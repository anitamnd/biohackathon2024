<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol. Biol. Evol</journal-id>
    <journal-id journal-id-type="publisher-id">molbev</journal-id>
    <journal-id journal-id-type="hwp">molbiolevol</journal-id>
    <journal-title-group>
      <journal-title>Molecular Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0737-4038</issn>
    <issn pub-type="epub">1537-1719</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3603318</article-id>
    <article-id pub-id-type="doi">10.1093/molbev/mst010</article-id>
    <article-id pub-id-type="publisher-id">mst010</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Fast Tracks</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MAFFT Multiple Sequence Alignment Software Version 7: Improvements in Performance and Usability</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Katoh</surname>
          <given-names>Kazutaka</given-names>
        </name>
        <xref ref-type="corresp" rid="mst010-COR1">*</xref>
        <xref ref-type="aff" rid="mst010-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="mst010-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Standley</surname>
          <given-names>Daron M.</given-names>
        </name>
        <xref ref-type="aff" rid="mst010-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="mst010-AFF1"><sup>1</sup>Immunology Frontier Research Center, Osaka University, Suita, Osaka, Japan</aff>
    <aff id="mst010-AFF2"><sup>2</sup>Computational Biology Research Center, The National Institute of Advanced Industrial Science and Technology (AIST), Tokyo, Japan</aff>
    <author-notes>
      <corresp id="mst010-COR1"><bold>*Corresponding author:</bold> E-mail: <email>kazutaka.katoh@aist.go.jp</email>.</corresp>
      <fn>
        <p><bold>Associate editor:</bold> Sudhir Kumar</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>4</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>1</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>1</month>
      <year>2013</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>4</issue>
    <fpage>772</fpage>
    <lpage>780</lpage>
    <permissions>
      <copyright-statement>© The Author 2013. Published by Oxford University Press on behalf of the Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>We report a major update of the MAFFT multiple sequence alignment program. This version has several new features, including options for adding unaligned sequences into an existing alignment, adjustment of direction in nucleotide alignment, constrained alignment and parallel processing, which were implemented after the previous major update. This report shows actual examples to explain how these features work, alone and in combination. Some examples incorrectly aligned by MAFFT are also shown to clarify its limitations. We discuss how to avoid misalignments, and our ongoing efforts to overcome such limitations.</p>
    </abstract>
    <kwd-group>
      <kwd>multiple sequence alignment</kwd>
      <kwd>metagemone</kwd>
      <kwd>protein structure</kwd>
      <kwd>progressive alignment</kwd>
      <kwd>parallel processing</kwd>
    </kwd-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>Introduction</title>
    <p>Multiple sequence alignment (MSA) plays an important role in evolutionary analyses of biological sequences. MAFFT is an MSA program, first released in 2002 (<xref ref-type="bibr" rid="mst010-B22">Katoh et al. 2002</xref>). Because of its high performance (<xref ref-type="bibr" rid="mst010-B34">Nuin et al. 2006</xref>; <xref ref-type="bibr" rid="mst010-B12">Golubchik et al. 2007</xref>; <xref ref-type="bibr" rid="mst010-B9">Dessimoz and Gil 2010</xref>; <xref ref-type="bibr" rid="mst010-B29">Letsch et al. 2010</xref>; <xref ref-type="bibr" rid="mst010-B38">Sahraeian and Yoon 2011</xref>; <xref ref-type="bibr" rid="mst010-B40">Sievers et al. 2011</xref>), MAFFT is becoming popular in recent years. After reviewing the previous version (version 6) in <xref ref-type="bibr" rid="mst010-B26">Katoh and Toh (2008b)</xref>, we have been continuously improving its accuracy, speed, and utility in practical situations. These improvements and techniques were mostly reported in individual papers (<xref ref-type="bibr" rid="mst010-B19">Katoh et al. 2009</xref>; <xref ref-type="bibr" rid="mst010-B27">Katoh and Toh 2010</xref>; <xref ref-type="bibr" rid="mst010-B20">Katoh and Frith 2012</xref>; <xref ref-type="bibr" rid="mst010-B23">Katoh and Standley 2013</xref>). In this report, we demonstrate the different kinds of analyses that can be achieved with the new features, alone and in combination, using realistic examples. We also discuss limitations of current version by giving examples of sequences incorrectly aligned by MAFFT, and describe our ongoing efforts to overcome these limitations.</p>
  </sec>
  <sec>
    <title>Basic Concepts and Usage</title>
    <p>As listed in <xref ref-type="table" rid="mst010-T1">table 1</xref>, MAFFT version 7 has options for various alignment strategies, including progressive methods (PartTree, FFT-NS-1, and L-INS-1) (<xref ref-type="bibr" rid="mst010-B10">Feng and Doolittle 1987</xref>; <xref ref-type="bibr" rid="mst010-B16">Higgins and Sharp 1988</xref>; <xref ref-type="bibr" rid="mst010-B24">Katoh and Toh 2007</xref>), iterative refinement methods (FFT-NS-i, L-INS-i, E-INS-i, and G-INS-i) (<xref ref-type="bibr" rid="mst010-B2">Barton and Sternberg 1987</xref>; <xref ref-type="bibr" rid="mst010-B3">Berger and Munson 1991</xref>; <xref ref-type="bibr" rid="mst010-B13">Gotoh 1993</xref>; <xref ref-type="bibr" rid="mst010-B21">Katoh et al. 2005</xref>), and structural alignment methods for RNAs (Q-INS-i and X-INS-i; <xref ref-type="bibr" rid="mst010-B25">Katoh and Toh 2008a</xref>). See <xref ref-type="bibr" rid="mst010-B26">Katoh and Toh (2008b)</xref> for details of these strategies. According to a recent comparative study based on the MetAl metric (<xref ref-type="bibr" rid="mst010-B5">Blackburne and Whelan 2012a</xref>, <xref ref-type="bibr" rid="mst010-B6">2012b</xref>), there are two significantly different classes of MSA methods, similarity-based methods and evolution-based methods. MAFFT is classified as a similarity-based method. However, evolutionary information is useful even for similarity-based methods, because the sequences to be aligned are generated from a common ancestor in the course of evolution. In this respect, MAFFT takes evolutionary information into account.
<table-wrap id="mst010-T1" position="float"><label>Table 1.</label><caption><p>Options of MAFFT Version 7.</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Option name</th><th rowspan="1" colspan="1">Command</th><th rowspan="1" colspan="1"/></tr></thead><tbody align="left"><tr><td colspan="3" rowspan="1">For a large-scale alignment: progressive methods with the PartTree algorithm<hr/></td></tr><tr><td rowspan="1" colspan="1">    NW-NS-PartTree1</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>parttree </monospace><monospace>––</monospace><monospace>retree 1 input</monospace></td><td align="left" rowspan="1" colspan="1">Distance is by the 6mer method.</td></tr><tr><td rowspan="1" colspan="1">    NW-NS-PartTree2</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>parttree </monospace><monospace>––</monospace><monospace>retree 2 input</monospace></td><td align="left" rowspan="1" colspan="1">Distance is by the 6mer method. Guide tree is re-built.</td></tr><tr><td rowspan="1" colspan="1">    NW-NS-DPPartTree1</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>dpparttree </monospace><monospace>––</monospace><monospace>retree 1 input</monospace></td><td align="left" rowspan="1" colspan="1">Distance is estimated based on DP.</td></tr><tr><td rowspan="1" colspan="1">    NW-NS-DPPartTree2</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>dpparttree </monospace><monospace>––</monospace><monospace>retree 2 input</monospace></td><td align="left" rowspan="1" colspan="1">Distance is estimated based on DP. Guide tree is re-built.</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">For a medium-scale alignment: progressive methods</td></tr><tr><td rowspan="1" colspan="1">    FFT-NS-1</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>retree 1 input</monospace></td><td align="left" rowspan="1" colspan="1">Approximately two times faster than the default.</td></tr><tr><td rowspan="1" colspan="1">    FFT-NS-2</td><td align="left" rowspan="1" colspan="1"><monospace>mafft input</monospace></td><td align="left" rowspan="1" colspan="1">Default.</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">For a small-scale alignment: iterative refinement methods</td></tr><tr><td rowspan="1" colspan="1">    FFT-NS-i</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>maxiterate 16 input</monospace></td><td align="left" rowspan="1" colspan="1">Fastest of the four in this category. Uses WSP score (<xref ref-type="bibr" rid="mst010-B14">Gotoh 1995</xref>) only.</td></tr><tr><td rowspan="1" colspan="1">    G-INS-i</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>maxiterate 16 </monospace><monospace>––</monospace><monospace>globalpair input</monospace></td><td align="left" rowspan="1" colspan="1">Uses WSP score and consistency (<xref ref-type="bibr" rid="mst010-B33">Notredame et al. 1998</xref>) score from global alignments.</td></tr><tr><td rowspan="1" colspan="1">    L-INS-i</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>maxiterate 16 </monospace><monospace>––</monospace><monospace>localpair input</monospace></td><td align="left" rowspan="1" colspan="1">Uses WSP score and consistency score from local alignments.</td></tr><tr><td rowspan="1" colspan="1">    E-INS-i</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>maxiterate 16 </monospace><monospace>––</monospace><monospace>genafpair input</monospace></td><td align="left" rowspan="1" colspan="1">Uses WSP score and consistency score from local alignments with a generalized affine gap cost (<xref ref-type="bibr" rid="mst010-B1">Altschul 1998</xref>).</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">If not sure which option to use</td></tr><tr><td rowspan="1" colspan="1">    Automatic</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>auto</monospace></td><td align="left" rowspan="1" colspan="1">Selects an appropriate option from FFT-NS-2, FFT-NS-i and L-INS-i, according to the size of input data.</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">For a small-scale RNA alignment: structural alignment methods</td></tr><tr><td rowspan="1" colspan="1">    Q-INS-i</td><td align="left" rowspan="1" colspan="1"><monospace>mafft-qinsi input</monospace></td><td align="left" rowspan="1" colspan="1">Structure information is included in iterative refinement step.</td></tr><tr><td rowspan="1" colspan="1">    X-INS-i-scarnapair</td><td align="left" rowspan="1" colspan="1"><monospace>mafft-xinsi </monospace><monospace>––</monospace><monospace>scarnapair input</monospace></td><td align="left" rowspan="1" colspan="1">Uses pairwise structural alignment by MXSCARNA (<xref ref-type="bibr" rid="mst010-B45">Tabei et al. 2008</xref>).</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">To add new sequences into an existing MSA</td></tr><tr><td rowspan="1" colspan="1">    Add</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>add mew msa</monospace></td><td align="left" rowspan="1" colspan="1">The simplest option for alignment extension.</td></tr><tr><td rowspan="1" colspan="1">    Addprofile</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>addprofile msa1 </monospace><monospace>msa2</monospace></td><td align="left" rowspan="1" colspan="1">msa1 must form a monophyletic cluster.</td></tr><tr><td rowspan="1" colspan="1">    Addfragments</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>addfragments new msa</monospace></td><td align="left" rowspan="1" colspan="1">Suitable for short new sequences.</td></tr><tr><td rowspan="1" colspan="1">    Addfragments, LAST</td><td align="left" rowspan="1" colspan="1"><monospace>mafft ––addfragments new </monospace><monospace>––</monospace><monospace>lastmultipair msa</monospace></td><td align="left" rowspan="1" colspan="1">Faster option, LAST (<xref ref-type="bibr" rid="mst010-B28">Kiełbasa et al. 2011</xref>) is required.</td></tr><tr><td rowspan="1" colspan="1">    Addfragments, 6mer</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>addfragments new </monospace><monospace>––</monospace><monospace>6merpair msa</monospace></td><td align="left" rowspan="1" colspan="1">Faster option for conserved data.</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">Parameters</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>bl #, </monospace><monospace>––</monospace><monospace>jtt #, </monospace><monospace>––</monospace><monospace>tm #</monospace></td><td align="left" rowspan="1" colspan="1">Score matrices for protein alignment.</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>kimura #</monospace></td><td align="left" rowspan="1" colspan="1">Score matrix for nucleotide alignment.</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">Utility options</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>anysymbol</monospace></td><td rowspan="11" align="left" colspan="1">See main text.</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>reorder</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>clustalout</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>phylipout</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>namelength #</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>adjustdirection</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>adjustdirectionaccurately</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>seed msa1 –seed msa2</monospace><monospace> …</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>treein treefile</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>treeout</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>thread #</monospace></td></tr></tbody></table><table-wrap-foot><fn id="mst010-TF1"><p>N<sc>ote</sc>.—<bold>N, the number of sequences; L, the sequence length; <monospace><bold>input, new</bold></monospace>, unaligned sequences in the multi-fasta format; <monospace><bold>msa, msa1, msa2</bold></monospace>, aligned sequences in the multi-fasta format; <monospace><bold>treefile</bold></monospace>, input guide tree file.</bold></p></fn></table-wrap-foot></table-wrap></p>
    <p>All the options of MAFFT assume that the input sequences are all homologous, that is, descended from a common ancestor. Thus, all the letters in the input data are aligned. Genomic rearrangement or domain shuffling is not assumed, and thus the order of the letters in each sequence is always preserved, although the sequences can be reordered according to similarity. Most options in MAFFT assume that almost all the pairs in the input sequences can be aligned, locally or globally. In such a situation, there is a tradeoff between accuracy and speed. For example, the PartTree option (<xref ref-type="bibr" rid="mst010-B24">Katoh and Toh 2007</xref>) is a fast and rough method, whereas L-INS-i and G-INS-i are slower and more accurate. RNA structural alignment methods are generally more accurate and computationally more expensive because they need additional calculations (<xref ref-type="bibr" rid="mst010-B25">Katoh and Toh 2008a</xref>). However, this tradeoff does not always hold. In particular, the new options to add sequences into an existing alignment (<xref ref-type="bibr" rid="mst010-B20">Katoh and Frith 2012</xref>), requires careful consideration of this tradeoff, as discussed later.</p>
  </sec>
  <sec>
    <title>Profile Alignments</title>
    <p>MAFFT has a subprogram, <monospace>mafft-profile</monospace>, to align two existing alignments.
<disp-quote content-type="extract"><p><monospace>mafft-profile alignment1 alignment2 </monospace><monospace>&gt;</monospace><monospace> output</monospace></p></disp-quote>
This method separately converts <monospace>alignment1</monospace> and <monospace>alignment2</monospace> to profiles and then aligns the two profiles. It means that the two input alignments are assumed to be phylogenetically isolated from each other, like <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>A</italic>. Careless application of this method results in serious misalignments, as discussed in later section.
<fig id="mst010-F1" position="float"><label><bold>F<sc>ig</sc>. 1</bold>.</label><caption><p>Assumptions on the phylogenetic relationship in different options of MAFFT. (<italic>A</italic>) <monospace>mafft-profile</monospace>, (<italic>B</italic>) <monospace>––</monospace><monospace>addprofile</monospace>, (<italic>C</italic>), misuse of <monospace>mafft-profile</monospace>, and (<italic>D</italic>) <monospace>––</monospace><monospace>add</monospace> or <monospace>––</monospace><monospace>addprofile</monospace>.</p></caption><graphic xlink:href="mst010f1p"/></fig></p>
    <p>MAFFT version 7 has an alternative option, <monospace>––</monospace><monospace>addprofile</monospace>, which is safer against misuses.
<disp-quote content-type="extract"><p><monospace>mafft <monospace>--</monospace></monospace><monospace>addprofile alignment1 alignment2 </monospace><monospace>&gt;</monospace><monospace> output</monospace></p></disp-quote>
This option accepts two existing alignments, <monospace>alignment1</monospace> and <monospace>alignment2</monospace>, and assumes a phylogenetic relationship shown in <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>B</italic>. That is, <monospace>alignment1</monospace> is assumed to form a monophyletic cluster, but <monospace>alignment2</monospace> is not assumed to form a monophyletic cluster. The cluster of <monospace>alignment1</monospace> can be placed in any phylogenetic position in the tree of <monospace>alignment2</monospace>. Moreover, this option checks whether <monospace>alignment1</monospace> forms a monophyletic cluster. If not, it returns an error message and asks user to use the <monospace>––</monospace><monospace>add</monospace> option (see the following section).</p>
  </sec>
  <sec>
    <title>Adding Unaligned Sequences into an MSA</title>
    <p>As a result of advances in sequencing technologies, we increasingly need MSAs consisting of a larger number of sequences. There are several different approaches to enable construction of large MSAs, such as rapid algorithms and parallelization. Here, we describe an alternate approach: use of an existing alignment. There already exist databases of carefully aligned and annotated sequences (<xref ref-type="bibr" rid="mst010-B8">Cole et al. 2009</xref>; <xref ref-type="bibr" rid="mst010-B41">Sigrist et al. 2010</xref>; <xref ref-type="bibr" rid="mst010-B37">Punta et al. 2012</xref>), in which each MSA consists of a small number (typically up to ∼1,000) of sequences. We can use such MSAs as a backbone to build a larger MSA containing newly sequenced data. This is more efficient than rebuilding the entire MSA from a set of ungapped sequences. Moreover, this approach is relatively robust to low-quality sequences resulting from sequencing errors, misassemblies, and other factors. Such noise usually has a negative effect on the quality of an MSA, but there are situations where biologically important information is contained in low-quality sequences. In such a case, we first select highly reliable sequences to build a backbone MSA, and then add the other sequences, including low-quality ones, into the MSA. As a result, the quality of the final MSA is less affected by the low-quality sequences.</p>
    <sec>
      <title>Inappropriate Applications of Profile Alignment</title>
      <p>The <monospace>mafft-profile</monospace> program is not useful for this purpose. There are two types of misapplications. One is as follows: 1) convert an existing alignment to a profile, 2) align new sequences and convert them to a profile, and 3) align the two profiles. This procedure is inappropriate for adding new sequences because it assumes a phylogenetic relationship as illustrated in <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>A</italic>.</p>
      <p>Another misapplication is as follows: 1) convert the existing alignment to a profile, <italic>2</italic>) separately align each new sequence to the profile of the existing alignment, and 3) construct a full alignment from the individual alignments computed in the previous step. This approach is more reasonable than the first one but still problematic, because the phylogenetic positions of new sequences are assumed at the root of the tree, as illustrated in <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>C</italic>. Results of this procedure for two cases are shown in <xref ref-type="table" rid="mst010-T2">table 2</xref> and <xref ref-type="fig" rid="mst010-F2">figure 2</xref>.
<fig id="mst010-F2" position="float"><label>F<sc>ig</sc>. 2.</label><caption><p>ITS alignments by different options of MAFFT, displayed on Jalview (<xref ref-type="bibr" rid="mst010-B47">Waterhouse et al. 2009</xref>). (<italic>A</italic>, <italic>B</italic>) Incorrect alignments by the FFT-NS-2 and L-INS-i algorithms, respectively. (<italic>C</italic>) An incorrect alignment by <monospace>mafft-profile</monospace>. The full-length sequences were aligned with the L-INS-i algorithm and then each new sequence was separately added to the full-length alignment, using <monospace>mafft-profile</monospace>. (<italic>D</italic>) Reasonable alignment by a two-step strategy. The <monospace>––</monospace><monospace>6merpair </monospace><monospace>––</monospace><monospace>addfragments</monospace> option was used at the second step. (<italic>E</italic>) Reordered version of D; sequences are ordered such that similar sequences are placed closely. All calculations were performed using 16 cores on a Linux PC with 2.67 GHz Intel Xeon E7-8837/256 GB RAM.</p></caption><graphic xlink:href="mst010f2p"/></fig>
<table-wrap id="mst010-T2" position="float"><label><bold>Table 2</bold>.</label><caption><p>Comparison of Different Options Using the 16S.B.ALL Data Set (<xref ref-type="bibr" rid="mst010-B32">Mirarab et al. 2012</xref>).</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Data</th><th rowspan="1" colspan="1">Method</th><th rowspan="1" colspan="1">Accuracy</th><th rowspan="1" colspan="1">CPU Time</th><th rowspan="1" colspan="1">Actual Time<xref ref-type="table-fn" rid="mst010-TF1"><sup>a</sup></xref></th></tr></thead><tbody align="left"><tr><td rowspan="5" colspan="1">Case 1</td><td align="left" rowspan="1" colspan="1"><monospace>mafft ––multipair ––addfragments frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9969</td><td align="left" rowspan="1" colspan="1">6.67 days</td><td align="left" rowspan="1" colspan="1">18.3 h</td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>mafft ––6merpair ––addfragments frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9949</td><td align="left" rowspan="1" colspan="1">3.76 h</td><td align="left" rowspan="1" colspan="1">36.2 min</td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>mafft ––localpair ––add  frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9707</td><td align="left" rowspan="1" colspan="1">23.4 days<xref ref-type="table-fn" rid="mst010-TF2"><sup>b</sup></xref></td><td align="left" rowspan="1" colspan="1">2.43 days<xref ref-type="table-fn" rid="mst010-TF2"><sup>b</sup></xref></td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>mafft ––6merpair ––add frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9604</td><td align="left" rowspan="1" colspan="1">1.32 h</td><td align="left" rowspan="1" colspan="1">1.44 h</td></tr><tr><td align="left" rowspan="1" colspan="1">profile alignment</td><td align="left" rowspan="1" colspan="1">0.2779</td><td align="left" rowspan="1" colspan="1">15.5 h</td><td align="left" rowspan="1" colspan="1">1.60 h</td></tr><tr><td colspan="5" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1">Case 2</td><td align="left" rowspan="1" colspan="1"><monospace>mafft ––6merpair ––addfragments frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9969</td><td align="left" rowspan="1" colspan="1">4.54 h</td><td align="left" rowspan="1" colspan="1">33.8 min</td></tr><tr><td colspan="5" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1">Case 3</td><td align="left" rowspan="1" colspan="1"><monospace>mafft ––6merpair ––addfragments frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9949</td><td align="left" rowspan="1" colspan="1">1.79 days</td><td align="left" rowspan="1" colspan="1">5.91 h</td></tr></tbody></table><table-wrap-foot><fn id="mst010-TF2"><p>N<sc>ote</sc>.—The estimated alignments were compared with the CRW alignment to measure the accuracy (the number of correctly aligned letters/the number of aligned letters in the CRW alignment). Calculations were performed on a Linux PC with 2.67 GHz Intel Xeon E7-8837/256 GB RAM (for the case marked with superscript alphabet “b”), or on a Linux PC with 3.47 GHz Intel Xeon X5690/48 GB RAM (for the other cases). Case 1: 13,822 sequences in the existing alignment × 13,821 fragments; Case 2: 1,000 sequences in the existing alignment × 138,210 fragments; Case 3: 13,822 sequences in the existing alignment × 138,210 fragments.</p></fn><fn id="mst010-TF3"><p><sup>a</sup>Wall-clock time with 10 cores. Command-line argument for parallel processing is <monospace>––thread 10</monospace>.</p></fn><fn id="mst010-TF4"><p><sup>b</sup>Full command-line options are as follows: <monospace>mafft ––localpair ––weighti 0 ––add frags existingmsa</monospace>.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec>
      <title>The <monospace>––</monospace><monospace>a</monospace><monospace>dd</monospace> and <monospace>––</monospace><monospace>a</monospace><monospace>ddfragments</monospace> Options</title>
      <p>To overcome this limitation of profile alignment, in 2010, we implemented an option, <monospace>––</monospace><monospace>add</monospace>, to add unaligned sequences to an existing MSA. This option assumes that each new sequence was derived from a branch in the tree of an existing alignment, as illustrated in <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>D</italic>. This option works almost identically to the standard progressive method, except that the alignment calculation is skipped at the nodes whose children are all in the existing alignment.</p>
      <p>Along with popularization of second-generation sequencers, we sometimes need to align short reads to an existing alignment. Several tools (<xref ref-type="bibr" rid="mst010-B4">Berger and Stamatakis 2011</xref>; <xref ref-type="bibr" rid="mst010-B30">Löytynoja et al. 2012</xref>; <xref ref-type="bibr" rid="mst010-B44">Sun and Buhler 2012</xref>) for this purpose were developed between 2011 and 2012. A limitation of the <monospace>––</monospace><monospace>add</monospace> option in MAFFT for this purpose was pointed out in <xref ref-type="bibr" rid="mst010-B30">Löytynoja et al. (2012)</xref>. Thus, we implemented a new option, <monospace>––</monospace><monospace>addfragments</monospace>, which does not consider the relationship among the sequences to be added. Details of the <monospace>––</monospace><monospace>add</monospace> and <monospace>––</monospace><monospace>addfragments</monospace> options are described in <xref ref-type="bibr" rid="mst010-B20">Katoh and Frith (2012)</xref>.</p>
    </sec>
    <sec sec-type="cases">
      <title>Test Case 1: Fungal Internal Transcribed Spacers Sequences</title>
      <p>Here, we discuss how the <monospace>––</monospace><monospace>addfragments</monospace> option works, using an actual case. Internal transcribed spacers (ITSs) are spacer regions located between structural ribosomal RNAs. The structure of the rDNA region in a eukaryotic genome is 18S − ITS1 − 5.8S − ITS2 − 28S. Here, we use a data set consisting of ITS1 and ITS2 sequences obtained from environmental samples (Chen W, personal communication). Each sequence has either ITS1 or ITS2 region only, extracted from 454 pyrosequencing data using FungalITSextractor (<xref ref-type="bibr" rid="mst010-B48">Nilsson et al. 2010</xref>). In addition, several fungal genomic sequences that fully cover ITS1 + 5.8S rRNA + ITS2 are available from public databases.</p>
      <p>Suppose a situation where we need an MSA of approximately 300 full-length sequences and approximately 5,000 ITS1 or ITS2 sequences. One possible solution is to build an entire MSA at once. The result of the default option (FFT-NS-2) of MAFFT is obviously incorrect, as shown in <xref ref-type="fig" rid="mst010-F2">figure 2</xref><italic>A</italic>. ITS1 and ITS2 regions are forced to be aligned to each other. Even if a more computationally expensive (and usually more accurate) method, L-INS-i, is applied (CPU time = 98 h), the alignment is still obviously incorrect (<xref ref-type="fig" rid="mst010-F2">fig. 2</xref><italic>B</italic>).</p>
      <p>Two-step strategies can solve this type of problem. That is, a set of full-length sequences taken from databases are first aligned to build a backbone MSA, and then the new ITS1 and ITS2 sequences are added into this backbone MSA, using the <monospace>––</monospace><monospace>addfragments</monospace> option.
<disp-quote content-type="extract"><p>Step 1: <monospace>mafft <monospace>--</monospace></monospace><monospace>auto full_length_sequences &gt;\ backbone_msa</monospace></p><p>Step 2: <monospace>mafft <monospace>--</monospace></monospace><monospace>addfragments \ new_sequences backbone_msa &gt; output</monospace></p></disp-quote>
The second command is equivalent to
<disp-quote content-type="extract"><p><monospace>mafft <monospace>--</monospace></monospace><monospace>multipair <monospace>--</monospace></monospace><monospace>addfragments \ new_sequences backbone_msa &gt; output</monospace></p></disp-quote>
in which Dynamic Programming (DP) is used to compare the distances between every new sequence and every sequence in the backbone MSA (<monospace>––</monospace><monospace>multipair</monospace> is selected by default).
<disp-quote content-type="extract"><p><monospace>mafft <monospace>--</monospace></monospace><monospace>6merpair <monospace>--</monospace></monospace><monospace>addfragments \ new_sequences backbone_msa &gt; output</monospace></p></disp-quote>
where distances are rapidly estimated using the number of shared 6mers, instead of DP.</p>
      <p>The result of the latter option (<monospace>––</monospace><monospace>6merpair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) is shown in <xref ref-type="fig" rid="mst010-F2">fig. 2</xref><italic>D</italic> and <italic>E</italic>. The difference between <italic>D</italic> and <italic>E</italic> is just in the order of sequences; the sequences were reordered according to similarity using the <monospace>––</monospace><monospace>reorder</monospace> option in <italic>E</italic>. In this alignment, ITS1 and ITS2 are clearly separated and aligned to appropriate positions in the full-length alignment. Moreover, this strategy is computationally much less expensive (CPU time = 15 min [first step] + 1.5 min [second step]) than the full application of L-INS-i (CPU time = 98 h). The former option (<monospace>––multipair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) also returns a similar result to the latter (<monospace>––</monospace><monospace>6merpair)</monospace> but is slower (CPU time = 48.6 min [second step]).</p>
      <p>This case suggests that it is crucial to select a strategy appropriate to the problem of interest. The most time-consuming method, L-INS-i, is not always the most accurate one. The difficulty of this problem for standard approaches comes from the fact that ITS1 sequences and ITS2 sequences are not homologous to each other and most pairwise alignments are impossible. Because of these nonhomologous pairs, the distance matrix used for the guide tree calculation is not additive; the distances between ITS1 and full-length sequences and those between ITS2 and full-length sequences are close to zero, whereas the distances between ITS1 and ITS2 are quite large. In this situation, it is difficult for normal distance-based tree-building methods to give a reasonable tree. Moreover, in the alignment step, the objective function of the L-INS-i is affected by inappropriate pairwise alignment scores between ITS1 and ITS2. Such problems can be avoided by just ignoring the relationship between ITS1 and ITS2, as done in the <monospace>––</monospace><monospace>addfragments</monospace> option.</p>
      <p>In addition, a result of the second type of misuse of <monospace>mafft-profile</monospace> (discussed earlier) is shown in <xref ref-type="fig" rid="mst010-F2">figure 2</xref><italic>C</italic>. Some new sequences are correctly aligned but others are obviously incorrectly aligned (note that the order of sequences in <xref ref-type="fig" rid="mst010-F2">fig. 2</xref><italic>C</italic> is identical that in <xref ref-type="fig" rid="mst010-F2">fig. 2</xref><italic>D</italic>). These misalignments are due to an incorrect assumption on phylogenetic placement of new sequences shown in <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>C</italic>.</p>
    </sec>
    <sec sec-type="cases">
      <title>Test Case 2: Bacterial SSU rRNA</title>
      <p>Another case is the 16S.B.ALL data set by <xref ref-type="bibr" rid="mst010-B32">Mirarab et al. (2012)</xref>. It consists of an MSA of 13,822 bacterial SSU rRNA sequences, taken from the Gutell Comparative RNA Website (CRW) (<xref ref-type="bibr" rid="mst010-B7">Cannone et al. 2002</xref>) and 138,210 fragmentary sequences, which are originally included in the CRW alignment but ungapped and artificially truncated. In <xref ref-type="bibr" rid="mst010-B23">Katoh and Standley (2013)</xref>, we used a subset (13,821 fragmentary sequences) prepared by <xref ref-type="bibr" rid="mst010-B32">Mirarab et al. (2012)</xref>. In addition to this subset, here we use the full data set (138,210 fragmentary sequences), to examine the scalability. Suppose a situation where we already have a manually curated (or backbone) MSA and a newly determined set of many fragmentary sequences in a metagenomics project, and we need an entire MSA of them.</p>
      <p>The first four lines in <xref ref-type="table" rid="mst010-T2">table 2</xref> (case 1) show the performances of various options for such an analysis, with a relatively small data set (13,822 sequences in the existing alignment × 13,821 fragments). The accuracy of each resulting MSA was evaluated by comparing the MSA with the original CRW alignment. CPU time and wall-clock time for each method are also listed. As the sequences in this data set are highly conserved, the difference in accuracy between the default (<monospace>––</monospace><monospace>multipair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) and the faster option (<monospace>––</monospace><monospace>6merpair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) is small.</p>
      <p>Again, the tradeoff between accuracy and speed does not hold. The application of a computationally expensive method based on L-INS-1 (<monospace>––</monospace><monospace>localpair </monospace><monospace>––</monospace><monospace>add</monospace>) has no advantage, because the extra computational time is spent on the comparison of nonoverlapping fragmentary sequences, which have no reasonable solutions.</p>
      <p>The “profile alignment” line in <xref ref-type="table" rid="mst010-T2">table 2</xref> shows results of the second type of misuse of profile alignment (discussed earlier), in which the given alignment is converted to a profile and each new sequence is separately aligned to the profile. This result clearly indicates that the application of profile alignment must be avoided in this case, too. Users do not need to be too worried about this misuse, because this calculation is disabled in MAFFT unless the user modifies the code or writes a wrapper script.</p>
      <p>The last two lines in <xref ref-type="table" rid="mst010-T2">table 2</xref> (Cases 2 and 3) show the performance of the fast option (<monospace>––</monospace><monospace>6merpair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) for a larger number (138,210) of fragmentary sequences. The number of sequences in the existing alignment is 1,000 and 13,822 in cases 2 and 3, respectively. This fast option gives a reasonable quality of result in a reasonable computing time. At present, the default option (<monospace>––</monospace><monospace>multipair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) cannot handle cases 2 and 3. Simulation-based benchmarks in <xref ref-type="bibr" rid="mst010-B20">Katoh and Frith (2012)</xref> suggested that, for cases with more divergent sequences, the accuracy of the default option is higher than that of the fast option. We are now trying to improve the scalability of the default option.</p>
    </sec>
  </sec>
  <sec>
    <title>Parallelization</title>
    <p>MAFFT version 7 has an option for parallel processing, <monospace>––</monospace><monospace>thread</monospace> (<xref ref-type="bibr" rid="mst010-B27">Katoh and Toh 2010</xref>). This feature is currently supported on Mac OS X in addition to Linux, but not yet supported on Windows for technical reasons. With the <monospace>––</monospace><monospace>thread</monospace>
<italic>n</italic> option, it runs in parallel with <italic>n</italic> threads. The number of threads can be automatically determined by <monospace>––</monospace><monospace>thread </monospace><monospace>–</monospace><monospace>1</monospace>. This option sets the number of threads as the number of physical cores, not the number of logical cores in Intel’s hyperthreaded CPUs.</p>
    <p>For progressive methods, the result with the multithread version is identical to that of the serial processing version. However, for iterative refinement methods, the results are not always identical. We confirmed that the accuracy of the parallel version in this case is comparable with that of the serial version (<xref ref-type="bibr" rid="mst010-B27">Katoh and Toh 2010</xref>). The efficiency of parallelization depends on the alignment strategy. In the case of the <monospace>––</monospace><monospace>addfragments</monospace> option, the efficiency is acceptably high as shown in <xref ref-type="table" rid="mst010-T2">table 2</xref>.</p>
  </sec>
  <sec>
    <title>Utility Options</title>
    <p>MAFFT version 7 also has several enhanced options for peripheral functions.</p>
    <sec>
      <title>Estimating the Direction of DNA Sequences</title>
      <p>In the case of nucleotide alignments, if some of input sequences have an incorrect direction relative to the other sequences, the directions can be automatically adjusted by the <monospace>––</monospace><monospace>adjustdirection</monospace> option. We use an algorithm with a time complexity of <inline-formula><inline-graphic xlink:href="mst010i1.jpg"/></inline-formula>, where <italic>n</italic> is the number of sequences (<xref ref-type="bibr" rid="mst010-B23">Katoh and Standley 2013</xref>). It is slow when the distances are calculated with DP. However, when the distance is rapidly calculated based on the number of shared 6mers, the speed is reasonable. This option is also available on the web version, with the “Adjust direction” button.</p>
      <p>MAFFT cannot handle more complicated sequences with genomic rearrangements (translocations, duplications, or inversions). The web version of MAFFT displays dot plots between the first sequence and the remaining sequences, using the LAST local alignment program (<xref ref-type="bibr" rid="mst010-B28">Kiełbasa et al. 2011</xref>), for every nucleotide alignment run. By viewing the dot plots, a user can easily check for genomic rearrangements and the directions of input sequences. See <xref ref-type="bibr" rid="mst010-B23">Katoh and Standley (2013)</xref> for details and an example.</p>
    </sec>
    <sec>
      <title>Input/Output</title>
      <p>MAFFT version 7 has several enhancements in the flexibility of input/output. The following options related to input/output are available and can be combined with other options.
<list list-type="simple"><list-item><p><monospace>––</monospace><monospace>anysymbol</monospace> If the input data include unusual letters, like U, J, etc., (in the case of protein data), MAFFT stops by default. The <monospace>––</monospace><monospace>anysymbol</monospace> option allows these letters and nonalphabetical letters.</p></list-item><list-item><p><monospace>––</monospace><monospace>preservecase</monospace><monospace> </monospace>By default, amino acid sequences are converted to upper case and nucleotide sequences are converted to lower case. This behavior can be changed by using the <monospace>––</monospace><monospace>preservecase</monospace> option.</p></list-item><list-item><p><monospace>––</monospace><monospace>reorder</monospace><monospace> </monospace>The order of sequences is the same as the input sequences by default, but the sequences can be sorted according to similarity to each other by the <monospace>––</monospace><monospace>reorder</monospace> option.</p></list-item><list-item><p><monospace>––</monospace><monospace>phylipout</monospace><monospace>a</monospace>nd <monospace>––<monospace>clustalout</monospace></monospace><monospace> </monospace>The output format is multi-fasta by default, but the phylip (interleaved) format and the clustal format can be selected.</p></list-item></list>
</p>
    </sec>
    <sec>
      <title>Guide Tree and Phylogenetic Positions of New Sequences</title>
      <p>Users can check the guide tree by using the <monospace>––</monospace><monospace>treeout</monospace> option. In the case of <monospace>––</monospace><monospace>addfragments</monospace>, the estimated phylogenetic positions of new sequences are shown together with the estimated tree of the existing alignment. The alignment calculation is performed based on this phylogenetic estimation. It is also possible to compute such phylogenetic information only, without alignment, by the <monospace>––</monospace><monospace>retree 0</monospace> option. An example of output is shown in <xref ref-type="fig" rid="mst010-F3">Figure 3</xref><italic>A</italic>.
<fig id="mst010-F3" position="float"><label>F<sc>ig</sc>. 3.</label><caption><p>(<italic>A</italic>) A part of output of the <monospace>––</monospace><monospace>treeout</monospace> option showing the phylogenetic positions of new sequences (<monospace>new#</monospace>) in the tree of the existing alignment (<monospace>backbone#</monospace>), estimated before the alignment calculation. This file also shows a Newick format tree of the existing alignment (not shown in this figure). For each new sequence, the nearest sequence in the existing alignment (<monospace>nearest sequence</monospace>), approximate distance to the nearest sequence (<monospace>approximate distance</monospace>), and the members of the sister group (<monospace>sister group</monospace>) are shown. (<italic>B</italic>) Graphical representation of (<italic>A</italic>).</p></caption><graphic xlink:href="mst010f3p"/></fig></p>
      <p>Note that this phylogenetic information is roughly estimated <italic>before</italic> the MSA calculation, not based on the MSA. Especially, with the fast option, <monospace>––</monospace><monospace>6merpair</monospace>, the estimation is very rough. With the <monospace>––</monospace><monospace>multipair</monospace> option (default), the estimation is expected to be better, but it needs a relatively long computational time. For more rigorous estimation of phylogenetic positions of new sequences, specially designed tools, such as pplacer (<xref ref-type="bibr" rid="mst010-B31">Matsen et al. 2010</xref>), PaPaRa (<xref ref-type="bibr" rid="mst010-B4">Berger and Stamatakis 2011</xref>), PAGAN (<xref ref-type="bibr" rid="mst010-B30">Löytynoja et al. 2012</xref>), SEPP (<xref ref-type="bibr" rid="mst010-B32">Mirarab et al. 2012</xref>), or combinations of them including MAFFT, should be tried.</p>
    </sec>
  </sec>
  <sec>
    <title>Parameters</title>
    <p>For amino acid alignment, MAFFT uses the BLOSUM62 matrix by default. For nucleotide alignment, a 200PAM log-odds scoring matrix is generated assuming that the transition rate is twice the transversion rate. These matrices are suitable for aligning distantly related sequences. We selected these default parameters based on an expectation that, if the program works well for difficult (distantly related) cases, it should also work well for easy cases.</p>
    <p>It is unclear whether this expectation is always correct. For example, in a benchmark using simulated protein sequences (<xref ref-type="bibr" rid="mst010-B30">Löytynoja et al. 2012</xref>) generated by INDELiBLE (<xref ref-type="bibr" rid="mst010-B11">Fletcher and Yang 2009</xref>), when we tested a more stringent scoring matrix, JTT 1PAM (<xref ref-type="bibr" rid="mst010-B17">Jones et al. 1992</xref>) with weaker gap penalties than the default, the benchmark scores were considerably improved. Despite this observation, we consistently used the default parameters in the benchmark in <xref ref-type="bibr" rid="mst010-B20">Katoh and Frith (2012)</xref>, because it does not make sense to arbitrarily adjust parameters to a simulation setting. This observation suggests that the current default parameters of MAFFT might not be very suitable for aligning closely related sequences. However, this idea must be checked using actual biological sequences.</p>
    <p>User can select different scoring matrices other than the default. For amino acid alignment, <monospace>––</monospace><monospace>bl 45</monospace>, <monospace>––</monospace><monospace>bl 62</monospace>, <monospace>––</monospace><monospace>bl 80</monospace>, <monospace>––</monospace><monospace>jtt N</monospace>, and <monospace>––</monospace><monospace>tm N</monospace> are accepted, where <monospace>N</monospace> is an expected evolutionary distance among input sequences. The <monospace>––</monospace><monospace>bl</monospace>, <monospace>––</monospace><monospace>jtt</monospace>, and <monospace>––</monospace><monospace>tm</monospace> options mean BLOSUM (Henikoff S and Henikoff JG <xref ref-type="bibr" rid="mst010-B15">1992</xref>), JTT (<xref ref-type="bibr" rid="mst010-B17">Jones et al. 1992</xref>), and a transmembrane model (<xref ref-type="bibr" rid="mst010-B18">Jones et al. 1994</xref>), respectively. A user-defined scoring matrix can also be accepted, by <monospace>––</monospace><monospace>aamatrix</monospace>. For nucleotide alignments, <monospace>––</monospace><monospace>kimura N</monospace> is accepted, where <monospace>N</monospace> is an expected evolutionary distance among input sequences. Gap penalties can be adjusted by <monospace>––</monospace><monospace>op</monospace>, <monospace>––</monospace><monospace>exp</monospace>, <monospace>––</monospace><monospace>lop</monospace>, and <monospace>––</monospace><monospace>lexp</monospace> options.</p>
    <p>One possible extension is to use different scoring matrices and gap penalties for different sequence pairs according to the divergence level, like ClustalW (<xref ref-type="bibr" rid="mst010-B46">Thompson et al. 1994</xref>). More studies using actual sequence data will be necessary before implementing this extension. It will also be necessary to adjust gap penalties, preferably based on a realistic evolutionary model of insertions and deletions.</p>
  </sec>
  <sec>
    <title>Use of Structural Information</title>
    <p>We have discussed possible improvements in MSAs of closely related sequences in the previous section. MSA of distantly related sequences is still a challenging problem.</p>
    <sec sec-type="cases">
      <title>Test Case 3: PIN Domain</title>
      <p><xref ref-type="fig" rid="mst010-F4">Figure 4</xref> shows a typical limitation of sequence level alignment for a highly divergent set of three PIN-domain containing proteins: human regnase-1, VPA0982 from <italic>Vibrio parahaemolyticus</italic>, nuclease domain of taq polymerase from <italic>Thermus aquaticus</italic>. These three proteins share a magnesium-binding site composed of three conserved aspartic acids. <xref ref-type="fig" rid="mst010-F4">Figure 4</xref><italic>A</italic> shows a superposition of the three structures (Protein Databank identifiers 3v33, 2qip, and 1taq, respectively). The middle aspartic acid is indicated by sphere-representation, colored red. In <xref ref-type="fig" rid="mst010-F4">Figure 4</xref><italic>B</italic>, a typical MSA (by MAFFT-L-INS-i) is shown wherein the middle aspartic acid position is misaligned. In <xref ref-type="fig" rid="mst010-F4">Figure 4</xref><italic>C</italic>, a structure-informed MSA (described below), with the middle aspartic acid correctly aligned, is shown.
<fig id="mst010-F4" position="float"><label><bold>F<sc>ig</sc>. 4</bold>.</label><caption><p>(<italic>A</italic>) Superposition of 3v33, 2qip, and 1taq structures visualized by PyMOL (<xref ref-type="bibr" rid="mst010-B39">Schrödinger LLC 2010</xref>). (<italic>B</italic>) MAFFT-L-INS-i sequence alignment displayed on jalview (<xref ref-type="bibr" rid="mst010-B47">Waterhouse et al. 2009</xref>). Misaligned Ds are highlighed in red. (<italic>C</italic>) Structure-informed MSA with correctly aligned Ds; Alpha helices and beta sheets are shown in blue and yellow, respectively, in (<italic>A–C</italic>).</p></caption><graphic xlink:href="mst010f4p"/></fig></p>
    </sec>
    <sec>
      <title>Strategy for Integrating Structural Alignments and MAFFT</title>
      <p>It has long been known that structural information can be used to improve MSA calculations. This was the basis of the 3D Coffee program (<xref ref-type="bibr" rid="mst010-B35">O’Sullivan et al. 2004</xref>), and later the PROMALS3D package (<xref ref-type="bibr" rid="mst010-B36">Pei et al. 2008</xref>). Here, we address incorporation of protein structural information in MAFFT-based MSA construction. There are both conceptual issues and technical issues that complicate the process. Conceptually, we have to define structural similarity in such a way that it can easily be used in sequence alignments. We discuss our approach to this problem below in the context of integrating MAFFT with the structural alignment program ASH (<xref ref-type="bibr" rid="mst010-B43">Standley et al. 2004</xref>, <xref ref-type="bibr" rid="mst010-B42">2007</xref>). On the technical level, structural information complicates matters simply because protein structures contain more information and more noise than sequence information.</p>
      <p>Here, we focus on one essential feature of ASH: the equivalence score that is used to define structural similarity. A particular element in the structural similarity matrix takes the form of a Gaussian-shaped function of the inter-residue distance
<disp-formula><graphic xlink:href="mst010um1"/></disp-formula>
where <italic>d<sub>ij</sub></italic> is the distance between two alpha carbons <italic>i</italic> and <italic>j</italic> in the two input structures and <italic>d</italic><sub>0</sub> is a parameter that defines tolerance in the score. The default behavior is to set <italic>d</italic><sub>0</sub> to 4 Å. The goal of ASH is to maximize the sum of e<italic><sub>ij</sub></italic> over aligned residues. The residue-level equivalences, which form the basis of all ASH alignments, provide a convenient route for combining MAFFT and ASH. We can, for example, set a threshold value of e<italic><sub>ij</sub></italic> and incorporate highly confident parts of the alignment into MAFFT to “seed” the MSA calculation. If we consider the case of the three PIN domain-containing structures in <xref ref-type="fig" rid="mst010-F4">Figure 4</xref>, we can first compute structural alignments for the three unique pairs using ASH (ash_3v33A-2qipA, ash_3v33A-1taqA, and ash_2qipA-1taqA). If we set a threshold for residue equivalence at <inline-formula><inline-graphic xlink:href="mst010i2.jpg"/></inline-formula>0.5, we can then combine the equivalence-filtered alignments into MAFFT using the seed option (<xref ref-type="bibr" rid="mst010-B19">Katoh et al. 2009</xref>):
<disp-quote content-type="extract"><p><monospace>mafft-linsi <monospace>--</monospace></monospace><monospace>seed ash_3v33A-2qipA <monospace>\ --</monospace></monospace><monospace>seed ash_3v33A-1taqA</monospace><monospace>\</monospace></p><p><monospace>--</monospace><monospace>seed ash_2qipA-1taqA \ sequences <monospace>&gt;</monospace></monospace><monospace> output</monospace></p></disp-quote>
Because the sequence identities between the aligned structures are low, we see an improvement in the resulting MSA relative to conventional MAFFT (<xref ref-type="fig" rid="mst010-F4">Fig. 4</xref>). Based on this approach, we are developing an integrative service for protein structure-informed MSA construction.</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The authors thank Drs. Wen Chen, C. André Lévesque, and Christopher Lewis, Agriculture and Agri-Food Canada, for permitting the use of the ITS data in this article and providing other challenging problems. This work was supported by <funding-source>Platform for Drug Discovery, Informatics, and Structural Life Science from the Ministry of Education, Culture, Sports, Science and Technology, Japan</funding-source>, and the <funding-source>Computational Biology Research Center, National Institute of Advanced Industrial Science and Technology (AIST), Japan</funding-source>.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="mst010-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
        </person-group>
        <article-title>Generalized affine gap costs for protein sequence alignment</article-title>
        <source>Proteins</source>
        <year>1998</year>
        <volume>32</volume>
        <fpage>88</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="pmid">9672045</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barton</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Sternberg</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>A strategy for the rapid multiple alignment of protein sequences. Confidence levels from tertiary structure comparisons</article-title>
        <source>J Mol Biol.</source>
        <year>1987</year>
        <volume>198</volume>
        <fpage>327</fpage>
        <lpage>337</lpage>
        <pub-id pub-id-type="pmid">3430611</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berger</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Munson</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>A novel randomized iterative strategy for aligning multiple protein sequences</article-title>
        <source>Comput Appl Biosci.</source>
        <year>1991</year>
        <volume>7</volume>
        <fpage>479</fpage>
        <lpage>484</lpage>
        <pub-id pub-id-type="pmid">1747779</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berger</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Aligning short reads to reference alignments and trees</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2068</fpage>
        <lpage>2075</lpage>
        <pub-id pub-id-type="pmid">21636595</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blackburne</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Whelan</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Class of multiple sequence alignment algorithm affects genomic analysis</article-title>
        <source>Mol Biol Evol.</source>
        <year>2012a</year>
        <comment>Advance access published December 4, 2012, doi:10.1093/molbev/mss256</comment>
      </element-citation>
    </ref>
    <ref id="mst010-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blackburne</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Whelan</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Measuring the distance between multiple sequence alignments</article-title>
        <source>Bioinformatics</source>
        <year>2012b</year>
        <volume>28</volume>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="pmid">22199391</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cannone</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Subramanian</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schnare</surname>
            <given-names>MN</given-names>
          </name>
          <etal/>
          <collab>(14 co-authors)</collab>
        </person-group>
        <article-title>The comparative RNA web (CRW) site: an online database of comparative sequence and structure information for ribosomal, intron, and other RNAs</article-title>
        <source>BMC Bioinformatics</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>2</fpage>
        <pub-id pub-id-type="pmid">11869452</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cole</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Cardenas</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
          <collab>(11 co-authors)</collab>
        </person-group>
        <article-title>The ribosomal database project: improved alignments and new tools for rRNA analysis</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>D141</fpage>
        <lpage>D145</lpage>
        <pub-id pub-id-type="pmid">19004872</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dessimoz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gil</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic assessment of alignments reveals neglected tree signal in gaps</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R37</fpage>
        <pub-id pub-id-type="pmid">20370897</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Doolittle</surname>
            <given-names>RF</given-names>
          </name>
        </person-group>
        <article-title>Progressive sequence alignment as a prerequisite to correct phylogenetic trees</article-title>
        <source>J Mol Evol.</source>
        <year>1987</year>
        <volume>25</volume>
        <fpage>351</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="pmid">3118049</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fletcher</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>INDELible: a flexible simulator of biological sequence evolution</article-title>
        <source>Mol Biol Evol.</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>1879</fpage>
        <lpage>1888</lpage>
        <pub-id pub-id-type="pmid">19423664</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Golubchik</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wise</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Easteal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jermiin</surname>
            <given-names>LS</given-names>
          </name>
        </person-group>
        <article-title>Mind the gaps: evidence of bias in estimates of multiple sequence alignments</article-title>
        <source>Mol Biol Evol.</source>
        <year>2007</year>
        <volume>24</volume>
        <fpage>2433</fpage>
        <lpage>2442</lpage>
        <pub-id pub-id-type="pmid">17709332</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gotoh</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Optimal alignment between groups of sequences and its application to multiple sequence alignment</article-title>
        <source>Comput Appl Biosci.</source>
        <year>1993</year>
        <volume>9</volume>
        <fpage>361</fpage>
        <lpage>370</lpage>
        <pub-id pub-id-type="pmid">8324637</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gotoh</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>A weighting system and algorithm for aligning many phylogenetically related sequences</article-title>
        <source>Comput Appl Biosci.</source>
        <year>1995</year>
        <volume>11</volume>
        <fpage>543</fpage>
        <lpage>551</lpage>
        <pub-id pub-id-type="pmid">8590178</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henikoff</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Henikoff</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>Amino acid substitution matrices from protein blocks</article-title>
        <source>Proc Natl Acad Sci U S A.</source>
        <year>1992</year>
        <volume>89</volume>
        <fpage>10915</fpage>
        <lpage>10919</lpage>
        <pub-id pub-id-type="pmid">1438297</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Sharp</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>CLUSTAL: a package for performing multiple sequence alignment on a microcomputer</article-title>
        <source>Gene</source>
        <year>1988</year>
        <volume>73</volume>
        <fpage>237</fpage>
        <lpage>244</lpage>
        <pub-id pub-id-type="pmid">3243435</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>The rapid generation of mutation data matrices from protein sequences</article-title>
        <source>Comput Appl Biosci.</source>
        <year>1992</year>
        <volume>8</volume>
        <fpage>275</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="pmid">1633570</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>A mutation data matrix for transmembrane proteins</article-title>
        <source>FEBS Lett.</source>
        <year>1994</year>
        <volume>339</volume>
        <fpage>269</fpage>
        <lpage>275</lpage>
        <pub-id pub-id-type="pmid">8112466</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Asimenos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Multiple alignment of DNA sequences with MAFFT</article-title>
        <source>Methods Mol Biol.</source>
        <year>2009</year>
        <volume>537</volume>
        <fpage>39</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="pmid">19378139</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Adding unaligned sequences into an existing alignment using MAFFT and LAST</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>3144</fpage>
        <lpage>3146</lpage>
        <pub-id pub-id-type="pmid">23023983</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kuma</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Miyata</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>MAFFT version 5: improvement in accuracy of multiple sequence alignment</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>511</fpage>
        <lpage>518</lpage>
        <pub-id pub-id-type="pmid">15661851</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Misawa</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kuma</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Miyata</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>3059</fpage>
        <lpage>3066</lpage>
        <pub-id pub-id-type="pmid">12136088</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Standley</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>MAFFT: iterative refinement and additional methods</article-title>
        <source>Methods Mol Biol.</source>
        <year>Forthcoming 2013</year>
      </element-citation>
    </ref>
    <ref id="mst010-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>PartTree: An algorithm to build an approximate tree from a large number of unaligned sequences</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>372</fpage>
        <lpage>374</lpage>
        <pub-id pub-id-type="pmid">17118958</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Improved accuracy of multiple ncRNA alignment by incorporating structural information into a MAFFT-based framework</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008a</year>
        <volume>9</volume>
        <fpage>212</fpage>
        <pub-id pub-id-type="pmid">18439255</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Recent developments in the MAFFT multiple sequence alignment program</article-title>
        <source>Brief Bioinform.</source>
        <year>2008b</year>
        <volume>9</volume>
        <fpage>286</fpage>
        <lpage>298</lpage>
        <pub-id pub-id-type="pmid">18372315</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Parallelization of the MAFFT multiple sequence alignment program</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1899</fpage>
        <lpage>1900</lpage>
        <pub-id pub-id-type="pmid">20427515</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiełbasa</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Horton</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Adaptive seeds tame genomic sequence comparison</article-title>
        <source>Genome Res.</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>487</fpage>
        <lpage>493</lpage>
        <pub-id pub-id-type="pmid">21209072</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letsch</surname>
            <given-names>HO</given-names>
          </name>
          <name>
            <surname>Kuck</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stocsits</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Misof</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>The impact of rRNA secondary structure consideration in alignment and tree reconstruction: simulated data and a case study on the phylogeny of hexapods</article-title>
        <source>Mol Biol Evol.</source>
        <year>2010</year>
        <volume>27</volume>
        <fpage>2507</fpage>
        <lpage>2521</lpage>
        <pub-id pub-id-type="pmid">20530152</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Löytynoja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vilella</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Accurate extension of multiple sequence alignments using a phylogeny-aware graph algorithm</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1684</fpage>
        <lpage>1691</lpage>
        <pub-id pub-id-type="pmid">22531217</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matsen</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Kodner</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Armbrust</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>pplacer: linear time maximum-likelihood and Bayesian phylogenetic placement of sequences onto a fixed reference tree</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>538</fpage>
        <pub-id pub-id-type="pmid">21034504</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>SEPP: SATé-enabled phylogenetic placement</article-title>
        <source>Pac Symp Biocomput.</source>
        <year>2012</year>
        <volume>17</volume>
        <fpage>247</fpage>
        <lpage>258</lpage>
        <pub-id pub-id-type="pmid">22174280</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B48">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nilsson</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Veldre</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Unterseher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Amend</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bergsten</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kristiansson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ryberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jumpponen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Abarenkov</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>An open source software package for automated extraction of ITS1 and ITS2 from fungal ITS sequences for use in high-throughput community assays and molecular ecology</article-title>
        <source>Fungal Ecology</source>
        <year>2010</year>
        <volume>3</volume>
        <fpage>284</fpage>
        <lpage>287</lpage>
      </element-citation>
    </ref>
    <ref id="mst010-B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Holm</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>COFFEE: an objective function for multiple sequence alignments</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>407</fpage>
        <lpage>422</lpage>
        <pub-id pub-id-type="pmid">9682054</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nuin</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Tillier</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <article-title>The accuracy of several multiple sequence alignment programs for proteins</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>471</fpage>
        <pub-id pub-id-type="pmid">17062146</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Sullivan</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Suhre</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Abergel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>3DCoffee: combining protein sequences and structures within multiple sequence alignments</article-title>
        <source>J Mol Biol.</source>
        <year>2004</year>
        <volume>340</volume>
        <fpage>385</fpage>
        <lpage>395</lpage>
        <pub-id pub-id-type="pmid">15201059</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pei</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>BH</given-names>
          </name>
          <name>
            <surname>Grishin</surname>
            <given-names>NV</given-names>
          </name>
        </person-group>
        <article-title>PROMALS3D: a tool for multiple protein sequence and structure alignments</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>2295</fpage>
        <lpage>2300</lpage>
        <pub-id pub-id-type="pmid">18287115</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Punta</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Coggill</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Eberhardt</surname>
            <given-names>RY</given-names>
          </name>
          <etal/>
          <collab>(16 co-authors)</collab>
        </person-group>
        <article-title>The Pfam protein families database</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>D290</fpage>
        <lpage>D301</lpage>
        <pub-id pub-id-type="pmid">22127870</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B38">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sahraeian</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Yoon</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>PicXAA-R: efficient structural alignment of multiple RNA sequences using a greedy approach</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>S38</fpage>
        <pub-id pub-id-type="pmid">21342569</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B39">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schrödinger</surname>
            <given-names>LLC</given-names>
          </name>
        </person-group>
        <article-title>The PyMOL Molecular Graphics System, Version 1.3r1. Portland</article-title>
        <year>2010</year>
        <comment>Oregon: Schrödinger, LLC</comment>
      </element-citation>
    </ref>
    <ref id="mst010-B40">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sievers</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dineen</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
          <collab>(12 co-authors)</collab>
        </person-group>
        <article-title>Fast scalable generation of high-quality protein multiple sequence alignments using Clustal Omega</article-title>
        <source>Mol Syst Biol.</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>539</fpage>
        <pub-id pub-id-type="pmid">21988835</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B41">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sigrist</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Cerutti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>de Castro</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Langendijk-Genevaux</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Bulliard</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bairoch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hulo</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>PROSITE, a protein domain database for functional characterization and annotation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>D161</fpage>
        <lpage>D166</lpage>
        <pub-id pub-id-type="pmid">19858104</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B42">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Standley</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Ash structure alignment package: sensitivity and selectivity in domain classification</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>116</fpage>
        <pub-id pub-id-type="pmid">17407606</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B43">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Standley</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Detecting local structural similarity in proteins by maximizing number of equivalent residues</article-title>
        <source>Proteins</source>
        <year>2004</year>
        <volume>57</volume>
        <fpage>381</fpage>
        <lpage>391</lpage>
        <pub-id pub-id-type="pmid">15340925</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B44">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Buhler</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>PhyLAT: a phylogenetic local alignment tool</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1336</fpage>
        <lpage>1344</lpage>
        <pub-id pub-id-type="pmid">22492645</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B45">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tabei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kiryu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Asai</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A fast structural multiple alignment method for long RNA sequences</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>33</fpage>
        <pub-id pub-id-type="pmid">18215258</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B46">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1994</year>
        <volume>22</volume>
        <fpage>4673</fpage>
        <lpage>4680</lpage>
        <pub-id pub-id-type="pmid">7984417</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B47">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waterhouse</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Procter</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Clamp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barton</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>Jalview version 2—a multiple sequence alignment editor and analysis workbench</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1189</fpage>
        <lpage>1191</lpage>
        <pub-id pub-id-type="pmid">19151095</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol. Biol. Evol</journal-id>
    <journal-id journal-id-type="publisher-id">molbev</journal-id>
    <journal-id journal-id-type="hwp">molbiolevol</journal-id>
    <journal-title-group>
      <journal-title>Molecular Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0737-4038</issn>
    <issn pub-type="epub">1537-1719</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3603318</article-id>
    <article-id pub-id-type="doi">10.1093/molbev/mst010</article-id>
    <article-id pub-id-type="publisher-id">mst010</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Fast Tracks</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MAFFT Multiple Sequence Alignment Software Version 7: Improvements in Performance and Usability</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Katoh</surname>
          <given-names>Kazutaka</given-names>
        </name>
        <xref ref-type="corresp" rid="mst010-COR1">*</xref>
        <xref ref-type="aff" rid="mst010-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="mst010-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Standley</surname>
          <given-names>Daron M.</given-names>
        </name>
        <xref ref-type="aff" rid="mst010-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="mst010-AFF1"><sup>1</sup>Immunology Frontier Research Center, Osaka University, Suita, Osaka, Japan</aff>
    <aff id="mst010-AFF2"><sup>2</sup>Computational Biology Research Center, The National Institute of Advanced Industrial Science and Technology (AIST), Tokyo, Japan</aff>
    <author-notes>
      <corresp id="mst010-COR1"><bold>*Corresponding author:</bold> E-mail: <email>kazutaka.katoh@aist.go.jp</email>.</corresp>
      <fn>
        <p><bold>Associate editor:</bold> Sudhir Kumar</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>4</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>1</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>1</month>
      <year>2013</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>4</issue>
    <fpage>772</fpage>
    <lpage>780</lpage>
    <permissions>
      <copyright-statement>© The Author 2013. Published by Oxford University Press on behalf of the Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>We report a major update of the MAFFT multiple sequence alignment program. This version has several new features, including options for adding unaligned sequences into an existing alignment, adjustment of direction in nucleotide alignment, constrained alignment and parallel processing, which were implemented after the previous major update. This report shows actual examples to explain how these features work, alone and in combination. Some examples incorrectly aligned by MAFFT are also shown to clarify its limitations. We discuss how to avoid misalignments, and our ongoing efforts to overcome such limitations.</p>
    </abstract>
    <kwd-group>
      <kwd>multiple sequence alignment</kwd>
      <kwd>metagemone</kwd>
      <kwd>protein structure</kwd>
      <kwd>progressive alignment</kwd>
      <kwd>parallel processing</kwd>
    </kwd-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>Introduction</title>
    <p>Multiple sequence alignment (MSA) plays an important role in evolutionary analyses of biological sequences. MAFFT is an MSA program, first released in 2002 (<xref ref-type="bibr" rid="mst010-B22">Katoh et al. 2002</xref>). Because of its high performance (<xref ref-type="bibr" rid="mst010-B34">Nuin et al. 2006</xref>; <xref ref-type="bibr" rid="mst010-B12">Golubchik et al. 2007</xref>; <xref ref-type="bibr" rid="mst010-B9">Dessimoz and Gil 2010</xref>; <xref ref-type="bibr" rid="mst010-B29">Letsch et al. 2010</xref>; <xref ref-type="bibr" rid="mst010-B38">Sahraeian and Yoon 2011</xref>; <xref ref-type="bibr" rid="mst010-B40">Sievers et al. 2011</xref>), MAFFT is becoming popular in recent years. After reviewing the previous version (version 6) in <xref ref-type="bibr" rid="mst010-B26">Katoh and Toh (2008b)</xref>, we have been continuously improving its accuracy, speed, and utility in practical situations. These improvements and techniques were mostly reported in individual papers (<xref ref-type="bibr" rid="mst010-B19">Katoh et al. 2009</xref>; <xref ref-type="bibr" rid="mst010-B27">Katoh and Toh 2010</xref>; <xref ref-type="bibr" rid="mst010-B20">Katoh and Frith 2012</xref>; <xref ref-type="bibr" rid="mst010-B23">Katoh and Standley 2013</xref>). In this report, we demonstrate the different kinds of analyses that can be achieved with the new features, alone and in combination, using realistic examples. We also discuss limitations of current version by giving examples of sequences incorrectly aligned by MAFFT, and describe our ongoing efforts to overcome these limitations.</p>
  </sec>
  <sec>
    <title>Basic Concepts and Usage</title>
    <p>As listed in <xref ref-type="table" rid="mst010-T1">table 1</xref>, MAFFT version 7 has options for various alignment strategies, including progressive methods (PartTree, FFT-NS-1, and L-INS-1) (<xref ref-type="bibr" rid="mst010-B10">Feng and Doolittle 1987</xref>; <xref ref-type="bibr" rid="mst010-B16">Higgins and Sharp 1988</xref>; <xref ref-type="bibr" rid="mst010-B24">Katoh and Toh 2007</xref>), iterative refinement methods (FFT-NS-i, L-INS-i, E-INS-i, and G-INS-i) (<xref ref-type="bibr" rid="mst010-B2">Barton and Sternberg 1987</xref>; <xref ref-type="bibr" rid="mst010-B3">Berger and Munson 1991</xref>; <xref ref-type="bibr" rid="mst010-B13">Gotoh 1993</xref>; <xref ref-type="bibr" rid="mst010-B21">Katoh et al. 2005</xref>), and structural alignment methods for RNAs (Q-INS-i and X-INS-i; <xref ref-type="bibr" rid="mst010-B25">Katoh and Toh 2008a</xref>). See <xref ref-type="bibr" rid="mst010-B26">Katoh and Toh (2008b)</xref> for details of these strategies. According to a recent comparative study based on the MetAl metric (<xref ref-type="bibr" rid="mst010-B5">Blackburne and Whelan 2012a</xref>, <xref ref-type="bibr" rid="mst010-B6">2012b</xref>), there are two significantly different classes of MSA methods, similarity-based methods and evolution-based methods. MAFFT is classified as a similarity-based method. However, evolutionary information is useful even for similarity-based methods, because the sequences to be aligned are generated from a common ancestor in the course of evolution. In this respect, MAFFT takes evolutionary information into account.
<table-wrap id="mst010-T1" position="float"><label>Table 1.</label><caption><p>Options of MAFFT Version 7.</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Option name</th><th rowspan="1" colspan="1">Command</th><th rowspan="1" colspan="1"/></tr></thead><tbody align="left"><tr><td colspan="3" rowspan="1">For a large-scale alignment: progressive methods with the PartTree algorithm<hr/></td></tr><tr><td rowspan="1" colspan="1">    NW-NS-PartTree1</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>parttree </monospace><monospace>––</monospace><monospace>retree 1 input</monospace></td><td align="left" rowspan="1" colspan="1">Distance is by the 6mer method.</td></tr><tr><td rowspan="1" colspan="1">    NW-NS-PartTree2</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>parttree </monospace><monospace>––</monospace><monospace>retree 2 input</monospace></td><td align="left" rowspan="1" colspan="1">Distance is by the 6mer method. Guide tree is re-built.</td></tr><tr><td rowspan="1" colspan="1">    NW-NS-DPPartTree1</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>dpparttree </monospace><monospace>––</monospace><monospace>retree 1 input</monospace></td><td align="left" rowspan="1" colspan="1">Distance is estimated based on DP.</td></tr><tr><td rowspan="1" colspan="1">    NW-NS-DPPartTree2</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>dpparttree </monospace><monospace>––</monospace><monospace>retree 2 input</monospace></td><td align="left" rowspan="1" colspan="1">Distance is estimated based on DP. Guide tree is re-built.</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">For a medium-scale alignment: progressive methods</td></tr><tr><td rowspan="1" colspan="1">    FFT-NS-1</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>retree 1 input</monospace></td><td align="left" rowspan="1" colspan="1">Approximately two times faster than the default.</td></tr><tr><td rowspan="1" colspan="1">    FFT-NS-2</td><td align="left" rowspan="1" colspan="1"><monospace>mafft input</monospace></td><td align="left" rowspan="1" colspan="1">Default.</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">For a small-scale alignment: iterative refinement methods</td></tr><tr><td rowspan="1" colspan="1">    FFT-NS-i</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>maxiterate 16 input</monospace></td><td align="left" rowspan="1" colspan="1">Fastest of the four in this category. Uses WSP score (<xref ref-type="bibr" rid="mst010-B14">Gotoh 1995</xref>) only.</td></tr><tr><td rowspan="1" colspan="1">    G-INS-i</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>maxiterate 16 </monospace><monospace>––</monospace><monospace>globalpair input</monospace></td><td align="left" rowspan="1" colspan="1">Uses WSP score and consistency (<xref ref-type="bibr" rid="mst010-B33">Notredame et al. 1998</xref>) score from global alignments.</td></tr><tr><td rowspan="1" colspan="1">    L-INS-i</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>maxiterate 16 </monospace><monospace>––</monospace><monospace>localpair input</monospace></td><td align="left" rowspan="1" colspan="1">Uses WSP score and consistency score from local alignments.</td></tr><tr><td rowspan="1" colspan="1">    E-INS-i</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>maxiterate 16 </monospace><monospace>––</monospace><monospace>genafpair input</monospace></td><td align="left" rowspan="1" colspan="1">Uses WSP score and consistency score from local alignments with a generalized affine gap cost (<xref ref-type="bibr" rid="mst010-B1">Altschul 1998</xref>).</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">If not sure which option to use</td></tr><tr><td rowspan="1" colspan="1">    Automatic</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>auto</monospace></td><td align="left" rowspan="1" colspan="1">Selects an appropriate option from FFT-NS-2, FFT-NS-i and L-INS-i, according to the size of input data.</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">For a small-scale RNA alignment: structural alignment methods</td></tr><tr><td rowspan="1" colspan="1">    Q-INS-i</td><td align="left" rowspan="1" colspan="1"><monospace>mafft-qinsi input</monospace></td><td align="left" rowspan="1" colspan="1">Structure information is included in iterative refinement step.</td></tr><tr><td rowspan="1" colspan="1">    X-INS-i-scarnapair</td><td align="left" rowspan="1" colspan="1"><monospace>mafft-xinsi </monospace><monospace>––</monospace><monospace>scarnapair input</monospace></td><td align="left" rowspan="1" colspan="1">Uses pairwise structural alignment by MXSCARNA (<xref ref-type="bibr" rid="mst010-B45">Tabei et al. 2008</xref>).</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">To add new sequences into an existing MSA</td></tr><tr><td rowspan="1" colspan="1">    Add</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>add mew msa</monospace></td><td align="left" rowspan="1" colspan="1">The simplest option for alignment extension.</td></tr><tr><td rowspan="1" colspan="1">    Addprofile</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>addprofile msa1 </monospace><monospace>msa2</monospace></td><td align="left" rowspan="1" colspan="1">msa1 must form a monophyletic cluster.</td></tr><tr><td rowspan="1" colspan="1">    Addfragments</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>addfragments new msa</monospace></td><td align="left" rowspan="1" colspan="1">Suitable for short new sequences.</td></tr><tr><td rowspan="1" colspan="1">    Addfragments, LAST</td><td align="left" rowspan="1" colspan="1"><monospace>mafft ––addfragments new </monospace><monospace>––</monospace><monospace>lastmultipair msa</monospace></td><td align="left" rowspan="1" colspan="1">Faster option, LAST (<xref ref-type="bibr" rid="mst010-B28">Kiełbasa et al. 2011</xref>) is required.</td></tr><tr><td rowspan="1" colspan="1">    Addfragments, 6mer</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>addfragments new </monospace><monospace>––</monospace><monospace>6merpair msa</monospace></td><td align="left" rowspan="1" colspan="1">Faster option for conserved data.</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">Parameters</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>bl #, </monospace><monospace>––</monospace><monospace>jtt #, </monospace><monospace>––</monospace><monospace>tm #</monospace></td><td align="left" rowspan="1" colspan="1">Score matrices for protein alignment.</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>kimura #</monospace></td><td align="left" rowspan="1" colspan="1">Score matrix for nucleotide alignment.</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">Utility options</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>anysymbol</monospace></td><td rowspan="11" align="left" colspan="1">See main text.</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>reorder</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>clustalout</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>phylipout</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>namelength #</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>adjustdirection</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>adjustdirectionaccurately</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>seed msa1 –seed msa2</monospace><monospace> …</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>treein treefile</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>treeout</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>thread #</monospace></td></tr></tbody></table><table-wrap-foot><fn id="mst010-TF1"><p>N<sc>ote</sc>.—<bold>N, the number of sequences; L, the sequence length; <monospace><bold>input, new</bold></monospace>, unaligned sequences in the multi-fasta format; <monospace><bold>msa, msa1, msa2</bold></monospace>, aligned sequences in the multi-fasta format; <monospace><bold>treefile</bold></monospace>, input guide tree file.</bold></p></fn></table-wrap-foot></table-wrap></p>
    <p>All the options of MAFFT assume that the input sequences are all homologous, that is, descended from a common ancestor. Thus, all the letters in the input data are aligned. Genomic rearrangement or domain shuffling is not assumed, and thus the order of the letters in each sequence is always preserved, although the sequences can be reordered according to similarity. Most options in MAFFT assume that almost all the pairs in the input sequences can be aligned, locally or globally. In such a situation, there is a tradeoff between accuracy and speed. For example, the PartTree option (<xref ref-type="bibr" rid="mst010-B24">Katoh and Toh 2007</xref>) is a fast and rough method, whereas L-INS-i and G-INS-i are slower and more accurate. RNA structural alignment methods are generally more accurate and computationally more expensive because they need additional calculations (<xref ref-type="bibr" rid="mst010-B25">Katoh and Toh 2008a</xref>). However, this tradeoff does not always hold. In particular, the new options to add sequences into an existing alignment (<xref ref-type="bibr" rid="mst010-B20">Katoh and Frith 2012</xref>), requires careful consideration of this tradeoff, as discussed later.</p>
  </sec>
  <sec>
    <title>Profile Alignments</title>
    <p>MAFFT has a subprogram, <monospace>mafft-profile</monospace>, to align two existing alignments.
<disp-quote content-type="extract"><p><monospace>mafft-profile alignment1 alignment2 </monospace><monospace>&gt;</monospace><monospace> output</monospace></p></disp-quote>
This method separately converts <monospace>alignment1</monospace> and <monospace>alignment2</monospace> to profiles and then aligns the two profiles. It means that the two input alignments are assumed to be phylogenetically isolated from each other, like <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>A</italic>. Careless application of this method results in serious misalignments, as discussed in later section.
<fig id="mst010-F1" position="float"><label><bold>F<sc>ig</sc>. 1</bold>.</label><caption><p>Assumptions on the phylogenetic relationship in different options of MAFFT. (<italic>A</italic>) <monospace>mafft-profile</monospace>, (<italic>B</italic>) <monospace>––</monospace><monospace>addprofile</monospace>, (<italic>C</italic>), misuse of <monospace>mafft-profile</monospace>, and (<italic>D</italic>) <monospace>––</monospace><monospace>add</monospace> or <monospace>––</monospace><monospace>addprofile</monospace>.</p></caption><graphic xlink:href="mst010f1p"/></fig></p>
    <p>MAFFT version 7 has an alternative option, <monospace>––</monospace><monospace>addprofile</monospace>, which is safer against misuses.
<disp-quote content-type="extract"><p><monospace>mafft <monospace>--</monospace></monospace><monospace>addprofile alignment1 alignment2 </monospace><monospace>&gt;</monospace><monospace> output</monospace></p></disp-quote>
This option accepts two existing alignments, <monospace>alignment1</monospace> and <monospace>alignment2</monospace>, and assumes a phylogenetic relationship shown in <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>B</italic>. That is, <monospace>alignment1</monospace> is assumed to form a monophyletic cluster, but <monospace>alignment2</monospace> is not assumed to form a monophyletic cluster. The cluster of <monospace>alignment1</monospace> can be placed in any phylogenetic position in the tree of <monospace>alignment2</monospace>. Moreover, this option checks whether <monospace>alignment1</monospace> forms a monophyletic cluster. If not, it returns an error message and asks user to use the <monospace>––</monospace><monospace>add</monospace> option (see the following section).</p>
  </sec>
  <sec>
    <title>Adding Unaligned Sequences into an MSA</title>
    <p>As a result of advances in sequencing technologies, we increasingly need MSAs consisting of a larger number of sequences. There are several different approaches to enable construction of large MSAs, such as rapid algorithms and parallelization. Here, we describe an alternate approach: use of an existing alignment. There already exist databases of carefully aligned and annotated sequences (<xref ref-type="bibr" rid="mst010-B8">Cole et al. 2009</xref>; <xref ref-type="bibr" rid="mst010-B41">Sigrist et al. 2010</xref>; <xref ref-type="bibr" rid="mst010-B37">Punta et al. 2012</xref>), in which each MSA consists of a small number (typically up to ∼1,000) of sequences. We can use such MSAs as a backbone to build a larger MSA containing newly sequenced data. This is more efficient than rebuilding the entire MSA from a set of ungapped sequences. Moreover, this approach is relatively robust to low-quality sequences resulting from sequencing errors, misassemblies, and other factors. Such noise usually has a negative effect on the quality of an MSA, but there are situations where biologically important information is contained in low-quality sequences. In such a case, we first select highly reliable sequences to build a backbone MSA, and then add the other sequences, including low-quality ones, into the MSA. As a result, the quality of the final MSA is less affected by the low-quality sequences.</p>
    <sec>
      <title>Inappropriate Applications of Profile Alignment</title>
      <p>The <monospace>mafft-profile</monospace> program is not useful for this purpose. There are two types of misapplications. One is as follows: 1) convert an existing alignment to a profile, 2) align new sequences and convert them to a profile, and 3) align the two profiles. This procedure is inappropriate for adding new sequences because it assumes a phylogenetic relationship as illustrated in <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>A</italic>.</p>
      <p>Another misapplication is as follows: 1) convert the existing alignment to a profile, <italic>2</italic>) separately align each new sequence to the profile of the existing alignment, and 3) construct a full alignment from the individual alignments computed in the previous step. This approach is more reasonable than the first one but still problematic, because the phylogenetic positions of new sequences are assumed at the root of the tree, as illustrated in <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>C</italic>. Results of this procedure for two cases are shown in <xref ref-type="table" rid="mst010-T2">table 2</xref> and <xref ref-type="fig" rid="mst010-F2">figure 2</xref>.
<fig id="mst010-F2" position="float"><label>F<sc>ig</sc>. 2.</label><caption><p>ITS alignments by different options of MAFFT, displayed on Jalview (<xref ref-type="bibr" rid="mst010-B47">Waterhouse et al. 2009</xref>). (<italic>A</italic>, <italic>B</italic>) Incorrect alignments by the FFT-NS-2 and L-INS-i algorithms, respectively. (<italic>C</italic>) An incorrect alignment by <monospace>mafft-profile</monospace>. The full-length sequences were aligned with the L-INS-i algorithm and then each new sequence was separately added to the full-length alignment, using <monospace>mafft-profile</monospace>. (<italic>D</italic>) Reasonable alignment by a two-step strategy. The <monospace>––</monospace><monospace>6merpair </monospace><monospace>––</monospace><monospace>addfragments</monospace> option was used at the second step. (<italic>E</italic>) Reordered version of D; sequences are ordered such that similar sequences are placed closely. All calculations were performed using 16 cores on a Linux PC with 2.67 GHz Intel Xeon E7-8837/256 GB RAM.</p></caption><graphic xlink:href="mst010f2p"/></fig>
<table-wrap id="mst010-T2" position="float"><label><bold>Table 2</bold>.</label><caption><p>Comparison of Different Options Using the 16S.B.ALL Data Set (<xref ref-type="bibr" rid="mst010-B32">Mirarab et al. 2012</xref>).</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Data</th><th rowspan="1" colspan="1">Method</th><th rowspan="1" colspan="1">Accuracy</th><th rowspan="1" colspan="1">CPU Time</th><th rowspan="1" colspan="1">Actual Time<xref ref-type="table-fn" rid="mst010-TF1"><sup>a</sup></xref></th></tr></thead><tbody align="left"><tr><td rowspan="5" colspan="1">Case 1</td><td align="left" rowspan="1" colspan="1"><monospace>mafft ––multipair ––addfragments frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9969</td><td align="left" rowspan="1" colspan="1">6.67 days</td><td align="left" rowspan="1" colspan="1">18.3 h</td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>mafft ––6merpair ––addfragments frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9949</td><td align="left" rowspan="1" colspan="1">3.76 h</td><td align="left" rowspan="1" colspan="1">36.2 min</td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>mafft ––localpair ––add  frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9707</td><td align="left" rowspan="1" colspan="1">23.4 days<xref ref-type="table-fn" rid="mst010-TF2"><sup>b</sup></xref></td><td align="left" rowspan="1" colspan="1">2.43 days<xref ref-type="table-fn" rid="mst010-TF2"><sup>b</sup></xref></td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>mafft ––6merpair ––add frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9604</td><td align="left" rowspan="1" colspan="1">1.32 h</td><td align="left" rowspan="1" colspan="1">1.44 h</td></tr><tr><td align="left" rowspan="1" colspan="1">profile alignment</td><td align="left" rowspan="1" colspan="1">0.2779</td><td align="left" rowspan="1" colspan="1">15.5 h</td><td align="left" rowspan="1" colspan="1">1.60 h</td></tr><tr><td colspan="5" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1">Case 2</td><td align="left" rowspan="1" colspan="1"><monospace>mafft ––6merpair ––addfragments frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9969</td><td align="left" rowspan="1" colspan="1">4.54 h</td><td align="left" rowspan="1" colspan="1">33.8 min</td></tr><tr><td colspan="5" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1">Case 3</td><td align="left" rowspan="1" colspan="1"><monospace>mafft ––6merpair ––addfragments frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9949</td><td align="left" rowspan="1" colspan="1">1.79 days</td><td align="left" rowspan="1" colspan="1">5.91 h</td></tr></tbody></table><table-wrap-foot><fn id="mst010-TF2"><p>N<sc>ote</sc>.—The estimated alignments were compared with the CRW alignment to measure the accuracy (the number of correctly aligned letters/the number of aligned letters in the CRW alignment). Calculations were performed on a Linux PC with 2.67 GHz Intel Xeon E7-8837/256 GB RAM (for the case marked with superscript alphabet “b”), or on a Linux PC with 3.47 GHz Intel Xeon X5690/48 GB RAM (for the other cases). Case 1: 13,822 sequences in the existing alignment × 13,821 fragments; Case 2: 1,000 sequences in the existing alignment × 138,210 fragments; Case 3: 13,822 sequences in the existing alignment × 138,210 fragments.</p></fn><fn id="mst010-TF3"><p><sup>a</sup>Wall-clock time with 10 cores. Command-line argument for parallel processing is <monospace>––thread 10</monospace>.</p></fn><fn id="mst010-TF4"><p><sup>b</sup>Full command-line options are as follows: <monospace>mafft ––localpair ––weighti 0 ––add frags existingmsa</monospace>.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec>
      <title>The <monospace>––</monospace><monospace>a</monospace><monospace>dd</monospace> and <monospace>––</monospace><monospace>a</monospace><monospace>ddfragments</monospace> Options</title>
      <p>To overcome this limitation of profile alignment, in 2010, we implemented an option, <monospace>––</monospace><monospace>add</monospace>, to add unaligned sequences to an existing MSA. This option assumes that each new sequence was derived from a branch in the tree of an existing alignment, as illustrated in <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>D</italic>. This option works almost identically to the standard progressive method, except that the alignment calculation is skipped at the nodes whose children are all in the existing alignment.</p>
      <p>Along with popularization of second-generation sequencers, we sometimes need to align short reads to an existing alignment. Several tools (<xref ref-type="bibr" rid="mst010-B4">Berger and Stamatakis 2011</xref>; <xref ref-type="bibr" rid="mst010-B30">Löytynoja et al. 2012</xref>; <xref ref-type="bibr" rid="mst010-B44">Sun and Buhler 2012</xref>) for this purpose were developed between 2011 and 2012. A limitation of the <monospace>––</monospace><monospace>add</monospace> option in MAFFT for this purpose was pointed out in <xref ref-type="bibr" rid="mst010-B30">Löytynoja et al. (2012)</xref>. Thus, we implemented a new option, <monospace>––</monospace><monospace>addfragments</monospace>, which does not consider the relationship among the sequences to be added. Details of the <monospace>––</monospace><monospace>add</monospace> and <monospace>––</monospace><monospace>addfragments</monospace> options are described in <xref ref-type="bibr" rid="mst010-B20">Katoh and Frith (2012)</xref>.</p>
    </sec>
    <sec sec-type="cases">
      <title>Test Case 1: Fungal Internal Transcribed Spacers Sequences</title>
      <p>Here, we discuss how the <monospace>––</monospace><monospace>addfragments</monospace> option works, using an actual case. Internal transcribed spacers (ITSs) are spacer regions located between structural ribosomal RNAs. The structure of the rDNA region in a eukaryotic genome is 18S − ITS1 − 5.8S − ITS2 − 28S. Here, we use a data set consisting of ITS1 and ITS2 sequences obtained from environmental samples (Chen W, personal communication). Each sequence has either ITS1 or ITS2 region only, extracted from 454 pyrosequencing data using FungalITSextractor (<xref ref-type="bibr" rid="mst010-B48">Nilsson et al. 2010</xref>). In addition, several fungal genomic sequences that fully cover ITS1 + 5.8S rRNA + ITS2 are available from public databases.</p>
      <p>Suppose a situation where we need an MSA of approximately 300 full-length sequences and approximately 5,000 ITS1 or ITS2 sequences. One possible solution is to build an entire MSA at once. The result of the default option (FFT-NS-2) of MAFFT is obviously incorrect, as shown in <xref ref-type="fig" rid="mst010-F2">figure 2</xref><italic>A</italic>. ITS1 and ITS2 regions are forced to be aligned to each other. Even if a more computationally expensive (and usually more accurate) method, L-INS-i, is applied (CPU time = 98 h), the alignment is still obviously incorrect (<xref ref-type="fig" rid="mst010-F2">fig. 2</xref><italic>B</italic>).</p>
      <p>Two-step strategies can solve this type of problem. That is, a set of full-length sequences taken from databases are first aligned to build a backbone MSA, and then the new ITS1 and ITS2 sequences are added into this backbone MSA, using the <monospace>––</monospace><monospace>addfragments</monospace> option.
<disp-quote content-type="extract"><p>Step 1: <monospace>mafft <monospace>--</monospace></monospace><monospace>auto full_length_sequences &gt;\ backbone_msa</monospace></p><p>Step 2: <monospace>mafft <monospace>--</monospace></monospace><monospace>addfragments \ new_sequences backbone_msa &gt; output</monospace></p></disp-quote>
The second command is equivalent to
<disp-quote content-type="extract"><p><monospace>mafft <monospace>--</monospace></monospace><monospace>multipair <monospace>--</monospace></monospace><monospace>addfragments \ new_sequences backbone_msa &gt; output</monospace></p></disp-quote>
in which Dynamic Programming (DP) is used to compare the distances between every new sequence and every sequence in the backbone MSA (<monospace>––</monospace><monospace>multipair</monospace> is selected by default).
<disp-quote content-type="extract"><p><monospace>mafft <monospace>--</monospace></monospace><monospace>6merpair <monospace>--</monospace></monospace><monospace>addfragments \ new_sequences backbone_msa &gt; output</monospace></p></disp-quote>
where distances are rapidly estimated using the number of shared 6mers, instead of DP.</p>
      <p>The result of the latter option (<monospace>––</monospace><monospace>6merpair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) is shown in <xref ref-type="fig" rid="mst010-F2">fig. 2</xref><italic>D</italic> and <italic>E</italic>. The difference between <italic>D</italic> and <italic>E</italic> is just in the order of sequences; the sequences were reordered according to similarity using the <monospace>––</monospace><monospace>reorder</monospace> option in <italic>E</italic>. In this alignment, ITS1 and ITS2 are clearly separated and aligned to appropriate positions in the full-length alignment. Moreover, this strategy is computationally much less expensive (CPU time = 15 min [first step] + 1.5 min [second step]) than the full application of L-INS-i (CPU time = 98 h). The former option (<monospace>––multipair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) also returns a similar result to the latter (<monospace>––</monospace><monospace>6merpair)</monospace> but is slower (CPU time = 48.6 min [second step]).</p>
      <p>This case suggests that it is crucial to select a strategy appropriate to the problem of interest. The most time-consuming method, L-INS-i, is not always the most accurate one. The difficulty of this problem for standard approaches comes from the fact that ITS1 sequences and ITS2 sequences are not homologous to each other and most pairwise alignments are impossible. Because of these nonhomologous pairs, the distance matrix used for the guide tree calculation is not additive; the distances between ITS1 and full-length sequences and those between ITS2 and full-length sequences are close to zero, whereas the distances between ITS1 and ITS2 are quite large. In this situation, it is difficult for normal distance-based tree-building methods to give a reasonable tree. Moreover, in the alignment step, the objective function of the L-INS-i is affected by inappropriate pairwise alignment scores between ITS1 and ITS2. Such problems can be avoided by just ignoring the relationship between ITS1 and ITS2, as done in the <monospace>––</monospace><monospace>addfragments</monospace> option.</p>
      <p>In addition, a result of the second type of misuse of <monospace>mafft-profile</monospace> (discussed earlier) is shown in <xref ref-type="fig" rid="mst010-F2">figure 2</xref><italic>C</italic>. Some new sequences are correctly aligned but others are obviously incorrectly aligned (note that the order of sequences in <xref ref-type="fig" rid="mst010-F2">fig. 2</xref><italic>C</italic> is identical that in <xref ref-type="fig" rid="mst010-F2">fig. 2</xref><italic>D</italic>). These misalignments are due to an incorrect assumption on phylogenetic placement of new sequences shown in <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>C</italic>.</p>
    </sec>
    <sec sec-type="cases">
      <title>Test Case 2: Bacterial SSU rRNA</title>
      <p>Another case is the 16S.B.ALL data set by <xref ref-type="bibr" rid="mst010-B32">Mirarab et al. (2012)</xref>. It consists of an MSA of 13,822 bacterial SSU rRNA sequences, taken from the Gutell Comparative RNA Website (CRW) (<xref ref-type="bibr" rid="mst010-B7">Cannone et al. 2002</xref>) and 138,210 fragmentary sequences, which are originally included in the CRW alignment but ungapped and artificially truncated. In <xref ref-type="bibr" rid="mst010-B23">Katoh and Standley (2013)</xref>, we used a subset (13,821 fragmentary sequences) prepared by <xref ref-type="bibr" rid="mst010-B32">Mirarab et al. (2012)</xref>. In addition to this subset, here we use the full data set (138,210 fragmentary sequences), to examine the scalability. Suppose a situation where we already have a manually curated (or backbone) MSA and a newly determined set of many fragmentary sequences in a metagenomics project, and we need an entire MSA of them.</p>
      <p>The first four lines in <xref ref-type="table" rid="mst010-T2">table 2</xref> (case 1) show the performances of various options for such an analysis, with a relatively small data set (13,822 sequences in the existing alignment × 13,821 fragments). The accuracy of each resulting MSA was evaluated by comparing the MSA with the original CRW alignment. CPU time and wall-clock time for each method are also listed. As the sequences in this data set are highly conserved, the difference in accuracy between the default (<monospace>––</monospace><monospace>multipair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) and the faster option (<monospace>––</monospace><monospace>6merpair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) is small.</p>
      <p>Again, the tradeoff between accuracy and speed does not hold. The application of a computationally expensive method based on L-INS-1 (<monospace>––</monospace><monospace>localpair </monospace><monospace>––</monospace><monospace>add</monospace>) has no advantage, because the extra computational time is spent on the comparison of nonoverlapping fragmentary sequences, which have no reasonable solutions.</p>
      <p>The “profile alignment” line in <xref ref-type="table" rid="mst010-T2">table 2</xref> shows results of the second type of misuse of profile alignment (discussed earlier), in which the given alignment is converted to a profile and each new sequence is separately aligned to the profile. This result clearly indicates that the application of profile alignment must be avoided in this case, too. Users do not need to be too worried about this misuse, because this calculation is disabled in MAFFT unless the user modifies the code or writes a wrapper script.</p>
      <p>The last two lines in <xref ref-type="table" rid="mst010-T2">table 2</xref> (Cases 2 and 3) show the performance of the fast option (<monospace>––</monospace><monospace>6merpair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) for a larger number (138,210) of fragmentary sequences. The number of sequences in the existing alignment is 1,000 and 13,822 in cases 2 and 3, respectively. This fast option gives a reasonable quality of result in a reasonable computing time. At present, the default option (<monospace>––</monospace><monospace>multipair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) cannot handle cases 2 and 3. Simulation-based benchmarks in <xref ref-type="bibr" rid="mst010-B20">Katoh and Frith (2012)</xref> suggested that, for cases with more divergent sequences, the accuracy of the default option is higher than that of the fast option. We are now trying to improve the scalability of the default option.</p>
    </sec>
  </sec>
  <sec>
    <title>Parallelization</title>
    <p>MAFFT version 7 has an option for parallel processing, <monospace>––</monospace><monospace>thread</monospace> (<xref ref-type="bibr" rid="mst010-B27">Katoh and Toh 2010</xref>). This feature is currently supported on Mac OS X in addition to Linux, but not yet supported on Windows for technical reasons. With the <monospace>––</monospace><monospace>thread</monospace>
<italic>n</italic> option, it runs in parallel with <italic>n</italic> threads. The number of threads can be automatically determined by <monospace>––</monospace><monospace>thread </monospace><monospace>–</monospace><monospace>1</monospace>. This option sets the number of threads as the number of physical cores, not the number of logical cores in Intel’s hyperthreaded CPUs.</p>
    <p>For progressive methods, the result with the multithread version is identical to that of the serial processing version. However, for iterative refinement methods, the results are not always identical. We confirmed that the accuracy of the parallel version in this case is comparable with that of the serial version (<xref ref-type="bibr" rid="mst010-B27">Katoh and Toh 2010</xref>). The efficiency of parallelization depends on the alignment strategy. In the case of the <monospace>––</monospace><monospace>addfragments</monospace> option, the efficiency is acceptably high as shown in <xref ref-type="table" rid="mst010-T2">table 2</xref>.</p>
  </sec>
  <sec>
    <title>Utility Options</title>
    <p>MAFFT version 7 also has several enhanced options for peripheral functions.</p>
    <sec>
      <title>Estimating the Direction of DNA Sequences</title>
      <p>In the case of nucleotide alignments, if some of input sequences have an incorrect direction relative to the other sequences, the directions can be automatically adjusted by the <monospace>––</monospace><monospace>adjustdirection</monospace> option. We use an algorithm with a time complexity of <inline-formula><inline-graphic xlink:href="mst010i1.jpg"/></inline-formula>, where <italic>n</italic> is the number of sequences (<xref ref-type="bibr" rid="mst010-B23">Katoh and Standley 2013</xref>). It is slow when the distances are calculated with DP. However, when the distance is rapidly calculated based on the number of shared 6mers, the speed is reasonable. This option is also available on the web version, with the “Adjust direction” button.</p>
      <p>MAFFT cannot handle more complicated sequences with genomic rearrangements (translocations, duplications, or inversions). The web version of MAFFT displays dot plots between the first sequence and the remaining sequences, using the LAST local alignment program (<xref ref-type="bibr" rid="mst010-B28">Kiełbasa et al. 2011</xref>), for every nucleotide alignment run. By viewing the dot plots, a user can easily check for genomic rearrangements and the directions of input sequences. See <xref ref-type="bibr" rid="mst010-B23">Katoh and Standley (2013)</xref> for details and an example.</p>
    </sec>
    <sec>
      <title>Input/Output</title>
      <p>MAFFT version 7 has several enhancements in the flexibility of input/output. The following options related to input/output are available and can be combined with other options.
<list list-type="simple"><list-item><p><monospace>––</monospace><monospace>anysymbol</monospace> If the input data include unusual letters, like U, J, etc., (in the case of protein data), MAFFT stops by default. The <monospace>––</monospace><monospace>anysymbol</monospace> option allows these letters and nonalphabetical letters.</p></list-item><list-item><p><monospace>––</monospace><monospace>preservecase</monospace><monospace> </monospace>By default, amino acid sequences are converted to upper case and nucleotide sequences are converted to lower case. This behavior can be changed by using the <monospace>––</monospace><monospace>preservecase</monospace> option.</p></list-item><list-item><p><monospace>––</monospace><monospace>reorder</monospace><monospace> </monospace>The order of sequences is the same as the input sequences by default, but the sequences can be sorted according to similarity to each other by the <monospace>––</monospace><monospace>reorder</monospace> option.</p></list-item><list-item><p><monospace>––</monospace><monospace>phylipout</monospace><monospace>a</monospace>nd <monospace>––<monospace>clustalout</monospace></monospace><monospace> </monospace>The output format is multi-fasta by default, but the phylip (interleaved) format and the clustal format can be selected.</p></list-item></list>
</p>
    </sec>
    <sec>
      <title>Guide Tree and Phylogenetic Positions of New Sequences</title>
      <p>Users can check the guide tree by using the <monospace>––</monospace><monospace>treeout</monospace> option. In the case of <monospace>––</monospace><monospace>addfragments</monospace>, the estimated phylogenetic positions of new sequences are shown together with the estimated tree of the existing alignment. The alignment calculation is performed based on this phylogenetic estimation. It is also possible to compute such phylogenetic information only, without alignment, by the <monospace>––</monospace><monospace>retree 0</monospace> option. An example of output is shown in <xref ref-type="fig" rid="mst010-F3">Figure 3</xref><italic>A</italic>.
<fig id="mst010-F3" position="float"><label>F<sc>ig</sc>. 3.</label><caption><p>(<italic>A</italic>) A part of output of the <monospace>––</monospace><monospace>treeout</monospace> option showing the phylogenetic positions of new sequences (<monospace>new#</monospace>) in the tree of the existing alignment (<monospace>backbone#</monospace>), estimated before the alignment calculation. This file also shows a Newick format tree of the existing alignment (not shown in this figure). For each new sequence, the nearest sequence in the existing alignment (<monospace>nearest sequence</monospace>), approximate distance to the nearest sequence (<monospace>approximate distance</monospace>), and the members of the sister group (<monospace>sister group</monospace>) are shown. (<italic>B</italic>) Graphical representation of (<italic>A</italic>).</p></caption><graphic xlink:href="mst010f3p"/></fig></p>
      <p>Note that this phylogenetic information is roughly estimated <italic>before</italic> the MSA calculation, not based on the MSA. Especially, with the fast option, <monospace>––</monospace><monospace>6merpair</monospace>, the estimation is very rough. With the <monospace>––</monospace><monospace>multipair</monospace> option (default), the estimation is expected to be better, but it needs a relatively long computational time. For more rigorous estimation of phylogenetic positions of new sequences, specially designed tools, such as pplacer (<xref ref-type="bibr" rid="mst010-B31">Matsen et al. 2010</xref>), PaPaRa (<xref ref-type="bibr" rid="mst010-B4">Berger and Stamatakis 2011</xref>), PAGAN (<xref ref-type="bibr" rid="mst010-B30">Löytynoja et al. 2012</xref>), SEPP (<xref ref-type="bibr" rid="mst010-B32">Mirarab et al. 2012</xref>), or combinations of them including MAFFT, should be tried.</p>
    </sec>
  </sec>
  <sec>
    <title>Parameters</title>
    <p>For amino acid alignment, MAFFT uses the BLOSUM62 matrix by default. For nucleotide alignment, a 200PAM log-odds scoring matrix is generated assuming that the transition rate is twice the transversion rate. These matrices are suitable for aligning distantly related sequences. We selected these default parameters based on an expectation that, if the program works well for difficult (distantly related) cases, it should also work well for easy cases.</p>
    <p>It is unclear whether this expectation is always correct. For example, in a benchmark using simulated protein sequences (<xref ref-type="bibr" rid="mst010-B30">Löytynoja et al. 2012</xref>) generated by INDELiBLE (<xref ref-type="bibr" rid="mst010-B11">Fletcher and Yang 2009</xref>), when we tested a more stringent scoring matrix, JTT 1PAM (<xref ref-type="bibr" rid="mst010-B17">Jones et al. 1992</xref>) with weaker gap penalties than the default, the benchmark scores were considerably improved. Despite this observation, we consistently used the default parameters in the benchmark in <xref ref-type="bibr" rid="mst010-B20">Katoh and Frith (2012)</xref>, because it does not make sense to arbitrarily adjust parameters to a simulation setting. This observation suggests that the current default parameters of MAFFT might not be very suitable for aligning closely related sequences. However, this idea must be checked using actual biological sequences.</p>
    <p>User can select different scoring matrices other than the default. For amino acid alignment, <monospace>––</monospace><monospace>bl 45</monospace>, <monospace>––</monospace><monospace>bl 62</monospace>, <monospace>––</monospace><monospace>bl 80</monospace>, <monospace>––</monospace><monospace>jtt N</monospace>, and <monospace>––</monospace><monospace>tm N</monospace> are accepted, where <monospace>N</monospace> is an expected evolutionary distance among input sequences. The <monospace>––</monospace><monospace>bl</monospace>, <monospace>––</monospace><monospace>jtt</monospace>, and <monospace>––</monospace><monospace>tm</monospace> options mean BLOSUM (Henikoff S and Henikoff JG <xref ref-type="bibr" rid="mst010-B15">1992</xref>), JTT (<xref ref-type="bibr" rid="mst010-B17">Jones et al. 1992</xref>), and a transmembrane model (<xref ref-type="bibr" rid="mst010-B18">Jones et al. 1994</xref>), respectively. A user-defined scoring matrix can also be accepted, by <monospace>––</monospace><monospace>aamatrix</monospace>. For nucleotide alignments, <monospace>––</monospace><monospace>kimura N</monospace> is accepted, where <monospace>N</monospace> is an expected evolutionary distance among input sequences. Gap penalties can be adjusted by <monospace>––</monospace><monospace>op</monospace>, <monospace>––</monospace><monospace>exp</monospace>, <monospace>––</monospace><monospace>lop</monospace>, and <monospace>––</monospace><monospace>lexp</monospace> options.</p>
    <p>One possible extension is to use different scoring matrices and gap penalties for different sequence pairs according to the divergence level, like ClustalW (<xref ref-type="bibr" rid="mst010-B46">Thompson et al. 1994</xref>). More studies using actual sequence data will be necessary before implementing this extension. It will also be necessary to adjust gap penalties, preferably based on a realistic evolutionary model of insertions and deletions.</p>
  </sec>
  <sec>
    <title>Use of Structural Information</title>
    <p>We have discussed possible improvements in MSAs of closely related sequences in the previous section. MSA of distantly related sequences is still a challenging problem.</p>
    <sec sec-type="cases">
      <title>Test Case 3: PIN Domain</title>
      <p><xref ref-type="fig" rid="mst010-F4">Figure 4</xref> shows a typical limitation of sequence level alignment for a highly divergent set of three PIN-domain containing proteins: human regnase-1, VPA0982 from <italic>Vibrio parahaemolyticus</italic>, nuclease domain of taq polymerase from <italic>Thermus aquaticus</italic>. These three proteins share a magnesium-binding site composed of three conserved aspartic acids. <xref ref-type="fig" rid="mst010-F4">Figure 4</xref><italic>A</italic> shows a superposition of the three structures (Protein Databank identifiers 3v33, 2qip, and 1taq, respectively). The middle aspartic acid is indicated by sphere-representation, colored red. In <xref ref-type="fig" rid="mst010-F4">Figure 4</xref><italic>B</italic>, a typical MSA (by MAFFT-L-INS-i) is shown wherein the middle aspartic acid position is misaligned. In <xref ref-type="fig" rid="mst010-F4">Figure 4</xref><italic>C</italic>, a structure-informed MSA (described below), with the middle aspartic acid correctly aligned, is shown.
<fig id="mst010-F4" position="float"><label><bold>F<sc>ig</sc>. 4</bold>.</label><caption><p>(<italic>A</italic>) Superposition of 3v33, 2qip, and 1taq structures visualized by PyMOL (<xref ref-type="bibr" rid="mst010-B39">Schrödinger LLC 2010</xref>). (<italic>B</italic>) MAFFT-L-INS-i sequence alignment displayed on jalview (<xref ref-type="bibr" rid="mst010-B47">Waterhouse et al. 2009</xref>). Misaligned Ds are highlighed in red. (<italic>C</italic>) Structure-informed MSA with correctly aligned Ds; Alpha helices and beta sheets are shown in blue and yellow, respectively, in (<italic>A–C</italic>).</p></caption><graphic xlink:href="mst010f4p"/></fig></p>
    </sec>
    <sec>
      <title>Strategy for Integrating Structural Alignments and MAFFT</title>
      <p>It has long been known that structural information can be used to improve MSA calculations. This was the basis of the 3D Coffee program (<xref ref-type="bibr" rid="mst010-B35">O’Sullivan et al. 2004</xref>), and later the PROMALS3D package (<xref ref-type="bibr" rid="mst010-B36">Pei et al. 2008</xref>). Here, we address incorporation of protein structural information in MAFFT-based MSA construction. There are both conceptual issues and technical issues that complicate the process. Conceptually, we have to define structural similarity in such a way that it can easily be used in sequence alignments. We discuss our approach to this problem below in the context of integrating MAFFT with the structural alignment program ASH (<xref ref-type="bibr" rid="mst010-B43">Standley et al. 2004</xref>, <xref ref-type="bibr" rid="mst010-B42">2007</xref>). On the technical level, structural information complicates matters simply because protein structures contain more information and more noise than sequence information.</p>
      <p>Here, we focus on one essential feature of ASH: the equivalence score that is used to define structural similarity. A particular element in the structural similarity matrix takes the form of a Gaussian-shaped function of the inter-residue distance
<disp-formula><graphic xlink:href="mst010um1"/></disp-formula>
where <italic>d<sub>ij</sub></italic> is the distance between two alpha carbons <italic>i</italic> and <italic>j</italic> in the two input structures and <italic>d</italic><sub>0</sub> is a parameter that defines tolerance in the score. The default behavior is to set <italic>d</italic><sub>0</sub> to 4 Å. The goal of ASH is to maximize the sum of e<italic><sub>ij</sub></italic> over aligned residues. The residue-level equivalences, which form the basis of all ASH alignments, provide a convenient route for combining MAFFT and ASH. We can, for example, set a threshold value of e<italic><sub>ij</sub></italic> and incorporate highly confident parts of the alignment into MAFFT to “seed” the MSA calculation. If we consider the case of the three PIN domain-containing structures in <xref ref-type="fig" rid="mst010-F4">Figure 4</xref>, we can first compute structural alignments for the three unique pairs using ASH (ash_3v33A-2qipA, ash_3v33A-1taqA, and ash_2qipA-1taqA). If we set a threshold for residue equivalence at <inline-formula><inline-graphic xlink:href="mst010i2.jpg"/></inline-formula>0.5, we can then combine the equivalence-filtered alignments into MAFFT using the seed option (<xref ref-type="bibr" rid="mst010-B19">Katoh et al. 2009</xref>):
<disp-quote content-type="extract"><p><monospace>mafft-linsi <monospace>--</monospace></monospace><monospace>seed ash_3v33A-2qipA <monospace>\ --</monospace></monospace><monospace>seed ash_3v33A-1taqA</monospace><monospace>\</monospace></p><p><monospace>--</monospace><monospace>seed ash_2qipA-1taqA \ sequences <monospace>&gt;</monospace></monospace><monospace> output</monospace></p></disp-quote>
Because the sequence identities between the aligned structures are low, we see an improvement in the resulting MSA relative to conventional MAFFT (<xref ref-type="fig" rid="mst010-F4">Fig. 4</xref>). Based on this approach, we are developing an integrative service for protein structure-informed MSA construction.</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The authors thank Drs. Wen Chen, C. André Lévesque, and Christopher Lewis, Agriculture and Agri-Food Canada, for permitting the use of the ITS data in this article and providing other challenging problems. This work was supported by <funding-source>Platform for Drug Discovery, Informatics, and Structural Life Science from the Ministry of Education, Culture, Sports, Science and Technology, Japan</funding-source>, and the <funding-source>Computational Biology Research Center, National Institute of Advanced Industrial Science and Technology (AIST), Japan</funding-source>.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="mst010-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
        </person-group>
        <article-title>Generalized affine gap costs for protein sequence alignment</article-title>
        <source>Proteins</source>
        <year>1998</year>
        <volume>32</volume>
        <fpage>88</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="pmid">9672045</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barton</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Sternberg</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>A strategy for the rapid multiple alignment of protein sequences. Confidence levels from tertiary structure comparisons</article-title>
        <source>J Mol Biol.</source>
        <year>1987</year>
        <volume>198</volume>
        <fpage>327</fpage>
        <lpage>337</lpage>
        <pub-id pub-id-type="pmid">3430611</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berger</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Munson</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>A novel randomized iterative strategy for aligning multiple protein sequences</article-title>
        <source>Comput Appl Biosci.</source>
        <year>1991</year>
        <volume>7</volume>
        <fpage>479</fpage>
        <lpage>484</lpage>
        <pub-id pub-id-type="pmid">1747779</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berger</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Aligning short reads to reference alignments and trees</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2068</fpage>
        <lpage>2075</lpage>
        <pub-id pub-id-type="pmid">21636595</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blackburne</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Whelan</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Class of multiple sequence alignment algorithm affects genomic analysis</article-title>
        <source>Mol Biol Evol.</source>
        <year>2012a</year>
        <comment>Advance access published December 4, 2012, doi:10.1093/molbev/mss256</comment>
      </element-citation>
    </ref>
    <ref id="mst010-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blackburne</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Whelan</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Measuring the distance between multiple sequence alignments</article-title>
        <source>Bioinformatics</source>
        <year>2012b</year>
        <volume>28</volume>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="pmid">22199391</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cannone</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Subramanian</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schnare</surname>
            <given-names>MN</given-names>
          </name>
          <etal/>
          <collab>(14 co-authors)</collab>
        </person-group>
        <article-title>The comparative RNA web (CRW) site: an online database of comparative sequence and structure information for ribosomal, intron, and other RNAs</article-title>
        <source>BMC Bioinformatics</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>2</fpage>
        <pub-id pub-id-type="pmid">11869452</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cole</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Cardenas</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
          <collab>(11 co-authors)</collab>
        </person-group>
        <article-title>The ribosomal database project: improved alignments and new tools for rRNA analysis</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>D141</fpage>
        <lpage>D145</lpage>
        <pub-id pub-id-type="pmid">19004872</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dessimoz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gil</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic assessment of alignments reveals neglected tree signal in gaps</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R37</fpage>
        <pub-id pub-id-type="pmid">20370897</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Doolittle</surname>
            <given-names>RF</given-names>
          </name>
        </person-group>
        <article-title>Progressive sequence alignment as a prerequisite to correct phylogenetic trees</article-title>
        <source>J Mol Evol.</source>
        <year>1987</year>
        <volume>25</volume>
        <fpage>351</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="pmid">3118049</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fletcher</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>INDELible: a flexible simulator of biological sequence evolution</article-title>
        <source>Mol Biol Evol.</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>1879</fpage>
        <lpage>1888</lpage>
        <pub-id pub-id-type="pmid">19423664</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Golubchik</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wise</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Easteal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jermiin</surname>
            <given-names>LS</given-names>
          </name>
        </person-group>
        <article-title>Mind the gaps: evidence of bias in estimates of multiple sequence alignments</article-title>
        <source>Mol Biol Evol.</source>
        <year>2007</year>
        <volume>24</volume>
        <fpage>2433</fpage>
        <lpage>2442</lpage>
        <pub-id pub-id-type="pmid">17709332</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gotoh</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Optimal alignment between groups of sequences and its application to multiple sequence alignment</article-title>
        <source>Comput Appl Biosci.</source>
        <year>1993</year>
        <volume>9</volume>
        <fpage>361</fpage>
        <lpage>370</lpage>
        <pub-id pub-id-type="pmid">8324637</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gotoh</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>A weighting system and algorithm for aligning many phylogenetically related sequences</article-title>
        <source>Comput Appl Biosci.</source>
        <year>1995</year>
        <volume>11</volume>
        <fpage>543</fpage>
        <lpage>551</lpage>
        <pub-id pub-id-type="pmid">8590178</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henikoff</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Henikoff</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>Amino acid substitution matrices from protein blocks</article-title>
        <source>Proc Natl Acad Sci U S A.</source>
        <year>1992</year>
        <volume>89</volume>
        <fpage>10915</fpage>
        <lpage>10919</lpage>
        <pub-id pub-id-type="pmid">1438297</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Sharp</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>CLUSTAL: a package for performing multiple sequence alignment on a microcomputer</article-title>
        <source>Gene</source>
        <year>1988</year>
        <volume>73</volume>
        <fpage>237</fpage>
        <lpage>244</lpage>
        <pub-id pub-id-type="pmid">3243435</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>The rapid generation of mutation data matrices from protein sequences</article-title>
        <source>Comput Appl Biosci.</source>
        <year>1992</year>
        <volume>8</volume>
        <fpage>275</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="pmid">1633570</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>A mutation data matrix for transmembrane proteins</article-title>
        <source>FEBS Lett.</source>
        <year>1994</year>
        <volume>339</volume>
        <fpage>269</fpage>
        <lpage>275</lpage>
        <pub-id pub-id-type="pmid">8112466</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Asimenos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Multiple alignment of DNA sequences with MAFFT</article-title>
        <source>Methods Mol Biol.</source>
        <year>2009</year>
        <volume>537</volume>
        <fpage>39</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="pmid">19378139</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Adding unaligned sequences into an existing alignment using MAFFT and LAST</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>3144</fpage>
        <lpage>3146</lpage>
        <pub-id pub-id-type="pmid">23023983</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kuma</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Miyata</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>MAFFT version 5: improvement in accuracy of multiple sequence alignment</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>511</fpage>
        <lpage>518</lpage>
        <pub-id pub-id-type="pmid">15661851</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Misawa</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kuma</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Miyata</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>3059</fpage>
        <lpage>3066</lpage>
        <pub-id pub-id-type="pmid">12136088</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Standley</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>MAFFT: iterative refinement and additional methods</article-title>
        <source>Methods Mol Biol.</source>
        <year>Forthcoming 2013</year>
      </element-citation>
    </ref>
    <ref id="mst010-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>PartTree: An algorithm to build an approximate tree from a large number of unaligned sequences</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>372</fpage>
        <lpage>374</lpage>
        <pub-id pub-id-type="pmid">17118958</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Improved accuracy of multiple ncRNA alignment by incorporating structural information into a MAFFT-based framework</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008a</year>
        <volume>9</volume>
        <fpage>212</fpage>
        <pub-id pub-id-type="pmid">18439255</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Recent developments in the MAFFT multiple sequence alignment program</article-title>
        <source>Brief Bioinform.</source>
        <year>2008b</year>
        <volume>9</volume>
        <fpage>286</fpage>
        <lpage>298</lpage>
        <pub-id pub-id-type="pmid">18372315</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Parallelization of the MAFFT multiple sequence alignment program</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1899</fpage>
        <lpage>1900</lpage>
        <pub-id pub-id-type="pmid">20427515</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiełbasa</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Horton</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Adaptive seeds tame genomic sequence comparison</article-title>
        <source>Genome Res.</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>487</fpage>
        <lpage>493</lpage>
        <pub-id pub-id-type="pmid">21209072</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letsch</surname>
            <given-names>HO</given-names>
          </name>
          <name>
            <surname>Kuck</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stocsits</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Misof</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>The impact of rRNA secondary structure consideration in alignment and tree reconstruction: simulated data and a case study on the phylogeny of hexapods</article-title>
        <source>Mol Biol Evol.</source>
        <year>2010</year>
        <volume>27</volume>
        <fpage>2507</fpage>
        <lpage>2521</lpage>
        <pub-id pub-id-type="pmid">20530152</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Löytynoja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vilella</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Accurate extension of multiple sequence alignments using a phylogeny-aware graph algorithm</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1684</fpage>
        <lpage>1691</lpage>
        <pub-id pub-id-type="pmid">22531217</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matsen</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Kodner</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Armbrust</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>pplacer: linear time maximum-likelihood and Bayesian phylogenetic placement of sequences onto a fixed reference tree</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>538</fpage>
        <pub-id pub-id-type="pmid">21034504</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>SEPP: SATé-enabled phylogenetic placement</article-title>
        <source>Pac Symp Biocomput.</source>
        <year>2012</year>
        <volume>17</volume>
        <fpage>247</fpage>
        <lpage>258</lpage>
        <pub-id pub-id-type="pmid">22174280</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B48">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nilsson</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Veldre</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Unterseher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Amend</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bergsten</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kristiansson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ryberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jumpponen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Abarenkov</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>An open source software package for automated extraction of ITS1 and ITS2 from fungal ITS sequences for use in high-throughput community assays and molecular ecology</article-title>
        <source>Fungal Ecology</source>
        <year>2010</year>
        <volume>3</volume>
        <fpage>284</fpage>
        <lpage>287</lpage>
      </element-citation>
    </ref>
    <ref id="mst010-B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Holm</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>COFFEE: an objective function for multiple sequence alignments</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>407</fpage>
        <lpage>422</lpage>
        <pub-id pub-id-type="pmid">9682054</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nuin</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Tillier</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <article-title>The accuracy of several multiple sequence alignment programs for proteins</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>471</fpage>
        <pub-id pub-id-type="pmid">17062146</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Sullivan</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Suhre</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Abergel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>3DCoffee: combining protein sequences and structures within multiple sequence alignments</article-title>
        <source>J Mol Biol.</source>
        <year>2004</year>
        <volume>340</volume>
        <fpage>385</fpage>
        <lpage>395</lpage>
        <pub-id pub-id-type="pmid">15201059</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pei</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>BH</given-names>
          </name>
          <name>
            <surname>Grishin</surname>
            <given-names>NV</given-names>
          </name>
        </person-group>
        <article-title>PROMALS3D: a tool for multiple protein sequence and structure alignments</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>2295</fpage>
        <lpage>2300</lpage>
        <pub-id pub-id-type="pmid">18287115</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Punta</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Coggill</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Eberhardt</surname>
            <given-names>RY</given-names>
          </name>
          <etal/>
          <collab>(16 co-authors)</collab>
        </person-group>
        <article-title>The Pfam protein families database</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>D290</fpage>
        <lpage>D301</lpage>
        <pub-id pub-id-type="pmid">22127870</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B38">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sahraeian</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Yoon</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>PicXAA-R: efficient structural alignment of multiple RNA sequences using a greedy approach</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>S38</fpage>
        <pub-id pub-id-type="pmid">21342569</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B39">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schrödinger</surname>
            <given-names>LLC</given-names>
          </name>
        </person-group>
        <article-title>The PyMOL Molecular Graphics System, Version 1.3r1. Portland</article-title>
        <year>2010</year>
        <comment>Oregon: Schrödinger, LLC</comment>
      </element-citation>
    </ref>
    <ref id="mst010-B40">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sievers</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dineen</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
          <collab>(12 co-authors)</collab>
        </person-group>
        <article-title>Fast scalable generation of high-quality protein multiple sequence alignments using Clustal Omega</article-title>
        <source>Mol Syst Biol.</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>539</fpage>
        <pub-id pub-id-type="pmid">21988835</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B41">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sigrist</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Cerutti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>de Castro</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Langendijk-Genevaux</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Bulliard</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bairoch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hulo</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>PROSITE, a protein domain database for functional characterization and annotation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>D161</fpage>
        <lpage>D166</lpage>
        <pub-id pub-id-type="pmid">19858104</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B42">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Standley</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Ash structure alignment package: sensitivity and selectivity in domain classification</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>116</fpage>
        <pub-id pub-id-type="pmid">17407606</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B43">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Standley</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Detecting local structural similarity in proteins by maximizing number of equivalent residues</article-title>
        <source>Proteins</source>
        <year>2004</year>
        <volume>57</volume>
        <fpage>381</fpage>
        <lpage>391</lpage>
        <pub-id pub-id-type="pmid">15340925</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B44">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Buhler</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>PhyLAT: a phylogenetic local alignment tool</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1336</fpage>
        <lpage>1344</lpage>
        <pub-id pub-id-type="pmid">22492645</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B45">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tabei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kiryu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Asai</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A fast structural multiple alignment method for long RNA sequences</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>33</fpage>
        <pub-id pub-id-type="pmid">18215258</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B46">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1994</year>
        <volume>22</volume>
        <fpage>4673</fpage>
        <lpage>4680</lpage>
        <pub-id pub-id-type="pmid">7984417</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B47">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waterhouse</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Procter</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Clamp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barton</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>Jalview version 2—a multiple sequence alignment editor and analysis workbench</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1189</fpage>
        <lpage>1191</lpage>
        <pub-id pub-id-type="pmid">19151095</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol. Biol. Evol</journal-id>
    <journal-id journal-id-type="publisher-id">molbev</journal-id>
    <journal-id journal-id-type="hwp">molbiolevol</journal-id>
    <journal-title-group>
      <journal-title>Molecular Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0737-4038</issn>
    <issn pub-type="epub">1537-1719</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3603318</article-id>
    <article-id pub-id-type="doi">10.1093/molbev/mst010</article-id>
    <article-id pub-id-type="publisher-id">mst010</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Fast Tracks</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MAFFT Multiple Sequence Alignment Software Version 7: Improvements in Performance and Usability</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Katoh</surname>
          <given-names>Kazutaka</given-names>
        </name>
        <xref ref-type="corresp" rid="mst010-COR1">*</xref>
        <xref ref-type="aff" rid="mst010-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="mst010-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Standley</surname>
          <given-names>Daron M.</given-names>
        </name>
        <xref ref-type="aff" rid="mst010-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="mst010-AFF1"><sup>1</sup>Immunology Frontier Research Center, Osaka University, Suita, Osaka, Japan</aff>
    <aff id="mst010-AFF2"><sup>2</sup>Computational Biology Research Center, The National Institute of Advanced Industrial Science and Technology (AIST), Tokyo, Japan</aff>
    <author-notes>
      <corresp id="mst010-COR1"><bold>*Corresponding author:</bold> E-mail: <email>kazutaka.katoh@aist.go.jp</email>.</corresp>
      <fn>
        <p><bold>Associate editor:</bold> Sudhir Kumar</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>4</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>1</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>1</month>
      <year>2013</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>4</issue>
    <fpage>772</fpage>
    <lpage>780</lpage>
    <permissions>
      <copyright-statement>© The Author 2013. Published by Oxford University Press on behalf of the Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>We report a major update of the MAFFT multiple sequence alignment program. This version has several new features, including options for adding unaligned sequences into an existing alignment, adjustment of direction in nucleotide alignment, constrained alignment and parallel processing, which were implemented after the previous major update. This report shows actual examples to explain how these features work, alone and in combination. Some examples incorrectly aligned by MAFFT are also shown to clarify its limitations. We discuss how to avoid misalignments, and our ongoing efforts to overcome such limitations.</p>
    </abstract>
    <kwd-group>
      <kwd>multiple sequence alignment</kwd>
      <kwd>metagemone</kwd>
      <kwd>protein structure</kwd>
      <kwd>progressive alignment</kwd>
      <kwd>parallel processing</kwd>
    </kwd-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>Introduction</title>
    <p>Multiple sequence alignment (MSA) plays an important role in evolutionary analyses of biological sequences. MAFFT is an MSA program, first released in 2002 (<xref ref-type="bibr" rid="mst010-B22">Katoh et al. 2002</xref>). Because of its high performance (<xref ref-type="bibr" rid="mst010-B34">Nuin et al. 2006</xref>; <xref ref-type="bibr" rid="mst010-B12">Golubchik et al. 2007</xref>; <xref ref-type="bibr" rid="mst010-B9">Dessimoz and Gil 2010</xref>; <xref ref-type="bibr" rid="mst010-B29">Letsch et al. 2010</xref>; <xref ref-type="bibr" rid="mst010-B38">Sahraeian and Yoon 2011</xref>; <xref ref-type="bibr" rid="mst010-B40">Sievers et al. 2011</xref>), MAFFT is becoming popular in recent years. After reviewing the previous version (version 6) in <xref ref-type="bibr" rid="mst010-B26">Katoh and Toh (2008b)</xref>, we have been continuously improving its accuracy, speed, and utility in practical situations. These improvements and techniques were mostly reported in individual papers (<xref ref-type="bibr" rid="mst010-B19">Katoh et al. 2009</xref>; <xref ref-type="bibr" rid="mst010-B27">Katoh and Toh 2010</xref>; <xref ref-type="bibr" rid="mst010-B20">Katoh and Frith 2012</xref>; <xref ref-type="bibr" rid="mst010-B23">Katoh and Standley 2013</xref>). In this report, we demonstrate the different kinds of analyses that can be achieved with the new features, alone and in combination, using realistic examples. We also discuss limitations of current version by giving examples of sequences incorrectly aligned by MAFFT, and describe our ongoing efforts to overcome these limitations.</p>
  </sec>
  <sec>
    <title>Basic Concepts and Usage</title>
    <p>As listed in <xref ref-type="table" rid="mst010-T1">table 1</xref>, MAFFT version 7 has options for various alignment strategies, including progressive methods (PartTree, FFT-NS-1, and L-INS-1) (<xref ref-type="bibr" rid="mst010-B10">Feng and Doolittle 1987</xref>; <xref ref-type="bibr" rid="mst010-B16">Higgins and Sharp 1988</xref>; <xref ref-type="bibr" rid="mst010-B24">Katoh and Toh 2007</xref>), iterative refinement methods (FFT-NS-i, L-INS-i, E-INS-i, and G-INS-i) (<xref ref-type="bibr" rid="mst010-B2">Barton and Sternberg 1987</xref>; <xref ref-type="bibr" rid="mst010-B3">Berger and Munson 1991</xref>; <xref ref-type="bibr" rid="mst010-B13">Gotoh 1993</xref>; <xref ref-type="bibr" rid="mst010-B21">Katoh et al. 2005</xref>), and structural alignment methods for RNAs (Q-INS-i and X-INS-i; <xref ref-type="bibr" rid="mst010-B25">Katoh and Toh 2008a</xref>). See <xref ref-type="bibr" rid="mst010-B26">Katoh and Toh (2008b)</xref> for details of these strategies. According to a recent comparative study based on the MetAl metric (<xref ref-type="bibr" rid="mst010-B5">Blackburne and Whelan 2012a</xref>, <xref ref-type="bibr" rid="mst010-B6">2012b</xref>), there are two significantly different classes of MSA methods, similarity-based methods and evolution-based methods. MAFFT is classified as a similarity-based method. However, evolutionary information is useful even for similarity-based methods, because the sequences to be aligned are generated from a common ancestor in the course of evolution. In this respect, MAFFT takes evolutionary information into account.
<table-wrap id="mst010-T1" position="float"><label>Table 1.</label><caption><p>Options of MAFFT Version 7.</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Option name</th><th rowspan="1" colspan="1">Command</th><th rowspan="1" colspan="1"/></tr></thead><tbody align="left"><tr><td colspan="3" rowspan="1">For a large-scale alignment: progressive methods with the PartTree algorithm<hr/></td></tr><tr><td rowspan="1" colspan="1">    NW-NS-PartTree1</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>parttree </monospace><monospace>––</monospace><monospace>retree 1 input</monospace></td><td align="left" rowspan="1" colspan="1">Distance is by the 6mer method.</td></tr><tr><td rowspan="1" colspan="1">    NW-NS-PartTree2</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>parttree </monospace><monospace>––</monospace><monospace>retree 2 input</monospace></td><td align="left" rowspan="1" colspan="1">Distance is by the 6mer method. Guide tree is re-built.</td></tr><tr><td rowspan="1" colspan="1">    NW-NS-DPPartTree1</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>dpparttree </monospace><monospace>––</monospace><monospace>retree 1 input</monospace></td><td align="left" rowspan="1" colspan="1">Distance is estimated based on DP.</td></tr><tr><td rowspan="1" colspan="1">    NW-NS-DPPartTree2</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>dpparttree </monospace><monospace>––</monospace><monospace>retree 2 input</monospace></td><td align="left" rowspan="1" colspan="1">Distance is estimated based on DP. Guide tree is re-built.</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">For a medium-scale alignment: progressive methods</td></tr><tr><td rowspan="1" colspan="1">    FFT-NS-1</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>retree 1 input</monospace></td><td align="left" rowspan="1" colspan="1">Approximately two times faster than the default.</td></tr><tr><td rowspan="1" colspan="1">    FFT-NS-2</td><td align="left" rowspan="1" colspan="1"><monospace>mafft input</monospace></td><td align="left" rowspan="1" colspan="1">Default.</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">For a small-scale alignment: iterative refinement methods</td></tr><tr><td rowspan="1" colspan="1">    FFT-NS-i</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>maxiterate 16 input</monospace></td><td align="left" rowspan="1" colspan="1">Fastest of the four in this category. Uses WSP score (<xref ref-type="bibr" rid="mst010-B14">Gotoh 1995</xref>) only.</td></tr><tr><td rowspan="1" colspan="1">    G-INS-i</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>maxiterate 16 </monospace><monospace>––</monospace><monospace>globalpair input</monospace></td><td align="left" rowspan="1" colspan="1">Uses WSP score and consistency (<xref ref-type="bibr" rid="mst010-B33">Notredame et al. 1998</xref>) score from global alignments.</td></tr><tr><td rowspan="1" colspan="1">    L-INS-i</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>maxiterate 16 </monospace><monospace>––</monospace><monospace>localpair input</monospace></td><td align="left" rowspan="1" colspan="1">Uses WSP score and consistency score from local alignments.</td></tr><tr><td rowspan="1" colspan="1">    E-INS-i</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>maxiterate 16 </monospace><monospace>––</monospace><monospace>genafpair input</monospace></td><td align="left" rowspan="1" colspan="1">Uses WSP score and consistency score from local alignments with a generalized affine gap cost (<xref ref-type="bibr" rid="mst010-B1">Altschul 1998</xref>).</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">If not sure which option to use</td></tr><tr><td rowspan="1" colspan="1">    Automatic</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>auto</monospace></td><td align="left" rowspan="1" colspan="1">Selects an appropriate option from FFT-NS-2, FFT-NS-i and L-INS-i, according to the size of input data.</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">For a small-scale RNA alignment: structural alignment methods</td></tr><tr><td rowspan="1" colspan="1">    Q-INS-i</td><td align="left" rowspan="1" colspan="1"><monospace>mafft-qinsi input</monospace></td><td align="left" rowspan="1" colspan="1">Structure information is included in iterative refinement step.</td></tr><tr><td rowspan="1" colspan="1">    X-INS-i-scarnapair</td><td align="left" rowspan="1" colspan="1"><monospace>mafft-xinsi </monospace><monospace>––</monospace><monospace>scarnapair input</monospace></td><td align="left" rowspan="1" colspan="1">Uses pairwise structural alignment by MXSCARNA (<xref ref-type="bibr" rid="mst010-B45">Tabei et al. 2008</xref>).</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">To add new sequences into an existing MSA</td></tr><tr><td rowspan="1" colspan="1">    Add</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>add mew msa</monospace></td><td align="left" rowspan="1" colspan="1">The simplest option for alignment extension.</td></tr><tr><td rowspan="1" colspan="1">    Addprofile</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>addprofile msa1 </monospace><monospace>msa2</monospace></td><td align="left" rowspan="1" colspan="1">msa1 must form a monophyletic cluster.</td></tr><tr><td rowspan="1" colspan="1">    Addfragments</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>addfragments new msa</monospace></td><td align="left" rowspan="1" colspan="1">Suitable for short new sequences.</td></tr><tr><td rowspan="1" colspan="1">    Addfragments, LAST</td><td align="left" rowspan="1" colspan="1"><monospace>mafft ––addfragments new </monospace><monospace>––</monospace><monospace>lastmultipair msa</monospace></td><td align="left" rowspan="1" colspan="1">Faster option, LAST (<xref ref-type="bibr" rid="mst010-B28">Kiełbasa et al. 2011</xref>) is required.</td></tr><tr><td rowspan="1" colspan="1">    Addfragments, 6mer</td><td align="left" rowspan="1" colspan="1"><monospace>mafft </monospace><monospace>––</monospace><monospace>addfragments new </monospace><monospace>––</monospace><monospace>6merpair msa</monospace></td><td align="left" rowspan="1" colspan="1">Faster option for conserved data.</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">Parameters</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>bl #, </monospace><monospace>––</monospace><monospace>jtt #, </monospace><monospace>––</monospace><monospace>tm #</monospace></td><td align="left" rowspan="1" colspan="1">Score matrices for protein alignment.</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>kimura #</monospace></td><td align="left" rowspan="1" colspan="1">Score matrix for nucleotide alignment.</td></tr><tr><td colspan="3" rowspan="1"><hr/></td></tr><tr><td colspan="3" rowspan="1">Utility options</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>anysymbol</monospace></td><td rowspan="11" align="left" colspan="1">See main text.</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>reorder</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>clustalout</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>phylipout</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>namelength #</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>adjustdirection</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>adjustdirectionaccurately</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>seed msa1 –seed msa2</monospace><monospace> …</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>treein treefile</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>treeout</monospace></td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><monospace>––</monospace><monospace>thread #</monospace></td></tr></tbody></table><table-wrap-foot><fn id="mst010-TF1"><p>N<sc>ote</sc>.—<bold>N, the number of sequences; L, the sequence length; <monospace><bold>input, new</bold></monospace>, unaligned sequences in the multi-fasta format; <monospace><bold>msa, msa1, msa2</bold></monospace>, aligned sequences in the multi-fasta format; <monospace><bold>treefile</bold></monospace>, input guide tree file.</bold></p></fn></table-wrap-foot></table-wrap></p>
    <p>All the options of MAFFT assume that the input sequences are all homologous, that is, descended from a common ancestor. Thus, all the letters in the input data are aligned. Genomic rearrangement or domain shuffling is not assumed, and thus the order of the letters in each sequence is always preserved, although the sequences can be reordered according to similarity. Most options in MAFFT assume that almost all the pairs in the input sequences can be aligned, locally or globally. In such a situation, there is a tradeoff between accuracy and speed. For example, the PartTree option (<xref ref-type="bibr" rid="mst010-B24">Katoh and Toh 2007</xref>) is a fast and rough method, whereas L-INS-i and G-INS-i are slower and more accurate. RNA structural alignment methods are generally more accurate and computationally more expensive because they need additional calculations (<xref ref-type="bibr" rid="mst010-B25">Katoh and Toh 2008a</xref>). However, this tradeoff does not always hold. In particular, the new options to add sequences into an existing alignment (<xref ref-type="bibr" rid="mst010-B20">Katoh and Frith 2012</xref>), requires careful consideration of this tradeoff, as discussed later.</p>
  </sec>
  <sec>
    <title>Profile Alignments</title>
    <p>MAFFT has a subprogram, <monospace>mafft-profile</monospace>, to align two existing alignments.
<disp-quote content-type="extract"><p><monospace>mafft-profile alignment1 alignment2 </monospace><monospace>&gt;</monospace><monospace> output</monospace></p></disp-quote>
This method separately converts <monospace>alignment1</monospace> and <monospace>alignment2</monospace> to profiles and then aligns the two profiles. It means that the two input alignments are assumed to be phylogenetically isolated from each other, like <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>A</italic>. Careless application of this method results in serious misalignments, as discussed in later section.
<fig id="mst010-F1" position="float"><label><bold>F<sc>ig</sc>. 1</bold>.</label><caption><p>Assumptions on the phylogenetic relationship in different options of MAFFT. (<italic>A</italic>) <monospace>mafft-profile</monospace>, (<italic>B</italic>) <monospace>––</monospace><monospace>addprofile</monospace>, (<italic>C</italic>), misuse of <monospace>mafft-profile</monospace>, and (<italic>D</italic>) <monospace>––</monospace><monospace>add</monospace> or <monospace>––</monospace><monospace>addprofile</monospace>.</p></caption><graphic xlink:href="mst010f1p"/></fig></p>
    <p>MAFFT version 7 has an alternative option, <monospace>––</monospace><monospace>addprofile</monospace>, which is safer against misuses.
<disp-quote content-type="extract"><p><monospace>mafft <monospace>--</monospace></monospace><monospace>addprofile alignment1 alignment2 </monospace><monospace>&gt;</monospace><monospace> output</monospace></p></disp-quote>
This option accepts two existing alignments, <monospace>alignment1</monospace> and <monospace>alignment2</monospace>, and assumes a phylogenetic relationship shown in <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>B</italic>. That is, <monospace>alignment1</monospace> is assumed to form a monophyletic cluster, but <monospace>alignment2</monospace> is not assumed to form a monophyletic cluster. The cluster of <monospace>alignment1</monospace> can be placed in any phylogenetic position in the tree of <monospace>alignment2</monospace>. Moreover, this option checks whether <monospace>alignment1</monospace> forms a monophyletic cluster. If not, it returns an error message and asks user to use the <monospace>––</monospace><monospace>add</monospace> option (see the following section).</p>
  </sec>
  <sec>
    <title>Adding Unaligned Sequences into an MSA</title>
    <p>As a result of advances in sequencing technologies, we increasingly need MSAs consisting of a larger number of sequences. There are several different approaches to enable construction of large MSAs, such as rapid algorithms and parallelization. Here, we describe an alternate approach: use of an existing alignment. There already exist databases of carefully aligned and annotated sequences (<xref ref-type="bibr" rid="mst010-B8">Cole et al. 2009</xref>; <xref ref-type="bibr" rid="mst010-B41">Sigrist et al. 2010</xref>; <xref ref-type="bibr" rid="mst010-B37">Punta et al. 2012</xref>), in which each MSA consists of a small number (typically up to ∼1,000) of sequences. We can use such MSAs as a backbone to build a larger MSA containing newly sequenced data. This is more efficient than rebuilding the entire MSA from a set of ungapped sequences. Moreover, this approach is relatively robust to low-quality sequences resulting from sequencing errors, misassemblies, and other factors. Such noise usually has a negative effect on the quality of an MSA, but there are situations where biologically important information is contained in low-quality sequences. In such a case, we first select highly reliable sequences to build a backbone MSA, and then add the other sequences, including low-quality ones, into the MSA. As a result, the quality of the final MSA is less affected by the low-quality sequences.</p>
    <sec>
      <title>Inappropriate Applications of Profile Alignment</title>
      <p>The <monospace>mafft-profile</monospace> program is not useful for this purpose. There are two types of misapplications. One is as follows: 1) convert an existing alignment to a profile, 2) align new sequences and convert them to a profile, and 3) align the two profiles. This procedure is inappropriate for adding new sequences because it assumes a phylogenetic relationship as illustrated in <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>A</italic>.</p>
      <p>Another misapplication is as follows: 1) convert the existing alignment to a profile, <italic>2</italic>) separately align each new sequence to the profile of the existing alignment, and 3) construct a full alignment from the individual alignments computed in the previous step. This approach is more reasonable than the first one but still problematic, because the phylogenetic positions of new sequences are assumed at the root of the tree, as illustrated in <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>C</italic>. Results of this procedure for two cases are shown in <xref ref-type="table" rid="mst010-T2">table 2</xref> and <xref ref-type="fig" rid="mst010-F2">figure 2</xref>.
<fig id="mst010-F2" position="float"><label>F<sc>ig</sc>. 2.</label><caption><p>ITS alignments by different options of MAFFT, displayed on Jalview (<xref ref-type="bibr" rid="mst010-B47">Waterhouse et al. 2009</xref>). (<italic>A</italic>, <italic>B</italic>) Incorrect alignments by the FFT-NS-2 and L-INS-i algorithms, respectively. (<italic>C</italic>) An incorrect alignment by <monospace>mafft-profile</monospace>. The full-length sequences were aligned with the L-INS-i algorithm and then each new sequence was separately added to the full-length alignment, using <monospace>mafft-profile</monospace>. (<italic>D</italic>) Reasonable alignment by a two-step strategy. The <monospace>––</monospace><monospace>6merpair </monospace><monospace>––</monospace><monospace>addfragments</monospace> option was used at the second step. (<italic>E</italic>) Reordered version of D; sequences are ordered such that similar sequences are placed closely. All calculations were performed using 16 cores on a Linux PC with 2.67 GHz Intel Xeon E7-8837/256 GB RAM.</p></caption><graphic xlink:href="mst010f2p"/></fig>
<table-wrap id="mst010-T2" position="float"><label><bold>Table 2</bold>.</label><caption><p>Comparison of Different Options Using the 16S.B.ALL Data Set (<xref ref-type="bibr" rid="mst010-B32">Mirarab et al. 2012</xref>).</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Data</th><th rowspan="1" colspan="1">Method</th><th rowspan="1" colspan="1">Accuracy</th><th rowspan="1" colspan="1">CPU Time</th><th rowspan="1" colspan="1">Actual Time<xref ref-type="table-fn" rid="mst010-TF1"><sup>a</sup></xref></th></tr></thead><tbody align="left"><tr><td rowspan="5" colspan="1">Case 1</td><td align="left" rowspan="1" colspan="1"><monospace>mafft ––multipair ––addfragments frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9969</td><td align="left" rowspan="1" colspan="1">6.67 days</td><td align="left" rowspan="1" colspan="1">18.3 h</td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>mafft ––6merpair ––addfragments frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9949</td><td align="left" rowspan="1" colspan="1">3.76 h</td><td align="left" rowspan="1" colspan="1">36.2 min</td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>mafft ––localpair ––add  frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9707</td><td align="left" rowspan="1" colspan="1">23.4 days<xref ref-type="table-fn" rid="mst010-TF2"><sup>b</sup></xref></td><td align="left" rowspan="1" colspan="1">2.43 days<xref ref-type="table-fn" rid="mst010-TF2"><sup>b</sup></xref></td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>mafft ––6merpair ––add frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9604</td><td align="left" rowspan="1" colspan="1">1.32 h</td><td align="left" rowspan="1" colspan="1">1.44 h</td></tr><tr><td align="left" rowspan="1" colspan="1">profile alignment</td><td align="left" rowspan="1" colspan="1">0.2779</td><td align="left" rowspan="1" colspan="1">15.5 h</td><td align="left" rowspan="1" colspan="1">1.60 h</td></tr><tr><td colspan="5" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1">Case 2</td><td align="left" rowspan="1" colspan="1"><monospace>mafft ––6merpair ––addfragments frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9969</td><td align="left" rowspan="1" colspan="1">4.54 h</td><td align="left" rowspan="1" colspan="1">33.8 min</td></tr><tr><td colspan="5" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1">Case 3</td><td align="left" rowspan="1" colspan="1"><monospace>mafft ––6merpair ––addfragments frags existingmsa</monospace></td><td align="left" rowspan="1" colspan="1">0.9949</td><td align="left" rowspan="1" colspan="1">1.79 days</td><td align="left" rowspan="1" colspan="1">5.91 h</td></tr></tbody></table><table-wrap-foot><fn id="mst010-TF2"><p>N<sc>ote</sc>.—The estimated alignments were compared with the CRW alignment to measure the accuracy (the number of correctly aligned letters/the number of aligned letters in the CRW alignment). Calculations were performed on a Linux PC with 2.67 GHz Intel Xeon E7-8837/256 GB RAM (for the case marked with superscript alphabet “b”), or on a Linux PC with 3.47 GHz Intel Xeon X5690/48 GB RAM (for the other cases). Case 1: 13,822 sequences in the existing alignment × 13,821 fragments; Case 2: 1,000 sequences in the existing alignment × 138,210 fragments; Case 3: 13,822 sequences in the existing alignment × 138,210 fragments.</p></fn><fn id="mst010-TF3"><p><sup>a</sup>Wall-clock time with 10 cores. Command-line argument for parallel processing is <monospace>––thread 10</monospace>.</p></fn><fn id="mst010-TF4"><p><sup>b</sup>Full command-line options are as follows: <monospace>mafft ––localpair ––weighti 0 ––add frags existingmsa</monospace>.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec>
      <title>The <monospace>––</monospace><monospace>a</monospace><monospace>dd</monospace> and <monospace>––</monospace><monospace>a</monospace><monospace>ddfragments</monospace> Options</title>
      <p>To overcome this limitation of profile alignment, in 2010, we implemented an option, <monospace>––</monospace><monospace>add</monospace>, to add unaligned sequences to an existing MSA. This option assumes that each new sequence was derived from a branch in the tree of an existing alignment, as illustrated in <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>D</italic>. This option works almost identically to the standard progressive method, except that the alignment calculation is skipped at the nodes whose children are all in the existing alignment.</p>
      <p>Along with popularization of second-generation sequencers, we sometimes need to align short reads to an existing alignment. Several tools (<xref ref-type="bibr" rid="mst010-B4">Berger and Stamatakis 2011</xref>; <xref ref-type="bibr" rid="mst010-B30">Löytynoja et al. 2012</xref>; <xref ref-type="bibr" rid="mst010-B44">Sun and Buhler 2012</xref>) for this purpose were developed between 2011 and 2012. A limitation of the <monospace>––</monospace><monospace>add</monospace> option in MAFFT for this purpose was pointed out in <xref ref-type="bibr" rid="mst010-B30">Löytynoja et al. (2012)</xref>. Thus, we implemented a new option, <monospace>––</monospace><monospace>addfragments</monospace>, which does not consider the relationship among the sequences to be added. Details of the <monospace>––</monospace><monospace>add</monospace> and <monospace>––</monospace><monospace>addfragments</monospace> options are described in <xref ref-type="bibr" rid="mst010-B20">Katoh and Frith (2012)</xref>.</p>
    </sec>
    <sec sec-type="cases">
      <title>Test Case 1: Fungal Internal Transcribed Spacers Sequences</title>
      <p>Here, we discuss how the <monospace>––</monospace><monospace>addfragments</monospace> option works, using an actual case. Internal transcribed spacers (ITSs) are spacer regions located between structural ribosomal RNAs. The structure of the rDNA region in a eukaryotic genome is 18S − ITS1 − 5.8S − ITS2 − 28S. Here, we use a data set consisting of ITS1 and ITS2 sequences obtained from environmental samples (Chen W, personal communication). Each sequence has either ITS1 or ITS2 region only, extracted from 454 pyrosequencing data using FungalITSextractor (<xref ref-type="bibr" rid="mst010-B48">Nilsson et al. 2010</xref>). In addition, several fungal genomic sequences that fully cover ITS1 + 5.8S rRNA + ITS2 are available from public databases.</p>
      <p>Suppose a situation where we need an MSA of approximately 300 full-length sequences and approximately 5,000 ITS1 or ITS2 sequences. One possible solution is to build an entire MSA at once. The result of the default option (FFT-NS-2) of MAFFT is obviously incorrect, as shown in <xref ref-type="fig" rid="mst010-F2">figure 2</xref><italic>A</italic>. ITS1 and ITS2 regions are forced to be aligned to each other. Even if a more computationally expensive (and usually more accurate) method, L-INS-i, is applied (CPU time = 98 h), the alignment is still obviously incorrect (<xref ref-type="fig" rid="mst010-F2">fig. 2</xref><italic>B</italic>).</p>
      <p>Two-step strategies can solve this type of problem. That is, a set of full-length sequences taken from databases are first aligned to build a backbone MSA, and then the new ITS1 and ITS2 sequences are added into this backbone MSA, using the <monospace>––</monospace><monospace>addfragments</monospace> option.
<disp-quote content-type="extract"><p>Step 1: <monospace>mafft <monospace>--</monospace></monospace><monospace>auto full_length_sequences &gt;\ backbone_msa</monospace></p><p>Step 2: <monospace>mafft <monospace>--</monospace></monospace><monospace>addfragments \ new_sequences backbone_msa &gt; output</monospace></p></disp-quote>
The second command is equivalent to
<disp-quote content-type="extract"><p><monospace>mafft <monospace>--</monospace></monospace><monospace>multipair <monospace>--</monospace></monospace><monospace>addfragments \ new_sequences backbone_msa &gt; output</monospace></p></disp-quote>
in which Dynamic Programming (DP) is used to compare the distances between every new sequence and every sequence in the backbone MSA (<monospace>––</monospace><monospace>multipair</monospace> is selected by default).
<disp-quote content-type="extract"><p><monospace>mafft <monospace>--</monospace></monospace><monospace>6merpair <monospace>--</monospace></monospace><monospace>addfragments \ new_sequences backbone_msa &gt; output</monospace></p></disp-quote>
where distances are rapidly estimated using the number of shared 6mers, instead of DP.</p>
      <p>The result of the latter option (<monospace>––</monospace><monospace>6merpair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) is shown in <xref ref-type="fig" rid="mst010-F2">fig. 2</xref><italic>D</italic> and <italic>E</italic>. The difference between <italic>D</italic> and <italic>E</italic> is just in the order of sequences; the sequences were reordered according to similarity using the <monospace>––</monospace><monospace>reorder</monospace> option in <italic>E</italic>. In this alignment, ITS1 and ITS2 are clearly separated and aligned to appropriate positions in the full-length alignment. Moreover, this strategy is computationally much less expensive (CPU time = 15 min [first step] + 1.5 min [second step]) than the full application of L-INS-i (CPU time = 98 h). The former option (<monospace>––multipair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) also returns a similar result to the latter (<monospace>––</monospace><monospace>6merpair)</monospace> but is slower (CPU time = 48.6 min [second step]).</p>
      <p>This case suggests that it is crucial to select a strategy appropriate to the problem of interest. The most time-consuming method, L-INS-i, is not always the most accurate one. The difficulty of this problem for standard approaches comes from the fact that ITS1 sequences and ITS2 sequences are not homologous to each other and most pairwise alignments are impossible. Because of these nonhomologous pairs, the distance matrix used for the guide tree calculation is not additive; the distances between ITS1 and full-length sequences and those between ITS2 and full-length sequences are close to zero, whereas the distances between ITS1 and ITS2 are quite large. In this situation, it is difficult for normal distance-based tree-building methods to give a reasonable tree. Moreover, in the alignment step, the objective function of the L-INS-i is affected by inappropriate pairwise alignment scores between ITS1 and ITS2. Such problems can be avoided by just ignoring the relationship between ITS1 and ITS2, as done in the <monospace>––</monospace><monospace>addfragments</monospace> option.</p>
      <p>In addition, a result of the second type of misuse of <monospace>mafft-profile</monospace> (discussed earlier) is shown in <xref ref-type="fig" rid="mst010-F2">figure 2</xref><italic>C</italic>. Some new sequences are correctly aligned but others are obviously incorrectly aligned (note that the order of sequences in <xref ref-type="fig" rid="mst010-F2">fig. 2</xref><italic>C</italic> is identical that in <xref ref-type="fig" rid="mst010-F2">fig. 2</xref><italic>D</italic>). These misalignments are due to an incorrect assumption on phylogenetic placement of new sequences shown in <xref ref-type="fig" rid="mst010-F1">figure 1</xref><italic>C</italic>.</p>
    </sec>
    <sec sec-type="cases">
      <title>Test Case 2: Bacterial SSU rRNA</title>
      <p>Another case is the 16S.B.ALL data set by <xref ref-type="bibr" rid="mst010-B32">Mirarab et al. (2012)</xref>. It consists of an MSA of 13,822 bacterial SSU rRNA sequences, taken from the Gutell Comparative RNA Website (CRW) (<xref ref-type="bibr" rid="mst010-B7">Cannone et al. 2002</xref>) and 138,210 fragmentary sequences, which are originally included in the CRW alignment but ungapped and artificially truncated. In <xref ref-type="bibr" rid="mst010-B23">Katoh and Standley (2013)</xref>, we used a subset (13,821 fragmentary sequences) prepared by <xref ref-type="bibr" rid="mst010-B32">Mirarab et al. (2012)</xref>. In addition to this subset, here we use the full data set (138,210 fragmentary sequences), to examine the scalability. Suppose a situation where we already have a manually curated (or backbone) MSA and a newly determined set of many fragmentary sequences in a metagenomics project, and we need an entire MSA of them.</p>
      <p>The first four lines in <xref ref-type="table" rid="mst010-T2">table 2</xref> (case 1) show the performances of various options for such an analysis, with a relatively small data set (13,822 sequences in the existing alignment × 13,821 fragments). The accuracy of each resulting MSA was evaluated by comparing the MSA with the original CRW alignment. CPU time and wall-clock time for each method are also listed. As the sequences in this data set are highly conserved, the difference in accuracy between the default (<monospace>––</monospace><monospace>multipair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) and the faster option (<monospace>––</monospace><monospace>6merpair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) is small.</p>
      <p>Again, the tradeoff between accuracy and speed does not hold. The application of a computationally expensive method based on L-INS-1 (<monospace>––</monospace><monospace>localpair </monospace><monospace>––</monospace><monospace>add</monospace>) has no advantage, because the extra computational time is spent on the comparison of nonoverlapping fragmentary sequences, which have no reasonable solutions.</p>
      <p>The “profile alignment” line in <xref ref-type="table" rid="mst010-T2">table 2</xref> shows results of the second type of misuse of profile alignment (discussed earlier), in which the given alignment is converted to a profile and each new sequence is separately aligned to the profile. This result clearly indicates that the application of profile alignment must be avoided in this case, too. Users do not need to be too worried about this misuse, because this calculation is disabled in MAFFT unless the user modifies the code or writes a wrapper script.</p>
      <p>The last two lines in <xref ref-type="table" rid="mst010-T2">table 2</xref> (Cases 2 and 3) show the performance of the fast option (<monospace>––</monospace><monospace>6merpair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) for a larger number (138,210) of fragmentary sequences. The number of sequences in the existing alignment is 1,000 and 13,822 in cases 2 and 3, respectively. This fast option gives a reasonable quality of result in a reasonable computing time. At present, the default option (<monospace>––</monospace><monospace>multipair </monospace><monospace>––</monospace><monospace>addfragments</monospace>) cannot handle cases 2 and 3. Simulation-based benchmarks in <xref ref-type="bibr" rid="mst010-B20">Katoh and Frith (2012)</xref> suggested that, for cases with more divergent sequences, the accuracy of the default option is higher than that of the fast option. We are now trying to improve the scalability of the default option.</p>
    </sec>
  </sec>
  <sec>
    <title>Parallelization</title>
    <p>MAFFT version 7 has an option for parallel processing, <monospace>––</monospace><monospace>thread</monospace> (<xref ref-type="bibr" rid="mst010-B27">Katoh and Toh 2010</xref>). This feature is currently supported on Mac OS X in addition to Linux, but not yet supported on Windows for technical reasons. With the <monospace>––</monospace><monospace>thread</monospace>
<italic>n</italic> option, it runs in parallel with <italic>n</italic> threads. The number of threads can be automatically determined by <monospace>––</monospace><monospace>thread </monospace><monospace>–</monospace><monospace>1</monospace>. This option sets the number of threads as the number of physical cores, not the number of logical cores in Intel’s hyperthreaded CPUs.</p>
    <p>For progressive methods, the result with the multithread version is identical to that of the serial processing version. However, for iterative refinement methods, the results are not always identical. We confirmed that the accuracy of the parallel version in this case is comparable with that of the serial version (<xref ref-type="bibr" rid="mst010-B27">Katoh and Toh 2010</xref>). The efficiency of parallelization depends on the alignment strategy. In the case of the <monospace>––</monospace><monospace>addfragments</monospace> option, the efficiency is acceptably high as shown in <xref ref-type="table" rid="mst010-T2">table 2</xref>.</p>
  </sec>
  <sec>
    <title>Utility Options</title>
    <p>MAFFT version 7 also has several enhanced options for peripheral functions.</p>
    <sec>
      <title>Estimating the Direction of DNA Sequences</title>
      <p>In the case of nucleotide alignments, if some of input sequences have an incorrect direction relative to the other sequences, the directions can be automatically adjusted by the <monospace>––</monospace><monospace>adjustdirection</monospace> option. We use an algorithm with a time complexity of <inline-formula><inline-graphic xlink:href="mst010i1.jpg"/></inline-formula>, where <italic>n</italic> is the number of sequences (<xref ref-type="bibr" rid="mst010-B23">Katoh and Standley 2013</xref>). It is slow when the distances are calculated with DP. However, when the distance is rapidly calculated based on the number of shared 6mers, the speed is reasonable. This option is also available on the web version, with the “Adjust direction” button.</p>
      <p>MAFFT cannot handle more complicated sequences with genomic rearrangements (translocations, duplications, or inversions). The web version of MAFFT displays dot plots between the first sequence and the remaining sequences, using the LAST local alignment program (<xref ref-type="bibr" rid="mst010-B28">Kiełbasa et al. 2011</xref>), for every nucleotide alignment run. By viewing the dot plots, a user can easily check for genomic rearrangements and the directions of input sequences. See <xref ref-type="bibr" rid="mst010-B23">Katoh and Standley (2013)</xref> for details and an example.</p>
    </sec>
    <sec>
      <title>Input/Output</title>
      <p>MAFFT version 7 has several enhancements in the flexibility of input/output. The following options related to input/output are available and can be combined with other options.
<list list-type="simple"><list-item><p><monospace>––</monospace><monospace>anysymbol</monospace> If the input data include unusual letters, like U, J, etc., (in the case of protein data), MAFFT stops by default. The <monospace>––</monospace><monospace>anysymbol</monospace> option allows these letters and nonalphabetical letters.</p></list-item><list-item><p><monospace>––</monospace><monospace>preservecase</monospace><monospace> </monospace>By default, amino acid sequences are converted to upper case and nucleotide sequences are converted to lower case. This behavior can be changed by using the <monospace>––</monospace><monospace>preservecase</monospace> option.</p></list-item><list-item><p><monospace>––</monospace><monospace>reorder</monospace><monospace> </monospace>The order of sequences is the same as the input sequences by default, but the sequences can be sorted according to similarity to each other by the <monospace>––</monospace><monospace>reorder</monospace> option.</p></list-item><list-item><p><monospace>––</monospace><monospace>phylipout</monospace><monospace>a</monospace>nd <monospace>––<monospace>clustalout</monospace></monospace><monospace> </monospace>The output format is multi-fasta by default, but the phylip (interleaved) format and the clustal format can be selected.</p></list-item></list>
</p>
    </sec>
    <sec>
      <title>Guide Tree and Phylogenetic Positions of New Sequences</title>
      <p>Users can check the guide tree by using the <monospace>––</monospace><monospace>treeout</monospace> option. In the case of <monospace>––</monospace><monospace>addfragments</monospace>, the estimated phylogenetic positions of new sequences are shown together with the estimated tree of the existing alignment. The alignment calculation is performed based on this phylogenetic estimation. It is also possible to compute such phylogenetic information only, without alignment, by the <monospace>––</monospace><monospace>retree 0</monospace> option. An example of output is shown in <xref ref-type="fig" rid="mst010-F3">Figure 3</xref><italic>A</italic>.
<fig id="mst010-F3" position="float"><label>F<sc>ig</sc>. 3.</label><caption><p>(<italic>A</italic>) A part of output of the <monospace>––</monospace><monospace>treeout</monospace> option showing the phylogenetic positions of new sequences (<monospace>new#</monospace>) in the tree of the existing alignment (<monospace>backbone#</monospace>), estimated before the alignment calculation. This file also shows a Newick format tree of the existing alignment (not shown in this figure). For each new sequence, the nearest sequence in the existing alignment (<monospace>nearest sequence</monospace>), approximate distance to the nearest sequence (<monospace>approximate distance</monospace>), and the members of the sister group (<monospace>sister group</monospace>) are shown. (<italic>B</italic>) Graphical representation of (<italic>A</italic>).</p></caption><graphic xlink:href="mst010f3p"/></fig></p>
      <p>Note that this phylogenetic information is roughly estimated <italic>before</italic> the MSA calculation, not based on the MSA. Especially, with the fast option, <monospace>––</monospace><monospace>6merpair</monospace>, the estimation is very rough. With the <monospace>––</monospace><monospace>multipair</monospace> option (default), the estimation is expected to be better, but it needs a relatively long computational time. For more rigorous estimation of phylogenetic positions of new sequences, specially designed tools, such as pplacer (<xref ref-type="bibr" rid="mst010-B31">Matsen et al. 2010</xref>), PaPaRa (<xref ref-type="bibr" rid="mst010-B4">Berger and Stamatakis 2011</xref>), PAGAN (<xref ref-type="bibr" rid="mst010-B30">Löytynoja et al. 2012</xref>), SEPP (<xref ref-type="bibr" rid="mst010-B32">Mirarab et al. 2012</xref>), or combinations of them including MAFFT, should be tried.</p>
    </sec>
  </sec>
  <sec>
    <title>Parameters</title>
    <p>For amino acid alignment, MAFFT uses the BLOSUM62 matrix by default. For nucleotide alignment, a 200PAM log-odds scoring matrix is generated assuming that the transition rate is twice the transversion rate. These matrices are suitable for aligning distantly related sequences. We selected these default parameters based on an expectation that, if the program works well for difficult (distantly related) cases, it should also work well for easy cases.</p>
    <p>It is unclear whether this expectation is always correct. For example, in a benchmark using simulated protein sequences (<xref ref-type="bibr" rid="mst010-B30">Löytynoja et al. 2012</xref>) generated by INDELiBLE (<xref ref-type="bibr" rid="mst010-B11">Fletcher and Yang 2009</xref>), when we tested a more stringent scoring matrix, JTT 1PAM (<xref ref-type="bibr" rid="mst010-B17">Jones et al. 1992</xref>) with weaker gap penalties than the default, the benchmark scores were considerably improved. Despite this observation, we consistently used the default parameters in the benchmark in <xref ref-type="bibr" rid="mst010-B20">Katoh and Frith (2012)</xref>, because it does not make sense to arbitrarily adjust parameters to a simulation setting. This observation suggests that the current default parameters of MAFFT might not be very suitable for aligning closely related sequences. However, this idea must be checked using actual biological sequences.</p>
    <p>User can select different scoring matrices other than the default. For amino acid alignment, <monospace>––</monospace><monospace>bl 45</monospace>, <monospace>––</monospace><monospace>bl 62</monospace>, <monospace>––</monospace><monospace>bl 80</monospace>, <monospace>––</monospace><monospace>jtt N</monospace>, and <monospace>––</monospace><monospace>tm N</monospace> are accepted, where <monospace>N</monospace> is an expected evolutionary distance among input sequences. The <monospace>––</monospace><monospace>bl</monospace>, <monospace>––</monospace><monospace>jtt</monospace>, and <monospace>––</monospace><monospace>tm</monospace> options mean BLOSUM (Henikoff S and Henikoff JG <xref ref-type="bibr" rid="mst010-B15">1992</xref>), JTT (<xref ref-type="bibr" rid="mst010-B17">Jones et al. 1992</xref>), and a transmembrane model (<xref ref-type="bibr" rid="mst010-B18">Jones et al. 1994</xref>), respectively. A user-defined scoring matrix can also be accepted, by <monospace>––</monospace><monospace>aamatrix</monospace>. For nucleotide alignments, <monospace>––</monospace><monospace>kimura N</monospace> is accepted, where <monospace>N</monospace> is an expected evolutionary distance among input sequences. Gap penalties can be adjusted by <monospace>––</monospace><monospace>op</monospace>, <monospace>––</monospace><monospace>exp</monospace>, <monospace>––</monospace><monospace>lop</monospace>, and <monospace>––</monospace><monospace>lexp</monospace> options.</p>
    <p>One possible extension is to use different scoring matrices and gap penalties for different sequence pairs according to the divergence level, like ClustalW (<xref ref-type="bibr" rid="mst010-B46">Thompson et al. 1994</xref>). More studies using actual sequence data will be necessary before implementing this extension. It will also be necessary to adjust gap penalties, preferably based on a realistic evolutionary model of insertions and deletions.</p>
  </sec>
  <sec>
    <title>Use of Structural Information</title>
    <p>We have discussed possible improvements in MSAs of closely related sequences in the previous section. MSA of distantly related sequences is still a challenging problem.</p>
    <sec sec-type="cases">
      <title>Test Case 3: PIN Domain</title>
      <p><xref ref-type="fig" rid="mst010-F4">Figure 4</xref> shows a typical limitation of sequence level alignment for a highly divergent set of three PIN-domain containing proteins: human regnase-1, VPA0982 from <italic>Vibrio parahaemolyticus</italic>, nuclease domain of taq polymerase from <italic>Thermus aquaticus</italic>. These three proteins share a magnesium-binding site composed of three conserved aspartic acids. <xref ref-type="fig" rid="mst010-F4">Figure 4</xref><italic>A</italic> shows a superposition of the three structures (Protein Databank identifiers 3v33, 2qip, and 1taq, respectively). The middle aspartic acid is indicated by sphere-representation, colored red. In <xref ref-type="fig" rid="mst010-F4">Figure 4</xref><italic>B</italic>, a typical MSA (by MAFFT-L-INS-i) is shown wherein the middle aspartic acid position is misaligned. In <xref ref-type="fig" rid="mst010-F4">Figure 4</xref><italic>C</italic>, a structure-informed MSA (described below), with the middle aspartic acid correctly aligned, is shown.
<fig id="mst010-F4" position="float"><label><bold>F<sc>ig</sc>. 4</bold>.</label><caption><p>(<italic>A</italic>) Superposition of 3v33, 2qip, and 1taq structures visualized by PyMOL (<xref ref-type="bibr" rid="mst010-B39">Schrödinger LLC 2010</xref>). (<italic>B</italic>) MAFFT-L-INS-i sequence alignment displayed on jalview (<xref ref-type="bibr" rid="mst010-B47">Waterhouse et al. 2009</xref>). Misaligned Ds are highlighed in red. (<italic>C</italic>) Structure-informed MSA with correctly aligned Ds; Alpha helices and beta sheets are shown in blue and yellow, respectively, in (<italic>A–C</italic>).</p></caption><graphic xlink:href="mst010f4p"/></fig></p>
    </sec>
    <sec>
      <title>Strategy for Integrating Structural Alignments and MAFFT</title>
      <p>It has long been known that structural information can be used to improve MSA calculations. This was the basis of the 3D Coffee program (<xref ref-type="bibr" rid="mst010-B35">O’Sullivan et al. 2004</xref>), and later the PROMALS3D package (<xref ref-type="bibr" rid="mst010-B36">Pei et al. 2008</xref>). Here, we address incorporation of protein structural information in MAFFT-based MSA construction. There are both conceptual issues and technical issues that complicate the process. Conceptually, we have to define structural similarity in such a way that it can easily be used in sequence alignments. We discuss our approach to this problem below in the context of integrating MAFFT with the structural alignment program ASH (<xref ref-type="bibr" rid="mst010-B43">Standley et al. 2004</xref>, <xref ref-type="bibr" rid="mst010-B42">2007</xref>). On the technical level, structural information complicates matters simply because protein structures contain more information and more noise than sequence information.</p>
      <p>Here, we focus on one essential feature of ASH: the equivalence score that is used to define structural similarity. A particular element in the structural similarity matrix takes the form of a Gaussian-shaped function of the inter-residue distance
<disp-formula><graphic xlink:href="mst010um1"/></disp-formula>
where <italic>d<sub>ij</sub></italic> is the distance between two alpha carbons <italic>i</italic> and <italic>j</italic> in the two input structures and <italic>d</italic><sub>0</sub> is a parameter that defines tolerance in the score. The default behavior is to set <italic>d</italic><sub>0</sub> to 4 Å. The goal of ASH is to maximize the sum of e<italic><sub>ij</sub></italic> over aligned residues. The residue-level equivalences, which form the basis of all ASH alignments, provide a convenient route for combining MAFFT and ASH. We can, for example, set a threshold value of e<italic><sub>ij</sub></italic> and incorporate highly confident parts of the alignment into MAFFT to “seed” the MSA calculation. If we consider the case of the three PIN domain-containing structures in <xref ref-type="fig" rid="mst010-F4">Figure 4</xref>, we can first compute structural alignments for the three unique pairs using ASH (ash_3v33A-2qipA, ash_3v33A-1taqA, and ash_2qipA-1taqA). If we set a threshold for residue equivalence at <inline-formula><inline-graphic xlink:href="mst010i2.jpg"/></inline-formula>0.5, we can then combine the equivalence-filtered alignments into MAFFT using the seed option (<xref ref-type="bibr" rid="mst010-B19">Katoh et al. 2009</xref>):
<disp-quote content-type="extract"><p><monospace>mafft-linsi <monospace>--</monospace></monospace><monospace>seed ash_3v33A-2qipA <monospace>\ --</monospace></monospace><monospace>seed ash_3v33A-1taqA</monospace><monospace>\</monospace></p><p><monospace>--</monospace><monospace>seed ash_2qipA-1taqA \ sequences <monospace>&gt;</monospace></monospace><monospace> output</monospace></p></disp-quote>
Because the sequence identities between the aligned structures are low, we see an improvement in the resulting MSA relative to conventional MAFFT (<xref ref-type="fig" rid="mst010-F4">Fig. 4</xref>). Based on this approach, we are developing an integrative service for protein structure-informed MSA construction.</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The authors thank Drs. Wen Chen, C. André Lévesque, and Christopher Lewis, Agriculture and Agri-Food Canada, for permitting the use of the ITS data in this article and providing other challenging problems. This work was supported by <funding-source>Platform for Drug Discovery, Informatics, and Structural Life Science from the Ministry of Education, Culture, Sports, Science and Technology, Japan</funding-source>, and the <funding-source>Computational Biology Research Center, National Institute of Advanced Industrial Science and Technology (AIST), Japan</funding-source>.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="mst010-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
        </person-group>
        <article-title>Generalized affine gap costs for protein sequence alignment</article-title>
        <source>Proteins</source>
        <year>1998</year>
        <volume>32</volume>
        <fpage>88</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="pmid">9672045</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barton</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Sternberg</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>A strategy for the rapid multiple alignment of protein sequences. Confidence levels from tertiary structure comparisons</article-title>
        <source>J Mol Biol.</source>
        <year>1987</year>
        <volume>198</volume>
        <fpage>327</fpage>
        <lpage>337</lpage>
        <pub-id pub-id-type="pmid">3430611</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berger</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Munson</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>A novel randomized iterative strategy for aligning multiple protein sequences</article-title>
        <source>Comput Appl Biosci.</source>
        <year>1991</year>
        <volume>7</volume>
        <fpage>479</fpage>
        <lpage>484</lpage>
        <pub-id pub-id-type="pmid">1747779</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berger</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Aligning short reads to reference alignments and trees</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2068</fpage>
        <lpage>2075</lpage>
        <pub-id pub-id-type="pmid">21636595</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blackburne</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Whelan</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Class of multiple sequence alignment algorithm affects genomic analysis</article-title>
        <source>Mol Biol Evol.</source>
        <year>2012a</year>
        <comment>Advance access published December 4, 2012, doi:10.1093/molbev/mss256</comment>
      </element-citation>
    </ref>
    <ref id="mst010-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blackburne</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Whelan</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Measuring the distance between multiple sequence alignments</article-title>
        <source>Bioinformatics</source>
        <year>2012b</year>
        <volume>28</volume>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="pmid">22199391</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cannone</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Subramanian</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schnare</surname>
            <given-names>MN</given-names>
          </name>
          <etal/>
          <collab>(14 co-authors)</collab>
        </person-group>
        <article-title>The comparative RNA web (CRW) site: an online database of comparative sequence and structure information for ribosomal, intron, and other RNAs</article-title>
        <source>BMC Bioinformatics</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>2</fpage>
        <pub-id pub-id-type="pmid">11869452</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cole</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Cardenas</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
          <collab>(11 co-authors)</collab>
        </person-group>
        <article-title>The ribosomal database project: improved alignments and new tools for rRNA analysis</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>D141</fpage>
        <lpage>D145</lpage>
        <pub-id pub-id-type="pmid">19004872</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dessimoz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gil</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic assessment of alignments reveals neglected tree signal in gaps</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R37</fpage>
        <pub-id pub-id-type="pmid">20370897</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Doolittle</surname>
            <given-names>RF</given-names>
          </name>
        </person-group>
        <article-title>Progressive sequence alignment as a prerequisite to correct phylogenetic trees</article-title>
        <source>J Mol Evol.</source>
        <year>1987</year>
        <volume>25</volume>
        <fpage>351</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="pmid">3118049</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fletcher</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>INDELible: a flexible simulator of biological sequence evolution</article-title>
        <source>Mol Biol Evol.</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>1879</fpage>
        <lpage>1888</lpage>
        <pub-id pub-id-type="pmid">19423664</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Golubchik</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wise</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Easteal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jermiin</surname>
            <given-names>LS</given-names>
          </name>
        </person-group>
        <article-title>Mind the gaps: evidence of bias in estimates of multiple sequence alignments</article-title>
        <source>Mol Biol Evol.</source>
        <year>2007</year>
        <volume>24</volume>
        <fpage>2433</fpage>
        <lpage>2442</lpage>
        <pub-id pub-id-type="pmid">17709332</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gotoh</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Optimal alignment between groups of sequences and its application to multiple sequence alignment</article-title>
        <source>Comput Appl Biosci.</source>
        <year>1993</year>
        <volume>9</volume>
        <fpage>361</fpage>
        <lpage>370</lpage>
        <pub-id pub-id-type="pmid">8324637</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gotoh</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>A weighting system and algorithm for aligning many phylogenetically related sequences</article-title>
        <source>Comput Appl Biosci.</source>
        <year>1995</year>
        <volume>11</volume>
        <fpage>543</fpage>
        <lpage>551</lpage>
        <pub-id pub-id-type="pmid">8590178</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henikoff</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Henikoff</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>Amino acid substitution matrices from protein blocks</article-title>
        <source>Proc Natl Acad Sci U S A.</source>
        <year>1992</year>
        <volume>89</volume>
        <fpage>10915</fpage>
        <lpage>10919</lpage>
        <pub-id pub-id-type="pmid">1438297</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Sharp</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>CLUSTAL: a package for performing multiple sequence alignment on a microcomputer</article-title>
        <source>Gene</source>
        <year>1988</year>
        <volume>73</volume>
        <fpage>237</fpage>
        <lpage>244</lpage>
        <pub-id pub-id-type="pmid">3243435</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>The rapid generation of mutation data matrices from protein sequences</article-title>
        <source>Comput Appl Biosci.</source>
        <year>1992</year>
        <volume>8</volume>
        <fpage>275</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="pmid">1633570</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>A mutation data matrix for transmembrane proteins</article-title>
        <source>FEBS Lett.</source>
        <year>1994</year>
        <volume>339</volume>
        <fpage>269</fpage>
        <lpage>275</lpage>
        <pub-id pub-id-type="pmid">8112466</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Asimenos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Multiple alignment of DNA sequences with MAFFT</article-title>
        <source>Methods Mol Biol.</source>
        <year>2009</year>
        <volume>537</volume>
        <fpage>39</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="pmid">19378139</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Adding unaligned sequences into an existing alignment using MAFFT and LAST</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>3144</fpage>
        <lpage>3146</lpage>
        <pub-id pub-id-type="pmid">23023983</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kuma</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Miyata</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>MAFFT version 5: improvement in accuracy of multiple sequence alignment</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>511</fpage>
        <lpage>518</lpage>
        <pub-id pub-id-type="pmid">15661851</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Misawa</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kuma</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Miyata</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>3059</fpage>
        <lpage>3066</lpage>
        <pub-id pub-id-type="pmid">12136088</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Standley</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>MAFFT: iterative refinement and additional methods</article-title>
        <source>Methods Mol Biol.</source>
        <year>Forthcoming 2013</year>
      </element-citation>
    </ref>
    <ref id="mst010-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>PartTree: An algorithm to build an approximate tree from a large number of unaligned sequences</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>372</fpage>
        <lpage>374</lpage>
        <pub-id pub-id-type="pmid">17118958</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Improved accuracy of multiple ncRNA alignment by incorporating structural information into a MAFFT-based framework</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008a</year>
        <volume>9</volume>
        <fpage>212</fpage>
        <pub-id pub-id-type="pmid">18439255</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Recent developments in the MAFFT multiple sequence alignment program</article-title>
        <source>Brief Bioinform.</source>
        <year>2008b</year>
        <volume>9</volume>
        <fpage>286</fpage>
        <lpage>298</lpage>
        <pub-id pub-id-type="pmid">18372315</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Parallelization of the MAFFT multiple sequence alignment program</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1899</fpage>
        <lpage>1900</lpage>
        <pub-id pub-id-type="pmid">20427515</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiełbasa</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Horton</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Adaptive seeds tame genomic sequence comparison</article-title>
        <source>Genome Res.</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>487</fpage>
        <lpage>493</lpage>
        <pub-id pub-id-type="pmid">21209072</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letsch</surname>
            <given-names>HO</given-names>
          </name>
          <name>
            <surname>Kuck</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stocsits</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Misof</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>The impact of rRNA secondary structure consideration in alignment and tree reconstruction: simulated data and a case study on the phylogeny of hexapods</article-title>
        <source>Mol Biol Evol.</source>
        <year>2010</year>
        <volume>27</volume>
        <fpage>2507</fpage>
        <lpage>2521</lpage>
        <pub-id pub-id-type="pmid">20530152</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Löytynoja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vilella</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Accurate extension of multiple sequence alignments using a phylogeny-aware graph algorithm</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1684</fpage>
        <lpage>1691</lpage>
        <pub-id pub-id-type="pmid">22531217</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matsen</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Kodner</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Armbrust</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>pplacer: linear time maximum-likelihood and Bayesian phylogenetic placement of sequences onto a fixed reference tree</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>538</fpage>
        <pub-id pub-id-type="pmid">21034504</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>SEPP: SATé-enabled phylogenetic placement</article-title>
        <source>Pac Symp Biocomput.</source>
        <year>2012</year>
        <volume>17</volume>
        <fpage>247</fpage>
        <lpage>258</lpage>
        <pub-id pub-id-type="pmid">22174280</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B48">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nilsson</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Veldre</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Unterseher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Amend</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bergsten</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kristiansson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ryberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jumpponen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Abarenkov</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>An open source software package for automated extraction of ITS1 and ITS2 from fungal ITS sequences for use in high-throughput community assays and molecular ecology</article-title>
        <source>Fungal Ecology</source>
        <year>2010</year>
        <volume>3</volume>
        <fpage>284</fpage>
        <lpage>287</lpage>
      </element-citation>
    </ref>
    <ref id="mst010-B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Holm</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>COFFEE: an objective function for multiple sequence alignments</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>407</fpage>
        <lpage>422</lpage>
        <pub-id pub-id-type="pmid">9682054</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nuin</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Tillier</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <article-title>The accuracy of several multiple sequence alignment programs for proteins</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>471</fpage>
        <pub-id pub-id-type="pmid">17062146</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Sullivan</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Suhre</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Abergel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>3DCoffee: combining protein sequences and structures within multiple sequence alignments</article-title>
        <source>J Mol Biol.</source>
        <year>2004</year>
        <volume>340</volume>
        <fpage>385</fpage>
        <lpage>395</lpage>
        <pub-id pub-id-type="pmid">15201059</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pei</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>BH</given-names>
          </name>
          <name>
            <surname>Grishin</surname>
            <given-names>NV</given-names>
          </name>
        </person-group>
        <article-title>PROMALS3D: a tool for multiple protein sequence and structure alignments</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>2295</fpage>
        <lpage>2300</lpage>
        <pub-id pub-id-type="pmid">18287115</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Punta</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Coggill</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Eberhardt</surname>
            <given-names>RY</given-names>
          </name>
          <etal/>
          <collab>(16 co-authors)</collab>
        </person-group>
        <article-title>The Pfam protein families database</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>D290</fpage>
        <lpage>D301</lpage>
        <pub-id pub-id-type="pmid">22127870</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B38">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sahraeian</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Yoon</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>PicXAA-R: efficient structural alignment of multiple RNA sequences using a greedy approach</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>S38</fpage>
        <pub-id pub-id-type="pmid">21342569</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B39">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schrödinger</surname>
            <given-names>LLC</given-names>
          </name>
        </person-group>
        <article-title>The PyMOL Molecular Graphics System, Version 1.3r1. Portland</article-title>
        <year>2010</year>
        <comment>Oregon: Schrödinger, LLC</comment>
      </element-citation>
    </ref>
    <ref id="mst010-B40">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sievers</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dineen</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
          <collab>(12 co-authors)</collab>
        </person-group>
        <article-title>Fast scalable generation of high-quality protein multiple sequence alignments using Clustal Omega</article-title>
        <source>Mol Syst Biol.</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>539</fpage>
        <pub-id pub-id-type="pmid">21988835</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B41">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sigrist</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Cerutti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>de Castro</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Langendijk-Genevaux</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Bulliard</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bairoch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hulo</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>PROSITE, a protein domain database for functional characterization and annotation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>D161</fpage>
        <lpage>D166</lpage>
        <pub-id pub-id-type="pmid">19858104</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B42">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Standley</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Ash structure alignment package: sensitivity and selectivity in domain classification</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>116</fpage>
        <pub-id pub-id-type="pmid">17407606</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B43">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Standley</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Detecting local structural similarity in proteins by maximizing number of equivalent residues</article-title>
        <source>Proteins</source>
        <year>2004</year>
        <volume>57</volume>
        <fpage>381</fpage>
        <lpage>391</lpage>
        <pub-id pub-id-type="pmid">15340925</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B44">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Buhler</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>PhyLAT: a phylogenetic local alignment tool</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1336</fpage>
        <lpage>1344</lpage>
        <pub-id pub-id-type="pmid">22492645</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B45">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tabei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kiryu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Asai</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A fast structural multiple alignment method for long RNA sequences</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>33</fpage>
        <pub-id pub-id-type="pmid">18215258</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B46">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1994</year>
        <volume>22</volume>
        <fpage>4673</fpage>
        <lpage>4680</lpage>
        <pub-id pub-id-type="pmid">7984417</pub-id>
      </element-citation>
    </ref>
    <ref id="mst010-B47">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waterhouse</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Procter</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Clamp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barton</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>Jalview version 2—a multiple sequence alignment editor and analysis workbench</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1189</fpage>
        <lpage>1191</lpage>
        <pub-id pub-id-type="pmid">19151095</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
