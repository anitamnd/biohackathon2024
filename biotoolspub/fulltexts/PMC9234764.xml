<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="publisher-id">molbev</journal-id>
    <journal-title-group>
      <journal-title>Molecular Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0737-4038</issn>
    <issn pub-type="epub">1537-1719</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9234764</article-id>
    <article-id pub-id-type="pmid">35647675</article-id>
    <article-id pub-id-type="doi">10.1093/molbev/msac119</article-id>
    <article-id pub-id-type="publisher-id">msac119</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01130</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>distAngsd: Fast and Accurate Inference of Genetic Distances for Next-Generation Sequencing Data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6551-2707</contrib-id>
        <name>
          <surname>Zhao</surname>
          <given-names>Lei</given-names>
        </name>
        <aff><institution>Section for Geogenetics, Globe Institute, University of Copenhagen</institution>, <addr-line>Øster Voldgade 5-7, 1350 København K</addr-line>, <country country="DK">Denmark</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0513-6591</contrib-id>
        <name>
          <surname>Nielsen</surname>
          <given-names>Rasmus</given-names>
        </name>
        <xref rid="msac119-cor1" ref-type="corresp"/>
        <!--rasmus_nielsen@berkeley.edu-->
        <aff><institution>Section for Geogenetics, Globe Institute, University of Copenhagen</institution>, <addr-line>Øster Voldgade 5-7, 1350 København K</addr-line>, <country country="DK">Denmark</country></aff>
        <aff><institution>Department of Integrative Biology, University of California</institution>, <addr-line>3040 Valley Life Sciences Building 3140, Berkeley, CA 94720-3140</addr-line>, <country country="US">USA</country></aff>
        <aff><institution>Department of Statistics, University of California</institution>, <addr-line>3040 Valley Life Sciences Building 3140, Berkeley, CA 94720-3140</addr-line>, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7576-5380</contrib-id>
        <name>
          <surname>Korneliussen</surname>
          <given-names>Thorfinn Sand</given-names>
        </name>
        <xref rid="msac119-cor1" ref-type="corresp"/>
        <!--tskorneliussen@sund.ku.dk-->
        <aff><institution>Section for Geogenetics, Globe Institute, University of Copenhagen</institution>, <addr-line>Øster Voldgade 5-7, 1350 København K</addr-line>, <country country="DK">Denmark</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Tamura</surname>
          <given-names>Koichiro</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="msac119-cor1"><bold>Corresponding authors:</bold> E-mails: <email>rasmus_nielsen@berkeley.edu</email>; <email>tskorneliussen@sund.ku.dk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-06-01">
      <day>01</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>6</issue>
    <elocation-id>msac119</elocation-id>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="msac119.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Commonly used methods for inferring phylogenies were designed before the emergence of high-throughput sequencing and can generally not accommodate the challenges associated with noisy, diploid sequencing data. In many applications, diploid genomes are still treated as haploid through the use of ambiguity characters; while the uncertainty in genotype calling—arising as a consequence of the sequencing technology—is ignored. In order to address this problem, we describe two new probabilistic approaches for estimating genetic distances: distAngsd-geno and distAngsd-nuc, both implemented in a software suite named distAngsd. These methods are specifically designed for next-generation sequencing data, utilize the full information from the data, and take uncertainty in genotype calling into account. Through extensive simulations, we show that these new methods are markedly more accurate and have more stable statistical behaviors than other currently available methods for estimating genetic distances—even for very low depth data with high error rates.</p>
    </abstract>
    <kwd-group>
      <kwd>phylogeny reconstruction</kwd>
      <kwd>genotype likelihood</kwd>
      <kwd>genetic distance</kwd>
      <kwd>high-throughput sequencing</kwd>
      <kwd>next-generation sequencing</kwd>
      <kwd>molecular evolution</kwd>
      <kwd>maximum likelihood</kwd>
      <kwd>expectation maximization</kwd>
    </kwd-group>
    <counts>
      <page-count count="14"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="msac119-s1">
    <title>Introduction</title>
    <p>While much of biology has been revolutionized by the availability of high-throughput next-generation sequencing, the state-of-art methods for calculating genetic distances used in phylogeny estimation have not changed much for the past several decades, and are still not properly modeling the uncertainty and idiosyncrasies associated with next-generation sequencing data. Modern sequencing technologies produce millions or billions of small DNA fragments through a massively parallel sequencing process. In re-sequencing studies, these fragments are then aligned to a (typically) haploid representation of the target genome. As the DNA sequences in these fragments have non-negligible error-rates, genotype likelihoods are calculated in order to model the uncertainty of genotypes arising from sequencing errors and from varying sequencing depth. These genotype likelihoods are defined as the probability of the observed sequencing data—at a particular position of the genome—as a function of the true (but unknown) genotype, which often is assumed to be diploid. Genotype likelihoods, therefore, capture all the uncertainty in the data regarding the true genotype.</p>
    <p>In phylogenetics, the estimation of genetic distances is based on continuous time Markov chain models of nucleotide substitution. The core concept is to model nucleotide substitution as a Markov process, while allowing for differences in substitution rates among the four different nucleotides and, possibly, variation in the substitution rate among sites. The simplest model is the Jukes and Cantor model, also called the JC69 model (<xref rid="msac119-B14" ref-type="bibr">Jukes and Cantor 1969</xref>), which assumes equal rates of substitutions between all base pairs. A series of other models developed in the 1980s and 1990s including the K80 (<xref rid="msac119-B16" ref-type="bibr">Kimura 1980</xref>), F81 (<xref rid="msac119-B7" ref-type="bibr">Felsenstein 1981</xref>), HKY85 (<xref rid="msac119-B12" ref-type="bibr">Hasegawa et al. 1985</xref>), F84 (<xref rid="msac119-B8" ref-type="bibr">Felsenstein and Churchill 1996</xref>), TN93 (<xref rid="msac119-B35" ref-type="bibr">Tamura and Nei 1993</xref>) relaxes this assumption by incorporating additional parameters, such as differences in the rate of transitions and transversions, and unequal equilibrium nucleotide frequencies. The most general commonly used model is the Generalized Time Reversible (GTR) model (<xref rid="msac119-B36" ref-type="bibr">Tavaré 1986</xref>), which is the most parameter-rich model that is still time-reversible. Relaxing the requirement of time-reversibility of the Markov chain allows for more parameter-rich models, in particular the unrestricted UNREST model of <xref rid="msac119-B40" ref-type="bibr">Yang (1994)</xref> which is a fully parameterized model with 12 parameters—one for each of the 12 possible substitution types. However, because of computational simplicity and tractability, most work in phylogenetics focuses on the GTR model. In this work we will also assume the GTR model as the basic model of nucleotide substitution—however, the results and methodology we develop can in principle be generalized to non-reversible models.</p>
    <p>The previously discussed substitution models were developed for haploid sequences of nucleotides. However, much data currently generated arise from the nuclear DNA of diploid organisms. Applying these models designed for haploid sequences to diploid data has been a challenge in many studies, especially due to the considerable genotyping uncertainty in much of the published sequencing data. Different approaches exist for handling heterozygous sites and uncertainty in genotype calling for phylogenetic analyses of diploid data. One approach is to construct haploid data by phasing the diploid data using computational approaches—e.g., using various extensions of PHASE (<xref rid="msac119-B34" ref-type="bibr">Stephens et al. 2001</xref>; <xref rid="msac119-B33" ref-type="bibr">Stephens and Donnelly 2003</xref>) or BEAGLE (<xref rid="msac119-B2" ref-type="bibr">Browning and Browning 2007</xref>). This is an approach that may work well for species where many individuals (&gt;100) have been re-sequenced or where large reference panels of individuals from the same species are already available. Unfortunately, for most phylogenetic analyses, such data will often not be available. Other approaches include: (1) ignoring all possible heterozygous sites, i.e. treating them as missing data (<xref rid="msac119-B27" ref-type="bibr">Nilsson et al. 2017</xref>; <xref rid="msac119-B1" ref-type="bibr">Árnason et al. 2018</xref>; <xref rid="msac119-B21" ref-type="bibr">Maldonado et al. 2019</xref>)—in this work, we call this approach <bold>NoAmbiguityGT</bold>; (2) representing possible heterozygous sites as IUPAC (The International Union of Pure and Applied Chemistry, <xref rid="msac119-B4" ref-type="bibr">Cornish-Bowden 1985</xref>) ambiguity codes (<xref rid="msac119-B17" ref-type="bibr">Klicka et al. 2014</xref>; <xref rid="msac119-B23" ref-type="bibr">Martin et al. 2014</xref>; <xref rid="msac119-B37" ref-type="bibr">Uckele et al. 2021</xref>)—termed <bold>AmbiguityGT</bold> in this work; (3) choosing a random nucleotide from the sequenced reads at each position (<xref rid="msac119-B31" ref-type="bibr">Skoglund et al. 2016</xref>; <xref rid="msac119-B39" ref-type="bibr">Yang et al. 2020</xref>)—<bold>RandomSEQ</bold> in this work; (4) making a consensus call of a single nucleotide based on the raw sequencing data, i.e., converting the diploid sequencing data into a haploid sequence by, for each site, selecting (one of) the most frequent nucleotides in the sequencing data (<xref rid="msac119-B22" ref-type="bibr">Manthey et al. 2016</xref>; <xref rid="msac119-B29" ref-type="bibr">Sass et al. 2016</xref>; <xref rid="msac119-B42" ref-type="bibr">Yuan et al. 2016</xref>)—<bold>ConsensusSEQ</bold> in this work; or (5) incorporating uncertainty using genotype likelihoods or other measurements of uncertainty, e.g., <bold>ngsDist</bold> (<xref rid="msac119-B38" ref-type="bibr">Vieira et al. 2015</xref>), which was applied in <xref rid="msac119-B3" ref-type="bibr">Choi and Purugganan (2018)</xref>, <xref rid="msac119-B11" ref-type="bibr">Gaunitz et al. (2018)</xref>, and <xref rid="msac119-B13" ref-type="bibr">Hu et al. (2018)</xref>. ngsDist does not perform genotype calling, but instead uses the diploid diallelic genotype likelihood to compute the average per site allelic differences by averaging over the joint posterior genotype probabilities. ngsDist was not devised for phylogenetic analyses and does not use an explicit model of nucleotide substitution.</p>
    <p>As we will show in the results section, all existing methods have serious drawbacks in simulated scenarios. All simulated scenarios presented in the manuscript are based on the topology shown in <xref rid="msac119-F1" ref-type="fig">figure 1</xref>. The first two approaches, AmbiguityGT and NoAmbituityGT, which perhaps are the most commonly used approaches, have previously been shown to cause strong biases in phylogenetic estimation (<xref rid="msac119-B20" ref-type="bibr">Lischer et al. 2014</xref>; <xref rid="msac119-B28" ref-type="bibr">Potts et al. 2014</xref>; <xref rid="msac119-B30" ref-type="bibr">Schrempf et al. 2016</xref>). The bias is not unidirectional: at low read depth (<inline-formula><mml:math id="IM1" display="inline" overflow="scroll"><mml:mo>≤</mml:mo></mml:math></inline-formula>1) these two methods will overestimate the genetic distance; whereas higher read depths (<inline-formula><mml:math id="IM2" display="inline" overflow="scroll"><mml:mo>≥</mml:mo></mml:math></inline-formula>5) will cause underestimation (see <xref rid="msac119-F2" ref-type="fig">fig. 2</xref> and <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S8, and Section S5.1, Supplementary Material</xref> online for further discussion).</p>
    <fig position="float" id="msac119-F1" fig-type="figure">
      <label>Fig. 1.</label>
      <caption>
        <p>Simulated divergence tree: Tree structure used for simulations. Two diploid individuals are of the genotypes <italic toggle="yes">ij</italic> and <italic toggle="yes">kl</italic>, respectively. The most recent common ancestor of <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> is A, and that of <italic toggle="yes">k</italic> and <italic toggle="yes">l</italic> is B. The divergence time of A and B is denoted as <inline-formula><mml:math id="IM3" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, while the time from <italic toggle="yes">A</italic> to <italic toggle="yes">i</italic> or <italic toggle="yes">j</italic> is <inline-formula><mml:math id="IM4" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, and the time from <italic toggle="yes">B</italic> to <italic toggle="yes">k</italic> or <italic toggle="yes">l</italic> is <inline-formula><mml:math id="IM5" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>. The divergence time between the two diploid individuals, <italic toggle="yes">t</italic>, is thus defined as <inline-formula><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>.</p>
      </caption>
      <graphic xlink:href="msac119f1" position="float"/>
    </fig>
    <fig position="float" id="msac119-F2" fig-type="figure">
      <label>Fig. 2.</label>
      <caption>
        <p>The (scaled) genetic distance estimations <inline-formula><mml:math id="IM7" display="inline" overflow="scroll"><mml:mo stretchy="false">(</mml:mo><mml:mspace width="3pt"/><mml:mrow><mml:mover><mml:mrow><mml:mspace width="-3pt"/><mml:mi>d</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> for (<italic toggle="yes">a</italic>) AmbiguityGT and (<italic toggle="yes">b</italic>) NoAmbiguityGT based on the simulation results. The average read depth <inline-formula><mml:math id="IM8" display="inline" overflow="scroll"><mml:mo>=</mml:mo></mml:math></inline-formula> 0.5, 0.75, 1, 5, 10, 20. True genetic distance <inline-formula><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.008</mml:mn></mml:math></inline-formula>, 0.01, 0.016. JC69 and GTR models were used. <inline-formula><mml:math id="IM10" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.004</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM11" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0025</mml:mn></mml:math></inline-formula>, see <xref rid="msac119-F1" ref-type="fig">figure 1</xref>. The default simulation setting was applied.</p>
      </caption>
      <graphic xlink:href="msac119f2" position="float"/>
    </fig>
    <p>The methods RandomSEQ and ConsensusSEQ do not perform genotype calling, but instead choose a representative nucleotide among all the available data for every site. RandomSEQ samples a random allele per site and the resulting data is equivalent to a sequencing study with a deterministic read depth of 1. ConsensusSEQ is based on constructing a haploid sequence by choosing the most frequently observed nucleotide in each site. As we will later show (<xref rid="msac119-F3" ref-type="fig">figs. 3</xref>, <xref rid="msac119-F4" ref-type="fig">4</xref> and <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S9, Supplementary Material</xref> online), both methods will be strongly affected by sequencing errors at low depths, although ConsensusSEQ can perform well at high sequencing depths.</p>
    <fig position="float" id="msac119-F3" fig-type="figure">
      <label>Fig. 3.</label>
      <caption>
        <p>The (scaled) genetic distance estimations (<inline-formula><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mi>d</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:math></inline-formula>) for distAngsd-nuc, distAngsd-geno, RandomSEQ, and ConsensusSEQ based on the simulation results under JC69 model. Average read depth <inline-formula><mml:math id="IM13" display="inline" overflow="scroll"><mml:mo>=</mml:mo></mml:math></inline-formula> 20, 10, 5, 1, 0.75, 0.5 for (<italic toggle="yes">a</italic>)–(<italic toggle="yes">f</italic>), respectively. True genetic distance <inline-formula><mml:math id="IM14" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.008</mml:mn></mml:math></inline-formula>, 0.01, 0.016. <inline-formula><mml:math id="IM15" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.004</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM16" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0025</mml:mn></mml:math></inline-formula>, see <xref rid="msac119-F1" ref-type="fig">figure 1</xref>. The default simulation setting was applied.</p>
      </caption>
      <graphic xlink:href="msac119f3" position="float"/>
    </fig>
    <fig position="float" id="msac119-F4" fig-type="figure">
      <label>Fig. 4.</label>
      <caption>
        <p>The (scaled) genetic distance estimations (<inline-formula><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mi>d</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:math></inline-formula>) for distAngsd-nuc, distAngsd-geno, RandomSEQ, and ConsensusSEQ based on the simulation results under GTR model. Average read depth <inline-formula><mml:math id="IM18" display="inline" overflow="scroll"><mml:mo>=</mml:mo></mml:math></inline-formula> 20, 10, 5, 1, 0.75, 0.5 for (<italic toggle="yes">a</italic>) to (<italic toggle="yes">f</italic>), respectively. True genetic distance <inline-formula><mml:math id="IM19" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.008</mml:mn></mml:math></inline-formula>, 0.01, 0.016. <inline-formula><mml:math id="IM20" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.004</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM21" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0025</mml:mn></mml:math></inline-formula>, see <xref rid="msac119-F1" ref-type="fig">figure 1</xref>. The default simulation setting was applied.</p>
      </caption>
      <graphic xlink:href="msac119f4" position="float"/>
    </fig>
    <p>The Bayesian approach in ngsDist assumes an infinite sites model that does not take recurrent mutations into account but more importantly it averages over the posterior probability distribution of genotypes when calculating distances. We will in the Results section show that this approach can result in highly biased estimates of genetic distances.</p>
    <p>Motivated by the statistical limitations of previous methods, we develop two new methods, <bold>distAngsd-geno</bold> and <bold>distAngsd-nuc</bold>, which are both maximum-likelihood (ML) estimators of the genetic distance. They differ from previous methods as they do not attempt genotype or haploid calling, but instead model the sequencing uncertainty while also using an explicit nucleotide substitution model. Through extensive simulations, and by applying our methods to real sequencing data, we show that the two novel methods outperform previous methods by having significantly less biases and smaller variances—especially in the context of low read depth, or small genome sizes. When using the methods for estimating phylogenetic trees on a real data set, we show that the phylogenetic trees estimated using the new methods have higher phylogenetic concordance with existing taxonomic categories than trees estimated using previous methods.</p>
  </sec>
  <sec sec-type="materials|methods" id="msac119-s4">
    <title>Materials and Methods</title>
    <p>Both distAngsd-geno and distAngsd-nuc share similar characteristics. They both pre-compute a genome-wide estimate of the joint distribution of either genotypes (distAngsd-geno) or nucleotides (distAngsd-nuc) in two individuals. This is accomplished by using genotype likelihoods or by directly using the quality scores associated with each nucleotide across all reads. The estimation of these joint distributions is free of assumptions regarding evolutionary models. Inference of genetic distance, <italic toggle="yes">d</italic>, using maximum likelihood based on models of molecular evolution, e.g., the JC69 model or the more realistic GTR model, then proceeds by treating the inferred joint distributions as pseudo-data (i.e., <inline-formula><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> below). The inference procedure, therefore, has two steps: (1) Maximum-likelihood inference of genome-wide joint distribution of alleles or genotypes, and (2) maximum-likelihood inference of genetic distances based on the results of step (1). This two-step approach ignores the statistical uncertainty introduced in step (1) and merely uses point estimates of joint distributions. However, for genome-wide data, the variances in the estimates of genotype or allele frequencies should be negligible, and as we will show, this procedure does in fact have good statistical properties for realistic parameters’ values.</p>
    <sec id="msac119-s4.1">
      <title>Estimation of Joint Distributions Using EM</title>
      <p>As accurate genotype calling is not possible with low read depth sequencing data, e.g., <xref rid="msac119-B26" ref-type="bibr">Nielsen et al. (2011)</xref>, we employ a likelihood approach to estimate the joint global distribution using the expectation maximization algorithm (EM) (<xref rid="msac119-B6" ref-type="bibr">Dempster et al. 1977</xref>).</p>
      <p>In distAngsd-geno, the joint genotype distribution is represented by a 10 by 10 matrix <inline-formula><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:math></inline-formula> where 10 is the total number of possible unphased genotypes in a diploid individual, i.e., {AA, AC, AG, AT, CC, CG, CT, GG, GT, TT}. Both rows and columns of <inline-formula><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:math></inline-formula> are indexed by these genotypes, and every element of <inline-formula><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, represents the proportion of the informative sites (sites where we have data for both individuals) where the true genotypes are given by <inline-formula><mml:math id="IM28" display="inline" overflow="scroll"><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM29" display="inline" overflow="scroll"><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>. Similarly in distAngsd-nuc, a 4 by 4 matrix <inline-formula><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:math></inline-formula> representing the joint distribution of nucleotides is estimated. Here, <inline-formula><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:math></inline-formula> is indexed by nucleotides, i.e., {A,C,G,T}, rather than the 10 possible genotypes.</p>
      <p>The <inline-formula><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:math></inline-formula> matrix used in distAngsd-geno is inferred via <xref rid="msac119-T2" ref-type="table">Algorithm 1</xref>, while distAngsd-nuc applies <xref rid="msac119-T3" ref-type="table">Algorithm 2</xref> in order to estimate <inline-formula><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:math></inline-formula>. The input of <xref rid="msac119-T2" ref-type="table">Algorithm 1</xref> are the genotype likelihoods, while the input in <xref rid="msac119-T3" ref-type="table">Algorithm 2</xref> are the likelihoods of all nucleotides given by the Phred-scaled base quality score in the read data. The objective function (i.e., eq. S3 for <inline-formula><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:math></inline-formula> and eq. S4 for <inline-formula><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:math></inline-formula>) is essentially the same as equation (1) in <xref rid="msac119-B18" ref-type="bibr">Korneliussen et al. (2014)</xref>, which is the two dimensional equivalent of the likelihood function presented in <xref rid="msac119-B15" ref-type="bibr">Keightley and Halligan (2011)</xref>, <xref rid="msac119-B19" ref-type="bibr">Li (2011)</xref>, and <xref rid="msac119-B25" ref-type="bibr">Nielsen et al. (2012)</xref>.</p>
      <table-wrap position="float" id="msac119-T2">
        <caption>
          <p><bold>Algorithm 1</bold>: EM estimation for <bold>M</bold>. EM algorithm for estimating the <inline-formula><mml:math id="IM36" display="inline" overflow="scroll"><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mn>10</mml:mn></mml:math></inline-formula> joint genotype distribution matrix <bold>M</bold>, where <inline-formula><mml:math id="IM37" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is the matrix <bold>M</bold> in the <italic toggle="yes">t</italic>th iteration and the function <inline-formula><mml:math id="IM38" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">GL</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the genotype likelihood of genotype <inline-formula><mml:math id="IM39" display="inline" overflow="scroll"><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> at site <italic toggle="yes">s</italic> in sample <italic toggle="yes">k</italic> (<inline-formula><mml:math id="IM40" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:math></inline-formula>).</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1"><bold>Input:</bold> Genotype likelihoods of sites;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><bold>Output:</bold><inline-formula><mml:math id="IM41" display="inline" overflow="scroll"><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mn>10</mml:mn></mml:math></inline-formula> matrix <inline-formula><mml:math id="IM42" display="inline" overflow="scroll"><mml:mspace width=".1em"/><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow></mml:math></inline-formula>;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">initialization: <inline-formula><mml:math id="IM43" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="-1.5pt"/><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula>, <inline-formula><mml:math id="IM44" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><bold>while</bold><italic toggle="yes">elements in</italic><bold>M</bold><italic toggle="yes">do not converge</italic> do</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> <inline-formula><mml:math id="IM45" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="-1.5pt"/><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> for <inline-formula><mml:math id="IM46" display="inline" overflow="scroll"><mml:mi>s</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> to <inline-formula><mml:math id="IM47" display="inline" overflow="scroll"><mml:mi mathvariant="normal">#</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:math></inline-formula> do</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">  if <italic toggle="yes">s</italic><italic toggle="yes">is an informative site</italic> then</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">   <inline-formula><mml:math id="IM48" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="-1.5pt"/><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="-1.5pt"/><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width=".1em"/><mml:mo>+</mml:mo><mml:mspace width=".1em"/></mml:math></inline-formula><inline-formula><mml:math id="IM49" display="inline" overflow="scroll"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">GL</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">GL</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">GL</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">GL</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:math></inline-formula>;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">  end</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> end</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> <inline-formula><mml:math id="IM50" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="-1.5pt"/><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="-1.5pt"/><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">#</mml:mi><mml:mtext mathvariant="italic">informative sites</mml:mtext></mml:mrow></mml:mfrac></mml:math></inline-formula>;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> <inline-formula><mml:math id="IM51" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">end</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="msac119-T3">
        <caption>
          <p><bold>Algorithm 2</bold>: EM estimation for matrix <bold>N</bold>. EM algorithm for estimating the <inline-formula><mml:math id="IM52" display="inline" overflow="scroll"><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:mn>4</mml:mn></mml:math></inline-formula> joint nucleotide distribution matrix <inline-formula><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="IM54" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is the matrix <inline-formula><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:math></inline-formula> in the <italic toggle="yes">t</italic>th iteration, and the function <inline-formula><mml:math id="IM56" display="inline" overflow="scroll"><mml:msub><mml:mi>q</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the likelihood function of the nucleotide <inline-formula><mml:math id="IM57" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> in the <inline-formula><mml:math id="IM58" display="inline" overflow="scroll"><mml:msub><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula>’th read at site <italic toggle="yes">s</italic> in sample <italic toggle="yes">l</italic>, <inline-formula><mml:math id="IM59" display="inline" overflow="scroll"><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> or 2. <inline-formula><mml:math id="IM60" display="inline" overflow="scroll"><mml:msub><mml:mi>q</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> can be obtained from the read quality scores.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1"><bold>Input:</bold> Reads data and their quality scores;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><bold>Output:</bold><inline-formula><mml:math id="IM61" display="inline" overflow="scroll"><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:mn>4</mml:mn></mml:math></inline-formula> matrix <inline-formula><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:mspace width=".1em"/></mml:mrow><mml:mi>N</mml:mi></mml:math></inline-formula>;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">initialization: <inline-formula><mml:math id="IM63" display="inline" overflow="scroll"><mml:mspace width=".1em"/><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>16</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula>, <inline-formula><mml:math id="IM64" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><bold>While</bold><italic toggle="yes">elements in</italic><inline-formula><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula><italic toggle="yes">do not converge</italic> do</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> <inline-formula><mml:math id="IM66" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> for <inline-formula><mml:math id="IM67" display="inline" overflow="scroll"><mml:mi>s</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> to <inline-formula><mml:math id="IM68" display="inline" overflow="scroll"><mml:mi mathvariant="normal">#</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:math></inline-formula> do</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">  for <inline-formula><mml:math id="IM69" display="inline" overflow="scroll"><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> to <inline-formula><mml:math id="IM70" display="inline" overflow="scroll"><mml:mi mathvariant="normal">#</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> do</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">   for <inline-formula><mml:math id="IM71" display="inline" overflow="scroll"><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> to <inline-formula><mml:math id="IM72" display="inline" overflow="scroll"><mml:mi mathvariant="normal">#</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> do</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">    <inline-formula><mml:math id="IM73" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">    <inline-formula><mml:math id="IM74" display="inline" overflow="scroll"><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mspace width=".1em"/><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mspace width=".1em"/><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>;</mml:mo></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">   end</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">  end</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> end</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> <inline-formula><mml:math id="IM75" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mfrac><mml:mrow><mml:mspace width=".1em"/><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">#</mml:mi><mml:mtext mathvariant="italic">sites</mml:mtext></mml:mrow></mml:munderover><mml:mi mathvariant="normal">#</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi mathvariant="normal">#</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>;</mml:mo></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> <inline-formula><mml:math id="IM76" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">end</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <sec id="msac119-s4.1.1">
        <title>Log-likelihood of distAngsd-geno Inference</title>
        <p>The log-likelihood function in distAngsd-geno given the inferred pseudo-observation matrix <inline-formula><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is defined as,<disp-formula id="M0001"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mtable columnalign="right left" rowspacing=".5em" columnspacing="thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:munder></mml:mstyle><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:munderover></mml:mstyle><mml:mi>log</mml:mi><mml:mspace width="0.2em"/><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>Here, the sum is over all possible unphased diallelic genotype nucleotide configurations and <inline-formula><mml:math id="IM78" display="inline" overflow="scroll"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM79" display="inline" overflow="scroll"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo></mml:math></inline-formula> are the <italic toggle="yes">i</italic>th and <italic toggle="yes">j</italic>th nucleotides of genotypes <inline-formula><mml:math id="IM80" display="inline" overflow="scroll"><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM81" display="inline" overflow="scroll"><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, respectively. <inline-formula><mml:math id="IM82" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the transition probability from nucleotide <inline-formula><mml:math id="IM83" display="inline" overflow="scroll"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="IM84" display="inline" overflow="scroll"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> given the genetic distance <italic toggle="yes">d</italic> between the two samples. <inline-formula><mml:math id="IM85" display="inline" overflow="scroll"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> is the stationary distribution of nucleotide <inline-formula><mml:math id="IM86" display="inline" overflow="scroll"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
      </sec>
      <sec id="msac119-s4.1.2">
        <title>Log-likelihood of distAngsd-nuc Inference</title>
        <p>The log-likelihood function of distAngsd-nuc given the inferred pseudo-observation matrix <inline-formula><mml:math id="IM87" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is,<disp-formula id="M0002"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mspace width=".1em"/><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mspace width=".1em"/><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:munder></mml:mstyle><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mspace width="0.2em"/><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="IM88" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the transition probability from nucleotide <inline-formula><mml:math id="IM89" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="IM90" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> given the genetic distance <italic toggle="yes">d</italic> between the two samples. <inline-formula><mml:math id="IM91" display="inline" overflow="scroll"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> is the stationary distribution of nucleotide <inline-formula><mml:math id="IM92" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>.</p>
      </sec>
      <sec id="msac119-s4.1.3">
        <title>Parameters of the Substitution Model</title>
        <p>The forms of <inline-formula><mml:math id="IM93" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mo>⋅</mml:mo><mml:mo>,</mml:mo><mml:mo>⋅</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="IM94" display="inline" overflow="scroll"><mml:msub><mml:mi>π</mml:mi><mml:mo>⋅</mml:mo></mml:msub></mml:math></inline-formula> and <italic toggle="yes">d</italic> in both equations (<xref rid="M0001" ref-type="disp-formula">1</xref>) and (<xref rid="M0002" ref-type="disp-formula">2</xref>) will be determined by the nucleotide substitution model (e.g., the JC69 or GTR model, see <xref rid="sup1" ref-type="supplementary-material">supplementary Section S3, Supplementary Material</xref> online for details). The genetic distance between two individuals, <italic toggle="yes">d</italic>, is a product of the divergence time <inline-formula><mml:math id="IM95" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> (as shown in <xref rid="msac119-F1" ref-type="fig">fig. 1</xref>) and the substitution rate, <inline-formula><mml:math id="IM96" display="inline" overflow="scroll"><mml:mi>μ</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="IM97" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>μ</mml:mi></mml:math></inline-formula>. Notice that this method, like other phylogenetic methods, estimate <italic toggle="yes">d</italic> but cannot independently estimate <italic toggle="yes">t</italic> and <inline-formula><mml:math id="IM98" display="inline" overflow="scroll"><mml:mi>μ</mml:mi></mml:math></inline-formula>. We then scale the nucleotide substitution rate matrices of the JC69 model and GTR model so that the mean number of substitutions occurring per base per scaled time unit is fixed to be 1, and <inline-formula><mml:math id="IM99" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula> represents the mean number of substitutions per site in the time interval. In the following, we will not distinguish between estimating <italic toggle="yes">d</italic> and estimating <italic toggle="yes">t</italic>. Also, notice that, similarly to classical phylogenetic methods, we here ignore complications from varying coalescence time and incomplete lineage sorting (See <xref rid="sup1" ref-type="supplementary-material">supplementary Section S6, Supplementary Material</xref> online for some further investigations on the effects on the estimation method of incomplete lineage sorting) between the two individuals. If the method is applied in settings where the coalescent process causes significant variation in <italic toggle="yes">t</italic>, the method is expected to estimate an average value of <italic toggle="yes">t</italic> for the two individuals.</p>
        <p>The detailed derivation of the EM algorithm for both proposed methods are given in <xref rid="sup1" ref-type="supplementary-material">supplementary Section S2, Supplementary Material</xref> online.</p>
      </sec>
    </sec>
    <sec id="msac119-s4.2">
      <title>Simulations and Comparisons to Previous Methods</title>
      <sec id="msac119-s4.2.1">
        <title>Simulations</title>
        <p>We will focus on the JC69 model and GTR model assuming all sites are variable. (i.e., no site is invariable). However, we also explore models where a proportion of sites are invariable in <xref rid="sup1" ref-type="supplementary-material">supplementary Section S3.5, Supplementary Material</xref> online.</p>
        <p>We simulate data following <xref rid="msac119-T4" ref-type="table">Algorithm 3</xref> assuming a diploid species. While distAngsd-geno assumes diploidy, distAngsd-nuc is applicable to species with other ploidies, but we here only compare the methods for the diploid case. The simulated phylogeny is described in <xref rid="msac119-F1" ref-type="fig">figure 1</xref>. The genotype likelihood model used in the simulations is the canonical genotype likelihood model (see also <xref rid="msac119-B24" ref-type="bibr">McKenna et al. 2010</xref> and <xref rid="sup1" ref-type="supplementary-material">supplementary Section S1, Supplementary Material</xref> online):<disp-formula id="UM0001"><mml:math id="UM1" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mspace width=".1em"/><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mspace width=".1em"/><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">If</mml:mi></mml:mrow><mml:mspace width=".1em"/><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="-15.5pt"/><mml:mrow><mml:mfrac><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mn>3</mml:mn></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">If</mml:mi></mml:mrow><mml:mspace width=".1em"/><mml:mi>l</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi><mml:mspace width=".1em"/><mml:mrow><mml:mi mathvariant="normal">and</mml:mi></mml:mrow><mml:mspace width=".1em"/><mml:mi>l</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mn>3</mml:mn></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">Otherwise</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>Here <italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>, <inline-formula><mml:math id="IM100" display="inline" overflow="scroll"><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo></mml:math></inline-formula>, and <inline-formula><mml:math id="IM101" display="inline" overflow="scroll"><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> is the error rate of the <italic toggle="yes">k</italic>th read in the focal site. <inline-formula><mml:math id="IM102" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mspace width=".1em"/><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mspace width=".1em"/><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the probability that the <italic toggle="yes">k</italic>th read at the focal site is called as nucleotide <italic toggle="yes">l</italic> given the true genotype in the site is <italic toggle="yes">ij</italic>.</p>
        <table-wrap position="float" id="msac119-T4">
          <caption>
            <p><bold>Algorithm 3</bold>: Simulation of sequencing data. Simulation scheme of two individuals with a shared ancestor. A simulation scheme considers both variable and invariable sites can be found in <xref rid="sup1" ref-type="supplementary-material">supplementary alg. S1, Supplementary Material</xref> online.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col valign="top" align="left" span="1"/>
            </colgroup>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1"><bold>Input:</bold> Substitution rate matrix <inline-formula><mml:math id="IM103" display="inline" overflow="scroll"><mml:mrow><mml:mspace width=".1em"/></mml:mrow><mml:mi>R</mml:mi></mml:math></inline-formula> (the stationary distribution of <inline-formula><mml:math id="IM104" display="inline" overflow="scroll"><mml:msub><mml:mi>π</mml:mi><mml:mo>⋅</mml:mo></mml:msub></mml:math></inline-formula> is known), divergence time <italic toggle="yes">t</italic>, <inline-formula><mml:math id="IM105" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM106" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, error rate <italic toggle="yes">e</italic>, mean read depth <inline-formula><mml:math id="IM107" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">RD</mml:mi></mml:mrow></mml:math></inline-formula>, genome length <italic toggle="yes">l</italic>;</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"><bold>Output:</bold> Read data and Genotype likelihoods across sites;</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <bold>Ancestral sequences construction:</bold>
                </td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">The ancestral nucleotide for sample A and B, denoted by <inline-formula><mml:math id="IM108" display="inline" overflow="scroll"><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM109" display="inline" overflow="scroll"><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, are simulated given <inline-formula><mml:math id="IM110" display="inline" overflow="scroll"><mml:mrow><mml:mspace width=".1em"/></mml:mrow><mml:mi>R</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="IM111" display="inline" overflow="scroll"><mml:msub><mml:mi>π</mml:mi><mml:mo>⋅</mml:mo></mml:msub></mml:math></inline-formula>, divergence time <inline-formula><mml:math id="IM112" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, and <italic toggle="yes">l</italic>. Sites are assumed to evolve independently;</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <bold>Sequence construction and calling:</bold>
                </td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">initialization: <inline-formula><mml:math id="IM113" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">GL</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">GL</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>;</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">for <inline-formula><mml:math id="IM114" display="inline" overflow="scroll"><mml:mi>j</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> to 2 do</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"> Two sequences <inline-formula><mml:math id="IM115" display="inline" overflow="scroll"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM116" display="inline" overflow="scroll"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> are simulated from <inline-formula><mml:math id="IM117" display="inline" overflow="scroll"><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> given <inline-formula><mml:math id="IM118" display="inline" overflow="scroll"><mml:mrow><mml:mspace width=".1em"/></mml:mrow><mml:mi>R</mml:mi></mml:math></inline-formula>, <italic toggle="yes">l</italic>, and time <inline-formula><mml:math id="IM119" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>;</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"> for <italic toggle="yes">every site s <bold>in</bold> sample j</italic> do</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">  Generate read depth <inline-formula><mml:math id="IM120" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mspace width=".1em"/></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">RD</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>.</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">  Sample <italic toggle="yes">n</italic> reads from the true genotype at the site <italic toggle="yes">s</italic> of <inline-formula><mml:math id="IM121" display="inline" overflow="scroll"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM122" display="inline" overflow="scroll"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> with symmetric errors at rate <italic toggle="yes">e</italic>, to generate data <inline-formula><mml:math id="IM123" display="inline" overflow="scroll"><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>.</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">  Define genotype likelihoods as <inline-formula><mml:math id="IM124" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">GL</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>log</mml:mi><mml:mspace width="0.2em"/><mml:mo stretchy="false">[</mml:mo><mml:mspace width=".1em"/><mml:mrow><mml:mi mathvariant="bold">Prob</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:math></inline-formula>.</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"> end</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">end</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <p>In the simulations, it is assumed that the error rates are identical across different reads and sites (i.e., <inline-formula><mml:math id="IM125" display="inline" overflow="scroll"><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>e</mml:mi></mml:math></inline-formula> for all <italic toggle="yes">k</italic>). The read depths are assumed to be i.i.d., Poisson random variables in all sites, and only parameter needed to define this distribution is the average read depth. It would also be possible to simulate varying error rates by sampling them from a different distribution, but as long as the base error rates are calibrated correctly, variation in the error rate among sites should not affect the behavior of the new methods qualitatively.</p>
      </sec>
      <sec id="msac119-s4.2.2">
        <title>Parameter Settings</title>
        <p>Unless otherwise stated, we simulate data with fixed values of <inline-formula><mml:math id="IM126" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.004</mml:mn></mml:math></inline-formula>, and <inline-formula><mml:math id="IM127" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0025</mml:mn></mml:math></inline-formula> (see <xref rid="msac119-F1" ref-type="fig">fig. 1</xref>), but vary the total divergence time <inline-formula><mml:math id="IM128" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, such that <inline-formula><mml:math id="IM129" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.008</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM130" display="inline" overflow="scroll"><mml:mn>0.01</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="IM131" display="inline" overflow="scroll"><mml:mn>0.016</mml:mn></mml:math></inline-formula>.</p>
        <p>In the main text, most of the simulations are conducted with the genome length and base calling error set to 1 Mb and <inline-formula><mml:math id="IM132" display="inline" overflow="scroll"><mml:mn>0.2</mml:mn><mml:mtext>%</mml:mtext></mml:math></inline-formula>. And for each scenario, 200 replicates are simulated. We will refer to these as the <bold>default simulation setting</bold>.</p>
        <p>The parameters of the GTR model are <inline-formula><mml:math id="IM133" display="inline" overflow="scroll"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>2.0431</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM134" display="inline" overflow="scroll"><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0821</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM135" display="inline" overflow="scroll"><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0000</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM136" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0670</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM137" display="inline" overflow="scroll"><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0000</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM138" display="inline" overflow="scroll"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2184</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM139" display="inline" overflow="scroll"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2606</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM140" display="inline" overflow="scroll"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.3265</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM141" display="inline" overflow="scroll"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1946</mml:mn></mml:math></inline-formula>. These values are suggested by the table 1.3 in <xref rid="msac119-B41" ref-type="bibr">Yang (2006)</xref> and were originally inferred from the human and orangutan 12S rRNA genes.</p>
        <p>Other parameter values with larger base calling error, longer genetic distance, etc., are explored in the <xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref> online but are not presented in the main text.</p>
      </sec>
      <sec id="msac119-s4.2.3">
        <title>Comparisons with the Previous Methods</title>
        <p>To assess the performance of the new methods, we compare their performance against the five previous methods (RandomSEQ, ConsensusSEQ, NoAmbiguityGT, AmbiguityGT, and ngsDist).</p>
        <p>1. RandomSEQ and ConsensusSEQ</p>
        <p>The likelihood function for both RandomSEQ and ConsensusSEQ is given by:<disp-formula id="UM0002"><mml:math id="UM2" display="block" overflow="scroll"><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mspace width=".1em"/><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mspace width=".1em"/><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:munder></mml:mstyle><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mspace width="0.2em"/><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="IM142" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> is the joint nucleotide counts matrix of the size <inline-formula><mml:math id="IM143" display="inline" overflow="scroll"><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:mn>4</mml:mn></mml:math></inline-formula> obtained by either sampling the nucleotide (RandomSEQ) or by using the Consensus (ConsensusSEQ). The consensus sequence is created by choosing the most common base in each site, choosing randomly if multiple bases are equally common, and ignoring the site if no bases are observed in one or both of the samples. The definitions of <inline-formula><mml:math id="IM144" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="IM145" display="inline" overflow="scroll"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> are the same as those in equation (<xref rid="M0002" ref-type="disp-formula">2</xref>).</p>
        <p>2. AmbiguityGT and NoAmbiguityGT</p>
        <p>AmbiguityGT and NoAmbiguityGT perform genotype calling and, thereby, have an implicit assumption of known ploidy level. We assume diploid genotypes obtained through standard genotype calling where a posterior probability is computed for each of the 10 possible genotypes under the assumption of a uniform prior. In the NoAmbiguityGT approach, heterozygous sites are discarded, i.e. the data are treated as haploid data ignoring heterozygous sites. However, in the AmbiguityGT method heterozygous sites are represented as ambiguity characters and the likelihood function is calculated by assigning equal likelihood to each of the two nucleotides, i.e., heterozygous sites are treated as sites that are haploid but with uncertainty regarding the nucleotide in the site. This is the standard way of dealing with missing data or uncertainty regarding nucleotide state in phylogenetic inference. We can think of the AmbiguityGT approach as being based on the following likelihood function:<disp-formula id="M0003"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mspace width=".1em"/><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mspace width=".1em"/><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:munder></mml:mstyle><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>log</mml:mi><mml:mspace width="0.2em"/><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="IM146" display="inline" overflow="scroll"><mml:mi>log</mml:mi><mml:mspace width="0.2em"/><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:math></inline-formula> equals <inline-formula><mml:math id="IM147" display="inline" overflow="scroll"><mml:mi>log</mml:mi><mml:mspace width="0.2em"/><mml:mo stretchy="false">[</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="IM148" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> is a count matrix of the called genotype pairs, and M1 and M2 are the sets of nucleotides observed in the two sites. <inline-formula><mml:math id="IM149" display="inline" overflow="scroll"><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> will contain two nucleotides if sample <italic toggle="yes">i</italic> is heterozygous in that site, and one nucleotide if homozygous. We elaborate more on the details of these likelihood functions in <xref rid="sup1" ref-type="supplementary-material">supplementary Section S5.1, Supplementary Material</xref> online.</p>
        <p>3. ngsDist</p>
        <p>All methods mentioned above including RandomSEQ, ConsensusSEQ, AmbiguityGT, and NoAmbiguityGT were implemented in distAngsd, and we used this implementation for the inferences for the simulated data.</p>
        <p>We also compare the new methods with ngsDist (<xref rid="msac119-B38" ref-type="bibr">Vieira et al. 2015</xref>), which is the only pre-existing method that models the uncertainty of the data to estimate genetic distances. However, this method assumes a di-allelic model. We, therefore, convert the 10-genotype likelihoods simulated by <xref rid="msac119-T4" ref-type="table">Algorithm 3</xref> to 3-genotype likelihoods, by first inferring the major and minor alleles as the most frequently, and second most frequently observed nucleotides, respectively. The resulting 3-genotype likelihoods are then used as input to ngsDist to calculate the pairwise distances (see <xref rid="sup1" ref-type="supplementary-material">supplementary Section S5.2, Supplementary Material</xref> online for details).</p>
      </sec>
    </sec>
    <sec id="msac119-s4.3">
      <title>Experimental Data Analyses</title>
      <p>We apply the new distAngsd-geno method in a phylogenetic analysis of a previously published dataset of RADseq reads from oak trees (<xref rid="msac119-B9" ref-type="bibr">Fitz-Gibbon et al. 2017</xref>). This data set is comprised of 83 oak samples representing 16 taxa located around the USA. We obtained the raw fastq sequences and followed the reference mapping approach described in detail in <xref rid="msac119-B9" ref-type="bibr">Fitz-Gibbon et al. (2017)</xref>. The sites retained for downstream analyses are based on the callable-locus BED files shared by the authors. For each site, we use the raw genotype likelihood (bcftools genotype likelihood model). The data processing pipeline differs from that of the original authors by allowing heterozygote sites, which had been masked in the original analyses. These sites are either encoded as IUPAC ambiguity codes for the AmbiguityGT method, or used in the form of raw genotype likelihoods for our new methods. We obtained nucleotide consensus sequences for the ConsensusSEQ method by using the bcftools consensus command.</p>
      <p>The fastq files for the 83 samples were aligned to the reference genome (Reference of the genome v0.5, <xref rid="msac119-B32" ref-type="bibr">Sork et al. 2016</xref>; available from <ext-link xlink:href="https://valleyoak.ucla.edu/genomicresources/" ext-link-type="uri">https://valleyoak.ucla.edu/genomicresources/</ext-link>) to obtain per sample BAM files. For the distAngsd-geno inference, VCF files were generated by applying bcftools mpileup to all pairs of samples. Similarly, bcftools mpileup commands were applied to obtain per sample information for use in the AmbiguityGT and ConsensusSEQ analyses. Genotype calling was performed with “bcftools call” followed by “bcftools consensus -I” to obtain the putative genotype calls with IUPAC ambiguity codes for the AmbiguityGT analyses whereas we did not apply “bcftools call” but solely used the “bcftools consensus” for the ConsensusSEQ analyses (see <xref rid="sup1" ref-type="supplementary-material">supplementary Section S10, Supplementary Material</xref> online for details).</p>
      <p>The distAngsd-geno, ConsensusSEQ, and AmbiguityGT methods were applied on each pair of oak samples using the JC69 substitution model. Based on the resulting <inline-formula><mml:math id="IM150" display="inline" overflow="scroll"><mml:mn>83</mml:mn><mml:mo>×</mml:mo><mml:mn>83</mml:mn></mml:math></inline-formula> pairwise distance matrices, we performed neighbor joining estimation for each method using the program PhyD (<xref rid="msac119-B5" ref-type="bibr">Criscuolo and Gascuel 2008</xref>) with the BioNJ (<xref rid="msac119-B10" ref-type="bibr">Gascuel 1997</xref>) algorithm. The trees were then plotted with FigTree v1.4.4. (<ext-link xlink:href="http://tree.bio.ed.ac.uk/software/figtree/" ext-link-type="uri">http://tree.bio.ed.ac.uk/software/figtree/</ext-link>).</p>
      <p>To compare the methods in low-coverage scenarios, we down-sampled each of the 83 samples to lower coverage. The original 83 samples have an average read depth of <inline-formula><mml:math id="IM151" display="inline" overflow="scroll"><mml:mn>20.32</mml:mn></mml:math></inline-formula> and lowest depth of <inline-formula><mml:math id="IM152" display="inline" overflow="scroll"><mml:mn>10.34</mml:mn></mml:math></inline-formula>. Each sample is down-sampled to read depths of 10, 5, 1, <inline-formula><mml:math id="IM153" display="inline" overflow="scroll"><mml:mn>0.75</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM154" display="inline" overflow="scroll"><mml:mn>0.5</mml:mn></mml:math></inline-formula>, and <inline-formula><mml:math id="IM155" display="inline" overflow="scroll"><mml:mn>0.25</mml:mn></mml:math></inline-formula>. Phylogenetic trees were then estimated using the same methods as previously described.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="msac119-s2">
    <title>Results</title>
    <p>We implemented the new methods in a program: <bold>distAngsd</bold> (<ext-link xlink:href="https://github.com/lz398/distAngsd" ext-link-type="uri">https://github.com/lz398/distAngsd</ext-link>). This program is threaded, scales linearly in the number of cores allocated, and is supplied as an open source <bold>c/c++</bold> program under the GPL license hosted on Github. Importantly, it is user friendly and allows for various standard formats that will enable researchers to integrate these methods in standard data-analysis pipelines. In the following, we compare the performance of the new methods to previous methods using extensive simulations and an application to a real data set.</p>
    <sec id="msac119-s2.1">
      <title>Simulation-based Inference</title>
      <p>The quantities we compared across different methods in this section are mainly the scaled genetic distances, <inline-formula><mml:math id="IM156" display="inline" overflow="scroll"><mml:mspace width="3pt"/><mml:mrow><mml:mover><mml:mrow><mml:mspace width="-3pt"/><mml:mi>d</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:math></inline-formula> and the scaled mean squared error, <inline-formula><mml:math id="IM157" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mspace width="3pt"/><mml:mrow><mml:mover><mml:mrow><mml:mspace width="-3pt"/><mml:mi>d</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>. The distributions of the genetic distance estimates, <inline-formula><mml:math id="IM158" display="inline" overflow="scroll"><mml:mspace width="3pt"/><mml:mrow><mml:mover><mml:mrow><mml:mspace width="-3pt"/><mml:mi>d</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, are presented as boxplots illustrating the variability among simulation replicates. The deviations of the mean of <inline-formula><mml:math id="IM159" display="inline" overflow="scroll"><mml:mspace width="3pt"/><mml:mrow><mml:mover><mml:mrow><mml:mspace width="-3pt"/><mml:mi>d</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:math></inline-formula> from 1 reflects the estimation biases, and the magnitudes of the boxes illustrate the variances of the estimates. <inline-formula><mml:math id="IM160" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mspace width="3pt"/><mml:mrow><mml:mover><mml:mrow><mml:mspace width="-3pt"/><mml:mi>d</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> is an overall measure of the accuracy of the estimates combining both bias and variance. Given the same true genetic distance <italic toggle="yes">d</italic>, the lower <inline-formula><mml:math id="IM161" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mspace width="3pt"/><mml:mrow><mml:mover><mml:mrow><mml:mspace width="-3pt"/><mml:mi>d</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> is, the better the inference of the method is.</p>
      <p>1. AmbiguityGT and NoAmbiguityGT</p>
      <p>As shown in <xref rid="msac119-F2" ref-type="fig">figure 2</xref><italic toggle="yes"><xref rid="msac119-F2" ref-type="fig">a</xref></italic> and <italic toggle="yes"><xref rid="msac119-F2" ref-type="fig">b</xref></italic>, the AmbiguityGT and NoAmbiguityGT approaches, which mimic the currently most commonly used methods, are generally found to be highly biased, and are affected by two oppositely directed biases: For example, for <inline-formula><mml:math id="IM162" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:math></inline-formula> under the JC69 model with average read depth is <inline-formula><mml:math id="IM163" display="inline" overflow="scroll"><mml:mn>0.5</mml:mn></mml:math></inline-formula>, AmbiguityGT and NoAmbiguityGT overestimate the true distance <inline-formula><mml:math id="IM164" display="inline" overflow="scroll"><mml:mn>1.234</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="IM165" display="inline" overflow="scroll"><mml:mn>1.228</mml:mn></mml:math></inline-formula> times, respectively. However, if the average read depth is large, e.g., 20, both methods underestimate the true distance (<inline-formula><mml:math id="IM166" display="inline" overflow="scroll"><mml:mspace width="3pt"/><mml:mrow><mml:mover><mml:mrow><mml:mspace width="-3pt"/><mml:mi>d</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.353</mml:mn></mml:math></inline-formula> for AmbiguityGT and <inline-formula><mml:math id="IM167" display="inline" overflow="scroll"><mml:mspace width="3pt"/><mml:mrow><mml:mover><mml:mrow><mml:mspace width="-3pt"/><mml:mi>d</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.351</mml:mn></mml:math></inline-formula> for NoAmbiguityGT). Similar patterns of overestimation for low read depth and underestimation for high read depth are observed across simulation settings (see also <xref rid="sup1" ref-type="supplementary-material">supplementary figs. S8 and S12, and table S4, Supplementary Material</xref> online).</p>
      <p>The reasons that AmbiguityGT and NoAmbiguityGT are biased upwards for low depth and downwards for high depth are as follows: When the average read depth is low, most heterozygous sites appear as homozygous, however, sequencing errors will appear as additional fixed differences that cause overestimation of the divergence time. As the sequencing depth increases, the genotype calling becomes more accurate and less affected by sequencing errors. However, for the NoAmbiguityGT methods, the removal of heterozygous sites leads to underestimation of the genetic distance. Instead of estimating <inline-formula><mml:math id="IM168" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> in <xref rid="msac119-F1" ref-type="fig">figure 1</xref>, effectively only <inline-formula><mml:math id="IM169" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is being estimated. There will be a similar effect for the AmbiguityGT method, which also ends up effectively just estimating <inline-formula><mml:math id="IM170" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>. This effect is explored in more detail in <xref rid="sup1" ref-type="supplementary-material">supplementary S5.1, Supplementary Material</xref> online.</p>
      <p>Since the biases of AmbiguityGT and NoAmbiguityGT are quite large, we do not include these methods in future comparisons.</p>
      <p>2. RandomSEQ and ConsensusSEQ</p>
      <p>Simulation results using the same parameter settings as in the previous section, for distAngsd-geno, distAngsd-nuc, RandomSEQ, and ConsensusSEQ are plotted in <xref rid="msac119-F3" ref-type="fig">figures 3</xref> (JC69) and <xref rid="msac119-F4" ref-type="fig">4</xref> (GTR) with different read depths in different panels.</p>
      <p>The results are qualitatively similar for both the GTR and JC69 models across all methods (including distAngsd-geno, distAngsd-nuc, RandomSEQ, and ConsensusSEQ, and the previously mentioned AmbiguityGT and NoAmbiguityGT methods see <xref rid="msac119-F2" ref-type="fig">fig. 2</xref>). However, the biases tend to be larger under the GTR model due to the asymmetric nature of the GTR model. We summarize the common features of the results of distAngsd-geno, distAngsd-nuc, RandomSEQ, and ConsensusSEQ under both nucleotide substitution models as follows:</p>
      <p>Both distAngsd-geno and distAngsd-nuc have higher accuracy and precision (smaller biases and variances) than RandomSEQ and ConsensusSEQ. This is especially clear for low depth scenarios (<xref rid="msac119-F3" ref-type="fig">figs. 3</xref><italic toggle="yes"><xref rid="msac119-F3" ref-type="fig">e,f</xref></italic> and <xref rid="msac119-F4" ref-type="fig">4</xref><italic toggle="yes"><xref rid="msac119-F4" ref-type="fig">e,f</xref></italic>) and shorter genome length scenarios (see also <xref rid="sup1" ref-type="supplementary-material">supplementary figs. S13 and S14, Supplementary Material</xref> online). RandomSEQ and ConsensusSEQ are strongly affected by errors at lower sequencing depths. This sensitivity to errors also affects RandomSEQ at higher sequencing depths, while the performance of ConsensusSEQ improves strongly with increasing depth. It should be noted that when the mean read depth is small and the base calling error is relatively large (relative to the true genetic divergence), both of the new methods can still be biased. However, these biases are much smaller than those observed for the previous methods (e.g., see <xref rid="msac119-F4" ref-type="fig">fig. 4</xref>). We refer readers to <xref rid="sup1" ref-type="supplementary-material">supplementary Section S4, Supplementary Material</xref> online for a general discussion on bias analyses.</p>
      <p>As expected, since the new methods take advantage of the full information of the sequencing data (see discussion in <xref rid="sup1" ref-type="supplementary-material">supplementary Section S5.1, Supplementary Material</xref> online), they also have the smallest variance and the smallest mean squared error (MSE, see <xref rid="msac119-F5" ref-type="fig">fig. 5</xref>, and <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S15, Supplementary Material</xref> online for shorter genome scenarios). Furthermore since distAngsd-geno also uses prior knowledge of ploidy level, it always has the least variance in our diploid simulations.</p>
      <fig position="float" id="msac119-F5" fig-type="figure">
        <label>Fig. 5.</label>
        <caption>
          <p>The (scaled) mean squared errors for six different methods (distAngsd-geno, distAngsd-nuc, RandomSEQ, ConsensusSEQ, AmbiguityGT, and NoAmbiguityGT) in the simulation results. True genetic distance <italic toggle="yes">d</italic>: (<italic toggle="yes">a</italic>) <inline-formula><mml:math id="IM171" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.008</mml:mn></mml:math></inline-formula>. (<italic toggle="yes">b</italic>) <inline-formula><mml:math id="IM172" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.010</mml:mn></mml:math></inline-formula>. (<italic toggle="yes">c</italic>) <inline-formula><mml:math id="IM173" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.016</mml:mn></mml:math></inline-formula>. <inline-formula><mml:math id="IM174" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.004</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM175" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0025</mml:mn></mml:math></inline-formula>, see <xref rid="msac119-F1" ref-type="fig">figure 1</xref>. The default simulation setting was applied. Solid lines correspond to the results of previous methods, while the dashed ones represent those of the two proposed methods.</p>
        </caption>
        <graphic xlink:href="msac119f5" position="float"/>
      </fig>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary figures S13 and S14, Supplementary Material</xref> online correspond to <xref rid="msac119-F3" ref-type="fig">figures 3</xref> and <xref rid="msac119-F4" ref-type="fig">4</xref>, with the only difference being the number of variable sites used in the actual simulation (1 MB in the main text, <inline-formula><mml:math id="IM176" display="inline" overflow="scroll"><mml:mn>0.1</mml:mn></mml:math></inline-formula> MB in <xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref> online).</p>
      <p>3. ngsDist</p>
      <p>ngsDist is based on a model which measures pairwise differences and does not distinguish between different types of nucleotide substitutions, we therefore compare the results of ngsDist with disAngsd-geno only under the symmetric JC69 model. ngsDist is also the only previous method that makes use of genotype likelihoods. We should also emphasize that ngsDist was not developed for phylogenetic analysis and the results presented is therefore not the recommended scenarios for ngsDist. We therefore present the result separately (<xref rid="msac119-F6" ref-type="fig">fig. 6</xref>). With an average read depth of 1, ngsDist overestimates genetic distance <italic toggle="yes">d</italic> when a relatively small true <italic toggle="yes">d</italic> is simulated (35-fold difference when true <inline-formula><mml:math id="IM177" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:math></inline-formula>). This is due to ngsDist averaging over the posterior genotype distribution when calculating genetic distances (eq. 2 in <xref rid="msac119-B38" ref-type="bibr">Vieira et al. 2015</xref>). Averaging over the posterior leads to overestimation of genetic distances when the true distances are small, because uncertainty regarding the genotype is effectively interpreted as a high probability of nucleotide differences. For example, for a uniform prior on diallelic genotypes and with no data, so that only the prior contributes to the posterior, the expected number of nucleotide differences per site is 0.5. If the sequencing depth is low, the genetic distance will therefore be biased towards large values especially when the true genetic distance is small. Incorporating statistical uncertainty by averaging over a posterior can, in general, lead to highly biased estimates and will be very sensitive to the choice of prior. DistAngsd-geno remains approximately unbiased but has increasing variance as depth decreases. In contrast, ngsDist has an obvious depth-dependent bias in the tested scenarios. As the depth becomes smaller, the genotype prior increasingly influences the estimated genetic distance (see <xref rid="msac119-F7" ref-type="fig">fig. 7</xref> for the genome length 1 Mb case and <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S6, Supplementary Material</xref> online for the genome length <inline-formula><mml:math id="IM178" display="inline" overflow="scroll"><mml:mn>0.1</mml:mn></mml:math></inline-formula> Mb scenario).</p>
      <fig position="float" id="msac119-F6" fig-type="figure">
        <label>Fig. 6.</label>
        <caption>
          <p>Comparison of estimated genetic distances by distAngsd-geno and ngsDist for different true distances ranging from <inline-formula><mml:math id="IM179" display="inline" overflow="scroll"><mml:mn>0.01</mml:mn></mml:math></inline-formula> to 1. The JC69 model was used. <inline-formula><mml:math id="IM180" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.004</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM181" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0025</mml:mn></mml:math></inline-formula>, see <xref rid="msac119-F1" ref-type="fig">figure 1</xref>. At each true <italic toggle="yes">d</italic> value, 200 replicates were simulated and estimated. The default simulation setting was applied and the average read depth is set to 1. Blue points: distAngsd-geno. Red points: ngsDist.</p>
        </caption>
        <graphic xlink:href="msac119f6" position="float"/>
      </fig>
      <fig position="float" id="msac119-F7" fig-type="figure">
        <label>Fig. 7.</label>
        <caption>
          <p>Comparison of estimated genetic distances by ngsDist and distAngsd-geno for different read depths ranging from <inline-formula><mml:math id="IM182" display="inline" overflow="scroll"><mml:mn>0.5</mml:mn></mml:math></inline-formula> to 20. (<italic toggle="yes">a</italic>) Genetic distance was estimated by ngsDist. (<italic toggle="yes">b</italic>) Genetic distance was estimated by distAngsd-geno. JC69 model was used. True genetic distance (<italic toggle="yes">d</italic>) was assumed to be <inline-formula><mml:math id="IM183" display="inline" overflow="scroll"><mml:mn>0.01</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM184" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.004</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM185" display="inline" overflow="scroll"><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0025</mml:mn></mml:math></inline-formula>, see <xref rid="msac119-F1" ref-type="fig">figure 1</xref>. The default simulation setting was applied.</p>
        </caption>
        <graphic xlink:href="msac119f7" position="float"/>
      </fig>
    </sec>
    <sec id="msac119-s2.2">
      <title>Inference based on Experimental Data</title>
      <p>To compare the methods on real data, we used a previously published data set of RADseq data from oak trees (<xref rid="msac119-B9" ref-type="bibr">Fitz-Gibbon et al. 2017</xref>). We estimate neighbor joining trees using genetic distances based on distAngsd-geno and two more popular previous methods, ConsensusSEQ and AmbiguityGT under the JC69 model (<xref rid="msac119-F8" ref-type="fig">fig. 8</xref>). We used the JC69 model to facilitate a more fair comparison among methods.</p>
      <fig position="float" id="msac119-F8" fig-type="figure">
        <label>Fig. 8.</label>
        <caption>
          <p>Neighbor-Joining Tree of 83 oak samples inferred using genetic distances estimated by (<italic toggle="yes">a</italic>) distAngsd-geno (<italic toggle="yes">b</italic>) ConsensusSEQ , and (<italic toggle="yes">c</italic>) AmbiguityGT. All inferences are based on the JC69 model. The colors of the leaf-node labels correspond to the species shown in the legend. All three trees are estimated as unrooted trees but roots are placed between the known outgroup <italic toggle="yes">Quercus kelloggii</italic> and other oak species.</p>
        </caption>
        <graphic xlink:href="msac119f8a" position="float"/>
        <graphic xlink:href="msac119f8b" position="float"/>
      </fig>
      <p>We only compare distAngsd-geno to the ConsensusSEQ and AmbiguityGT methods since (1) they perform equally as well or better than RandomSEQ and NoAmbiguity in simulations. (2) ngsDist overestimates the pairwise genetic distances and is not appropriate for phylogenetic inference (<xref rid="msac119-F6" ref-type="fig">figs. 6</xref> and <xref rid="msac119-F7" ref-type="fig">7</xref>).</p>
      <p>Distances estimated using distAngsd-geno results in trees that are more concordant with existing taxonomic assignments, as they are closer at identifying <italic toggle="yes">Quercus berberidifolia</italic>, <italic toggle="yes">Quercus durata var. gabrielensis</italic> and <italic toggle="yes">Quercus durata var. durata</italic> (<xref rid="msac119-F8" ref-type="fig">fig. 8</xref>) as monophyletic groups.</p>
      <p>To further examine the relative performance of the methods on real data, we down-sample to obtain mean read depths of 10, 5, 1, <inline-formula><mml:math id="IM186" display="inline" overflow="scroll"><mml:mn>0.75</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM187" display="inline" overflow="scroll"><mml:mn>0.5</mml:mn></mml:math></inline-formula>, and <inline-formula><mml:math id="IM188" display="inline" overflow="scroll"><mml:mn>0.25</mml:mn></mml:math></inline-formula>. The original mean depth per sample was <inline-formula><mml:math id="IM189" display="inline" overflow="scroll"><mml:mn>20.32</mml:mn></mml:math></inline-formula> with a lowest mean depth of any sample of <inline-formula><mml:math id="IM190" display="inline" overflow="scroll"><mml:mn>10.34</mml:mn></mml:math></inline-formula>. We then, again, estimated neighbor-joining trees using distances inferred using distAngsd-geno, ConsensusSEQ, and AmbiguityGT. To compare the compatibility of the results with the existing taxonomy, we developed a compatibility measurement, <italic toggle="yes">m</italic>, that measures the amount of taxonomic compatibility observed in the trees, i.e., higher values correspond to better performance (see <xref rid="sup1" ref-type="supplementary-material">supplementary Section S8, Supplementary Material</xref> online). Results for all scenarios and methods can be found in <xref rid="msac119-T1" ref-type="table">table 1</xref>.</p>
      <table-wrap position="float" id="msac119-T1">
        <label>Table 1.</label>
        <caption>
          <p>The Compatibility Measurement <italic toggle="yes">m</italic> between the Inferred Pairwise Distance Trees and the Prior Species Knowledge.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" colspan="2" rowspan="1">Downsampling Depth</th>
              <th align="center" rowspan="1" colspan="1">Full</th>
              <th align="center" rowspan="1" colspan="1">10</th>
              <th align="center" rowspan="1" colspan="1">5</th>
              <th align="center" rowspan="1" colspan="1">1</th>
              <th align="center" rowspan="1" colspan="1">
                <inline-formula>
                  <mml:math id="IM191" display="inline" overflow="scroll">
                    <mml:mn>0.75</mml:mn>
                  </mml:math>
                </inline-formula>
              </th>
              <th align="center" rowspan="1" colspan="1">
                <inline-formula>
                  <mml:math id="IM192" display="inline" overflow="scroll">
                    <mml:mn>0.5</mml:mn>
                  </mml:math>
                </inline-formula>
              </th>
              <th align="center" rowspan="1" colspan="1">
                <inline-formula>
                  <mml:math id="IM193" display="inline" overflow="scroll">
                    <mml:mn>0.25</mml:mn>
                  </mml:math>
                </inline-formula>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Criterion <inline-formula><mml:math id="IM194" display="inline" overflow="scroll"><mml:mo fence="false" stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">distAngsd-geno</td>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">m</italic>
              </td>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">13</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">ConsensusSEQ</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">13</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">AmbiguityGT</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">12</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Criterion <inline-formula><mml:math id="IM195" display="inline" overflow="scroll"><mml:mo fence="false" stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">distAngsd-geno</td>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">m</italic>
              </td>
              <td rowspan="1" colspan="1">75</td>
              <td rowspan="1" colspan="1">75</td>
              <td rowspan="1" colspan="1">73</td>
              <td rowspan="1" colspan="1">74</td>
              <td rowspan="1" colspan="1">73</td>
              <td rowspan="1" colspan="1">70</td>
              <td rowspan="1" colspan="1">57</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">ConsensusSEQ</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">74</td>
              <td rowspan="1" colspan="1">75</td>
              <td rowspan="1" colspan="1">76</td>
              <td rowspan="1" colspan="1">72</td>
              <td rowspan="1" colspan="1">70</td>
              <td rowspan="1" colspan="1">66</td>
              <td rowspan="1" colspan="1">58</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">AmbiguityGT</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">75</td>
              <td rowspan="1" colspan="1">75</td>
              <td rowspan="1" colspan="1">74</td>
              <td rowspan="1" colspan="1">74</td>
              <td rowspan="1" colspan="1">70</td>
              <td rowspan="1" colspan="1">67</td>
              <td rowspan="1" colspan="1">56</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>Note:—The trees are inferred based on the original samples as well as the downsampled samples. The original 83 samples have mean read depth <inline-formula><mml:math id="IM196" display="inline" overflow="scroll"><mml:mn>20.32</mml:mn></mml:math></inline-formula> with lowest depth <inline-formula><mml:math id="IM197" display="inline" overflow="scroll"><mml:mn>10.34</mml:mn></mml:math></inline-formula>, and each sample is downsampled to mean read depth 10, 5, 1, <inline-formula><mml:math id="IM198" display="inline" overflow="scroll"><mml:mn>0.75</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM199" display="inline" overflow="scroll"><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="IM200" display="inline" overflow="scroll"><mml:mn>0.25</mml:mn></mml:math></inline-formula>.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Clearly, trees estimated using distAngsd-geno are more compatible with existing taxonomy than both ConsensusSEQ and AmbiguityGT, particularly as the read depth decreases.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="msac119-s3">
    <title>Discussion</title>
    <p>We have here presented two novel methods for estimating genetic distances: distAngsd-geno and distAngsd-nuc. Both of these methods incorporate the uncertainty that is inherently associated with high-throughput sequencing data. The uncertainty is either modeled through standard diploid genotype likelihoods or, equivalently, through the application of the base quality scores in a framework that facilitates inferences in a polyploid or unknown ploidy context. Both methods can estimate the genetic distance between samples with high sequencing error rates and low average read depth.</p>
    <p>The key characteristic of both methods is to decompose the likelihood optimization process into two parts: (1) estimation of global pseudo-observations (i.e. joint distributions of genotypes or nucleotides between each pair of samples); (2) the maximum-likelihood estimation of genetic distance (and other related parameters) based on the previously calculated pseudo-observations. This decomposition reduces the complexity of the maximum-likelihood estimation.</p>
    <p>However, we note that this decomposition can introduce biases (See <xref rid="sup1" ref-type="supplementary-material">supplementary Section S4, Supplementary Material</xref> online), particularly when the sequences compared are short. The proposed methods are not intended for data consisting of very short sequences. However, the bias for our proposed methods is still smaller—by a large margin—compared to any previous method.</p>
    <p>We also simulated and inferred genetic distances based on tree topologies different from <xref rid="msac119-F1" ref-type="fig">figure 1</xref> (See <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S7, Supplementary Material</xref> online). Such topologies can occur due to incomplete lineage sorting, i.e. when coalescence times are shorter between alleles from different individuals than from the same individual. We find that for a realistic range of divergence levels, the results of the new methods still offer higher accuracy than the previous methods (See <xref rid="sup1" ref-type="supplementary-material">supplementary Section S6, Supplementary Material</xref> online). The biases of the previous methods for topologies resulting from incomplete linage sorting are similar to those observed for the standard topology in <xref rid="msac119-F1" ref-type="fig">figure 1</xref>, and the general conclusions from the standard simulation scenario carries over to the case of incomplete lineage sorting. One exception is for extremely large divergence levels (see <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S10, Supplementary Material</xref> online), where the new methods will be increasingly biased.</p>
    <p>While the distAngsd-geno results presented here assume diploidy, it can in principle be extended to any ploidy level. However, unlike the distAngsd-geno, the distAngsd-nuc does not require prior knowledge of ploidy level, and the size of joint distribution matrix of nucleotides N remains a <inline-formula><mml:math id="IM201" display="inline" overflow="scroll"><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:mn>4</mml:mn></mml:math></inline-formula> regardless of ploidy level. We observe that distAngsd-geno produces more accurate results for our diploid simulation scenarios but speculate that in the context of unknown ploidy distAngsd-nuc will yield more robust estimates and would therefore be more suitable.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>msac119_Supplementary_Data</label>
      <media xlink:href="msac119_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>We thank two anonymous reviewers and editor Tom Whitehead for their careful reading and insightful comments and suggestions. We thank Prof. Victoria L. Sork and Dr. Sorel Fitz-Gibbon for kindly sharing the oak data with us. We thank Prof. Rasmus Heller for advice of processing RAD sequences. We thank Prof. Ziheng Yang for sharing code for matrix exponentiation. We thank Dr. Abigail Daisy Ramsøe for English polishing. L.Z. was funded by Lundbeck Foundation Centre for Disease Evolution: R302-2018-2155. T.S.K. was funded by a Carlsberg Foundation Young Researcher Fellowship awarded by the Carlsberg Foundation in 2019 (CF19-0712). R.N. is supported by NIH grant R01GM138634.</p>
  </ack>
  <sec id="msac119-s5">
    <title>Supplementary Material</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Molecular Biology and Evolution online</italic>.</p>
  </sec>
  <sec sec-type="data-availability" id="msac119-s6">
    <title>Data availability</title>
    <p>Raw oak data were from previously published dataset (described in <xref rid="msac119-B9" ref-type="bibr">Fitz-Gibbon et al. 2017</xref>). Derived data supporting the findings of this study are available on request.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="msac119-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Árnason</surname><given-names>Ú</given-names></string-name>, <string-name><surname>Lammers</surname><given-names>F</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>V</given-names></string-name>, <string-name><surname>Nilsson</surname><given-names>MA</given-names></string-name>, <string-name><surname>Janke</surname><given-names>A</given-names></string-name></person-group>. <year>2018</year>. <article-title>Whole-genome sequencing of the blue whale and other rorquals finds signatures for introgressive gene flow</article-title>. <source>Sci Adv</source>. <volume>4</volume>(<issue>4</issue>):<comment>eaap9873</comment>.</mixed-citation>
    </ref>
    <ref id="msac119-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Browning</surname><given-names>SR</given-names></string-name>, <string-name><surname>Browning</surname><given-names>BL</given-names></string-name></person-group>. <year>2007</year>. <article-title>Rapid and accurate haplotype phasing and missing-data inference for whole-genome association studies by use of localized haplotype clustering</article-title>. <source>Am J Hum Genet</source>. <volume>81</volume>:<fpage>1084</fpage>–<lpage>1097</lpage>.<pub-id pub-id-type="pmid">17924348</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Choi</surname><given-names>JY</given-names></string-name>, <string-name><surname>Purugganan</surname><given-names>MD</given-names></string-name></person-group>. <year>2018</year>. <article-title>Multiple origin but single domestication led to Oryza sativa</article-title>. <source>G3-Genes Genom Genet</source>. <volume>8</volume>:<fpage>797</fpage>–<lpage>803</lpage>.</mixed-citation>
    </ref>
    <ref id="msac119-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cornish-Bowden</surname><given-names>A</given-names></string-name></person-group>. <year>1985</year>. <article-title>Nomenclature for incompletely specified bases in nucleic acid sequences: rcommendations 1984</article-title>. <source>Nucleic Acids Res</source>. <volume>13</volume>(<issue>9</issue>):<fpage>3021</fpage>–<lpage>3030</lpage>.<pub-id pub-id-type="pmid">2582368</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Criscuolo</surname><given-names>A</given-names></string-name>, <string-name><surname>Gascuel</surname><given-names>O</given-names></string-name></person-group>. <year>2008</year>. <article-title>Fast NJ-like algorithms to deal with incomplete distance matrices</article-title>. <source>BMC Bioinform</source>. <volume>9</volume>:<fpage>166</fpage>.</mixed-citation>
    </ref>
    <ref id="msac119-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dempster</surname><given-names>AP</given-names></string-name>, <string-name><surname>Laird</surname><given-names>NM</given-names></string-name>, <string-name><surname>Rubin</surname><given-names>DB</given-names></string-name></person-group>. <year>1977</year>. <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>. <source>J R Stat Soc Ser B</source>. <volume>39</volume>:<fpage>1</fpage>–<lpage>38</lpage>.</mixed-citation>
    </ref>
    <ref id="msac119-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Felsenstein</surname><given-names>J</given-names></string-name></person-group>. <year>1981</year>. <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>. <source>J Mol Evol</source>. <volume>17</volume>:<fpage>368</fpage>–<lpage>376</lpage>.<pub-id pub-id-type="pmid">7288891</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Felsenstein</surname><given-names>J</given-names></string-name>, <string-name><surname>Churchill</surname><given-names>GA</given-names></string-name></person-group>. <year>1996</year>. <article-title>A hidden Markov model approach to variation among sites in rate of evolution</article-title>. <source>Mol Biol Evol</source>. <volume>13</volume>:<fpage>93</fpage>–<lpage>104</lpage>.<pub-id pub-id-type="pmid">8583911</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fitz-Gibbon</surname><given-names>S</given-names></string-name>, <string-name><surname>Hipp</surname><given-names>AL</given-names></string-name>, <string-name><surname>Pham</surname><given-names>KK</given-names></string-name>, <string-name><surname>Manos</surname><given-names>PS</given-names></string-name>, <string-name><surname>Sork</surname><given-names>VL</given-names></string-name></person-group>. <year>2017</year>. <article-title>Phylogenomic inferences from reference-mapped and de novo assembled short-read sequence data using RADseq sequencing of California white oaks (Quercus section Quercus)</article-title>. <source>Genome</source>. <volume>60</volume>:<fpage>743</fpage>–<lpage>755</lpage>.<pub-id pub-id-type="pmid">28355490</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gascuel</surname><given-names>O</given-names></string-name></person-group>. <year>1997</year>. <article-title>BIONJ: an improved version of the NJ algorithm based on a simple model of sequence data</article-title>. <source>Mol Biol Evol</source>. <volume>14</volume>:<fpage>685</fpage>–<lpage>695</lpage>.<pub-id pub-id-type="pmid">9254330</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gaunitz</surname><given-names>C</given-names></string-name>, <string-name><surname>Fages</surname><given-names>A</given-names></string-name>, <string-name><surname>Hanghøj</surname><given-names>K</given-names></string-name>, <string-name><surname>Albrechtsen</surname><given-names>A</given-names></string-name>, <string-name><surname>Khan</surname><given-names>N</given-names></string-name>, <string-name><surname>Schubert</surname><given-names>M</given-names></string-name>, <string-name><surname>Seguin-Orlando</surname><given-names>A</given-names></string-name>, <string-name><surname>Owens</surname><given-names>IJ</given-names></string-name>, <string-name><surname>Felkel</surname><given-names>S</given-names></string-name>, <string-name><surname>Bignon-Lau</surname><given-names>O</given-names></string-name>, <etal>et al</etal></person-group><year>2018</year>. <article-title>Ancient genomes revisit the ancestry of domestic and Przewalski’s horses</article-title>. <source>Science</source><volume>360</volume>:<fpage>111</fpage>–<lpage>114</lpage>.<pub-id pub-id-type="pmid">29472442</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hasegawa</surname><given-names>M</given-names></string-name>, <string-name><surname>Kishino</surname><given-names>H</given-names></string-name>, <string-name><surname>Yano</surname><given-names>T</given-names></string-name></person-group>. <year>1985</year>. <article-title>Dating of the human-ape splitting by a molecular clock of mitochondrial DNA</article-title>. <source>J Mol Evol</source>. <volume>22</volume>:<fpage>160</fpage>–<lpage>174</lpage>.<pub-id pub-id-type="pmid">3934395</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>XJ</given-names></string-name>, <string-name><surname>Yang</surname><given-names>J</given-names></string-name>, <string-name><surname>Xie</surname><given-names>XL</given-names></string-name>, <string-name><surname>Lv</surname><given-names>FH</given-names></string-name>, <string-name><surname>Cao</surname><given-names>YH</given-names></string-name>, <string-name><surname>Li</surname><given-names>WR</given-names></string-name>, <string-name><surname>Liu</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Wang</surname><given-names>YT</given-names></string-name>, <string-name><surname>Li</surname><given-names>JQ</given-names></string-name>, <string-name><surname>Liu</surname><given-names>YG</given-names></string-name>, <etal>et al</etal></person-group><year>2018</year>. <article-title>The genome landscape of Tibetan sheep reveals adaptive introgression from argali and the history of early human settlements on the Qinghai-Tibetan Plateau</article-title>. <source>Mol Biol Evol</source>. <volume>36</volume>:<fpage>283</fpage>–<lpage>303</lpage>.</mixed-citation>
    </ref>
    <ref id="msac119-B14">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Jukes</surname><given-names>TH</given-names></string-name>, <string-name><surname>Cantor</surname><given-names>CR</given-names></string-name></person-group>. <year>1969</year>. <part-title>Evolution of protein molecules</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Munro</surname><given-names>HN</given-names></string-name></person-group>, editor. <source>Mammalian protein metabolism</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Academic Press</publisher-name>. p. <fpage>21</fpage>–<lpage>132</lpage>.</mixed-citation>
    </ref>
    <ref id="msac119-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keightley</surname><given-names>PD</given-names></string-name>, <string-name><surname>Halligan</surname><given-names>DL</given-names></string-name></person-group>. <year>2011</year>. <article-title>Inference of site frequency spectra from high-throughput sequence data: quantification of selection on nonsynonymous and synonymous sites in humans</article-title>. <source>Genetics</source><volume>188</volume>(<issue>4</issue>):<fpage>931</fpage>–<lpage>940</lpage>.<pub-id pub-id-type="pmid">21596896</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kimura</surname><given-names>M</given-names></string-name></person-group>. <year>1980</year>. <article-title>A simple method for estimating evolutionary rates of base substitutions through comparative studies of nucleotide sequences</article-title>. <source>J Mol Evol</source>. <volume>16</volume>:<fpage>111</fpage>–<lpage>120</lpage>.<pub-id pub-id-type="pmid">7463489</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klicka</surname><given-names>J</given-names></string-name>, <string-name><surname>Keith Barker</surname><given-names>F</given-names></string-name>, <string-name><surname>Burns</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Lanyon</surname><given-names>SM</given-names></string-name>, <string-name><surname>Lovette</surname><given-names>IJ</given-names></string-name>, <string-name><surname>Chaves</surname><given-names>JA</given-names></string-name>, <string-name><surname>Bryson</surname><given-names>RW</given-names></string-name></person-group>. <year>2014</year>. <article-title>A comprehensive multilocus assessment of sparrow (Aves: Passerellidae) relationships</article-title>. <source>Mol Phylogenet Evol</source>. <volume>77</volume>:<fpage>177</fpage>–<lpage>182</lpage>.<pub-id pub-id-type="pmid">24792084</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korneliussen</surname><given-names>TS</given-names></string-name>, <string-name><surname>Albrechtsen</surname><given-names>A</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>R</given-names></string-name></person-group>. <year>2014</year>. <article-title>ANGSD: analysis of next generation sequencing data</article-title>. <source>BMC Bioinform</source>. <volume>15</volume>:<fpage>356</fpage>.</mixed-citation>
    </ref>
    <ref id="msac119-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H</given-names></string-name></person-group>. <year>2011</year>. <article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source>. <volume>27</volume>:<fpage>2987</fpage>–<lpage>2993</lpage>.<pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lischer</surname><given-names>HE</given-names></string-name>, <string-name><surname>Excoffier</surname><given-names>L</given-names></string-name>, <string-name><surname>Heckel</surname><given-names>G</given-names></string-name></person-group>. <year>2014</year>. <article-title>Ignoring heterozygous sites biases phylogenomic estimates of divergence times: implications for the evolutionary history of microtus voles</article-title>. <source>Mol Biol Evol</source>. <volume>31</volume>:<fpage>817</fpage>–<lpage>831</lpage>.<pub-id pub-id-type="pmid">24371090</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maldonado</surname><given-names>LL</given-names></string-name>, <string-name><surname>Arrabal</surname><given-names>JP</given-names></string-name>, <string-name><surname>Rosenzvit</surname><given-names>MC</given-names></string-name>, <string-name><surname>Oliveira</surname><given-names>GCD</given-names></string-name>, <string-name><surname>Kamenetzky</surname><given-names>L</given-names></string-name></person-group>. <year>2019</year>. <article-title>Revisiting the phylogenetic history of helminths through genomics, the case of the new <italic toggle="yes">Echinococcus oligarthrus</italic> genome</article-title>. <source>Front Genet</source>. <volume>10</volume>:<fpage>708</fpage>.<pub-id pub-id-type="pmid">31440275</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Manthey</surname><given-names>JD</given-names></string-name>, <string-name><surname>Campillo</surname><given-names>LC</given-names></string-name>, <string-name><surname>Burns</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Moyle</surname><given-names>RG</given-names></string-name></person-group>. <year>2016</year>. <article-title>Comparison of target-capture and restriction-site associated DNA sequencing for phylogenomics: a test in cardinalid tanagers (Aves, Genus: Piranga)</article-title>. <source>Syst Biol</source>. <volume>65</volume>:<fpage>640</fpage>–<lpage>650</lpage>.<pub-id pub-id-type="pmid">26821912</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martin</surname><given-names>FN</given-names></string-name>, <string-name><surname>Blair</surname><given-names>JE</given-names></string-name>, <string-name><surname>Coffey</surname><given-names>MD</given-names></string-name></person-group>. <year>2014</year>. <article-title>A combined mitochondrial and nuclear multilocus phylogeny of the genus Phytophthora</article-title>. <source>Fungal Genet Biol</source>. <volume>66</volume>:<fpage>19</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">24603058</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKenna</surname><given-names>A</given-names></string-name>, <string-name><surname>Hanna</surname><given-names>M</given-names></string-name>, <string-name><surname>Banks</surname><given-names>E</given-names></string-name>, <string-name><surname>Sivachenko</surname><given-names>A</given-names></string-name>, <string-name><surname>Cibulskis</surname><given-names>K</given-names></string-name>, <string-name><surname>Kernytsky</surname><given-names>A</given-names></string-name>, <string-name><surname>Garimella</surname><given-names>K</given-names></string-name>, <string-name><surname>Altshuler</surname><given-names>D</given-names></string-name>, <string-name><surname>Gabriel</surname><given-names>S</given-names></string-name>, <string-name><surname>Daly</surname><given-names>M</given-names></string-name>, <etal>et al</etal></person-group><year>2010</year>. <article-title>The genome analysis toolkit: a mapreduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source>. <volume>20</volume>(<issue>9</issue>):<fpage>1297</fpage>–<lpage>1303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nielsen</surname><given-names>R</given-names></string-name>, <string-name><surname>Korneliussen</surname><given-names>T</given-names></string-name>, <string-name><surname>Albrechtsen</surname><given-names>A</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name></person-group>. <year>2012</year>. <article-title>SNP calling, genotype calling, and sample allele frequency estimation from New-Generation Sequencing Data</article-title>. <source>PLoS ONE</source><volume>7</volume>:<fpage>e37558</fpage>.<pub-id pub-id-type="pmid">22911679</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nielsen</surname><given-names>R</given-names></string-name>, <string-name><surname>Paul</surname><given-names>JS</given-names></string-name>, <string-name><surname>Albrechtsen</surname><given-names>A</given-names></string-name>, <string-name><surname>Song</surname><given-names>YS</given-names></string-name></person-group>. <year>2011</year>. <article-title>Genotype and SNP calling from next-generation sequencing data</article-title>. <source>Nat Rev Genet</source>. <volume>12</volume>:<fpage>443</fpage>–<lpage>451</lpage>.<pub-id pub-id-type="pmid">21587300</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nilsson</surname><given-names>MA</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>V</given-names></string-name>, <string-name><surname>Phillips</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Janke</surname><given-names>A</given-names></string-name></person-group>. <year>2017</year>. <article-title>Speciation generates mosaic genomes in kangaroos</article-title>. <source>Genome Biol Evol</source>. <volume>10</volume>:<fpage>33</fpage>–<lpage>44</lpage>.</mixed-citation>
    </ref>
    <ref id="msac119-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Potts</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Hedderson</surname><given-names>TA</given-names></string-name>, <string-name><surname>Grimm</surname><given-names>GW</given-names></string-name></person-group>. <year>2014</year>. <article-title>Constructing phylogenies in the presence of intra-individual site polymorphisms (2ISPs) with a focus on the nuclear ribosomal cistron</article-title>. <source>Syst Biol</source>. <volume>63</volume>:<fpage>1</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">23939193</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sass</surname><given-names>C</given-names></string-name>, <string-name><surname>Iles</surname><given-names>WJD</given-names></string-name>, <string-name><surname>Barrett</surname><given-names>CF</given-names></string-name>, <string-name><surname>Smith</surname><given-names>SY</given-names></string-name>, <string-name><surname>Specht</surname><given-names>CD</given-names></string-name></person-group>. <year>2016</year>. <article-title>Revisiting the Zingiberales: using multiplexed exon capture to resolve ancient and recent phylogenetic splits in a charismatic plant lineage</article-title>. <source>PeerJ</source>. <volume>4</volume>:<fpage>e1584</fpage>.<pub-id pub-id-type="pmid">26819846</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schrempf</surname><given-names>D</given-names></string-name>, <string-name><surname>Minh</surname><given-names>BQ</given-names></string-name>, <string-name><surname>Maio</surname><given-names>ND</given-names></string-name>, <string-name><surname>von Haeseler</surname><given-names>A</given-names></string-name>, <string-name><surname>Kosiol</surname><given-names>C</given-names></string-name></person-group>. <year>2016</year>. <article-title>Reversible polymorphism-aware phylogenetic models and their application to tree inference</article-title>. <source>J Theor Biol</source>. <volume>407</volume>:<fpage>362</fpage>–<lpage>370</lpage>.<pub-id pub-id-type="pmid">27480613</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Skoglund</surname><given-names>P</given-names></string-name>, <string-name><surname>Posth</surname><given-names>C</given-names></string-name>, <string-name><surname>Sirak</surname><given-names>K</given-names></string-name>, <string-name><surname>Spriggs</surname><given-names>M</given-names></string-name>, <string-name><surname>Valentin</surname><given-names>F</given-names></string-name>, <string-name><surname>Bedford</surname><given-names>S</given-names></string-name>, <string-name><surname>Clark</surname><given-names>GR</given-names></string-name>, <string-name><surname>Reepmeyer</surname><given-names>C</given-names></string-name>, <string-name><surname>Petchey</surname><given-names>F</given-names></string-name>, <string-name><surname>Fernandes</surname><given-names>D</given-names></string-name>, <etal>et al</etal></person-group><year>2016</year>. <article-title>Genomic insights into the peopling of the Southwest Pacific</article-title>. <source>Nature</source><volume>538</volume>:<fpage>510</fpage>–<lpage>513</lpage>.<pub-id pub-id-type="pmid">27698418</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sork</surname><given-names>VL</given-names></string-name>, <string-name><surname>Fitz-Gibbon</surname><given-names>ST</given-names></string-name>, <string-name><surname>Puiu</surname><given-names>D</given-names></string-name>, <string-name><surname>Crepeau</surname><given-names>M</given-names></string-name>, <string-name><surname>Gugger</surname><given-names>PF</given-names></string-name>, <string-name><surname>Sherman</surname><given-names>R</given-names></string-name>, <string-name><surname>Stevens</surname><given-names>K</given-names></string-name>, <string-name><surname>Langley</surname><given-names>CH</given-names></string-name>, <string-name><surname>Pellegrini</surname><given-names>M</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL</given-names></string-name></person-group>. <year>2016</year>. <article-title>First draft assembly and annotation of the genome of a California endemic oak <italic toggle="yes">Quercus lobata</italic> Née (Fagaceae)</article-title>. <source>G3 (Bethesda)</source>. <volume>6</volume>(<issue>11</issue>):<fpage>3485</fpage>–<lpage>3495</lpage>.<pub-id pub-id-type="pmid">27621377</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stephens</surname><given-names>M</given-names></string-name>, <string-name><surname>Donnelly</surname><given-names>P</given-names></string-name></person-group>. <year>2003</year>. <article-title>A comparison of Bayesian methods for haplotype reconstruction from population genotype data</article-title>. <source>Am J Hum Genet</source>. <volume>73</volume>:<fpage>1162</fpage>–<lpage>1169</lpage>.<pub-id pub-id-type="pmid">14574645</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stephens</surname><given-names>M</given-names></string-name>, <string-name><surname>Smith</surname><given-names>N</given-names></string-name>, <string-name><surname>Donnelly</surname><given-names>P</given-names></string-name></person-group>. <year>2001</year>. <article-title>A new statistical method for haplotype reconstruction from population data</article-title>. <source>Am J Hum Genet</source>. <volume>68</volume>:<fpage>978</fpage>–<lpage>989</lpage>.<pub-id pub-id-type="pmid">11254454</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Nei</surname><given-names>M</given-names></string-name></person-group>. <year>1993</year>. <article-title>Estimation of the number of nucleotide substitutions in the control region of mitochondrial DNA in humans and chimpanzees</article-title>. <source>Mol Biol Evol</source>. <volume>10</volume>:<fpage>512</fpage>–<lpage>526</lpage>.<pub-id pub-id-type="pmid">8336541</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tavaré</surname><given-names>S</given-names></string-name></person-group>. <year>1986</year>. <article-title>Some probabilistic and statistical problems in the analysis of DNA sequences</article-title>. <source>Lect Math Life Sci</source>. <volume>17</volume>:<fpage>57</fpage>–<lpage>86</lpage>.</mixed-citation>
    </ref>
    <ref id="msac119-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Uckele</surname><given-names>KA</given-names></string-name>, <string-name><surname>Adams</surname><given-names>RP</given-names></string-name>, <string-name><surname>Schwarzbach</surname><given-names>AE</given-names></string-name>, <string-name><surname>Parchman</surname><given-names>TL</given-names></string-name></person-group>. <year>2021</year>. <article-title>Genome-wide RAD sequencing resolves the evolutionary history of serrate leaf Juniperus and reveals discordance with chloroplast phylogeny</article-title>. <source>Mol Phylogenet Evol</source>. <volume>156</volume>:<fpage>107022</fpage>.<pub-id pub-id-type="pmid">33242585</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vieira</surname><given-names>FG</given-names></string-name>, <string-name><surname>Lassalle</surname><given-names>F</given-names></string-name>, <string-name><surname>Korneliussen</surname><given-names>TS</given-names></string-name>, <string-name><surname>Fumagalli</surname><given-names>M</given-names></string-name></person-group>. <year>2015</year>. <article-title>Improving the estimation of genetic distances from Next-Generation Sequencing data</article-title>. <source>Biol J Linn Soc</source>. <volume>117</volume>:<fpage>139</fpage>–<lpage>149</lpage>.</mixed-citation>
    </ref>
    <ref id="msac119-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>MA</given-names></string-name>, <string-name><surname>Fan</surname><given-names>X</given-names></string-name>, <string-name><surname>Sun</surname><given-names>B</given-names></string-name>, <string-name><surname>Chen</surname><given-names>C</given-names></string-name>, <string-name><surname>Lang</surname><given-names>J</given-names></string-name>, <string-name><surname>Ko</surname><given-names>YC</given-names></string-name>, <string-name><surname>Tsang</surname><given-names>Ch</given-names></string-name>, <string-name><surname>Chiu</surname><given-names>H</given-names></string-name>, <string-name><surname>Wang</surname><given-names>T</given-names></string-name>, <string-name><surname>Bao</surname><given-names>Q</given-names></string-name>, <etal>et al</etal></person-group><year>2020</year>. <article-title>Ancient DNA indicates human population shifts and admixture in northern and southern China</article-title>. <source>Science</source><volume>369</volume>:<fpage>282</fpage>–<lpage>288</lpage>.<pub-id pub-id-type="pmid">32409524</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Z</given-names></string-name></person-group>. <year>1994</year>. <article-title>Estimating the pattern of nucleotide substitution</article-title>. <source>J Mol Evol</source>. <volume>39</volume>:<fpage>105</fpage>–<lpage>111</lpage>.<pub-id pub-id-type="pmid">8064867</pub-id></mixed-citation>
    </ref>
    <ref id="msac119-B41">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Z</given-names></string-name></person-group>. <year>2006</year>. <source>Computational molecular evolution</source>. <publisher-loc>Oxford (UK)</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="msac119-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yuan</surname><given-names>H</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>J</given-names></string-name>, <string-name><surname>Jiménez</surname><given-names>FA</given-names></string-name>, <string-name><surname>Hoberg</surname><given-names>EP</given-names></string-name>, <string-name><surname>Cook</surname><given-names>JA</given-names></string-name>, <string-name><surname>Galbreath</surname><given-names>KE</given-names></string-name>, <string-name><surname>Li</surname><given-names>C</given-names></string-name></person-group>. <year>2016</year>. <article-title>Target gene enrichment in the cyclophyllidean cestodes, the most diverse group of tapeworms</article-title>. <source>Mol Ecol Resour</source>. <volume>16</volume>:<fpage>1095</fpage>–<lpage>1106</lpage>.<pub-id pub-id-type="pmid">27037792</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
