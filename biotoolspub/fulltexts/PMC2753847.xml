<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2753847</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-10-296</article-id>
    <article-id pub-id-type="pmid">19765293</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-10-296</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>NN-align</italic>. An artificial neural network-based alignment algorithm for MHC class II peptide binding prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Nielsen</surname>
          <given-names>Morten</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>mniel@cbs.dtu.dk</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Lund</surname>
          <given-names>Ole</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>lund@cbs.dtu.dk</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Center for Biological Sequence Analysis, Department of Systems Biology, Technical University of Denmark, Building 208, DK-2800 Lyngby, Denmark</aff>
    <pub-date pub-type="collection">
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>9</month>
      <year>2009</year>
    </pub-date>
    <volume>10</volume>
    <fpage>296</fpage>
    <lpage>296</lpage>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>3</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>9</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright Â©2009 Nielsen and Lund; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <copyright-holder>Nielsen and Lund; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/10/296"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>The major histocompatibility complex (MHC) molecule plays a central role in controlling the adaptive immune response to infections. MHC class I molecules present peptides derived from intracellular proteins to cytotoxic T cells, whereas MHC class II molecules stimulate cellular and humoral immunity through presentation of extracellularly derived peptides to helper T cells. Identification of which peptides will bind a given MHC molecule is thus of great importance for the understanding of host-pathogen interactions, and large efforts have been placed in developing algorithms capable of predicting this binding event.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Here, we present a novel artificial neural network-based method, <italic>NN-align that </italic>allows for simultaneous identification of the MHC class II binding core and binding affinity. <italic>NN-align </italic>is trained using a novel training algorithm that allows for correction of bias in the training data due to redundant binding core representation. Incorporation of information about the residues flanking the peptide-binding core is shown to significantly improve the prediction accuracy. The method is evaluated on a large-scale benchmark consisting of six independent data sets covering 14 human MHC class II alleles, and is demonstrated to outperform other state-of-the-art MHC class II prediction methods.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The <italic>NN-align </italic>method is competitive with the state-of-the-art MHC class II peptide binding prediction algorithms. The method is publicly available at <ext-link ext-link-type="uri" xlink:href="http://www.cbs.dtu.dk/services/NetMHCII-2.0">http://www.cbs.dtu.dk/services/NetMHCII-2.0</ext-link>.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Major histocompatibility complex (MHC) molecules play an essential role in host-pathogen interactions determining the onset and outcome of many host immune responses. Only a small fraction of the possible peptides that can be generated from proteins of pathogenic organisms actually generate an immune response. MHC class II molecules present peptides derived from proteins taken up from the extracellular environment. They stimulate cellular and humoral immunity against pathogenic microorganisms through the actions of helper T lymphocytes. In order for a peptide to stimulate a helper T lymphocyte response, it must bind MHC II in the endocytic organelles [<xref ref-type="bibr" rid="B1">1</xref>].</p>
    <p>The MHC class I molecule is highly specific and binds a limited set of peptides of a narrow length distribution [<xref ref-type="bibr" rid="B2">2</xref>]. In contrast to this, the MHC class II molecule is highly promiscuous both with respect to composition and length of the peptide ligands [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>]. During the last decade, large efforts have been invested in developing methods to allow for <italic>in silico </italic>screening of pathogenic organisms with the purpose of identifying peptides that will bind MHC class II molecules in a given host [<xref ref-type="bibr" rid="B5">5</xref>-<xref ref-type="bibr" rid="B20">20</xref>]. The majority of these methods are trained on limited data sets covering a single or a few MHC molecules. The binding of a peptide to a given MHC molecule is predominantly determined by the amino acids present in the peptide-binding core. However, peptide residues flanking the binding core (so-called peptide flanking residues, PFR) do also to some degree affect the binding affinity of a peptide [<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>]. Most published methods for MHC class II binding prediction however focus on identifying the peptide-binding core only, ignoring the effects on the binding affinity of PFRs.</p>
    <p>In two recent publications, we have demonstrated i) how a stabilization matrix method (<italic>SMM-align</italic>) could be applied to simultaneously identify the peptide-binding core and predict the binding strength [<xref ref-type="bibr" rid="B20">20</xref>], and ii) how this peptide core alignment together with information about the peptide flanking residues could be integrated in a neural network-based algorithm that allows for pan-specific HLA-DR binding prediction (<italic>NetMHCIIpan</italic>) [<xref ref-type="bibr" rid="B23">23</xref>]. Both the <italic>SMM-align </italic>and the <italic>NetMHCIIpan </italic>methods have in recent benchmarks been shown to be among the best publicly available methods for HLA-DR peptide binding prediction [<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B24">24</xref>].</p>
    <p>Here, we show how an artificial neural network-based alignment method, <italic>NN-align</italic>, can significantly outperform both the <italic>SMM-align </italic>and <italic>NetMHCIIpan </italic>methods. The <italic>NN-align </italic>method includes explicit encoding of the peptide flanking residues in terms of amino acid composition and length, as well as a novel scheme for neural network training that deals with the data redundancy inherent in the peptide data due to multiple examples of identical binding cores. The <italic>NN-align </italic>method is trained on a large data set of more than 14,000 quantitative peptide MHC binding values covering 14 HLA-DR alleles. The performance is evaluated on five independent data sets and its performance is compared to the best publicly available state-of-the-art MHC class II prediction methods.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Data</title>
      <p>A quantitative IEDB HLA-DR restricted peptide-binding data set was obtained from the data published by Nielsen et al. [<xref ref-type="bibr" rid="B23">23</xref>]. The data set comprises 14 HLA-DR alleles each characterized by at least 420 and up to 5166 peptide binding data points. To minimize the peptide overlap between training and testing data, the binding data for each HLA-DR allele was partitioned into 5 data sets using the approach outlined by Nielsen et al. [<xref ref-type="bibr" rid="B20">20</xref>] minimizing the sequence overlap between the training and test data. Each data set and corresponding partition is made available online at <ext-link ext-link-type="uri" xlink:href="http://www.cbs.dtu.dk/suppl/immunology/NetMHCII-2.0.php">http://www.cbs.dtu.dk/suppl/immunology/NetMHCII-2.0.php</ext-link>.</p>
      <p>The method was evaluated further on five independent data sets taken from recent MHC class II benchmark publications. The HLA-DR class II ligand data set from the SYFPEITHI database [<xref ref-type="bibr" rid="B4">4</xref>] was taken from Nielsen et al. [<xref ref-type="bibr" rid="B23">23</xref>]. Only ligands restricted by one of the 14 HLA-DR alleles in the quantitative binding data set were included. This SYFPEITHI data set consists of 475 MHC ligands. The peptide core data set was also taken from Nielsen et al. [<xref ref-type="bibr" rid="B23">23</xref>] to evaluate the ability of the proposed method to identify the core of HLA-DR binding peptides. As a further evaluation, the method was evaluated against the benchmark data sets published by Lin et al. [<xref ref-type="bibr" rid="B24">24</xref>] and Wang et al. [<xref ref-type="bibr" rid="B18">18</xref>]. The Lin data set data set contains binding affinities of 103 overlapping peptides to seven common HLA-DR molecules (DRB1*0101, 0301, 0401, 0701, 1101, 1301, and 1501). Only six of the seven alleles were included since the DRB1*1301 allele is not covered by the data in the quantitative training data set. All methods from the Lin benchmark that cover all six alleles and which were labeled as "best performing" by Lin at al. were included in the benchmark. The Wang et al. benchmark consists of quantitative binding data to 14 HLA-DR alleles. In this benchmark, the predictive performance of the NN-based method was evaluated using 10-fold cross-validation. Finally, to investigate how the performance of the NN-based method depends on the inherent similarity in the peptide data, the method was benchmarked using the El-Manzalawy benchmark data set [<xref ref-type="bibr" rid="B25">25</xref>]. Three data sets with different degrees of inherent peptide similarity were selected from the IEDB benchmark data set: UPDS; unique peptides from the IEDB data base, SRDS1; sequence similarity reduced UPDS data excluding peptides sharing 9 mer subsequences, and SRDS2; sequence similarity reduced SRDS1 data ensuring maximum 80% similarity between pairs of peptides. Three support vector machine (SVM) based MHC class II binding prediction methods were included in the El-Manzalawy et al. benchmark; composition transition distribution (CTD), local alignment kernel (LA), and k-spectrum kernel (5-spectrum). The performance of the different methods was evaluated using the AUC measure since this is the only measure provided in the El-Manzalawy paper that does not depend on binding affinity classification.</p>
    </sec>
    <sec>
      <title>Method</title>
      <p><italic>NN-align </italic>was implemented as a conventional feed-forward artificial neural network method [<xref ref-type="bibr" rid="B26">26</xref>]. The method consists of a two-step procedure that simultaneously estimates the optimal peptide binding register (core) and network weight configuration. Initially, all network weights were assigned random values. Given this set of network weights, the core of a given peptide was identified as the highest scoring of all 9 mers contained within the peptide. The score of a 9 mer peptide was calculated using the conventional feed-forward algorithm. The network weights were updated using gradient descent back-propagation. Given a peptide core alignment, the weights were updated to lower the sum of squared errors between the predicted binding score and the measured binding affinity target value. The quantitative binding data contains a large degree of redundancy since many peptide data points have been measured repeatedly with single amino acid mutations in order to identify for instance the effect of the amino acids flanking the peptide-binding core. To limit the effect of such data redundancy, the network back-propagation was modified so that the step-size of back-propagation was divided by the binding core redundancy of the given peptide. The binding core redundancy was calculated using a Hobohm-1 algorithm [<xref ref-type="bibr" rid="B27">27</xref>] to define clusters of identical binding cores. For a peptide belonging to a cluster containing five peptides with identical binding core, the step-size of back-propagation was thus divided by five. The identification of peptide clusters was done repeatedly during the network training based on the given binding core configuration.</p>
      <p>The 9 mer peptide was encoded to the network as described for the <italic>NetMHCIIpan </italic>by Nielsen et al. [<xref ref-type="bibr" rid="B23">23</xref>]. In brief, the peptide core was presented to the network using Blosum encoding, where each amino acid was encoded by the BLOSUM log-odds vector [<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B29">29</xref>]. The peptide flanking regions (PFR) were presented as the average BLOSUM substitution frequency vector over a maximum length of three amino acids. The PFR length was encoded as L<sub>PFR</sub>/3, 1-L<sub>PFR</sub>/3, where L<sub>PFR </sub>is the length of the PFR (between 0 and 3), and the peptide length was encode as L<sub>PEP</sub>, 1-L<sub>PEP</sub>, where L<sub>PEP </sub>= 1/(1+exp((L-15)/2)) and L is the peptide length. To impose an amino acid preference at the P1 position of the binding core, a log-odds position specific scoring matrix (PSSM) was constructed using the Gibbs sampler method for class II binding prediction [<xref ref-type="bibr" rid="B10">10</xref>] using the peptide binders in the training data for the allele in question. Next, the core P1 amino acid was encoded as the P1-PSSM score for that given amino acid, i.e. for a given peptide binding register, one additional value was added to the network input as the score of the core P1 amino acid at the P1 position in the PSSM. For each peptide core, the input to the neural network thus consisted of the peptide sequence (9Ã20 = 180 inputs), the PFRs (2Ã20 = 40 inputs), the peptide length (2 inputs), the length of the C and N terminal PFR's (2Ã2 = 4 inputs), and the P1-PSSM score (1 input) resulting in a total of 227 input values. The peptide binding affinity IC50 values were encoded to the neural network as log-transformed values, using the relation 1-log (aff)/log(50000), where aff is the measured binding affinity (IC50) in nM units [<xref ref-type="bibr" rid="B29">29</xref>].</p>
      <p>The networks were trained using cross-validation. Network ensembles were trained with 2, 10, 20, 40 and 60 hidden neurons, respectively. The procedure of i) identifying the optimal peptide core, and of ii) updating the network weights to lower the predictive error was repeated for 500 cycles for each network architecture. Since the "search landscape" has a large set of local minima, each with close to identical performance values, the network training was run 10 times, each time with different initial configuration values, for each network architecture. This led to a significantly improved prediction accuracy (data not shown). In total 50 (5 architectures*10 seeds) networks were created for each training/test set configuration. For each training/test set configuration, the 10 networks with the highest test-set Pearson correlation coefficient were selected to form the final network ensemble. The binding core of a given peptide was assigned by a majority vote of the networks in the ensemble.</p>
    </sec>
    <sec>
      <title>Statistical tests</title>
      <p>All statistical comparisons were made using one-tailed binomial tests. For each comparison, it is calculated how often one method outperforms the other (excluding ties), and based on these numbers one-tailed p-values were calculated. P-values less than 0.05 were taken to be significant.</p>
    </sec>
    <sec>
      <title>SMM-align and NetMHCIIpan methods</title>
      <p>The <italic>SMM-align </italic>method was trained as described by Nielsen et al. [<xref ref-type="bibr" rid="B20">20</xref>] on the IEDB quantitative data set combined with HLA-DR ligand data obtained from the SYFPEITHI database [<xref ref-type="bibr" rid="B30">30</xref>]. The <italic>NetMHCIIpan </italic>method was used via the online server-link <ext-link ext-link-type="uri" xlink:href="http://www.cbs.dtu.dk/services/NetMHCIIpan">http://www.cbs.dtu.dk/services/NetMHCIIpan</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>The quantitative IEDB benchmark data set</title>
      <p>The predictive performance of the artificial neural network (NN) based methods on the quantitative IEDB benchmark data set is shown in Table <xref ref-type="table" rid="T1">1</xref>. The performance was estimated using five-fold cross-validation. In each cross-validation, 1/5 of the data were left out for evaluation and the remaining 4/5 were used for a four-fold cross-validated training as described in the methods section. The four-fold cross-validated training resulted in an ensemble of 40 networks. The predictive binding affinity for the peptides in the evaluation set was next calculated as a simple average over the 40 network predictions, and the peptide-binding core was identified by a majority vote. In this approach, no peptide from the evaluation set was included in either the network training or the identification of the optimal network ensemble.</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Predictive performance for the 14 HLA-DR alleles in the quantitative IEDB benchmark dataset.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">Allele</th>
              <th align="left">#</th>
              <th align="right">
                <italic>TEPITOPE</italic>
              </th>
              <th align="right">
                <italic>SMM-align</italic>
              </th>
              <th align="right">NN</th>
              <th align="right">NN-W</th>
              <th align="right">NN-P1</th>
              <th align="right">NN-W-P1</th>
              <th align="right">NN-xPFR</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">DRB1*0101</td>
              <td align="left">5166</td>
              <td align="right">0.720</td>
              <td align="right">0.802</td>
              <td align="right">
                <bold>
                  <underline>0.837</underline>
                </bold>
              </td>
              <td align="right">0.836</td>
              <td align="right">0.833</td>
              <td align="right">0.833</td>
              <td align="right">0.813</td>
            </tr>
            <tr>
              <td align="left">DRB1*0301</td>
              <td align="left">1020</td>
              <td align="right">0.664</td>
              <td align="right">0.795</td>
              <td align="right">0.808</td>
              <td align="right">0.816</td>
              <td align="right">
                <bold>
                  <underline>0.817</underline>
                </bold>
              </td>
              <td align="right">
                <bold>
                  <underline>0.817</underline>
                </bold>
              </td>
              <td align="right">0.778</td>
            </tr>
            <tr>
              <td align="left">DRB1*0401</td>
              <td align="left">1024</td>
              <td align="right">0.716</td>
              <td align="right">0.751</td>
              <td align="right">
                <bold>
                  <underline>0.768</underline>
                </bold>
              </td>
              <td align="right">0.771</td>
              <td align="right">0.764</td>
              <td align="right">0.766</td>
              <td align="right">0.764</td>
            </tr>
            <tr>
              <td align="left">DRB1*0404</td>
              <td align="left">663</td>
              <td align="right">0.770</td>
              <td align="right">0.801</td>
              <td align="right">0.815</td>
              <td align="right">
                <bold>
                  <underline>0.818</underline>
                </bold>
              </td>
              <td align="right">0.816</td>
              <td align="right">0.817</td>
              <td align="right">0.814</td>
            </tr>
            <tr>
              <td align="left">DRB1*0405</td>
              <td align="left">630</td>
              <td align="right">0.759</td>
              <td align="right">
                <underline>0.789</underline>
              </td>
              <td align="right">0.771</td>
              <td align="right">0.781</td>
              <td align="right">0.779</td>
              <td align="right">
                <bold>0.784</bold>
              </td>
              <td align="right">0.773</td>
            </tr>
            <tr>
              <td align="left">DRB1*0701</td>
              <td align="left">853</td>
              <td align="right">0.761</td>
              <td align="right">0.812</td>
              <td align="right">
                <bold>
                  <underline>0.844</underline>
                </bold>
              </td>
              <td align="right">0.841</td>
              <td align="right">0.839</td>
              <td align="right">0.838</td>
              <td align="right">0.813</td>
            </tr>
            <tr>
              <td align="left">DRB1*0802</td>
              <td align="left">420</td>
              <td align="right">0.766</td>
              <td align="right">0.787</td>
              <td align="right">0.826</td>
              <td align="right">
                <bold>
                  <underline>0.832</underline>
                </bold>
              </td>
              <td align="right">0.820</td>
              <td align="right">0.822</td>
              <td align="right">0.802</td>
            </tr>
            <tr>
              <td align="left">DRB1*0901</td>
              <td align="left">530</td>
              <td/>
              <td align="right">
                <underline>0.655</underline>
              </td>
              <td align="right">0.623</td>
              <td align="right">0.616</td>
              <td align="right">0.618</td>
              <td align="right">
                <bold>0.640</bold>
              </td>
              <td align="right">0.623</td>
            </tr>
            <tr>
              <td align="left">DRB1*1101</td>
              <td align="left">950</td>
              <td align="right">0.721</td>
              <td align="right">0.796</td>
              <td align="right">0.822</td>
              <td align="right">
                <bold>
                  <underline>0.823</underline>
                </bold>
              </td>
              <td align="right">0.818</td>
              <td align="right">0.813</td>
              <td align="right">0.802</td>
            </tr>
            <tr>
              <td align="left">DRB1*1302</td>
              <td align="left">498</td>
              <td align="right">0.652</td>
              <td align="right">0.785</td>
              <td align="right">0.822</td>
              <td align="right">
                <bold>
                  <underline>0.831</underline>
                </bold>
              </td>
              <td align="right">0.822</td>
              <td align="right">0.824</td>
              <td align="right">0.811</td>
            </tr>
            <tr>
              <td align="left">DRB1*1501</td>
              <td align="left">934</td>
              <td align="right">0.686</td>
              <td align="right">0.727</td>
              <td align="right">0.754</td>
              <td align="right">0.758</td>
              <td align="right">0.754</td>
              <td align="right">0.754</td>
              <td align="right">
                <bold>
                  <underline>0.761</underline>
                </bold>
              </td>
            </tr>
            <tr>
              <td align="left">DRB3*0101</td>
              <td align="left">549</td>
              <td/>
              <td align="right">0.836</td>
              <td align="right">
                <bold>
                  <underline>0.855</underline>
                </bold>
              </td>
              <td align="right">0.844</td>
              <td align="right">0.838</td>
              <td align="right">0.841</td>
              <td align="right">0.831</td>
            </tr>
            <tr>
              <td align="left">DRB4*0101</td>
              <td align="left">446</td>
              <td/>
              <td align="right">0.793</td>
              <td align="right">0.811</td>
              <td align="right">0.811</td>
              <td align="right">0.815</td>
              <td align="right">
                <bold>
                  <underline>0.818</underline>
                </bold>
              </td>
              <td align="right">0.813</td>
            </tr>
            <tr>
              <td align="left">DRB5*0101</td>
              <td align="left">924</td>
              <td align="right">0.680</td>
              <td align="right">0.761</td>
              <td align="right">0.789</td>
              <td align="right">
                <bold>
                  <underline>0.797</underline>
                </bold>
              </td>
              <td align="right">0.790</td>
              <td align="right">0.790</td>
              <td align="right">0.787</td>
            </tr>
            <tr>
              <td colspan="9">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">Ave</td>
              <td/>
              <td align="right">0.718</td>
              <td align="right">0.778</td>
              <td align="right">0.796</td>
              <td align="right">0.798</td>
              <td align="right">0.795</td>
              <td align="right">0.797</td>
              <td align="right">0.785</td>
            </tr>
            <tr>
              <td align="left">Ave*</td>
              <td/>
              <td align="right">0.716</td>
              <td align="right">0.785</td>
              <td align="right">0.809</td>
              <td align="right">0.810</td>
              <td align="right">0.807</td>
              <td align="right">0.808</td>
              <td align="right">0.793</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The performance was estimated using five-fold cross-validation and is given as the area under the ROC curve (AUC) calculated using a binding affinity threshold of 500 nM. <italic>SMM-align </italic>is the <italic>SMM-align </italic>method described by Nielsen et al. [<xref ref-type="bibr" rid="B20">20</xref>] re-trained on the quantitative benchmark data set. <italic>TEPITOPE </italic>refers to the method developed by Sturniolo et al. [<xref ref-type="bibr" rid="B17">17</xref>]. <italic>NN </italic>is the standard NN-based method, <italic>NN-W </italic>is the NN-based method including data redundancy step-size rescaling, <italic>NN-P1 </italic>is the NN-based method including PSSM-P1 amino acid encoding, <italic>NN-W-P1 </italic>is the NN-based method including data redundancy step-size rescaling and PSSM-P1 amino acid encoding. <italic>NN-xPFR </italic>is the <italic>NN-W-P1 </italic>method excluding peptide-flanking residue encoding. For each allele, the best performing NN method is highlighted in bold and the best performing of all methods is underlined. Ave is the average per-allele performance over all 14 alleles, and Ave* is the average predictive performance over the 14 alleles weighted by the number of data points for each allele.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Table <xref ref-type="table" rid="T1">1</xref> shows the predictive performance in terms of AUC [<xref ref-type="bibr" rid="B31">31</xref>] (area under the receiver operator curve) of the different NN-based methods. Performance values in terms of the Pearson's correlation coefficient are shown in supplementary material [see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>]. Further, the predictive performance of the <italic>SMM-align </italic>[<xref ref-type="bibr" rid="B20">20</xref>] and <italic>TEPITOPE </italic>[<xref ref-type="bibr" rid="B17">17</xref>] methods is given. The <italic>TEPITOPE </italic>method does not produce prediction values that are linearly related to the log-transformed binding affinities, which is why for this method only AUC values are reported. The performance is shown for five different versions of the NN-based method, each including different degrees of sophistication in the training algorithm. <italic>NN </italic>is the standard NN-based method, <italic>NN-W </italic>is the NN-based method including data redundancy step-size rescaling, <italic>NN-P1 </italic>is the NN-based method including PSSM-P1 amino acid encoding, <italic>NN-W-P1 </italic>is the NN-based method including both data redundancy step-size rescaling and PSSM-P1 amino acid encoding, and <italic>NN-xPFR </italic>is the <italic>NN-W-P1 </italic>method excluding peptide-flanking residue encoding.</p>
      <p>From Table <xref ref-type="table" rid="T1">1</xref>, it is clear that the NN-based methods that include data redundancy step-size rescaling (<italic>NN-W </italic>and <italic>NN-W-P1</italic>) significantly outperformed (p &lt; 0.05) their non-rescaled counterparts (<italic>NN </italic>and <italic>NN-P1</italic>). When compared to the <italic>SMM-align </italic>and <italic>TEPITOPE </italic>methods, the NN-based methods all showed a significantly improved predictive performance (p &lt; 0.05, in all cases). Only for two alleles (DRB1*0405 and DRB1*0901) did the <italic>SMM-align </italic>method outperform NN-based methods, while TEPITOPE did not perform best for any of the alleles.</p>
      <p>The per-allele binomial statistical test applied here places equal weight on all alleles and does not take into account the large differences in the peptide data available for each allele. To place a relative weight on the performance of the different alleles, Table <xref ref-type="table" rid="T1">1</xref> includes a performance value for each method calculated as the mean weighted by the number of peptides per allele. However, a pooled statistical test on all peptide data would favor methods being able to accurately predict binding for the alleles described by most data over other methods. In the per-allele binomial test for instance, the methods <italic>NN </italic>and <italic>NN-P1 </italic>have comparable performance. <italic>NN </italic>has the best performance for 7 alleles and the <italic>NN-P1 </italic>method performs best for 5 (see Table <xref ref-type="table" rid="T1">1</xref>). This difference is not significant. When performing a binomial test on the predicted error per peptide for the pooled set of 14,607 peptides, the difference between the two methods comes out highly significant in favor of the <italic>NN </italic>method (p &lt; 0.007). However, 35% of the peptide binding data are measured for the DRB1*0101 allele. The <italic>NN </italic>method performs best of the four NN-based methods on the HLA-DRB1*0101 allele and pooling the data hence favors this method over the other. When performing the same test on the pooled peptide data excluding the DRB1*0101 data, the two methods come out with comparable performance (p &lt; 0.20). Since it is essential to demonstrate that a prediction method has high predictive performance across a large set of different alleles, we therefore here limit the statistical tests to per-allele binomial tests.</p>
      <p>Comparing the performance of the NN-based method with (<italic>NN-W-P1</italic>) and without peptide-flanking residue encoding (<italic>NN-xPFR</italic>) demonstrated the importance of the latter for improved prediction accuracy. For 13 of the 14 alleles, did the inclusion of PFR improve the prediction accuracy (p &lt; 0.005). The direct and linear relationship between the <italic>NN-W-P1 </italic>prediction score and the measured binding affinity is apparent when calculating a least square linear fit between the prediction score and the log-transformed binding affinities. Here, the average slope was 0.86 Â± 0.10 and the intercept 0.05 Â± 0.05 (data not shown).</p>
      <p>The NN-based method with P1-PSSM amino acid encoding (<italic>NN-W-P1</italic>) showed a lower performance compared to the method without P1-PSSM amino acid encoding (<italic>NN-W</italic>). However, when investigating the amino acid distribution at the P1 position of the predicted binding cores of the two methods, it became apparent that the <italic>NN-W-P1 </italic>method produces a P1 binding core amino acid preference that is in stronger accordance with prior experimental knowledge than the <italic>NN-W </italic>method. Only hydrophobic amino acids have experimentally been found to be allowed at the P1 position in the binding core of HLA-DR molecules [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B32">32</xref>]. For the 14 alleles in Table <xref ref-type="table" rid="T1">1</xref>, we found that the <italic>NN-W </italic>method on average assigned 30% of the predicted binders to have non-conventional P1 amino acids, whereas the corresponding value for the <italic>NN-W-P1 </italic>method was 16%.</p>
    </sec>
    <sec>
      <title>Identification of the peptide-binding core</title>
      <p>To further investigate the effect of this difference in P1 binding core amino acid preference, the ability to correctly identify the binding core of HLA-DR binding peptides was investigated. The HLA-DR binding core data set was taken from Nielsen et al. [<xref ref-type="bibr" rid="B23">23</xref>] and consists of 15 peptides where the binding register to a HLA-DR allele has been determined from the structure of the protein complex. The result of the benchmark is shown in Table <xref ref-type="table" rid="T2">2</xref>. From this table, it is clear that the <italic>NN-W-P1 </italic>method was to a higher degree capable of identifying peptide-binding cores than <italic>NN-W</italic>. <italic>TEPITOPE </italic>correctly identified all 15 binding cores, the <italic>NN-W-P1 </italic>method (together with <italic>SMM-align </italic>and <italic>NetMHCIIpan</italic>) misaligned one peptide by a single amino acid residue, whereas the <italic>NN-W </italic>method misaligned 5 peptides.</p>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Identification of peptide binding cores.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">Allele</th>
              <th align="left">Peptide</th>
              <th align="left">Core</th>
              <th align="left">
                <italic>TEPITOPE</italic>
              </th>
              <th align="left">
                <italic>SMM-align</italic>
              </th>
              <th align="left">
                <italic>NetMHCIIPan</italic>
              </th>
              <th align="left">
                <italic>NN-W-P1</italic>
              </th>
              <th align="left">
                <italic>NN-W</italic>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">DRB1*0101</td>
              <td align="left">
                <monospace>
                  <bold>AGFKGEQGPKGEPG</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKGEQGPKG</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKGEQGPKG</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKGEQGPKG</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKGEQGPKG</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKGEQGPKG</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKGEQGPKG</bold>
                </monospace>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*0101</td>
              <td align="left">
                <monospace>
                  <bold>GELIGILNAAKVPAD</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>IGILNAAKV</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>IGILNAAKV</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>IGILNAAKV</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>IGILNAAKV</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>IGILNAAKV</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>IGILNAAKV</bold>
                </monospace>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*0101</td>
              <td align="left">
                <monospace>
                  <bold>PEVIPMFSALSEGATP</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VIPMFSALS</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VIPMFSALS</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VIPMFSALS</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VIPMFSALS</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VIPMFSALS</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VIPMFSALS</bold>
                </monospace>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*0101</td>
              <td align="left">
                <monospace>
                  <bold>PKYVKQNTLKLAT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YVKQNTLKL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YVKQNTLKL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YVKQNTLKL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YVKQNTLKL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YVKQNTLKL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YVKQNTLKL</bold>
                </monospace>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*0101</td>
              <td align="left">
                <monospace>
                  <bold>VGSDWRFLRGYHQYA</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>WRFLRGYHQ</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>WRFLRGYHQ</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>WRFLRGYHQ</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>WRFLRGYHQ</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>WRFLRGYHQ</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>WRFLRGYHQ</bold>
                </monospace>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*0101</td>
              <td align="left">
                <monospace>
                  <bold>AFVKQNAAALA</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FVKQNAAAL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FVKQNAAAL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>
                    <underline>VKQNAAALA</underline>
                  </bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FVKQNAAAL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FVKQNAAAL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FVKQNAAAL</bold>
                </monospace>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*0101</td>
              <td align="left">
                <monospace>
                  <bold>AAYSDQATPLLLSPR</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YSDQATPLL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YSDQATPLL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YSDQATPLL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YSDQATPLL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YSDQATPLL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YSDQATPLL</bold>
                </monospace>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*0301</td>
              <td align="left">
                <monospace>
                  <bold>PVSKMRMATPLLMQA</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>MRMATPLLM</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>MRMATPLLM</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>MRMATPLLM</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>MRMATPLLM</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>MRMATPLLM</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>
                    <underline>VSKMRMATP</underline>
                  </bold>
                </monospace>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*0401</td>
              <td align="left">
                <monospace>
                  <bold>AYMRADAAAGGA</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>MRADAAAGG</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>MRADAAAGG</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>MRADAAAGG</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>
                    <underline>YMRADAAAG</underline>
                  </bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>
                    <underline>YMRADAAAG</underline>
                  </bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>
                    <underline>AYMRADAAA</underline>
                  </bold>
                </monospace>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*0401</td>
              <td align="left">
                <monospace>
                  <bold>PKYVKQNTLKLAT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YVKQNTLKL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YVKQNTLKL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YVKQNTLKL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YVKQNTLKL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YVKQNTLKL</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>
                    <underline>KYVKQNTLK</underline>
                  </bold>
                </monospace>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*1501</td>
              <td align="left">
                <monospace>
                  <bold>ENPVVHFFKNIVTPR</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VHFFKNIVT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VHFFKNIVT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VHFFKNIVT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VHFFKNIVT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VHFFKNIVT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>
                    <underline>VVHFFKNIV</underline>
                  </bold>
                </monospace>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*1501</td>
              <td align="left">
                <monospace>
                  <bold>ENPVVHFFKNIVTPRGGSGGGGG</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VHFFKNIVT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VHFFKNIVT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VHFFKNIVT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VHFFKNIVT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>VHFFKNIVT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>
                    <underline>VVHFFKNIV</underline>
                  </bold>
                </monospace>
              </td>
            </tr>
            <tr>
              <td align="left">DRB5*0101</td>
              <td align="left">
                <monospace>
                  <bold>GGVYHFVKKHVHES</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YHFVKKHVH</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YHFVKKHVH</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YHFVKKHVH</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YHFVKKHVH</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YHFVKKHVH</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>YHFVKKHVH</bold>
                </monospace>
              </td>
            </tr>
            <tr>
              <td align="left">DRB5*0101</td>
              <td align="left">
                <monospace>
                  <bold>NPVVHFFKNIVTPRTPPPSQ</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKNIVTPRT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKNIVTPRT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKNIVTPRT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKNIVTPRT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKNIVTPRT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKNIVTPRT</bold>
                </monospace>
              </td>
            </tr>
            <tr>
              <td align="left">DRB5*0101</td>
              <td align="left">
                <monospace>
                  <bold>VHFFKNIVTPRTPGG</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKNIVTPRT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKNIVTPRT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKNIVTPRT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKNIVTPRT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKNIVTPRT</bold>
                </monospace>
              </td>
              <td align="left">
                <monospace>
                  <bold>FKNIVTPRT</bold>
                </monospace>
              </td>
            </tr>
            <tr>
              <td colspan="8">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">Correct</td>
              <td/>
              <td/>
              <td align="left">15/15</td>
              <td align="left">14/15</td>
              <td align="left">14/15</td>
              <td align="left">14/15</td>
              <td align="left">10/15</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>15 HLA-DR restricted peptides compiled from the protein database [<xref ref-type="bibr" rid="B32">32</xref>]. The columns in the table state the HLA restriction, the peptide sequence, the binding core as determined from the protein structure, followed by the binding core as predicted by <italic>TEPITOPE, SMM-align, NetMHCIIpan</italic>, <italic>NN-W-P1 </italic>(the NN-based method including data redundancy step-size rescaling and P1-PSSM encoding), and <italic>NN-W </italic>(the NN-based method including data redundancy step-size rescaling), respectively. Erroneous predictions are underlined.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Identifying endogenously presented peptides</title>
      <p>We next turned to the benchmark of HLA-DR endogenously presented ligands. The benchmark was performed as described by Nielsen et al [<xref ref-type="bibr" rid="B23">23</xref>]. In short, the ligand source protein was split into overlapping peptide sequences of the length of the ligand. All peptides except the annotated HLA ligand were taken as negatives. This is a very strong assumption since suboptimal peptides that could be presented on the HLA molecule are counted as negatives. This setup thus most likely underestimated the predictive performance, but the effect should be equal for all methods. For each protein-HLA ligand pair, the predictive performance was estimated as the AUC value. In the benchmark, we compared the predictive performance of the NN-based method including data redundancy step-size rescaling with (<italic>NN-W-P1</italic>) and without (<italic>NN-W</italic>) PSSM-P1 amino acid encoding to that of <italic>TEPITOPE </italic>and <italic>NetMHCIIpan </italic>[<xref ref-type="bibr" rid="B23">23</xref>]. The <italic>SMM-align </italic>method was not included here since it was trained on both quantitative and HLA ligand binding data [<xref ref-type="bibr" rid="B20">20</xref>]. The summary of this benchmark is shown in Table <xref ref-type="table" rid="T3">3</xref>.</p>
      <table-wrap id="T3" position="float">
        <label>Table 3</label>
        <caption>
          <p>The HLA-DR ligand benchmark.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">Allele</th>
              <th align="right">N</th>
              <th align="right">
                <italic>NetMHCIIpan</italic>
              </th>
              <th align="right">
                <italic>TEPITOPE</italic>
              </th>
              <th align="right">
                <italic>NN-W-P1</italic>
              </th>
              <th align="right">
                <italic>NN-W</italic>
              </th>
              <th align="right">
                <italic>NN-xPFR</italic>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">DRB1*0101</td>
              <td align="right">37</td>
              <td align="right">0.873</td>
              <td align="right">0.883</td>
              <td align="right">
                <bold>
                  <underline>0.899</underline>
                </bold>
              </td>
              <td align="right">0.882</td>
              <td align="right">0.863</td>
            </tr>
            <tr>
              <td align="left">DRB1*0301</td>
              <td align="right">26</td>
              <td align="right">0.882</td>
              <td align="right">0.837</td>
              <td align="right">0.862</td>
              <td align="right">
                <bold>
                  <underline>0.906</underline>
                </bold>
              </td>
              <td align="right">0.788</td>
            </tr>
            <tr>
              <td align="left">DRB1*0401</td>
              <td align="right">209</td>
              <td align="right">0.865</td>
              <td align="right">
                <underline>0.876</underline>
              </td>
              <td align="right">
                <bold>0.865</bold>
              </td>
              <td align="right">0.843</td>
              <td align="right">0.848</td>
            </tr>
            <tr>
              <td align="left">DRB1*0404</td>
              <td align="right">46</td>
              <td align="right">
                <underline>0.817</underline>
              </td>
              <td align="right">0.790</td>
              <td align="right">
                <bold>0.776</bold>
              </td>
              <td align="right">0.772</td>
              <td align="right">0.770</td>
            </tr>
            <tr>
              <td align="left">DRB1*0405</td>
              <td align="right">35</td>
              <td align="right">0.848</td>
              <td align="right">0.809</td>
              <td align="right">
                <bold>
                  <underline>0.892</underline>
                </bold>
              </td>
              <td align="right">0.866</td>
              <td align="right">0.878</td>
            </tr>
            <tr>
              <td align="left">DRB1*0701</td>
              <td align="right">36</td>
              <td align="right">0.687</td>
              <td align="right">0.711</td>
              <td align="right">
                <bold>
                  <underline>0.761</underline>
                </bold>
              </td>
              <td align="right">0.754</td>
              <td align="right">0.757</td>
            </tr>
            <tr>
              <td align="left">DRB1*0802</td>
              <td align="right">1</td>
              <td align="right">0.982</td>
              <td align="right">0.914</td>
              <td align="right">
                <bold>
                  <underline>0.984</underline>
                </bold>
              </td>
              <td align="right">0.979</td>
              <td align="right">0.959</td>
            </tr>
            <tr>
              <td align="left">DRB1*0901</td>
              <td align="right">4</td>
              <td align="right">0.865</td>
              <td/>
              <td align="right">0.867</td>
              <td align="right">0.864</td>
              <td align="right">
                <bold>
                  <underline>0.878</underline>
                </bold>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*1101</td>
              <td align="right">27</td>
              <td align="right">0.873</td>
              <td align="right">0.863</td>
              <td align="right">
                <bold>
                  <underline>0.894</underline>
                </bold>
              </td>
              <td align="right">0.876</td>
              <td align="right">0.881</td>
            </tr>
            <tr>
              <td align="left">DRB1*1302</td>
              <td align="right">21</td>
              <td align="right">0.605</td>
              <td align="right">
                <underline>0.761</underline>
              </td>
              <td align="right">
                <bold>0.702</bold>
              </td>
              <td align="right">0.687</td>
              <td align="right">0.681</td>
            </tr>
            <tr>
              <td align="left">DRB1*1501</td>
              <td align="right">12</td>
              <td align="right">0.770</td>
              <td align="right">0.729</td>
              <td align="right">0.767</td>
              <td align="right">0.766</td>
              <td align="right">
                <bold>
                  <underline>0.776</underline>
                </bold>
              </td>
            </tr>
            <tr>
              <td align="left">DRB3*0101</td>
              <td align="right">2</td>
              <td align="right">
                <underline>0.957</underline>
              </td>
              <td/>
              <td align="right">0.680</td>
              <td align="right">
                <bold>0.730</bold>
              </td>
              <td align="right">0.681</td>
            </tr>
            <tr>
              <td align="left">DRB4*0101</td>
              <td align="right">4</td>
              <td align="right">0.471</td>
              <td/>
              <td align="right">
                <bold>
                  <underline>0.540</underline>
                </bold>
              </td>
              <td align="right">0.492</td>
              <td align="right">0.496</td>
            </tr>
            <tr>
              <td align="left">DRB5*0101</td>
              <td align="right">15</td>
              <td align="right">0.840</td>
              <td align="right">0.853</td>
              <td align="right">
                <bold>
                  <underline>0.877</underline>
                </bold>
              </td>
              <td align="right">0.819</td>
              <td align="right">0.851</td>
            </tr>
            <tr>
              <td colspan="7">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">
                <bold>Ave</bold>
              </td>
              <td/>
              <td align="right">0.810</td>
              <td/>
              <td align="right">0.812</td>
              <td align="right">0.804</td>
              <td align="right">0.794</td>
            </tr>
            <tr>
              <td align="left">
                <bold>Ave*</bold>
              </td>
              <td/>
              <td align="right">0.830</td>
              <td/>
              <td align="right">0.842</td>
              <td align="right">0.824</td>
              <td align="right">0.824</td>
            </tr>
            <tr>
              <td align="left">
                <bold>Ave**</bold>
              </td>
              <td/>
              <td align="right">0.822</td>
              <td align="right">0.821</td>
              <td align="right">0.844</td>
              <td align="right">0.834</td>
              <td align="right">0.824</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The benchmark data set consists of 475 HLA-DR restricted ligands downloaded from the SYFPEITHI database of MHC ligands covering 14 HLA-DR alleles. The predictive performance was estimated in terms of the AUC as described in the text. Ave is the average per-allele performance over all 14 alleles. Ave* is the average predictive performance over all 475 ligand/HLA-DR pairs. Ave** is the average per allele performance over the 11 alleles covered by the <italic>TEPITOPE </italic>method. <italic>NetMHCIIpan </italic>is the HLA-DR pan-specific method described by Nielsen et al. [<xref ref-type="bibr" rid="B23">23</xref>]. <italic>TEPITOPE </italic>refers to the method developed by Sturniolo et al [<xref ref-type="bibr" rid="B17">17</xref>]. <italic>NN-W-P1 </italic>is the NN-based method including data redundancy step-size rescaling and PSSM-P1 amino acid encoding. <italic>NN-W </italic>is the NN-based method including data redundancy step-size rescaling. <italic>NN-xPFR </italic>is the <italic>NN-W-P1 </italic>method excluding peptide flanking residue encoding. For each allele, the best performing NN method is highlighted in bold and the best performing of all methods is underlined.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>For the HLA-DR ligand benchmark, the <italic>NN-W-P1 </italic>method including P1-PSSM encoding clearly outperforms its counterpart, <italic>NN-W</italic>, not including P1-PSSM encoding. Only for two alleles did <italic>NN-W </italic>outperform the <italic>NN-W-P1 </italic>method making this difference highly statistically significant (p &lt; 0.01). Furthermore, the <italic>NN-W-P1 </italic>method significantly outperformed both the <italic>NetMHCIIpan </italic>(p &lt; 0.05) and <italic>TEPITOPE </italic>(p &lt; 0.05) methods. Likewise, it is clear that the inclusion of peptide-flanking residues significantly improved the predictive performance of the <italic>NN-W-P1 </italic>method (p &lt; 0.002).</p>
    </sec>
    <sec>
      <title>The Wang el al. benchmark data set</title>
      <p>The evaluation of the NN-based method on the Wang et al. benchmark is shown in Table <xref ref-type="table" rid="T4">4</xref>. From this benchmark, it is clear that the <italic>NN-W-P1 </italic>and <italic>NN-W </italic>methods have similar predictive performance and that they significantly outperformed all other methods in the benchmark (p &lt; 0.01 in all cases). The NN-based methods were outperformed only for one allele (DRB1*0801).</p>
      <table-wrap id="T4" position="float">
        <label>Table 4</label>
        <caption>
          <p>Predictive performance in terms of the AUC on the Wang benchmark data set.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">Allele</th>
              <th align="right">
                <italic>ARB</italic>
              </th>
              <th align="right">
                <italic>MHC2Pred</italic>
              </th>
              <th align="right">
                <italic>MHCpred</italic>
              </th>
              <th align="right">
                <italic>Propred</italic>
              </th>
              <th align="right">
                <italic>Rankpep</italic>
              </th>
              <th align="right">
                <italic>SMM-align</italic>
              </th>
              <th align="right">
                <italic>SVRMHC</italic>
              </th>
              <th align="right">
                <italic>SYF</italic>
              </th>
              <th align="right">
                <italic>Cons</italic>
              </th>
              <th align="right">
                <italic>NN-W-P1</italic>
              </th>
              <th align="right">
                <italic>NN-W</italic>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">DRB1*0101</td>
              <td align="right">0.76</td>
              <td align="right">0.67</td>
              <td align="right">0.62</td>
              <td align="right">0.74</td>
              <td align="right">0.70</td>
              <td align="right">0.77</td>
              <td align="right">0.69</td>
              <td align="right">0.71</td>
              <td align="right">0.79</td>
              <td align="right">
                <bold>
                  <underline>0.88</underline>
                </bold>
              </td>
              <td align="right">0.87</td>
            </tr>
            <tr>
              <td align="left">DRB1*0301</td>
              <td align="right">0.66</td>
              <td align="right">0.53</td>
              <td/>
              <td align="right">0.65</td>
              <td align="right">0.67</td>
              <td align="right">0.69</td>
              <td/>
              <td align="right">0.50</td>
              <td align="right">0.72</td>
              <td align="right">
                <bold>
                  <underline>0.82</underline>
                </bold>
              </td>
              <td align="right">
                <bold>
                  <underline>0.82</underline>
                </bold>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*0401</td>
              <td align="right">0.67</td>
              <td align="right">0.52</td>
              <td align="right">0.60</td>
              <td align="right">0.69</td>
              <td align="right">0.63</td>
              <td align="right">0.68</td>
              <td align="right">0.66</td>
              <td align="right">0.65</td>
              <td align="right">0.69</td>
              <td align="right">
                <bold>
                  <underline>0.73</underline>
                </bold>
              </td>
              <td align="right">0.72</td>
            </tr>
            <tr>
              <td align="left">DRB1*0404</td>
              <td align="right">0.72</td>
              <td align="right">0.64</td>
              <td/>
              <td align="right">0.79</td>
              <td align="right">0.66</td>
              <td align="right">0.75</td>
              <td/>
              <td/>
              <td align="right">0.80</td>
              <td align="right">
                <bold>
                  <underline>0.83</underline>
                </bold>
              </td>
              <td align="right">
                <bold>
                  <underline>0.83</underline>
                </bold>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*0405</td>
              <td align="right">0.67</td>
              <td align="right">0.51</td>
              <td/>
              <td align="right">0.75</td>
              <td align="right">0.62</td>
              <td align="right">0.69</td>
              <td align="right">0.62</td>
              <td/>
              <td align="right">0.72</td>
              <td align="right">
                <bold>
                  <underline>0.81</underline>
                </bold>
              </td>
              <td align="right">0.80</td>
            </tr>
            <tr>
              <td align="left">DRB1*0701</td>
              <td align="right">0.69</td>
              <td/>
              <td align="right">0.63</td>
              <td align="right">0.78</td>
              <td align="right">0.58</td>
              <td align="right">0.78</td>
              <td/>
              <td align="right">0.68</td>
              <td align="right">0.83</td>
              <td align="right">0.86</td>
              <td align="right">
                <bold>
                  <underline>0.87</underline>
                </bold>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*0802</td>
              <td align="right">0.74</td>
              <td align="right">0.70</td>
              <td/>
              <td align="right">0.77</td>
              <td/>
              <td align="right">0.75</td>
              <td/>
              <td/>
              <td align="right">
                <underline>0.82</underline>
              </td>
              <td align="right">0.79</td>
              <td align="right">
                <bold>0.81</bold>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*0901</td>
              <td align="right">0.62</td>
              <td align="right">0.48</td>
              <td/>
              <td/>
              <td align="right">0.61</td>
              <td align="right">0.66</td>
              <td/>
              <td align="right">0.73</td>
              <td align="right">0.68</td>
              <td align="right">0.68</td>
              <td align="right">
                <bold>
                  <underline>0.69</underline>
                </bold>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*1101</td>
              <td align="right">0.73</td>
              <td align="right">0.60</td>
              <td/>
              <td align="right">0.80</td>
              <td align="right">0.70</td>
              <td align="right">0.81</td>
              <td/>
              <td/>
              <td align="right">0.80</td>
              <td align="right">
                <bold>
                  <underline>0.89</underline>
                </bold>
              </td>
              <td align="right">
                <bold>
                  <underline>0.89</underline>
                </bold>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*1302</td>
              <td align="right">0.79</td>
              <td align="right">0.54</td>
              <td/>
              <td align="right">0.58</td>
              <td align="right">0.52</td>
              <td align="right">0.69</td>
              <td/>
              <td/>
              <td align="right">0.73</td>
              <td align="right">
                <bold>
                  <underline>0.78</underline>
                </bold>
              </td>
              <td align="right">
                <bold>
                  <underline>0.78</underline>
                </bold>
              </td>
            </tr>
            <tr>
              <td align="left">DRB1*1501</td>
              <td align="right">0.70</td>
              <td align="right">0.63</td>
              <td/>
              <td align="right">0.72</td>
              <td align="right">0.62</td>
              <td align="right">0.74</td>
              <td align="right">0.64</td>
              <td align="right">0.67</td>
              <td align="right">0.72</td>
              <td align="right">
                <bold>
                  <underline>0.77</underline>
                </bold>
              </td>
              <td align="right">0.76</td>
            </tr>
            <tr>
              <td align="left">DRB3*0101</td>
              <td align="right">0.59</td>
              <td/>
              <td/>
              <td/>
              <td/>
              <td align="right">0.68</td>
              <td/>
              <td/>
              <td/>
              <td align="right">0.85</td>
              <td align="right">
                <bold>
                  <underline>0.86</underline>
                </bold>
              </td>
            </tr>
            <tr>
              <td align="left">DRB4*0101</td>
              <td align="right">0.74</td>
              <td align="right">0.61</td>
              <td/>
              <td/>
              <td align="right">0.65</td>
              <td align="right">0.71</td>
              <td/>
              <td/>
              <td align="right">0.74</td>
              <td align="right">
                <bold>
                  <underline>0.86</underline>
                </bold>
              </td>
              <td align="right">
                <bold>
                  <underline>0.86</underline>
                </bold>
              </td>
            </tr>
            <tr>
              <td align="left">DRB5*0101</td>
              <td align="right">0.70</td>
              <td align="right">0.59</td>
              <td/>
              <td align="right">0.79</td>
              <td align="right">0.73</td>
              <td align="right">0.75</td>
              <td align="right">0.63</td>
              <td/>
              <td align="right">0.79</td>
              <td align="right">
                <bold>
                  <underline>0.87</underline>
                </bold>
              </td>
              <td align="right">
                <bold>
                  <underline>0.87</underline>
                </bold>
              </td>
            </tr>
            <tr>
              <td colspan="12">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">
                <bold>Ave</bold>
              </td>
              <td align="right">0.70</td>
              <td align="right">0.59</td>
              <td align="right">0.62</td>
              <td align="right">0.73</td>
              <td align="right">0.64</td>
              <td align="right">0.73</td>
              <td align="right">0.65</td>
              <td align="right">0.66</td>
              <td align="right">0.76</td>
              <td align="right">0.82</td>
              <td align="right">0.82</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p><italic>NN-W-P1 </italic>is the NN-based method including data redundancy step-size rescaling and P1-PSSM encoding and <italic>NN-W </italic>is the NN-based method including data redundancy step-size rescaling. Both methods were evaluated using 10-fold cross-validation. The performance values for the 9 other methods were taken from Wang et al. [<xref ref-type="bibr" rid="B18">18</xref>]. For each allele, the best performing NN method is highlighted in bold and the best performing of all methods is underlined.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>The Lin et al. benchmark data set</title>
      <p>The predictive performance of the <italic>NN-W-P1 </italic>and <italic>NN-W </italic>methods was next evaluated on the Lin et al. benchmark data set [<xref ref-type="bibr" rid="B24">24</xref>]. The result of this benchmark is shown in Table <xref ref-type="table" rid="T5">5</xref>. All methods from the Lin benchmark that cover at least six alleles and that were labeled as "best performing" by Lin at al. were included in the benchmark. Also from this benchmark, it is apparent that the <italic>NN-W-P1 </italic>and <italic>NN-W </italic>methods have similar predictive performance and that they outperformed all other methods in the benchmark.</p>
      <table-wrap id="T5" position="float">
        <label>Table 5</label>
        <caption>
          <p>Predictive performance in terms of the AUC on the Lin benchmark data set.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">Method</th>
              <th align="right">DRB1*0101</th>
              <th align="right">DRB1*0301</th>
              <th align="right">DRB1*0401</th>
              <th align="right">DRB1*0701</th>
              <th align="right">DRB1*1101</th>
              <th align="right">DRB1*1501</th>
              <th align="right">Ave</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">
                <italic>IEDB_SMM</italic>
              </td>
              <td align="right">0.81</td>
              <td align="right">0.71</td>
              <td align="right">0.79</td>
              <td align="right">0.67</td>
              <td align="right">0.84</td>
              <td align="right">0.67</td>
              <td align="right">0.75</td>
            </tr>
            <tr>
              <td align="left">
                <italic>IEDB_SAT</italic>
              </td>
              <td align="right">0.89</td>
              <td align="right">0.69</td>
              <td align="right">0.75</td>
              <td align="right">0.74</td>
              <td align="right">0.83</td>
              <td align="right">0.66</td>
              <td align="right">0.76</td>
            </tr>
            <tr>
              <td align="left">
                <italic>IEDB_Cons</italic>
              </td>
              <td align="right">0.83</td>
              <td align="right">0.67</td>
              <td align="right">0.72</td>
              <td align="right">0.80</td>
              <td align="right">0.84</td>
              <td align="right">0.66</td>
              <td align="right">0.75</td>
            </tr>
            <tr>
              <td align="left">
                <italic>Multipred_SVM</italic>
              </td>
              <td align="right">0.86</td>
              <td align="right">
                <underline>0.80</underline>
              </td>
              <td align="right">0.65</td>
              <td align="right">0.70</td>
              <td align="right">0.78</td>
              <td align="right">0.62</td>
              <td align="right">0.74</td>
            </tr>
            <tr>
              <td align="left">
                <italic>NetMHCII</italic>
              </td>
              <td align="right">0.77</td>
              <td align="right">0.69</td>
              <td align="right">0.81</td>
              <td align="right">0.62</td>
              <td align="right">0.78</td>
              <td align="right">0.65</td>
              <td align="right">0.72</td>
            </tr>
            <tr>
              <td align="left">
                <italic>NetMHCIIpan</italic>
              </td>
              <td align="right">0.84</td>
              <td align="right">0.65</td>
              <td align="right">0.81</td>
              <td align="right">
                <underline>0.83</underline>
              </td>
              <td align="right">0.81</td>
              <td align="right">0.79</td>
              <td align="right">0.79</td>
            </tr>
            <tr>
              <td align="left">
                <italic>Propred</italic>
              </td>
              <td align="right">0.89</td>
              <td align="right">0.70</td>
              <td align="right">0.75</td>
              <td align="right">0.74</td>
              <td align="right">0.83</td>
              <td align="right">0.66</td>
              <td align="right">0.76</td>
            </tr>
            <tr>
              <td align="left">
                <italic>SVMHC</italic>
              </td>
              <td align="right">0.86</td>
              <td align="right">0.69</td>
              <td align="right">0.75</td>
              <td align="right">0.74</td>
              <td align="right">0.83</td>
              <td align="right">0.66</td>
              <td align="right">0.76</td>
            </tr>
            <tr>
              <td align="left">
                <italic>SYF</italic>
              </td>
              <td align="right">0.72</td>
              <td align="right">0.65</td>
              <td align="right">0.69</td>
              <td align="right">0.70</td>
              <td align="right">0.59</td>
              <td align="right">0.77</td>
              <td align="right">0.69</td>
            </tr>
            <tr>
              <td colspan="8">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">
                <italic>NN-W-P1</italic>
              </td>
              <td align="right">
                <bold>
                  <underline>0.90</underline>
                </bold>
              </td>
              <td align="right">0.78</td>
              <td align="right">
                <bold>
                  <underline>0.84</underline>
                </bold>
              </td>
              <td align="right">0.75</td>
              <td align="right">
                <bold>
                  <underline>0.85</underline>
                </bold>
              </td>
              <td align="right">0.79</td>
              <td align="right">0.82</td>
            </tr>
            <tr>
              <td align="left">
                <italic>NN-W</italic>
              </td>
              <td align="right">
                <bold>
                  <underline>0.90</underline>
                </bold>
              </td>
              <td align="right">
                <bold>0.79</bold>
              </td>
              <td align="right">0.80</td>
              <td align="right">
                <bold>0.76</bold>
              </td>
              <td align="right">0.83</td>
              <td align="right">
                <bold>
                  <underline>0.82</underline>
                </bold>
              </td>
              <td align="right">0.81</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p><italic>NN-W-P1 </italic>is the NN-based method including data redundancy step-size rescaling and P1-PSSM encoding and <italic>NN-W </italic>the NN-based method including data redundancy step-size rescaling. All other methods are described in the Lin et al. publication. The AUC was calculated using the following binding affinity threshold values for each of the 6 alleles: DRB1*0101, 0401, 0701, and 1501 threshold = 100 nM, DRB1*0301, 1101, and 1301, threshold = 1000 nM (Lin HH personal communication). The performance values for the 9 methods above the dotted line were taken from Lin et al. [<xref ref-type="bibr" rid="B24">24</xref>]. For each allele, the best performing NN method is highlighted in bold and the best performing method is underlined.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>The El-Manzalawy benchmark data set</title>
      <p>The recent benchmark by El-Manzalawy and co-workers [<xref ref-type="bibr" rid="B25">25</xref>] demonstrated that the predictive performance of a given prediction method depends strongly on the inherent peptide similarity in the training data and that a benchmark ranking of peptide binding prediction algorithms could vary as a function of this similarity. To investigate to what extent the <italic>NN-align </italic>method and its performance were influenced by peptide similarities, we compared the performance of the <italic>NN-W-P1 </italic>and <italic>NN-W </italic>methods to the MHC class II binding prediction methods (<italic>5-spectrum, LA, and CTD</italic>) included in the El-Manzalawy paper on three data sets, each with a different degree of inherent sequence similarity. From the results summarized in Table <xref ref-type="table" rid="T6">6</xref> (details are given in supplementary material [see Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>]) it is clear that the NN-based methods significantly outperformed the three other methods included in the benchmark, independent of the inherent peptide similarity in the training data. Only for one single comparison, <italic>NN-W-P1 </italic>versus <italic>CTD</italic>, the difference was only marginally significant (p &lt; 0.06). The <italic>NN-W </italic>method had the highest predictive performance. The difference to <italic>NN-W-P1 </italic>was, however, only significant for the SRDS2 data set (p &lt; 0.05). This analysis demonstrated that the NN-based methods are robust and perform well also in situations where the peptide similarity is low.</p>
      <table-wrap id="T6" position="float">
        <label>Table 6</label>
        <caption>
          <p>Predictive performance in terms of the AUC on the IEDB El-Manzalawy benchmark.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th/>
              <th align="left">UPDS</th>
              <th align="left">SRDS1</th>
              <th align="left">SRDS2</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">
                <italic>NN-W-P1</italic>
              </td>
              <td align="left">0.863</td>
              <td align="left">0.699</td>
              <td align="left">0.673</td>
            </tr>
            <tr>
              <td align="left">
                <italic>NN-W</italic>
              </td>
              <td align="left">
                <bold>
                  <underline>0.864</underline>
                </bold>
              </td>
              <td align="left">
                <bold>
                  <underline>0.705</underline>
                </bold>
              </td>
              <td align="left">
                <bold>
                  <underline>0.676</underline>
                </bold>
              </td>
            </tr>
            <tr>
              <td align="left">
                <italic>CTD</italic>
              </td>
              <td align="left">0.782</td>
              <td align="left">0.639</td>
              <td align="left">0.634</td>
            </tr>
            <tr>
              <td align="left">
                <italic>LA</italic>
              </td>
              <td align="left">0.802</td>
              <td align="left">0.645</td>
              <td align="left">
                <bold>0.606</bold>
              </td>
            </tr>
            <tr>
              <td align="left">
                <italic>5-spectrum</italic>
              </td>
              <td align="left">0.748</td>
              <td align="left">0.429</td>
              <td align="left">
                <bold>0.390</bold>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The methods included are <italic>NN-W-P1 </italic>(the NN-based method including data redundancy step-size rescaling and P1-PSSM encoding), <italic>NN-W </italic>(the NN-based method including data redundancy step-size rescaling), CTD, LA, and 5-spectrum. The performance values for the latter three methods are taken from the El-Manzalawy publication [<xref ref-type="bibr" rid="B25">25</xref>]. The benchmark data sets are UPDS: Unique peptides from the IEDB database, SRDS1: Sequence similarity reduced UPDS data excluding peptides sharing 9 mer subsequences, and SRDS2: Sequence similarity reduced SRDS1 data ensuring maximum more than 80% similarity between pairs of peptides. For each allele, the best performing NN-based method is highlighted in bold and the best performing method is underlined.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>The NN-align method</title>
      <p>From the large set of benchmark studies, we conclude that the two methods <italic>NN-W-P1 </italic>and <italic>NN-W </italic>share comparable predictive performance. The <italic>NN-W-P1 </italic>method was shown to be more accurate in identifying the peptide core binding register, whereas the <italic>NN-W </italic>was more accurate when predicting the binding affinity. However, none of these differences were consistently statistically significant. The final method, called <italic>NN-align</italic>, was therefore implemented with a switch that allows the user to select whether or not to include the P1-PSSM amino acid preference encoding.</p>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>Prediction of which peptides will bind to a given MHC molecule has great implications for the understanding of how a given host will react to a pathogen infection. Here, we have developed an artificial neural network-based method, <italic>NN-align</italic>, for MHC class II peptide binding prediction. The <italic>NN-align </italic>method is inspired by the earlier published <italic>Gibbs sampler </italic>[<xref ref-type="bibr" rid="B10">10</xref>], <italic>SMM-align </italic>[<xref ref-type="bibr" rid="B20">20</xref>], and <italic>NetMHCIIpan </italic>[<xref ref-type="bibr" rid="B23">23</xref>] methods. The method is trained on a large set of quantitative peptide binding data consisting of more than 14,000 peptide affinity values covering 14 human MHC class II DR molecules. Each peptide is encoded to the method in terms of the peptide binding core and information about the length and composition of the residues flanking this core. <italic>NN-align </italic>was trained using a novel training algorithm that allows for correction of bias in the training data due to redundant binding core representation. Inclusion of peptide flanking residues was shown to significantly improve the prediction accuracy. The method was benchmarked on six independent data sets and was shown to consistently and significantly outperform other state-of-the-art MHC class II prediction algorithms, like <italic>TEPITOPE</italic>, <italic>SMM-align</italic>, and <italic>NetMHCIIpan</italic>. In particular, it was demonstrated that the <italic>NN-align </italic>method could provide both accurate quantitative predictions that directly translate into IC50 binding values and correct identification of the peptide-binding core.</p>
    <p>In contrast to the <italic>SMM-align </italic>method (and other matrix-based methods), <italic>NN-align </italic>is neural network based and can hence take into account higher order sequence correlations. For MHC class I binding, this has been demonstrated to be of importance for accurate prediction of peptide binding to MHC molecules [<xref ref-type="bibr" rid="B29">29</xref>]. Furthermore, <italic>NN-align </italic>incorporates PFR and peptide length directly into the training of the method. This is in contrast to <italic>SMM-align</italic>, where the PFR and peptide length are dealt with in an ad-hoc manner. The allele-specific <italic>NN-align </italic>and pan-specific <italic>NetMHCIIpan </italic>methods are highly similar in their design and use of peptide features. The pan-specific method, however, is one single universal method capable of predicting binding for all HLA-DR alleles of known protein sequence, in contrast to the allele-specific method, <italic>NN-align</italic>, that is trained individually for each allele. As observed for MHC class I methods, it is therefore expected that the allele-specific method will outperform the pan-specific method for alleles where sufficient data is available to accurately characterize the binding motif, as is the case for most alleles in the quantitative data set used here [<xref ref-type="bibr" rid="B33">33</xref>].</p>
    <p>The <italic>NN-align </italic>algorithm, even though here only applied to the problem of peptide MHC class II binding prediction based on peptide data points, should be generally applicable to find subtle linear sequence motifs in large scale quantitative data sets like peptide chip data for MHC binding, TCR recognition, monoclonal antibodies etc., where the precise location of the receptor peptide interaction is not <italic>a priori </italic>known [<xref ref-type="bibr" rid="B34">34</xref>].</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We have developed a method, <italic>NN-align</italic>, for prediction of peptide binding to MHC class II molecules. <italic>NN-align </italic>was trained using a novel training algorithm that allowed for correction of bias in the training data due to redundant binding core representation. The predictive performance of the method was significantly improved by incorporation of information from residues flanking the peptide-binding core. Large scale benchmarking comprising six independent data sets covering 14 human MHC class II alleles demonstrated that <italic>NN-align </italic>outperformed other state-of-the-art MHC class II prediction methods. The method and benchmark data are made publicly available at <ext-link ext-link-type="uri" xlink:href="http://www.cbs.dtu.dk/services/NetMHCII-2.0">http://www.cbs.dtu.dk/services/NetMHCII-2.0</ext-link>.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>MN developed the <italic>NN-align </italic>method, designed the benchmark, trained the prediction method and did the performance comparison between the different prediction methods, and drafted the manuscript. All authors read and corrected the manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Predictive performance for 14 HLA-DR alleles in the quantitative IEDB benchmark data set</bold>. The performance is estimated using five-fold cross-validation, and the predictive performance is estimated in terms of the Pearson's correlation. <italic>SMM-align </italic>is the <italic>SMM-align </italic>method described by Nielsen et al. [<xref ref-type="bibr" rid="B20">20</xref>] re-trained on the quantitative benchmark data set. <italic>NN </italic>is the standard NN-based method, <italic>NN-W </italic>is the NN-based method including data redundancy step-size rescaling, <italic>NN-P1 </italic>is the NN-based method including PSSM-P1 amino acid encoding, <italic>NN-W-P1 </italic>is the NN-based method including step-size rescaling and P1 amino acid encoding. <italic>NN-xPFR </italic>is the <italic>NN-W-P1 </italic>method excluding peptide-flanking residue encoding. For each allele, the best performing NN method is highlighted in bold and the best performing of all methods is underlined.</p>
      </caption>
      <media xlink:href="1471-2105-10-296-S1.DOC" mimetype="application" mime-subtype="msword">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>Predictive performance in terms of the AUC on the IEDB El-Manzalawy benchmark</bold>. The methods included are <italic>NN-W-P1 </italic>(the NN-based method including data redundancy step-size rescaling and P1-PSSM encoding), <italic>NN-W </italic>(the NN-based method including data redundancy step-size rescaling), CTD, LA, and 5-spectrum. The performance values for the latter three methods are taken from the El-Manzalawy publication [<xref ref-type="bibr" rid="B25">25</xref>]. The benchmark data sets are UPDS: Unique peptides from the IEDB database, SRDS1: Sequence similarity reduced UPDS data excluding peptides sharing 9 mer subsequences, and SRDS2: Sequence similarity reduced SRDS1 data ensuring maximum more than 80% sequence similarity between pairs of peptides. For each allele, the best performing of all methods is underlined.</p>
      </caption>
      <media xlink:href="1471-2105-10-296-S2.DOC" mimetype="application" mime-subtype="msword">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>This work was supported by NIH contracts HHSN266200400083C and HHSN266200400025C.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Castellino</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Zhong</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>N</surname>
          <given-names>GR</given-names>
        </name>
        <article-title>Antigen presentation by MHC class II molecules: invariant chain function, protein trafficking, and the molecular basis of diverse determinant capture</article-title>
        <source>Hum Immunol</source>
        <year>1997</year>
        <volume>54</volume>
        <fpage>159</fpage>
        <lpage>169</lpage>
        <pub-id pub-id-type="doi">10.1016/S0198-8859(97)00078-5</pub-id>
        <pub-id pub-id-type="pmid">9297534</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Yewdell</surname>
          <given-names>JW</given-names>
        </name>
        <name>
          <surname>Bennink</surname>
          <given-names>JR</given-names>
        </name>
        <article-title>Immunodominance in major histocompatibility complex class I-restricted T lymphocyte responses</article-title>
        <source>Annual review of immunology</source>
        <year>1999</year>
        <volume>17</volume>
        <fpage>51</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.immunol.17.1.51</pub-id>
        <pub-id pub-id-type="pmid">10358753</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sette</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Adorini</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Colon</surname>
          <given-names>SM</given-names>
        </name>
        <name>
          <surname>Buus</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Grey</surname>
          <given-names>HM</given-names>
        </name>
        <article-title>Capacity of intact proteins to bind to MHC class II molecules</article-title>
        <source>J Immunol</source>
        <year>1989</year>
        <volume>143</volume>
        <issue>4</issue>
        <fpage>1265</fpage>
        <lpage>1267</lpage>
        <pub-id pub-id-type="pmid">2787361</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rammensee</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Bachmann</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Emmerich</surname>
          <given-names>NP</given-names>
        </name>
        <name>
          <surname>Bachor</surname>
          <given-names>OA</given-names>
        </name>
        <name>
          <surname>Stevanovic</surname>
          <given-names>S</given-names>
        </name>
        <article-title>SYFPEITHI: database for MHC ligands and peptide motifs</article-title>
        <source>Immunogenetics</source>
        <year>1999</year>
        <volume>50</volume>
        <issue>3-4</issue>
        <fpage>213</fpage>
        <lpage>219</lpage>
        <pub-id pub-id-type="doi">10.1007/s002510050595</pub-id>
        <pub-id pub-id-type="pmid">10602881</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Karpenko</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Shi</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Dai</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>Prediction of MHC class II binders using the ant colony search strategy</article-title>
        <source>Artif Intell Med</source>
        <year>2005</year>
        <volume>35</volume>
        <issue>1-2</issue>
        <fpage>147</fpage>
        <lpage>156</lpage>
        <pub-id pub-id-type="doi">10.1016/j.artmed.2005.02.002</pub-id>
        <pub-id pub-id-type="pmid">16061368</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Murugan</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Dai</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>Prediction of MHC class II binding peptides based on an iterative learning model</article-title>
        <source>Immunome research</source>
        <year>2005</year>
        <volume>1</volume>
        <fpage>6</fpage>
        <pub-id pub-id-type="doi">10.1186/1745-7580-1-6</pub-id>
        <pub-id pub-id-type="pmid">16351712</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chang</surname>
          <given-names>ST</given-names>
        </name>
        <name>
          <surname>Ghosh</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Kirschner</surname>
          <given-names>DE</given-names>
        </name>
        <name>
          <surname>Linderman</surname>
          <given-names>JJ</given-names>
        </name>
        <article-title>Peptide length-based prediction of peptide-MHC class II binding</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <issue>22</issue>
        <fpage>2761</fpage>
        <lpage>2767</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl479</pub-id>
        <pub-id pub-id-type="pmid">17000752</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Salomon</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Flower</surname>
          <given-names>DR</given-names>
        </name>
        <article-title>Predicting Class II MHC-Peptide binding: a kernel based approach using similarity scores</article-title>
        <source>BMC bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>501</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-501</pub-id>
        <pub-id pub-id-type="pmid">17105666</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bui</surname>
          <given-names>HH</given-names>
        </name>
        <name>
          <surname>Sidney</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Peters</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Sathiamurthy</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Sinichi</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Purton</surname>
          <given-names>KA</given-names>
        </name>
        <name>
          <surname>Mothe</surname>
          <given-names>BR</given-names>
        </name>
        <name>
          <surname>Chisari</surname>
          <given-names>FV</given-names>
        </name>
        <name>
          <surname>Watkins</surname>
          <given-names>DI</given-names>
        </name>
        <name>
          <surname>Sette</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Automated generation and evaluation of specific MHC binding predictive tools: ARB matrix applications</article-title>
        <source>Immunogenetics</source>
        <year>2005</year>
        <volume>57</volume>
        <issue>5</issue>
        <fpage>304</fpage>
        <lpage>314</lpage>
        <pub-id pub-id-type="doi">10.1007/s00251-005-0798-y</pub-id>
        <pub-id pub-id-type="pmid">15868141</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Nielsen</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lundegaard</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Worning</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Hvid</surname>
          <given-names>CS</given-names>
        </name>
        <name>
          <surname>Lamberth</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Buus</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Brunak</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Lund</surname>
          <given-names>O</given-names>
        </name>
        <article-title>Improved prediction of MHC class I and class II epitopes using a novel Gibbs sampling approach</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>9</issue>
        <fpage>1388</fpage>
        <lpage>1397</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth100</pub-id>
        <pub-id pub-id-type="pmid">14962912</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Xu</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Ren</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Flower</surname>
          <given-names>DR</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>T</given-names>
        </name>
        <article-title>SVRMHC prediction server for MHC-binding peptides</article-title>
        <source>BMC bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>463</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-463</pub-id>
        <pub-id pub-id-type="pmid">17059589</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Brusic</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Rudy</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Honeyman</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Hammer</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Harrison</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Prediction of MHC class II-binding peptides using an evolutionary algorithm and artificial neural network</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <issue>2</issue>
        <fpage>121</fpage>
        <lpage>130</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/14.2.121</pub-id>
        <pub-id pub-id-type="pmid">9545443</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Noguchi</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Kato</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Hanai</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Matsubara</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Honda</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Brusic</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Kobayashi</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Hidden Markov model-based prediction of antigenic peptides that interact with MHC class II molecules</article-title>
        <source>J Biosci Bioeng</source>
        <year>2002</year>
        <volume>94</volume>
        <issue>3</issue>
        <fpage>264</fpage>
        <lpage>270</lpage>
        <pub-id pub-id-type="doi">10.1263/jbb.94.264</pub-id>
        <pub-id pub-id-type="pmid">16233301</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rajapakse</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Schmidt</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Feng</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Brusic</surname>
          <given-names>V</given-names>
        </name>
        <article-title>Predicting peptides binding to MHC class II molecules using multi-objective evolutionary algorithms</article-title>
        <source>BMC bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>459</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-459</pub-id>
        <pub-id pub-id-type="pmid">18031584</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Doytchinova</surname>
          <given-names>IA</given-names>
        </name>
        <name>
          <surname>Flower</surname>
          <given-names>DR</given-names>
        </name>
        <article-title>Towards the in silico identification of class II restricted T-cell epitopes: a partial least squares iterative self-consistent algorithm for affinity prediction</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <issue>17</issue>
        <fpage>2263</fpage>
        <lpage>2270</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg312</pub-id>
        <pub-id pub-id-type="pmid">14630655</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cui</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Han</surname>
          <given-names>LY</given-names>
        </name>
        <name>
          <surname>Lin</surname>
          <given-names>HH</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>HL</given-names>
        </name>
        <name>
          <surname>Tang</surname>
          <given-names>ZQ</given-names>
        </name>
        <name>
          <surname>Zheng</surname>
          <given-names>CJ</given-names>
        </name>
        <name>
          <surname>Cao</surname>
          <given-names>ZW</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>YZ</given-names>
        </name>
        <article-title>Prediction of MHC-binding peptides of flexible lengths from sequence-derived structural and physicochemical properties</article-title>
        <source>Molecular immunology</source>
        <year>2007</year>
        <volume>44</volume>
        <issue>5</issue>
        <fpage>866</fpage>
        <lpage>877</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molimm.2006.04.001</pub-id>
        <pub-id pub-id-type="pmid">16806474</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sturniolo</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Bono</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Ding</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Raddrizzani</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Tuereci</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Sahin</surname>
          <given-names>U</given-names>
        </name>
        <name>
          <surname>Braxenthaler</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Gallazzi</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Protti</surname>
          <given-names>MP</given-names>
        </name>
        <name>
          <surname>Sinigaglia</surname>
          <given-names>F</given-names>
        </name>
        <etal/>
        <article-title>Generation of tissue-specific and promiscuous HLA ligand databases using DNA microarrays and virtual HLA class II matrices</article-title>
        <source>Nat Biotechnol</source>
        <year>1999</year>
        <volume>17</volume>
        <issue>6</issue>
        <fpage>555</fpage>
        <lpage>561</lpage>
        <pub-id pub-id-type="doi">10.1038/9858</pub-id>
        <pub-id pub-id-type="pmid">10385319</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wang</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Sidney</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Dow</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Mothe</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Sette</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Peters</surname>
          <given-names>B</given-names>
        </name>
        <article-title>A systematic assessment of MHC class II peptide binding predictions and evaluation of a consensus approach</article-title>
        <source>PLoS Comput Biol</source>
        <year>2008</year>
        <volume>4</volume>
        <issue>4</issue>
        <fpage>e1000048</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000048</pub-id>
        <pub-id pub-id-type="pmid">18389056</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Singh</surname>
          <given-names>SP</given-names>
        </name>
        <name>
          <surname>Mishra</surname>
          <given-names>BN</given-names>
        </name>
        <article-title>Prediction of MHC binding peptide using Gibbs motif sampler, weight matrix and artificial neural network</article-title>
        <source>Bioinformation</source>
        <year>2008</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>150</fpage>
        <lpage>155</lpage>
        <pub-id pub-id-type="pmid">19238237</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Nielsen</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lundegaard</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Lund</surname>
          <given-names>O</given-names>
        </name>
        <article-title>Prediction of MHC class II binding affinity using SMM-align, a novel stabilization matrix alignment method</article-title>
        <source>BMC bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>238</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-238</pub-id>
        <pub-id pub-id-type="pmid">17608956</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Godkin</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>KJ</given-names>
        </name>
        <name>
          <surname>Willis</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Tejada-Simon</surname>
          <given-names>MV</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Elliott</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Hill</surname>
          <given-names>AV</given-names>
        </name>
        <article-title>Naturally processed HLA class II peptides reveal highly conserved immunogenic flanking region sequence preferences that reflect antigen processing rather than peptide-MHC interactions</article-title>
        <source>J Immunol</source>
        <year>2001</year>
        <volume>166</volume>
        <issue>11</issue>
        <fpage>6720</fpage>
        <lpage>6727</lpage>
        <pub-id pub-id-type="pmid">11359828</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lovitch</surname>
          <given-names>SB</given-names>
        </name>
        <name>
          <surname>Pu</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Unanue</surname>
          <given-names>ER</given-names>
        </name>
        <article-title>Amino-terminal flanking residues determine the conformation of a peptide-class II MHC complex</article-title>
        <source>J Immunol</source>
        <year>2006</year>
        <volume>176</volume>
        <issue>5</issue>
        <fpage>2958</fpage>
        <lpage>2968</lpage>
        <pub-id pub-id-type="pmid">16493054</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Nielsen</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lundegaard</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Blicher</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Peters</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Sette</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Justesen</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Buus</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Lund</surname>
          <given-names>O</given-names>
        </name>
        <article-title>Quantitative predictions of peptide binding to any HLA-DR molecule of known sequence: NetMHCIIpan</article-title>
        <source>PLoS Comput Biol</source>
        <year>2008</year>
        <volume>4</volume>
        <issue>7</issue>
        <fpage>e1000107</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000107</pub-id>
        <pub-id pub-id-type="pmid">18604266</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lin</surname>
          <given-names>HH</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>GL</given-names>
        </name>
        <name>
          <surname>Tongchusak</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Reinherz</surname>
          <given-names>EL</given-names>
        </name>
        <name>
          <surname>Brusic</surname>
          <given-names>V</given-names>
        </name>
        <article-title>Evaluation of MHC-II peptide binding prediction servers: applications for vaccine research</article-title>
        <source>BMC bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>Suppl 12</issue>
        <fpage>S22</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-S12-S22</pub-id>
        <pub-id pub-id-type="pmid">19091022</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>El-Manzalawy</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Dobbs</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Honavar</surname>
          <given-names>V</given-names>
        </name>
        <article-title>On evaluating MHC-II binding peptide prediction methods</article-title>
        <source>PLoS One</source>
        <year>2008</year>
        <volume>3</volume>
        <issue>9</issue>
        <fpage>e3268</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0003268</pub-id>
        <pub-id pub-id-type="pmid">18813344</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="book">
        <name>
          <surname>Baldi</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Brunak</surname>
          <given-names>S</given-names>
        </name>
        <source>Bioinformatics: The Machine Learning Approach</source>
        <year>2001</year>
        <edition>2</edition>
        <publisher-name>Cambridge, Mass.: MIT Press</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hobohm</surname>
          <given-names>U</given-names>
        </name>
        <name>
          <surname>Scharf</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Schneider</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Sander</surname>
          <given-names>C</given-names>
        </name>
        <article-title>Selection of representative protein data sets</article-title>
        <source>Protein Sci</source>
        <year>1992</year>
        <volume>1</volume>
        <fpage>409</fpage>
        <lpage>417</lpage>
        <pub-id pub-id-type="pmid">1304348</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Henikoff</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Henikoff</surname>
          <given-names>JG</given-names>
        </name>
        <article-title>Amino acid substitution matrices from protein blocks</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1992</year>
        <volume>89</volume>
        <fpage>10915</fpage>
        <lpage>10919</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.89.22.10915</pub-id>
        <pub-id pub-id-type="pmid">1438297</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Nielsen</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lundegaard</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Worning</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Lauemoller</surname>
          <given-names>SL</given-names>
        </name>
        <name>
          <surname>Lamberth</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Buus</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Brunak</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Lund</surname>
          <given-names>O</given-names>
        </name>
        <article-title>Reliable prediction of T-cell epitopes using neural networks with novel sequence representations</article-title>
        <source>Protein Sci</source>
        <year>2003</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>1007</fpage>
        <lpage>1017</lpage>
        <pub-id pub-id-type="doi">10.1110/ps.0239403</pub-id>
        <pub-id pub-id-type="pmid">12717023</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rammensee</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Bachmann</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Emmerich</surname>
          <given-names>NP</given-names>
        </name>
        <name>
          <surname>Bachor</surname>
          <given-names>OA</given-names>
        </name>
        <name>
          <surname>Stevanovic</surname>
          <given-names>S</given-names>
        </name>
        <article-title>SYFPEITHI: database for MHC ligands and peptide motifs</article-title>
        <source>Immunogenetics</source>
        <year>1999</year>
        <volume>50</volume>
        <fpage>213</fpage>
        <lpage>219</lpage>
        <pub-id pub-id-type="doi">10.1007/s002510050595</pub-id>
        <pub-id pub-id-type="pmid">10602881</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Swets</surname>
          <given-names>JA</given-names>
        </name>
        <article-title>Measuring the accuracy of diagnostic systems</article-title>
        <source>Science (New York, NY)</source>
        <year>1988</year>
        <volume>240</volume>
        <issue>4857</issue>
        <fpage>1285</fpage>
        <lpage>1293</lpage>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Berman</surname>
          <given-names>HM</given-names>
        </name>
        <name>
          <surname>Battistuz</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Bhat</surname>
          <given-names>TN</given-names>
        </name>
        <name>
          <surname>Bluhm</surname>
          <given-names>WF</given-names>
        </name>
        <name>
          <surname>Bourne</surname>
          <given-names>PE</given-names>
        </name>
        <name>
          <surname>Burkhardt</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Feng</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Gilliland</surname>
          <given-names>GL</given-names>
        </name>
        <name>
          <surname>Iype</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Jain</surname>
          <given-names>S</given-names>
        </name>
        <etal/>
        <article-title>The Protein Data Bank</article-title>
        <source>Acta Crystallogr D Biol Crystallogr</source>
        <year>2002</year>
        <volume>58</volume>
        <issue>Pt 6 No 1</issue>
        <fpage>899</fpage>
        <lpage>907</lpage>
        <pub-id pub-id-type="doi">10.1107/S0907444902003451</pub-id>
        <pub-id pub-id-type="pmid">12037327</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Lundegaard</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Nielsen</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Pan-specific MHC class I predictors: a benchmark of HLA class I pan-specific prediction methods</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>1</issue>
        <fpage>83</fpage>
        <lpage>89</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn579</pub-id>
        <pub-id pub-id-type="pmid">18996943</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gaseitsiwe</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Valentini</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Ahmed</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Mahdavifar</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Magalhaes</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Zerweck</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Schutkowski</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Gautherot</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Montero</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Ehrnst</surname>
          <given-names>A</given-names>
        </name>
        <etal/>
        <article-title>Major histocompatibility complex class II molecule-human immunodeficiency virus peptide analysis using a microarray chip</article-title>
        <source>Clin Vaccine Immunol</source>
        <year>2009</year>
        <volume>16</volume>
        <issue>4</issue>
        <fpage>567</fpage>
        <lpage>573</lpage>
        <pub-id pub-id-type="doi">10.1128/CVI.00441-08</pub-id>
        <pub-id pub-id-type="pmid">19225081</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
