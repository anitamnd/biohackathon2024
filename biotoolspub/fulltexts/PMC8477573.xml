<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8477573</article-id>
    <article-id pub-id-type="publisher-id">542</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-021-00542-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>How can SHAP values help to shape metabolic stability of chemical compounds?</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3112-2049</contrib-id>
        <name>
          <surname>Wojtuch</surname>
          <given-names>Agnieszka</given-names>
        </name>
        <address>
          <email>agnieszka.pocha@doctoral.uj.edu.pl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4563-9230</contrib-id>
        <name>
          <surname>Jankowski</surname>
          <given-names>Rafał</given-names>
        </name>
        <address>
          <email>rafal.jankowski@student.uj.edu.pl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2891-5603</contrib-id>
        <name>
          <surname>Podlewska</surname>
          <given-names>Sabina</given-names>
        </name>
        <address>
          <email>smusz@if-pan.krakow.pl</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5522.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 2162 9631</institution-id><institution>Faculty of Mathematics and Computer Science, </institution><institution>Jagiellonian University, </institution></institution-wrap>6 S. Łojasiewicza Street, 30-348 Kraków, Poland </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.418903.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 2227 8271</institution-id><institution>Maj Institute of Pharmacology, Polish Academy of Sciences, </institution></institution-wrap>12 Smętna Street, 31-343 Kraków, Poland </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.5522.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 2162 9631</institution-id><institution>Department of Technology and Biotechnology of Drugs, Faculty of Pharmacy, </institution><institution>Jagiellonian University Medical College, </institution></institution-wrap>9 Medyczna Street, 30-688 Kraków, Poland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>74</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Computational methods support nowadays each stage of drug design campaigns. They assist not only in the process of identification of new active compounds towards particular biological target, but also help in the evaluation and optimization of their physicochemical and pharmacokinetic properties. Such features are not less important in terms of the possible turn of a compound into a future drug than its desired affinity profile towards considered proteins. In the study, we focus on metabolic stability, which determines the time that the compound can act in the organism and play its role as a drug. Due to great complexity of xenobiotic transformation pathways in the living organisms, evaluation and optimization of metabolic stability remains a big challenge.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we present a novel methodology for the evaluation and analysis of structural features influencing metabolic stability. To this end, we use a well-established explainability method called SHAP. We built several predictive models and analyse their predictions with the SHAP values to reveal how particular compound substructures influence the model’s prediction. The method can be widely applied by users thanks to the web service, which accompanies the article. It allows a detailed analysis of SHAP values obtained for compounds from the ChEMBL database, as well as their determination and analysis for any compound submitted by a user. Moreover, the service enables manual analysis of the possible structural modifications via the provision of analogous analysis for the most similar compound from the ChEMBL dataset.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">To our knowledge, this is the first attempt to employ SHAP to reveal which substructural features are utilized by machine learning models when evaluating compound metabolic stability. The accompanying web service for metabolic stability evaluation can be of great help for medicinal chemists. Its significant usefulness is related not only to the possibility of assessing compound stability, but also to the provision of information about substructures influencing this parameter. It can assist in the design of new ligands with improved metabolic stability, helping in the detection of privileged and unfavourable chemical moieties during stability optimization. The tool is available at <ext-link ext-link-type="uri" xlink:href="https://metstab-shap.matinf.uj.edu.pl/">https://metstab-shap.matinf.uj.edu.pl/</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Metabolic stability</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Web service</kwd>
      <kwd>SHAP</kwd>
      <kwd>ChEMBL database</kwd>
      <kwd>Explainability</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004281</institution-id>
            <institution>Narodowe Centrum Nauki</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">It is not a mystery that the process of drug design and development is very complex and absorbs a huge amount of time and money [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Although nowadays it significantly differs from the drug design strategies from the past (the emergence of new medicines used to be rather a result of serendipity and fortunate accidents [<xref ref-type="bibr" rid="CR3">3</xref>]), it is still a subject to relatively high risk of failure. Nevertheless, the current strategies of searching for new drugs are much more structured and several steps can be distinguished within them, such as target identification, finding the lead structure, its optimization, preclinical studies and 3 phases of clinical tests [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par5">Finding a new active compound towards a particular target is just the first step in the long path of its possible transformation into a drug. Meeting the affinity requirements is not sufficient, as a compound needs to possess favourable physicochemical and pharmacokinetic properties as well, and it should not display any toxic effects [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. Within the set of considered parameters it is also important to put attention to metabolic stability, because if a compound is transformed in the organism too quickly, it does not have enough time to induce a desired biological response [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p id="Par6">Metabolic stability is one of the most difficult parameters to be predicted by computational tools due to extreme complexity of processes related to xenobiotic transformations in the living organisms. The main role in xenobiotic metabolism is played by cytochrome P450—a group of haemoprotein enzymes with monooxidase activity. Almost sixty CYP isoforms occur in human organisms; however, it is CYP3A4 that is responsible for metabolism of the majority of drugs [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    <p id="Par7">A high number of processes that contribute to metabolic stability makes the correct prediction of this parameter a challenging task. As a result, publications on in silico tools for evaluating the speed of compound metabolism are scarce. Here, we mention a few examples of such studies. Schwaighofer et al. [<xref ref-type="bibr" rid="CR13">13</xref>] analyzed compounds examined by the Bayer Schering Pharma in terms of the percentage of compound remaining after incubation with liver microsomes for 30 min. The human, mouse, and rat datasets were used with approximately 1000–2200 datapoints each. The compounds were represented by molecular descriptors generated with Dragon software and both classification and regression probabilistic models were developed with the AUC on the test set ranging from 0.690 to 0.835. Lee et al. [<xref ref-type="bibr" rid="CR14">14</xref>] used MOE descriptors, E-State descriptors, ADME keys, and ECFP6 fingerprints to prepare Random Forest and Naïve Bayes predictive models for evaluation of compound apparent intrinsic clearance with the most effective method reaching 75% accuracy on the validation set. Bayesian approach was also used by Hu et al. [<xref ref-type="bibr" rid="CR15">15</xref>] with accuracy of compound assignment to the stable or unstable class ranging from 75 to 78%. Jensen et al. [<xref ref-type="bibr" rid="CR16">16</xref>] focused on more structurally consistent group of ligands (calcitriol analogues) and developed predictive model based on the Partial Least-Squares (PLS) regression, which was found to be 85% effective in the stable/unstable class assignment. On the other hand, Stratton et al. [<xref ref-type="bibr" rid="CR17">17</xref>] focused on the antitubercular agents and applied Bayesian models to optimize metabolic stability of one of the thienopyrimidine derivatives. Arylpiperazine core was deeply examined in terms of in silico evaluation of metabolic stability by Ulenberg et al. [<xref ref-type="bibr" rid="CR18">18</xref>] (Dragon descriptors and Support Vector Machines (SVM) were used) who obtained performance of R<sup>2</sup> = 0.844 and MSE = 0.005 on the test set. QSPR models on a diverse compound sets were constructed by Shen et al. [<xref ref-type="bibr" rid="CR19">19</xref>] with R<sup>2</sup> ranging from 0.5 to 0.6 in cross-validation experiments and stable/unstable classification with 85% accuracy on the test set.</p>
    <p id="Par8">In silico evaluation of particular compound property constitutes great support of the drug design campaigns. However, providing explanation of predictive model answers and obtaining guidance on the most advantageous compound modifications is even more helpful. Searching for such structural-activity and structural-property relationships is a subject of Quantitative Structural-Activity Relationship (QSAR) and Quantitative Structural-Property Relationship (QSPR) studies. Interpretation of such models can be performed e.g. via the application of Multiple Linear Regression (MLR) or PLS approaches [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. Descriptors importance can also be relatively easily derived from tree models [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. Recently, researchers' attention is also attracted by the deep neural nets (DNNs) [<xref ref-type="bibr" rid="CR21">21</xref>] and various visualization methods, such as the ‘SAR Matrix’ technique developed by Gupta-Ostermann and Bajorath [<xref ref-type="bibr" rid="CR22">22</xref>]. The ‘SAR Matrix’ is based on the matched molecular pair (MMP) formalism, which is also widely used for QSAR/QSPR models interpretation [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. The work of Sasahara et al. [<xref ref-type="bibr" rid="CR25">25</xref>] is one of the most recent examples of the development of interpretable models for studies on metabolic stability.</p>
    <p id="Par9">In our study, we focus on the ligand-based approach to metabolic stability prediction. We use datasets of compounds for which the half-lifetime (T1/2) was determined in human- and rat-based in vitro experiments. After compound representation by two key-based fingerprints, namely MACCS keys fingerprint (MACCSFP) [<xref ref-type="bibr" rid="CR26">26</xref>] and Klekota &amp; Roth Fingerprint (KRFP) [<xref ref-type="bibr" rid="CR27">27</xref>], we develop classification and regression models (separately for human and rat data) with the use of three machine learning (ML) approaches: Naïve Bayes classifiers [<xref ref-type="bibr" rid="CR28">28</xref>], trees [<xref ref-type="bibr" rid="CR29">29</xref>–<xref ref-type="bibr" rid="CR31">31</xref>], and SVM [<xref ref-type="bibr" rid="CR32">32</xref>]. Finally, we use Shapley Additive exPlanations (SHAP) [<xref ref-type="bibr" rid="CR33">33</xref>] to examine the influence of particular chemical substructures on the model’s outcome. It stays in line with the most recent recommendations for constructing explainable predictive models, as the knowledge they provide can relatively easily be transferred into medicinal chemistry projects and help in compound optimization towards its desired activity or physicochemical and pharmacokinetic profile [<xref ref-type="bibr" rid="CR34">34</xref>]. SHAP assigns a value, that can be seen as importance, to each feature in the given prediction. These values are calculated for each prediction separately and do not cover a general information about the entire model. High absolute SHAP values indicate high importance, whereas values close to zero indicate low importance of a feature.</p>
    <p id="Par10">The results of the analysis performed with tools developed in the study can be examined in detail using the prepared web service, which is available at <ext-link ext-link-type="uri" xlink:href="https://metstab-shap.matinf.uj.edu.pl/">https://metstab-shap.matinf.uj.edu.pl/</ext-link>. Moreover, the service enables analysis of new compounds, submitted by the user, in terms of contribution of particular structural features to the outcome of half-lifetime predictions. It returns not only SHAP-based analysis for the submitted compound, but also presents analogous evaluation for the most similar compound from the ChEMBL [<xref ref-type="bibr" rid="CR35">35</xref>] dataset. Thanks to all the above-mentioned functionalities, the service can be of great help for medicinal chemists when designing new ligands with improved metabolic stability. All datasets and scripts needed to reproduce the study are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gmum/metstab-shap">https://github.com/gmum/metstab-shap</ext-link>.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Evaluation of the ML models</title>
      <p id="Par11">We construct separate predictive models for two tasks: classification and regression. In the former case, the compounds are assigned to one of the metabolic stability classes (stable, unstable, and of middle stability) according to their half-lifetime (the T1/2 thresholds used for the assignment to particular stability class are provided in the Methods section), and the prediction power of ML models is evaluated with the Area Under the Receiver Operating Characteristic Curve (AUC) [<xref ref-type="bibr" rid="CR36">36</xref>]. In the case of regression studies, we assess the prediction correctness with the use of the Root Mean Square Error (RMSE); however, during the hyperparameter optimization we optimize for the Mean Square Error (MSE). Analysis of the dataset division into the training and test set as the possible source of bias in the results is presented in the Appendix <xref rid="Sec16" ref-type="sec">1</xref>. The model evaluation is presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, where the performance on the test set of a single model selected during the hyperparameter optimization is shown.<fig id="Fig1"><label>Fig. 1</label><caption><p>Global prediction power of the ML algorithms in <bold>a</bold> classification and <bold>b</bold> regression studies. The Figure presents global prediction accuracy expressed as AUC for classification studies and RMSE for regression experiments for MACCSFP and KRFP used for compound representation for human and rat data</p></caption><graphic xlink:href="13321_2021_542_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par12">In general, the predictions of compound half-lifetimes are satisfactory with AUC values over 0.8 and RMSE below 0.4–0.45. These are slightly higher values than AUC reported by Schwaighofer et al. (0.690–0.835), although datasets used there were different and the model performances cannot be directly compared [<xref ref-type="bibr" rid="CR13">13</xref>]. All class assignments performed on human data are more effective for KRFP with the improvement over MACCSFP ranging from ~ 0.02 for SVM and trees up to 0.09 for Naïve Bayes. Classification efficiency performed on rat data is more consistent for different compound representations with AUC variation of around 1 percentage point. Interestingly, in this case MACCSFP provides slightly more effective predictions than KRFP. When particular algorithms are considered, trees are slightly preferred over SVM (~ 0.01 of AUC), whereas predictions provided by the Naïve Bayes classifiers are worse<bold>—</bold>for human data up to 0.15 of AUC for MACCSFP. Differences for particular ML algorithms and compound representations are much lower for the assignment to metabolic stability class using rat data<bold>—</bold>maximum AUC variation is equal to 0.02.</p>
      <p id="Par13">When regression experiments are considered, the KRFP provides better half-lifetime predictions than MACCSFP for 3 out of 4 experimental setups<bold>—</bold>only for studies on rat data with the use of trees, the RMSE is higher by 0.01 for KRFP than for MACCSFP. There is ~ 0.02–0.03 RMSE difference between trees and SVMs with the slight preference (lower RMSE) for SVM. SVM-based evaluations are of similar prediction power for human and rat data, whereas for trees, there is ~ 0.03 RMSE difference between the prediction errors obtained for human and rat data.</p>
    </sec>
    <sec id="Sec4">
      <title>Regression vs. classification</title>
      <p id="Par14">Besides performing ‘standard’ classification and regression experiments, we also pose an additional research question related to the efficiency of the regression models in comparison to their classification counterparts. To this end, we prepare the following analysis: the outcome of a regression model is used to assign the stability class of a compound, applying the same thresholds as for the classification experiments. Accuracy of such classification is presented in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of accuracy of standard classification and class assignment based on the regression output</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="2">Dataset</th><th align="left" colspan="2">Human</th><th align="left" colspan="2">Rat</th></tr><tr><th align="left">Model</th><th align="left">Representation</th><th align="left">Class</th><th align="left">Class. via regression</th><th align="left">Class</th><th align="left">Class. via regression</th></tr></thead><tbody><tr><td align="left" rowspan="2">SVM</td><td align="left">MACCS</td><td char="." align="char"><bold>0.745</bold></td><td char="." align="char">0.695</td><td char="." align="char">0.676</td><td char="." align="char"><bold>0.686</bold></td></tr><tr><td align="left">KRFP</td><td char="." align="char"><bold>0.759</bold></td><td char="." align="char">0.672</td><td char="." align="char">0.676</td><td char="." align="char"><bold>0.751</bold></td></tr><tr><td align="left" rowspan="2">Trees</td><td align="left">MACCS</td><td char="." align="char"><bold>0.737</bold></td><td char="." align="char">0.692</td><td char="." align="char">0.659</td><td char="." align="char"><bold>0.686</bold></td></tr><tr><td align="left">KRFP</td><td char="." align="char"><bold>0.734</bold></td><td char="." align="char">0.661</td><td char="." align="char">0.670</td><td char="." align="char"><bold>0.676</bold></td></tr></tbody></table><table-wrap-foot><p>Comparison of efficiency of classification experiments (standard and using class assignment based on the regression output) expressed as accuracy. Higher values in a particular comparison setup are depicted in bold</p></table-wrap-foot></table-wrap></p>
      <p id="Par15">Analysis of the classification experiments performed via regression-based predictions indicate that depending on the experimental setup, the predictive power of particular method varies to a relatively high extent. For the human dataset, the ‘standard classifiers’ always outperform class assignment based on the regression models, with accuracy difference ranging from ~ 0.045 (for trees/MACCSFP), up to ~ 0.09 (for SVM/KRFP). On the other hand, predicting exact half-lifetime value is more effective basis for class assignment when working on the rat dataset. The accuracy differences are much lower in this case (between ~ 0.01 and 0.02), with an exception of SVM/KRFP with difference of ~ 0.75. The accuracy values obtained in classification experiments for the human dataset are similar to accuracies reported by Lee et al. (75%) [<xref ref-type="bibr" rid="CR14">14</xref>] and Hu et al. (75–78%) [<xref ref-type="bibr" rid="CR15">15</xref>], though one must remember that the datasets used in these studies are different from ours and therefore a direct comparison is impossible.</p>
    </sec>
    <sec id="Sec5">
      <title>Global analysis of all ChEMBL data</title>
      <p id="Par16">We analyzed the predictions obtained on the ChEMBL data with the use of SHAP values in order to find these substructural features, which have the highest contribution to particular class assignment (Fig. <xref rid="Fig2" ref-type="fig">2</xref>) or prediction of exact half-lifetime value (Fig. <xref rid="Fig3" ref-type="fig">3</xref>); class 0—unstable compounds, class 1—compounds of middle stability, class 2—stable compounds.<fig id="Fig2"><label>Fig. 2</label><caption><p>The 20 features which contribute the most to the outcome of classification models for <bold>a</bold> Naïve Bayes, <bold>b</bold> SVM, <bold>c</bold> trees constructed on human dataset with the use of KRFP</p></caption><graphic xlink:href="13321_2021_542_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>The 20 features which contribute the most to the outcome of regression models for <bold>a</bold> SVM, <bold>b</bold> trees constructed on human dataset with the use of KRFP</p></caption><graphic xlink:href="13321_2021_542_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par17">Analysis of Fig. <xref rid="Fig2" ref-type="fig">2</xref> reveals that among the 20 features which are indicated by SHAP values as the most important overall, most features contribute rather to the assignment of a compound to the group of unstable molecules than to the stable ones<bold>—</bold>bars referring to class 0 (unstable compounds, blue) are significantly longer than green bars indicating influence on classifying compound as stable (for SVM and trees). However, we stress that these are averaged tendencies for the whole dataset and that they consider absolute values of SHAP. Observations for individual compounds might be significantly different and the set of highest contributing features can vary to high extent when shifting between particular compounds. Moreover, the high absolute values of SHAP in the case of the unstable class can be caused by two factors: (a) a particular feature makes the compound unstable and therefore it is assigned to this class, (b) a particular feature makes compound stable<bold>—</bold>in such case, the probability of compound assignment to the unstable class is significantly lower resulting in negative SHAP value of high magnitude.</p>
      <p id="Par18">For both Naïve Bayes classifier as well as trees it is visible that the primary amine group has the highest impact on the compound stability. As a matter of fact, the primary amine group is the only feature which is indicated by trees as contributing mostly to compound instability. However, according to the above-mentioned remark, it suggests that this feature is important for unstable class, but because of the nature of the analysis it is unclear whether it increases or decreases the possibility of particular class assignment.</p>
      <p id="Par19">Amines are also indicated as important for evaluation of metabolic stability for regression models, for both SVM and trees. Furthermore, regression models indicate a number of nitrogen- and oxygen-containing moieties as important for prediction of compound half-lifetime (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). However, the contribution of particular substructures should be analyzed separately for each compound in order to verify the exact nature of their contribution.</p>
      <p id="Par20">In order to examine to what extent the choice of the ML model influences the features indicated as important in particular experiment, Venn diagrams visualizing overlap between sets of features indicated by SHAP values are prepared and shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. In each case, 20 most important features are considered.<fig id="Fig4"><label>Fig. 4</label><caption><p>Overlap of important keys for <bold>a</bold> classification studies and <bold>b</bold> regression studies; c) legend for SMARTS visualization. Analysis of the overlap of the most important keys (in the number of 20) indicated by SHAP values for <bold>a</bold> classification studies and <bold>b</bold> regression studies; <bold>c</bold> legend for SMARTS visualization (generated with the use of SMARTS plus (<ext-link ext-link-type="uri" xlink:href="https://smarts.plus/">https://smarts.plus/</ext-link>); Venn diagrams generated by <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.psb.ugent.be/webtools/Venn/">http://bioinformatics.psb.ugent.be/webtools/Venn/</ext-link></p></caption><graphic xlink:href="13321_2021_542_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par21">When different classifiers are analyzed, there is only one common feature which is indicated by SHAP for all three models: the primary amine group. The lowest overlap between pairs of models occurs for Naïve Bayes and SVM (only one feature), whereas the highest (8 features) for Naïve Bayes and trees. For SVM and trees, the SHAP values indicate 4 common features as the highest contributors to the assignment to particular stability class. Nevertheless, we should remember that for Naïve Bayes the prediction accuracy was significantly lower than for SVM or trees; and therefore, the features indicated by this approach are also less reliable.</p>
      <p id="Par22">Finally, 4 features are common for SVM and trees in the case of regression experiments: the already mentioned primary amine group, alkoxy-substituted phenyl, secondary amine, and ester. This is in line with the intuition on the possible transformations that can occur for compounds containing these chemical moieties.</p>
    </sec>
    <sec id="Sec6">
      <title>Case studies</title>
      <p id="Par23">In order to verify the applicability of the developed methodology on particular case, we analyze the output of an example compound (Fig. <xref rid="Fig5" ref-type="fig">5</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><p>Analysis of the metabolic stability prediction for CHEMBL2207577 for human/KRFP/trees predictive model. Analysis of the metabolic stability prediction for CHEMBL2207577 with the use of SHAP values for human/KRFP/trees predictive model with indication of features influencing its assignment to the class of stable compounds; the SMARTS visualization was generated with the use of SMARTS plus (<ext-link ext-link-type="uri" xlink:href="https://smarts.plus/">https://smarts.plus/</ext-link>)</p></caption><graphic xlink:href="13321_2021_542_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par24">The highest contribution to the stability of CHEMBL2207577 is indicated to be the aromatic ring with the chlorine atom attached (feature 3545) and thiophen (feature 1915), the secondary amine (feature 677) lowers the probability of assignment to the stable class. All these features are present in the examined compounds and their metabolic stability indications are already known by chemists and they are in line with the results of the SHAP analysis.</p>
    </sec>
    <sec id="Sec7">
      <title>Web service</title>
      <p id="Par25">The results of all experiments can be analyzed in detail with the use of the web service, which can be found at <ext-link ext-link-type="uri" xlink:href="https://metstab-shap.matinf.uj.edu.pl/">https://metstab-shap.matinf.uj.edu.pl/</ext-link>. In addition, the user can submit their own compound and its metabolic stability will be evaluated with the use of the constructed models and the contribution of particular structural features will be evaluated with the use of the SHAP values (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Moreover, in order to enable manual comparisons, the most similar compound from the ChEMBL set (in terms of the Tanimoto coefficient calculated on Morgan fingerprints) is provided for each submitted compound (if the similarity is above the 0.3 threshold).<fig id="Fig6"><label>Fig. 6</label><caption><p>Screens of the web service <bold>a</bold> main page, <bold>b</bold> submission of custom compound, <bold>c</bold> stability predictions and SHAP-based analysis for a submitted compound. Screens of the web service for the compound analysis using SHAP values. <bold>a</bold> main page, <bold>b</bold> submission of custom compound for evaluation, <bold>c</bold> stability predictions for a submitted compound and SHAP-based analysis of its structural features</p></caption><graphic xlink:href="13321_2021_542_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par26">Obtaining such information enables optimization of metabolic stability as the substructures influencing this parameter are detected. Moreover, the comparison of several ML models and compound representations allows to provide a comprehensive overview of the problem.</p>
      <p id="Par27">An example analysis of the output of the presented web service and its application in the compound optimization in terms of its metabolic stability is presented in Fig. <xref rid="Fig7" ref-type="fig">7</xref>.<fig id="Fig7"><label>Fig. 7</label><caption><p>Custom compound analysis with the use of the prepared web service and output application to optimization of compound structure. Custom compound analysis with the use of the prepared web service, together with the application of its output to the optimization of compound structure in terms of its metabolic stability (human KRFP classification model was used); the SMARTS visualization generated with the use of SMARTS plus (<ext-link ext-link-type="uri" xlink:href="https://smarts.plus/">https://smarts.plus/</ext-link>)</p></caption><graphic xlink:href="13321_2021_542_Fig7_HTML" id="MO7"/></fig></p>
      <p id="Par28">The analysis of the submitted compound (evaluated in the classification studies as stable) indicates that the highest positive contribution to its metabolic stability has benzaldehyde moiety, and the feature which has a negative contribution to the assignment to the stable class is aliphatic sulphur. The most similar compound from the ChEMBL dataset is CHEMBL2315653, which differs from the submitted compound only by the presence of a fluorine atom. For this compound, the substructure indicated as the one with the highest positive contribution to compound stability is fluorophenyl. Therefore, the proposed structural modifications of the submitted compound involves the addition of the fluorine atom to the phenyl ring and the substitution of sulfone by ketone.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Conclusions</title>
    <p id="Par29">In the study, we focus on an important chemical property considered by medicinal chemists<bold>—</bold>metabolic stability. We construct predictive models of both classification and regression type, which can be used for computational assessment of this parameter with the use of the provided on-line tool. Moreover, we use an explainability method called SHAP to develop a methodology for indication of structural contributors, which have the strongest influence on the particular model output. Finally, we prepared a web service, where user can analyze in detail predictions for CHEMBL data, or submit own compounds for metabolic stability evaluation. As an output, not only the result of metabolic stability assessment is returned, but also the SHAP-based analysis of the structural contributions to the provided outcome is given. In addition, a summary of the metabolic stability (together with SHAP analysis) of the most similar compound from the ChEMBL dataset is provided. All this information enables the user to optimize the submitted compound in such a way that its metabolic stability is improved. The web service is available at <ext-link ext-link-type="uri" xlink:href="https://metstab-shap.matinf.uj.edu.pl/">https://metstab-shap.matinf.uj.edu.pl/</ext-link>.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <sec id="Sec10">
      <title>Data</title>
      <p id="Par30">We use CHEMBL-derived datasets describing human and rat metabolic stability (database version used: 23). We only use these measurements which are given in hours and refer to half-lifetime (T1/2), and which are described as examined on’Liver’,’Liver microsome’ or’Liver microsomes’. The half-lifetime values are log-scaled due to long tail distribution of the metabolic stability measurements. In case of multiple measurements for a single compound, we use their median value. In total, the human dataset comprises 3578 measurements for 3498 compounds and the rat dataset 1819 measurements for 1795 compounds. The resulting datasets are randomly split into training and test data, with the test set being 10% of the whole data set. The detailed number of measurements and compounds in each subset is listed in Table <xref rid="Tab2" ref-type="table">2</xref>. Finally, the training data is split into five cross-validation folds which are later used to choose the optimal hyperparameters.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Number of measurements and compounds in the ChEMBL datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left">Subset</th><th align="left">Number of measurements</th><th align="left">Number of compounds</th></tr></thead><tbody><tr><td align="left" rowspan="3">Human</td><td align="left">Train</td><td align="left">3221</td><td align="left">3149</td></tr><tr><td align="left">Test</td><td align="left">357</td><td align="left">349</td></tr><tr><td align="left">Total</td><td align="left">3578</td><td align="left">3498</td></tr><tr><td align="left" rowspan="3">Rat</td><td align="left">Train</td><td align="left">1634</td><td align="left">1616</td></tr><tr><td align="left">Test</td><td align="left">185</td><td align="left">179</td></tr><tr><td align="left">Total</td><td align="left">1819</td><td align="left">1795</td></tr></tbody></table><table-wrap-foot><p>The table presents the number of measurements and compounds present in particular datasets used in the study<bold>—</bold>human and rat data, divided into training and test sets</p></table-wrap-foot></table-wrap></p>
      <p id="Par31">In our experiments, we use two compound representations: MACCSFP [<xref ref-type="bibr" rid="CR26">26</xref>] calculated with the RDKit package [<xref ref-type="bibr" rid="CR37">37</xref>] and Klekota &amp; Roth FingerPrint (KRFP) [<xref ref-type="bibr" rid="CR27">27</xref>] calculated using PaDELPy (available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ECRL/PaDELPy">https://github.com/ECRL/PaDELPy</ext-link>)—a python wrapper for PaDEL descriptors [<xref ref-type="bibr" rid="CR38">38</xref>]. These compound representations are based on the widely known sets of structural keys—MACCS, developed and optimized by MDL for similarity-based comparisons, and KRFP, prepared upon examination of the 24 cell-based phenotypic assays to identify substructures which are preferred for biological activity and which enable differentiation between active and inactive compounds. Complete list of keys is available at <ext-link ext-link-type="uri" xlink:href="https://metstab-shap.matinf.uj.edu.pl/features-description">https://metstab-shap.matinf.uj.edu.pl/features-description</ext-link>. Data preprocessing is model-specific and is chosen during the hyperparameter search.</p>
      <p id="Par32">For compound similarity evaluation, we use Morgan fingerprint, calculated with the RDKit package with 1024-bit length and other settings set to default.</p>
    </sec>
    <sec id="Sec11">
      <title>Tasks</title>
      <p id="Par33">We perform both direct metabolic stability prediction (expressed as half-lifetime) with regression models and classification of molecules into three stability classes (unstable, medium, and stable). The true class for each molecule is determined based on its half-lifetime expressed in hours. We follow the cut-offs from Podlewska et al. [<xref ref-type="bibr" rid="CR39">39</xref>]:<list list-type="bullet"><list-item><p id="Par34"> ≤ 0.6<bold>—</bold>low stability,</p></list-item><list-item><p id="Par35">(0.6 − 2.32 &gt; <bold>—</bold>medium stability,</p></list-item><list-item><p id="Par36"> &gt; 2.32<bold>—</bold>high stability.</p></list-item></list></p>
    </sec>
    <sec id="Sec12">
      <title>Models</title>
      <p id="Par37">In our experiments, we examine Naïve Bayes classifiers, Support Vector Machines (SVMs), and several models based on trees. We use the implementations provided in the scikit-learn package [<xref ref-type="bibr" rid="CR40">40</xref>]. The optimal hyperparameters for these models and model-specific data preprocessing is determined using five-fold cross-validation and a genetic algorithm implemented in TPOT [<xref ref-type="bibr" rid="CR41">41</xref>]. The hyperparameter search is run on 5 cores in parallel and we allow it to last for 24 h. To determine the optimal set of hyperparameters, the regression models are evaluated using (negative) mean square error, and the classifiers using one-versus-one area under ROC curve (AUC), which is the average AUC of all possible pairwise combinations of classes. We use the scikit-learn implementation of ROC_AUC score with parameter multiclass set to ‘ovo’.</p>
      <p id="Par38">The hyperparameters accepted by the models and their values considered during hyperparameter optimization are listed in Tables <xref rid="Tab3" ref-type="table">3</xref>, <xref rid="Tab4" ref-type="table">4</xref>, <xref rid="Tab5" ref-type="table">5</xref>, <xref rid="Tab6" ref-type="table">6</xref>, <xref rid="Tab7" ref-type="table">7</xref>, <xref rid="Tab8" ref-type="table">8</xref>, <xref rid="Tab9" ref-type="table">9</xref>. After the optimal hyperparameter configuration is determined, the model is retrained on the whole training set and evaluated on the test set.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Hyperparameters accepted by different Naïve Bayes classifiers</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">alpha</th><th align="left">Fit_prior</th><th align="left">norm</th><th align="left">var_smoothing</th></tr></thead><tbody><tr><td align="left">BernoulliNB</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left"/></tr><tr><td align="left">ComplementNB</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/></tr><tr><td align="left">GaussianNB</td><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td></tr><tr><td align="left">MultinomialNB</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left"/></tr></tbody></table><table-wrap-foot><p>The table lists the hyperparameters which are accepted by different Naïve Bayes classifiers</p></table-wrap-foot></table-wrap><table-wrap id="Tab4"><label>Table 4</label><caption><p>The values considered for hyperparameters for Naïve Bayes classifiers</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Hyperparameter</th><th align="left">Considered values</th></tr></thead><tbody><tr><td align="left">Alpha</td><td align="left">0.001, 0.01, 0.1, 1, 10, 100</td></tr><tr><td align="left">var_smoothing</td><td align="left">1e−11, 1e−10, 1e−9, 1e−8, 1e−7, 1e−6, 1e−5, 1e−4</td></tr><tr><td align="left">fit_prior</td><td align="left">True, False</td></tr><tr><td align="left">Norm</td><td align="left">True, False</td></tr></tbody></table><table-wrap-foot><p>The table lists the values of hyperparameters which were considered during optimization process of different Naïve Bayes classifiers</p></table-wrap-foot></table-wrap><table-wrap id="Tab5"><label>Table 5</label><caption><p>Hyperparameters accepted by different tree models</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">n_estimators</th><th align="left">max_depth</th><th align="left">max_samples</th><th align="left">splitter</th><th align="left">max_features</th><th align="left">bootstrap</th></tr></thead><tbody><tr><td align="left">ExtraTrees</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">DecisionTree</td><td align="left"/><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left"/></tr><tr><td align="left">RandomForest</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left">✓</td></tr></tbody></table><table-wrap-foot><p>The table lists the hyperparameters which are accepted by different tree classifiers</p></table-wrap-foot></table-wrap><table-wrap id="Tab6"><label>Table 6</label><caption><p>The values considered for hyperparameters for different tree models</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Hyperparameter</th><th align="left">Considered values</th></tr></thead><tbody><tr><td align="left">n_estimators</td><td align="left">10, 50, 100, 500, 1000</td></tr><tr><td align="left">max_depth</td><td align="left">1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 20, 25, None</td></tr><tr><td align="left">max_samples</td><td align="left">0.5, 0.7, 0.9, None</td></tr><tr><td align="left">splitter</td><td align="left">Best, random</td></tr><tr><td align="left">max_features</td><td align="left">np.arrange(0.05, 1.01, 0.05)</td></tr><tr><td align="left">bootstrap</td><td align="left">True, False</td></tr></tbody></table><table-wrap-foot><p>The table lists the values of hyperparameters which were considered during optimization process of different tree models</p></table-wrap-foot></table-wrap><table-wrap id="Tab7"><label>Table 7</label><caption><p>Hyperparameters accepted by SVMs with different kernels for classification experiments</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">kernel</th><th align="left">c</th><th align="left">loss</th><th align="left">dual</th><th align="left">penalty</th><th align="left">gamma</th><th align="left">coeff0</th><th align="left">degree</th><th align="left">tol</th><th align="left">epsilon</th><th align="left">Max_oter</th><th align="left">probability</th></tr></thead><tbody><tr><td align="left">linear</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">rbf</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left"/><td align="left"/><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left">poly</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left">sigmoid</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td></tr></tbody></table><table-wrap-foot><p>The table lists the hyperparameters which are accepted by different SVMs in classification experiments</p></table-wrap-foot></table-wrap><table-wrap id="Tab8"><label>Table 8</label><caption><p>Hyperparameters accepted by SVMs with different kernels for regression experiments</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">kernel</th><th align="left">c</th><th align="left">loss</th><th align="left">dual</th><th align="left">penalty</th><th align="left">gamma</th><th align="left">Coeff0</th><th align="left">degree</th><th align="left">tol</th><th align="left">epsilon</th><th align="left">Max_oter</th><th align="left">probability</th></tr></thead><tbody><tr><td align="left">linear</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left"/></tr><tr><td align="left">rbf</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left"/><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/></tr><tr><td align="left">poly</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/></tr><tr><td align="left">sigmoid</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/></tr></tbody></table><table-wrap-foot><p>The table lists the hyperparameters which are by different SVMs in regression experiments</p></table-wrap-foot></table-wrap><table-wrap id="Tab9"><label>Table 9</label><caption><p>The values considered for hyperparameters for different SVM models</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">hyperparameter</th><th align="left">Considered values</th></tr></thead><tbody><tr><td align="left">C</td><td align="left">0.0001, 0.001, 0.01, 0.1, 0.5, 1.0, 5.0, 10.0, 15.0, 20.0, 25.0</td></tr><tr><td align="left">loss (SVC)</td><td align="left">hinge, squared_hinge</td></tr><tr><td align="left">loss (SVR)</td><td align="left">epsilon_insensitive, squared_epsilon_insensitive</td></tr><tr><td align="left">dual</td><td align="left">True, False</td></tr><tr><td align="left">penalty</td><td align="left">11, 12</td></tr><tr><td align="left">gamma</td><td align="left">[auto, scale] + [10 ** i for i in range (− 6, 0)]</td></tr><tr><td align="left">coef0</td><td align="left">[10 ** i for i in range (− 6, 0)] + [0.0] + [10 ** i for i in range (− 1, − 7, − 1)]</td></tr><tr><td align="left">degree</td><td align="left">1…9</td></tr><tr><td align="left">tol</td><td align="left">1e−05, 0.0001, 0.001, 0.01, 0.1</td></tr><tr><td align="left">epsilon</td><td align="left">0.0001, 0.001, 0.01, 0.1, 1.0</td></tr><tr><td align="left">max_iter</td><td align="left">2000</td></tr><tr><td align="left">probability</td><td align="left">True</td></tr></tbody></table><table-wrap-foot><p>The table lists the values of hyperparameters which were considered during optimization process of different SVM models during classification and regression</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec13">
      <title>Explainability</title>
      <p id="Par39">We assume that if a model is capable of predicting metabolic stability well, then the features it uses might be relevant in determining the true metabolic stability. In other words, we analyse machine learning models to shed light on the underlying factors that influence metabolic stability. To this end, we use the SHapley Additive exPlanations (SHAP) [<xref ref-type="bibr" rid="CR33">33</xref>]. SHAP allows to attribute a single value (the so-called SHAP value) for each feature of the input for each prediction. It can be interpreted as a feature importance and reflects the feature’s influence on the prediction. SHAP values are calculated for each prediction separately (as a result, they explain a single prediction, not the entire model) and sum to the difference between the model’s average prediction and its actual prediction. In case of multiple outputs, as is the case with classifiers, each output is explained individually. High positive or negative SHAP values suggest that a feature is important, with positive values indicating that the feature increases the model’s output and negative values indicating the decrease in the model’s output. The values close to zero indicate features of low importance.</p>
      <p id="Par40">The SHAP method originates from the Shapley values from game theory. Its formulation guarantees three important properties to be satisfied: local accuracy, missingness and consistency. A SHAP value for a given feature is calculated by comparing output of the model when the information about the feature is present and when it is hidden. The exact formula requires collecting model’s predictions for all possible subsets of features that do and do not include the feature of interest. Each such term if then weighted by its own coefficient. The SHAP implementation by Lundberg et al. [<xref ref-type="bibr" rid="CR33">33</xref>], which is used in this work, allows an efficient computation of approximate SHAP values.</p>
      <p id="Par41">In our case, the features correspond to presence or absence of chemical substructures encoded by MACCSFP or KRFP. In all our experiments, we use Kernel Explainer with background data of 25 samples and parameter link set to identity.</p>
      <p id="Par42">The SHAP values can be visualised in multiple ways. In the case of single predictions, it can be useful to exploit the fact that SHAP values reflect how single features influence the change of the model’s prediction from the mean to the actual prediction. To this end, 20 features with the highest mean absolute SHAP value are plotted side by side starting from the actual prediction and the most important feature at the top. The SHAP values of the remaining features are summed and plotted collectively at the bottom of the plot and ending at the model’s average prediction. In case of classification, this process is repeated for each of the model outputs resulting in three separate plots<bold>—</bold>one for each of the classes.</p>
      <p id="Par43">The SHAP values for multiple predictions can be averaged to discover general tendencies of the model. Initially, we filter out any predictions which are incorrect, because the features used to provide an incorrect answer are of little relevance. In case of classification, the class returned by the model must be equal to the true class for the prediction to be correct. In case of regression, we allow an error smaller or equal to 20% of the true value expressed in hours. Moreover, if both the true and the predicted values are greater than or equal to 7 h and 30 min, we also accept the prediction to be correct. In other words, we use the following condition: <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{y}$$\end{document}</tex-math><mml:math id="M2"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13321_2021_542_Article_IEq1.gif"/></alternatives></inline-formula> is correct if and only if (0.8y ≤ <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{y}$$\end{document}</tex-math><mml:math id="M4"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13321_2021_542_Article_IEq2.gif"/></alternatives></inline-formula>  ≤ 1.2y) or (y ≥ 7.5 and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{y}$$\end{document}</tex-math><mml:math id="M6"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13321_2021_542_Article_IEq3.gif"/></alternatives></inline-formula> ≥ 7.5), where y is the true half-lifetime expressed in hours, and <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{y}$$\end{document}</tex-math><mml:math id="M8"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13321_2021_542_Article_IEq4.gif"/></alternatives></inline-formula> is the predicted value converted to hours. After finding the set of correct predictions, we average their absolute SHAP values to establish which features are on average most important. In case of regression, each row in the figures corresponds to a single feature. We plot 20 most important features with the most important one at the top of the figure. Each dot represents a single correct prediction, its colour the value of the corresponding feature (blue<bold>—</bold>absence, red<bold>—</bold>presence), and the position on the x-axis is the SHAP value itself. In case of classification, we group the predictions according to their class and calculate their mean absolute SHAP values for each class separately. The magnitude of the resulting value is indicated in a bar plot. Again, the most important feature is at the top of each figure. This process is repeated for each output of the model<bold>—</bold>as a result, for each classifier three bar plots are generated.</p>
    </sec>
    <sec id="Sec14">
      <title>Hyperparameter details</title>
      <p id="Par44">The hyperparameter details are gathered in Tables <xref rid="Tab3" ref-type="table">3</xref>, <xref rid="Tab4" ref-type="table">4</xref>, <xref rid="Tab5" ref-type="table">5</xref>, <xref rid="Tab6" ref-type="table">6</xref>, <xref rid="Tab7" ref-type="table">7</xref>, <xref rid="Tab8" ref-type="table">8</xref>, <xref rid="Tab9" ref-type="table">9</xref>: Table <xref rid="Tab3" ref-type="table">3</xref> and Table <xref rid="Tab4" ref-type="table">4</xref> refer to Naïve Bayes (NB), Table <xref rid="Tab5" ref-type="table">5</xref> and Table <xref rid="Tab6" ref-type="table">6</xref> to trees and Table <xref rid="Tab7" ref-type="table">7</xref>, Table <xref rid="Tab8" ref-type="table">8</xref>, and Table <xref rid="Tab9" ref-type="table">9</xref> to SVM.</p>
    </sec>
    <sec id="Sec15">
      <title>Description of the GitHub repository</title>
      <p id="Par45">All scripts are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gmum/metstab-shap/">https://github.com/gmum/metstab-shap/</ext-link>. In folder ‘models’ there are scripts which can be used to train the models presented in our work and in folder ‘metstab_shap’, the implementation to reproduce the full results, which includes hyperparameter tuning and calculation of SHAP values. We encourage the use of the experiment tracking platform Neptune (<ext-link ext-link-type="uri" xlink:href="https://neptune.ai/">https://neptune.ai/</ext-link>) for logging the results, however, it can be easily disabled. Both datasets, the data splits and all configuration files are present in the repository. The code can be run with the use of Conda environment, Docker container or Singularity container. The detailed instructions to run the code are present in the repository.</p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec16">
        <title>Appendix 1</title>
        <sec id="Sec17">
          <title>Training/test set analysis</title>
          <p id="Par47">In order to ensure that the predictions are not biased by the dataset division into training and test set, we prepared visualizations of chemical spaces of both training and test set (Fig. <xref rid="Fig8" ref-type="fig">8</xref>), as well as an analysis of the similarity coefficients which were calculated as Tanimoto similarity determined on Morgan fingerprints with 1024 bits (Fig. <xref rid="Fig9" ref-type="fig">9</xref>). In the latter case, we report two types of analysis<bold>—</bold>similarity of each test set representative to the closest neighbour from the training set, as well as similarity of each element of the test set to each element of the training set.<fig id="Fig8"><label>Fig. 8</label><caption><p>Chemical spaces of training (blue) and test set (red) for <bold>a</bold> human and <bold>b</bold> rat data. The figure presents visualization of chemical spaces of training and test set to indicate the possible bias of the results connected with the improper dataset division into the training and test set part. The analysis was generated using ECFP4 in the form of the principal component analysis with the webMolCS tool </p><p>available at <ext-link ext-link-type="uri" xlink:href="http://www.gdbtools.unibe.ch:8080/webMolCS/">http://www.gdbtools.unibe.ch:8080/webMolCS/</ext-link></p></caption><graphic position="anchor" xlink:href="13321_2021_542_Fig8_HTML" id="MO8"/></fig><fig id="Fig9"><label>Fig. 9</label><caption><p>Tanimoto coefficients between training and test set for <bold>a</bold>, <bold>b</bold> the closest neighbour, <bold>c</bold>, <bold>d</bold> all training and test set representatives. The figure presents histograms of Tanimoto coefficients calculated between each representative of the training set and each element from the test set. <bold>a</bold>, <bold>b</bold> report only the highest values calculated for particular element from the test set and <bold>c</bold>, <bold>d</bold> present outcome of all pairwise comparisons</p></caption><graphic position="anchor" xlink:href="13321_2021_542_Fig9_HTML" id="MO9"/></fig></p>
          <p id="Par48">The PCA analysis presented in Fig. <xref rid="Fig8" ref-type="fig">8</xref> clearly shows that the final train and test sets uniformly cover the chemical space and that the risk of bias related to the structural properties of compounds presented in either train or test set is minimized. Therefore, if a particular substructure is indicated as important by SHAP, it is caused by its true influence on metabolic stability, rather than overrepresentation in the training set.</p>
          <p id="Par49">The analysis of Tanimoto coefficients between training and test sets (Fig. <xref rid="Fig9" ref-type="fig">9</xref>) indicates that in each case the majority of compounds from the test set has the Tanimoto coefficient to the nearest neighbour from the training set in range of 0.6–0.7, which points to not very high structural similarity. The distribution of similarity coefficient is similar for human and rat data, and in each case there is only a small fraction of compounds with Tanimoto coefficient above 0.9. Next, the analysis of the all pairwise Tanimoto coefficients indicates that the overall similarity between training and test sets is low, with over 95% of Tanimoto values below 0.2.</p>
        </sec>
      </sec>
      <sec id="Sec18">
        <title>Appendix 2</title>
        <sec id="Sec19">
          <title>Prediction correctness analysis</title>
          <p id="Par50">In addition, the overlap of correctly predicted compounds for various models is examined to verify, whether shifting towards different compound representation or ML model can improve evaluation of metabolic stability (Fig. <xref rid="Fig10" ref-type="fig">10</xref>). The prediction correctness is examined using both the training and the test set. We use the whole dataset, as we would like to examine the reliability of the analysis carried out for all ChEMBL data in order to derive patterns of structural factors influencing metabolic stability.<fig id="Fig10"><label>Fig. 10</label><caption><p>Venn diagrams for experiments on human data <italic>presenting the number of correctly evaluated compounds in different setups (ML algorithms/compound representations)</italic>: <bold>a</bold> classification on KRFP, <bold>b</bold> regression on KRFP, <bold>c</bold> classification and regression on KRFP, <bold>d</bold> classification on MACCSFP, <bold>e</bold> regression on MACCSFP, <bold>f</bold> classification and regression on MACCSFP, <bold>g</bold> classification with Naïve Bayes, <bold>h</bold> classification with SVM, <bold>i</bold> classification with trees, <bold>j</bold> regression with SVM, <bold>k</bold> regression with trees. The figure presents Venn diagrams showing the overlap between correctly predicted compounds in different experiments (different ML algorithms/compound representations) carried out on human data. Venn diagrams were generated with <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.psb.ugent.be/webtools/Venn/">http://bioinformatics.psb.ugent.be/webtools/Venn/</ext-link></p></caption><graphic position="anchor" xlink:href="13321_2021_542_Fig10_HTML" id="MO10"/></fig></p>
          <p id="Par51">In case of regression, we assume that the prediction is correct when it does not differ from the actual T1/2 value by more than 20% or when both the true and predicted values are above 7 h and 30 min.</p>
          <p id="Par52">The first observation coming from Fig. <xref rid="Fig3" ref-type="fig">10</xref> is that the overlap of correctly classified compounds is much higher for classification than for regression studies. The number of compounds which are correctly classified by all three models is slightly higher for KRFP than for MACCSFP, although the difference is not significant (less than 100 compounds, which constitutes around 3% of the whole dataset).</p>
          <p id="Par53">On the other hand, the rate of correctly predicted compounds overlap is much lower for regression studies and MACCSFP seems to be more effective representation when the consensus for different predictive models is taken into account. Moreover, the total number of correctly evaluated compounds is also much lower for regression studies in comparison to standard classification (this is also reflected by the lower efficiency of classification via regression for the human dataset).</p>
          <p id="Par54">When both regression and classification experiments are considered, only 20–25% of compounds are correctly predicted by all classification and regression models. The exact percentage of compounds depends on the compound representation and is higher for MACCSFP. There is no direct relationship between the prediction correctness and the compound structure representation or its half-lifetime value. Considering the model pairs, the highest overlap is provided by Naïve Bayes and trees in ‘standard’ classification mode.</p>
          <p id="Par55">Examination of the overlap between compound representations for various predictive models show that the highest overlap occurs for trees<bold>—</bold>over 85% of the total dataset is correctly classified by both models. On the other hand, the lowest overlap for different compound representations within the classification models occurs for Naïve Bayes; however, it is also the model for which there is the lowest total number of correctly predicted compounds (less than 75% of the whole dataset). When regression models are compared, the fraction of correctly predicted compounds is higher for SVM, although the number of compounds correctly predicted for both compound representations is similar for both SVM and trees (~ 1100, a slightly higher number for SVM).</p>
          <p id="Par56">Another type of prediction correctness analysis was performed for regression experiments with the use of the parity plots for ‘classification via regression’ experiments (Fig. <xref rid="Fig11" ref-type="fig">11</xref>).<fig id="Fig11"><label>Fig. 11</label><caption><p>Parity plots showing the misclassification distribution in classification-via-regression experiments with reference to the half-lifetime values for <bold>a</bold> KRFP/SVM, <bold>b</bold> KRFP/trees, <bold>c</bold> MACCSFP/SVM, <bold>d</bold> MACCSFP/trees, <bold>e</bold> KRFP/SVM, <bold>f</bold> KRFP/trees, <bold>g</bold> MACCSFP/SVM, <bold>h</bold> MACCSFP/trees. The figure presents differences between true and predicted metabolic stability classes in the class assignment task performed based on the exact predicted value of half-lifetime in regression studies</p></caption><graphic position="anchor" xlink:href="13321_2021_542_Fig11_HTML" id="MO11"/></fig></p>
          <p id="Par57">Figure <xref rid="Fig11" ref-type="fig">11</xref> indicates that there is no apparent correlation between the misclassification distribution and the half-lifetime values as the models misclassify molecules of both low and high stability.</p>
          <p id="Par58">Analogous analysis was performed for the classifiers (Fig. <xref rid="Fig12" ref-type="fig">12</xref>). One general observation is that in case of incorrect predictions the models are more likely to assign the compound to the neighbouring class, e.g. there is higher probability of the assignment of stable compounds (yellow dots) to the class of middle stability (blue) than to the unstable class (red). For compounds of middle stability, there is no direct tendency of class assignment when the prediction is incorrect<bold>—</bold>there is similar probability of predicting such compounds as stable and unstable ones. In the case of classifiers, the order of classes is irrelevant; therefore, it is highly probable that the models during training gained the ability to recognize reliable features and use them to correctly sort compounds according to their stability.<fig id="Fig12"><label>Fig. 12</label><caption><p>Analysis of the assignment correctness for models trained on human data: <bold>a</bold> NaïveBayes, <bold>b</bold> SVM, <bold>c</bold> trees, <bold>d</bold> NaïveBayes, <bold>e</bold> SVM, <bold>f</bold> trees. Class 0<bold>—</bold>unstable compounds, class 1<bold>—</bold>compounds of middle stability, class 2<bold>—</bold>stable compounds. The figure presents the distribution of probabilities of compound assignment to particular stability class, depending on the true class value for test sets derived from the human dataset. Each dot represent a single molecule, the position on x-axis indicates the correct class, the position on y-axis the probability of this class returned by the model, and the colour the class assignment based on model’s prediction</p></caption><graphic position="anchor" xlink:href="13321_2021_542_Fig12_HTML" id="MO12"/></fig></p>
          <p id="Par59">Evaluation of the predictive power of the obtained models allows us to state, that they are capable of assessing metabolic stability with high accuracy. This is important because we assume that if a model is capable of making correct predictions about the metabolic stability of a compound, then the structural features, which are used to produce such predictions, might be relevant for provision of desired metabolic stability. Therefore, the developed ML models underwent deeper examination to shed light on the structural factors that influence metabolic stability.</p>
        </sec>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The study was supported by the National Science Centre, Poland within the SONATINA grant 2018/28/C/NZ7/00145. This research was supported in part by PL-Grid Infrastructure.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>All authors designed the experiments. AW performed the experiments and analyzed the data. AW and RJ prepared the web service. SP managed the project and prepared the manuscript. All authors draw conclusions, read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The study was supported by the National Science Centre, Poland within the SONATINA Grant 2018/28/C/NZ7/00145.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Datasets and scripts enabling reproduction of all the results obtained in the study are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gmum/metstab-shap">https://github.com/gmum/metstab-shap</ext-link>. The online tool enabling the use of the developed methodology is available at <ext-link ext-link-type="uri" xlink:href="https://metstab-shap.matinf.uj.edu.pl/">https://metstab-shap.matinf.uj.edu.pl/</ext-link>.</p>
  </notes>
  <notes>
    <title>Declaration</title>
    <notes notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par46">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mohs</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Greig</surname>
            <given-names>NH</given-names>
          </name>
        </person-group>
        <article-title>Drug discovery and development: Role of basic biological research</article-title>
        <source>Alzheimers Dement (N Y).</source>
        <year>2017</year>
        <volume>3</volume>
        <fpage>651</fpage>
        <lpage>657</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trci.2017.10.005</pub-id>
        <pub-id pub-id-type="pmid">29255791</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shankar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Frapaise</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>LEAN drug development in R&amp;D</article-title>
        <source>Drug Discov Dev</source>
        <year>2006</year>
        <volume>9</volume>
        <fpage>57</fpage>
        <lpage>60</lpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hughes</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Rees</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Kalindjian</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Philpott</surname>
            <given-names>KL</given-names>
          </name>
        </person-group>
        <article-title>Principles of early drug discovery</article-title>
        <source>Br J Pharmacol</source>
        <year>2011</year>
        <volume>162</volume>
        <fpage>1239</fpage>
        <lpage>1249</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1476-5381.2010.01127.x</pub-id>
        <pub-id pub-id-type="pmid">21091654</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brodniewicz</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Grynkiewicz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Preclinical drug development</article-title>
        <source>Acta Pol Pharm</source>
        <year>2010</year>
        <volume>67</volume>
        <fpage>578</fpage>
        <lpage>585</lpage>
        <pub-id pub-id-type="pmid">21229871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ratti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Trist</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The continuing evolution of the drug discovery process in the pharmaceutical industry</article-title>
        <source>Farmaco</source>
        <year>2001</year>
        <volume>56</volume>
        <fpage>13</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1016/S0014-827X(01)01019-9</pub-id>
        <pub-id pub-id-type="pmid">11347954</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Drug</surname>
            <given-names>RZCNS</given-names>
          </name>
        </person-group>
        <article-title>Design: balancing physicochemical properties for optimal brain exposure</article-title>
        <source>J Med Chem</source>
        <year>2015</year>
        <volume>58</volume>
        <fpage>2584</fpage>
        <lpage>2608</lpage>
        <pub-id pub-id-type="doi">10.1021/jm501535r</pub-id>
        <pub-id pub-id-type="pmid">25494650</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Masimirembwa</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Bredberg</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>TB</given-names>
          </name>
        </person-group>
        <article-title>Metabolic stability for drug discovery and development: pharmacokinetic and biochemical challenges</article-title>
        <source>Clin Pharmacokinet</source>
        <year>2003</year>
        <volume>42</volume>
        <fpage>515</fpage>
        <lpage>528</lpage>
        <pub-id pub-id-type="doi">10.2165/00003088-200342060-00002</pub-id>
        <pub-id pub-id-type="pmid">12793837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>TN</given-names>
          </name>
        </person-group>
        <article-title>Optimization of metabolic stability as a goal of modern drug design</article-title>
        <source>Med Res Rev</source>
        <year>2001</year>
        <volume>21</volume>
        <fpage>412</fpage>
        <lpage>449</lpage>
        <pub-id pub-id-type="doi">10.1002/med.1017</pub-id>
        <pub-id pub-id-type="pmid">11579441</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>AY</given-names>
          </name>
        </person-group>
        <article-title>Role of pharmacokinetics and metabolism in drug discovery and development</article-title>
        <source>Pharmacol Rev</source>
        <year>1997</year>
        <volume>49</volume>
        <fpage>403</fpage>
        <lpage>449</lpage>
        <pub-id pub-id-type="pmid">9443165</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pochapsky</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Kazanis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dang</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Conformational plasticity and structure/function relationships in cytochromes P450</article-title>
        <source>Antioxid Redox Signal</source>
        <year>2010</year>
        <volume>13</volume>
        <fpage>1273</fpage>
        <lpage>1296</lpage>
        <pub-id pub-id-type="doi">10.1089/ars.2010.3109</pub-id>
        <pub-id pub-id-type="pmid">20446763</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sirim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Widmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pleiss</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Prediction and analysis of the modular structure of cytochrome P450 monooxygenases</article-title>
        <source>BMC Struct Biol</source>
        <year>2010</year>
        <volume>10</volume>
        <fpage>34</fpage>
        <pub-id pub-id-type="doi">10.1186/1472-6807-10-34</pub-id>
        <pub-id pub-id-type="pmid">20950472</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steuer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Junker</surname>
            <given-names>BH</given-names>
          </name>
        </person-group>
        <article-title>Computational models of metabolism: stability and regulation in metabolic networks</article-title>
        <source>Adv Chem Phys</source>
        <year>2008</year>
        <volume>142</volume>
        <fpage>105</fpage>
        <lpage>251</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwaighofer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schroeter</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mika</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>ter Laak</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lienau</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Reichel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Heinrich</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>K-R</given-names>
          </name>
        </person-group>
        <article-title>A probabilistic approach to classifying metabolic stability</article-title>
        <source>J Chem Inf Model</source>
        <year>2008</year>
        <volume>48</volume>
        <fpage>785</fpage>
        <lpage>796</lpage>
        <pub-id pub-id-type="doi">10.1021/ci700142c</pub-id>
        <pub-id pub-id-type="pmid">18327900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Cucurull-Sanchez</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>YJ</given-names>
          </name>
        </person-group>
        <article-title>Development of in silico models for human liver microsomal stability</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2007</year>
        <volume>21</volume>
        <fpage>665</fpage>
        <lpage>673</lpage>
        <pub-id pub-id-type="doi">10.1007/s10822-007-9124-0</pub-id>
        <pub-id pub-id-type="pmid">17599241</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Unwalla</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Denny</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Bikker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Di</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Humblet</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Development of QSAR models for microsomal stability: Identification of good and bad structural features for rat, human and mouse microsomal stability</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2010</year>
        <volume>24</volume>
        <fpage>23</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1007/s10822-009-9309-9</pub-id>
        <pub-id pub-id-type="pmid">19937264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jensen</surname>
            <given-names>BF</given-names>
          </name>
          <name>
            <surname>Sørensen</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Kissmeyer</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Björkling</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sonne</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Engelsen</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Nørgaard</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Prediction of in vitro metabolic stability of calcitriol analogs by QSAR</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2003</year>
        <volume>17</volume>
        <fpage>849</fpage>
        <lpage>859</lpage>
        <pub-id pub-id-type="doi">10.1023/B:JCAM.0000021861.31978.da</pub-id>
        <pub-id pub-id-type="pmid">15124933</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stratton</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Perryman</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Vilchèze</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Russo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S-G</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Singleton</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ekins</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Connell</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jacobs</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Freundlich</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Addressing the metabolic stability of antituberculars through machine learning</article-title>
        <source>ACS Med Chem Lett</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>1099</fpage>
        <lpage>1104</lpage>
        <pub-id pub-id-type="doi">10.1021/acsmedchemlett.7b00299</pub-id>
        <pub-id pub-id-type="pmid">29057058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ulenberg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Belka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Król</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Herold</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hewelt-Belka</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kot-Wasik</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Baczek</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Prediction of overall in vitro microsomal stability of drug candidates based on molecular modeling and support vector machines. Case study of novel arylpiperazines derivatives</article-title>
        <source>PLoS ONE</source>
        <year>2015</year>
        <volume>10</volume>
        <fpage>e0122772</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0122772</pub-id>
        <pub-id pub-id-type="pmid">25826401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Golbraikh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gombar</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Tropsha</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Development and validation of k-nearest-neighbor QSPR models of metabolic stability of drug candidates</article-title>
        <source>J Med Chem</source>
        <year>2003</year>
        <volume>46</volume>
        <fpage>3013</fpage>
        <lpage>3020</lpage>
        <pub-id pub-id-type="doi">10.1021/jm020491t</pub-id>
        <pub-id pub-id-type="pmid">12825940</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Polishchuk</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Interpretation of quantitative structure-activity relationship models: past, present, and future</article-title>
        <source>J Chem Inf Model</source>
        <year>2017</year>
        <volume>57</volume>
        <fpage>2618</fpage>
        <lpage>2639</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.7b00274</pub-id>
        <pub-id pub-id-type="pmid">28949520</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muratov</surname>
            <given-names>EN</given-names>
          </name>
          <name>
            <surname>Bajorath</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sheridan</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Tetko</surname>
            <given-names>IV</given-names>
          </name>
          <name>
            <surname>Filimonov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Poroikov</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Oprea</surname>
            <given-names>TI</given-names>
          </name>
          <name>
            <surname>Baskin</surname>
            <given-names>II</given-names>
          </name>
          <name>
            <surname>Varnek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Roitberg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Isayev</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Curtalolo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fourches</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Aspuru-Guzik</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Agrafiotis</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cherkasov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tropsha</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>QSAR without borders</article-title>
        <source>Chem Soc Rev</source>
        <year>2020</year>
        <volume>49</volume>
        <fpage>3525</fpage>
        <pub-id pub-id-type="doi">10.1039/D0CS00098A</pub-id>
        <pub-id pub-id-type="pmid">32356548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta-Ostermann</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bajorath</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The ‘SAR Matrix’ method and its extensions for applications in medicinal chemistry and chemogenomics</article-title>
        <source>F100 Research</source>
        <year>2014</year>
        <volume>3</volume>
        <fpage>113</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.4185.1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lombardo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Desai</surname>
            <given-names>PV</given-names>
          </name>
          <name>
            <surname>Arimoto</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Desino</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Keefer</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Petersson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Winiwarter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Broccatelli</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>In silico absorption, distribution, metabolism, excretion, and pharmacokinetics (ADME-PK): utility and best practices. An industry perspective from the international consortium for innovation through quality in pharmaceutical development</article-title>
        <source>J Med Chem</source>
        <year>2017</year>
        <volume>60</volume>
        <fpage>9097</fpage>
        <lpage>9113</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jmedchem.7b00487</pub-id>
        <pub-id pub-id-type="pmid">28609624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shah</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Siramshetty</surname>
            <given-names>VB</given-names>
          </name>
          <name>
            <surname>Zakharov</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Southall</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>D-T</given-names>
          </name>
        </person-group>
        <article-title>Predicting liver cytosol stability of small molecules</article-title>
        <source>J Cheminf</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>21</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-020-00426-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sasahara</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shibata</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sasabe</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Suzuki</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Takeuchi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Umehara</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kashiyama</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Feature importance of machine learning prediction models shows structurally active part and important physicochemical features in drug design</article-title>
        <source>Drug Metab Pharmacokinet</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>100401</fpage>
        <pub-id pub-id-type="doi">10.1016/j.dmpk.2021.100401</pub-id>
        <pub-id pub-id-type="pmid">34089983</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durant</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Leland</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Nourse</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>Reoptimization of MDL keys for use in drug discovery</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>2002</year>
        <volume>42</volume>
        <fpage>1273</fpage>
        <lpage>1280</lpage>
        <pub-id pub-id-type="doi">10.1021/ci010132r</pub-id>
        <pub-id pub-id-type="pmid">12444722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klekota</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>FP</given-names>
          </name>
        </person-group>
        <article-title>Chemical substructures that enrich for biological activity</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>2518</fpage>
        <lpage>2525</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn479</pub-id>
        <pub-id pub-id-type="pmid">18784118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Domingos</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pazzani</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>On the optimality of the simple Bayesian classifier under zero-one loss</article-title>
        <source>Mach Learn</source>
        <year>1997</year>
        <volume>29</volume>
        <fpage>103</fpage>
        <lpage>137</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1007413511361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Olshen</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Stone</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <source>Classification and regression trees</source>
        <year>1984</year>
        <publisher-loc>Belmont</publisher-loc>
        <publisher-name>Wadsworth</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geurts</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ernst</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wehenkel</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Extremely randomized trees</article-title>
        <source>Mach Learn</source>
        <year>2006</year>
        <volume>63</volume>
        <fpage>3</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1007/s10994-006-6226-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Random forests</article-title>
        <source>Mach Learn</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>5</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cortes</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vapnik</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Support-vector networks</article-title>
        <source>Mach Learn</source>
        <year>1995</year>
        <volume>2</volume>
        <fpage>273</fpage>
        <lpage>297</lpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lundberg</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Guyon</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Luxburg</surname>
            <given-names>UV</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wallach</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Fergus</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vishwanathan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Garnett</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>&amp;nbsp;A unified approach to interpreting model predictions</article-title>
        <source>Advances in neural information processing systems 30</source>
        <year>2017</year>
        <publisher-loc>Curran Associates Inc</publisher-loc>
        <publisher-name>Red Hook</publisher-name>
        <fpage>4765</fpage>
        <lpage>4774</lpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chuang</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Gunsalus</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Keiser</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Learning molecular representations for medicinal chemistry</article-title>
        <source>J Med Chem</source>
        <year>2020</year>
        <volume>63</volume>
        <fpage>8705</fpage>
        <lpage>8722</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jmedchem.0c00385</pub-id>
        <pub-id pub-id-type="pmid">32366098</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaulton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bellis</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Bento</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Chambers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davies</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hersey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Light</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>McGlinchey</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Michalovich</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Al-Lazikani</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Overington</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>ChEMBL: a large-scale bioactivity database for drug discovery</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>40</volume>
        <fpage>D1100</fpage>
        <lpage>D1107</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr777</pub-id>
        <pub-id pub-id-type="pmid">21948594</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andrew</surname>
            <given-names>PB</given-names>
          </name>
        </person-group>
        <article-title>The use of the area under the ROC curve in the evaluation of machine learning algorithms</article-title>
        <source>Pattern Recogn</source>
        <year>1997</year>
        <volume>30</volume>
        <issue>7</issue>
        <fpage>1145</fpage>
        <lpage>1159</lpage>
        <pub-id pub-id-type="doi">10.1016/S0031-3203(96)00142-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Landrum G. RDKit: Open-Source Cheminformatics Software, 2016, <ext-link ext-link-type="uri" xlink:href="https://www.rdkit.org">https://www.rdkit.org</ext-link></mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>PaDEL-descriptor</surname>
            <given-names>YCW</given-names>
          </name>
        </person-group>
        <article-title>An open source software to calculate molecular descriptors and fingerprints</article-title>
        <source>J Comput Chem</source>
        <year>2011</year>
        <volume>32</volume>
        <fpage>1466</fpage>
        <lpage>1474</lpage>
        <pub-id pub-id-type="doi">10.1002/jcc.21707</pub-id>
        <pub-id pub-id-type="pmid">21425294</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Podlewska</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kafel</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>MetStabOn<bold>—</bold>online platform for metabolic stability predictions</article-title>
        <source>Int J Mol Sci</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>1040</fpage>
        <pub-id pub-id-type="doi">10.3390/ijms19041040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gramfort</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Thirion</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grisel</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Blondel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Prettenhofer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dubourg</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vanderplas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Passos</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cournapeau</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Brucher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Perrot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Duchesnay</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Scikit-learn: machine Learning in Python</article-title>
        <source>J Mach Learn Res</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olson</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Bartley</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Urbanowicz</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of a tree-based pipeline optimization tool for automating data science</article-title>
        <source>Proc GECCO</source>
        <year>2016</year>
        <volume>2016</volume>
        <fpage>485</fpage>
        <lpage>492</lpage>
        <pub-id pub-id-type="doi">10.1145/2908812.2908918</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
