<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10284677</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad063</article-id>
    <article-id pub-id-type="publisher-id">vbad063</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Article</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Software</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LongDat: an R package for covariate-sensitive longitudinal analysis of high-dimensional data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1765-7132</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Chia-Yu</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="http://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="lead">Formal analysis</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="lead">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="http://credit.niso.org/contributor-roles/project-administration" degree-contribution="lead">Project administration</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="lead">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="lead">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="lead">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Max-Delbrück-Center for Molecular Medicine in the Helmholtz Association (MDC)</institution>, Berlin 13125, <country country="DE">Germany</country></aff>
        <aff><institution>Experimental and Clinical Research Center, A Cooperation between the Max-Delbrück-Center for Molecular Medicine in the Helmholtz Association and the Charité – Universitätsmedizin Berlin</institution>, Berlin 13125, <country country="DE">Germany</country></aff>
        <aff><institution>Charité - Universitätsmedizin Berlin, Corporate Member of Freie Universität Berlin and Humboldt-Universität zu Berlin</institution>, Berlin 10117, <country country="DE">Germany</country></aff>
        <aff><institution>DZHK (German Centre for Cardiovascular Research), partner site Berlin</institution>, Berlin 10785, <country country="DE">Germany</country></aff>
        <xref rid="vbad063-cor1" ref-type="corresp"/>
        <!--Chia-Yu.Chen@mdc-berlin.de-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7468-9531</contrib-id>
        <name>
          <surname>Löber</surname>
          <given-names>Ulrike</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/conceptualization" degree-contribution="supporting">Conceptualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="http://credit.niso.org/contributor-roles/supervision" degree-contribution="supporting">Supervision</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Max-Delbrück-Center for Molecular Medicine in the Helmholtz Association (MDC)</institution>, Berlin 13125, <country country="DE">Germany</country></aff>
        <aff><institution>Experimental and Clinical Research Center, A Cooperation between the Max-Delbrück-Center for Molecular Medicine in the Helmholtz Association and the Charité – Universitätsmedizin Berlin</institution>, Berlin 13125, <country country="DE">Germany</country></aff>
        <aff><institution>Charité - Universitätsmedizin Berlin, Corporate Member of Freie Universität Berlin and Humboldt-Universität zu Berlin</institution>, Berlin 10117, <country country="DE">Germany</country></aff>
        <aff><institution>DZHK (German Centre for Cardiovascular Research), partner site Berlin</institution>, Berlin 10785, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Forslund</surname>
          <given-names>Sofia K</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="http://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="supporting">Formal analysis</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="http://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="supporting">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="http://credit.niso.org/contributor-roles/project-administration" degree-contribution="supporting">Project administration</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="lead">Resources</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="http://credit.niso.org/contributor-roles/supervision" degree-contribution="lead">Supervision</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="supporting">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="supporting">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="supporting">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Max-Delbrück-Center for Molecular Medicine in the Helmholtz Association (MDC)</institution>, Berlin 13125, <country country="DE">Germany</country></aff>
        <aff><institution>Experimental and Clinical Research Center, A Cooperation between the Max-Delbrück-Center for Molecular Medicine in the Helmholtz Association and the Charité – Universitätsmedizin Berlin</institution>, Berlin 13125, <country country="DE">Germany</country></aff>
        <aff><institution>Charité - Universitätsmedizin Berlin, Corporate Member of Freie Universität Berlin and Humboldt-Universität zu Berlin</institution>, Berlin 10117, <country country="DE">Germany</country></aff>
        <aff><institution>DZHK (German Centre for Cardiovascular Research), partner site Berlin</institution>, Berlin 10785, <country country="DE">Germany</country></aff>
        <aff><institution>Structural and Computational Biology Unit, European Molecular Biology Laboratory</institution>, Heidelberg 69117, <country country="DE">Germany</country></aff>
        <xref rid="vbad063-cor1" ref-type="corresp"/>
        <!--Sofia.Forslund@mdc-berlin.de-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kuijjer</surname>
          <given-names>Marieke</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad063-cor1">To whom correspondence should be addressed. <email>chia-yu.chen@mdc-berlin.de</email> or <email>sofia.forslund@mdc-berlin.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-05-18">
      <day>18</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad063</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>15</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>30</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>21</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad063.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>We introduce LongDat, an R package that analyzes longitudinal multivariable (cohort) data while simultaneously accounting for a potentially large number of covariates. The primary use case is to differentiate direct from indirect effects of an intervention (or treatment) and to identify covariates (potential mechanistic intermediates) in longitudinal data. LongDat focuses on analyzing longitudinal microbiome data, but its usage can be expanded to other data types, such as binary, categorical and continuous data. We tested and compared LongDat with other tools (i.e. MaAsLin2, ANCOM, lgpr and ZIBR) on both simulated and real data. We showed that LongDat outperformed these tools in accuracy, runtime and memory cost, especially when there were multiple covariates. The results indicate that the LongDat R package is a computationally efficient and low-memory-cost tool for longitudinal data with multiple covariates and facilitates robust biomarker searches in high-dimensional datasets.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The R package LongDat is available on CRAN (<ext-link xlink:href="https://cran.r-project.org/web/packages/LongDat/" ext-link-type="uri">https://cran.r-project.org/web/packages/LongDat/</ext-link>) and GitHub (<ext-link xlink:href="https://github.com/CCY-dev/LongDat" ext-link-type="uri">https://github.com/CCY-dev/LongDat</ext-link>).</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>German Research Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001659</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>German Federal Ministry of Education and Research</institution>
          </institution-wrap>
        </funding-source>
        <award-id>01KI1909B</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Recent years have seen the spawning of high-dimensional data (i.e. data with a large number of features) as biotechnology develops rapidly (<xref rid="vbad063-B2" ref-type="bibr">Assent, 2012</xref>; <xref rid="vbad063-B54" ref-type="bibr">Witten <italic toggle="yes">et al.</italic>, 2010</xref>). For instance, metabolomics, immunomics and metagenomics are becoming prevalent. Among them, count data derived from microbial metagenomics sequencing especially require specific methods to tackle since they have several inherent properties, including uneven sequencing depth across samples, compositional structure, overdispersion and high sparsity (<xref rid="vbad063-B16" ref-type="bibr">Kodikara <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="vbad063-B55" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2017</xref>). When the research aim is to find out the differences in the abundance of microbial features between groups (e.g. time points, treatments), a typical workflow consists of pre-processing and differential abundance analysis steps. Uneven sequencing depth in metagenomic shotgun sequencing needs to be addressed at the pre-processing step because it is known to cause bias in evaluating microbial communities (<xref rid="vbad063-B41" ref-type="bibr">Sanchez-Cid <italic toggle="yes">et al.</italic>, 2022</xref>). Therefore, data-preprocessing approaches such as normalization, transformation and rarefaction have been developed to deal with varying sequencing depth (<xref rid="vbad063-B19" ref-type="bibr">Lin <italic toggle="yes">et al.</italic>, 2020</xref>). When it comes to differential abundance analysis, we need to consider the typical characteristics of microbiome data, including () compositional structure, (ii) overdispersion and (iii) high sparsity. Microbial data from shotgun sequencing are inherently compositional since the total amount of reads each sequencing run can generate is fixed. Thus the abundances of features are not independent of each other (<xref rid="vbad063-B13" ref-type="bibr">Gloor <italic toggle="yes">et al.</italic>, 2017</xref>). Tools have been proposed to account for the compositional structure (<xref rid="vbad063-B27" ref-type="bibr">Mandal <italic toggle="yes">et al.</italic>, 2015</xref>). However, some literature shows that the compositional methods do not always outperform the non-compositional methods (<xref rid="vbad063-B26" ref-type="bibr">Mallick <italic toggle="yes">et al.</italic>, 2021</xref>). Overdispersion denotes a larger variability observed in data than expected from a specific distribution, while high sparsity implies that the data are inflated with zeros. When fitting models to the microbiome data, overdispersion and high sparsity should be addressed. For example, models like negative binomial regression and zero-inflated Poisson regression have been introduced to solve overdispersion and high-sparsity problems (<xref rid="vbad063-B26" ref-type="bibr">Mallick <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad063-B55" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2017</xref>). Collectively, many different microbiome data analysis methods have been proposed so far, and there are plentiful reviews on their comparisons (<xref rid="vbad063-B7" ref-type="bibr">Calgaro <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="vbad063-B43" ref-type="bibr">Swift <italic toggle="yes">et al.</italic>, 2023</xref>; <xref rid="vbad063-B50" ref-type="bibr">Weiss <italic toggle="yes">et al.</italic>, 2017</xref>). However, there is no universal method for analyzing all types of microbiome data. Hence, it depends on the characteristics of the data and the user’s research aim to opt for an appropriate method in different scenarios.</p>
    <p>Microbiome data can be divided into cross-sectional and longitudinal based on its study design. Cross-sectional data are collected by examining multiple subjects at one time point (<xref rid="vbad063-B18" ref-type="bibr">Levin, 2006</xref>). In contrast, longitudinal data from observational or intervention cohorts are repeated measurements from the same individuals at different time points (<xref rid="vbad063-B21" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2010</xref>). Compared with cross-sectional studies, longitudinal studies account for individual variation and enable researchers to trace changes over time (<xref rid="vbad063-B15" ref-type="bibr">Hua <italic toggle="yes">et al.</italic>, 2009</xref>). Thus, longitudinal data collection has become more common in biological and medical fields nowadays (<xref rid="vbad063-B21" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2010</xref>). When fitting models to longitudinal microbiome data, microbiome features are the dependent variables, while the metadata (i.e. information about the individuals) are the independent variables. The metadata may include the time variable and other variables, such as dietary supplements, changes in meals and weight. The aim of longitudinal microbiome data analysis is to investigate the effect of the time variable since it is the proxy for treatment or intervention in longitudinal data. Accordingly, all variables in the metadata except for the time variables are referred to as covariates, which are defined as the factors other than the variable we are interested in (here the time variable) that might associate with the outcome (here microbiome features) (<xref rid="vbad063-B11" ref-type="bibr">Field-Fote, 2019</xref>). Examples of covariates include, for example, how patients benefiting from a dietary intervention (coded as a time variable) may have their medication dosages reduced during the course of a trial, raising the question of whether observed -omics signature changes are direct effects of the intervention or indirect effects following from the alteration of medication regime (<xref rid="vbad063-B25" ref-type="bibr">Maifeld <italic toggle="yes">et al.</italic>, 2021</xref>). Consequently, to ensure proper analyses of longitudinal microbiome data, it is important to disentangle the time variable's effects from the covariates' effects. In other words, covariates should be uncovered and controlled for to avoid false conclusions (<xref rid="vbad063-B35" ref-type="bibr">Pedersen <italic toggle="yes">et al.</italic>, 2018</xref>). In addition, two other critical points need to be considered when analyzing longitudinal microbiome data. First, selecting appropriate statistical tests from empirical data distributions is important for obtaining proper interpretations (<xref rid="vbad063-B32" ref-type="bibr">Nahm, 2016</xref>). Second, inter-individual variation (e.g. differences in microbial abundance levels between individuals) should be addressed. Several tools dealing with longitudinal microbiome data already exist, and some allow taking in covariates for analysis (<xref rid="vbad063-B1" ref-type="bibr">Asar <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="vbad063-B8" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="vbad063-B14" ref-type="bibr">Gonçalves <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad063-B26" ref-type="bibr">Mallick <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad063-B27" ref-type="bibr">Mandal <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="vbad063-B34" ref-type="bibr">Opgen-Rhein <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad063-B45" ref-type="bibr">Timonen <italic toggle="yes">et al.</italic>, 2021</xref>). Nevertheless, none of these tools reports explicitly on how the effect of time variable is affected by the presence of other covariates while detecting and simultaneously controlling for them. Therefore, we developed LongDat, an R package capable of performing the tasks as described above.</p>
    <p>LongDat is developed and tested centered on microbiome data. However, we extended its utility to work on different data types (e.g. immunome, metabolome, transcriptome). The key to LongDat’s flexibility to adapt to input data with different statistical distributions lies in the utilization of generalized linear models (GLMs) and non-parametric effect size calculations in the pipeline. GLMs can fit skewed data (e.g. data with overdispersion and high sparsity), allow non-constant variances (heteroscedasticity) and model various data types, such as continuous, categorical and ordinal data (<xref rid="vbad063-B20" ref-type="bibr">Lindsey <italic toggle="yes">et al.</italic>, 1998</xref>). To account for inter-individual variation in longitudinal data, we treat sample donor origin (i.e. individual) as a random effect, expanding the GLMs framework to the generalized linear mixed models (GLMMs) (<xref rid="vbad063-B5" ref-type="bibr">Bolker <italic toggle="yes">et al.</italic>, 2009</xref>). LongDat utilizes GLMMs to test the significance of the time variable without and with the presence of covariates in the models, respectively. Subsequently, the effect size of the time variable on each microbiome feature is calculated. In a longitudinal setting, an effect size is defined as the degree of feature difference before and after treatment. Reporting effect sizes in the result is in line with the current best practice, which urges researchers to report effect sizes along with <italic toggle="yes">P</italic>-values in biomedical research (<xref rid="vbad063-B42" ref-type="bibr">Sullivan <italic toggle="yes">et al.</italic>, 2012</xref>). <italic toggle="yes">P</italic>-values from the abovementioned model tests indicate the statistical significance of the time variable (proxy of treatments), whereas standardized and directional effect sizes allow users to interpret the magnitude of effects both manually and within automated frameworks. In the LongDat pipeline, directional non-parametric effect sizes (e.g. Spearman’s rho and Cliff’s delta) are applied to handle both normally and non-normally distributed data (<xref rid="vbad063-B28" ref-type="bibr">Marfo <italic toggle="yes">et al.</italic>, 2019</xref>). LongDat focuses on analyzing monotonic (i.e. the direction of change is fixed) treatment effects within time intervals while reporting covariates for each feature.</p>
    <p>In this report, we describe the method of the LongDat R package and validate its performance by comparing it with its closest published counterpart to date, MaAsLin2 (<xref rid="vbad063-B26" ref-type="bibr">Mallick <italic toggle="yes">et al.</italic>, 2021</xref>). We tested the performance of LongDat and MaAsLin2 on simulated, semi-synthetic and real microbiome data. MaAsLin2 is an R package similar to LongDat in several aspects. They both focus on microbiome analysis, adopt GLMMs and allow covariates to be included in the models. The main difference between MaAsLin2 and LongDat is that MaAsLin2 does not explicitly report how the effect of the time variable is affected by the presence of other covariates. In addition, the ways of treating covariates in the two tools differ. MaAsLin2 takes in all covariates along with the time variable into a model at once, while LongDat loops over each covariate in parallel models (see Methods). This distinction leads to significant differences in the results of analyzing longitudinal microbiome data with many covariates, making LongDat more suitable when there are multiple covariates (see Results). Aside from MaAsLin2, we also compared LongDat with other R packages which allow covariates to be included in the analysis, namely ANCOM (<xref rid="vbad063-B27" ref-type="bibr">Mandal <italic toggle="yes">et al.</italic>, 2015</xref>), lgpr (<xref rid="vbad063-B45" ref-type="bibr">Timonen <italic toggle="yes">et al.</italic>, 2021</xref>) and ZIBR (<xref rid="vbad063-B8" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2016</xref>). ANCOM is a microbiome-oriented tool that utilizes the compositional method. Lgpr uses additive Gaussian process regression (a Bayesian method) to achieve non-parametric modeling of longitudinal data. ZIBR incorporates logistic models and zero-inflated Beta regressions with random effects to test the effect of time on microbiome features. Since normalization and rarefaction of the microbial count data might induce considerable changes to the analysis result, we compared the performances of these tools when different normalization or rarefaction techniques were applied, including total-sum scaling (TSS), cumulative-sum scaling (CSS), trimmed mean of M-values (TMM), geometric mean of pairwise ratios (GMPR), centered log-ratio (CLR), rarefaction (<xref rid="vbad063-B9" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbad063-B29" ref-type="bibr">McKnight <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="vbad063-B31" ref-type="bibr">Mulè <italic toggle="yes">et al.</italic>, 2022</xref>). TSS divides absolute abundance by the total sum of read depth and converts it into relative abundance ranging between 0 and 1. CSS is a quantile normalization method that addresses the bias arising from TSS. The purpose of TMM is to tackle the problem of composition bias and calculate normalization factors that aid in comparing different libraries. GMPR computes the ratio between each pair of values and then takes the geometric mean of those ratios to normalize data. CLR transformation, commonly used for compositional data analysis, takes the logarithm of the ratios of each component to the geometric mean of all components, and then centers the resulting values around zero. Lastly, rarefaction randomly subsamples the data to obtain an equivalent sequencing depth across all samples. Altogether, we assessed how these tools performed with various normalization or rarefaction techniques.</p>
    <p>The real microbiome data used in this study for comparison are from our previous study, which reported on a clinical cohort investigating fasting effects on patients with metabolic syndrome (MetS) (<xref rid="vbad063-B25" ref-type="bibr">Maifeld <italic toggle="yes">et al.</italic>, 2021</xref>). By reanalyzing this dataset in which MetS patients benefit from a dietary intervention while medication dosages were altered subsequently during the trial course as an indirect effect following improved health, we demonstrated the need to resolve the time variable (proxy of dietary intervention) and covariate effects in real data. The research question is whether the beneficial outcome is a direct effect of the intervention or an indirect effect following the alteration of the medication regimen. Below we show that LongDat could disentangle the intervention’s beneficial direct effect from the indirect effect of the changes in drug dosage. Finally, to demonstrate LongDat’s flexibility to deal with other datatypes besides microbiome data, we also applied LongDat to the immunome data in the study described above.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 The LongDat method</title>
      <p>The LongDat pipeline comprises three major steps, namely the null time model test, covariate model test and effect size calculation (<xref rid="vbad063-F1" ref-type="fig">Fig. 1</xref>).</p>
      <fig position="float" id="vbad063-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>LongDat pipeline overview. Flowchart of LongDat showing the major functions (bold text in red) and steps. The function ‘make_master_table()’ creates a master table that can be taken as input by joining metadata and feature tables provided by the user. The two functions ‘longdat_disc()’ and ‘longdat_cont()’ both perform covariate-sensitive analyses. The main components of them are the null time model test, the effect size calculation and the covariate model test, applied to input master tables to perform covariate-aware tests for the significance of the time variable (the proxy of treatment). The function ‘longdat_disc()’ is suitable for data where time is discrete (e.g. a before/after treatment dataset), whereas ‘longdat_cont()’ is for data with time represented as a continuous variable (e.g. day). Finally, the function ‘cuneiform_plot()’ generates a summarizing plot of the result table. For more detailed tutorials of LongDat application, please visit GitHub (<ext-link xlink:href="https://github.com/CCY-dev/LongDat" ext-link-type="uri">https://github.com/CCY-dev/LongDat</ext-link>), or refer to its vignettes</p>
        </caption>
        <graphic xlink:href="vbad063f1" position="float"/>
      </fig>
      <list list-type="order">
        <list-item>
          <p><italic toggle="yes">Null time model test.</italic> We test whether time associates significantly with each feature (dependent variable), regardless of covariates. LongDat incorporates several R packages specializing in GLMMs, such as MASS, lme4 and glmmTMB (<xref rid="vbad063-B3" ref-type="bibr">Bates <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="vbad063-B6" ref-type="bibr">Brooks <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="vbad063-B48" ref-type="bibr">Venables <italic toggle="yes">et al.</italic>, 2002</xref>), providing high flexibility for input data types. A negative binomial model is used to fit count data composed of integers (<xref rid="vbad063-B49" ref-type="bibr">Ver Hoef <italic toggle="yes">et al.</italic>, 2007</xref>), such as numbers of sequencing reads. A beta model is applied to proportion data (i.e. that range between 0 and 1) (<xref rid="vbad063-B10" ref-type="bibr">Ferrari <italic toggle="yes">et al.</italic>, 2004</xref>). For binary data (consisting of either 0 or 1), binary logistic regression is performed (<xref rid="vbad063-B33" ref-type="bibr">Nick <italic toggle="yes">et al.</italic>, 2007</xref>). For ordinal data (where the features correspond to ranks), a proportional odds model is adopted (<xref rid="vbad063-B22" ref-type="bibr">Liu, 2009</xref>). Finally, continuous data are first normalized and then fitted by linear models. Each model is a random intercept model with the sample donor origin treated as a random factor to account for between-individual variability and non-independence of samples from the same donor. <italic toggle="yes">P</italic>-values are adjusted for multiple testing using the Benjamini-Hochberg method or other approaches (<xref rid="vbad063-B4" ref-type="bibr">Benjamini <italic toggle="yes">et al.</italic>, 1995</xref>).</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Covariate model test.</italic> If covariates are present in a dataset, this step identifies them and disentangles their effects from those of variables of interest (here, the time variable). In the metadata, covariates that exhibit significant association with each feature (e.g. microbiome abundance) via non-parametric tests (i.e. the Wilcoxon rank-sum, Kruskal-Wallis or Spearman’s correlation test) are selected. And then, each selected covariate is included one by one as a fixed effect, together with the time variable, in GLMMs to examine whether or not the time associations can be reduced to the influence of each covariate, reflecting the ‘vibration of effects’ (VoE) concept (<xref rid="vbad063-B44" ref-type="bibr">Tierney <italic toggle="yes">et al.</italic>, 2021</xref>). VoE is the degree to which different combinations of independent variables (e.g. adding covariates) change the outcome and assessed significance of a model. The larger the VoE, the less robust the association is between features and independent variables. That is, a true association should remain significant across all model configurations. Significant time-dependent features are subsequently classified as fulfilling conditions of ‘effect not reducible to covariate’, ‘entangled with covariate’ or ‘effect reducible to covariate’ according to these model tests. If the time variable remains a significant predictor in all models, the feature will be flagged as ‘effect not reducible to covariate’. If the time variable loses significance but the covariate does show significance in any of the models, the feature is marked as ‘effect reducible to covariate’. If there is no clear covariate but at least one model in which the covariate and time both failed to show significance, the feature will be labeled ‘entangled with covariate’.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Effect size calculation.</italic> Non-parametric effect size calculations are implemented. These are Spearman correlation for continuous time variables (e.g. day) and Cliff’s delta for discrete time variables (e.g. before/after treatment) (<xref rid="vbad063-B24" ref-type="bibr">Macbeth <italic toggle="yes">et al.</italic>, 2010</xref>). Effect size calculation is based on a naïve association between the independent variable and the feature, without being partitioned by covariates. Therefore, to ensure LongDat calculates the correct effect size, treatment effects should be monotonic (i.e. no change in the direction of association) within the time interval of the input data. If this is not the case, analyses should be done separately on time subranges of the data for which monotony holds.</p>
        </list-item>
      </list>
      <p>All results of the steps mentioned above are summarized into two tables. One table lists the significance estimate (<italic toggle="yes">q</italic>-values adjusted for multiple testing) of time dependence and effect sizes across all features. The other table lists relevant covariates with relative reducibility status for each of them.</p>
    </sec>
    <sec>
      <title>2.2 LongDat package overview</title>
      <p>LongDat is built with R (≥4.0.0), and its dependencies include lme4 (≥1.1-28) (<xref rid="vbad063-B3" ref-type="bibr">Bates <italic toggle="yes">et al.</italic>, 2015</xref>), glmmTMB (≥1.1.3) (<xref rid="vbad063-B6" ref-type="bibr">Brooks <italic toggle="yes">et al.</italic>, 2017</xref>), reshape2 (≥1.4.4) (<xref rid="vbad063-B51" ref-type="bibr">Wickham, 2007</xref>), emmeans (≥1.7.3) (<xref rid="vbad063-B17" ref-type="bibr">Lenth, 2021</xref>), bestNormalize (≥1.8.2) (<xref rid="vbad063-B37" ref-type="bibr">Peterson, 2021</xref>), MASS (≥7.3-56) (<xref rid="vbad063-B48" ref-type="bibr">Venables <italic toggle="yes">et al.</italic>, 2002</xref>), tidyverse (≥1.3.1) (<xref rid="vbad063-B52" ref-type="bibr">Wickham <italic toggle="yes">et al.</italic>, 2019</xref>), effsize (≥0.8.1) (<xref rid="vbad063-B46" ref-type="bibr">Torchiano, 2020</xref>), patchwork (≥1.1.1) (<xref rid="vbad063-B36" ref-type="bibr">Pedersen, 2020</xref>) and car (≥3.0-12) (<xref rid="vbad063-B12" ref-type="bibr">Fox <italic toggle="yes">et al.</italic>, 2019</xref>). There are four main functions that are the most relevant to users of the LongDat package (<xref rid="vbad063-F1" ref-type="fig">Fig. 1</xref>). For more detailed tutorials for LongDat, please visit GitHub (<ext-link xlink:href="https://github.com/CCY-dev/LongDat" ext-link-type="uri">https://github.com/CCY-dev/LongDat</ext-link>), or install LongDat and then access its vignettes with the command <bold>‘</bold>browseVignettes(“LongDat”)’.</p>
    </sec>
    <sec>
      <title>2.3 Simulation of longitudinal data with microbiomeDASim</title>
      <p>Longitudinal data corresponding to microbiome taxonomic abundance measurements from a cohort were simulated using microbiomeDASim (<xref rid="vbad063-B53" ref-type="bibr">Williams <italic toggle="yes">et al.</italic>, 2019</xref>). MicrobiomeDASim is an R package aimed at simulating longitudinal differential microbiome data. It allows the users to define sparsity, effect size, number of samples and time points. Here, simulated data were generated from a multivariate normal distribution, and the parameter encoding the longitudinal dependency within individuals was a first-order autoregressive correlation structure.</p>
      <list list-type="order">
        <list-item>
          <p><italic toggle="yes">Simulated data with no covariate.</italic> For each sample size (10, 20, 38, 75, 150 and 300) and effect size (Spearman’s rho median ≈ 0.2 or 0.5 for time-varying features) combination, 100 simulations were performed. Each simulated dataset contained 200 features. Among them, 20 features changed over time/under intervention, while the remaining 180 were sampled from the same distribution across time points. Two time points were simulated for each individual.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Simulated data with a single covariate for covariate effect analysis.</italic> A dummy variable correlating with the time variable was manually added to the aforementioned simulated dataset (sample size = 75, effect size median ≈ 0.5). The dummy variable was sampled to correlate with the time variable at a Spearman’s rho of approximately 0.25, 0.5, 0.75 or 0.99. For each correlation level, 100 simulations were performed. For the negative-control data, we shuffled the time variable against all other variables randomly within each individual to wipe out the association between the time variable and the features, and the association between the time variable and the covariates.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Simulated data with multiple covariates.</italic> 1, 2, 4, 8 or 16 dummy variables correlating with the time variable were manually added to the abovementioned simulated dataset (sample size = 75, effect size median ≈ 0.5). The dummy variables were randomly sampled to correlate with the time variable at a Spearman’s rho of approximately 0.25, 0.5, 0.75 or 0.99. For each correlation level, 100 simulations were performed. For the comparison between LongDat and Maaslin2, each dataset contained 200 features (20 changed over time and 180 did not), and for each combination of sample size, effect size and tool, 100 simulations were performed. For the comparison between LongDat, ANCOM, lpgr and ZIBR, each dataset contained 100 features (10 changed over time and 90 did not), and 50 simulations were performed for each combination of sample size, effect size and tool. The reduction of feature number and simulation number was due to the heavy computational resource ANCOM (large memory), lgpr (long runtime) and ZIBR (long runtime) required.</p>
        </list-item>
      </list>
    </sec>
    <sec>
      <title>2.4 Simulation of longitudinal data with SparseDOSSA2</title>
      <p>Besides microbiomeDASim, another set of longitudinal microbial data was simulated using SparseDOSSA2 (<xref rid="vbad063-B23" ref-type="bibr">Ma <italic toggle="yes">et al.</italic>, 2021</xref>). SparseDOSSA2 is an R package specialized for simulating realistic new microbiome data templated on real microbial communities. In these longitudinal data simulations, SparseDOSSA2 adopts generalized linear models to create feature-covariate associations (here, the time variable and other covariates) specified by users, and the template was based on stool microbiome. We followed the tutorial of SparseDOSSA2 (<ext-link xlink:href="https://github.com/biobakery/biobakery/wiki/SparseDOSSA2" ext-link-type="uri">https://github.com/biobakery/biobakery/wiki/SparseDOSSA2</ext-link>) as a complementary approach to the above to simulate longitudinal microbial data for benchmarking.</p>
      <list list-type="order">
        <list-item>
          <p><italic toggle="yes">Simulated data with no covariate.</italic> For each sample size (10, 20, 38, 75, 150 and 300) and effect size (Spearman’s rho median ≈ 0.2 or 0.5 for time-varying features) combination, 100 simulations were performed. Each simulated dataset contained 332 features. Among them, 33 features were spiked (changed over time/under intervention), while the remaining ones were sampled from the same distribution across time points. Two time points were simulated for each individual.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Simulated data with multiple covariates.</italic> 1, 4 or 16 dummy variables correlating with the time variable were manually added to the abovementioned simulated dataset with 332 features and varying sample sizes. The dummy variables were randomly sampled to correlate with the time variable at a Spearman’s rho of approximately 0.25, 0.5, 0.75 or 0.99. For each correlation level, 100 simulations were performed.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Simulated negative control data.</italic> Simulations were done to generate 100 sets of data with two time points, 150 individuals, 332 microbes and zero effect size for all microbial features (i.e. no spiked feature). Six versions of the data with different sequencing depths (the sum of microbial abundance of each feature) were further generated, to test the impact of systematic effects on sampling depth as may occur, for example, in clinical low biomass datasets. Accordingly, for these simulated data, any signal detected will reflect such systematic bias only. In versions one and two of the simulation, both of the total abundances at the first and second time points of each individual were rarefied to 50 000 and 1000, respectively. In version three, the total abundances at the first time point were rarefied to 50 000 and the second time point to 5000, while in version four, the total abundances at the first time point were rarefied to 5000 and the second time point to 50 000. In version five, the total abundances at the first time point were rarefied to 50 000 and the second time point to 1000, while in version six, the total abundances at the first time point were rarefied to 1000 and the second time point to 50 000. When applying LongDat count mode (running negative binomial models), versions three to six were further rarefied to either 5000 or 1000 (as per the lowest sequencing depth) at both time points, such that the sequencing depths are the same between the two time points, reflecting how a user concerned over unequal sampling depths would preprocess the data for this method.</p>
        </list-item>
      </list>
    </sec>
    <sec>
      <title>2.5 Normalization of the data simulated by SparseDOSSA2</title>
      <p>Several R packages were used to normalize or transform the raw simulated microbial features from SparseDOSSA2, TSS, rarefaction (<xref rid="vbad063-B40" ref-type="bibr">Saary <italic toggle="yes">et al.</italic>, 2017</xref>), CLR (<xref rid="vbad063-B47" ref-type="bibr">van den Boogaart <italic toggle="yes">et al.</italic>, 2008</xref>), GMPR (<xref rid="vbad063-B9" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2018</xref>), TMM (<xref rid="vbad063-B39" ref-type="bibr">Robinson <italic toggle="yes">et al.</italic>, 2010</xref>) and CSS (<xref rid="vbad063-B30" ref-type="bibr">Metwally <italic toggle="yes">et al.</italic>, 2018</xref>). The combinations of the tools (LongDat, MaAsLin2, lgpr, ZIBR) and the normalization methods are limited by each tool’s requirement of the input format.</p>
    </sec>
    <sec>
      <title>2.6 Running LongDat on simulated longitudinal data</title>
      <p>The function ‘longdat_cont()’ in the LongDat package was used for analyzing simulated longitudinal data, where the time between samplings was treated as a continuous variable and the data type as count data. The R package peakRAM was adopted to record running time and memory usage (<xref rid="vbad063-B38" ref-type="bibr">Quinn, 2017</xref>). Feature associations with Benjamini-Hochberg (BH)-corrected null-model <italic toggle="yes">q</italic>-value &lt; 0.1 and BH-corrected post-hoc test <italic toggle="yes">q</italic>-values &lt; 0.05 were considered significant. LongDat was run under CentOS Linux 7 and R version 4.1.1 with 8 GB of memory allocated.</p>
    </sec>
    <sec>
      <title>2.7 Running MaAsLin2 on simulated longitudinal data</title>
      <p>The function ‘Maaslin2()’ in the MaAsLin2 package was used for analyzing simulated longitudinal data, where the time between samplings was treated as a continuous variable, and the mode was set as ‘NEGBIN’ for negative binomial model mode and ‘LM’ for linear model mode (<xref rid="vbad063-B26" ref-type="bibr">Mallick <italic toggle="yes">et al.</italic> 2021</xref>). Since MaAsLin2 lacks a covariate model test component that corresponds to the second part of the LongDat pipeline, we ran MaAsLin2 with two separate runs (with and without simulated covariate included as a fixed effect, respectively) for each simulated data with covariates, such that the MaAsLin2 result is comparable with that of LongDat. Features with BH-corrected <italic toggle="yes">q</italic>-value &lt; 0.1 were considered significant. MaAsLin2 was run under CentOS Linux 7 and R version 4.1.1 with 8 GB of memory allocated.</p>
    </sec>
    <sec>
      <title>2.8 Running ANCOM on simulated longitudinal data</title>
      <p>The function ANCOM in the ancom. R Rscript (<ext-link xlink:href="https://github.com/FrederickHuangLin/ANCOM-Code-Archive" ext-link-type="uri">https://github.com/FrederickHuangLin/ANCOM-Code-Archive</ext-link>) was used for analyzing simulated longitudinal data. The time between samplings was treated as a factor, while the random formula was set as sample ID, and the adjust formula included all the present covariates. Features were considered significant if their W statistics passed the cutoff of the number of taxa multiplied by 0.7. ANCOM was run under CentOS Linux 7 and R version 4.1.1 with 350 GB of memory allocated.</p>
    </sec>
    <sec>
      <title>2.9 Running ZIBR on simulated longitudinal data</title>
      <p>The function ‘zibr()’ in the ZIBR package (<xref rid="vbad063-B8" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2016</xref>) was used for analyzing simulated longitudinal data, where the time between samplings was treated as a continuous variable. All covariates in the data were included for analyses, while subjects and time points were specified. Features with joint <italic toggle="yes">P</italic> values corrected by BH &lt; 0.1 were considered significant. ZIBR was run under CentOS Linux 7 and R version 4.1.1 with 8 GB of memory allocated.</p>
    </sec>
    <sec>
      <title>2.10 Running lgpr on simulated longitudinal data</title>
      <p>The function ‘lgp()’ in the lgpr package (<xref rid="vbad063-B45" ref-type="bibr">Timonen <italic toggle="yes">et al.</italic>, 2021</xref>) was used for analyzing simulated longitudinal data, where the time between samplings was treated as a continuous variable. Sample ID was set as the random effect, and all covariates in the data were included for analyses. The number of drawing samples from a Stan model was 100, and the number of Markov chains was 4. If the time variable was selected using a 95% threshold for the proportion of total explained variance, then the feature was considered significant. Lgpr was run under CentOS Linux 7 and R version 4.1.1 with 8 GB of memory allocated.</p>
    </sec>
    <sec>
      <title>2.11 Semi-synthetic evaluation of metagenomic data: Fasting study</title>
      <p>To perform a semi-synthetic evaluation based on real microbiome data, we selected the first and second time points from the stool microbiome data, using bacterial genus abundances. Next, we randomly shuffled the time variable against all other variables for each individual to eliminate any associations between the time variable and the microbes, as well as between the time variable and the covariates, such that no real signal of the intervention or of the passage of time should remain. Data were normalized or rarefied as the methods in the ‘normalization of the data simulated by SparseDOSSA2’ section.</p>
    </sec>
    <sec>
      <title>2.12 Evaluation of real metagenomic and immunome data: Fasting study</title>
      <p>The fasting study reanalyzed here reported on a clinical cohort investigating fasting effects on patients with MetS (<xref rid="vbad063-B25" ref-type="bibr">Maifeld <italic toggle="yes">et al.</italic>, 2021</xref>). This study has two arms, one being the fasting arm and the other being the DASH (Dietary Approaches to Stop Hypertension, DASH) arm. MetS patients in the fasting arm first underwent seven-day fasting, which consists of two days in which the patients took in a maximum of 1200 kcal/day and five days in which the patients took in 300–350 kcal/day. And then, there was a three-month re-feeding stage where MetS patients were asked to follow the DASH diet. Microbial abundance at the species level and the immunome data of the fasting arm were reanalyzed to demonstrate the value and performance of LongDat.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 LongDat outperforms MaAsLin2 when there are multiple covariates in the simulated data</title>
      <p>First, we compared the performance of LongDat with its closest counterpart up to date, MaAsLin2, by running them on microbiomeDASim-simulated longitudinal datasets templated on microbiome data from cohort studies without covariates. The default setting of MaAsLin2 was doing total-sum scaling (TSS) that converted the data into relative abundance and then fitting linear model (LM). However, this default setting performs worse than using the negative binomial model in terms of accuracy, true positive rate (TPR), false discovery rate (FDR) and Matthews correlation coefficient (MCC) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). Therefore, we focused on the MaAsLin2 negative binomial model mode results instead of its default setting. Both LongDat and MaAsLin2 use negative binomial models to fit the data. LongDat and MaAsLin2 have comparable accuracy ranging between 0.9 and 1 (<xref rid="vbad063-F2" ref-type="fig">Fig. 2</xref>). While MaAsLin2 achieves a higher TPR when sample sizes are small, this comes at the cost of a higher FDR. In contrast, the FDR median of LongDat was controlled at zero across all tested effects and sample sizes, while TPR increases with sample size (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). LongDat and MaAsLin2 have comparable memory footprints, whereas LongDat has a longer runtime (<xref rid="vbad063-F3" ref-type="fig">Fig. 3A</xref> and <xref rid="vbad063-F3" ref-type="fig">B</xref>) due to the additional covariate model test, which MaAsLin2 does not possess. Although MaAsLin2 and LongDat perform similarly on simulated data without covariates, their difference in performance rises as the number of covariates increases in the simulated data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S3A, B, S4A</xref> and <xref rid="sup1" ref-type="supplementary-material">B</xref>). The performance of LongDat remains stable across all numbers of covariates. In contrast, FDR escalates and TPR diminishes in MaAsLin2 as the number of covariates increases, especially when more than four covariates are present.</p>
      <fig position="float" id="vbad063-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Comparison of LongDat and MaAsLin2 (using the negative binomial model mode) on performance and power applied to microbiomeDASim-simulated longitudinal data. The box plots show the accuracy, true positive rate (TPR), false discovery rate (FDR) and Matthews correlation coefficient (MCC). The upper panel features a low effect size (median ≈ 0.2) while the lower panel features a medium effect size (median ≈ 0.5). For each combination of sample size, effect size and tool, 100 simulations were performed</p>
        </caption>
        <graphic xlink:href="vbad063f2" position="float"/>
      </fig>
      <fig position="float" id="vbad063-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Comparison of LongDat and MaAsLin2 (using the negative binomial model mode) on computational resource profiling applied to microbiomeDASim-simulated longitudinal data. Runtime (<bold>A</bold>) and total used memory (<bold>B</bold>) required by LongDat and MaAsLin2 when run on simulated data with 200 features and various sample sizes. For each sample size, 200 simulations were performed. 1 mebibyte (MiB) ≈ 1.05 megabyte (MB)</p>
        </caption>
        <graphic xlink:href="vbad063f3" position="float"/>
      </fig>
      <p>Apart from evaluating LongDat and MaAsLin2 using microbiomeDASim-simulated data, we utilized SparseDOSSA2, another microbiome data simulation tool, to validate that the benchmarking outcome of LongDat is consistent between different simulation tools. Here, we assessed the performance of LongDat and MaAsLin2 using various modes, such as linear or negative binomial models, on simulated data that was either raw, normalized or rarefied. The benchmarking of performance and requirement of computational resources on SparseDOSSA2-simulated data with 0 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5A</xref> and <xref rid="sup1" ref-type="supplementary-material">B</xref>), 1 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6A</xref> and <xref rid="sup1" ref-type="supplementary-material">B</xref>), 4 (<xref rid="sup1" ref-type="supplementary-material">Fig. S7</xref> and <xref rid="sup1" ref-type="supplementary-material">S7B</xref>) and 16 covariates (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8A</xref> and <xref rid="sup1" ref-type="supplementary-material">B</xref>) are presented. Within a broader perspective, these results reproduce our findings in the benchmarking using microbiomeDASim-simulated data, where MaAsLin2 and LongDat perform similarly on simulated data in the absence of covariates. However, as the number of covariates increases, the performance gap between the two methods becomes more evident. The performance of LongDat remains stable across all numbers of covariates while FDR surges and TPR diminishes in MaAsLin2, particularly when more than four covariates are present. Upon closer examination of each normalization method, MaAsLin2's negative binomial model mode generally produces higher TPR but also higher FDR than its linear model mode (except when run on CLR-transformed data, which has a high FDR), thus similar accuracy and MCC. On the other hand, LongDat produces comparable outcomes when either linear or negative binomial models are run on data processed through different normalization or rarefaction methods (except for CLR paired with linear model, which performs the worst). Specifically, we believe rarefaction is necessary for some situations, although the pair of negative binomial model and rarefied count data has higher FDR than the pair of linear model TSS-normalized data. For example, we simulated longitudinal negative control data with two time points in which the sequencing depths varied systematically between the two points. In this scenario, the negative binomial model applied to rarefied count data maintains a near-zero false positive rate (FPR), while the linear model applied to non-rarefied TSS-normalized data results in a high FPR when the depth variation between the two time points was large (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>). Therefore, we conclude that the use of linear models to analyze TSS-normalized data is reasonable only when there is no systematic bias in sequencing depth between groups or time points; otherwise, the analysis may result in many false positives. There is no method suitable for all scenarios; instead, the selection of an appropriate approach highly depends on the data's nature.</p>
    </sec>
    <sec>
      <title>3.2 LongDat outperforms ANCOM in computational efficiency and outperforms lgpr and ZIBR in overall performance when tested on simulated data</title>
      <p>In addition to MaAsLin2, we also compared LongDat with several other tools capable of analyzing longitudinal microbiome data, including ANCOM, lgpr and ZIBR, by examining their performances when multiple covariates are present (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S10A, B, S11A and B</xref>). Here the simulated data were generated by microbiomeDASim. The results show that the FDR of ANCOM remains around zero as LongDat does and has comparable accuracy, TPR and MCC when there are less than four covariates, whereas TPR dwindles as the number of covariates increases. The major drawback of ANCOM is that it needs large memory (requires 350 GB to be allocated or else errors would occur and halt) to run through each simulated dataset (here each containing 100 features), making it challenging to run ANCOM on a large scale. ZIBR does not perform well because its FDR is high, and its accuracy, TPR and MCC are low across all numbers of covariates. Moreover, ZIBR needs much time to run through each dataset with large sample sizes (e.g. around 55 h to finish a run with 300 samples and 16 covariates). Lastly, while lgpr has better TPR than LongDat when the sample size is small (≤38), it simultaneously has a high level of FDR. The primary shortcoming of lgpr is that its run time (e.g. around 65 h with 150 samples and 1 covariate) is substantially longer than all other tools, and it could not finish any run within the time limit (96 h) of the high-performance computing cluster we used. This impedes lgpr from being widely applied to microbiome data in a common research environment. From these results, we concluded that LongDat is the ideal tool for data with multiple covariates since it has decent performance and low computational resource requirements (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>).</p>
      <p>As we did with the comparison between LongDat and MaAsLin2, we employed SparseDOSSA2 to assess the performance of LongDat, lgpr and ZIBR, in addition to the microbiomeDASim-simulated data comparison. ANCOM's high memory requirement (&gt;350 GB) for SparseDOSSA2-simulated data analysis caused it to fail to run on the high-performance computing cluster we utilized, leading to its exclusion from the analysis here. The assessment of computational resource requirements and performance benchmarking using SparseDOSSA2-simulated data with varying numbers of covariates (0, 1, 4 and 16) is depicted in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S12A, B, S13A, B, S14A, B, S15A and B</xref>, respectively. These findings confirm our earlier observations based on microbiomeDASim-simulated data. ZIBR, which operates on TSS-normalized data, has a high FDR and takes a long time to execute. lgpr performs better than LongDat in terms of TPR for small sample sizes, regardless of normalization or rarefaction, but it also has a high FDR. The primary disadvantage of lgpr is that it takes significantly longer to run than any of the other tools, making it not able to complete any run within the time limit (96 h) of the high-performance computing cluster we used when the sample size is relatively large. The performances of both ZIBR and lgpr decline as the number of covariates increases. In contrast, LongDat maintains decent performance and computational resource requirements regardless of the number of covariates.</p>
    </sec>
    <sec>
      <title>3.3 The performance of LongDat was evaluated using semi-synthetic data, demonstrating a low false positive rate</title>
      <p>To estimate the performance of LongDat based on data aside from simulated data (microbiomeDASim and SparseDOSSA2), we conducted a semi-synthetic evaluation as well. In this evaluation, we shuffled the time variable against all other variables in the fasting microbiome data (at the genus level). Next, we compared the ratio of significant associations between unshuffled and shuffled data. The result of LongDat indicates few to no false positives in the shuffled data in all modes, regardless of whether covariates were included or excluded in the analysis (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S16</xref>). Conversely, MaAsLin2, lgpr and ZIBR were all influenced by the presence of covariates in their analyses. MaAsLin2 identifies fewer significant associations in the unshuffled data and more false positives in the shuffled data than LongDat. ZIBR and lgpr result in much higher false positive rates than LongDat. Consistent with prior analyses, we confirmed that LongDat is robust against false positive findings in both simulated and semi-synthetic evaluations.</p>
    </sec>
    <sec>
      <title>3.4 LongDat provides a more smooth and more efficient workflow than MaAsLin2 despite similar performance</title>
      <p>Since MaAsLin2 is the only alternate tool where memory and runtime scaling do not preclude its application to our full benchmark, the analyses below focus on the comparison between MaAsLin2 and LongDat. To compare the performance of LongDat and MaAsLin2 on detecting covariate effects, we added a dummy variable correlating with the time variable and tested whether this dummy variable, when instead used as the time input variable, was wrongly reported as exhibiting a relationship to the simulated feature independent of time (<xref rid="vbad063-F4" ref-type="fig">Fig. 4A and B</xref>). LongDat requires only a single run for this test. In contrast, MaAsLin2 lacks a covariate model test component corresponding to the LongDat pipeline's second part, so we ran MaAsLin2 in two separate runs (with and without covariate included in the model, respectively) to generate comparable results with LongDat. We found that LongDat and MaAsLin2 achieved similar performance, with the median success rate for both tools in correctly concluding covariate effects remaining at ∼0.95 (as per FDR threshold/family-wise error rate) even when the dummy and time variables were strongly correlated. As a negative control, we tested how LongDat performs when both the features and covariates are not associated with time by shuffling the time variable randomly within each individual (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S17</xref>). Here we tested if the shuffled time variable was reported as significant. We found no false positive occurred across all correlation degrees (the correlation between the time variable and covariate was, in fact, destroyed because time was shuffled). These results demonstrate that both LongDat and MaAsLin2 perform well in accuracy and correctly flagging covariates.</p>
      <fig position="float" id="vbad063-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Comparison of LongDat and MaAsLin2 on covariate-sensitive analysis applied to microbiomeDASim-simulated longitudinal data. To compare the ability of LongDat and MaAsLin2 on detecting covariates, a dummy variable was added to the simulated data and was tested for its effect. ‘Success’ is defined as a tool indicating the dummy variable as either ‘non-significant’, ‘reducible to covariate’ or ‘entangled with covariate’ (time is the covariate here), whereas ‘failure’ occurs when a tool wrongly concludes that the dummy variable is significant and the time variable is not. (<bold>A</bold>) The box plot shows the success rate of using LongDat and MaAsLin2 to filter out and conclude covariate effects at different degrees of correlation between the dummy variable and time. (<bold>B</bold>) The bar chart illustrates the proportion of success and failure across correlation degrees. For each degree of correlation, 100 simulations were done</p>
        </caption>
        <graphic xlink:href="vbad063f4" position="float"/>
      </fig>
      <p>In the simulated data, with rho being as high as 0.99 between the dummy and time variables, we demonstrated that LongDat could distinguish data generated from different underlying ground truths even when there is substantial confounding. It is worth noting that LongDat does not label the dummy variable as ‘non-significant’ (i.e. having no relationship with the feature at all) but rather as ‘reducible to covariate’ or ‘entangled with covariate’ when the correlation degree is high. These two labels do not signify that the dummy variable is irrelevant to the features but instead intend to communicate that its association with the features might be from an indirect association. In real data, however, it will be more challenging to discern between the dummy and the time variables if they are highly correlated. In that case, more investigation or experiments are required to confirm which variable has direct versus indirect influence, necessitating more careful inspection and domain knowledge before robust conclusions can be drawn.</p>
    </sec>
    <sec>
      <title>3.5 LongDat performs more robustly than MaAsLin2 in real data with multiple covariates</title>
      <p>Subsequently, to compare the performance of LongDat and MaAsLin2 on real data, we reanalyzed gut microbial data from a clinical cohort investigating fasting effects on patients with MetS (<xref rid="vbad063-B25" ref-type="bibr">Maifeld <italic toggle="yes">et al.</italic>, 2021</xref>). One aim of the study was to investigate how fasting affects blood pressure while controlling for changes in medication. When no covariates (i.e. medication variables) were included in the MaAsLin2 analysis, LongDat and MaAsLin2 each identified 27 microbial species that were significantly altered in abundance throughout the intervention, with 19 of them being consistent between the two (<xref rid="vbad063-F5" ref-type="fig">Fig. 5A and B</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2, S3 and S4</xref>). However, when covariates were included, only two species were reported significantly different in abundance by MaAsLin2 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). This is because models fitting most of the significantly affected species returned errors (showed NA in <italic toggle="yes">P</italic>-values and standard errors) when multiple fixed effects were included. LongDat avoids this problem by having only one covariate in a model at one time and loops over all of them. Thus, LongDat performs more robustly than MaAsLin2 for this type of data when multiple covariates are present in the dataset, but at the cost of higher runtime.</p>
      <fig position="float" id="vbad063-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Comparison of LongDat and MaAsLin2 on analyzing real microbiome data. (<bold>A</bold>) The cuneiform plot on the left panel shows the gut microbes (species level) that display significant differences in their abundance in at least one of the time intervals in the assessed study (<xref rid="vbad063-B25" ref-type="bibr">Maifeld <italic toggle="yes">et al.</italic>, 2021</xref>). In that study, metabolic disease patients underwent 7-day fasting and then a 3-month re-feeding period. In the plot, ‘fasting’ indicates the time elapsed from Day 0 to 7, while ‘refeeding’ indicates Day 7 to 90, and ‘study’ indicates the overall duration from Day 0 to 90. Bold species are the ones that appeared significant in both LongDat and MaAsLin2 results. The right panel reports the covariate status of each microbe as follows. <italic toggle="yes">OK_nc</italic>: OK and no covariate. Time/intervention has significant effect and there is no covariate. <italic toggle="yes">OK_nrc</italic>: OK and not reducible to any covariate. Time/intervention has significant effect, and its effect is independent of all tracked covariates. <italic toggle="yes">RC</italic>: Effect reducible to covariate. Time/intervention when tested on its own achieves significance; however, its effect is better explained by that of a covariate (whereas the inverse is not true). Microbes with BH-corrected model test q-values &lt; 0.1 and BH-corrected post-hoc test q-values &lt; 0.05 are regarded as significant. (<bold>B</bold>) The Venn diagram shows the significant species found by LongDat and MaAsLin2. Numbers indicate counts and percentages of each category. Note that for MaAsLin2, covariates were not included in the analyses here. When covariates were included in MaAsLin2 analysis, only 2 of the species showed significance here remained significant, while all others returned error due to NA in <italic toggle="yes">P</italic>-values and standard errors (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>)</p>
        </caption>
        <graphic xlink:href="vbad063f5" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.6 LongDat can be applied to other data types, such as immunome data</title>
      <p>Finally, to demonstrate that LongDat can run on other data types besides microbiome data, we applied LongDat to the immunome data from the same fasting study mentioned above (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S18 and S19</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S6–S9</xref>). The immunome data consist of proportion (percentage) and non-proportion (non-percentage) data, so they were analyzed by LongDat proportion mode and measurement mode, respectively. These results show that LongDat can tackle other types of data in addition to microbiome counts.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We introduce LongDat, an R package that analyzes longitudinal data for intervention (or treatment) effects while accounting for covariates throughout the intervention. LongDat was developed and tested as a microbiome analysis tool, and we made it able to work on other high-dimensional data types by using flexible and robust approaches, chiefly GLMMs and non-parametric tests. The resulting output allows convenient downstream analysis and interpretation. Instead of proposing a new theory or mathematical tool to deal with the problems of high-dimensional data, multiple covariates and different data types (distribution), we packaged the GLMMs and non-parametric tests together to automate the process of analyzing high-dimensional data. LongDat relieves the users of the burden of having to program the R linear modeling functions from scratch. With the standardized output, including effect sizes reported in Cliff’s delta, and the visualization of the significances and influences of covariates for each feature, it is easier for biologists to integrate, compare and visualize their findings. Though here we do not present a theoretical advance, we believe LongDat is a practical and convenient modeling tool immediately applicable to the scale of problems faced, e.g. in cohort- or intervention-centered systems medical research, and therefore promotes high-dimensional data analysis in the biomedical research field. One limitation of LongDat is that it reports standardized non-parametric effect sizes of discrete (Cliff’s delta) or continuous (Spearman’s rho) variables, both of which are calculated independently of other covariates. Thus, when covariates are present in the data, the reported effect size is not a perfect estimate as it does not incorporate covariates for calculation. We currently are not aware of any partial standardized directional effect size metrics that would let us circumvent this obstacle, but we are actively searching for them to include in later versions of LongDat.</p>
    <p>By conducting simulations using two independent tools, namely microbiomeDASim and SparseDOSSA2, we confirm that the statements below are consistent across benchmarking platforms. The advantages of LongDat over the most similar existing tool, MaAsLin2, include lower FDR, the ability to explicitly report covariate effects and their effect sizes, and thus a more convenient functionality in reporting and describing covariates for each feature. The latter, which reports the influence of covariates on the tested variable, is the exclusive feature of LongDat that no other tool possesses to the best of our knowledge. The other important feature of LongDat is that it can handle multiple covariates at once and maintain stable performance. This feature is achieved by having only one covariate in a model at one time and looping over them instead of including all covariates at once, which forms a lengthy formula. This approach grants LongDat robustness when facing multiple covariates, but at the cost of higher runtime. By contrast, the performance of MaAsLin2 is highly dependent on the number of covariates in the data. While MaAsLin2 and LongDat have comparable accuracy when there are no covariates, we observe a trade-off between TPR and FDR in them. Hence, MaAsLin2 and LongDat are suitable in different scenarios depending on the priorities of the application. For instance, when a lower FDR is more emphasized in an analysis, or when there are many covariates in a study, LongDat will be a better choice. In contrast, if a higher TPR and power are prioritized, and no covariate is in the data, then MaAsLin2 is a good option.</p>
    <p>In addition to MaAsLin2, we also compared LongDat with three other tools: ANCOM, lgpr and ZIBR. While the performance of ANCOM is fairly good when the number of covariates is low, ANCOM suffers from the need for huge memory to run. On the other hand, the performances of both lgpr and ZIBR are highly dependent on the number of covariates, and both tools suffer from long runtime. Furthermore, ANCOM and lgpr rely on arbitrary cutoffs (W statistics and the proportion of total explained variance, respectively), which might pose inconvenience and confusion to the users. Despite the unfavorable ZIBR results shown here, we believe in the potential of the zero-inflated models (represented by ZIBR here) since they characterize the distribution of highly sparse microbiome data well. We will keep track of its development (or other related zero-inflated models) and plan to integrate it into the future version of LongDat.</p>
    <p>To investigate the impact of normalization and rarefaction on analysis results, we conducted benchmarking tests on each tool using different preprocessing methods. Interestingly, we find that LongDat and MaAsLin2 have similar overall performance (based on accuracy and MCC) when analyzing data without any covariates, irrespective of the modes (negative binomial or linear model) and preprocessing methods (except for the CLR transformation). However, the discrepancy in the performance of LongDat and MaAsLin2 widens as the number of covariates increases. While all modes of MaAsLin2 struggle to maintain high true positive rates and low false discovery rates with four or more covariates, LongDat remains stable and performs well across all scenarios. Meanwhile, ZIBR and lgpr did not excel in this round of benchmarking test because of high FDR and extremely long runtime that impedes the users from applying them effectively. Furthermore, by simulating datasets with high variation in sequencing depth between time points (or groups), we underscored that the choice of normalization or rarefaction technique should be tailored to the specific characteristics of the data. In the example above, rarefaction is required to remove the systematic bias between time points, which leads to false positive findings. Ultimately, we believe that there is no one-size-fits-all approach to data preprocessing and analysis, and researchers should carefully select appropriate protocols according to the unique features of their data.</p>
    <p>In conclusion, our comprehensive benchmarking, including independent simulation tools, semi-synthetic and real data evaluations, demonstrates that the LongDat package we present here is a computationally efficient and low-memory-cost analysis tool for longitudinal data with multiple covariates, and facilitates robust biomarker searches in high-dimensional datasets.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbad063_Supplementary_Data</label>
      <media xlink:href="vbad063_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>We sincerely thank Morgan Essex for her insightful comments and revisions that significantly improved the manuscript in all aspects.</p>
    <sec>
      <title>Author contributions</title>
      <p>Chia-Yu Chen (Conceptualization [equal], Formal analysis [lead], Investigation [lead], Methodology [equal], Project administration [lead], Software [lead], Validation [lead], Visualization [lead], Writing—original draft [lead], Writing—review &amp; editing [equal]), Ulrike Löber (Conceptualization [supporting], Methodology [supporting], Software [supporting], Supervision [supporting], Writing—review &amp; editing [equal]) and Sofia Forslund (Conceptualization [equal], Formal analysis [supporting], Funding acquisition [lead], Investigation [supporting], Methodology [equal], Project administration [supporting], Resources [lead], Software [supporting], Supervision [lead], Validation [supporting], Visualization [supporting], Writing—original draft [supporting], Writing—review &amp; editing [equal]).</p>
    </sec>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the German Research Foundation (Deutsche Forschungsgemeinschaft, DFG) Collaborative Research Center (CRC) 1365 ‘Renoprotection’; the DFG as part of a Clinical Research Unit (CRU) 339 ‘Food Allergy and Tolerance’ [428049112]; and the German Federal Ministry of Education and Research [EMBARK; 01KI1909B] under the frame of JPI-AMR [EMBARK; JPIAMR2019-109] to U.L.</p>
    <p><italic toggle="yes">Conflict of interest</italic>: All authors declare that they have no conflicts of interest.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The scripts for simulating longitudinal data, running LongDat, ANCOM, lgpr, ZIBR and MaAsLin2, and also the raw data for the fasting study are available at <ext-link xlink:href="https://github.com/CCY-dev/LongDat_paper_supplement.git" ext-link-type="uri">https://github.com/CCY-dev/LongDat_paper_supplement.git</ext-link>. The stool sequencing data of the fasting study are deposited on NCBI under the accession PRJNA698459.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad063-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Asar</surname><given-names>Ö.</given-names></string-name></person-group><etal>et al</etal> (<year>2013</year>) <article-title>mmm: an R package for analyzing multivariate longitudinal data with multivariate marginal models</article-title>. <source>Comput. Methods Programs Biomed</source>., <volume>112</volume>, <fpage>649</fpage>–<lpage>654</lpage>.<pub-id pub-id-type="pmid">24054737</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Assent</surname><given-names>I.</given-names></string-name></person-group> (<year>2012</year>) <article-title>Clustering high dimensional data</article-title>. <source>WIREs Data Min. Knowledge Discov</source>., <volume>2</volume>, <fpage>340</fpage>–<lpage>350</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bates</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Fitting linear mixed-effects models using lme4</article-title>. <source>J. Stat. Soft</source>., <volume>67</volume>, <fpage>1</fpage>–<lpage>48</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benjamini</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>1995</year>) <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J. R. Stat. Soc. Ser. B (Methodological)</source>, <volume>57</volume>, <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bolker</surname><given-names>B.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Generalized linear mixed models: a practical guide for ecology and evolution</article-title>. <source>Trends Ecol. Evol</source>., <volume>24</volume>, <fpage>127</fpage>–<lpage>135</lpage>.<pub-id pub-id-type="pmid">19185386</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brooks</surname><given-names>M.E.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Modeling zero-inflated count data with glmmTMB</article-title>. <source>bioRxiv preprint</source>: 132753.</mixed-citation>
    </ref>
    <ref id="vbad063-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Calgaro</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Assessment of statistical methods from single cell, bulk RNA-seq, and metagenomics applied to microbiome data</article-title>. <source>Genome Biol</source>., <volume>21</volume>, <fpage>191</fpage>.<pub-id pub-id-type="pmid">32746888</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>E.Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>A two-part mixed-effects model for analyzing longitudinal microbiome compositional data</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2611</fpage>–<lpage>2617</lpage>.<pub-id pub-id-type="pmid">27187200</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>GMPR: a robust normalization method for zero-inflated count data with application to microbiome sequencing data</article-title>. <source>PeerJ</source>, <volume>6</volume>, <fpage>e4600</fpage>.<pub-id pub-id-type="pmid">29629248</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ferrari</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2004</year>) <article-title>Beta regression for modelling rates and proportions</article-title>. <source>J. Appl. Stat</source>., <volume>31</volume>, <fpage>799</fpage>–<lpage>815</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Field-Fote</surname><given-names>E.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Mediators and moderators, confounders and covariates: exploring the variables that illuminate or obscure the “active ingredients” in neurorehabilitation</article-title>. <source>J. Neurol. Phys. Therapy</source>, <volume>43</volume>, <fpage>83</fpage>–<lpage>84</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B12">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Fox</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <source>An {R} Companion to Applied Regression</source>. <publisher-name>Sage, California, USA</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vbad063-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gloor</surname><given-names>G.B.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Microbiome datasets are compositional: and this is not optional</article-title>. <source>Front. Microbiol</source>., <volume>8</volume>, <fpage>1</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">28197127</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gonçalves</surname><given-names>M.H.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Cold: an R package for the analysis of count longitudinal data</article-title>. <source>J. Stat. Soft</source>., <volume>99</volume>, <fpage>1</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B15">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hua</surname><given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) Study design: cross-sectional, longitudinal, case, and group. In: Wei, L., and Moyer, M.G. (eds) <italic toggle="yes">The Blackwell Guide to Research Methods in Bilingualism and Multilingualism</italic>, pp. <fpage>88</fpage>–<lpage>107</lpage>. Wiley Interscience/John Wiley and Sons, Hoboken, USA.</mixed-citation>
    </ref>
    <ref id="vbad063-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kodikara</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Statistical challenges in longitudinal microbiome data analysis</article-title>. <source>Brief. Bioinf</source>., <volume>23</volume>, bbac273.</mixed-citation>
    </ref>
    <ref id="vbad063-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lenth</surname><given-names>R.V.</given-names></string-name></person-group> (<year>2021</year>) <italic toggle="yes">emmeans: Estimated Marginal Means, aka Least-Squares Means</italic>. R Package Version 1.6.3., CRAN, Vienna, Austria.</mixed-citation>
    </ref>
    <ref id="vbad063-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levin</surname><given-names>K.A.</given-names></string-name></person-group> (<year>2006</year>) <article-title>Study design III: cross-sectional studies</article-title>. <source>Evid. Based Dent</source>., <volume>7</volume>, <fpage>24</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">16557257</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Analysis of microbial compositions: a review of normalization and differential abundance analysis</article-title>. <source>NPJ Biofilms Microbiomes</source>, <volume>6</volume>, <fpage>60</fpage>.<pub-id pub-id-type="pmid">33268781</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lindsey</surname><given-names>J.K.</given-names></string-name></person-group><etal>et al</etal> (<year>1998</year>) <article-title>Choosing among generalized linear models applied to medical data</article-title>. <source>Statist. Med</source>., <volume>17</volume>, <fpage>59</fpage>–<lpage>68</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>Statistical issues in longitudinal data analysis for treatment efficacy studies in the biomedical sciences</article-title>. <source>Mol. Ther</source>., <volume>18</volume>, <fpage>1724</fpage>–<lpage>1730</lpage>.<pub-id pub-id-type="pmid">20588256</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>X.</given-names></string-name></person-group> (<year>2009</year>) <article-title>Ordinal regression analysis: fitting the proportional odds model using stata, SAS and SPSS</article-title>. <source>J. Mod. App. Stat. Meth</source>., <volume>8</volume>, <fpage>632</fpage>–<lpage>642</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>A statistical model for describing and simulating microbial community profiles</article-title>. <source>PLoS Comput. Biol</source>., <volume>17</volume>, <fpage>e1008913</fpage>.<pub-id pub-id-type="pmid">34516542</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Macbeth</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>Cliff's Delta calculator: a non-parametric effect size program for two groups of observations</article-title>. <source>Univ. Psychol</source>., <volume>10</volume>, <fpage>545</fpage>–<lpage>555</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maifeld</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Fasting alters the gut microbiome reducing blood pressure and body weight in metabolic syndrome patients</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>1970</fpage>.<pub-id pub-id-type="pmid">33785752</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mallick</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Multivariable association discovery in population-scale meta-omics studies</article-title>. <source>PLoS Comput. Biol</source>., <volume>17</volume>, <fpage>e1009442</fpage>.<pub-id pub-id-type="pmid">34784344</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mandal</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Analysis of composition of microbiomes: a novel method for studying microbial composition</article-title>. <source>Microb. Ecol. Health Dis</source>., <volume>26</volume>, <fpage>27663</fpage>.<pub-id pub-id-type="pmid">26028277</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marfo</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>The accuracy of effect-size estimates under normals and contaminated normals in meta-analysis</article-title>. <source>Heliyon</source>, <volume>5</volume>, <fpage>e01838</fpage>.<pub-id pub-id-type="pmid">31211256</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKnight</surname><given-names>D.T.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Methods for normalizing microbiome data: an ecological perspective</article-title>. <source>Methods Ecol. Evol</source>., <volume>10</volume>, <fpage>389</fpage>–<lpage>400</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Metwally</surname><given-names>A.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>MetaLonDA: a flexible R package for identifying time intervals of differentially abundant features in metagenomic longitudinal studies</article-title>. <source>Microbiome</source>, <volume>6</volume>, <fpage>32</fpage>.<pub-id pub-id-type="pmid">29439731</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mulè</surname><given-names>M.P.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Normalizing and denoising protein expression data from droplet-based single cell profiling</article-title>. <source>Nat. Commun</source>., <volume>13</volume>, <fpage>2099</fpage>.<pub-id pub-id-type="pmid">35440536</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nahm</surname><given-names>F.S.</given-names></string-name></person-group> (<year>2016</year>) <article-title>Nonparametric statistical tests for the continuous data: the basic concept and the practical use</article-title>. <source>Korean J. Anesthesiol</source>., <volume>69</volume>, <fpage>8</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">26885295</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B33">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Nick</surname><given-names>T.G.</given-names></string-name></person-group><etal>et al</etal> (<year>2007</year>) <part-title>Logistic regression</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Ambrosius</surname><given-names>W.T.</given-names></string-name></person-group> (ed.) <source>Topics in Biostatistics</source>. <publisher-name>Humana Press</publisher-name>, <publisher-loc>Totowa, NJ</publisher-loc>, pp. <fpage>273</fpage>–<lpage>301</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B34">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Opgen-Rhein</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <source>Longitudinal: Analysis of Multiple Time Course Data</source>. <publisher-name>CRAN, Vienna, Austria</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vbad063-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedersen</surname><given-names>H.K.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>A computational framework to integrate high-throughput ‘-omics’ datasets for the identification of potential mechanistic links</article-title>. <source>Nat. Protoc</source>., <volume>13</volume>, <fpage>2781</fpage>–<lpage>2800</lpage>.<pub-id pub-id-type="pmid">30382244</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B36">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Pedersen</surname><given-names>T.L.</given-names></string-name></person-group> (<year>2020</year>) <source>Patchwork: The Composer of Plots</source>. <publisher-name>CRAN, Vienna, Austria</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vbad063-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peterson</surname><given-names>R.A.</given-names></string-name></person-group> (<year>2021</year>) <article-title>Finding optimal normalizing transformations via bestNormalize</article-title>. <source>R. J</source>., <volume>13</volume>, <fpage>310</fpage>–<lpage>329</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B38">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Quinn</surname><given-names>T.</given-names></string-name></person-group> (<year>2017</year>) <source>peakRAM: Monitor the Total and Peak RAM Used by an Expression or Function</source>. <publisher-name>CRAN, Vienna, Austria</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vbad063-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>M.D.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>edgeR: a bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>139</fpage>–<lpage>140</lpage>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saary</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>RTK: efficient rarefaction analysis of large datasets</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>2594</fpage>–<lpage>2595</lpage>.<pub-id pub-id-type="pmid">28398468</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sanchez-Cid</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Sequencing depth has a stronger effect than DNA extraction on soil bacterial richness discovery</article-title>. <source>Biomolecules</source>, <volume>12</volume>, <fpage>364</fpage>.<pub-id pub-id-type="pmid">35327556</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sullivan</surname><given-names>G.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>Using effect size—or why the P value is not enough</article-title>. <source>J. Grad. Med. Educ</source>., <volume>4</volume>, <fpage>279</fpage>–<lpage>282</lpage>.<pub-id pub-id-type="pmid">23997866</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Swift</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2023</year>) <article-title>A review of normalization and differential abundance methods for microbiome counts data</article-title>. <source>WIREs Comput. Stat</source>., <volume>15</volume>, <fpage>e1586</fpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tierney</surname><given-names>B.T.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Gene-level metagenomic architectures across diseases yield high-resolution microbiome diagnostic indicators</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>2907</fpage>.<pub-id pub-id-type="pmid">34006865</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Timonen</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>lgpr: an interpretable non-parametric method for inferring covariate effects from longitudinal data</article-title>. <source>Bioinformatics</source>, <volume>37</volume>, <fpage>1860</fpage>–<lpage>1867</lpage>.<pub-id pub-id-type="pmid">33471072</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B46">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Torchiano</surname><given-names>M.</given-names></string-name></person-group> (<year>2020</year>) <source>effsize: Efficient Effect Size Computation</source>. <publisher-name>CRAN, Vienna, Austria</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vbad063-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van den Boogaart</surname><given-names>K.G.</given-names></string-name></person-group><etal>et al</etal> (<year>2008</year>) <article-title>“compositions”: a unified R package to analyze compositional data</article-title>. <source>Comput. Geosci</source>., <volume>34</volume>, <fpage>320</fpage>–<lpage>338</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B48">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Venables</surname><given-names>W.N.</given-names></string-name></person-group><etal>et al</etal> (<year>2002</year>) <source>Modern Applied Statistics with S</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>New York</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="vbad063-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ver Hoef</surname><given-names>J.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2007</year>) <article-title>Quasi-Poisson vs. negative binomial regression: how should we model overdispersed count data?</article-title><source>Ecology</source>, <volume>88</volume>, <fpage>2766</fpage>–<lpage>2772</lpage>.<pub-id pub-id-type="pmid">18051645</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weiss</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Normalization and microbial differential abundance strategies depend upon data characteristics</article-title>. <source>Microbiome</source>, <volume>5</volume>, <fpage>27</fpage>.<pub-id pub-id-type="pmid">28253908</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H.</given-names></string-name></person-group> (<year>2007</year>) <article-title>Reshaping data with the reshape package</article-title>. <source>J. Stat. Soft</source>., <volume>21</volume>, <fpage>1</fpage>–<lpage>20</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Welcome to the Tidyverse</article-title>. <source>JOSS</source>, <volume>4</volume>, <fpage>1686</fpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Williams</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>microbiomeDASim: simulating longitudinal differential abundance for microbiome data</article-title>. <source>F1000Res</source>., <volume>8</volume>, <fpage>1769</fpage>.<pub-id pub-id-type="pmid">32148761</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Witten</surname><given-names>D.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>Survival analysis with high-dimensional covariates</article-title>. <source>Stat. Methods Med. Res</source>., <volume>19</volume>, <fpage>29</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">19654171</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Negative binomial mixed models for analyzing microbiome count data</article-title>. <source>BMC Bioinformatics</source>, <volume>18</volume>, <fpage>4</fpage>.<pub-id pub-id-type="pmid">28049409</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10284677</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad063</article-id>
    <article-id pub-id-type="publisher-id">vbad063</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Article</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Software</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LongDat: an R package for covariate-sensitive longitudinal analysis of high-dimensional data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1765-7132</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Chia-Yu</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="http://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="lead">Formal analysis</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="lead">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="http://credit.niso.org/contributor-roles/project-administration" degree-contribution="lead">Project administration</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="lead">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="lead">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="lead">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Max-Delbrück-Center for Molecular Medicine in the Helmholtz Association (MDC)</institution>, Berlin 13125, <country country="DE">Germany</country></aff>
        <aff><institution>Experimental and Clinical Research Center, A Cooperation between the Max-Delbrück-Center for Molecular Medicine in the Helmholtz Association and the Charité – Universitätsmedizin Berlin</institution>, Berlin 13125, <country country="DE">Germany</country></aff>
        <aff><institution>Charité - Universitätsmedizin Berlin, Corporate Member of Freie Universität Berlin and Humboldt-Universität zu Berlin</institution>, Berlin 10117, <country country="DE">Germany</country></aff>
        <aff><institution>DZHK (German Centre for Cardiovascular Research), partner site Berlin</institution>, Berlin 10785, <country country="DE">Germany</country></aff>
        <xref rid="vbad063-cor1" ref-type="corresp"/>
        <!--Chia-Yu.Chen@mdc-berlin.de-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7468-9531</contrib-id>
        <name>
          <surname>Löber</surname>
          <given-names>Ulrike</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/conceptualization" degree-contribution="supporting">Conceptualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="http://credit.niso.org/contributor-roles/supervision" degree-contribution="supporting">Supervision</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Max-Delbrück-Center for Molecular Medicine in the Helmholtz Association (MDC)</institution>, Berlin 13125, <country country="DE">Germany</country></aff>
        <aff><institution>Experimental and Clinical Research Center, A Cooperation between the Max-Delbrück-Center for Molecular Medicine in the Helmholtz Association and the Charité – Universitätsmedizin Berlin</institution>, Berlin 13125, <country country="DE">Germany</country></aff>
        <aff><institution>Charité - Universitätsmedizin Berlin, Corporate Member of Freie Universität Berlin and Humboldt-Universität zu Berlin</institution>, Berlin 10117, <country country="DE">Germany</country></aff>
        <aff><institution>DZHK (German Centre for Cardiovascular Research), partner site Berlin</institution>, Berlin 10785, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Forslund</surname>
          <given-names>Sofia K</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="http://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="supporting">Formal analysis</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="http://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="http://credit.niso.org/contributor-roles/investigation" degree-contribution="supporting">Investigation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="http://credit.niso.org/contributor-roles/project-administration" degree-contribution="supporting">Project administration</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="lead">Resources</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="http://credit.niso.org/contributor-roles/supervision" degree-contribution="lead">Supervision</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="supporting">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="supporting">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="supporting">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Max-Delbrück-Center for Molecular Medicine in the Helmholtz Association (MDC)</institution>, Berlin 13125, <country country="DE">Germany</country></aff>
        <aff><institution>Experimental and Clinical Research Center, A Cooperation between the Max-Delbrück-Center for Molecular Medicine in the Helmholtz Association and the Charité – Universitätsmedizin Berlin</institution>, Berlin 13125, <country country="DE">Germany</country></aff>
        <aff><institution>Charité - Universitätsmedizin Berlin, Corporate Member of Freie Universität Berlin and Humboldt-Universität zu Berlin</institution>, Berlin 10117, <country country="DE">Germany</country></aff>
        <aff><institution>DZHK (German Centre for Cardiovascular Research), partner site Berlin</institution>, Berlin 10785, <country country="DE">Germany</country></aff>
        <aff><institution>Structural and Computational Biology Unit, European Molecular Biology Laboratory</institution>, Heidelberg 69117, <country country="DE">Germany</country></aff>
        <xref rid="vbad063-cor1" ref-type="corresp"/>
        <!--Sofia.Forslund@mdc-berlin.de-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kuijjer</surname>
          <given-names>Marieke</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad063-cor1">To whom correspondence should be addressed. <email>chia-yu.chen@mdc-berlin.de</email> or <email>sofia.forslund@mdc-berlin.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-05-18">
      <day>18</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad063</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>15</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>30</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>21</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad063.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>We introduce LongDat, an R package that analyzes longitudinal multivariable (cohort) data while simultaneously accounting for a potentially large number of covariates. The primary use case is to differentiate direct from indirect effects of an intervention (or treatment) and to identify covariates (potential mechanistic intermediates) in longitudinal data. LongDat focuses on analyzing longitudinal microbiome data, but its usage can be expanded to other data types, such as binary, categorical and continuous data. We tested and compared LongDat with other tools (i.e. MaAsLin2, ANCOM, lgpr and ZIBR) on both simulated and real data. We showed that LongDat outperformed these tools in accuracy, runtime and memory cost, especially when there were multiple covariates. The results indicate that the LongDat R package is a computationally efficient and low-memory-cost tool for longitudinal data with multiple covariates and facilitates robust biomarker searches in high-dimensional datasets.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The R package LongDat is available on CRAN (<ext-link xlink:href="https://cran.r-project.org/web/packages/LongDat/" ext-link-type="uri">https://cran.r-project.org/web/packages/LongDat/</ext-link>) and GitHub (<ext-link xlink:href="https://github.com/CCY-dev/LongDat" ext-link-type="uri">https://github.com/CCY-dev/LongDat</ext-link>).</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>German Research Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001659</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>German Federal Ministry of Education and Research</institution>
          </institution-wrap>
        </funding-source>
        <award-id>01KI1909B</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Recent years have seen the spawning of high-dimensional data (i.e. data with a large number of features) as biotechnology develops rapidly (<xref rid="vbad063-B2" ref-type="bibr">Assent, 2012</xref>; <xref rid="vbad063-B54" ref-type="bibr">Witten <italic toggle="yes">et al.</italic>, 2010</xref>). For instance, metabolomics, immunomics and metagenomics are becoming prevalent. Among them, count data derived from microbial metagenomics sequencing especially require specific methods to tackle since they have several inherent properties, including uneven sequencing depth across samples, compositional structure, overdispersion and high sparsity (<xref rid="vbad063-B16" ref-type="bibr">Kodikara <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="vbad063-B55" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2017</xref>). When the research aim is to find out the differences in the abundance of microbial features between groups (e.g. time points, treatments), a typical workflow consists of pre-processing and differential abundance analysis steps. Uneven sequencing depth in metagenomic shotgun sequencing needs to be addressed at the pre-processing step because it is known to cause bias in evaluating microbial communities (<xref rid="vbad063-B41" ref-type="bibr">Sanchez-Cid <italic toggle="yes">et al.</italic>, 2022</xref>). Therefore, data-preprocessing approaches such as normalization, transformation and rarefaction have been developed to deal with varying sequencing depth (<xref rid="vbad063-B19" ref-type="bibr">Lin <italic toggle="yes">et al.</italic>, 2020</xref>). When it comes to differential abundance analysis, we need to consider the typical characteristics of microbiome data, including () compositional structure, (ii) overdispersion and (iii) high sparsity. Microbial data from shotgun sequencing are inherently compositional since the total amount of reads each sequencing run can generate is fixed. Thus the abundances of features are not independent of each other (<xref rid="vbad063-B13" ref-type="bibr">Gloor <italic toggle="yes">et al.</italic>, 2017</xref>). Tools have been proposed to account for the compositional structure (<xref rid="vbad063-B27" ref-type="bibr">Mandal <italic toggle="yes">et al.</italic>, 2015</xref>). However, some literature shows that the compositional methods do not always outperform the non-compositional methods (<xref rid="vbad063-B26" ref-type="bibr">Mallick <italic toggle="yes">et al.</italic>, 2021</xref>). Overdispersion denotes a larger variability observed in data than expected from a specific distribution, while high sparsity implies that the data are inflated with zeros. When fitting models to the microbiome data, overdispersion and high sparsity should be addressed. For example, models like negative binomial regression and zero-inflated Poisson regression have been introduced to solve overdispersion and high-sparsity problems (<xref rid="vbad063-B26" ref-type="bibr">Mallick <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad063-B55" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2017</xref>). Collectively, many different microbiome data analysis methods have been proposed so far, and there are plentiful reviews on their comparisons (<xref rid="vbad063-B7" ref-type="bibr">Calgaro <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="vbad063-B43" ref-type="bibr">Swift <italic toggle="yes">et al.</italic>, 2023</xref>; <xref rid="vbad063-B50" ref-type="bibr">Weiss <italic toggle="yes">et al.</italic>, 2017</xref>). However, there is no universal method for analyzing all types of microbiome data. Hence, it depends on the characteristics of the data and the user’s research aim to opt for an appropriate method in different scenarios.</p>
    <p>Microbiome data can be divided into cross-sectional and longitudinal based on its study design. Cross-sectional data are collected by examining multiple subjects at one time point (<xref rid="vbad063-B18" ref-type="bibr">Levin, 2006</xref>). In contrast, longitudinal data from observational or intervention cohorts are repeated measurements from the same individuals at different time points (<xref rid="vbad063-B21" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2010</xref>). Compared with cross-sectional studies, longitudinal studies account for individual variation and enable researchers to trace changes over time (<xref rid="vbad063-B15" ref-type="bibr">Hua <italic toggle="yes">et al.</italic>, 2009</xref>). Thus, longitudinal data collection has become more common in biological and medical fields nowadays (<xref rid="vbad063-B21" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2010</xref>). When fitting models to longitudinal microbiome data, microbiome features are the dependent variables, while the metadata (i.e. information about the individuals) are the independent variables. The metadata may include the time variable and other variables, such as dietary supplements, changes in meals and weight. The aim of longitudinal microbiome data analysis is to investigate the effect of the time variable since it is the proxy for treatment or intervention in longitudinal data. Accordingly, all variables in the metadata except for the time variables are referred to as covariates, which are defined as the factors other than the variable we are interested in (here the time variable) that might associate with the outcome (here microbiome features) (<xref rid="vbad063-B11" ref-type="bibr">Field-Fote, 2019</xref>). Examples of covariates include, for example, how patients benefiting from a dietary intervention (coded as a time variable) may have their medication dosages reduced during the course of a trial, raising the question of whether observed -omics signature changes are direct effects of the intervention or indirect effects following from the alteration of medication regime (<xref rid="vbad063-B25" ref-type="bibr">Maifeld <italic toggle="yes">et al.</italic>, 2021</xref>). Consequently, to ensure proper analyses of longitudinal microbiome data, it is important to disentangle the time variable's effects from the covariates' effects. In other words, covariates should be uncovered and controlled for to avoid false conclusions (<xref rid="vbad063-B35" ref-type="bibr">Pedersen <italic toggle="yes">et al.</italic>, 2018</xref>). In addition, two other critical points need to be considered when analyzing longitudinal microbiome data. First, selecting appropriate statistical tests from empirical data distributions is important for obtaining proper interpretations (<xref rid="vbad063-B32" ref-type="bibr">Nahm, 2016</xref>). Second, inter-individual variation (e.g. differences in microbial abundance levels between individuals) should be addressed. Several tools dealing with longitudinal microbiome data already exist, and some allow taking in covariates for analysis (<xref rid="vbad063-B1" ref-type="bibr">Asar <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="vbad063-B8" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="vbad063-B14" ref-type="bibr">Gonçalves <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad063-B26" ref-type="bibr">Mallick <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad063-B27" ref-type="bibr">Mandal <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="vbad063-B34" ref-type="bibr">Opgen-Rhein <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad063-B45" ref-type="bibr">Timonen <italic toggle="yes">et al.</italic>, 2021</xref>). Nevertheless, none of these tools reports explicitly on how the effect of time variable is affected by the presence of other covariates while detecting and simultaneously controlling for them. Therefore, we developed LongDat, an R package capable of performing the tasks as described above.</p>
    <p>LongDat is developed and tested centered on microbiome data. However, we extended its utility to work on different data types (e.g. immunome, metabolome, transcriptome). The key to LongDat’s flexibility to adapt to input data with different statistical distributions lies in the utilization of generalized linear models (GLMs) and non-parametric effect size calculations in the pipeline. GLMs can fit skewed data (e.g. data with overdispersion and high sparsity), allow non-constant variances (heteroscedasticity) and model various data types, such as continuous, categorical and ordinal data (<xref rid="vbad063-B20" ref-type="bibr">Lindsey <italic toggle="yes">et al.</italic>, 1998</xref>). To account for inter-individual variation in longitudinal data, we treat sample donor origin (i.e. individual) as a random effect, expanding the GLMs framework to the generalized linear mixed models (GLMMs) (<xref rid="vbad063-B5" ref-type="bibr">Bolker <italic toggle="yes">et al.</italic>, 2009</xref>). LongDat utilizes GLMMs to test the significance of the time variable without and with the presence of covariates in the models, respectively. Subsequently, the effect size of the time variable on each microbiome feature is calculated. In a longitudinal setting, an effect size is defined as the degree of feature difference before and after treatment. Reporting effect sizes in the result is in line with the current best practice, which urges researchers to report effect sizes along with <italic toggle="yes">P</italic>-values in biomedical research (<xref rid="vbad063-B42" ref-type="bibr">Sullivan <italic toggle="yes">et al.</italic>, 2012</xref>). <italic toggle="yes">P</italic>-values from the abovementioned model tests indicate the statistical significance of the time variable (proxy of treatments), whereas standardized and directional effect sizes allow users to interpret the magnitude of effects both manually and within automated frameworks. In the LongDat pipeline, directional non-parametric effect sizes (e.g. Spearman’s rho and Cliff’s delta) are applied to handle both normally and non-normally distributed data (<xref rid="vbad063-B28" ref-type="bibr">Marfo <italic toggle="yes">et al.</italic>, 2019</xref>). LongDat focuses on analyzing monotonic (i.e. the direction of change is fixed) treatment effects within time intervals while reporting covariates for each feature.</p>
    <p>In this report, we describe the method of the LongDat R package and validate its performance by comparing it with its closest published counterpart to date, MaAsLin2 (<xref rid="vbad063-B26" ref-type="bibr">Mallick <italic toggle="yes">et al.</italic>, 2021</xref>). We tested the performance of LongDat and MaAsLin2 on simulated, semi-synthetic and real microbiome data. MaAsLin2 is an R package similar to LongDat in several aspects. They both focus on microbiome analysis, adopt GLMMs and allow covariates to be included in the models. The main difference between MaAsLin2 and LongDat is that MaAsLin2 does not explicitly report how the effect of the time variable is affected by the presence of other covariates. In addition, the ways of treating covariates in the two tools differ. MaAsLin2 takes in all covariates along with the time variable into a model at once, while LongDat loops over each covariate in parallel models (see Methods). This distinction leads to significant differences in the results of analyzing longitudinal microbiome data with many covariates, making LongDat more suitable when there are multiple covariates (see Results). Aside from MaAsLin2, we also compared LongDat with other R packages which allow covariates to be included in the analysis, namely ANCOM (<xref rid="vbad063-B27" ref-type="bibr">Mandal <italic toggle="yes">et al.</italic>, 2015</xref>), lgpr (<xref rid="vbad063-B45" ref-type="bibr">Timonen <italic toggle="yes">et al.</italic>, 2021</xref>) and ZIBR (<xref rid="vbad063-B8" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2016</xref>). ANCOM is a microbiome-oriented tool that utilizes the compositional method. Lgpr uses additive Gaussian process regression (a Bayesian method) to achieve non-parametric modeling of longitudinal data. ZIBR incorporates logistic models and zero-inflated Beta regressions with random effects to test the effect of time on microbiome features. Since normalization and rarefaction of the microbial count data might induce considerable changes to the analysis result, we compared the performances of these tools when different normalization or rarefaction techniques were applied, including total-sum scaling (TSS), cumulative-sum scaling (CSS), trimmed mean of M-values (TMM), geometric mean of pairwise ratios (GMPR), centered log-ratio (CLR), rarefaction (<xref rid="vbad063-B9" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbad063-B29" ref-type="bibr">McKnight <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="vbad063-B31" ref-type="bibr">Mulè <italic toggle="yes">et al.</italic>, 2022</xref>). TSS divides absolute abundance by the total sum of read depth and converts it into relative abundance ranging between 0 and 1. CSS is a quantile normalization method that addresses the bias arising from TSS. The purpose of TMM is to tackle the problem of composition bias and calculate normalization factors that aid in comparing different libraries. GMPR computes the ratio between each pair of values and then takes the geometric mean of those ratios to normalize data. CLR transformation, commonly used for compositional data analysis, takes the logarithm of the ratios of each component to the geometric mean of all components, and then centers the resulting values around zero. Lastly, rarefaction randomly subsamples the data to obtain an equivalent sequencing depth across all samples. Altogether, we assessed how these tools performed with various normalization or rarefaction techniques.</p>
    <p>The real microbiome data used in this study for comparison are from our previous study, which reported on a clinical cohort investigating fasting effects on patients with metabolic syndrome (MetS) (<xref rid="vbad063-B25" ref-type="bibr">Maifeld <italic toggle="yes">et al.</italic>, 2021</xref>). By reanalyzing this dataset in which MetS patients benefit from a dietary intervention while medication dosages were altered subsequently during the trial course as an indirect effect following improved health, we demonstrated the need to resolve the time variable (proxy of dietary intervention) and covariate effects in real data. The research question is whether the beneficial outcome is a direct effect of the intervention or an indirect effect following the alteration of the medication regimen. Below we show that LongDat could disentangle the intervention’s beneficial direct effect from the indirect effect of the changes in drug dosage. Finally, to demonstrate LongDat’s flexibility to deal with other datatypes besides microbiome data, we also applied LongDat to the immunome data in the study described above.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 The LongDat method</title>
      <p>The LongDat pipeline comprises three major steps, namely the null time model test, covariate model test and effect size calculation (<xref rid="vbad063-F1" ref-type="fig">Fig. 1</xref>).</p>
      <fig position="float" id="vbad063-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>LongDat pipeline overview. Flowchart of LongDat showing the major functions (bold text in red) and steps. The function ‘make_master_table()’ creates a master table that can be taken as input by joining metadata and feature tables provided by the user. The two functions ‘longdat_disc()’ and ‘longdat_cont()’ both perform covariate-sensitive analyses. The main components of them are the null time model test, the effect size calculation and the covariate model test, applied to input master tables to perform covariate-aware tests for the significance of the time variable (the proxy of treatment). The function ‘longdat_disc()’ is suitable for data where time is discrete (e.g. a before/after treatment dataset), whereas ‘longdat_cont()’ is for data with time represented as a continuous variable (e.g. day). Finally, the function ‘cuneiform_plot()’ generates a summarizing plot of the result table. For more detailed tutorials of LongDat application, please visit GitHub (<ext-link xlink:href="https://github.com/CCY-dev/LongDat" ext-link-type="uri">https://github.com/CCY-dev/LongDat</ext-link>), or refer to its vignettes</p>
        </caption>
        <graphic xlink:href="vbad063f1" position="float"/>
      </fig>
      <list list-type="order">
        <list-item>
          <p><italic toggle="yes">Null time model test.</italic> We test whether time associates significantly with each feature (dependent variable), regardless of covariates. LongDat incorporates several R packages specializing in GLMMs, such as MASS, lme4 and glmmTMB (<xref rid="vbad063-B3" ref-type="bibr">Bates <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="vbad063-B6" ref-type="bibr">Brooks <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="vbad063-B48" ref-type="bibr">Venables <italic toggle="yes">et al.</italic>, 2002</xref>), providing high flexibility for input data types. A negative binomial model is used to fit count data composed of integers (<xref rid="vbad063-B49" ref-type="bibr">Ver Hoef <italic toggle="yes">et al.</italic>, 2007</xref>), such as numbers of sequencing reads. A beta model is applied to proportion data (i.e. that range between 0 and 1) (<xref rid="vbad063-B10" ref-type="bibr">Ferrari <italic toggle="yes">et al.</italic>, 2004</xref>). For binary data (consisting of either 0 or 1), binary logistic regression is performed (<xref rid="vbad063-B33" ref-type="bibr">Nick <italic toggle="yes">et al.</italic>, 2007</xref>). For ordinal data (where the features correspond to ranks), a proportional odds model is adopted (<xref rid="vbad063-B22" ref-type="bibr">Liu, 2009</xref>). Finally, continuous data are first normalized and then fitted by linear models. Each model is a random intercept model with the sample donor origin treated as a random factor to account for between-individual variability and non-independence of samples from the same donor. <italic toggle="yes">P</italic>-values are adjusted for multiple testing using the Benjamini-Hochberg method or other approaches (<xref rid="vbad063-B4" ref-type="bibr">Benjamini <italic toggle="yes">et al.</italic>, 1995</xref>).</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Covariate model test.</italic> If covariates are present in a dataset, this step identifies them and disentangles their effects from those of variables of interest (here, the time variable). In the metadata, covariates that exhibit significant association with each feature (e.g. microbiome abundance) via non-parametric tests (i.e. the Wilcoxon rank-sum, Kruskal-Wallis or Spearman’s correlation test) are selected. And then, each selected covariate is included one by one as a fixed effect, together with the time variable, in GLMMs to examine whether or not the time associations can be reduced to the influence of each covariate, reflecting the ‘vibration of effects’ (VoE) concept (<xref rid="vbad063-B44" ref-type="bibr">Tierney <italic toggle="yes">et al.</italic>, 2021</xref>). VoE is the degree to which different combinations of independent variables (e.g. adding covariates) change the outcome and assessed significance of a model. The larger the VoE, the less robust the association is between features and independent variables. That is, a true association should remain significant across all model configurations. Significant time-dependent features are subsequently classified as fulfilling conditions of ‘effect not reducible to covariate’, ‘entangled with covariate’ or ‘effect reducible to covariate’ according to these model tests. If the time variable remains a significant predictor in all models, the feature will be flagged as ‘effect not reducible to covariate’. If the time variable loses significance but the covariate does show significance in any of the models, the feature is marked as ‘effect reducible to covariate’. If there is no clear covariate but at least one model in which the covariate and time both failed to show significance, the feature will be labeled ‘entangled with covariate’.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Effect size calculation.</italic> Non-parametric effect size calculations are implemented. These are Spearman correlation for continuous time variables (e.g. day) and Cliff’s delta for discrete time variables (e.g. before/after treatment) (<xref rid="vbad063-B24" ref-type="bibr">Macbeth <italic toggle="yes">et al.</italic>, 2010</xref>). Effect size calculation is based on a naïve association between the independent variable and the feature, without being partitioned by covariates. Therefore, to ensure LongDat calculates the correct effect size, treatment effects should be monotonic (i.e. no change in the direction of association) within the time interval of the input data. If this is not the case, analyses should be done separately on time subranges of the data for which monotony holds.</p>
        </list-item>
      </list>
      <p>All results of the steps mentioned above are summarized into two tables. One table lists the significance estimate (<italic toggle="yes">q</italic>-values adjusted for multiple testing) of time dependence and effect sizes across all features. The other table lists relevant covariates with relative reducibility status for each of them.</p>
    </sec>
    <sec>
      <title>2.2 LongDat package overview</title>
      <p>LongDat is built with R (≥4.0.0), and its dependencies include lme4 (≥1.1-28) (<xref rid="vbad063-B3" ref-type="bibr">Bates <italic toggle="yes">et al.</italic>, 2015</xref>), glmmTMB (≥1.1.3) (<xref rid="vbad063-B6" ref-type="bibr">Brooks <italic toggle="yes">et al.</italic>, 2017</xref>), reshape2 (≥1.4.4) (<xref rid="vbad063-B51" ref-type="bibr">Wickham, 2007</xref>), emmeans (≥1.7.3) (<xref rid="vbad063-B17" ref-type="bibr">Lenth, 2021</xref>), bestNormalize (≥1.8.2) (<xref rid="vbad063-B37" ref-type="bibr">Peterson, 2021</xref>), MASS (≥7.3-56) (<xref rid="vbad063-B48" ref-type="bibr">Venables <italic toggle="yes">et al.</italic>, 2002</xref>), tidyverse (≥1.3.1) (<xref rid="vbad063-B52" ref-type="bibr">Wickham <italic toggle="yes">et al.</italic>, 2019</xref>), effsize (≥0.8.1) (<xref rid="vbad063-B46" ref-type="bibr">Torchiano, 2020</xref>), patchwork (≥1.1.1) (<xref rid="vbad063-B36" ref-type="bibr">Pedersen, 2020</xref>) and car (≥3.0-12) (<xref rid="vbad063-B12" ref-type="bibr">Fox <italic toggle="yes">et al.</italic>, 2019</xref>). There are four main functions that are the most relevant to users of the LongDat package (<xref rid="vbad063-F1" ref-type="fig">Fig. 1</xref>). For more detailed tutorials for LongDat, please visit GitHub (<ext-link xlink:href="https://github.com/CCY-dev/LongDat" ext-link-type="uri">https://github.com/CCY-dev/LongDat</ext-link>), or install LongDat and then access its vignettes with the command <bold>‘</bold>browseVignettes(“LongDat”)’.</p>
    </sec>
    <sec>
      <title>2.3 Simulation of longitudinal data with microbiomeDASim</title>
      <p>Longitudinal data corresponding to microbiome taxonomic abundance measurements from a cohort were simulated using microbiomeDASim (<xref rid="vbad063-B53" ref-type="bibr">Williams <italic toggle="yes">et al.</italic>, 2019</xref>). MicrobiomeDASim is an R package aimed at simulating longitudinal differential microbiome data. It allows the users to define sparsity, effect size, number of samples and time points. Here, simulated data were generated from a multivariate normal distribution, and the parameter encoding the longitudinal dependency within individuals was a first-order autoregressive correlation structure.</p>
      <list list-type="order">
        <list-item>
          <p><italic toggle="yes">Simulated data with no covariate.</italic> For each sample size (10, 20, 38, 75, 150 and 300) and effect size (Spearman’s rho median ≈ 0.2 or 0.5 for time-varying features) combination, 100 simulations were performed. Each simulated dataset contained 200 features. Among them, 20 features changed over time/under intervention, while the remaining 180 were sampled from the same distribution across time points. Two time points were simulated for each individual.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Simulated data with a single covariate for covariate effect analysis.</italic> A dummy variable correlating with the time variable was manually added to the aforementioned simulated dataset (sample size = 75, effect size median ≈ 0.5). The dummy variable was sampled to correlate with the time variable at a Spearman’s rho of approximately 0.25, 0.5, 0.75 or 0.99. For each correlation level, 100 simulations were performed. For the negative-control data, we shuffled the time variable against all other variables randomly within each individual to wipe out the association between the time variable and the features, and the association between the time variable and the covariates.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Simulated data with multiple covariates.</italic> 1, 2, 4, 8 or 16 dummy variables correlating with the time variable were manually added to the abovementioned simulated dataset (sample size = 75, effect size median ≈ 0.5). The dummy variables were randomly sampled to correlate with the time variable at a Spearman’s rho of approximately 0.25, 0.5, 0.75 or 0.99. For each correlation level, 100 simulations were performed. For the comparison between LongDat and Maaslin2, each dataset contained 200 features (20 changed over time and 180 did not), and for each combination of sample size, effect size and tool, 100 simulations were performed. For the comparison between LongDat, ANCOM, lpgr and ZIBR, each dataset contained 100 features (10 changed over time and 90 did not), and 50 simulations were performed for each combination of sample size, effect size and tool. The reduction of feature number and simulation number was due to the heavy computational resource ANCOM (large memory), lgpr (long runtime) and ZIBR (long runtime) required.</p>
        </list-item>
      </list>
    </sec>
    <sec>
      <title>2.4 Simulation of longitudinal data with SparseDOSSA2</title>
      <p>Besides microbiomeDASim, another set of longitudinal microbial data was simulated using SparseDOSSA2 (<xref rid="vbad063-B23" ref-type="bibr">Ma <italic toggle="yes">et al.</italic>, 2021</xref>). SparseDOSSA2 is an R package specialized for simulating realistic new microbiome data templated on real microbial communities. In these longitudinal data simulations, SparseDOSSA2 adopts generalized linear models to create feature-covariate associations (here, the time variable and other covariates) specified by users, and the template was based on stool microbiome. We followed the tutorial of SparseDOSSA2 (<ext-link xlink:href="https://github.com/biobakery/biobakery/wiki/SparseDOSSA2" ext-link-type="uri">https://github.com/biobakery/biobakery/wiki/SparseDOSSA2</ext-link>) as a complementary approach to the above to simulate longitudinal microbial data for benchmarking.</p>
      <list list-type="order">
        <list-item>
          <p><italic toggle="yes">Simulated data with no covariate.</italic> For each sample size (10, 20, 38, 75, 150 and 300) and effect size (Spearman’s rho median ≈ 0.2 or 0.5 for time-varying features) combination, 100 simulations were performed. Each simulated dataset contained 332 features. Among them, 33 features were spiked (changed over time/under intervention), while the remaining ones were sampled from the same distribution across time points. Two time points were simulated for each individual.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Simulated data with multiple covariates.</italic> 1, 4 or 16 dummy variables correlating with the time variable were manually added to the abovementioned simulated dataset with 332 features and varying sample sizes. The dummy variables were randomly sampled to correlate with the time variable at a Spearman’s rho of approximately 0.25, 0.5, 0.75 or 0.99. For each correlation level, 100 simulations were performed.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Simulated negative control data.</italic> Simulations were done to generate 100 sets of data with two time points, 150 individuals, 332 microbes and zero effect size for all microbial features (i.e. no spiked feature). Six versions of the data with different sequencing depths (the sum of microbial abundance of each feature) were further generated, to test the impact of systematic effects on sampling depth as may occur, for example, in clinical low biomass datasets. Accordingly, for these simulated data, any signal detected will reflect such systematic bias only. In versions one and two of the simulation, both of the total abundances at the first and second time points of each individual were rarefied to 50 000 and 1000, respectively. In version three, the total abundances at the first time point were rarefied to 50 000 and the second time point to 5000, while in version four, the total abundances at the first time point were rarefied to 5000 and the second time point to 50 000. In version five, the total abundances at the first time point were rarefied to 50 000 and the second time point to 1000, while in version six, the total abundances at the first time point were rarefied to 1000 and the second time point to 50 000. When applying LongDat count mode (running negative binomial models), versions three to six were further rarefied to either 5000 or 1000 (as per the lowest sequencing depth) at both time points, such that the sequencing depths are the same between the two time points, reflecting how a user concerned over unequal sampling depths would preprocess the data for this method.</p>
        </list-item>
      </list>
    </sec>
    <sec>
      <title>2.5 Normalization of the data simulated by SparseDOSSA2</title>
      <p>Several R packages were used to normalize or transform the raw simulated microbial features from SparseDOSSA2, TSS, rarefaction (<xref rid="vbad063-B40" ref-type="bibr">Saary <italic toggle="yes">et al.</italic>, 2017</xref>), CLR (<xref rid="vbad063-B47" ref-type="bibr">van den Boogaart <italic toggle="yes">et al.</italic>, 2008</xref>), GMPR (<xref rid="vbad063-B9" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2018</xref>), TMM (<xref rid="vbad063-B39" ref-type="bibr">Robinson <italic toggle="yes">et al.</italic>, 2010</xref>) and CSS (<xref rid="vbad063-B30" ref-type="bibr">Metwally <italic toggle="yes">et al.</italic>, 2018</xref>). The combinations of the tools (LongDat, MaAsLin2, lgpr, ZIBR) and the normalization methods are limited by each tool’s requirement of the input format.</p>
    </sec>
    <sec>
      <title>2.6 Running LongDat on simulated longitudinal data</title>
      <p>The function ‘longdat_cont()’ in the LongDat package was used for analyzing simulated longitudinal data, where the time between samplings was treated as a continuous variable and the data type as count data. The R package peakRAM was adopted to record running time and memory usage (<xref rid="vbad063-B38" ref-type="bibr">Quinn, 2017</xref>). Feature associations with Benjamini-Hochberg (BH)-corrected null-model <italic toggle="yes">q</italic>-value &lt; 0.1 and BH-corrected post-hoc test <italic toggle="yes">q</italic>-values &lt; 0.05 were considered significant. LongDat was run under CentOS Linux 7 and R version 4.1.1 with 8 GB of memory allocated.</p>
    </sec>
    <sec>
      <title>2.7 Running MaAsLin2 on simulated longitudinal data</title>
      <p>The function ‘Maaslin2()’ in the MaAsLin2 package was used for analyzing simulated longitudinal data, where the time between samplings was treated as a continuous variable, and the mode was set as ‘NEGBIN’ for negative binomial model mode and ‘LM’ for linear model mode (<xref rid="vbad063-B26" ref-type="bibr">Mallick <italic toggle="yes">et al.</italic> 2021</xref>). Since MaAsLin2 lacks a covariate model test component that corresponds to the second part of the LongDat pipeline, we ran MaAsLin2 with two separate runs (with and without simulated covariate included as a fixed effect, respectively) for each simulated data with covariates, such that the MaAsLin2 result is comparable with that of LongDat. Features with BH-corrected <italic toggle="yes">q</italic>-value &lt; 0.1 were considered significant. MaAsLin2 was run under CentOS Linux 7 and R version 4.1.1 with 8 GB of memory allocated.</p>
    </sec>
    <sec>
      <title>2.8 Running ANCOM on simulated longitudinal data</title>
      <p>The function ANCOM in the ancom. R Rscript (<ext-link xlink:href="https://github.com/FrederickHuangLin/ANCOM-Code-Archive" ext-link-type="uri">https://github.com/FrederickHuangLin/ANCOM-Code-Archive</ext-link>) was used for analyzing simulated longitudinal data. The time between samplings was treated as a factor, while the random formula was set as sample ID, and the adjust formula included all the present covariates. Features were considered significant if their W statistics passed the cutoff of the number of taxa multiplied by 0.7. ANCOM was run under CentOS Linux 7 and R version 4.1.1 with 350 GB of memory allocated.</p>
    </sec>
    <sec>
      <title>2.9 Running ZIBR on simulated longitudinal data</title>
      <p>The function ‘zibr()’ in the ZIBR package (<xref rid="vbad063-B8" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2016</xref>) was used for analyzing simulated longitudinal data, where the time between samplings was treated as a continuous variable. All covariates in the data were included for analyses, while subjects and time points were specified. Features with joint <italic toggle="yes">P</italic> values corrected by BH &lt; 0.1 were considered significant. ZIBR was run under CentOS Linux 7 and R version 4.1.1 with 8 GB of memory allocated.</p>
    </sec>
    <sec>
      <title>2.10 Running lgpr on simulated longitudinal data</title>
      <p>The function ‘lgp()’ in the lgpr package (<xref rid="vbad063-B45" ref-type="bibr">Timonen <italic toggle="yes">et al.</italic>, 2021</xref>) was used for analyzing simulated longitudinal data, where the time between samplings was treated as a continuous variable. Sample ID was set as the random effect, and all covariates in the data were included for analyses. The number of drawing samples from a Stan model was 100, and the number of Markov chains was 4. If the time variable was selected using a 95% threshold for the proportion of total explained variance, then the feature was considered significant. Lgpr was run under CentOS Linux 7 and R version 4.1.1 with 8 GB of memory allocated.</p>
    </sec>
    <sec>
      <title>2.11 Semi-synthetic evaluation of metagenomic data: Fasting study</title>
      <p>To perform a semi-synthetic evaluation based on real microbiome data, we selected the first and second time points from the stool microbiome data, using bacterial genus abundances. Next, we randomly shuffled the time variable against all other variables for each individual to eliminate any associations between the time variable and the microbes, as well as between the time variable and the covariates, such that no real signal of the intervention or of the passage of time should remain. Data were normalized or rarefied as the methods in the ‘normalization of the data simulated by SparseDOSSA2’ section.</p>
    </sec>
    <sec>
      <title>2.12 Evaluation of real metagenomic and immunome data: Fasting study</title>
      <p>The fasting study reanalyzed here reported on a clinical cohort investigating fasting effects on patients with MetS (<xref rid="vbad063-B25" ref-type="bibr">Maifeld <italic toggle="yes">et al.</italic>, 2021</xref>). This study has two arms, one being the fasting arm and the other being the DASH (Dietary Approaches to Stop Hypertension, DASH) arm. MetS patients in the fasting arm first underwent seven-day fasting, which consists of two days in which the patients took in a maximum of 1200 kcal/day and five days in which the patients took in 300–350 kcal/day. And then, there was a three-month re-feeding stage where MetS patients were asked to follow the DASH diet. Microbial abundance at the species level and the immunome data of the fasting arm were reanalyzed to demonstrate the value and performance of LongDat.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 LongDat outperforms MaAsLin2 when there are multiple covariates in the simulated data</title>
      <p>First, we compared the performance of LongDat with its closest counterpart up to date, MaAsLin2, by running them on microbiomeDASim-simulated longitudinal datasets templated on microbiome data from cohort studies without covariates. The default setting of MaAsLin2 was doing total-sum scaling (TSS) that converted the data into relative abundance and then fitting linear model (LM). However, this default setting performs worse than using the negative binomial model in terms of accuracy, true positive rate (TPR), false discovery rate (FDR) and Matthews correlation coefficient (MCC) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). Therefore, we focused on the MaAsLin2 negative binomial model mode results instead of its default setting. Both LongDat and MaAsLin2 use negative binomial models to fit the data. LongDat and MaAsLin2 have comparable accuracy ranging between 0.9 and 1 (<xref rid="vbad063-F2" ref-type="fig">Fig. 2</xref>). While MaAsLin2 achieves a higher TPR when sample sizes are small, this comes at the cost of a higher FDR. In contrast, the FDR median of LongDat was controlled at zero across all tested effects and sample sizes, while TPR increases with sample size (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). LongDat and MaAsLin2 have comparable memory footprints, whereas LongDat has a longer runtime (<xref rid="vbad063-F3" ref-type="fig">Fig. 3A</xref> and <xref rid="vbad063-F3" ref-type="fig">B</xref>) due to the additional covariate model test, which MaAsLin2 does not possess. Although MaAsLin2 and LongDat perform similarly on simulated data without covariates, their difference in performance rises as the number of covariates increases in the simulated data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S3A, B, S4A</xref> and <xref rid="sup1" ref-type="supplementary-material">B</xref>). The performance of LongDat remains stable across all numbers of covariates. In contrast, FDR escalates and TPR diminishes in MaAsLin2 as the number of covariates increases, especially when more than four covariates are present.</p>
      <fig position="float" id="vbad063-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Comparison of LongDat and MaAsLin2 (using the negative binomial model mode) on performance and power applied to microbiomeDASim-simulated longitudinal data. The box plots show the accuracy, true positive rate (TPR), false discovery rate (FDR) and Matthews correlation coefficient (MCC). The upper panel features a low effect size (median ≈ 0.2) while the lower panel features a medium effect size (median ≈ 0.5). For each combination of sample size, effect size and tool, 100 simulations were performed</p>
        </caption>
        <graphic xlink:href="vbad063f2" position="float"/>
      </fig>
      <fig position="float" id="vbad063-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Comparison of LongDat and MaAsLin2 (using the negative binomial model mode) on computational resource profiling applied to microbiomeDASim-simulated longitudinal data. Runtime (<bold>A</bold>) and total used memory (<bold>B</bold>) required by LongDat and MaAsLin2 when run on simulated data with 200 features and various sample sizes. For each sample size, 200 simulations were performed. 1 mebibyte (MiB) ≈ 1.05 megabyte (MB)</p>
        </caption>
        <graphic xlink:href="vbad063f3" position="float"/>
      </fig>
      <p>Apart from evaluating LongDat and MaAsLin2 using microbiomeDASim-simulated data, we utilized SparseDOSSA2, another microbiome data simulation tool, to validate that the benchmarking outcome of LongDat is consistent between different simulation tools. Here, we assessed the performance of LongDat and MaAsLin2 using various modes, such as linear or negative binomial models, on simulated data that was either raw, normalized or rarefied. The benchmarking of performance and requirement of computational resources on SparseDOSSA2-simulated data with 0 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5A</xref> and <xref rid="sup1" ref-type="supplementary-material">B</xref>), 1 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6A</xref> and <xref rid="sup1" ref-type="supplementary-material">B</xref>), 4 (<xref rid="sup1" ref-type="supplementary-material">Fig. S7</xref> and <xref rid="sup1" ref-type="supplementary-material">S7B</xref>) and 16 covariates (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8A</xref> and <xref rid="sup1" ref-type="supplementary-material">B</xref>) are presented. Within a broader perspective, these results reproduce our findings in the benchmarking using microbiomeDASim-simulated data, where MaAsLin2 and LongDat perform similarly on simulated data in the absence of covariates. However, as the number of covariates increases, the performance gap between the two methods becomes more evident. The performance of LongDat remains stable across all numbers of covariates while FDR surges and TPR diminishes in MaAsLin2, particularly when more than four covariates are present. Upon closer examination of each normalization method, MaAsLin2's negative binomial model mode generally produces higher TPR but also higher FDR than its linear model mode (except when run on CLR-transformed data, which has a high FDR), thus similar accuracy and MCC. On the other hand, LongDat produces comparable outcomes when either linear or negative binomial models are run on data processed through different normalization or rarefaction methods (except for CLR paired with linear model, which performs the worst). Specifically, we believe rarefaction is necessary for some situations, although the pair of negative binomial model and rarefied count data has higher FDR than the pair of linear model TSS-normalized data. For example, we simulated longitudinal negative control data with two time points in which the sequencing depths varied systematically between the two points. In this scenario, the negative binomial model applied to rarefied count data maintains a near-zero false positive rate (FPR), while the linear model applied to non-rarefied TSS-normalized data results in a high FPR when the depth variation between the two time points was large (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>). Therefore, we conclude that the use of linear models to analyze TSS-normalized data is reasonable only when there is no systematic bias in sequencing depth between groups or time points; otherwise, the analysis may result in many false positives. There is no method suitable for all scenarios; instead, the selection of an appropriate approach highly depends on the data's nature.</p>
    </sec>
    <sec>
      <title>3.2 LongDat outperforms ANCOM in computational efficiency and outperforms lgpr and ZIBR in overall performance when tested on simulated data</title>
      <p>In addition to MaAsLin2, we also compared LongDat with several other tools capable of analyzing longitudinal microbiome data, including ANCOM, lgpr and ZIBR, by examining their performances when multiple covariates are present (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S10A, B, S11A and B</xref>). Here the simulated data were generated by microbiomeDASim. The results show that the FDR of ANCOM remains around zero as LongDat does and has comparable accuracy, TPR and MCC when there are less than four covariates, whereas TPR dwindles as the number of covariates increases. The major drawback of ANCOM is that it needs large memory (requires 350 GB to be allocated or else errors would occur and halt) to run through each simulated dataset (here each containing 100 features), making it challenging to run ANCOM on a large scale. ZIBR does not perform well because its FDR is high, and its accuracy, TPR and MCC are low across all numbers of covariates. Moreover, ZIBR needs much time to run through each dataset with large sample sizes (e.g. around 55 h to finish a run with 300 samples and 16 covariates). Lastly, while lgpr has better TPR than LongDat when the sample size is small (≤38), it simultaneously has a high level of FDR. The primary shortcoming of lgpr is that its run time (e.g. around 65 h with 150 samples and 1 covariate) is substantially longer than all other tools, and it could not finish any run within the time limit (96 h) of the high-performance computing cluster we used. This impedes lgpr from being widely applied to microbiome data in a common research environment. From these results, we concluded that LongDat is the ideal tool for data with multiple covariates since it has decent performance and low computational resource requirements (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>).</p>
      <p>As we did with the comparison between LongDat and MaAsLin2, we employed SparseDOSSA2 to assess the performance of LongDat, lgpr and ZIBR, in addition to the microbiomeDASim-simulated data comparison. ANCOM's high memory requirement (&gt;350 GB) for SparseDOSSA2-simulated data analysis caused it to fail to run on the high-performance computing cluster we utilized, leading to its exclusion from the analysis here. The assessment of computational resource requirements and performance benchmarking using SparseDOSSA2-simulated data with varying numbers of covariates (0, 1, 4 and 16) is depicted in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S12A, B, S13A, B, S14A, B, S15A and B</xref>, respectively. These findings confirm our earlier observations based on microbiomeDASim-simulated data. ZIBR, which operates on TSS-normalized data, has a high FDR and takes a long time to execute. lgpr performs better than LongDat in terms of TPR for small sample sizes, regardless of normalization or rarefaction, but it also has a high FDR. The primary disadvantage of lgpr is that it takes significantly longer to run than any of the other tools, making it not able to complete any run within the time limit (96 h) of the high-performance computing cluster we used when the sample size is relatively large. The performances of both ZIBR and lgpr decline as the number of covariates increases. In contrast, LongDat maintains decent performance and computational resource requirements regardless of the number of covariates.</p>
    </sec>
    <sec>
      <title>3.3 The performance of LongDat was evaluated using semi-synthetic data, demonstrating a low false positive rate</title>
      <p>To estimate the performance of LongDat based on data aside from simulated data (microbiomeDASim and SparseDOSSA2), we conducted a semi-synthetic evaluation as well. In this evaluation, we shuffled the time variable against all other variables in the fasting microbiome data (at the genus level). Next, we compared the ratio of significant associations between unshuffled and shuffled data. The result of LongDat indicates few to no false positives in the shuffled data in all modes, regardless of whether covariates were included or excluded in the analysis (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S16</xref>). Conversely, MaAsLin2, lgpr and ZIBR were all influenced by the presence of covariates in their analyses. MaAsLin2 identifies fewer significant associations in the unshuffled data and more false positives in the shuffled data than LongDat. ZIBR and lgpr result in much higher false positive rates than LongDat. Consistent with prior analyses, we confirmed that LongDat is robust against false positive findings in both simulated and semi-synthetic evaluations.</p>
    </sec>
    <sec>
      <title>3.4 LongDat provides a more smooth and more efficient workflow than MaAsLin2 despite similar performance</title>
      <p>Since MaAsLin2 is the only alternate tool where memory and runtime scaling do not preclude its application to our full benchmark, the analyses below focus on the comparison between MaAsLin2 and LongDat. To compare the performance of LongDat and MaAsLin2 on detecting covariate effects, we added a dummy variable correlating with the time variable and tested whether this dummy variable, when instead used as the time input variable, was wrongly reported as exhibiting a relationship to the simulated feature independent of time (<xref rid="vbad063-F4" ref-type="fig">Fig. 4A and B</xref>). LongDat requires only a single run for this test. In contrast, MaAsLin2 lacks a covariate model test component corresponding to the LongDat pipeline's second part, so we ran MaAsLin2 in two separate runs (with and without covariate included in the model, respectively) to generate comparable results with LongDat. We found that LongDat and MaAsLin2 achieved similar performance, with the median success rate for both tools in correctly concluding covariate effects remaining at ∼0.95 (as per FDR threshold/family-wise error rate) even when the dummy and time variables were strongly correlated. As a negative control, we tested how LongDat performs when both the features and covariates are not associated with time by shuffling the time variable randomly within each individual (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S17</xref>). Here we tested if the shuffled time variable was reported as significant. We found no false positive occurred across all correlation degrees (the correlation between the time variable and covariate was, in fact, destroyed because time was shuffled). These results demonstrate that both LongDat and MaAsLin2 perform well in accuracy and correctly flagging covariates.</p>
      <fig position="float" id="vbad063-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Comparison of LongDat and MaAsLin2 on covariate-sensitive analysis applied to microbiomeDASim-simulated longitudinal data. To compare the ability of LongDat and MaAsLin2 on detecting covariates, a dummy variable was added to the simulated data and was tested for its effect. ‘Success’ is defined as a tool indicating the dummy variable as either ‘non-significant’, ‘reducible to covariate’ or ‘entangled with covariate’ (time is the covariate here), whereas ‘failure’ occurs when a tool wrongly concludes that the dummy variable is significant and the time variable is not. (<bold>A</bold>) The box plot shows the success rate of using LongDat and MaAsLin2 to filter out and conclude covariate effects at different degrees of correlation between the dummy variable and time. (<bold>B</bold>) The bar chart illustrates the proportion of success and failure across correlation degrees. For each degree of correlation, 100 simulations were done</p>
        </caption>
        <graphic xlink:href="vbad063f4" position="float"/>
      </fig>
      <p>In the simulated data, with rho being as high as 0.99 between the dummy and time variables, we demonstrated that LongDat could distinguish data generated from different underlying ground truths even when there is substantial confounding. It is worth noting that LongDat does not label the dummy variable as ‘non-significant’ (i.e. having no relationship with the feature at all) but rather as ‘reducible to covariate’ or ‘entangled with covariate’ when the correlation degree is high. These two labels do not signify that the dummy variable is irrelevant to the features but instead intend to communicate that its association with the features might be from an indirect association. In real data, however, it will be more challenging to discern between the dummy and the time variables if they are highly correlated. In that case, more investigation or experiments are required to confirm which variable has direct versus indirect influence, necessitating more careful inspection and domain knowledge before robust conclusions can be drawn.</p>
    </sec>
    <sec>
      <title>3.5 LongDat performs more robustly than MaAsLin2 in real data with multiple covariates</title>
      <p>Subsequently, to compare the performance of LongDat and MaAsLin2 on real data, we reanalyzed gut microbial data from a clinical cohort investigating fasting effects on patients with MetS (<xref rid="vbad063-B25" ref-type="bibr">Maifeld <italic toggle="yes">et al.</italic>, 2021</xref>). One aim of the study was to investigate how fasting affects blood pressure while controlling for changes in medication. When no covariates (i.e. medication variables) were included in the MaAsLin2 analysis, LongDat and MaAsLin2 each identified 27 microbial species that were significantly altered in abundance throughout the intervention, with 19 of them being consistent between the two (<xref rid="vbad063-F5" ref-type="fig">Fig. 5A and B</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2, S3 and S4</xref>). However, when covariates were included, only two species were reported significantly different in abundance by MaAsLin2 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). This is because models fitting most of the significantly affected species returned errors (showed NA in <italic toggle="yes">P</italic>-values and standard errors) when multiple fixed effects were included. LongDat avoids this problem by having only one covariate in a model at one time and loops over all of them. Thus, LongDat performs more robustly than MaAsLin2 for this type of data when multiple covariates are present in the dataset, but at the cost of higher runtime.</p>
      <fig position="float" id="vbad063-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Comparison of LongDat and MaAsLin2 on analyzing real microbiome data. (<bold>A</bold>) The cuneiform plot on the left panel shows the gut microbes (species level) that display significant differences in their abundance in at least one of the time intervals in the assessed study (<xref rid="vbad063-B25" ref-type="bibr">Maifeld <italic toggle="yes">et al.</italic>, 2021</xref>). In that study, metabolic disease patients underwent 7-day fasting and then a 3-month re-feeding period. In the plot, ‘fasting’ indicates the time elapsed from Day 0 to 7, while ‘refeeding’ indicates Day 7 to 90, and ‘study’ indicates the overall duration from Day 0 to 90. Bold species are the ones that appeared significant in both LongDat and MaAsLin2 results. The right panel reports the covariate status of each microbe as follows. <italic toggle="yes">OK_nc</italic>: OK and no covariate. Time/intervention has significant effect and there is no covariate. <italic toggle="yes">OK_nrc</italic>: OK and not reducible to any covariate. Time/intervention has significant effect, and its effect is independent of all tracked covariates. <italic toggle="yes">RC</italic>: Effect reducible to covariate. Time/intervention when tested on its own achieves significance; however, its effect is better explained by that of a covariate (whereas the inverse is not true). Microbes with BH-corrected model test q-values &lt; 0.1 and BH-corrected post-hoc test q-values &lt; 0.05 are regarded as significant. (<bold>B</bold>) The Venn diagram shows the significant species found by LongDat and MaAsLin2. Numbers indicate counts and percentages of each category. Note that for MaAsLin2, covariates were not included in the analyses here. When covariates were included in MaAsLin2 analysis, only 2 of the species showed significance here remained significant, while all others returned error due to NA in <italic toggle="yes">P</italic>-values and standard errors (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>)</p>
        </caption>
        <graphic xlink:href="vbad063f5" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.6 LongDat can be applied to other data types, such as immunome data</title>
      <p>Finally, to demonstrate that LongDat can run on other data types besides microbiome data, we applied LongDat to the immunome data from the same fasting study mentioned above (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S18 and S19</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S6–S9</xref>). The immunome data consist of proportion (percentage) and non-proportion (non-percentage) data, so they were analyzed by LongDat proportion mode and measurement mode, respectively. These results show that LongDat can tackle other types of data in addition to microbiome counts.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We introduce LongDat, an R package that analyzes longitudinal data for intervention (or treatment) effects while accounting for covariates throughout the intervention. LongDat was developed and tested as a microbiome analysis tool, and we made it able to work on other high-dimensional data types by using flexible and robust approaches, chiefly GLMMs and non-parametric tests. The resulting output allows convenient downstream analysis and interpretation. Instead of proposing a new theory or mathematical tool to deal with the problems of high-dimensional data, multiple covariates and different data types (distribution), we packaged the GLMMs and non-parametric tests together to automate the process of analyzing high-dimensional data. LongDat relieves the users of the burden of having to program the R linear modeling functions from scratch. With the standardized output, including effect sizes reported in Cliff’s delta, and the visualization of the significances and influences of covariates for each feature, it is easier for biologists to integrate, compare and visualize their findings. Though here we do not present a theoretical advance, we believe LongDat is a practical and convenient modeling tool immediately applicable to the scale of problems faced, e.g. in cohort- or intervention-centered systems medical research, and therefore promotes high-dimensional data analysis in the biomedical research field. One limitation of LongDat is that it reports standardized non-parametric effect sizes of discrete (Cliff’s delta) or continuous (Spearman’s rho) variables, both of which are calculated independently of other covariates. Thus, when covariates are present in the data, the reported effect size is not a perfect estimate as it does not incorporate covariates for calculation. We currently are not aware of any partial standardized directional effect size metrics that would let us circumvent this obstacle, but we are actively searching for them to include in later versions of LongDat.</p>
    <p>By conducting simulations using two independent tools, namely microbiomeDASim and SparseDOSSA2, we confirm that the statements below are consistent across benchmarking platforms. The advantages of LongDat over the most similar existing tool, MaAsLin2, include lower FDR, the ability to explicitly report covariate effects and their effect sizes, and thus a more convenient functionality in reporting and describing covariates for each feature. The latter, which reports the influence of covariates on the tested variable, is the exclusive feature of LongDat that no other tool possesses to the best of our knowledge. The other important feature of LongDat is that it can handle multiple covariates at once and maintain stable performance. This feature is achieved by having only one covariate in a model at one time and looping over them instead of including all covariates at once, which forms a lengthy formula. This approach grants LongDat robustness when facing multiple covariates, but at the cost of higher runtime. By contrast, the performance of MaAsLin2 is highly dependent on the number of covariates in the data. While MaAsLin2 and LongDat have comparable accuracy when there are no covariates, we observe a trade-off between TPR and FDR in them. Hence, MaAsLin2 and LongDat are suitable in different scenarios depending on the priorities of the application. For instance, when a lower FDR is more emphasized in an analysis, or when there are many covariates in a study, LongDat will be a better choice. In contrast, if a higher TPR and power are prioritized, and no covariate is in the data, then MaAsLin2 is a good option.</p>
    <p>In addition to MaAsLin2, we also compared LongDat with three other tools: ANCOM, lgpr and ZIBR. While the performance of ANCOM is fairly good when the number of covariates is low, ANCOM suffers from the need for huge memory to run. On the other hand, the performances of both lgpr and ZIBR are highly dependent on the number of covariates, and both tools suffer from long runtime. Furthermore, ANCOM and lgpr rely on arbitrary cutoffs (W statistics and the proportion of total explained variance, respectively), which might pose inconvenience and confusion to the users. Despite the unfavorable ZIBR results shown here, we believe in the potential of the zero-inflated models (represented by ZIBR here) since they characterize the distribution of highly sparse microbiome data well. We will keep track of its development (or other related zero-inflated models) and plan to integrate it into the future version of LongDat.</p>
    <p>To investigate the impact of normalization and rarefaction on analysis results, we conducted benchmarking tests on each tool using different preprocessing methods. Interestingly, we find that LongDat and MaAsLin2 have similar overall performance (based on accuracy and MCC) when analyzing data without any covariates, irrespective of the modes (negative binomial or linear model) and preprocessing methods (except for the CLR transformation). However, the discrepancy in the performance of LongDat and MaAsLin2 widens as the number of covariates increases. While all modes of MaAsLin2 struggle to maintain high true positive rates and low false discovery rates with four or more covariates, LongDat remains stable and performs well across all scenarios. Meanwhile, ZIBR and lgpr did not excel in this round of benchmarking test because of high FDR and extremely long runtime that impedes the users from applying them effectively. Furthermore, by simulating datasets with high variation in sequencing depth between time points (or groups), we underscored that the choice of normalization or rarefaction technique should be tailored to the specific characteristics of the data. In the example above, rarefaction is required to remove the systematic bias between time points, which leads to false positive findings. Ultimately, we believe that there is no one-size-fits-all approach to data preprocessing and analysis, and researchers should carefully select appropriate protocols according to the unique features of their data.</p>
    <p>In conclusion, our comprehensive benchmarking, including independent simulation tools, semi-synthetic and real data evaluations, demonstrates that the LongDat package we present here is a computationally efficient and low-memory-cost analysis tool for longitudinal data with multiple covariates, and facilitates robust biomarker searches in high-dimensional datasets.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbad063_Supplementary_Data</label>
      <media xlink:href="vbad063_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>We sincerely thank Morgan Essex for her insightful comments and revisions that significantly improved the manuscript in all aspects.</p>
    <sec>
      <title>Author contributions</title>
      <p>Chia-Yu Chen (Conceptualization [equal], Formal analysis [lead], Investigation [lead], Methodology [equal], Project administration [lead], Software [lead], Validation [lead], Visualization [lead], Writing—original draft [lead], Writing—review &amp; editing [equal]), Ulrike Löber (Conceptualization [supporting], Methodology [supporting], Software [supporting], Supervision [supporting], Writing—review &amp; editing [equal]) and Sofia Forslund (Conceptualization [equal], Formal analysis [supporting], Funding acquisition [lead], Investigation [supporting], Methodology [equal], Project administration [supporting], Resources [lead], Software [supporting], Supervision [lead], Validation [supporting], Visualization [supporting], Writing—original draft [supporting], Writing—review &amp; editing [equal]).</p>
    </sec>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the German Research Foundation (Deutsche Forschungsgemeinschaft, DFG) Collaborative Research Center (CRC) 1365 ‘Renoprotection’; the DFG as part of a Clinical Research Unit (CRU) 339 ‘Food Allergy and Tolerance’ [428049112]; and the German Federal Ministry of Education and Research [EMBARK; 01KI1909B] under the frame of JPI-AMR [EMBARK; JPIAMR2019-109] to U.L.</p>
    <p><italic toggle="yes">Conflict of interest</italic>: All authors declare that they have no conflicts of interest.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The scripts for simulating longitudinal data, running LongDat, ANCOM, lgpr, ZIBR and MaAsLin2, and also the raw data for the fasting study are available at <ext-link xlink:href="https://github.com/CCY-dev/LongDat_paper_supplement.git" ext-link-type="uri">https://github.com/CCY-dev/LongDat_paper_supplement.git</ext-link>. The stool sequencing data of the fasting study are deposited on NCBI under the accession PRJNA698459.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad063-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Asar</surname><given-names>Ö.</given-names></string-name></person-group><etal>et al</etal> (<year>2013</year>) <article-title>mmm: an R package for analyzing multivariate longitudinal data with multivariate marginal models</article-title>. <source>Comput. Methods Programs Biomed</source>., <volume>112</volume>, <fpage>649</fpage>–<lpage>654</lpage>.<pub-id pub-id-type="pmid">24054737</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Assent</surname><given-names>I.</given-names></string-name></person-group> (<year>2012</year>) <article-title>Clustering high dimensional data</article-title>. <source>WIREs Data Min. Knowledge Discov</source>., <volume>2</volume>, <fpage>340</fpage>–<lpage>350</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bates</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Fitting linear mixed-effects models using lme4</article-title>. <source>J. Stat. Soft</source>., <volume>67</volume>, <fpage>1</fpage>–<lpage>48</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benjamini</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>1995</year>) <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J. R. Stat. Soc. Ser. B (Methodological)</source>, <volume>57</volume>, <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bolker</surname><given-names>B.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Generalized linear mixed models: a practical guide for ecology and evolution</article-title>. <source>Trends Ecol. Evol</source>., <volume>24</volume>, <fpage>127</fpage>–<lpage>135</lpage>.<pub-id pub-id-type="pmid">19185386</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brooks</surname><given-names>M.E.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Modeling zero-inflated count data with glmmTMB</article-title>. <source>bioRxiv preprint</source>: 132753.</mixed-citation>
    </ref>
    <ref id="vbad063-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Calgaro</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Assessment of statistical methods from single cell, bulk RNA-seq, and metagenomics applied to microbiome data</article-title>. <source>Genome Biol</source>., <volume>21</volume>, <fpage>191</fpage>.<pub-id pub-id-type="pmid">32746888</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>E.Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>A two-part mixed-effects model for analyzing longitudinal microbiome compositional data</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2611</fpage>–<lpage>2617</lpage>.<pub-id pub-id-type="pmid">27187200</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>GMPR: a robust normalization method for zero-inflated count data with application to microbiome sequencing data</article-title>. <source>PeerJ</source>, <volume>6</volume>, <fpage>e4600</fpage>.<pub-id pub-id-type="pmid">29629248</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ferrari</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2004</year>) <article-title>Beta regression for modelling rates and proportions</article-title>. <source>J. Appl. Stat</source>., <volume>31</volume>, <fpage>799</fpage>–<lpage>815</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Field-Fote</surname><given-names>E.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Mediators and moderators, confounders and covariates: exploring the variables that illuminate or obscure the “active ingredients” in neurorehabilitation</article-title>. <source>J. Neurol. Phys. Therapy</source>, <volume>43</volume>, <fpage>83</fpage>–<lpage>84</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B12">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Fox</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <source>An {R} Companion to Applied Regression</source>. <publisher-name>Sage, California, USA</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vbad063-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gloor</surname><given-names>G.B.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Microbiome datasets are compositional: and this is not optional</article-title>. <source>Front. Microbiol</source>., <volume>8</volume>, <fpage>1</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">28197127</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gonçalves</surname><given-names>M.H.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Cold: an R package for the analysis of count longitudinal data</article-title>. <source>J. Stat. Soft</source>., <volume>99</volume>, <fpage>1</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B15">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hua</surname><given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) Study design: cross-sectional, longitudinal, case, and group. In: Wei, L., and Moyer, M.G. (eds) <italic toggle="yes">The Blackwell Guide to Research Methods in Bilingualism and Multilingualism</italic>, pp. <fpage>88</fpage>–<lpage>107</lpage>. Wiley Interscience/John Wiley and Sons, Hoboken, USA.</mixed-citation>
    </ref>
    <ref id="vbad063-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kodikara</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Statistical challenges in longitudinal microbiome data analysis</article-title>. <source>Brief. Bioinf</source>., <volume>23</volume>, bbac273.</mixed-citation>
    </ref>
    <ref id="vbad063-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lenth</surname><given-names>R.V.</given-names></string-name></person-group> (<year>2021</year>) <italic toggle="yes">emmeans: Estimated Marginal Means, aka Least-Squares Means</italic>. R Package Version 1.6.3., CRAN, Vienna, Austria.</mixed-citation>
    </ref>
    <ref id="vbad063-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levin</surname><given-names>K.A.</given-names></string-name></person-group> (<year>2006</year>) <article-title>Study design III: cross-sectional studies</article-title>. <source>Evid. Based Dent</source>., <volume>7</volume>, <fpage>24</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">16557257</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Analysis of microbial compositions: a review of normalization and differential abundance analysis</article-title>. <source>NPJ Biofilms Microbiomes</source>, <volume>6</volume>, <fpage>60</fpage>.<pub-id pub-id-type="pmid">33268781</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lindsey</surname><given-names>J.K.</given-names></string-name></person-group><etal>et al</etal> (<year>1998</year>) <article-title>Choosing among generalized linear models applied to medical data</article-title>. <source>Statist. Med</source>., <volume>17</volume>, <fpage>59</fpage>–<lpage>68</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>Statistical issues in longitudinal data analysis for treatment efficacy studies in the biomedical sciences</article-title>. <source>Mol. Ther</source>., <volume>18</volume>, <fpage>1724</fpage>–<lpage>1730</lpage>.<pub-id pub-id-type="pmid">20588256</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>X.</given-names></string-name></person-group> (<year>2009</year>) <article-title>Ordinal regression analysis: fitting the proportional odds model using stata, SAS and SPSS</article-title>. <source>J. Mod. App. Stat. Meth</source>., <volume>8</volume>, <fpage>632</fpage>–<lpage>642</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>A statistical model for describing and simulating microbial community profiles</article-title>. <source>PLoS Comput. Biol</source>., <volume>17</volume>, <fpage>e1008913</fpage>.<pub-id pub-id-type="pmid">34516542</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Macbeth</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>Cliff's Delta calculator: a non-parametric effect size program for two groups of observations</article-title>. <source>Univ. Psychol</source>., <volume>10</volume>, <fpage>545</fpage>–<lpage>555</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maifeld</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Fasting alters the gut microbiome reducing blood pressure and body weight in metabolic syndrome patients</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>1970</fpage>.<pub-id pub-id-type="pmid">33785752</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mallick</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Multivariable association discovery in population-scale meta-omics studies</article-title>. <source>PLoS Comput. Biol</source>., <volume>17</volume>, <fpage>e1009442</fpage>.<pub-id pub-id-type="pmid">34784344</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mandal</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Analysis of composition of microbiomes: a novel method for studying microbial composition</article-title>. <source>Microb. Ecol. Health Dis</source>., <volume>26</volume>, <fpage>27663</fpage>.<pub-id pub-id-type="pmid">26028277</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marfo</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>The accuracy of effect-size estimates under normals and contaminated normals in meta-analysis</article-title>. <source>Heliyon</source>, <volume>5</volume>, <fpage>e01838</fpage>.<pub-id pub-id-type="pmid">31211256</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKnight</surname><given-names>D.T.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Methods for normalizing microbiome data: an ecological perspective</article-title>. <source>Methods Ecol. Evol</source>., <volume>10</volume>, <fpage>389</fpage>–<lpage>400</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Metwally</surname><given-names>A.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>MetaLonDA: a flexible R package for identifying time intervals of differentially abundant features in metagenomic longitudinal studies</article-title>. <source>Microbiome</source>, <volume>6</volume>, <fpage>32</fpage>.<pub-id pub-id-type="pmid">29439731</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mulè</surname><given-names>M.P.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Normalizing and denoising protein expression data from droplet-based single cell profiling</article-title>. <source>Nat. Commun</source>., <volume>13</volume>, <fpage>2099</fpage>.<pub-id pub-id-type="pmid">35440536</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nahm</surname><given-names>F.S.</given-names></string-name></person-group> (<year>2016</year>) <article-title>Nonparametric statistical tests for the continuous data: the basic concept and the practical use</article-title>. <source>Korean J. Anesthesiol</source>., <volume>69</volume>, <fpage>8</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">26885295</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B33">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Nick</surname><given-names>T.G.</given-names></string-name></person-group><etal>et al</etal> (<year>2007</year>) <part-title>Logistic regression</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Ambrosius</surname><given-names>W.T.</given-names></string-name></person-group> (ed.) <source>Topics in Biostatistics</source>. <publisher-name>Humana Press</publisher-name>, <publisher-loc>Totowa, NJ</publisher-loc>, pp. <fpage>273</fpage>–<lpage>301</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B34">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Opgen-Rhein</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <source>Longitudinal: Analysis of Multiple Time Course Data</source>. <publisher-name>CRAN, Vienna, Austria</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vbad063-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedersen</surname><given-names>H.K.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>A computational framework to integrate high-throughput ‘-omics’ datasets for the identification of potential mechanistic links</article-title>. <source>Nat. Protoc</source>., <volume>13</volume>, <fpage>2781</fpage>–<lpage>2800</lpage>.<pub-id pub-id-type="pmid">30382244</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B36">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Pedersen</surname><given-names>T.L.</given-names></string-name></person-group> (<year>2020</year>) <source>Patchwork: The Composer of Plots</source>. <publisher-name>CRAN, Vienna, Austria</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vbad063-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peterson</surname><given-names>R.A.</given-names></string-name></person-group> (<year>2021</year>) <article-title>Finding optimal normalizing transformations via bestNormalize</article-title>. <source>R. J</source>., <volume>13</volume>, <fpage>310</fpage>–<lpage>329</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B38">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Quinn</surname><given-names>T.</given-names></string-name></person-group> (<year>2017</year>) <source>peakRAM: Monitor the Total and Peak RAM Used by an Expression or Function</source>. <publisher-name>CRAN, Vienna, Austria</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vbad063-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>M.D.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>edgeR: a bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>139</fpage>–<lpage>140</lpage>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saary</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>RTK: efficient rarefaction analysis of large datasets</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>2594</fpage>–<lpage>2595</lpage>.<pub-id pub-id-type="pmid">28398468</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sanchez-Cid</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Sequencing depth has a stronger effect than DNA extraction on soil bacterial richness discovery</article-title>. <source>Biomolecules</source>, <volume>12</volume>, <fpage>364</fpage>.<pub-id pub-id-type="pmid">35327556</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sullivan</surname><given-names>G.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>Using effect size—or why the P value is not enough</article-title>. <source>J. Grad. Med. Educ</source>., <volume>4</volume>, <fpage>279</fpage>–<lpage>282</lpage>.<pub-id pub-id-type="pmid">23997866</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Swift</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2023</year>) <article-title>A review of normalization and differential abundance methods for microbiome counts data</article-title>. <source>WIREs Comput. Stat</source>., <volume>15</volume>, <fpage>e1586</fpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tierney</surname><given-names>B.T.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Gene-level metagenomic architectures across diseases yield high-resolution microbiome diagnostic indicators</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>2907</fpage>.<pub-id pub-id-type="pmid">34006865</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Timonen</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>lgpr: an interpretable non-parametric method for inferring covariate effects from longitudinal data</article-title>. <source>Bioinformatics</source>, <volume>37</volume>, <fpage>1860</fpage>–<lpage>1867</lpage>.<pub-id pub-id-type="pmid">33471072</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B46">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Torchiano</surname><given-names>M.</given-names></string-name></person-group> (<year>2020</year>) <source>effsize: Efficient Effect Size Computation</source>. <publisher-name>CRAN, Vienna, Austria</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vbad063-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van den Boogaart</surname><given-names>K.G.</given-names></string-name></person-group><etal>et al</etal> (<year>2008</year>) <article-title>“compositions”: a unified R package to analyze compositional data</article-title>. <source>Comput. Geosci</source>., <volume>34</volume>, <fpage>320</fpage>–<lpage>338</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B48">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Venables</surname><given-names>W.N.</given-names></string-name></person-group><etal>et al</etal> (<year>2002</year>) <source>Modern Applied Statistics with S</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>New York</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="vbad063-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ver Hoef</surname><given-names>J.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2007</year>) <article-title>Quasi-Poisson vs. negative binomial regression: how should we model overdispersed count data?</article-title><source>Ecology</source>, <volume>88</volume>, <fpage>2766</fpage>–<lpage>2772</lpage>.<pub-id pub-id-type="pmid">18051645</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weiss</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Normalization and microbial differential abundance strategies depend upon data characteristics</article-title>. <source>Microbiome</source>, <volume>5</volume>, <fpage>27</fpage>.<pub-id pub-id-type="pmid">28253908</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H.</given-names></string-name></person-group> (<year>2007</year>) <article-title>Reshaping data with the reshape package</article-title>. <source>J. Stat. Soft</source>., <volume>21</volume>, <fpage>1</fpage>–<lpage>20</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Welcome to the Tidyverse</article-title>. <source>JOSS</source>, <volume>4</volume>, <fpage>1686</fpage>.</mixed-citation>
    </ref>
    <ref id="vbad063-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Williams</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>microbiomeDASim: simulating longitudinal differential abundance for microbiome data</article-title>. <source>F1000Res</source>., <volume>8</volume>, <fpage>1769</fpage>.<pub-id pub-id-type="pmid">32148761</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Witten</surname><given-names>D.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>Survival analysis with high-dimensional covariates</article-title>. <source>Stat. Methods Med. Res</source>., <volume>19</volume>, <fpage>29</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">19654171</pub-id></mixed-citation>
    </ref>
    <ref id="vbad063-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Negative binomial mixed models for analyzing microbiome count data</article-title>. <source>BMC Bioinformatics</source>, <volume>18</volume>, <fpage>4</fpage>.<pub-id pub-id-type="pmid">28049409</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
