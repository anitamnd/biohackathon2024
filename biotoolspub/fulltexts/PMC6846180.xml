<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6846180</article-id>
    <article-id pub-id-type="pmid">31504818</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkz743</article-id>
    <article-id pub-id-type="publisher-id">gkz743</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Machine learning-based chemical binding similarity using evolutionary relationships of target genes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-8783-9495</contrib-id>
        <name>
          <surname>Park</surname>
          <given-names>Keunwan</given-names>
        </name>
        <!--<email>keunwan@kist.re.kr</email>-->
        <xref ref-type="aff" rid="AFF1">1</xref>
        <xref ref-type="corresp" rid="COR1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ko</surname>
          <given-names>Young-Joon</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">1</xref>
        <xref ref-type="aff" rid="AFF2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Durai</surname>
          <given-names>Prasannavenkatesh</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pan</surname>
          <given-names>Cheol-Ho</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">1</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><label>1</label><institution>Natural Product Informatics Research Center, KIST Gangneung Institute of Natural Products</institution>, Gangneung 25451, <country country="KR">Republic of Korea</country></aff>
    <aff id="AFF2"><label>2</label><institution>Department of Bioinformatics and Life Science, Soongsil University</institution>, Seoul 06978, <country country="KR">Republic of Korea</country></aff>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +82 33 650 3663; Fax: +82 33 650 3629; Email: <email>keunwan@kist.re.kr</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>18</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-08-31">
      <day>31</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>31</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>47</volume>
    <issue>20</issue>
    <fpage>e128</fpage>
    <lpage>e128</lpage>
    <history>
      <date date-type="accepted">
        <day>20</day>
        <month>8</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>8</month>
        <year>2019</year>
      </date>
      <date date-type="received">
        <day>13</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gkz743.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Chemical similarity searching is a basic research tool that can be used to find small molecules which are similar in shape to known active molecules. Despite its popularity, the retrieval of local molecular features that are critical to functional activity related to target binding often fails. To overcome this limitation, we developed a novel machine learning-based chemical binding similarity score by using various evolutionary relationships of binding targets. The chemical similarity was defined by the probability of chemical compounds binding to identical targets. Comprehensive and heterogeneous multiple target-binding chemical data were integrated into a paired data format and processed using multiple classification similarity-learning models with various levels of target evolutionary information. Encoding evolutionary information to chemical compounds through their binding targets substantially expanded available chemical-target interaction data and significantly improved model performance. The output probability of our integrated model, referred to as ensemble evolutionary chemical binding similarity (ensECBS), was effective for finding hidden chemical relationships. The developed method can serve as a novel chemical similarity tool that uses evolutionarily conserved target binding information.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Ministry of Oceans and Fisheries</named-content>
          <named-content content-type="funder-identifier">10.13039/501100003566</named-content>
        </funding-source>
        <award-id>20170488</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">KIST</named-content>
          <named-content content-type="funder-identifier">10.13039/501100003693</named-content>
        </funding-source>
        <award-id>2E29562</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Most chemical similarity scores consider the overall structural similarity based on predefined and equally weighted structural features (i.e., molecular fingerprints) (<xref rid="B1" ref-type="bibr">1–3</xref>). Although these methods have been widely used to search for similar compounds owing to their fast processing speed and ease of use (<xref rid="B4" ref-type="bibr">4–7</xref>), the simplicity often hinders the detection of meaningful hits where only a few chemical features are important for target-binding (<xref rid="B6" ref-type="bibr">6</xref>,<xref rid="B8" ref-type="bibr">8</xref>,<xref rid="B9" ref-type="bibr">9</xref>).</p>
    <p>Machine-learning methods have been extensively studied in the field of cheminformatics. Many sophisticated models have been proposed using quantitative structure–activity relationship (QSAR) data for consideration of complex target-binding molecular features and have been successfully applied to many biological areas (<xref rid="B4" ref-type="bibr">4</xref>,<xref rid="B9" ref-type="bibr">9–12</xref>). QSAR models are usually built on active and non-active compound sets defined for a target protein, and the models have been effective for extracting important spatial features, despite the two-dimensional nature of some molecular descriptors (<xref rid="B13" ref-type="bibr">13</xref>). However, even with the advantages of QSAR methods, the pairwise molecular relationships cannot be defined because they are mostly limited to a predefined target and it is difficult to consider multiple chemical-target relationships.</p>
    <p>Similarity-learning techniques provide context-dependent pairwise similarity measures using machine-learning methods (<xref rid="B14" ref-type="bibr">14–16</xref>). Similar to other classification problems, paired data sets are labeled as similar or dissimilar and used to build a model or function which can decide if new paired data is similar. Metric learning and classification similarity-learning are two common approaches that are used to address the similarity-learning problem. Metric-learning techniques focus their attention on learning a similarity measure that satisfies the mathematical properties of a metric distance (<xref rid="B17" ref-type="bibr">17</xref>), whereas classification similarity-learning techniques produce a score, rather than a metric, that effectively classifies similar/dissimilar objects (<xref rid="B16" ref-type="bibr">16</xref>,<xref rid="B18" ref-type="bibr">18</xref>). Classification similarity-learning is particularly useful when the overall objective is to rank data according to similarity relationship and the metric properties are not strictly required to output similarity scores (<xref rid="B14" ref-type="bibr">14</xref>).</p>
    <p>In our previous study, classification similarity-learning was applied to small molecule drugs and showed promising results with regards to finding unknown drug-target interactions and novel pharmacological effects (<xref rid="B11" ref-type="bibr">11</xref>). However, despite the initial success, many key issues such as insufficient chemical-target binding data, unlabeled chemical-target interactions, ambiguous target relationships, and lack of general-purpose chemical similarity remain unsolved.</p>
    <p>Herein, we present a novel evolutionary chemical binding similarity (ECBS) method using a classification similarity-learning framework defined with paired chemical data and target's evolutionary relationship (Figure <xref ref-type="fig" rid="F1">1</xref>). The ECBS method is designed to encode molecular features enriched in evolutionarily conserved chemical-target binding relationships, and formulated by the likelihood of chemical compounds binding to identical targets. The inclusion of evolutionary information linked to chemical compounds through their binding targets (Figure <xref ref-type="fig" rid="F1">1A</xref> and <xref ref-type="fig" rid="F1">B</xref>) is a unique property of the ECBS method that enables substantial expansion of available chemical-target interaction data, contributing to significant improvement of model performance. Details regarding the model construction and performance evaluation are described in the following sections.</p>
    <fig id="F1" orientation="portrait" position="float">
      <label>Figure 1.</label>
      <caption>
        <p>Overview of evolutionary chemical binding similarity (ECBS) method. (<bold>A</bold>) The simplified chemical-target-evolutionary relationship is used as an example for a schematic description of different ECBS models. The ‘C’ in the first layer means a chemical compound, the ‘T’ means a target, and the ‘F’ represents arbitrary evolutionary information (e.g. family). The C-T connection is defined by the direct binding between C and T, and T-F is defined by the evolutionary class information F of the target T. The chemical pairs are classified based on the evolutionary relationship of binding targets. For example, C1–C2, C3–C4 and C5–C6 are evolutionarily related chemical pairs (ERCPs) by the common binding targets, and C1–C3, C1–C4, C2–C3 and C2–C4 are also ERCPs defined by F1. The other unrelated chemical pairs are considered as negative data. (<bold>B</bold>) The conceptual classification scheme for different ECBS models is depicted using the example in (A). In the QSAR-like model, active molecules are defined for the target T1 and the classification model (dotted line) clusters them together in chemical feature space. In the Target-ECBS model, the ERCPs defined by the multiple targets (T1, T2 and T3) will be clustered by the model, but the ERCPs by T1 and T2 are likely to have closer distances in chemical feature space because of the similar molecular features for binding to the evolutionarily conserved binding pocket defined by F1. On the other hand, the Family-ECBS model starts to consider the ERCPs defined by evolutionary information of the targets (chemical pairs in the green background). These additional ERCPs will make an enhancement effect to locate the F1-related chemical compounds in close proximity by presenting evolutionarily conserved features more evidently. The TS-Family-ECBS model is a target-specific Family-ECBS model that only considers the ERCPs defined from the targets evolutionarily related to the predefined target T1 (square box). Therefore, the model construction procedure is identical to the Family-ECBS model except that C5–C6 is excluded because the target T3 has no evolutionary relationship to T1 or T2. Compared to the target-specific model, the Target-ECBS and Family-ECBS are categorized as a unified model, because it considers multiple and heterogeneous chemical-target binding information altogether.</p>
      </caption>
      <graphic xlink:href="gkz743fig1"/>
    </fig>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Collection of chemical-target binding data</title>
      <p>Chemical structures and target-binding information were collected from the DrugBank (<xref rid="B19" ref-type="bibr">19</xref>) and BindingDB (<xref rid="B20" ref-type="bibr">20</xref>) databases. In the DrugBank database, drug-target interaction data (28 July 2017) were retrieved only for ‘polypeptide’ targets and used to obtain Structure Data Format (SDF) files for the drugs. In the BindingDB database, the 2D SDF file was downloaded (BindingDB_All_terse_2D_2018m3.sdf updated on 1 April 2018) and parsed to obtain binding affinity data represented by <italic>K</italic><sub>i</sub>, IC<sub>50</sub>, <italic>K</italic><sub>d</sub> and EC<sub>50</sub> values. To exclude low-affinity promiscuous binding, interactions were considered only when the affinity determined by any of the measurements was below 100 nM. As a result, the total number of small molecules, targets, and interactions were 6671, 4283 and 16 587 in DrugBank, and 587 693, 5425 and 1 018 895 in BindingDB, respectively. The two databases were integrated after removing redundant small molecules by comparing InChIKey (<xref rid="B21" ref-type="bibr">21</xref>) for the construction of target-specific ECBS models.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Definition of evolutionarily related chemical pairs</title>
      <p>Homologous target proteins usually have evolutionarily conserved ligand binding sites and perform similar biological functions (<xref rid="B22" ref-type="bibr">22</xref>). In the present study, it is assumed that the structural and functional similarity between homologous proteins can be transferred to their binding chemical compounds because they are likely to share common three-dimensional (3D) pharmacophore features to bind similar structural environments in the conserved pocket (<xref rid="B23" ref-type="bibr">23</xref>). Accordingly, the chemical compounds that bind identical or homologous targets are considered as ‘evolutionarily related’, and the chemical pairs which have a common evolutionary target, domain, family, or superfamily annotation in their binding targets are defined as ‘evolutionarily related chemical pairs’ (ERCPs) (Figure <xref ref-type="fig" rid="F1">1A</xref>). The evolutionary information of targets can vary according to the definition of homology between targets.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Multiple annotations of evolutionary information to target genes</title>
      <p>To avoid mislabeling in proteomic-scale evolutionary annotations for target genes, we incorporated evolutionary motif, domain, family and superfamily information defined in highly qualified and curated protein databases. The databases used in this study were UniProtKB (<xref rid="B24" ref-type="bibr">24</xref>), PFAM (<xref rid="B25" ref-type="bibr">25</xref>), SMART (<xref rid="B26" ref-type="bibr">26</xref>), PRINT (<xref rid="B27" ref-type="bibr">27</xref>), Gene3D (<xref rid="B28" ref-type="bibr">28</xref>), TIGRFAM (<xref rid="B29" ref-type="bibr">29</xref>), FAMILY (<xref rid="B30" ref-type="bibr">30</xref>) and SUPERFAMILY (<xref rid="B30" ref-type="bibr">30</xref>). Identifiers for target genes were unified by UniProtKB entry name. The InterPro (<xref rid="B31" ref-type="bibr">31</xref>) database (protein2ipr.dat) was used to map UniProtKB entry names to the protein databases.</p>
      <p>The Superfamily (1.75) server provided hidden Markov models (HMMs) pre-built for 2478 sequenced genomes, which enabled flexible structural protein domain annotation for the target genes using the SCOP family and superfamily ID. The HMM library (<ext-link ext-link-type="uri" xlink:href="http://supfam.org/SUPERFAMILY/downloads/license/supfam-local-1.75/">http://supfam.org/SUPERFAMILY/downloads/license/supfam-local-1.75/</ext-link>) in the Superfamily database was applied to all target sequences using the script ‘superfamily.pl’ (downloaded from the Superfamily server) with default options to annotate family and superfamily-level description to targets. In summary, target genes were annotated by diverse evolutionary information such as a sequence-based motif, domain, family, and structure-based family and superfamily information.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Feature vector generation for representing a chemical pair</title>
      <p>Structural information (formatted by the SDF file) for each chemical compound was converted to chemical binary fingerprints using ChemmineR and ChemmineOB cheminformatics packages in R (<xref rid="B32" ref-type="bibr">32</xref>). A fingerprint is a collection of predefined features regarding a local fragment found within a structure and is typically represented by a bit-string where 1 and 0 indicate ‘existence’ and ‘absence’ of each feature. MACCS (256 bits) and FP4 (512 bits) fingerprints available in the ChemmineOB package were concatenated to represent each chemical compound using a 768-bit numeric vector. The fingerprints with empty values for all drugs in DrugBank were discarded to reduce the dimension of feature space, which eventually generated a 386-bit feature vector representing an individual chemical compound. The feature vector for a chemical pair was subsequently generated by element-wise summation of the chemical fingerprints as follows.<disp-formula><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*} {V_{ij}} = {V_{ji}}{\rm{\ }} = {V_i}{\rm{\ }} + {V_j}, \end{eqnarray*}$$\end{document}</tex-math></disp-formula>where <italic>V<sub>i</sub></italic> is a fingerprint for chemical i and <italic>V<sub>j</sub></italic> for chemical <italic>j</italic>.</p>
      <p>The element-wise summation of <italic>V<sub>i</sub></italic> and <italic>V<sub>j</sub></italic> generated <italic>V<sub>ij</sub></italic>, a feature vector for a chemical pair, where the elements 0, 1 and 2 indicate ‘none’, ‘different’, and ‘common’ features, respectively.</p>
    </sec>
    <sec id="SEC2-5">
      <title>Classification similarity-learning for modeling chemical binding similarity</title>
      <p>The collected chemical pair, target, and evolutionary data (Figure <xref ref-type="fig" rid="F1">1A</xref>) were used to build ECBS models by classification similarity-learning. Specifically, an ECBS model was designed to classify ERCPs from ‘unrelated chemical pairs’ and so the output value by the ECBS model represented a chemical similarity score prioritizing the selection of ERCPs. The model was trained as follows:</p>
      <p>Training data: <inline-formula><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\{ {V_{11}},{V_{12}},{V_{13}}, \ldots ,{V_{nm}}\}$\end{document}</tex-math></inline-formula>, where <italic>V<sub>nm</sub></italic> is a feature vector for a chemical pair consisted of V<sub>n</sub> and V<sub>m</sub>.</p>
      <p>The data label <inline-formula><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${l_{nm}}$\end{document}</tex-math></inline-formula> for V<sub>nm</sub> is defined as follows:<disp-formula><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{l_{nm}} = \left\{ {\begin{array}{@{}*{1}{c}@{}} {\ 1\left( {{\rm{positive}}\,{\rm{data}}} \right)\ \,{\rm{if}}\ E{V_X}({V_n}) = E{V_X}({V_m})}\\ {0\ \left( {{\rm{negative\ data}}} \right)\ \quad \quad \quad \quad {\rm{otherwise}}} \end{array}} \right.,\end{equation*}$$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$E{V_X}({V_n})$\end{document}</tex-math></inline-formula> represents an evolutionary annotation <italic>X</italic> for the targets of a chemical compound V<sub>n</sub>. Accordingly, the data label can be defined in many different ways according to the evolutionary information used to train ECBS models. For example, in the Target-ECBS model (Figure <xref ref-type="fig" rid="F1">1B</xref>), ERCPs (positive data) are defined by the identity of binding targets, whereas in Family-ECBS model, ERCPs are defined by the chemicals that have common ‘Family’ annotation in the binding targets.</p>
      <p>Target-specific ECBS model is designed to overcome the data size limitation of the unified ECBS model. The model requires a predefined target (e.g. T1 for TS-Family-ECBS in Figure <xref ref-type="fig" rid="F1">1B</xref>) and the positive data (ERCPs) are only defined for the targets evolutionarily related to the predefined target. Thus, in the target-specific model, for a given target <italic>T</italic>, the label <inline-formula><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${l_{nm}}$\end{document}</tex-math></inline-formula> for V<sub>nm</sub> is defined as follows:<disp-formula><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{l_{nm}} = \left\{ {\begin{array}{@{}*{1}{c}@{}} {1\,\,\left( {{\rm{positive\ data}}} \right)\,\,{\rm{if}}\,E{V_X}({V_n}) = E{V_X}({V_m}), E{V_X}({V_n}) \cap E{V_X}({V_m}) \ni T\ }\\ {0\,\ \left( {{\rm{negative\ data}}} \right)\quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad {\rm{otherwise}}} \end{array}} \right.,\end{equation*}$$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$E{V_X}({V_n}) \cap E{V_X}({V_m}) \ni T$\end{document}</tex-math></inline-formula> means that the predefined target <italic>T</italic> should have the common evolutionary annotation <italic>X</italic> for the targets of a chemical compound V<sub>n</sub> and V<sub>m</sub>. Schematic model description for each ECBS variant is shown in Figure <xref ref-type="fig" rid="F1">1</xref>. Details are in the Results section.</p>
    </sec>
    <sec id="SEC2-6">
      <title>Sampling unrelated chemical pairs</title>
      <p>Sampling negative data can be important to determine the model quality (<xref rid="B33" ref-type="bibr">33</xref>,<xref rid="B34" ref-type="bibr">34</xref>), because the current chemical-target binding data is highly imbalanced, with much larger amounts of unrelated chemical pairs (negative data). Thus, a procedure for sampling unrelated chemical pairs was designed to balance with the positive data (ERCPs) and to avoid possible overfitting towards the abundant negative data.</p>
      <p>Specifically, six negative chemical pairs for each positive pair were generated by sampling chemical pairs which are structurally similar but evolutionarily unrelated to the positive pair. The chemical database was first scanned to find chemical compounds structurally similar but evolutionarily unrelated to a positive chemical pair P<sub>a</sub>–P<sub>b</sub>. Next, three molecules (N<sub>a1</sub>, N<sub>a2</sub> and N<sub>a3</sub>) most similar to P<sub>a</sub> were paired with P<sub>b</sub>, resulting in three negative chemical pairs P<sub>b</sub>–N<sub>a1</sub>, P<sub>b</sub>–N<sub>a2</sub> and P<sub>b</sub>–N<sub>a2</sub>. An identical procedure for P<sub>b</sub> generated another three negative chemical pairs P<sub>a</sub>–N<sub>b1</sub>, P<sub>a</sub>–N<sub>b2</sub> and P<sub>a</sub>–N<sub>b2</sub>. The generated negative data were excluded if 2D structure similarity was too high (Tanimoto coefficient &gt; 0.85) or evolutionarily related by at least one of the evolutionary databases.</p>
    </sec>
    <sec id="SEC2-7">
      <title>Random forest classifier for ECBS model generation</title>
      <p>Various machine learning techniques have been successfully applied in bio- and cheminformatics. However, in this study, available methods were limited because a large amount of paired chemical data (positive pairs: <sub>N</sub>C<sub>2</sub> + negative pairs: 6 x <sub>N</sub>C<sub>2</sub>) hindered efficient parameter tuning and model training. Therefore, we chose to use ‘<italic>ranger</italic>’, a fast implementation of random forest classifier, because it features less-adjustable parameters, fast runtime, and efficient memory usage particularly suited for high-dimensional data (<xref rid="B35" ref-type="bibr">35</xref>). For training the ECBS models, <italic>ranger</italic> parameters were set with the following options: <italic>num.trees = 200 or 500, save.memory = TRUE</italic>, and down-weighting negative samples by 0.35 with the <italic>case.weights</italic> option. Feature vectors for ERCPs (positive data) and unrelated pairs (negative data) were generated and trained to predict the data labels according to different evolutionary information of target genes, each of which resulted in <italic>X</italic>-ECBS model where <italic>X</italic> represented arbitrary evolutionary information used to train the model.</p>
    </sec>
    <sec id="SEC2-8">
      <title>Generation of an ensemble ECBS model</title>
      <p>An ensemble ECBS (ensECBS) classifier integrating all <italic>X</italic>-ECBS models was built by <italic>ranger</italic> package based on the output scores from the individual <italic>X</italic>-ECBS models (Figure <xref ref-type="fig" rid="F2">2</xref>). The ensemble model was trained as follows:</p>
      <fig id="F2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>The model structure of the ensemble ECBS model. An input chemical pair is scored by the individual <italic>X</italic>-ECBS models defined by different evolutionary relationship (‘<italic>X</italic>’ represents target, domain, family, and superfamily in this case). The scores from all <italic>X</italic>-ECBS models are integrated by the ensemble model to generate a final chemical binding similarity score.</p>
        </caption>
        <graphic xlink:href="gkz743fig2"/>
      </fig>
      <p>Training data: {<italic>X<sub>1</sub></italic>-ECBS<sub>nm</sub>, <italic>X<sub>2</sub></italic>-ECBS<sub>nm</sub>,..., <italic>X<sub>j</sub></italic>-ECBS<sub>nm</sub>}, where <italic>X<sub>j</sub></italic>-ECBS<sub>nm</sub> represents a similarity score for a chemical pair V<sub>n</sub> and V<sub>m</sub> calculated by the <italic>X<sub>j</sub></italic>-ECBS model trained by evolutionary information <italic>X<sub>j</sub></italic>. The label <inline-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${l_{nm}}$\end{document}</tex-math></inline-formula> for a chemical pair V<sub>n</sub> and V<sub>m</sub> is defined as follows:<disp-formula><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{l_{nm}} = \left\{ {\begin{array}{@{}*{1}{c}@{}} {1\left( {{\rm{positive}}\,{\rm{data}}} \right){\rm{if}}\,E{V_{Target}}({V_n}) = E{V_{Target}}({V_m})}\\ {0\ \left( {{\rm{negative}}\,{\rm{data}}} \right)\quad \quad \quad \quad \quad \quad {\rm{otherwise}}} \end{array}} \right.\end{equation*}$$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$E{V_{Target}}({V_n})$\end{document}</tex-math></inline-formula> represents a target identity for a chemical compound V<sub>n</sub>.</p>
      <p>The predicted scores for the cross-validation test set by each <italic>X</italic>-ECBS model were used to train the ensECBS model. Specifically, all the test scores from the cross-validation procedures were combined and split into five sets. One set (20%) was only used to train the model to avoid possible overfitting problem, and the rest (80%) was tested for model validation. The procedure was repeated five times with the identical <italic>ranger</italic> parameters used to train <italic>X</italic>-ECBS models. Furthermore, the trained model was further validated with another independently generated dataset (test set generation is described in the following section). The test results for the cross-validation set and the independent set were used to estimate the prediction performance of the ensemble ECBS models (Table <xref rid="tbl1" ref-type="table">1</xref>). To check the robustness of the ensemble models, the whole test procedure was repeated 100 times and the stability of the model performance was confirmed (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>).</p>
      <table-wrap id="tbl1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>Summary of ECBS model performance according to different model type and test set</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th colspan="2" align="left" rowspan="1">Test set</th>
              <th colspan="2" align="center" rowspan="1">Cross-validation set</th>
              <th colspan="2" align="center" rowspan="1">Independent set</th>
            </tr>
            <tr>
              <th colspan="2" align="left" rowspan="1">Performance (AUC)</th>
              <th rowspan="1" colspan="1">PR</th>
              <th rowspan="1" colspan="1">ROC</th>
              <th rowspan="1" colspan="1">PR</th>
              <th rowspan="1" colspan="1">ROC</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Ensemble models</td>
              <td rowspan="1" colspan="1">TS-ensECBS</td>
              <td rowspan="1" colspan="1">0.8555</td>
              <td rowspan="1" colspan="1">0.9672</td>
              <td rowspan="1" colspan="1">0.8181</td>
              <td rowspan="1" colspan="1">0.9316</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">(avg. TS-<italic>X</italic>-ECBS*)</td>
              <td rowspan="1" colspan="1">(0.7013)</td>
              <td rowspan="1" colspan="1">(0.9337)</td>
              <td rowspan="1" colspan="1">(0.5962)</td>
              <td rowspan="1" colspan="1">(0.8169)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">ensECBS</td>
              <td rowspan="1" colspan="1">0.6964</td>
              <td rowspan="1" colspan="1">0.8872</td>
              <td rowspan="1" colspan="1">0.7704</td>
              <td rowspan="1" colspan="1">0.8895</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">(avg. <italic>X</italic>-ECBS*)</td>
              <td rowspan="1" colspan="1">(0.6545)</td>
              <td rowspan="1" colspan="1">(0.8778)</td>
              <td rowspan="1" colspan="1">(0.7350)</td>
              <td rowspan="1" colspan="1">(0.9064)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Single evolutionary models</td>
              <td rowspan="1" colspan="1">Target-ECBS+</td>
              <td rowspan="1" colspan="1">0.5609</td>
              <td rowspan="1" colspan="1">0.8086</td>
              <td rowspan="1" colspan="1">0.7307</td>
              <td rowspan="1" colspan="1">0.8839</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Pfam-ECBS</td>
              <td rowspan="1" colspan="1">0.5891</td>
              <td rowspan="1" colspan="1">0.8331</td>
              <td rowspan="1" colspan="1">0.6909</td>
              <td rowspan="1" colspan="1">0.888</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Family-ECBS</td>
              <td rowspan="1" colspan="1">0.6487</td>
              <td rowspan="1" colspan="1">0.8762</td>
              <td rowspan="1" colspan="1">0.7026</td>
              <td rowspan="1" colspan="1">0.8979</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Superfamily-ECBS</td>
              <td rowspan="1" colspan="1">0.6438</td>
              <td rowspan="1" colspan="1">0.8745</td>
              <td rowspan="1" colspan="1">0.6937</td>
              <td rowspan="1" colspan="1">0.8915</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">TS-Target-ECBS</td>
              <td rowspan="1" colspan="1">0.6663</td>
              <td rowspan="1" colspan="1">0.9047</td>
              <td rowspan="1" colspan="1">0.5332</td>
              <td rowspan="1" colspan="1">0.7536</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">TS-Pfam-ECBS</td>
              <td rowspan="1" colspan="1">0.6904</td>
              <td rowspan="1" colspan="1">0.9281</td>
              <td rowspan="1" colspan="1">0.4396</td>
              <td rowspan="1" colspan="1">0.6930</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">TS-Family-ECBS</td>
              <td rowspan="1" colspan="1">0.6933</td>
              <td rowspan="1" colspan="1">0.9305</td>
              <td rowspan="1" colspan="1">0.4088</td>
              <td rowspan="1" colspan="1">0.6319</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">TS-Superfamily-ECBS</td>
              <td rowspan="1" colspan="1">0.5689</td>
              <td rowspan="1" colspan="1">0.8604</td>
              <td rowspan="1" colspan="1">0.4011</td>
              <td rowspan="1" colspan="1">0.6787</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">TS-SMART-ECBS</td>
              <td rowspan="1" colspan="1">0.6086</td>
              <td rowspan="1" colspan="1">0.8557</td>
              <td rowspan="1" colspan="1">0.4600</td>
              <td rowspan="1" colspan="1">0.7355</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">TS-PRINT-ECBS</td>
              <td rowspan="1" colspan="1">0.6083</td>
              <td rowspan="1" colspan="1">0.8558</td>
              <td rowspan="1" colspan="1">0.4423</td>
              <td rowspan="1" colspan="1">0.7002</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">TS-TIGR-ECBS</td>
              <td rowspan="1" colspan="1">0.3465</td>
              <td rowspan="1" colspan="1">0.6875</td>
              <td rowspan="1" colspan="1">0.3095</td>
              <td rowspan="1" colspan="1">0.6329</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">TS-Gene3D-ECBS</td>
              <td rowspan="1" colspan="1">0.4950</td>
              <td rowspan="1" colspan="1">0.8069</td>
              <td rowspan="1" colspan="1">0.4049</td>
              <td rowspan="1" colspan="1">0.6740</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Ligand-based structure similarity</td>
              <td rowspan="1" colspan="1">LIGSIFT (ShapeSim)</td>
              <td rowspan="1" colspan="1">0.2187</td>
              <td rowspan="1" colspan="1">0.5604</td>
              <td rowspan="1" colspan="1">0.3733</td>
              <td rowspan="1" colspan="1">0.6135</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">LIGSIFT (ChemSim)</td>
              <td rowspan="1" colspan="1">0.2204</td>
              <td rowspan="1" colspan="1">0.5571</td>
              <td rowspan="1" colspan="1">0.3794</td>
              <td rowspan="1" colspan="1">0.6178</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Lisica (2D)</td>
              <td rowspan="1" colspan="1">0.3314</td>
              <td rowspan="1" colspan="1">0.6500</td>
              <td rowspan="1" colspan="1">0.5395</td>
              <td rowspan="1" colspan="1">0.7437</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Lisica (3D)</td>
              <td rowspan="1" colspan="1">0.3244</td>
              <td rowspan="1" colspan="1">0.6490</td>
              <td rowspan="1" colspan="1">0.5534</td>
              <td rowspan="1" colspan="1">0.7531</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">2D structure similarity</td>
              <td rowspan="1" colspan="1">0.2537</td>
              <td rowspan="1" colspan="1">0.5716</td>
              <td rowspan="1" colspan="1">0.4865</td>
              <td rowspan="1" colspan="1">0.7225</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="T1TFN1">
            <p>*All single ECBS scores are averaged to compare with the ensemble models.</p>
          </fn>
          <fn id="T1TFN2">
            <p><sup>+</sup>Reference original method, Park <italic>et al.</italic> (2011).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The target-specific ensemble model (TS-ensECBS) integrating all target-specific ECBS (TS-<italic>X</italic>-ECBS) and unified ECBS (<italic>X</italic>-ECBS) models was built (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2</xref>) and tested in the same manner. One difference was that the TS-ensECBS model included additional data size information into the training data to reduce target-specific bias. The training data for a given target <italic>T</italic> were defined as follows.</p>
      <p>Training data: {TS-<italic>X<sub>1</sub></italic>-ECBS<sub>nm</sub>,...,TS-<italic>X<sub>i</sub></italic>-ECBS<sub>nm</sub>, <italic>X<sub>1</sub></italic>size,...,<italic>X<sub>i</sub></italic>size, <italic>X<sub>1</sub></italic>-ECBS<sub>nm</sub>,...,<italic>X<sub>j</sub></italic>-ECBS<sub>nm</sub>}, where TS-<italic>X<sub>i</sub></italic>-ECBS<sub>nm</sub> represents a similarity score for a chemical pair V<sub>n</sub> and V<sub>m</sub> calculated by the TS-<italic>X<sub>i</sub></italic>-ECBS model built for a target <italic>T</italic>, <italic>X<sub>i</sub></italic>size represents a trained data size of the TS-<italic>X<sub>i</sub></italic>-ECBS model, and <italic>X<sub>j</sub></italic>-ECBS<sub>nm</sub> represents a similarity score for a chemical pair V<sub>n</sub> and V<sub>m</sub> calculated by the unified <italic>X<sub>j</sub></italic>-ECBS model.</p>
      <p>The inclusion of the amount of evolutionary information (<italic>X</italic><sub><italic>i</italic></sub>size) in the feature vector was to down weight the scores calculated by the TS-<italic>X</italic>-ECBS models which were built on a very small amount of evolutionary data. Each type of evolutionary information contributed very differently to the model's accuracy, which correlated to the amount of available information in the training dataset (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S3</xref>). The output scores (<italic>X<sub>j</sub></italic>-ECBS<sub>nm</sub>) from the unified <italic>X</italic>-ECBS models were included to compensate for possible defects of the TS-<italic>X</italic>-ECBS models caused by the limited usage of chemical-target binding information (See the Results section for a comparison between the target-specific and unified model).</p>
    </sec>
    <sec id="SEC2-9">
      <title>Cross-validation test set for evaluating ECBS models</title>
      <p>A test chemical pair dataset was generated by splitting all binding targets into 12 sets. Among them, 11 sets were used to train the model, and the remaining one was used to validate model performance (12-fold cross-validation). For example, in Figure <xref ref-type="fig" rid="F3">3</xref>, a target T1 is selected as a test set, so the chemical pair C1–C2 (dotted line in Figure <xref ref-type="fig" rid="F3">3A</xref>) which commonly binds to T1 is assumed to be unknown (test chemical pair). On the other hand, the other chemicals such as C3, C4, C5 and C6 are used to train ECBS models by defining ERCPs (Figure <xref ref-type="fig" rid="F3">3B</xref>) based on the chemical-target-evolutionary relationships in Figure <xref ref-type="fig" rid="F3">3A</xref>.</p>
      <fig id="F3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Cross-validation test set for evaluating the ECBS models (<bold>A</bold>) The simplified chemical-target-evolutionary relationships similar to Figure <xref ref-type="fig" rid="F1">1A</xref> are defined to schematically show how the ECBS models are differently trained and how the test chemical pairs are generated by splitting the target set. For clarity, the ERCPs (positive data in training) and their relationships are also represented by a network where the blue edge represents the ECRPs defined by target identity, the green edge represents the ERCPs defined by evolutionary information F1, and the dotted edge is the test chemical pair. Arbitrary unrelated chemical pairs (negative data) are shown by grey nodes and edges. (<bold>B</bold>) For the cross-validation, binding targets are split into test and training set (1:11). In the example where T1 is selected as the test target, all ERCPs defined by T1 (i.e. C1–C2) are considered as a blind test set common for all ECBS models. To predict the test data, each ECBS model differently organizes the training set by the different definition of ECRPs (Figure <xref ref-type="fig" rid="F1">1B</xref>). For example, Target-ECBS only considers C3–C4 and C5–C6 as ECRPs, whereas Family-ECBS additionally considers C2–C3 and C2–C4 through the F1 information. On the other hand, the target-specific models exclude C5–C6 in the training set because T4 is not annotated by F1.</p>
        </caption>
        <graphic xlink:href="gkz743fig3"/>
      </fig>
      <p>According to the model type and definition of evolutionary information (Figure <xref ref-type="fig" rid="F1">1B</xref>), each ECBS model differently uses the chemical-target-evolutionary relationships in the training procedure. For instance, Target-ECBS only considers C3–C4 (by T3) and C5–C6 (by T4) as positive data (ERCP) for training, whereas Family-ECBS additionally considers C2–C3 and C2–C4 as positive data by F1 family annotation (Figure <xref ref-type="fig" rid="F3">3B</xref>). On the other hand, target-specific (TS-) ECBS models only consider the targets evolutionarily related to the predefined target T1 to define ERCPs, which is why TS-Target-ECBS for T1 only uses C3–C4 as positive data without C5–C6. The negative data are generated by sampling the chemical pairs which are structurally similar but evolutionarily unrelated to the corresponding ERCPs.</p>
      <p>The cross-validation by splitting targets instead of chemical pairs was to test the effectiveness of evolutionary information by assuming that all direct chemical binding information for a test target is unknown. Without direct target binding information, chemical similarity scores will be estimated only through the indirect evolutionary information, which is very hard to achieve by traditional QSAR methods.</p>
    </sec>
    <sec id="SEC2-10">
      <title>Independent test set for evaluating ECBS models</title>
      <p>Another test set was independently generated by using drug-target binding data recently updated in DrugBank. The newly updated data in the file downloaded in December 2018 (the previous version was retrieved in July 2017) included 360 drugs, 202 targets, and 915 drug-target interactions. Among them, only the targets whose TS-<italic>X</italic>-ECBS model was built with more than two chemical compounds were considered for comparison. As a result, the independent test set contained 1538 ERCPs defined by target identity (positive data). The fourfold unrelated chemical pairs (negative data) were generated in the same way used to build the cross-validation set. Any redundant chemical pairs to the cross-validation or training set were deleted from the test set.</p>
    </sec>
    <sec id="SEC2-11">
      <title>Performance evaluation by precision-recall curve</title>
      <p>Area under the curve (AUC) values in precision-recall (PR) and receiver operating characteristic (ROC) curves were calculated to estimate the prediction performance. It is well-known that the ROC (true positive rate vs. false positive rate) is inappropriate to test highly imbalanced data with a much higher amount of negative samples, because the false positive rate is significantly affected by high true negative (TN) values. However, the PR curve is negligibly affected by a large number of negative samples, because precision depends on the true positive (TP) and false positive (FP) values (<xref rid="B36" ref-type="bibr">36</xref>).<disp-formula><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\rm{Precision}} = \frac{{{\rm{TP}}}}{{{\rm{TP}} + {\rm{FP}}}}\ \end{equation*}$$\end{document}</tex-math></disp-formula><disp-formula><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\rm{Recall}} = \frac{{{\rm{TP}}}}{{{\rm{TP}} + {\rm{FN}}}}\ \end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>The higher sensitivity of the PR curve towards positive samples makes it more suitable for the evaluation of model performance by focusing on positive samples. The ‘<italic>PRROC</italic>’ R package was used to calculate AUC values in the PR and ROC curves (<xref rid="B37" ref-type="bibr">37</xref>).</p>
    </sec>
    <sec id="SEC2-12">
      <title>Chemical structure similarity</title>
      <p>The 386-bit fingerprint representing a chemical pair was identically used to calculate 2D chemical structure similarity using the Tanimoto coefficient (i.e. ratio of intersection-bits over union-bits). LiSiCA (Ligand Similarity using Clique Algorithm) (<xref rid="B38" ref-type="bibr">38</xref>) and LIGSIFT (<xref rid="B39" ref-type="bibr">39</xref>) were used with default options to calculate conformational ligand shape similarity. Because both methods are sensitive to 3D conformations of chemical structures, conformers for each chemical compound were generated using BEST method in Discovery Studio software (Dassault Systemes BIOVIA, Discovery Studio Modeling Environment, Release 4.5, 2015) with default options (RMSD cut-off: 0.2 Å). At the same time, the energy-minimized structure by CHARMm force field was also obtained for each compound. For a chemical pair V<sub>n</sub> and V<sub>m</sub>, the low energy 50 conformers of V<sub>n</sub> were compared to the energy-minimized structure of V<sub>m</sub> by LIGSIFT and LiSiCA, and the maximum value was considered as a representative similarity score for the chemical pair. For LIGSIFT, ShapeSim and ChemSim scores were used to calculate similarity scores, and for LiSiCA, 2D and 3D options were separately applied with <italic>-d</italic> option.</p>
    </sec>
    <sec id="SEC2-13">
      <title>Virtual screening by ECBS and <italic>in vitro</italic> kinase binding assay</title>
      <p>To screen new inhibitory chemical compounds for serine/arginine protein kinase 1 (SRPK1) and SRPK2, we used the TS-ensECBS models built for the targets to screen MarinLit (<xref rid="B40" ref-type="bibr">40</xref>) and Maybridge chemical database (screening collection). The ECBS scores between all chemicals in the database and NCC007 (<xref rid="B41" ref-type="bibr">41</xref>) were calculated using the respective TS-ensECBS model. The NCC007 is a recently found chemical compound initially discovered to have dual inhibition activities for casein kinase Iα (CKIα) and Iδ (CKIδ) but also show unexpected inhibition for SRPK1 and SRPK2 (<xref rid="B41" ref-type="bibr">41</xref>). The candidate molecules most similar to NCC007 by the ECBS scores were retrieved and tested by <italic>in vitro</italic> kinase binding assay.</p>
      <p>The KINOMEscan kinase assay provided by DiscoverX was used to measure competitive binding strength of the candidate molecules for SRPK1 and SRPK2. In the assay, high-affinity chemical compounds that prevent SRPK binding to the immobilized ligand reduce the amount of SRPK on the solid support, whereas low-affinity compounds have no effect. Thus, a higher percentage of SRPK dissociated from the immobilized ligand implies higher binding affinity. Details for the assay is described on the company website.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <sec id="SEC3-1">
      <title>The underlying principle of evolutionary chemical binding similarity</title>
      <p>In general, machine learning-based classification is designed to transform labeled samples originally located in a hardly-distinguishable feature space into a more clearly-separable space by adjusting the sample distances according to classification boundaries (<xref rid="B14" ref-type="bibr">14</xref>,<xref rid="B42" ref-type="bibr">42</xref>). Similarly, well-trained classification similarity-learning models should maintain close distances between identically labeled (similar) samples compared to those of differently labeled (dissimilar) samples by extracting effective distinguishing features (<xref rid="B14" ref-type="bibr">14</xref>,<xref rid="B43" ref-type="bibr">43</xref>). Moreover, formulation of similarity in a classification similarity-learning framework should allow a group of samples sharing common critical features to be clustered together at close distances in a transformed feature space even for mislabeled or weakly related samples (<xref rid="B16" ref-type="bibr">16</xref>,<xref rid="B44" ref-type="bibr">44</xref>). In the present study, the intrinsic property of classification similarity-learning was used to define target-centric chemical binding similarity.</p>
      <p>We implemented the classification similarity-learning models in various formats according to the input data type, model type, and evolutionary information (Figure <xref ref-type="fig" rid="F1">1B</xref>). The details of different ECBS models will be discussed with the simplified chemical-target-evolutionary relationships shown in Figure <xref ref-type="fig" rid="F1">1A</xref>. In addition, the schematic figure is shown together for each ECBS model (Figure <xref ref-type="fig" rid="F1">1B</xref>) to represent how the classification similarity-learning conceptually works for the chemical pairs to calculate ECBS scores. In Figure <xref ref-type="fig" rid="F1">1A</xref>, the chemical-target relationship is defined by direct binding and the target-evolutionary relationship by annotated groups of homologous targets that have a common ancestry. Because of the diverse definition of evolutionary information, multiple ECBS models were built and labeled as <italic>X</italic>-ECBS model, where <italic>X</italic> represented arbitrary evolutionary information used to train the model.</p>
    </sec>
    <sec id="SEC3-2">
      <title>QSAR-like</title>
      <p>A QSAR model is typically built by collecting active and inactive chemical compounds for a predefined target. The activity can be determined by either phenotypic profile or direct target-binding, and the classification model is constructed to prioritize active compounds sharing pharmacophore features for the target. Thus, the resulting QSAR model is expected to group the active compounds together in chemical feature space (Figure <xref ref-type="fig" rid="F1">1B</xref>). The input data type of QASR model is a set of chemical compounds, and the model is built for a predefined single target (i.e. target-specific) without consideration of evolutionary information.</p>
    </sec>
    <sec id="SEC3-3">
      <title>Target-ECBS</title>
      <p>In contrast to QSAR models, the input data type of all ECBS models are chemical pairs required to apply classification similarity-learning. In the ECBS models, chemical pairs are categorized into positive and negative pairs, where the former represents ERCPs that bind either identical or evolutionarily related target, and the latter represents evolutionarily unrelated chemical pairs. The Target-ECBS model defines the positive pairs only by target identity. For example, in Figure <xref ref-type="fig" rid="F1">1A</xref>, the chemical pairs, C1–C2 (by T1), C3–C4 (by T2) and C5–C6 (by T3) are considered as positive pairs and are likely to be grouped together in arbitrary feature space by the classification similarity-learning model. Because target T1 and T2 are evolutionarily related by F1 (family-level annotation), C1–C2 and C3–C4 will likely share evolutionarily conserved molecular features necessary for target binding, and thus, it should be straightforward for a similarity-learning classifier to cluster C1, C2, C3 and C4 in close proximity (Figure <xref ref-type="fig" rid="F1">1B</xref>). The C5–C6 defined by T3 will be clustered by themselves in isolated feature space with coupled negative data. As a result, chemical compounds from T1 and T2, and those from T3, respectively, will have high chemical binding similarity.</p>
      <p>Accordingly, the Target-ECBS model can consider multiple targets at the same time through the unified classification similarity-learning framework, which ‘intrinsically’ reveals hidden ERCPs such as C1–C3, C1–C4, C2–C3 and C2–C4 without specifying F1 information (target identity is the only information used to train the model). The Target-ECBS model is used as a reference method to test the effectiveness of evolutionary information.</p>
    </sec>
    <sec id="SEC3-4">
      <title>Family-ECBS</title>
      <p>The Family-ECBS model starts to explicitly consider evolutionary information to estimate chemical binding similarity. In Figure <xref ref-type="fig" rid="F1">1A</xref>, the chemical pairs defined by evolutionarily related targets are C1–C3, C1–C4, C2–C3 and C2–C4 (by F1). Because the Family-ECBS model uses Family information to define ERCPs, the four chemical pairs are additionally considered as positives (shown in the green background in Figure <xref ref-type="fig" rid="F1">1B</xref>), which results in bigger cluster consisted of all F1-related chemical compounds by the classification similarity-learning model. Thus, the additional ERCPs defined by Family information are expected to reinforce the clustering effect in chemical feature space by presenting conserved molecular features for target-binding more evidently and by enriching the chemical-target binding information at multiple levels of evolutionary information. The ERCPs in Figure <xref ref-type="fig" rid="F1">1B</xref> (C1–C3, C1–C4, C2–C3 and C2–C4) are likely to share an abstract form of evolutionarily conserved molecular features, and this additional information can be useful to improve ECBS model performance when combined with the target-based molecular features.</p>
    </sec>
    <sec id="SEC3-5">
      <title>TS-Family-ECBS</title>
      <p>The TS-Family-ECBS model is a target-specific Family-ECBS model where positive chemical pairs are defined only from the targets evolutionarily related to a predefined target. For example, in Figure <xref ref-type="fig" rid="F1">1A</xref> where T1 is specified as the predefined target, the TS-Family-ECBS model only defines the chemical pairs evolutionarily related to T1 as ERCPs. Thus, all the chemical pairs defined by C1, C2, C3 and C4 are considered as ERCPs by target (T1, T2) or family (F1) but C5–C6 is excluded.</p>
      <p>Although the TS-Family-ECBS model is target-specific, it is still applicable to the case that chemical binding information for a predefined target is completely unknown because ERCPs can be also defined from evolutionarily related targets (e.g. C3–C4 by T2). The strengths and weakness of the unified (<italic>X</italic>-ECBS) and target-specific (TS-<italic>X</italic>-ECBS) models will be discussed in the following section.</p>
    </sec>
    <sec id="SEC3-6">
      <title>The unified and target-specific ECBS models</title>
      <p>All <italic>X</italic>-ECBS models were based on drug-target binding information in DrugBank because incorporating BindingDB data caused a practical memory problem during the model training procedure due to the quadratic growth of the paired chemical data. The number of available chemical-target interactions in DrugBank was 16 587 but increased to 1 018 895 by combining with BindingDB (ca. 60-fold increase). The big chemical dataset was not well tolerated by the unified <italic>X</italic>-ECBS models, and so the target-specific <italic>X</italic>-ECBS (TS-<italic>X</italic>-ECBS) model was proposed to overcome the data size limitation.</p>
      <p>Because the TS-<italic>X</italic>-ECBS models were built for a subset of targets, the ERCP data size could be significantly reduced without losing a lot of information regarding potentially related chemical pairs, and so the incorporation of BindingDB data became feasible. Plenty of chemical-target binding data for natural products and synthetic compounds in BindingDB other than drugs (<xref rid="B45" ref-type="bibr">45</xref>) was expected to improve the performance of ECBS models. Moreover, because of the reduced training data size, supplementary evolutionary information defined by SMART (<xref rid="B26" ref-type="bibr">26</xref>), PRINT (<xref rid="B27" ref-type="bibr">27</xref>), Gene3D (<xref rid="B28" ref-type="bibr">28</xref>), and TIGRFAM (<xref rid="B29" ref-type="bibr">29</xref>), could be adopted to maximize the use of evolutionary relationship data and diversify target-specific evolutionary information in addition to the PFAM, Family and Superfamily information. However, the prior target-specification can be a weakness of TS-<italic>X</italic>-ECBS models. If a predefined target lacks evolutionary information and has no homologous targets, the TS-<italic>X</italic>-ECBS model will be almost identical to the typical QSAR model.</p>
      <p>On the other hand, in the construction of ensemble model, all <italic>X</italic>-ECBS models are considered to have equivalent weight, so the output scores from each <italic>X</italic>-ECBS model are directly used as training data for constructing the secondary ensemble model (ensECBS) (Figure <xref ref-type="fig" rid="F2">2</xref>). However, the reliability of the output scores from each TS-<italic>X</italic>-ECBS model can vary according to a predefined target. For instance, if the predefined target is not annotated by evolutionary information <italic>X<sub>j</sub></italic>, the prediction accuracy of the TS-<italic>X<sub>j</sub></italic>-ECBS model will be very low for the target, because of the small amount of training data. To overcome the problem, information on the size of training data and output scores from the unified <italic>X</italic>-ECBS models for each target was additionally included in the training data to construct the ensemble model of target-specific ECBS models (TS-ensECBS) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2</xref>).</p>
    </sec>
    <sec id="SEC3-7">
      <title>Hidden evolutionary chemical relationship can be revealed by ECBS models</title>
      <p>The principal assumption of the ECBS models is that classification similarity-learning for the unified paired chemical data derived from heterogeneous target-binding information will compulsively cluster similar target-binding chemical compounds, maintain close distances, and eventually provide an effective chemical binding similarity score. The clustering effect is also expected to enable detection of novel ERCPs.</p>
      <p>To examine the assumption, we tested whether the basal Target-ECBS model could detect unknown ERCPs. Specifically, all-versus-all ECBS calculations for 1778 approved drugs (1 579 753 pairs) were performed using Target-ECBS and 2D structure similarity, respectively. Then, we focused on the drug pairs that had no common binding targets but showed high ECBS scores (i.e. false positives by the definition of Target-ECBS model) and checked how many of them bind to evolutionarily related targets. The drug pairs whose targets are not identical but evolutionarily related in at least one of the evolutionary databases were assumed to be a potential binding molecule for the respective target, because of the evolutionarily conserved structure-function relationship in homologous proteins. All drug pairs used to train the Target-ECBS model were excluded from the analysis.</p>
      <p>The results showed that the drugs pairs binding to evolutionarily related targets had higher similarity scores than unrelated pairs with a significant population difference (<italic>P</italic>-value &lt; 2.2e–16 by Student's t-test) by both Target-ECBS and 2D structure similarity (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4</xref>). When the detection ratio for ERCP was compared for the high-rank drug pairs, the Target-ECBS model detected ERCPs with a significantly higher ratio (e.g. 88% for top 100 pairs and 74% for top 1000), whereas 2D structure similarity showed low detection ratio (42% for the top 100 and 50% for the top 1000) (Figure <xref ref-type="fig" rid="F4">4</xref>). Overall results suggested that the assumption for the clustering effects between evolutionarily related chemical compounds is valid and effective by the classification similarity-learning models.</p>
      <fig id="F4" orientation="portrait" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>Hidden evolutionary chemical relationship revealed by Target-ECBS model. The ratios detecting ERCPs (whose targets are not identical but evolutionarily related) are compared between Target-ECBS and 2D chemical structure similarity. It is assumed that the ERCPs are potential target-binding molecules even though it is not experimentally validated. The chemical pairs are sorted by each similarity score and the ratio of ERCPs within ranks is plotted. The Target-ECBS model better describes the potential target-binding chemicals with high ERCP ratio.</p>
        </caption>
        <graphic xlink:href="gkz743fig4"/>
      </fig>
    </sec>
    <sec id="SEC3-8">
      <title>ECBS model performance for cross-validation and independent test set</title>
      <p>Two test sets were separately generated to estimate the prediction performance of ECBS models. One is a cross-validation set (Figure <xref ref-type="fig" rid="F3">3</xref>) and another is an independent test set created by extracting the recently updated drug-target information in DrugBank. The former is a comprehensive test set covering most chemical pairs in the database, and the latter is a much smaller test set that consists of completely unseen data. Overall model performance was estimated and compared by AUC values in the PR curve.</p>
      <p>The test results for the cross-validation set (Figure <xref ref-type="fig" rid="F5">5A</xref>) showed that ECBS models clearly outperformed the methods based on global structure similarity, such as LIGSIFT, LiSiCA and 2D structure similarity. Among the ECBS models, both ensECBS and TS-ensECBS showed better performance than Target-ECBS and TS-Target-ECBS, respectively, suggesting that evolutionary information was effective to improve the model performance. The TS-ensECBS model showed the best performance and clear separation of ERCPs (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S5</xref>), likely thanks to the richest training information including X-ECBS models.</p>
      <fig id="F5" orientation="portrait" position="float">
        <label>Figure 5.</label>
        <caption>
          <p>Test performance of ECBS models for (<bold>A</bold>) the cross-validation set and (<bold>B</bold>) the independent set are shown by the PR curve. The methods based on chemical structure similarity (LIGSIFT, LiSiCA and 2D structure similarity) are shown for comparison.</p>
        </caption>
        <graphic xlink:href="gkz743fig5"/>
      </fig>
      <p>The single evolutionary ECBS models other than Target-ECBS or TS-Target-ECBS model were designed to be ensembled with the target-based models, not to be used solely. As shown in Figure <xref ref-type="fig" rid="F3">3</xref>, the evolutionary models were trained to predict ERCPs as well as the common target-binding chemical pairs. However, the identical test set with the Target-ECBS model was used to evaluate the model for comparison (Table <xref rid="tbl1" ref-type="table">1</xref>). This extended definition of ERCPs in the evolutionary ECBS models might hinder the accurate prediction of the chemical pairs binding to common targets but the ensemble procedure was expected to resolve these issues by integrating all the information.</p>
      <p>Another test using the independent set showed comparable results despite the smaller data size (Figure <xref ref-type="fig" rid="F5">5B</xref>). One difference was the low performance of the TS-Target-ECBS model, suggesting that the performance of target-specific models can vary according to the selection of targets. However, the unified <italic>X</italic>-ECBS and the ensemble ECBS models consistently showed reasonable performance. The AUC values in PR and ROC curves for all individual and ensemble ECBS models are summarized in Table <xref rid="tbl1" ref-type="table">1</xref>.</p>
    </sec>
    <sec id="SEC3-9">
      <title>Virtual screening using ECBS</title>
      <p>Recently, we identified a novel dual inhibitor, NCC007, for CKIα and CKIδ, and demonstrated its functional role to control circadian rhythms through the CKI inhibition (<xref rid="B41" ref-type="bibr">41</xref>). Interestingly, comprehensive kinase profiling of NCC007 unexpectedly suggested that NCC007 also binds to SRPK1 and SRPK2, a potential therapeutic target for neovascular eye disease (<xref rid="B46" ref-type="bibr">46</xref>). Inspired by the finding, a virtual screening procedure was devised using ECBS and applied for SRPK1 and SRPK2 as another blind test. The TS-ensECBS models were built for SRPK1 and SRPK2, respectively, each of which was used to scan a virtual chemical library to find new chemical compounds evolutionarily related to NCC007. A total of five chemical compounds selected by TS-ensECBS were ordered and tested by <italic>in vitro</italic> kinase binding assay.</p>
      <p>The assay results revealed that the TS-ensECBS model successfully discovered new SRPK inhibitors with high accuracy (Figure <xref ref-type="fig" rid="F6">6</xref>). Out of five tested compounds, three for SRPK1 and one for SRPK2 showed promising binding affinity. Because none of the chemicals are known for SRPK inhibitor so far, they might serve as a novel lead compound for neovascular eye disease in the future.</p>
      <fig id="F6" orientation="portrait" position="float">
        <label>Figure 6.</label>
        <caption>
          <p>Blind test by virtual screening for SRPK1 and SRPK2 using TS-ensECBS. NCC007 is used to screen a virtual chemical library to identify novel compounds similar-binding to NCC007. The TS-ensECBS models built for SRPK1 and SRPK2, respectively, are used to calculate chemical similarity scores. The chemical compounds with high ECBS score are further validated by <italic>in vitro</italic> kinase binding assay. Three (MarinLit-14196, CD09767, XBX00307) for SRPK1 and one (XBX00307) for SRPK2 are confirmed to have considerable binding affinity.</p>
        </caption>
        <graphic xlink:href="gkz743fig6"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <sec id="SEC4-1">
      <title>Unique characteristics of different evolutionary information</title>
      <p>We find that evolutionary information has the following distinctive features: (i) different hierarchical levels defining an evolutionary class (e.g. motif, domain, family, and superfamily), (ii) source information used to extract evolutionary relationship (e.g. sequence or structure-based) and (iii) unique target annotation coverage.</p>
      <p>Specifically, evolutionary information of target genes has been defined at multiple levels such as a motif, domain, family, and superfamily. A motif is the smallest unit to define evolutionary relationships between targets, because it is mostly represented by a short nucleotide or amino acid pattern mediating a common function. A family represents a group of proteins that descend from a common ancestor and therefore are likely to share evolutionarily conserved structure, function, and sequence that possibly consist of multiple domains. A superfamily is a high level classification that the common ancestry is inferred by 3D structure similarity, even if no sequence similarity is evident. One superfamily often contains several protein families. Therefore, motif, domain, family, and superfamily information can provide a variety of chemical-target binding features which are evolutionarily conserved at different hierarchical levels.</p>
      <p>In the present study, seven protein databases, PFAM, SMART, TIGRFAM, PRINT, Gene3D, Family, and Superfamily, were used to represent diverse evolutionary features for targets. Because there is the possibility of generating unclear evolutionary relationships with single motif information, the PRINT database, which characterizes a family based on protein fingerprints (a group of conserved motifs), was only used to represent motif information. PFAM, TIGRFAM and SMART were used to provide a sequence-based annotation of domain or family, whereas Gene3D and Superfamily 2.0 databases were to provide structural information at the SCOP family/superfamily and CATH domain level.</p>
      <p>In addition, the target annotation coverage varied according to the annotation coverage of each database. For example, the PFAM, Family, and Superfamily information annotated more than 74% of targets, whereas SMART, TIGRFAM, PRINT and Gene3D showed &lt;50% target annotation coverages (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S6</xref>). It seemed that the target annotation coverage of each of evolutionary information was related to the performance of each <italic>X</italic>-ECBS model. For instance, the TS-TIGR-ECBS model based on TIGRFAM information showed the lowest performance for both test sets (Table <xref rid="tbl1" ref-type="table">1</xref>), which is likely due to the least evolutionary information annotated for targets.</p>
    </sec>
    <sec id="SEC4-2">
      <title>Contribution of evolutionary information</title>
      <p>The contribution of each evolutionary information was quantitatively estimated by analysing variable importance (Gini index) during the cross-validation procedure which was performed to test the TS-ensECBS model. The variable importance (a total decrease in node impurity) measures how effectively the output scores from each ECBS model contribute to classifying the training data in the construction of the ensemble model. The node impurity values were retrieved from the iterative cross-validation procedures and summarized in Figure <xref ref-type="fig" rid="F7">7A</xref>. In the result, Family, Target, and PFAM information consistently represented high importance regardless of the model type. In contrast, TS-SMART, TS-TIGR, TS-PRINT and TS-Gene3D (G3DSA) showed low importance probably due to the low model performance (Table <xref rid="tbl1" ref-type="table">1</xref>) and target coverage (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S6</xref>). Interestingly, the variable importance of superfamily information varied according to the model type. The Superfamily-ECBS model represented higher importance than the TS-Superfamily-ECBS model, which might be related to the higher model performance of the Superfamily-ECBS model for both test sets (AUC 0.64 versus 0.57 for the cross-validation set and 0.69 versus 0.40 for the independent set). The reason for the performance difference is not clear but we think that superfamily-based evolutionary annotation generates ambiguous target relationships irrelevant to chemical binding property (one superfamily is often linked to many motifs, domains, and families). This noisy data might decrease the performance of the TS-Superfamily-ECBS model. The unified models such as Superfamily-ECBS could be more robust to the noisy information because they take full advantage of the clustering effect shown in Figure <xref ref-type="fig" rid="F1">1B</xref> by considering all chemical-target binding information together.</p>
      <fig id="F7" orientation="portrait" position="float">
        <label>Figure 7.</label>
        <caption>
          <p>Contribution of evolutionary information in the construction of the ensemble ECBS models. (<bold>A</bold>) The contribution of each evolutionary information is estimated by calculating variable importance (Gini index) in the construction of the TS-ensECBS model. (<bold>B</bold>) The correlations between different ECBS models are represented by calculating Pearson's <italic>r</italic> for the predicted scores for the cross-validation test set.</p>
        </caption>
        <graphic xlink:href="gkz743fig7"/>
      </fig>
    </sec>
    <sec id="SEC4-3">
      <title>Complementarity of the unified and target-specific ECBS model</title>
      <p>The unified (<italic>X</italic>-ECBS) and target-specific (TS-<italic>X</italic>-ECBS) model differently encode evolutionary information to the output similarity scores by the distinctive model design (Figure <xref ref-type="fig" rid="F1">1B</xref>). To check the complementarity of the ECBS models, pairwise Pearson correlation coefficients between all ECBS scores were calculated using the predicted scores for the cross-validation test set (Figure <xref ref-type="fig" rid="F7">7B</xref>).</p>
      <p>Mostly, the correlations within the same model type (i.e. either unified or target-specific) are much higher than those between different types. Among the unified ECBS models, PFAM-ECBS, Family-ECBS and Superfamily-ECBS have a high correlation (&gt;0.88), whereas Target-ECBS has a relatively different score distribution compared to others. It suggested that domain, family, and superfamily information should be distinct from the target information, which might help to improve model performance as shown in the variable importance analysis (Figure <xref ref-type="fig" rid="F7">7A</xref>). In contrast to the unified models, TS-Target-ECBS is highly correlated to the other evolution-based target-specific models, probably because of the restriction of evolutionary information to a predefined target.</p>
      <p>In summary, various ECBS models encoded different evolutionary information, which showed distinct score distributions, except for a few cases mentioned above. Especially, all unified ECBS models showed high variable importance in the construction of the TS-ensECBS model, suggesting their complementarity to the target-specific ECBS models.</p>
    </sec>
    <sec id="SEC4-4">
      <title>Evolutionarily related chemical pairs highlight the conserved molecular binding features</title>
      <p>A target ‘Cholera enterotoxin subunit B’ (ctxB, Uniprot ID P01556) was used to show how ERCPs help to improve model quality. The ctxB was selected because both TS-Target-ECBS and TS-ensECBS showed high accuracy in the cross-validation test set (AUC 0.72 and 0.96 for TS-Target-ECBS and TS-ensECBS, respectively) with a moderate number of test and training data (14 drugs in the blind test set and 7 drugs in the training set). The test and trained chemical pairs for ctxB were categorized into ‘test’ (dotted in red), ‘trained by target’ (solid blue line), and ‘trained by evolution’ (solid green line) in Figure <xref ref-type="fig" rid="F8">8</xref>.</p>
      <fig id="F8" orientation="portrait" position="float">
        <label>Figure 8.</label>
        <caption>
          <p>Enriched chemical features by evolutionarily related chemical pairs (ERCPs). All the chemical compounds used to predict the chemical pairs commonly binding to ‘cholera enterotoxin subunit B’ (ctxB) are represented by the network as in Figure <xref ref-type="fig" rid="F3">3A</xref>. In the network, the blue edges represent the ERCPs defined by target identity, the green edges represent the ERCPs defined by evolutionary information (motif, domain, family, and superfamily are mixed for clarity), and the red dotted edges are the blind test set which commonly binds to ctxB. The 2D chemical structures for the nodes are shown together, and the arbitrary unrelated chemical pairs are represented by grey nodes and edges.</p>
        </caption>
        <graphic xlink:href="gkz743fig8"/>
      </fig>
      <p>Because all drugs binding to ctxB were included as a blind test set (see Figure <xref ref-type="fig" rid="F3">3</xref> for the test set generation), similarity scores for the ‘test’ pairs would be inferred only by the indirect information related to ctxB. For example, two known targets of DB02213 are ctxB and heat-labile enterotoxin B chain (eltB, UniProt ID: P32890), both of which are evolutionarily related by the common PFAM (PF01376, Enterotoxin_b), PRINT (PR00772, enterotoxin B), Family (50204, Bacterial AB5 toxins B-subunits) and Superfamily (50203, Bacterial enterotoxins) although the source organisms are different (ctxB is from Vibro cholerae serotype O1 and eltB from <italic>Escherichia coli</italic>). In this case, the TS-Target-ECBS model would consider the ‘trained by target’ chemical pairs defined by eltB as ERCPs for model training (e.g., DB03421, DB04040, DB03446, DB03242 and DB04396).</p>
      <p>However, the TS-ensECBS model would consider additional ERCPs such as DB02213-DB08501, DB02213-DB04465 and many others for DB03077, DB03721 and DB02379, depending on their evolutionary relatedness. The targets of DB03077, DB03721 and DB02379 are cholera enterotoxin B-subunit (Q57193), enterotoxin type B (P01552), and Shiga-like toxin 1 subunit B (P69178), respectively, all of which belong to the same bacterial enterotoxin superfamily (50203) without a common target. The evolutionary information contributed to generate more ERCPs (‘trained by evolution’ pairs), which resulted in the densely connected network that consisted of similar-binding chemical compounds (Figure <xref ref-type="fig" rid="F8">8</xref>). The number of ERCPs significantly increased by consideration of superfamily information, and so the important molecular features should be enriched and emphasized in the model training procedure. As expected, the ERCPs shared a few functional moieties such as the benzamide or galactopyranosyl groups representing the conserved molecular features for target-binding.</p>
      <p>In summary, the target-binding information of ctxB can be highly limited if the target identity is only considered to build an ECBS model. The inclusion of many ERCPs will make the relationships (or distances) between similar-binding chemical compounds much closer by providing densely connected ERCPs and therefore highlighting the conserved molecular binding features.</p>
    </sec>
  </sec>
  <sec id="SEC5">
    <title>CONCLUDING REMARKS</title>
    <p>Categorization of paired chemical data based on evolutionary target-binding information enabled the use of classification similarity-learning method to develop novel chemical binding similarities. Two major factors are closely related to the performance improvement of the ensemble ECBS models compared with the original Target-ECBS that only used target-binding information of drugs. Incorporating more chemical-target binding data from BindingDB was very effective to improve the model performance, suggesting the possibility of further improvement with future data generation. More importantly, collecting targets’ evolutionary information from a variety of curated databases was critical, as it reflected the diverse evolutionary relationship of targets at multiple levels such as a motif, domain, family, and superfamily.</p>
    <p>The target-binding information of chemical compounds is valuable to infer functional activity, because chemical-target interactions are directly linked to biological functions but are difficult to predict from a chemical structure alone. Evolutionarily related targets contain broad functional information thanks to the well-maintained structure-function relationship, particularly in the evolutionarily conserved binding pockets in homologous proteins (<xref rid="B47" ref-type="bibr">47</xref>). It has been consistently discussed that the evolution rate in the functionally important regions, such as enzyme active site, is much slower than the surface region (<xref rid="B23" ref-type="bibr">23</xref>). The ECBS models encode this evolutionary target-binding information into pairwise chemical relationships, where the similarity scores can compare more complicated binding properties between chemical compounds. Accordingly, we expect that ECBS can be widely used with applications such as large-scale ligand-based screening, target-specific ligand identification, drug-repositioning, and general chemical binding similarity calculations by modeling functional similarity.</p>
  </sec>
  <sec sec-type="data-availability" id="SEC6">
    <title>DATA AVAILABILITY</title>
    <p>The script for ensECBS is available in the GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/keunwan-kist/ECBS">https://github.com/keunwan-kist/ECBS</ext-link>) and the pre-built models are deposited in the Zenodo (<ext-link ext-link-type="uri" xlink:href="https://sandbox.zenodo.org/record/297093">https://sandbox.zenodo.org/record/297093</ext-link>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>gkz743_Supplemental_File</label>
      <media xlink:href="gkz743_supplemental_file.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank J. Lee for helpful discussion on virtual screening. The model building was facilitated through the use of KIST Server Farm infrastructure.</p>
    <p><italic>Author contributions:</italic> K.P. conceived the study and developed the method. K.P., D.P. and Y.J.K. evaluated the results. D.P. and C.H.P. assisted in algorithm design. K.P. wrote the manuscript with input from all authors.</p>
  </ack>
  <sec id="SEC7">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkz743#supplementary-data">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC8">
    <title>FUNDING</title>
    <p>Ministry of Oceans and Fisheries, Korea [20170488]; KIST institutional grant [2E29562]. Funding for open access charge: Ministry of Oceans and Fisheries, Korea [20170488]; KIST institutional grant [2E29562].</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bajusz</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Racz</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Heberger</surname><given-names>K.</given-names></name></person-group><article-title>Why is Tanimoto index an appropriate choice for fingerprint-based similarity calculations</article-title>. <source>J. Cheminformatics</source>. <year>2015</year>; <volume>7</volume>:<fpage>20</fpage>.</mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Muegge</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Mukherjee</surname><given-names>P.</given-names></name></person-group><article-title>An overview of molecular fingerprint similarity search in virtual screening</article-title>. <source>Expert Opin. Drug Dis.</source><year>2016</year>; <volume>11</volume>:<fpage>137</fpage>–<lpage>148</lpage>.</mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cereto-Massague</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Ojeda</surname><given-names>M.J.</given-names></name>, <name name-style="western"><surname>Valls</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Mulero</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Garcia-Vallve</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Pujadas</surname><given-names>G.</given-names></name></person-group><article-title>Molecular fingerprint similarity search in virtual screening</article-title>. <source>Methods</source>. <year>2015</year>; <volume>71</volume>:<fpage>58</fpage>–<lpage>63</lpage>.<pub-id pub-id-type="pmid">25132639</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Geppert</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Vogt</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Bajorath</surname><given-names>J.</given-names></name></person-group><article-title>Current trends in ligand-based virtual screening: molecular representations, data mining methods, new application areas, and performance evaluation</article-title>. <source>J. Chem. Inf. Model.</source><year>2010</year>; <volume>50</volume>:<fpage>205</fpage>–<lpage>216</lpage>.<pub-id pub-id-type="pmid">20088575</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ripphausen</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Nisius</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Bajorath</surname><given-names>J.</given-names></name></person-group><article-title>State-of-the-art in ligand-based virtual screening</article-title>. <source>Drug Discov. Today</source>. <year>2011</year>; <volume>16</volume>:<fpage>372</fpage>–<lpage>376</lpage>.<pub-id pub-id-type="pmid">21349346</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sheridan</surname><given-names>R.P.</given-names></name>, <name name-style="western"><surname>Kearsley</surname><given-names>S.K.</given-names></name></person-group><article-title>Why do we need so many chemical similarity search methods</article-title>. <source>Drug Discov. Today</source>. <year>2002</year>; <volume>7</volume>:<fpage>903</fpage>–<lpage>911</lpage>.<pub-id pub-id-type="pmid">12546933</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Willett</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Barnard</surname><given-names>J.M.</given-names></name>, <name name-style="western"><surname>Downs</surname><given-names>G.M.</given-names></name></person-group><article-title>Chemical similarity searching</article-title>. <source>J. Chem. Inf. Comp. Sci.</source><year>1998</year>; <volume>38</volume>:<fpage>983</fpage>–<lpage>996</lpage>.</mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Geer</surname><given-names>L.Y.</given-names></name>, <name name-style="western"><surname>Han</surname><given-names>L.Y.</given-names></name>, <name name-style="western"><surname>Bryant</surname><given-names>S.H.</given-names></name></person-group><article-title>Target enhanced 2D similarity search by using explicit biological activity annotations and profiles</article-title>. <source>J Cheminformatics</source>. <year>2015</year>; <volume>7</volume>:<fpage>55</fpage>.</mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Luo</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>X.S.</given-names></name>, <name name-style="western"><surname>Tropsha</surname><given-names>A.</given-names></name></person-group><article-title>Comparative analysis of QSAR-based vs. chemical similarity based predictors of GPCRs binding affinity</article-title>. <source>Mol. Inform.</source><year>2016</year>; <volume>35</volume>:<fpage>36</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">27491652</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ma</surname><given-names>J.S.</given-names></name>, <name name-style="western"><surname>Sheridan</surname><given-names>R.P.</given-names></name>, <name name-style="western"><surname>Liaw</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Dahl</surname><given-names>G.E.</given-names></name>, <name name-style="western"><surname>Svetnik</surname><given-names>V.</given-names></name></person-group><article-title>Deep neural nets as a method for quantitative structure-activity relationships</article-title>. <source>J. Chem. Inf. Model.</source><year>2015</year>; <volume>55</volume>:<fpage>263</fpage>–<lpage>274</lpage>.<pub-id pub-id-type="pmid">25635324</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Park</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Kim</surname><given-names>D.</given-names></name></person-group><article-title>Drug-drug relationship based on target information: application to drug target identification</article-title>. <source>BMC Syst. Biol.</source><year>2011</year>; <volume>5</volume>:<fpage>S12</fpage>.</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Tan</surname><given-names>J.J.</given-names></name>, <name name-style="western"><surname>Han</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>H.</given-names></name></person-group><article-title>From machine learning to deep learning: progress in machine intelligence for rational drug discovery</article-title>. <source>Drug Discov. Today</source>. <year>2017</year>; <volume>22</volume>:<fpage>1680</fpage>–<lpage>1685</lpage>.<pub-id pub-id-type="pmid">28881183</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bender</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Mussa</surname><given-names>H.Y.</given-names></name>, <name name-style="western"><surname>Glen</surname><given-names>R.C.</given-names></name>, <name name-style="western"><surname>Reiling</surname><given-names>S.</given-names></name></person-group><article-title>Similarity searching of chemical databases using atom environment descriptors (MOLPRINT 2D): evaluation of performance</article-title>. <source>J. Chem. Inf. Comput. Sci.</source><year>2004</year>; <volume>44</volume>:<fpage>1708</fpage>–<lpage>1718</lpage>.<pub-id pub-id-type="pmid">15446830</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lopez-Inesta</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Grimaldo</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Arevalillo-Herraez</surname><given-names>M.</given-names></name></person-group><article-title>Classification similarity learning using feature-based and distance-based representations: a comparative study</article-title>. <source>Appl Artif Intell</source>. <year>2015</year>; <volume>29</volume>:<fpage>445</fpage>–<lpage>458</lpage>.</mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>Y.H.</given-names></name>, <name name-style="western"><surname>Garcia</surname><given-names>E.K.</given-names></name>, <name name-style="western"><surname>Gupta</surname><given-names>M.R.</given-names></name>, <name name-style="western"><surname>Rahimi</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Cazzanti</surname><given-names>L.</given-names></name></person-group><article-title>Similarity-based classification: concepts and algorithms</article-title>. <source>J. Mach. Learn. Res.</source><year>2009</year>; <volume>10</volume>:<fpage>747</fpage>–<lpage>776</lpage>.</mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lopez-Inesta</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Grimaldo</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Arevalillo-Herraez</surname><given-names>M.</given-names></name></person-group><article-title>Learning similarity scores by using a family of distance functions in multiple feature spaces</article-title>. <source>Int. J. Pattern Recogn.</source><year>2017</year>; <volume>31</volume>:<fpage>1750027</fpage>.</mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hua</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>Q.</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>R.</given-names></name></person-group><article-title>A guaranteed similarity metric learning framework for biological sequence comparison</article-title>. <source>IEEE/ACM Trans. Comput. Biol. Bioinform.</source><year>2016</year>; <volume>13</volume>:<fpage>868</fpage>–<lpage>877</lpage>.<pub-id pub-id-type="pmid">26529778</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lopez-Inesta</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Grimaldo</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Arevalillo-Herraez</surname><given-names>M.</given-names></name></person-group><article-title>Combining feature extraction and expansion to improve classification based similarity learning</article-title>. <source>Pattern Recogn. Lett.</source><year>2017</year>; <volume>93</volume>:<fpage>95</fpage>–<lpage>103</lpage>.</mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wishart</surname><given-names>D.S.</given-names></name>, <name name-style="western"><surname>Feunang</surname><given-names>Y.D.</given-names></name>, <name name-style="western"><surname>Guo</surname><given-names>A.C.</given-names></name>, <name name-style="western"><surname>Lo</surname><given-names>E.J.</given-names></name>, <name name-style="western"><surname>Marcu</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Grant</surname><given-names>J.R.</given-names></name>, <name name-style="western"><surname>Sajed</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Johnson</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Sayeeda</surname><given-names>Z.</given-names></name><etal>et al</etal>.</person-group><article-title>DrugBank 5.0: a major update to the DrugBank database for 2018</article-title>. <source>Nucleic Acids Res.</source><year>2018</year>; <volume>46</volume>:<fpage>D1074</fpage>–<lpage>D1082</lpage>.<pub-id pub-id-type="pmid">29126136</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gilson</surname><given-names>M.K.</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>T.Q.</given-names></name>, <name name-style="western"><surname>Baitaluk</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Nicola</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Hwang</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Chong</surname><given-names>J.</given-names></name></person-group><article-title>BindingDB in 2015: a public database for medicinal chemistry, computational chemistry and systems pharmacology</article-title>. <source>Nucleic Acids Res.</source><year>2016</year>; <volume>44</volume>:<fpage>D1045</fpage>–<lpage>D1053</lpage>.<pub-id pub-id-type="pmid">26481362</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Heller</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>McNaught</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Stein</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Tchekhovskoi</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Pletnev</surname><given-names>I.</given-names></name></person-group><article-title>InChI - the worldwide chemical structure identifier standard</article-title>. <source>J. Cheminform.</source><year>2013</year>; <volume>5</volume>:<fpage>7</fpage>.<pub-id pub-id-type="pmid">23343401</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lichtarge</surname><given-names>O.</given-names></name>, <name name-style="western"><surname>Bourne</surname><given-names>H.R.</given-names></name>, <name name-style="western"><surname>Cohen</surname><given-names>F.E.</given-names></name></person-group><article-title>An evolutionary trace method defines binding surfaces common to protein families</article-title>. <source>J. Mol. Biol.</source><year>1996</year>; <volume>257</volume>:<fpage>342</fpage>–<lpage>358</lpage>.<pub-id pub-id-type="pmid">8609628</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Echave</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Spielman</surname><given-names>S.J.</given-names></name>, <name name-style="western"><surname>Wilke</surname><given-names>C.O.</given-names></name></person-group><article-title>Causes of evolutionary rate variation among protein sites</article-title>. <source>Nat. Rev. Genet.</source><year>2016</year>; <volume>17</volume>:<fpage>109</fpage>–<lpage>121</lpage>.<pub-id pub-id-type="pmid">26781812</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><collab>The UniProt, C.</collab><article-title>UniProt: the universal protein knowledgebase</article-title>. <source>Nucleic Acids Res.</source><year>2017</year>; <volume>45</volume>:<fpage>D158</fpage>–<lpage>D169</lpage>.<pub-id pub-id-type="pmid">27899622</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Finn</surname><given-names>R.D.</given-names></name>, <name name-style="western"><surname>Coggill</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Eberhardt</surname><given-names>R.Y.</given-names></name>, <name name-style="western"><surname>Eddy</surname><given-names>S.R.</given-names></name>, <name name-style="western"><surname>Mistry</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Mitchell</surname><given-names>A.L.</given-names></name>, <name name-style="western"><surname>Potter</surname><given-names>S.C.</given-names></name>, <name name-style="western"><surname>Punta</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Qureshi</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Sangrador-Vegas</surname><given-names>A.</given-names></name><etal>et al</etal>.</person-group><article-title>The Pfam protein families database: towards a more sustainable future</article-title>. <source>Nucleic Acids Res.</source><year>2016</year>; <volume>44</volume>:<fpage>D279</fpage>–<lpage>D285</lpage>.<pub-id pub-id-type="pmid">26673716</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Letunic</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Bork</surname><given-names>P.</given-names></name></person-group><article-title>20 years of the SMART protein domain annotation resource</article-title>. <source>Nucleic Acids Res.</source><year>2018</year>; <volume>46</volume>:<fpage>D493</fpage>–<lpage>D496</lpage>.<pub-id pub-id-type="pmid">29040681</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Attwood</surname><given-names>T.K.</given-names></name>, <name name-style="western"><surname>Coletta</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Muirhead</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Pavlopoulou</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Philippou</surname><given-names>P.B.</given-names></name>, <name name-style="western"><surname>Popov</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Roma-Mateo</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Theodosiou</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Mitchell</surname><given-names>A.L.</given-names></name></person-group><article-title>The PRINTS database: a fine-grained protein sequence annotation and analysis resource–its status in 2012</article-title>. <source>Database</source>. <year>2012</year>; <volume>2012</volume>:<fpage>bas019</fpage>.<pub-id pub-id-type="pmid">22508994</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lewis</surname><given-names>T.E.</given-names></name>, <name name-style="western"><surname>Sillitoe</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Dawson</surname><given-names>N.</given-names></name>, <name name-style="western"><surname>Lam</surname><given-names>S.D.</given-names></name>, <name name-style="western"><surname>Clarke</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Orengo</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Lees</surname><given-names>J.</given-names></name></person-group><article-title>Gene3D: extensive prediction of globular domains in proteins</article-title>. <source>Nucleic Acids Res.</source><year>2018</year>; <volume>46</volume>:<fpage>D1282</fpage>.<pub-id pub-id-type="pmid">29194501</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Haft</surname><given-names>D.H.</given-names></name>, <name name-style="western"><surname>Selengut</surname><given-names>J.D.</given-names></name>, <name name-style="western"><surname>White</surname><given-names>O.</given-names></name></person-group><article-title>The TIGRFAMs database of protein families</article-title>. <source>Nucleic Acids Res.</source><year>2003</year>; <volume>31</volume>:<fpage>371</fpage>–<lpage>373</lpage>.<pub-id pub-id-type="pmid">12520025</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wilson</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Madera</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Vogel</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Chothia</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Gough</surname><given-names>J.</given-names></name></person-group><article-title>The SUPERFAMILY database in 2007: families and functions</article-title>. <source>Nucleic Acids Res.</source><year>2007</year>; <volume>35</volume>:<fpage>D308</fpage>–<lpage>D313</lpage>.<pub-id pub-id-type="pmid">17098927</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Finn</surname><given-names>R.D.</given-names></name>, <name name-style="western"><surname>Attwood</surname><given-names>T.K.</given-names></name>, <name name-style="western"><surname>Babbitt</surname><given-names>P.C.</given-names></name>, <name name-style="western"><surname>Bateman</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Bork</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Bridge</surname><given-names>A.J.</given-names></name>, <name name-style="western"><surname>Chang</surname><given-names>H.Y.</given-names></name>, <name name-style="western"><surname>Dosztanyi</surname><given-names>Z.</given-names></name>, <name name-style="western"><surname>El-Gebali</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Fraser</surname><given-names>M.</given-names></name><etal>et al</etal>.</person-group><article-title>InterPro in 2017-beyond protein family and domain annotations</article-title>. <source>Nucleic Acids Res.</source><year>2017</year>; <volume>45</volume>:<fpage>D190</fpage>–<lpage>D199</lpage>.<pub-id pub-id-type="pmid">27899635</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cao</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Charisi</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Cheng</surname><given-names>L.C.</given-names></name>, <name name-style="western"><surname>Jiang</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Girke</surname><given-names>T.</given-names></name></person-group><article-title>ChemmineR: a compound mining framework for R</article-title>. <source>Bioinformatics</source>. <year>2008</year>; <volume>24</volume>:<fpage>1733</fpage>–<lpage>1734</lpage>.<pub-id pub-id-type="pmid">18596077</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Park</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Marcotte</surname><given-names>E.M.</given-names></name></person-group><article-title>Revisiting the negative example sampling problem for predicting protein-protein interactions</article-title>. <source>Bioinformatics</source>. <year>2011</year>; <volume>27</volume>:<fpage>3024</fpage>–<lpage>3028</lpage>.<pub-id pub-id-type="pmid">21908540</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cheng</surname><given-names>Z.Z.</given-names></name>, <name name-style="western"><surname>Huang</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Guan</surname><given-names>J.H.</given-names></name>, <name name-style="western"><surname>Zhou</surname><given-names>S.G.</given-names></name></person-group><article-title>Selecting high-quality negative samples for effectively predicting protein-RNA interactions</article-title>. <source>BMC Syst. Biol.</source><year>2017</year>; <volume>11</volume>:<fpage>9</fpage>.<pub-id pub-id-type="pmid">28361676</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wright</surname><given-names>M.N.</given-names></name>, <name name-style="western"><surname>Ziegler</surname><given-names>A.</given-names></name></person-group><article-title>ranger: a fast implementation of random forests for high dimensional Data in C plus plus and R</article-title>. <source>J. Stat. Softw.</source><year>2017</year>; <volume>77</volume>:<fpage>1</fpage>–<lpage>17</lpage>.</mixed-citation>
    </ref>
    <ref id="B36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gu</surname><given-names>Q.</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Cai</surname><given-names>Z.H.</given-names></name></person-group><article-title>Evaluation measures of the classification performance of imbalanced data sets</article-title>. <source>Comm. Com. Inf. Sci.</source><year>2009</year>; <volume>51</volume>:<fpage>461</fpage>–<lpage>471</lpage>.</mixed-citation>
    </ref>
    <ref id="B37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Grau</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Grosse</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Keilwagen</surname><given-names>J.</given-names></name></person-group><article-title>PRROC: computing and visualizing precision-recall and receiver operating characteristic curves in R</article-title>. <source>Bioinformatics</source>. <year>2015</year>; <volume>31</volume>:<fpage>2595</fpage>–<lpage>2597</lpage>.<pub-id pub-id-type="pmid">25810428</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lesnik</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Stular</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Brus</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Knez</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Gobec</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Janezic</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Konc</surname><given-names>J.</given-names></name></person-group><article-title>LiSiCA: a software for ligand-based virtual screening and its application for the discovery of butyrylcholinesterase inhibitors</article-title>. <source>J. Chem. Inf. Model.</source><year>2015</year>; <volume>55</volume>:<fpage>1521</fpage>–<lpage>1528</lpage>.<pub-id pub-id-type="pmid">26158767</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Roy</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Skolnick</surname><given-names>J.</given-names></name></person-group><article-title>LIGSIFT: an open-source tool for ligand structural alignment and virtual screening</article-title>. <source>Bioinformatics</source>. <year>2015</year>; <volume>31</volume>:<fpage>539</fpage>–<lpage>544</lpage>.<pub-id pub-id-type="pmid">25336501</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dabb</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Blunt</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Munro</surname><given-names>M.</given-names></name></person-group><article-title>MarinLit: database and essential tools for the marine natural products community</article-title>. <source>Abstr. Pap. Am. Chem. S</source>. <year>2014</year>; <volume>248</volume>:<fpage>1</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="B41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>J.W.</given-names></name>, <name name-style="western"><surname>Hirota</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Ono</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Honma</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Honma</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Park</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Kay</surname><given-names>S.A.</given-names></name></person-group><article-title>Chemical control of mammalian circadian behavior through dual inhibition of casein kinase 1 alpha and delta</article-title>. <source>J. Med. Chem.</source><year>2019</year>; <volume>62</volume>:<fpage>1989</fpage>–<lpage>1998</lpage>.<pub-id pub-id-type="pmid">30707835</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ponzoni</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Sebastian-Perez</surname><given-names>V.</given-names></name>, <name name-style="western"><surname>Requena-Triguero</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Roca</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Martinez</surname><given-names>M.J.</given-names></name>, <name name-style="western"><surname>Cravero</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Diaz</surname><given-names>M.F.</given-names></name>, <name name-style="western"><surname>Paez</surname><given-names>J.A.</given-names></name>, <name name-style="western"><surname>Arrayas</surname><given-names>R.G.</given-names></name>, <name name-style="western"><surname>Adrio</surname><given-names>J.</given-names></name><etal>et al</etal>.</person-group><article-title>Hybridizing feature selection and feature learning approaches in QSAR modeling for drug discovery</article-title>. <source>Sci. Rep.</source><year>2017</year>; <volume>7</volume>:<fpage>2403</fpage>.<pub-id pub-id-type="pmid">28546583</pub-id></mixed-citation>
    </ref>
    <ref id="B43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Scholkopf</surname><given-names>B.</given-names></name></person-group><article-title>The kernel trick for distances</article-title>. <source>Adv Neur In</source>. <year>2001</year>; <volume>13</volume>:<fpage>301</fpage>–<lpage>307</lpage>.</mixed-citation>
    </ref>
    <ref id="B44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Eick</surname><given-names>C.F.</given-names></name>, <name name-style="western"><surname>Rouhana</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Bagherjeiran</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Vilalta</surname><given-names>R.</given-names></name></person-group><article-title>Using clustering to learn distance functions for supervised similarity assessment</article-title>. <source>Lect. Notes Artif. Int.</source><year>2005</year>; <volume>3587</volume>:<fpage>120</fpage>–<lpage>131</lpage>.</mixed-citation>
    </ref>
    <ref id="B45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Yan</surname><given-names>C.C.</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Dai</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Yin</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>Y.</given-names></name></person-group><article-title>Drug-target interaction prediction: databases, web servers and computational models</article-title>. <source>Brief. Bioinform.</source><year>2016</year>; <volume>17</volume>:<fpage>696</fpage>–<lpage>712</lpage>.<pub-id pub-id-type="pmid">26283676</pub-id></mixed-citation>
    </ref>
    <ref id="B46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Batson</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Toop</surname><given-names>H.D.</given-names></name>, <name name-style="western"><surname>Redondo</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Babaei-Jadidi</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Chaikuad</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Wearmouth</surname><given-names>S.F.</given-names></name>, <name name-style="western"><surname>Gibbons</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Allen</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Tallant</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>J.X.</given-names></name><etal>et al</etal>.</person-group><article-title>Development of potent, selective SRPK1 inhibitors as potential topical therapeutics for neovascular eye disease</article-title>. <source>ACS Chem. Biol.</source><year>2017</year>; <volume>12</volume>:<fpage>825</fpage>–<lpage>832</lpage>.<pub-id pub-id-type="pmid">28135068</pub-id></mixed-citation>
    </ref>
    <ref id="B47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Park</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Kim</surname><given-names>D.</given-names></name></person-group><article-title>A method to detect important residues using protein binding site comparison</article-title>. <source>Genome Inform.</source><year>2006</year>; <volume>17</volume>:<fpage>216</fpage>–<lpage>225</lpage>.<pub-id pub-id-type="pmid">17503394</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
