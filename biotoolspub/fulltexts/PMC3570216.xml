<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3570216</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btt001</article-id>
    <article-id pub-id-type="publisher-id">btt001</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MaSC: mappability-sensitive cross-correlation for estimating mean fragment length of single-end short-read sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ramachandran</surname>
          <given-names>Parameswaran</given-names>
        </name>
        <xref ref-type="aff" rid="btt001-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btt001-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Palidwor</surname>
          <given-names>Gareth A.</given-names>
        </name>
        <xref ref-type="aff" rid="btt001-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Porter</surname>
          <given-names>Christopher J.</given-names>
        </name>
        <xref ref-type="aff" rid="btt001-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Perkins</surname>
          <given-names>Theodore J.</given-names>
        </name>
        <xref ref-type="aff" rid="btt001-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btt001-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="btt001-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="btt001-AFF1"><sup>1</sup>Regenerative Medicine Program, Ottawa Hospital Research Institute, K1H 8L6, Ottawa, Canada and <sup>2</sup>Department of Biochemistry, Microbiology and Immunology, Faculty of Medicine, University of Ottawa, K1H 8M5, Ottawa, Canada</aff>
    <author-notes>
      <corresp id="btt001-COR1">*To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Martin Bishop</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>2</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>1</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>7</day>
      <month>1</month>
      <year>2013</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>29</volume>
    <issue>4</issue>
    <fpage>444</fpage>
    <lpage>450</lpage>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>9</month>
        <year>2012</year>
      </date>
      <date date-type="rev-recd">
        <day>9</day>
        <month>12</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>1</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2013. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/3.0/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/">http://creativecommons.org/licenses/by/3.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Reliable estimation of the mean fragment length for next-generation short-read sequencing data is an important step in next-generation sequencing analysis pipelines, most notably because of its impact on the accuracy of the enriched regions identified by peak-calling algorithms. Although many peak-calling algorithms include a fragment-length estimation subroutine, the problem has not been adequately solved, as demonstrated by the variability of the estimates returned by different algorithms.</p>
      <p><bold>Results:</bold> In this article, we investigate the use of strand cross-correlation to estimate mean fragment length of single-end data and show that traditional estimation approaches have mixed reliability. We observe that the mappability of different parts of the genome can introduce an artificial bias into cross-correlation computations, resulting in incorrect fragment-length estimates. We propose a new approach, called mappability-sensitive cross-correlation (MaSC), which removes this bias and allows for accurate and reliable fragment-length estimation. We analyze the computational complexity of this approach, and evaluate its performance on a test suite of NGS datasets, demonstrating its superiority to traditional cross-correlation analysis.</p>
      <p><bold>Availability:</bold> An open-source Perl implementation of our approach is available at <ext-link ext-link-type="uri" xlink:href="http://www.perkinslab.ca/Software.html">http://www.perkinslab.ca/Software.html</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>tperkins@ohri.ca</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btt001/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Next-generation sequencing (NGS) technologies have revolutionized molecular biology with their unprecedented capacity for genome-wide measurement of protein–DNA interactions, chromatin state changes and transcription levels (<xref ref-type="bibr" rid="btt001-B7">Mardis, 2011</xref>). Although NGS technologies differ in their details, most of the common platforms work by sequencing large numbers of short-DNA fragments. These fragments may originate, for example, from simple extraction of DNA from a sample of cells, selective extraction based on a chromatin-immunoprecipitation pulldown or reverse transcription of RNA into DNA. When dealing with DNA from an organism that lacks a canonical genome assembly, the sequences can be assembled to create a <italic>de novo</italic> estimate of the genome or transcriptome (<xref ref-type="bibr" rid="btt001-B8">Narzisi and Mishra, 2011</xref>). When the organism does have a canonical genome, the DNA fragment sequences are typically mapped back to the canonical genome, so that their distribution, and especially sites of enrichment, may be studied (<xref ref-type="bibr" rid="btt001-B9">Pepke <italic>et al.</italic>, 2009</xref>).</p>
    <p>NGS technologies usually do not sequence each DNA fragment in its entirety. Indeed, depending on the size of the fragments, this is typically impossible and is not the intended use of the technology. The best practical alternative offered by typical current technologies is sequencing the fragments starting from both ends. However, most experiments do not take advantage of this option for cost reasons and, instead, choose to sequence only one end of each fragment. Thus, despite having a canonical genome assembly to which one end of each fragment can be mapped, most NGS experiments lack information on the other, unsequenced end of each fragment.</p>
    <p>A fundamental step in many NGS analysis pipelines is to estimate mean fragment length, so that we can have at least some idea of the genomic locations of the unsequenced ends. First, this helps in the visualization of the NGS dataset in a genome browser. Each read can be ‘extended’ to the average fragment length and shown as an interval in the browser, giving a more accurate impression of the regions of the genome represented by the DNA sample. Secondly, fragment-length estimation is important for peak-calling algorithms—methods for automatically detecting the genomic regions that are enriched in the sample of DNA fragments (<xref ref-type="bibr" rid="btt001-B9">Pepke <italic>et al.</italic>, 2009</xref>). In most such algorithms, either the reads are extended to an average fragment length (e.g. <xref ref-type="bibr" rid="btt001-B12">Tuteja <italic>et al.</italic>, 2009</xref>), or the positive- and negative-strand reads are shifted towards each other by half the estimated fragment length (e.g. <xref ref-type="bibr" rid="btt001-B15">Zhang <italic>et al.</italic>, 2008</xref>). Indeed, many peak-calling algorithms include a fragment-length estimation subroutine. However, many of these have not been rigorously validated, and different algorithms often produce different fragment-length estimates. Partly, as a result, the enriched regions identified by different peak-calling algorithms can have poor overlap (<xref ref-type="bibr" rid="btt001-B14">Wilbanks and Facciotti, 2010</xref>) (also see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt001/-/DC1">Supplementary Section S1</ext-link>). Yet other peak-calling algorithms require the fragment length as input (e.g. <xref ref-type="bibr" rid="btt001-B10">Rozowsky <italic>et al.</italic>, 2009</xref>). For all of these reasons, reliable fragment-length estimation is an important problem that has not yet been adequately solved.</p>
    <p>Mean fragment length can be estimated in the wetlab, and this is often a part of DNA sample preparation protocols. Fragment length is commonly controlled by the aggressiveness of DNA fragmentation (e.g. duration of DNA sonication) and/or by gel-based size selection. However, such procedures vary by laboratory and even by experimenter, and they often go unreported for public NGS datasets. Moreover, such procedures are typically not highly quantitative, and only result in rough estimated ranges for fragment length (e.g. 200–300 bp), which are not satisfactory.</p>
    <p>In this article, we investigate the use of cross-correlation of positive- and negative-strand reads for estimating mean fragment length. By applying this method to a small number of available paired-end datasets, for which mean fragment length can be computed exactly, we show that cross-correlation usually produces an accurate fragment-length estimate. Occasionally, however, estimates are clearly wrong, returning a value near the read length rather than the fragment length. Our key insight is that the mappability of different parts of the genome can introduce an artificial bias into the cross-correlation function, which sometimes results in incorrect fragment-length estimates. Based on this insight, we propose a new approach, called <italic>mappability</italic><italic>-</italic><italic>sensitive </italic><italic>cross</italic><italic>-correlation</italic> (MaSC), which removes this bias, allowing for much more accurate fragment-length estimation. We analyze the computational complexity of this algorithm and evaluate its performance on a test suite of NGS datasets, demonstrating its superiority to traditional cross-correlation analysis.</p>
  </sec>
  <sec id="SEC2">
    <title>2 RESULTS</title>
    <sec id="SEC2.1">
      <title>2.1 Disagreements between existing fragment-length estimators</title>
      <p>A number of algorithms rely on some form of cross-correlation between positive- and negative-strand read sets to estimate fragment length (details provided later in the text). The intuition behind the use of cross-correlation is straightforward. Imagine, for example, a DNA sample that is the result of a chromatin-immunoprecipitation experiment, in which DNA bound to a particular transcription factor (TF) is pulled down. Let us choose a binding site in the genome and consider the subset of all DNA fragments bound to that site. Assuming each fragment is read from only one end, the positive-strand reads will necessarily occur upstream (to the left) of the binding site, whereas the negative-strand reads will occur downstream (to the right) of the binding site. If the fragments are <italic>L</italic> base pairs long on average, then, assuming symmetry, the positive reads will occur approximately <italic>L</italic>/2 base pairs upstream of the site, and the negative reads will occur approximately <italic>L</italic>/2 base pairs downstream. If we correlate the positive- and negative-strand read densities, they should correlate best when the negative-strand reads are shifted upstream by <italic>L</italic> base pairs, which is equivalent to the mean fragment length.</p>
      <p>Different algorithms implement this intuition in different ways. For instance, MACS builds a model by measuring the alignment between the positive- and negative-strand reads in a small subset of high-quality peaks (<xref ref-type="bibr" rid="btt001-B15">Zhang <italic>et al.</italic>, 2008</xref>). The main drawback of this method is that it sometimes fails because of the unavailability of a sufficient number of paired peaks to build a reliable model. Consequently, MACS sometimes ends up assuming a default fragment length of 200 bp. QuEST executes a similar procedure to MACS where the fragment length is estimated from a set of high-quality enriched regions (<xref ref-type="bibr" rid="btt001-B13">Valouev <italic>et al.</italic>, 2008</xref>). The strand cross-correlation approach (<xref ref-type="bibr" rid="btt001-B5">Kharchenko <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="btt001-B16">Landt <italic>et al.</italic>, 2012</xref>) computes the Pearson correlation coefficient between the genome-wide positive- and negative-strand read-density profiles. SISSRs, on the other hand, computes a measure of the average proximity of matching positive- and negative-strand reads (<xref ref-type="bibr" rid="btt001-B3">Jothi <italic>et al.</italic>, 2008</xref>). Other algorithms, such as Peakseq and Peakranger, do not have a built-in fragment-length estimation subroutine (<xref ref-type="bibr" rid="btt001-B2">Feng <italic>et al.</italic>, 2011</xref>; <xref ref-type="bibr" rid="btt001-B10">Rozowsky <italic>et al.</italic>, 2009</xref>). Instead, they require the user to input this parameter.</p>
      <p>To formalize the correlation approach, let us imagine a genome of B base pairs in total. For simplicity, we assume that the genome has a single chromosome; a generalization to include multiple chromosomes would be straightforward. For <inline-formula><inline-graphic xlink:href="btt001i1.jpg"/></inline-formula>, let <italic>f</italic>(<italic>b</italic>) and <italic>g</italic>(<italic>b</italic>) denote the number of positive- and negative-strand reads mapped to position <italic>b</italic> in the genome. We assume these positions represent the ends of the fragments that were read. That is, if a fragment has <italic>R</italic> bases read from one end, and if the <italic>R</italic>-mer that was read maps to positive-strand positions <italic>b</italic> through <italic>b</italic> + <italic>R</italic> − 1, then <italic>f</italic>(<italic>b</italic>) is credited with one read. However, if the same read maps to negative-strand positions <italic>b</italic> through <italic>b</italic> + <italic>R</italic> − 1, then <italic>g</italic>(<italic>b</italic> + <italic>R</italic> − 1) is credited with one read—base position <italic>b</italic> + <italic>R</italic> − 1 represents the physical origin of the start of that negative-strand read. Alternatively, for simplicity, if one prefers to credit <italic>g</italic>(<italic>b</italic>) with a read instead, then one will later have to add <italic>R</italic> − 1 to the fragment-length estimate.</p>
      <p>Following what is largely a common practice, we assume that multiple reads mapped to the same position are collapsed into a single read. (Multiple identical reads can be an artifact of PCR amplification; therefore, they are replaced with a single representative, <xref ref-type="bibr" rid="btt001-B9">Pepke <italic>et al.</italic>, 2009</xref>.) As such, <inline-formula><inline-graphic xlink:href="btt001i2.jpg"/></inline-formula>. Let us further define <inline-formula><inline-graphic xlink:href="btt001i3a.jpg"/></inline-formula><inline-formula><inline-graphic xlink:href="btt001i3.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="btt001i4.jpg"/></inline-formula>. These are just the sample means and variances of <italic>f</italic> and <italic>g</italic>. The cross-correlation of <italic>f</italic> and <italic>g</italic> at a shift (or distance) of <italic>d</italic> is
<disp-formula id="btt001-M1"><label>(1)</label><graphic xlink:href="btt001m1"/></disp-formula>
</p>
      <p>The approximation in the second line results from the summation in the first line not being taken over exactly the same values of <italic>b</italic> as the summations in the formulae for <inline-formula><inline-graphic xlink:href="btt001i5.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="btt001i6.jpg"/></inline-formula>. However, in typical cases, <inline-formula><inline-graphic xlink:href="btt001i7.jpg"/></inline-formula>, and any difference arising from this approximation would be inconsequential. For a given dataset, we then estimate mean fragment length as <inline-formula><inline-graphic xlink:href="btt001i8.jpg"/></inline-formula>, where the <inline-formula><inline-graphic xlink:href="btt001i9.jpg"/></inline-formula> is taken over some plausible range of <italic>d</italic>.</p>
      <p>To test whether this whole-genome cross-correlation technique works, we applied it on several <italic>paired-end</italic> datasets downloaded from the GEO database (<xref ref-type="bibr" rid="btt001-B1">Barrett <italic>et al.</italic>, 2011</xref>). Paired-end datasets contain pairs of reads sequenced from both ends of each DNA fragment. Assuming each end can be mapped back to the genome, the exact length of each fragment and, consequently, the exact mean fragment length, can be computed. For our analysis, a single-end dataset was created from each paired-end dataset (details in Section 4) to hide the paired ends from the algorithm, and the single-end datasets were then used for fragment-length estimation. The results were then corroborated using the true mean fragment lengths. To ensure variety, we chose different types of datasets from different organisms: ChIP-Seq in <italic>Arabidopsis</italic> based on <italic>aborted microspores</italic> (AMS) pulldown, ChIP-Seq in yeast based on a nucleosome pulldown and four RNA-seq datasets from C2C12 mouse myoblasts where the samples have been prepared to have a mean fragment length of either 100 or 280. Because transcript splicing may result in RNA-seq read pairs spanning different exons thereby exhibiting unusually large apparent fragment lengths, we retained only those RNA-seq read pairs with both ends mapping to the same exon according to the UCSC gene definitions. Other processing details can be found in Section 4.</p>
      <p>In addition to computing the naïve cross-correlation, we also processed these datasets using four other fragment-length estimation techniques (or subroutines), namely, MACS, SISSRs, the cross-correlation technique by <xref ref-type="bibr" rid="btt001-B5">Kharchenko <italic>et al.</italic> (2008)</xref> and a technique known as ‘coverage’ that computes the optimal shift for which the number of bases covered by any read is minimized. Although the last technique is briefly mentioned in the ‘chipseq’ R package (<xref ref-type="bibr" rid="btt001-B11">Sarkar <italic>et al.</italic>, 2012</xref>), we could not obtain a published reference for it. MACS (version 1.4.0rc2) was run directly using Python, whereas the other methods were run using their implementations in the ‘chipseq’ R package, with the command ‘<italic>estimate.mean.fraglen</italic>’.</p>
      <p><xref ref-type="table" rid="btt001-T1">Table 1</xref> lists the results for the six single-end datasets created from the paired ends, along with the true mean fragment lengths. MACS fails in two of the six cases because of the unavailability of a sufficient number of paired peaks. In the cases where it succeeds, its estimates are accurate. SISSRs demonstrates some variability, and in the majority of the cases, its estimates are far away from the true values. Coverage and Kharchenko-correlation yield accurate estimates for the mouse myoblasts but have difficulties for the <italic>Arabidopsis</italic> and yeast cases. Columns naïve-BC and naïve-WG list the results of our implementations of the naïve cross-correlation, the first on individual chromosomes and the other on the whole genome. Except for the <italic>Arabidopsis</italic> case, our naïve-correlation estimates are within one or two base pairs of the corresponding true mean values. Thus, overall, we can see that the whole-genome cross-correlation works well in many cases but fails sometimes. In the next section, we identify the reasons for failure and propose effective solutions.
<table-wrap id="btt001-T1" position="float"><label>Table 1.</label><caption><p>Paired-end mean fragment-length estimates using multiple methods, and the corresponding true mean values</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Name</th><th rowspan="1" colspan="1">GEO accession</th><th rowspan="1" colspan="1">MACS</th><th rowspan="1" colspan="1">SISSRs</th><th rowspan="1" colspan="1">Kharchenko-correlation</th><th rowspan="1" colspan="1">Coverage</th><th rowspan="1" colspan="1">Naïve-BC</th><th rowspan="1" colspan="1">Naïve-WG</th><th rowspan="1" colspan="1">True value</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1"><italic>Arabidopsis</italic> AMS</td><td rowspan="1" colspan="1">GSM424618</td><td rowspan="1" colspan="1">F</td><td rowspan="1" colspan="1">82 ± 28</td><td rowspan="1" colspan="1">109 ± 74</td><td rowspan="1" colspan="1">209 ± 60</td><td rowspan="1" colspan="1">91 ± 76</td><td rowspan="1" colspan="1">36</td><td rowspan="1" colspan="1">245</td></tr><tr><td rowspan="1" colspan="1">Yeast nucleosome</td><td rowspan="1" colspan="1">GSM730535</td><td rowspan="1" colspan="1">F</td><td rowspan="1" colspan="1">12 ± 2</td><td rowspan="1" colspan="1">156 ± 6</td><td rowspan="1" colspan="1">42 ± 4</td><td rowspan="1" colspan="1">153 ± 0</td><td rowspan="1" colspan="1">153</td><td rowspan="1" colspan="1">154</td></tr><tr><td rowspan="1" colspan="1">Mouse myoblasts</td><td rowspan="1" colspan="1">GSM582290</td><td rowspan="1" colspan="1">96</td><td rowspan="1" colspan="1">98 ± 3</td><td rowspan="1" colspan="1">100 ± 1</td><td rowspan="1" colspan="1">100 ± 0</td><td rowspan="1" colspan="1">99 ± 0</td><td rowspan="1" colspan="1">99</td><td rowspan="1" colspan="1">98</td></tr><tr><td rowspan="1" colspan="1">Mouse myoblasts</td><td rowspan="1" colspan="1">GSM582293</td><td rowspan="1" colspan="1">98</td><td rowspan="1" colspan="1">79 ± 2</td><td rowspan="1" colspan="1">100 ± 1</td><td rowspan="1" colspan="1">100 ± 0</td><td rowspan="1" colspan="1">98 ± 0</td><td rowspan="1" colspan="1">98</td><td rowspan="1" colspan="1">99</td></tr><tr><td rowspan="1" colspan="1">Mouse myoblasts</td><td rowspan="1" colspan="1">GSM582295</td><td rowspan="1" colspan="1">277</td><td rowspan="1" colspan="1">148 ± 7</td><td rowspan="1" colspan="1">278 ± 1</td><td rowspan="1" colspan="1">280 ± 1</td><td rowspan="1" colspan="1">278 ± 1</td><td rowspan="1" colspan="1">278</td><td rowspan="1" colspan="1">277</td></tr><tr><td rowspan="1" colspan="1">Mouse myoblasts</td><td rowspan="1" colspan="1">GSM582297</td><td rowspan="1" colspan="1">285</td><td rowspan="1" colspan="1">157 ± 6</td><td rowspan="1" colspan="1">286 ± 1</td><td rowspan="1" colspan="1">285 ± 1</td><td rowspan="1" colspan="1">284 ± 0</td><td rowspan="1" colspan="1">284</td><td rowspan="1" colspan="1">282</td></tr></tbody></table><table-wrap-foot><fn id="btt001-TF1"><p>‘F’ indicates failure. Read length is 36 bp for all datasets. SISSRs, Kharchenko-correlation and coverage yield an estimate for each chromosome; therefore, we report means ± 2 × standard errors for these cases. For comparison, mean estimates from naïve correlations computed by chromosome are also shown (naïve-BC). Naïve-WG lists whole-genome naïve correlation results. All estimates have been rounded to the nearest integer.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Problems with naïve cross-correlation as an estimator of fragment length</title>
      <p>Two issues are associated with the use of naïve cross-correlation as an estimator of fragment length. The first, relatively minor, issue is the noisy nature of the correlation signal itself because of which there is an uncertainty in the exact location of the peak’s summit. In other words, taking the <inline-formula><inline-graphic xlink:href="btt001i10.jpg"/></inline-formula> may be overly simplistic. This problem can be circumvented by smoothing the correlation signal using a suitable procedure, such as the moving average filter, thereby obtaining an unambiguous summit location. The effect of smoothing is illustrated in <xref ref-type="fig" rid="btt001-F1">Figure 1</xref>, where the raw and the smoothed cross-correlation signals are displayed for the yeast dataset.
<fig id="btt001-F1" position="float"><label>Fig. 1.</label><caption><p>Cross-correlation curve indicating the fragment-length estimate for yeast nucleosome single-end data created from a paired-end dataset. The estimated mean fragment length is 153, whereas the true value is 154. The figure also illustrates the effect of smoothing the correlation curve to more robustly determine fragment length. A central moving average taking 15 samples on either side of the current value has been performed</p></caption><graphic xlink:href="btt001f1p"/></fig></p>
      <p>The other, more serious, problem associated with the method is its unreliability. First, with paired-end data, we observed that the method fails for the <italic>Arabidopsis</italic> dataset. More failures were then encountered on testing further on a number of other single-end datasets, including some from our own group. Still unclear on whether this was just a quirk of the data or a more general phenomenon, we investigated even further using several additional public datasets: ENCODE ChIP-Seq in human based on seven methylation pulldowns, six TF pulldowns and a control (GEO Series GSE29611); ENCODE ChIP-Seq in mouse based on a methylation pulldown, four TF pulldowns and a control (GEO Series GSE31039); and a variety of ChIP-Seq, methylation and input DNA datasets from the EBF1 transcription factor study in mouse (GEO GSE35857) and the histone-modification study in NCCIT cell lines in human (GEO GSE25882). In these datasets too, we found that the naïve cross-correlation sometimes seemed to work and sometimes failed. <xref ref-type="fig" rid="btt001-F2">Figure 2</xref> shows three representative examples where naïve cross-correlation fails (thin curves). The trouble in such cases is caused by the tall ‘phantom’ peak occurring at or around the read length that overshadows the ‘true’ peak around the expected fragment length. A seemingly straightforward solution to this problem is to simply ignore or mask the phantom peak. However, as can be deciphered from <xref ref-type="fig" rid="btt001-F2">Figure 2</xref>, the phantom peak not only overshadows the true peak but also affects its shape and location, in many cases displacing the summit significantly. It is, therefore, necessary to systematically address the problem to identify its root cause and thereby eliminate the phantom peak. Although the phenomenon has been partly attributed to poor enrichment (<xref ref-type="bibr" rid="btt001-B16">Landt <italic>et al.</italic>, 2012</xref>), our investigation revealed other critical mappability issues at play that can be effectively corrected for, resulting in the almost complete elimination of the phantom peak. These details, along with a more complete summary of our analysis, are presented in the next section.
<fig id="btt001-F2" position="float"><label>Fig. 2.</label><caption><p>Comparison of fragment-length estimates obtained using naïve cross-correlation and the proposed MaSC algorithm. (<bold>a</bold>) Human HSMMtube ChIP-Seq H3K4me3 pulldown from the ENCODE project (GEO GSM733738), (<bold>b</bold>) mouse lymph node ChIP-Seq EBF1 pulldown (GEO GSM876624) and (<bold>c</bold>) mouse bone marrow input DNA (GEO GSM876641). In all cases, the phantom peak (occurring at the read length of 36 bp) has been eliminated almost completely by the MaSC algorithm, thereby predicting the correct fragment-length estimates. The estimates in the legend insets are the values obtained after applying moving-average smoothing</p></caption><graphic xlink:href="btt001f2p"/></fig></p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Mappability-sensitive cross-correlation yields correct fragment length estimates on test data</title>
      <p>The appearance of the naïve cross-correlation curves in <xref ref-type="fig" rid="btt001-F2">Figure 2</xref> suggests that there are at least two factors influencing the positive- and negative-strand read densities. One results in a peak near the fragment length and the other results in a peak near the read length. We reasoned that the factor related to read length may be occurring because of <italic>mappability</italic>. A given base pair position <italic>b</italic> in the genome is mappable with length <italic>R</italic> reads if the sequence of <italic>R</italic> nucleotides beginning at position <italic>b</italic> occurs nowhere else in the genome. Thus, if a short-read dataset contains a read with exactly those <italic>R</italic> nucleotides, then one presumes that one end of the DNA fragment came from exactly that genomic position. (Although we have assumed an exact match here for simplicity of explanation, mismatches are usually allowed in practice.) However, if the <italic>R</italic>-mer beginning at position <italic>b</italic> matches exactly the <italic>R</italic>-mer beginning at one or more other positions in the genome, then position <italic>b</italic> is deemed to be unmappable. When a dataset contains a read with such an <italic>R</italic>-mer, its true genomic source position is ambiguous; hence, the read is usually discarded. A zero value in the functions <italic>f</italic> and <italic>g</italic> may thus represent either the absence of a read at a mappable position or an unmappable position altogether. If a zero indeed represents an unmappable position, then including it in the cross-correlation computation introduces an artificial correlation between <italic>f</italic> and <italic>g</italic>—in particular, at a shift equal to <italic>R</italic> − 1 because if position <italic>b</italic> is unmappable for a positive-strand read, then position <italic>b</italic> + <italic>R</italic> − 1 is unmappable for the (reverse complement) negative-strand read. We reasoned that if we could correct for this artificial mappability-induced correlation between <italic>f</italic> and <italic>g</italic>, we might eliminate the phantom peak in the cross-correlation curve that confuses the fragment-length estimation algorithm. It must be mentioned that a value of ‘1’ in <italic>f</italic> or <italic>g</italic> has no ambiguity associated with it, as it represents a mappable position where a read has fallen.</p>
      <p>The essence of our proposal is to use cross-correlation to estimate fragment length, but to compute it using only bases where the positive strand and the shifted negative strand are both mappable (<xref ref-type="fig" rid="btt001-F3">Fig. 3</xref>). More formally, let <italic>M<sub>R</sub></italic> be the set of positive-strand positions in the genome that are mappable with length <italic>R</italic> reads. This would be the set of shaded positions in row 2 of <xref ref-type="fig" rid="btt001-F3">Figure 3</xref>. The corresponding set of positions in the negative strand that are mappable with length <italic>R</italic> reads would be <inline-formula><inline-graphic xlink:href="btt001i11.jpg"/></inline-formula>, and for a shift <italic>d</italic> of the negative strand, this set would become <inline-formula><inline-graphic xlink:href="btt001i12.jpg"/></inline-formula>. These positions (shaded) are shown in row 3 of <xref ref-type="fig" rid="btt001-F3">Figure 3</xref>. Now let <inline-formula><inline-graphic xlink:href="btt001i13a.jpg"/></inline-formula>
<inline-formula><inline-graphic xlink:href="btt001i13.jpg"/></inline-formula>, which we call the set of <italic>doubly mappable</italic> positions at shift <italic>d</italic>. If <inline-formula><inline-graphic xlink:href="btt001i14.jpg"/></inline-formula>, it means that neither <italic>f</italic>(<italic>b</italic>) nor <italic>g</italic>(<italic>b</italic> + <italic>d</italic>) is constrained to be zero because of unmappability. To correct for mappability, the cross-correlation should be computed only over the doubly mappable positions. Accordingly, we define sample means and variances of <italic>f</italic> and <italic>g</italic> as <inline-formula><inline-graphic xlink:href="btt001i15.jpg"/></inline-formula>
<inline-formula><inline-graphic xlink:href="btt001i15a.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="btt001i16a.jpg"/></inline-formula>
<inline-formula><inline-graphic xlink:href="btt001i16.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="btt001i17.jpg"/></inline-formula> denotes cardinality of the set. The <italic>mappability-sensitive cross-correlation</italic> (MaSC) is then defined as
<disp-formula id="btt001-M2"><label>(2)</label><graphic xlink:href="btt001m2"/></disp-formula>
<fig id="btt001-F3" position="float"><label>Fig. 3.</label><caption><p>Illustration of MaSC computation at the base-pair level for a single shift <italic>d</italic>. A ‘1’ indicates the presence of a read or a mappable location. Rows 1 and 2 denote positive-strand read locations and mappability, whereas rows 3 and 4 denote negative-strand mappability and read locations, respectively. Only reads falling in doubly mappable locations, i.e. locations having ‘1’s in both rows 2 and 3 (shaded), are included in the cross-correlation computation between rows 1 and 4. Other reads are discarded. Naïve cross-correlation, on the other hand, simply computes correlation between rows 1 and 4, regardless of mappability</p></caption><graphic xlink:href="btt001f3p"/></fig></p>
      <p>To test whether the MaSC computation corrects fragment-length estimation, we applied it on the single-end datasets mentioned in the previous section. The mappability maps corresponding to the species and read lengths were obtained from the UCSC Table Browser (<xref ref-type="bibr" rid="btt001-B4">Karolchik <italic>et al.</italic>, 2004</xref>). The thick curves in <xref ref-type="fig" rid="btt001-F2">Figure 2</xref> were obtained using MaSC. From the plots, it is clear that the MaSC algorithm almost completely eliminates the phantom peak occurring at read length, thereby correcting the fragment-length estimate. In ∼40 different datasets we tested, consisting of a variety of ChIP-Seq, methylation and control/input DNA, the phantom peak occurred with varying strengths. In ∼20% of the cases, it was strong enough to overshadow what we take to be the true peak at a plausible fragment-length estimate. In all such cases where the phantom peak presented a problem, MaSC eliminated it almost completely, thus enabling accurate fragment-length estimation. The results for these cases along with the GEO identifiers are presented in <xref ref-type="table" rid="btt001-T2">Table 2</xref>, comparing the fragment-length estimates obtained using naïve cross-correlation, MaSC and the four external methods, namely, MACS, SISSRs, Kharchenko-correlation and ‘coverage’. Since the last three methods output an estimate for each chromosome, for comparison, MaSC results on individual chromosomes are also shown. For these methods, failure rates were computed by setting a threshold that is slightly larger than the read length for a given dataset and classifying all estimates (both chromosomal and means) below this threshold as failures or invalid estimates. These rates are also listed in the table. The threshold was set at 50 for the 36-bp datasets and 90 for the 75-bp dataset.
<table-wrap id="btt001-T2" position="float"><label>Table 2.</label><caption><p>Comparison of fragment-length estimates using different methods</p></caption><table frame="hsides" rules="groups"><tbody align="left"><tr><td rowspan="1" colspan="1"><inline-graphic xlink:href="btt001i30.jpg"/></td></tr></tbody></table><table-wrap-foot><fn id="btt001-TF2"><p>The first five rows correspond to data from the ENCODE project. SISSRs, Kharchenko-correlation and coverage output estimates by chromosome. Hence, these columns have means ± 2 × standard errors. For comparison, MaSC results by chromosome are also included (‘MaSC-BC’). ‘MaSC-WG’ lists whole-genome MaSC results. ‘RL’ lists read lengths. Estimates have been rounded to the nearest integer, and smoothing has been applied for MaSC estimates. The %F columns list the % of failures, i.e. the % of chromosomal estimates at or near the read length.</p></fn></table-wrap-foot></table-wrap></p>
      <p>Since these datasets are single-ended, true mean fragment lengths cannot be computed for benchmarking. Nevertheless, some general observations can be made as follows. MACS yields a valid estimate only in three of the nine cases, whereas in the others it seems to be picking up the phantom peak. SISSRs, on the other hand, yields valid mean estimates with some variability, although, in many cases, its estimates are quite different from those of the other methods. Kharchenko-correlation, which is similar to the naïve correlation, proves to be unreliable for these datasets as expected, displaying large uncertainties and failure rates due largely to the dominance of the phantom peak. The method ‘coverage’, which performed quite well on the paired-end datasets, suffers from significantly large failure rates on the single-end datasets. For the specific case GSM733721, the method completely fails yielding an invalid mean estimate. MaSC-BC performs well on all datasets, including the ones where it has non-zero failure rates. Thus, in the overall analysis, although the concept of strand cross-correlation is well founded and suitable for fragment-length estimation, on its own, it is not sufficiently reliable because of the problems caused by the frequently occurring phantom peak in typical NGS datasets. Tests we conducted using both our implementation as well as that of Kharchenko <italic>et al.</italic> confirm this observation. However, if the causative factor of the phantom peak is corrected for, as we propose here through the MaSC algorithm, the peak is eliminated almost entirely, and the reliability of the cross-correlation technique is greatly improved, resulting in valid and accurate fragment-length estimates. In comparison, none of the other techniques we investigated demonstrated consistent reliability. Between MaSC-BC and MaSC-WG, the latter provides more robust and consistent results. Hence, to obtain accurate estimates, we recommend running MaSC on whole datasets instead of on individual chromosomes. As further tests of robustness, we conducted two more investigations. First, we ran MaSC on a number of randomly sampled subsets of decreasing size of some of our single-end test datasets. MaSC yielded meaningful estimates even with as little as 50% of the reads, although variability in the estimates generally increased with decreasing number of reads (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt001/-/DC1">Supplementary Section S2</ext-link>). Secondly, we used different short-read aligners to remap the reads and ran MaSC on the resulting alignments. The accuracy of the MaSC estimates did not get influenced by the type of the aligner used (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt001/-/DC1">Supplementary Section S3</ext-link>).</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Algorithmic implementation and efficiency</title>
      <p>In Section 2.3, we have defined MaSC in terms of binary functions <italic>f</italic> and <italic>g</italic>, which indicate the locations of positive- and negative-strand reads. Thus, the most obvious implementation of MaSC would involve computations with such functions. However, NGS datasets are virtually always presented as lists of reads, with each element in a list specifying the position (chromosome and base pair) and orientation (positive or negative strand) of a read. Similarly, information on which positions in a genome are mappable is typically available as lists (<xref ref-type="bibr" rid="btt001-B4">Karolchik <italic>et al.</italic>, 2004</xref>; <xref ref-type="bibr" rid="btt001-B6">Koehler <italic>et al.</italic>, 2011</xref>). Thus, a list-based implementation of MaSC would also be natural and possibly more efficient, especially if the lists of reads and mappable intervals are short. To analyze the big-O complexity of these alternatives, let <italic>N</italic> denote the total number of reads, <italic>M</italic> the number of mappable intervals, <italic>G</italic> the genome size and <italic>D</italic> the number of distinct shifts at which we want to compute the cross-correlation.</p>
      <p>In a list-based implementation of MaSC, we would begin by separating the list of reads into positive- and negative-strand read lists, <italic>R</italic><sup>+</sup> and <italic>R</italic><sup>−</sup>. We would also ensure that the lists are sorted in ascending order by chromosome and position, so that subsequent operations can be carried out efficiently. Sorting would take <inline-formula><inline-graphic xlink:href="btt001i18.jpg"/></inline-formula> time. Then, for each shift <italic>d</italic>, we would do the following. First, compute the set of doubly mappable base pairs <inline-formula><inline-graphic xlink:href="btt001i19.jpg"/></inline-formula> at that shift. This can be done by shifting the mappable intervals to produce <inline-formula><inline-graphic xlink:href="btt001i20.jpg"/></inline-formula>, and then intersecting this set with <italic>M<sub>R</sub></italic>. Both these operations can be carried out in <italic>O</italic>(<italic>M</italic>) time, assuming that the mappable intervals have already been sorted in ascending order. (If the mappable intervals are unsorted, then sorting would cost an additional <inline-formula><inline-graphic xlink:href="btt001i21.jpg"/></inline-formula> time. However, as this is a one-time cost per organism, we do not include it in our analysis. If the mappable intervals are not available at all, then they need to be computed based on the reference genome. This is a much more significant computation, but again, it is a one-time cost, and, at present, mappable intervals are available for many model organisms at a variety of read lengths.) Secondly, we would intersect the positive- and negative-strand read lists, <italic>R</italic><sup>+</sup> and <italic>R</italic><sup>−</sup>, with the doubly mappable base pairs <inline-formula><inline-graphic xlink:href="btt001i22.jpg"/></inline-formula>, which would take <italic>O</italic>(<italic>N</italic> + <italic>M</italic>) time. At this point, the means and variances in <xref ref-type="disp-formula" rid="btt001-M2">Equation (2)</xref> can be readily computed. Finally, to obtain the <inline-formula><inline-graphic xlink:href="btt001i23.jpg"/></inline-formula> term, we would perform one final intersection, between the positive- and negative-strand reads on doubly mappable bases, which would take <italic>O</italic>(<italic>N</italic>) time. The total time complexity would thus be <inline-formula><inline-graphic xlink:href="btt001i24.jpg"/></inline-formula>.</p>
      <p>In a binary-function implementation of MaSC, we would create the functions <italic>f</italic> and <italic>g</italic>, which would take <italic>O</italic>(<italic>G</italic> + <italic>N</italic>) time regardless of whether the original read list is sorted. Then, in <italic>O</italic>(<italic>G</italic> + <italic>M</italic>) time, we would create a function <italic>h</italic> identifying the mappable base pairs according to <italic>M<sub>R</sub></italic>. Then, for each shift <italic>d</italic>, we would create shifted versions of <italic>g</italic> and <italic>h</italic>, which would take <italic>O</italic>(<italic>G</italic>) time. The various element-wise intersections and summations would also take <italic>O</italic>(<italic>G</italic>) time. The total time complexity would thus be <italic>O</italic>[<italic>D</italic>(<italic>G</italic> + <italic>N</italic> + <italic>M</italic>)].</p>
      <p>Thus, in effect, in terms of big-O analysis, the difference between a list-based and binary-function implementations reduces to the difference between an <inline-formula><inline-graphic xlink:href="btt001i25.jpg"/></inline-formula> term and an <italic>O</italic>(<italic>DG</italic>) term. As <italic>G</italic> can be in the billions and <italic>D</italic> can be in the tens or hundreds, we would generally expect the list-based implementation to be faster. However, the binary-function implementation can benefit significantly if the functions are implemented as bit vectors, and the shifts and intersections are computed using hardware-level bit-wise operations. Our Perl implementation of MaSC, available at <ext-link ext-link-type="uri" xlink:href="http://www.perkinslab.ca/Software.html">http://www.perkinslab.ca/Software.html</ext-link>, uses bit-vectors. On a single core of a SunFire x2250 computer with 32 Gb RAM, it takes on average ∼30 min to estimate fragment length for each of the datasets studied in this article.</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 DISCUSSION</title>
    <p>We have demonstrated that mappability can introduce a strong bias into genome-wide cross-correlation computations of positive- and negative-strand read densities. When those computations are carried out to estimate fragment length, and when the bias is strong enough, a dramatically wrong fragment-length estimate can result. When used for peak calling, such incorrect estimates can have adverse effects on the set of peaks returned. Crucially, we have shown that the mappability-induced bias can be corrected for using our MaSC algorithm. Tests using a variety of public NGS datasets demonstrated the effectiveness of MaSC. We also showed that smoothing the correlation signal helps in obtaining an unambiguous summit location. We do recommend checking the plots of the smoothed and the unsmoothed signals provided by our software to ensure a reasonable agreement between the summit locations. The computational complexity of MaSC is comparable with the traditional cross-correlation computation. The only serious caveat to the MaSC computation is that it requires a mappability map to have been established for the target genome and for the read length under consideration. Such maps are not always available and are non-trivial to compute (<xref ref-type="bibr" rid="btt001-B6">Koehler <italic>et al.</italic>, 2011</xref>). However, when such mappability information is available, we see no reason not to use the MaSC computation instead of the traditional, biased cross-correlation computation.</p>
    <p>The pervasiveness of the mappability problem in correlation analysis is unclear. In some datasets we obtained from GEO, we found the problem, whereas other datasets did not show the problem. Generally, we expect datasets with shorter reads to be more susceptible because a greater fraction of the genome is unmappable with shorter reads. However, mappability also varies significantly by organism. The problem seems to be present both in older datasets and new datasets. We are presently planning a comprehensive examination of the large number of ENCODE ChIP-Seq datasets to get a better assessment of the issue.</p>
    <p>Although we have emphasized positive- versus negative-strand cross-correlation and the fragment-length estimation problem, our approach to eliminating mappability bias is relevant to other correlative-type analysis of short-read data. For instance, if one were to compute autocorrelation functions as a measure of the spatial structure of the genomic signal being assessed, a similar mappability correction could be performed. The concept could also be relevant to correlating different datasets–for instance, relating a transcription factor binding signal to a histone-modification signal. This would especially be true if the different datasets used different read lengths, and thus were differentially susceptible to mappability problems. Finally, based on the cross-correlation function, we have begun exploring the possibility of estimating not just the mean fragment length, but the variance as well, or, even more generally, the entire fragment-length distribution.</p>
  </sec>
  <sec id="SEC4">
    <title>4 MATERIALS AND METHODS</title>
    <p>A number of preprocessing steps were carried out to prepare the datasets. The paired-end datasets were first used directly to compute the true mean fragment lengths. They were then converted into single-end datasets before applying the fragment-length estimation algorithms. The <italic>Arabidopsis</italic> dataset was available as a single file containing the chromosomal start and end positions of the mapped fragments. However, this file seemed to have been created using paired-end alignment. As paired-end alignments have different mappability profiles compared to single-end alignments, we carried out a fresh alignment (using the same tools as originally used) by randomly choosing one read from each pair and aligning these reads independently as single ends to the TAIR8 genome using SSAHA2. The SAM output from SSAHA2 was converted to a BAM file and then to a BED file using the SAMtools and the BEDtools utilities, respectively, including only hits designated as ‘primary’. The yeast nucleosome data were available as two SRA files, one each for the two ends of the fragments. These were first converted to FASTQ files using the fastq-dump utility from NCBI. The reads were then used in two ways. (i) To obtain the true fragment-length statistics: the reads were mapped to the genome using Bowtie’s paired-end alignment option making sure the FASTQ files met the criteria for a successful paired-end alignment. The resulting SAM file containing the paired-end read locations was converted to BAM and then to a paired-end BED file. (ii) To create a single-end dataset: one read from each pair was randomly selected by walking through the paired FASTQ files, and the chosen set of reads were then independently mapped to the SacCer1 genome (2003) using ELAND (from the CASAVA 1.6 pipeline), including only reads that mapped to a single location (up to two mismatches in the 32-bp seed). The ELAND output was then converted to a BED file using an in-house Perl script. The mouse RNA-Seq datasets were available as BED files containing paired read locations, and since the read pairs had been mapped independently, we could create the single-end dataset by simply subsampling the aligned positions in a random fashion. The only preprocessing steps required were the elimination of orphaned reads by positioning matching reads next to each other and the elimination of read pairs spanning multiple exons.</p>
    <p>The single-end datasets were available either directly as BED files, or as SRA or BAM files. In the latter cases, necessary processing, including alignment and format conversions, was performed to obtain BED files. Perl code implementing the MaSC algorithm is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.perkinslab.ca/Software.html">http://www.perkinslab.ca/Software.html</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_29_4_444__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btt001_Supplementary_File_for_Online_Publication.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENT</title>
    <p>The authors gratefully acknowledge Dr Michael Rudnicki and Dr Vahab Soleimani for data and discussions.</p>
    <p><italic>Funding</italic>: This work was supported in part by the <funding-source>Natural Sciences and Engineering Council of Canada (NSERC)</funding-source> Discovery Grant <award-id>328154-2009</award-id>, by the <funding-source>Ontario Ministry of Economic Development and Innovation (MEDI)</funding-source> grants <award-id>RE03-001</award-id> and <award-id>RE05-084</award-id>, and by the <funding-source>Ottawa Hospital Research Institute (OHRI)</funding-source>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btt001-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barrett</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NCBI GEO: archive for functional genomics data sets–10 years on</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39</volume>
        <issue>Suppl. 1</issue>
        <fpage>D1005</fpage>
        <lpage>D1010</lpage>
        <pub-id pub-id-type="pmid">21097893</pub-id>
      </element-citation>
    </ref>
    <ref id="btt001-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Peakranger: a cloud-enabled peak caller for CHIP-seq data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>139</fpage>
        <pub-id pub-id-type="pmid">21554709</pub-id>
      </element-citation>
    </ref>
    <ref id="btt001-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jothi</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide identification of <italic>in vivo</italic> protein-DNA binding sites from ChIP-Seq data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>5221</fpage>
        <lpage>5231</lpage>
        <pub-id pub-id-type="pmid">18684996</pub-id>
      </element-citation>
    </ref>
    <ref id="btt001-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karolchik</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UCSC table browser data retrieval tool</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2004</year>
        <volume>32</volume>
        <issue>Suppl. 1</issue>
        <fpage>D493</fpage>
        <lpage>D496</lpage>
        <pub-id pub-id-type="pmid">14681465</pub-id>
      </element-citation>
    </ref>
    <ref id="btt001-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Design and analysis of CHIP-seq experiments for DNA-binding proteins</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>1351</fpage>
        <lpage>1359</lpage>
        <pub-id pub-id-type="pmid">19029915</pub-id>
      </element-citation>
    </ref>
    <ref id="btt001-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koehler</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The uniqueome: a mappability resource for short-tag sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>272</fpage>
        <lpage>274</lpage>
        <pub-id pub-id-type="pmid">21075741</pub-id>
      </element-citation>
    </ref>
    <ref id="btt001-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Landt</surname>
            <given-names>SG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChIP-seq guidelines and practices of the ENCODE and modENCODE consortia</article-title>
        <source>Genome Res.</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>1813</fpage>
        <lpage>1831</lpage>
        <pub-id pub-id-type="pmid">22955991</pub-id>
      </element-citation>
    </ref>
    <ref id="btt001-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <article-title>A decades perspective on DNA sequencing technology</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>470</volume>
        <fpage>198</fpage>
        <lpage>203</lpage>
        <pub-id pub-id-type="pmid">21307932</pub-id>
      </element-citation>
    </ref>
    <ref id="btt001-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Narzisi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mishra</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Comparing de novo genome assembly: the long and short of it</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e19175</fpage>
        <pub-id pub-id-type="pmid">21559467</pub-id>
      </element-citation>
    </ref>
    <ref id="btt001-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pepke</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computation for CHIP-seq and RNA-seq studies</article-title>
        <source>Nat. Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>S22</fpage>
        <lpage>S32</lpage>
        <pub-id pub-id-type="pmid">19844228</pub-id>
      </element-citation>
    </ref>
    <ref id="btt001-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rozowsky</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Peakseq enables systematic scoring of CHIP-seq experiments relative to controls</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2009</year>
        <volume>27</volume>
        <fpage>66</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="pmid">19122651</pub-id>
      </element-citation>
    </ref>
    <ref id="btt001-B11">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Sarkar</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Chipseq: A Package for Analyzing Chipseq Data</source>
        <year>2012</year>
        <comment>[R package]. version 1.6.1 <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/2.12/bioc/manuals/chipseq/man/chipseq.pdf">http://www.bioconductor.org/packages/2.12/bioc/manuals/chipseq/man/chipseq.pdf</ext-link> (20 January 2013, date last accessed)</comment>
      </element-citation>
    </ref>
    <ref id="btt001-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tuteja</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Extracting transcription factor targets from CHIP-seq data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>e113</fpage>
        <pub-id pub-id-type="pmid">19553195</pub-id>
      </element-citation>
    </ref>
    <ref id="btt001-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Valouev</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide analysis of transcription factor binding sites based on CHIP-seq data</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>829</fpage>
        <lpage>834</lpage>
        <pub-id pub-id-type="pmid">19160518</pub-id>
      </element-citation>
    </ref>
    <ref id="btt001-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilbanks</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Facciotti</surname>
            <given-names>MT</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of algorithm performance in CHIP-seq peak detection</article-title>
        <source>PLoS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>e11471</fpage>
        <pub-id pub-id-type="pmid">20628599</pub-id>
      </element-citation>
    </ref>
    <ref id="btt001-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Model-based analysis of CHIP-seq (MACS)</article-title>
        <source>Genome Biol.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R137</fpage>
        <pub-id pub-id-type="pmid">18798982</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
