<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7293045</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkaa314</article-id>
    <article-id pub-id-type="publisher-id">gkaa314</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00010</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>Narese/7</subject>
        <subject>Narese/24</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Computational Biology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BREM-SC: a bayesian random effects mixture model for joint clustering single cell multi-omics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xinjun</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">1</xref>
        <xref ref-type="author-notes" rid="FN1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sun</surname>
          <given-names>Zhe</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">1</xref>
        <xref ref-type="author-notes" rid="FN1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Yanfu</given-names>
        </name>
        <xref ref-type="aff" rid="AFF2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Zhongli</given-names>
        </name>
        <xref ref-type="aff" rid="AFF3">3</xref>
        <xref ref-type="aff" rid="AFF4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xin</surname>
          <given-names>Hongyi</given-names>
        </name>
        <xref ref-type="aff" rid="AFF3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Heng</given-names>
        </name>
        <xref ref-type="aff" rid="AFF2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Duerr</surname>
          <given-names>Richard H</given-names>
        </name>
        <xref ref-type="aff" rid="AFF5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Kong</given-names>
        </name>
        <xref ref-type="aff" rid="AFF5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-1352-1000</contrib-id>
        <name>
          <surname>Ding</surname>
          <given-names>Ying</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-7196-8703</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Wei</given-names>
        </name>
        <!--<email>wei.chen@chp.edu</email>-->
        <xref ref-type="aff" rid="AFF1">1</xref>
        <xref ref-type="aff" rid="AFF3">3</xref>
        <xref ref-type="corresp" rid="COR1"/>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><label>1</label><institution>Department of Biostatistics, University of Pittsburgh</institution>, Pittsburgh, PA, <country country="US">USA</country></aff>
    <aff id="AFF2"><label>2</label><institution>Department of Electrical and Computer Engineering, University of Pittsburgh</institution>, Pittsburgh, PA, <country country="US">USA</country></aff>
    <aff id="AFF3"><label>3</label><institution>Department of Pediatrics, University of Pittsburgh</institution>, Pittsburgh, PA, <country country="US">USA</country></aff>
    <aff id="AFF4"><label>4</label><institution>School of Medicine, Tsinghua University</institution>, Beijing, <country country="CN">China</country></aff>
    <aff id="AFF5"><label>5</label><institution>Department of Medicine, University of Pittsburgh</institution>, Pittsburgh, PA, <country country="US">USA</country></aff>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +1 412 692 6241; Fax: +1 412 692 7636; Email: <email>wei.chen@chp.edu</email></corresp>
      <fn id="FN1">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>19</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-05-07">
      <day>07</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>48</volume>
    <issue>11</issue>
    <fpage>5814</fpage>
    <lpage>5824</lpage>
    <history>
      <date date-type="accepted">
        <day>20</day>
        <month>4</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="received">
        <day>07</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gkaa314.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Droplet-based single cell transcriptome sequencing (scRNA-seq) technology, largely represented by the 10× Genomics Chromium system, is able to measure the gene expression from tens of thousands of single cells simultaneously. More recently, coupled with the cutting-edge Cellular Indexing of Transcriptomes and Epitopes by Sequencing (CITE-seq), the droplet-based system has allowed for immunophenotyping of single cells based on cell surface expression of specific proteins together with simultaneous transcriptome profiling in the same cell. Despite the rapid advances in technologies, novel statistical methods and computational tools for analyzing multi-modal CITE-Seq data are lacking. In this study, we developed BREM-SC, a novel Bayesian Random Effects Mixture model that jointly clusters paired single cell transcriptomic and proteomic data. Through simulation studies and analysis of public and in-house real data sets, we successfully demonstrated the validity and advantages of this method in fully utilizing both types of data to accurately identify cell clusters. In addition, as a probabilistic model-based approach, BREM-SC is able to quantify the clustering uncertainty for each single cell. This new method will greatly facilitate researchers to jointly study transcriptome and surface proteins at the single cell level to make new biological discoveries, particularly in the area of immunology.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01HL137709</award-id>
        <award-id>P01AI106684</award-id>
        <award-id>U01DK062420</award-id>
        <award-id>UL1TR001857</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Revolutionary tools such as Cellular Indexing of Transcriptomes and Epitopes by Sequencing (CITE-Seq) and RNA expression and protein sequencing assay (REAP-seq) have been recently developed for measuring single cell surface protein and mRNA expression level simultaneously in the same cell (<xref rid="B1" ref-type="bibr">1–3</xref>). Oligonucleotide-labeled antibodies are used to integrate cellular protein and transcriptome measurements. It combines highly multiplexed protein marker detection with transcriptome profiling for thousands of single cells. CITE-Seq allows for immunophenotyping of cells using existing single cell sequencing approaches (<xref rid="B3" ref-type="bibr">3</xref>), and it is fully compatible with droplet-based single cell RNA sequencing (scRNA-Seq) technology (e.g. 10× Genomics Chromium system (<xref rid="B4" ref-type="bibr">4</xref>)) and utilizes the discrete count of Antibody-Derived Tags (ADT) as the direct measurement of cell surface protein abundance. This promising and popular technology provides an unprecedent opportunity for jointly analyzing transcriptome and surface proteins at the single cell level in a cost-effective way.</p>
    <p>In CITE-Seq experiment, the abundance of RNA and surface marker is quantified by Unique Molecular Index (UMI) and Antibody-Derived Tags (ADT) respectively, for a common set of cells at the single cell resolution. These two data sources represent different but highly related and complementary biological components. Classic cell type identification relies on cell surface protein abundance, which can be measured individually with flow cytometry. Recently, scRNA-Seq data are also used to classify cell types, based on differentially expressed genes among different cell types. In fact, both data sources have their unique characteristics and can provide complementary information. For example, the use of cell surface proteins for cell gating is advantageous in identifying common cell types but may not successfully identify some rare cell types due to its low dimensionality. On the other hand, although cell clustering based on scRNA-Seq could identify more cell types because of its higher dimensionality, it is less capable to distinguish highly similar cell types, such as CD4+ T cells and CD8+ T cells, due to a poor observed correlation between a mRNA and its translated protein expression in single cell (<xref rid="B3" ref-type="bibr">3</xref>,<xref rid="B5" ref-type="bibr">5</xref>,<xref rid="B6" ref-type="bibr">6</xref>).</p>
    <p>Despite the promise of this new technology, current statistical methods for jointly analyzing data from scRNA-Seq and CITE-Seq are still unavailable or immature. A novel joint clustering approach that fully utilizes the advantages and unique features of these single cell multi-omics data will lead to a more powerful tool in identifying rare cell types or reduce false positives such as doublets. Many statistical methods have been proposed for clustering scRNA-Seq data only, such as single cell interpretation via multi-kernel learning (SIMLR) (<xref rid="B7" ref-type="bibr">7</xref>), CellTree (duVerle <italic>et al.</italic>, 2016), Seurat (<xref rid="B8" ref-type="bibr">8</xref>), SC3 (<xref rid="B9" ref-type="bibr">9</xref>), DIMM-SC (<xref rid="B10" ref-type="bibr">10</xref>) and BAMM-SC (<xref rid="B11" ref-type="bibr">11</xref>), which are either from different clustering approach categories or recommended by recent reviewers (<xref rid="B12" ref-type="bibr">12</xref>,<xref rid="B13" ref-type="bibr">13</xref>). In contrast, to our best knowledge, there is no published method tailored for joint clustering multi-omics data from CITE-Seq. A naïve approach is to do separate analysis on each data source, which is straightforward but suffering from various of issues such as lack of power and failing to capture the associations between transcriptome and expression of surface proteins. Multimodal data analysis, on the other hand, is supposed to achieve a more detailed characterization of cellular phenotypes than using transcriptome measurements alone.</p>
    <p>In this study, we propose BREM-SC, a Bayesian Random Effects Mixture Model for joint clustering scRNA-Seq and CITE-Seq data. Because there is no existing method tailored for clustering single cell multi-omics data jointly, we compare the performance of BREM-SC with three popular single source clustering methods, including <italic>K</italic>-means clustering, SC3 (<xref rid="B9" ref-type="bibr">9</xref>) and TSCAN (<xref rid="B14" ref-type="bibr">14</xref>), and two commonly used multi-source clustering methods in the engineering field, including Multi-View Non-negative Matrix Factorization equipped with capped norm (MV-NMF) (<xref rid="B15" ref-type="bibr">15</xref>) and Pair-wised Co-regularized Multi-modal Spectral Clustering (PC-MSC) (<xref rid="B16" ref-type="bibr">16</xref>), in our simulation studies. <italic>K</italic>-means is one of the most popular clustering methods and has been used in the first 10× Genomics publication (<xref rid="B4" ref-type="bibr">4</xref>). SC3 and TSCAN have also been proposed for clustering scRNA-Seq data, but they fall in different clustering categories. For example, SC3 is a single cell consensus clustering method, where a consensus matrix is calculated using the Cluster-based Similarity Partitioning Algorithm (CSPA). Unlike SC3, TSCAN performs model-based clustering on the transformed expression values. We also compared BREM-SC with two existing methods MV-NMF and PC-MSC, which were developed for analyzing multi-source data. MV-NMF considers the non-negative entry constraints in dimension reduction while preserving the cross-modal consistency for reduced features, after which a standard <italic>K</italic>-means is used to finalize the clustering. To make the model robust to outliers, a capped-norm objective is also utilized. Alternatively, PC-MSC introduces a co-regularization on the spectral clustering. Neither MV-NMF nor PC-MSC has been used in single cell multi-omics analysis before, but they can be directly applied to our CITE-seq data. In our real data applications, we also include Seurat (<xref rid="B17" ref-type="bibr">17</xref>,<xref rid="B18" ref-type="bibr">18</xref>), one of the most popular tools for single cell analysis, and DIMM-SC (<xref rid="B10" ref-type="bibr">10</xref>), the single source version of BREM-SC, to benchmark the performance of single source clustering compared to joint clustering.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Statistical model and estimation</title>
      <p>The data illustration and general framework of BREM-SC modeling are shown in Figure <xref ref-type="fig" rid="F1">1</xref>. Although data from both sources are count data, there are several major differences between them. Firstly, the drop-out events are very common in the transcriptomic data, which are in fact much less frequent in the proteomic data. Therefore, the data matrix for RNA source is relatively sparse and people usually screen out genes with low variability in expression before performing analysis. Secondly, the overall scale of two data sets are significantly different, where proteomic data have larger values due to higher abundance of proteins in a cell. Based on the facts, we propose separate parametric model for each data source.</p>
      <fig id="F1" orientation="portrait" position="float">
        <label>Figure 1.</label>
        <caption>
          <p>Core logic of BREM-SC method for joint clustering RNA and ADT single cell data.</p>
        </caption>
        <graphic xlink:href="gkaa314fig1"/>
      </fig>
      <p>Suppose there are <inline-formula><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math></inline-formula> cells generated from CITE-Seq, denote by the transcriptomic data a matrix <inline-formula><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${{\boldsymbol{X}}^{({\bf 1})}}$\end{document}</tex-math></inline-formula> and its ADT levels (measurement of surface protein) a matrix <inline-formula><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${{\boldsymbol{X}}^{({\bf 2})}}$\end{document}</tex-math></inline-formula>. We use a latent variable vector <inline-formula><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{Z}}$\end{document}</tex-math></inline-formula> with elements <inline-formula><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${z_j}$\end{document}</tex-math></inline-formula> to represent the cell type label for cell <inline-formula><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula>, where <inline-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j\ = \ 1, \ldots ,C$\end{document}</tex-math></inline-formula>.</p>
      <p>For transcriptomic data, each element <inline-formula><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$x_{ij}^{( 1 )}$\end{document}</tex-math></inline-formula> in the raw count matrix represents the number of unique UMIs for gene <inline-formula><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i$\end{document}</tex-math></inline-formula> in cell <inline-formula><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula>, where <inline-formula><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i$\end{document}</tex-math></inline-formula> runs from 1 to the total number of genes <inline-formula><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$G$\end{document}</tex-math></inline-formula>, and <inline-formula><tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula> runs from 1 to the total number of cells <inline-formula><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math></inline-formula>. We then denote the number of unique UMIs in the <inline-formula><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula> th single cell by a vector <inline-formula><tex-math id="M18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{x}}_{\boldsymbol{j}}^{( 1 )} = ( {x_{1j}^{( 1 )},x_{2j}^{( 1 )}, \ldots ,x_{Gj}^{( 1 )}} )\ .$\end{document}</tex-math></inline-formula> We assume that <inline-formula><tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{x}}_{\boldsymbol{j}}^{( 1 )}$\end{document}</tex-math></inline-formula> follows a multinomial distribution with parameter vector <inline-formula><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{p}}_{\boldsymbol{j}}^{( 1 )} = ( {p_{1j}^{( 1 )},p_{2j}^{( 1 )}, \ldots ,p_{Gj}^{( 1 )}} )\ .$\end{document}</tex-math></inline-formula> For this multinomial distribution, we further assume that the proportion <inline-formula><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{p}}_{\boldsymbol{j}}^{( 1 )} = ( {p_{1j}^{( 1 )},p_{2j}^{( 1 )}, \ldots ,p_{Gj}^{( 1 )}} )$\end{document}</tex-math></inline-formula> follows a Dirichlet distribution <inline-formula><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Dir\,( {{{\boldsymbol{\alpha }}^{( 1 )}}} ) = Dir\,( {\alpha _1^{( 1 )},\alpha _2^{( 1 )}, \ldots ,\alpha _G^{( 1 )}} )$\end{document}</tex-math></inline-formula>, with all the elements in <inline-formula><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${{\boldsymbol{a}}^{({\bf 1})}}$\end{document}</tex-math></inline-formula> being strictly positive. Next, we assume that the cell population consists of <inline-formula><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$K$\end{document}</tex-math></inline-formula> distinct cell types. To provide a more flexible modeling framework and allow for unsupervised clustering, we extend the aforementioned single Dirichlet prior to a mixture of <inline-formula><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$K$\end{document}</tex-math></inline-formula> Dirichlet distributions, indexed by <inline-formula><tex-math id="M26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$k = 1, \ldots ,K$\end{document}</tex-math></inline-formula> and each with parameter <inline-formula><tex-math id="M27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{\alpha }}_{( {\boldsymbol{k}} )}^{( 1 )}$\end{document}</tex-math></inline-formula>. For instance, if cell <inline-formula><tex-math id="M28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula> belongs to the <inline-formula><tex-math id="M29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$k$\end{document}</tex-math></inline-formula>th cell type, its gene expression profile <inline-formula><tex-math id="M30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{p}}_{\boldsymbol{j}}^{( 1 )}$\end{document}</tex-math></inline-formula> follows a cell-type-specific prior distribution <inline-formula><tex-math id="M31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Dir( {{\boldsymbol{\alpha }}_{( {\boldsymbol{k}} )}^{( 1 )}} )$\end{document}</tex-math></inline-formula>. The Dirichlet multinomial density for cell <inline-formula><tex-math id="M32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula>, as illustrated in DIMM-SC (<xref rid="B10" ref-type="bibr">10</xref>), can be obtained by multiplying the Dirichlet mixture prior by the multinomial density and then integrating out <inline-formula><tex-math id="M33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p_j^{( 1 )}$\end{document}</tex-math></inline-formula>, which is derived as <inline-formula><tex-math id="M34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P\ ( {{\boldsymbol{x}}_{\boldsymbol{j}}^{( 1 )}{\rm{|}}{{\boldsymbol{\alpha }}^{( 1 )}}} ) = \frac{{T_j^{( 1 )}!}}{{\mathop \prod \nolimits_{i = 1}^G x_{ij}^{( 1 )}!}}\ ( {\mathop \prod \limits_{i\ = \ 1}^G \frac{{\Gamma ( {x_{ij}^{( 1 )} + \alpha _i^{( 1 )}} )}}{{\Gamma ( {\alpha _i^{( 1 )}} )}}} )\frac{{\Gamma ( {| {{{\boldsymbol{\alpha }}^{( 1 )}}} |} )}}{{\Gamma ( {T_j^{( 1 )} + | {{{\boldsymbol{\alpha }}^{( 1 )}}} |} )}}$\end{document}</tex-math></inline-formula>, where <inline-formula><tex-math id="M35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T_j^{( 1 )} = \mathop \sum \limits_i x_{ij}^{( 1 )}$\end{document}</tex-math></inline-formula> is the total number of unique UMIs for <inline-formula><tex-math id="M36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula> th cell.</p>
      <p>Similarly, we also use the Dirichlet multinomial distribution to model surface protein (ADT) data. Suppose there are in total <inline-formula><tex-math id="M37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$D$\end{document}</tex-math></inline-formula> number of ADT markers, then similarly, the density of Dirichlet multinomial is derived as <inline-formula><tex-math id="M38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P\ ( {{\boldsymbol{x}}_{\boldsymbol{j}}^{( 2 )}{\rm{|}}{{\boldsymbol{\alpha }}^{( 2 )}}} ) = \frac{{T_j^{( 2 )}!}}{{\mathop \prod \nolimits_{d = 1}^D x_{dj}^{( 2 )}!}}\ ( {\mathop \prod \limits_{d\ = \ 1}^D \frac{{\Gamma ( {x_{dj}^{( 2 )} + \alpha _d^{( 2 )}} )}}{{\Gamma ( {\alpha _d^{( 2 )}} )}}} )\frac{{\Gamma ( {| {{{\boldsymbol{\alpha }}^{( 2 )}}} |} )}}{{\Gamma ( {T_j^{( 2 )} + | {{{\boldsymbol{\alpha }}^{( 2 )}}} |} )}}$\end{document}</tex-math></inline-formula>, where <inline-formula><tex-math id="M39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$d = 1, \ldots ,D$\end{document}</tex-math></inline-formula> indicates the index for protein marker and <inline-formula><tex-math id="M40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T_j^{( 2 )} = \mathop \sum \limits_d x_{dj}^{( 2 )}$\end{document}</tex-math></inline-formula> is the total ADT counts for <inline-formula><tex-math id="M41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula> th cell.</p>
      <p>Without considering the correlation between two datasets, the joint log-likelihood for all cells, assuming full independency between two sources, can then be derived as<disp-formula id="M1"><label>(1)</label><tex-math id="M42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}\begin{array}{@{}*{1}{l}@{}} {\mathop \sum \limits_{j\ = \ 1}^C \mathop \sum \limits_{k\ = \ 1}^K I(\ {z_j} = \ k)\log\left\{ {\left( {\mathop \prod \limits_{i\ = \ 1}^G \frac{{\Gamma \left( {x_{ij}^{(1)} + \alpha _{i(k)}^{(1)}} \right)}}{{\Gamma \left( {\alpha _{i\left( k \right)}^{(1)}} \right)}}} \right)\frac{{\Gamma \left( {\left| {{\boldsymbol{\alpha }}_{({\boldsymbol{k}})}^{(1)}} \right|} \right)}}{{\Gamma \left( {T_j^{(1)} + \left| {{\boldsymbol{\alpha }}_{({\boldsymbol{k}})}^{(1)}} \right|} \right)}}} \right.}\\[10pt] {\left. {\qquad \times \left( {\mathop \prod \limits_{d\ = \ 1}^D \frac{{\Gamma \left( {x_{dj}^{(2)} + \alpha _{d(k)}^{(2)}} \right)}}{{\Gamma \left( {\alpha _{d(k)}^{(2)}} \right)}}} \right)\frac{{\Gamma \left( {\left| {{\boldsymbol{\alpha }}_{({\boldsymbol{k}})}^{(2)}} \right|} \right)}}{{\Gamma \left( {T_j^{(2)} + \left| {{\boldsymbol{\alpha }}_{({\boldsymbol{k}})}^{(2)}} \right|} \right)}}} \right\}.} \end{array}\end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>To further model the correlation between different data sources, we introduce cell-specific random effects into our framework. Since we assume that cells belonging to same cell type share common Dirichlet parameters, we model cell heterogeneity by directly multiplying cluster-specific Dirichlet parameters with the random effects, i.e. <inline-formula><tex-math id="M43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{\alpha }}_{{\boldsymbol{j}}( {\boldsymbol{k}} )}^{( 1 )} = {\boldsymbol{\alpha }}_{( {\boldsymbol{k}} )}^{( 1 )}{\boldsymbol{\ }}{b_j}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{\alpha }}_{{\boldsymbol{j}}( {\boldsymbol{k}} )}^{( 2 )} = {\boldsymbol{\alpha }}_{( {\boldsymbol{k}} )}^{( 2 )}{\boldsymbol{\ }}{b_j}$\end{document}</tex-math></inline-formula>, where <inline-formula><tex-math id="M45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{\alpha }}_{( {\boldsymbol{k}} )}^{( 1 )}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{\alpha }}_{( {\boldsymbol{k}} )}^{( 2 )}$\end{document}</tex-math></inline-formula> are the Dirichlet parameters of cell type <inline-formula><tex-math id="M47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$k$\end{document}</tex-math></inline-formula> for RNA and protein data, respectively, and <inline-formula><tex-math id="M48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${b_j}$\end{document}</tex-math></inline-formula> is the random effects for the <inline-formula><tex-math id="M49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula>th cell. Based on the fact that Dirichlet parameters are strictly positive numbers, we assume that this cell-specific random effects <inline-formula><tex-math id="M50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${b_j}\ \sim\ {\rm LogNormal}\ ( {0,\ \sigma _b^2} )$\end{document}</tex-math></inline-formula>, i.e., <inline-formula><tex-math id="M51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P\ ( {\boldsymbol{b}} ) = \mathop \prod \limits_{j = 1}^C \frac{1}{{{b_j}\sqrt {2\pi \sigma _b^2} }}{\rm exp}\{ { - \frac{{{{( {\log{b_j}} )}^2}}}{{2\sigma _b^2}}} \}$\end{document}</tex-math></inline-formula>. Finally, the complete log likelihood can be derived as<disp-formula id="M2"><label>(2)</label><tex-math id="M52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}\begin{array}{@{}*{2}{l}@{}} {log\,P\left( {{\alpha ^{(1)}},{\alpha ^{(2)}},Z,{b_j}\ {\rm{|}}{X^{(1)}},{X^{(2)}}} \right)\propto \sum _{j\ = \ 1}^C\sum _{k\ = \ 1}^K I(\ {z_j} = k)} \\[10pt] \times \ {\log\left\{ {\left( {\Pi _{i\ = \ 1}^G\frac{{\Gamma \left( {x_{ij}^{(1)} + \alpha _{i(k)}^{(1)}{b_j}} \right)}}{{\Gamma \left( {\alpha _{i\left( k \right)}^{(1)}{b_j}} \right)}}} \right)\frac{{\Gamma \left( {\left| {\alpha _{(k)}^{(1)}{b_j}} \right|} \right)}}{{\Gamma \left( {T_j^{(1)} + \left| {\alpha _{(k)}^{(1)}{b_j}} \right|} \right)}}} \right.}\\[10pt] {\left. {\qquad \times \left( {\Pi _{d\ = \ 1}^D\frac{{\Gamma \left( {x_{dj}^{(2)} + \alpha _{d(k)}^{(2)}{b_j}} \right)}}{{\Gamma \left( {\alpha _{d(k)}^{(2)}{b_j}} \right)}}} \right)\frac{{\Gamma \left( {\left| {\alpha _{(k)}^{(2)}{b_j}} \right|} \right)}}{{\Gamma \left( {T_j^{(2)} + \left| {\alpha _{(k)}^{(2)}{b_j}} \right|} \right)}}} \right\}}\\[10pt] \qquad +{ \sum _{j\ = \ 1}^C\left( { - \log{b_j} - \frac{{{{\left( {\log{b_j}} \right)}^2}}}{{2\sigma _b^2}}} \right) + \sum _{j\ = \ 1}^C\left( { - \frac{1}{2}\log\sigma _b^2} \right)} \end{array}\end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>We use Gibbs sampler to update<inline-formula><tex-math id="M53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\ {z_j}$\end{document}</tex-math></inline-formula>, and use random walk Metropolis within Gibbs sampler to iteratively update <inline-formula><tex-math id="M54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\alpha _{i( k )}^{( 1 )}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="M55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\alpha _{d( k )}^{( 2 )}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${b_j}$\end{document}</tex-math></inline-formula> in (Equation <xref ref-type="disp-formula" rid="M2">2</xref>) (details can be found in Supplementary Methods).</p>
    </sec>
    <sec id="SEC2-2">
      <title>Selection of the number of clusters and initial values</title>
      <p>To implement BREM-SC, it is critical to select the total number of clusters and the initial values for MCMC. Specifically, the number of clusters <inline-formula><tex-math id="M57">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$K$\end{document}</tex-math></inline-formula> can be defined either with prior knowledge or standard model checking criterion such as Akaike's Information Criteria (AIC) or Bayesian Information Criteria (BIC). Meanwhile, there are many methods to determine the initial values of <inline-formula><tex-math id="M58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\alpha _1},{\alpha _2}, \ldots ,{\alpha _G}$\end{document}</tex-math></inline-formula>. For BREM-SC we applied <italic>K</italic>-means clustering to get a preliminary clustering result for each data source separately, followed by using Ronning's method (<xref rid="B19" ref-type="bibr">19</xref>) to estimate initial values of <inline-formula><tex-math id="M59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{\alpha }}$\end{document}</tex-math></inline-formula>, which is similar to the estimation procedure implemented in DIMM-SC (<xref rid="B10" ref-type="bibr">10</xref>).</p>
    </sec>
    <sec id="SEC2-3">
      <title>Data generation algorithm for simulation studies under BREM-SC model</title>
      <p>Based on different parameter settings in our Dirichlet multinomial models, we simulated RNA expression and ADT measurements for each single cell. In the simulation set-up, the two count matrices were sampled from the proposed Dirichlet mixture models. Specifically, for a fixed number of cell clusters <inline-formula><tex-math id="M60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$K$\end{document}</tex-math></inline-formula>, we first pre-defined the values of <inline-formula><tex-math id="M61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{\alpha }}_{( {\boldsymbol{k}} )}^{( 1 )}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M62">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{\alpha }}_{( {\boldsymbol{k}} )}^{( 2 )}$\end{document}</tex-math></inline-formula> for the <inline-formula><tex-math id="M63">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$k$\end{document}</tex-math></inline-formula>th cell cluster. The random effects <inline-formula><tex-math id="M64">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${b_j}$\end{document}</tex-math></inline-formula> are generated from a log-normal distribution with pre-specified value <inline-formula><tex-math id="M65">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sigma _b^2$\end{document}</tex-math></inline-formula>. We then computed the transcriptomic profile <inline-formula><tex-math id="M66">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{\alpha }}_{{\boldsymbol{j}}( {\boldsymbol{k}} )}^{( 1 )}$\end{document}</tex-math></inline-formula> for each single cell by multiplying <inline-formula><tex-math id="M67">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{\alpha }}_{( {\boldsymbol{k}} )}^{( 1 )}$\end{document}</tex-math></inline-formula> by <inline-formula><tex-math id="M68">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${b_j}$\end{document}</tex-math></inline-formula>. Similarly, for cellular protein expression profile, we multiplied <inline-formula><tex-math id="M69">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{\alpha }}_{( {\boldsymbol{k}} )}^{( 2 )}$\end{document}</tex-math></inline-formula> by <inline-formula><tex-math id="M70">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${b_j}$\end{document}</tex-math></inline-formula> to compute <inline-formula><tex-math id="M71">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{\alpha }}_{{\boldsymbol{j}}( {\boldsymbol{k}} )}^{( 2 )}$\end{document}</tex-math></inline-formula>. For the next step, we sampled the cluster proportion <inline-formula><tex-math id="M72">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{p}}_{\boldsymbol{j}}^{( 1 )}$\end{document}</tex-math></inline-formula> (or <inline-formula><tex-math id="M73">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{p}}_{\boldsymbol{j}}^{( 2 )}$\end{document}</tex-math></inline-formula>) from a Dirichlet distribution <inline-formula><tex-math id="M74">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Dir( {{\boldsymbol{\alpha }}_{{\boldsymbol{j}}( {\boldsymbol{k}} )}^{( 1 )}} )$\end{document}</tex-math></inline-formula> (or <inline-formula><tex-math id="M75">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Dir( {{\boldsymbol{\alpha }}_{{\boldsymbol{j}}( {\boldsymbol{k}} )}^{( 2 )}} )$\end{document}</tex-math></inline-formula>). Lastly, we sampled the UMI count vector <inline-formula><tex-math id="M76">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{x}}_{\boldsymbol{j}}^{( 1 )}$\end{document}</tex-math></inline-formula> for <inline-formula><tex-math id="M77">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula> th cell from multinomial distribution <inline-formula><tex-math id="M78">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Multinomial( {T_j^{( 1 )},{\boldsymbol{p}}_{\boldsymbol{j}}^{( 1 )}} )$\end{document}</tex-math></inline-formula> and sampled the ADT count vector <inline-formula><tex-math id="M79">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{x}}_{\boldsymbol{j}}^{( 2 )}$\end{document}</tex-math></inline-formula> from <inline-formula><tex-math id="M80">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Multinomial( {T_j^{( 2 )},{\boldsymbol{p}}_{\boldsymbol{j}}^{( 2 )}} )$\end{document}</tex-math></inline-formula>, where <inline-formula><tex-math id="M81">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T_j^{( 1 )}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M82">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T_j^{( 2 )}$\end{document}</tex-math></inline-formula> are each simulated from truncated normal distribution with parameters estimated from real data.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Data generation algorithm for simulation studies under model misspecification</title>
      <p>We used R package <italic>Splatter</italic> (<xref rid="B20" ref-type="bibr">20</xref>) to simulate data to assess robustness of BREM-SC under model misspecification. In <italic>Splatter</italic>, the final data matrix is a synthetic dataset consisting of counts from a Gamma-Poisson (or negative-binomial) distribution. Since there is no existing method for generating single cell surface protein expression levels from CITE-Seq, we also used <italic>Splatter</italic> to generate ADT count for the proteomic data. To make our simulated gene expression data a good approximation to the real data, our model parameters (in <italic>Splatter</italic>) were estimated from the real data downloaded from 10X Genomics website (<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/b_cells">https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/b_cells</ext-link>). Specifically, for ADT data, we modified the <italic>Splatter</italic> parameters such as dropout rate, library size, expression outlier, and dispersion across features to make the simulated data more similar to real observed ADT data regarding the scale. We assumed all cell types are shared between gene expression and ADT data, and further specified differential expression parameters to generate scenarios with different magnitude of cell type differences.</p>
    </sec>
    <sec id="SEC2-5">
      <title>Setup of BREM-SC and competing methods used in this paper</title>
      <p>As a Bayesian method, to increase the stability of BREM-SC and avoid the extreme case of bad initialization, in practice we recommend running the algorithm with three to five chains simultaneously (parallel computing implemented within R package) and then choose the chain with maximum likelihood. In this study, we applied BREM-SC using three chains in simulation and real data analyses, and set the number of MCMCs to be 500. On the other hand, all clustering methods to which BREM-SC compared were performed under their default settings. Single-source clustering methods including <italic>K</italic>-means, SC3 and TSCAN were applied to the pooled data from RNA expression and ADT with centered log-ratio (clr)-transformation (<xref rid="B8" ref-type="bibr">8</xref>) for normalization when applicable while ignoring source specificity.</p>
    </sec>
    <sec id="SEC2-6">
      <title>Metrics for clustering performance</title>
      <p>We used adjusted rand index (ARI) (<xref rid="B21" ref-type="bibr">21</xref>) and adjusted mutual information (AMI) (<xref rid="B22" ref-type="bibr">22</xref>) as the metrics for clustering performance in our analysis. Both of them are commonly used metrics to indicate similarity between two clustering results. In general, ARI is based on pair-counting while AMI is based on Shannon information theory. ARI ranges from –1 to 1, where an ARI of value 1 indicates the clustering result is identical to the underlying truth, 0 indicates a clustering result by random clustering, and negative number indicates an even worse result than random clustering. Similar to ARI, an AMI of value 1 indicates a perfect clustering result while 0 indicates a random clustering result. Although ARI and AMI often agree in most situations, a previous study found that ARI is preferred when the reference clustering has relatively equal sized-clusters, while AMI is recommended when the reference clustering is unbalanced and thus small clusters could exist (<xref rid="B23" ref-type="bibr">23</xref>). Therefore, we used ARI as the clustering metric in our simulation studies since we simulated balanced clusters, and we used both ARI and AMI in our real data applications since the approximated ground truth cell types are not balanced.</p>
    </sec>
    <sec id="SEC2-7">
      <title>Public human peripheral blood mononuclear cells (PBMC) CITE-Seq dataset</title>
      <p>To assess the performance of BREM-SC, we used a published human PBMC CITE-Seq dataset downloaded from 10X Genomics website (<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/3.0.0/pbmc_10k_protein_v3">https://support.10xgenomics.com/single-cell-gene-expression/datasets/3.0.0/pbmc_10k_protein_v3</ext-link>). A total of 7,865 cells from a healthy donor were stained with 14 TotalSeq-B antibodies, including CD3, CD4, CD8a, CD14, CD15, CD16, CD19, CD25, CD45RA, CD45RO, CD56, CD127, PD-1 and TIGIT. Cell-matched scRNA-Seq data are available.</p>
    </sec>
    <sec id="SEC2-8">
      <title>In-house human PBMC CITE-Seq dataset</title>
      <p>To further evaluate the validity of our method. We generated an in-house CITE-seq dataset of human PBMC from a healthy donor under IRB approval from the University of Pittsburgh. 1372 cells were stained with Totalseq-A from BioLegend and are prepared using the 10x Genomics platform with Gel Bead Kit V2. The prepared assay is subsequently sequenced on an Illumina Hiseq with a depth of 50K reads per cell. Cells in this dataset are measured for their surface marker abundance through CITE-seq (<xref rid="B3" ref-type="bibr">3</xref>). Ten surface markers are measured for every cell: CD3, CD4, CD8a, CD11c, CD14, CD16, CD19, CD56, CD127 and CD154. Cell Ranger 3.0 was used to process the data and generate UMI matrix for the downstream analysis.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <p>To assess the performance of BREM-SC, we performed comprehensive simulation studies to compare BREM-SC with five existing clustering methods, including K-means, SC3, TSCAN, MV-NMF and PC-MSC, all of which are hard clustering approaches and thus will assign each cell to an exclusive cluster. We simulated scRNA-Seq and CITE-Seq data under both our proposed model and model misspecification (using R package Splatter (<xref rid="B20" ref-type="bibr">20</xref>)) to assess the validity and robustness of BREM-SC. For each simulation scenario, we simulated 100 datasets to assess the variability of clustering results for each method. We also applied BREM-SC on two human peripheral blood mononuclear cells (PBMC) CITE-Seq datasets to assess the usefulness of our method in real application.</p>
    <sec id="SEC3-1">
      <title>BREM-SC outperforms other methods in simulation studies under our proposed model</title>
      <p>We designed different simulation scenarios to assess the performance of BREM-SC by varying number of cells in each cluster, number of clusters, magnitude of cell type differences (i.e. the magnitude of difference among different clusters), and among-cell variabilities (indicated by the magnitude of random effects).</p>
      <p>The results of simulation studies under our proposed model are shown in Figure <xref ref-type="fig" rid="F2">2</xref>. In general, the performance of all clustering approaches decreases as the among-cell variability, indicated by <inline-formula><tex-math id="M83">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sigma _b^2$\end{document}</tex-math></inline-formula>, increases, number of clusters increases, and number of cells decreases. As shown in Figure <xref ref-type="fig" rid="F2">2A</xref>, BREM-SC outperformed the other five competing methods by achieving the highest average ARI among 100 simulations across different levels of among-cell variabilities.</p>
      <fig id="F2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>Boxplots of ARIs for six clustering methods across 100 simulations, investigating how various among-cell variabilities (<bold>A</bold>), magnitude of cell type differences (<bold>B</bold>), (W refers to weak signals between clusters; S refers to strong signals), number of cells in each cluster (<bold>C</bold>) and number of clusters (<bold>D</bold>) affect the clustering results.</p>
        </caption>
        <graphic xlink:href="gkaa314fig2"/>
      </fig>
      <p>Figure <xref ref-type="fig" rid="F2">2B</xref>–<xref ref-type="fig" rid="F2">D</xref> list the boxplots of ARI by varying magnitude of cell type differences, number of cells in each cluster, and number of clusters, respectively. In Figure <xref ref-type="fig" rid="F2">2B</xref>, we considered four scenarios in terms of signal strength from two data sources. To illustrate the advantage of joint clustering, we also applied <italic>K</italic>-means, SC3, TSCAN and DIMM-SC on ADT data alone. When the clustering signal is strong (i.e. difference among cell clusters is large) in both RNA expression and ADT data (referred to <italic>Both S</italic> column), both BREM-SC and SC3 performed extremely well while other methods show fair clustering results. However, when cell clusters are similar in either proteomics (referred to <italic>ADT W/ RNA S</italic> column) or transcriptomics data (referred to <italic>ADT S/ RNA W</italic> column), <italic>K</italic>-means and TSCAN produced less accurate clustering results, while BREM-SC and SC3 still performed well. As expected, strong clustering signal leads to higher clustering accuracy and lower clustering variability. If both RNA expression and ADT data are alike across different cell types (referred to <italic>Both W</italic> column), ARIs of all methods decreased but BREM-SC still performed the best. This simulation scenario clearly demonstrated that as long as either of the data source contains strong clustering signals, our BREM-SC takes full advantage of that and achieves highly satisfactory performance. In Figure <xref ref-type="fig" rid="F2">2C</xref>, we observed that more cells can provide more accurate and robust clustering results, which is as expected. In Figure <xref ref-type="fig" rid="F2">2D</xref>, we found that larger number of clusters is associated with worse clustering performance. Again, in both scenarios, BREM-SC outperformed the other five methods across all various settings.</p>
      <p>Consistently across all four scenarios shown in Figure <xref ref-type="fig" rid="F2">2</xref>, when data are generated from our proposed true model, BREM-SC outperformed <italic>K</italic>-means clustering, SC3, TSCAN, MV-NMF and PC-MSC, suggesting its advantages in fully utilizing both types of data simultaneously.</p>
    </sec>
    <sec id="SEC3-2">
      <title>BREM-SC outperforms other methods in simulation studies under model misspecification</title>
      <p>To evaluate the robustness of BREM-SC when the data generation model is mis-specified, we simulated additional datasets using R package <italic>Splatter</italic> (<xref rid="B20" ref-type="bibr">20</xref>), a commonly used tool to simulate scRNA-Seq data whose underlying models are completely different from ours. Figure <xref ref-type="fig" rid="F3">3</xref> shows the performance of BREM-SC and other competing methods under model misspecification. In Figure <xref ref-type="fig" rid="F3">3A</xref>, we simulated different signal strength for each data source using <italic>Splatter</italic>. Methods such as K-means and MV-NMF produced poor results across all scenarios even when signal strengths are large in both data sources. On the other hand, BREM-SC outperformed all other methods and showed good clustering performance even when signal strengths are relatively small in both data sources. In Figure <xref ref-type="fig" rid="F3">3B</xref>, we assessed the clustering performance across different probabilities that a gene is differentially expressed (DE). In general, higher DE probability indicates easier cell clustering. Again, we found that BREM-SC outperformed all other competing methods in terms of clustering accuracy. Therefore, we demonstrated the strong robustness of BREM-SC under model misspecification.</p>
      <fig id="F3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Boxplots of ARIs for six clustering methods across 100 simulations using Splatter. The performance under various magnitude of cell type differences were investigated. In (<bold>A</bold>), mean parameters of three cell types were set as (0.15, 0.151, 0.152) and (0.15, 0.2, 0.25) to represent two levels (S standards small and L standards for large) of cell type difference. In (<bold>B</bold>), different probabilities that a gene would be selected to be differentially expressed (DE) were set.</p>
        </caption>
        <graphic xlink:href="gkaa314fig3"/>
      </fig>
    </sec>
    <sec id="SEC3-3">
      <title>Analysis of a public human PBMC CITE-Seq dataset</title>
      <p>To evaluate the clustering performance of BREM-SC on real data, we first used a published human peripheral blood mononuclear cells (PBMC) CITE-Seq dataset downloaded from 10× Genomics website. A total of 7865 cells and 14 surface protein markers are included in this dataset in addition to matched scRNA-Seq data. As a standard approach of analyzing human PBMC dataset, we extracted the top 1000 highly variable genes using the algorithm implemented in Seurat that accounts for mean-variance relationship (<xref rid="B18" ref-type="bibr">18</xref>). We identified seven cell types based on the biological knowledge of both protein and gene markers as the approximate truth, which is illustrated in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>. Examples of such cell type identification procedure are shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2</xref>. Taken together, &gt;80% of single cells can be assigned to a specific cell type. Cells with uncertain cell types (not identified in the ground truth) were removed from computing ARIs and AMIs.</p>
      <p>We applied eight clustering methods (<italic>K</italic>-means clustering, TSCAN, SC3, Seurat, DIMM-SC, MV-NMF, PC-MSC and BREM-SC) on this dataset and performed both single source clustering (using ADT or RNA data only) and multi-source joint clustering, respectively. We ran each method ten times to evaluate the stability of clustering performance. Note that since TSCAN is a deterministic clustering method and generates identical results, stability of performance cannot be assessed from analyzing a single dataset for this method. Similar feature is for Seurat with a fixed resolution parameter. As shown in Table <xref rid="tbl1" ref-type="table">1</xref>, BREM-SC outperformed other methods for multi-source joint clustering in terms of both ARI and AMI. Also, we observed that the clustering results based on protein only are better than based on RNA only for all methods. For example, Seurat reached an ARI of 0.726 and AMI of 0.757 in protein only analysis, but only with ARI of 0.564 and AMI of 0.660 in RNA only analysis. We can explain this observation by the facts that we used much more protein information to build the approximated ground truth, and on the other hand, the transcriptome and proteome information are not as highly correlated as people may expect at single cell resolution, which has also been observed in other studies. Further, we used Uniform Manifold Approximation and Projection (UMAP) plot (<xref rid="B24" ref-type="bibr">24</xref>) to visualize the clustering results from BREM-SC. UMAP is a recently developed non-linear dimension reduction tool for visualization, but quickly gains popularity among single cell researches because of its outstanding performance. Figure <xref ref-type="fig" rid="F4">4</xref> shows the UMAP plots with each cell colored by their ground truth label (Figure <xref ref-type="fig" rid="F4">4A</xref>) and cluster labels inferred by BREM-SC (Figure <xref ref-type="fig" rid="F4">4B</xref>), respectively. In general, the two plots are highly similar regarding to the distribution of different clusters (ARI = 0.840), indicating the outstanding performance of BREM-SC.</p>
      <table-wrap id="tbl1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>Performance (ARI and AMI) of different clustering methods from ten times analyses of the public human PBMC real dataset</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">ARI</th>
              <th rowspan="1" colspan="1">AMI</th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">Mean (SD), [range]</th>
              <th rowspan="1" colspan="1">Mean (SD), [range]</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="3" rowspan="1">Single source clustering - RNA only</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">K-means</td>
              <td rowspan="1" colspan="1">0.524 (0.054), [0.508, 0.562]</td>
              <td rowspan="1" colspan="1">0.592 (0.022), [0.579, 0.632]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TSCAN</td>
              <td rowspan="1" colspan="1">0.563 (N/A), [N/A]</td>
              <td rowspan="1" colspan="1">0.591 (N/A), [N/A]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SC3</td>
              <td rowspan="1" colspan="1">0.596 (0.082), [0.456, 0.709]</td>
              <td rowspan="1" colspan="1">0.629 (0.060), [0.513, 0.706]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">DIMM-SC</td>
              <td rowspan="1" colspan="1">0.629 (0.030), [0.590, 0.676]</td>
              <td rowspan="1" colspan="1">0.666 (0.018), [0.653, 0.700]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Seurat</td>
              <td rowspan="1" colspan="1">0.564 (N/A), [N/A]</td>
              <td rowspan="1" colspan="1">0.660 (N/A), [N/A]</td>
            </tr>
            <tr>
              <td colspan="3" rowspan="1">Single source clustering - protein only</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>K</italic>-means</td>
              <td rowspan="1" colspan="1">0.653 (0.093), [0.436, 0.760]</td>
              <td rowspan="1" colspan="1">0.732 (0.048), [0.632, 0.808]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TSCAN</td>
              <td rowspan="1" colspan="1">0.691 (N/A), [N/A]</td>
              <td rowspan="1" colspan="1">0.717 (N/A), [N/A]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SC3</td>
              <td rowspan="1" colspan="1">0.649 (0.045), [0.568, 0.692]</td>
              <td rowspan="1" colspan="1">0.722 (0.035), [0.670, 0.777]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">DIMM-SC</td>
              <td rowspan="1" colspan="1">0.698 (0.046), [0.619, 0.741]</td>
              <td rowspan="1" colspan="1">0.744 (0.025) [0.701, 0.766]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Seurat</td>
              <td rowspan="1" colspan="1">0.726 (N/A), [N/A]</td>
              <td rowspan="1" colspan="1">0.757 (N/A), [N/A]</td>
            </tr>
            <tr>
              <td colspan="3" rowspan="1">Multi-source joint clustering</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>K</italic>-means</td>
              <td rowspan="1" colspan="1">0.661 (0.107), [0.471, 0.811]</td>
              <td rowspan="1" colspan="1">0.723 (0.059), [0.577, 0.781]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TSCAN</td>
              <td rowspan="1" colspan="1">0.586 (N/A), [N/A]</td>
              <td rowspan="1" colspan="1">0.635 (N/A), [N/A]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SC3</td>
              <td rowspan="1" colspan="1">0.679 (0.162), [0.430, 0.911]</td>
              <td rowspan="1" colspan="1">0.723 (0.096), [0.595, 0.870]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MV-NMF</td>
              <td rowspan="1" colspan="1">0.701 (0.154), [0.380, 0.856]</td>
              <td rowspan="1" colspan="1">0.679 (0.098), [0.473, 0.779]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PC-MSC</td>
              <td rowspan="1" colspan="1">0.641 (0.029), [0.621, 0.723]</td>
              <td rowspan="1" colspan="1">0.679 (0.018), [0.672, 0.729]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">BREM-SC</td>
              <td rowspan="1" colspan="1">0.728 (0.091), [0.585, 0.840]</td>
              <td rowspan="1" colspan="1">0.737 (0.048), [0.674, 0.800]</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <fig id="F4" orientation="portrait" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>The performance of BREM-SC with the public human PBMC CITE-Seq dataset (from 10X Genomics). The UMAP projection of cells are colored by the approximate ground truth (<bold>A</bold>) and BREM-SC clustering results (<bold>B</bold>).</p>
        </caption>
        <graphic xlink:href="gkaa314fig4"/>
      </fig>
    </sec>
    <sec id="SEC3-4">
      <title>‘Soft-clustering’ property of BREM-SC</title>
      <p>We further used this public human PBMC CITE-Seq dataset to illustrate the property of ‘soft-clustering’, that BREM-SC can provide the posterior probability that a given cell belongs to a specific cluster in addition to cell labels. We highlighted the ‘vague’ cells identified by BREM-SC on UMAP plots. Here ‘vague’ cells refer to those cells with largest posterior probability smaller than a pre-specified threshold. By setting up different probability threshold, the number of ‘vague’ cells can be controlled. In Figure <xref ref-type="fig" rid="F5">5</xref>, we showed the distribution of ‘vague’ cells, which are defined as the lowest 5% cells ranked by the largest cluster posterior probability, on UMAP plot for the public PBMC dataset. By comparing with Figure <xref ref-type="fig" rid="F4">4A</xref>, we found many of such ‘vague’ cells coincide with either the unknown cells that we fail to identify based on current biological knowledge or the cells on the boundary between two cell types that are closely attached to each other on UMAP plot. In addition, we observed that a subset of CD8+ T cells are labeled as ‘vague’ cells, which we suspect to be memory CD8+ T cells by differential expression analysis with RNA data. We also plotted the distribution of the top 1%, 2%, 3% and 4% ‘vague’ cells with the lowest certainty in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4</xref>.</p>
      <fig id="F5" orientation="portrait" position="float">
        <label>Figure 5.</label>
        <caption>
          <p>Illustration of ‘soft clustering’ property by highlighting ‘vague’ cells (about lowest 5% ranked by the largest cluster posterior probability) from BREM-SC.</p>
        </caption>
        <graphic xlink:href="gkaa314fig5"/>
      </fig>
    </sec>
    <sec id="SEC3-5">
      <title>Analysis of an in-house human PBMC CITE-Seq dataset</title>
      <p>Because there are limited public datasets of CITE-seq, to further evaluate our method, we performed a CITE-seq experiment on human PBMCs from a healthy donor with informed consent and University IRB approval. 10× Genomics Chromium system was used to generate CITE-Seq data with 10 cell surface markers designed in the experiment, which yielded a total of 1388 cells. Similarly, we extracted the top 1000 highly variable genes as we did for the public human PBMC dataset. For this dataset, we identified six subtypes of PBMCs based solely on the biological knowledge of cell-type-specific protein markers (illustrated in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>), and &gt;85% of single cells were assigned to a specific cell type using these markers. Examples of such cell type identification procedure are shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S3</xref>. We then used these cell labels as the approximated ground truth to benchmark the clustering performance for different clustering methods. Cells with uncertain cell types were removed when calculating ARIs and AMIs.</p>
      <p>Similar to the analysis of public human PBMC dataset, we applied eight clustering methods on this in-house PBMC dataset and repeated each method ten times to evaluate the stability of its performance. As shown in Figure <xref ref-type="fig" rid="F6">6</xref>, BREM-SC performed very well in the human PBMC samples (ARI = 0.985), since the UMAP plot with each cell colored by their cell-type label based on protein markers (Figure <xref ref-type="fig" rid="F6">6A</xref>) is highly similar to the plot generated from the clustering result of BREM-SC (Figure <xref ref-type="fig" rid="F6">6B</xref>). Clustering results for all methods are summarized in Table <xref rid="tbl2" ref-type="table">2</xref>. Again, BREM-SC outperformed all other competing methods for multi-source joint clustering based on the average ARI and AMI. However, it is observed that in general single source clustering with ADT count data performed better than multi-source joint clustering under this circumstance. The reason for this result is that the approximated ground truth is built solely based on protein markers, and thus will favor clustering analyses only using the protein data. Methods such as <italic>K</italic>-means and TSCAN performed much worse compared to their corresponding single source analysis results, indicating that they failed to properly incorporate RNA information and thus the joint clustering results were highly compromised by the inclusion of RNA ‘noises’. On the other hand, BREM-SC, although performed slightly worse than DIMM-SC with protein only clustering, still gives extremely satisfactory results (mean ARI = 0.966), indicating that BREM-SC can handle mRNA–protein association very well in real data and is robust to ‘noises’ introduced from one data source.</p>
      <fig id="F6" orientation="portrait" position="float">
        <label>Figure 6.</label>
        <caption>
          <p>The performance of BREM-SC for in-house human PBMC CITE-Seq dataset. The UMAP projection of cells are colored by the ground truth (<bold>A</bold>) and BREM-SC clustering results (<bold>B</bold>).</p>
        </caption>
        <graphic xlink:href="gkaa314fig6"/>
      </fig>
      <table-wrap id="tbl2" orientation="portrait" position="float">
        <label>Table 2.</label>
        <caption>
          <p>Performance (ARI and AMI) of different clustering methods from ten times analyses of the in-house human PBMC real dataset</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">ARI</th>
              <th rowspan="1" colspan="1">AMI</th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">Mean (SD), [range]</th>
              <th rowspan="1" colspan="1">Mean (SD), [range]</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="3" rowspan="1">Single source clustering - RNA only</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>K</italic>-means</td>
              <td rowspan="1" colspan="1">0.547 (0.073), [0.429, 0.681]</td>
              <td rowspan="1" colspan="1">0.613 (0.062), [0.474, 0.707]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TSCAN</td>
              <td rowspan="1" colspan="1">0.476 (N/A), [N/A]</td>
              <td rowspan="1" colspan="1">0.574 (N/A), [N/A]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SC3</td>
              <td rowspan="1" colspan="1">0.561 (0.017), [0.540, 0.589]</td>
              <td rowspan="1" colspan="1">0.606 (0.022), [0.560, 0.644]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">DIMM-SC</td>
              <td rowspan="1" colspan="1">0.563 (0.101), [0.366, 0.682]</td>
              <td rowspan="1" colspan="1">0.598 (0.069), [0.488, 0.707]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Seurat</td>
              <td rowspan="1" colspan="1">0.675 (N/A), [N/A]</td>
              <td rowspan="1" colspan="1">0.732 (N/A), [N/A]</td>
            </tr>
            <tr>
              <td colspan="3" rowspan="1">Single source clustering - protein only (complete list)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>K</italic>-means</td>
              <td rowspan="1" colspan="1">0.930 (0.120), [0.702, 0.989]</td>
              <td rowspan="1" colspan="1">0.931 (0.072), [0.794, 0.968]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TSCAN</td>
              <td rowspan="1" colspan="1">0.929 (N/A), [N/A]</td>
              <td rowspan="1" colspan="1">0.881 (N/A), [N/A]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SC3</td>
              <td rowspan="1" colspan="1">0.921 (0.039), [0.816, 0.951]</td>
              <td rowspan="1" colspan="1">0.891 (0.048), [0.760, 0.930]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">DIMM-SC</td>
              <td rowspan="1" colspan="1">0.988 (0.005), [0.975, 0.993]</td>
              <td rowspan="1" colspan="1">0.971 (0.014), [0.935, 0.983]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Seurat</td>
              <td rowspan="1" colspan="1">0.996 (N/A), [N/A]</td>
              <td rowspan="1" colspan="1">0.976 (N/A), [N/A]</td>
            </tr>
            <tr>
              <td colspan="3" rowspan="1">Multi-source joint clustering</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>K</italic>-means</td>
              <td rowspan="1" colspan="1">0.718 (0.102), [0.562, 0.805]</td>
              <td rowspan="1" colspan="1">0.755 (0.057), [0.659, 0.803]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TSCAN</td>
              <td rowspan="1" colspan="1">0.563 (N/A), [N/A]</td>
              <td rowspan="1" colspan="1">0.619 (N/A), [N/A]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SC3</td>
              <td rowspan="1" colspan="1">0.798 (0.108), [0.620, 0.938]</td>
              <td rowspan="1" colspan="1">0.788 (0.068), [0.690, 0.881]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MV-NMF</td>
              <td rowspan="1" colspan="1">0.861 (0.115), [0.710, 0.989]</td>
              <td rowspan="1" colspan="1">0.871 (0.086), [0.780, 0.969]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PC-MSC</td>
              <td rowspan="1" colspan="1">0.703 (0.094), [0.573, 0.950]</td>
              <td rowspan="1" colspan="1">0.798 (0.048), [0.705, 0.909]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">BREM-SC</td>
              <td rowspan="1" colspan="1">0.966 (0.025), [0.917, 0.985]</td>
              <td rowspan="1" colspan="1">0.944 (0.039), [0.869, 0.970]</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="SEC3-6">
      <title>Robust performance with incomplete ADT data</title>
      <p>In practice, it is common that researchers may have limited biological information of a specific cell type (especially rare cell type). As a result, they may fail to include some protein markers that are specifically differentially expressed in that rare cell type when they design their CITE-Seq experiments. In this case, researchers are not able to identify all the cell types with surface protein data only, and joint clustering methods will be preferred if they can appropriately incorporate RNA data to compensate the ‘loss’ of surface markers. To mimic the situation where the pre-designed protein markers cannot capture the characteristics of all cell types, we removed three protein markers (CD8A, CD16, CD127) in this human PBMC dataset and re-analyzed the remaining data. The results of this realistic simulation are summarized in Table <xref rid="tbl3" ref-type="table">3</xref>. In general, the results of single source clustering analyses for all methods except for Seurat are much worse when some important protein markers are missing. BREM-SC, on the other hand, achieves the highest mean ARI and mean AMI compared with all other clustering methods (both single source and multi-source). In addition, the performance of BREM-SC is only slightly influenced with missing a few protein markers, which demonstrates the robustness of BREM-SC and its capability of properly handling the mRNA–protein association.</p>
      <table-wrap id="tbl3" orientation="portrait" position="float">
        <label>Table 3.</label>
        <caption>
          <p>Performance (ARI and AMI) of clustering analysis for the subset of in-house human PBMC real dataset with the removal of three protein markers (CD8A, CD16, CD127)</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">ARI</th>
              <th rowspan="1" colspan="1">AMI</th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">Mean (SD), [range]</th>
              <th rowspan="1" colspan="1">Mean (SD), [range]</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="3" rowspan="1">Single source clustering - protein only</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>K</italic>-means (ADT)</td>
              <td rowspan="1" colspan="1">0.783 (0.144), [0.671, 0.991]</td>
              <td rowspan="1" colspan="1">0.839 (0.091), [0.766, 0.972]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TSCAN (ADT)</td>
              <td rowspan="1" colspan="1">0.863 (N/A), [N/A]</td>
              <td rowspan="1" colspan="1">0.811 (N/A), [N/A]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SC3 (ADT)</td>
              <td rowspan="1" colspan="1">0.757 (0.106), [0.552, 0.840]</td>
              <td rowspan="1" colspan="1">0.698 (0.074), [0.524, 0.752]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">DIMM-SC (ADT)</td>
              <td rowspan="1" colspan="1">0.820 (0.114), [0.681, 0.988]</td>
              <td rowspan="1" colspan="1">0.842 (0.067), [0.774, 0.960]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Seurat (ADT)</td>
              <td rowspan="1" colspan="1">0.929 (N/A), [N/A]</td>
              <td rowspan="1" colspan="1">0.896 (N/A), [N/A]</td>
            </tr>
            <tr>
              <td colspan="3" rowspan="1">Multi-source joint clustering</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>K</italic>-means</td>
              <td rowspan="1" colspan="1">0.691 (0.131), [0.533, 0.800]</td>
              <td rowspan="1" colspan="1">0.728 (0.073), [0.634, 0.789]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TSCAN</td>
              <td rowspan="1" colspan="1">0.451 (N/A), [N/A]</td>
              <td rowspan="1" colspan="1">0.578 (N/A), [N/A]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SC3</td>
              <td rowspan="1" colspan="1">0.771 (0.103), [0.655, 0.948]</td>
              <td rowspan="1" colspan="1">0.781 (0.070), [0.675, 0.899]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MV-NMF</td>
              <td rowspan="1" colspan="1">0.517 (0.032), [0.485, 0.600]</td>
              <td rowspan="1" colspan="1">0.644 (0.024), [0.628, 0.707]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PC-MSC</td>
              <td rowspan="1" colspan="1">0.698 (0.092), [0.613, 0.946]</td>
              <td rowspan="1" colspan="1">0.786 (0.046), [0.724, 0.893]</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">BREM-SC</td>
              <td rowspan="1" colspan="1">0.925 (0.057), [0.816, 0.975]</td>
              <td rowspan="1" colspan="1">0.913 (0.052), [0.803, 0.962]</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>When analyzing data from different data sources, ensemble clustering may be considered to integrate the separate clusters and determine an overall partition of cells that agrees the most with the source-specific cluster. However, most of ensemble clustering methods assume that the separate clusters are known in advance and do not inherently model the uncertainty (<xref rid="B25" ref-type="bibr">25</xref>). At the other extreme, a joint analysis that ignores the heterogeneity of the data may not capture important features that are specific to each data source. A fully integrative clustering approach is necessary to effectively combine the discriminatory power from transcriptome and protein measurements. Our probabilistic model provides a unified framework to jointly analyze multi-source data and take into account between-source correlation.</p>
    <p>There are several noticeable limitations of this method. First, BREM-SC uses a computationally intensive MCMC algorithm, which is roughly linear with the number of cells and the number of genes used. In practice, it may result in a high computational cost when applying to large datasets (e.g. &gt;10 k cells). To increase speed, BREM-SC has been implemented efficiently through vectorization to accommodate data in relatively large scale. We benchmarked the computational speed as well as memory consumption of BREM-SC in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>. Specifically, we varied the number of cells, genes and MCMC iterations in the benchmark experiment to provide users a general guidance about computing time of BREM-SC. We also examined the convergence of MCMC in two real data analyses, and we found that the log-likelihood converges quite well within 500 interactions (shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S5</xref>). We further developed an alternative approach to reduce running time by removing the random effects and assume independency between two data sources (illustrated in Equation <xref ref-type="disp-formula" rid="M1">1</xref>). By assuming each of the two data follows separate multinomial distribution with Dirichlet prior, we derive the joint likelihood of two data and use E–M algorithm (<xref rid="B26" ref-type="bibr">26</xref>) to update parameters. We named this approach jointDIMM-SC, as it can be considered as an extension of DIMM-SC for joint analysis. This method is useful when there are in fact relatively low among-cell variabilities. We compared the performance of BREM-SC and jointDIMM-SC on the two real PBMC datasets. The estimated standard deviation of random effects for the public PBMC data is 0.7, and for the in-house data is 1.2. <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref> summarizes the ARI and AMI of each method performed on each dataset, by which we observed that the performance of jointDIMM-SC is always worse than BREM-SC, and such a difference is larger when the estimated variance of random effects is larger. <xref ref-type="supplementary-material" rid="sup1">Supplementary Figures S6 and S7</xref> show the clustering results of jointDIMM-SC on public and in-house PBMC datasets, respectively, on UMAP plots. Although jointDIMM-SC performs worse than BREM-SC, still it could beat most of the competing methods currently available. JointDIMM-SC has also been implemented in our method as an optional choice. In addition to these, potential speed-up methods could include using graphics processing unit.</p>
    <p>Another limitation is that BREM-SC model ignores the measurement errors and uncertainties buried in count matrices. Multiple factors such as drop-out event, mapping percentage and PCR efficiency are not considered in the current model. These limitations can be largely overcome by extending the method. We will explore these directions in the near future. Finally, although BREM-SC can allow some noise between the two data sources, still a key assumption that the two sources are consistent in some level in terms of cell type classification. Traditionally, biologists define cell type through the abundance of cell surface markers, so ADT data are preferred if available. They are in general consistent with corresponding transcriptomic data, which may provide additional information on defining sub-cell types. If the inconsistency is so large as to overwhelm the cluster-specific signals, then joint clustering methods such as BREM-SC could fail, and source specific grouping methods such as Bayesian consensus clustering (<xref rid="B27" ref-type="bibr">27</xref>) can be developed in future studies.</p>
    <p>In summary, we provide a novel statistical method, BREM-SC, for joint clustering scRNA-Seq and CITE-Seq data, which facilitates rigorous statistical inference of cell population heterogeneity. Our model-based joint clustering method can be readily extended to accommodate more than two data sources or multi-source data from other fields. In addition, our well-designed in-house CITE-seq dataset will be valuable to the bioinformatics field for further method development. We are confident that BREM-SC will be highly useful for the fast-growing community of large-scale single cell analysis.</p>
  </sec>
  <sec id="SEC5">
    <title>SOFTWARE AVAILABILITY</title>
    <p>An R package of BREM-SC with a detailed tutorial is available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/tarot0410/BREMSC">https://github.com/tarot0410/BREMSC</ext-link>).</p>
  </sec>
  <sec sec-type="data-availability" id="SEC6">
    <title>DATA AVAILABILITY</title>
    <p>The published human PBMC CITE-Seq dataset that supports the finding of this study can be downloaded from 10× Genomics website (<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/3.0.0/pbmc_10k_protein_v3">https://support.10xgenomics.com/single-cell-gene-expression/datasets/3.0.0/pbmc_10k_protein_v3</ext-link>). The in-house CITE-seq data is available in GEO (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/">https://www.ncbi.nlm.nih.gov/geo/</ext-link>, GSE148665).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>gkaa314_Supplemental_File</label>
      <media xlink:href="gkaa314_supplemental_file.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec id="SEC7">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkaa314#supplementary-data">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC8">
    <title>FUNDING</title>
    <p>National Institutes of Health [R01HL137709 to W.C., K.C., P01AI106684 to W.C., U01DK062420 to W.C., R.D., UL1TR001857 to W.C., X.W.]. Funding for open access charge: National Institutes of Health [U01DK062420].</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mimitou</surname><given-names>E.P.</given-names></name>, <name name-style="western"><surname>Cheng</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Montalbano</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Hao</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Stoeckius</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Legut</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Roush</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Herrera</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Papalexi</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Ouyang</surname><given-names>Z.</given-names></name></person-group><article-title>Multiplexed detection of proteins, transcriptomes, clonotypes and CRISPR perturbations in single cells</article-title>. <source>Nat. Methods</source>. <year>2019</year>; <volume>16</volume>:<fpage>409</fpage>.<pub-id pub-id-type="pmid">31011186</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Peterson</surname><given-names>V.M.</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>K.X.</given-names></name>, <name name-style="western"><surname>Kumar</surname><given-names>N.</given-names></name>, <name name-style="western"><surname>Wong</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>D.C.</given-names></name>, <name name-style="western"><surname>Moore</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>McClanahan</surname><given-names>T.K.</given-names></name>, <name name-style="western"><surname>Sadekova</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Klappenbach</surname><given-names>J.A.</given-names></name></person-group><article-title>Multiplexed quantification of proteins and transcripts in single cells</article-title>. <source>Nat. Biotechnol.</source><year>2017</year>; <volume>35</volume>:<fpage>936</fpage>.<pub-id pub-id-type="pmid">28854175</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stoeckius</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Hafemeister</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Stephenson</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>Houck-Loomis</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Chattopadhyay</surname><given-names>P.K.</given-names></name>, <name name-style="western"><surname>Swerdlow</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Satija</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Smibert</surname><given-names>P.</given-names></name></person-group><article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title>. <source>Nat Methods.</source><year>2017</year>; <volume>14</volume>:<fpage>865</fpage>.<pub-id pub-id-type="pmid">28759029</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zheng</surname><given-names>G.X.</given-names></name>, <name name-style="western"><surname>Terry</surname><given-names>J.M.</given-names></name>, <name name-style="western"><surname>Belgrader</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Ryvkin</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Bent</surname><given-names>Z.W.</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Ziraldo</surname><given-names>S.B.</given-names></name>, <name name-style="western"><surname>Wheeler</surname><given-names>T.D.</given-names></name>, <name name-style="western"><surname>McDermott</surname><given-names>G.P.</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>J.</given-names></name><etal>et al</etal>.</person-group><article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat. Commun.</source><year>2017</year>; <volume>8</volume>:<fpage>14049</fpage>.<pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Haider</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Pal</surname><given-names>R.</given-names></name></person-group><article-title>Integrated analysis of transcriptomic and proteomic data</article-title>. <source>Curr. Genomics</source>. <year>2013</year>; <volume>14</volume>:<fpage>91</fpage>–<lpage>110</lpage>.<pub-id pub-id-type="pmid">24082820</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Gharib</surname><given-names>T.G.</given-names></name>, <name name-style="western"><surname>Huang</surname><given-names>C.C.</given-names></name>, <name name-style="western"><surname>Taylor</surname><given-names>J.M.</given-names></name>, <name name-style="western"><surname>Misek</surname><given-names>D.E.</given-names></name>, <name name-style="western"><surname>Kardia</surname><given-names>S.L.</given-names></name>, <name name-style="western"><surname>Giordano</surname><given-names>T.J.</given-names></name>, <name name-style="western"><surname>Iannettoni</surname><given-names>M.D.</given-names></name>, <name name-style="western"><surname>Orringer</surname><given-names>M.B.</given-names></name>, <name name-style="western"><surname>Hanash</surname><given-names>S.M.</given-names></name><etal>et al</etal>.</person-group><article-title>Discordant protein and mRNA expression in lung adenocarcinomas</article-title>. <source>Mol. Cell. Proteomics</source>. <year>2002</year>; <volume>1</volume>:<fpage>304</fpage>–<lpage>313</lpage>.<pub-id pub-id-type="pmid">12096112</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Ramazzotti</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>De Sano</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Pierson</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Batzoglou</surname><given-names>S.</given-names></name></person-group><article-title>SIMLR: a tool for large-scale genomic analyses by multi-kernel learning</article-title>. <source>Proteomics</source>. <year>2018</year>; <volume>18</volume>:<fpage>1700232</fpage>.</mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Satija</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Farrell</surname><given-names>J.A.</given-names></name>, <name name-style="western"><surname>Gennert</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Schier</surname><given-names>A.F.</given-names></name>, <name name-style="western"><surname>Regev</surname><given-names>A.</given-names></name></person-group><article-title>Spatial reconstruction of single-cell gene expression data</article-title>. <source>Nat. Biotechnol.</source><year>2015</year>; <volume>33</volume>:<fpage>495</fpage>–<lpage>502</lpage>.<pub-id pub-id-type="pmid">25867923</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kiselev</surname><given-names>V.Y.</given-names></name>, <name name-style="western"><surname>Kirschner</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Schaub</surname><given-names>M.T.</given-names></name>, <name name-style="western"><surname>Andrews</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Yiu</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Chandra</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Natarajan</surname><given-names>K.N.</given-names></name>, <name name-style="western"><surname>Reik</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>Barahona</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Green</surname><given-names>A.R.</given-names></name><etal>et al</etal>.</person-group><article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat. Methods</source>. <year>2017</year>; <volume>14</volume>:<fpage>483</fpage>–<lpage>486</lpage>.<pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sun</surname><given-names>Z.</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Deng</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>X.F.</given-names></name>, <name name-style="western"><surname>Lafyatis</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Ding</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Hu</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>W.</given-names></name></person-group><article-title>DIMM-SC: a Dirichlet mixture model for clustering droplet-based single cell transcriptomic data</article-title>. <source>Bioinformatics</source>. <year>2018</year>; <volume>34</volume>:<fpage>139</fpage>–<lpage>146</lpage>.<pub-id pub-id-type="pmid">29036318</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sun</surname><given-names>Z.</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Xin</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Jiang</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Huang</surname><given-names>Q.</given-names></name>, <name name-style="western"><surname>Cillo</surname><given-names>A.R.</given-names></name>, <name name-style="western"><surname>Tabib</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Kolls</surname><given-names>J.K.</given-names></name>, <name name-style="western"><surname>Bruno</surname><given-names>T.C.</given-names></name>, <name name-style="western"><surname>Lafyatis</surname><given-names>R.</given-names></name></person-group><article-title>A Bayesian mixture model for clustering droplet-based single-cell transcriptomic data from population studies</article-title>. <source>Nat. Commun.</source><year>2019</year>; <volume>10</volume>:<fpage>1649</fpage>.<pub-id pub-id-type="pmid">30967541</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Freytag</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Tian</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Lönnstedt</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Ng</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Bahlo</surname><given-names>M.</given-names></name></person-group><article-title>Comparison of clustering tools in R for medium-sized 10x Genomics single-cell RNA-sequencing data [version 2; peer review: 3 approved]</article-title>. <source>F1000Research</source>. <year>2018</year>; <volume>7</volume>:<fpage>1297</fpage>.<pub-id pub-id-type="pmid">30228881</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Duò</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Robinson</surname><given-names>M.D.</given-names></name>, <name name-style="western"><surname>Soneson</surname><given-names>C.</given-names></name></person-group><article-title>A systematic performance evaluation of clustering methods for single-cell RNA-seq data [version 2; peer review: 2 approved]</article-title>. <source>F1000Research</source>. <year>2018</year>; <volume>7</volume>:<fpage>1141</fpage>.<pub-id pub-id-type="pmid">30271584</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ji</surname><given-names>Z.</given-names></name>, <name name-style="western"><surname>Ji</surname><given-names>H.</given-names></name></person-group><article-title>TSCAN: Pseudo-time reconstruction and evaluation in single-cell RNA-seq analysis</article-title>. <source>Nucleic Acids Res.</source><year>2016</year>; <volume>44</volume>:<fpage>e117</fpage>.<pub-id pub-id-type="pmid">27179027</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Gao</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Han</surname><given-names>J.</given-names></name></person-group><source>Proceedings of the 2013 SIAM International Conference on Data Mining</source>. <year>2013</year>; <publisher-name>SIAM</publisher-name><fpage>252</fpage>–<lpage>260</lpage>.</mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Kumar</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Rai</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Daume</surname><given-names>H.</given-names></name></person-group><source>Advances in Neural Information Processing Systems</source>. <year>2011</year>; <fpage>1413</fpage>–<lpage>1421</lpage>.</mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Butler</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Hoffman</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Smibert</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Papalexi</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Satija</surname><given-names>R.</given-names></name></person-group><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat. Biotechnol.</source><year>2018</year>; <volume>36</volume>:<fpage>411</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stuart</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Butler</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Hoffman</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Hafemeister</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Papalexi</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Mauck</surname><given-names>W.M.</given-names><suffix>III</suffix></name>, <name name-style="western"><surname>Hao</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Stoeckius</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Smibert</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Satija</surname><given-names>R.</given-names></name></person-group><article-title>Comprehensive integration of single-cell data</article-title>. <source>Cell</source>. <year>2019</year>; <volume>177</volume>:<fpage>1888</fpage>–<lpage>1902</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ronning</surname><given-names>G.</given-names></name></person-group><article-title>Maximum-likelihood estimation of dirichlet distributions</article-title>. <source>J. Statist. Comput. Simulation</source>. <year>1989</year>; <volume>32</volume>:<fpage>215</fpage>–<lpage>221</lpage>.</mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zappia</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Phipson</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Oshlack</surname><given-names>A.</given-names></name></person-group><article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>. <source>Genome Biol.</source><year>2017</year>; <volume>18</volume>:<fpage>174</fpage>.<pub-id pub-id-type="pmid">28899397</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rand</surname><given-names>W.M.</given-names></name></person-group><article-title>Objective criteria for the evaluation of clustering methods</article-title>. <source>J. Am. Statist. Assoc.</source><year>1971</year>; <volume>66</volume>:<fpage>846</fpage>–<lpage>850</lpage>.</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Vinh</surname><given-names>N.X.</given-names></name>, <name name-style="western"><surname>Epps</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Bailey</surname><given-names>J.</given-names></name></person-group><source>Proceedings of the 26th Annual International Conference on Machine Learning</source>. <year>2009</year>; <fpage>1073</fpage>–<lpage>1080</lpage>.</mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Romano</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Vinh</surname><given-names>N.X.</given-names></name>, <name name-style="western"><surname>Bailey</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Verspoor</surname><given-names>K.</given-names></name></person-group><article-title>Adjusting for chance clustering comparison measures</article-title>. <source>J. Mach. Learn. Res.</source><year>2016</year>; <volume>17</volume>:<fpage>4635</fpage>–<lpage>4666</lpage>.</mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>McInnes</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Healy</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Melville</surname><given-names>J.</given-names></name></person-group><article-title>Umap: uniform manifold approximation and projection for dimension reduction</article-title>. <year>2018</year>; </mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Shan</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Banerjee</surname><given-names>A</given-names></name></person-group><article-title>Bayesian cluster ensembles</article-title>. <source>Stat. Anal. Data Mining</source>. <year>2011</year>; <volume>4</volume>:<fpage>54</fpage>–<lpage>70</lpage>.</mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dempster</surname><given-names>A.P.</given-names></name>, <name name-style="western"><surname>Laird</surname><given-names>N.M.</given-names></name>, <name name-style="western"><surname>Rubin</surname><given-names>D.B.</given-names></name></person-group><article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>. <source>J. R. Stat. Soc.: Series B (Methodological)</source>. <year>1977</year>; <volume>39</volume>:<fpage>1</fpage>–<lpage>38</lpage>.</mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lock</surname><given-names>E.F.</given-names></name>, <name name-style="western"><surname>Dunson</surname><given-names>D.B.</given-names></name></person-group><article-title>Bayesian consensus clustering</article-title>. <source>Bioinformatics</source>. <year>2013</year>; <volume>29</volume>:<fpage>2610</fpage>–<lpage>2616</lpage>.<pub-id pub-id-type="pmid">23990412</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
