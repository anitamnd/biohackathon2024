<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10320078</article-id>
    <article-id pub-id-type="pmid">37070190</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkad284</article-id>
    <article-id pub-id-type="publisher-id">gkad284</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00010</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Web Server Issue</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Haplogrep 3 - an interactive haplogroup classification and analysis platform</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schönherr</surname>
          <given-names>Sebastian</given-names>
        </name>
        <xref rid="FN1" ref-type="author-notes"/>
        <aff><institution>Institute of Genetic Epidemiology, Medical University of Innsbruck</institution>, <addr-line>Innsbruck</addr-line> 6020, <country country="AT">Austria</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2871-8669</contrib-id>
        <name>
          <surname>Weissensteiner</surname>
          <given-names>Hansi</given-names>
        </name>
        <xref rid="FN1" ref-type="author-notes"/>
        <aff><institution>Institute of Genetic Epidemiology, Medical University of Innsbruck</institution>, <addr-line>Innsbruck</addr-line> 6020, <country country="AT">Austria</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2229-1120</contrib-id>
        <name>
          <surname>Kronenberg</surname>
          <given-names>Florian</given-names>
        </name>
        <aff><institution>Institute of Genetic Epidemiology, Medical University of Innsbruck</institution>, <addr-line>Innsbruck</addr-line> 6020, <country country="AT">Austria</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2139-7329</contrib-id>
        <name>
          <surname>Forer</surname>
          <given-names>Lukas</given-names>
        </name>
        <!--lukas.forer@i-med.ac.at-->
        <xref rid="COR1" ref-type="corresp"/>
        <aff><institution>Institute of Genetic Epidemiology, Medical University of Innsbruck</institution>, <addr-line>Innsbruck</addr-line> 6020, <country country="AT">Austria</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: 
<phone>+43 512 9003</phone> 70562; Fax: +43 512 9003 73510; Email: <email>lukas.forer@i-med.ac.at</email></corresp>
      <fn id="FN1">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <day>05</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-04-18">
      <day>18</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <volume>51</volume>
    <issue>W1</issue>
    <fpage>W263</fpage>
    <lpage>W268</lpage>
    <history>
      <date date-type="accepted">
        <day>05</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>01</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="received">
        <day>28</day>
        <month>2</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gkad284.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Over the last decade, Haplogrep has become a standard tool for haplogroup classification in the field of human mitochondrial DNA and is widely used by medical, forensic, and evolutionary researchers. Haplogrep scales well for thousands of samples, supports many file formats and provides an intuitive graphical web interface. Nevertheless, the currently available version has limitations when applying it to large biobank-scale data. In this paper, we present a major upgrade to the software by adding (a) haplogroup summary statistics and variant annotations from various publicly available genome databases, (b) an interface to connect new phylogenetic trees, (c) a new state-of-the-art web framework managing large scale data, (d) algorithmic adaptions to improve FASTA classification using BWA-specific alignment rules and (e) a pre-classification quality control step for VCF samples. These improvements will give researchers the opportunity to classify thousands of samples as usual but providing additional ways to investigate the dataset directly in the browser. The web service and its documentation can be accessed freely without any registration at <ext-link xlink:href="https://haplogrep.i-med.ac.at" ext-link-type="uri">https://haplogrep.i-med.ac.at</ext-link>.</p>
    </abstract>
    <abstract abstract-type="graphical">
      <title>Graphical Abstract</title>
      <p>
        <fig position="float" id="ga1">
          <label>Graphical Abstract</label>
          <caption>
            <p>Haplogrep 3 allows the upload of mitochondrial profiles in different formats for haplogroup classification and also includes steps for input validation or quality control. The user interface reports summary statistics and provides annotations for each sample.</p>
          </caption>
          <graphic xlink:href="gkad284figgra1" position="float"/>
        </fig>
      </p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Medical University of Innsbruck</institution>
            <institution-id institution-id-type="DOI">10.13039/501100009980</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Available phylogenetic presentations of sequenced samples (so called phylogenetic trees) allow to classify uniparentally transmitted haplotypes into haplogroups (<xref rid="B1" ref-type="bibr">1</xref>). Each phylogenetic haplogroup (or branch) within the tree is identified by a unique set of variants differing from a reference genome. The currently most updated phylogenetic tree for human mitochondrial genomes includes 6401 unique haplogroups (<xref rid="B2" ref-type="bibr">2</xref>), which is based on the well-known phylogenetic tree Phylotree (<xref rid="B3" ref-type="bibr">3</xref>). Previously, we developed Haplogrep to assign mitochondrial input profiles the best matching haplogroup in an automated way. Haplogrep works by traversing a phylogenetic tree, calculating the distance to each haplogroup using the Kulczynski metric and returning a sorted list of haplogroup hits for each sample (<xref rid="B4" ref-type="bibr">4</xref>). In 2016, we improved the software by integrating a rule-based system assigning each sample a quality status, supporting new file formats and providing a command-line version, which has also been integrated in several workflow pipelines and online services (<xref rid="B5" ref-type="bibr">5</xref>). The set of included features, frequent updates of supported phylogenetic trees and our community support made Haplogrep to one of the most accurate and widest used tools for haplogroup classification in mtDNA studies (<xref rid="B6" ref-type="bibr">6</xref>).</p>
    <p>Nevertheless, over the last years we also identified shortcomings with the currently available version: first, genomic databases like gnomAD (<xref rid="B7" ref-type="bibr">7</xref>) provide a rich set of annotations such as variant or population frequencies for evaluating sites of interest. Many of these necessary downstream-analysis steps are currently not directly supported within the application, making it unnecessarily complicated for researchers to analyse samples initially classified with Haplogrep. Second, modern technologies allow sequencing thousands of samples with decreasing costs, therefore making biobank-scale datasets available to researchers. While Haplogrep's classification algorithm works well for many samples, the web application was not developed for screening thousands of samples directly in the browser and does not provide any summary statistics on the uploaded dataset. Third, while Haplogrep already supports numerous phylogenetic trees, the integration of new trees is closely bundled to the software itself, making it complex to add new trees for external users. Forth, input data is nowadays coming from heterogeneous resources (e.g. genotyping arrays (<xref rid="B8" ref-type="bibr">8</xref>), whole-genome sequenced samples (<xref rid="B9" ref-type="bibr">9</xref>), Sanger-sequenced data (<xref rid="B10" ref-type="bibr">10</xref>), long-read data (<xref rid="B11" ref-type="bibr">11</xref>)), which requires a systematic quality control before haplogroup classification to avoid unexpected pitfalls.</p>
    <p>To address these shortcomings, we developed Haplogrep 3. It includes all key features from previous versions, eliminates the mentioned shortcomings and is available as a hosted web service but can also be run graphically or on the command-line in a private environment. This version will greatly improve how researchers analyse datasets, allowing them identifying input errors or spurious results as early as possible.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Webserver</title>
      <p>Haplogrep 3 is a web application developed in Java using the Javalin web framework in combination with a template engine for Java. For visualization, we use the D3.js and Chart.js JavaScript libraries. The main algorithm of Haplogrep has been capsulated into a library (haplogrep-core), integrated into the application as a dependency and has already been described in detail elsewhere (<xref rid="B4" ref-type="bibr">4</xref>). Haplogrep 3 provides several sub-commands (server, classify, distance, trees, install-trees) to end users, which allows to run it locally or integrate it in automated pipelines. The <italic toggle="yes">server</italic> command starts a new web-server instance, <italic toggle="yes">classify</italic> allows to run haplogroup classification on the command line, <italic toggle="yes">distance</italic> calculates the distance between two input haplogroups, <italic toggle="yes">trees</italic> returns the currently installed trees and <italic toggle="yes">install-trees</italic> allows to install new phylogenetic trees. Unlike to previous versions, the same code base is now used for the web application and the command-line tool. Haplogrep 3 loads all required information from a configuration file in YAML syntax. This file includes basic features like upload limit, port, provided test datasets but also includes the currently installed phylogenetic trees and the location of the phylogenetic trees' repository.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Integration of phylogenetic trees</title>
      <p>Starting with Haplogrep 3, phylogenetic trees are now hosted in a separate repository (<ext-link xlink:href="https://genepi.github.io/haplogrep-trees" ext-link-type="uri">https://genepi.github.io/haplogrep-trees</ext-link>). Each tree includes a set of required files for the integration into Haplogrep. It consists of (a) the tree in XML syntax, (b) variants weights for haplogroup classification, (c) hotspot locations not considered for phylogenetic interpretation, (d) annotation files from external databases, (e) reference sequence (e.g. rCRS (<xref rid="B12" ref-type="bibr">12</xref>) or RSRS (<xref rid="B13" ref-type="bibr">13</xref>)) and required BWA files and (f) a set of FASTA alignment rules. This architectural change allowed us to decouple Haplogrep from a specific phylogenetic tree and will simplify the integration of new trees in future releases. All installed trees are loaded at startup and user can select one of the trees before classification starts.</p>
    </sec>
    <sec id="SEC2-3">
      <title>FASTA improvement and alignment rules</title>
      <p>To support FASTA as an input format, we integrated the BWA alignment software (<xref rid="B14" ref-type="bibr">14</xref>) as a JNI library. Unlike to sequence alignment with BWA where insertions and deletions (indels) are left aligned, the currently available mitochondrial phylogenetic trees expect right aligned indels. Therefore, indels are not correctly placed by BWA and result in a lower overall haplogroup quality or even misclassification. To adjust for that, we integrated a set of currently 123 nomenclature rules that are applied by default prior to haplogroup classification. The rules have been generated by comparing expected and remaining variants from haplogroup-defining samples from the updated Phylotree (<xref rid="B2" ref-type="bibr">2</xref>) in FASTA format. By comparing these variants for each input sample, we were able to create a list of rules which fix issues especially for indel alignments. The list of rules is included as a file in each phylogenetic tree, making it adaptable in future releases. Besides that, Haplogrep 3 has been improved to work with partial FASTA sequences (e.g. control region), a previous shortcoming of the software.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Haplogroup clustering and search</title>
      <p>Haplogrep 3 introduces a new clustering of haplogroups using the top-level haplogroups (or clusters) as defined by Phylotree and gnomAD. For each input sample or defining haplogroup of an available tree, we calculate the distance to each of the 33 top-level haplogroups and use the cluster with the minimal distance as a result. Using this new tree structure, users can search for haplogroups and variants directly within the application.</p>
    </sec>
    <sec id="SEC2-5">
      <title>Variant annotation</title>
      <p>For variant annotation, we used external data from gnomAD (<xref rid="B7" ref-type="bibr">7</xref>), MitImpact (<xref rid="B15" ref-type="bibr">15</xref>) and the Helix Mitochondrial database (<xref rid="B16" ref-type="bibr">16</xref>), which have been integrated in the application. The files have been downloaded and indexed for accessing variant details in real-time. Each provided phylogenetic tree package also consists of a version number, which allows us to integrate possible future database updates in a reproducible way.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <sec id="SEC3-1">
      <title>Analysis workflow</title>
      <p>Like previous versions, users can upload their sample data in a text format (hsd), as FASTA or in the variant calling format (VCF). The server assigns each sample the top haplogroup hits (currently 20) by traversing through the selected phylogenetic tree. The input format of the samples is autodetected by the software but can also be set manually. This is especially useful for VCF files, where users can specify if input files originate from genotyping arrays or how heteroplasmic positions from next-generation sequencing data should be handled by the system. If the samples come from genotyping arrays, Haplogrep 3 automatically adapts the search range to the available positions included in the VCF file. Before classification, users can select one of the available Haplogrep metrics on how distances to haplogroups are calculated, the phylogenetic tree and if additional output formats should be generated. Haplogrep then executes a quality control (QC) step and calculates summary statistics for all samples. After the actual haplogroup classification, an annotation step is executed and users are forwarded to the results including a summary dashboard for visual analytics (e.g. data grouped by top-level haplogroups including population information, QC statistics) and the sample details (see Figure <xref rid="F1" ref-type="fig">1</xref>).</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>Analysis workflow of Haplogrep 3. Haplogrep allows the upload of hsd, FASTA or VCF files. Initially, the samples are checked and validated. Before haplogroup classification, a quality control step is executed to provide summary statistics on the uploaded file. Haplogroups are then calculated and enriched with numerous annotations on a haplogroup and variant level. All results are displayed in the web-browser for further investigation.</p>
        </caption>
        <graphic xlink:href="gkad284fig1" position="float"/>
      </fig>
    </sec>
    <sec id="SEC3-2">
      <title>Summary dashboard</title>
      <p>Haplogrep 3 includes a graphical summary dashboard including statistics regarding the sample classification. It consists of a graphical overview of all individual haplogroups and their distribution into the 33 top-level haplogroups (see Materials and Methods). The dashboard also consists of a table of all uploaded samples showing the population composition for each top-level haplogroup with ancestry information provided by gnomAD. Besides that, it also includes all available export formats including the possibilities to download the sample QC report as a tab-delimited file. Unlike to previous versions, export formats are generated on-the-fly during classification and can be downloaded without any delay.</p>
    </sec>
    <sec id="SEC3-3">
      <title>Sample overview</title>
      <p>Besides the summary dashboard, the individual samples page includes details for each sample (e.g. number of expected variants, found variants, additional variants), the top 20 hits for each input sample and the analysed range. To investigate samples, Haplogrep 3 allows to analyse each variant associated with a haplogroup by clicking on it. This will allow users to access variant or population frequencies and evaluate variants in more detail (see ‘Interactive Variant Discoveries’).</p>
    </sec>
    <sec id="SEC3-4">
      <title>Phylogenetic trees</title>
      <p>Haplogrep 3 supports the integration of external phylogenetic trees. We currently provide a set of five mtDNA trees within Haplogrep 3, all managed in separate Git repositories for reproducibility (<ext-link xlink:href="https://genepi.github.io/haplogrep-trees" ext-link-type="uri">https://genepi.github.io/haplogrep-trees</ext-link>). Each tree consists of a configuration file and a set of annotation files (see Material and Methods). This architectural change allowed us to decouple Haplogrep from the phylogenetic trees and simplifies the integration of new trees for external users. While all trees are currently mtDNA specific, Haplogrep 3 is not limited to mtDNA allowing other phylogenetic representations to benefit from its features. Beginning with this version, we also provide a new feature to make phylogenies searchable for end users. Users can use Haplogrep 3 to navigate through all top-level haplogroups and access textual and graphical representations for each haplogroup including expected variants.</p>
    </sec>
    <sec id="SEC3-5">
      <title>VCF pre-classification quality control</title>
      <p>VCF files can originate from different projects (e.g. microarray projects, whole-exome/whole-genome or long-read sequencing projects) and are often missing an external quality-control step before classification. This can result in a lower haplogroup quality or even in a misclassification. The latest version of Haplogrep now integrates an initial validation step for VCF samples and includes (a) an analysis of the uploaded sample file (e.g. number of samples, number of variants, overlap with the phylogenetic tree, monomorphic variants), (b) a check on possible strand-flips and (c) statistics on the variant or sample call rate.</p>
    </sec>
    <sec id="SEC3-6">
      <title>Interactive variant discoveries</title>
      <p>Each phylogenetic tree includes a set of annotation files. Haplogrep 3 displays all available information directly in the web-application, when a specific variant is selected (see Material and Methods). Access to variant frequencies allow users to evaluate each variant in detail and assess its clinical relevance using functional predictors from MitImpact (<xref rid="B15" ref-type="bibr">15</xref>). Haplogrep 3 also provides direct links to external resources for further investigation and allows to export a set of predefined annotations.</p>
    </sec>
    <sec id="SEC3-7">
      <title>Analysing 1000 genomes data with Haplogrep 3</title>
      <p>The new web application allows to investigate samples in more depth directly in the browser. Here, we are analysing the 1000 Genomes data, which have been made available by the 1000 Genomes Project Phase 3 (<xref rid="B17" ref-type="bibr">17</xref>) and includes a set of 2534 samples. All samples have been classified in 88 seconds on the publicly available web service using the default parameters (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The newly created dashboard shows an overview of all samples and indicated that all samples are passing QC. Samples are clustered by top-level haplogroup or by individual haplogroup. All 33 clusters as defined by Phylotree are represented. 11% of the uploaded samples include a warning, mainly because of a slightly decreased haplogroup quality (see Figure <xref rid="F2" ref-type="fig">2</xref>).</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>Summary dashboard of haplogrep 3. The dashboard shows the overview of 2534 samples from the 1000 Genomes Phase 3 project. 89% of the samples (2282) include no warnings, 11% show a warning which needs further investigation in the Sample tab. The clusters table includes all found haplogroups summarized by top-level haplogroup and annotated with the population frequencies from gnomAD. The report can be downloaded or shared via a link.</p>
        </caption>
        <graphic xlink:href="gkad284fig2" position="float"/>
      </fig>
      <p>The details tab of Haplogrep 3 shows how a sample report is structured. It includes the haplogroup top hit, expected mutations of the haplogroup and remaining mutations of each sample, the top 20 additional haplogroup hits and the analysed sample range. It also includes frequencies for each variant (provided by publicly available databases) for further investigation (see Figure <xref rid="F3" ref-type="fig">3</xref>).</p>
      <fig position="float" id="F3">
        <label>Figure 3.</label>
        <caption>
          <p>(<xref rid="B1" ref-type="bibr">1</xref>) All samples are provided as a table including the most important information like detected haplogroup, quality score or position coverage. (<xref rid="B2" ref-type="bibr">2</xref>) By selecting a sample, additional information is displayed showing all excepted and remaining variants for the top hit haplogroup. (<xref rid="B3" ref-type="bibr">3</xref>) Each variant can be selected to display numerous frequencies and predictions.</p>
        </caption>
        <graphic xlink:href="gkad284fig3" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>Published in 2010 and 2016, Haplogrep was the first fully automated haplogroup classification tool for mtDNA. The number of citations and downloads shows that Haplogrep is a critical tool for numerous research areas and supports studies at any size. With the upgrade presented in this paper, we go a step further and provide users new tools for evaluating variants and new possibilities to look at their data. We also improved the FASTA alignment for partial samples, added a new QC step for VCF samples and decoupled the phylogenetic trees from the application itself. Since our original publication, many tools have been published showing a similar set of features or provided functionally which were initially not available in Haplogrep. Nevertheless, none of the currently available tools include the same set of features compared to Haplogrep. HaploGrouper (<xref rid="B18" ref-type="bibr">18</xref>) works for any kind of phylogenetic trees but supports only VCF and is not available as a graphical web service. MitoSuite (<xref rid="B19" ref-type="bibr">19</xref>) requires a local installation and works only for next-generation sequencing data in BAM format. HaploTracker (<xref rid="B20" ref-type="bibr">20</xref>) works well for partial FASTA sequences, a feature which has also been integrated in Haplogrep 3. HaploCart1.0 (<xref rid="B21" ref-type="bibr">21</xref>) uses a novel and promising pangenome reference structure eliminating problems when the sample is identical to the rCRS but is currently too computational expensive to run on a large set of samples. MitoSuite (<xref rid="B22" ref-type="bibr">22</xref>) uses Haplogrep for mtDNA classification but also includes several tools to further investigate variants. Many of these annotations are now also available within Haplogrep 3.</p>
    <p>While the integration of new trees is now simplified, the creation of phylogenetic trees can pose numerous challenges to end users. Since Haplogrep is a constantly developing service since &gt;10 years, we are planning to provide automated ways to create the required files, which can then be connected to Haplogrep. Overall, we think that the new set of features will greatly improve and simplify the work with Haplogrep and provide users for the first-time functionality for downstream analysis directly within the application.</p>
  </sec>
  <sec sec-type="data-availability" id="SEC5">
    <title>DATA AVAILABILITY</title>
    <p>The Haplogrep 3 webserver is available at: <ext-link xlink:href="https://haplogrep.i-med.ac.at" ext-link-type="uri">https://haplogrep.i-med.ac.at</ext-link>. The Haplogrep 3 source code is available at: <ext-link xlink:href="https://github.com/genepi/haplogrep3" ext-link-type="uri">https://github.com/genepi/haplogrep3</ext-link> and <ext-link xlink:href="https://doi.org/10.5281/zenodo.7801633" ext-link-type="uri">https://doi.org/10.5281/zenodo.7801633</ext-link>. The Haplogrep 3 documentation including examples is available at: <ext-link xlink:href="https://haplogrep.readthedocs.io" ext-link-type="uri">https://haplogrep.readthedocs.io</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>gkad284_Supplemental_File</label>
      <media xlink:href="gkad284_supplemental_file.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors would like to thank Alessandro Achilli and Nicola Rambaldi Migliore (both University of Pavia) for intensive testing of Haplogrep 3. We also want to thank all Haplogrep users and GitHub contributors for their feedback and input. We also appreciate the continuous support of the Medical University of Innsbruck for providing the IT-infrastructure to run the Haplogrep service.</p>
  </ack>
  <sec id="SEC6">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkad284#supplementary-data" ext-link-type="uri">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC7">
    <title>FUNDING</title>
    <p>Medical University of Innsbruck.</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Torroni</surname><given-names>A.</given-names></string-name>, <string-name><surname>Achilli</surname><given-names>A.</given-names></string-name>, <string-name><surname>Olivieri</surname><given-names>A.</given-names></string-name>, <string-name><surname>Semino</surname><given-names>O.</given-names></string-name></person-group><person-group person-group-type="editor"><string-name><surname>Gasparre</surname><given-names>G.</given-names></string-name>, <string-name><surname>Porcelli</surname><given-names>A.M.</given-names></string-name></person-group><article-title>Chapter 5 – haplogroups and the history of human evolution through mtDNA</article-title>. <source>The Human Mitochondrial Genome</source>. <year>2020</year>; <publisher-name>Academic Press</publisher-name><fpage>111</fpage>–<lpage>129</lpage>.</mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dur</surname><given-names>A.</given-names></string-name>, <string-name><surname>Huber</surname><given-names>N.</given-names></string-name>, <string-name><surname>Parson</surname><given-names>W.</given-names></string-name></person-group><article-title>Fine-tuning phylogenetic alignment and haplogrouping of mtDNA sequences</article-title>. <source>Int. J. Mol. Sci.</source><year>2021</year>; <volume>22</volume>:<fpage>5747</fpage>.<pub-id pub-id-type="pmid">34072215</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Oven</surname><given-names>M.</given-names></string-name>, <string-name><surname>Kayser</surname><given-names>M.</given-names></string-name></person-group><article-title>Updated comprehensive phylogenetic tree of global human mitochondrial DNA variation</article-title>. <source>Hum. Mutat.</source><year>2009</year>; <volume>30</volume>:<fpage>E386</fpage>–<lpage>E394</lpage>.<pub-id pub-id-type="pmid">18853457</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kloss-Brandstatter</surname><given-names>A.</given-names></string-name>, <string-name><surname>Pacher</surname><given-names>D.</given-names></string-name>, <string-name><surname>Schonherr</surname><given-names>S.</given-names></string-name>, <string-name><surname>Weissensteiner</surname><given-names>H.</given-names></string-name>, <string-name><surname>Binna</surname><given-names>R.</given-names></string-name>, <string-name><surname>Specht</surname><given-names>G.</given-names></string-name>, <string-name><surname>Kronenberg</surname><given-names>F.</given-names></string-name></person-group><article-title>HaploGrep: a fast and reliable algorithm for automatic classification of mitochondrial DNA haplogroups</article-title>. <source>Hum. Mutat.</source><year>2011</year>; <volume>32</volume>:<fpage>25</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">20960467</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weissensteiner</surname><given-names>H.</given-names></string-name>, <string-name><surname>Pacher</surname><given-names>D.</given-names></string-name>, <string-name><surname>Kloss-Brandstatter</surname><given-names>A.</given-names></string-name>, <string-name><surname>Forer</surname><given-names>L.</given-names></string-name>, <string-name><surname>Specht</surname><given-names>G.</given-names></string-name>, <string-name><surname>Bandelt</surname><given-names>H.J.</given-names></string-name>, <string-name><surname>Kronenberg</surname><given-names>F.</given-names></string-name>, <string-name><surname>Salas</surname><given-names>A.</given-names></string-name>, <string-name><surname>Schonherr</surname><given-names>S.</given-names></string-name></person-group><article-title>HaploGrep 2: mitochondrial haplogroup classification in the era of high-throughput sequencing</article-title>. <source>Nucleic Acids Res.</source><year>2016</year>; <volume>44</volume>:<fpage>W58</fpage>–<lpage>W63</lpage>.<pub-id pub-id-type="pmid">27084951</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Garcia-Olivares</surname><given-names>V.</given-names></string-name>, <string-name><surname>Munoz-Barrera</surname><given-names>A.</given-names></string-name>, <string-name><surname>Lorenzo-Salazar</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>Zaragoza-Trello</surname><given-names>C.</given-names></string-name>, <string-name><surname>Rubio-Rodriguez</surname><given-names>L.A.</given-names></string-name>, <string-name><surname>Diaz-de Usera</surname><given-names>A.</given-names></string-name>, <string-name><surname>Jaspez</surname><given-names>D.</given-names></string-name>, <string-name><surname>Inigo-Campos</surname><given-names>A.</given-names></string-name>, <string-name><surname>Gonzalez-Montelongo</surname><given-names>R.</given-names></string-name>, <string-name><surname>Flores</surname><given-names>C.</given-names></string-name></person-group><article-title>A benchmarking of human mitochondrial DNA haplogroup classifiers from whole-genome and whole-exome sequence data</article-title>. <source>Sci. Rep.</source><year>2021</year>; <volume>11</volume>:<fpage>20510</fpage>.<pub-id pub-id-type="pmid">34654896</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Laricchia</surname><given-names>K.M.</given-names></string-name>, <string-name><surname>Lake</surname><given-names>N.J.</given-names></string-name>, <string-name><surname>Watts</surname><given-names>N.A.</given-names></string-name>, <string-name><surname>Shand</surname><given-names>M.</given-names></string-name>, <string-name><surname>Haessly</surname><given-names>A.</given-names></string-name>, <string-name><surname>Gauthier</surname><given-names>L.</given-names></string-name>, <string-name><surname>Benjamin</surname><given-names>D.</given-names></string-name>, <string-name><surname>Banks</surname><given-names>E.</given-names></string-name>, <string-name><surname>Soto</surname><given-names>J.</given-names></string-name>, <string-name><surname>Garimella</surname><given-names>K.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Mitochondrial DNA variation across 56,434 individuals in gnomAD</article-title>. <source>Genome Res.</source><year>2022</year>; <volume>32</volume>:<fpage>569</fpage>–<lpage>582</lpage>.<pub-id pub-id-type="pmid">35074858</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yonova-Doing</surname><given-names>E.</given-names></string-name>, <string-name><surname>Calabrese</surname><given-names>C.</given-names></string-name>, <string-name><surname>Gomez-Duran</surname><given-names>A.</given-names></string-name>, <string-name><surname>Schon</surname><given-names>K.</given-names></string-name>, <string-name><surname>Wei</surname><given-names>W.</given-names></string-name>, <string-name><surname>Karthikeyan</surname><given-names>S.</given-names></string-name>, <string-name><surname>Chinnery</surname><given-names>P.F.</given-names></string-name>, <string-name><surname>Howson</surname><given-names>J.M.M.</given-names></string-name></person-group><article-title>An atlas of mitochondrial DNA genotype-phenotype associations in the UK Biobank</article-title>. <source>Nat. Genet.</source><year>2021</year>; <volume>53</volume>:<fpage>982</fpage>–<lpage>993</lpage>.<pub-id pub-id-type="pmid">34002094</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Byrska-Bishop</surname><given-names>M.</given-names></string-name>, <string-name><surname>Evani</surname><given-names>U.S.</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>X.</given-names></string-name>, <string-name><surname>Basile</surname><given-names>A.O.</given-names></string-name>, <string-name><surname>Abel</surname><given-names>H.J.</given-names></string-name>, <string-name><surname>Regier</surname><given-names>A.A.</given-names></string-name>, <string-name><surname>Corvelo</surname><given-names>A.</given-names></string-name>, <string-name><surname>Clarke</surname><given-names>W.E.</given-names></string-name>, <string-name><surname>Musunuri</surname><given-names>R.</given-names></string-name>, <string-name><surname>Nagulapalli</surname><given-names>K.</given-names></string-name><etal>et al</etal>.</person-group><article-title>High-coverage whole-genome sequencing of the expanded 1000 Genomes Project cohort including 602 trios</article-title>. <source>Cell</source>. <year>2022</year>; <volume>185</volume>:<fpage>3426</fpage>–<lpage>3440</lpage>.<pub-id pub-id-type="pmid">36055201</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kloss-Brandstatter</surname><given-names>A.</given-names></string-name>, <string-name><surname>Summerer</surname><given-names>M.</given-names></string-name>, <string-name><surname>Horst</surname><given-names>D.</given-names></string-name>, <string-name><surname>Horst</surname><given-names>B.</given-names></string-name>, <string-name><surname>Streiter</surname><given-names>G.</given-names></string-name>, <string-name><surname>Raschenberger</surname><given-names>J.</given-names></string-name>, <string-name><surname>Kronenberg</surname><given-names>F.</given-names></string-name>, <string-name><surname>Sanguansermsri</surname><given-names>T.</given-names></string-name>, <string-name><surname>Horst</surname><given-names>J.</given-names></string-name>, <string-name><surname>Weissensteiner</surname><given-names>H.</given-names></string-name></person-group><article-title>An in-depth analysis of the mitochondrial phylogenetic landscape of Cambodia</article-title>. <source>Sci. Rep.</source><year>2021</year>; <volume>11</volume>:<fpage>10816</fpage>.<pub-id pub-id-type="pmid">34031453</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luth</surname><given-names>T.</given-names></string-name>, <string-name><surname>Schaake</surname><given-names>S.</given-names></string-name>, <string-name><surname>Grunewald</surname><given-names>A.</given-names></string-name>, <string-name><surname>May</surname><given-names>P.</given-names></string-name>, <string-name><surname>Trinh</surname><given-names>J.</given-names></string-name>, <string-name><surname>Weissensteiner</surname><given-names>H.</given-names></string-name></person-group><article-title>Benchmarking low-frequency variant calling with long-read data on mitochondrial DNA</article-title>. <source>Front Genet</source>. <year>2022</year>; <volume>13</volume>:<fpage>887644</fpage>.<pub-id pub-id-type="pmid">35664331</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andrews</surname><given-names>R.M.</given-names></string-name>, <string-name><surname>Kubacka</surname><given-names>I.</given-names></string-name>, <string-name><surname>Chinnery</surname><given-names>P.F.</given-names></string-name>, <string-name><surname>Lightowlers</surname><given-names>R.N.</given-names></string-name>, <string-name><surname>Turnbull</surname><given-names>D.M.</given-names></string-name>, <string-name><surname>Howell</surname><given-names>N.</given-names></string-name></person-group><article-title>Reanalysis and revision of the Cambridge reference sequence for human mitochondrial DNA</article-title>. <source>Nat. Genet.</source><year>1999</year>; <volume>23</volume>:<fpage>147</fpage>.<pub-id pub-id-type="pmid">10508508</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Behar</surname><given-names>D.M.</given-names></string-name>, <string-name><surname>van Oven</surname><given-names>M.</given-names></string-name>, <string-name><surname>Rosset</surname><given-names>S.</given-names></string-name>, <string-name><surname>Metspalu</surname><given-names>M.</given-names></string-name>, <string-name><surname>Loogvali</surname><given-names>E.L.</given-names></string-name>, <string-name><surname>Silva</surname><given-names>N.M.</given-names></string-name>, <string-name><surname>Kivisild</surname><given-names>T.</given-names></string-name>, <string-name><surname>Torroni</surname><given-names>A.</given-names></string-name>, <string-name><surname>Villems</surname><given-names>R.</given-names></string-name></person-group><article-title>A “Copernican” reassessment of the human mitochondrial DNA tree from its root</article-title>. <source>Am. J. Hum. Genet.</source><year>2012</year>; <volume>90</volume>:<fpage>675</fpage>–<lpage>684</lpage>.<pub-id pub-id-type="pmid">22482806</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group><article-title>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</article-title>. <year>2013</year>; <comment>arXiv doi:</comment><comment>26 May 2013, preprint: not peer reviewed</comment><uri xlink:href="https://arxiv.org/abs/1303.3997">https://arxiv.org/abs/1303.3997</uri>.</mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Castellana</surname><given-names>S.</given-names></string-name>, <string-name><surname>Ronai</surname><given-names>J.</given-names></string-name>, <string-name><surname>Mazza</surname><given-names>T.</given-names></string-name></person-group><article-title>MitImpact: an exhaustive collection of pre-computed pathogenicity predictions of human mitochondrial non-synonymous variants</article-title>. <source>Hum. Mutat.</source><year>2015</year>; <volume>36</volume>:<fpage>E2413</fpage>–<lpage>E2422</lpage>.<pub-id pub-id-type="pmid">25516408</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Bolze</surname><given-names>A.</given-names></string-name>, <string-name><surname>Mendez</surname><given-names>F.</given-names></string-name>, <string-name><surname>White</surname><given-names>S.</given-names></string-name>, <string-name><surname>Tanudjaja</surname><given-names>F.</given-names></string-name>, <string-name><surname>Isaksson</surname><given-names>M.</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>R.</given-names></string-name>, <string-name><surname>Rossi</surname><given-names>A.D.</given-names></string-name>, <string-name><surname>Cirulli</surname><given-names>E.T.</given-names></string-name>, <string-name><surname>Rashkin</surname><given-names>M.</given-names></string-name>, <string-name><surname>Metcalf</surname><given-names>W.J.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A catalog of homoplasmic and heteroplasmic mitochondrial DNA variants in humans</article-title>. <year>2020</year>; <comment>bioRxiv doi:</comment><comment>26 June 2020, preprint: not peer reviewed</comment><pub-id pub-id-type="doi">10.1101/798264</pub-id>.</mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Auton</surname><given-names>A.</given-names></string-name>, <string-name><surname>Abecasis</surname><given-names>G.R.</given-names></string-name>, <string-name><surname>Altshuler</surname><given-names>D.M.</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R.M.</given-names></string-name>, <string-name><surname>Abecasis</surname><given-names>G.R.</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>D.R.</given-names></string-name>, <string-name><surname>Chakravarti</surname><given-names>A.</given-names></string-name>, <string-name><surname>Clark</surname><given-names>A.G.</given-names></string-name>, <string-name><surname>Donnelly</surname><given-names>P.</given-names></string-name>, <string-name><surname>Eichler</surname><given-names>E.E.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>. <year>2015</year>; <volume>526</volume>:<fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jagadeesan</surname><given-names>A.</given-names></string-name>, <string-name><surname>Ebenesersdottir</surname><given-names>S.S.</given-names></string-name>, <string-name><surname>Guethmundsdottir</surname><given-names>V.B.</given-names></string-name>, <string-name><surname>Thordardottir</surname><given-names>E.L.</given-names></string-name>, <string-name><surname>Moore</surname><given-names>K.H.S.</given-names></string-name>, <string-name><surname>Helgason</surname><given-names>A.</given-names></string-name></person-group><article-title>HaploGrouper: a generalized approach to haplogroup classification</article-title>. <source>Bioinformatics</source>. <year>2021</year>; <volume>37</volume>:<fpage>570</fpage>–<lpage>572</lpage>.<pub-id pub-id-type="pmid">32805011</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ishiya</surname><given-names>K.</given-names></string-name>, <string-name><surname>Ueda</surname><given-names>S.</given-names></string-name></person-group><article-title>MitoSuite: a graphical tool for human mitochondrial genome profiling in massive parallel sequencing</article-title>. <source>PeerJ</source>. <year>2017</year>; <volume>5</volume>:<fpage>e3406</fpage>.<pub-id pub-id-type="pmid">28584729</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>K.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>D.H.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>K.Y.</given-names></string-name></person-group><article-title>Mitochondrial haplogroup classification of ancient DNA samples using haplotracker</article-title>. <source>Biomed. Res. Int.</source><year>2022</year>; <volume>2022</volume>:<fpage>5344418</fpage>.<pub-id pub-id-type="pmid">35342764</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Rubin</surname><given-names>J.D.</given-names></string-name>, <string-name><surname>Vogel</surname><given-names>N.A.</given-names></string-name>, <string-name><surname>Gopalakrishnan</surname><given-names>S.</given-names></string-name>, <string-name><surname>Sackett</surname><given-names>P.W.</given-names></string-name>, <string-name><surname>Renaud</surname><given-names>G.</given-names></string-name></person-group><article-title>HaploCart: human mtDNA haplogroup classification using a pangenomic reference graph</article-title>. <year>2022</year>; <comment>bioRxiv doi:</comment><comment>26 September 2022, preprint: not peer reviewed</comment><pub-id pub-id-type="doi">10.1101/2022.09.23.509203</pub-id>.</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lott</surname><given-names>M.T.</given-names></string-name>, <string-name><surname>Leipzig</surname><given-names>J.N.</given-names></string-name>, <string-name><surname>Derbeneva</surname><given-names>O.</given-names></string-name>, <string-name><surname>Xie</surname><given-names>H.M.</given-names></string-name>, <string-name><surname>Chalkia</surname><given-names>D.</given-names></string-name>, <string-name><surname>Sarmady</surname><given-names>M.</given-names></string-name>, <string-name><surname>Procaccio</surname><given-names>V.</given-names></string-name>, <string-name><surname>Wallace</surname><given-names>D.C.</given-names></string-name></person-group><article-title>mtDNA variation and analysis using Mitomap and Mitomaster</article-title>. <source>Curr. Protoc. Bioinformatics</source>. <year>2013</year>; <volume>44</volume>:<fpage>1.23.1</fpage>–<lpage>1.23.26</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
