<?properties no_embargo?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Acta Crystallogr D Biol Crystallogr</journal-id>
    <journal-id journal-id-type="publisher-id">Acta Cryst. D</journal-id>
    <journal-title>Acta Crystallographica Section D: Biological Crystallography</journal-title>
    <issn pub-type="ppub">0907-4449</issn>
    <issn pub-type="epub">1399-0047</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2394800</article-id>
    <article-id pub-id-type="publisher-id">ba5115</article-id>
    <article-id pub-id-type="doi">10.1107/S0907444907037195</article-id>
    <article-id pub-id-type="coden">ABCRE6</article-id>
    <article-id pub-id-type="pii">S0907444907037195</article-id>
    <article-id pub-id-type="pmid">18094475</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Papers</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>MrBUMP</italic>: an automated pipeline for molecular replacement</article-title>
      <alt-title>
        <italic>MrBUMP</italic>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Keegan</surname>
          <given-names>Ronan M.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Winn</surname>
          <given-names>Martyn D.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <aff id="a"><label>a</label>Computational Science and Engineering Department, STFC Daresbury Laboratory, Daresbury, Warrington WA4 4AD, <country>England</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>m.d.winn@dl.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>1</month>
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>12</month>
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>4</day>
      <month>12</month>
      <year>2007</year>
    </pub-date>
    <volume>64</volume>
    <issue>Pt 1</issue>
    <issue-id pub-id-type="publisher-id">d080100</issue-id>
    <fpage>119</fpage>
    <lpage>124</lpage>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>5</month>
        <year>2007</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>7</month>
        <year>2007</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© International Union of Crystallography 2008</copyright-statement>
      <copyright-year>2008</copyright-year>
      <license license-type="open-access" xlink:href="http://journals.iucr.org/services/termsofuse.html">
        <p>This is an open-access article distributed under the terms described at http://journals.iucr.org/services/termsofuse.html.</p>
      </license>
    </permissions>
    <self-uri xlink:type="simple" xlink:href="http://dx.doi.org/10.1107/S0907444907037195">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p>An automation pipeline for macromolecular structure solution by molecular replacement with a special emphasis on the discovery and preparation of a large number of search models is described.</p>
    </abstract>
    <abstract>
      <p>A novel automation pipeline for macromolecular structure solution by molecular replacement is described. There is a special emphasis on the discovery and preparation of a large number of search models, all of which can be passed to the core molecular-replacement programs. For routine molecular-replacement problems, the pipeline automates what a crystallographer might do and its value is simply one of convenience. For more difficult cases, the pipeline aims to discover the particular template structure and model edits required to produce a viable search model and may succeed in finding an efficacious combination that would be missed otherwise. An overview of <italic>MrBUMP</italic> is given and some recent additions to its functionality are highlighted.</p>
    </abstract>
    <kwd-group>
      <kwd>molecular replacement</kwd>
      <kwd>search-model generation</kwd>
      <kwd>automation</kwd>
      <kwd>protein structure</kwd>
    </kwd-group>
    <conference>
      <conf-date/>
      <conf-name>Molecular replacement</conf-name>
      <conf-loc/>
    </conference>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <label>1.</label>
    <title><italic>MrBUMP</italic> as an automated pipeline</title>
    <p>The 2007 CCP4 Study Weekend meeting has addressed many aspects of molecular replacement (MR), including how to prepare a search model and how to assess and process the output of MR programs. It is pertinent to ask what automation can do in this context.</p>
    <p>An automation pipeline cannot do anything that could not in principle be done manually. In the context of MR, if there really is no suitable homologous protein to form the basis of a search model, then an automation pipeline will not create one. Does automation add anything at all? In fact, there are often a large number of potential search models to be tried and automation can clearly help in ensuring that all are tried. For example, Jaskólski <italic>et al.</italic> (2006<xref ref-type="bibr" rid="bb11"> ▶</xref>) provided results for a range of search models and solution methods for the case of a retroviral protease HTLV-1 and concluded that <disp-quote><p>when many possible models are available, all should be investigated as potential starting points.</p></disp-quote>Earlier, Schwarzenbacher <italic>et al.</italic> (2004<xref ref-type="bibr" rid="bb33"> ▶</xref>) also advocated the use of a range of search models together with the use of more than one MR program and suggested that <disp-quote><p>The only practical solution for massive MR searches with different parameters is automation and parallelization.</p></disp-quote>An additional and important benefit of an automated scheme is that one gets data and file management for free.</p>
    <p>Going to the other extreme, can automation now do everything, so that the practising protein crystallographer no longer need worry about the methodology? Sadly, this is not the case either. As we have heard during the meeting, difficult cases are still common and an automation scheme will not cover all the tricks needed to solve such cases. Moreover, the parameters and methods used in an automation scheme will be tuned to the test sets used and however extensive these test sets are, the resulting parameters will not be appropriate in every case, even given searches over some parameters. Finally, finding a correct MR solution is not the end of the story: it is still necessary to complete the model and it may be necessary to rebuild parts of the model where there is bias towards the search model.</p>
    <p>In this article, we describe <italic>MrBUMP</italic>, an MR automation scheme that we have been developing. In recent years, a number of automated pipelines and services based around or including the MR technique have been developed. These include those developed to support structural genomics consortia; see, for example, Rupp <italic>et al.</italic> (2002<xref ref-type="bibr" rid="bb32"> ▶</xref>) and Fu <italic>et al.</italic> (2005<xref ref-type="bibr" rid="bb8"> ▶</xref>). Publicly available services include the TB Consortium Bias Removal Server (Reddy <italic>et al.</italic>, 2003<xref ref-type="bibr" rid="bb31"> ▶</xref>), <italic>CaspR</italic> (Claude <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb4"> ▶</xref>) and <italic>BRUTEPTF</italic> (Strokopytov <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb35"> ▶</xref>). Other developments include <italic>Auto-Rickshaw</italic> (Panjikar <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb27"> ▶</xref>), which is principally for experimental phasing but covers phased MR as well, and a scheme for using comparative models in MR (Giorgetti <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb9"> ▶</xref>). More recently, the <italic>Balbes</italic> automated system for MR has been developed at York. <italic>Balbes</italic> is described elsewhere in this issue (Long <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb20"> ▶</xref>), along with the MR pipeline of the Joint Centre for Structural Genomics (JCSG).</p>
    <p><italic>MrBUMP</italic> is a framework which allows a range of techniques and programs to be employed, rather than relying on a single approach. For a given target, <italic>MrBUMP</italic> tries a long list of potential search models based on different proteins and on different search-model generation techniques. The search is exhaustive rather than fast. Search models are ranked so that there is a reasonable chance that good solutions will appear early, but unexpected hits are allowed for. In favourable cases, this approach gives a ‘one-button’ solution, with the output of <italic>MrBUMP</italic> ready for model completion and submission. In unfavourable cases, the results of <italic>MrBUMP</italic> will suggest likely search models for further manual investigation.</p>
    <p>The current version of <italic>MrBUMP</italic> assumes a single target sequence, although there may be multiple copies of the target molecule in the asymmetric unit. <italic>MrBUMP</italic> does not currently address multi-component systems, <italic>i.e.</italic> complexes and multi-domain proteins where the domains need to be solved separately. In these cases, it can be and has been used to search for the components separately, with the best results being combined manually.</p>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title><italic>MrBUMP</italic> overview</title>
    <p>The <italic>MrBUMP</italic> pipeline has been described in detail in a recent article (Keegan &amp; Winn, 2007<xref ref-type="bibr" rid="bb15"> ▶</xref>) and so we give only a brief overview here. Recent developments not described in the previous article are presented in the next section.</p>
    <p>The overall scheme of <italic>MrBUMP</italic> is shown in Fig. 1<xref ref-type="fig" rid="fig1"> ▶</xref>. In the highest level view, the process consists of three stages: discovery of search-model templates, construction of search models from these templates and molecular replacement itself. Each of the stages can utilize a variety of techniques, giving a large degree of flexibility. The process is centred around a list of templates and a list of derived search models and the various techniques operate on these lists.</p>
    <p>The first stage currently has three methods of acquiring search-model templates. Firstly, the target sequence is used to search for related proteins in the Protein Data Bank using a simple pairwise alignment as implemented in the <italic>FASTA</italic> package (Pearson &amp; Lipman, 1988<xref ref-type="bibr" rid="bb28"> ▶</xref>). The second method is to submit the structure of the top <italic>FASTA</italic> hit to the <italic>SSM</italic> service (Krissinel &amp; Henrick, 2004<xref ref-type="bibr" rid="bb16"> ▶</xref>), which may find additional PDB entries that were not picked up in the initial sequence search. Such entries are structurally similar (based on the secondary-structure elements) to the top match of the <italic>FASTA</italic> search; the hope is that such structures are also structurally similar to the target. Finally, templates may be specified manually if they are known, either by including a local PDB file or by specifying a PDB code.</p>
    <p>In addition to complete chains, search models may be based on individual domains or on multimers. The SCOP database (Murzin <italic>et al.</italic>, 1995<xref ref-type="bibr" rid="bb24"> ▶</xref>; Lo Conte <italic>et al.</italic>, 2002<xref ref-type="bibr" rid="bb18"> ▶</xref>) is checked to see whether any of the templates under consideration includes domains; if so, a new template is constructed for those domains. Multimer templates are constructed if the multimer is biologically relevant (and therefore likely to be transferable between crystal structures) and if it will fit in the target asymmetric unit. The first implementation used the PQS database (Henrick &amp; Thornton, 1998<xref ref-type="bibr" rid="bb10"> ▶</xref>) to identify possible biological multimers. Recent usage of the <italic>PISA</italic> service (Krissinel &amp; Henrick, 2005<xref ref-type="bibr" rid="bb17"> ▶</xref>) is described in the next section.</p>
    <p>The sequences of the set of template structures are aligned against the target sequence in a single multiple alignment step. The aim is twofold. Firstly, a template-to-target alignment is required for the <italic>Chainsaw</italic> model-generation step (see below) and that extracted from a multiple alignment is expected to be more reliable than a simple pairwise alignment of the sequences. Secondly, a score for each template is calculated from the multiple alignment and is used to rank the templates for subsequent steps.</p>
    <p>In the second stage of <italic>MrBUMP</italic>, one or more search models are derived from each of the selected templates. Currently, four methods are implemented. The ‘PDBclip’ method simply tidies up the template PDB file, for example removing nonprotein atoms. This is a precursor for other methods, but can be used on its own. The second method generates a traditional polyalanine model from the template structure. The other two methods are more sophisticated and use an alignment to the target to remove sections of main chain that do not align to the target and to truncate side chains of aligned residues according to the conservation of the residue. The third method does this <italic>via</italic> the model-improvement functions of <italic>MOLREP</italic> (Vagin &amp; Teplyakov, 1997<xref ref-type="bibr" rid="bb37"> ▶</xref>), which uses an internal alignment that takes into account the secondary structure of the template. The fourth method uses the program <italic>Chainsaw</italic> (Stein, 2008<xref ref-type="bibr" rid="bb34"> ▶</xref>), which uses an alignment extracted from the previous multiple alignment step. <italic>MOLREP</italic> and <italic>Chainsaw</italic> are similar in purpose, but differ in the details of the alignment used and the extent of side-chain truncation.</p>
    <p>At this stage, <italic>MrBUMP</italic> can exit with a list of possible search models. Up to this point, there is no absolute requirement to have diffraction data and therefore <italic>MrBUMP</italic> can be used to generate search models before data collection. This may be useful to assess the need to collect derivative or anomalous data.</p>
    <p>In the final stage of <italic>MrBUMP</italic>, the top search models are passed to <italic>MOLREP</italic> (Vagin &amp; Teplyakov, 1997<xref ref-type="bibr" rid="bb37"> ▶</xref>) and/or <italic>Phaser</italic> (McCoy <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb21"> ▶</xref>) for molecular replacement. <italic>MrBUMP</italic> passes the target data, a search model and additional information such as the molecular weight of the target to the molecular-replacement program. If the latter locates at least one copy of the search model, then the positioned model is passed to <italic>REFMAC</italic> (Murshudov <italic>et al.</italic>, 1997<xref ref-type="bibr" rid="bb23"> ▶</xref>) for 30 cycles of restrained refinement. The purpose of the refinement step is to assess whether the positioned model is refinable, <italic>i.e.</italic> whether it is both positioned correctly and is a useful starting point for model completion. On the basis of the behaviour of <italic>R</italic>
            <sub>free</sub>, the MR solution for a particular search model is classified as a solution, a marginal solution or a failure.</p>
    <p>The result of a run of <italic>MrBUMP</italic> is thus a set of search models and results from molecular-replacement trials. In favourable cases, <italic>MrBUMP</italic> will have produced a partially refined model that can be passed to final rounds of model editing and refinement or that can be passed to <italic>ARP</italic>/<italic>wARP</italic> (Perrakis <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb29"> ▶</xref>) for rebuilding. Otherwise, it is often clear that a particular search model is capable of solving the structure and the role of <italic>MrBUMP</italic> has been to direct manual efforts.</p>
  </sec>
  <sec id="sec3">
    <label>3.</label>
    <title>Recent developments</title>
    <sec id="sec3.1">
      <label>3.1.</label>
      <title>Enantiomorphic space groups</title>
      <p>There are 11 pairs of enantiomorphic space groups containing screw axes of opposite handedness. One property of an enantiomorphic space group is that in the absence of anomalous scattering it is indistinguishable from the other member of the pair on the basis of its diffraction pattern. Therefore, unless one has prior knowledge of the space group, both enantiomorphic space groups of a pair need to be tested in MR. The collection of orientations of molecules in the unit cell does not differ between the two space groups, only the translations of these molecules with respect to the origin. Therefore, the rotation function is in principle identical for the alternative space groups and the correct space group is only indicated by the translation and packing functions.</p>
      <p><italic>MrBUMP</italic> has been extended to detect when an input MTZ file is in one of a pair of enantiomorphic space groups and then to give the user the option of testing both possible alternative space groups. <italic>Phaser</italic> already includes such an option (keyword SGAL HAND) and this is invoked by <italic>MrBUMP</italic>. The correct space group is inferred from the top solution provided by <italic>Phaser</italic>. <italic>MOLREP</italic> does not currently have such an option (although it does have an option to test all space groups in a given point group) and so <italic>MrBUMP</italic> runs the translation-function step of <italic>MOLREP</italic> twice, once for each possible space group. The correct space group is chosen as that which gives the best contrast value in <italic>MOLREP</italic>. The subsequent refinement step of <italic>MrBUMP</italic> is performed in the space group selected by the MR step.</p>
      <p>When there is a good search model and hence a good MR solution, then the correct space group is obvious from the MR scores. For marginal search models, the discrimination is not so good and the incorrect space group may be chosen. Note that the choice is made independently for each search model.</p>
    </sec>
    <sec id="sec3.2">
      <label>3.2.</label>
      <title>Phase improvement with <italic>ACORN</italic>
            </title>
      <p><italic>ACORN</italic> is a program for phase improvement <italic>via</italic> dynamic density modification. The initial phase set can come from a variety of sources and can represent a small fraction of the target structure such as a single heavy atom. One application of <italic>ACORN</italic> is to the improvement of phase sets from MR and the reduction of model bias. Until recently, <italic>ACORN</italic> required atomic resolution, but the latest version of <italic>ACORN</italic> (Jia-xing <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb12"> ▶</xref>) has pushed the limit of applicability down to around 1.7 Å. This is achieved by artificially extending the reflection data to 1.0 Å, with several schemes for filling in missing observed amplitudes.</p>
      <p><italic>MrBUMP</italic> now has the option to run <italic>ACORN</italic> after a successful molecular replacement. One aim is to provide better maps for subsequent model completion. The correlation coefficient between the observed and calculated <italic>E</italic> values in the set of medium reflections is also a good indicator of the quality and correctness of the MR solution. <italic>ACORN</italic> still requires reasonably good resolution and is invoked by default by <italic>MrBUMP</italic> if the target data resolution is better than 1.7 Å. Initial phases are provided by the partially refined search model from <italic>REFMAC</italic>. Trials have shown that refined coordinates provide a better starting phase set for <italic>ACORN</italic> than the unrefined coordinates direct from MR. §<xref ref-type="sec" rid="sec4.1"/>4.1 shows an example of the usage of <italic>ACORN</italic> within <italic>MrBUMP</italic>.</p>
    </sec>
    <sec id="sec3.3">
      <label>3.3.</label>
      <title>Quaternary structures with <italic>PISA</italic>
            </title>
      <p>The <italic>PISA</italic> service (Krissinel &amp; Henrick, 2005<xref ref-type="bibr" rid="bb17"> ▶</xref>) considers all possible sets of protein assemblies that can be generated from the crystal structure and scores them according to an estimated free energy of dissociation. For a given template structure, <italic>MrBUMP</italic> queries the <italic>PISA</italic> server at the European Bioinformatics Institute and retrieves an XML file listing all possible multimers, together with their scores. <italic>MrBUMP</italic> selects those multimers considered to be stable and relevant to the current target and adds them to the list of templates. A coordinate file for each multimer is created using the chain and symmetry information provided by <italic>PISA</italic>. For each multimer template, a number of different MR search models may be generated using some or all of the four methods listed in §<xref ref-type="sec" rid="sec2"/>2.</p>
      <p>The use of <italic>PISA</italic> has a couple of advantages over the earlier use of the PQS database. Firstly, the scoring is expected to be slightly more accurate and trials against a benchmark set of experimentally verified assemblies gave a slightly improved success rate (Krissinel &amp; Henrick, 2005<xref ref-type="bibr" rid="bb17"> ▶</xref>). Secondly, <italic>PISA</italic> gives a full list of possible multimers, so that <italic>MrBUMP</italic> could, for instance, generate both dimer and tetramer search models when trying to solve a tetrameric target.</p>
    </sec>
    <sec id="sec3.4">
      <label>3.4.</label>
      <title>Alternative multiple alignment programs</title>
      <p>Multiple alignment is used in <italic>MrBUMP</italic> to generate scores for the template structures, which inform the order in which MR jobs are run, and to generate the pairwise alignments used by <italic>Chainsaw</italic>. Multiple alignment is still an active area of research, especially in the ‘twilight zone’ of low (&lt;30%) sequence identities, and tests show that different multiple alignment programs can give significantly different results (see, for example, Ahola <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb1"> ▶</xref>). The quality of an alignment is sometimes assessed by comparison with reference alignments, such as BAliBASE (Thompson <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb36"> ▶</xref>), but the conclusions of such tests do not necessarily transfer to our particular usage of these programs.</p>
      <p>The original version of <italic>MrBUMP</italic> supported two multiple alignment programs, namely <italic>ClustalW</italic> (Chenna <italic>et al.</italic>, 2003<xref ref-type="bibr" rid="bb3"> ▶</xref>) and <italic>MAFFT</italic> (Katoh <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb14"> ▶</xref>). While <italic>ClustalW</italic> is the most widely used multiple alignment program, it is no longer considered to be the best available. Given the importance of alignment in generating MR search models it is useful to try other programs and to this end <italic>MrBUMP</italic> now also supports <italic>PROBCONS</italic> (Do <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb6"> ▶</xref>) and <italic>T-COFFEE</italic> (Notredame <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb25"> ▶</xref>).</p>
      <p>In the ‘twilight zone’ where the alignment is not necessarily reliable, it may be necessary to try different alignments in the <italic>Chainsaw</italic> step, either from the same program or from different programs. This will be automated in future, but for the moment the user can experiment with different alignment programs.</p>
    </sec>
    <sec id="sec3.5">
      <label>3.5.</label>
      <title><italic>Smartie</italic>: smart log-file browsing</title>
      <p>A new mechanism for parsing the various log files produced by the underlying <italic>CCP</italic>4 programs (Collaborative Computational Project, Number 4, 1994<xref ref-type="bibr" rid="bb5"> ▶</xref>) in <italic>MrBUMP</italic> has been incorporated into the program. Currently being developed by Peter Briggs of the CCP4 team, <italic>Smartie</italic> is a set of Python classes and methods intended to provide tools for parsing the content of <italic>CCP</italic>4 log files. The name ‘<italic>Smartie</italic>’ reflects its origins as the driver for a ‘smart logfile browser’. Amongst other things, <italic>Smartie</italic> allows the extraction of tables from the log files according to their title and their presentation in various formats such as log graph, marked up in HTML or in a plain text format. Its main advantages are its robustness and ease of use.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <label>4.</label>
    <title>Case studies</title>
    <p>Examples of the application of <italic>MrBUMP</italic> have been presented in two previous articles (Bahar <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb2"> ▶</xref>; Keegan &amp; Winn, 2007<xref ref-type="bibr" rid="bb15"> ▶</xref>). <italic>MrBUMP</italic> has also been used in a number of structure determinations (Obiero <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb26"> ▶</xref>; El Omari <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb7"> ▶</xref>; Karbat <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb13"> ▶</xref>; Logan, 2008<xref ref-type="bibr" rid="bb19"> ▶</xref>).</p>
    <p>Here, we give one example to illustrate the usage of <italic>ACORN</italic> within <italic>MrBUMP</italic>, as well as general features of <italic>MrBUMP</italic>.</p>
    <sec id="sec4.1">
      <label>4.1.</label>
      <title>dUTPase from <italic>Campylobacter jejuni</italic>
            </title>
      <p>The example target is dUTPase from <italic>C. jejuni</italic> in complex with the substrate analogue dUpNHp, now deposited with PDB code <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1w2y">1w2y</ext-link>. It was solved originally by molecular replace­ment using <italic>MOLREP</italic> with the structure of the <italic>Trypanosoma cruzi</italic> dUTPase in complex with dUDP (PDB code <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1ogk">1ogk</ext-link>) as the search model (Moroz <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb22"> ▶</xref>). It was subsequently used as a test case for <italic>ACORN</italic> in Jia-xing <italic>et al.</italic> (2005<xref ref-type="bibr" rid="bb12"> ▶</xref>). The target asymmetric unit contains two chains of 229 residues. Data are available to 1.65 Å, which is expected to be just good enough to apply the <italic>ACORN</italic> protocol.</p>
      <p>The <italic>FASTA</italic> search in <italic>MrBUMP</italic> locates chain <italic>A</italic> of <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1ogl">1ogl</ext-link> and chains <italic>A</italic>, <italic>B</italic>, <italic>D</italic> and <italic>E</italic> of <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1ogk">1ogk</ext-link>, all of which have sequence identities to the target of around 38%. The SCOP search fails to find smaller constituent domains, but PQS indicates that <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1ogl">1ogl</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1ogk">1ogk</ext-link> exist as dimers. The multiple alignment step aligns the five template chains against the target sequence and pairwise alignments are extracted for use in <italic>Chainsaw</italic>. Scoring based on the multiple alignment step ranks the chains in the order 1ogl_<italic>A</italic>, 1ogk_<italic>B</italic>, 1ogk_<italic>E</italic>, 1ogk_<italic>D</italic>, 1ogk_<italic>A</italic>, although in fact the scores are very similar in this case.</p>
      <p>Table 1<xref ref-type="table" rid="table1"> ▶</xref> shows sample results for monomer search models from a standard run of <italic>MrBUMP</italic>, invoking the <italic>ACORN</italic> option. When referring to search models, we use the nomenclature &lt;PDB code&gt;_&lt;subunit ID&gt;_&lt;model preparation method&gt;, where a subunit can be a chain or a domain. For example, 1ogk_B_CHNSAW refers to chain <italic>B</italic> of <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1ogk">1ogk</ext-link> prepared using the program <italic>Chainsaw</italic>.</p>
      <p><italic>Phaser</italic> finds clear solutions for <italic>Chainsaw</italic> search models based on chains <italic>B</italic>, <italic>D</italic> and <italic>E</italic> of <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1ogk">1ogk</ext-link>. The <italic>Z</italic> scores for the final translation function are large and the <italic>R</italic>
               <sub>free</sub> drops sufficiently in restrained refinement to indicate a marginal solution. Conversely, the <italic>Phaser</italic> solutions for models 1ogk_A_CHNSAW and 1ogl_A_CHNSAW fail to refine. Similar results are obtained using <italic>MOLREP</italic> as the MR program. Unlike the other three chains, chain <italic>A</italic> of <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1ogk">1ogk</ext-link> is not complexed with dUDP in the template structure and adopts a significantly different conformation. Similarly, <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1ogl">1ogl</ext-link> is the crystal structure of the unliganded dUTPase from <italic>T. cruzi</italic> and adopts the same conformation as chain <italic>A</italic> of <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1ogk">1ogk</ext-link>. Since the target is in a bound form, chains 1ogk_<italic>B</italic>, 1ogk_<italic>D</italic> and 1ogk_<italic>E</italic> provide a better search-model conformation. As might be expected from these observations, a dimer search model based on chains <italic>D</italic> and <italic>E</italic> of <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1ogk">1ogk</ext-link> provides a solution, whereas one based on chains <italic>A</italic> and <italic>B</italic> does not.</p>
      <p><italic>MrBUMP</italic> passes the three successful solutions to <italic>ACORN</italic>. In each case, the correlation coefficient shows a clear increase, giving confidence that these solutions are correct. The low absolute values of the correlation coefficient reflect the use of medium-strength <italic>E</italic> values and are typical. Acorn outputs normalized structure factors, phases and weights to the fictitious high-resolution limit and these can be used to generate atomic style maps which are better than maps calculated to the true resolution (Jia-xing <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb12"> ▶</xref>). Fig. 2<xref ref-type="fig" rid="fig2"> ▶</xref> shows part of such a map, together with the positioned and refined search model used as input to <italic>ACORN</italic> and the final deposited structure. The search model 1ogk_E_CHNSAW possesses the same overall fold as the target, but nevertheless there are disagreements in some loop regions. At the bottom of the figure is part of a loop which differs substantially between the search model and the final coordinates. The <italic>ACORN</italic> density clearly follows the correct coordinates rather than being biased to the search model. Finally, the <italic>ACORN</italic> phases can be used as input to model-building programs such as <italic>ARP</italic>/<italic>wARP</italic> (Perrakis <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb29"> ▶</xref>), which rebuilds the model in the correct location.</p>
    </sec>
  </sec>
  <sec id="sec5">
    <label>5.</label>
    <title>Availability</title>
    <p><italic>MrBUMP</italic> is distributed under the <italic>CCP</italic>4 licence and is available for download from <ext-link ext-link-type="uri" xlink:href="http://www.ccp4.ac.uk/MrBUMP">http://www.ccp4.ac.uk/MrBUMP</ext-link>. It runs under Linux/Unix, Mac OSX and Windows and comes complete with a <italic>ccp</italic>4<italic>i</italic> GUI.</p>
  </sec>
</body>
<back>
  <ack>
    <p>This work was supported by the BBSRC through the e-­HTPX and CCP4 grants. We thank all users of <italic>MrBUMP</italic> for useful feedback and encouragement.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <citation citation-type="other">Ahola, V., Aittokallio, T., Vihinen, M. &amp; Uusipaikka, E. (2006). <italic>BMC Bioinformatics</italic>, <bold>7</bold>, 484.</citation>
    </ref>
    <ref id="bb2">
      <citation citation-type="other">Bahar, M. <italic>et al.</italic> (2006). <italic>Acta Cryst.</italic> D<bold>62</bold>, 1170–1183.</citation>
    </ref>
    <ref id="bb3">
      <citation citation-type="other">Chenna, R., Sugawara, H., Koike,T., Lopez, R., Gibson, T. J., Higgins, D. G. &amp; Thompson, J. D. (2003). <italic>Nucleic Acids Res.</italic><bold>31</bold>, 3497–3500.</citation>
    </ref>
    <ref id="bb4">
      <citation citation-type="other">Claude, J.-B., Suhre, K., Notredame, C., Claverie, J.-M. &amp; Abergel, C. (2004). <italic>Nucleic Acids Res.</italic><bold>32</bold>, W606–W609.</citation>
    </ref>
    <ref id="bb5">
      <citation citation-type="other">Collaborative Computational Project, Number 4 (1994). <italic>Acta Cryst.</italic> D<bold>50</bold>, 760–763.</citation>
    </ref>
    <ref id="bb6">
      <citation citation-type="other">Do, C. B., Mahabhashyam, M. S. P., Brudno, M. &amp; Batzoglou, S. (2005). <italic>Genome Res.</italic><bold>15</bold>, 330–340.</citation>
    </ref>
    <ref id="bb7">
      <citation citation-type="other">El Omari, K., Dhaliwal, B., Lockyer, M., Charles, I., Hawkins, A. R. &amp; Stammers, D. K. (2006). <italic>Acta Cryst.</italic> F<bold>62</bold>, 949–953.</citation>
    </ref>
    <ref id="bb8">
      <citation citation-type="other">Fu, Z.-Q., Rose, J. &amp; Wang, B.-C. (2005). <italic>Acta Cryst.</italic> D<bold>61</bold>, 951–959.</citation>
    </ref>
    <ref id="bb9">
      <citation citation-type="other">Giorgetti, A., Raimondo, D., Miele, A. E. &amp; Tramontano, A. (2005). <italic>Bioinformatics</italic>, <bold>21</bold>, 72–76.</citation>
    </ref>
    <ref id="bb10">
      <citation citation-type="other">Henrick, K. &amp; Thornton, J. M. (1998). <italic>Trends Biochem. Sci.</italic><bold>23</bold>, 358–­361.</citation>
    </ref>
    <ref id="bb11">
      <citation citation-type="other">Jaskólski, M., Li, M., Laco, G., Gustchina, A. &amp; Wlodawer, A. (2006). <italic>Acta Cryst.</italic> D<bold>62</bold>, 208–215.</citation>
    </ref>
    <ref id="bb12">
      <citation citation-type="other">Jia-xing, Y., Woolfson, M. M., Wilson, K. S. &amp; Dodson, E. J. (2005). <italic>Acta Cryst.</italic> D<bold>61</bold>, 1465–1475.</citation>
    </ref>
    <ref id="bb13">
      <citation citation-type="other">Karbat, I., Turkov, M., Cohen, L., Kahn, R., Gordon, D., Gurevitz, M. &amp; Frolow, F. (2007). <italic>J. Mol. Biol.</italic><bold>366</bold>, 586–601.</citation>
    </ref>
    <ref id="bb14">
      <citation citation-type="other">Katoh, K., Kuma, K.,Toh, H. &amp; Miyata, T. (2005). <italic>Nucleic Acids Res.</italic><bold>33</bold>, 511–518.</citation>
    </ref>
    <ref id="bb15">
      <citation citation-type="other">Keegan, R. M. &amp; Winn, M. D. (2007). <italic>Acta Cryst.</italic> D<bold>63</bold>, 447–457.</citation>
    </ref>
    <ref id="bb16">
      <citation citation-type="other">Krissinel, E. &amp; Henrick, K. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2256–2268.</citation>
    </ref>
    <ref id="bb17">
      <citation citation-type="other">Krissinel, E. &amp; Henrick, K. (2005). <italic>CompLife 2005</italic>, edited by M. R. Berthold, R. Glen, K. Diederichs, O. Kohlbacher &amp; I. Fischer, pp. 163–174. Berlin/Heidelberg: Springer-Verlag.</citation>
    </ref>
    <ref id="bb18">
      <citation citation-type="other">Lo Conte, L., Brenner, S. E., Hubbard, T. J. P., Chothia, C. &amp; Murzin, A. G. (2002). <italic>Nucleic Acids Res.</italic><bold>30</bold>, 264–267.</citation>
    </ref>
    <ref id="bb19">
      <citation citation-type="other">Logan, D. (2008). Submitted.</citation>
    </ref>
    <ref id="bb20">
      <citation citation-type="journal">Long, F., Vagin, A., Young, P. &amp; Murshudov, G. N. (2008). <italic>Acta Cryst.</italic> D<bold>64</bold>, 125–132.</citation>
    </ref>
    <ref id="bb21">
      <citation citation-type="other">McCoy, A. J., Grosse-Kunstleve, R. W., Storoni, L. C. &amp; Read, R. J. (2005). <italic>Acta Cryst.</italic> D<bold>61</bold>, 458–464.</citation>
    </ref>
    <ref id="bb22">
      <citation citation-type="other">Moroz, O. V., Harkiolaki, M., Galperin, M. Y., Vagin, A. A., González-Pacanowska, D. &amp; Wilson, K. S. (2004). <italic>J. Mol. Biol.</italic><bold>342</bold>, 1583–1597.</citation>
    </ref>
    <ref id="bb23">
      <citation citation-type="other">Murshudov, G. N., Vagin, A. A. &amp; Dodson, E. J. (1997). <italic>Acta Cryst.</italic> D<bold>53</bold>, 240–255.</citation>
    </ref>
    <ref id="bb24">
      <citation citation-type="other">Murzin, A. G., Brenner, S. E., Hubbard, T. &amp; Chothia, C. (1995). <italic>J. Mol. Biol.</italic><bold>247</bold>, 536–540.</citation>
    </ref>
    <ref id="bb25">
      <citation citation-type="other">Notredame, C., Higgins, D. G. &amp; Heringa, J. (2000). <italic>J. Mol. Biol.</italic><bold>302</bold>, 205–217.</citation>
    </ref>
    <ref id="bb26">
      <citation citation-type="other">Obiero, J., Bonderoff, S. A., Goertzen, M. M. &amp; Sanders, D. A. R. (2006). <italic>Acta Cryst.</italic> F<bold>62</bold>, 757–760.</citation>
    </ref>
    <ref id="bb27">
      <citation citation-type="other">Panjikar, S., Parthasarathy, V., Lamzin, V. S., Weiss, M. S. &amp; Tucker, P. A. (2005). <italic>Acta Cryst.</italic> D<bold>61</bold>, 449–457.</citation>
    </ref>
    <ref id="bb28">
      <citation citation-type="other">Pearson, W. R. &amp; Lipman, D. J. (1988). <italic>Proc. Natl Acad. Sci. USA</italic>, <bold>85</bold>, 2444–2448.</citation>
    </ref>
    <ref id="bb29">
      <citation citation-type="other">Perrakis, A., Morris, R. &amp; Lamzin, V. S. (1999). <italic>Nature Struct. Biol.</italic><bold>6</bold>, 458–463.</citation>
    </ref>
    <ref id="bb30">
      <citation citation-type="other">Potterton, L., McNicholas, S., Krissinel, E., Gruber, J., Cowtan, K., Emsley, P., Murshudov, G. N., Cohen, S., Perrakis, A. &amp; Noble, M. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2288–2294.</citation>
    </ref>
    <ref id="bb31">
      <citation citation-type="other">Reddy, V., Swanson, S. M., Segelke, B., Kantardjieff, K. A., Sacchettini, J. C. &amp; Rupp, B. (2003). <italic>Acta Cryst.</italic> D<bold>59</bold>, 2200–2210.</citation>
    </ref>
    <ref id="bb32">
      <citation citation-type="other">Rupp, B., Segelke, B. W., Krupka, H. I., Lekin, T., Schäfer, J., Zemla, A., Toppani, D., Snell, G. &amp; Earnest, T. (2002). <italic>Acta Cryst.</italic> D<bold>58</bold>, 1514–1518.</citation>
    </ref>
    <ref id="bb33">
      <citation citation-type="other">Schwarzenbacher, R., Godzik, A., Grzechnik, S. K. &amp; Jaroszewski, L. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 1229–1236.</citation>
    </ref>
    <ref id="bb34">
      <citation citation-type="journal">Stein, N. D. (2008). <italic>J. Appl. Cryst.</italic> Submitted.</citation>
    </ref>
    <ref id="bb35">
      <citation citation-type="other">Strokopytov, B. V., Fedorov, A., Mahoney, N. M., Kessels, M., Drubin, D. G. &amp; Almo, S. C. (2005). <italic>Acta Cryst.</italic> D<bold>61</bold>, 285–293.</citation>
    </ref>
    <ref id="bb36">
      <citation citation-type="other">Thompson, J., Plewniak, F. &amp; Poch, O. (1999). <italic>Bioinformatics</italic>, <bold>15</bold>, 87–­88.</citation>
    </ref>
    <ref id="bb37">
      <citation citation-type="other">Vagin, A. &amp; Teplyakov, A. (1997). <italic>J. Appl. Cryst.</italic><bold>30</bold>, 1022–1025.</citation>
    </ref>
  </ref-list>
</back>
<floats-wrap>
  <fig id="fig1" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Flow diagram of the steps performed in a full run of <italic>MrBUMP</italic>. The starting point is an MTZ file containing structure factors and a single target sequence (the corresponding flow diagram for complexes, not yet implemented, is more complicated). Grey boxes indicate steps that can be run in parallel, for example making use of computer clusters.</p>
    </caption>
    <graphic xlink:href="d-64-00119-fig1"/>
  </fig>
  <fig id="fig2" position="float">
    <label>Figure 2</label>
    <caption>
      <p>An example fragment showing the positioned and refined search model 1ogk_E_CHNSAW (coral) compared with the final deposited structure (PDB code <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1w2y">1w2y</ext-link>, green) for dUTPase from <italic>C. jejuni</italic> (§<xref ref-type="sec" rid="sec4.1"/>4.1). The map was generated using phases generated by <italic>ACORN</italic> density modification, starting from the search-model coordinates. At the top of the figure are two regions where the search model matches the final coordinates well. At the bottom of the figure is part of a loop which differs substantially between the search model and the final coordinates. The <italic>ACORN</italic> density clearly follows the correct coordinates rather than being biased to the search model. The map is atomic in nature, as it uses coefficients from the phase-extension procedure. It also noticeable that <italic>ACORN</italic> picks out O and N atoms better than C atoms. The figure was prepared using <italic>CCP</italic>4<italic>mg</italic> (Potterton <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb30"> ▶</xref>).</p>
    </caption>
    <graphic xlink:href="d-64-00119-fig2"/>
  </fig>
  <table-wrap id="table1" position="float">
    <label>Table 1</label>
    <caption>
      <title>Selected results for dUTPase from <italic>C. jejuni</italic> (§<xref ref-type="sec" rid="sec4.1"/>4.1)</title>
      <p>The first column gives the search model used, following the notation described in §<xref ref-type="sec" rid="sec4"/>4. The column ‘Seq. id.’ gives the <italic>FASTA</italic> sequence identity against the target for the chain. The column ‘RFZ/TFZ’ gives the <italic>Z</italic> scores from the <italic>Phaser</italic> rotation and translation functions for the second copy located. The column ‘<italic>R</italic>
                  <sub>free,i</sub>/<italic>R</italic>
                  <sub>free,f</sub>’ gives the initial and final <italic>R</italic>
                  <sub>free</sub> values from restrained refinement in <italic>REFMAC</italic>. The column ‘CC<sub>i</sub>/CC<sub>f</sub>’ gives the initial and final correlation coefficient for medium <italic>E</italic> values from <italic>ACORN</italic>. The correctness of the solution indicated in the final column is based on comparison with the final structure. See text for a discussion of the results.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead valign="bottom">
        <tr>
          <th rowspan="1" colspan="1" align="left" valign="bottom">Search model</th>
          <th rowspan="1" colspan="1" align="left" char="." charoff="50" valign="bottom">Seq id. (%)</th>
          <th rowspan="1" colspan="1" align="left" char="." charoff="50" valign="bottom">RFZ/TFZ</th>
          <th rowspan="1" colspan="1" align="left" char="." charoff="50" valign="bottom"><italic>R</italic><sub>free,i</sub>/<italic>R</italic><sub>free,f</sub></th>
          <th rowspan="1" colspan="1" align="left" valign="bottom">CC<sub>i</sub>/CC<sub>f</sub></th>
          <th rowspan="1" colspan="1" align="left" valign="bottom">Solution</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">1ogl_A_CHNSAW</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="50" valign="top">38.3</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="50" valign="top">3.3/6.1</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="50" valign="top">0.567/0.586</td>
          <td rowspan="1" colspan="1" align="left" valign="top">—</td>
          <td rowspan="1" colspan="1" align="left" valign="top">No</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">1ogk_A_CHNSAW</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="50" valign="top">37.3</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="50" valign="top">3.3/5.0</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="50" valign="top">0.564/0.572</td>
          <td rowspan="1" colspan="1" align="left" valign="top">—</td>
          <td rowspan="1" colspan="1" align="left" valign="top">No</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">1ogk_B_CHNSAW</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="50" valign="top">38.4</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="50" valign="top">4.9/6.6</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="50" valign="top">0.568/0.516</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.075/0.137</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Yes</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">1ogk_D_CHNSAW</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="50" valign="top">38.3</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="50" valign="top">4.2/10.1</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="50" valign="top">0.562/0.509</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.109/0.174</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Yes</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">1ogk_E_CHNSAW</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="50" valign="top">38.2</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="50" valign="top">4.7/11.6</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="50" valign="top">0.571/0.505</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.078/0.156</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Yes</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-wrap>
