<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3654711</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btt143</article-id>
    <article-id pub-id-type="publisher-id">btt143</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Shrinkage estimation of dispersion in Negative Binomial models for RNA-seq experiments with small sample size</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yu</surname>
          <given-names>Danni</given-names>
        </name>
        <xref ref-type="aff" rid="btt143-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btt143-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huber</surname>
          <given-names>Wolfgang</given-names>
        </name>
        <xref ref-type="aff" rid="btt143-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vitek</surname>
          <given-names>Olga</given-names>
        </name>
        <xref ref-type="aff" rid="btt143-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btt143-AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="btt143-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="btt143-AFF1"><sup>1</sup>Genome Biology Unit, European Molecular Biology Laboratory, Mayerhofstraße 1, Heidelberg 69117, Germany <sup>2</sup>Department of Statistics and <sup>3</sup>Department of Computer Science, Purdue University, West Lafayette, IN 47907, USA</aff>
    <author-notes>
      <corresp id="btt143-COR1">*To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Inanc Birol</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>5</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>4</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>4</month>
      <year>2013</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>29</volume>
    <issue>10</issue>
    <fpage>1275</fpage>
    <lpage>1282</lpage>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>9</month>
        <year>2012</year>
      </date>
      <date date-type="rev-recd">
        <day>24</day>
        <month>2</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>3</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2013. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> RNA-seq experiments produce digital counts of reads that are affected by both biological and technical variation. To distinguish the systematic changes in expression between conditions from noise, the counts are frequently modeled by the Negative Binomial distribution. However, in experiments with small sample size, the per-gene estimates of the dispersion parameter are unreliable.</p>
      <p><bold>Method:</bold> We propose a simple and effective approach for estimating the dispersions. First, we obtain the initial estimates for each gene using the method of moments. Second, the estimates are regularized, i.e. shrunk towards a common value that minimizes the average squared difference between the initial estimates and the shrinkage estimates. The approach does not require extra modeling assumptions, is easy to compute and is compatible with the exact test of differential expression.</p>
      <p><bold>Results:</bold> We evaluated the proposed approach using 10 simulated and experimental datasets and compared its performance with that of currently popular packages edgeR, DESeq, baySeq, BBSeq and SAMseq. For these datasets, sSeq performed favorably for experiments with small sample size in sensitivity, specificity and computational time.</p>
      <p><bold>Availability:</bold><ext-link ext-link-type="uri" xlink:href="http://www.stat.purdue.edu/~ovitek/Software.html">http://www.stat.purdue.edu/∼ovitek/Software.html</ext-link> and Bioconductor.</p>
      <p>
        <bold>Contact:</bold>
        <email>ovitek@purdue.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt143/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Whole transcriptome shotgun sequencing (RNA-seq) technology (<xref ref-type="bibr" rid="btt143-B24">Mardis, 2008</xref>; <xref ref-type="bibr" rid="btt143-B29">Metzker, 2009</xref>; <xref ref-type="bibr" rid="btt143-B46">Wang <italic>et al.</italic>, 2009</xref>) quantifies gene expression in biological samples in counts of transcript reads mapped to the genes. Accurate and comprehensive, it has made a major impact on genomic research (<xref ref-type="bibr" rid="btt143-B13">Garber <italic>et al.</italic>, 2011</xref>; <xref ref-type="bibr" rid="btt143-B30">Oshlack <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="btt143-B32">Pepke <italic>et al.</italic>, 2009</xref>). One common goal of RNA-seq experiments is to detect differentially expressed genes, i.e. genes for which the counts of reads change between conditions more systematically than as expected by random chance (<xref ref-type="bibr" rid="btt143-B30">Oshlack <italic>et al.</italic>, 2010</xref>). Statistical methods for detecting differentially expressed genes must reflect the experimental design and appropriately account for the stochastic variation. Moreover, many RNA-seq experiments serve as high-throughput screens of a small number of samples with the goal of subsequent experimental validation. Therefore, the analysis must handle a relatively small number of biological replicates.</p>
    <p>A variety of statistical methods and software has recently been proposed for detecting differentially expressed genes. These include DESeq (<xref ref-type="bibr" rid="btt143-B1">Anders and Huber, 2010</xref>), edgeR (<xref ref-type="bibr" rid="btt143-B37">Robinson and Smyth, 2007</xref>; <xref ref-type="bibr" rid="btt143-B35">Robinson <italic>et al.</italic>, 2010</xref>), baySeq (<xref ref-type="bibr" rid="btt143-B17">Hardcastle and Kelly, 2010</xref>), SAMseq (<xref ref-type="bibr" rid="btt143-B21">Li and Tibshirani, 2011</xref>), BBSeq(<xref ref-type="bibr" rid="btt143-B49">Zhou <italic>et al.</italic>, 2011</xref>). We briefly overview these methods. We further propose a direct and effective approach for characterizing the variation in the counts of reads, which improves the sensitivity and specificity of detecting differentially expressed genes for experiments with small sample size. We support this approach with an open-source R-based software package sSeq.</p>
  </sec>
  <sec id="SEC2">
    <title>2 BACKGROUND</title>
    <sec id="SEC2.1">
      <title>2.1 The Negative Binomial distribution</title>
      <p>The input to the statistical analysis is a set of discrete counts of reads in each experimental run. Although the counts can be modeled with the one-parameter Poisson or Geometric distributions (<xref ref-type="bibr" rid="btt143-B3">Auer and Doerge, 2011</xref>; <xref ref-type="bibr" rid="btt143-B20">Li <italic>et al.</italic>, 2011</xref>; <xref ref-type="bibr" rid="btt143-B25">Marioni <italic>et al.</italic>, 2008</xref>), it is often advantageous to use the two-parameter Negative Binomial distribution (<xref ref-type="bibr" rid="btt143-B1">Anders and Huber, 2010</xref>; <xref ref-type="bibr" rid="btt143-B17">Hardcastle and Kelly, 2010</xref>; <xref ref-type="bibr" rid="btt143-B37">Robinson and Smyth, 2007</xref>; <xref ref-type="bibr" rid="btt143-B35">Robinson <italic>et al.</italic>, 2010</xref>). This distribution is more general and flexible and can be viewed as a generalization of both Poisson and Geometric distributions (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt143/-/DC1">Supplementary Materials</ext-link>). We focus on the Negative Binomial distribution in what follows.</p>
      <p>Denote <inline-formula><inline-graphic xlink:href="btt143i1.jpg"/></inline-formula> as the random variable that expresses the counts of reads mapped to gene <inline-formula><inline-graphic xlink:href="btt143i2.jpg"/></inline-formula> in sample (or, equivalently, <italic>library</italic>) <inline-formula><inline-graphic xlink:href="btt143i3.jpg"/></inline-formula> in condition <italic>i</italic> and denote <inline-formula><inline-graphic xlink:href="btt143i4.jpg"/></inline-formula> as the observed values. For simplicity, we consider two conditions <inline-formula><inline-graphic xlink:href="btt143i5.jpg"/></inline-formula>; however, the discussion holds for pairwise comparisons of conditions in experiments with more complex designs. We are particularly interested in situations where <inline-formula><inline-graphic xlink:href="btt143i6.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="btt143i7.jpg"/></inline-formula> are small, e.g. 1–4. We consider the following parametrization:
<disp-formula id="btt143-M1"><label>(1)</label><graphic xlink:href="btt143m1"/></disp-formula>
The <italic>dispersion</italic> parameter <inline-formula><inline-graphic xlink:href="btt143i8.jpg"/></inline-formula> determines the extent to which the variance <inline-formula><inline-graphic xlink:href="btt143i9.jpg"/></inline-formula> exceeds the expected value <inline-formula><inline-graphic xlink:href="btt143i10.jpg"/></inline-formula> (<xref ref-type="bibr" rid="btt143-B9">Cameron and Trivedi, 1998</xref>; <xref ref-type="bibr" rid="btt143-B28">McCullagh and Nelder, 1989</xref>).</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Motivation for the proposed approach</title>
      <p>The estimation of <inline-formula><inline-graphic xlink:href="btt143i11.jpg"/></inline-formula> is the main focus of this work and is based on the following considerations.
<list list-type="order"><list-item><p>A naïve approach is to estimate <inline-formula><inline-graphic xlink:href="btt143i12.jpg"/></inline-formula> using the method of moments (i.e. the per-gene sample variance). However, it is highly variable in experiments with a small sample size (<xref ref-type="bibr" rid="btt143-B11">Croarkin and Tobias, 2006</xref>).</p></list-item><list-item><p>RNA-seq experiments simultaneously quantify the expression of many genes. The genes share aspects of biological and technical variation, and therefore a combination of the gene-specific estimates and of consensus estimates can yield better estimates of variation. Such approaches are increasingly popular with RNA-seq experiments (<xref ref-type="bibr" rid="btt143-B1">Anders and Huber, 2010</xref>; <xref ref-type="bibr" rid="btt143-B37">Robinson and Smyth, 2007</xref>).</p></list-item><list-item><p>The variance of the Negative Binomial distribution is a known function of the expected value <inline-formula><inline-graphic xlink:href="btt143i13.jpg"/></inline-formula> and of the dispersion <inline-formula><inline-graphic xlink:href="btt143i14.jpg"/></inline-formula>. Therefore, an accurate estimation of the dispersion (e.g. by combining the gene-specific and consensus estimates, without explicitly modeling its relationship to <inline-formula><inline-graphic xlink:href="btt143i16.jpg"/></inline-formula>) can lead to an accurate estimation of the variance while preserving the mean–variance relationship.</p></list-item><list-item><p>Finally, constraints of throughput sample availability or cost may restrict the number of biological replicates. Although experiments with little or no biological replication have poor reproducibility and are undesirable, such under-replicated screens are the only practical option in some situations (<xref ref-type="bibr" rid="btt143-B23">Malo <italic>et al.</italic>, 2006</xref>; <xref ref-type="bibr" rid="btt143-B26">Markowetz, 2010</xref>). They can only detect large changes in expression and require an extensive downstream validation with complementary low-throughput experiments and large sample size. To detect differentially expressed genes, we assume that the majority of the genes are not differentially expressed, and that for these genes, the samples from all conditions can be viewed as biological replicates (<xref ref-type="bibr" rid="btt143-B36">Robinson and Oshlack, 2010</xref>; <xref ref-type="bibr" rid="btt143-B35">Robinson <italic>et al.</italic>, 2010</xref>). Under this assumption, a consensus estimate of dispersion helps to improve the accuracy of gene-specific estimates of variation.</p></list-item></list>
Our main concern is in how to (i) accurately define the consensus estimate of dispersion and (ii) accurately combine the gene-specific estimates of dispersion with the consensus estimate.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Existing approaches for RNA-seq experiments</title>
      <p>Among the existing methods, edgeR (<xref ref-type="bibr" rid="btt143-B37">Robinson and Smyth, 2007</xref>; <xref ref-type="bibr" rid="btt143-B35">Robinson <italic>et al.</italic>, 2010</xref>), DESeq (<xref ref-type="bibr" rid="btt143-B1">Anders and Huber, 2010</xref>) and baySeq (<xref ref-type="bibr" rid="btt143-B17">Hardcastle and Kelly, 2010</xref>) assume the Negative Binomial distribution, and SAMseq (<xref ref-type="bibr" rid="btt143-B21">Li and Tibshirani, 2011</xref>) and BBSeq (<xref ref-type="bibr" rid="btt143-B49">Zhou <italic>et al.</italic>, 2011</xref>) use other flexible models. The approaches have been extensively evaluated (<xref ref-type="bibr" rid="btt143-B50">Soneson and Delorenzi, 2013</xref>) and are broadly used. <xref ref-type="bibr" rid="btt143-B17">Hardcastle and Kelly (2010)</xref> found that the performance of DESeq, edgeR and baySeq is superior to that of DEGseq (<xref ref-type="bibr" rid="btt143-B45">Wang <italic>et al.</italic>, 2010</xref>), <xref ref-type="bibr" rid="btt143-B21">Li and Tibshirani (2011)</xref> found that SAMseq improves on PoissonSeq (<xref ref-type="bibr" rid="btt143-B20">Li <italic>et al.</italic>, 2011</xref>). We briefly overview these approaches in the historical order. <xref ref-type="table" rid="btt143-T1">Table 1</xref> summarizes the discussion.
<table-wrap id="btt143-T1" position="float"><label>Table 1.</label><caption><p>Existing and proposed approaches for differential analysis of RNA-seq experiments with two conditions</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Probability model</th><th rowspan="1" colspan="1">Estimation of dispersion</th><th rowspan="1" colspan="1">Testing</th><th rowspan="1" colspan="1"><italic>n</italic> = 1</th><th rowspan="1" colspan="1">Time</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">(a) sSeq (proposed) (this manuscript)</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i17.jpg"/></inline-formula></td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i18.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="btt143i19.jpg"/></inline-formula> is a common dispersion and <inline-formula><inline-graphic xlink:href="btt143i20.jpg"/></inline-formula> is a weight</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i21.jpg"/></inline-formula> Exact test</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">min</td></tr><tr><td rowspan="1" colspan="1">(b) edgeR (Robinson and Smyth, 2008)</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i22.jpg"/></inline-formula></td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i23.jpg"/></inline-formula> maximize linear combination of per-gene and common-dispersion conditional likelihoods</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i24.jpg"/></inline-formula> Exact or GLM-based test</td><td rowspan="1" colspan="1">Yes*</td><td rowspan="1" colspan="1">min</td></tr><tr><td rowspan="1" colspan="1">(c) DESeq (<xref ref-type="bibr" rid="btt143-B1">Anders and Huber, 2010</xref>)</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i25.jpg"/></inline-formula></td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i26.jpg"/></inline-formula><inline-formula><inline-graphic xlink:href="btt143i27.jpg"/></inline-formula> is estimated as function of the mean</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i28.jpg"/></inline-formula> Exact or GLM-based test</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">min</td></tr><tr><td rowspan="1" colspan="1">(d) baySeq (<xref ref-type="bibr" rid="btt143-B17">Hardcastle and Kelly, 2010</xref>)</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i29.jpg"/></inline-formula> Empirical priors on sets of parameters</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i30.jpg"/></inline-formula> maximize per-gene integrated quasi-likelihood</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i31.jpg"/></inline-formula> Posterior probability cutoff</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">h</td></tr><tr><td rowspan="1" colspan="1">(e) BBSeq (<xref ref-type="bibr" rid="btt143-B49">Zhou <italic>et al.</italic>, 2011</xref>)</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i32.jpg"/></inline-formula><inline-formula><inline-graphic xlink:href="btt143i35.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="btt143i36.jpg"/></inline-formula></td><td rowspan="3" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i33.jpg"/></inline-formula> maximize per-gene marginal likelihood; is a free parameter or a function of the mean</td><td rowspan="3" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i34.jpg"/></inline-formula> Wald test</td><td rowspan="3" colspan="1">Yes</td><td rowspan="3" colspan="1">h</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">(f) SAMseq (<xref ref-type="bibr" rid="btt143-B20">Li and Tibshirani, 2011</xref>)</td><td rowspan="1" colspan="1">Non-parametric</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i37.jpg"/></inline-formula>: same distributions A and B Wilcoxon test &amp; resampling</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">min</td></tr></tbody></table><table-wrap-foot><fn id="btt143-TF1"><p>(a) <inline-formula><inline-graphic xlink:href="btt143i38.jpg"/></inline-formula> is the size factor for sample <italic>j</italic> in condition <italic>i</italic> as defined in (<xref ref-type="bibr" rid="btt143-B1">Anders and Huber, 2010</xref>). <inline-formula><inline-graphic xlink:href="btt143i39.jpg"/></inline-formula> is the expected normalized expression of gene <italic>g</italic> for a sample in condition <italic>i</italic>. <inline-formula><inline-graphic xlink:href="btt143i40.jpg"/></inline-formula> is the per-gene dispersion estimate using the method of moments in <xref ref-type="disp-formula" rid="btt143-M6">Equation (6)</xref>.</p><p>(b) <inline-formula><inline-graphic xlink:href="btt143i41.jpg"/></inline-formula> is the ‘effective’ library size. <inline-formula><inline-graphic xlink:href="btt143i42.jpg"/></inline-formula> is the probability that a read in <italic>i</italic> maps to gene <italic>g</italic>. *Up to v2.4.6.</p><p>(c) <inline-formula><inline-graphic xlink:href="btt143i43.jpg"/></inline-formula> is gene- and condition-specific dispersion. <inline-formula><inline-graphic xlink:href="btt143i44.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="btt143i45.jpg"/></inline-formula> can be estimated by the method of moments or by the Cox-Reid corrected Maximum Likelihood.</p><p>(d) <inline-formula><inline-graphic xlink:href="btt143i46.jpg"/></inline-formula> is the size of the library <italic>i</italic> from condition <italic>j</italic>. <inline-formula><inline-graphic xlink:href="btt143i47.jpg"/></inline-formula> is as in (b).</p><p>(e) <inline-formula><inline-graphic xlink:href="btt143i48.jpg"/></inline-formula> is as in (b). <inline-formula><inline-graphic xlink:href="btt143i49.jpg"/></inline-formula> is as in (d). <inline-formula><inline-graphic xlink:href="btt143i50.jpg"/></inline-formula> is the coefficient of the linear predictor associated with an indicator <italic>Z</italic> of conditions. Column ‘Time’ is the run time for the experimental datasets in <xref ref-type="sec" rid="SEC4">Section 4</xref> on a laptop computer.</p></fn></table-wrap-foot></table-wrap></p>
      <p><bold>Probability model.</bold><italic>edgeR</italic> models the count of reads with the Negative Binomial distribution. It includes normalization, which accounts for the changes in read counts owing to technical artifacts such as different sequencing depth. The normalization factor can be the total library size (i.e. the number of reads in the library). A more accurate normalization factor is the ‘effective’ library size <inline-formula><inline-graphic xlink:href="btt143i51.jpg"/></inline-formula>, which multiplies the size of the library <italic>ij</italic> by a robust estimate of the log-fold change of the total count in condition <italic>i</italic> as compared with a reference run (<xref ref-type="bibr" rid="btt143-B36">Robinson and Oshlack, 2010</xref>). The parameter <inline-formula><inline-graphic xlink:href="btt143i52.jpg"/></inline-formula> in row (b) of <xref ref-type="table" rid="btt143-T1">Table 1</xref> is the probability that a single read maps to gene <italic>g</italic> for a sample in condition <italic>i</italic>. The model assumes that the dispersion parameter is gene specific but constant across conditions. For experiments without replication versions up to 2.4.6 assumed a common dispersion in all the genes. The subsequent versions discourage unreplicated experiments. Finally, generalized linear models for the Negative Binomial response are available.</p>
      <p><italic>DESeq</italic> also models the count of reads with the Negative Binomial distribution. It normalizes the read counts by a size factor <inline-formula><inline-graphic xlink:href="btt143i53.jpg"/></inline-formula> (<xref ref-type="bibr" rid="btt143-B1">Anders and Huber, 2010</xref>).
<disp-formula id="btt143-M2"><label>(2)</label><graphic xlink:href="btt143m2"/></disp-formula>
The size factor can be thought of as the ‘representative’ ratio of counts in the library to the geometric mean of the counts in all the libraries, and differs from the ‘effective’ library size in edgeR. The parameter <inline-formula><inline-graphic xlink:href="btt143i54.jpg"/></inline-formula> in row (c) of <xref ref-type="table" rid="btt143-T1">Table 1</xref> is the expected normalized expression of gene <italic>g</italic> in condition <italic>i</italic>. DESeq allows specification of separate variances for genes and conditions and models the variances as functions of the expected values. This relationship can be a flexible smooth function (local polynomial) or a parabolic function <inline-formula><inline-graphic xlink:href="btt143i55.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="btt143i56.jpg"/></inline-formula> are constants. Alternatives based on generalized linear models for the Negative Binomial response are also available.</p>
      <p>The <italic>baySeq</italic> specifies the same probability model as edgeR; however, it proposes a different Empirical Bayes characterization of the between-library variation. The baySeq assumes that subsets of the libraries share the parameters of Negative Binomial distribution and derives an empirical prior distribution for the corresponding parameter sets. After integrating over the empirical priors, the dispersion in the integrated likelihood is constant across conditions and different between the genes. The default normalization parameter is the library size.</p>
      <p><italic>BBSeq</italic> specifies a Beta-Binomial generalized linear model. Using the logit link, it connects the expected probability of a read for gene <italic>g</italic> in condition <italic>i</italic> and sample <italic>j</italic> to the linear combinations of predictors, such as indicators of conditions and other covariates. The dispersion parameter can be independent from the mean (free model) or dependent on the mean (constrained model). <italic>SAMseq</italic> uses a fully non-parametric approach.</p>
      <p><bold>Estimation of dispersion.</bold><italic>edgeR</italic> maximizes a weighted combination of the conditional log-likelihoods with per-gene dispersion and of the conditional log-likelihood with common dispersion. Conditional likelihoods generalize the restricted maximum likelihood estimation for a discrete response by conditioning on the sum of the read counts per class and improve the statistical properties of dispersion estimates. The estimation requires calculating pseudocounts of reads that would have been obtained with libraries of equal size and an iterative computational optimization. For experiments with few replicates, the estimates tend to be discrete values (<xref ref-type="bibr" rid="btt143-B22">Lloyd-Smith, 2007</xref>; <xref ref-type="bibr" rid="btt143-B33">Piegorsch, 1990</xref>; <xref ref-type="bibr" rid="btt143-B43">Toft <italic>et al.</italic>, 2006</xref>). For experiments with many replicates, edgeR specifies a generalized linear model. As conditional likelihoods cannot be easily extended to this case, these are further approximated by adjusted profile likelihoods (<xref ref-type="bibr" rid="btt143-B27">McCarthy <italic>et al.</italic>, 2012</xref>).</p>
      <p><italic>DESeq</italic> starts by estimating per-gene means and variances of the normalized counts in each gene and condition by the methods of moments. Next, it re-estimates them by fitting the postulated relationship between the expected values and the variances. The estimates of dispersion can be back-calculated from the estimates of variance as shown in row (c) of <xref ref-type="table" rid="btt143-T1">Table 1</xref>. For experiments without replication, DESeq assumes that the majority of the genes are not differentially expressed, and combines the samples across conditions to estimate the variance. The same strategy is used with the generalized linear models.</p>
      <p>The <italic>baySeq</italic> relies on an iterative estimation of the relative gene expression and of the dispersion. Given an initial partition of the libraries into subsets and an initial estimate of the relative gene expression, it estimates the dispersion using the quasi-likelihood approach. Given the estimates of dispersion, it re-estimates the relative gene expression by maximizing the integrated likelihood. This is repeated for different partitions of the libraries.</p>
      <p><italic>BBSeq</italic> estimates the dispersion using maximum likelihood for the free model. For the constrained model, it uses the estimates from the free model for all the genes, fits the postulated relationship to the mean and re-estimates the dispersions. <italic>SAMseq</italic> sidesteps the need to estimate the dispersion by using a fully non-parametric approach.</p>
      <p><bold>Testing.</bold> For the Negative Binomial model, <italic>edgeR</italic> tests the null hypothesis <inline-formula><inline-graphic xlink:href="btt143i57.jpg"/></inline-formula>, and <italic>DESeq</italic>
<inline-formula><inline-graphic xlink:href="btt143i58.jpg"/></inline-formula> separately for each gene. Both edgeR and DESeq use the exact test, which is free from asymptotic arguments and is therefore preferred. The test statistic for a gene is the total (normalized) count of reads in all the replicates of a condition. The <italic>P</italic>-value is the probability of the normalized read counts per group such that under <inline-formula><inline-graphic xlink:href="btt143i59.jpg"/></inline-formula> their probability is same or lower than the probability of the observed counts, conditional on the total counts equal to the observed. With the generalized linear models, edgeR and DESeq use the asymptotic likelihood ratio or Wald tests.</p>
      <p><italic>baySeq</italic> ranks the genes by their posterior probabilities of differential expression. <italic>BBSeq</italic> tests the coefficient of the linear predictor (i.e. condition) in the generalized linear model with the asymptotic Wald test. <italic>SAMseq</italic> uses a resampling strategy to estimate the distribution of the test statistic and the <italic>P</italic>-values.</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 METHODS</title>
    <p>The proposed approach combines aspects of the existing approaches, but is simpler, requires fewer assumptions and streamlines the computation. It is summarized in <xref ref-type="table" rid="btt143-T1">Table 1</xref>a. More details regarding the method and its implementation in <italic>sSeq</italic> are in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt143/-/DC1">Supplementary Materials</ext-link>.</p>
    <p><bold>Probability model.</bold> The model for the counts <inline-formula><inline-graphic xlink:href="btt143i60.jpg"/></inline-formula> of gene <inline-formula><inline-graphic xlink:href="btt143i61.jpg"/></inline-formula>, replicate <inline-formula><inline-graphic xlink:href="btt143i62.jpg"/></inline-formula> and condition <inline-formula><inline-graphic xlink:href="btt143i63.jpg"/></inline-formula> is
<disp-formula id="btt143-M3"><label>(3)</label><graphic xlink:href="btt143m3"/></disp-formula>
<disp-formula id="btt143-M4"><label>(4)</label><graphic xlink:href="btt143m4"/></disp-formula>
We follow edgeR, DESeq and baySeq by specifying a Negative Binomial distribution. As in experiments with a small sample size, it may be difficult to distinguish the true dependency of dispersions on expected values from artifacts of random variation, the model specifies free gene-specific dispersion parameters <inline-formula><inline-graphic xlink:href="btt143i64.jpg"/></inline-formula>. As the initial versions of edgeR, we specify a common dispersion across conditions, i.e. <inline-formula><inline-graphic xlink:href="btt143i65.jpg"/></inline-formula>. As a consequence, the counts of differentially expressed genes have different variances in each condition.</p>
    <p>We follow DESeq in normalizing the counts by the size factor <inline-formula><inline-graphic xlink:href="btt143i66.jpg"/></inline-formula>. However, in the proposed normalization, the size factor affects not only the expected value but also the dispersion. <xref ref-type="disp-formula" rid="btt143-M4">Equation (4)</xref> shows that under this assumption the size factor linearly scales both <inline-formula><inline-graphic xlink:href="btt143i67.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="btt143i68.jpg"/></inline-formula>. Such linear scaling is consistent with the technical variation in RNA-seq experiments, which can be characterized by the Poisson distribution (<xref ref-type="bibr" rid="btt143-B25">Marioni <italic>et al.</italic>, 2008</xref>). As typical size factors are close to 1, the proposed model has little practical difference from the model in DESeq. However, as shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt143/-/DC1">Supplementary Section 2</ext-link>, it allows us to directly conduct the exact test and contributes to the accuracy of the results.</p>
    <p><bold>Estimation of dispersion.</bold> Similarly to DESeq, we start by estimating the dispersion parameters by the methods of moments. A conservative estimate of the per-gene variance in experiments with a small sample size is obtained by pooling the samples across conditions, i.e. 
<disp-formula id="btt143-M5"><label>(5)</label><graphic xlink:href="btt143m5"/></disp-formula>
and <inline-formula><inline-graphic xlink:href="btt143i69.jpg"/></inline-formula>. The estimate of dispersion <inline-formula><inline-graphic xlink:href="btt143i70.jpg"/></inline-formula> is then calculated from <xref ref-type="disp-formula" rid="btt143-M1">Equation (1)</xref>, and negative values are truncated at zero
<disp-formula id="btt143-M6"><label>(6)</label><graphic xlink:href="btt143m6"/></disp-formula>
Unfortunately, in experiments with small sample size, <inline-formula><inline-graphic xlink:href="btt143i71.jpg"/></inline-formula> are unsatisfactory owing to high variance (<xref ref-type="bibr" rid="btt143-B6">Bowman, 1984</xref>; <xref ref-type="bibr" rid="btt143-B10">Clark and Perry, 1989</xref>; <xref ref-type="bibr" rid="btt143-B47">Willson et al., 1984</xref>). Next, we improve the statistical properties of these estimates by introducing shrinkage.</p>
    <p><xref ref-type="bibr" rid="btt143-B41">Stein (1956)</xref> showed that when we estimate the expected values of three or more independent Normal random variables with known constant variance, shrinking the per-dimension estimates toward a target value <inline-formula><inline-graphic xlink:href="btt143i72.jpg"/></inline-formula> produces biased estimates, but reduces the mean squared error (MSE) for all choices of <inline-formula><inline-graphic xlink:href="btt143i73.jpg"/></inline-formula>. The shrinkage estimator by <xref ref-type="bibr" rid="btt143-B18">James and Stein (1961)</xref> (<xref ref-type="bibr" rid="btt143-B19">Lehmann and Casella, 1998</xref>; <xref ref-type="bibr" rid="btt143-B34">Richards, 1999</xref>) implements this strategy. More recently, Hansen extended the approach of James and Stein with a generalized shrinkage estimator, (<xref ref-type="bibr" rid="btt143-B16">Hansen, 2008</xref>). Hansen’s shrinkage can be used with any per-dimension estimator with an arbitrary sampling distribution (not necessarily Normal), for which the Central Limit Theorem holds. Specifically, it requires that the true parameter lies in a neighborhood of the restricted parameter space, and that the estimator is asymptotically Normal with a consistent variance. Estimators by the method of moments satisfy these criteria. Applied to the estimation of <inline-formula><inline-graphic xlink:href="btt143i74.jpg"/></inline-formula>, and assuming that the per-gene estimates are independent, the generalized shrinkage estimator is
<disp-formula id="btt143-M7"><label>(7)</label><graphic xlink:href="btt143m7"/></disp-formula>
<inline-formula><inline-graphic xlink:href="btt143i75.jpg"/></inline-formula> is a linear combination of the pre-defined target <inline-formula><inline-graphic xlink:href="btt143i76.jpg"/></inline-formula> and of the per-gene methods of moment estimates. The weight <inline-formula><inline-graphic xlink:href="btt143i77.jpg"/></inline-formula> is defined as
<disp-formula id="btt143-M8"><label>(8)</label><graphic xlink:href="btt143m8"/></disp-formula>
As <inline-formula><inline-graphic xlink:href="btt143i78.jpg"/></inline-formula>, the weight <inline-formula><inline-graphic xlink:href="btt143i79.jpg"/></inline-formula>. Larger values of <inline-formula><inline-graphic xlink:href="btt143i80.jpg"/></inline-formula> shrink the estimates closer to the pre-defined target <inline-formula><inline-graphic xlink:href="btt143i81.jpg"/></inline-formula>.</p>
    <p>We use the Hansen’s generalized shrinkage estimator <inline-formula><inline-graphic xlink:href="btt143i82.jpg"/></inline-formula> in conjunction with the Negative Binomial distribution to test genes for differential expression. Although the assumption of <inline-formula><inline-graphic xlink:href="btt143i83.jpg"/></inline-formula> being independent variables is simplistic, it is a suitable approximation for experiments with a small sample size. A similar assumption is made, e.g. by DESeq when modeling the variance as function of the mean. Although the asymptotic argument cannot be justified in this context, we show empirically in <xref ref-type="sec" rid="SEC5">Section 5</xref> that <inline-formula><inline-graphic xlink:href="btt143i84.jpg"/></inline-formula> performs well in practice.</p>
    <p>Hansen showed that the estimator in <xref ref-type="disp-formula" rid="btt143-M7">Equations (7)</xref> and <xref ref-type="disp-formula" rid="btt143-M8">(8)</xref> reduces the asymptotic MSE for all choices of targets <inline-formula><inline-graphic xlink:href="btt143i85.jpg"/></inline-formula>. However, a good practice is to select a value for <inline-formula><inline-graphic xlink:href="btt143i86.jpg"/></inline-formula> that maximizes this reduction. To this end, we approximate the <inline-formula><inline-graphic xlink:href="btt143i87.jpg"/></inline-formula> using the average squared difference (ASD) between <inline-formula><inline-graphic xlink:href="btt143i88.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="btt143i89.jpg"/></inline-formula>
<disp-formula id="btt143-M9"><label>(9)</label><graphic xlink:href="btt143m9"/></disp-formula>
<xref ref-type="disp-formula" rid="btt143-M9">Equation (9)</xref> substitutes <inline-formula><inline-graphic xlink:href="btt143i90.jpg"/></inline-formula> with <inline-formula><inline-graphic xlink:href="btt143i91.jpg"/></inline-formula> and divides MSE by the constant <italic>G</italic> for numeric stability. It is shown that
<disp-formula id="btt143-M10"><label>(10)</label><graphic xlink:href="btt143m10"/></disp-formula>
<xref ref-type="fig" rid="btt143-F1">Figure 1</xref>a visualizes the functional form of <inline-formula><inline-graphic xlink:href="btt143i103.jpg"/></inline-formula> for a simulation in <xref ref-type="sec" rid="SEC4">Section 4</xref> and shows that the tail of the curve flattens for large <inline-formula><inline-graphic xlink:href="btt143i104.jpg"/></inline-formula>. Therefore, we can also minimize the bias by minimizing <inline-formula><inline-graphic xlink:href="btt143i105.jpg"/></inline-formula> while enforcing the constraint that <inline-formula><inline-graphic xlink:href="btt143i106.jpg"/></inline-formula> is comparably small. In practice, <inline-formula><inline-graphic xlink:href="btt143i107.jpg"/></inline-formula> estimates <inline-formula><inline-graphic xlink:href="btt143i108.jpg"/></inline-formula> by calculating the slope of <inline-formula><inline-graphic xlink:href="btt143i109.jpg"/></inline-formula> and setting
<disp-formula id="btt143-M11"><label>(11)</label><graphic xlink:href="btt143m11"/></disp-formula>
for a small constant <inline-formula><inline-graphic xlink:href="btt143i110.jpg"/></inline-formula> such as <inline-formula><inline-graphic xlink:href="btt143i111.jpg"/></inline-formula>. The selected value is shown by the vertical line in <xref ref-type="fig" rid="btt143-F1">Figure 1</xref>a.
<fig id="btt143-F1" position="float"><label>Fig. 1.</label><caption><p>Dispersion and variance estimation in Simulation1. Similar plots for other datasets are shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt143/-/DC1">Supplementary Materials</ext-link>. (<bold>a</bold>) ASD versus shrinkage target <inline-formula><inline-graphic xlink:href="btt143i93.jpg"/></inline-formula>. ASD is maximized at <inline-formula><inline-graphic xlink:href="btt143i94.jpg"/></inline-formula> (solid horizontal line). The dashed lines are the selected target <inline-formula><inline-graphic xlink:href="btt143i95.jpg"/></inline-formula> and its ASD. (<bold>b</bold>) The proposed shrinkage estimator is a linear transformation of <inline-formula><inline-graphic xlink:href="btt143i96.jpg"/></inline-formula>, with the slope <inline-formula><inline-graphic xlink:href="btt143i97.jpg"/></inline-formula> and the fixed point <inline-formula><inline-graphic xlink:href="btt143i98.jpg"/></inline-formula>. All <inline-formula><inline-graphic xlink:href="btt143i99.jpg"/></inline-formula> are transformed to <inline-formula><inline-graphic xlink:href="btt143i100.jpg"/></inline-formula>. (<bold>c</bold>, <bold>e</bold> and <bold>g</bold>) Dispersion estimates by sSeq, edgeR and DESeq versus the per-gene mean read counts across conditions. Gray smooth scatter are <inline-formula><inline-graphic xlink:href="btt143i101.jpg"/></inline-formula> (same on all the plots). Black dots are <inline-formula><inline-graphic xlink:href="btt143i102.jpg"/></inline-formula> estimated by each method. Gray lines indicate the true dispersion parameters. (<bold>d</bold>, <bold>f</bold> and <bold>h</bold>) Same as above, but for the variances of the read counts</p></caption><graphic xlink:href="btt143f1p"/></fig></p>
    <p><xref ref-type="fig" rid="btt143-F1">Figure 1</xref>b illustrates the fact that the proposed shrinkage estimator is a linear transformation of <inline-formula><inline-graphic xlink:href="btt143i112.jpg"/></inline-formula>. The slope of the transformation is <inline-formula><inline-graphic xlink:href="btt143i113.jpg"/></inline-formula>, and the fixed point is the shrinkage target <inline-formula><inline-graphic xlink:href="btt143i114.jpg"/></inline-formula>. The shrinkage increases the per-gene estimates of dispersion that are smaller than <inline-formula><inline-graphic xlink:href="btt143i115.jpg"/></inline-formula> and decreases the values that are larger than <inline-formula><inline-graphic xlink:href="btt143i116.jpg"/></inline-formula>. From our experience with multiple datasets, <inline-formula><inline-graphic xlink:href="btt143i117.jpg"/></inline-formula> is often around the 95.5th quantile of <inline-formula><inline-graphic xlink:href="btt143i118.jpg"/></inline-formula>. In other words, it biases the majority of the estimates towards conservative values.</p>
    <p>The proposed estimate of dispersion has analogies in methods developed for other high-throughput technologies. For example, it is similar in spirit to the moderated variance estimator in the package Limma (<xref ref-type="bibr" rid="btt143-B39">Smyth, 2004</xref>, <xref ref-type="bibr" rid="btt143-B40">2005</xref>), which is also a linear combination of per-gene and consensus estimates.</p>
    <p><bold>Testing.</bold> We follow edgeR and DESeq by testing <inline-formula><inline-graphic xlink:href="btt143i119.jpg"/></inline-formula> per gene with the exact test. The test statistic is <inline-formula><inline-graphic xlink:href="btt143i120.jpg"/></inline-formula>, i.e. the sum of the read counts in each condition. Under <inline-formula><inline-graphic xlink:href="btt143i121.jpg"/></inline-formula>, the <italic>P</italic>-values are calculated with respect to the reference distribution <inline-formula><inline-graphic xlink:href="btt143i122.jpg"/></inline-formula> and are adjusted to control the false discovery rate (FDR) (<xref ref-type="bibr" rid="btt143-B4">Benjamini and Hochberg, 1995</xref>). See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt143/-/DC1">Supplementary Materials</ext-link> for more details.</p>
    <p><bold>Extensions to experiments with complex designs.</bold> The proposed approach can be extended to pairwise comparisons of conditions in experiments with more complex designs without recurring to a generalized linear model and without additional assumptions. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt143/-/DC1">Supplementary Materials</ext-link> for details.</p>
  </sec>
  <sec id="SEC4">
    <title>4 DATASETS</title>
    <p>We evaluated the proposed approach using 10 simulated and experimental datasets. The first five datasets had an external ‘gold standard’ of differential expression, and the last two had experimental designs more complex than a two-group comparison. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt143/-/DC1">Supplementary Materials</ext-link> for more details.</p>
    <p>Simulation1, Simulation2 and Simulation3 each generated <inline-formula><inline-graphic xlink:href="btt143i123.jpg"/></inline-formula> genes in conditions <italic>A</italic> and <italic>B</italic>, <inline-formula><inline-graphic xlink:href="btt143i124.jpg"/></inline-formula>. Thirty percent of the genes were simulated as differentially expressed. Size factors were sampled from the Uniform distribution <inline-formula><inline-graphic xlink:href="btt143i125.jpg"/></inline-formula>.</p>
    <p>Simulation1 assumed a constant dispersion parameter across all genes and is favorable to sSeq. Simulation2 assumed that <inline-formula><inline-graphic xlink:href="btt143i126.jpg"/></inline-formula> is a non-linear function of <inline-formula><inline-graphic xlink:href="btt143i127.jpg"/></inline-formula>, i.e. <inline-formula><inline-graphic xlink:href="btt143i128.jpg"/></inline-formula> and as such is favorable to DESeq. Simulation3 is most realistic. From the dataset by <xref ref-type="bibr" rid="btt143-B5">Bottomly <italic>et al.</italic> (2011)</xref> (<xref ref-type="bibr" rid="btt143-B12">Frazee <italic>et al.</italic>, 2011</xref>), the largest experimental dataset in this manuscript, we selected a subset of non-differentially expressed genes (as determined by a consensus of sSeq, edgeR and DESeq) and sampled pairs <inline-formula><inline-graphic xlink:href="btt143i129.jpg"/></inline-formula> from this subset as the true parameters for simulating read counts.</p>
    <p>MAQC (<xref ref-type="bibr" rid="btt143-B38">Shi <italic>et al.</italic>, 2006</xref>) is the dataset from the MicroArray Quality Control (MAQC) consortium, comparing three libraries from Ambion human brain reference RNA against two libraries from Stratagene human universal reference RNA. The libraries were sequenced with the Illumina platform, resulting in 19 580 genes. A subset of the genes from four of the libraries was assayed by real-time reverse-transcription PCR (<xref ref-type="bibr" rid="btt143-B38">Shi <italic>et al.</italic>, 2006</xref>; <xref ref-type="bibr" rid="btt143-B48">Zhining <italic>et al.</italic>, 2010</xref>). We used the 323 differential genes and 85 non-differentially expressed genes determined by real-time reverse-transcription PCR as the ‘gold standard’. Although the dataset only has technical replicates, it has been used extensively as the benchmark in the past (<xref ref-type="bibr" rid="btt143-B2">Arikawa <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="btt143-B8">Bullard <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="btt143-B31">Patterson <italic>et al.</italic>, 2006</xref>).</p>
    <p><xref ref-type="bibr" rid="btt143-B14">Griffith <italic>et al.</italic> (2010)</xref> compared fluorouracil (5-FU)-resistant human colorectal cancer cell lines MIP101 against their non-resistant counterpart MIP/5-FU24. One library from each condition was quantified with the paired-end Illumina platform, resulting in 27 145 genes. In all, 197 of these genes from the same samples were assayed by quantitative PCR. We used 12 truly differential genes and 19 truly non-differentially expressed genes as determined by quantitative PCR as the ‘gold standard’ for method comparison.</p>
    <p><xref ref-type="bibr" rid="btt143-B7">Brooks <italic>et al.</italic> (2011)</xref> compared untreated cells of <italic>Drosophila melanogaster</italic> against cells cultured in presence of Pasilla, the homologue of the mammalian Nova-1 and Nova-2 protein. Two biological samples per condition were sequenced with the paired-end Illumina platform, resulting in 14 470 genes.</p>
    <p><xref ref-type="bibr" rid="btt143-B42">Sultan <italic>et al.</italic> (2008)</xref> (<xref ref-type="bibr" rid="btt143-B12">Frazee <italic>et al.</italic>, 2011</xref>) compared two biological replicates of human cell lines Ramos B and HEK293T with the Illumina platform, yielding 6 573 643 uniquely aligned reads.</p>
    <p><xref ref-type="bibr" rid="btt143-B5">Bottomly <italic>et al.</italic> (2011)</xref> (<xref ref-type="bibr" rid="btt143-B12">Frazee <italic>et al.</italic>, 2011</xref>) compared brain tissues of two inbred mouse strains, C57BL/6J (B6) and DBA/2J (D2), using the Illumina platform. The analysis of 10 and 11 biological samples per condition resulted in 13 932 genes.</p>
    <p><xref ref-type="bibr" rid="btt143-B15">Hammer <italic>et al.</italic> (2010)</xref> (<xref ref-type="bibr" rid="btt143-B12">Frazee <italic>et al.</italic>, 2011</xref>) compared gene expression in rat strains Sprague Dawley and L5 SNL Sprague Dawley 2, at two times (2 weeks and 2 months) in a factorial design. Two distinct biological libraries per condition and per time slot were quantified using the Illumina platform, resulting in 18 635 genes.</p>
    <p><xref ref-type="bibr" rid="btt143-B44">Tuch <italic>et al.</italic> (2010)</xref> compared the expression of genes in normal human tissues and in tissues with oral squamous cell carcinoma. The experiment compared pairs of normal and tumor samples from three patients. The six libraries were sequenced using the SOLiD platform, resulting in 10 453 genes.</p>
  </sec>
  <sec id="SEC5">
    <title>5 RESULTS</title>
    <p>In addition to sSeq, the following versions of the existing packages were used: edgeR v3.0.8 (January 2013), DESeq v1.10.1 (October 2012), baySeq v1.12.0 (October 2012), BBSeq v1.0 (March 2011), SAMSeq as part of the R package samr v2.0 (June 2011).</p>
    <p>For sSeq, all the datasets were analyzed with the exact test, and analyses of the Hammer and the Tuch datasets accounted for their experimental designs. For edgeR and DESeq, the datasets with two-group comparisons were analyzed with the exact test, and Hammer and Tuch datasets were analyzed with the glm-based approaches. For edgeR, the estimateCommonDisp function in an older version of edgeR package (v2.4.6) was used to analyze unreplicated datasets. For DESeq, the option fitType=‘local’ was used to estimate the per-group variance. The default parameters were used otherwise. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt143/-/DC1">Supplementary Materials</ext-link> for details and representative R scripts.</p>
    <sec id="SEC5.1">
      <title>5.1 sSeq accurately estimates the variation</title>
      <p>As the proposed approach shares most similarities with edgeR and DESeq, we compared their estimates of dispersions and variances in more details. <xref ref-type="fig" rid="btt143-F1">Figure 1</xref>c, e and g use the simplest case of Simulation1 to illustrate the estimates by the method of moments and by the three approaches. As expected, <inline-formula><inline-graphic xlink:href="btt143i130.jpg"/></inline-formula> have a high variance, which increases with the mean. Also as expected, estimates by <inline-formula><inline-graphic xlink:href="btt143i131.jpg"/></inline-formula> are biased towards larger values but have smaller deviations from the true values as compared to <inline-formula><inline-graphic xlink:href="btt143i132.jpg"/></inline-formula>. Estimates by the other two methods fit the pattern of <inline-formula><inline-graphic xlink:href="btt143i133.jpg"/></inline-formula>.</p>
      <p><xref ref-type="fig" rid="btt143-F1">Figure 1</xref>d, f and h show that despite the differences in dispersion estimation, the estimates of variance by the three methods are less different. This is due to the fact that the values of the dispersions are small as compared with the means, and that the variances in <xref ref-type="disp-formula" rid="btt143-M1">Equation (1)</xref> are highly influenced by the expected values. As a result, the bias in the estimation of the dispersion has a low impact on the overall estimation of variation. <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt143/-/DC1">Supplementary Materials</ext-link> provide plots for the other datasets.</p>
      <p>The first two columns of <xref ref-type="table" rid="btt143-T2">Table 2</xref> show that the bias also has little impact on the performance of detecting differentially expressed genes, as the performance of sSeq, edgeR and DESeq are relatively similar. sSeq has a slightly higher area under the ROC curves.
<table-wrap id="btt143-T2" position="float"><label>Table 2.</label><caption><p>Areas under the ROC curves of detecting differentially expressed genes for the datasets with an external ‘gold standard’ while varying the FDR-adjusted <italic>P</italic>-value or posterior probability cutoff</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th colspan="2" rowspan="1">Methods<hr/></th><th colspan="2" rowspan="1">Simulation1<hr/></th><th colspan="2" rowspan="1">Simulation2<hr/></th><th colspan="2" rowspan="1">Simulation3<hr/></th><th colspan="2" rowspan="1">MAQC Project<hr/></th><th rowspan="1" colspan="1">Griffith <italic>et al.</italic></th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i134.jpg"/></inline-formula></th><th rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i135.jpg"/></inline-formula></th><th rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i136.jpg"/></inline-formula></th><th rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i137.jpg"/></inline-formula></th><th rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i138.jpg"/></inline-formula></th><th rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i139.jpg"/></inline-formula></th><th rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i140.jpg"/></inline-formula></th><th rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i141.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="btt143i142.jpg"/></inline-formula></th><th rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt143i143.jpg"/></inline-formula></th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Proposed</td><td rowspan="1" colspan="1">sSeq</td><td rowspan="1" colspan="1">0.947</td><td rowspan="1" colspan="1">0.962</td><td rowspan="1" colspan="1">0.951</td><td rowspan="1" colspan="1">0.967</td><td rowspan="1" colspan="1">0.856</td><td rowspan="1" colspan="1">0.888</td><td rowspan="1" colspan="1">0.585</td><td rowspan="1" colspan="1">0.911</td><td rowspan="1" colspan="1">0.689</td></tr><tr><td rowspan="5" colspan="1">Existing</td><td rowspan="1" colspan="1">edgeR</td><td rowspan="1" colspan="1">0.918</td><td rowspan="1" colspan="1">0.948</td><td rowspan="1" colspan="1">0.938</td><td rowspan="1" colspan="1">0.951</td><td rowspan="1" colspan="1">0.840</td><td rowspan="1" colspan="1">0.833</td><td rowspan="1" colspan="1">0.558</td><td rowspan="1" colspan="1">0.850</td><td rowspan="1" colspan="1">0.557</td></tr><tr><td rowspan="1" colspan="1">DESeq</td><td rowspan="1" colspan="1">0.932</td><td rowspan="1" colspan="1">0.940</td><td rowspan="1" colspan="1">0.937</td><td rowspan="1" colspan="1">0.949</td><td rowspan="1" colspan="1">0.842</td><td rowspan="1" colspan="1">0.816</td><td rowspan="1" colspan="1">0.577</td><td rowspan="1" colspan="1">0.867</td><td rowspan="1" colspan="1">0.596</td></tr><tr><td rowspan="1" colspan="1">baySeq</td><td rowspan="1" colspan="1">0.568</td><td rowspan="1" colspan="1">0.711</td><td rowspan="1" colspan="1">0.548</td><td rowspan="1" colspan="1">0.714</td><td rowspan="1" colspan="1">0.558</td><td rowspan="1" colspan="1">0.628</td><td rowspan="1" colspan="1">0.551</td><td rowspan="1" colspan="1">0.852</td><td rowspan="1" colspan="1">0.702</td></tr><tr><td rowspan="1" colspan="1">BBSeq</td><td rowspan="1" colspan="1">0.675</td><td rowspan="1" colspan="1">0.672</td><td rowspan="1" colspan="1">0.669</td><td rowspan="1" colspan="1">0.674</td><td rowspan="1" colspan="1">0.578</td><td rowspan="1" colspan="1">0.619</td><td rowspan="1" colspan="1">0.560</td><td rowspan="1" colspan="1">0.617</td><td rowspan="1" colspan="1">0.544</td></tr><tr><td rowspan="1" colspan="1">SAMseq</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">0.964</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">0.968</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">0.882</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">0.563</td><td rowspan="1" colspan="1"/></tr></tbody></table><table-wrap-foot><fn id="btt143-TF6"><p>Sub-columns are subsets of the data with one randomly selected replicate per condition and the full datasets. Values closer to 1 indicate higher sensitivity and specificity.</p></fn></table-wrap-foot></table-wrap></p>
      <p><xref ref-type="fig" rid="btt143-F1">Figure 1</xref>d, f and h also provide an insight into why shrinking the method of moments estimates of dispersion is more beneficial than shrinking the method of moments estimates of variance. On the log scale the relationship between the mean and the variance in the Negative Binomial distribution is roughly linear for large mean counts. Mathematically, from <xref ref-type="disp-formula" rid="btt143-M1">Equation (1)</xref><disp-formula id="btt143-M12"><label>(12)</label><graphic xlink:href="btt143m12"/></disp-formula>
A shrinkage of the variance estimates would multiply them by <inline-formula><inline-graphic xlink:href="btt143i144.jpg"/></inline-formula> and would distort the slope of the mean–variance relationship in <xref ref-type="disp-formula" rid="btt143-M1">Equation (1)</xref> away from <xref ref-type="disp-formula" rid="btt143-M2">Equation (2)</xref>. The shrinkage of the dispersion parameter, on the other hand, preserves this nominal mean–variance relationship. Our results (shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt143/-/DC1">Supplementary Materials</ext-link>) confirmed that shrinking the variance leads to inferior performance.</p>
      <p>To further investigate the usefulness of multiple shrinkage targets, we partitioned the genes into 10 groups according to the ranges of <inline-formula><inline-graphic xlink:href="btt143i145.jpg"/></inline-formula> and applied the shrinkage separately to each group. Our results (not shown here) indicated that there is no advantage in specifying multiple shrinkage targets.</p>
    </sec>
    <sec id="SEC5.2">
      <title>5.2 sSeq accurately detects differential expression</title>
      <p>Five datasets with an external ‘gold standard’ were used to evaluate the sensitivity and the specificity of detecting differentially expressed genes. For each method, the genes were ranked by FDR-adjusted <italic>P</italic>-value of posterior probability and termed ‘significant’ for varying cutoffs. The sensitivity and the specificity of differential expression was compared with the ‘gold standard’ and summarized with ROC curves. <xref ref-type="table" rid="btt143-T2">Table 2</xref> shows that the proposed approach consistently had a similar or a higher accuracy as compared with the existing methods.</p>
      <p>Five datasets without an external ‘gold standard’ were used to evaluate the sensitivity and the specificity less formally, as discussed in (<xref ref-type="bibr" rid="btt143-B1">Anders and Huber, 2010</xref>). First, comparisons of two conditions (‘<italic>AvsB</italic>’) had some truly differentially expressed genes. Therefore, methods with higher sensitivity should have higher areas under the empirical cumulative distribution functions (ECDF) of the <italic>P</italic>-values defined as <inline-formula><inline-graphic xlink:href="btt143i146.jpg"/></inline-formula>. Second, comparisons of replicates of a same condition (‘<italic>AvsA</italic>’) had no differentially expressed genes. Therefore, methods with higher specificity should have ECDF curves at or below the 45 degree line. For baySeq, we expect similar patterns of the ECDF curves based on the posterior probability cutoff. <xref ref-type="fig" rid="btt143-F2">Figure 2</xref> summarizes the curves for the five datasets. It shows that sSeq produced most consistently the expected pattern and had a similar or a higher accuracy as compared with the existing methods.
<fig id="btt143-F2" position="float"><label>Fig. 2.</label><caption><p>The ECDF curves of detecting differential expression for the datasets with no external ‘gold standard’. Y-axis: ECDF, function of the gene rank. <italic>x</italic>-axis: <italic>P</italic>-value or 1 minus posterior probability. Solid line: two randomly selected replicates from a same condition (<italic>AvsA</italic>). Dotted line: one randomly selected replicate from each condition (unreplicated <italic>AvsB</italic>). Dashed line: <italic>AvsB</italic> on the full dataset for two-group designs. Dashed-dotted line: <italic>AvsB</italic> on the full dataset for more complex designs. Gray line: 45 degree. SAMseq is not applicable to unreplicated experiments and is excluded. The desired patterns are high areas under the <italic>AvsB</italic> curves, and <italic>AvsA</italic> curves that are at or below the 45 degree line</p></caption><graphic xlink:href="btt143f2p"/></fig></p>
      <p>The effect of sample size and of size factors on the accuracy was investigated using the three simulated datasets. <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt143/-/DC1">Supplementary Section 4.4</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt143/-/DC1">4.5</ext-link> indicate that sSeq is particularly advantageous for experiments when <inline-formula><inline-graphic xlink:href="btt143i147.jpg"/></inline-formula>.</p>
    </sec>
  </sec>
  <sec id="SEC6">
    <title>6 DISCUSSION</title>
    <p>In this manuscript, we advocated a model that specifies free per-gene dispersion parameters in the Negative Binomial model for counts of RNA-seq reads. We also advocated a biased estimation of these parameters, which can reduce the variance of the estimates and minimize the overall MSE. Biased estimation is different from specifying a probability model (such as in DESeq) that assumes a true systematic relationship of the true variance and the true mean. It is particularly useful for experiments with a small sample size, where the systematic relationship may be difficult to evaluate. The shrinkage estimates are easy to compute, avoid iterative estimation, minimize the potential for overfitting and do not require extra computation time. They are compatible with the exact test of differential expression. For the datasets in this manuscript, sSeq consistently had a similar or a higher sensitivity and specificity of detecting differential expression than the existing methods. The approach can be generalized to express the dependence of the dispersions on the expected value or on other covariates such as guanine-cytosine (GC) content or Gene Ontology annotations.</p>
    <p>sSeq can produce meaningful results in under-replicated RNA-seq screens. However, we stress that RNA-seq screens do not eliminate the biological variation in gene expression <xref ref-type="disp-formula" rid="btt143-M12">Equation (12)</xref>. As evidenced by <xref ref-type="table" rid="btt143-T2">Table 2</xref> and <xref ref-type="fig" rid="btt143-F2">Figure 2</xref>, the under-replicated screens have lower reproducibility as compared with the replicated studies. Multiple biological replicates are necessary to adequately assess the full extent of the variation in the biological system. Therefore, the under-replicated screens can only be conducted when followed by a rigorous experimental validation with complementary technologies and adequate sample size.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_29_10_1275__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btt143_supplementary.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors thank S. Anders, M. E. Bock and the Huber group for helpful discussions.</p>
    <p><italic>Funding</italic>: <funding-source>NSF CAREER</funding-source> award <award-id>DBI-1054826</award-id> to O.V. (in part).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btt143-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R106</fpage>
        <pub-id pub-id-type="pmid">20979621</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arikawa</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cross-platform comparison of SYBR Green real-time PCR with TaqMan PCR, microarrays and other gene expression measurement technologies evaluated in the MicroArray Quality Control (MAQC) study</article-title>
        <source>BMC Genomics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>328</fpage>
        <pub-id pub-id-type="pmid">18620571</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Auer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Doerge</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A two-stage Poisson model for testing RNA-seq data</article-title>
        <source>Stat. Appl. Genet. Mol. Biol.</source>
        <year>2011</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>26</lpage>
      </element-citation>
    </ref>
    <ref id="btt143-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J. R Stat. Soc. B</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="btt143-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bottomly</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluating Gene Expression in C57BL/6J and DBA/2J mouse striatum using RNA-seq and microarrays</article-title>
        <source>PloS One</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e17820</fpage>
        <pub-id pub-id-type="pmid">21455293</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bowman</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Extended moment series and the parameters of the negative binomial distribution</article-title>
        <source>Biometrics</source>
        <year>1984</year>
        <volume>40</volume>
        <fpage>249</fpage>
        <lpage>252</lpage>
      </element-citation>
    </ref>
    <ref id="btt143-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brooks</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Conservation of an RNA regulatory map between <italic>Drosophila</italic> and mammals</article-title>
        <source>Genome Res.</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>193</fpage>
        <lpage>202</lpage>
        <pub-id pub-id-type="pmid">20921232</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bullard</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-seq experiments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>94</fpage>
        <pub-id pub-id-type="pmid">20167110</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B9">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cameron</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Trivedi</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <source>Regression Analysis of Count Data</source>
        <year>1998</year>
        <comment>Econometric Society Monograph (No.30). Cambridge University Press, Cambridge, UK</comment>
      </element-citation>
    </ref>
    <ref id="btt143-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clark</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Estimation of the negative binomial parameter <italic>κ</italic> by maximum quasi-likelihood</article-title>
        <source>Biometrics</source>
        <year>1989</year>
        <volume>45</volume>
        <fpage>309</fpage>
        <lpage>316</lpage>
      </element-citation>
    </ref>
    <ref id="btt143-B11">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Croarkin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tobias</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <source>NIST/SEMATECH e-Handbook of Statistical Methods</source>
        <year>2006</year>
        <comment>National Institute of Standards and Technology. <ext-link ext-link-type="uri" xlink:href="http://www.itl.nist.gov/div898/handbook/">http://www.itl.nist.gov/div898/handbook/</ext-link> (15 April 2013, date last accessed)</comment>
      </element-citation>
    </ref>
    <ref id="btt143-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frazee</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ReCount: a multi-experiment resource of analysis-ready RNA-seq gene count datasets</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>449</fpage>
        <pub-id pub-id-type="pmid">22087737</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garber</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational methods for transcriptome annotation and quantification using RNA-seq</article-title>
        <source>Nat. Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>469</fpage>
        <lpage>477</lpage>
        <pub-id pub-id-type="pmid">21623353</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griffith</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Alternative expression analysis by RNA sequencing</article-title>
        <source>Nature Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>843</fpage>
        <lpage>847</lpage>
        <pub-id pub-id-type="pmid">20835245</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hammer</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>mRNA-seq with agnostic splice site discovery for nervous system transcriptomics tested in chronic pain</article-title>
        <source>Genome Res.</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>847</fpage>
        <lpage>860</lpage>
        <pub-id pub-id-type="pmid">20452967</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B16">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <source>Generalized Shrinkage Estimators</source>
        <year>2008</year>
        <publisher-name>University of Wisconsin</publisher-name>
      </element-citation>
    </ref>
    <ref id="btt143-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hardcastle</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kelly</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>BaySeq: Empirical Bayesian methods for identifying differential expression in sequence count data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>422</fpage>
        <pub-id pub-id-type="pmid">20698981</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B18">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>James</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Estimation with quadratic loss</article-title>
        <source>Proceedings of the fourth Berkeley Symposium on Mathematical Statistics and Probability Held at the Statistical Laboratory, University of California, June 20-July 30, 1960</source>
        <year>1961</year>
        <publisher-name>University of California Press</publisher-name>
        <fpage>361</fpage>
      </element-citation>
    </ref>
    <ref id="btt143-B19">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lehmann</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Casella</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>Theory of Point Estimation</source>
        <year>1998</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="btt143-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Normalization, testing, and false discovery rate estimation for RNA-sequencing data</article-title>
        <source>Biostatistics</source>
        <year>2011</year>
        <volume>13</volume>
        <fpage>523</fpage>
        <lpage>538</lpage>
        <pub-id pub-id-type="pmid">22003245</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Finding consistent patterns: a nonparametric approach for identifying differential expression in RNA-seq data</article-title>
        <source>Stat. Methods Med. Res.</source>
        <year>2011</year>
        <comment>[Epub ahead of print, doi: 10.1177/0962280211428386, November 28, 2011]</comment>
      </element-citation>
    </ref>
    <ref id="btt143-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lloyd-Smith</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood estimation of the negative binomial dispersion parameter for highly overdispersed data, with applications to infectious diseases</article-title>
        <source>PLoS One</source>
        <year>2007</year>
        <volume>2</volume>
        <fpage>e180</fpage>
        <pub-id pub-id-type="pmid">17299582</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malo</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Statistical practice in high-throughput screening data analysis</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2006</year>
        <volume>24</volume>
        <fpage>167</fpage>
        <lpage>175</lpage>
        <pub-id pub-id-type="pmid">16465162</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mardis</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Next-generation DNA sequencing methods</article-title>
        <source>Annu. Rev. Genomics Hum. Genet.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>387</fpage>
        <lpage>402</lpage>
        <pub-id pub-id-type="pmid">18576944</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1509</fpage>
        <lpage>1517</lpage>
        <pub-id pub-id-type="pmid">18550803</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Markowetz</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>How to understand the cell by breaking it: network analysis of gene perturbation screens</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>e1000655</fpage>
        <pub-id pub-id-type="pmid">20195495</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential expression analysis of multifactor RNA-seq experiments with respect to biological variation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>4288</fpage>
        <lpage>4297</lpage>
        <pub-id pub-id-type="pmid">22287627</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B28">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>McCullagh</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Nelder</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Generalized Linear Models</source>
        <year>1989</year>
        <comment>Monographs on Statistics and Applied Probability (No. 37), Chapman &amp; Hall/CRC, New York</comment>
      </element-citation>
    </ref>
    <ref id="btt143-B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Metzker</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Sequencing technologies: The next generation</article-title>
        <source>Nat. Rev. Genetics</source>
        <year>2009</year>
        <volume>11</volume>
        <fpage>31</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="pmid">19997069</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>From RNA-seq reads to differential expression results</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>220</fpage>
        <pub-id pub-id-type="pmid">21176179</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patterson</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Performance comparison of one-color and two-color platforms within the MicroArray Quality Control (MAQC) project</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2006</year>
        <volume>24</volume>
        <fpage>1140</fpage>
        <lpage>1150</lpage>
        <pub-id pub-id-type="pmid">16964228</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pepke</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computation for ChIP-seq and RNA-seq studies</article-title>
        <source>Nat. Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>S22</fpage>
        <lpage>S32</lpage>
        <pub-id pub-id-type="pmid">19844228</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Piegorsch</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood estimation for the negative binomial dispersion parameter</article-title>
        <source>Biometrics</source>
        <year>1990</year>
        <volume>46</volume>
        <fpage>863</fpage>
        <lpage>867</lpage>
        <pub-id pub-id-type="pmid">2242417</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richards</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>An Introduction to James-Stein estimation</article-title>
        <year>1999</year>
        <comment>M.I.T. EECS Area Exam Report, 1999. <ext-link ext-link-type="uri" xlink:href="http://www.yaroslavvb.com/papers/richards-introduction.ps">http://www.yaroslavvb.com/papers/richards-introduction.ps</ext-link> (15 April 2013, date last accessed)</comment>
      </element-citation>
    </ref>
    <ref id="btt143-B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>EdgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">20196867</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Moderated statistical tests for assessing differences in tag abundance</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2881</fpage>
        <lpage>2887</lpage>
        <pub-id pub-id-type="pmid">17881408</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B38">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The MicroArray Quality Control (MAQC) project shows inter-and intraplatform reproducibility of gene expression measurements</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2006</year>
        <volume>24</volume>
        <fpage>1151</fpage>
        <lpage>1161</lpage>
        <pub-id pub-id-type="pmid">16964229</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B39">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Linear models and empirical Bayes methods for assessing differential expression in microarray experiments</article-title>
        <source>Stat. Appl. Genet. Mol. Biol.</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>3</fpage>
      </element-citation>
    </ref>
    <ref id="btt143-B40">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Limma: Linear models for microarray data</article-title>
        <source>Bioinformatics Computational Biology Solutions Using R and Bioconductor</source>
        <year>2005</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>397</fpage>
        <lpage>420</lpage>
      </element-citation>
    </ref>
    <ref id="btt143-B50">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Delorenzi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A comparison of methods for differential expression analysis of RNA-seq data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>91</fpage>
        <pub-id pub-id-type="pmid">23497356</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B41">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Stein</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Inadmissibility of the usual estimator for the mean of a multivariate Normal distribution</article-title>
        <source>Proceedings of the Third Berkeley symposium on mathematical statistics and probability</source>
        <year>1956</year>
        <volume>Vol. 1</volume>
        <publisher-loc>Berkeley</publisher-loc>
        <publisher-name>University of California Press</publisher-name>
        <fpage>197</fpage>
        <lpage>206</lpage>
      </element-citation>
    </ref>
    <ref id="btt143-B42">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sultan</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A global view of gene activity and alternative splicing by deep sequencing of the human transcriptome</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>321</volume>
        <fpage>956</fpage>
        <lpage>960</lpage>
        <pub-id pub-id-type="pmid">18599741</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B43">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Toft</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Gamma-Poisson model as a statistical method to determine if micro-organisms are randomly distributed in a food matrix</article-title>
        <source>Food Microbiol.</source>
        <year>2006</year>
        <volume>23</volume>
        <fpage>90</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="pmid">16942991</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B44">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tuch</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tumor transcriptome sequencing reveals allelic expression imbalances associated with copy number alterations</article-title>
        <source>PloS One</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>e9317</fpage>
        <pub-id pub-id-type="pmid">20174472</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B45">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DEGseq: an R package for identifying differentially expressed genes from RNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>136</fpage>
        <lpage>138</lpage>
        <pub-id pub-id-type="pmid">19855105</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B46">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
    <ref id="btt143-B47">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willson</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multistage estimation compared with fixed-sample-size estimation of the negative binomial parameter <italic>k</italic></article-title>
        <source>Biometrics</source>
        <year>1984</year>
        <volume>40</volume>
        <fpage>109</fpage>
        <lpage>117</lpage>
      </element-citation>
    </ref>
    <ref id="btt143-B48">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhining</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation of gene expression data generated from expired Affymetrix GeneChip microarrays using MAQC reference RNA samples</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>Suppl. 6</issue>
        <fpage>S10</fpage>
      </element-citation>
    </ref>
    <ref id="btt143-B49">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A powerful and flexible approach to the analysis of RNA sequence count data</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2672</fpage>
        <lpage>2678</lpage>
        <pub-id pub-id-type="pmid">21810900</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
