<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4375852</article-id>
    <article-id pub-id-type="pmid">25888166</article-id>
    <article-id pub-id-type="publisher-id">517</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-015-0517-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>micropan: an R-package for microbial pan-genomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Snipen</surname>
          <given-names>Lars</given-names>
        </name>
        <address>
          <email>lars.snipen@nmbu.no</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liland</surname>
          <given-names>Kristian Hovde</given-names>
        </name>
        <address>
          <email>kristian.liland@nofima.no</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0607 975X</institution-id><institution-id institution-id-type="GRID">grid.19477.3c</institution-id><institution>Department of Chemistry, Biotechnology and Food Sciences, </institution><institution>Norwegian University of Life Sciences, </institution></institution-wrap>P.O. Box 5003, N-1432 Ås, Norway </aff>
      <aff id="Aff2"><label>2</label>Nofima - Norwegian Institute of Food, Fisheries and Aquaculture Research, Osloveien 1, N-1430 Ås, Norway </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>3</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>79</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>10</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>2</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Snipen and Liland; licensee BioMed Central. 2015</copyright-statement>
      <license license-type="open-access">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>A pan-genome is defined as the set of all unique gene families found in one or more strains of a prokaryotic species. Due to the extensive within-species diversity in the microbial world, the pan-genome is often many times larger than a single genome. Studies of pan-genomes have become popular due to the easy access to whole-genome sequence data for prokaryotes. A pan-genome study reveals species diversity and gene families that may be of special interest, e.g because of their role in bacterial survival or their ability to discriminate strains.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present an R package for the study of prokaryotic pan-genomes. The R computing environment harbors endless possibilities with respect to statistical analyses and graphics. External free software is used for the heavy computations involved, and the R package provides functions for building a computational pipeline.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>We demonstrate parts of the package on a data set for the gram positive bacterium <italic>Enterococcus faecalis</italic>. The package is free to download and install from The Comprehensive R Archive Network.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-015-0517-0) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Pan-genome</kwd>
      <kwd>R</kwd>
      <kwd>Clustering</kwd>
      <kwd>Prokaryotes</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>As a result of accelerated development of sequencing technologies over the last decades, prokaryotic genomes can now be sequenced in short time and at small cost. This has made it popular to sequence many strains within the same species, to investigate the diversity, to look for a core set of genes common to all strains, to be able to distinguish pathogenic from non-pathogenic genotypes, etc. [<xref ref-type="bibr" rid="CR1">1</xref>-<xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p>It has long since been recognized that the diversity between prokaryotic strains is much greater than between, say, individuals in a human subpopulation. All humans share, more or less, the same genes, and the differences between individuals are often found in the regulatory parts of the genome. In contrast, two different strains of <italic>E. coli</italic> may be many times more diverse than humans and chimpanzees, with perhaps 20% of the genes in one strain lacking in the other (e.g. [<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref>]). For this reason, the set of unique genes found in the entire <italic>E. coli</italic> population is many times larger than what we observe in a single genome, and this collection of all genes utilized by a species was by [<xref ref-type="bibr" rid="CR8">8</xref>] denoted the ‘pan-genome’.</p>
    <p>Microbial comparative genomics has in most cases focused on the core genes, i.e. housekeeping genes conserved across all strains [<xref ref-type="bibr" rid="CR9">9</xref>]. In pan-genomics we consider all genes, also those referred to as accessory genes. In all cases, a ‘gene’ is actually a gene family or cluster of similar sequences, and we only consider the protein coding genes. A gene family is usually synonymous to a collection of orthologs, i.e. genes playing identical roles in different genomes. Since the grouping we come up with in pan-genomics does not always correspond to the classical gene family, we prefer the term <italic>gene cluster</italic> instead of gene family. Despite the central role of such clusters or families, there has never really been any consensus on how to compute them [<xref ref-type="bibr" rid="CR10">10</xref>], and in the tool set presented here we have implemented several options.</p>
    <p>In this paper we describe and illustrate some functions and opportunities of the micropan R-package [<xref ref-type="bibr" rid="CR11">11</xref>] by using public data for the species <italic>Enterococcus faecalis</italic>. <italic>E. faecalis</italic> is a multifaceted Gram-positive bacterium with an intimate relationship to human health and disease [<xref ref-type="bibr" rid="CR12">12</xref>]. This species is among the first to colonize the gastro intestinal tract of newborns [<xref ref-type="bibr" rid="CR13">13</xref>], and for most people <italic>E. faecalis</italic> constitutes a commensal of the normal intestinal microflora [<xref ref-type="bibr" rid="CR14">14</xref>]. Remarkably, while certain strains are used as probiotics [<xref ref-type="bibr" rid="CR15">15</xref>], <italic>E. faecalis</italic> is also a prominent cause of nosocomial infections [<xref ref-type="bibr" rid="CR16">16</xref>]. Hence, this extreme diversity in phenotype among different strains motivates an investigation of the species’ pan-genome.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>Within the package there is a document (casestudy.
pdf) giving a detailed description, with R-code, of a case study example that can serve as a template for most studies. Here we give an overview of the package implementation.</p>
    <p>We have chosen to use R as the ‘workbench’ for making microbial pan-genome analyses. R is a free and platform-independent tool much used in bioinformatics, and it requires only very modest programming skills. Inside R there is a huge array of other packages and solutions available, making the possible combinations endless. A long list of basic and complex statistical analyses can be made, as well as graphical displays of all kinds. The micropan package offers a set of functions specifically designed for microbial pan-genomics, but it is quite natural to also make use of other facilities in R once the basic computations are made.</p>
    <p>In addition to R, we also make use of some external software, typically for heavy computations. All external software used by the micropan package are free and platform-independent, and the package vignette gives an overview of how to obtain them. Once installed, the external software are operated by using micropan R-functions. This means you never leave the R-environment while doing the analyses, but still make use of these extremely efficient computing engines.</p>
    <sec id="Sec3">
      <title>The pan-matrix</title>
      <p>A central data structure in a pan-genome analysis is the <italic>pan-matrix</italic>. Any pan-genome analysis is typically divided into two phases; first, the heavy computations required to establish the pan-matrix, and then the more interesting analyses where the pan-matrix is often used as the input.</p>
      <p>Any pan-genome study requires a set of FASTA-files containing the protein sequences of all genes in each genome. The micropan package has functions for downloading genomes (complete or draft) from NCBI [<xref ref-type="bibr" rid="CR17">17</xref>], using the Entrez programming utilities [<xref ref-type="bibr" rid="CR18">18</xref>], and if gene calling is needed the function prodigalPredict can be used to call upon the Prodigal gene finder [<xref ref-type="bibr" rid="CR19">19</xref>] as an external software.</p>
      <p>To compute the pan-matrix, a large number of protein sequence comparisons must be made, which is the computational bottleneck of a pan-genome study. We have chosen the software BLAST+ or HMMER3 [<xref ref-type="bibr" rid="CR20">20</xref>-<xref ref-type="bibr" rid="CR22">22</xref>] for this job, highly optimized standard tools in the bioinformatics toolbox. These are invoked from R by the functions blastAllAll and hmmerScan in the micropan package. The sequence comparisons are still time-consuming, but they are only done once for each data set since all results are stored on files in a specified output-folder. If data sets are extended, only computations involving the new genomes are needed. On a multi-core computer you can easily increase the computational speed by running multiple R-sessions in parallel. We have designed the functions not to overwrite existing result files, allowing multiple R-sessions to write to the same output-folder.</p>
      <p>Based on the result files from the heavy computations, sequences are clustered into gene clusters. The micropan package contains functions for doing this in various ways. Clustering genes into classical gene families (clusters of orthologs) is a common approach [<xref ref-type="bibr" rid="CR23">23</xref>], and means all sequences must be compared to all sequences in a <italic>direct</italic> way (pairwise alignments). This is an option in the micropan package as well, based on results from blastAllAll. Distances between sequence <italic>i</italic> and <italic>j</italic> are computed as
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ D(i,j) = \frac{1}{2}\left[ 2-S(i;j)/S(j;j)-S(j;i)/S(i;i)\right]  $$
\end{document}</tex-math><mml:math id="M2"><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>;</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>;</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2015_517_Equ1.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>where <italic>S</italic>(<italic>i</italic>;<italic>j</italic>) is the BLAST score for the alignment between the sequences when <italic>i</italic> is used as query and <italic>j</italic> as database sequence, and vice versa for <italic>S</italic>(<italic>j</italic>;<italic>i</italic>). The self-scores <italic>S</italic>(<italic>j</italic>;<italic>j</italic>) and <italic>S</italic>(<italic>i</italic>;<italic>i</italic>) are used to get the relative score (between 0 and 1), and the distance is simply the average lack of relative score. Gene families are found by a hierarchical clustering where linkage functions and cutoff thresholds can be specified.</p>
      <p>However, any all-versus-all type of comparison suffers from the quadratic scaling, i.e. the computational load is <italic>O</italic>(<italic>G</italic>
<sup>2</sup>) where <italic>G</italic> is the number of genomes involved. It is feasible for a smallish number of genomes, but considering the ever-growing number of sequenced strains, it has some daunting perspectives. Already the approach would prove difficult for <italic>Escherichia coli</italic>. At the time of writing there are 2267 strains available at NCBI. Producing the more than 5 million (2267<sup>2</sup>) BLAST result files would take weeks given ordinary computing resources, and in the meantime the number of <italic>E. coli</italic> strains has increased further!</p>
      <p>An alternative to clustering based on orthologs is to scan all genes for protein domains using HMMER3, as suggested by [<xref ref-type="bibr" rid="CR24">24</xref>], and then cluster them by their ordered sequence of non-overlapping domains. The whole idea of this <italic>indirect</italic> comparison is to first compare all proteins to some reference set of sequences, e.g. a database of protein domains, and then cluster them based on how they look in this sequence subspace. This approach scales linearly in the number of genomes, and is more robust to gene prediction errors since an accurate start-codon prediction is not as critical as for the direct comparison approach.</p>
      <p>Finally, the pan-matrix is constructed from the clustering results based on either BLAST+ or HMMER3 comparisons. The pan-matrix has one row for each genome and one column for each gene cluster, and the value in cell (<italic>i</italic>,<italic>j</italic>) is the number of copies of gene cluster <italic>j</italic> found in genome <italic>i</italic>.</p>
    </sec>
    <sec id="Sec4">
      <title>Exploring pan-genomes</title>
      <p>Pan-genome size can be estimated by methods previously suggested [<xref ref-type="bibr" rid="CR25">25</xref>-<xref ref-type="bibr" rid="CR27">27</xref>]. The Chao lower bound estimate of pan-genome size is a conservative estimate, i.e. it tends to be on the smaller side of the true size. Fitting a binomial mixture model will also produce a conservative estimate of pan-genome size, as well as an estimate of the core size. Such models also give a nice graphical view of the composition of the pan-genome with respect to gene types, ranging from core genes (always or almost always present), shell genes (often present, but lacking in subsets of genomes) to cloud genes (observed in only a few genomes).</p>
      <p>Pan-genome openness/closedness can be estimated as suggested by [<xref ref-type="bibr" rid="CR28">28</xref>], using a Heaps law type of model. This model is fitted to rarefaction curves for the data, and the display of such curves is also implemented.</p>
      <p>Another quantity describing pan-genome diversity is the genomic fluidity suggested by [<xref ref-type="bibr" rid="CR29">29</xref>], also implemented as a function in the micropan package. The fluidity is very similar to a Jaccard distance, which is a measure of overlap between genomes with respect to their gene clusters. Both Jaccard distances as well as Manhattan distances between genomes can be computed. The functions distManhattan and distJaccard will by default consider only presence and absence of any gene cluster in a genome, i.e. transform the pan-matrix values to 0<sup>′</sup>
<italic>s</italic> or 1<sup>′</sup>
<italic>s</italic>.</p>
      <p>The distManhattan function may also consider copy number variation. The argument scale is used for this, as demonstrated in Figure <xref rid="Fig1" ref-type="fig">1</xref>. By default scale =0.0 and a gene cluster is only counted as present or absent regardless of the actual number of copies for that cluster. Using scale =1.0 means all copy number differences are equally important. Any value between 0.0 and 1.0 will put some emphasis on copy number changes, but going from 0 to 1 copy is still the most severe difference. It is also possible to give weights to certain gene clusters. By default all gene clusters have weight 1.0, but by lowering this certain gene clusters can be partially or totally ignored in the distance computations. Figure <xref rid="Fig1" ref-type="fig">1</xref> also illustrates some built-in weighting options.
<fig id="Fig1"><label>Figure 1</label><caption><p><bold>Scaling and weighting.</bold> The left panel shows how the scaling parameter affects the values of the pan-matrix when computing distances between genomes. With no scaling (default) copy numbers beyond 1 are ignored, i.e. for a gene cluster occurring in 1 or more copies the pan-matrix will only have the value 1. If the scale is 1 (maximum) the pan-matrix value is identical to the copy number. Any scale value between 0 and 1 will produce intermediate pan-matrix values. The right panel shows two gene cluster weight strategies available in the geneWeights function. The blue curve is the <italic>shell</italic> weighting, giving large weight to gene clusters occurring frequently (large detection probability). The red curve is the <italic>cloud</italic> weighting, emphasizing rarely occurring gene clusters.</p></caption><graphic xlink:href="12859_2015_517_Fig1_HTML" id="MO1"/></fig>
</p>
      <p>Based on some function for computing distances (mentioned above, or made by the user) the genomes can be displayed in pan-genome trees as described in [<xref ref-type="bibr" rid="CR30">30</xref>]. An alternative display is by principal component analysis (PCA). A pan-matrix, like any matrix, can be used as input in a PCA, and by plotting the genomes in a truncated score-space we may get an impression of how the genomes are located relative to each other. A PCA biplot may also reveal which gene clusters are the best discriminators between (groups of) genomes. A PCA on a pan-matrix will most typically indicate if genomes tend to cluster. The panpca function can also take arguments for copy number scaling and gene cluster weighting, as mentioned for distManhattan above.</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results and discussion</title>
    <p>To demonstrate some facets of the micropan package we have used publicly available data for the species <italic>E. faecalis</italic>. We have chosen this rather large data set since it is typical of what we will face in near future for all species. Within the micropan package a case study document demonstrates the approach on a very small data set, to make all computations fast for a do-it-yourself exercise.</p>
    <p>First, genome data for 342 <italic>E. faecalis</italic> genome sequencing projects were downloaded from NCBI by entrezDownload. Only 5 of these genomes were complete and the rest were draft genomes. Next, we called protein-coding genes in all genomes using the prodigalPredict function. In the 342 FASTA-files of amino acid sequences the median number of proteins was 2916 with a range of 2428 to 3482, and close to 1 million sequences in total.</p>
    <p>In the present study, since we have as many as 342 genomes, we decided to compare sequences by their protein domain sequences. All proteins were scanned against the Pfam-A database [<xref ref-type="bibr" rid="CR31">31</xref>] using the hmmerScan function. A total of 2318 unique Pfam-A entries produced hits, with around 3500 hits per genome. On average 84<italic>%</italic> of the proteins in a genome contained some Pfam-A domain(s). Each sequence having a hit in Pfam-A was clustered together with all other sequences having the exact same domains in the exact same non-overlapping order, using the dClust function. Clearly, a drawback of this approach is that the 16<italic>%</italic> proteins without hits in the Pfam-A database are excluded from the analysis. Using only domain sequences we maintain a very high degree of specificity (including only real genes in the analysis) at the cost of a lower sensitivity. This we find fruitful in pan-genome studies, where the inclusion of some ‘rubbish genes’ in every genome would assemble into a large pool of (seemingly) ORFan genes in the entire pan-genome. The sensitivity can be improved to some degree by extending the domain database, e.g. including data from CDD and/or InterPro [<xref ref-type="bibr" rid="CR32">32</xref>,<xref ref-type="bibr" rid="CR33">33</xref>].</p>
    <p>The pan-matrix was constructed from the domain sequence clusters. We found 3111 unique domain sequence clusters in the entire data set, with an average of 1465 in a single genome. Domain sequence clusters are larger and more coarse groups than classical gene families, reflected in the fact that there are approximately half as many clusters as there are protein sequences in an average <italic>E. faecalis</italic> genome. Some clusters are huge; the largest is characterized by the single domain PF00005.22, which is an ABC Transporter type of protein. All <italic>E. faecalis</italic> genomes contain many of these genes. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the micropan default graphical display of the pan-matrix, a barplot listing the number of clusters found in 1,2,…,342 genomes. We found 762 clusters present in all 342 genomes (rightmost bar) and at the other end there are 572 clusters unique to one genome only. Thus, on average every genome has around 2 domain sequence clusters never seen in any other <italic>E. faecalis</italic> genome.
<fig id="Fig2"><label>Figure 2</label><caption><p><bold>Presence/absence distribution of clusters.</bold> The bar chart shows the number of domain sequence clusters found present in 1,2,…,342 of the <italic>E. faecalis</italic> genomes. This is the default chart when plotting a pan-matrix in the micropan package.</p></caption><graphic xlink:href="12859_2015_517_Fig2_HTML" id="MO2"/></fig>
</p>
    <p>Based on the pan-matrix we fitted a binomial mixture model using the binomixEstimate function [<xref ref-type="bibr" rid="CR27">27</xref>] describing the <italic>E. faecalis</italic> pan-genome. This function estimates a series of mixture models of increasing complexity, and uses the Bayesian Information Criterion (BIC, [<xref ref-type="bibr" rid="CR34">34</xref>]) to find the optimum. For this data set the optimum was found at 14 components, i.e. gene clusters should be divided into 14 groups with respect to how frequently they appear in the genomes. The pie-chart visualization of the fitted binomial mixture model is perhaps the most descriptive visual summary of the pan-genome. Gene clusters are assembled into groups having specific detection probabilities, and the relative distribution of these indicate how the species’ gene content looks like. In Figure <xref rid="Fig3" ref-type="fig">3</xref> we show this picture of the <italic>E. faecalis</italic> pan-genome.
<fig id="Fig3"><label>Figure 3</label><caption><p><bold>Visualization of the pan-genome.</bold> The pie symbolizes the entire pan-genome, and the 14 sectors correspond to various groups of gene clusters, where the color of the sector shows the detection probability, also indicated by the numbers. The blue sectors are highly conserved (core) genes. These are found in (almost) all genomes. The greenish sectors are accessory (shell) genes found in (large) subsets of genomes. The orange/pink sectors are the rarely occurring (cloud) genes. Most of these have not yet been described. Only one or a few such genes are found in each genome, but if we keep on sequencing they will make up a large proportion of the pan-genome.</p></caption><graphic xlink:href="12859_2015_517_Fig3_HTML" id="MO3"/></fig>
</p>
    <p>The core gene clusters corresponds to the darkest blue sector, with detection probability 1. There are also two other sectors with almost the same dark blue, and detection probabilities close to 1. In practice, we would say these are also core genes. They lack in some of the 342 genomes, but since these data contain mostly incomplete draft genomes we do not expect 100% detection even for real core gene clusters. Thus, the core genes make up roughly one third of the <italic>E. faecalis</italic> pan-genome. These gene clusters comprise the stable part of the pan-genome. At the other end we notice the large sector of ‘cloud’ gene clusters (pink). If we also include the sector with detection probability 0.041 we see that such gene clusters make up half the pan-genome. Even if they are many, they are rarely found in a genome (low detection probability). The history and function of such genes is interesting from a biological viewpoint, but is of less importance for describing the population of <italic>E. faeclis</italic> strains. From Figure <xref rid="Fig3" ref-type="fig">3</xref> we also note that around 10-15% of the pan-genome are ‘shell’ gene clusters (greenish colors), being present in many, but not all, genomes. These gene clusters are interesting. In this segment we find the really strong signals with respect to which strains are more or less similar. If we should design a typing scheme for this species, we would certainly consider these gene clusters as important.</p>
    <p>Estimates of the full pan-genome size was obtained from the fitted mixture model as well as the chao [<xref ref-type="bibr" rid="CR25">25</xref>] function in the micropan package. Both produce conservative estimates of how many clusters we should expect to see if we continue to sequence more strains, the results were 3327 and 3845, respectively. Both these methods assume the pan-genome is closed, i.e. its size has an upper bound. The heaps function was used to indicate if this is actually the case. The Heaps law model parameter <italic>α</italic> was estimated to 0.82, indicating an open pan-genome, the threshold being 1.0, see [<xref ref-type="bibr" rid="CR28">28</xref>] for details. We will, however, not conclude from this that the <italic>E. faecalis</italic> pan-genome is ‘infinite’. An ‘open’ pan-genome must be interpreted as a size much bigger than what we have seen so far. The pan-genome size estimation is by nature a very difficult problem since it implies an extrapolation way beyond the present data. This must always be acknowledged and warrants a caution on making statements about pan-genome open/closedness.</p>
    <p>The estimation of a pan-genome size is a variant of the ‘number of unseen species’ problem that dates back at least to [<xref ref-type="bibr" rid="CR35">35</xref>]. The methods implemented in the current version of this R package are just some out of several possible [<xref ref-type="bibr" rid="CR36">36</xref>]. Recent investigations have demonstrated that both these and some other methods have their flaws [<xref ref-type="bibr" rid="CR37">37</xref>]. More methodological research should be devoted to this problem, and future versions of this R package will be updated accordingly. Specifically, methods incorporating information about genome relatedness should have a potential for improving such estimates. This has recently been tried out by [<xref ref-type="bibr" rid="CR37">37</xref>,<xref ref-type="bibr" rid="CR38">38</xref>], and similar ideas from related problems should also be explored [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
    <p>Given the pan-matrix, we can construct a pan-genome tree, as described in [<xref ref-type="bibr" rid="CR30">30</xref>]. Such trees illustrate the difference in gene cluster content between genomes. For 342 genomes any such tree requires too much space for being displayed in this paper, but in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1 we have included such a (unweighted and unscaled) tree for all genomes.</p>
    <p>An alternative display of the genomes is obtained by a principal component analysis (PCA). A pan-matrix can be used in a PCA to rotate and truncate its column-space, and plotting the genomes in the first 2-3 dimensions will reveal the dominant differences between them. In Figure <xref rid="Fig4" ref-type="fig">4</xref> we have used the panpca function together with plotScores to show how the genomes are located in the space spanned by the two first principal components. We have used the default scale =0 and no weighting. The genomes are colored according to the environment they have been isolated from, collected from the BioSample database at NCBI [<xref ref-type="bibr" rid="CR40">40</xref>]. Only 25% of the total variation is seen along these two directions, but there is still some interesting information to be found. We notice that the first principal (horizontal) axis is spanned by the tight cluster of strains from human blood on the right. This group is dominated by a subset of strains from the Enterococcus Illumina PacBio initiative, Broad Institute (broadinstitute.org). This project has provided many of the genomes shown here, and only a subset of them forms this very distinct cluster. There are other tendencies of clustering as well, especially a subset of human (urine) strains around position (2,−3) in the coordinate system. We also notice that all environmental and freshwater isolates (green and dark blue) are located in the lower left quadrant. This indicates that the present/absent patterns of domain sequence clusters is far from random and clearly has a typing potential.
<fig id="Fig4"><label>Figure 4</label><caption><p><bold>PCA on a pan-matrix.</bold> Each square marks a genome in the two first principal components (directions) of the pan-matrix space. The colors indicate the type of environment from which the genome has been sampled. Note that the magenta genomes are isolated from humans, but without specifying blood, gut or urine. The percentages in the axis labels show how much of the total pan-matrix variation is seen along each principal component.</p></caption><graphic xlink:href="12859_2015_517_Fig4_HTML" id="MO4"/></fig>
</p>
    <p>Since Figure <xref rid="Fig4" ref-type="fig">4</xref> indicates some clustering, we decided to partition the genomes and display the central genome from each group in a pan-genome tree. We first used the distManhattan function to produce a distance table. To illustrate the use of other R-facilities, we used the cluster package for the partitioning. We used the Partitioning Around Medoids method [<xref ref-type="bibr" rid="CR41">41</xref>], clustering the genomes into 2,3,…,100 clusters. For each number of clusters we computed the silhouette values [<xref ref-type="bibr" rid="CR41">41</xref>]. The silhouettes measure how well a genome belongs to its assigned cluster compared to its nearest neighbor cluster. We computed the mean of the 25% smallest silhouettes in each case, and found that this reaches its maximum at 19 clusters, as shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2. Thus, the data suggest that the 342 genomes can be separated into 19 groups. From each group we extracted the medoide genome and constructed a pan-genome tree, using the panTree function and displayed it in Figure <xref rid="Fig5" ref-type="fig">5</xref>. Each group is represented by the medoide genome name, while the color represents the dominating environment of the genomes in the group. We notice there is one big group of human blood genomes (red, B1441 as medoide), one with human urine (orange, ERV68) and one with human gut (brown, 79-3). There are 6 more groups of human isolates (magenta). The three uppermost clades in the tree (red, orange and magenta) contain only human isolates. One cluster is dominated by animals (light blue, 7430821-4) and 4 groups are environmental/freshwater (green). The gray groups are mixes without any dominating environment. Two strains, the environmental isolate 13-SD-W-01 and the lab-strain ATCC 29212, are extremely different from all others. This partitioning procedure has some resemblances to the definition of clonal complexes based on MLST-analyses [<xref ref-type="bibr" rid="CR42">42</xref>], but here we use all gene clusters instead of a small subset of core genes. Supervised learning methods could now easily be implemented to design whole-genome based typing procedures for <italic>E. faecalis</italic>, but this is beyond the scope of this application note.
<fig id="Fig5"><label>Figure 5</label><caption><p><bold>Pan-genome tree for medoide genomes.</bold> This pan-genome tree was constructed using unscaled and unweighted Manhattan distances between the medoide genomes after partitioning all genomes into 19 groups (see the text for details). A medoide is the ‘central’ genome in the group. The number of genomes in each group is shown in the parenthesis behind each name. The colors indicate the dominating environment in each group, see Figure <xref rid="Fig4" ref-type="fig">4</xref> for color-code. The gray are mixes without any dominating environment.</p></caption><graphic xlink:href="12859_2015_517_Fig5_HTML" id="MO5"/></fig>
</p>
  </sec>
  <sec id="Sec6" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We have presented an R package including a number of functions for exploring microbial pan-genomes. The implementation uses R as the working environment, but exports heavy computations to external software. Within the package is a small case study example for the user to explore. In this paper we have used a larger data set for <italic>Enterococcus faecalis</italic> to demonstrate some of the facets in this package. We have also used other functions and packages available in R on the <italic>E. faecalis</italic> data to highlight these possibilities from within the R computing environment.</p>
  </sec>
  <sec id="Sec7">
    <title>Availability and requirements</title>
    <p>The R package is available for free from The Comprehensive R Archive Network (CRAN, [<xref ref-type="bibr" rid="CR43">43</xref>]). It is most easily obtained by starting R and runninginstall.packages(~micropan~, repos=~http://cran.r-project.org/~) in the console window.<bold>Project name:</bold>
micropan
<bold>Project home page:</bold> Search for micropan on CRAN<bold>Operating systems:</bold> Platform independent<bold>Programming language:</bold> R<bold>Other requirements:</bold> For full functionality the system must also have available the BLAST+ software [<xref ref-type="bibr" rid="CR20">20</xref>], the HMMER3 software [<xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR22">22</xref>] and the Prodigal software [<xref ref-type="bibr" rid="CR19">19</xref>]. <bold>License:</bold> GPL-2</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec8">
        <title>Additional files</title>
        <p>
          <media position="anchor" xlink:href="12859_2015_517_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p><bold>Figure S1 - Pan-genome tree for all genomes.</bold> An unscaled and unweighted pan-genome tree for all the 342 <italic>E. faecalis</italic> genomes used in the example study. The colors of the leaves reflect the environment from which the genome has been sampled, and the color code is shown in Figure <xref rid="Fig4" ref-type="fig">4</xref>.</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="12859_2015_517_MOESM2_ESM.pdf" id="MOESM2">
            <label>Additional file 2</label>
            <caption>
              <p><bold>Figure S2 - silhouette values.</bold> Genomes were clustered into 2,3,…,100 groups using the Partitioning Around Medoids (PAM) method in the cluster package in R. For each number of clusters the mean of the 25% smallest silhouette values are shown. The maximum value is reached at 19 clusters, indicating the best possible grouping according to this criterion.</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The non-profit corporation Nofima - Norwegian Institute of Food, Fisheries and Aquaculture Research has no competing interests related to this publication or the presented software. The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>Both authors have contributed significantly to all programming, documentation and preparation of this manuscript. Both authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>This project has been financed by the Norwegian University of Life Sciences.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Probing the pan-genome of Listeria monocytogenes: new insights into intraspecific niche expansion and genomic diversification</article-title>
        <source>BMC Genomics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>500</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-11-500</pub-id>
        <pub-id pub-id-type="pmid">20846431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Donati</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hiller</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Tettelin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Muzzi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Croucher</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Angiuoli</surname>
            <given-names>SV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure and dynamics of the pan-genome of Streptococcus pneumoniae and closely related species</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>10</issue>
        <fpage>R107</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r107</pub-id>
        <pub-id pub-id-type="pmid">21034474</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lefebure</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pavinski Bitar</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Suzuki</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Stanhope</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary dynamics of complete campylobacter pan-genomes and the bacterial species concept</article-title>
        <source>Genome Biol Evol</source>
        <year>2010</year>
        <volume>2</volume>
        <fpage>646</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1093/gbe/evq048</pub-id>
        <pub-id pub-id-type="pmid">20688752</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Galardini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mengoni</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brilli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pini</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Fioravanti</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lucas</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exploring the symbiotic pangenome of the nitrogen-fixing bacterium Sinorhizobium meliloti</article-title>
        <source>BMC Genomics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>235</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-12-235</pub-id>
        <pub-id pub-id-type="pmid">21569405</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Complete sequencing and pan-genomic analysis of lactobacillus delbrueckii subsp. bulgaricus reveal its genetic basis for industrial yogurt production</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>e15964</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0015964</pub-id>
        <pub-id pub-id-type="pmid">21264216</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rasko</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Rosovitz</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>GSA</given-names>
          </name>
          <name>
            <surname>Mongodin</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Fricke</surname>
            <given-names>WF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The pangenome structure of Escherichia coli: comparative genomic analysis of E. coli commensal and pathogenic isolates</article-title>
        <source>J Bacteriol</source>
        <year>2008</year>
        <volume>190</volume>
        <issue>20</issue>
        <fpage>6881</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1128/JB.00619-08</pub-id>
        <pub-id pub-id-type="pmid">18676672</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lukjancenko</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Wassenaar</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ussery</surname>
            <given-names>DW</given-names>
          </name>
        </person-group>
        <article-title>Comparison of 61 sequenced Escherichia coli genomes</article-title>
        <source>Microb Ecol</source>
        <year>2010</year>
        <volume>60</volume>
        <fpage>708</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1007/s00248-010-9717-3</pub-id>
        <pub-id pub-id-type="pmid">20623278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <mixed-citation publication-type="other">Tettelin H, Masignani V, Cieslewicz MJ, Donati C, Medini D, Ward NL, et al. Genome analysis of multiple pathogenic isolates of streptococcus agalactiae: implications for the microbial ‘pan-genome’. PNAS. 1395; 102:0–5.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maiden</surname>
            <given-names>MCJ</given-names>
          </name>
          <name>
            <surname>Bygraves</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Feil</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Morelli</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rusell</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Urwin</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multilocus sequence typing: A portable approach to the identification of clones within populations of pathogenic microorganisms</article-title>
        <source>PNAS</source>
        <year>1998</year>
        <volume>25</volume>
        <fpage>3140</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.95.6.3140</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dessimoz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gabaldon</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Roos</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Sonnhammer</surname>
            <given-names>ELL</given-names>
          </name>
          <name>
            <surname>Herrero</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>for Orthologs Consortium</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>Towards community standards in the quest for orthologs</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>6</issue>
        <fpage>900</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts050</pub-id>
        <pub-id pub-id-type="pmid">22332236</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>R Core Team</collab>
        </person-group>
        <source>R: A language and environment for statistical computing</source>
        <year>2014</year>
        <publisher-loc>Vienna</publisher-loc>
        <publisher-name>Austria: R Foundation for Statistical Computing</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilmore</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Ferretti</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>The thin line between gut commensal and pathogen</article-title>
        <source>Science</source>
        <year>2003</year>
        <volume>299</volume>
        <issue>5615</issue>
        <fpage>1999</fpage>
        <lpage>2002</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1083534</pub-id>
        <pub-id pub-id-type="pmid">12663906</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Are</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aronsson</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Greicius</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>YK</given-names>
          </name>
          <name>
            <surname>Gustafsson</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Enterococcus faecalis from newborn babies regulate endogenous PPARgamma activity and IL-10 levels in colonic epithelial cells</article-title>
        <source>PNAS</source>
        <year>2008</year>
        <volume>105</volume>
        <issue>6</issue>
        <fpage>1943</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0711734105</pub-id>
        <pub-id pub-id-type="pmid">18234854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Noble</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>Carriage of group D streptococci in the human bowel</article-title>
        <source>J Clin Pathol</source>
        <year>1978</year>
        <volume>31</volume>
        <fpage>1182</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1136/jcp.31.12.1182</pub-id>
        <pub-id pub-id-type="pmid">107199</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Domann</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hain</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ghai</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Billion</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kuenne</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zimmermann</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative genomic analysis for the presence of potential enterococcal virulence factors in the probiotic Enterococcus faecalis strain Symbioflor 1</article-title>
        <source>Int J Med Microbiol</source>
        <year>2007</year>
        <volume>297</volume>
        <issue>7–8</issue>
        <fpage>533</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ijmm.2007.02.008</pub-id>
        <pub-id pub-id-type="pmid">17466591</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richards</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Culver</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Gaynes</surname>
            <given-names>RP</given-names>
          </name>
        </person-group>
        <article-title>Nosocomial infections in combined medical-surgical intensive care units in the United States</article-title>
        <source>Infect Control Hosp Epidemiol</source>
        <year>2000</year>
        <volume>21</volume>
        <issue>8</issue>
        <fpage>510</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1086/501795</pub-id>
        <pub-id pub-id-type="pmid">10968716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <mixed-citation publication-type="other">NCBI Genome. http://www.ncbi.nlm.nih.gov/genome.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <mixed-citation publication-type="other">NCBI E-utilities. http://www.ncbi.nlm.nih.gov/books/NBK25501/.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hyatt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>LoCascio</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Land</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Larimer</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Hauser</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>119</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-119</pub-id>
        <pub-id pub-id-type="pmid">20211023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <issue>3</issue>
        <fpage>403</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <mixed-citation publication-type="other">Eddy SR. A probabilistic model of local sequence alignment that simplifies statistical significance estimation. PLoS Comput Biol. 2008; 4(5).</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A new generation of homology search tools based on probabilistic inference</article-title>
        <source>Genome Inform</source>
        <year>2009</year>
        <volume>23</volume>
        <fpage>205</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="pmid">20180275</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benedict</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Henriksen</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Metcalf</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Whitaker</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>ND</given-names>
          </name>
        </person-group>
        <article-title>ITEP: An integrated toolkit for exploration of microbial pan-genomes</article-title>
        <source>BMC Genomics</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>8</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-15-8</pub-id>
        <pub-id pub-id-type="pmid">24387194</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Snipen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ussery</surname>
            <given-names>DW</given-names>
          </name>
        </person-group>
        <article-title>A domain sequence approach to pangenomics: applications to Escherichia coli</article-title>
        <source>F1000 Res</source>
        <year>2012</year>
        <volume>1</volume>
        <issue>19</issue>
        <fpage>1</fpage>
        <lpage>19</lpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chao</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Estimating the population size for capture-recapture data with unequal catchability</article-title>
        <source>Biometrics</source>
        <year>1987</year>
        <volume>43</volume>
        <fpage>783</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.2307/2531532</pub-id>
        <pub-id pub-id-type="pmid">3427163</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hogg</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>FZ</given-names>
          </name>
          <name>
            <surname>Janto</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Boissy</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Keefe</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterization and modelling of the Haemophilus influenzae core- and supra-genomes based on the complete genomic sequences of Rd and 12 clinical nontypeable strains</article-title>
        <source>Genome Biol</source>
        <year>2007</year>
        <volume>8</volume>
        <issue>6</issue>
        <fpage>R103</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2007-8-6-r103</pub-id>
        <pub-id pub-id-type="pmid">17550610</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Snipen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Almœy</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ussery</surname>
            <given-names>DW</given-names>
          </name>
        </person-group>
        <article-title>Microbial comparative pan-genomics using binomial mixture models</article-title>
        <source>BMC Genomics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>385</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-10-385</pub-id>
        <pub-id pub-id-type="pmid">19691844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tettelin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Riley</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cattuto</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Medini</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Comparative genomics: the bacterial pan-genome</article-title>
        <source>Curr Opinions Microbiol</source>
        <year>2008</year>
        <volume>12</volume>
        <fpage>472</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mib.2008.09.006</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kislyuk</surname>
            <given-names>AO</given-names>
          </name>
          <name>
            <surname>Haegeman</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Weitz</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Genomic fluidity: an integrative view of gene diversity within microbial populations</article-title>
        <source>BMC Genomics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>32</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-12-32</pub-id>
        <pub-id pub-id-type="pmid">21232151</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Snipen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ussery</surname>
            <given-names>DW</given-names>
          </name>
        </person-group>
        <article-title>Standard operating procedure for computing pangenome trees</article-title>
        <source>Stand Genomic Sci</source>
        <year>2010</year>
        <volume>2</volume>
        <fpage>135</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.4056/sigs.38923</pub-id>
        <pub-id pub-id-type="pmid">21304685</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finn</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Mistry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tate</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Coggill</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Heger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pollington</surname>
            <given-names>JE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Pfam protein families database</article-title>
        <source>Nucleic Acid Res</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>D211</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp985</pub-id>
        <pub-id pub-id-type="pmid">19920124</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <mixed-citation publication-type="other">Conserved Domains Database. http://www.ncbi.nlm.nih.gov/Structure/cdd/cdd.shtml.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <mixed-citation publication-type="other">InterPro protein sequencee analysis and classification. http://www.ebi.ac.uk/interpro/.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwarz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Estimating the dimension of a model</article-title>
        <source>Ann Stat</source>
        <year>1978</year>
        <volume>6</volume>
        <fpage>461</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1176344136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fisher</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Corbet</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>CB</given-names>
          </name>
        </person-group>
        <article-title>The relation between the number of species and the number of individuals in a random sample of an animal population</article-title>
        <source>J Anim Ecol</source>
        <year>1943</year>
        <volume>12</volume>
        <fpage>42</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.2307/1411</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lapierre</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gogarten</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Estimating the size of the bacterial pan-genome</article-title>
        <source>Trends Genet</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>3</issue>
        <fpage>107</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2008.12.004</pub-id>
        <pub-id pub-id-type="pmid">19168257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lobkovsky</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>YI</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>Estimation of prokaryotic supergenome size and composition from gene frequency distributions</article-title>
        <source>BMC Genomics</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>S14</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-15-S6-S14</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baumdicker</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hess</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Pfaffelhuber</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The infinitely many genes model for the distributed genome of bacteria</article-title>
        <source>Genome Biol Evol</source>
        <year>2012</year>
        <volume>4</volume>
        <issue>4</issue>
        <fpage>443</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="doi">10.1093/gbe/evs016</pub-id>
        <pub-id pub-id-type="pmid">22357598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andersen</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Eriksen</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Morling</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>The discrete Laplace exponential family and estimation of Y-STR haplotype frequencies</article-title>
        <source>J Theor Biol</source>
        <year>2013</year>
        <volume>329</volume>
        <fpage>39</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jtbi.2013.03.009</pub-id>
        <pub-id pub-id-type="pmid">23524164</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <mixed-citation publication-type="other">BioSample database. http://www.ncbi.nlm.nih.gov/biosample/.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kaufman</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rousseeuw</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <source>Finding groups in data: an introduction to cluster analysis</source>
        <year>1990</year>
        <publisher-loc>USA</publisher-loc>
        <publisher-name>John Wiley &amp; Sons, Inc</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feil</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Aanensen</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Hanage</surname>
            <given-names>WP</given-names>
          </name>
          <name>
            <surname>Spratt</surname>
            <given-names>BG</given-names>
          </name>
        </person-group>
        <article-title>eBURST: Inferring patterns of evolutionary descent among clusters of related bacterial genotypes from multilocus sequence typing data</article-title>
        <source>J Bac</source>
        <year>2004</year>
        <volume>186</volume>
        <fpage>1518</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1128/JB.186.5.1518-1530.2004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <mixed-citation publication-type="other">The Comprehensive R Archive Network. <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/">http://cran.r-project.org/</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
