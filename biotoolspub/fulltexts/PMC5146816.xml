<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5146816</article-id>
    <article-id pub-id-type="publisher-id">1407</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-016-1407-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SurvivalGWAS_Power: a user friendly tool for power calculations in pharmacogenetic studies with “time to event” outcomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6981-6962</contrib-id>
        <name>
          <surname>Syed</surname>
          <given-names>Hamzah</given-names>
        </name>
        <address>
          <email>Hamzah.Syed@liverpool.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jorgensen</surname>
          <given-names>Andrea L.</given-names>
        </name>
        <address>
          <email>aljorgen@liverpool.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Morris</surname>
          <given-names>Andrew P.</given-names>
        </name>
        <address>
          <email>apmorris@liverpool.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Department of Biostatistics, University of Liverpool, Liverpool, UK </aff>
      <aff id="Aff2"><label>2</label>Department of Molecular and Clinical Pharmacology, University of Liverpool, Liverpool, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>12</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>12</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <elocation-id>523</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>6</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>12</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Power calculators are currently available for the design of genetic association studies of binary phenotypes and quantitative traits, but not for “time to event” outcomes, which are of particular relevance in pharmacogenetics. With the rapid emergence of pharmacogenetic association studies of single nucleotide polymorphisms (SNPs), and the complexity of clinical outcomes they consider, there is a need for software to perform power calculations of time to event data over a range of design scenarios and analytical methodologies.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We have developed the user friendly software tool SurvivalGWAS_Power to perform power calculations for time to event outcomes over a range of study designs and different analytical approaches. The software calculates the power to detect SNP association with a time to event outcome over a range of study design scenarios. The software enables analyses under a Cox proportional hazards model or Weibull regression model, and can account for treatment and SNP-treatment interaction effects. Simulated data sets can also be generated by SurvivalGWAS_Power to enable analyses with methods that are not currently supported by the power calculator, thereby increasing the flexibility of the software.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>SurvivalGWAS_Power addresses the need for flexible and user-friendly software for power calculations for genetic association studies of time to event outcomes, with particular design features of relevance in pharmacogenetics.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-016-1407-9) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Pharmacogenetics</kwd>
      <kwd>Power calculation</kwd>
      <kwd>Time to event</kwd>
      <kwd>Cox proportional hazards</kwd>
      <kwd>Weibull regression</kwd>
      <kwd>Simulation</kwd>
      <kwd>Censoring</kwd>
      <kwd>SNP-treatment interaction</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id>
            <institution>Wellcome Trust</institution>
          </institution-wrap>
        </funding-source>
        <award-id>WT098017</award-id>
        <principal-award-recipient>
          <name>
            <surname>Morris</surname>
            <given-names>Andrew P.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Power calculations are an essential component of study design, and are readily available for genome-wide association studies (GWAS) of binary phenotypes and quantitative traits [<xref ref-type="bibr" rid="CR1">1</xref>]. However, as yet, software is not available to determine adequate sample size for GWAS of “time to event” outcomes. Such outcomes are of particular relevance in the emerging field of pharmacogenetics, where the event could be death, disease remission, or the occurrence of an adverse drug reaction, for example, after treatment intervention. The most appropriate approach to the analysis of time to event data is through survival modelling, which can allow for censoring because the event has not occurred, or due to patient drop-out, before the end of the study. Software is thus required to enable power calculations for GWAS of time to event outcomes, for alternative analytical models, particularly for pharmacogenetic studies, where the impact of alternative treatments, and potentially their interaction with single nucleotide polymorphisms (SNPs), is often of relevance in the study design.</p>
    <p>The objective of GWAS is to identify SNPs that are associated with outcome, typically at a stringent level of genome-wide significance (defined as <italic>p</italic> &lt; 5 × 10<sup>−8</sup>) [<xref ref-type="bibr" rid="CR2">2</xref>]. SNPs are variations in the DNA sequence and are encoded by genotypes. Genotypes can be represented as AA, AB and BB, where A and B are the two alternative alleles at the SNP. Association of a SNP with outcome can then be assessed within a generalised linear modelling framework, accounting for relevant confounding variables as covariates. It is typical to assume an “additive” genetic model, whereby the effect of the heterozygous AB genotype is intermediate between homozygous AA and BB genotypes. Under this additive model, genotypes are coded according to the number of B alleles carried, such that AA = 0, AB = 1 and BB = 2.</p>
    <p>Currently, software to determine power for GWAS of binary phenotypes and quantitative traits is available. These include the freely available ‘Genetic Power Calculator’, developed by Purcell et al. [<xref ref-type="bibr" rid="CR1">1</xref>], which is a web based platform, and ‘genomeSIM’ developed by Dudek et al. [<xref ref-type="bibr" rid="CR3">3</xref>] for the simulation of large-scale genomic data in population based case-control samples. However, as yet, software for power calculations for GWAS of time to event outcomes is not available. In response to this analytical bottleneck, we have developed the user friendly tool, SurvivalGWAS_Power, which is the first program to implement both data generation and power calculations for GWAS of time to event outcomes. The software is of particular relevance to pharmacogenetic studies, where the design will likely include alternative treatment interventions, and analyses are likely to consider SNP-treatment interaction effects.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>SurvivalGWAS_Power was built using C# and developed as a Windows application, utilising pre-designed frameworks Math.NET and Accord.NET [<xref ref-type="bibr" rid="CR4">4</xref>], for the generation of pharmacogenetic data and statistical analyses, respectively. SurvivalGWAS_Power requires specification of genetic parameters, such as the magnitude of the SNP effect on the outcome and the minor allele frequency (MAF). The varied collection of design scenarios includes adding a recruitment period, SNP-treatment interactions, and/or different censoring options (for example, withdrawal due to an adverse treatment event). We created these pharmacogenomic study designs after a thorough examination of published studies in the literature [<xref ref-type="bibr" rid="CR5">5</xref>], including Charland et al. [<xref ref-type="bibr" rid="CR6">6</xref>], Depta et al. [<xref ref-type="bibr" rid="CR7">7</xref>], Wiese et al. [<xref ref-type="bibr" rid="CR8">8</xref>], and Absenger et al. [<xref ref-type="bibr" rid="CR9">9</xref>]. The power calculation is performed by simulating multiple datasets based on the user specified parameter settings and study design options, specifically testing for SNP associations (and SNP-treatment interactions, if required) with the time to event outcome across all simulated datasets. For GWAS, the usual threshold for “genome-wide significance” is <italic>p</italic> &lt; 5 × 10<sup>−8</sup>. However, the software is equally applicable to power calculations for individual SNPs, for which a nominal significance threshold of <italic>p</italic> &lt; 0.05 is appropriate.</p>
    <sec id="Sec3">
      <title>User interface</title>
      <p>The main window consists of two panels, the first for design, analysis and parameter inputs, and the second for all output. The menu bar has a “Save Sample Data” option, as well as another option to store all the datasets from every simulation run. This is useful for those who want to test power for methods not supported by the program. The data are saved as a text file, in R statistical software friendly readable format. The interface has been designed to be user friendly; there are various help buttons to navigate the user through the program in the form of tooltips, and an example of a commonly used pharmacogenetic study design is available as a guide. The inputs are split into two sections: (i) data generation inputs; and (ii) statistical analysis inputs. The user defined parameter inputs are submitted in text boxes.</p>
    </sec>
    <sec id="Sec4">
      <title>Data simulation</title>
      <p>For each replicate of data, a SNP genotype (coded as 0, 1 or 2) is generated for each individual from a binomial distribution dependent on the MAF and assuming Hardy-Weinberg equilibrium. The user is given the option of incorporating an active treatment against a placebo. Treatment allocation is also simulated using a binomial distribution.</p>
      <p>Time to event for each individual is then simulated on the basis of specified model parameters from a Weibull distribution, which allows for the possibility of a deviation from a proportional hazards assumption. The value of the shape parameter, <italic>a</italic>, of the Weibull distribution is specified by the user. A value of <italic>a</italic> &lt; 1 indicates that the failure rate decreases over time. A value of <italic>a</italic> = 1 indicates that the failure rate is constant over time, resulting in proportional hazards. A value of <italic>a</italic> &lt; 1 indicates that the failure rate increases with time. The scale parameter of the Weibull distribution is parameterized to incorporate SNP, treatment, and SNP-treatment interaction effects in generating time to event for each individual. Specifically, the scale parameter for the <italic>i</italic>th individual is given by, <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {b}_i={d}_0{e}^{\beta_s{S}_i+{\beta}_x{x}_i+{\beta}_{\gamma }{S}_i{x}_i} $$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>γ</mml:mi></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2016_1407_Article_IEq1.gif"/></alternatives></inline-formula>, where <italic>x</italic>
<sub><italic>i</italic></sub> is the treatment covariate (coded as 0/1 for placebo/active), <italic>S</italic>
<sub><italic>i</italic></sub> is the SNP genotype coded under an additive model for the minor allele. The value of the “baseline” scale parameter <italic>d</italic>
<sub>0</sub>, is specified by the user. The parameters <italic>β</italic>
<sub><italic>s</italic></sub> and <italic>β</italic>
<sub><italic>x</italic></sub> are the effect on log-hazard of the minor allele at the SNP, and the treatment effect, respectively, and <italic>β</italic>
<sub><italic>γ</italic></sub> is the interaction effect between the SNP and treatment. The values of each of these parameters are also specified by the user.</p>
      <p>The simulated observed time to event outcome is generated for the following possible study design scenarios, each of which include the option of incorporating treatment and SNP-treatment interaction effects. In all scenarios, the simulated time to event of the <italic>i</italic>th individual is denoted <italic>t</italic>
<sub><italic>i</italic></sub>, and the observed event time (after censoring) is denoted <italic>δ</italic>
<sub><italic>i</italic></sub>.<list list-type="bullet"><list-item><p>Scenario 1-End of study censoring.</p><p>This scenario is designed based on a user specified and fixed end of study time, Z. If the event occurs before the end of the study and due to this scenario not including censoring before time Z, the observed event time for the <italic>i</italic>th individual is <italic>δ</italic>
<sub><italic>i</italic></sub> = <italic>t</italic>
<sub><italic>i</italic></sub>; otherwise <italic>δ</italic>
<sub><italic>i</italic></sub> = <italic>Z</italic>.</p></list-item><list-item><p>Scenario 2-Censoring during the study period and at end of study.</p><p>The censoring time of the <italic>i</italic>th individual, <italic>c</italic>
<sub><italic>i</italic></sub>, is simulated from a Weibull distribution with a user defined scale parameter and a fixed shape parameter of 1. Small values of the scale parameter will generate more censored observations. If censoring occurs before the end of the study, the individual is assumed to have dropped out at that time, thus <italic>δ</italic>
<sub><italic>i</italic></sub> = <italic>c</italic>
<sub><italic>i</italic></sub>. If censoring occurs after the end of the study, yet the event occurred before the end of the study, then the observed event time for the <italic>i</italic>th individual is <italic>δ</italic>
<sub><italic>i</italic></sub> = <italic>t</italic>
<sub><italic>i</italic></sub> − <italic>r</italic>
<sub><italic>i</italic></sub>; otherwise <italic>δ</italic>
<sub><italic>i</italic></sub> = <italic>Z</italic> − <italic>r</italic>
<sub><italic>i</italic></sub>.</p></list-item><list-item><p>Scenario 3-Recruitment period and end of study censoring.</p><p>The recruitment time, <italic>r</italic>
<sub><italic>i</italic></sub>, is simulated from a discrete uniform distribution between 0 and a specified end time. There is no censoring before the end of the study and if the event occurs before the end of the study the observed event time for the <italic>i</italic>th individual is <italic>δ</italic>
<sub><italic>i</italic></sub> = <italic>t</italic>
<sub><italic>i</italic></sub> − <italic>r</italic>
<sub><italic>i</italic></sub>; otherwise <italic>δ</italic>
<sub><italic>i</italic></sub> = <italic>Z</italic> − <italic>r</italic>
<sub><italic>i</italic></sub>.</p></list-item><list-item><p>Scenario 4-Censoring during the study period and at the end of study with a recruitment period.</p><p>The censoring time of the <italic>i</italic>th individual, <italic>c</italic>
<sub><italic>i</italic></sub>, is simulated from a Weibull distribution with a user defined scale parameter and a fixed shape parameter of 1. If censoring does not occur before the end of study, and an event has occurred, an individual will have observed time <italic>δ</italic>
<sub><italic>i</italic></sub> = <italic>t</italic>
<sub><italic>i</italic></sub>–<italic>r</italic>
<sub><italic>i</italic></sub>, unless censored at the end of study, then <italic>δ</italic>
<sub><italic>i</italic></sub> = <italic>Z</italic> − <italic>r</italic>
<sub><italic>i</italic></sub>. If censoring does occur during the study period, then <italic>δ</italic>
<sub><italic>i</italic></sub> = <italic>c</italic>
<sub><italic>i</italic></sub> − <italic>r</italic>
<sub><italic>i</italic></sub>.</p></list-item></list>
</p>
    </sec>
    <sec id="Sec5">
      <title>Analysis</title>
      <p>There are two options to compare when running the analysis; (i) a Cox proportional hazards model and (ii) a Weibull regression model. Users can select between running their choice of analysis model by fitting: (i) the SNP alone; (ii) the SNP and treatment; or (iii) the SNP, treatment and SNP-treatment interaction.</p>
      <p>The Cox proportional hazards regression model is the most extensively used analysis of time to event outcomes. It is a semi-parametric model that assumes that the hazard functions of individuals are proportional over time. The framework Accord.Net has a built in Cox proportional hazards function, which calculates the partial likelihood and obtains parameter estimates and Wald test <italic>p</italic>-value.</p>
      <p>The Weibull regression model is parametric with completely specified hazard and survivor functions, and is beneficial in scenarios where the hazard is not proportional or has an accelerated failure time feature. We obtain maximum likelihood estimates of model parameters using an iterative Newton-Raphson method, the full derivation of which is presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec6">
      <title>Validation</title>
      <p>The user interface implements a validation system to track user errors at input. As the user inputs values into parameter textboxes, the error provider will check that the entered values are valid. Before the power calculation begins, the error provider will check that all required information has been entered for a selected scenario. For example, the user cannot select treatment as an analysis covariate if a treatment effect has not been included in the simulation model. The workflow is presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Workflow diagram of software functionality</p></caption><graphic xlink:href="12859_2016_1407_Fig1_HTML" id="MO1"/></fig>
</p>
    </sec>
    <sec id="Sec7">
      <title>Output</title>
      <p>The output comprises of a sample dataset, a table of the analysis output for each simulation run and two histograms of parameters across simulations: (i) coefficient values for the SNP effect from the regression model; and (ii) ‐ <italic>log</italic>
<sub>10</sub> Wald <italic>p</italic>-values for the SNP effect. All histograms can be saved by right clicking the graph and selecting “save as image”. Power, at the specified significance threshold, <italic>φ</italic>, is approximated by the proportion of replicates for which <italic>p</italic> &lt; <italic>φ</italic> for the SNP effect on outcome. Power, at the same significance threshold, is also calculated for the SNP-treatment interaction effect, if this term is included in the analysis model.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results</title>
    <p>SurvivalGWAS_Power can simulate a large number of datasets to enable efficient estimation of power based on specified model parameters and design scenarios. We present the results of example power calculations for two similar scenarios to demonstrate the utility of the software.</p>
    <p>Figure <xref rid="Fig2" ref-type="fig">2</xref> presents the input parameter tab of the software. The example demonstrates a scenario with censoring during the study period and at the end of the study, and including a recruitment period. Here we have considered SNP and treatment main effects and a SNP-treatment interaction effect in simulating event times. However, in the analysis, we have only considered the SNP main effect. Specifically, a Weibull regression model is implemented for analysis to test the SNP association (i.e. the null hypothesis H<sub>0</sub> : <italic>β</italic>
<sub><italic>s</italic></sub> = 0 against the alternative H<sub>A</sub> : <italic>β</italic>
<sub><italic>s</italic></sub> ≠ 0), for which power is estimated to be 90% at a significance threshold of <italic>p</italic> &lt; 0.05.<fig id="Fig2"><label>Fig. 2</label><caption><p>Front end of SurvivalGWAS_Power. Legend: Input parameter tab for simulations and analysis. Depicting a scenario with only a SNP effect analysed, censoring and a recruitment period</p></caption><graphic xlink:href="12859_2016_1407_Fig2_HTML" id="MO2"/></fig>
</p>
    <p>Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the additional output from the analysis. This is the output from the setup shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The left histogram shows the distribution of estimated SNP effect sizes across simulations, which in this example are centred around 0.5, and not the true effect size of 0.4. This bias occurs as the data are simulated with treatment and SNP-treatment interaction effects, but the analysis model does not take these into account.<fig id="Fig3"><label>Fig. 3</label><caption><p>Output tab of SurvivalGWAS_Power. Legend: Output from example power calculation. (<italic>Top left</italic>) sample dataset, (<italic>Top right</italic>) Parameter estimates of the SNP effect from each simulation run, (<italic>Bottom left</italic>) histogram of SNP coefficient beta effects across simulations &amp; (<italic>Bottom right</italic>) histogram of ‐ <italic>log</italic>
<sub>10</sub>
<italic>p</italic>-values for the SNP effect across simulations</p></caption><graphic xlink:href="12859_2016_1407_Fig3_HTML" id="MO3"/></fig>
</p>
    <p>Figure <xref rid="Fig4" ref-type="fig">4</xref> presents the input parameter tab of the software with an alternative scenario to Fig. <xref rid="Fig2" ref-type="fig">2</xref>. We have used the same simulation model as in the previous example, including censoring during the study period and at end of study with a recruitment period. Here we have also considered SNP and treatment main effects and a SNP-treatment interaction effect in simulating event times. However, in the analysis, we have considered the SNP main effect along with treatment and an interaction effect. A Weibull regression model is implemented for analysis to test: (i) the null hypothesis H<sub>0</sub> : <italic>β</italic>
<sub><italic>s</italic></sub> = 0 against the alternative H<sub>A</sub> : <italic>β</italic>
<sub><italic>s</italic></sub> ≠ 0, for which power is estimated to be 54% at a significance threshold of <italic>p</italic> &lt; 0.05; and (ii) the null hypothesis H<sub>0</sub> : <italic>β</italic>
<sub><italic>γ</italic></sub> = 0 against the alternative H<sub>A</sub> : <italic>β</italic>
<sub><italic>γ</italic></sub> ≠ 0, for which power is estimated to be 0% at a significance threshold of <italic>p</italic> &lt; 0.05.<fig id="Fig4"><label>Fig. 4</label><caption><p>Front end of SurvivalGWAS_Power. Legend: Input parameter tab for simulations and analysis. Depicting a scenario with a SNP effect, treatment and interaction effect analysed, censoring and a recruitment period</p></caption><graphic xlink:href="12859_2016_1407_Fig4_HTML" id="MO4"/></fig>
</p>
    <p>Figure <xref rid="Fig5" ref-type="fig">5</xref> shows the additional output from the analysis. This is the output from the setup shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. The left histogram shows the distribution of estimated SNP effect sizes across simulations, which in this example are centred around 0.4. Unlike the previous example, the effect estimates are now unbiased because the correct analysis model is fitted by accounting for treatment and SNP-treatment interaction effects.<fig id="Fig5"><label>Fig. 5</label><caption><p>Output tab of SurvivalGWAS_Power. Legend: Output from example power calculation. (<italic>Top left</italic>) sample dataset, (<italic>Top right</italic>) Parameter estimates of the SNP effect from each simulation run, (<italic>Bottom left</italic>) histogram of SNP coefficient beta effects across simulations &amp; (<italic>Bottom right</italic>) histogram of ‐ <italic>log</italic>
<sub>10</sub>
<italic>p</italic>-values for the SNP effect across simulations</p></caption><graphic xlink:href="12859_2016_1407_Fig5_HTML" id="MO5"/></fig>
</p>
    <sec id="Sec9">
      <title>Performance</title>
      <p>Figure <xref rid="Fig6" ref-type="fig">6</xref> presents run times of SurvivalGWAS_Power under two different analyses as a function of the number of simulations: (i) SNP effect only; and (ii) SNP effect, treatment effect and SNP-treatment interaction. Results are presented for a Cox proportional hazards model and Weibull regression model, for a sample size of 1000 individuals and a scenario with censoring but no recruitment period.<fig id="Fig6"><label>Fig. 6</label><caption><p>Performance graph—Sample size of 1000 with censoring. Legend: Performance of SurvivalGWAS_Power comparing alternative regression models. Sample size of 1000 used for each simulation</p></caption><graphic xlink:href="12859_2016_1407_Fig6_HTML" id="MO6"/></fig>
</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Conclusions</title>
    <p>SurvivalGWAS_Power effectively and efficiently estimates the power of the Cox proportional hazards model and Weibull regression model under a variety of pharmacogenetic settings. Specifically, we allow for testing of SNP main effects (i.e. testing the null hypothesis <italic>H</italic>
<sub>0</sub> : <italic>β</italic>
<sub><italic>s</italic></sub> = 0 against the alternative H<sub>A</sub> : <italic>β</italic>
<sub><italic>s</italic></sub> ≠ 0) and SNP-treatment interaction effects (i.e. testing the null hypothesis H<sub>0</sub> : <italic>β</italic>
<sub><italic>γ</italic></sub> = 0 against the alternative H<sub>A</sub> : <italic>β</italic>
<sub><italic>s</italic></sub> ≠ 0).</p>
    <p>The software offers the option for users to simulate data and use other programs such as R for analysis. For example, Uno et al. [<xref ref-type="bibr" rid="CR10">10</xref>] have demonstrated that, where the proportional hazards assumption is invalid, the use of the Cox proportional hazards method will produce a loss in power to detect associations. They propose using alternative robust measures for the difference between survival curves instead of parametric models. The flexibility of our software enables generation of time to event data under models with non-proportional hazards that can be exported for association testing with methods not supported by our power calculator.</p>
    <p>SurvivalGWAS_Power is important as it is the first genetic data simulator with time to event outcomes, and the first to enable estimation of power for multiple pharmacogenetic designs and analysis methods. However, the software is not limited to pharmacogenetic designs: for example, the treatment can be used to represent any binary covariate. This adds flexibility to the software for application to general GWAS of time to event outcomes.</p>
    <p>In summary, this application offers a much needed user-friendly and flexible software tool for power calculations for time to event outcomes in pharmacogenetic association study designs.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec11">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="12859_2016_1407_MOESM1_ESM.docx" id="MOESM1">
            <label>Additional file 1:</label>
            <caption>
              <p>Details of Weibull regression model. (DOCX 14 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>GWAS</term>
        <def>
          <p>Genome-wide association studies</p>
        </def>
      </def-item>
      <def-item>
        <term>MAF</term>
        <def>
          <p>Minor allele frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>SNPs</term>
        <def>
          <p>Single nucleotide polymorphisms</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Duncan Appelbe of the Department of Biostatistics at the University of Liverpool for his help and guidance with C#.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p>APM is a Wellcome Trust Senior Fellow in Basic Biomedical Science (under award WT098017). Funding for open access charge: Wellcome Trust.</p>
    </sec>
    <sec id="FPar2">
      <title>Availability of data and materials</title>
      <p>Project name: SurvivalGWAS_Power (Pharmacogenetic Power Calculator for Time to Event Studies).</p>
      <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.liverpool.ac.uk/translational-medicine/research/statistical-genetics/software/">https://www.liverpool.ac.uk/translational-medicine/research/statistical-genetics/software/</ext-link>.</p>
      <p>Operating system(s): Windows.</p>
      <p>Programming language: C#.</p>
      <p>Other requirements: None.</p>
      <p>License: GNU General Public License, version 3 (GPL-3.0).</p>
      <p>Any restrictions to use by non-academics: None.</p>
    </sec>
    <sec id="FPar3">
      <title>Authors’ contributions</title>
      <p>HS carried out the investigation of commonly used pharmacogenetic study designs, coded and developed the software, debugged and tested the software and drafted the manuscript. ALJ tested the software and helped to draft the manuscript. APM participated in the design and coordination of the software and helped to draft the manuscript. All authors read and approved the final manuscript.</p>
    </sec>
    <sec id="FPar4">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar5">
      <title>Consent for publication</title>
      <p>Not Applicable.</p>
    </sec>
    <sec id="FPar6">
      <title>Ethics approval and consent to participate</title>
      <p>Not Applicable.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Purcell</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cherny</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Sham</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Genetic power calculator: design of linkage and association genetic mapping studies of complex traits</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>149</fpage>
        <lpage>150</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/19.1.149</pub-id>
        <?supplied-pmid 12499305?>
        <pub-id pub-id-type="pmid">12499305</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clarke</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Pettersson</surname>
            <given-names>FH</given-names>
          </name>
          <name>
            <surname>Cardon</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Zondervan</surname>
            <given-names>KT</given-names>
          </name>
        </person-group>
        <article-title>Basic statistical analysis in genetic case-control studies</article-title>
        <source>Nat protoc</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>121</fpage>
        <lpage>133</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2010.182</pub-id>
        <?supplied-pmid 21293453?>
        <pub-id pub-id-type="pmid">21293453</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dudek</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Motsinger</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Velez</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Ritchie</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Data simulation software for whole-genome association and other studies in human genetics</article-title>
        <source>Scott Pacific Symposium Biocomputing</source>
        <year>2006</year>
        <volume>11</volume>
        <fpage>499</fpage>
        <lpage>510</lpage>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Souza CR, “The Accord.NET Framework,” <ext-link ext-link-type="uri" xlink:href="http://accord-framework.net/">http://accord-framework.net</ext-link>. São Carlos, Brazil. December 2014.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Syed H, Jorgensen AL, Morris AP. Evaluation of methodology for the analysis of “time-to-event” data in pharmacogenomic genome-wide association studies. Pharmacogenomics. 2016; doi:10.2217/pgs.16.19.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Charland</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Agatep</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Herrera</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Schrader</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Frueh</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Ryvkin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shabbeer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Devlin</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Superko</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Stanek</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <article-title>Providing patients with pharmacogenomic test results affects adherence to statin therapy: results of the additional KIF6 risk offers better adherence to statins (AKROBATS) trial</article-title>
        <source>Pharmacogenomics J</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>272</fpage>
        <lpage>280</lpage>
        <pub-id pub-id-type="doi">10.1038/tpj.2013.27</pub-id>
        <?supplied-pmid 23979174?>
        <pub-id pub-id-type="pmid">23979174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Depta</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Lenzini</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Lanfear</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>TY</given-names>
          </name>
          <name>
            <surname>Spertus</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Bach</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Cresci</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Clinical outcomes associated with proton pump inhibitor use among clopidogrel-treated patients within CYP2C19 genotype groups following acute myocardial infarction</article-title>
        <source>Pharmacogenomics J</source>
        <year>2015</year>
        <volume>15</volume>
        <fpage>20</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1038/tpj.2014.28</pub-id>
        <?supplied-pmid 25001880?>
        <pub-id pub-id-type="pmid">25001880</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wiese</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Alotaibi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>O’Doherty</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sorich</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Suppiah</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Cleland</surname>
            <given-names>LG</given-names>
          </name>
          <name>
            <surname>Proudman</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>Pharmacogenomics of NAT2 and ABCG2 influence the toxicity and efficacy of sulphasalazine containing DMARD regimens in early rheumatoid arthritis</article-title>
        <source>Pharmacogenomics j</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>350</fpage>
        <lpage>355</lpage>
        <pub-id pub-id-type="doi">10.1038/tpj.2013.45</pub-id>
        <?supplied-pmid 24394199?>
        <pub-id pub-id-type="pmid">24394199</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Absenger</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Benhaim</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Szkandera</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Labonte</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Pichler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stotz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Samonigg</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Renner</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Gerger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lenz</surname>
            <given-names>HJ</given-names>
          </name>
        </person-group>
        <article-title>The cyclin D1 (CCND1) rs9344 G4A polymorphism predicts clinical outcome in colon cancer patients treated with adjuvant 5-FU-based chemotherapy</article-title>
        <source>Pharmacogenomics j</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>130</fpage>
        <lpage>134</lpage>
        <pub-id pub-id-type="doi">10.1038/tpj.2013.15</pub-id>
        <?supplied-pmid 23567490?>
        <pub-id pub-id-type="pmid">23567490</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Uno</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Claggett</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Inoue</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gallo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Miyata</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schrag</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Takeuchi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Uyama</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Skali</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Solomon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jacobus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Packer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Moving beyond the hazard ratio in quantifying the between-group difference in survival analysis</article-title>
        <source>J clin oncol</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>2380</fpage>
        <lpage>2385</lpage>
        <pub-id pub-id-type="doi">10.1200/JCO.2014.55.2208</pub-id>
        <?supplied-pmid 24982461?>
        <pub-id pub-id-type="pmid">24982461</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
