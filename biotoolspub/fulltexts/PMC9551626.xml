<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pone.0275818.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS One</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9551626</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0275818</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-22-18805</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Optics</subject>
            <subj-group>
              <subject>Holography</subject>
              <subj-group>
                <subject>Holograms</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Fourier Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Waves</subject>
            <subj-group>
              <subject>Wave Interference</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Waves</subject>
            <subj-group>
              <subject>Diffraction</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Equipment</subject>
          <subj-group>
            <subject>Optical Equipment</subject>
            <subj-group>
              <subject>Optical Lenses</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Geometry</subject>
            <subj-group>
              <subject>Radii</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Crystallographic Techniques</subject>
          <subj-group>
            <subject>Phase Determination</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">pyDHM</italic>: A Python library for applications in digital holographic microscopy</article-title>
      <alt-title alt-title-type="running-head">pyDHM: A Python library for applications in Digital Holographic Microscopy</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Castañeda</surname>
          <given-names>Raul</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1007-5028</contrib-id>
        <name>
          <surname>Trujillo</surname>
          <given-names>Carlos</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0448-376X</contrib-id>
        <name>
          <surname>Doblas</surname>
          <given-names>Ana</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Optical Imaging Research Laboratory, Department of Electrical and Computer Engineering, The University of Memphis, Memphis, TN, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Applied Optics Group, School of Applied Sciences and Engineering, Universidad EAFIT, Medellin, Colombia</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Carretero</surname>
          <given-names>Luis</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Universidad Miguel Hernandez de Elche, SPAIN</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>adoblas@memphis.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>17</volume>
    <issue>10</issue>
    <elocation-id>e0275818</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>9</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 Castañeda et al</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Castañeda et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0275818.pdf"/>
    <abstract>
      <p><italic toggle="yes">pyDHM</italic> is an open-source Python library aimed at Digital Holographic Microscopy (DHM) applications. The <italic toggle="yes">pyDHM</italic> is a user-friendly library written in the robust programming language of Python that provides a set of numerical processing algorithms for reconstructing amplitude and phase images for a broad range of optical DHM configurations. The <italic toggle="yes">pyDHM</italic> implements phase-shifting approaches for in-line and slightly off-axis systems and enables phase compensation for telecentric and non-telecentric systems. In addition, <italic toggle="yes">pyDHM</italic> includes three propagation algorithms for numerical focusing complex amplitude distributions in DHM and digital holography (DH) setups. We have validated the library using numerical and experimental holograms.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2042563</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0448-376X</contrib-id>
          <name>
            <surname>Doblas</surname>
            <given-names>Ana</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100013404</institution-id>
            <institution>Universidad EAFIT</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1007-5028</contrib-id>
          <name>
            <surname>Trujillo</surname>
            <given-names>Carlos</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This research was partially funded by the Vicerrectoría de Ciencia, Tecnología e Innovación from Universidad EAFIT, and National Science Foundation (NSF) grant number 2042563. The funders had no role in library design, implementation and validation, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="8"/>
      <table-count count="4"/>
      <page-count count="23"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The pyDHM library, documentation, and the holograms used are publicly available on GitHub (<ext-link xlink:href="https://catrujilla.github.io/pyDHM/" ext-link-type="uri">https://catrujilla.github.io/pyDHM/</ext-link> and <ext-link xlink:href="https://github.com/catrujilla/pyDHM" ext-link-type="uri">https://github.com/catrujilla/pyDHM</ext-link>). The GitHub repository also includes troubleshooting guidelines for the correct use of the library and some instructional videos (<ext-link xlink:href="https://youtu.be/h76nZM6JpXo" ext-link-type="uri">https://youtu.be/h76nZM6JpXo</ext-link>, <ext-link xlink:href="https://youtu.be/Z9o0ODe1lUQ" ext-link-type="uri">https://youtu.be/Z9o0ODe1lUQ</ext-link>, <ext-link xlink:href="https://youtu.be/CMHbF0uoWDk" ext-link-type="uri">https://youtu.be/CMHbF0uoWDk</ext-link>, and <ext-link xlink:href="https://youtu.be/CMHbF0uoWDk" ext-link-type="uri">https://youtu.be/CMHbF0uoWDk</ext-link>) on how to install and use the library.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The pyDHM library, documentation, and the holograms used are publicly available on GitHub (<ext-link xlink:href="https://catrujilla.github.io/pyDHM/" ext-link-type="uri">https://catrujilla.github.io/pyDHM/</ext-link> and <ext-link xlink:href="https://github.com/catrujilla/pyDHM" ext-link-type="uri">https://github.com/catrujilla/pyDHM</ext-link>). The GitHub repository also includes troubleshooting guidelines for the correct use of the library and some instructional videos (<ext-link xlink:href="https://youtu.be/h76nZM6JpXo" ext-link-type="uri">https://youtu.be/h76nZM6JpXo</ext-link>, <ext-link xlink:href="https://youtu.be/Z9o0ODe1lUQ" ext-link-type="uri">https://youtu.be/Z9o0ODe1lUQ</ext-link>, <ext-link xlink:href="https://youtu.be/CMHbF0uoWDk" ext-link-type="uri">https://youtu.be/CMHbF0uoWDk</ext-link>, and <ext-link xlink:href="https://youtu.be/CMHbF0uoWDk" ext-link-type="uri">https://youtu.be/CMHbF0uoWDk</ext-link>) on how to install and use the library.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>1. Introduction</title>
    <p>Digital holographic microscopes (DHMs) have been widely applied in material and biological applications. For instance, among many biological and biomedical applications [<xref rid="pone.0275818.ref001" ref-type="bibr">1</xref>–<xref rid="pone.0275818.ref004" ref-type="bibr">4</xref>], DHM systems are used for analyzing cells and tissues [<xref rid="pone.0275818.ref004" ref-type="bibr">4</xref>–<xref rid="pone.0275818.ref008" ref-type="bibr">8</xref>], as well as disease diagnosis and screening [<xref rid="pone.0275818.ref004" ref-type="bibr">4</xref>, <xref rid="pone.0275818.ref009" ref-type="bibr">9</xref>–<xref rid="pone.0275818.ref011" ref-type="bibr">11</xref>] and assessing the polarimetric properties of biomedical samples[<xref rid="pone.0275818.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0275818.ref013" ref-type="bibr">13</xref>]. In material science, DHM systems have been used to measure MEMs [<xref rid="pone.0275818.ref014" ref-type="bibr">14</xref>–<xref rid="pone.0275818.ref019" ref-type="bibr">19</xref>], detect and characterize defects [<xref rid="pone.0275818.ref020" ref-type="bibr">20</xref>], as well as to characterize surface topography [<xref rid="pone.0275818.ref021" ref-type="bibr">21</xref>–<xref rid="pone.0275818.ref023" ref-type="bibr">23</xref>]. The performance of DHM technologies relies heavily on computational reconstruction processing to provide trustworthy sample information. The required computational reconstruction algorithms are uniquely dependent on the optical configuration of the DHM system. An incorrect selection of the reconstruction algorithms leads to distorted and inaccurate amplitude and phase measurements. DHM systems record the interference pattern (e.g., hologram) generated between the scattered light from the sample, named object wavefront, and a known reference wavefront. DHM systems operate in off-axis, slightly off-axis, or in-line (also known as on-axis) configurations based on the interference angle. Therefore, the selection of the DHM reconstruction algorithms depends on this interference angle. For example, off-axis DHM systems enable the reconstruction of the complex amplitude distribution of an object wavefront from a single hologram since the three components of the hologram are entirely separable in the Fourier domain [<xref rid="pone.0275818.ref024" ref-type="bibr">24</xref>, <xref rid="pone.0275818.ref025" ref-type="bibr">25</xref>]. Therefore, the reconstruction algorithm in off-axis DHM systems requires the spatial filtering of the sample frequencies from the hologram’s spectrum. In contrast, the spectral components of a hologram in the Fourier domain overlay totally or partially in in-line and slightly off-axis DHM systems, respectively, requiring the acquisition of multiple phase-shifted holograms and the application of phase-shifting (PS) techniques [<xref rid="pone.0275818.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0275818.ref026" ref-type="bibr">26</xref>] to reconstruct the desired object information. In addition, the selection of the DHM reconstruction algorithms also depends on whether the DHM imaging system operates in telecentric or non-telecentric regimes. DHM systems operating in the telecentric regime only require the interference angle compensation in the off-axis and slightly off-axis configuration. Oppositely, non-telecentric DHM systems should compensate for the spherical phase factor recognized in DHM and associated with a non-telecentric imaging system [<xref rid="pone.0275818.ref027" ref-type="bibr">27</xref>–<xref rid="pone.0275818.ref030" ref-type="bibr">30</xref>]. Finally, the DHM configuration can operate in an image-plane configuration, meaning that in-focus DHM holograms are recorded, so there is no need to apply numerical propagations to focus the amplitude and phase images. However, if out-of-focus holograms are recorded, the user should numerically propagate the complex amplitude distribution to provide in-focus images. Among the different numerical propagation algorithms to reconstruct DHM images, the most used computational approaches in DHM are the angular spectrum for short propagation distances [<xref rid="pone.0275818.ref031" ref-type="bibr">31</xref>, <xref rid="pone.0275818.ref032" ref-type="bibr">32</xref>] and the Fresnel transform algorithm for large propagation distances [<xref rid="pone.0275818.ref033" ref-type="bibr">33</xref>].</p>
    <p>Still, each research group within the DHM community develops and implements its own computational reconstruction algorithms based on its experimental digital holography (DH) and DHM systems. Nonetheless, some research groups have developed and implemented libraries and plugins to address the need for an open-source reconstruction toolbox in DHM and DH. The main difference between DHM and DH systems is the utilization of a microscopic imaging system in the object wave. For example, in 2010, Shimobaba <italic toggle="yes">et al</italic>. developed a numerical library, e.g., the GWO library, for diffraction calculations using a Graphics Processing Unit (GPU) [<xref rid="pone.0275818.ref034" ref-type="bibr">34</xref>]. This GWO library enabled the numerical propagation of complex amplitude distributions using the angular spectrum and Fresnel approaches. Since the GWO library was based on the C language and, consequently, was not user-friendly, in 2012, the same authors developed a new C++ class library for diffraction and calculations using computer-generated holograms (CGHs) [<xref rid="pone.0275818.ref035" ref-type="bibr">35</xref>]. In 2015, Piedrahita-Quintero <italic toggle="yes">et al</italic>. developed a JAVA plugin for numerical wavefields propagation [<xref rid="pone.0275818.ref036" ref-type="bibr">36</xref>]. This plugin enabled the propagation of complex amplitude distributions using angular spectrum, Fresnel, and Fresnel–Bluestein approaches. The pluggin’s most important feature is that it is embedded within the well-known open-source software for image processing named ImageJ. Piedrahita-Quintero <italic toggle="yes">et al</italic>. validated their plugging by numerically propagating experimental holograms recorded in off-axis DH and DHM systems. In 2017, the same authors upgraded their previously-developed JAVA-based plugin to a GPU-accelerated library, JDiffraction [<xref rid="pone.0275818.ref037" ref-type="bibr">37</xref>]. The OpenHolo library, developed by Hong <italic toggle="yes">et al</italic>. in 2020, can generate holograms using the most popular CGH algorithms [<xref rid="pone.0275818.ref038" ref-type="bibr">38</xref>]. This library also includes standard tools for holography, like phase unwrapping algorithms and reconstruction algorithms using the Rayleigh-Sommerfeld diffraction integral and the numerical Fresnel propagation algorithm. That same year, Trujillo <italic toggle="yes">et al</italic>. developed an ImageJ-based open-source plugin for in-line digital lensless holographic microscopy (DLHM) [<xref rid="pone.0275818.ref039" ref-type="bibr">39</xref>]. This plugin contains two modules to simulate holograms using the discrete version of the Rayleigh–Somerfield diffraction formula and to reconstruct holograms using the Kirchhoff–Helmholtz diffraction integral. More recently, the Manoharan Lab at Harvard University has implemented the HoloPy library, a Python-based library, to perform scattering and optical propagation theories [<xref rid="pone.0275818.ref040" ref-type="bibr">40</xref>]. Like the JAVA plugin from Trujillo <italic toggle="yes">et al</italic>. [<xref rid="pone.0275818.ref039" ref-type="bibr">39</xref>], the HoloPy library focuses on in-line DLHM systems.</p>
    <p>Despite all these efforts, a library containing the needed computational reconstruction approaches to reconstruct DHM images, regardless of the optical configuration of the system, does not still exist. This paper presents a Python library focused on DHM applications, named <italic toggle="yes">pyDHM</italic>, for reconstructing DHM images for various experimental DHM implementations. We aim to provide the DH and DHM community with a complete set of tools for holographic processing in a widely supported and easy-to-use programming language. The library consists of four packages. The first package contains a set of useful functions, such as calculating the hologram spectrum and displaying the amplitude and phase images. The second package is related to reconstructing in-line and slightly off-axis DHM systems using phase-shifting techniques. The third package reconstructs phase images from off-axis DHM holograms using telecentric and non-telecentric configurations. Finally, the last package includes algorithms for propagating the complex amplitude distribution using the angular spectrum and the Fresnel and Fresnel-Bluestein transform approaches. Our proposed library has been validated with experimental and simulated holograms recorded using different setups.</p>
  </sec>
  <sec id="sec002">
    <title>2. Background: Reconstruction algorithms for different optical DHM configurations</title>
    <p>DHM systems are based on optical interferometry, which involves the digital recording of the interference pattern (e.g., digital hologram) between the complex amplitude distribution scattered by a microscopic object (e.g., the object wavefront) and a uniform reference wavefront. DHM systems are colloquially known as hybrid imaging systems since the final reconstructed amplitude or phase images are obtained after further computational processing of the digital hologram. This second stage, known as the reconstruction stage, depends on the optical configuration of the DHM system. This section thoroughly describes different DHM configurations and their corresponding numerical reconstruction algorithms.</p>
    <p>For simplicity, we have chosen a traditional DHM setup based on a Mach-Zehnder interferometer operating in transmission mode, see <xref rid="pone.0275818.g001" ref-type="fig">Fig 1(A)</xref>. The light generated from a laser of wavelength λ is collimated by a converging lens (CL) and the resultant plane wavefront impinges a cubic beam splitter (BS1) to generate the object (O) and the reference (R) wavefronts. A microscopic imaging system is inserted in the object arm of the DHM system. This microscopic imaging system comprises an infinity-corrected microscopic objective (MO) lens and a tube lens (TL) which forms an image of the wavefront scattered by the microscopic sample with amplitude distribution <italic toggle="yes">o</italic> (<italic toggle="yes">x</italic>,<italic toggle="yes">y</italic>). If the object is set at the front-focal plane (FFP) of the MO lens, the image of the sample whose amplitude distribution is <italic toggle="yes">u</italic><sub><italic toggle="yes">IP</italic></sub> (<italic toggle="yes">x</italic>,<italic toggle="yes">y</italic>) is then obtained at the back-focal plane (BFP) of the TL. This plane is known as the microscope’s image plane (IP). The complex amplitude distribution <italic toggle="yes">u</italic><sub><italic toggle="yes">IP</italic></sub> (<italic toggle="yes">x</italic>,<italic toggle="yes">y</italic>) produced by the microscope at the IP is given by
<disp-formula id="pone.0275818.e001"><alternatives><graphic xlink:href="pone.0275818.e001.jpg" id="pone.0275818.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi>k</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>O</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>C</mml:mi></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mo>[</mml:mo><mml:mrow><mml:mi>o</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>x</mml:mi><mml:mi>M</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mi>y</mml:mi><mml:mi>M</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mo>⊗</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>x</mml:mi><mml:mrow><mml:mi>λ</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mi>y</mml:mi><mml:mrow><mml:mi>λ</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic toggle="yes">k</italic> = 2π/λ is the illumination wavenumber, ⊗<sub>2</sub> denotes the 2D convolution operator, <italic toggle="yes">f</italic><sub><italic toggle="yes">MO</italic></sub> is the focal length of the MO lens, <italic toggle="yes">f</italic><sub><italic toggle="yes">TL</italic></sub> is the focal length of the TL, <italic toggle="yes">d</italic> is the distance between the BFP of the MO and TL lenses (<xref rid="pone.0275818.g001" ref-type="fig">Fig 1</xref>), and <italic toggle="yes">M = —f</italic><sub><italic toggle="yes">TL</italic></sub> / <italic toggle="yes">f</italic><sub><italic toggle="yes">MO</italic></sub> stands for the lateral magnification of the imaging system which does not depend on the distance <italic toggle="yes">d</italic>. <italic toggle="yes">P</italic>(<italic toggle="yes">u</italic>,<italic toggle="yes">v</italic>) is the 2D Fourier transform of the amplitude transmittance of the pupil distribution, <italic toggle="yes">p</italic>(<italic toggle="yes">x</italic>,<italic toggle="yes">y</italic>). The quadratic phase factor <inline-formula id="pone.0275818.e002"><alternatives><graphic xlink:href="pone.0275818.e002.jpg" id="pone.0275818.e002g" position="anchor"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>C</mml:mi></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> with a radius of curvature <inline-formula id="pone.0275818.e003"><alternatives><graphic xlink:href="pone.0275818.e003.jpg" id="pone.0275818.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac bevelled="true"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> is associated with a non-telecentric geometry (<italic toggle="yes">d</italic> ≠ <italic toggle="yes">f</italic><sub><italic toggle="yes">TL</italic></sub>) for the optical microscope. When the microscope operates in the telecentric regime (<italic toggle="yes">d = f</italic><sub><italic toggle="yes">TL</italic></sub>), no quadratic phase factor appears in Eq (<xref rid="pone.0275818.e001" ref-type="disp-formula">1</xref>).</p>
    <fig position="float" id="pone.0275818.g001">
      <object-id pub-id-type="doi">10.1371/journal.pone.0275818.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Scheme of a transmission DHM.</title>
        <p>(a) Optical setup based on a Mach-Zehnder interferometer in which the microscope objective (MO) lens and tube lens (TL) are generally arranged in non-telecentric mode (d ≠ f<sub>TL</sub>). (b)-(d) Classification of the DHM system based on the interference angle between the object and reference waves (in-line, slightly off-axis, and off-axis) based on the Fourier spectrum of the hologram. The size of the DC diffraction order (red circle) is always double the ±1 terms (blue circles) if the DHM system operates in the telecentric regime (d = f<sub>TL</sub>). The system components are: BS1 and BS2, beam-splitters; CL, converging lens; IP, image plane; M1 and M2 mirrors; O, object wavefront; R, reference wavefront.</p>
      </caption>
      <graphic xlink:href="pone.0275818.g001" position="float"/>
    </fig>
    <p>The hologram, captured at any plane from the IP, is the result of the interference between the complex wavefield produced by the microscope at a distance <italic toggle="yes">z</italic> from the IP,
<disp-formula id="pone.0275818.e004"><alternatives><graphic xlink:href="pone.0275818.e004.jpg" id="pone.0275818.e004g" position="anchor"/><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi mathvariant="normal">i</mml:mi><mml:mrow><mml:mi>λ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi>k</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:msup><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo>⊗</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mi mathvariant="normal">exp</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula>
and a tilted plane wavefront,
<disp-formula id="pone.0275818.e005"><alternatives><graphic xlink:href="pone.0275818.e005.jpg" id="pone.0275818.e005g" position="anchor"/><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:msqrt><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">exp</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi>k</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">sin</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula>
where <italic toggle="yes">I</italic><sub><italic toggle="yes">R</italic></sub> is the irradiance of the reference wavefront, and <bold><italic toggle="yes">θ</italic></bold> = (<italic toggle="yes">θ</italic><sub><italic toggle="yes">x</italic></sub>,<italic toggle="yes">θ</italic><sub><italic toggle="yes">y</italic></sub>) is the vector representation of the titled reference angle to the optical axis, which coincides with the center of the object wavefront. In Mach-Zehnder-based DHM systems, this angle can be changed by tilting the optical elements that reflect the reference wavefront <italic toggle="yes">R</italic> (e.g., the BS2 and/or M2 in <xref rid="pone.0275818.g001" ref-type="fig">Fig 1(A))</xref>. The irradiance distribution of the hologram <italic toggle="yes">h</italic>(<italic toggle="yes">x</italic>,<italic toggle="yes">y;z</italic>) is
<disp-formula id="pone.0275818.e006"><alternatives><graphic xlink:href="pone.0275818.e006.jpg" id="pone.0275818.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(4)</label></disp-formula>
where <italic toggle="yes">z</italic> &lt; 0 refers to planes located in front of the IP, |·|<sup>2</sup> represents the square module, and the symbol * stands for the complex conjugate operation. In Eq (<xref rid="pone.0275818.e006" ref-type="disp-formula">4</xref>), the first two terms are related to the irradiance of both object and reference wavefronts. On the other hand, the third and fourth terms in Eq (<xref rid="pone.0275818.e006" ref-type="disp-formula">4</xref>) encode the complex amplitude information of the object wavefront scattered by the sample. These terms represent the object’s real and twin images. From Eq (<xref rid="pone.0275818.e006" ref-type="disp-formula">4</xref>), it is clear that the object information <italic toggle="yes">o</italic>(<italic toggle="yes">x</italic>,<italic toggle="yes">y</italic>), encoded in <italic toggle="yes">u</italic>(<italic toggle="yes">x</italic>,<italic toggle="yes">y</italic>;<italic toggle="yes">z</italic>) is mixed with other undesired terms. The reconstruction algorithms aim to separate these undesired terms from the object information to provide well-contrast amplitude and phase images from the complex in-focus amplitude distribution <italic toggle="yes">u</italic><sub><italic toggle="yes">IP</italic></sub> (<italic toggle="yes">x</italic>,<italic toggle="yes">y</italic>) = <italic toggle="yes">u</italic>(<italic toggle="yes">x</italic>,<italic toggle="yes">y</italic>;<italic toggle="yes">z</italic> = 0) with minimum distortions. Assuming that the reference wavefront is plane, the 2D Fourier transform of the hologram <italic toggle="yes">H</italic>(<italic toggle="yes">u</italic>,<italic toggle="yes">v</italic>;<italic toggle="yes">z</italic>) is
<disp-formula id="pone.0275818.e007"><alternatives><graphic xlink:href="pone.0275818.e007.jpg" id="pone.0275818.e007g" position="anchor"/><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>;</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>;</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow><mml:mi>λ</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow><mml:mi>λ</mml:mi></mml:mfrac><mml:mo>;</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>(</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow><mml:mi>λ</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow><mml:mi>λ</mml:mi></mml:mfrac><mml:mo>;</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(5)</label></disp-formula>
where (<italic toggle="yes">u</italic>,<italic toggle="yes">v</italic>) are the transverse spatial frequencies, <inline-formula id="pone.0275818.e008"><alternatives><graphic xlink:href="pone.0275818.e008.jpg" id="pone.0275818.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:mi>D</mml:mi><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>;</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:msub><mml:mo>*</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:msub><mml:mo>*</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>R</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> being *<sub>2</sub> the 2D cross-correlation operator. The capital letters refer to the 2D Fourier transform distributions to simplify our notation. The spatial frequencies of the DC term are always placed at the center of the hologram spectrum. However, the frequencies of the ±1 terms, respectively the <italic toggle="yes">U</italic>(·) and <italic toggle="yes">U</italic>*(·) terms, are located symmetrically around the DC term at locations that depend on the interference angle <bold><italic toggle="yes">θ</italic></bold> = (<italic toggle="yes">θ</italic><sub><italic toggle="yes">x</italic></sub>,<italic toggle="yes">θ</italic><sub><italic toggle="yes">y</italic></sub>). In other words, the different components of the hologram spectrum may overlap based on the interference angle between the two wavefronts of the DHM system. Knowledge of the hologram’s spectral composition is critical to selecting the reconstruction method. For example, off-axis DHM systems are those in which the angle between the object and reference wavefronts is such that the terms in Eq (<xref rid="pone.0275818.e007" ref-type="disp-formula">5</xref>) are not superimposed [<xref rid="pone.0275818.g001" ref-type="fig">Fig 1(D)</xref>]. The reconstruction method for off-axis DHM systems involves a spatial filtering approach using a single hologram [<xref rid="pone.0275818.ref024" ref-type="bibr">24</xref>, <xref rid="pone.0275818.ref025" ref-type="bibr">25</xref>]. The other extreme case occurs when no interference fringes are observed in the hologram since the interference angle between wavefronts is zero. Therefore, the three terms in Eq (<xref rid="pone.0275818.e007" ref-type="disp-formula">5</xref>) entirely overlap [<xref rid="pone.0275818.g001" ref-type="fig">Fig 1(B)</xref>]. These DHM systems operate in in-line (or on-axis) regime. The third DHM configuration, slightly off-axis DHM systems, lies between these two extremes; the interference angle between both wavefronts is not null but small enough to produce some overlapping between the different components of the hologram spectrum [<xref rid="pone.0275818.g001" ref-type="fig">Fig 1(C)</xref>]. For in-line and slight off-axis DHM systems, the reconstruction algorithms involve phase-shifting (PS) techniques, requiring the recording of multiple holograms in which the phase of the reference wavefront is shifted (e.g., phase-shifted holograms) [<xref rid="pone.0275818.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0275818.ref026" ref-type="bibr">26</xref>]. The main advantage of PS algorithms is that the reconstructed phase images are obtained via point-wise subtractions and division operations between the recorded phase-shifted holograms. Traditionally, PS algorithms are aimed exclusively at strictly in-line DHM systems. We highlight the traditional PS algorithms requiring five, four, and three phase-shifted holograms among the different PS algorithms. In the five- and four-step algorithms, the phase shift between the holograms is π/2. Consequently, the point-wise phase images are reconstructed by
<disp-formula id="pone.0275818.e009"><alternatives><graphic xlink:href="pone.0275818.e009.jpg" id="pone.0275818.e009g" position="anchor"/><mml:math id="M9" display="block" overflow="scroll"><mml:mrow><mml:mi>φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">tan</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>[</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mn>3</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(6)</label></disp-formula>
and
<disp-formula id="pone.0275818.e010"><alternatives><graphic xlink:href="pone.0275818.e010.jpg" id="pone.0275818.e010g" position="anchor"/><mml:math id="M10" display="block" overflow="scroll"><mml:mrow><mml:mi>φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">tan</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mn>3</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(7)</label></disp-formula>
for the five- and four-step algorithms, respectively. The third variable of the hologram distribution in these equations refers to the phase shift of the reference wavefront. For example, <italic toggle="yes">h</italic>(<italic toggle="yes">x</italic>,<italic toggle="yes">y</italic>;3π/2) is a recorded hologram in which there is a phase shift of 3π/2 to the first hologram. One can reconstruct the phase distribution using a three-step PS algorithm with a phase shift of 2π/3 between holograms as
<disp-formula id="pone.0275818.e011"><alternatives><graphic xlink:href="pone.0275818.e011.jpg" id="pone.0275818.e011g" position="anchor"/><mml:math id="M11" display="block" overflow="scroll"><mml:mrow><mml:mi>φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">tan</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mrow><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mfrac><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mn>5</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mn>5</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives><label>(8)</label></disp-formula></p>
    <p>Although the three-step PS algorithm requires fewer holograms, being more suitable for real-time DHM imaging, this implementation is more sensitive to noise than the four- and five-step PS algorithms in experimental conditions. For this reason, four- and five-step algorithms are still used in many phase-shifting DHM configurations.</p>
    <p>Due to the experimental difficulty in perfectly aligning the object and reference wavefronts, thus achieving a strictly in-line setup, slightly off-axis DHM systems are commonly preferred. For slightly off-axis DHM systems, traditional PS algorithms must be modified to compensate for the interference angle between both interfering wavefronts. De Nicola <italic toggle="yes">et al</italic>. proposed a four-step PS strategy with a phase shift of π/2 between consecutive holograms [<xref rid="pone.0275818.ref041" ref-type="bibr">41</xref>]. In this quadrature method, the complex amplitude distribution of the object can be reconstructed by summing the individual products between the recorded holograms and their corresponding digital reference wavefronts
<disp-formula id="pone.0275818.e012"><alternatives><graphic xlink:href="pone.0275818.e012.jpg" id="pone.0275818.e012g" position="anchor"/><mml:math id="M12" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="4.25em"/><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mn>3</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mn>3</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula></p>
    <p>Eq (<xref rid="pone.0275818.e012" ref-type="disp-formula">9</xref>) provides the complex amplitude distribution of the specimen without the DC term and the conjugate image, enabling the computing of amplitude and phase images via <inline-formula id="pone.0275818.e013"><alternatives><graphic xlink:href="pone.0275818.e013.jpg" id="pone.0275818.e013g" position="anchor"/><mml:math id="M13" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> or <inline-formula id="pone.0275818.e014"><alternatives><graphic xlink:href="pone.0275818.e014.jpg" id="pone.0275818.e014g" position="anchor"/><mml:math id="M14" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">atan</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">imag</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">real</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, respectively.</p>
    <p>The main disadvantage of traditional in-line and slightly off-axis PS approaches is that most of these methods require i) accurate knowledge of the phase shift between the recorded holograms, and ii) this phase shift must be equal within the acquisition sequence. These two requirements can be experimentally challenging due to inaccuracies prevalent in most phase-shifting devices, particularly those based on mechanical movements. Several blind PS strategies have been proposed to have multiple holograms with a random and unknown phase shift [<xref rid="pone.0275818.ref042" ref-type="bibr">42</xref>–<xref rid="pone.0275818.ref049" ref-type="bibr">49</xref>]. Among these approaches, we have proposed two blind iterative PS-DHM algorithms for slightly off-axis DHM systems, which are computationally efficient, user-friendly, and robust under noisy conditions [<xref rid="pone.0275818.ref050" ref-type="bibr">50</xref>, <xref rid="pone.0275818.ref051" ref-type="bibr">51</xref>]. These two blind PS-DHM methods are based on the demodulation of the terms composing the Fourier spectrum of the hologram. In particular, the hologram distribution can be understood as a linear combination between three unknown components {<italic toggle="yes">d</italic><sub>0</sub>, <italic toggle="yes">d</italic><sub>+1</sub> and <italic toggle="yes">d</italic><sub>-1</sub>} where the weighting of each component depends on the phase shift: <italic toggle="yes">h = d</italic><sub>0</sub> + e<sup><bold>-j<italic toggle="yes">Δθ</italic></bold></sup> d<sub>+1</sub> + e<sup><bold>j<italic toggle="yes">Δθ</italic></bold></sup>
<italic toggle="yes">d</italic><sub>-1</sub> [<xref rid="pone.0275818.ref050" ref-type="bibr">50</xref>] where <italic toggle="yes">d</italic><sub>0</sub> is the two first terms of Eq (<xref rid="pone.0275818.e006" ref-type="disp-formula">4</xref>), <inline-formula id="pone.0275818.e015"><alternatives><graphic xlink:href="pone.0275818.e015.jpg" id="pone.0275818.e015g" position="anchor"/><mml:math id="M15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>;</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">sin</mml:mi><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>⋅</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pone.0275818.e016"><alternatives><graphic xlink:href="pone.0275818.e016.jpg" id="pone.0275818.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">sin</mml:mi><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>⋅</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, being <bold>x</bold> = (<italic toggle="yes">x</italic>,<italic toggle="yes">y</italic>) the vector representation of the lateral coordinates. Based on this composition of the hologram distribution in terms of {<italic toggle="yes">d</italic><sub>0</sub>, <italic toggle="yes">d</italic><sub>+1,</sub> and <italic toggle="yes">d</italic><sub>-1</sub>}, the object information can be reconstructed from either the <italic toggle="yes">d</italic><sub>+1</sub> or <italic toggle="yes">d</italic><sub>-1</sub> components using three recorded holograms, {<italic toggle="yes">h</italic><sub>1</sub>, <italic toggle="yes">h</italic><sub>2</sub>, <italic toggle="yes">h</italic><sub>3</sub>} with different phase shifts {<italic toggle="yes">Δθ</italic><sub>1</sub>, <italic toggle="yes">Δθ</italic><sub>2</sub>, <italic toggle="yes">Δθ</italic><sub>3</sub>}. Conversely, the hologram can also be written as the sum of two components{<italic toggle="yes">d</italic><sub>0</sub>, <italic toggle="yes">d</italic><sub>3</sub>}: <italic toggle="yes">h = d</italic><sub>0</sub>+e<sup><bold>i<italic toggle="yes">Δθ</italic></bold></sup>
<italic toggle="yes">d</italic><sub>3</sub>, where <italic toggle="yes">d</italic><sub>3</sub>
<italic toggle="yes">= d</italic><sub>+1</sub>+ e<sup><bold>-i2<italic toggle="yes">Δθ</italic></bold></sup><italic toggle="yes">d</italic><sub>-1</sub>, requiring only two holograms with a phase-shift difference of <italic toggle="yes">Δθ</italic> to estimate <italic toggle="yes">d</italic><sub>3</sub> [<xref rid="pone.0275818.ref051" ref-type="bibr">51</xref>]. An accurate estimation of the <italic toggle="yes">d</italic><sub>+1</sub> or <italic toggle="yes">d</italic><sub>3</sub> components involves that the phase shifts used to demodulate the <italic toggle="yes">d</italic><sub>+1</sub> or <italic toggle="yes">d</italic><sub>3</sub> components coincide to the ones of the experimental reference wave. When the values of the phase shifts match the real ones, the spectrum of the <italic toggle="yes">d</italic><sub>0</sub> component is composed of a unique order for the 2- and 3-step blind PS algorithms. The spectrum of the <italic toggle="yes">d</italic><sub>+1</sub> component is also composed of a unique order for the 3-step blind PS algorithm. Our blind PS-DHM approaches take advantage of this observation, e.g., the expected/real composition of the spectrum of the decomposed terms, to estimate jointly the phase steps and the <italic toggle="yes">d</italic><sub>+1</sub> or <italic toggle="yes">d</italic><sub>3</sub> component by minimizing a cost function that quantifies the difference between the absolute value of the Fourier component of the expected/real and residual peaks. Since both algorithms are used for slightly off-axis DHM systems, one must compensate for the linear phase term introduced by the tilted plane reference wave. In addition, the 2-step blind PS algorithm requires the spatial filtering of the spectral frequencies of the <italic toggle="yes">d</italic><sub>+1</sub> term from the spectrum of the demodulated d<sub>3</sub> term. Consequently, the 2-step blind PS approach only works for slightly off-axis DHM systems in which the spectra of the <italic toggle="yes">d</italic><sub>+1</sub> and <italic toggle="yes">d</italic><sub>-1</sub> terms do not overlap in the Fourier domain among them. The major limitation of these approaches is that they only work for DHM systems operating in telecentric regime since the center of the ±1 terms in the Fourier transform should correspond to a maximum value.</p>
    <p>The reconstruction algorithms in in-line and slightly off-axis DHM systems using PS strategies require multiple recorded holograms, restricting the use of those systems for live-cell imaging and dynamic analysis. Therefore, DHM systems operating in an off-axis regime are the most used DHM system for real-time imaging. These systems allow the reconstruction of an object’s amplitude and phase information from a single recorded hologram. The reconstruction algorithms for reconstructing a phase image in off-axis DHM systems involve two steps. The first step is the spatial filtering of the frequencies related to the object from the hologram spectrum. Due to the off-axis configuration, the ±1 diffraction orders are arranged symmetrically around the DC term in the Fourier space [<xref rid="pone.0275818.g001" ref-type="fig">Fig 1(D)</xref>]. From the hologram spectrum [Eq (<xref rid="pone.0275818.e007" ref-type="disp-formula">5</xref>)], the spectral object information (i.e., the +1 term) can be filtered [<xref rid="pone.0275818.ref024" ref-type="bibr">24</xref>].</p>
    <disp-formula id="pone.0275818.e017">
      <alternatives>
        <graphic xlink:href="pone.0275818.e017.jpg" id="pone.0275818.e017g" position="anchor"/>
        <mml:math id="M17" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mi>H</mml:mi>
              <mml:mi>F</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi mathvariant="bold-italic">u</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi>U</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>u</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi mathvariant="normal">sin</mml:mi>
                  <mml:msub>
                    <mml:mi>θ</mml:mi>
                    <mml:mi>x</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mi>λ</mml:mi>
              </mml:mfrac>
              <mml:mo>,</mml:mo>
              <mml:mi>v</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi mathvariant="normal">sin</mml:mi>
                  <mml:msub>
                    <mml:mi>θ</mml:mi>
                    <mml:mi>y</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mi>λ</mml:mi>
              </mml:mfrac>
              <mml:mo>;</mml:mo>
              <mml:mi>z</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </alternatives>
      <label>(10)</label>
    </disp-formula>
    <p>Eq (<xref rid="pone.0275818.e017" ref-type="disp-formula">10</xref>) represents the filtered hologram spectrum, which is the spectrum of the sample displaced at the spatial frequencies (sinθ<sub>x</sub>/λ, sinθ<sub>y</sub>/λ). The amplitude distribution scattered by the sample can be obtained as the absolute value of the inverse Fourier transform of Eq (<xref rid="pone.0275818.e017" ref-type="disp-formula">10</xref>). Whereas the spatial filtering step is sufficient for amplitude imaging, quantitative phase imaging requires the phase compensation of the tilting angle between the object and reference wavefronts (the second step of the reconstruction procedure). The phase compensation of the interference angle can be performed in the space domain by multiplying the inverse Fourier transform of Eq (<xref rid="pone.0275818.e017" ref-type="disp-formula">10</xref>), <italic toggle="yes">h</italic><sub><italic toggle="yes">F</italic></sub>(<bold><italic toggle="yes">x</italic></bold>) and a digital replica of the reference wavefront, <italic toggle="yes">r</italic><sub><italic toggle="yes">D</italic></sub>(<bold><italic toggle="yes">x</italic></bold>) as <inline-formula id="pone.0275818.e018"><alternatives><graphic xlink:href="pone.0275818.e018.jpg" id="pone.0275818.e018g" position="anchor"/><mml:math id="M18" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Assuming a uniform plane reference wavefront, the generation of a digital reference wavefront requires the knowledge of the interference angle <bold><italic toggle="yes">θ</italic></bold> = (<italic toggle="yes">θ</italic><sub><italic toggle="yes">x</italic></sub>,<italic toggle="yes">θ</italic><sub><italic toggle="yes">y</italic></sub>), which depends on the wavelength of the light source, the features of the digital sensor (i.e., <italic toggle="yes">M</italic>×<italic toggle="yes">N</italic> square pixels with pixel size Δ<sub>xy</sub>), and the subtraction between the pixel locations of the DC and the +1 terms in the hologram spectrum [<xref rid="pone.0275818.ref052" ref-type="bibr">52</xref>]. Among these parameters, the only one that is unknown <italic toggle="yes">a-priori</italic> is the location of the +1 term. The determination of this parameter must be precisely executed to provide phase images without phase nuisances. Although this step can be performed manually by generating a set of reconstructed phase images with different phase compensation until the one without sawtooth fringes is obtained, several automated DHM reconstruction approaches [<xref rid="pone.0275818.ref052" ref-type="bibr">52</xref>–<xref rid="pone.0275818.ref056" ref-type="bibr">56</xref>] have been proposed to alleviate this task. Among these works, the <italic toggle="yes">pyDHM</italic> library implements the following three algorithms that are restricted to off-axis DHM systems operating in telecentric regime. The first two algorithms have been coined the full region of interest (ROI) search [<xref rid="pone.0275818.ref053" ref-type="bibr">53</xref>] and efficient ROI search [<xref rid="pone.0275818.ref056" ref-type="bibr">56</xref>] from Trujillo’s laboratory. The third approach has been investigated and developed by Doblas’ laboratory [<xref rid="pone.0275818.ref052" ref-type="bibr">52</xref>]. The main difference between these three algorithms relies on how the search for the optimal parameters of the digital reference wavefront is performed. In Ref. [<xref rid="pone.0275818.ref053" ref-type="bibr">53</xref>], this search is carried out using nested loops in which different spatial frequencies around the point of maximum energy of the +1 diffraction order (region of interest) are used to generate different compensating angles. Then, different digital reference wavefronts are built with these angles to produce different compensated phase maps of the object. The parameters of the reference wavefront yielding the best-compensated phase image are the proposal’s output. A quantification of the number of phase discontinuities, performed via a summation-and-thresholding metric, is employed to determine the best-compensated phase image in Ref. [<xref rid="pone.0275818.ref053" ref-type="bibr">53</xref>]. More efficiently, in Ref. [<xref rid="pone.0275818.ref056" ref-type="bibr">56</xref>], the search involves a heuristic determination of the spatial frequencies inside the region of interest most likely to provide properly compensated phase maps. The latter path-oriented strategy uses only the resulting best-compensated phase map in each fewer-step nested loop until the same metric to quantify phase discontinuities as in Ref. [<xref rid="pone.0275818.ref053" ref-type="bibr">53</xref>] can not be further improved. Finally, in Ref. [<xref rid="pone.0275818.ref052" ref-type="bibr">52</xref>], the search of the parameters of the digital reference wavefront is based on an unconstrained nonlinear optimization procedure involving the minimization of the inverse of the summation-and-thresholding metric as a function of spatial frequencies around the point of maximum energy of the +1 diffraction order.</p>
    <p>In addition to accurately determining the interfering angle between the object and reference wavefronts, the reconstruction algorithms depend on the microscope’s optical configuration. The shape of the ±1 diffraction orders changes between DHM systems operating in telecentric and non-telecentric configurations, depending on the radius of the curvature of the spherical wavefront in Eq (<xref rid="pone.0275818.e001" ref-type="disp-formula">1</xref>), <italic toggle="yes">C</italic><sup>-1</sup>. The smaller the radius of curvature <italic toggle="yes">C</italic>, the wider the ±1 orders, being the area of the ±1 diffraction orders inversely proportional to <italic toggle="yes">C</italic> [<xref rid="pone.0275818.ref057" ref-type="bibr">57</xref>]. <xref rid="pone.0275818.g002" ref-type="fig">Fig 2</xref> illustrates the changes in the size of the ±1 diffraction orders based on the radius of curvature <italic toggle="yes">C</italic>. The ±1 diffraction orders are rectangular-based compact support functions in non-telecentric DHM systems. However, these terms are circular compact support functions in telecentric-based DHM systems whose diameter is related to the resolution of the microscopic imaging system [<xref rid="pone.0275818.ref057" ref-type="bibr">57</xref>], <italic toggle="yes">u</italic><sub>c</sub> = NA/(λ<italic toggle="yes">M</italic>) where NA is the numerical aperture of the MO lens. The reconstructed phase image from a non-telecentric DHM system is distorted by the quadratic phase factor that appears in Eq (<xref rid="pone.0275818.e001" ref-type="disp-formula">1</xref>). Therefore, this quadratic phase factor should be suppressed to reconstruct accurate quantitative phase images in non-telencetric DHM systems. This quadratic phase factor can be suppressed computationally by a point-wise subtraction of the reconstructed phase with and without a sample, e.g., performing a double-exposure technique where two holograms should be recorded [<xref rid="pone.0275818.ref058" ref-type="bibr">58</xref>]. Single-shot computational approaches have also been proposed to eliminate the quadratic phase factor by multiplying the inverse Fourier transform of Eq (<xref rid="pone.0275818.e017" ref-type="disp-formula">10</xref>), <italic toggle="yes">h</italic><sub><italic toggle="yes">F</italic></sub>(<bold><italic toggle="yes">x</italic></bold>), with the conjugated replica of the distorted phase term, <inline-formula id="pone.0275818.e019"><alternatives><graphic xlink:href="pone.0275818.e019.jpg" id="pone.0275818.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:mfrac><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> knowing its center (<italic toggle="yes">x</italic><sub><italic toggle="yes">C</italic></sub>, <italic toggle="yes">y</italic><sub><italic toggle="yes">C</italic></sub>) and radius of curvature (<italic toggle="yes">C</italic>). These parameters can be estimated by analyzing the hologram’s spectrum [<xref rid="pone.0275818.ref059" ref-type="bibr">59</xref>].</p>
    <fig position="float" id="pone.0275818.g002">
      <object-id pub-id-type="doi">10.1371/journal.pone.0275818.g002</object-id>
      <label>Fig 2</label>
      <caption>
        <title>Spreading of the ±1 diffraction orders when the DHM system does not operate in telecentric regime.</title>
      </caption>
      <graphic xlink:href="pone.0275818.g002" position="float"/>
    </fig>
    <p>Finally, numerical propagators of complex wavefields are required in DHM if digital holograms are not recorded at the IP since the object’s reconstructed information must be numerically focused considering the axial distance <italic toggle="yes">z</italic> between the sensor/hologram plane and the in-focus plane [<xref rid="pone.0275818.ref060" ref-type="bibr">60</xref>]. Conventional numerical propagators are based on the angular spectrum or Fresnel Transform approaches [<xref rid="pone.0275818.ref031" ref-type="bibr">31</xref>, <xref rid="pone.0275818.ref032" ref-type="bibr">32</xref>]. The angular spectrum approach represents a complex amplitude wavefront as a combination of infinite plane wavefronts following Huygens’ principle. Therefore, the in-focus complex amplitude distribution can be estimated as
<disp-formula id="pone.0275818.e020"><alternatives><graphic xlink:href="pone.0275818.e020.jpg" id="pone.0275818.e020g" position="anchor"/><mml:math id="M20" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">FT</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>[</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>;</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>•</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:mfrac><mml:mi>z</mml:mi><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(11)</label></disp-formula>
where FT<sup>-1</sup>[<bold>·</bold>] denotes the inverse 2D Fourier transform operator, and <inline-formula id="pone.0275818.e021"><alternatives><graphic xlink:href="pone.0275818.e021.jpg" id="pone.0275818.e021g" position="anchor"/><mml:math id="M21" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the 2D Fourier transform of the reconstructed complex amplitude distribution [<inline-formula id="pone.0275818.e022"><alternatives><graphic xlink:href="pone.0275818.e022.jpg" id="pone.0275818.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>] after applying PS algorithms or spatial filtering and phase compensation the interfering angle. The phase map of the <inline-formula id="pone.0275818.e023"><alternatives><graphic xlink:href="pone.0275818.e023.jpg" id="pone.0275818.e023g" position="anchor"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> distribution should have been compensated for any quadratic phase factor. The Fresnel Transform approach is another method to solve the Fresnel-Kirchhoff diffraction equation using the paraxial approximation [<xref rid="pone.0275818.ref032" ref-type="bibr">32</xref>]. The paraxial approximation involves that the sensor/hologram plane dimensions are smaller than the propagation distance, i.e., large propagation distances. Based on the Fresnel Transform, the relationship between the out-of-focus distribution, <inline-formula id="pone.0275818.e024"><alternatives><graphic xlink:href="pone.0275818.e024.jpg" id="pone.0275818.e024g" position="anchor"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and the in-focus complex amplitude distribution, <inline-formula id="pone.0275818.e025"><alternatives><graphic xlink:href="pone.0275818.e025.jpg" id="pone.0275818.e025g" position="anchor"/><mml:math id="M25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, is expressed as
<disp-formula id="pone.0275818.e026"><alternatives><graphic xlink:href="pone.0275818.e026.jpg" id="pone.0275818.e026g" position="anchor"/><mml:math id="M26" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∬</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>;</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mi mathvariant="normal">exp</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mfrac><mml:mi>π</mml:mi><mml:mrow><mml:mi>λ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mi>z</mml:mi></mml:mfrac><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>y</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives><label>(12)</label></disp-formula></p>
    <p>Some constant phase factors have been neglected in Eq (<xref rid="pone.0275818.e026" ref-type="disp-formula">12</xref>). The third term within the integral in Eq (<xref rid="pone.0275818.e026" ref-type="disp-formula">12</xref>) is related to the kernel of a 2D Fourier transform with frequencies <italic toggle="yes">u = x</italic>/<italic toggle="yes">z</italic> and <italic toggle="yes">v</italic> = <italic toggle="yes">y</italic>/<italic toggle="yes">z</italic>. Although the low-computational complexity of the Fresnel transform enables fast numerical processing, this traditional approach imposes a fixed magnification of the propagated wavefield according to the illumination wavelength and the system’s geometry. A third numerical propagator can be employed to overcome this limitation. In a modified version of the Fresnel approach, the kernel of the Fourier transform in Eq (<xref rid="pone.0275818.e026" ref-type="disp-formula">12</xref>) is modified by inserting the Bluestein substitution [<xref rid="pone.0275818.ref033" ref-type="bibr">33</xref>, <xref rid="pone.0275818.ref061" ref-type="bibr">61</xref>] to convert this expression into a convolution operation in which the magnification of the propagated wavefield can be chosen at will at the expense of higher computational complexity.</p>
    <p>In summary, the DHM numerical processing involves computational strategies dependent on the employed optical configuration. In the proposed <italic toggle="yes">pyDHM</italic> library, we have implemented functions for: i) spatial filtering off-axis holograms, ii) computing complex amplitudes distributions from phase-shifted interferograms in in-line and slightly off-axis setups, iii) compensating the interference angle between interfering wavefronts in off-axis setups, iv) compensating the spherical wavefront of non-telecentric recordings, and v) the propagating complex wavefields to focus non-IP holographic reconstructions.</p>
  </sec>
  <sec id="sec003">
    <title>3. Library structure</title>
    <p>The <italic toggle="yes">pyDHM</italic> library consists of four packages. The first utility package includes essential functions such as reading, displaying images, and filtering Fourier spectrums of holograms. The second package is related to reconstructing in-line and slightly off-axis DHM systems using phase-shifting techniques. The third package reconstructs phase images from off-axis telecentric-based DHM holograms. Finally, the last package includes algorithms for propagating complex amplitude distributions using the angular spectrum and the Fresnel and Fresnel-Bluestein transform approaches. This section explains each package in detail, including the functions and required parameters. We also present sample codes and results illustrating the performance of the <italic toggle="yes">pyDHM</italic> library.</p>
    <sec id="sec004">
      <title>3.1 Package 1: Utility package</title>
      <p>The first package in the <italic toggle="yes">pyDHM</italic> library contains functions for reading and displaying images, computing the Fourier transform (FT), and applying filters to reduce speckle noise [<xref rid="pone.0275818.ref062" ref-type="bibr">62</xref>]. Since the library focuses on DHM applications dealing with complex amplitude distributions, one can display any complex wavefield’s amplitude, intensity, or phase map. Although these operations can be straightforwardly implemented in Python for experienced users, this package is aimed to provide compact and user-friendly codes. This package is imported by typing the following code lines, <italic toggle="yes">from pyDHM import utilities</italic>. <xref rid="pone.0275818.t001" ref-type="table">Table 1</xref> shows the information for each package function, including the declaration statement and the parameters needed. Examples of the use of this package are shown in the upcoming figures.</p>
      <table-wrap position="float" id="pone.0275818.t001">
        <object-id pub-id-type="doi">10.1371/journal.pone.0275818.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Available functions in the utility package.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pone.0275818.t001" id="pone.0275818.t001g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Utility function</th>
                <th align="center" rowspan="1" colspan="1">Specifications</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>imageRead</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">imageRead(namefile)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to read an image. The parameter <italic toggle="yes">namefile</italic> corresponds to the name of the image to be opened (e.g., the hologram).</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>imageShow</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">imageShow(inp, name)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to display an image. Two parameters are necessary: <italic toggle="yes">inp</italic> is the data to be visualized (e.g., the load hologram, the amplitude, intensity or phase distribution), and a <italic toggle="yes">name</italic> is a label for the displayed image.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>amplitude</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">amplitude(output, log)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to compute the amplitude distribution of the output complex wavefield. Two parameters are necessary: <italic toggle="yes">output</italic> is the complex wavefield distribution, and <italic toggle="yes">log</italic> corresponds to a Boolean variable (e.g., True or False) for applying a common logarithm transformation to the amplitude distribution.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>intensity</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">intensity(output, log)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to compute the intensity distribution of the output complex amplitude wavefield. Two parameters are necessary: <italic toggle="yes">output</italic> is the complex wavefield distribution, and <italic toggle="yes">log</italic> is the Boolean variable to apply a common logarithm transformation.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>phase</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">phase(output)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to compute the phase distribution of an output complex wavefield distribution. The only required parameter is the <italic toggle="yes">output</italic> complex wavefield distribution.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>Fourier Transform</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">FT(input)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to compute the 2D Fourier transform of an image. The only required parameter is the image (<italic toggle="yes">input</italic>).</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>Inverse Fourier Transform</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">IFT(input)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to compute the 2D inverse Fourier transform of a spectral image. The only required parameter is the spectral image (<italic toggle="yes">input</italic>).</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>Circular filter</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">sfc(field, radius, centX, centY, display)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to filter the Fourier Transform of a hologram using a circular mask. The required parameters are: <italic toggle="yes">field</italic> the hologram, <italic toggle="yes">radius</italic> is the radius of the circular mask in pixels, and (<italic toggle="yes">centX</italic>, <italic toggle="yes">centY</italic>) are the central pixel positions for the circular mask. The Boolean parameter <italic toggle="yes">display</italic> shows the filtered object frequencies from the hologram spectrum when its value is true.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>Rectangular filter</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">sfr(field, x1, x2, y1, y2, display)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to filter the Fourier Transform of a hologram using a rectangular mask. The required parameters are: <italic toggle="yes">field</italic> the hologram; (<italic toggle="yes">x1</italic>, <italic toggle="yes">y1</italic>) the pixel coordinates of the upper left corner for the rectangular mask; and (<italic toggle="yes">x2</italic>, <italic toggle="yes">y2</italic>) the pixel coordinates of the lower right corner for the rectangular mask. The Boolean parameter <italic toggle="yes">display</italic> shows the filtered object frequencies from the hologram spectrum when its value is true.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>Manual rectangular filter</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">sfmr(field, display)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to filter the Fourier Transform of a hologram using a user-defined rectangular mask from a popup window. The required parameters are the hologram (<italic toggle="yes">field</italic>) and the Boolean parameter (<italic toggle="yes">display</italic>) that allows the display of the filtered hologram spectrum when it is true. It is important to mention that this function works only if the OpenCV library is installed.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>Hybrid median-mean</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">HM2F(inp, kernel)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to apply the median-mean filter to reduce speckle noise [<xref rid="pone.0275818.ref062" ref-type="bibr">62</xref>]. The parameters are: <italic toggle="yes">inp</italic> the reconstructed amplitude or phase image to be applied the filter; and the <italic toggle="yes">kernel</italic> corresponds to the maximum kernel size for the median filter.</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec005">
      <title>3.2 Package 2: Phase-shifting package</title>
      <p>The second package in the <italic toggle="yes">pyDHM</italic> library contains the phase-shifting strategies for reconstructing the complex amplitude distribution in in-line and slightly off-axis systems: the following code line, <italic toggle="yes">from pyDHM import phaseShifting</italic>, calls this package. The package is composed of six different phase-shifting approaches. We have implemented the traditional phase-shifting techniques in which the phase shifts are known using 5 (PS5), 4 (PS4) and 3 (PS3) phase-shifted images, which corresponds to Eqs (<xref rid="pone.0275818.e009" ref-type="disp-formula">6</xref>)–(<xref rid="pone.0275818.e011" ref-type="disp-formula">8</xref>), respectively. We have also implemented the quadrature PS method (SOSR) [<xref rid="pone.0275818.ref041" ref-type="bibr">41</xref>] and two blind PS approaches using 3 (BPS3) and 2 (BPS2) frames [<xref rid="pone.0275818.ref050" ref-type="bibr">50</xref>, <xref rid="pone.0275818.ref051" ref-type="bibr">51</xref>] for slightly off-axis DHM systems. The two blind PS approaches require a DHM operating in telecentric regime. <xref rid="pone.0275818.t002" ref-type="table">Table 2</xref> illustrates the different PS strategies implemented in the package, their definition line statement, and respective parameters. These PS functions require the input of multiple phase-shifted holograms. The number of holograms and the phase shift values depend on the phase-shifting strategy used. For example, 5 holograms (e.g., inp0, inp1, inp2, inp3, inp4) are required with phase shift of π/2 (e.g., 0, π/2, π, 3π/2, 2π) for the PS5 function. The phase shift in the PS4 algorithm is the same as the one from PS5. However, for the PS3 function, the phase shift is equal to 2π/3. The SOSR strategy is based on the quadrature phase-shifting method proposed by De Nicola <italic toggle="yes">et</italic>. <italic toggle="yes">al</italic> [<xref rid="pone.0275818.ref041" ref-type="bibr">41</xref>]. The main difference between the original SOSR strategy and our implementation is that we have upgraded the method to automatically calculate the best digital reference wavefront to reconstruct fully compensated phase maps. The best digital reference wavefront is found using the ROI search [<xref rid="pone.0275818.ref053" ref-type="bibr">53</xref>]. The SOSR function requires 10 input parameters: 4 phase-shifted holograms with a phase shift of π/2; a True/False Boolean variable, <italic toggle="yes">upper</italic>, which is related to the position of the spectrum of the real image in the Fourier domain; <italic toggle="yes">wavelength</italic> is the wavelength of the illumination source used to record the hologram; <italic toggle="yes">dx</italic> and <italic toggle="yes">dy</italic> are the pixel sizes for both the input and output planes along the x- and y- directions; and <italic toggle="yes">s</italic> and <italic toggle="yes">step</italic> are two parameters for determining the ROI in the spatial frequencies domain for the compensation step. This ROI (centered at its brightest pixel) is gridded into a regular rectangular grid whose size in pixels is given by <italic toggle="yes">1+2s</italic> in each dimension. The number of points inside this grid in each dimension is given by <italic toggle="yes">step</italic>; these points are placed apart equidistantly. Therefore, <italic toggle="yes">(step)</italic><sup><italic toggle="yes">2</italic></sup> is the total number of points used inside the ROI. For instance, if using <italic toggle="yes">s = 1</italic> and <italic toggle="yes">step = 4</italic>, a <italic toggle="yes">3x3</italic> pixels ROI size with 16 points inside is selected. If using <italic toggle="yes">s = 2</italic> and <italic toggle="yes">step = 4</italic>, a 5<italic toggle="yes">x5</italic> pixels ROI size with 16 points is selected, implying that a larger ROI with a lesser density of points will be used for the search. The user can adjust these parameters at will, considering that although a more accurate search can be performed by increasing their values, the computational complexity of the procedure increases as well. Finally, the parameters of the BPS3 and the BPS2 algorithms are the input phase-shifted holograms with arbitrary phase shift, and the wavelength of the illumination source and the pixel size along the x- and y-direction (e.g., <italic toggle="yes">dx</italic> and <italic toggle="yes">dy</italic>, respectively) to generate the digital reference wavefront and reconstruct fully-compensated phase maps. The variables (e.g., wavelength, <italic toggle="yes">dx</italic>, <italic toggle="yes">dy</italic>) in the functions should be inserted in the same units.</p>
      <table-wrap position="float" id="pone.0275818.t002">
        <object-id pub-id-type="doi">10.1371/journal.pone.0275818.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Available functions in the phase-shifting package.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pone.0275818.t002" id="pone.0275818.t002g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Phase-shifting strategy</th>
                <th align="center" rowspan="1" colspan="1">Specifications</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>5 frames</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">PS5(inp0, inp1, inp2, inp3, inp4)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to reconstruct the phase distribution using 5 phase-shifted holograms with a phase shift of π/2. The required parameters are the five holograms.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>4 frames</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">PS4(inp0, inp1, inp2, inp3)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to reconstruct the phase distribution using 4 phase-shifted holograms with a phase shift equal to π/2. The required parameters are the four holograms.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>3 frames</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">PS3(inp0, inp1, inp2)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to reconstruct the phase distribution using 3 phase-shifted holograms with a phase shift equal to π/3. The required parameters are the three holograms.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>quadrature method</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">SOSR(inp0, inp1, inp2, inp3, upper, wavelength, dx, dy, s = 1, steps = 4)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to reconstruct the phase distribution using 4 phase-shifted holograms with a phase shift equal to π/2. This method is based on the SOSR approach proposed by De Nicola <italic toggle="yes">et al</italic>. [<xref rid="pone.0275818.ref041" ref-type="bibr">41</xref>]. The input parameters are the four holograms, <italic toggle="yes">inp0-inp3</italic>; <italic toggle="yes">upper</italic> corresponds to a region for searching the diffraction order; <italic toggle="yes">wavelength</italic> is the illumination wavelength, (<italic toggle="yes">dx</italic>,<italic toggle="yes">dy</italic>) are the pixel sizes along the <italic toggle="yes">x</italic>- and <italic toggle="yes">y</italic>- axis, respectively. <italic toggle="yes">s</italic> is a parameter to determine the ROI size in pixels in each dimension to search for the best spatial frequency (size in each dimension equals <italic toggle="yes">1+2s</italic>). <italic toggle="yes">steps</italic> is the number of steps for the search inside the ROI in each dimension.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>Blind 3 raw frames</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">BPS3(inp0, inp1, inp2, wavelength, dx, dy)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to reconstruct the phase distribution using 3 phase-shifted holograms with an arbitrary and unknown phase shift. The input parameters are the three holograms (<italic toggle="yes">inp0-inp2</italic>); the illumination wavelength (<italic toggle="yes">wavelength</italic>), and the pixel sizes for x and y axes (<italic toggle="yes">dx</italic>, <italic toggle="yes">dy</italic>). This method is valid for slightly off-axis DHM systems operating in telecentric regime [<xref rid="pone.0275818.ref050" ref-type="bibr">50</xref>].</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>Blind 2 raw frames</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">BPS2(inp0, inp1, wavelength, dx, dy)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to reconstruct the phase distribution using 2 phase-shifted holograms with an arbitrary and unknown phase shift. This method is valid for slightly off-axis DHM systems operating in telecentric regime [<xref rid="pone.0275818.ref051" ref-type="bibr">51</xref>]. The spectral +1 and -1 components in the spectrum of the recorded hologram should not overlay. The input parameters are the two holograms (<italic toggle="yes">inp0-inp1</italic>); the wavelength of the illumination (<italic toggle="yes">wavelength</italic>), and the pixel sizes for x and y axes (<italic toggle="yes">dx</italic>, <italic toggle="yes">dy</italic>).</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>These six PS algorithms have been validated using simulated and experimental holograms. <xref rid="pone.0275818.g003" ref-type="fig">Fig 3</xref> shows the code and an example for the PS5, PS4 and PS3 algorithms. The code starts importing the utility package and the PS package, lines 2–3 in <xref rid="pone.0275818.g003" ref-type="fig">Fig 3(A)</xref>. Lines 5–9 are the commands to read the phase-shifted holograms. For simplicity, we do not display any of these input holograms. Line 11 calls functions to display the PS5, PS4 or PS3 implementation. Finally, line 13 is the command to display the phase distribution reconstructed by the selected algorithm. <xref rid="pone.0275818.g003" ref-type="fig">Fig 3(C)</xref> illustrates the reconstructed phase distribution from the simulated phase-shifted phantom hologram [<xref rid="pone.0275818.g003" ref-type="fig">Fig 3(B)</xref>] recorded in an in-line DHM system with a phase shift of π/2. <xref rid="pone.0275818.g003" ref-type="fig">Fig 3(D) and 3(E)</xref> show the reconstructed phase images of the simulated phantom hologram using PS4 and PS3 functions, respectively.</p>
      <fig position="float" id="pone.0275818.g003">
        <object-id pub-id-type="doi">10.1371/journal.pone.0275818.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Verification of the in-line PS function.</title>
          <p>(a) An example code; (b) Simulated in-line DHM holograms of a phantom model. Panels (c)-(e) and the reconstructed phase images for the PS5, PS4, and PS3 strategies, respectively.</p>
        </caption>
        <graphic xlink:href="pone.0275818.g003" position="float"/>
      </fig>
      <p>The performance of the slightly off-axis PS strategies is evaluated using two different experimental samples. The validation of the SORS function is provided by reconstructing the phase image of a Fresnel lens with a phase shift of π/2 between holograms introduced by a liquid lens [<xref rid="pone.0275818.ref063" ref-type="bibr">63</xref>]. The sample used for validating the blind strategies (i.e., the BPS3 and BPS2 algorithms) is a phase USAF test target. <xref rid="pone.0275818.g004" ref-type="fig">Fig 4(A)</xref> shows the sample code to use the slightly off-axis strategy algorithms, see the Fourier spectrum of one hologram from the Fresnel lens in <xref rid="pone.0275818.g004" ref-type="fig">Fig 4(B)</xref>. Again, line 10 corresponds to the command for the slightly off-axis strategies (e.g., SOSR, BPS3 and BPS2) with their corresponding parameters. <xref rid="pone.0275818.g004" ref-type="fig">Fig 4(C)</xref> to <xref rid="pone.0275818.g004" ref-type="fig">4(E)</xref> show the reconstructed phase images of the Fresnel lens and the USAF target with minimum phase distortions.</p>
      <fig position="float" id="pone.0275818.g004">
        <object-id pub-id-type="doi">10.1371/journal.pone.0275818.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Example of use of the slightly off-axis strategies.</title>
          <p>(a) A sample code; (b) FT of recorded hologram showing that the DHM system is operating in slightly off-axis configuration. Panel (c) is the reconstructed phase image of a Fresnel lens by the SOSR function using four holograms with a π/2 phase shifting. Panels (d) and (e) are the reconstructed phase images of a USAF test target using the BPS3 and BPS2 strategies, respectively.</p>
        </caption>
        <graphic xlink:href="pone.0275818.g004" position="float"/>
      </fig>
    </sec>
    <sec id="sec006">
      <title>3.3 Package 3: Fully-compensated phase reconstruction package</title>
      <p>The third package of the <italic toggle="yes">pyDHM</italic> library is devoted to the phase reconstruction of DHM holograms without or with minimal perturbations (e.g., fully-compensated reconstructed phase images without distorting sawtooth fringes) using an off-axis system. One includes the <italic toggle="yes">from pyDHM import phaseCompensation</italic> line to call this package. In this package, we have implemented four functions, three functions for holograms recorded in telecentric regime: the full-ROI-search (FRS) function, the efficient-ROI -search (ERS) function, and the cost-function-search (CFS) function. And one function for holograms recorded in non-telecentric regime, the compensation non-telecentric (CNT) function. <xref rid="pone.0275818.t003" ref-type="table">Table 3</xref> shows the definition statement and a brief description of each package function. For example, the FRS function has seven input parameters: the off-axis hologram (<italic toggle="yes">inp</italic>), a True/False Boolean variable (<italic toggle="yes">upper</italic>) for choosing the region where the algorithm would find the maximum peak value of the +1 or -1 order for the filtering step. <italic toggle="yes">Wavelength</italic> corresponds to the wavelength used to record the hologram; <italic toggle="yes">dx</italic> and <italic toggle="yes">dy</italic> are the pixel size of the camera sensor for the acquisition of the hologram along the x- and y- direction, respectively, and <italic toggle="yes">s</italic> and <italic toggle="yes">step</italic> are parameters for selecting the search region to find the best phase reconstructed image. These parameters determine the ROI size and the number of points inside this search region. For example, if using <italic toggle="yes">s = 2</italic> and <italic toggle="yes">step = 10</italic>, a 2x2 pixels ROI size with 100 spatial frequency locations is selected to search for the best phase reconstructed image [<xref rid="pone.0275818.ref053" ref-type="bibr">53</xref>]. For using the efficient ROI search, the EFR function must be executed. This function has the same parameters as the FRS function. To run the cost-function search, the CFS function must be called. The parameters for this function are <italic toggle="yes">inp</italic>, <italic toggle="yes">wavelength</italic>, <italic toggle="yes">dx</italic>, and <italic toggle="yes">dy</italic>. By the other hand, the CNT function contain 8 parameters. Whereas the first ones are <italic toggle="yes">inp</italic>, <italic toggle="yes">wavelength</italic>, <italic toggle="yes">dx</italic>, <italic toggle="yes">dy</italic>, already defined parameters, (<italic toggle="yes">x1</italic>, <italic toggle="yes">x2</italic>, <italic toggle="yes">y1</italic>, <italic toggle="yes">y2</italic>) are the pixels position to create a rectangular mask for filtering the +1 difraction order, where (<italic toggle="yes">x1</italic>, <italic toggle="yes">y1</italic>) and (<italic toggle="yes">x2</italic>, <italic toggle="yes">y2</italic>) are the pixel position of the upper-left and bottom-right corner, respectively.</p>
      <table-wrap position="float" id="pone.0275818.t003">
        <object-id pub-id-type="doi">10.1371/journal.pone.0275818.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Available functions in the phase reconstruction package.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pone.0275818.t003" id="pone.0275818.t003g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Compensation method</th>
                <th align="center" rowspan="1" colspan="1">Specifications</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>Full ROI search</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">FRS(inp, upper, wavelength, dx, dy, s, step)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to reconstruct fully-compensated phase images using the full ROI search strategy [<xref rid="pone.0275818.ref053" ref-type="bibr">53</xref>]. The function requires seven parameters: <italic toggle="yes">inp</italic>, <italic toggle="yes">upper</italic>, <italic toggle="yes">wavelength</italic>, <italic toggle="yes">dx</italic>, <italic toggle="yes">dy</italic>, <italic toggle="yes">s</italic>, and step. The <italic toggle="yes">upper</italic> is a True/False Boolean variable for selecting the region where the algorithm would find the maximum peak value of the +1 order for the filtering step. The default values of these parameters are <italic toggle="yes">s</italic> = 2, and <italic toggle="yes">step =</italic> 10. The DHM system should operate in off-axis configuration and telecentric regime.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>Efficient ROI search</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">ERS(inp, upper, wavelength, dx, dy, s, step)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to reconstruct fully-compensated phase images using the efficient ROI search strategy [<xref rid="pone.0275818.ref056" ref-type="bibr">56</xref>]. The function requires seven parameters: <italic toggle="yes">inp</italic>, <italic toggle="yes">upper</italic>, <italic toggle="yes">wavelength</italic>, <italic toggle="yes">dx</italic>, <italic toggle="yes">dy</italic>, <italic toggle="yes">s</italic>, and step. The <italic toggle="yes">upper</italic> is a True/False Boolean variable for selecting the region where the algorithm would find the maximum peak value of the +1 order for the filtering step. The default values of these parameters are <italic toggle="yes">s</italic> = 5, and <italic toggle="yes">step =</italic> 0.2. The DHM system should operate in off-axis configuration and telecentric regime.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>Cost-function search</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">CFS(inp, wavelength, dx, dy)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to reconstruct fully-compensated phase images by minimizing a cost function [<xref rid="pone.0275818.ref052" ref-type="bibr">52</xref>]. The function requires four parameters: <italic toggle="yes">inp</italic>, <italic toggle="yes">wavelength</italic>, <italic toggle="yes">dx</italic>, and <italic toggle="yes">dy</italic>. The DHM system should operate in off-axis configuration and telecentric regime.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>Compensation no-telecentric regime</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">CNT(inp, wavelength, dx, dy, x1, x2, y1, y2, spatialFilter)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to reconstruct fully-compensated phase images of holograms recorded in non-telecentric regime. The function requires up to nine parameters: <italic toggle="yes">inp</italic>, <italic toggle="yes">wavelength</italic>, <italic toggle="yes">dx</italic>, <italic toggle="yes">dy</italic>, <italic toggle="yes">x1</italic>, <italic toggle="yes">x2</italic>, <italic toggle="yes">y1</italic>, <italic toggle="yes">y2</italic>. The units of <italic toggle="yes">wavelength</italic>, <italic toggle="yes">dx</italic>, <italic toggle="yes">dy</italic> should be microns. The DHM system should operate in off-axis configuration and non-telecentric regime. The parameter spatialFilter allows to decide how to select the object frequencies from the hologram spectrum. Use spatialFilter = ’<italic toggle="yes">sfmr</italic>’ for a manual filter via a popup windown or spatialFilter = ’<italic toggle="yes">sfr</italic>’ for a rectangular mask filter defined by the <italic toggle="yes">x1</italic>, <italic toggle="yes">x2</italic>, <italic toggle="yes">y1</italic>, <italic toggle="yes">y2</italic> parameters. Users selecting the sfmr option should not insert any parameter for x1, x2, y1, and y2. In other words, the notation of the function is CNT(inp, wavelength, dx, dy, x1, x2, y1, y2, spatialFilter = ’sfr’) or CNT(inp, wavelength, dx, dy, spatialFilter = ’sfmr’). This function is based on the proposed method by Kemper <italic toggle="yes">et al</italic>. [<xref rid="pone.0275818.ref059" ref-type="bibr">59</xref>]. We have implemented a search algorithm with nested for loops [<xref rid="pone.0275818.ref053" ref-type="bibr">53</xref>] to automatically find the best-reconstructed phase image (e.g., fully-compensate).</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>We have reconstructed two different holograms to evaluate the performance of the fully-compensated phase reconstruction package using an off-axis DHM system operating in the telecentric regime. The <italic toggle="yes">full</italic> and <italic toggle="yes">efficient ROI search</italic> strategies have been validated using the hologram of a transverse section of the head of a <italic toggle="yes">Drosophila melanogaster</italic> fly [<xref rid="pone.0275818.ref030" ref-type="bibr">30</xref>]. The parameters of the DHM system to record this sample are wavelength <italic toggle="yes">λ</italic> = 633 nm and a camera with a pixel size <italic toggle="yes">dx</italic> = <italic toggle="yes">dy</italic> = 6.9 μm. We have used the hologram of a phase star target to validate the <italic toggle="yes">cost-function search</italic> strategy using <italic toggle="yes">λ</italic> = 532 nm, and <italic toggle="yes">dx</italic> = <italic toggle="yes">dy</italic> = 2.6 μm. These two holograms were recorded at the IP of the microscope. Therefore, no refocusing step is necessary for the reconstruction stage. The sample code is shown in <xref rid="pone.0275818.g005" ref-type="fig">Fig 5(A)</xref>. The code starts with the import of the utility and the fully-compensated phase reconstruction packages; lines 2–3 in <xref rid="pone.0275818.g005" ref-type="fig">Fig 5(A)</xref>. In line 5, the hologram is loaded. Line 7 calls the functions for reconstructing off-axis holograms in telecentric regimen: FRS, ERS, or CFS function. In <xref rid="pone.0275818.g005" ref-type="fig">Fig 5(B)</xref>, the common logarithm of the power spectrum of the hologram of a transverse section of the head of a Drosophila melanogaster fly is shown to demonstrate that an off-axis setup in telecentric regime is used. After applying the three different approaches in this package, the reconstructed phase images are illustrated in <xref rid="pone.0275818.g005" ref-type="fig">Fig 5(C)–5(E)</xref>.</p>
      <fig position="float" id="pone.0275818.g005">
        <object-id pub-id-type="doi">10.1371/journal.pone.0275818.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Example of the fully-compensated phase reconstruction package for off-axis DHM holograms recorded in telecentric configuration.</title>
          <p>(a) A sample code; (b) FT of a recorded hologram to show that the DHM system operates in off-axis and telecentric configuration. Panels (c)-(d) are the fully-compensated reconstructed phase images of a <italic toggle="yes">Drosophila melanogaster</italic> fly using FRS and ERS functions. Panel (e) shows the fully-compensated reconstructed phase image of a star target using the CFS function.</p>
        </caption>
        <graphic xlink:href="pone.0275818.g005" position="float"/>
      </fig>
      <p>Regarding the CNT function, a hologram of a <italic toggle="yes">Drosophila melanogaster</italic> fly recorded in non-telecentric regime has been used [<xref rid="pone.0275818.ref030" ref-type="bibr">30</xref>]. The parameters of the DHM system to record this sample are wavelength λ = 633 nm and a camera with a pixel size <italic toggle="yes">dx</italic> = <italic toggle="yes">dy</italic> = 6.9 μm. The sample code is shown in <xref rid="pone.0275818.g006" ref-type="fig">Fig 6(A)</xref>. The CNT function allows the spatial filtering of the object frequencies from the hologram spectrum using a rectangular mask defined by their pixel corners (e.g., <italic toggle="yes">x1</italic>, <italic toggle="yes">x2</italic>, <italic toggle="yes">y1</italic>, and <italic toggle="yes">y2</italic>) or manually drawn using a popup window. Before running the CNT function with the spatial filter option <italic toggle="yes">sfr</italic>, the user may need to select the pixels position (<italic toggle="yes">x1</italic>, <italic toggle="yes">y1</italic>) and (<italic toggle="yes">x2</italic>, <italic toggle="yes">y2</italic>) of the rectangular mask to filter the +1 term. For this task, one should compute the Fourier transform of the hologram (line 7). <xref rid="pone.0275818.g006" ref-type="fig">Fig 6(B) and 6(C)</xref> shows the Fourier transform and the binarized Fourier transform of the hologram. The latter display is recommended to select the positions of the rectangular mask, the red rectangle inside <xref rid="pone.0275818.g006" ref-type="fig">Fig 6(C)</xref>. Line 11 runs the CNT function using the two possible filter options (e.g., <italic toggle="yes">sfr</italic> and <italic toggle="yes">sfrm</italic>). When running this function, the binarized phase image after compensating the interfering angle but without compensation of the quadratic phase factor is shown [<xref rid="pone.0275818.g006" ref-type="fig">Fig 6(D)</xref>]. Using this image, the user selects the central pixel position (X_cent, Y_cent) of the quadratic phase mask. After closing this image, the CNT function asks to the user the values for this position: “<italic toggle="yes">Enter the pixel position X_cent for the center of circular phase map on x axis</italic>,” and “<italic toggle="yes">Enter the pixel position Y_cent for the center of circular phase map on y axis</italic>” for X_cent and Y_cent, respectively. The curvature of the quadratic phase factor is estimated by the size of the rectangular mask since the spreading of the +1 term and the curvature value are inversaly related [<xref rid="pone.0275818.ref057" ref-type="bibr">57</xref>]. When these values are introduced, the search for the reconstructed phase image starts, providing the optimal reconstructed phase image with minimum phase distortions [<xref rid="pone.0275818.g006" ref-type="fig">Fig 6(E)</xref>].</p>
      <fig position="float" id="pone.0275818.g006">
        <object-id pub-id-type="doi">10.1371/journal.pone.0275818.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Example of the CNF function for off-axis DHM holograms recorded in a non-telecentric configuration.</title>
          <p>(a) A sample code; (b) FT of a recorded hologram, notice that the hologram operates in off-axis and non-telecentric configuration. Panel (c) is the binarized image of the FT to select the dimensions of the rectangular filter with parameters (x1, x2, y1, y2). Panel (d) corresponds to the binarized reconstructed phase image after compensating the interfering angle, where X_cent and Y_cent positions are marked. Finally, panel (e) shows the reconstructed phase image of a <italic toggle="yes">Drosophila melanogaster</italic> fly with minimum phase distortions.</p>
        </caption>
        <graphic xlink:href="pone.0275818.g006" position="float"/>
      </fig>
    </sec>
    <sec id="sec007">
      <title>3.4 Package 4: Numerical propagation package</title>
      <p>The final package in <italic toggle="yes">pyDHM</italic> is the numerical propagation package. This package contains the numerical propagation algorithms to compute the scalar complex diffractive wavefield at different propagation distances. The package is called by the following code line <italic toggle="yes">from pyDHM import numerical Propagation</italic>. We have implemented three different propagators: angular spectrum (<italic toggle="yes">angularSpectrum</italic>), the Fresnel transform (<italic toggle="yes">fresnel</italic>), and the Fresnel-Bluestein transform (<italic toggle="yes">bluestein</italic>). <xref rid="pone.0275818.t004" ref-type="table">Table 4</xref> shows the declaration statement and the parameters needed for each propagator. For example, the <italic toggle="yes">angularSpectrum</italic> and <italic toggle="yes">fresnel</italic> propagator functions have five parameters. <italic toggle="yes">field</italic> is the input complex wavefield to be propagated. The distance to propagate the input wavefield is represented by <italic toggle="yes">z</italic>. <italic toggle="yes">wavelength</italic> is the wavelength of the illumination source used to record the hologram. Finally, <italic toggle="yes">dx</italic> and <italic toggle="yes">dy</italic> are the pixel size for the input and output planes along the x- and y- directions. The <italic toggle="yes">bluestein</italic> propagator function has two additional parameters (e.g., <italic toggle="yes">dxout</italic> and <italic toggle="yes">dyout</italic>) related to the pixel size at the output plane.</p>
      <table-wrap position="float" id="pone.0275818.t004">
        <object-id pub-id-type="doi">10.1371/journal.pone.0275818.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>Available functions in the numerical propagation package.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pone.0275818.t004" id="pone.0275818.t004g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Propagator</th>
                <th align="center" rowspan="1" colspan="1">Specifications</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>Angular spectrum</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">angularSpectrum(field, z, wavelength, dx, dy)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to propagate a complex distribution using the angular spectrum approach.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>Fresnel transform</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">fresnel(field, z, wavelength, dx, dy)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to propagate a complex distribution using the Fresnel Transform approach.</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>Fresnel-Bluestein transform</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">bluestein(field, z, wavelength, dx, dy, dxout, dyout)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Function to propagate a complex distribution using the Fresnel-Bluestein transform approach. Note that the pixel size of the input (<italic toggle="yes">dx</italic>, <italic toggle="yes">dy</italic>) and the output (<italic toggle="yes">dxout</italic>, d<italic toggle="yes">yout</italic>) planes can be different in this method.</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>We have evaluated the <italic toggle="yes">angularSpectrum</italic> propagator by numerically focusing the out-of-focus hologram of a USAF test target recorded in off-axis configuration [<xref rid="pone.0275818.ref064" ref-type="bibr">64</xref>]. The hologram was recorded using a wavelength of 633 nm. The camera with a pixel size <italic toggle="yes">dx</italic> = <italic toggle="yes">dy</italic> = 6.9 μm was located approximately 3 cm from the back focal plane of the TL. <xref rid="pone.0275818.g007" ref-type="fig">Fig 7(A)</xref> shows a sample code. The code starts with the import of the utility, and the numerical propagation packages; see lines 2–3 in <xref rid="pone.0275818.g007" ref-type="fig">Fig 7(A)</xref>. In lines 5–6, the hologram is loaded and displayed [<xref rid="pone.0275818.g007" ref-type="fig">Fig 7(B)</xref>]. The Fourier Transform of the hologram is computing (line 8) and displayed (lines 9–10) in <xref rid="pone.0275818.g007" ref-type="fig">Fig 7(C)</xref>. We have applied a circular mask (line 12) to filter the spatial frequencies of the object from the hologram spectrum [<xref rid="pone.0275818.g007" ref-type="fig">Fig 7(D)</xref>]. Line 14 calls the angular spectrum function. We have used three different values for the propagation distance (<italic toggle="yes">z</italic> = 0, 1, and 3.3 cm) to show the reconstructed intensity image (line 16–17) at different planes in <xref rid="pone.0275818.g007" ref-type="fig">Fig 7(E)–7(G)</xref>. Inside each panel, the zoom-in rectangle areas highlight the effect of the propagation distance to focus the USAF target.</p>
      <fig position="float" id="pone.0275818.g007">
        <object-id pub-id-type="doi">10.1371/journal.pone.0275818.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Example of the angular spectrum approach to numerically focus a hologram using a circular spatial filter tool.</title>
          <p>Panel (a) is the sample code. Panels (b)-(d) show the hologram (b) and its spectrum without (c) and with (d) a circular mask. Panels (e)-(g) are the reconstructed intensity images for three propagation distances (<italic toggle="yes">z</italic>).</p>
        </caption>
        <graphic xlink:href="pone.0275818.g007" position="float"/>
      </fig>
      <p>The performance of the Fresnel and Fresnel-Bluestein transform propagators has been validated by propagating an experimental hologram recorded using a Mach-Zehnder interferometer [<xref rid="pone.0275818.ref061" ref-type="bibr">61</xref>]. A hologram of a horse model is used for the Fresnel propagator, whereas a 1cm edge dice is used for the Fresnel-Bluestein propagator. The sample code for the <italic toggle="yes">fresnel</italic> and <italic toggle="yes">bluestein</italic> propagators is shown in <xref rid="pone.0275818.g008" ref-type="fig">Fig 8(A)</xref>. Lines 2–3 are used to import the utility and numerical propagation packages. In lines 8–10, the computing and display of the Fourier transform of the hologram is implemented. In these examples, we have used a rectangle mask (line 12) to filter the hologram spectrum’s object frequencies [<xref rid="pone.0275818.g008" ref-type="fig">Fig 8(B) and 8(E)</xref>]. Lines 14 and 15 calls the <italic toggle="yes">fresnel</italic> and the <italic toggle="yes">bluestein</italic> propagators, respectively. The parameters for the horse model hologram are <italic toggle="yes">z</italic> = 45 cm, <italic toggle="yes">wavelength</italic> = 633 nm, and <italic toggle="yes">dx</italic> = <italic toggle="yes">dy</italic> = 5 μm. <xref rid="pone.0275818.g008" ref-type="fig">Fig 8(C) and 8(D)</xref> are the reconstructed amplitude images without [<xref rid="pone.0275818.g008" ref-type="fig">Fig 8(C)</xref>] and with [<xref rid="pone.0275818.g008" ref-type="fig">Fig 8(D)</xref>] spatial filtering of the object frequencies in the hologram spectrum. The reconstruction parameters for the dice hologram are <italic toggle="yes">z</italic> = 30 cm, <italic toggle="yes">λ</italic> = 633 nm, and <italic toggle="yes">dx</italic> = <italic toggle="yes">dy</italic> = 7.4 μm. The most important feature of the <italic toggle="yes">bluestein</italic> function (line 15) is that the output pixel sizes (<italic toggle="yes">dxout</italic> and <italic toggle="yes">dyout</italic>) are required as input parameters. Therefore, one can control the magnification of the reconstructed image using the Fresnel-Bluestein approach by modifying the value of these paramters. For this example, the output pixel sizes have been adjusted to 14.8 μm [<xref rid="pone.0275818.g008" ref-type="fig">Fig 8(F)</xref>], and 18.5 μm [<xref rid="pone.0275818.g008" ref-type="fig">Fig 8(G)</xref>]. These values provide an effective lateral magnification of 2× and 2.5× to the output size of the original hologram.</p>
      <fig position="float" id="pone.0275818.g008">
        <object-id pub-id-type="doi">10.1371/journal.pone.0275818.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Examples of the Fresnel and Fresnel-Bluestein propagation approaches to numerically focus holograms using a rectangular mask to filter the object frequencies from the hologram spectrum.</title>
          <p>Panel (a) is the sample code. Panels (b) show the hologram spectrum (b) and the reconstructed intensity image without (c) and with (d) a rectangular mask of a horse model using the <italic toggle="yes">fresnel</italic> propagator. Panels (e)-(g) are the hologram spectrum (e), and the reconstructed intensity images after filtering the object frequencies from the hologram spectrum using two different magnifications [2× and 2.5× in panels (f) and (g), respectively] for a 1-cm edge dice using the <italic toggle="yes">bluestein</italic> propagator.</p>
        </caption>
        <graphic xlink:href="pone.0275818.g008" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec008">
    <title>4. Conclusions</title>
    <p>This work presents the pyDHM library, a Python library for the numerical processing of digital holograms registered in DHM systems. The library contains different computational implementations for: (1) reading and showing the complex distribution of a sample (e.g., utility package); (2) performing numerical propagations of complex wavefields to provide in-focus DH and DHM images (e.g., numerical propagation package); (3) reconstructing the phase distribution of samples in in-line and slightly off-axis DH and DHM systems using PS techniques (e.g., phase-shifting package); and (4) reconstructing phase images in single-shot off-axis DHM systems operating in telecentric and non-telecentric configuration using automatic methods to estimate the best digital reference wavefront (e.g., fully-compensated phase reconstruction package). We have presented a sample code for each function implemented in the pyDHM library and validated its performance using simulated or experimental images. The pyDHM library is posted publicly on GitHub [<xref rid="pone.0275818.ref065" ref-type="bibr">65</xref>, <xref rid="pone.0275818.ref066" ref-type="bibr">66</xref>]. The GitHub repository includes a complete documentation of the functions implemented, sample codes, and troubleshooting guidelines for correctly using the library. To increase the applicability of this library in our community, the GitHub repository also includes simulated and experimental holograms and some instructional videos on how to install and use the library [<xref rid="pone.0275818.ref067" ref-type="bibr">67</xref>–<xref rid="pone.0275818.ref069" ref-type="bibr">69</xref>]. In future works, we will expand the codes within our library and reduce its processing time using GPU implementations. Current implementations within the pyDHM library require that the users select the adequate reconstruction method based on the optical configuration of the DHM systems. Future work will focus on an automatic algorithm to reconstruct DHM holograms without prior knowledge of the DHM configuration (e.g., only hologram, source’s wavelength, and sensor’s pixel size). Because of the broad applicability of DHM systems in biology and medicine, we will create a graphical user interface (GUI) for the pyDHM library, aiming that users who lack coding skills and background in Optics and DHM could adopt this library. Such an app will allow the users to input a single hologram or a sequence/video of holograms, enabling the processing of the whole hologram series. Some reprocessing steps will be avoided, such as selecting the spatial filter mask to optimize such video processing. Our final goal is to expand such app further so that pyDHM can be used to analyze biological systems, including motility analysis for microorganism tracking and cell counting.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0275818.ref001">
      <label>1</label>
      <mixed-citation publication-type="book"><name><surname>Kim</surname><given-names>MK</given-names></name>. <part-title>Digital Holographic Microscopy</part-title>. <source>Principles, techniques, and Aplications.</source><publisher-name>Springer Series in Optical Sciences. Springer</publisher-name>; <year>2011</year>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Yu</surname><given-names>X</given-names></name>, <name><surname>Hong</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>C</given-names></name>, <name><surname>Kim</surname><given-names>MK</given-names></name>. <article-title>Review of digital holographic microscopy for three-dimensional profiling and tracking</article-title>. <source>Opt Eng</source>. <year>2014</year>;<volume>53</volume>(<issue>11</issue>):<fpage>112306</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Park</surname><given-names>YK</given-names></name>, <name><surname>Depeursinge</surname><given-names>C</given-names></name>, <name><surname>Popescu</surname><given-names>G</given-names></name>. <article-title>Quantitative phase imaging in biomedicine</article-title>. <source>Nat Photonics</source>. <year>2018</year>;<volume>12</volume>(<issue>10</issue>):<fpage>578</fpage>–<lpage>89</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Javidi</surname><given-names>B</given-names></name>, <name><surname>Carnicer</surname><given-names>A</given-names></name>, <name><surname>Anand</surname><given-names>A</given-names></name>, <name><surname>Barbastathis</surname><given-names>G</given-names></name>, <name><surname>Chen</surname><given-names>W</given-names></name>, <name><surname>Ferraro</surname><given-names>P</given-names></name>, <etal>et al</etal>., <article-title>Roadmap on digital holographi</article-title>, <source>Opt. Express</source>. <year>2021</year>;<volume>29</volume>(<issue>22</issue>): <fpage>35078</fpage>–<lpage>35118</lpage>.<pub-id pub-id-type="pmid">34808951</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Kemper</surname><given-names>K</given-names></name>, <name><surname>Carl</surname><given-names>D</given-names></name>, <name><surname>Schnekenburger</surname><given-names>J</given-names></name>, <name><surname>Bredebusch</surname><given-names>I</given-names></name>, <name><surname>Schäfer</surname><given-names>M</given-names></name>, <name><surname>Domschke</surname><given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Investigation of living pancreas tumor cells by digital holographic microscopy</article-title>. <source>J. Bio. Opt</source>. <year>2006</year>;<volume>11</volume>:<fpage>034005</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1117/1.2204609</pub-id><?supplied-pmid 16822055?><pub-id pub-id-type="pmid">16822055</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Kemper</surname><given-names>B</given-names></name>, <name><surname>Langehanenberg</surname><given-names>P</given-names></name>, <name><surname>Bredebusch</surname><given-names>I</given-names></name>, <name><surname>Schnekenburger</surname><given-names>J</given-names></name>, <name><surname>von Bally</surname><given-names>G</given-names></name>. <article-title>Techniques and Applications of Digital Holographic Microscopy for Life Cell Imaging</article-title>. In: <source>Biophotonics 2007: Optics in Life Science</source>, <name><surname>Popp</surname><given-names>J.</given-names></name> and <name><surname>von Bally</surname><given-names>G.</given-names></name>, eds., Vol. <volume>6633</volume> of Proceedings of SPIE-OSA Biomedical Optics, paper 6633_12.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Boss</surname><given-names>D</given-names></name>, <name><surname>Kühn</surname><given-names>J</given-names></name>, <name><surname>Jourdain</surname><given-names>P</given-names></name>, <name><surname>Depeursinge</surname><given-names>C</given-names></name>, <name><surname>Magistretti</surname><given-names>PJ</given-names></name>, <name><surname>Marquet</surname><given-names>P</given-names></name>. <article-title>Measurement of absolute cell volume, osmotic membrane water permeability, and refractive index of transmembrane water and solute flux by digital holographic microscopy</article-title>. <source>J Biomed Opt</source>. <year>2013</year>; <volume>18</volume>(<issue>3</issue>):<fpage>036007</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1117/1.JBO.18.3.036007</pub-id><?supplied-pmid 23487181?><pub-id pub-id-type="pmid">23487181</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Cacace</surname><given-names>T</given-names></name>, <name><surname>Bianco</surname><given-names>V</given-names></name>, <name><surname>Ferraro</surname><given-names>P</given-names></name>. <article-title>Quantitative phase imaging trends in biomedical applications</article-title>. <source>Opt Lasers Eng</source>; <year>2020</year>;<volume>135</volume>:<fpage>106188</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.optlaseng.2020.106188</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Anand</surname><given-names>A</given-names></name>, <name><surname>Chhaniwal</surname><given-names>VK</given-names></name>, <name><surname>Patel</surname><given-names>NR</given-names></name>, <name><surname>Javidi</surname><given-names>B</given-names></name>. <article-title>Automatic identification of malaria-infected RBC with digital holographic microscopy using correlation algorithms</article-title>. <source>IEEE Photonics J</source>. <year>2012</year>;<volume>4</volume>(<issue>5</issue>):<fpage>1456</fpage>–<lpage>64</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Doblas</surname><given-names>A</given-names></name>, <name><surname>Roche</surname><given-names>E</given-names></name>, <name><surname>Ampudia-Blasco</surname><given-names>FJ</given-names></name>, <name><surname>Martínez-Corral</surname><given-names>M</given-names></name>, <name><surname>Saavedra</surname><given-names>G</given-names></name>, <name><surname>Garcia-Sucerquia</surname><given-names>J</given-names></name>. <article-title>Diabetes screening by telecentric digital holographic microscopy</article-title>. <source>J Microsc</source>. <year>2016</year>;<volume>261</volume>(<issue>3</issue>):<fpage>285</fpage>–<lpage>90</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/jmi.12331</pub-id><?supplied-pmid 26501512?><pub-id pub-id-type="pmid">26501512</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Javidi</surname><given-names>B</given-names></name>, <name><surname>Markman</surname><given-names>A</given-names></name>, <name><surname>Rawat</surname><given-names>S</given-names></name>, <name><surname>O’Connor</surname><given-names>T</given-names></name>, <name><surname>Anand</surname><given-names>A</given-names></name>, <name><surname>Andemariam</surname><given-names>B</given-names></name>. <article-title>Sickle cell disease diagnosis based on spatio- temporal cell dynamics analysis using 3D printed shearing digital holographic microscopy</article-title>. <source>Opt. Express</source><year>2018</year>;<volume>26</volume>(<issue>10</issue>):<fpage>13614</fpage>–<lpage>13627</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/OE.26.013614</pub-id><?supplied-pmid 29801384?><pub-id pub-id-type="pmid">29801384</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Lam</surname><given-names>VK</given-names></name>, <name><surname>Phan</surname><given-names>T</given-names></name>, <name><surname>Ly</surname><given-names>K</given-names></name>, <name><surname>Luo</surname><given-names>X</given-names></name>, <name><surname>Nehmetallah</surname><given-names>G</given-names></name>, <name><surname>Raub</surname><given-names>CB</given-names></name>. <article-title>Dual-modality digital holographic and polarization microscope to quantify phase and birefringence signals in biospecimens with a complex microstructure</article-title>. <source>Biomed Opt Express</source>. <year>2022</year>;<volume>13</volume>(<issue>2</issue>):<fpage>805</fpage>–<lpage>823</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/BOE.449125</pub-id><?supplied-pmid 35284161?><pub-id pub-id-type="pmid">35284161</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Lopera</surname><given-names>MJ</given-names></name>, <name><surname>Trujillo</surname><given-names>C</given-names></name>. <article-title>Linear diattenuation imaging of biological samples with digital lensless holographic microscopy</article-title>. <source>Appl Opt</source>. <year>2022</year>;<volume>61</volume>(<issue>5</issue>):<fpage>B77</fpage>–<lpage>B82</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/AO.440376</pub-id><?supplied-pmid 35201128?><pub-id pub-id-type="pmid">35201128</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref014">
      <label>14</label>
      <mixed-citation publication-type="book"><name><surname>Asundi</surname><given-names>A.</given-names></name><part-title>Digital Holography for MEMS and Microsystem Metrology</part-title>. <source>Digital Holography for MEMS and Microsystem Metrology</source>. <publisher-name>Wiley</publisher-name>; <year>2011</year>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Osten</surname><given-names>W</given-names></name>, <name><surname>Seebacher</surname><given-names>S</given-names></name>, <name><surname>Jueptner</surname><given-names>W</given-names></name>. <article-title>Application of digital holography for theinspection of microcomponents</article-title>. <source>Proc. SPIE</source><year>2001</year>; <volume>4400</volume>:<fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref016">
      <label>16</label>
      <mixed-citation publication-type="book"><name><surname>Osten</surname><given-names>W</given-names></name>, <name><surname>Ferraro</surname><given-names>P.</given-names></name><part-title>Digital holography and its application in MEMS/MOEMS inspection. In Optical Inspection of Microsystems</part-title>. <name><surname>Osten</surname><given-names>W</given-names></name>. Eds.; <publisher-name>Publisher: CRC Press</publisher-name>, <year>2006</year>, pp. <fpage>351</fpage>–<lpage>426</lpage>.45520.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Pagliarulo</surname><given-names>V</given-names></name>, <name><surname>Russo</surname><given-names>T</given-names></name>, <name><surname>Miccio</surname><given-names>L</given-names></name>, <name><surname>Ferraro</surname><given-names>P</given-names></name>. <article-title>Numerical tools for the characterization of microelectromechanical systems by digital holographic microscopy</article-title>. <source>J. Micro/Nanolithog. MEMS MOEMS</source><year>2015</year>;<volume>14</volume>: <fpage>041314</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Pagliarulo</surname><given-names>V</given-names></name>, <name><surname>Miccio</surname><given-names>L</given-names></name>, <name><surname>Ferraro</surname><given-names>P</given-names></name>. <article-title>Digital holographic microscopy for the characterization of microelectromechanical systems</article-title>. <source>Proc. SPIE</source><year>2016</year>; <volume>9890</volume>:<fpage>989002</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Castañeda</surname><given-names>R</given-names></name>, <name><surname>Garcia-Sucerquia</surname><given-names>J</given-names></name>. <article-title>Single-shot 3D topography of reflective samples with digital holographic microscopy</article-title>. <source>Appl Opt</source>. <year>2018</year>; <volume>57</volume>(<issue>1</issue>):<fpage>A12</fpage>–<lpage>A18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/AO.57.000A12</pub-id><?supplied-pmid 29328124?><pub-id pub-id-type="pmid">29328124</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Valin Fernandez</surname><given-names>M</given-names></name>, <name><surname>Goncalves</surname><given-names>E</given-names></name>, <name><surname>Valin Rivera</surname><given-names>JL</given-names></name>, <name><surname>Ricardo</surname><given-names>J</given-names></name>, <name><surname>Fernandez Abreu</surname><given-names>ME</given-names></name>, <name><surname>Pires Vaz</surname><given-names>MA</given-names></name>. <article-title>Development of digitalholographic microscopy by reflection for analysis of surface</article-title>. <source>Results Phys</source>. <year>2018</year>;<volume>11</volume>: <fpage>182</fpage>–<lpage>187</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref021">
      <label>21</label>
      <mixed-citation publication-type="book"><name><surname>Achimova</surname><given-names>E</given-names></name>, <name><surname>Abaskin</surname><given-names>V</given-names></name>, <name><surname>Cazac</surname><given-names>V</given-names></name>, <name><surname>Meshalkin</surname><given-names>A</given-names></name>, <name><surname>Pedrini</surname><given-names>G</given-names></name>, <name><surname>Claus</surname><given-names>D</given-names></name>, <etal>et al</etal>. <part-title>Surface topography studied by off-axis digital holography. In Novel Optical Materials and Applications; paper No W1J.7</part-title>; <publisher-name>Optical Society of America</publisher-name>:<publisher-loc>San Diego, CA, USA</publisher-loc>, <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Rekola</surname><given-names>H</given-names></name>, <name><surname>Berdin</surname><given-names>A</given-names></name>, <name><surname>Fedele</surname><given-names>C</given-names></name>, <name><surname>Virkki</surname><given-names>M</given-names></name>, <name><surname>Priimagi</surname><given-names>A</given-names></name>. <article-title>Digital holographic microscopy for real-time observation of surface-relief grating formation on azobenzene-containing films.</article-title><source>Sci. Rep</source>. <year>2020</year>;<volume>10</volume>: <fpage>19642</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41598-020-76573-6</pub-id><?supplied-pmid 33184387?><pub-id pub-id-type="pmid">33184387</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Emery</surname><given-names>Y</given-names></name>, <name><surname>Colomb</surname><given-names>T</given-names></name>, <name><surname>Cuche</surname><given-names>E</given-names></name>. <article-title>Metrology applications using off-axis digital holographic microscopy</article-title>. <source>J. Phys. Photonics</source><year>2021</year>;<volume>3</volume>: <fpage>034016</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Cuche</surname><given-names>E</given-names></name>, <name><surname>Marquet</surname><given-names>P</given-names></name>, <name><surname>Depeursinge</surname><given-names>C</given-names></name>. <article-title>Spatial filtering for zero-order and twin-image elimination in digital off-axis holography</article-title>. <source>Appl Opt</source>. <year>2000</year>;<volume>39</volume>(<issue>23</issue>):<fpage>4070</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/ao.39.004070</pub-id><?supplied-pmid 18349988?><pub-id pub-id-type="pmid">18349988</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Verrier</surname><given-names>N</given-names></name>, <name><surname>Atlan</surname><given-names>M</given-names></name>. <article-title>Off-axis digital hologram reconstruction: some practical considerations</article-title>. <source>Appl Opt</source><year>2011</year>;<volume>50</volume>(<issue>34</issue>):<fpage>H136</fpage>—<lpage>H146</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/AO.50.00H136</pub-id><?supplied-pmid 22192998?><pub-id pub-id-type="pmid">22192998</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref026">
      <label>26</label>
      <mixed-citation publication-type="book"><name><surname>Malacara</surname><given-names>D</given-names></name>, <name><surname>Servín</surname><given-names>M</given-names></name>, <name><surname>Malacara</surname><given-names>Z</given-names></name>. <source>Interferogram Analysis For Optical Testing</source>. <publisher-name>CRC Press</publisher-name>; <year>2005</year>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Cuche</surname><given-names>E</given-names></name>, <name><surname>Marquet</surname><given-names>P</given-names></name>, <name><surname>Depeursinge</surname><given-names>C</given-names></name>. <article-title>Simultaneous amplitude-contrast andquantitative phase-contrast microscopy bynumerical reconstruction of Fresnel off-axisholograms</article-title>. <source>Appl. Opt</source>. <year>1999</year>; <volume>38</volume>: <fpage>6994</fpage>–<lpage>7001</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/ao.38.006994</pub-id><?supplied-pmid 18324243?><pub-id pub-id-type="pmid">18324243</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Colomb</surname><given-names>T</given-names></name>, <name><surname>Montfort</surname><given-names>F</given-names></name>, <name><surname>Kühn</surname><given-names>J</given-names></name>, <name><surname>Aspert</surname><given-names>N</given-names></name>, <name><surname>Cuche</surname><given-names>E</given-names></name>, <name><surname>Marian</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Numericalparametric lens for shifting, magnification, and complete aberration compensation in digital holographic microscopy</article-title>. <source>J. Opt. Soc. Am</source>. <year>2006</year>: <volume>23</volume>(<issue>12</issue>):<fpage>3177</fpage>–<lpage>3190</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Doblas</surname><given-names>A</given-names></name>, <name><surname>Sánchez-Ortiga</surname><given-names>E</given-names></name>, <name><surname>Martínez-Corral</surname><given-names>M</given-names></name>, <name><surname>Saavedra</surname><given-names>G</given-names></name>, <name><surname>Andrés</surname><given-names>P</given-names></name>, <name><surname>Garcia-Sucerquia</surname><given-names>J</given-names></name>. <article-title>Shift-variant digital holographic microscopy: inaccuracies in quantitative phase imaging</article-title>. <source>Opt Lett</source>. <year>2013</year>;<volume>38</volume>(<issue>8</issue>):<fpage>1352</fpage>–<lpage>1354</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/OL.38.001352</pub-id><?supplied-pmid 23595482?><pub-id pub-id-type="pmid">23595482</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Doblas</surname><given-names>A</given-names></name>, <name><surname>Sánchez-Ortiga</surname><given-names>E</given-names></name>, <name><surname>Martínez-Corral</surname><given-names>M</given-names></name>, <name><surname>Saavedra</surname><given-names>G</given-names></name>, <name><surname>Garcia-Sucerquia</surname><given-names>J</given-names></name>. <article-title>Accurate single-shot quantitative phase imaging of biological specimens with telecentric digital holographic microscopy</article-title>. <source>J Biomed Opt</source>. <year>2014</year>;<volume>19</volume>(<issue>4</issue>):<fpage>46022</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1117/1.JBO.19.4.046022</pub-id><?supplied-pmid 24781590?><pub-id pub-id-type="pmid">24781590</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Mendlovic</surname><given-names>D</given-names></name>, <name><surname>Zalevsky</surname><given-names>Z</given-names></name>, <name><surname>Konforti</surname><given-names>N</given-names></name>. <article-title>Computation considerations and fast algorithms for calculating the diffraction integral</article-title>. <source>J Mod Opt</source>. <year>1997</year>; <volume>44</volume>(<issue>2</issue>):<fpage>407</fpage>–<lpage>414</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref032">
      <label>32</label>
      <mixed-citation publication-type="book"><name><surname>Kreis</surname><given-names>T.</given-names></name><source>Handbook of Holographic Interferometry</source>. <publisher-name>Wiley</publisher-name>; <year>2004</year>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Picart</surname><given-names>P</given-names></name>, <name><surname>Leval</surname><given-names>J</given-names></name>. <article-title>General theoretical formulation of image formation in digital Fresnel holography</article-title>. <source>J Opt Soc Am A</source><year>2008</year>;<volume>25</volume>(<issue>7</issue>): <fpage>1744</fpage>–<lpage>1761</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/josaa.25.001744</pub-id><?supplied-pmid 18594633?><pub-id pub-id-type="pmid">18594633</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Shimobaba</surname><given-names>T</given-names></name>, <name><surname>Takada</surname><given-names>N</given-names></name>, <name><surname>Ichihashi</surname><given-names>Y</given-names></name>, <name><surname>Masuda</surname><given-names>N</given-names></name>, <name><surname>Ito</surname><given-names>T</given-names></name>. <article-title>Fast numerical wave-optics library using a graphics processing unit: GWO library, and its applications to holography</article-title>. <source>Opt InfoBase Conf Pap.</source><year>2010</year>;JMA:JMA15.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Shimobaba</surname><given-names>T</given-names></name>, <name><surname>Weng</surname><given-names>J</given-names></name>, <name><surname>Sakurai</surname><given-names>T</given-names></name>, <name><surname>Okada</surname><given-names>N</given-names></name>, <name><surname>Nishitsuji</surname><given-names>T</given-names></name>, <name><surname>Takada</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Computational wave optics library for C++: CWO++ library</article-title>. <source>Comput Phys Commun</source>. <year>2012</year>;<volume>183</volume>(<issue>5</issue>):<fpage>1124</fpage>–<lpage>38</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Piedrahita-Quintero</surname><given-names>P</given-names></name>, <name><surname>Castañeda</surname><given-names>R</given-names></name>, <name><surname>Garcia-Sucerquia</surname><given-names>J</given-names></name>. <article-title>Numerical wave propagation in ImageJ</article-title>. <source>Appl Opt</source>. <year>2015</year>;<volume>54</volume>(<issue>21</issue>):<fpage>6410</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/AO.54.006410</pub-id><?supplied-pmid 26367821?><pub-id pub-id-type="pmid">26367821</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Piedrahita-Quintero</surname><given-names>P</given-names></name>, <name><surname>Trujillo</surname><given-names>C</given-names></name>, <name><surname>Garcia-Sucerquia</surname><given-names>J</given-names></name>. <article-title>JDiffraction: A GPGPU-accelerated JAVA library for numerical propagation of scalar wave fields</article-title>. <source>Comput Phys Commun</source>. <year>2017</year>;<volume>214</volume>:<fpage>128</fpage>–<lpage>139</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Hong</surname><given-names>J</given-names></name>, <name><surname>Kim</surname><given-names>Y</given-names></name>, <name><surname>Bae</surname><given-names>H</given-names></name>, <name><surname>Hong</surname><given-names>S</given-names></name>. <article-title>OpenHolo: Open source library for hologram generation, reconstruction and signal processing</article-title>. <source>OSA Imaging Appl Opt Congr</source><year>2020</year>;HF3G:HF3G.1.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Trujillo</surname><given-names>C</given-names></name>, <name><surname>Piedrahita-Quintero</surname><given-names>P</given-names></name>, <name><surname>Garcia-Sucerquia</surname><given-names>J</given-names></name>. <article-title>Digital lensless holographic microscopy: numerical simulation and reconstruction with ImageJ</article-title>. <source>Appl Opt</source>. <year>2020</year>;<volume>59</volume>(<issue>19</issue>):<fpage>5788</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/AO.395672</pub-id><?supplied-pmid 32609706?><pub-id pub-id-type="pmid">32609706</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Barkley</surname><given-names>S</given-names></name>, <name><surname>Dimiduk</surname><given-names>TG</given-names></name>, <name><surname>Fung</surname><given-names>J</given-names></name>, <name><surname>Kaz</surname><given-names>DM</given-names></name>, <name><surname>Manoharan</surname><given-names>VN</given-names></name>, <name><surname>McGorty</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Holographic Microscopy with Python and HoloPy</article-title>. <source>Comput Sci Eng</source>. <year>2020</year>;<volume>22</volume>(<issue>5</issue>):<fpage>72</fpage>–<lpage>82</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>De Nicola</surname><given-names>S</given-names></name>, <name><surname>Ferraro</surname><given-names>P</given-names></name>, <name><surname>Finizio</surname><given-names>A</given-names></name>, <name><surname>Pierattini</surname><given-names>G</given-names></name>. <article-title>Wave front reconstruction of Fresnel off-axis holograms with compensation of aberrations by means of phase-shifting digital holography</article-title>. <source>Opt Lasers Eng</source>. <year>2002</year>;<volume>37</volume>(<issue>4</issue>):<fpage>331</fpage>–<lpage>40</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>H</given-names></name>, <name><surname>Yu</surname><given-names>Y</given-names></name>, <name><surname>Chen</surname><given-names>M</given-names></name>. <article-title>Blind phase shift estimation in phase-shifting interferometry</article-title>. <source>J Opt Soc Am A</source><year>2007</year>;<volume>24</volume>(<issue>1</issue>):<fpage>25</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/josaa.24.000025</pub-id><?supplied-pmid 17164840?><pub-id pub-id-type="pmid">17164840</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>XF</given-names></name>, <name><surname>Cai</surname><given-names>LZ</given-names></name>, <name><surname>Meng</surname><given-names>XF</given-names></name>, <name><surname>Dong</surname><given-names>GY</given-names></name>, <name><surname>Shen</surname><given-names>XX</given-names></name>. <article-title>Fast blind extraction of arbitrary unknown phase shifts by an iterative tangent approach in generalized phase-shifting interferometry</article-title>. <source>Opt Lett</source>. <year>2006</year>;<volume>31</volume>(<issue>13</issue>):<fpage>1966</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/ol.31.001966</pub-id><?supplied-pmid 16770400?><pub-id pub-id-type="pmid">16770400</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Zeng</surname><given-names>F</given-names></name>, <name><surname>Gu</surname><given-names>H</given-names></name>, <name><surname>Tan</surname><given-names>Q</given-names></name>. <article-title>Application of the blind signal separation method for phase-shifting interferometry with random phase shifts</article-title>. <source>Proc. SPIE</source><year>2013</year>;<volume>9046</volume>:<fpage>90460R</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>F</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Wu</surname><given-names>Y</given-names></name>, <name><surname>Wu</surname><given-names>F</given-names></name>, <name><surname>Trusiak</surname><given-names>M</given-names></name>, <name><surname>Patorski</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Simultaneous extraction of phase and phase shift from two interferograms using Lissajous figure and ellipse fitting technology with Hilbert–Huang prefiltering</article-title>. <source>J Opt</source>. <year>2016</year>;<volume>18</volume>(<issue>10</issue>):<fpage>105604</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Xie</surname><given-names>D</given-names></name>, <name><surname>Zhao</surname><given-names>D</given-names></name>, <name><surname>Yang</surname><given-names>Y</given-names></name>, <name><surname>Zhai</surname><given-names>H</given-names></name>. <article-title>Phase-shift extraction algorithm for blind phase-shifting holography based on the quotient of inner products</article-title>. <source>Opt Commun</source>. <year>2017</year>;<volume>393</volume>:<fpage>40</fpage>–<lpage>4</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Meneses-Fabian</surname><given-names>C</given-names></name>, <name><surname>Tejeda-Muñoz</surname><given-names>N</given-names></name>. <article-title>Self-calibrating phase-shifting interferometry of three unequal phase steps by fitting background light to a polynomial of degree K</article-title>. <source>Appl Opt</source>. <year>2017</year>;<volume>56</volume>(<issue>15</issue>):<fpage>4278</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/AO.56.004278</pub-id><?supplied-pmid 29047851?><pub-id pub-id-type="pmid">29047851</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Ayubi</surname><given-names>GA</given-names></name>, <name><surname>Duarte</surname><given-names>I</given-names></name>, <name><surname>Ferrari</surname><given-names>JA</given-names></name>. <article-title>Optimal phase-shifting algorithm for interferograms with arbitrary steps and phase noise</article-title>. <source>Opt Lasers Eng</source>. <year>2019</year>;<volume>114</volume>:<fpage>129</fpage>–<lpage>35</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>XF</given-names></name>, <name><surname>Cai</surname><given-names>LZ</given-names></name>, <name><surname>Wang</surname><given-names>YR</given-names></name>, <name><surname>Yang</surname><given-names>XL</given-names></name>, <name><surname>Meng</surname><given-names>XF</given-names></name>, <name><surname>Dong</surname><given-names>GY</given-names></name>, <etal>et al</etal>. <article-title>Generalized phase-shifting interferometry with arbitrary unknown phase shifts: Direct wave-front reconstruction by blind phase shift extraction and its experimental verification</article-title>. <source>Appl Phys Lett</source>. <year>2007</year>;<volume>90</volume>(<issue>12</issue>):<fpage>121124</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Doblas</surname><given-names>A</given-names></name>, <name><surname>Buitrago-Duque</surname><given-names>C</given-names></name>, <name><surname>Robinson</surname><given-names>A</given-names></name>, <name><surname>Garcia-Sucerquia</surname><given-names>J</given-names></name>. <article-title>Phase-shifting digital holographic microscopy with an iterative blind reconstruction algorithm</article-title>. <source>Appl Opt</source>. <year>2019</year>;<volume>58</volume>(<issue>34</issue>):<fpage>G311</fpage>–<lpage>G317</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/AO.58.00G311</pub-id><?supplied-pmid 31873515?><pub-id pub-id-type="pmid">31873515</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Castañeda</surname><given-names>R</given-names></name>, <name><surname>Buitrago-Duque</surname><given-names>C</given-names></name>, <name><surname>Garcia-Sucerquia</surname><given-names>J</given-names></name>, <name><surname>Doblas</surname><given-names>A</given-names></name>. <article-title>Fast-iterative blind phase-shifting digital holographic microscopy using two images</article-title>. <source>Appl. Opt</source>. <year>2020</year>; <volume>59</volume>(<issue>24</issue>): <fpage>7469</fpage>–<lpage>7476</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/AO.398352</pub-id><?supplied-pmid 32902516?><pub-id pub-id-type="pmid">32902516</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Castaneda</surname><given-names>R</given-names></name>, <name><surname>Doblas</surname><given-names>A</given-names></name>. <article-title>Fast-iterative automatic reconstruction method for quantitative phase image with reduced phase perturbations in off-axis digital holographic microscopy</article-title>. <source>Appl Opt</source>. <year>2021</year>;<volume>60</volume>(<issue>32</issue>):<fpage>10214</fpage>–<lpage>10220</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/AO.437640</pub-id><?supplied-pmid 34807130?><pub-id pub-id-type="pmid">34807130</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Trujillo</surname><given-names>C</given-names></name>, <name><surname>Castañeda</surname><given-names>R</given-names></name>, <name><surname>Piedrahita-Quintero</surname><given-names>P</given-names></name>, <name><surname>Garcia-Sucerquia</surname><given-names>J</given-names></name>. <article-title>Automatic full compensation of quantitative phase imaging in off-axis digital holographic microscopy</article-title>. <source>Appl Opt</source>. <year>2016</year>;<volume>55</volume>(<issue>36</issue>):<fpage>10299</fpage>–<lpage>306</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/AO.55.010299</pub-id><?supplied-pmid 28059249?><pub-id pub-id-type="pmid">28059249</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>He</surname><given-names>X</given-names></name>, <name><surname>Nguyen</surname><given-names>CV</given-names></name>, <name><surname>Pratap</surname><given-names>M</given-names></name>, <name><surname>Zheng</surname><given-names>Y</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Nisbet</surname><given-names>DR</given-names></name>, <etal>et al</etal>. <article-title>Automated Fourier space region-recognition filtering for off-axis digital holographic microscopy</article-title>. <source>Biomed Opt Express</source>. <year>2016</year>;<volume>7</volume>(<issue>8</issue>):<fpage>3111</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/BOE.7.003111</pub-id><?supplied-pmid 27570702?><pub-id pub-id-type="pmid">27570702</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Nguyen</surname><given-names>T</given-names></name>, <name><surname>Bui</surname><given-names>V</given-names></name>, <name><surname>Lam</surname><given-names>V</given-names></name>, <name><surname>Raub</surname><given-names>CB</given-names></name>, <name><surname>Chang</surname><given-names>L-C</given-names></name>, <name><surname>Nehmetallah</surname><given-names>G</given-names></name>. <article-title>Automatic phase aberration compensation for digital holographic microscopy based on deep learning background detection</article-title>. <source>Opt Express</source>. <year>2017</year>;<volume>25</volume>(<issue>13</issue>):<fpage>15043</fpage>–<lpage>57</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/OE.25.015043</pub-id><?supplied-pmid 28788938?><pub-id pub-id-type="pmid">28788938</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Obando</surname><given-names>S</given-names></name>, <name><surname>Trujillo</surname><given-names>C</given-names></name>. <article-title>Computationally efficient phase aberration compensation method for digital holographic microscopy of biological samples. In: Biophotonics Congress 2021</article-title>. <source>Optical Society of America</source>; <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Sánchez-Ortiga</surname><given-names>E</given-names></name>, <name><surname>Doblas</surname><given-names>A</given-names></name>, <name><surname>Saavedra</surname><given-names>G</given-names></name>, <name><surname>Martínez-Corral</surname><given-names>M</given-names></name>, <name><surname>Garcia-Sucerquia</surname><given-names>J</given-names></name>, <name><surname>Saavedra</surname><given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Off-axis digital holographic microscopy: practical design parameters for operating at diffraction limit</article-title>. <source>Appl Opt</source>. <year>2014</year>;<volume>53</volume>(<issue>10</issue>):<fpage>2058</fpage>–<lpage>66</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/AO.53.002058</pub-id><?supplied-pmid 24787162?><pub-id pub-id-type="pmid">24787162</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Ferraro</surname><given-names>P</given-names></name>, <name><surname>De Nicola</surname><given-names>S</given-names></name>, <name><surname>Finizio</surname><given-names>A</given-names></name>, <name><surname>Coppola</surname><given-names>G</given-names></name>, <name><surname>Grilli</surname><given-names>S</given-names></name>, <name><surname>Magro</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Compensation of the Inherent Wave Front Curvature in Digital Holographic Coherent Microscopy for Quantitative Phase-Contrast Imaging</article-title>. <source>Appl Opt</source>. <year>2003</year>;<volume>42</volume>(<issue>11</issue>):<fpage>1938</fpage>–<lpage>46</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/ao.42.001938</pub-id><?supplied-pmid 12699340?><pub-id pub-id-type="pmid">12699340</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Min</surname><given-names>J</given-names></name>, <name><surname>Yfao</surname><given-names>B</given-names></name>, <name><surname>Ketelhut</surname><given-names>S</given-names></name>, <name><surname>Engwer</surname><given-names>C</given-names></name>, <name><surname>Greve</surname><given-names>B</given-names></name>, <name><surname>Kemper</surname><given-names>B</given-names></name>. <article-title>Simple and fast spectral domain algorithm for quantitative phase imaging of living cells with digital holographic microscopy</article-title>. <source>Opt Lett</source>. <year>2017</year>;<volume>42</volume>(<issue>2</issue>):<fpage>227</fpage>–<lpage>30</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/OL.42.000227</pub-id><?supplied-pmid 28081079?><pub-id pub-id-type="pmid">28081079</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Castañeda</surname><given-names>R</given-names></name>, <name><surname>Toro</surname><given-names>W</given-names></name>, <name><surname>Garcia-Sucerquia</surname><given-names>J</given-names></name>. <article-title>Evaluation of the limits of application for numerical diffraction methods based on basic optics concepts</article-title>. <source>Optik</source><year>2015</year>;<volume>126</volume>(<issue>24</issue>):<fpage>5963</fpage>–<lpage>70</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Restrepo</surname><given-names>JF</given-names></name>, <name><surname>Garcia-Sucerquia</surname><given-names>J</given-names></name>. <article-title>Magnified reconstruction of digitally recorded holograms by Fresnel–Bluestein transform</article-title>. <source>Appl Opt</source>. <year>2010</year>;<volume>49</volume>(<issue>33</issue>):<fpage>6430</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/AO.49.006430</pub-id><?supplied-pmid 21102668?><pub-id pub-id-type="pmid">21102668</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Castañeda</surname><given-names>R</given-names></name>, <name><surname>Garcia-Sucerquia</surname><given-names>J</given-names></name>, <name><surname>Doblas</surname><given-names>A</given-names></name>. <article-title>Speckle noise reduction in coherent imaging systems via hybrid median-mean filter</article-title>. <source>Opt. Engineering</source><year>2021</year>; <volume>60</volume>(<issue>12</issue>):<fpage>123107</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Trujillo</surname><given-names>C</given-names></name>, <name><surname>Doblas</surname><given-names>A</given-names></name>, <name><surname>Saavedra</surname><given-names>G</given-names></name>, <name><surname>Martínez-Corral</surname><given-names>M</given-names></name>, <name><surname>García-Sucerquia</surname><given-names>J</given-names></name>. <article-title>Phase-shifting by means of an electronically tunable lens: quantitative phase imaging of biological specimens with digital holographic microscopy</article-title>. <source>Opt Lett</source>. <year>2016</year>;<volume>41</volume>(<issue>7</issue>):<fpage>1416</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1364/OL.41.001416</pub-id><?supplied-pmid 27192250?><pub-id pub-id-type="pmid">27192250</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0275818.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Doblas</surname><given-names>A</given-names></name>, <name><surname>Sánchez-Ortiga</surname><given-names>E</given-names></name>, <name><surname>Martínez-Corral</surname><given-names>M</given-names></name>, <name><surname>Garcia-Surcerquia</surname><given-names>J</given-names></name>. <article-title>Study of spatial lateral resolution in off-axis digital holographic microscopy</article-title>. <source>Opt. Commun</source>. <year>2015</year>; <volume>352</volume>: <fpage>63</fpage>–<lpage>69</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0275818.ref065">
      <label>65</label>
      <mixed-citation publication-type="other">
        <ext-link xlink:href="https://catrujilla.github.io/pyDHM/" ext-link-type="uri">https://catrujilla.github.io/pyDHM/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="pone.0275818.ref066">
      <label>66</label>
      <mixed-citation publication-type="other">
        <ext-link xlink:href="https://github.com/catrujilla/pyDHM" ext-link-type="uri">https://github.com/catrujilla/pyDHM</ext-link>
      </mixed-citation>
    </ref>
    <ref id="pone.0275818.ref067">
      <label>67</label>
      <mixed-citation publication-type="other">
        <ext-link xlink:href="https://youtu.be/h76nZM6JpXo" ext-link-type="uri">https://youtu.be/h76nZM6JpXo</ext-link>
      </mixed-citation>
    </ref>
    <ref id="pone.0275818.ref068">
      <label>68</label>
      <mixed-citation publication-type="other">
        <ext-link xlink:href="https://youtu.be/Z9o0ODe1lUQ" ext-link-type="uri">https://youtu.be/Z9o0ODe1lUQ</ext-link>
      </mixed-citation>
    </ref>
    <ref id="pone.0275818.ref069">
      <label>69</label>
      <mixed-citation publication-type="other">
        <ext-link xlink:href="https://youtu.be/CMHbF0uoWDk" ext-link-type="uri">https://youtu.be/CMHbF0uoWDk</ext-link>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pone.0275818.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0275818.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Carretero</surname>
          <given-names>Luis</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Luis Carretero</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Luis Carretero</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0275818" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">4 Aug 2022</named-content>
    </p>
    <p><!-- <div> -->PONE-D-22-18805<!-- </div> --><!-- <div> -->pyDHM: A Python library for applications in Digital Holographic Microscopy<!-- </div> --><!-- <div> -->PLOS ONE</p>
    <p>Dear Dr. Doblas,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>Please submit your revised manuscript by Sep 18 2022 11:59PM. If you will need more time than this to complete your revisions, please reply to this message or contact the journal office at <email>plosone@plos.org</email>. When you're ready to submit your revision, log on to <ext-link xlink:href="https://www.editorialmanager.com/pone/" ext-link-type="uri">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>Please include the following items when submitting your revised manuscript:<!-- </div> --><list list-type="bullet"><list-item><p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). You should upload this letter as a separate file labeled 'Response to Reviewers'.</p></list-item><list-item><p>A marked-up copy of your manuscript that highlights changes made to the original version. You should upload this as a separate file labeled 'Revised Manuscript with Track Changes'.</p></list-item><list-item><p>An unmarked version of your revised paper without tracked changes. You should upload this as a separate file labeled 'Manuscript'.</p></list-item></list><!-- <div> -->If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter. Guidelines for resubmitting your figure files are available below the reviewer comments at the end of this letter.</p>
    <p>If applicable, we recommend that you deposit your laboratory protocols in protocols.io to enhance the reproducibility of your results. Protocols.io assigns your protocol its own identifier (DOI) so that it can be cited independently in the future. For instructions see: <ext-link xlink:href="https://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols" ext-link-type="uri">https://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link>. Additionally, PLOS ONE offers an option for publishing peer-reviewed Lab Protocol articles, which describe protocols hosted on protocols.io. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link>.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Luis Carretero, Ph.D</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Journal Requirements:</p>
    <p>When submitting your revision, we need you to address these additional requirements.</p>
    <p>1. Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at </p>
    <p><ext-link xlink:href="https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf" ext-link-type="uri">https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and </p>
    <p>
      <ext-link xlink:href="https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf" ext-link-type="uri">https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link>
    </p>
    <p>2. Please review your reference list to ensure that it is complete and correct. If you have cited papers that have been retracted, please include the rationale for doing so in the manuscript text, or remove these references and replace them with relevant current references. Any changes to the reference list should be mentioned in the rebuttal letter that accompanies your revised manuscript. If you need to cite a retracted article, indicate the article’s retracted status in the References list and also include a citation and full reference for the retraction notice.</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <!-- <font color="black"> -->
      <bold>Comments to the Author</bold>
    </p>
    <p>1. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. <!-- </font> --></p>
    <p>Reviewer #1: Partly</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->2. Has the statistical analysis been performed appropriately and rigorously? <!-- </font> --></p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: N/A</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->3. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link xlink:href="http://www.plosone.org/static/policies.action#sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.<!-- </font> --></p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->4. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.<!-- </font> --></p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->5. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)<!-- </font> --></p>
    <p>Reviewer #1: The manuscript is clearly written. The authors conducted a thorough literature review in the field of digital holographic microscopy. Discussions on a broad range of DHM optical configurations and reconstruction methods are supported by appropriate references. The key innovation in this work is the proposal of the pyDHM library as a complete toolbox for numerical processing of holograms recorded from DHM systems of different configurations (on/slightly-off/off axis) with varying optical (tele centricity, wavelength, sensor properties) and acquisition parameters (focusing, phase-shifting intervals). However, there are several inconsistencies between the manuscript and the pyDHM library that require immediate corrections. Nevertheless, the pyDHM library provides a simplified approach in generalizing DHM numerical processing, which is beneficial for the field. I believe that the manuscript can be published in PLOS ONE as a research article, if the authors address the following comments.</p>
    <p>1. As a coding/programing-orientated work, a thorough documentation for the pyDHM library should be composed and included on the GitHub repository for this work. The manuscript demonstrates sample codes for numerical processing, however, is not sufficient for facilitating troubleshooting. A detailed documentation that is standalone can immediately help readers and users trail the sample data, adopt this work to their workflow, troubleshoot, and contribute. The pyDHM library should also incorporate appropriate error messages to guide the users upon error.</p>
    <p>2. It is understandable that the pyDHM library serves as the first toolbox library that supports multimodality DHM numerical processing. However, its useability is poor at current stage. Immediate future work should be aiming to improve the useability with for example, a graphical user interface. There is no doubt that the spatial filtering process of the +-1 orders in the FT of an off-axis hologram can be greatly simplified if performed in a graphical way.</p>
    <p>3. In Fig. 6a, line 7 ‘hologram’ is not defined and an error is prompted when the sample code is run, possibly replacing by ‘inp’. Line 9 ‘ft_holo’ should be ‘ftholo’. It is recommended for the authors to doublecheck the variable names in sample codes throughout the manuscript.</p>
    <p>4. In Fig. 6a, running line 11 – ‘output = phaseCompensation.CNT(inp, 0.633, 6.9, 6.9, 200, 287, 180, 267)’ in Python gives an error ‘TypeError: CNT() missing 3 required positional arguments: 'cur', 's', and 'step'’ and prevent further trails. The authors should conduct a thorough proof on the codes before publishing.</p>
    <p>5. Currently, the pyDHM library only permits single hologram processing, which can be highly inefficient when users have a series of holograms or a video to process. To expand the temporal processing capability of the pyDHM library, the authors should provide a future plan on how this function can be achieved.</p>
    <p>Reviewer #2: The manuscript is written clearly and understandably. An extensive literature review has been provided and delineation to the literature has been presented. In-depth knowledge of digital holographic microscopy and detailed explanations of the advantages and disadvantages of various techniques and algorithms are provided.</p>
    <p>The authors contribute to community efforts by sharing the software publicly on Github. Code examples are available, which facilitates the introduction to the package.</p>
    <p>The software is documented in the manuscript, however I would also suggest to add a documentation on github or dedicated software documentation services.</p>
    <p>I believe the manuscript and the python package are useful contributions to the digital holographic microscopy community.</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->6. PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.<!-- </font> --></p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>**********</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email PLOS at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.<!-- </div> --></p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pone.0275818.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0275818.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0275818" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">21 Sep 2022</named-content>
    </p>
    <p>The authors thank the anonymous reviewer for reading the manuscript and for his/her effort in providing constructive criticism and positive feedback. A detailed reply to the reviewer's comments is provided below on the uploaded document named "Response to Reviewers". Our responses are written in blue font below each reviewer's comment, and the corresponding manuscript changes are provided in red font for clarity in the document "Revised Manuscript with Track Changes". We have numbered the reviewer's comments. In cases where numbers were not provided, we have numbered the key points asked so that each point could be addressed clearly.</p>
    <supplementary-material id="pone.0275818.s001" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response_To_Reviewer_FINAL.pdf</named-content></p>
      </caption>
      <media xlink:href="pone.0275818.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pone.0275818.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0275818.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Carretero</surname>
          <given-names>Luis</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Luis Carretero</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Luis Carretero</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0275818" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">26 Sep 2022</named-content>
    </p>
    <p>pyDHM: A Python library for applications in Digital Holographic Microscopy</p>
    <p>PONE-D-22-18805R1</p>
    <p>Dear Dr. Doblas,</p>
    <p>We’re pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it meets all outstanding technical requirements.</p>
    <p>Within one week, you’ll receive an e-mail detailing the required amendments. When these have been addressed, you’ll receive a formal acceptance letter and your manuscript will be scheduled for publication.</p>
    <p>An invoice for payment will follow shortly after the formal acceptance. To ensure an efficient process, please log into Editorial Manager at <ext-link xlink:href="http://www.editorialmanager.com/pone/" ext-link-type="uri">http://www.editorialmanager.com/pone/</ext-link>, click the 'Update My Information' link at the top of the page, and double check that your user information is up-to-date. If you have any billing related questions, please contact our Author Billing department directly at <email>authorbilling@plos.org</email>.</p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper to help maximize its impact. If they’ll be preparing press materials, please inform our press team as soon as possible -- no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email>onepress@plos.org</email>.</p>
    <p>Kind regards,</p>
    <p>Luis Carretero, Ph.D</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pone.0275818.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0275818.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Carretero</surname>
          <given-names>Luis</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Luis Carretero</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Luis Carretero</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0275818" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">28 Sep 2022</named-content>
    </p>
    <p>PONE-D-22-18805R1 </p>
    <p><italic toggle="yes">pyDHM</italic>: A Python library for applications in Digital Holographic Microscopy </p>
    <p>Dear Dr. DOBLAS:</p>
    <p>I'm pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p>
    <p>If your institution or institutions have a press office, please let them know about your upcoming paper now to help maximize its impact. If they'll be preparing press materials, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email>onepress@plos.org</email>.</p>
    <p>If we can help with anything else, please email us at <email>plosone@plos.org</email>. </p>
    <p>Thank you for submitting your work to PLOS ONE and supporting open access. </p>
    <p>Kind regards, </p>
    <p>PLOS ONE Editorial Office Staff</p>
    <p>on behalf of</p>
    <p>Dr Luis Carretero </p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
  </body>
</sub-article>
