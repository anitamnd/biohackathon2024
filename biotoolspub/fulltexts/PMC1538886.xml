<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">Nucleic Acids Research</journal-id>
    <journal-title>Nucleic Acids Research</journal-title>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1538886</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkl212</article-id>
    <article-id pub-id-type="pmid">16845064</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VOMBAT: prediction of transcription factor binding sites using variable order Bayesian trees</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Grau</surname>
          <given-names>Jan</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ben-Gal</surname>
          <given-names>Irad</given-names>
        </name>
        <xref rid="au1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Posch</surname>
          <given-names>Stefan</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Grosse</surname>
          <given-names>Ivo</given-names>
        </name>
        <xref rid="au2" ref-type="aff">2</xref>
        <xref ref-type="corresp" rid="cor1">*</xref>
      </contrib>
      <aff>
        <institution>Institute of Computer Science, University Halle</institution>
        <addr-line>06099 Halle (Saale), Germany</addr-line>
      </aff>
      <aff id="au1">
        <sup>1</sup>
        <institution>Department of Industrial Engineering, Tel-Aviv University</institution>
        <addr-line>Tel-Aviv 69978, Israel</addr-line>
      </aff>
      <aff id="au2">
        <sup>2</sup>
        <institution>Leibniz-Institute of Plant Genetics and Crop Plant Research (IPK)</institution>
        <addr-line>06466 Gatersleben, Germany</addr-line>
      </aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><sup>*</sup>To whom correspondence should be addressed. Tel: ++49 39482 5755; Fax: ++49 39482 5357; Email: <email>grosse@ipk-gatersleben.de</email></corresp>
    </author-notes>
    <!--For NAR: both ppub and collection dates generated for PMC processing 1/27/05 beck-->
    <pub-date pub-type="collection">
      <day>01</day>
      <month>7</month>
      <year>2006</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>7</month>
      <year>2006</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>7</month>
      <year>2006</year>
    </pub-date>
    <volume>34</volume>
    <issue>Web Server issue</issue>
    <fpage>W529</fpage>
    <lpage>W533</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>2</month>
        <year>2006</year>
      </date>
      <date date-type="rev-recd">
        <day>24</day>
        <month>3</month>
        <year>2006</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>3</month>
        <year>2006</year>
      </date>
    </history>
    <copyright-statement>© 2006 The Author(s)</copyright-statement>
    <copyright-year>2006</copyright-year>
    <license license-type="openaccess">
      <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"/>) which permits unrestricted non-commerical use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
    </license>
    <abstract>
      <p>Variable order Markov models and variable order Bayesian trees have been proposed for the recognition of transcription factor binding sites, and it could be demonstrated that they outperform traditional models, such as position weight matrices, Markov models and Bayesian trees. We develop a web server for the recognition of DNA binding sites based on variable order Markov models and variable order Bayesian trees offering the following functionality: (i) given datasets with annotated binding sites and genomic background sequences, variable order Markov models and variable order Bayesian trees can be trained; (ii) given a set of trained models, putative DNA binding sites can be predicted in a given set of genomic sequences and (iii) given a dataset with annotated binding sites and a dataset with genomic background sequences, cross-validation experiments for different model combinations with different parameter settings can be performed. Several of the offered services are computationally demanding, such as genome-wide predictions of DNA binding sites in mammalian genomes or sets of 10<sup>4</sup>-fold cross-validation experiments for different model combinations based on problem-specific data sets. In order to execute these jobs, and in order to serve multiple users at the same time, the web server is attached to a Linux cluster with 150 processors. VOMBAT is available at <ext-link ext-link-type="uri" xlink:href="http://pdw-24.ipk-gatersleben.de:8080/VOMBAT/"/>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>One important and interesting problem in genome research is the prediction of transcription factor binding sites (TFBSs). Binding of transcription factors to their DNA binding sites in the regulatory region of a gene is a prerequisite for its activation or repression. The combinatorial presence of TFBSs controls gene regulation at least partially, and the prediction of TFBSs is of importance for unraveling the underlying molecular mechanisms.</p>
    <p>Wet-lab experiments allow the identification of TFBSs, but these experiments are expensive and time consuming. Computational methods, which are often less accurate but easy to conduct with available resources, are a welcome complementation to wet-lab experiments. Many TFBS prediction algorithms employ statistical models for scoring a given sequence as TFBS or non-TFBS. For these algorithms, the chosen family of statistical models is of importance for the performance of prediction.</p>
    <p>The family of Markov models (<xref ref-type="bibr" rid="b1">1</xref>–<xref ref-type="bibr" rid="b3">3</xref>) is chosen in many TFBS prediction algorithms as well as for a variety of other classification problems. Well-known examples are the position weight matrix (PWM) model (<xref ref-type="bibr" rid="b4">4</xref>), which is an inhomogeneous Markov model of order 0, and the weight array matrix (WAM) model (<xref ref-type="bibr" rid="b5">5</xref>), which is an inhomogeneous Markov model of order 1. From a statistical point of view, Markov models employ assumptions about the statistical independence of nucleotides at different positions of the binding site.</p>
    <p>The strongest independence assumption is realized by the PWM model, where each position is assumed to be statistically independent of all other positions. As indicated e.g. in (<xref ref-type="bibr" rid="b6">6</xref>), it is an open question whether this strong independence assumption is reasonable in view of recent results indicating the presence of statistical dependences between positions (<xref ref-type="bibr" rid="b7">7</xref>,<xref ref-type="bibr" rid="b8">8</xref>). Markov models of higher order take into account statistical dependences from previous positions, called the context, where the length of the context is equal to the order of the Markov model.</p>
    <p>Despite the often unjustified independence assumption, PWM models are often found to outperform Markov models of higher order in the prediction of TFBSs. This is probably caused by the rather limited amount of training data available from experimentally verified TFBSs. As the number of model parameters grows exponentially with the order of the Markov model, Markov models of higher order tend to be over-fitted, resulting in poor performance.</p>
    <p>One possibility to circumvent this problem is provided by variable order Markov models, which do not require the contexts to be of a fixed length, but allow contexts with variable lengths (<xref ref-type="bibr" rid="b9">9</xref>–<xref ref-type="bibr" rid="b12">12</xref>). The power of variable order Markov models stems from the freedom to include only those contexts into the model for which there are strong statistical dependences.</p>
    <p>Another possibility to capture statistical dependences between non-adjacent positions without the burden of increasing the number of model parameters exponentially are provided by Bayesian trees (BTs) (<xref ref-type="bibr" rid="b13">13</xref>–<xref ref-type="bibr" rid="b16">16</xref>). In BTs the contexts are not restricted to the previous positions within the binding site, and it could be demonstrated that BTs outperform PWM models and WAM models in the prediction of splice sites (<xref ref-type="bibr" rid="b17">17</xref>,<xref ref-type="bibr" rid="b18">18</xref>) and TFBSs (<xref ref-type="bibr" rid="b6">6</xref>,<xref ref-type="bibr" rid="b19">19</xref>).</p>
    <p>As an extension of variable order Markov models and BTs, we introduce variable order BTs (<xref ref-type="bibr" rid="b19">19</xref>). The VOMBAT web server is designed to train variable order Markov models and variable order BTs on user-supplied data and to apply the resulting models to the prediction of TFBSs. In addition, the VOMBAT web server provides a cross-validation platform, allowing advanced users to compare different model combinations with different parameter settings on problem-specific datasets. The VOMBAT web server is primarily designed for the prediction of TFBSs, but applicable to other types of fixed-length motifs as well.</p>
  </sec>
  <sec>
    <title>ALGORITHM</title>
    <p>The prediction of TFBSs is based on one statistical model for TFBSs and one for non-TFBS sequences constituting the background. Each statistical model assigns a probability <italic>P</italic>(<italic>x</italic><sub>1</sub>⋯<italic>x<sub>L</sub></italic>) to a given DNA sequence <italic>x</italic><sub>1</sub>⋯<italic>x<sub>L</sub></italic> of <italic>L</italic> nucleotides. For any value of <italic>M</italic>, 1 ≤ <italic>M</italic> ≤ <italic>L</italic>, <italic>P</italic>(<italic>x</italic><sub>1</sub>⋯<italic>x</italic><sub><italic>L</italic></sub>) can be decomposed according to
<disp-formula><mml:math id="M1"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover></mml:mstyle><mml:msub><mml:mi>P</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
    <p>Markov models of order <italic>M</italic> assume that the conditional probabilities <italic>P<sub>l</sub></italic>(<italic>x<sub>l</sub></italic>∣<italic>x</italic><sub>1</sub>⋯<italic>x</italic><sub><italic>l</italic>−1</sub>) do not depend on all previous nucleotides <italic>x</italic><sub>1</sub>⋯<italic>x</italic><sub><italic>l</italic>−1</sub>, but only on the <italic>M</italic> previous nucleotides <italic>x</italic><sub><italic>l</italic>−<italic>M</italic></sub>⋯<italic>x</italic><sub><italic>l</italic>−1</sub>, which are called the context of position <italic>l</italic>. Hence, a Markov model of order <italic>M</italic> is defined by
<disp-formula><mml:math id="M2"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover></mml:mstyle><mml:msub><mml:mi>P</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
If the conditional probabilities <italic>P<sub>l</sub></italic>(<italic>x<sub>l</sub></italic>∣<italic>x</italic><sub><italic>l</italic>−<italic>M</italic></sub>⋯<italic>x</italic><sub><italic>l</italic>−1</sub>) are identical at all positions, the Markov model is called homogeneous, otherwise it is called inhomogeneous.</p>
    <p>In contrast to a Markov model of order 1, where the conditional probabilities at position <italic>l</italic> depend only on the previous nucleotide <italic>x</italic><sub><italic>l</italic>−1</sub>, a BT allows that the conditional probabilities at position <italic>l</italic> may depend on the nucleotide <italic>x</italic><sub><italic>Pa</italic>(<italic>l</italic>)</sub> at a possibly non-adjacent position <italic>Pa</italic>(<italic>l</italic>), which is called the parent of position <italic>l</italic>. In a BT, arbitrarily remote positions may be chosen as parents as long as no cycles between positions are induced. This implies that there is one position, called the root position, which must not depend on any other position, and that the statistical dependences of a BT may be graphically represented by a rooted tree, where the positions are represented by nodes and the statistical dependences are represented by edges (<xref ref-type="bibr" rid="b13">13</xref>–<xref ref-type="bibr" rid="b16">16</xref>). The probability distribution defined by a BT with root position <italic>r</italic> decomposes as
<disp-formula><mml:math id="M3"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>≠</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:munder></mml:mstyle><mml:msub><mml:mi>P</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
    <p>In the VOMBAT web server, the so-called motif model <italic>P</italic><sub>motif</sub> (used for modeling TFBSs) and the so-called background model <italic>P</italic><sub>bg</sub> (used for modeling background DNA sequences) can be chosen by the user. An inhomogeneous Markov model or a BT should be chosen if statistical dependences are assumed to vary from position to position within the sequence. This is typically the case for TFBSs or other motifs. A homogeneous Markov model should be chosen if statistical dependences are assumed to be the same at all positions within the sequence. This is a reasonable assumption for background sequences. The appropriate order of a Markov model depends on the expected range of statistical dependences and on the amount of available training data.</p>
    <p>For Markov models of fixed order, the number of model parameters grows exponentially with the order, resulting in a sharp transition from under-fitted to over-fitted models. Variable order Markov models were developed to circumvent this sharp transition (<xref ref-type="bibr" rid="b9">9</xref>–<xref ref-type="bibr" rid="b12">12</xref>). The idea of variable order Markov models is to shorten the context in those cases where extending the context does not yield ‘enough’ statistical dependences. Mathematically this is formulated by measuring to which degree the conditional probabilities change when extending or reducing the context.</p>
    <p>The Kullback–Leibler divergence (<xref ref-type="bibr" rid="b20">20</xref>) is used as a measure of change of the conditional probability distributions. It measures the degree of dissimilarity of the conditional probability distribution given the extended context and the conditional probability distribution given the reduced context. The Kullback–Leibler divergence is always non-negative, but small positive values of the Kullback–Leibler divergence do not indicate significant statistical dependences. The threshold above which the Kullback–Leibler divergences are considered important can be set by an external parameter, <italic>c</italic>, called pruning constant.</p>
    <p>For <italic>c</italic> = 0, any extension of the context is considered important, and the resulting variable order Markov model becomes a traditional Markov model of order <italic>M</italic>. For <italic>c</italic> → ∞, any extensions of the context is considered unimportant, and the resulting variable order Markov model becomes a traditional Markov model of order 0, i.e. a PWM model. As <italic>c</italic> grows from 0 to ∞, more and more contexts are considered unimportant, and the resulting variable order Markov models become smaller and smaller, interpolating between a Markov model of order <italic>M</italic> and a PWM model. More detail and other aspects can be found in (<xref ref-type="bibr" rid="b19">19</xref>).</p>
    <p>The parameters of the conditional probabilities are estimated from user-supplied training data. VOMBAT uses a maximum likelihood estimator with optional pseudo counts, which can be specified by the user, for smoothing the conditional probability distributions and to compensate for zero occurrences of nucleotides and contexts. The motif model <italic>P</italic><sub>motif</sub> is learned from a user-supplied training set of TFBSs, and the background model <italic>P</italic><sub>bg</sub> is learned from a user-supplied training set of background sequences.</p>
    <p>After training <italic>P</italic><sub>motif</sub> and <italic>P</italic><sub>bg</sub>, VOMBAT can be used to compute genome-wide predictions of the learned motif in a set of user-supplied sequences. For each position of a sliding window of length <italic>L</italic>, the log-likelihood ratio of the oligonucleotide <italic>y</italic><sub>1</sub>⋯<italic>y<sub>L</sub></italic> occurring at that position is computed, and <italic>y</italic><sub>1</sub>⋯<italic>y<sub>L</sub></italic> is predicted as TFBS if the log-likelihood ratio is greater than a given threshold <italic>T</italic>, i.e. if
<disp-formula><mml:math id="M4"><mml:msub><mml:mtext>log</mml:mtext><mml:mn>2</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>motif</mml:mtext></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mtext>bg</mml:mtext></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>≥</mml:mo><mml:mi>T</mml:mi><mml:mo>.</mml:mo></mml:math></disp-formula>
Specific knowledge, such as the number of TFBSs expected in the genome, can be taken into account to adjust the threshold <italic>T</italic> to achieve TFBS predictions with the desired balance of sensitivity and specificity.</p>
    <p>For advanced users, VOMBAT allows a cross-validation of the prediction accuracy of a user-defined combination of <italic>P</italic><sub>motif</sub> and <italic>P</italic><sub>bg</sub> based on a user-supplied set of TFBSs and a user-supplied set of background sequences. From each of the datasets, 10% of the sequences are randomly excluded, and the models <italic>P</italic><sub>motif</sub> and <italic>P</italic><sub>bg</sub> are trained on the remaining 90%. Subsequently, both models are used for the prediction of the withheld data, and the sensitivity given a user-defined value of the specificity is computed. This procedure is repeated <italic>k</italic> times, where <italic>k</italic> can be specified by the user, and the mean sensitivity and its standard error are reported.</p>
    <p>VOMBAT is based on a variant of the three-tier architecture, where the presentation layer, the management layer and the execution framework are logically separated and physically located on different servers. The web front-end of VOMBAT is based on standard technologies like JavaServer Faces for the web forms and Servlets for displaying images and providing downloads of results. The user-supplied parameters and input files are stored in a mySQL-database. This database is queried by the execution framework. If the execution framework detects a job to be executed, it requests the necessary parameters and input files and submits the corresponding job to the scheduler of the attached Linux cluster. After the job is finished, the results are written to the database and can be displayed by the web front-end, which loads numerical results, model descriptions and images from the result-tables of the mySQL-database.</p>
  </sec>
  <sec>
    <title>INPUT AND OUTPUT</title>
    <p>Imagine a user interested in a genome-wide prediction of binding sites of the transcription factor SP1 in GC-poor upstream regions of human RefSeq (<xref ref-type="bibr" rid="b21">21</xref>) genes. If the user were interested in a prediction based on pre-trained PWM models stored in the Transfac database (<xref ref-type="bibr" rid="b22">22</xref>), he could use the TFBS prediction program MATCH™ (<xref ref-type="bibr" rid="b3">3</xref>). If the user were interested in a prediction based on variable order Markov models or variable order BTs, he could use the VOMBAT web server.</p>
    <p>The two main functions of the VOMBAT web server are training variable order Markov models or variable order BTs based on user-supplied sequences and predicting putative TFBSs based on user-supplied variable order Markov models or variable order BTs. The training function allows the user to choose an optimal combination of a motif model and a background model and train these models on problem-specific datasets. For example, the user might choose a variable order BT as motif model and a variable order Markov model of order 5 as background model, he might choose that subset of SP1 binding sites available from Transfac that are located in GC-poor promoters as motif dataset, and he might choose a representative set of GC-poor promoter regions as background dataset.</p>
    <sec>
      <title>Training a model</title>
      <p>For training a model from user-supplied input data, the user first selects ‘Train a model from data’ from the selection of tasks. The subsequently displayed form requests the necessary parameters. The user can enter a comment on the model to be trained in order to make it easier to identify the corresponding results in a list of all results. The rest of the parameters defines the type of model to be trained as well as the pruning constant and the pseudo count. The default value of the pseudo count is 1, and we recommend the user to always specify a pseudo count greater than 0 to compensate for zero occurrences.</p>
      <p>The subsequent three parameters define the type of model to be trained. The first parameter is the initial order of the model. The second parameter defines if the model to be trained is homogeneous or inhomogeneous. If the model is defined to be inhomogeneous, the user can select between a Markov model and a BT as a third parameter. Based on (<xref ref-type="bibr" rid="b6">6</xref>,<xref ref-type="bibr" rid="b19">19</xref>) and based on systematic cross-validation analyses of different model combinations applied to different sets of TFBSs and background sequences, we generally recommend to use a BT as motif model and a homogeneous Markov model with an initial order of at least 3 as background model.</p>
      <p>The following two parameters are data specific. The user-supplied input file to train an inhomogeneous model must consist of aligned sequences of identical length, separated by line breaks. For homogeneous models the length of the sequences may differ. The VOMBAT web server is designed for, but not restricted to, the prediction of motifs in DNA sequences. Hence, it is possible to specify the alphabet of the sequences. In case of DNA sequences the alphabet is ‘ACGT.’ As a last option the user may select a checkbox that determines if a graphical representation of the trained model shall be displayed as Supplementary Data.</p>
      <p>If the job of training a model could be successfully submitted to the scheduler of the attached Linux cluster, the subsequently displayed page reports ‘Jobs success,’ and VOMBAT gives the user the possibility to go either to the list of tasks for starting another job or to the job overview.</p>
      <p>The job overview displays a table of all jobs with the following columns: the time at which the job was started, the comment that was entered by the user, the type of the job (‘Train’, ‘Classify’, ‘CrossVal’), the current state of the job, a button for the already available results and a button to stop a running job. The possible states of a job are ‘START’ for jobs still waiting for execution, ‘RUNNING’ for jobs currently running on the Linux cluster, ‘STOP’ for jobs marked to be stopped, ‘STOPPED’ for stopped jobs and ‘FINISHED’ for successfully executed jobs. If the state of a job is ‘FINISHED,’ the user can click on the button ‘View results…’ in the same row to inspect the results of this job.</p>
      <p>The results of training a model are a link to an XML representation of the trained model, which can be saved and used as input for one of the other tasks presented in the following. If the user selected to obtain a graphical representation of the trained model, this representation is also displayed as a series of images, which may be saved using the corresponding browser command.</p>
    </sec>
    <sec>
      <title>Predicting putative transcription factor binding sites</title>
      <p>After a motif model and a background model have been trained and saved, they can be combined to predict putative TFBSs in a user-supplied set of input sequences. For this purpose, the user selects ‘Classify data’ from the list of tasks. The first input field of the subsequently displayed form, which is shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>, allows to enter a user-defined comment on the job. Next, the user uploads two files containing the XML representations of the desired motif and background models, which have been trained using the ‘Train a model from data’ task described above. The classification threshold must be specified, and the file containing the set of sequences in which the motif is to be predicted must be uploaded.</p>
      <p>After a classification job has been started, the user can monitor the current state of the job in the job overview of VOMBAT. If the job is finished, the predictions can be inspected by clicking on the corresponding ‘View results…’button. The subsequently displayed result page is presented in <xref ref-type="fig" rid="fig2">Figure 2</xref>. The HTML file contains a textual description of the putative motifs, which contains for each predicted motif its position, its sequence, its probabilities returned by the two models, and the corresponding log-likelihood ratio. Additionally, a profile of the log-likelihoods and the log-likelihood ratio is plotted for each sequence of the input file. The chosen classification threshold is also plotted as a reference for the log-likelihood ratio, allowing the user to judge the influence of the classification threshold on the prediction results at a glance.</p>
    </sec>
    <sec>
      <title>Cross-validation</title>
      <p>As an auxiliary function for advanced users, VOMBAT provides a platform for cross-validation analyses of different combinations of user-defined models based on problem-specific data. Selecting ‘Cross validation’ from the list of tasks brings up the cross-validation input form. The first input field allows to enter a user-defined comment on the cross-validation job. Next, the number of iterations of the cross-validation job can be entered. A higher number of iterations produces more reliable results. On the other hand, the cross-validation job becomes more time-consuming.</p>
      <p>Two files containing XML representations of the motif model and the background model must be uploaded by the user. These files can be obtained by a standard training on the datasets to be used for cross-validation.</p>
      <p>Next, the user must specify the desired specificity for which the mean sensitivity is to be computed. The last option in the form allows to plot a histogram of the log-likelihood ratios for the motif sequences and background sequences, which allows further analyses of the cross-validation results, such as judging the effect of a shifted threshold or inspecting the separation of the samples of both classes.</p>
      <p>The cross-validation results are also listed in the job overview. The presented results are the mean (and standard error) of the sensitivity for the fixed specificity entered in the cross-validation form, the mean (and standard error) of the maximum correlation coefficient, and the corresponding thresholds and optionally the histogram of the log-likelihood ratios as shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>.</p>
      <p>The following prototypical example illustrates how the three functions of VOMBAT may be utilized for the prediction of putative TFBSs. Recall the user interested in a genome-wide prediction of SP1 binding sites. Typically, the user has no a priori knowledge of which model combination and which model parameters could provide an accurate prediction of these binding sites in GC-poor upstream regions. Hence, he would start a series of different cross-validation experiments for different model combinations and different parameter settings using the cross-validation function of VOMBAT.</p>
      <p>After having established an optimal model combination (including optimal parameters) for his specificity requirements and based on his problem-specific datasets, e.g. based on already annotated SP1 binding sites from Transfac as motif dataset and representative GC-poor upstream regions as background dataset, he would then use these models to run the training and prediction functions of VOMBAT as outlined above.</p>
    </sec>
  </sec>
  <sec>
    <title>SUPPLEMENTARY DATA</title>
    <p>Supplementary Data are available at NAR online.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We thank André Gohr for implementing many of the algorithms, Martin Oertel for valuable discussions, and the German Ministry of Education and Research (BMBF Grant No. 0312706A/D) for financial support. Funding to pay the Open Access publication charges for this article was provided by IPK Gatersleben.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="b1">
      <label>1</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fickett</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Hatzigeorgiou</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Eukaryotic promoter recognition</article-title>
        <source>Genome Res.</source>
        <year>1997</year>
        <volume>7</volume>
        <fpage>861</fpage>
        <lpage>878</lpage>
        <pub-id pub-id-type="pmid">9314492</pub-id>
      </citation>
    </ref>
    <ref id="b2">
      <label>2</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salzberg</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>A method for identifying splice sites, translational start sites in eukaryotic mRNA</article-title>
        <source>CABIOS</source>
        <year>1997</year>
        <volume>13</volume>
        <fpage>365</fpage>
        <lpage>376</lpage>
        <pub-id pub-id-type="pmid">9283751</pub-id>
      </citation>
    </ref>
    <ref id="b3">
      <label>3</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kel</surname>
            <given-names>A.E.</given-names>
          </name>
          <name>
            <surname>Gossling</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Reuter</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Cheremushkin</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Kel-Margoulis</surname>
            <given-names>O.V.</given-names>
          </name>
          <name>
            <surname>Wingender</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>MATCH™: a tool for searching transcription factor binding sites in DNA sequences</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>3576</fpage>
        <lpage>3579</lpage>
        <pub-id pub-id-type="pmid">12824369</pub-id>
      </citation>
    </ref>
    <ref id="b4">
      <label>4</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Staden</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Computer methods to locate signals in nucleic acid sequences</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1984</year>
        <volume>12</volume>
        <fpage>505</fpage>
        <lpage>519</lpage>
        <pub-id pub-id-type="pmid">6364039</pub-id>
      </citation>
    </ref>
    <ref id="b5">
      <label>5</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>M.Q.</given-names>
          </name>
          <name>
            <surname>Marr</surname>
            <given-names>T.G.</given-names>
          </name>
        </person-group>
        <article-title>A weight array method for splicing signal analysis</article-title>
        <source>Comput. Appl. Biosci.</source>
        <year>1993</year>
        <volume>9</volume>
        <fpage>499</fpage>
        <lpage>509</lpage>
        <pub-id pub-id-type="pmid">8293321</pub-id>
      </citation>
    </ref>
    <ref id="b6">
      <label>6</label>
      <citation citation-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Barash</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Elidan</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Kaplan</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Modeling dependencies in protein-dna binding sites</article-title>
        <year>2003</year>
        <conf-name>Proceedings of the Annual International Conference on Research in Computational Molecular Biology (RECOMB)</conf-name>
        <fpage>28</fpage>
        <lpage>37</lpage>
      </citation>
    </ref>
    <ref id="b7">
      <label>7</label>
      <citation citation-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Benos</surname>
            <given-names>P.V.</given-names>
          </name>
          <name>
            <surname>Lapedes</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Fields</surname>
            <given-names>D.S.</given-names>
          </name>
          <name>
            <surname>Stormo</surname>
            <given-names>G.D.</given-names>
          </name>
        </person-group>
        <article-title>Samie: statistical algorithm for modeling interaction energies</article-title>
        <year>2001</year>
        <conf-name>Pacific Symposium on Biocomputing</conf-name>
        <fpage>115</fpage>
        <lpage>126</lpage>
        <comment>ACM, NY</comment>
      </citation>
    </ref>
    <ref id="b8">
      <label>8</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bulyk</surname>
            <given-names>M.L.</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>P.L.F.</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>G.M.</given-names>
          </name>
        </person-group>
        <article-title>Nucleotides of transcription factor binding sites exert interdependent effects on the binding affinities of transcription factors</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>1255</fpage>
        <lpage>1261</lpage>
        <pub-id pub-id-type="pmid">11861919</pub-id>
      </citation>
    </ref>
    <ref id="b9">
      <label>9</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rissanen</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>A universal data compression system</article-title>
        <source>IEEE Transactions on Information Theory</source>
        <year>1983</year>
        <volume>29</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
      </citation>
    </ref>
    <ref id="b10">
      <label>10</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ron</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Tishby</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>The power of amnesia: learning probabilistic automata with variable memory length</article-title>
        <source>Mach. Learn.</source>
        <year>1996</year>
        <volume>25</volume>
        <fpage>117</fpage>
        <lpage>149</lpage>
      </citation>
    </ref>
    <ref id="b11">
      <label>11</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buhlmann</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Wyner</surname>
            <given-names>A.J.</given-names>
          </name>
        </person-group>
        <article-title>Variable length markov chains</article-title>
        <source>Ann. Statist.</source>
        <year>1999</year>
        <volume>27</volume>
        <fpage>480</fpage>
        <lpage>513</lpage>
      </citation>
    </ref>
    <ref id="b12">
      <label>12</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bejerano</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Yona</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Variations on probabilistic suffix trees: statistical modeling and prediction of protein families</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>23</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="pmid">11222260</pub-id>
      </citation>
    </ref>
    <ref id="b13">
      <label>13</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chow</surname>
            <given-names>C.K.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C.N.</given-names>
          </name>
        </person-group>
        <article-title>Approximating discrete probability distributions with dependence trees</article-title>
        <source>IEEE Transactions on Information Theory</source>
        <year>1968</year>
        <volume>14</volume>
        <fpage>462</fpage>
        <lpage>467</lpage>
      </citation>
    </ref>
    <ref id="b14">
      <label>14</label>
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pearl</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <source>Probabilistic Reasoning in Intelligent Systems: Networks of plausible inference</source>
        <year>1988</year>
        <publisher-loc>San Mateo, CA</publisher-loc>
        <publisher-name>Morgan Kaufmann</publisher-name>
      </citation>
    </ref>
    <ref id="b15">
      <label>15</label>
      <citation citation-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Buntine</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>Theory refinement on bayesian networks</article-title>
        <year>1991</year>
        <conf-name>Proceedings of Seventh Conference on Uncertainty in Artificial Intelligence</conf-name>
        <conf-loc>Los Angeles, CA</conf-loc>
        <publisher-name>Morgan Kaufmann</publisher-name>
        <fpage>52</fpage>
        <lpage>60</lpage>
      </citation>
    </ref>
    <ref id="b16">
      <label>16</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heckerman</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Geiger</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Chickering</surname>
            <given-names>D.M.</given-names>
          </name>
        </person-group>
        <article-title>Learning bayesian networks. the combination of knowledge and statistical data</article-title>
        <source>Machine Learn.</source>
        <year>1995</year>
        <volume>20</volume>
        <fpage>197</fpage>
        <lpage>243</lpage>
      </citation>
    </ref>
    <ref id="b17">
      <label>17</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cai</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kao</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Kasif</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Modeling splice sites with bayes networks</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>16</volume>
        <fpage>152</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="pmid">10842737</pub-id>
      </citation>
    </ref>
    <ref id="b18">
      <label>18</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castelo</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Guigo</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Splice site identification by idlbns</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>i69</fpage>
        <lpage>i76</lpage>
        <pub-id pub-id-type="pmid">15262783</pub-id>
      </citation>
    </ref>
    <ref id="b19">
      <label>19</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ben-Gal</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Shani</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Gohr</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Grau</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Arviv</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Shmilovici</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Posch</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Grosse</surname>
            <given-names>I.</given-names>
          </name>
        </person-group>
        <article-title>Identification of transcription factor binding sites with variable-order bayesian networks</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>2657</fpage>
        <lpage>2666</lpage>
        <pub-id pub-id-type="pmid">15797905</pub-id>
      </citation>
    </ref>
    <ref id="b20">
      <label>20</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kullback</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Leibler</surname>
            <given-names>R.A.</given-names>
          </name>
        </person-group>
        <article-title>On information and sufficiency</article-title>
        <source>Ann. Math. Statist.</source>
        <year>1951</year>
        <volume>22</volume>
        <fpage>79</fpage>
        <lpage>86</lpage>
      </citation>
    </ref>
    <ref id="b21">
      <label>21</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pruitt</surname>
            <given-names>K.D.</given-names>
          </name>
          <name>
            <surname>Tatusova</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Maglott</surname>
            <given-names>D.R.</given-names>
          </name>
        </person-group>
        <article-title>Ncbi reference sequence (refseq): a curated non-redundant sequence database of genomes, transcripts and proteins</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>D501</fpage>
        <lpage>D504</lpage>
        <pub-id pub-id-type="pmid">15608248</pub-id>
      </citation>
    </ref>
    <ref id="b22">
      <label>22</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wingender</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Fricke</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Geffers</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Hehl</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Liebich</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Krull</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Matys</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Michael</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Ohnhäuser</surname>
            <given-names>R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The transfac system on gene expression regulation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>281</fpage>
        <lpage>283</lpage>
        <pub-id pub-id-type="pmid">11125113</pub-id>
      </citation>
    </ref>
  </ref-list>
  <sec sec-type="display-objects">
    <title>Figures and Tables</title>
    <fig id="fig1" position="float">
      <label>Figure 1</label>
      <caption>
        <p>The form requesting the parameters for a TFBS prediction.</p>
      </caption>
      <graphic xlink:href="gkl212f1"/>
    </fig>
    <fig id="fig2" position="float">
      <label>Figure 2</label>
      <caption>
        <p>The results of a TFBS prediction. The list of putative TFBSs are displayed as a link to ‘sites.html,’ and the profiles for the sequences are plotted.</p>
      </caption>
      <graphic xlink:href="gkl212f2"/>
    </fig>
    <fig id="fig3" position="float">
      <label>Figure 3</label>
      <caption>
        <p>The results of a cross-validation.</p>
      </caption>
      <graphic xlink:href="gkl212f3"/>
    </fig>
  </sec>
</back>
