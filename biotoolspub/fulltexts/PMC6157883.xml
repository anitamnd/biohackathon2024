<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6157883</article-id>
    <article-id pub-id-type="pmid">29672674</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty283</article-id>
    <article-id pub-id-type="publisher-id">bty283</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TRUmiCount: correctly counting absolute numbers of molecules using unique molecular identifiers</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-5344-5359</contrib-id>
        <name>
          <surname>Pflug</surname>
          <given-names>Florian G</given-names>
        </name>
        <xref ref-type="aff" rid="bty283-aff1">1</xref>
        <xref ref-type="corresp" rid="bty283-cor1"/>
        <!--<email>florian.pflug@univie.ac.at</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>von Haeseler</surname>
          <given-names>Arndt</given-names>
        </name>
        <xref ref-type="aff" rid="bty283-aff1">1</xref>
        <xref ref-type="aff" rid="bty283-aff2">2</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty283-aff1"><label>1</label>Center for Integrative Bioinformatics Vienna (CIBIV), Joint Institute of the University of Vienna and Medicial University of Vienna, Max F. Perutz Laboratories (MFPL), Vienna, Austria</aff>
    <aff id="bty283-aff2"><label>2</label>Bioinformatics and Computational Biology, Faculty of Computer Science, University of Vienna, Vienna, Austria</aff>
    <author-notes>
      <corresp id="bty283-cor1">To whom correspondence should be addressed. <email>florian.pflug@univie.ac.at</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>9</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-04-16">
      <day>16</day>
      <month>4</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>4</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>18</issue>
    <fpage>3137</fpage>
    <lpage>3144</lpage>
    <history>
      <date date-type="received">
        <day>02</day>
        <month>2</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>3</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>4</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty283.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Counting molecules using <italic>next-generation sequencing</italic> (NGS) suffers from PCR amplification bias, which reduces the accuracy of many quantitative NGS-based experimental methods such as RNA-Seq. This is true even if molecules are made distinguishable using <italic>unique molecular identifiers</italic> (UMIs) before PCR amplification, and distinct UMIs are counted instead of reads: Molecules that are lost entirely during the sequencing process will still cause underestimation of the molecule count, and amplification artifacts like PCR chimeras create phantom UMIs and thus cause over-estimation.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce the TRUmiCount algorithm to correct for both types of errors. The TRUmiCount algorithm is based on a mechanistic model of PCR amplification and sequencing, whose two parameters have an immediate physical interpretation as PCR efficiency and sequencing depth and can be estimated from experimental data without requiring calibration experiments or spike-ins. We show that our model captures the main stochastic properties of amplification and sequencing, and that it allows us to filter out phantom UMIs and to estimate the number of molecules lost during the sequencing process. Finally, we demonstrate that the phantom-filtered and loss-corrected molecule counts computed by TRUmiCount measure the true number of molecules with considerably higher accuracy than the raw number of distinct UMIs, even if most UMIs are sequenced only once as is typical for single-cell RNA-Seq.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>TRUmiCount is available at <ext-link ext-link-type="uri" xlink:href="http://www.cibiv.at/software/trumicount">http://www.cibiv.at/software/trumicount</ext-link> and through Bioconda (<ext-link ext-link-type="uri" xlink:href="http://bioconda.github.io">http://bioconda.github.io</ext-link>).</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary information</xref> is available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Austrian Science Fund</named-content>
          <named-content content-type="funder-identifier">10.13039/501100002428</named-content>
        </funding-source>
        <award-id>W1207-B09</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Experimental methods like RNA-Seq, ChIP-Seq and many others depend on <italic>next-generation sequencing</italic> (NGS) to measure the abundance of DNA or RNA molecules in a sample. The PCR amplification step necessary before sequencing often amplifies different molecules with different efficiencies, thereby biasing the measured abundances (<xref rid="bty283-B1" ref-type="bibr">Aird <italic>et al.</italic>, 2011</xref>). This problem can be alleviated by ensuring that all molecules are distinguishable before amplification by some combination of factors comprising a <italic>unique molecular identifier</italic> (UMI) (<xref rid="bty283-B5" ref-type="bibr">Hug and Schuler, 2003</xref>; <xref rid="bty283-B7" ref-type="bibr">Kivioja <italic>et al.</italic>, 2012</xref>), which usually includes a distinct molecular barcode ligated to each molecule before amplification (<xref ref-type="fig" rid="bty283-F1">Fig. 1A</xref>, colored dots; see <xref rid="bty283-B12" ref-type="bibr">Smith <italic>et al.</italic> (2017)</xref> for a more extensive history of the UMI method). After amplification and sequencing, instead of counting reads, reads are grouped by UMI, and each distinct UMI is taken to reflect a distinct molecule in the original sample (<xref ref-type="fig" rid="bty283-F1">Fig. 1A</xref>). But while the number of distinct UMIs may be a better proxy for the molecule count, it is still biased, for two reasons:
</p>
    <fig id="bty283-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>(<bold>A</bold>) The relevant steps of library preparation when the UMI method is used. The sample initially contains three copies of molecule <inline-graphic xlink:href="bty283ilf9.jpg"/> and two copies of <inline-graphic xlink:href="bty283ilf10.jpg"/>, which are made unique by labelling with UMIs (<inline-graphic xlink:href="bty283ilf1.jpg"/>). Each of those molecules is expanded into a molecular family during amplification, and a random selection of molecules from these families is sequenced. Counting unique UMIs then counts unique molecules, unless UMIs have read-count zero (<inline-graphic xlink:href="bty283ilf3.jpg"/>) or phantom UMIs are produced (<inline-graphic xlink:href="bty283ilf7.jpg"/>). <bold>(B)</bold> PCR as a Galton-Watson branching process. Molecule <inline-graphic xlink:href="bty283ilf8.jpg"/> failed to be copied during the first PCR cycle and the final family size is thus reduced compared with <inline-graphic xlink:href="bty283ilf11.jpg"/>. <bold>(C)</bold> Normalized family size distribution for efficiency 10, 50 and 90%. The arrows mark the most likely normalized family sizes for the two molecules from (B), assuming a reaction efficiency of 90%, and taking their distinct fates during the first PCR cycle into account. <bold>(D)</bold> Distribution of reads per UMI for efficiency 10, 50 and 90% assuming <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> Reads per UMI on average</p>
      </caption>
      <graphic xlink:href="bty283f1"/>
    </fig>
    <list list-type="bullet">
      <list-item>
        <p>Molecules that are amplified with low efficiency will have fewer copies made, hence fewer reads per UMI, and thus a higher chance of being left entirely unsequenced (<xref ref-type="fig" rid="bty283-F1">Fig. 1A</xref>, green transcript, violet UMI).</p>
      </list-item>
      <list-item>
        <p>Sequencing errors, PCR chimeras, and index miss-assignment (Sinha <italic>et al.</italic>, <ext-link ext-link-type="uri" xlink:href="http://www.biorxiv.org/content/early/2017/04/09/125724">http://www.biorxiv.org/content/early/2017/04/09/125724</ext-link>) in multiplexed sequencing runs can produce <italic>phantom UMIs</italic> which do not correspond to any molecule in the original sample (<xref ref-type="fig" rid="bty283-F1">Fig. 1A</xref>, orange/red phantom UMI).</p>
      </list-item>
    </list>
    <p>Various methods have been proposed to counter-act these effects: <xref rid="bty283-B12" ref-type="bibr">Smith <italic>et al.</italic> (2017)</xref> proposed an algorithm for merging highly similar, erroneous versions of the same original UMI to correct for sequencing errors and single-nucleotide PCR amplification errors. To filter out more complex PCR artifacts, strand-specific UMI-labeling protocols were introducted (<xref rid="bty283-B11" ref-type="bibr">Shiroguchi <italic>et al.</italic>, 2012</xref>; <xref rid="bty283-B10" ref-type="bibr">Schmitt <italic>et al.</italic>, 2012</xref>) that allow filtering out artifacts based on whether UMIs for both strands of a template molecule were detected. A correction for molecules left entirely unsequenced is mentioned by <xref rid="bty283-B7" ref-type="bibr">Kivioja <italic>et al.</italic> (2012)</xref>, but being based on the Poission distribution, it severely under-estimates the amount of affected molecules; for their data by about an order of magnitude.</p>
    <p>Instead of relying on sequence similary or complicated strand-specific UMI-labeling protocols, we rely on the per-UMI read count to separate <italic>true UMIs</italic> (i.e. UMIs of actual molecules in the original sample) from <italic>phantom UMIs</italic>. Chimeric PCR products are typically produced during later reaction cycles, and can therefore be expected to have smaller copy numbers and hence a lower read-count than non-chimeric PCR products. Index miss-assignment and sequencing errors typically happen randomly, and are unlikely to produce a larger number of reads showing the same phantom UMI. For these reasons, phantom UMIs can be expected to have a markedly lower read count than most <italic>true UMIs</italic>, i.e. UMIs of actual molecules in the original sample.</p>
    <p>Our bias-correction and phantom-removal algorithm TRUmiCount exploits this difference in expected read counts between phantoms and true UMIs. It removes UMIs likely to be phantoms based on a read-count threshold, and then estimates and corrects the (gene-specific) loss, i.e. the fraction of molecules that were not sequenced or whose UMIs were mistaken for phantoms. For this correction TRUmiCount employs a model of PCR amplification that accounts for the stochasticity inherent to this amplification reaction.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 The TRUmiCount algorithm</title>
      <p>The TRUmiCount algorithm consists of the following three steps:
<list list-type="order"><list-item><p>We first filter out phantom UMIs by removing any UMI whose read count lies below a suitably chosen <italic>error-correction threshold</italic> (<italic>T</italic>).</p></list-item><list-item><p>We then estimate the loss (<inline-formula id="IE2"><mml:math id="IM2"><mml:mo>ℓ</mml:mo></mml:math></inline-formula>), i.e. the fraction of molecules that were not sequenced at all, or whose UMIs were removed by the error-correction threshold. This estimate is computed using a stochastic model of the amplification and sequencing process whose parameters are the PCR efficiency (<italic>E</italic>), and the sequencing depth (<italic>D</italic>), expressed as the average number of reads per UMI in the initial sample. From the observed distribution of reads per UMI, we estimate both (raw) gene-specific as well as library-wide values for these parameters, and compute corresponding estimates of the loss (see Section 2.2 for details).</p></list-item><list-item><p>Finally, we add the estimated number of lost UMIs back to the the observed number of true UMIs (those UMIs with ≥ threshold reads) to find the total number of molecules in the original sample. Since the loss can vary between genes, to yield unbiased counts, the correction must be based on gene-specific loss estimates. Due to the noise inherent to raw gene-specific estimates for genes with only few observed true UMIs, we employ a James-Stein-type (<xref rid="bty283-B6" ref-type="bibr">James and Stein, 1961</xref>) <italic>shrinkage estimator</italic>, adjusting the raw gene-specific parameter and loss estimates towards the library-wide ones (thus <italic>shrinking</italic> their difference). We choose the amount of shrinkage based on each estimate’s precision, in such a way that the expected overall error is minimized (<xref rid="bty283-B3" ref-type="bibr">Carter and Rolph, 1974</xref>) (see Section 2.3).</p></list-item></list></p>
    </sec>
    <sec>
      <title>2.2 Estimating the fraction of lost molecules</title>
      <p>To estimate the loss, i.e. the fraction of molecules whose UMIs had a read count below the error-correction threshold, we model the distribution of per-UMI read counts by combining a stochastic model of PCR amplification with a model of NGS as random sampling.</p>
      <sec>
        <label>2.2.1</label>
        <title>A stochastic model of PCR amplification</title>
        <p>To model PCR amplification, we use the <italic>single-stranded</italic> model of <xref rid="bty283-B8" ref-type="bibr">Krawczak <italic>et al.</italic> (1989)</xref>, meaning we view PCR as a stochastic process that during each cycle duplicates each molecule independently with a particular probability <italic>E</italic>, called the reaction’s <italic>efficiency</italic>. We further assume that a molecule is copied perfectly or not at all, i.e. that neither partial copies nor copies with a slightly different base-pair sequence are produced, that no molecules are destroyed or lost, and that the efficiency <italic>E</italic> stays constant throughout the reaction. Although this model has been extended by <xref rid="bty283-B14" ref-type="bibr">Weiss and von Haeseler (1997)</xref> to include the possibility of substitution errors during amplification, exhaustively modeling <italic>all</italic> possible sources of phantom UMIs seems futile. We therefore pursue a different approach, and model only the error-free case, trusting the error-correction threshold to remove phantoms. Over multiple cycles, each molecule is thus assumed to be expanded into a <italic>molecular family</italic> of identical copies. Since we use the single-stranded model, <italic>molecule</italic> for us always means a single-stranded piece of DNA, and we do not distinguish between a strand and its reverse complement. For our purposes, a piece of double-stranded DNA thus consists of two indistinguishable molecules.</p>
        <p>Before amplification, we assume all molecules in the sample to be distinguishable by some UMI. During amplification, each of those molecules gives rise to a <italic>molecular family</italic> of (indistinguishable) copies. The initial size of such a family (i.e. the number of copies it is comprised of) is 1. During the first PCR cycle, the size increases to 2 if the single initial molecule is copied successfully, i.e. with probability <italic>E</italic>. Continuation of this process, always using all existing molecules as potential templates that are copied with probability <italic>E</italic>, produces a random sequence <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow></mml:math></inline-formula> of molecular family sizes after the 0th, 1st, 2nd, … cycle. This sequence forms a Galton-Watson branching process (<xref rid="bty283-B13" ref-type="bibr">Weiss and von Haeseler, 1995</xref>), and follows the recursion
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mtext>where</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mo>Δ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mtext>Binom</mml:mtext><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
Although we are not aware of a way to obtain an explicit formula for the distribution of the family size <italic>M<sub>i</sub></italic> after <italic>i</italic> PCR cycles, the expected value and variance of <italic>M<sub>i</sub></italic> can be computed explicitly. According to <xref rid="bty283-B4" ref-type="bibr">Harris (1989</xref>, Ch. 1), <xref ref-type="disp-formula" rid="E5">Equation (5.3</xref>), <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:mi mathvariant="double-struck">V</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mo>σ</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> where <italic>m</italic> and <italic>σ</italic> are the mean and SD of <italic>M</italic><sub>1</sub>. In our case these are <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:msup><mml:mo>σ</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, thus we find
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:math></disp-formula><disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:mi mathvariant="double-struck">V</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p><xref ref-type="disp-formula" rid="E2">Equation 2</xref> shows the well-known exponential growth of expected family sizes during PCR. But apart from recovering this well-known property of PCR, the Galton-Watson model also predicts the likelihood of <italic>deviations</italic> from this expectation due to random failures of copy operations, and by simulation allows us to find the actual distribution of <italic>M<sub>i</sub></italic>.</p>
      </sec>
      <sec>
        <label>2.2.2</label>
        <title>The normalized family size <italic>F</italic></title>
        <p>Due to the exponential growth of the expectation of <italic>M<sub>i</sub></italic>, the distribution of <italic>M<sub>i</sub></italic> depends heavily on the PCR cycle count <italic>i</italic>. That dependency, however, affects mostly the <italic>scale</italic>, not the <italic>shape</italic> of the distribution of <italic>M<sub>i</sub></italic>. To see the effect on the shape more clearly, the effect on the scale is removed by replacing <italic>M<sub>i</sub></italic> with a re-scaled version which has an expected value of one,
<disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>These re-scaled family sizes can be sensibly compared across PCR cycles. We observe that with growing cycle counts, the additional stochasticity introduced by each additional cycle drops rapidly. The re-scaled family size after the first cycle varies by a factor of two depending on whether the (single) copy operation during the first cycle succeeds or fails. Later on there are more templates to copy from, and thus the success or failure to copy any particular molecule averages out, making the behavior of the reaction more deterministic. Finally, <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, because the family size <italic>M<sub>i</sub></italic> increases during each cycle almost exactly by a factor of <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>, which matches the decrease of the re-scaling factor in <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. This informal argument can be turned into a formal proof (see <xref rid="bty283-B4" ref-type="bibr">Harris (1989)</xref>, Ch. 1, Th. 8.1) of the convergence of the re-scaled family size as <italic>i</italic> tends towards <inline-formula id="IE10"><mml:math id="IM10"><mml:mo>∞</mml:mo></mml:math></inline-formula>, which allows us to remove the cycle count as a parameter entirely from what we call the <italic>normalized family size</italic><disp-formula id="E5"><label>(5)</label><mml:math id="M5"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>lim</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mo>∞</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>Although there is again no explicit formula known for the distribution of the normalized family size <italic>F</italic>, we find its variance from <xref ref-type="disp-formula" rid="E3 E4 E5">Equations (3–5)</xref> to be
<disp-formula id="E6"><label>(6)</label><mml:math id="M6"><mml:mrow><mml:mi mathvariant="double-struck">V</mml:mi><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>To quickly evaluate the density <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of the distribution of <italic>F</italic> for a particular normalized family size <italic>x</italic> given reaction efficiency <italic>E</italic>, we interpolate using 2D polynomial interpolation (<xref rid="bty283-B2" ref-type="bibr">Akima, 1996</xref>) between pre-computed densities for different reaction efficiencies between 0 and 100% at different family sizes between 0 and 50 (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S1.1</xref> for details).</p>
      </sec>
      <sec>
        <label>2.2.3</label>
        <title>Modeling the sequencing process</title>
        <p>The normalized family size distribution models the abundance of molecules with a particular UMI. To model the read count of a particular UMI after sequencing (i.e. the number of reads stemming from a particular pre-amplification molecule), we model NGS with a Poissonian sampling model (<xref rid="bty283-B9" ref-type="bibr">Marioni <italic>et al.</italic>, 2008</xref>). This amounts to assuming that (i) each individual copy has the same probability of being sequenced, (ii) this probability is small compared to the sequencing depth and (iii) there were many (distinguishable) original molecules. We further assume that a UMI is <italic>on average</italic> represented by <italic>D</italic> reads. Then the read count <italic>C</italic> of a UMI with known normalized molecular family size <italic>F</italic> is Poisson distributed,
<disp-formula id="E7"><label>(7)</label><mml:math id="M7"><mml:mtable><mml:mtr><mml:mtd><mml:mi>C</mml:mi><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi>F</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>·</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo>·</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>·</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
        <p>In general, however, the exact family size <italic>F</italic> of any particular UMI is unknown—we only know the <italic>distribution</italic> of <italic>F</italic>. To compute the probability of a UMI having <italic>k</italic> reads, we average over all possible family sizes <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>∞</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, weighting them with their respective density <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in the distribution of the normalized family size <italic>F</italic>,
<disp-formula id="E8"><label>(8)</label><mml:math id="M8"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mo>∞</mml:mo></mml:msubsup><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
We note that while <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> depends on <italic>D</italic> and <italic>E</italic>, we omit these dependencies for brevity of notation. To compute the probabilities <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we integrate numerically using the midpoint rule on the grid of family sizes <italic>x</italic> for which <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> was pre-computed. For the mean and variance of <italic>C</italic> we find the explicit expressions
<disp-formula id="E9"><label>(9)</label><mml:math id="M9"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="double-struck">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>Since we impose an error-correction threshold <italic>T</italic> and drop UMIs with fewer than <italic>T</italic> reads, the read-count distribution we actually observe is a <italic>censored</italic> version of <italic>C</italic> where the possible outcomes <italic>C </italic>&lt;<italic> T</italic> are removed. For the mean and variance of this censored distribution with threshold <italic>T</italic> we write
<disp-formula id="E10"><label>(10)</label><mml:math id="M10"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi>C</mml:mi><mml:mo>≥</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>∞</mml:mo></mml:msubsup><mml:mi>k</mml:mi><mml:mo>·</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>≥</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E11"><label>(11)</label><mml:math id="M11"><mml:mrow><mml:mi mathvariant="double-struck">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi>C</mml:mi><mml:mo>≥</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>∞</mml:mo></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi>C</mml:mi><mml:mo>≥</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>≥</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>To compute <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi>C</mml:mi><mml:mo>≥</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we rewrite the infinite sum in <xref ref-type="disp-formula" rid="E10">Equation (10)</xref> to <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mi>k</mml:mi><mml:mo>·</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and similarly for <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:mi mathvariant="double-struck">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi>C</mml:mi><mml:mo>≥</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec>
        <label>2.2.4</label>
        <title>Computing the loss</title>
        <p>The expected loss <inline-formula id="IE20"><mml:math id="IM20"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> is the expected fraction of true UMIs that either remain completely unsequenced, or that are removed by the error-correction threshold. Since we treat each per-UMI read count, and hence each UMI’s fate (to be filtered or not) as independent stochastic quantities, this expected fraction is simply the probability that a single UMI has a read-count below the threshold <italic>T</italic>, i.e.
<disp-formula id="E12"><label>(12)</label><mml:math id="M12"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Correcting for lost molecules</title>
      <p>Given <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> experimentally observed UMIs (after applying the error-correction threshold <italic>T</italic> to filter out phantoms) and their read count vector <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we estimate the reaction efficiency <italic>E</italic> and the mean number of reads per UMI <italic>D</italic>. We use the <italic>method of moments</italic>, i.e. we find <italic>E</italic> and <italic>D</italic> such that the predicted mean equals the sample mean <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> of <bold>c</bold>, and the predicted variance its sample variance <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. Since we only take observed UMIs with at least <italic>T</italic> reads into account, we must compute the predictions using the censored distribution, i.e. find <italic>E</italic>, <italic>D</italic> such that <inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi>C</mml:mi><mml:mo>≥</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mi>C</mml:mi><mml:mo>≥</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p>
      <p>If <italic>T</italic> = 0, i.e. if <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> reflect the <italic>uncensored</italic> mean respectively variance, these equations can be solved explicitly by inverting <xref ref-type="disp-formula" rid="E9">Equation (9)</xref>, which yields the method of moments estimates <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:mi>v</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> limited to the interval <inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>If <italic>T</italic> &gt; 0, we solve the system of equations numerically to find <italic>E</italic> and <italic>D</italic> (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S1.2</xref>). With these parameter estimates, we then compute an estimate <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> of the loss <inline-formula id="IE34"><mml:math id="IM34"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> using <xref ref-type="disp-formula" rid="E12">Equation (12)</xref>, and use it to correct for the expected number of lost molecules. Assuming that we observed <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> UMIs and given <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, we estimate the total number of molecules in the original sample to have been
<disp-formula id="E13"><label>(13)</label><mml:math id="M13"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>tot</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <sec>
        <title>2.3.1 Gene-specific estimates and corrections</title>
        <p>Since the reaction efficiency <italic>E</italic> and depth <italic>D</italic>, and hence also the loss, will usually vary between individual genes (or other genomic features of interest), to correct the observed number of transcripts of some gene <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> for the loss, a <italic>gene-specific</italic> loss estimate <inline-formula id="IE38"><mml:math id="IM38"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> should be used. In principle, such estimates are found by applying the described estimation procedure to only the UMIs found for transcripts of gene <italic>g</italic>, i.e. by computing a gene-specific mean <inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and variance <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> of the number of reads per UMI, and solving for parameters <italic>E</italic> and <italic>D</italic> to find a gene-specific <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>raw</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>raw</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, and computing <inline-formula id="IE43"><mml:math id="IM43"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>raw</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> using <xref ref-type="disp-formula" rid="E12">Equation (12)</xref>. If the number <inline-formula id="IE44"><mml:math id="IM44"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> of observed UMIs (i.e. transcripts) stemming from gene <italic>g</italic> is large, a correction based on <inline-formula id="IE45"><mml:math id="IM45"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>raw</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> yields an (approximately) unbiased and accurate estimate of the total number of transcripts of that gene. But if <inline-formula id="IE46"><mml:math id="IM46"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is small, the error of the estimator <inline-formula id="IE47"><mml:math id="IM47"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>raw</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> easily exceeds the variability of the true gene-specific value <inline-formula id="IE48"><mml:math id="IM48"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> between genes. In such cases, correcting using the <italic>library-wide</italic> estimate <inline-formula id="IE49"><mml:math id="IM49"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>all</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> computed from <italic>all</italic> UMIs found in the library will yield a more accurate (although biased) estimate of the total number transcripts of gene <italic>g</italic>.</p>
        <p>Interestingly, by combining these two flawed estimators of the true gene-specific loss <inline-formula id="IE50"><mml:math id="IM50"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we obtain a <italic>shrinkage estimator</italic><inline-formula id="IE51"><mml:math id="IM51"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>shr</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> that improves upon both in terms of <italic>mean squared error</italic> (MSE), see <xref rid="bty283-B3" ref-type="bibr">Carter and Rolph (1974</xref>) <xref ref-type="disp-formula" rid="E2">Equation (2.4</xref>),
<disp-formula id="E14"><label>(14)</label><mml:math id="M14"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>shr</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>raw</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>all</mml:mtext></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>The gene-specific coefficient <italic>λ<sub>g</sub></italic> determines how much the raw gene-specific estimate is <italic>shrunk</italic> towards the global estimate, and its optimal choice (with respect to the MSE) depends on the variances the two constituent estimators. To determine the optimal <italic>λ<sub>g</sub></italic> we make the following assumptions about these estimators:
<list list-type="roman-lower"><list-item><p>the library-wide estimate <inline-formula id="IE52"><mml:math id="IM52"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>all</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is a good proxy for the true <italic>average</italic> loss taken over all genes <inline-formula id="IE53"><mml:math id="IM53"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>. This seems reasonable given the size of a typical library, comprising millions of UMIs.</p></list-item><list-item><p>the estimator variance of the raw gene-specific estimator <inline-formula id="IE54"><mml:math id="IM54"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>raw</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> depends only on the number <inline-formula id="IE55"><mml:math id="IM55"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> of observed UMIs for gene <italic>g</italic>, and does so in an inversely proportional manner. This is certainly true asymptotically for large numbers of observations, for small numbers <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4</xref> shows this approximation to be reasonable.</p></list-item></list></p>
        <p>We write <italic>s</italic> for the variance of the true loss between genes (i.e. for the mean squared difference of <inline-formula id="IE56"><mml:math id="IM56"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE57"><mml:math id="IM57"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>all</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), and <italic>u</italic> for the proportionality constant between the estimator variance of <inline-formula id="IE58"><mml:math id="IM58"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>raw</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE59"><mml:math id="IM59"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. According to <xref rid="bty283-B3" ref-type="bibr">Carter and Rolph (1974)</xref><xref ref-type="disp-formula" rid="E2">Equation (2.4ff</xref>) the optimal choice for <italic>λ<sub>g</sub></italic> is then
<disp-formula id="E15"><label>(15)</label><mml:math id="M15"><mml:mrow><mml:msub><mml:mo>λ</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>s</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mo>/</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
        <p>To compute the gene-specific shrinkage estimators <inline-formula id="IE60"><mml:math id="IM60"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>shr</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, it remains to find constants <italic>u</italic> and <italic>s</italic>. Towards that end, we observe that the expected squared deviation of the raw gene-specific loss estimate <inline-formula id="IE61"><mml:math id="IM61"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>raw</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> from its average <inline-formula id="IE62"><mml:math id="IM62"><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>raw</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the total variance of <inline-formula id="IE63"><mml:math id="IM63"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>raw</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, which is comprised of the between-gene variance <italic>s</italic> and the estimator variance <inline-formula id="IE64"><mml:math id="IM64"><mml:mrow><mml:mi>u</mml:mi><mml:mo>/</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, or in other words <inline-formula id="IE65"><mml:math id="IM65"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>raw</mml:mtext></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mo>/</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
        <p>This allows us to estimate <italic>s</italic> and <italic>u</italic> using <italic>least squares regression</italic>, i.e. by minimizing
<disp-formula id="E16"><label>(16)</label><mml:math id="M16"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>raw</mml:mtext></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mi>u</mml:mi><mml:mo>/</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Without weighting (i.e. for <italic>w</italic>(<italic>n</italic>) = 1), the considerable drop in magnitude of <inline-formula id="IE66"><mml:math id="IM66"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mtext>raw</mml:mtext></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> as <inline-formula id="IE67"><mml:math id="IM67"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> increases would allow genes with small number of observations to yield an unduly large influence over the estimates. Since it is the genes with a low to moderate number of observations that benefit from shrinking, some modest bias of this sort is actually desired—but not as strong a bias as <italic>w</italic>(<italic>n</italic>) = 1 exhibits, and one not so purely focused on genes with very few observations. We therefore use the weights <inline-formula id="IE68"><mml:math id="IM68"><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>n</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, which initially increase linearly with the number of observations, but eventually converge to 100 instead of increasing further. This has the desired effect of shifting the focus away from rarely observed genes, and concentrating it on genes with a moderate number of observations.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 PCR stochasticity versus efficiency</title>
      <p>During PCR amplification, each uniquely labeled molecule is amplified into a molecular family of indistinguishable copies. Random successes or failures to copy molecules during early reaction cycles lead to a variation in the final family sizes (<xref ref-type="fig" rid="bty283-F1">Fig. 1B</xref>), even between identical (expect for their molecular barcode) molecules. As the family size of each initial molecule grows, the proportion of successful copy operations approaches the efficiency <italic>E</italic>, therefore reducing the amount of noise added by each additional cycle. The total number of cycles thus has little influence on the final family size distribution, and is therefore not a parameter of our model. For the same reason, a plateau effect (i.e. diminishing reaction efficiency during later cycles) has little effect on the final family size distribution, and is thus not included in the model. The final distribution does, however, depend strongly on the reaction efficiency, with fluctuations in family size decreasing as the efficiency grows towards 100% (<xref ref-type="fig" rid="bty283-F1">Fig. 1C</xref>).</p>
      <p>For efficiencies close to 100%, most molecular families are thus of about average size, except for those (∼<inline-formula id="IE69"><mml:math id="IM69"><mml:mrow><mml:mn>100</mml:mn><mml:mo>−</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> percent) families for which the first copy failed. These are about half the average size, and form a distinct secondary peak in the family size distribution (<xref ref-type="fig" rid="bty283-F1">Fig. 1C</xref>, brown curve). We emphasize that due to this, even at efficiencies close to 100%, the distribution still shows considerable dispersion, meaning that even at high efficiencies stochastic PCR effects are not negligible. At lower efficiencies, the family sizes vary even more wildly, as extreme family sizes (on both ends of the scale) become more likely (<xref ref-type="fig" rid="bty283-F1">Fig. 1C</xref>, blue and green curves).</p>
      <p>If we add sequencing to the picture, i.e. combine the stochastic PCR model outlined above with a model of sequencing as random Poissonian sampling (<xref rid="bty283-B9" ref-type="bibr">Marioni <italic>et al.</italic>, 2008</xref>), the variability of per-UMI read counts (<xref ref-type="fig" rid="bty283-F1">Fig. 1D</xref>) then has two sources—the variability of molecular family sizes and the Poissonian sampling introduced by sequencing. Although the latter is reduced by increasing the sequencing depth, the former is independent of the sequencing depth but is reduced by increasing the reaction efficiency. For all reasonable error-correction thresholds <italic>T</italic> the predicted fraction of true UMIs filtered out by the error-correction step thus grows with diminishing efficiency <italic>E</italic>.</p>
    </sec>
    <sec>
      <title>3.2 Model validation and phantom UMI removal</title>
      <p>To validate our model of amplification and sequencing, we compared the predicted distribution of per-UMI read counts to the distribution observed in two published RNA-Seq datasets. <xref rid="bty283-B7" ref-type="bibr">Kivioja <italic>et al.</italic> (2012)</xref> labeled and sequenced transcripts in <italic>Drosophila melanogaster</italic> S2 cells using 10 bp random molecular barcodes from the 5′ end. <xref rid="bty283-B11" ref-type="bibr">Shiroguchi <italic>et al.</italic> (2012)</xref> labeled and sequenced transcript fragments in <italic>E.coli</italic> cells on both ends, using (on each end) one of 145 molecular barcodes carefully selected to have large pairwise edit distances. The Y-shaped sequencing adapters used in the <italic>E.coli</italic> experiment were designed such that each strand of a labeled double-stranded cDNA molecule produces a related but distinguishable molecular family.</p>
      <p>To see whether our algorithm offers an advantage over existing UMI error-correction strategies, we pre-filtered the observed UMIs in each of the two replicates of these datasets using the following existing algorithms: We first merged UMIs likely to be erroneously sequenced versions of the same molecule, using the algorithm proposed by <xref rid="bty283-B12" ref-type="bibr">Smith <italic>et al.</italic> (2017)</xref>. For the <italic>E.coli</italic> experiment we also removed UMIs for which the complementary UMI corresponding to the second strand of the same initial template molecule was not detected, as proposed by <xref rid="bty283-B11" ref-type="bibr">Shiroguchi <italic>et al.</italic> (2012)</xref>. See <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S1.4</xref> for details on the analysis pipeline we used.</p>
      <p>To this pre-filtered set of UMIs we then applied our algorithm. For each dataset, we manually chose an error-correction threshold by visually comparing read-count distribution and model prediction for different thresholds, and picking the lowest threshold that yielded a reasonably good fit. Above the error-correction threshold (<xref ref-type="fig" rid="bty283-F2">Fig. 2a</xref>, black bars), the observed library-wide distribution of reads per UMI closely follows the model prediction, and the <italic>E.coli</italic> data even shows traces of the secondary peak that represents molecules not duplicated in the first reaction PCR cycle. Choosing a different threshold will change the number of UMIs surviving the error-correction filter, but has little influence on the estimated reaction efficiency and on the estimated total number of UMIs after loss correction (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>). We thus conclude that our model captures the main stochastic behavior of the amplification and sequencing processes, and accurately models the read-count distribution of true UMIs.
</p>
      <fig id="bty283-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>(<bold>A</bold>) Observed and predicted library-wide distribution of reads per UMI and parameter and loss estimates. Filtered UMIs (grey bars, left of threshold <italic>T</italic>) are over-abundant and thus assumed to contain both phantom and true UMIs (red dots). UMIs surviving the filter (black bars) closely follow the predicted distribution (black dots) and are assumed to be true UMIs. <bold>(B)</bold> Variability of the (shrunken) model parameters and resulting loss between genes. Includes parameter for 7481 detected genes in <italic>D.melanogaster</italic> R1, 8001 genes in R2, 2380 genes in <italic>E.coli</italic> R1 and 2308 genes in R2. (Color version of this figure is available at <italic>Bioinformatics</italic> online.)</p>
        </caption>
        <graphic xlink:href="bty283f2"/>
      </fig>
      <p>The UMIs removed by our filter, i.e. those with fewer reads than the error-correction threshold demands, (<xref ref-type="fig" rid="bty283-F2">Fig. 2A</xref>, gray bars) are over-abundant compared to our prediction. This over-abundance increases further as per-UMI read counts drop, indicating the existence of a group of UMIs with significantly reduced molecular family sizes. While we may expect some systematic variation of family sizes between true UMIs (on top of the stochastic variations that our PCR model predicts), we would expect these to be gradual and not form distinct groups. We conclude that the extra UMIs causing the observed over-abundance are indeed phantoms that are rightly removed by our algorithm. We note that none of these phantoms were removed by either the UMI merging algorithm of <xref rid="bty283-B12" ref-type="bibr">Smith <italic>et al.</italic> (2017)</xref>, or (for the <italic>E.coli</italic> data) by filtering UMIs for which the complementary UMI (representing the second strand of the template molecule) was not detected.</p>
      <p>For the <italic>D.melanogaster</italic> data, our loss estimates of 9% (R1) and 8.8% (R2) are about a magnitude higher than the 1% (R1) and 2% (R2) estimated using the (truncated) Poisson distribution suggested by <xref rid="bty283-B7" ref-type="bibr">Kivioja <italic>et al.</italic> (2012)</xref>. Given that using a Poisson model amounts to assuming a 100% efficient duplication of molecules during each PCR cycle, this severe underestimation by the Poisson model shows that the inherent stochasticity of the PCR cannot be neglected.</p>
    </sec>
    <sec>
      <title>3.3 Gene-specific quantification bias</title>
      <p>The gene-specific (shrunken) estimates for amplification efficiency, average reads per UMI, and loss that our algorithm produces, vary between genes to different degrees (<xref ref-type="fig" rid="bty283-F2">Fig. 2B</xref>). We observe the smallest amount of variation for the average number of reads per UMI (<xref ref-type="fig" rid="bty283-F2">Fig. 2B</xref>, left)—the estimates of this parameter are virtually identical for a large majority of genes, and differs only for a few outliers.</p>
      <p>The estimated amplification efficiencies on the other hand can vary substantially between genes (<xref ref-type="fig" rid="bty283-F2">Fig. 2B</xref>, middle). For the two <italic>D.melanogaster</italic> replicates the range is 22–81% (R1) and 1–83% (R2). Considering that in this experiment only the 3’ ends of transcripts were sequenced, and all fragments contributing to a gene hence share a similar sequence composition, this is not unexpected. These differences in efficiency cause the loss to vary heavily between genes as well (<xref ref-type="fig" rid="bty283-F2">Fig. 2B</xref>, right), between 4 and 35% for R1 and between 4 and 89% for R2 (which has a much lower overall sequencing depth). Without gene-specific loss corrections, abundance comparisons between genes will thus suffer from systematic quantification bias against certain genes of up to <inline-formula id="IE70"><mml:math id="IM70"><mml:mo>≈</mml:mo></mml:math></inline-formula> 35–4% = 31% for R1 and up to <inline-formula id="IE71"><mml:math id="IM71"><mml:mo>≈</mml:mo></mml:math></inline-formula> 85% for R2. The larger amount of systematic bias in <italic>D.melanogaster</italic> R2 is caused by the two-fold reduction of the number of reads per molecules in R2 compared with R1—due to the lower number of reads per molecule in R2, the same difference in amplification efficiencies between two genes translates into a larger difference of the number of lost molecules in R2 compared with R1.</p>
      <p>In contrast, fragments from all parts of the transcript were sequenced in the <italic>E.coli</italic> experiments, and together with the high sequencing depth (<inline-formula id="IE72"><mml:math id="IM72"><mml:mo>≈</mml:mo></mml:math></inline-formula>300 reads per UMI), we now expect little variations of efficiency, and small and highly uniform losses across genes. Our efficiency and loss estimates reflects this (<xref ref-type="fig" rid="bty283-F2">Fig. 2B</xref>, middle and right), and as the lack of outliers shows, they do so even for genes with only few UMIs. Yet for these genes, the raw (unshrunken) gene-specific estimates are noisy (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S3</xref>), proving that shrinking the raw estimates successfully reduces the noise to acceptable levels.</p>
    </sec>
    <sec>
      <title>3.4 Bias-corrected transcript counts</title>
      <p>To further verify the accuracy of the corrected transcript counts computed by our algorithm, we conducted a simulation study. We use the (loss-corrected) estimated total transcript abundances of <italic>D.melanogaster</italic> replicate 1, rounded to 10, 30, 100, 300, 1000, 3000 or 10 000 molecules as the true transcript abundances. We then simulated amplification and sequencing of these transcripts, using for each gene the previously estimated gene-specific efficiency and average number of reads per UMI (<xref ref-type="fig" rid="bty283-F2">Fig. 2B</xref>). To the resulting list of UMIs and their read-counts for each gene we applied our algorithm to recover the true transcript abundances (threshold <italic>T</italic> = 5 as before), and determined for each gene the relative error of the recovered abundances compared with the simulation input.</p>
      <p><xref ref-type="fig" rid="bty283-F3">Figure 3</xref> shows these relative errors (i) if no correction is done (ii) if the correction is based soley on the raw gene-specific loss estimates (i.e. no shrinkage) and (iii) for the full TRUmiCount algorithm (i.e. using shrunken loss estimates). The uncorrected counts systematically under-estimate the true transcript counts, in 50% of the cases by at least <inline-formula id="IE73"><mml:math id="IM73"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>, independent of the true number of transcripts per gene. And even at high transcript abundances, the relative error still varies <italic>between</italic> genes, biasing not only absolute transcript quantification, but also relative comparisons between different genes. The counts corrected using raw gene-specific estimates are unbiased and virtually error-free for strongly expressed genes, but exhibit a large amount of additional noise for weakly expressed genes. The full TRUmiCount algorithm successfully controls the amount of added noise, and shows no additional noise for weakly expressed genes, while still being unbiased and virtually error-free for more strongly expressed genes.
</p>
      <fig id="bty283-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Relative error of estimated total number of transcripts depending on the true number of transcripts. Left panel uses the observed number of UMIs without any correction. Middle panel uses the raw gene-specific loss estimates to correct for lost UMIs. Right panel uses the full TRUMmiCount algorithm employing shrunken gene-specific loss estimates to correct for lost UMIs</p>
        </caption>
        <graphic xlink:href="bty283f3"/>
      </fig>
    </sec>
    <sec>
      <title>3.5 Peformance for low sequencing depth</title>
      <p>To assess the performance of the TRUmiCount algorithm at low sequencing depths such as are common for single-cell RNA-Seq experiments, we ran a second simulation with gene-specific depth parameters scaled such that the average across all genes was <italic>D</italic> = 1 read per molecule (<xref ref-type="fig" rid="bty283-F4">Fig. 4</xref>). Under these conditions, the most likely outcome for a single molecule in the initial sample is to remain unsequenced (39% of molecules), and only 27% of molecules are found in more than one read. The library-wide efficiency estimate of 57% (<xref ref-type="fig" rid="bty283-F4">Fig. 4A</xref>) is nevertheless accurate, and identical to the one computed for the full dataset (<italic>D.melanogaster</italic> R1) that the simulation was based on (<xref ref-type="fig" rid="bty283-F2">Fig. 2A</xref>).
</p>
      <fig id="bty283-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>TRUmiCount performance for low sequencing depth. <bold>(A)</bold> Overall distribution of observed and predicted reads per UMI for an average of <italic>D</italic> = 1 read per molecule. <bold>(B)</bold> Relative error of estimated total number of transcripts for different true numbers of transcripts and <italic>D</italic> = 1 read per molecules on average. (Color version of this figure is available at <italic>Bioinformatics</italic> online.)</p>
        </caption>
        <graphic xlink:href="bty283f4"/>
      </fig>
      <p>For the relative error of the corrected transcript counts we observed a roughly 2-fold increase at low-sequencing depth (<xref ref-type="fig" rid="bty283-F4">Fig. 4B</xref>) compared with the situation at original sequencing depth (<xref ref-type="fig" rid="bty283-F3">Fig. 3</xref>, right), but still no systematic over- or under-estimation. We estimate that Poissonian sampling effects account for about a <inline-formula id="IE74"><mml:math id="IM74"><mml:mrow><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>0.09</mml:mn></mml:mrow></mml:msqrt><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>0.39</mml:mn></mml:mrow></mml:msqrt><mml:mo>≈</mml:mo><mml:mn>1.2</mml:mn></mml:mrow></mml:math></inline-formula>-fold increase of the relative errors. The rest is probably due to the parameter estimation problem becoming harder at lower sequencing depths, particularly for weakly expressed genes. For more strongly expressed genes, the relative quantification error again drops towards zero, similar to the behavior at original sequencing depth.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>The TRUmiCount algorithm we presented successfully removes the biases inherent in raw UMI counts, and produces unbiased and low-noise measurements of transcript abundance, allowing for unbiased comparisons between different genes, exons and other genomic features. It does so even in the presence of various types of phantom UMIs and varying amplification efficiencies, both between samples and along the genome. Compared to other error-correction techniques, it is not restricted to particular types of phantom UMIs, or to a special Y-shaped design of the sequencing adapters.</p>
    <p>Our model of the amplification and sequencing process is mechanistic, and its two parameters have an immediate physical interpretation. They can both be determined from the experimental data without the need for either guesses or separate calibration experiments. The TRUmiCount algorithm thus does not require any changes to library preparation over the basic UMI method. By inspecting the estimated parameters—in particular the amplification efficiency, the amplification reaction itself can be studied. For example, by estimating model parameters separately for sequenced fragments of different lengths, the drop of reaction efficiency with increasing fragment lengths can be quantified (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>).</p>
    <p>Although TRUmiCount requires that libraries are sequenced sufficiently deeply to detect at least some UMIs more than once, it can also deal with cases where a molecule is on average detected only by a single read, which is common e.g. for single-cell RNA-Seq. The performance of TRUmiCount is reduced a bit in such situations, but it still offers an improvement over uncorrected counts by removing systematic biases. For even lower read counts, where gene-specific bias correction becomes infeasible, we expect that TRUmiCount could still be used to correct for cell-specific (instead of gene-specific) biases, thus reducing the amount of technical noise when comparing absolute transcript counts of the same gene between individual cells.</p>
    <p>The TRUmiCount algorithm can thus help to increase the accuracy of many quantitative applications of NGS, and by removing biases from comparisons between genes can aid in the quantitative unraveling of complex gene interaction networks. To make our method as easily accessible as possible to a wide range of researchers, we provide two readily usable implementations of our algorithm. Our R package <italic>gwpcR</italic> enables a flexible integration into existing R-based data analysis workflows. In addition, we offer the command-line tool TRUmiCount which is designed to work in conjunction with the <italic>UMI-Tools</italic> of <xref rid="bty283-B12" ref-type="bibr">Smith <italic>et al.</italic> (2017)</xref>. Together they provide a complete analysis pipeline which produces unbiased transcript counts from the raw reads produced by a UMI-based RNA-Seq experiment (<ext-link ext-link-type="uri" xlink:href="http://www.cibiv.at/software/trumicount">http://www.cibiv.at/software/trumicount</ext-link>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="bty283_supplement.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Armin Djamei and Simon Uhse for introducing us to the concept of UMIs, all members of the <italic>Center for Integrative Bioinformatics Vienna</italic> (CIBIV), in particular Luis Paulin-Paz, Celine Prakash and Philipp Rescheneder for their valuable feedback throughout all stages of this project, and Olga Chernomor for sharing her insights into shrinkage estimators. We also thank the “DoktoratsKolleg RNA Biology” for funding this work.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Austrian Science Fund (FWF): W1207-B09.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bty283-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Aird</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Analyzing and minimizing PCR amplification bias in Illumina sequencing libraries</article-title>. <source>Genome Biol</source>., <volume>12</volume>, <fpage>R18.</fpage><pub-id pub-id-type="pmid">21338519</pub-id></mixed-citation>
    </ref>
    <ref id="bty283-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Akima</surname><given-names>H.</given-names></name></person-group> (<year>1996</year>) 
<article-title>Algorithm 760; rectangular-grid-data surface fitting that has the accuracy of a bicubic polynomial</article-title>. <source>ACM Trans. Math Softw</source>., <volume>22</volume>, <fpage>357</fpage>–<lpage>361</lpage>.</mixed-citation>
    </ref>
    <ref id="bty283-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Carter</surname><given-names>G.M.</given-names></name>, <name name-style="western"><surname>Rolph</surname><given-names>J.E.</given-names></name></person-group> (<year>1974</year>) 
<article-title>Empirical bayes methods applied to estimating fire alarm probabilities</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>69</volume>, <fpage>880.</fpage></mixed-citation>
    </ref>
    <ref id="bty283-B4">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Harris</surname><given-names>T.E.</given-names></name></person-group> (<year>1989</year>). <source>The Theory of Branching Processes</source>. 
<publisher-name>Dover</publisher-name>, 
<publisher-loc>New York</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="bty283-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hug</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Schuler</surname><given-names>R.</given-names></name></person-group> (<year>2003</year>) 
<article-title>Measurement of the number of molecules of a single mRNA species in a complex mRNA preparation</article-title>. <source>J. Theor. Biol</source>., <volume>221</volume>, <fpage>615</fpage>–<lpage>624</lpage>.<pub-id pub-id-type="pmid">12713944</pub-id></mixed-citation>
    </ref>
    <ref id="bty283-B6">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>James</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>Stein</surname><given-names>C.</given-names></name></person-group> (<year>1961</year>) 
<article-title>Estimation with quadratic loss</article-title>. In <source>Proceedings of the 4th Berkeley Symposium on Mathematical Statistics and Probability</source>, vol. <volume>1</volume>, pp. <fpage>361</fpage>–<lpage>379</lpage>. 
<publisher-name>University of California Press</publisher-name>, 
<publisher-loc>Berkeley, CA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="bty283-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kivioja</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Counting absolute numbers of molecules using unique molecular identifiers</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>72</fpage>–<lpage>74</lpage>.</mixed-citation>
    </ref>
    <ref id="bty283-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Krawczak</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>1989</year>) 
<article-title>Polymerase chain reaction: replication errors and reliability of gene diagnosis</article-title>. <source>Nucleic Acids Res</source>., <volume>17</volume>, <fpage>2197</fpage>–<lpage>2201</lpage>.<pub-id pub-id-type="pmid">2565023</pub-id></mixed-citation>
    </ref>
    <ref id="bty283-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Marioni</surname><given-names>J.C.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>. <source>Genome Res</source>., <volume>18</volume>, <fpage>1509</fpage>–<lpage>1517</lpage>.<pub-id pub-id-type="pmid">18550803</pub-id></mixed-citation>
    </ref>
    <ref id="bty283-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schmitt</surname><given-names>M.W.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Detection of ultra-rare mutations by next-generation sequencing</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A</source>., <volume>109</volume>, <fpage>14508</fpage>–<lpage>14513</lpage>.<pub-id pub-id-type="pmid">22853953</pub-id></mixed-citation>
    </ref>
    <ref id="bty283-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shiroguchi</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Digital RNA sequencing minimizes sequence-dependent bias and amplification noise with optimized single-molecule barcodes</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A</source>., <volume>109</volume>, <fpage>1347</fpage>–<lpage>1352</lpage>.<pub-id pub-id-type="pmid">22232676</pub-id></mixed-citation>
    </ref>
    <ref id="bty283-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>UMI-tools: modeling sequencing errors in unique molecular identifiers to improve quantification accuracy</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>491</fpage>–<lpage>499</lpage>.<pub-id pub-id-type="pmid">28100584</pub-id></mixed-citation>
    </ref>
    <ref id="bty283-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weiss</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>von Haeseler</surname><given-names>A.</given-names></name></person-group> (<year>1995</year>) 
<article-title>Modeling the polymerase chain reaction</article-title>. <source>J. Comput. Biol</source>., <volume>2</volume>, <fpage>49</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">7497120</pub-id></mixed-citation>
    </ref>
    <ref id="bty283-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weiss</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>von Haeseler</surname><given-names>A.</given-names></name></person-group> (<year>1997</year>) 
<article-title>A coalescent approach to the polymerase chain reaction</article-title>. <source>Nucleic Acids Res</source>., <volume>25</volume>, <fpage>3082</fpage>–<lpage>3087</lpage>.<pub-id pub-id-type="pmid">9224608</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
