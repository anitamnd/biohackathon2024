<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Commun Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Commun Biol</journal-id>
    <journal-title-group>
      <journal-title>Communications Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2399-3642</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8448759</article-id>
    <article-id pub-id-type="pmid">34535759</article-id>
    <article-id pub-id-type="publisher-id">2622</article-id>
    <article-id pub-id-type="doi">10.1038/s42003-021-02622-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GenNet framework: interpretable deep learning for predicting phenotypes from genetic data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2630-8217</contrib-id>
        <name>
          <surname>van Hilten</surname>
          <given-names>Arno</given-names>
        </name>
        <address>
          <email>a.vanhilten@erasmusmc.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9777-3338</contrib-id>
        <name>
          <surname>Kushner</surname>
          <given-names>Steven A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4958-847X</contrib-id>
        <name>
          <surname>Kayser</surname>
          <given-names>Manfred</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0372-8585</contrib-id>
        <name>
          <surname>Ikram</surname>
          <given-names>M. Arfan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3687-2508</contrib-id>
        <name>
          <surname>Adams</surname>
          <given-names>Hieab H. H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2355-5258</contrib-id>
        <name>
          <surname>Klaver</surname>
          <given-names>Caroline C. W.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Niessen</surname>
          <given-names>Wiro J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3403-2313</contrib-id>
        <name>
          <surname>Roshchupkin</surname>
          <given-names>Gennady V.</given-names>
        </name>
        <address>
          <email>g.roshchupkin@erasmusmc.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5645.2</institution-id><institution-id institution-id-type="ISNI">000000040459992X</institution-id><institution>Department of Radiology and Nuclear Medicine, </institution><institution>Erasmus MC, Medical Center, </institution></institution-wrap>Rotterdam, the Netherlands </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.5645.2</institution-id><institution-id institution-id-type="ISNI">000000040459992X</institution-id><institution>Department of Psychiatry, </institution><institution>Erasmus MC, Medical Center, </institution></institution-wrap>Rotterdam, the Netherlands </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.5645.2</institution-id><institution-id institution-id-type="ISNI">000000040459992X</institution-id><institution>Department of Genetic Identification, </institution><institution>Erasmus MC, Medical Center, </institution></institution-wrap>Rotterdam, the Netherlands </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.5645.2</institution-id><institution-id institution-id-type="ISNI">000000040459992X</institution-id><institution>Department of Epidemiology, </institution><institution>Erasmus MC, Medical Center, </institution></institution-wrap>Rotterdam, the Netherlands </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.5645.2</institution-id><institution-id institution-id-type="ISNI">000000040459992X</institution-id><institution>Department of Clinical Genetics, </institution><institution>Erasmus MC, Medical Center, </institution></institution-wrap>Rotterdam, the Netherlands </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.5645.2</institution-id><institution-id institution-id-type="ISNI">000000040459992X</institution-id><institution>Department of Ophthalmology, </institution><institution>Erasmus MC, Medical Center, </institution></institution-wrap>Rotterdam, the Netherlands </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.5292.c</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 4740</institution-id><institution>Faculty of Applied Sciences, </institution><institution>TU Delft, </institution></institution-wrap>Delft, the Netherlands </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>4</volume>
    <elocation-id>1094</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021, corrected publication 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par2">Applying deep learning in population genomics is challenging because of computational issues and lack of interpretable models. Here, we propose GenNet, a novel open-source deep learning framework for predicting phenotypes from genetic variants. In this framework, interpretable and memory-efficient neural network architectures are constructed by embedding biologically knowledge from public databases, resulting in neural networks that contain only biologically plausible connections. We applied the framework to seventeen phenotypes and found well-replicated genes such as <italic>HERC2</italic> and <italic>OCA2</italic> for hair and eye color, and novel genes such as <italic>ZNF773</italic> and <italic>PCNT</italic> for schizophrenia. Additionally, the framework identified ubiquitin mediated proteolysis, endocrine system and viral infectious diseases as most predictive biological pathways for schizophrenia. GenNet is a freely available, end-to-end deep learning framework that allows researchers to develop and use interpretable neural networks to obtain novel insights into the genetic architecture of complex traits and diseases.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par3">van Hilten and colleagues present GenNet, a deep-learning framework for predicting phenotype from genetic data. This framework generates interpretable neural networks that provide insight into the genetic basis of complex traits and diseases.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Software</kwd>
      <kwd>Population genetics</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Epidemiology</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Dutch Technology Foundation (STW) through the 2005 Simon Steven Meester grant 2015 to W.J. Niessen.</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par4">While genome-wide association studies (GWAS) have identified numerous genomic loci associated with complex traits and diseases, the biological interpretation of the underlying mechanisms often remains unclear. Recent GWAS studies with increasingly large sample sizes are resulting greater numbers of significant associations, at an increasing number of independent loci. To illustrate, the latest GWAS for body height based on 700,000 individuals identified more than 3000 near-independent significantly associated single nucleotide polymorphisms (SNPs)<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Uncovering a clear biological interpretation from all this information is a challenging task, in which causal variants, genes, and pathways need to be identified. In response, many methods such as MAGMA<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>, ALIGATOR<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, and INRICH<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, have been developed to obtain a biological interpretation from GWAS summary statistics, providing insights into relevant genes and pathways for defined phenotypes of interest. These methods explore GWAS summary statics and utilize knowledge from annotated biological databases such as NCBI RefSeq<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, KEGG<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, Reactome<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, and GTEx<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, which have proven to contain crucial information for understanding the underlying biological mechanisms of the human genome<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Additionally, it has been shown that embedding biological knowledge from these databases in polygenic risk scores can improve interpretation, trans-ancestry portability, and genetic risk prediction<sup><xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref></sup>.</p>
    <p id="Par5">Given the increasing amount of data available via biobanks and new developments to integrate data, it is now feasible to analyze raw data with more advanced methods. Deep learning is the state of the art in many domains such as medical image analysis<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> and natural language processing<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> because of its flexibility and modeling capabilities. In many cases, deep learning yields better performance than traditional approaches, since it scales very well with data size and can model highly non-linear relationships. However, a limitation to deep learning is that these algorithms are often uninterpretable because of their complexity<sup><xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>. Additionally, genetic data does not lend itself well to the convolution operation, the main driver of the success of deep learning in the imaging domain. Traditional fully connected neural networks have been successfully applied to predict genetic risk. Recently, Badre et al.<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> employed a fully connected neural network for improving polygenic risk scores for breast cancer, training a neural network with up to 528,620 input variants. However, these networks are very memory-intensive and therefore often require pre-selecting SNPs using GWAS summary statistics. Applying these fully connected neural networks for millions of input variants would require infeasible amounts of computational time and memory.</p>
    <p id="Par6">To overcome these limitations, we propose GenNet, a novel framework for predicting phenotype from genotype. Within the GenNet framework, biological information from annotated biological sources such as NCBI RefSeq, KEGG, and single RNA gene expression datasets, is used to define biologically plausible connections. As a result, neural networks based on this framework are memory efficient, interpretable, and yield biological interpretations for their predictions. GenNet is an end-to-end deep learning framework available as a command-line tool (<ext-link ext-link-type="uri" xlink:href="https://github.com/ArnovanHilten/GenNet">https://github.com/ArnovanHilten/GenNet/</ext-link>).</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>A framework for constructing interpretable neural networks for phenotype prediction</title>
      <p id="Par7">The main concept of the GenNet framework is summarized graphically in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. In this framework, prior knowledge is used to create groups of connected nodes to reduce the number of learnable parameters in comparison to a fully connected neural network. For example, in the first layer, biological knowledge in the form of gene annotations is used to group millions of SNPs and to connect those SNPs to their corresponding genes. The resulting layer retains only meaningful connections, significantly reducing the total number of parameters compared to a classical fully connected layer. Because of this memory-efficient approach networks in the GenNet framework are able to handle millions of inputs for genotype-to-phenotype prediction.<fig id="Fig1"><label>Fig. 1</label><caption><title>Overview of the GenNet framework.</title><p>Neural networks are created by using prior biological knowledge to define connections between layers (i.e., SNPs are connected to their corresponding genes by using gene annotations, and genes are connected to their corresponding pathway by using pathway annotations). Prior knowledge is thus used to define each connection, creating interpretable networks.</p></caption><graphic xlink:href="42003_2021_2622_Fig1_HTML" id="d32e477"/></fig></p>
      <p id="Par8">Biological knowledge is thus used to define only meaningful connections, shaping the architecture of the neural network. Interpretability is inherent to the neural network’s architecture; each node is uniquely defined by its connections and represents a biological entity (e.g., gene, pathway). For example, a network that connects SNPs-to-genes and genes-to-output. The learned weights of the connections between layers represent the effect of the SNP on the gene or the effect of the gene on the output. In the network, all neurons represent biological entities, and weights model the effects between these entities, together forming a biologically interpretable neural network.</p>
      <p id="Par9">Many types of layers can be created using this principle. Apart from gene annotations, our framework provides layers built from exon annotations, pathway annotations, chromosome annotations, and cell and tissue type expressions. All these layers can be used like building blocks to form new neural network architectures.</p>
      <p id="Par10">We built a proof of concept simulations as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a and described in Supplementary Method 1. These simulations demonstrate that the proposed network architecture is interpretable, the strongest weights are assigned to causal variants and genes. Next, we designed experiments to test the network architecture’s performance under a variety of conditions. Performance is dependent on phenotype, neural network architecture, and dataset size. To disentangle this, we created simulated data with varying levels of heritability, the number of training samples, and polygenicity (Supplementary Method 1). Figures <xref rid="Fig2" ref-type="fig">2</xref>b, c demonstrate the major trends observed in the simulations. As expected, the network performs best for traits with high heritability, high number of training samples, and low polygenicity.<fig id="Fig2"><label>Fig. 2</label><caption><title>Simulation results and the importance of each gene for predicting schizophrenia.</title><p><bold>a</bold> A simple, non-linear proof of concept. In this simulation, each gene in the causal region has two causal SNPs that cause the simulated disease. The magnitude of the learned weight is represented by the line thickness (contributing causal connections in red, non-contributing control connections in gray). <bold>b</bold> A secondary set of simulations show the performance of GenNet, expressed as area under the curve, for increasing levels of heritability and training set size (<bold>c</bold>). The black curve presents the theoretical maximum of the AUC versus heritability. <bold>d</bold> Manhattan plot showing genes and their relative importance according to the network, here we have shown the results for distinguishing between schizophrenia cases and controls in the Sweden exome study. This Manhattan plot is a cross-section between the gene layer (21,390 nodes) and the outcome of a trained network with 1,288,701 input variants.</p></caption><graphic xlink:href="42003_2021_2622_Fig2_HTML" id="d32e512"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Applying neural network architectures based on gene-annotations to population-based data</title>
      <p id="Par11">Motivated by the proof-of-concept and outcomes of the simulations, we applied the framework to data from multiple sources, including population-based data from the UK Biobank study<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, the Rotterdam study<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, and the Swedish Schizophrenia Exome Sequencing study<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Phenotypes vary from traits that can be predicted well from only a dozen variants (eye color) to disorders in which thousands of variants explain only a small portion of the variance (schizophrenia and bipolar disorder)<sup><xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR22">22</xref></sup>. The datasets also vary in size and type of data. We used 113,241 exonic variants from imputed microarray-based GWAS data from the Rotterdam study for predicting eye color while we predict fifteen phenotypes in the UK Biobank using 6,986,636 input variants from whole exome sequencing (WES) data. Finally, we used 1,288,701 WES input variants for predicting schizophrenia in the Swedish study. An overview of the main results for networks embedded with gene and pathway information can be found in Table <xref rid="Tab1" ref-type="table">1</xref>. The results for all the experiments, including expression-based networks, can be found in Supplementary Note 2.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Overview of the main results for the experiments using the Rotterdam Study, UK Biobank, and Swedish Schizophrenia Exome Sequencing study data.</p></caption><table frame="hsides" rules="groups"><tbody><tr><td>Dataset (type)</td><td rowspan="2">Trait</td><td colspan="2">Subjects &amp; phenotype</td><td rowspan="2">AUC gene test (val)</td><td rowspan="2">Top three predictive genes</td><td rowspan="2">AUC pathway test (val)</td><td colspan="3">Top predictive pathway</td></tr><tr><td/><td>Class I</td><td>Class II</td><td>Global level</td><td>Middle level</td><td>Local level</td></tr><tr><td>Rotterdam Study (genotype array)</td><td>Eye color</td><td>4041 Blue</td><td>2250 Other</td><td><bold>0.75 (0.74)</bold></td><td><italic>HERC2, OCA2, LAMC1</italic></td><td>0.50 (0.52)</td><td>Organismal Systems (78.4%)</td><td>Digestive system (72.6%),</td><td>Pancreatic secretion (59.1%)</td></tr><tr><td>UK Biobank (exome)</td><td rowspan="3">Hair color</td><td>1734 Red</td><td>1727 Other</td><td><bold>0.93 (0.94)</bold></td><td><italic>MC1R*</italic>, <italic>SHOC2, DCTN3</italic></td><td>0.77 (0.77)</td><td>Genetic Information Processing (87.4%)</td><td>Replication and repair (83.4%)</td><td>Fanconi anemia pathway (79.7%)</td></tr><tr><td/><td>3762 Black</td><td>3753 Other</td><td>0.80 (0.82)</td><td><italic>OCA2, RPL23AP8, MC1R*</italic></td><td>0.76 (0.78)</td><td>Organismal Systems (46.9%)</td><td>Endocrine system (18.6%)</td><td>Axon guidance (5.0%)</td></tr><tr><td/><td>4501 Blond</td><td>4518 Other</td><td><bold>0.66 (0.65)</bold></td><td><italic>OCA2</italic>, <italic>TC2N</italic>, <italic>SLC45A2</italic></td><td>0.58 (0.57)</td><td>Organismal Systems (70.2%)</td><td>Endocrine system (30.1%),</td><td>Adrenergic signaling in cardiomyocytes (4.1%)</td></tr><tr><td/><td>Bipolar disorder</td><td>343 Cases</td><td>347 Controls</td><td><bold>0.60 (0.56)</bold></td><td><italic>LINC00266-1</italic>, <italic>CSMD1</italic>, <italic>TCERG1L</italic></td><td>0.47 (0.55)</td><td>Organismal Systems (76.9%)</td><td>Endocrine system (46.5%)</td><td>Melanogenesis (32.9%)</td></tr><tr><td/><td>Atrial fibrillation</td><td>192 Cases</td><td>194 Controls</td><td><bold>0.56 (0.59)</bold></td><td><italic>**BRINP1, SORBS3, ELM0D3</italic></td><td>0.57 (0.63)</td><td>Organismal Systems (39.6%)</td><td>Signal transduction (11.2%)</td><td>Cytokine−cytokine receptor interaction (4.4%)</td></tr><tr><td/><td>Coronary Artery Disease</td><td>1563 Cases</td><td>1600 Controls</td><td><bold>0.56 (0.58)</bold></td><td><italic>**STARD7-AS1, VWC2L, NSD2</italic></td><td>0.54 (0.56)</td><td>Environmental Information Processing (29.5%),</td><td>Signal transduction (27.7%)</td><td>PI3K-Akt signaling pathway (4.6%)</td></tr><tr><td/><td>Dementia</td><td>139 Cases</td><td>142 Controls</td><td><bold>0.60 (0.65)</bold></td><td><italic>RPL23AP87, CTNNA3, LINC01003</italic></td><td>0.55 (0.58)</td><td>Human Diseases (39.8%)</td><td>Signal transduction (22.2%)</td><td>Pathways in cancer (5.6%)</td></tr><tr><td/><td>Male balding pattern</td><td>3454 Balding pattern 1</td><td>3454 Balding pattern 4</td><td><bold>0.56 (0.57)</bold></td><td><italic>NGEF</italic>, <italic>NKRD18B</italic>, <italic>SYNJ2</italic></td><td>0.54 (0.55)</td><td>Organismal Systems (34.6%)</td><td>Nervous system (9.7%)</td><td>Metabolic pathways (8.7%)</td></tr><tr><td/><td>Asthma</td><td>4229 Cases</td><td>4214 Controls</td><td><bold>0.55 (0.57)</bold></td><td><italic>HLA-DQB1, HCG9, LINC00266-1</italic></td><td>0.51 (0.54)</td><td>Genetic Information Processing (52.3%)</td><td>Folding, sorting and degradation (41.5%)</td><td>Ubiquitin mediated proteolysis (22.0%)</td></tr><tr><td/><td>Diabetes</td><td>2557 Cases</td><td>2555 Controls</td><td><bold>0.54 (0.57)</bold></td><td><italic>**DNAH10, SNAR-I, PSMD13</italic></td><td>0.54 (0.54)</td><td>Environmental Information Processing (43.5%),</td><td>Signal transduction (40.5%),</td><td>Ras signaling pathway (7.9%)</td></tr><tr><td/><td>Breast cancer</td><td>1070 Cases</td><td>1082 Controls</td><td><bold>0.51 (0.56)</bold></td><td><italic>RPL23AP87, LINC00266-1, HPSE</italic></td><td>0.51 (0.56)</td><td>Human Diseases (57.1%)</td><td>Infectious diseases: Viral (16.6%)</td><td>Pathways in cancer (6.5%)</td></tr><tr><td>Sweden (exome)</td><td>Schizophrenia</td><td>4969 Cases</td><td>6245 Controls</td><td><bold>0.74 (0.73)</bold></td><td><italic>ZNF773</italic>, <italic>PCNT</italic>, <italic>DYSF</italic></td><td>0.68 (0.67)</td><td>Human Diseases (30.8%)</td><td>Infectious diseases: Viral (27.3%)</td><td>Human papillomavirus infection (11.7%)</td></tr></tbody></table><table-wrap-foot><p>The performance in AUC for the network with gene-annotations is bold if the network outperformed or matched LASSO regression. Manhattan plots for the genes can be found in Supplementary Notes 3−5. *MC1R was not annotated but was identified by linkage disequilibrium. **Many genes contributed to the prediction without clear separation between genes (see Supplementary Note 4).</p></table-wrap-foot></table-wrap></p>
      <p id="Par12">Phenotypes with more training samples and that require less variants to obtain high predictive performance, such as eye and hair color, yielded the best performance. Nonetheless, we achieved a good predictive performance for schizophrenia, a highly polygenic disorder, with an area under the curve (AUC) of 0.74 in the held-out test set. All models based on gene annotations outperformed or matched the baseline LASSO logistic regression model with the exception of the black hair color phenotype.</p>
      <p id="Par13">Inspecting the networks, we found that the <italic>OCA2</italic> gene was the most important gene to predict blond, dark, and light brown hair color. <italic>OCA2</italic> is involved in the transport of tyrosine, a precursor of melanin<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. The <italic>OCA2</italic> signal is likely amplified by the nearby gene <italic>HERC2</italic>, previously identified via functional genetic studies as harboring a strong, long-distance enhancer regulating <italic>OCA2</italic> gene expression underlaying pigmentation variation<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. According to the network, <italic>OCA2</italic> and <italic>HERC2</italic> are the two most predictive genes for predicting blue iris color. Both genes were previously identified through GWAS studies of hair and eye color <sup><xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref></sup>.</p>
      <p id="Par14">In the experiments with schizophrenia as outcome, the network was able to classify cases and controls with a maximum accuracy of 0.685 (mean of 0.663 ± 0.014 over 10 runs). Based on all genetic aspects, we estimate the theoretical upper limit for classification accuracy to be between 0.73 and 0.83 for schizophrenia in this dataset (Supplementary Method 6). The model achieved a maximum area under the receiver operating curve of 0.738 (mean of 0.715 ± 0.016) in the held-out test set over 10 runs, thereby considerably outperforming the LASSO logistic regression baseline which obtained a maximum AUC of 0.649 (mean of 0.644 ± 0.003). The genes <italic>ZNF773, PCNT,</italic> and <italic>DYSF</italic> were assigned the highest weights by the neural network and were thus considered to be the most predictive genes for schizophrenia. However, the polygenic nature of schizophrenia can be seen when comparing the Manhattan plot of the genes (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>) to other phenotypes in this study (<xref rid="MOESM1" ref-type="media">Supplementary Notes</xref> 3−5). More genes contributed to the prediction for schizophrenia than for the other phenotypes examined. As a consequence, the predictive performance deteriorates slower for schizophrenia than for eye color prediction when connections to the most predictive genes are removed before training (see Supplementary Discussion 7).</p>
      <p id="Par15">To evaluate if embedding prior knowledge also improves predictive performance, we compared networks built using gene annotations to networks with the same number of connections but randomly connected. For predicting blue eye color, the network build using gene annotations performed significantly better than a randomly connected neural network over ten runs (<italic>p</italic> = 6.5 × 10<sup>−3</sup>). However, for predicting schizophrenia we found the opposite, a randomly connected neural network performed significantly better than networks embedded with prior knowledge (<italic>p</italic> = 2.5 × 10<sup>−4</sup>). See Supplementary Discussion 8 for more information on all phenotypes.</p>
    </sec>
    <sec id="Sec5">
      <title>Embedding pathway and expression-based annotations into the neural network architecture</title>
      <p id="Par16">Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the relative importance of the pathways for predicting schizophrenia. The neural network, embedded with the KEGG pathway information, obtained an AUC of 0.68 in the test set. Human diseases (30.8%), organismal systems (26.7%), and genetic information processing (26.5%) were the main contributors to the neural network’s prediction of schizophrenia. The contribution of human diseases was mainly driven by viral infectious diseases (27.3%) which can be subdivided further into human papillomavirus infection (11.7%), herpes simplex infections (3.7%), and human cytomegalovirus infection (3.2%), as well as genes and SNPs assigned to these diseases. The ubiquitin-mediated proteolysis pathway, a subset of the genetic information pathway, had a relative importance of 10.0%.<fig id="Fig3"><label>Fig. 3</label><caption><title>Sunburst plot of the important KEGG pathways for predicting schizophrenia.</title><p>A neural network with layers based on KEGG pathway information was trained to predict schizophrenia. The relative importance was calculated for each pathway using the learned weights of this neural network. The sunburst plot is read from the center, which shows the output node with the prediction of the neural network. The inner ring represents the last layer with the highest-level pathways, followed by the mid-level pathways, and finally the lowest-level pathways. The gene and SNP layer are omitted for clarity.</p></caption><graphic xlink:href="42003_2021_2622_Fig3_HTML" id="d32e1119"/></fig></p>
      <p id="Par17">To investigate if the most predictive genes are concentrated in a single cell or tissue type, we used three different gene expression datasets processed by Finucane et al. (2018)<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> to create layers subsequent to the gene-based layer. The relative importance of the trained networks showed a widespread signal with small contributions by many cell and tissue types. When GTEx data was embedded in the network, uterine genes had the greatest relative importance (4.2%). For GTEx brain expression data, the frontal cortex (15.1%) had the strongest contribution, whereas for immune cell types mesenteric lymph nodes (1.23%) contributed most. An overview of the experiments performed, including GTEx and other expression-based networks for other phenotypes, can be found in Supplementary Note 2.</p>
    </sec>
  </sec>
  <sec id="Sec6" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par18">We presented a novel framework for predicting phenotypes from genotype with interpretable neural networks. The proposed neural networks have connections defined by prior biological knowledge only, reducing the number of connections and therefore the number of trainable parameters. Consequently, the networks can be trained on a single GPU and offer a biological interpretation for their predictions.</p>
    <p id="Par19">In the first set of experiments, simulations showed the network’s performance when varying the degree of heritability, polygenicity, and sample size. In the second set of experiments, the framework was applied to UK Biobank, Rotterdam study, and Swedish Schizophrenia Exome Sequencing study data. In these experiments, phenotypes with widely different heritability, sample size, and polygenicity were predicted with generally high predictive performance. For example, we obtained an AUC of 0.96 for red hair color, an AUC of 0.74 for blue eye color, and an AUC of 0.74 for predicting schizophrenia. For schizophrenia, polygenic risk scores from genome-wide association studies obtained a similar AUC of 0.72 in an independent test cohort and a mean AUC of 0.70 in 40 leave-one-out GWAS analyses (AUC ranging from 0.49 to 0.81)<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. However, a direct comparison between traditional polygenic risk scores and predictions given by neural networks from the GenNet framework would be unfair. The neural networks employed in this study use WES data or variants from the coding regions, while polygenic risk scores generally use all genotype data. Additionally, polygenic risk scores are built based on GWAS data with large sample sizes. For example for schizophrenia, the network was trained with roughly 4,696 cases and 6,969 controls while polygenic risk scores were derived using 32,838 cases and 44,357 controls<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>.</p>
    <p id="Par20">Interpretation of the trained networks revealed well-replicated genes for traits with a known etiology such as <italic>HERC2</italic> and <italic>OCA2</italic> for eye color and <italic>OCA2</italic> and <italic>TC2N</italic> for hair color<sup><xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR28">28</xref></sup>. For schizophrenia, a disorder with an unclear etiology, the network identified novel genes, including <italic>ZNF773</italic> and <italic>PCNT</italic>. In previous studies, <italic>PCNT</italic> was only nominally associated with schizophrenia, although it is known to have interactions with <italic>DISC1</italic> (Disrupted in Schizophrenia-1)<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. There is a strong correlation between (prenatal) viral infections and increased risk for developing schizophrenia<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. It is therefore interesting that by using the KEGG pathway information to create layers, we identified the viral infectious diseases pathway with its associated pathways, genes, and SNPs to be the most important for predicting schizophrenia. The results of these experiments reveal that with GenNet framework can provide insights across multiple functional levels, identifying which SNPs, genes, pathways, and tissue types are important for prediction.</p>
    <p id="Par21">In a comparison between randomly connected neural networks and networks built using gene annotations, we found that embedding gene annotations in the network architecture resulted in significantly better predictive performance for predicting eye color. However, randomly connected neural networks, with the same number of trainable parameters, performed significantly better for predicting schizophrenia. Based on these experiments using gene annotations, it seems that the optimal neural network architecture depends on the genetic architecture of the trait. But there are many factors that could influence the convergence and thus the predictive performance of a neural network aside from the genetic architecture of the trait. Among others, the quality of the available prior knowledge will be an important factor to consider.</p>
    <p id="Par22">In this study, WES data and exonic variants from microarrays have been used; however, the principles in the GenNet framework can be extended to handle diverse types of input, including genotype, gene expression, and methylation data or combinations thereof. Similarly, we explored only a fraction of the possible layers as building blocks for our networks. Any data that create unique biological groups can be used in the framework to create new layers. However, the quality of the resulting network is highly dependent on the quality of the data used. For example, networks built with biological pathway data performed generally worse than networks using only gene annotations since many genes are not annotated to pathways. But with new and better data from projects such as GTEx<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, ENCODE<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, and KEGG<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> the quality of the layers will only improve. Moreover, given the increasing sample sizes of biobanks in coming years and the development of algorithms, which allow distributed deep learning between cohorts without sharing raw data<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>, we foresee that our framework can be easily adopted for such settings and can be widely used for quantitate traits and functional mapping analysis.</p>
    <p id="Par23">In conclusion, we developed a freely-available framework, which can be used to build interpretable neural networks for genotype data by incorporating prior biological knowledge. In addition to computationally efficient, the architectures are interpretable, thereby alleviating one of the most important shortcomings of neural networks. We have demonstrated the effectiveness of this novel framework across multiple datasets and for multiple phenotypes. Given that each network node is interpretable, we anticipate this approach to have wide applicability for uncovering novel insights into the genetic architecture of complex traits and diseases.</p>
  </sec>
  <sec id="Sec7">
    <title>Methods</title>
    <sec id="Sec8">
      <title>Sweden Schizophrenia Exome Sequencing study</title>
      <p id="Par24">Sweden-Schizophrenia Population-Based Case-Control Exome Sequencing study (dbGaP phs000473.v2.p2), is a case-control study with 4969 cases and 6245 controls<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. All individuals aged 18−65, have parents born in Sweden, and provided written informed consent. The following inclusion criteria were used for cases: at least two times hospitalized with schizophrenia discharge diagnosis; no hospital register diagnosis consistent with a medical or other psychiatric disorder that mitigates the schizophrenia diagnosis. Cases were excluded if they had a relationship closer than 2nd degree relative with any other case. Controls were matched to cases and controls were never hospitalized with a discharge diagnosis of schizophrenia. Controls were excluded if they had any relation to either case or control.</p>
      <p id="Par25">The downloaded plink files were converted using HASE<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> to hierarchical data format (HDF), a format that allows fast and parallel data reading. After conversion, the data was transposed and SNPs without any variance were removed (1,288,701 SNPs remain). The data was split into a training, validation, and test set (ratio of 60/20/20), while preserving the ratio cases and controls.</p>
    </sec>
    <sec id="Sec9">
      <title>UK Biobank</title>
      <p id="Par26">We applied the framework to multiple phenotypes in the UK Biobank using the first release of the WES data, providing WES for 50,000 UK Biobank participants<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. Phenotypes are self-reported using touchscreen questions in the UK Biobank Assessment Center. Similar to the Sweden cohort all variants without variance were removed, data was converted to HDF and transposed. For every phenotype, an equal number of cases and controls were sampled. The resulting dataset is split into a train, validation, and a test set (ratio of 60/20/20). Related cases and cases with related controls, (kinship &gt; 0.0625) are all in the training set. This is done under the assumption that related cases and controls could ease training, the shared genetic information could steer the network towards the discriminatory features. The validation and test sets contain only unrelated cases and controls within and between sets. Unrelated controls are randomly sampled and added to gain an even distribution between cases and controls in all sets. Misaligned SNPs and sex chromosomes were masked in the first layer and therefore not included in the study.</p>
    </sec>
    <sec id="Sec10">
      <title>Rotterdam Study</title>
      <p id="Par27">The Rotterdam Study is a prospective population-based cohort study<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. We used the first cohort consisting of 6291 participants, genotyped using the Illumina 550 and 550 K duo arrays. Samples with low call rate (&lt;97.5%), excess autosomal heterozygosity (&gt;0.336), or sex-mismatch were excluded, as were outliers identified by the identity-by-state clustering analysis (outliers were defined as being &gt;3 standard deviation (SD) from the population mean or having identity-by-state probabilities &gt; 97%). For imputation the Markov Chain Haplotyping (MACH) package version 1.0 software (Imputed to plus strand of NCBI build 37, 1000 Genomes phase I version 3) and minimac version 2012.8.6 were used (call rate &gt; 98%, MAF &gt; 0.001 and Hardy–Weinberg equilibrium <italic>P</italic>-value &gt; 10<sup>−6</sup>). From here on, processing steps are identical as described for Sweden Schizophrenia resulting in a dataset with 113,241 exonic variants for 6291 subjects.</p>
      <p id="Par28">For each subject, both eyes were examined by an ophthalmological medical researcher, and eye (iris) color was categorized into three categories; blue, intermediate, and brown using standard images and based on the predominant color and pigmentation<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>.</p>
    </sec>
    <sec id="Sec11">
      <title>Prior knowledge</title>
      <p id="Par29">All SNPs were annotated using Annovar<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. From these annotations, a sparse connectivity matrix was created, connecting the SNPs to their corresponding genes. Connectivity matrices between SNPs, exons, and genes were made using intron-exon annotations. A mapping between genes and pathways was made using GeneSCF<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> and the KEGG database<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. Due to the hierarchical structure of the KEGG database no further preprocessing was necessary and the structure could be integrated in GenNet as it is. Expression-based layers were created using publicly available group-wise t-score statistics by Finucane et al. (2018)<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. For each tissue, we connected the genes with the top 10% highest t-statistic to a tissue to ensures that nodes are uniquely defined by their connections and therefore interpretable. This threshold is in accordance with the work of Finucane et al. (2018)<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, they showed that their results were stable for thresholds of 5, 10, and 20% (URLs can be found in Supplementary Note 9).</p>
      <p id="Par30">Additional to the used layers, there are countless of different network layers possible. Any prior knowledge that groups data uniquely can be used to create layers in the GenNet framework.</p>
    </sec>
    <sec id="Sec12">
      <title>Neural network architecture</title>
      <p id="Par31">In the GenNet framework, layers are available built from biological knowledge such as exon annotations, gene annotations, pathway annotations, cell expression, and tissue expression. Information from these resources is used to define only meaningful connections, shaping an interpretable and lightweight neural network, allowing the evaluation of millions of input variants together. These networks bear similarities to the first generation of neural networks, where prior knowledge was also used to make neural networks computationally cheaper. Recently, interest for these types of networks has rekindled for biological applications<sup><xref ref-type="bibr" rid="CR38">38</xref>–<xref ref-type="bibr" rid="CR41">41</xref></sup>.</p>
      <p id="Par32">However, the use of prior knowledge also restricts the network layout. The shape of the network, i.e., the number of neurons and the number of layers is determined by the prior knowledge embedded in the network (characteristics of all architectures can be found in Supplementary Note 9). Additionally, for a fair interpretation of the weights, each layer is preceded by batch normalization (without scaling and centering) resulting in an input for each layer with zero mean and unit standard deviation. For all classification task, a sigmoid function was used as a final activation function.</p>
      <p id="Par33">Operating within these restrictions, we optimized the following hyperparameters: the activation function, optimizer, and the L1 kernel regularization penalty. In the first set of experiments to determine the activation function, we found that the hyperbolic tangent activation function consistently led to a higher area under the curve in the validation set than the Relu and PreLu activation functions for schizophrenia, hair color, and eye color. Using the hyperbolic tangent activation function, we optimized the remaining hyperparameters. For each phenotype, we tested different combinations of optimizers with different learning rates and L1 kernel regularization penalties. We explored combinations of the Adadelta optimizer (with learning rate of 1) or Adam optimizer (learning rates of 0.01, 0.001, and 0.0001) with kernel L1 regularization penalties of 0.1, 0.001, 0.001, 0.00001, and 0 (no penalty). The L1 regularization penalty penalizes the network for the total sum of weights, similar to LASSO regression. A higher penalty will reduce the number of variants the network will use for prediction and is therefore related to the polygenicity of the phenotype.</p>
      <p id="Par34">All models were trained on a single GPU with 11 GB memory (Nvidia GeForce GTX 1080 Ti) using a batch size of 64. The networks were optimized using the ADAM or Adadelta optimizers, using weighted binary cross-entropy with weights proportional to the imbalance of the classes. For regression tasks, mean squared error was used as a loss function in combination with ReLu activations (Supplementary Method 10). The training was stopped after not improving on the validation loss for 10 epochs (all models converged within five days). For each phenotype, the configuration of hyperparameters with the best performance in the validation set was used for a final evaluation in the test set.</p>
    </sec>
    <sec id="Sec13">
      <title>Interpretation</title>
      <p id="Par35">Interpretation of the network is straightforward due to the simplicity of the concept, the stronger the weight is the more it contributes to the final prediction of the network. The simplest network in the framework, a network built by gene annotations, can be seen as ~20,000 (number of genes) parallel regressions followed by a single logistic regression. The learned weights in these regressions are similar to the coefficients in logistic regression. Especially the last node, the equation for a single neuron with a sigmoid activation (<xref rid="Equ1" ref-type="">1</xref>) is very similar to the equation for logistic regression (<xref rid="Equ2" ref-type="">2</xref>). For both, all inputs (<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2021_2622_Article_IEq1.gif"/></alternatives></inline-formula> to <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{n}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2021_2622_Article_IEq2.gif"/></alternatives></inline-formula>) are multiplied with learnable parameters followed by an addition of a learnable bias <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M6"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="42003_2021_2622_Article_IEq3.gif"/></alternatives></inline-formula> to obtain output <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y$$\end{document}</tex-math><mml:math id="M8"><mml:mi>Y</mml:mi></mml:math><inline-graphic xlink:href="42003_2021_2622_Article_IEq4.gif"/></alternatives></inline-formula>.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y={{{{{{\mathrm{Sigmoid}}}}}}}\left(\mathop{\sum }_{i=0}^{n}{x}_{i}{w}_{i}\,+B\right)$$\end{document}</tex-math><mml:math id="M10"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Sigmoid</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>+</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="42003_2021_2622_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y={{{{{{\mathrm{Sigmoid}}}}}}}\left(\mathop{\sum }_{i=0}^{n}{{x}_{i}\beta }_{i}\,+B\right)$$\end{document}</tex-math><mml:math id="M12"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Sigmoid</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>+</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="42003_2021_2622_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par36">For logistic regression, the inputs are generally normalized to compare coefficients (<inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M14"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="42003_2021_2622_Article_IEq5.gif"/></alternatives></inline-formula>). In the neural network, this is achieved by batch normalization (without center and scaling), normalizing the weights (<inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w$$\end{document}</tex-math><mml:math id="M16"><mml:mi>w</mml:mi></mml:math><inline-graphic xlink:href="42003_2021_2622_Article_IEq6.gif"/></alternatives></inline-formula>) after every activation. The weights can then be compared and used as an important measure. Since batch normalization is a batch-wise approximation, the learned weights can be multiplied with the standard deviation of the activations for a more accurate estimate. For Manhattan plots, the normalized, absolute weights between the gene layer and the output are used.</p>
      <p id="Par37">In larger networks, the relative importance is calculated by multiplying the weights for each possible path from the end node to the input SNPs. At each input, we obtain then a value denoting its contribution. These values are then aggregated (summed) according to the groups of the subsequent layers to get the importance estimate for each node in the network.</p>
      <p id="Par38">It is important to note that in this work (relative) importance is more similar to effect size or odds ratio than to statistical significance. The weights represent the direction and effect a gene or pathway has on the outcome of the network.</p>
    </sec>
    <sec id="Sec14">
      <title>Implementation</title>
      <p id="Par39">Technically, the computational performance of the implemented Keras/Tensorfow<sup><xref ref-type="bibr" rid="CR42">42</xref>,<xref ref-type="bibr" rid="CR43">43</xref></sup> layer should be on par or an improvement over similar layers. It is implemented using sparse matrix multiplication, making it faster than the slice-wise locallyconnected1D layer and more memory efficient than dense matrix multiplication. The layer is friendly to use, with only one extra input compared to a normal dense layer. This extra input, the sparse connectivity matrix, is made with prior knowledge and describes how neurons are connected between layers.</p>
      <p id="Par40">The networks behave similar to normal fully connected artificial neural networks but are pruned by removing irrelevant connections:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y={{{{{{\mathrm{Activation}}}}}}}\left(\mathop{\sum }_{i=0}^{n}{{x}_{i}w}_{i}\,+B\right)$$\end{document}</tex-math><mml:math id="M18"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Activation</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>+</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="42003_2021_2622_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par41">With <italic>w</italic> as a sparse matrix with learnable weights, initialized with a sparse connectivity matrix defining connections.</p>
      <p id="Par42">The GenNet framework is available as a command line tool and includes functionalities to convert data, to create, train, and evaluate and interpret neural networks.</p>
    </sec>
    <sec id="Sec15">
      <title>Baseline</title>
      <p id="Par43">As a baseline method, LASSO logistic regression was implemented in Tensorflow by using a dense layer of a single neuron with a sigmoid activation function and L1 regularization on weights. Polygenic Risk Scores (PRS) were not used since we used only variants from the exome.</p>
    </sec>
    <sec id="Sec16">
      <title>Upper bound of classification accuracy for predicting phenotypes</title>
      <p id="Par44">In contrast to the application of deep learning for image analysis, where the performance is not limited, in application for genetic analysis, we are limited by the information in DNA relevant for trait or disease, i.e., by the heritability. Therefore, we cannot expect the performance of the neural network above a certain value.</p>
      <p id="Par45">Population characteristics can be used to calculate the upper bound of performance for a classifier for any trait. This can be done by creating a confusion matrix. The accuracy between true and false positives for a perfect classifier, based solely on genetic inputs, is given by the concordance rate between monozygotic twins. It is impossible to predict better based solely on genetic code than the rate a trait occurs in people with virtually the same genetic code. The chance of misclassifying a control should be better than the prevalence, which is often close to zero for most diseases. Creating a confusion matrix can give insights in the upper bound for accuracy, sensitivity, and specificity in the dataset. An example for schizophrenia in our dataset can be found in Supplementary Method 6.</p>
    </sec>
    <sec id="Sec17">
      <title>Reporting summary</title>
      <p id="Par46">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="42003_2021_2622_MOESM1_ESM.pdf">
            <caption>
              <p>Transparent Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="42003_2021_2622_MOESM2_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="42003_2021_2622_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic>Communications Biology</italic> thanks the anonymous reviewers for their contribution to the peer review of this work. Primary Handling Editors: Eirini Marouli and Luke R. Grinham. Peer reviewer reports are available.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors jointly supervised this work: Wiro J. Niessen and Gennady V. Roshchupkin.</p>
    </fn>
    <fn>
      <p>
        <bold>Change history</bold>
      </p>
      <p>10/7/2021</p>
      <p id="Par1">In the original version of this article, the given and family names of M. Arfan Ikram were incorrectly structured. The name was displayed correctly in all versions at the time of publication. The original article has been corrected.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s42003-021-02622-z.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Marloes Arts (University of Copenhagen) for her advice. This work was funded by the Dutch Technology Foundation (STW) through the 2005 Simon Steven Meester grant 2015 to W.J. Niessen. This research has been conducted using the UK Biobank Resource under Application Number 23509. This work was carried out on the Dutch national e-infrastructure with the support of SURF Cooperative (application number 17610). The Rotterdam study is supported by the Netherlands Organization for Scientific Research (NWO, 91203014, 175.010.2005.011, 91103012).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>A.H. and G.R. conceived and designed the method. A.H. performed experiments and implemented the method. G.R. and W.N. supervised the work. M.A.I., C.K., H.A., M.K. and S.A.K. provided or gave access to data. A.H., G.R., W.N., M.K., M.A.I. and S.A.K, wrote, revised, and approved the paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Code to run and generate data for the simulations are publicly available on GitHub. The genetic and phenotypic UK Biobank data are available upon application to the UK Biobank (<ext-link ext-link-type="uri" xlink:href="https://www.ukbiobank.ac.uk/">https://www.ukbiobank.ac.uk/</ext-link>). Access to the Sweden-Schizophrenia Exome Sequencing study can be requested on dbGaP (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/gap/">https://www.ncbi.nlm.nih.gov/gap/</ext-link>) (dbGaP phs000473.v2.p2). All trained networks are available on <ext-link ext-link-type="uri" xlink:href="https://github.com/ArnovanHilten/GenNet_Zoo/">https://github.com/ArnovanHilten/GenNet_Zoo/</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>GenNet is an open-source framework usable from command line. GenNet and its tutorials, including how to build new layers and networks from prior knowledge, can be found on: <ext-link ext-link-type="uri" xlink:href="https://github.com/arnovanhilten/GenNet/">https://github.com/arnovanhilten/GenNet/</ext-link> and Zenodo<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par47">W.N. is co-founder and shareholder of Quantib BV. Other authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yengo</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Meta-analysis of genome-wide association studies for height and body mass index in ~700,000 individuals of European ancestry</article-title>
        <source>Hum. Mol. Genet.</source>
        <year>2018</year>
        <volume>27</volume>
        <fpage>3641</fpage>
        <lpage>3649</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddy271</pub-id>
        <pub-id pub-id-type="pmid">30124842</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Leeuw</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Mooij</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Heskes</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Posthuma</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>MAGMA: generalized gene-set analysis of GWAS data</article-title>
        <source>PLoS Comput Biol.</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>e1004219</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004219</pub-id>
        <pub-id pub-id-type="pmid">25885710</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holmans</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene ontology analysis of GWA study data sets provides insights into the biology of bipolar disorder</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>2009</year>
        <volume>85</volume>
        <fpage>13</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2009.05.011</pub-id>
        <pub-id pub-id-type="pmid">19539887</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>O’Dushlaine</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Purcell</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>INRICH: interval-based enrichment analysis for genome-wide association studies</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1797</fpage>
        <lpage>1799</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts191</pub-id>
        <pub-id pub-id-type="pmid">22513993</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Tatusova</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Maglott</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>NCBI reference sequences (RefSeq): a curated non-redundant sequence database of genomes, transcripts, and proteins</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>D61</fpage>
        <lpage>D65</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkl842</pub-id>
        <pub-id pub-id-type="pmid">17130148</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goto</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>KEGG: Kyoto encyclopedia of genes and genomes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2000</year>
        <volume>28</volume>
        <fpage>27</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.27</pub-id>
        <pub-id pub-id-type="pmid">10592173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Croft</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Reactome pathway knowledgebase</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>D472</fpage>
        <lpage>D477</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1102</pub-id>
        <pub-id pub-id-type="pmid">24243840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lonsdale</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The genotype-tissue expression (GTEx) project</article-title>
        <source>Nat. Genet.</source>
        <year>2013</year>
        <volume>45</volume>
        <fpage>580</fpage>
        <pub-id pub-id-type="doi">10.1038/ng.2653</pub-id>
        <pub-id pub-id-type="pmid">23715323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gallagher</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Chen-Plotkin</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>The post-GWAS era: from association to function</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>2018</year>
        <volume>102</volume>
        <fpage>717</fpage>
        <lpage>730</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2018.04.002</pub-id>
        <pub-id pub-id-type="pmid">29727686</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hari Dass</surname>
            <given-names>SA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A biologically-informed polygenic score identifies endophenotypes and clinical conditions associated with the insulin receptor function on specific brain regions</article-title>
        <source>EBioMedicine</source>
        <year>2019</year>
        <volume>42</volume>
        <fpage>188</fpage>
        <lpage>202</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ebiom.2019.03.051</pub-id>
        <pub-id pub-id-type="pmid">30922963</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amariuta</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improving the trans-ancestry portability of polygenic risk scores by prioritizing variants in predicted cell-type-specific regulatory elements</article-title>
        <source>Nat. Genet.</source>
        <year>2020</year>
        <volume>52</volume>
        <fpage>1346</fpage>
        <lpage>1354</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-020-00740-8</pub-id>
        <pub-id pub-id-type="pmid">33257898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burcu</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Darst et al. Pathway-specific polygenic risk scores as predictors of β- amyloid deposition and cognitive function in a sample at increased risk for Alzheimer’s disease</article-title>
        <source>J. Alzheimers Dis.</source>
        <year>2017</year>
        <volume>176</volume>
        <fpage>139</fpage>
        <lpage>148</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Litjens</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A survey on deep learning in medical image analysis</article-title>
        <source>Med. Image Anal.</source>
        <year>2017</year>
        <volume>42</volume>
        <fpage>60</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.1016/j.media.2017.07.005</pub-id>
        <pub-id pub-id-type="pmid">28778026</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Young</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hazarika</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Poria</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cambria</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Recent trends in deep learning based natural language processing</article-title>
        <source>IEEE Comput. Intell. Mag.</source>
        <year>2018</year>
        <volume>13</volume>
        <fpage>55</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1109/MCI.2018.2840738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Veale</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Slave to the algorithm: why a right to an explanation is probably not the remedy you are looking for</article-title>
        <source>Duke L. Tech. Rev.</source>
        <year>2017</year>
        <volume>16</volume>
        <fpage>18</fpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Došilović, F. K., Brčić, M. &amp; Hlupić, N. Explainable artificial intelligence: a survey. In <italic>2018 41st International Convention on Information and Communication Technology, Electronics and Microelectronics (MIPRO)</italic> 210–215 (IEEE, 2018).</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Badré</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Muchero</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Reynolds</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Deep neural network improves the estimation of polygenic risk scores for breast cancer</article-title>
        <source>J. Hum. Genet.</source>
        <year>2021</year>
        <volume>66</volume>
        <fpage>359</fpage>
        <lpage>369</lpage>
        <pub-id pub-id-type="doi">10.1038/s10038-020-00832-7</pub-id>
        <pub-id pub-id-type="pmid">33009504</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bycroft</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UK Biobank resource with deep phenotyping and genomic data</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>562</volume>
        <fpage>203</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0579-z</pub-id>
        <pub-id pub-id-type="pmid">30305743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Ikram, M. A. et al. Objectives, design, and main findings until 2020 from the Rotterdam Study. <italic>Eur. J. Epidemiol</italic>. <bold>35</bold>, 483−517 (2020).</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Purcell</surname>
            <given-names>SM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A polygenic burden of rare disruptive mutations in schizophrenia</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>506</volume>
        <fpage>185</fpage>
        <lpage>190</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12975</pub-id>
        <pub-id pub-id-type="pmid">24463508</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ripke</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Biological insights from 108 schizophrenia-associated genetic loci</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>511</volume>
        <fpage>421</fpage>
        <lpage>427</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13595</pub-id>
        <pub-id pub-id-type="pmid">25056061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stahl</surname>
            <given-names>EA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide association study identifies 30 loci associated with bipolar disorder</article-title>
        <source>Nat. Genet.</source>
        <year>2019</year>
        <volume>51</volume>
        <fpage>793</fpage>
        <lpage>803</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-019-0397-8</pub-id>
        <pub-id pub-id-type="pmid">31043756</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Visser</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kayser</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Palstra</surname>
            <given-names>R-J</given-names>
          </name>
        </person-group>
        <article-title>HERC2 rs12913832 modulates human pigmentation by attenuating chromatin-loop formation between a long-range enhancer and the OCA2 promoter</article-title>
        <source>Genome Res.</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>446</fpage>
        <lpage>455</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.128652.111</pub-id>
        <pub-id pub-id-type="pmid">22234890</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Han, J. et al. A genome-wide association study identifies novel alleles associated with hair color and skin pigmentation. <italic>PLoS Genet</italic>. <bold>4</bold>, e1000074 (2008).</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hysi</surname>
            <given-names>PG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide association meta-analysis of individuals of European ancestry identifies new loci explaining a substantial fraction of hair color variation and heritability</article-title>
        <source>Nat. Genet.</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>652</fpage>
        <lpage>656</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0100-5</pub-id>
        <pub-id pub-id-type="pmid">29662168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Eye color and the prediction of complex phenotypes from genotypes</article-title>
        <source>Curr. Biol.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>R192</fpage>
        <lpage>R193</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2009.01.027</pub-id>
        <pub-id pub-id-type="pmid">19278628</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finucane</surname>
            <given-names>HK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types</article-title>
        <source>Nat. Genet.</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>621</fpage>
        <lpage>629</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0081-4</pub-id>
        <pub-id pub-id-type="pmid">29632380</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Candille, S. I. et al. Genome-wide association studies of quantitatively measured skin, hair, and eye pigmentation in four European populations. <italic>PLoS One</italic><bold>7</bold>, e48294 (2012).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bradshaw</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Porteous</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>DISC1-binding proteins in neural development, signalling and schizophrenia</article-title>
        <source>Neuropharmacology</source>
        <year>2012</year>
        <volume>62</volume>
        <fpage>1230</fpage>
        <lpage>1241</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuropharm.2010.12.027</pub-id>
        <pub-id pub-id-type="pmid">21195721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fatemi</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Folsom</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <article-title>The neurodevelopmental hypothesis of schizophrenia, revisited</article-title>
        <source>Schizophr. Bull.</source>
        <year>2009</year>
        <volume>35</volume>
        <fpage>528</fpage>
        <lpage>548</lpage>
        <pub-id pub-id-type="doi">10.1093/schbul/sbn187</pub-id>
        <pub-id pub-id-type="pmid">19223657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Encyclopedia of DNA elements (ENCODE): data portal update</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D794</fpage>
        <lpage>D801</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1081</pub-id>
        <pub-id pub-id-type="pmid">29126249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Li, W. et al. Privacy-preserving federated brain tumour segmentation. <italic>International Workshop on Machine Learning in Medical Imaging</italic> 133–141 (2019).</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roshchupkin</surname>
            <given-names>GV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HASE: Framework for efficient high-dimensional association analyses</article-title>
        <source>Sci. Rep.</source>
        <year>2016</year>
        <volume>6</volume>
        <fpage>36076</fpage>
        <pub-id pub-id-type="doi">10.1038/srep36076</pub-id>
        <pub-id pub-id-type="pmid">27782180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Hout</surname>
            <given-names>CV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exome sequencing and characterization of 49,960 individuals in the UK Biobank</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>586</volume>
        <fpage>749</fpage>
        <lpage>756</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2853-0</pub-id>
        <pub-id pub-id-type="pmid">33087929</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kayser</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Three genome-wide association studies and a linkage analysis identify HERC2 as a human iris color gene</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>2008</year>
        <volume>82</volume>
        <fpage>411</fpage>
        <lpage>423</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2007.10.003</pub-id>
        <pub-id pub-id-type="pmid">18252221</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hakonarson</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>ANNOVAR: functional annotation of genetic variants from high-throughput sequencing data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>e164</fpage>
        <lpage>e164</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq603</pub-id>
        <pub-id pub-id-type="pmid">20601685</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subhash</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kanduri</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>GeneSCF: a real-time based functional enrichment tool with support for multiple organisms</article-title>
        <source>BMC Bioinform.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>365</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-1250-z</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Michael</surname>
            <given-names>KY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Visible machine learning for biomedicine</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>173</volume>
        <fpage>1562</fpage>
        <lpage>1565</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.05.056</pub-id>
        <pub-id pub-id-type="pmid">29906441</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Using deep learning to model the hierarchical structure and function of a cell</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>290</fpage>
        <lpage>298</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4627</pub-id>
        <pub-id pub-id-type="pmid">29505029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gazestani</surname>
            <given-names>VH</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>NE</given-names>
          </name>
        </person-group>
        <article-title>From genotype to phenotype: augmenting deep learning with networks and systems biology</article-title>
        <source>Curr. Opin. Syst. Biol.</source>
        <year>2019</year>
        <volume>15</volume>
        <fpage>68</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1016/j.coisb.2019.04.001</pub-id>
        <pub-id pub-id-type="pmid">31777764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Wang, D. et al. Comprehensive functional genomic resource and integrative model for the human brain. <italic>Science</italic><bold>362</bold>, eaat8464 (2018).</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Chollet, F. Keras: deep learning library for theano and tensorflow. <ext-link ext-link-type="uri" xlink:href="https://keras.io/k">https://keras.io/k</ext-link> (2015).</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Abadi, M. et al. Tensorflow: a system for large-scale machine learning. In <italic>12th {USENIX} Symposium on Operating Systems Design and Implementation ({OSDI} 16)</italic> 265–2833 ({USENIX} Association, Savannah, 2016).</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">van Hilten, A. et al. ArnovanHilten/GenNet: Release GenNet 1.4. 10.5281/ZENODO.5151527 (2021).</mixed-citation>
    </ref>
  </ref-list>
</back>
