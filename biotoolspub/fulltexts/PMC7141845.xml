<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7141845</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz859</article-id>
    <article-id pub-id-type="publisher-id">btz859</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>KofamKOALA: KEGG Ortholog assignment based on profile HMM and adaptive score threshold</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Aramaki</surname>
          <given-names>Takuya</given-names>
        </name>
        <xref ref-type="aff" rid="btz859-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Blanc-Mathieu</surname>
          <given-names>Romain</given-names>
        </name>
        <xref ref-type="aff" rid="btz859-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Endo</surname>
          <given-names>Hisashi</given-names>
        </name>
        <xref ref-type="aff" rid="btz859-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ohkubo</surname>
          <given-names>Koichi</given-names>
        </name>
        <xref ref-type="aff" rid="btz859-aff1">1</xref>
        <xref ref-type="aff" rid="btz859-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kanehisa</surname>
          <given-names>Minoru</given-names>
        </name>
        <xref ref-type="aff" rid="btz859-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Goto</surname>
          <given-names>Susumu</given-names>
        </name>
        <xref ref-type="aff" rid="btz859-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ogata</surname>
          <given-names>Hiroyuki</given-names>
        </name>
        <xref ref-type="aff" rid="btz859-aff1">1</xref>
        <xref ref-type="corresp" rid="btz859-cor1"/>
        <!--<email>ogata@kuicr.kyoto-u.ac.jp</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btz859-aff1"><label>1</label><institution>Bioinformatics Center, Institute for Chemical Research, Kyoto University</institution>, Gokasho, Uji, Kyoto 611-0011</aff>
    <aff id="btz859-aff2"><label>2</label><institution>Hewlett-Packard Japan Ltd.</institution>, Koto-ku, Tokyo 136-8711</aff>
    <aff id="btz859-aff3"><label>3</label><institution>Database Center for Life Science, Research Organization of Information and Systems</institution>, Kashiwa, Chiba 277-0871, <country country="JP">Japan</country></aff>
    <author-notes>
      <corresp id="btz859-cor1">To whom correspondence should be addressed. E-mail: <email>ogata@kuicr.kyoto-u.ac.jp</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-11-19">
      <day>19</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>7</issue>
    <fpage>2251</fpage>
    <lpage>2252</lpage>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>02</day>
        <month>10</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>11</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz859.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>KofamKOALA is a web server to assign KEGG Orthologs (KOs) to protein sequences by homology search against a database of profile hidden Markov models (KOfam) with pre-computed adaptive score thresholds. KofamKOALA is faster than existing KO assignment tools with its accuracy being comparable to the best performing tools. Function annotation by KofamKOALA helps linking genes to KEGG resources such as the KEGG pathway maps and facilitates molecular network reconstruction.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>KofamKOALA, KofamScan and KOfam are freely available from GenomeNet (<ext-link ext-link-type="uri" xlink:href="https://www.genome.jp/tools/kofamkoala/">https://www.genome.jp/tools/kofamkoala/</ext-link>).</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>JSPS/MEXT/KAKENHI</institution>
          </institution-wrap>
        </funding-source>
        <award-id>26430184</award-id>
        <award-id>18H02279</award-id>
        <award-id>16H06429</award-id>
        <award-id>16K21723</award-id>
        <award-id>16H06437</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Collaborative Research Program of the Institute for Chemical Research, Kyoto University </institution>
          </institution-wrap>
        </funding-source>
        <award-id>2018-30</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Automatic gene function annotation is an important first step to interpret genomic data. Kyoto Encyclopedia of Genes and Genomes (KEGG) is a widely used reference knowledge base, which helps investigate genomic functions by linking genes to biological knowledge such as metabolic pathways and molecular networks (<xref rid="btz859-B4" ref-type="bibr">Kanehisa and Goto, 2000</xref>). In KEGG, the KEGG Orthology (KO) database—a manually curated large collection of protein families (i.e. KO families)—serves as a baseline reference to link genes with other KEGG resources such as metabolic maps through <italic>K</italic> number identifiers. Currently, KOs are assigned to 12 934 525 (48%) protein sequences in the KEGG GENES database (27 173 868 proteins). Three existing tools, BlastKOALA, GhostKOALA (<xref rid="btz859-B5" ref-type="bibr">Kanehisa <italic>et al.</italic>, 2016</xref>) and KAAS (<xref rid="btz859-B7" ref-type="bibr">Moriya <italic>et al.</italic>, 2007</xref>), are available to assign KOs to protein sequences. These tools use homology search software such as BLAST (<xref rid="btz859-B1" ref-type="bibr">Altschul <italic>et al.</italic>, 1997</xref>) and GHOSTX (<xref rid="btz859-B8" ref-type="bibr">Suzuki <italic>et al.</italic>, 2014</xref>) to search amino acid sequences against GENES. To reduce the lengthy computational times required for multiple pairwise sequence comparisons, these tools use selected representative sequences from GENES to build their target database. In this study, we propose to employ profile hidden Markov model (pHMM) to compress the database and to define adaptive thresholds for similarity scores, which can be used for reliable KO assignments.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>For each set of protein sequences in GENES annotated with a given KO, we generate a pHMM as follows. First, sequence redundancy in the sequence set is reduced by CD-HIT (<xref rid="btz859-B3" ref-type="bibr">Fu <italic>et al.</italic>, 2012</xref>) with 100% sequence identity clustering cutoff. Next, MAFFT (<xref rid="btz859-B6" ref-type="bibr">Katoh <italic>et al.</italic>, 2005</xref>) and HMMER/hmmbuild (<xref rid="btz859-B2" ref-type="bibr">Eddy, 2008</xref>) are used to align sequences and to generate a pHMM, respectively.</p>
    <p>A family-specific adaptive score threshold is computed for each KO family as follows. For a given KO family, non-redundant sequences belonging to the family are randomly divided into three groups. One of the groups is used as the positive training dataset, while the sequences in the remaining two groups are used to generate a pHMM. Sequences belonging to the remaining KO families serve as the negative training dataset for the KO under consideration. Sequence similarity scores (bit scores) between sequences in the positive/negative training datasets and the pHMM are computed using HMMER/hmmsearch. Based on the distributions of two sets of bit scores for the sequences in the positive and negative datasets, we determine a threshold score, <italic>T</italic>, which maximizes the <italic>F</italic>-measure (<xref ref-type="supplementary-material" rid="sup1">Supplementary Data</xref>). This procedure is repeated three times by replacing the positive training dataset among the three groups. Finally, the adaptive score threshold for the KO family is defined as the average of <italic>T</italic> <inline-formula id="IE1"><mml:math id="IM1"><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>. <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is used as a criterion to assign the KO family to new sequences.</p>
    <p>The database of HMMs with the adaptive score thresholds was named KOfam. When the present study was performed using KEGG release 88.2, KOfam contained 20 654 pHMMs. We developed KofamScan software and employed it in KofamKOALA webserver to annotate genes using KOfam and to link them with other KEGG resources through <italic>K</italic> numbers for versatile function investigation.</p>
  </sec>
  <sec>
    <title>3 Assessment and discussions</title>
    <p>To compare the performance of KofamScan with BlastKOALA, GhostKOALA and KAAS, we used 40 genomes (20 eukaryotes and 20 prokaryotes; <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>) randomly selected from 6030 genomes recorded in GENES as test queries. This test set contains 383 202 sequences (143 662 sequences with KOs) corresponding to 16 166 distinct KOs. From GENES, we removed all the genomes belonging to the genera of the selected 40 test query genomes. Then, using the remaining GENES sequences with KO annotations, we generated a test KOfam database for this assessment. As for BlastKOALA, GhostKOALA and KAAS, we used the default target databases used in their respective webservers after removing genomes from the genera that were represented by the test queries.</p>
    <p>The KOfam database created for this assessment contained 20 394 pHMMs, of which 9414 were represented by prokaryotic sequences. For the 40 genomes constituting our test set, the performance (<italic>F</italic>-measure) was comparable among KofamScan (0.866), BlastKOALA (0.889) and GhostKOALA (0.862), while KAAS showed a lower <italic>F</italic>-measure (0.810) (<xref rid="btz859-T1" ref-type="table">Table 1</xref>). To perform another test using only 20 prokaryotic genomes as test queries, we reduced the target databases either by excluding pHMMs composed exclusively of eukaryotic sequences (for KofamScan) or by using the target database for prokaryotes (for BlastKOALA, GhostKOALA and KAAS). Again, the performance of KofamScan (<italic>F</italic> = 0.875) was comparable to BlastKOALA (0.846) and GhostKOALA (0.886), while KAAS showed the lowest <italic>F</italic>-measure (0.786).
</p>
    <table-wrap id="btz859-T1" orientation="portrait" position="float">
      <label>Table 1.</label>
      <caption>
        <p>Comparison of the performance of KofamScan with other tools</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1">KofamScan</th>
            <th rowspan="1" colspan="1">BlastKOALA</th>
            <th rowspan="1" colspan="1">GhostKOALA</th>
            <th rowspan="1" colspan="1">KAAS</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td colspan="5" rowspan="1">Entire database (40 genomes)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> Precision</td>
            <td rowspan="1" colspan="1">0.844</td>
            <td rowspan="1" colspan="1">0.835</td>
            <td rowspan="1" colspan="1">0.787</td>
            <td rowspan="1" colspan="1">0.895</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> Recall</td>
            <td rowspan="1" colspan="1">0.888</td>
            <td rowspan="1" colspan="1">0.950</td>
            <td rowspan="1" colspan="1">0.952</td>
            <td rowspan="1" colspan="1">0.739</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> <italic>F</italic></td>
            <td rowspan="1" colspan="1">0.866</td>
            <td rowspan="1" colspan="1">0.889</td>
            <td rowspan="1" colspan="1">0.862</td>
            <td rowspan="1" colspan="1">0.810</td>
          </tr>
          <tr>
            <td colspan="5" rowspan="1">Prokaryote database (20 genomes)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> Precision</td>
            <td rowspan="1" colspan="1">0.906</td>
            <td rowspan="1" colspan="1">0.906</td>
            <td rowspan="1" colspan="1">0.907</td>
            <td rowspan="1" colspan="1">0.881</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> Recall</td>
            <td rowspan="1" colspan="1">0.846</td>
            <td rowspan="1" colspan="1">0.793</td>
            <td rowspan="1" colspan="1">0.867</td>
            <td rowspan="1" colspan="1">0.709</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> <italic>F</italic></td>
            <td rowspan="1" colspan="1">0.875</td>
            <td rowspan="1" colspan="1">0.846</td>
            <td rowspan="1" colspan="1">0.886</td>
            <td rowspan="1" colspan="1">0.786</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>Regarding CPU time, KofamScan was 69, 2.1 and 1.1 times faster than BlastKOALA, KAAS and GhostKOALA, respectively, when they were tested for the annotation of 40 genomes (<xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S2 and S3</xref>). CPU time for this calculation was 2 h26 m18 s for KofamScan, while it was over 168 h for BlastKOALA. For the test with 20 prokaryote genomes, KofamScan was 83, 1.9 and 1.8 times faster than BlastKOALA, KAAS and GhostKOALA, respectively. Required CPU time was 11 m59 s for KofamScan, while it was over 16 h for BlastKOALA. The latter result indicates that KofamScan can benefits more from the reduction of the target database compared to the three other tools while it is among the tools showing the highest <italic>F</italic>-measures.</p>
    <p>We developed a database of pHMMs based on the KO and GENES databases. The adaptive score thresholds are pre-computed for individual KO families, and can be used to assign KOs (<italic>K</italic> numbers) to sequences using KofamScan and KofamKOALA. Sequence matches with scores above the thresholds are considered more reliable than other matches and thus highlighted with ‘*’ marks in the output of these tools. KofamScan users are able to customize KOfam by choosing a subset of KOs so that they can focus on the annotation of specific class of proteins while reducing computational time. KofamKOALA webserver has additional functions to automatically send the search results to KEGG Mapper for reconstruction of pathways (PATHWAY), pathway modules (MODULE) and hierarchical function classifications (BRITE).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz859_Supplementary_Data</label>
      <media xlink:href="btz859_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>Computation time was provided by the SuperComputer System, Institute for Chemical Research, Kyoto University.</p>
    <sec>
      <title>Funding</title>
      <p>This work has been supported by the JSPS/MEXT/KAKENHI (Nos. 26430184, 18H02279, 16H06429, 16K21723, 16H06437) and the Collaborative Research Program of the Institute for Chemical Research, Kyoto University (No. 2018-30).</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz859-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>S.F.</given-names></name></person-group><etal>et al</etal> (<year>1997</year>) 
<article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res</source>., <volume>25</volume>, <fpage>3389</fpage>–<lpage>3402</lpage>.<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="btz859-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Eddy</surname><given-names>S.R.</given-names></name></person-group> (<year>2008</year>) 
<article-title>A probabilistic model of local sequence alignment that simplifies statistical significance estimation</article-title>. <source>PLoS Comput. Biol</source>., <volume>4</volume>, <fpage>e1000069</fpage>.<pub-id pub-id-type="pmid">18516236</pub-id></mixed-citation>
    </ref>
    <ref id="btz859-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fu</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>3150</fpage>–<lpage>3152</lpage>.<pub-id pub-id-type="pmid">23060610</pub-id></mixed-citation>
    </ref>
    <ref id="btz859-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kanehisa</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Goto</surname><given-names>S.</given-names></name></person-group> (<year>2000</year>) 
<article-title>KEGG: Kyoto encyclopedia of genes and genomes</article-title>. <source>Nucleic Acids Res</source>., <volume>28</volume>, <fpage>27</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">10592173</pub-id></mixed-citation>
    </ref>
    <ref id="btz859-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kanehisa</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>BlastKOALA and GhostKOALA: KEGG tools for functional characterization of genome and metagenome sequences</article-title>. <source>J. Mol. Biol</source>., <volume>428</volume>, <fpage>726</fpage>–<lpage>731</lpage>.<pub-id pub-id-type="pmid">26585406</pub-id></mixed-citation>
    </ref>
    <ref id="btz859-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Katoh</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>MAFFT version 5: improvement in accuracy of multiple sequence alignment</article-title>. <source>Nucleic Acids Res</source>., <volume>33</volume>, <fpage>511</fpage>–<lpage>518</lpage>.<pub-id pub-id-type="pmid">15661851</pub-id></mixed-citation>
    </ref>
    <ref id="btz859-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Moriya</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>KAAS: an automatic genome annotation and pathway reconstruction server</article-title>. <source>Nucleic Acids Res</source>., <volume>35</volume>, <fpage>W182</fpage>–<lpage>W185</lpage>.<pub-id pub-id-type="pmid">17526522</pub-id></mixed-citation>
    </ref>
    <ref id="btz859-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Suzuki</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>GHOSTX: an improved sequence homology search algorithm using a query suffix array and a database suffix array</article-title>. <source>PLoS One</source>, <volume>9</volume>, <fpage>e103833</fpage>.<pub-id pub-id-type="pmid">25099887</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
