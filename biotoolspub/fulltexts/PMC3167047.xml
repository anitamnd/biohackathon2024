<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3167047</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btr421</article-id>
    <article-id pub-id-type="publisher-id">btr421</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RNAG: a new Gibbs sampler for predicting RNA secondary structure for unaligned sequences</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wei</surname>
          <given-names>Donglai</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Alpert</surname>
          <given-names>Lauren V.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lawrence</surname>
          <given-names>Charles E.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Department of Mathematics and <sup>2</sup>Division of Applied Mathematics, Center for Computational Molecular Biology, Brown University, Providence, RI 02912, USA</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Ivo Hofacker</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>9</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>7</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>7</month>
      <year>2011</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>27</volume>
    <issue>18</issue>
    <fpage>2486</fpage>
    <lpage>2493</lpage>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>1</month>
        <year>2011</year>
      </date>
      <date date-type="rev-recd">
        <day>3</day>
        <month>6</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>7</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2011. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> RNA secondary structure plays an important role in the function of many RNAs, and structural features are often key to their interaction with other cellular components. Thus, there has been considerable interest in the prediction of secondary structures for RNA families. In this article, we present a new global structural alignment algorithm, RNAG, to predict consensus secondary structures for unaligned sequences. It uses a blocked Gibbs sampling algorithm, which has a theoretical advantage in convergence time. This algorithm iteratively samples from the conditional probability distributions P(Structure | Alignment) and P(Alignment | Structure). Not surprisingly, there is considerable uncertainly in the high-dimensional space of this difficult problem, which has so far received limited attention in this field. We show how the samples drawn from this algorithm can be used to more fully characterize the posterior space and to assess the uncertainty of predictions.</p>
      <p><bold>Results:</bold> Our analysis of three publically available datasets showed a substantial improvement in RNA structure prediction by RNAG over extant prediction methods. Additionally, our analysis of 17 RNA families showed that the RNAG sampled structures were generally compact around their ensemble centroids, and at least 11 families had at least two well-separated clusters of predicted structures. In general, the distance between a reference structure and our predicted structure was large relative to the variation among structures within an ensemble.</p>
      <p><bold>Availability:</bold> The Perl implementation of the RNAG algorithm and the data necessary to reproduce the results described in <xref ref-type="sec" rid="SEC3.1">Sections 3.1</xref> and <xref ref-type="sec" rid="SEC3.2">3.2</xref> are available at <ext-link ext-link-type="uri" xlink:href="http://ccmbweb.ccv.brown.edu/rnag.html">http://ccmbweb.ccv.brown.edu/rnag.html</ext-link></p>
      <p>
        <bold>Contact:</bold>
        <ext-link ext-link-type="uri" xlink:href="charles_lawrence@brown.edu">charles_lawrence@brown.edu</ext-link>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr421/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>RNA secondary structure plays a key role in the function of many types of RNA, including structural RNAs, non-coding RNAs (ncRNA) and regulatory motifs in mRNAs (e.g. riboswitches). Accordingly, structural features of RNA molecules are often characterized by evolutionarily conserved secondary structures that are critical to their functions. Furthermore, there are often multiple occurrences of these structural elements within one species (e.g. tRNA). Given the recent recognition of many important additional roles that RNAs play in cellular functions, predicting the common structural features of a set of RNA sequences is more important than ever.</p>
    <sec id="SEC1.1">
      <title>1.1 Structure prediction for a single sequence</title>
      <p>Three main classes of probabilistic models of P(S|Q) for the prediction of the secondary structure (S) for a single sequence (Q), are currently available. The most popular is a thermodynamic model that supposes that RNA structures may be described by Boltzmann statistics [e.g. Mfold (<xref ref-type="bibr" rid="B45">Zuker <italic>et al.</italic>, 1981</xref>)]. The second model incorporates phylogenetic information into folding [e.g. PETfold (<xref ref-type="bibr" rid="B35">Seemann <italic>et al.</italic>, 2008</xref>)]. The third method abandons the biophysical model in favor of machine learning algorithms that empirically infer structure based on probabilistic graphical models [e.g. CONTRAfold (<xref ref-type="bibr" rid="B9">Do <italic>et al.</italic>, 2006</xref>)] or non-parametric methods [e.g. KNETfold (<xref ref-type="bibr" rid="B1">Bindewald <italic>et al.</italic>, 2006</xref>)].</p>
      <p>Algorithms that use a thermodynamic model have gained wide acceptance, particularly the early algorithms like Mfold (<xref ref-type="bibr" rid="B45">Zuker <italic>et al.</italic>, 1981</xref>) and RNAfold (<xref ref-type="bibr" rid="B19">Hofacker <italic>et al.</italic>, 1994</xref>) that use dynamic programming to find the most probable structure (MPS), i.e. the ‘minimum free energy structure’ (MFE). However, the Boltzmann weighted ensemble of structures, represented as a large set of binary matrices, defines a high-dimensional discrete space in which even the MPS is likely to have low probability. Furthermore, the MPS is often not representative of the Boltzmann weighted ensemble of structures. In particular, there is no fundamental reason for the MPS to even be included in the high-weight region of the Boltzmann space (<xref ref-type="bibr" rid="B3">Carvalho <italic>et al.</italic>, 2008</xref>). Thus, alternative estimators that gain information from the full ensemble of structures have emerged, including centroid estimators (<xref ref-type="bibr" rid="B3">Carvalho <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B6">Ding <italic>et al.</italic>, 2005</xref>) and the related maximum expected accuracy (MEA) estimator (<xref ref-type="bibr" rid="B9">Do <italic>et al.</italic>, 2006</xref>). A generalization of the centroid estimator, the γ -centroid (<xref ref-type="bibr" rid="B17">Hamada <italic>et al.</italic>, 2009</xref>, <xref ref-type="bibr" rid="B18">2011</xref>), permits the balancing of false positive and false negative errors based on the tunable parameter γ. Moreover, the focus on finding the MPS without uncertainty analysis implicitly assumes that an RNA molecule exists only in one single stable state, which is not the case for many RNAs, and almost certainly is not the case for mRNAs. To address these issues, sampling algorithms like Sfold (<xref ref-type="bibr" rid="B6">Ding <italic>et al.</italic>, 2005</xref>) provide a method to characterize the full ensemble of structures (<xref ref-type="bibr" rid="B28">Mathews, 2006</xref>), and Bayesian confidence limits, a.k.a. credibility limits, provide a method to delineate the uncertainty of an estimate (<xref ref-type="bibr" rid="B32">Newberg <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B41">Webb <italic>et al.</italic>, 2008</xref>).</p>
    </sec>
    <sec id="SEC1.2">
      <title>1.2 Structure prediction for multiple unaligned sequences</title>
      <p>With multiple sequences, the problem becomes harder since the extra unknown alignment (A) of the sequences enters and the model becomes P(S,A|Q). Algorithms that address the two major components of this problem, i.e. the prediction of common structure given an alignment and predicting an alignment given a common structure, have been developed. The first of these assumes an alignment of sequences is given, and seeks to predict the structure common to the aligned sequences, i.e. draw inference from P(S|A,Q). Several methods have been developed for this problem. Mutual information (<xref ref-type="bibr" rid="B16">Gutell <italic>et al.</italic>, 1992</xref>) and stochastic context-free grammars (SCFG) (<xref ref-type="bibr" rid="B24">Knudsen <italic>et al.</italic>, 1999</xref>; <xref ref-type="bibr" rid="B33">Sakakibara <italic>et al.</italic>, 1994</xref>) have been effectively used to detect and model complementary covariation that is indicative of conserved base pairing interactions. Maximum weighted matching (MWM), a graph-theoretical approach, was introduced to predict common secondary structures allowing pseudoknots (<xref ref-type="bibr" rid="B4">Cary <italic>et al.</italic>, 1995</xref>; <xref ref-type="bibr" rid="B38">Tabaska <italic>et al.</italic>, 1998</xref>). RNAalifold (<xref ref-type="bibr" rid="B2">Bernhart <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B20">Hofacker <italic>et al.</italic>, 2002</xref>) incorporates both thermodynamic parameters and sequence covariation, and permits sampling of consensus structures from its probabilistic model.</p>
      <p>Algorithms for finding a multiple alignment given a common structure, i.e. P(A|S,Q), have also been developed. There are well-known generic multiple alignment algorithms, e.g. ClustalW2 (<xref ref-type="bibr" rid="B5">Chenna <italic>et al.</italic>, 2003</xref>) and ProbCons (<xref ref-type="bibr" rid="B8">Do <italic>et al.</italic>, 2005</xref>), but these do not incorporate structural information, and thus model only P(A|Q). Of more direct interest here are algorithms that use a given consensus structure to predict a multiple alignment, i.e. the model P(A|S,Q). Such methods can improve the alignment of RNA sequences (<xref ref-type="bibr" rid="B30">Nawrocki and Eddy, 2007</xref>). In one approach, structures of individual sequences are predicted separately and abstractions of these structures aligned (<xref ref-type="bibr" rid="B14">Giegerich <italic>et al.</italic>, 2004</xref>; <xref ref-type="bibr" rid="B36">Siebert <italic>et al.</italic>, 2005</xref>; <xref ref-type="bibr" rid="B37">Steffen <italic>et al.</italic>, 2006</xref>). Another approach (<xref ref-type="bibr" rid="B21">Ji <italic>et al.</italic>, 2004</xref>) applies graph theory to find stems conserved across multiple sequences first, and then assembles conserved stem blocks to form consensus structures in which pseudoknots are permitted. The probabilistic covariance model (<xref ref-type="bibr" rid="B11">Eddy and Durbin, 1994</xref>) employs the SCFG model to multiply align sequences using a given consensus structure. This algorithm iterates between parameter estimation and alignment prediction using an expectation maximization (EM) algorithm. After convergence, it permits sampling of alignments. <xref ref-type="bibr" rid="B11">Eddy and Durbin (1994</xref>) also presented an iterative optimization procedure that iterates between alignment and structure, taking an optimization approach instead of the sampling approach we describe here. More recently, <xref ref-type="bibr" rid="B44">Yao <italic>et al.</italic> (2006</xref>) described CMfinder, an extension of this approach to find regulatory motifs.</p>
      <p>There is a ‘chicken and egg’ problem for these two classes of algorithms: a good RNA sequence alignment (A) depends on a specified consensus structure (S), and a good consensus structure (S) prediction depends on a good alignment (A). One approach to solving this dilemma is to simultaneously align and fold a pair of RNA sequences with a dynamic programming algorithm (<xref ref-type="bibr" rid="B34">Sankoff, 1985</xref>). However, the computational complexity is O(<italic>n</italic><sup>6</sup>), too high to be of practical value in all but very short sequences. Heuristics based on simplifications and restrictions of the Sankoff algorithm for multiple sequences (more than two) have been developed, such as FoldalignM (<xref ref-type="bibr" rid="B39">Torarinsson <italic>et al.</italic>, 2007</xref>), mLocARNA (<xref ref-type="bibr" rid="B42">Will <italic>et al.</italic>, 2007</xref>), Murlet (<xref ref-type="bibr" rid="B22">Kiryu <italic>et al.</italic>, 2007a</xref>) and RNA Alignment and Folding (RAF) (<xref ref-type="bibr" rid="B10">Do <italic>et al.</italic>, 2008</xref>).</p>
      <p>Another approach is to iteratively predict structure and alignment conditioned on each other. Early work focused on finding the optimal solution with an EM algorithm (<xref ref-type="bibr" rid="B11">Eddy <italic>et al.</italic>, 1994</xref>; <xref ref-type="bibr" rid="B44">Yao <italic>et al.</italic>, 2006</xref>) or simulated annealing (<xref ref-type="bibr" rid="B25">Lindgreen <italic>et al.</italic>, 2007</xref>). Recently, approaches that draw samples from probabilistic models using Markov chain Monte Carlo (MCMC) procedures have been described. <xref ref-type="bibr" rid="B29">Meyer <italic>et al.</italic> (2007</xref>) employs a Metropolis–Hastings algorithm that makes proposals for local alignment and structure changes, accepting them probabilistically. However, the slow convergence of these local-move algorithms tends to require a large number of sampling steps. Another variation is RNAsampler (<xref ref-type="bibr" rid="B43">Xing <italic>et al.</italic>, 2007</xref>), which heuristically iterates between the alignment and sampling of candidate stems in the multiple sequences.</p>
      <p>Gibbs sampling, introduced by Geman and <xref ref-type="bibr" rid="B13">Geman (1984</xref>), is another popular MCMC procedure. Inspired by a theorem of <xref ref-type="bibr" rid="B26">Liu (1994</xref>) concerning accelerated convergence of various Gibbs samplers, here we describe a blocked sampling algorithm that iterates between alignment (A) and structure prediction (S). In Liu's first theorem, three alternative Gibbs sampling approaches are considered: (i) the standard Gibbs sampler in which each of the random variables (RVs) are sampled individually; (ii) the grouped Gibbs sampler in which two or more of the RVs are sampled jointly in blocks; and (iii) the collapsed Gibbs sampler in which at least one of the RVs is removed from the problem via integration. He compares their convergence rates based on their forward operators, F<sub>s</sub>, F<sub>g</sub>, F<sub>c</sub>. The theorem shows that the norms of these operators are ordered as follows: ||F<sub>c</sub>||≤||F<sub>g</sub>||≤||F<sub>s</sub>||. Thus, the expected number of iterations until convergence follows the reverse order. However, as he points out, if the computation required at each iteration to sample blocks or to remove RVs via integration is too large, then any improvements in convergence rate may not be worth the added computational expense. Thus, the key is to find efficient procedures for blocking or integrating.</p>
      <p>Here we describe a Gibbs sampling algorithm that capitalizes on Liu's theorem via block sampling. This algorithm, which we call RNAG, iteratively block samples from the conditional probability distributions P(Structure | Alignment) and P(Alignment | Structure), and in so doing refines the models of both Alignment and Structure. We use these samples to characterize the shape of the posterior space using hierarchal clustering and centroid estimators. We use γ -centroid estimators to delineate the trade-off between the positive predictive value (PPV) and the sensitivity of the algorithm, and credibility limits to characterize the uncertainty of our predictions.</p>
    </sec>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 RNAG sampling algorithm</title>
      <p>Consider the probabilistic model P(A,S|Λ<sub><italic>A</italic></sub>,Λ<sub><italic>S</italic></sub>,Q) for multiple sequences Q, where the hidden variables are A (the alignment) and S (the consensus structure), and Λ<sub><italic>A</italic></sub>, Λ<sub><italic>S</italic></sub> are the corresponding parameters of the A, S prediction steps. The goal is to find samples from the joint distribution P(A,S|Λ<sub><italic>A</italic></sub>, Λ<sub><italic>S</italic></sub>,Q). RNAG, the blocked Gibbs sampler described here, achieves this by iteratively sampling from the conditional probabilities P(S<sup>(<italic>t</italic>)</sup>|<italic>A</italic><sup>(<italic>t</italic>−1)</sup>, Λ<sub><italic>S</italic></sub>,Q) and P(A<sup>(<italic>t</italic>)</sup>|<italic>S</italic><sup>(<italic>t</italic>−1)</sup>, Λ<sub><italic>A</italic></sub>,Q), at the <italic>t</italic>-th iteration. Notice that our algorithm provides a generic framework that can employ any probabilistic sampling algorithms in each of its two sampling steps. Specifically, RNAG proceeds as follows.</p>
      <sec id="SEC2.1.1">
        <title>2.1.1 Alignment initialization</title>
        <p>In theory, it does not matter if the algorithm starts from an initial alignment or an initial consensus structure. Here, we begin with an initial alignment A<sup>(0)</sup> produced by ProbCons (<xref ref-type="bibr" rid="B8">Do <italic>et al.</italic>, 2005</xref>) under the model P(A|Q).</p>
      </sec>
      <sec id="SEC2.1.2">
        <title>2.1.2 Iteration steps</title>
        <p><list list-type="order"><list-item><p>Sample a consensus structure (S<sup>(<italic>t</italic>)</sup>) given an alignment (A<sup>(<italic>t</italic>−1)</sup>). To sample from P(S<sup><italic>(t)</italic></sup>|<italic>A</italic><sup>(<italic>t</italic>−1)</sup>, Λ<sub><italic>S</italic></sub>,Q), we employ RNAalifold (<xref ref-type="bibr" rid="B2">Bernhart <italic>et al.</italic>, 2008</xref>), which combines thermodynamic parameters and empirical parameters estimated from the aligned sequences using a default covariation weight Λ<sub><italic>S</italic></sub>.</p></list-item><list-item><p>Sample an alignment (A<sup>(<italic>t</italic>)</sup>) given a consensus structure (S<sup>(<italic>t</italic>)</sup>). To sample from P(A<sup>(<italic>t</italic>)</sup>|<italic>S</italic><sup>(<italic>t</italic>)</sup>, Λ<sub><italic>A</italic></sub>,Q), we employ the Infernal package (<xref ref-type="bibr" rid="B31">Nawrocki <italic>et al.</italic>, 2009</xref>). Λ<sub><italic>A</italic></sub> is a set of empirical parameter estimates (parameters for SCFG model) obtained from P(Λ<sub><italic>A</italic></sub>|<italic>S</italic><sup>(<italic>t</italic>)</sup>, A<sup>(<italic>t</italic> − 1)</sup>, Q) using an EM algorithm. Given Λ<sub><italic>A</italic></sub>, a multiple alignment is sampled from P(A<sup>(<italic>t</italic>)</sup>| Λ<sub><italic>A</italic></sub>, S<sup>(<italic>t</italic>)</sup> ,Q) using the SCFG model.</p></list-item></list><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr421/DC1">Supplementary Figure S1</ext-link> shows a diagram of these steps.</p>
      </sec>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Sample analysis: characterization of the posterior space</title>
      <p>As described by <xref ref-type="bibr" rid="B28">Mathews (2006</xref>), sampling from the Boltzmann weighted ensemble of secondary structures can provide a full characterization of this structure space. Here, the RNAG sampler draws samples from the very high-dimensional space of structures and alignments. In our approach, attention is focused on the sampled structures, though the multiple alignments also evolve during the sampling. We employed clustering analysis to characterize the overall shape of the posterior space of structures, and credibility limits to delineate uncertainty in predicted structures.</p>
      <sec id="SEC2.2.1">
        <title>2.2.1 Clustering analysis</title>
        <p>Boltzmann weighted ensembles of RNA secondary structures can exhibit complex shapes, which often include multiple modes (<xref ref-type="bibr" rid="B7">Ding <italic>et al.</italic>, 2006</xref>). Here we examine the shape of the probabilistically weighted posterior space using a hierarchical clustering procedure like that employed by <xref ref-type="bibr" rid="B7">Ding <italic>et al.</italic> (2006</xref>) for a single sequence.</p>
        <p>Direct comparison of the sampled consensus structures is impractical because of the dependence of the indices of the bases of sampled structures on the alignment. Thus, we followed the second evaluation procedure described by <xref ref-type="bibr" rid="B18">Hamada <italic>et al.</italic> (2011</xref>), projecting the consensus structure back onto each sequence, and then used a hierarchical clustering method on the projected structures.</p>
      </sec>
      <sec id="SEC2.2.2">
        <title>2.2.2 Centroid estimator</title>
        <p>We calculated γ -centroid estimators (<xref ref-type="bibr" rid="B17">Hamada <italic>et al.</italic>, 2009</xref>) for structure prediction and for comparison with alternative prediction methods. Specifically, we used estimates of marginal probabilities of base pairs obtained from base pair frequencies from the Gibbs sampler after a burn-in period to obtain the γ-centroid estimators. For each RNAG experiment described in <xref ref-type="sec" rid="SEC3">Section 3</xref>, we sampled a burn-in period of 1000 iterations, and used the next 1000 sampled structures for clustering and calculation of the centroid. The γ-centroid, as a generalization of the centroid estimator, provides a means to balance sensitivity and PPV and accordingly can be used to compare procedures over the range of this trade-off. We employed the γ-centroid estimator for such comparisons and the original centroid estimator in calculations of bias and variance.</p>
      </sec>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Evaluation metric</title>
      <sec id="SEC2.3.1">
        <title>2.3.1 Prediction accuracy</title>
        <p>To evaluate prediction accuracy, we compared the predicted structure for each sequence with its reference structure and calculated sensitivity (SEN) and PPV. SEN is the fraction of known base pairs correctly predicted, and PPV is the fraction of predicted base pairs that are in the known structure (<xref ref-type="bibr" rid="B27">Mathews, 2004</xref>). Using γ-centroid estimation, we can interpolate a curve on the PPV-−SEN plane based on different γ values (<xref ref-type="bibr" rid="B18">Hamada <italic>et al.</italic>, 2011</xref>). Following the lead of <xref ref-type="bibr" rid="B10">Do <italic>et al.</italic> (2008</xref>), we report the average of (PPV, SEN) calculated for each test case, weighing each sequence equally. For the comparison of the relative performance of RNAG across RNA families, we used the area under the curve, acquired with linear interpolation, as a qualitative measure.</p>
      </sec>
      <sec id="SEC2.3.2">
        <title>2.3.2 Uncertainty analysis</title>
        <list list-type="order">
          <list-item>
            <p>Credibility limits: Any prediction of structure provides only a point estimate of secondary structure, giving no information about the uncertainty of that estimate. We employed Bayesian confidence limits, a.k.a. credibility limits, to characterize this uncertainty (<xref ref-type="bibr" rid="B32">Newberg <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B41">Webb-Robertson <italic>et al.</italic>, 2008</xref>). These limits compute the radius of the smallest hypersphere centered at the estimate containing 95% of the posterior weighted space.</p>
          </list-item>
          <list-item>
            <p>Bias-variance analysis: In any prediction based on finite data involving comparison with a reference, deviations from the reference involve two components, bias and variance, where the bias measures the distance between the mean and the reference, and the variance gives the variation around the mean. In this discrete setting, where the secondary structure is treated as a binary matrix with random elements, the mean is almost certainly not a feasible RNA secondary structure, because it will almost certainly not be integer valued. Accordingly, here we measured bias as the distance between the reference structure and the structure in the ensemble that is nearest to the mean in the least squares sense (the centroid) (<xref ref-type="bibr" rid="B3">Carvalho and Lawrence, 2008</xref>), and the variance as the variation around the centroid of the ensemble. As <xref ref-type="bibr" rid="B3">Carvalho and Lawrence (2008</xref>) have shown, for binary variables, square error distances, <italic>p</italic>-th power error differences and Hamming distances are equal; thus, we used Hamming distances to calculate bias.</p>
          </list-item>
          <list-item>
            <p>Separation index: To assess how well separated the clusters of secondary structures were relative to the variation within clusters, we used the following separation index:
<disp-formula id="M1"><label>(1)</label><graphic xlink:href="btr421m1"/></disp-formula>
where <italic>D</italic> is the Hamming distance between the centroids of the two largest clusters, i.e. the total number of paired bases contained in one centroid structure but not the other, and <italic>C</italic><sub>1</sub>, <italic>C</italic><sub>2</sub> are the 95% credibility limits around the two largest cluster centroids. When this index is at least 1, no more than 5% of the structures from either cluster are within the 95% credibility limit of the other cluster, and thus we say the two largest clusters are well separated.</p>
          </list-item>
        </list>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>3 RESULTS</title>
    <p>Following <xref ref-type="bibr" rid="B18">Hamada <italic>et al.</italic> (2011</xref>), we picked 17 γ-centroid estimators, where γ∈{2<sup><italic>k</italic></sup>: −5≤<italic>k</italic>≤10, <italic>k</italic>∈<italic>Z</italic>}∪{6} from which to interpolate the curve on the PPV–SEN plane.</p>
    <sec id="SEC3.1">
      <title>3.1 Training</title>
      <p>Because there are only a few current algorithms for each step of RNAG, and because we used default parameters and settings for each algorithm employed in our study, training in this study was very limited. Furthermore, since there are very few available algorithms that draw samples, we have explored only RNAalifold and Infernal for the two iteration steps. Using the dataset of <xref ref-type="bibr" rid="B22">Kiryu <italic>et al.</italic> (2007a</xref>), we compared ClustalW and ProbCons for the initialization step, and found that ProbCons returned better results; thus, the results presented here all use ProbCons.</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Comparison of accuracy (testing)</title>
      <p>In our first accuracy assessment, we evaluated RNAG on the benchmark dataset from <xref ref-type="bibr" rid="B25">Lindgreen <italic>et al.</italic> (2007</xref>), herein called the MASTR dataset. Structure prediction results from current algorithms for this dataset are given in <xref ref-type="bibr" rid="B10">Do <italic>et al.</italic> (2008</xref>) and plotted together with the PPV-SEN curve from RNAG in <xref ref-type="fig" rid="F1">Figure 1</xref>.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Average performance of different secondary structure prediction methods in the PPV–SEN plane for the MASTR dataset (<xref ref-type="bibr" rid="B25">Lindgreen <italic>et al.</italic>, 2007</xref>). PPV = TP/P = TP/(TP + FP), SEN = TP/T = TP/(TP + FN). Note: the axis ranges are set from 0.3 to 1.0 to improve readability. Points showing the performance of extant procedures were taken from <xref ref-type="bibr" rid="B10">Do <italic>et al.</italic> (2008</xref>) except for CMfinder, which was included because of its similarity to RNAG. CMfinder was run at default values and settings.</p></caption><graphic xlink:href="btr421f1"/></fig></p>
      <p>We also tested and compared different align-fold algorithms on the BRAliBASE II dataset (<xref ref-type="bibr" rid="B12">Gardner <italic>et al.</italic>, 2005</xref>), which contains collections of ~100 five-sequence subalignments, sampled from four specific Rfam families (5S rRNA, group II intron, tRNA and U5 spliceosomal RNA) for which the BRAliBASE II dataset included reference alignments. For comparison, the results reported in <xref ref-type="bibr" rid="B10">Do <italic>et al.</italic> (2008</xref>) were averaged over the four RNA families and are shown plotted on the PPV–SEN plane along with the RNAG frontier in <xref ref-type="fig" rid="F2">Figure 2</xref>.
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>Average performance of different secondary structure prediction methods in the PPV–SEN plane for four RNA families (5S rRNA, group II intron, tRNA and U5 spliceosomal RNA) from the BRAliBASE II dataset (<xref ref-type="bibr" rid="B12">Gardner <italic>et al.</italic>, 2005</xref>). Note: the axis ranges are set from 0.3 to 1.0 to improve readability. Points showing the performance of extant procedures were taken from <xref ref-type="bibr" rid="B10">Do <italic>et al.</italic> (2008</xref>) except for CMfinder, which was run at defaults.</p></caption><graphic xlink:href="btr421f2"/></fig></p>
      <p>These comparisons demonstrate that the results of extant procedures lie below the RNAG frontier, indicating that, on average, RNAG provides a better trade-off between PPV and sensitivity. Not surprisingly, this is not always the case. <xref ref-type="bibr" rid="B10">Do <italic>et al.</italic> (2008</xref>) presents the results of prediction methods for each of the four RNA families in the BRAliBASE II dataset. <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr421/DC1">Supplementary Figure S2</ext-link> shows that 14 of these 16 predictions are below the RNAG frontier and 2 are somewhat above this frontier.</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 RNAG performance characteristics</title>
      <p>We explored RNAG's properties using the benchmark dataset described by <xref ref-type="bibr" rid="B22">Kiryu <italic>et al.</italic> (2007a</xref>), which contains 85 reference alignments of 10 sequences each, representing 17 RNA families from the Rfam database (<xref ref-type="bibr" rid="B15">Griffiths-Jones <italic>et al.</italic>, 2005</xref>). This dataset spans a range of sequence lengths from 51 to 291 bases, and a range of sequence identity from 40% to 94%, including nine families with identities under 60%. <xref ref-type="bibr" rid="B22">Kiryu <italic>et al.</italic> (2007a</xref>) used this dataset to compare algorithms that predict a consensus structure for an aligned set of sequences. Perhaps not surprisingly, as shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr421/DC1">Supplementary Figure S3</ext-link>, RNAG also outperforms these procedures, including CentroidAlifold (<xref ref-type="bibr" rid="B18">Hamada <italic>et al.</italic>, 2011</xref>), a state-of-the-art algorithm. However, our purpose in using this dataset was to characterize the variation in RNAG performance with number of sequences in the alignment and over various RNA families.</p>
      <sec id="SEC3.3.1">
        <title>3.3.1 Variation with the number of unaligned sequences</title>
        <p>To assess the effect that the number of input sequences has on prediction accuracy, we took <italic>N</italic> (2≤<italic>N</italic>≤10) random sequences from each of the 85 reference alignments, ran RNAG on these subsets of sequences and averaged over 10 independent runs (except for <italic>N</italic>=10). The results are given in <xref ref-type="table" rid="T1">Table 1</xref> and a subset of these results are shown as PPV–SEN curves in <xref ref-type="fig" rid="F3">Figure 3</xref>, which shows that with additional sequences the structure prediction improves, but with decreasing increments, as indicated by the small improvement between 8 and 10 input sequences. However, <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr421/DC1">Supplementary Figure S4 and Table S1</ext-link> show that this finding differs between sequence sets, and depends on the average pairwise identity of the input sequences, suggesting that larger gains are attainable with additional sequences when the input sequences have &lt;60% average pairwise identity. Notice in <xref ref-type="table" rid="T1">Table 1</xref> that the bias decreases with the number of sequences in the alignment, but with decreasing gains, which is in agreement with improvements in the area under the PPV–SEN curves.
<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>Improvement of the RNAG PPV–SEN curves with increasing numbers of input sequences.</p></caption><graphic xlink:href="btr421f3"/></fig>
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Effects of the number of sequences on prediction results</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">No. of sequences</th><th align="left" colspan="3" rowspan="1">Area under PPV–SEN curve<hr/></th><th align="left" rowspan="1" colspan="1">Bias</th><th align="left" rowspan="1" colspan="1">SD</th><th align="left" colspan="3" rowspan="1">No. of samples<hr/></th><th align="left" colspan="3" rowspan="1">95% credibility limit<hr/></th></tr><tr><td rowspan="1" colspan="1"/><th align="left" rowspan="1" colspan="1">Ensemble</th><th align="left" rowspan="1" colspan="1">First cluster</th><th align="left" rowspan="1" colspan="1">Second cluster</th><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><th align="left" rowspan="1" colspan="1">First cluster</th><th align="left" rowspan="1" colspan="1">Second cluster</th><th align="left" rowspan="1" colspan="1">First+second cluster</th><th align="left" rowspan="1" colspan="1">Ensemble</th><th align="left" rowspan="1" colspan="1">First cluster</th><th align="left" rowspan="1" colspan="1">Second cluster</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">0.44</td><td align="left" rowspan="1" colspan="1">0.46</td><td align="left" rowspan="1" colspan="1">0.37</td><td align="left" rowspan="1" colspan="1">0.27</td><td align="left" rowspan="1" colspan="1">0.04</td><td align="left" rowspan="1" colspan="1">728.13</td><td align="left" rowspan="1" colspan="1">150.76</td><td align="left" rowspan="1" colspan="1">878.89</td><td align="left" rowspan="1" colspan="1">0.21</td><td align="left" rowspan="1" colspan="1">0.14</td><td align="left" rowspan="1" colspan="1">0.11</td></tr><tr><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">0.58</td><td align="left" rowspan="1" colspan="1">0.59</td><td align="left" rowspan="1" colspan="1">0.49</td><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">793.15</td><td align="left" rowspan="1" colspan="1">124.94</td><td align="left" rowspan="1" colspan="1">918.09</td><td align="left" rowspan="1" colspan="1">0.14</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.07</td></tr><tr><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">0.58</td><td align="left" rowspan="1" colspan="1">0.58</td><td align="left" rowspan="1" colspan="1">0.48</td><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">791.66</td><td align="left" rowspan="1" colspan="1">115.00</td><td align="left" rowspan="1" colspan="1">906.66</td><td align="left" rowspan="1" colspan="1">0.14</td><td align="left" rowspan="1" colspan="1">0.09</td><td align="left" rowspan="1" colspan="1">0.06</td></tr><tr><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">0.62</td><td align="left" rowspan="1" colspan="1">0.63</td><td align="left" rowspan="1" colspan="1">0.51</td><td align="left" rowspan="1" colspan="1">0.17</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">802.20</td><td align="left" rowspan="1" colspan="1">113.24</td><td align="left" rowspan="1" colspan="1">915.44</td><td align="left" rowspan="1" colspan="1">0.12</td><td align="left" rowspan="1" colspan="1">0.08</td><td align="left" rowspan="1" colspan="1">0.05</td></tr><tr><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1">0.67</td><td align="left" rowspan="1" colspan="1">0.67</td><td align="left" rowspan="1" colspan="1">0.54</td><td align="left" rowspan="1" colspan="1">0.16</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">800.50</td><td align="left" rowspan="1" colspan="1">111.66</td><td align="left" rowspan="1" colspan="1">912.16</td><td align="left" rowspan="1" colspan="1">0.11</td><td align="left" rowspan="1" colspan="1">0.07</td><td align="left" rowspan="1" colspan="1">0.05</td></tr><tr><td align="left" rowspan="1" colspan="1">7</td><td align="left" rowspan="1" colspan="1">0.70</td><td align="left" rowspan="1" colspan="1">0.69</td><td align="left" rowspan="1" colspan="1">0.57</td><td align="left" rowspan="1" colspan="1">0.15</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">795.52</td><td align="left" rowspan="1" colspan="1">111.92</td><td align="left" rowspan="1" colspan="1">907.44</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.07</td><td align="left" rowspan="1" colspan="1">0.05</td></tr><tr><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1">0.73</td><td align="left" rowspan="1" colspan="1">0.71</td><td align="left" rowspan="1" colspan="1">0.60</td><td align="left" rowspan="1" colspan="1">0.15</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">797.56</td><td align="left" rowspan="1" colspan="1">116.19</td><td align="left" rowspan="1" colspan="1">913.75</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.07</td><td align="left" rowspan="1" colspan="1">0.04</td></tr><tr><td align="left" rowspan="1" colspan="1">9</td><td align="left" rowspan="1" colspan="1">0.73</td><td align="left" rowspan="1" colspan="1">0.73</td><td align="left" rowspan="1" colspan="1">0.60</td><td align="left" rowspan="1" colspan="1">0.14</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">790.59</td><td align="left" rowspan="1" colspan="1">122.38</td><td align="left" rowspan="1" colspan="1">912.97</td><td align="left" rowspan="1" colspan="1">0.09</td><td align="left" rowspan="1" colspan="1">0.06</td><td align="left" rowspan="1" colspan="1">0.04</td></tr><tr><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">0.75</td><td align="left" rowspan="1" colspan="1">0.74</td><td align="left" rowspan="1" colspan="1">0.63</td><td align="left" rowspan="1" colspan="1">0.13</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">792.85</td><td align="left" rowspan="1" colspan="1">125.11</td><td align="left" rowspan="1" colspan="1">917.96</td><td align="left" rowspan="1" colspan="1">0.09</td><td align="left" rowspan="1" colspan="1">0.06</td><td align="left" rowspan="1" colspan="1">0.04</td></tr></tbody></table><table-wrap-foot><fn><p>For each row, we not only calculate the average area under the PPV–SEN curve for accuracy comparison, but also summarize the bias-variance statistics and the size of the two biggest clusters to visualize the clustering results. In order to normalize bias, SD and credibility limits with respect to the sequence length, we divide them by the average sequence length for the family.</p></fn></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="SEC3.3.2">
        <title>3.3.2 A detailed look into each family</title>
        <p>The above results describe the overall performance of RNAG for this dataset, but do not reveal differences across the families. In <xref ref-type="table" rid="T2">Table 2</xref>, we list the bias-variance statistics, area under the PPV–SEN curve and cluster statistics for each family. As this table indicates, there is considerable variability in the biases and under-curve areas, which reflects the fact that the ability to predict the reference structure varies widely between families. <xref ref-type="fig" rid="F4">Figure 4</xref> highlights this variability and shows a strong correlation between bias and the area under the PPV–SEN curve.
<fig id="F4" position="float"><label>Fig. 4.</label><caption><p>2D plot of bias per base pair and the area under the PPV–SEN curve of the ensemble centroid for the 17 RNA families in <xref ref-type="table" rid="T2">Table 2</xref>. The results for each family are represented by a symbol indicating their functional group.</p></caption><graphic xlink:href="btr421f4"/></fig>
<table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>A detailed look into the RNAG results on 17 RNA families, listed in groups by their functional type</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">RNA family</th><th align="left" rowspan="1" colspan="1">RNA type</th><th align="left" rowspan="1" colspan="1">Mean length (percent identity)</th><th align="left" rowspan="1" colspan="1">Bias</th><th align="left" rowspan="1" colspan="1">SD</th><th align="left" colspan="3" rowspan="1">95% credibility limit<hr/></th><th align="left" colspan="3" rowspan="1">PPV–SEN area<hr/></th><th align="left" colspan="3" rowspan="1">No. of samples<hr/></th><th align="left" rowspan="1" colspan="1">Separation index</th></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><th align="left" rowspan="1" colspan="1">Ensemble</th><th align="left" rowspan="1" colspan="1">First cluster</th><th align="left" rowspan="1" colspan="1">Second cluster</th><th align="left" rowspan="1" colspan="1">Ensemble</th><th align="left" rowspan="1" colspan="1">First cluster</th><th align="left" rowspan="1" colspan="1">Second cluster</th><th align="left" rowspan="1" colspan="1">First+second</th><th align="left" rowspan="1" colspan="1">First cluster</th><th align="left" rowspan="1" colspan="1">Second cluster</th><td rowspan="1" colspan="1"/></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">T-box</td><td align="left" rowspan="1" colspan="1">tRNA</td><td align="left" rowspan="1" colspan="1">244 (45)</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.01</td><td align="left" rowspan="1" colspan="1">0.06</td><td align="left" rowspan="1" colspan="1">0.04</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.58</td><td align="left" rowspan="1" colspan="1">0.55</td><td align="left" rowspan="1" colspan="1">0.47</td><td align="left" rowspan="1" colspan="1">926</td><td align="left" rowspan="1" colspan="1">826</td><td align="left" rowspan="1" colspan="1">100</td><td align="left" rowspan="1" colspan="1">1.00</td></tr><tr><td align="left" rowspan="1" colspan="1">t-RNA</td><td align="left" rowspan="1" colspan="1">tRNA</td><td align="left" rowspan="1" colspan="1">73 (45)</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.01</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">0.01</td><td align="left" rowspan="1" colspan="1">0.01</td><td align="left" rowspan="1" colspan="1">1.00</td><td align="left" rowspan="1" colspan="1">0.99</td><td align="left" rowspan="1" colspan="1">0.91</td><td align="left" rowspan="1" colspan="1">949</td><td align="left" rowspan="1" colspan="1">888</td><td align="left" rowspan="1" colspan="1">61</td><td align="left" rowspan="1" colspan="1">2.50</td></tr><tr><td align="left" rowspan="1" colspan="1">5S-rRNA</td><td align="left" rowspan="1" colspan="1">rRNA</td><td align="left" rowspan="1" colspan="1">116 (57)</td><td align="left" rowspan="1" colspan="1">0.17</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.07</td><td align="left" rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">0.70</td><td align="left" rowspan="1" colspan="1">0.70</td><td align="left" rowspan="1" colspan="1">0.67</td><td align="left" rowspan="1" colspan="1">922</td><td align="left" rowspan="1" colspan="1">751</td><td align="left" rowspan="1" colspan="1">171</td><td align="left" rowspan="1" colspan="1">0.88</td></tr><tr><td align="left" rowspan="1" colspan="1">5-8S-rRNA</td><td align="left" rowspan="1" colspan="1">rRNA</td><td align="left" rowspan="1" colspan="1">154 (61)</td><td align="left" rowspan="1" colspan="1">0.18</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">0.14</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.08</td><td align="left" rowspan="1" colspan="1">0.43</td><td align="left" rowspan="1" colspan="1">0.42</td><td align="left" rowspan="1" colspan="1">0.26</td><td align="left" rowspan="1" colspan="1">907</td><td align="left" rowspan="1" colspan="1">744</td><td align="left" rowspan="1" colspan="1">163</td><td align="left" rowspan="1" colspan="1">0.56</td></tr><tr><td align="left" rowspan="1" colspan="1">Retroviral-psi</td><td align="left" rowspan="1" colspan="1">Rviral</td><td align="left" rowspan="1" colspan="1">117 (92)</td><td align="left" rowspan="1" colspan="1">0.07</td><td align="left" rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">0.15</td><td align="left" rowspan="1" colspan="1">0.11</td><td align="left" rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">0.99</td><td align="left" rowspan="1" colspan="1">0.99</td><td align="left" rowspan="1" colspan="1">0.47</td><td align="left" rowspan="1" colspan="1">981</td><td align="left" rowspan="1" colspan="1">952</td><td align="left" rowspan="1" colspan="1">29</td><td align="left" rowspan="1" colspan="1">1.25</td></tr><tr><td align="left" rowspan="1" colspan="1">U1</td><td align="left" rowspan="1" colspan="1">sRNA</td><td align="left" rowspan="1" colspan="1">157 (59)</td><td align="left" rowspan="1" colspan="1">0.16</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.06</td><td align="left" rowspan="1" colspan="1">0.06</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.69</td><td align="left" rowspan="1" colspan="1">0.69</td><td align="left" rowspan="1" colspan="1">0.63</td><td align="left" rowspan="1" colspan="1">988</td><td align="left" rowspan="1" colspan="1">928</td><td align="left" rowspan="1" colspan="1">60</td><td align="left" rowspan="1" colspan="1">1.13</td></tr><tr><td align="left" rowspan="1" colspan="1">U2</td><td align="left" rowspan="1" colspan="1">sRNA</td><td align="left" rowspan="1" colspan="1">182 (62)</td><td align="left" rowspan="1" colspan="1">0.08</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.90</td><td align="left" rowspan="1" colspan="1">0.90</td><td align="left" rowspan="1" colspan="1">0.71</td><td align="left" rowspan="1" colspan="1">981</td><td align="left" rowspan="1" colspan="1">941</td><td align="left" rowspan="1" colspan="1">40</td><td align="left" rowspan="1" colspan="1">1.14</td></tr><tr><td align="left" rowspan="1" colspan="1">Sno-14q-I-II</td><td align="left" rowspan="1" colspan="1">sRNA</td><td align="left" rowspan="1" colspan="1">75 (64)</td><td align="left" rowspan="1" colspan="1">0.07</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">0.12</td><td align="left" rowspan="1" colspan="1">0.08</td><td align="left" rowspan="1" colspan="1">0.07</td><td align="left" rowspan="1" colspan="1">1.00</td><td align="left" rowspan="1" colspan="1">0.92</td><td align="left" rowspan="1" colspan="1">0.86</td><td align="left" rowspan="1" colspan="1">838</td><td align="left" rowspan="1" colspan="1">636</td><td align="left" rowspan="1" colspan="1">202</td><td align="left" rowspan="1" colspan="1">0.47</td></tr><tr><td align="left" rowspan="1" colspan="1">Lysine</td><td align="left" rowspan="1" colspan="1">riboswitch</td><td align="left" rowspan="1" colspan="1">181 (49)</td><td align="left" rowspan="1" colspan="1">0.07</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.06</td><td align="left" rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">0.94</td><td align="left" rowspan="1" colspan="1">0.93</td><td align="left" rowspan="1" colspan="1">0.84</td><td align="left" rowspan="1" colspan="1">983</td><td align="left" rowspan="1" colspan="1">923</td><td align="left" rowspan="1" colspan="1">60</td><td align="left" rowspan="1" colspan="1">0.88</td></tr><tr><td align="left" rowspan="1" colspan="1">RFN</td><td align="left" rowspan="1" colspan="1">riboswitch</td><td align="left" rowspan="1" colspan="1">140 (66)</td><td align="left" rowspan="1" colspan="1">0.15</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">0.11</td><td align="left" rowspan="1" colspan="1">0.06</td><td align="left" rowspan="1" colspan="1">0.06</td><td align="left" rowspan="1" colspan="1">0.68</td><td align="left" rowspan="1" colspan="1">0.64</td><td align="left" rowspan="1" colspan="1">0.60</td><td align="left" rowspan="1" colspan="1">820</td><td align="left" rowspan="1" colspan="1">574</td><td align="left" rowspan="1" colspan="1">246</td><td align="left" rowspan="1" colspan="1">0.58</td></tr><tr><td align="left" rowspan="1" colspan="1">THI</td><td align="left" rowspan="1" colspan="1">riboswitch</td><td align="left" rowspan="1" colspan="1">105 (55)</td><td align="left" rowspan="1" colspan="1">0.08</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.07</td><td align="left" rowspan="1" colspan="1">0.06</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.89</td><td align="left" rowspan="1" colspan="1">0.88</td><td align="left" rowspan="1" colspan="1">0.75</td><td align="left" rowspan="1" colspan="1">968</td><td align="left" rowspan="1" colspan="1">869</td><td align="left" rowspan="1" colspan="1">99</td><td align="left" rowspan="1" colspan="1">1.13</td></tr><tr><td align="left" rowspan="1" colspan="1">S-box</td><td align="left" rowspan="1" colspan="1">riboswitch</td><td align="left" rowspan="1" colspan="1">107 (66)</td><td align="left" rowspan="1" colspan="1">0.09</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.07</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">0.88</td><td align="left" rowspan="1" colspan="1">0.87</td><td align="left" rowspan="1" colspan="1">0.74</td><td align="left" rowspan="1" colspan="1">945</td><td align="left" rowspan="1" colspan="1">806</td><td align="left" rowspan="1" colspan="1">139</td><td align="left" rowspan="1" colspan="1">1.17</td></tr><tr><td align="left" rowspan="1" colspan="1">IRES-HCV</td><td align="left" rowspan="1" colspan="1">Cis</td><td align="left" rowspan="1" colspan="1">261 (94)</td><td align="left" rowspan="1" colspan="1">0.25</td><td align="left" rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">0.21</td><td align="left" rowspan="1" colspan="1">0.16</td><td align="left" rowspan="1" colspan="1">0.08</td><td align="left" rowspan="1" colspan="1">0.61</td><td align="left" rowspan="1" colspan="1">0.58</td><td align="left" rowspan="1" colspan="1">0.44</td><td align="left" rowspan="1" colspan="1">936</td><td align="left" rowspan="1" colspan="1">877</td><td align="left" rowspan="1" colspan="1">59</td><td align="left" rowspan="1" colspan="1">1.00</td></tr><tr><td align="left" rowspan="1" colspan="1">SECIS</td><td align="left" rowspan="1" colspan="1">Cis</td><td align="left" rowspan="1" colspan="1">64 (41)</td><td align="left" rowspan="1" colspan="1">0.17</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.08</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.74</td><td align="left" rowspan="1" colspan="1">0.71</td><td align="left" rowspan="1" colspan="1">0.72</td><td align="left" rowspan="1" colspan="1">840</td><td align="left" rowspan="1" colspan="1">679</td><td align="left" rowspan="1" colspan="1">161</td><td align="left" rowspan="1" colspan="1">1.50</td></tr><tr><td align="left" rowspan="1" colspan="1">UnaL2</td><td align="left" rowspan="1" colspan="1">Cis</td><td align="left" rowspan="1" colspan="1">54 (73)</td><td align="left" rowspan="1" colspan="1">0.18</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">0.06</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.33</td><td align="left" rowspan="1" colspan="1">0.62</td><td align="left" rowspan="1" colspan="1">0.61</td><td align="left" rowspan="1" colspan="1">867</td><td align="left" rowspan="1" colspan="1">752</td><td align="left" rowspan="1" colspan="1">115</td><td align="left" rowspan="1" colspan="1">1.00</td></tr><tr><td align="left" rowspan="1" colspan="1">SRP-bact</td><td align="left" rowspan="1" colspan="1">srpRNA</td><td align="left" rowspan="1" colspan="1">93 (47)</td><td align="left" rowspan="1" colspan="1">0.16</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">0.12</td><td align="left" rowspan="1" colspan="1">0.04</td><td align="left" rowspan="1" colspan="1">0.04</td><td align="left" rowspan="1" colspan="1">0.79</td><td align="left" rowspan="1" colspan="1">0.78</td><td align="left" rowspan="1" colspan="1">0.70</td><td align="left" rowspan="1" colspan="1">834</td><td align="left" rowspan="1" colspan="1">646</td><td align="left" rowspan="1" colspan="1">188</td><td align="left" rowspan="1" colspan="1">2.75</td></tr><tr><td align="left" rowspan="1" colspan="1">SRP-euk-arch</td><td align="left" rowspan="1" colspan="1">srpRNA</td><td align="left" rowspan="1" colspan="1">291 (40)</td><td align="left" rowspan="1" colspan="1">0.23</td><td align="left" rowspan="1" colspan="1">0.01</td><td align="left" rowspan="1" colspan="1">0.04</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.49</td><td align="left" rowspan="1" colspan="1">0.48</td><td align="left" rowspan="1" colspan="1">0.47</td><td align="left" rowspan="1" colspan="1">921</td><td align="left" rowspan="1" colspan="1">837</td><td align="left" rowspan="1" colspan="1">84</td><td align="left" rowspan="1" colspan="1">0.80</td></tr><tr><td align="left" rowspan="1" colspan="1">Average</td><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">142</td><td align="left" rowspan="1" colspan="1">0.13</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.09</td><td align="left" rowspan="1" colspan="1">0.06</td><td align="left" rowspan="1" colspan="1">0.04</td><td align="left" rowspan="1" colspan="1">0.76</td><td align="left" rowspan="1" colspan="1">0.74</td><td align="left" rowspan="1" colspan="1">0.63</td><td align="left" rowspan="1" colspan="1">926</td><td align="left" rowspan="1" colspan="1">826</td><td align="left" rowspan="1" colspan="1">100</td><td align="left" rowspan="1" colspan="1">0.90</td></tr></tbody></table><table-wrap-foot><fn><p>We calculated the average area under the PPV–SEN curve for accuracy comparison, as well as statistics like bias, SD, credibility limit, and separation index from cluster analysis, to better understand the posterior secondary structure space.</p></fn></table-wrap-foot></table-wrap></p>
        <p>Furthermore, we observed that the normalized 95% credibility limits for the ensemble centroid are &lt;10% for 11 of the families, which indicates that the probabilistically weighted ensembles are quite tightly compact around the centroid of the full ensemble for the majority of the families. Normalization was obtained by dividing the Hamming distances by the lengths of the sequences. In spite of this, 11 families have a separation index of at least 1 (shown in the last column of <xref ref-type="table" rid="T2">Table 2</xref>), indicating that the cluster centroids are well separated for these 11 families. Finally, notice that the biases, which give the distances between the predicted structures and the reference structures, are more than twice as large as the SDs of the distances of ensemble members around the predicted structures, which shows that the predictions are substantially more precise than they are accurate.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>4 DISCUSSION</title>
    <p>Our results comparing RNAG predictions to those from several additional recently published methods show that the existing procedures yield a combination of sensitivity and PPV that is considerably below the RNAG frontier. Some features of RNAG suggest an explanation for this behavior. RNAG not only inherits the advantages of the sampling method, but also enjoys a theoretical convergence advantage over the Metropolis–Hastings algorithm, which employs local moves. Since RNAG samples full, valid secondary structures, it enjoys an advantage over iterative algorithms that sample only stems. Also, since the two recursive steps sample from the full space of alignments and structures directly, we avoid the need to use a reduced model; a concession that is common to several extant procedures. However, since RNAG is an MCMC procedure, there are no means to assure that it has converged to its target distribution.</p>
    <sec id="SEC4.1">
      <title>4.1 Limitations of comparison datasets and training</title>
      <p>We specifically selected three published datasets and compared RNAG's performance to the published performance of other methods in order to avoid self-serving selection biases and biases that can arise with less than ideal application of extant methods. We added CMfinder to these comparisons by first reproducing the results in <xref ref-type="bibr" rid="B44">Yao <italic>et al.</italic> (2006</xref>) with default settings and then applying the published algorithm to the three datasets in this study with default settings. CMfinder was included because it is similar to RNAG, and as shown by <xref ref-type="bibr" rid="B44">Yao <italic>et al.</italic> (2006</xref>), it can be used to predict global RNA secondary structure, but in fairness, note that CMfinder was not designed primarily for this purpose. Of the three datasets, the most extensive is that of <xref ref-type="bibr" rid="B22">Kiryu <italic>et al.</italic> (2007a</xref>), which includes 17 Rfam families. We accept that in this field it is almost always difficult or impossible to obtain a truly representative dataset. Nevertheless, it is important to recognize that available datasets have limitations. Specifically, generalizations from these 17 families, plus the datasets from the other two comparison groups to the population of RNAs, should be drawn with some caution as the combined sample size is not large and these sets are not random samples. As pointed out above, we did very little to train RNAG in this implementation.</p>
    </sec>
    <sec id="SEC4.2">
      <title>4.2 Potential improvement of RNAG</title>
      <p>There are several potential means for improving RNAG. Since we have done no training to select options or parameters for the algorithmic components in this implementation, the performance of RNAG could potentially be improved by exploiting the full strength of these packages and by tuning the model on a training set. Moreover, RNAG is only a framework for computation and the auxiliary packages above can be replaced by any other algorithms that are designed for P(A|Q), P(S|A,Q) and P(A|S,Q). Furthermore, RNAG now takes the theoretical advantage of a blocked Gibbs sampler by grouping parameters to sample into S and A. A further increase in the convergence rate may be available by integrating out A from the model to take advantage of the collapsed Gibbs sampler. There are several other options for improving the algorithm's speed, including the use of better stopping rules, parallel implementation, and the use of more advanced sampling methods such as parallel tempering.</p>
    </sec>
    <sec id="SEC4.3">
      <title>4.3 An alternative goal of these algorithms</title>
      <p>Our finding of substantial biases in the <xref ref-type="bibr" rid="B22">Kiryu <italic>et al.</italic> (2007a</xref>) dataset indicates that there are systematic departures of predictions from the reference structures. Such systematic departures suggest one of the following: current alignment and structural models are deficient; 1000 iterations is not sufficient for reaching convergence; or several of the reference structures in the 17 Rfam families are not reflective of the structural and sequence features common to the RNA families. As shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr421/DC1">Supplementary Table S2</ext-link>, only two of the reference structures in this dataset were obtained by covariation analysis, and 13 were obtained by X-ray or NMR. Thus, nearly 76% of the reference structures in this dataset were determined by <italic>in vitro</italic> methods. Structures from such biophysical experiments may not reflect structural features common among family members, as important cellular components were likely missing in these experiments. This suggests an alternative goal for align-fold algorithms aimed at RNA family identification: correct classification of sequences into families, similar to that reported by <xref ref-type="bibr" rid="B40">Webb <italic>et al.</italic> (2002</xref>) for protein sequences. As the database of Rfam families has been obtained based on alignments to specific ‘reference structures,’ it will be a particularly difficult challenge to demonstrate that there is an alternative structure that is superior in the identification of family members. Thus, comparison of performances in family membership may require the use of reference sets obtained through independent experiments, such as those using immunoprecipitation (IP) methods. Finally, the existence of small variances indicates that an alternative estimator that trades larger variances for reduced bias may yield lower overall deviations.</p>
    </sec>
    <sec id="SEC4.4">
      <title>4.4 Confusion of MEA</title>
      <p>In recent publications (<xref ref-type="bibr" rid="B9">Do <italic>et al.</italic>, 2006</xref>; <xref ref-type="bibr" rid="B22">Kiryu <italic>et al.</italic>, 2007</xref>), MEA estimators are widely used as a better representative than the previous MFE estimator. However, we find the name MEA misleading. If the MEA is calculated on the basis of base pairs instead of individual bases, then this estimator corresponds to the centroid or γ -centroid. But our findings of large biases of these estimators indicate that expected ‘accuracy’ is misleading, in that there is no assurance that these estimators are close to an outside reference structure. However, these estimators do return estimates that have minimum variance, and thus in the least squared sense they are the most reproducible of all estimators in the posterior weighted space. Accordingly, they would be better described as maximum expected precision (MEP) estimators, or perhaps preferably by the non-buoyant name that defines them as centroid or γ-centroid estimates.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC5">
    <title>5 CONCLUSION</title>
    <p>In this study, we introduce a blocked Gibbs sampler (RNAG) to predict secondary structure for unaligned RNA sequences. RNAG confronts the high time complexity of the align-fold problem by capitalizing on Liu's findings on blocked Gibbs sampling. <xref ref-type="fig" rid="F1">Figures 1</xref> and <xref ref-type="fig" rid="F2">2</xref> show that the new algorithm delivers substantial improvement, as measured by PPV–SEN curves. However, as with any MCMC procedure, evidence of convergence during the burn-in cannot be guaranteed. Also, in the current implementation of this algorithm, little has been done ensure fast code or an efficient stopping rule. We found that the running times of RNAG are in the range of 3 times faster than the RNAsampler and 10 times slower than RAF. Thus, improvements in implementation speed will be important. While the results with the two available datasets and those shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr421/DC1">Supplementary Figure S3</ext-link> are encouraging, these do not assure that this procedure will perform this well for all RNA sequence sets. Furthermore, this procedure and others like it may not be ideal for structure prediction since if it works perfectly, it will only capture structural and sequence features common to a set of input sequences, much as motif finding algorithms capture sequence characteristics common to transcription factor binding sites in multiple sequences. Nevertheless, here we show that RNAG does a better job at predicting reference structures than extant procedures, while providing a fuller characterization of the shape of the posterior space including characterization of multimodal features and ascertainment of uncertainty in structural predictions. Even if RNAG does continue to perform well at this task, several more steps will be necessary to develop a fully Bayesian RNA motif finder.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_27_18_2486__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_btr421_SUPPLEMENTARY_WAL.doc"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank Sean Eddy, Dave Mathews and the referees for their many helpful suggestions. We also thank Bill Thompson for his help improving the scripts for our implementation and Lee Ann McCue for helping to improve our presentation.</p>
    <p><italic>Funding</italic>: <funding-source>US Department of Energy, DOE</funding-source> grant (DOE: <award-id>DE-FG02-04ER63942</award-id>) and funds from <funding-source>Brown University</funding-source>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bindewald</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Shapiro</surname>
            <given-names>B.A.</given-names>
          </name>
        </person-group>
        <article-title>RNA secondary structure prediction from sequence alignments using a network of k-nearest neighbor classifiers</article-title>
        <source>RNA</source>
        <year>2006</year>
        <volume>12</volume>
        <fpage>342</fpage>
        <lpage>352</lpage>
        <pub-id pub-id-type="pmid">16495232</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernhart</surname>
            <given-names>S.H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNAalifold: improved consensus structure prediction for RNA alignments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>474</fpage>
        <lpage>487</lpage>
        <pub-id pub-id-type="pmid">19014431</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carvalho</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Centroid estimation in discrete high-dimensional spaces with applications in biology</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2008</year>
        <volume>105</volume>
        <fpage>3209</fpage>
        <lpage>3214</lpage>
        <pub-id pub-id-type="pmid">18305160</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cary</surname>
            <given-names>R.B.</given-names>
          </name>
          <name>
            <surname>Stormo</surname>
            <given-names>G.D.</given-names>
          </name>
        </person-group>
        <article-title>Graph-theoretic approach to RNA modeling using comparative data</article-title>
        <source>Proc. Int. Conf. Intell. Syst. Mol. Biol.</source>
        <year>1995</year>
        <volume>3</volume>
        <fpage>75</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">7584469</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chenna</surname>
            <given-names>R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiple sequence alignment with the Clustal series of programs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>3497</fpage>
        <lpage>3500</lpage>
        <pub-id pub-id-type="pmid">12824352</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>Y.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA secondary structure prediction by centroids in a Boltzmann weighted ensemble</article-title>
        <source>RNA</source>
        <year>2005</year>
        <volume>11</volume>
        <fpage>1157</fpage>
        <lpage>1166</lpage>
        <pub-id pub-id-type="pmid">16043502</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>Y.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clustering of RNA secondary structures with application to messenger RNAs</article-title>
        <source>J. Mol. Biol.</source>
        <year>2006</year>
        <volume>359</volume>
        <fpage>554</fpage>
        <lpage>571</lpage>
        <pub-id pub-id-type="pmid">16631786</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Do</surname>
            <given-names>C.B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ProbCons: probabilistic consistency-based multiple sequence alignment</article-title>
        <source>Genome Res.</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>330</fpage>
        <lpage>340</lpage>
        <pub-id pub-id-type="pmid">15687296</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Do</surname>
            <given-names>C.B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CONTRAfold: RNA secondary structure prediction without physics-based models</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>e90</fpage>
        <lpage>e98</lpage>
        <pub-id pub-id-type="pmid">16873527</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Do</surname>
            <given-names>C.B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A max-margin model for efficient simultaneous alignment and folding of RNA sequences</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>i68</fpage>
        <lpage>i76</lpage>
        <pub-id pub-id-type="pmid">18586747</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>S.R.</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>RNA sequence analysis using covariance models</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1994</year>
        <volume>22</volume>
        <fpage>2079</fpage>
        <lpage>2088</lpage>
        <pub-id pub-id-type="pmid">8029015</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>P.P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A benchmark of multiple sequence alignment programs upon structural RNAs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>2433</fpage>
        <lpage>2439</lpage>
        <pub-id pub-id-type="pmid">15860779</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geman</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Geman</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Stochastic relaxation, Gibbs distributions, and the Bayesian restoration of images</article-title>
        <source>IEEE PAMI</source>
        <year>1984</year>
        <volume>6</volume>
        <fpage>721</fpage>
        <lpage>741</lpage>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giegerich</surname>
            <given-names>R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Abstract shapes of RNA</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>4843</fpage>
        <lpage>4851</lpage>
        <pub-id pub-id-type="pmid">15371549</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griffiths-Jones</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rfam: annotating non-coding RNAs in complete genomes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>D121</fpage>
        <lpage>D124</lpage>
        <pub-id pub-id-type="pmid">15608160</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gutell</surname>
            <given-names>R.R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying constraints on the higher-order structure of RNA: continued development and application of comparative sequence analysis methods</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1992</year>
        <volume>20</volume>
        <fpage>5785</fpage>
        <lpage>5795</lpage>
        <pub-id pub-id-type="pmid">1454539</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hamada</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prediction of RNA secondary structure using generalized centroid estimators</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>465</fpage>
        <lpage>473</lpage>
        <pub-id pub-id-type="pmid">19095700</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hamada</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improving the accuracy of predicting secondary structure for aligned RNA sequences</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>393</fpage>
        <lpage>402</lpage>
        <pub-id pub-id-type="pmid">20843778</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>I.L.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast folding and comparison of RNA secondary structures</article-title>
        <source>Monatshefte f. Chemie</source>
        <year>1994</year>
        <volume>125</volume>
        <fpage>167</fpage>
        <lpage>188</lpage>
      </element-citation>
    </ref>
    <ref id="B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>I.L.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Secondary structure prediction for aligned RNA sequences</article-title>
        <source>J. Mol. Biol.</source>
        <year>2002</year>
        <volume>319</volume>
        <fpage>1059</fpage>
        <lpage>1066</lpage>
        <pub-id pub-id-type="pmid">12079347</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>Y.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A graph theoretical approach for predicting common RNA secondary structure motifs including pseudoknots in unaligned sequences</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>1591</fpage>
        <lpage>1602</lpage>
        <pub-id pub-id-type="pmid">14962926</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiryu</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Murlet: a practical multiple alignment tool for structural RNA sequences</article-title>
        <source>Bioinformatics</source>
        <year>2007a</year>
        <volume>23</volume>
        <fpage>1588</fpage>
        <lpage>1598</lpage>
        <pub-id pub-id-type="pmid">17459961</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiryu</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust prediction of consensus secondary structures using averaged base pairing probability matrices</article-title>
        <source>Bioinformatics</source>
        <year>2007b</year>
        <volume>23</volume>
        <fpage>434</fpage>
        <lpage>441</lpage>
        <pub-id pub-id-type="pmid">17182698</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knudsen</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Hein</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>RNA secondary structure prediction using stochastic context-free grammars and evolutionary history</article-title>
        <source>Bioinformatics</source>
        <year>1999</year>
        <volume>15</volume>
        <fpage>446</fpage>
        <lpage>454</lpage>
        <pub-id pub-id-type="pmid">10383470</pub-id>
      </element-citation>
    </ref>
    <ref id="B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lindgreen</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MASTR: multiple alignment and structure prediction of non-coding RNAs using simulated annealing</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>3304</fpage>
        <lpage>3311</lpage>
        <pub-id pub-id-type="pmid">18006551</pub-id>
      </element-citation>
    </ref>
    <ref id="B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J.S.</given-names>
          </name>
        </person-group>
        <article-title>The collapsed Gibbs Sampler in Bayesian computations with applications to a gene regulation problem</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>1994</year>
        <volume>89</volume>
        <fpage>958</fpage>
        <lpage>966</lpage>
      </element-citation>
    </ref>
    <ref id="B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathews</surname>
            <given-names>D.H.</given-names>
          </name>
        </person-group>
        <article-title>Using an RNA secondary structure partition function to determine confidence in base pairs predicted by free energy minimization</article-title>
        <source>RNA</source>
        <year>2004</year>
        <volume>10</volume>
        <fpage>1178</fpage>
        <lpage>1190</lpage>
        <pub-id pub-id-type="pmid">15272118</pub-id>
      </element-citation>
    </ref>
    <ref id="B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathews</surname>
            <given-names>D.H.</given-names>
          </name>
        </person-group>
        <article-title>Revolutions in RNA secondary structure prediction</article-title>
        <source>J. Mol. Biol.</source>
        <year>2006</year>
        <volume>359</volume>
        <fpage>526</fpage>
        <lpage>532</lpage>
        <pub-id pub-id-type="pmid">16500677</pub-id>
      </element-citation>
    </ref>
    <ref id="B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyer</surname>
            <given-names>I.M.</given-names>
          </name>
          <name>
            <surname>Miklos</surname>
            <given-names>I.</given-names>
          </name>
        </person-group>
        <article-title>SimulFold: simultaneously inferring RNA structures including pseudoknots, alignments, and trees using a Bayesian MCMC framework</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e149</fpage>
        <pub-id pub-id-type="pmid">17696604</pub-id>
      </element-citation>
    </ref>
    <ref id="B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nawrocki</surname>
            <given-names>E.P.</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>S.R.</given-names>
          </name>
        </person-group>
        <article-title>Query-dependent banding (QDB) for faster RNA similarity searches</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e56</fpage>
        <pub-id pub-id-type="pmid">17397253</pub-id>
      </element-citation>
    </ref>
    <ref id="B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nawrocki</surname>
            <given-names>E.P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Infernal 1.0: inference of RNA alignments</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1335</fpage>
        <lpage>1337</lpage>
        <pub-id pub-id-type="pmid">19307242</pub-id>
      </element-citation>
    </ref>
    <ref id="B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newberg</surname>
            <given-names>L.A.</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>C.E.</given-names>
          </name>
        </person-group>
        <article-title>Exact calculation of distributions on integers, with application to sequence alignment</article-title>
        <source>J. Comput. Biol.</source>
        <year>2009</year>
        <volume>16</volume>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="pmid">19119992</pub-id>
      </element-citation>
    </ref>
    <ref id="B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sakakibara</surname>
            <given-names>Y.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Stochastic context-free grammers for tRNA modeling</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1994</year>
        <volume>22</volume>
        <fpage>5112</fpage>
        <lpage>5120</lpage>
        <pub-id pub-id-type="pmid">7800507</pub-id>
      </element-citation>
    </ref>
    <ref id="B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sankoff</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Simultaneous solution of the RNA folding, alignment and protosequence problems</article-title>
        <source>SIAM J. Appl. Math.</source>
        <year>1985</year>
        <volume>45</volume>
        <fpage>810</fpage>
        <lpage>825</lpage>
      </element-citation>
    </ref>
    <ref id="B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seemann</surname>
            <given-names>S.E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unifying evolutionary and thermodynamic information for RNA folding of multiple alignments</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>6355</fpage>
        <lpage>6362</lpage>
        <pub-id pub-id-type="pmid">18836192</pub-id>
      </element-citation>
    </ref>
    <ref id="B36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Siebert</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>MARNA: multiple alignment and consensus structure prediction of RNAs based on sequence structure comparisons</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3352</fpage>
        <lpage>3359</lpage>
        <pub-id pub-id-type="pmid">15972285</pub-id>
      </element-citation>
    </ref>
    <ref id="B37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steffen</surname>
            <given-names>P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNAshapes: an integrated RNA analysis package based on abstract shapes</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>500</fpage>
        <lpage>503</lpage>
        <pub-id pub-id-type="pmid">16357029</pub-id>
      </element-citation>
    </ref>
    <ref id="B38">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tabaska</surname>
            <given-names>J.E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An RNA folding method capable of identifying pseudoknots and base triples</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>691</fpage>
        <lpage>699</lpage>
        <pub-id pub-id-type="pmid">9789095</pub-id>
      </element-citation>
    </ref>
    <ref id="B39">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torarinsson</surname>
            <given-names>E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiple structural alignment and clustering of RNA sequences</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>926</fpage>
        <lpage>932</lpage>
        <pub-id pub-id-type="pmid">17324941</pub-id>
      </element-citation>
    </ref>
    <ref id="B40">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Webb</surname>
            <given-names>B.M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BALSA: Bayesian algorithm for local sequence alignment</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>1268</fpage>
        <lpage>1277</lpage>
        <pub-id pub-id-type="pmid">11861921</pub-id>
      </element-citation>
    </ref>
    <ref id="B41">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Webb-Robertson</surname>
            <given-names>B.M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Measuring global credibility with application to local sequence alignment</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>e1000077</fpage>
        <pub-id pub-id-type="pmid">18464927</pub-id>
      </element-citation>
    </ref>
    <ref id="B42">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Will</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inferring noncoding RNA families and classes by means of genome-scale structure-based clustering</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e65</fpage>
        <pub-id pub-id-type="pmid">17432929</pub-id>
      </element-citation>
    </ref>
    <ref id="B43">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xing</surname>
            <given-names>X.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA Sampler: a new sampling based algorithm for common RNA secondary structure prediction and structural alignment</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>1883</fpage>
        <lpage>1891</lpage>
        <pub-id pub-id-type="pmid">17537756</pub-id>
      </element-citation>
    </ref>
    <ref id="B44">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yao</surname>
            <given-names>Z.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CMfinder - a covariance model based RNA motif finding algorithm</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>445</fpage>
        <lpage>452</lpage>
        <pub-id pub-id-type="pmid">16357030</pub-id>
      </element-citation>
    </ref>
    <ref id="B45">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zuker</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Stiegler</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Optimal computer folding of large RNA sequences using thermodynamics and auxiliary information</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1981</year>
        <volume>109</volume>
        <fpage>133</fpage>
        <lpage>148</lpage>
        <pub-id pub-id-type="pmid">6163133</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
