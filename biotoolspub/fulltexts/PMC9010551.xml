<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_CSBJ1465 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEga1 jpg ?>
<?FILEmmc1 pdf ?>
<?FILEmmc2 pdf ?>
<?FILEmmc3 xlsx ?>
<?FILEmmc4 pdf ?>
<?FILEmmc5 xlsx ?>
<?FILEmmc6 xlsx ?>
<?FILEsi1 svg ?>
<?FILEsi2 svg ?>
<?FILEsi3 svg ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Comput Struct Biotechnol J</journal-id>
    <journal-id journal-id-type="iso-abbrev">Comput Struct Biotechnol J</journal-id>
    <journal-title-group>
      <journal-title>Computational and Structural Biotechnology Journal</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2001-0370</issn>
    <publisher>
      <publisher-name>Research Network of Computational and Structural Biotechnology</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9010551</article-id>
    <article-id pub-id-type="pii">S2001-0370(22)00111-8</article-id>
    <article-id pub-id-type="doi">10.1016/j.csbj.2022.03.036</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SRIQ clustering: A fusion of Random Forest, QT clustering, and KNN concepts</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au005">
        <name>
          <surname>Karlström</surname>
          <given-names>Jacob</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author" id="au010">
        <name>
          <surname>Aine</surname>
          <given-names>Mattias</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author" id="au015">
        <name>
          <surname>Staaf</surname>
          <given-names>Johan</given-names>
        </name>
        <email>johan.staaf@med.lu.se</email>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
      <contrib contrib-type="author" id="au020">
        <name>
          <surname>Veerla</surname>
          <given-names>Srinivas</given-names>
        </name>
        <email>srinivas.veerla@med.lu.se</email>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
      <aff id="af005">Division of Oncology, Department of Clinical Sciences Lund, Lund University, Medicon Village, SE-22381 Lund, Sweden</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>⁎</label>Corresponding authors. <email>johan.staaf@med.lu.se</email><email>srinivas.veerla@med.lu.se</email></corresp>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>04</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <volume>20</volume>
    <fpage>1567</fpage>
    <lpage>1579</lpage>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>21</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>3</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 The Author(s)</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).</license-p>
      </license>
    </permissions>
    <abstract abstract-type="graphical" id="ab005">
      <title>Graphical abstract</title>
      <fig id="f0030" position="anchor">
        <graphic xlink:href="ga1"/>
      </fig>
    </abstract>
    <abstract id="ab010">
      <p>Gene expression profiling together with unsupervised analysis methods, typically clustering methods, has been used extensively in cancer research to unravel, e.g., new molecular subtypes that hold promise of disease refinement that may ultimately benefit patients. However, many of the commonly used methods require a prespecified number of clusters to extract and frequently require some type of feature pre-selection, e.g. variance filtering. This introduces subjectivity to the process of cluster discovery and the definition of putative novel tumor subtypes. Here, we introduce SRIQ, a novel unsupervised clustering method that could circumvent some of the issues in commonly used unsupervised analysis methods. SRIQ incorporates concepts from random forest machine learning as well as quality threshold- and k-nearest neighbor clustering. It is implemented as a Java and Python pipeline including data pre-processing, differential expression analysis, and pathway analysis. Using 434 lung adenocarcinomas profiled by RNA sequencing, we demonstrate the technical reproducibility of SRIQ and benchmark its performance compared to the commonly used consensus clustering method. Based on differential gene expression analysis and auxiliary molecular data we show that SRIQ can define new tumor subsets that appear biologically relevant and consistent compared and that these new subgroups seem to refine existing transcriptional subtypes that were defined using consensus clustering. Together, this provides support that SRIQ may be a useful new tool for unsupervised analysis of gene expression data from human malignancies.</p>
    </abstract>
    <kwd-group id="kg005">
      <title>Keywords</title>
      <kwd>Lung adenocarcinoma</kwd>
      <kwd>Clustering</kwd>
      <kwd>Molecular subtypes</kwd>
      <kwd>Gene expression</kwd>
      <kwd>Random Forest</kwd>
      <kwd>QT clustering</kwd>
      <kwd>KNN</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="s0005">
    <label>1</label>
    <title>Introduction</title>
    <p id="p0005">Cancer is the second leading cause of death globally and estimated to account for 9.6 million deaths in 2018 <xref rid="b0005" ref-type="bibr">[1]</xref>. A hallmark of cancer is the vast heterogeneity of the disease, between different anatomical sites, between different patients, and within individual tumors. Cancer outcome is gradually improving through better diagnostics, clinical management, and novel therapeutics. To further refine patient prognostication and treatment prediction new tools/methods are needed beyond existing clinical markers, which to a large extent are still based on morphological or single marker analyses of tumor tissue. One molecular method that has shown promise in, e.g., breast cancer is gene expression profiling, where some of the first reported gene signatures now exist as commercial products with approval for use in the clinical setting. In cancer research in general, gene expression profiling has been used extensively to unravel new molecular subtypes as well as to define prognostic and/or treatment predictive gene signatures. Commonly, different unsupervised analysis methods for clustering samples have often been used for subtype discovery, ranging from the simplest form of hierarchical clustering (e.g., defining the original breast cancer subtypes <xref rid="b0010" ref-type="bibr">[2]</xref>) to more refined methods including e.g. bootstrapping <xref rid="b0015" ref-type="bibr">[3]</xref>. One of the most commonly used approaches represent variations of consensus/bootstrap clustering in which cluster solutions are arrived at after a large number of repeated clustering loops that reduce the impact of outliers thereby yielding more robust results. A limitation of consensus/bootstrap clustering is the requirement of a predefined parameter, K, for the number of clusters to be defined. Even though there are means to gauge the optimal K <xref rid="b0020" ref-type="bibr">[4]</xref>, <xref rid="b0025" ref-type="bibr">[5]</xref>, there is no absolute way of knowing the true number of biological entities and evaluation of clustering results therefore requires in-depth knowledge of the cohort and tumor type in question. In contrast, density based clustering algorithms, e.g., Quality Threshold (QT) clustering <xref rid="b0030" ref-type="bibr">[6]</xref> and DBSCAN (Density-Based Spatial Clustering of Applications with Noise) <xref rid="b0035" ref-type="bibr">[7]</xref> find clusters without a prior K value, but are limited in the case of high dimensional data <xref rid="b0040" ref-type="bibr">[8]</xref>. Moreover, clustering methods for gene expression data may often restrict the number of input features (genes) for different reasons, which may constrain or make the results dependent on the selected feature set. It is also customary to use all available cases (tumors) for clustering. Even though including a large number of cases increases the clustering efficiency and allows for the discovery of less common tumor phenotypes, it frequently also introduces “fuzzy” borders between the major subgroups as all samples are given equal weighting in the clustering. Traditional clustering methods also do not provide a means of defining core/prototypical cases and due to the issues discussed above, are sensitive to the relative sample composition of the analyzed tumor cohort.</p>
    <p id="p0010">It is well known that distance values of high dimensional data become meaningless because every observation in a dataset is equidistant from all the others, which is famously called the curse of dimensionality <xref rid="b0045" ref-type="bibr">[9]</xref>. As a result, the clustering process may lead to overfitting and result in unstable clusters. Furthermore, for a high dimensional dataset, the single squared distance matrix values may be highly influenced by the outlier features <xref rid="b0050" ref-type="bibr">[10]</xref>, <xref rid="b0055" ref-type="bibr">[11]</xref>, <xref rid="b0060" ref-type="bibr">[12]</xref>. To reduce the bias resulting from outliers one can use the Jackknife method which calculates the distance value, e.g., a correlation coefficient value (r) between two samples by leaving one feature out at a time for which the maximum of r values is then taken as a final distance value <xref rid="b0065" ref-type="bibr">[13]</xref>. This procedure is often computationally and memory intensive for large datasets. To overcome the computational issue, the number of features may be reduced by using different filtering methods, e.g. a variance filter, but this may lead to reduced information content. In the present investigation we aimed to develop, benchmark, and evaluate a novel clustering approach termed systematic random forest integration to quality threshold (QT) clustering, SRIQ, which could circumvent some of the issues in unsupervised clustering analysis of tumor gene expression data (<xref rid="f0005" ref-type="fig">Fig. 1</xref>). SRIQ incorporates concepts from Random Forest machine learning (bagging and aggregation) <xref rid="b0070" ref-type="bibr">[14]</xref> to avoid the restriction on the number of input features, as this concept is known for handling large datasets efficiently <xref rid="b0070" ref-type="bibr">[14]</xref>, <xref rid="b0075" ref-type="bibr">[15]</xref>, <xref rid="b0080" ref-type="bibr">[16]</xref> and can reduce the feature dimensionality in a meaningful way. This concept produces squared distance matrices from randomly extracted features subsets and aggregating the results produces robust estimates of distance values, which are not highly affected by the outlier features <xref rid="b0075" ref-type="bibr">[15]</xref>, <xref rid="b0080" ref-type="bibr">[16]</xref>. In addition to this, bagging can also reduce the high variance caused due to missing values in the high dimensional data. Next, QT clustering is used to form “core clusters” (<xref rid="f0005" ref-type="fig">Fig. 1</xref>A) while avoiding the requirement for a prespecified number of clusters (K) to be discovered, and finally k-nearest neighbor (KNN) is used to expand core clusters in order to assign subgroup calls to lower confidence or more heterogenous samples (<xref rid="f0005" ref-type="fig">Fig. 1</xref>B).<fig id="f0005"><label>Fig. 1</label><caption><p>SRIQ framework and study outline. (<bold>A</bold>) Concept of core and spiral clusters. A blue dot represents a sample, red circles define different core clusters of samples and green circles define different spiral clusters. (<bold>B</bold>) SRIQ framework. (<bold>C</bold>) Study outline. LUAD: lung adenocarcinoma. DGE: differential gene expression analysis. (For interpretation of the references to color in this figure legend, the reader is referred to the web version of this article.)</p></caption><graphic xlink:href="gr1"/></fig></p>
    <p id="p0015">This fusion of concepts makes it possible to select the number of tumor classes based on stability and cluster tightness, and the approach identifies “core clusters” composed of typical samples which are representative of the major biological entities while being less influenced by the entirety of statistical signals present in the data set. For samples falling outside core cluster entities, KNN is used to assign class labels to the remaining samples/cases using core cluster centroids. KNN-expanded core clusters are referred to as “spiral clusters” and provide a means to assign cluster identities to the all cohort samples (<xref rid="f0005" ref-type="fig">Fig. 1</xref>A). To assess cluster quality and stability the entire clustering process is iterated, and a pairwise sample co-occurrence matrix is used to evaluate the stability of core and spiral clusters.</p>
    <p id="p0020">To provide a context for evaluating the usefulness of SRIQ in unsupervised analysis of high-dimensional tumor data (whole transcriptome RNA sequencing data) we chose lung adenocarcinoma (LUAD) as a model. LUAD is the most frequent histological type of non-small cell lung cancer (NSCLC) <xref rid="b0085" ref-type="bibr">[17]</xref>, and a highly lethal disease mainly due to late diagnosis. While treatment options for advanced stage LUAD have greatly improved during the last decades, treatments are still often palliative due to nearly inevitable treatment resistance over time. For surgically treated patients, i.e., patients with lower stage tumors treated with a curative intent, there is still a high-risk of metastatic relapse even for tumors of the lowest stage <xref rid="b0090" ref-type="bibr">[18]</xref>. Consequently, additional prognostic and predictive tools are needed to improve patient outcome. Surgically resected LUAD have been intensively studied using different high-throughput molecular profiling techniques, including gene expression analysis. The latter technique has been used extensively to derive, e.g., prognostic gene signatures as well as transcriptional LUAD subtypes <xref rid="b0095" ref-type="bibr">[19]</xref>, <xref rid="b0100" ref-type="bibr">[20]</xref>, <xref rid="b0105" ref-type="bibr">[21]</xref>, <xref rid="b0110" ref-type="bibr">[22]</xref>, <xref rid="b0115" ref-type="bibr">[23]</xref>, <xref rid="b0120" ref-type="bibr">[24]</xref>, <xref rid="b0125" ref-type="bibr">[25]</xref>. Concerning the latter, three transcriptional subtypes termed the terminal respiratory unit (TRU), the proximal-inflammatory (PI), and the proximal-proliferative (PP) subtypes have been proposed in LUAD based on consensus cluster analysis by The Cancer Genome Atlas (TCGA) consortium <xref rid="b0095" ref-type="bibr">[19]</xref>, <xref rid="b0110" ref-type="bibr">[22]</xref>, <xref rid="b0130" ref-type="bibr">[26]</xref>. While these three transcriptional subtypes have been associated with different clinicopathological and molecular features as well as patient outcome, there is still significant heterogeneity within the subtypes and recent studies have proposed other subtyping schemes that intersect the TRU/PI/PP classification <xref rid="b0135" ref-type="bibr">[27]</xref>. The lack of transcriptional subtype consensus in LUAD indicates that current subtypes may need to be refined through, e.g., analyses of larger more representative cohorts, and/or new analysis methods. As such, LUAD represents a suitable context for assessing how a novel unsupervised analysis method like SRIQ performs in relation to preexisting molecular classifications (TRU/PI/PP) and existing methods (e.g., consensus clustering), and whether it can extract novel biology not currently captured in the existing subtyping schemes.</p>
    <p id="p0025">Based on a well characterized cohort of 434 surgically resected lung adenocarcinoma specimens from the TCGA consortium profiled by RNA sequencing we demonstrate the technical reproducibility of SRIQ and its performance compared to consensus clustering. More interestingly, based on differential gene expression analysis and additional molecular data we demonstrate that SRIQ can define new tumor subsets that appear biologically relevant and consistent in relation to consensus clustering, and that these new subgroups also refine existing transcriptional subtype classifications. Together, this provides support that SRIQ may be a useful new tool for unsupervised analysis of gene expression data from human malignancies.</p>
  </sec>
  <sec id="s0010">
    <label>2</label>
    <title>Materials &amp; methods</title>
    <sec id="s0015">
      <label>2.1</label>
      <title>SRIQ</title>
      <p id="p0030">The principle of the SRIQ framework is illustrated in <xref rid="f0005" ref-type="fig">Fig. 1</xref>B. In brief, we repeatedly (default, t = 10000 number of times) randomly select a given number of genes, termed bag size (default, BagSize = <inline-formula><mml:math id="M1" altimg="si1.svg"><mml:mrow><mml:msqrt><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, n = total genes), from a gene expression matrix and produce between-sample distance matrices (Euclidean or Pearson distance). Next, the average of all random distance matrices is calculated. The QT clustering method <xref rid="b0030" ref-type="bibr">[6]</xref> is applied on the aggregate matrix using a sliding window of cluster diameter (d), i.e., cluster tightness, ranging from 0 to 1 with an increment interval of 0.01 and a minimum size of the cluster (default, cs=<inline-formula><mml:math id="M2" altimg="si2.svg"><mml:mrow><mml:msqrt><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, s = total samples). At each d cut-off, a distinct number of core cluster solutions are produced without a requirement of a specified K. Subsequently, the KNN method is used to identify nearest neighbors to these core clusters from the remaining samples in the cohort using the core cluster centroids (K = 1 as default). As a result, each core cluster is expanded into what we term a “spiral cluster” (<xref rid="f0005" ref-type="fig">Fig. 1</xref>A). To determine the quality and stability of a cluster solution the above procedure is repeated (default, r = 10). For each run and diameter, a co-occurrence matrix for each cluster solution (K<sub>x</sub>) is generated. Next, the average of the co-occurrence matrix (S) is calculated and converted to a distance matrix (1-S). This final distance matrix for each diameter is subjected to the QT clustering process for a series of quality or stability diameter (QSD), ranging from 0 to 1 with an increment interval of 0.05. This process is stopped at a diameter where it identifies cluster solution (K<sub>x</sub>). The resulting clusters are considered final. Subsequently, to calculate quality or stability score (QSS) for cluster solution (K<sub>x</sub>) the following formulae is used.<disp-formula id="e0005"><label>(1)</label><mml:math id="M3" altimg="si3.svg"><mml:mrow><mml:mi mathvariant="normal">Q</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi mathvariant="normal">r</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">-</mml:mo><mml:mi>Q</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p id="p0035">The QSS represents the stability/consensus score of sample pairwise cooccurrence among the r repetitive clustering analyses. In this process, some samples may be excluded from being assigned to a cluster, based on alternating cluster associations (instability). We recommend selecting a cluster solution (K<sub>x</sub>) with a low cluster diameter, a high (re-)occurrence across repetitions, and a high QSS. In short, the SRIQ framework includes eight steps as outlined in <xref rid="f0005" ref-type="fig">Fig. 1</xref>B: 1) Retrieval of random subsets of the expression matrix using the defined or default BagSize parameter value, 2) calculation of distance matrices for each random subset, 3) calculation of the average across all distance matrices, 4) using step 3 results as the input to the QT clustering method to form core clusters with defined or default parameter values, 5) application of KNN to the core clusters to form spiral clusters, 6) repeating steps 1–5, where for each repetition a co-occurrence matrix is generated for each QSD, 7) calculation of the average co-occurrence matrices from all step 4 (core clusters) results or step 5 (spiral clusters) results for a specific density d, and 8) and applying QT clustering to step 7 results to obtain the final stable core and spiral clusters. SRIQ steps 6–8 are further graphically visualized in the <xref rid="s0150" ref-type="sec">Supplementary Methods File</xref>.</p>
      <p id="p0040">The step-by-step pseudocode for SRIQ is provided in the <xref rid="s0150" ref-type="sec">Supplementary Methods File</xref>. The SRIQ framework is implemented using the JAVA programming language and utilizes parallel processing wherever repeated calculations are performed during the clustering process. A complete analysis pipeline, including data preprocessing, SRIQ, clustering validation (Silhouette) scores, differential gene expression analysis, and gene ontology (GO) enrichment analysis, written in Jupyter notebook is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/StaafLab/SRIQ" id="ir005">https://github.com/StaafLab/SRIQ</ext-link>. In addition to QSS validity/quality scores, the SRIQ pipeline also outputs Silhouette scores that can be used to decide on cluster solutions.</p>
    </sec>
    <sec id="s0020">
      <label>2.2</label>
      <title>Patient cohorts</title>
      <p id="p0045">LUAD gene expression data (n = 60438 transcripts) for 434 cases used in this study was generated through RNA sequencing (RNA-seq) by the TCGA consortium. Expression data was obtained from the GDC portal (<ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov/" id="ir010">https://portal.gdc.cancer.gov/</ext-link>) in FPKM format. Additional clinicopathological data, molecular data, and molecular classifications were obtained from <ext-link ext-link-type="uri" xlink:href="https://gdc.cancer.gov/about-data/publications/panimmune" id="ir015">https://gdc.cancer.gov/about-data/publications/panimmune</ext-link>
<xref rid="b0140" ref-type="bibr">[28]</xref>, including immune-related classifications from Cibersort <xref rid="b0145" ref-type="bibr">[29]</xref>. Clinicopathological characteristics of the 434-patient cohort is detailed in <xref rid="s0150" ref-type="sec">Supplementary Table 1</xref>.</p>
    </sec>
    <sec id="s0025">
      <label>2.3</label>
      <title>Gene expression data preprocessing</title>
      <p id="p0050">Two gene expression datasets were generated from the original RNA-seq data: i) a FPKM expression matrix, from which the median, variance, and log fold change were calculated, and ii) a median centered log2 transformed FPKM (all values below 1 set to 1) matrix, of the top 25,785 most varying transcripts (obtained by removing all transcripts consisting solely of 0′s and then removing 65% least varying genes across all samples), used for SRIQ clustering, differential gene expression analysis, and biological metagene analysis. The removal of low varying genes was performed to reduce the sparsity of the gene expression matrix.</p>
    </sec>
    <sec id="s0030">
      <label>2.4</label>
      <title>Consensus clustering</title>
      <p id="p0055">As consensus clustering is frequently used to derive molecular subtypes, including LUAD, it was chosen as a benchmark method for SRIQ. Consensus clustering was performed using hierarchical clustering with Pearson correlation as distance metric and ward.D linkage. Number of repetitions were set to 2000 and a resampling schedule of 0.7 was used for both genes and samples. Cluster solutions between 3 and 7 were collected.</p>
    </sec>
    <sec id="s0035">
      <label>2.5</label>
      <title>Clustering comparison metrics</title>
      <p id="p0060">We created a metric called Pair Similarity score (PS, not part of SRIQ) to compare similarity and diversity between the SRIQ and consensus clustering solutions. This was done by first creating a binary pairwise similarity matrix and then applying the Jaccard index method to it.</p>
    </sec>
    <sec id="s0040">
      <label>2.6</label>
      <title>Lung adenocarcinoma TCGA molecular subtype classification</title>
      <p id="p0065">Classification of the LUAD data according to the proposed gene expression subtypes by TCGA <xref rid="b0110" ref-type="bibr">[22]</xref>: terminal respiratory unit (TRU), proximal inflammatory (PI), and proximal proliferative (PP) was performed using centroid classification as originally outlined by Wilkerson et al. <xref rid="b0095" ref-type="bibr">[19]</xref> for the subtypes, using the Wilkerson et al. reported centroid genes matching the TCGA RNA-seq gene set. For each sample the Pearson correlation to each centroid (subtype) was calculated. The subtype with the highest Pearson correlation was assigned to the sample.</p>
    </sec>
    <sec id="s0045">
      <label>2.7</label>
      <title>Differentially expressed genes, biological metagenes, and GO enrichment analysis</title>
      <p id="p0070">Differentially expressed genes between SRIQ clusters (one vs rest approach) were obtained by implementation of Significance Analysis of Microarray (SAM) <xref rid="b0150" ref-type="bibr">[30]</xref> yielding up- and down-regulated genes. For the framework analysis we used SAM to obtain differentially expressed genes with significance parameters, FDR q-value&lt;=5 and a fold change fc&gt;=2. Metagene scores for six metagenes proposed to represent biological processes in lung cancer based on gene network analysis <xref rid="b0155" ref-type="bibr">[31]</xref> were calculated from expression data for each sample. The metagene score of each sample was calculated as the mean expression of all genes associated with a specific metagene. GO enrichment analysis of differentially expressed genes was performed using the enrichR API endpoint <xref rid="b0160" ref-type="bibr">[32]</xref>, <xref rid="b0165" ref-type="bibr">[33]</xref>, <xref rid="b0170" ref-type="bibr">[34]</xref>.</p>
    </sec>
    <sec id="s0050">
      <label>2.8</label>
      <title>SRIQ computation time</title>
      <p id="p0075">Computation times for SRIQ in datasets of different sizes and technological platforms (n = 434–3520), including TCGA-LUAD, are provided in <xref rid="s0150" ref-type="sec">Supplementary Table 2</xref>.</p>
    </sec>
  </sec>
  <sec id="s0055">
    <label>3</label>
    <title>Results</title>
    <p id="p0080">The outline of the study is shown in <xref rid="f0005" ref-type="fig">Fig. 1</xref>C incorporating two main branches of analyses: i) technical reproducibility and benchmarking, and ii) assessment of molecular features of derived SRIQ clusters.</p>
    <sec id="s0060">
      <label>3.1</label>
      <title>Technical reproducibility and benchmarking of SRIQ</title>
      <sec id="s0065">
        <label>3.1.1</label>
        <title>SRIQ clustering of 434 LUAD cases</title>
        <p id="p0085">Application of SRIQ to 434 LUAD cases with expression data for 25,785 transcripts resulted in multiple potential clustering solutions using a BagSize parameter value of 1200 and 10,000 permutations (<xref rid="f0010" ref-type="fig">Fig. 2</xref>A, <xref rid="s0150" ref-type="sec">Supplementary Table 1</xref>). Of the 434 samples, 382 were classified as core or spiral samples and 52 samples were considered unstable, i.e., alternating between clusters during repetitions. Of the observed cluster solutions, three were of particular interest based on recurrence of cluster solution, occurrence across different diameter solutions, and stability throughout the iterations: i) a three cluster (K3), ii) a five cluster (K5) and iii) a six cluster solution (K6) at cluster diameter cut off ranges of 0.58, 0.60, and 0.63, respectively. Notably, the K6 solution occurred for several diameter cut offs (0.60–0.64) compared to the K3 (0.58) and K5 (0.6, 0.61) solutions (<xref rid="f0010" ref-type="fig">Fig. 2</xref>A). At diameter cut-off 0.63, the K6 solution had 100% recurrence across all 10 iterations with a stability score (QSS) of 60% (QSS represents the percentage of seeing sample-sample pairs in the same cluster when repeating the entire clustering analysis). Core cluster samples for this solution were also clearly separated from each other based on UMAP analysis (<xref rid="f0015" ref-type="fig">Fig. 3</xref>A) and spiral clusters also showed high recurrence and stability across iterations (<xref rid="s0150" ref-type="sec">Supplementary Fig. 1</xref>A).<fig id="f0010"><label>Fig. 2</label><caption><p>SRIQ analyses of 434 TCGA LUAD cases and stability analyses. (<bold>A</bold>) SRIQ summary plot using 10,000 permutations and a bag size parameter value of 1200. The height of the bar indicates the % of times the cluster solution has been detected across 10 iterations. The fraction of coloring in the upper bar chart represents the stability score (QSS) of the respective cluster solution as described in the Material and Methods section. The fraction of coloring in the lower bar chart represents the percentage of samples included for corresponding cluster solution above. Only solutions found &gt;2 times (20%) are shown in the panels. (<bold>B</bold>) Pair similarity when varying bag size using the 1200 bag size run as comparison for different K solutions using all samples. (<bold>C</bold>) Sample overlap between SRIQ runs when removing random samples from the original cohort, using 100% of the tumors and a bag size of 1200 as reference solution. E.g., in the panel, 90% corresponds to SRIQ analysis using 90% of all LUAD samples. Samples are ordered according to the 100% solution and colored according to the cluster number set by the 100% solution (irrespective of core/spiral assignment). SRIQ cluster identifiers (colors) can change between runs, thus samples in a 100% cluster may have different cluster assignments in a lower fraction analysis. (<bold>D</bold>) Sample agreement across clusters for the different fraction sizes in C versus the 100% cohort cluster solution as reference, irrespective of core/spiral assignment. Black line corresponds to the agreement (%) from a sample confusion matrix of all six SRIQ clusters between the 100% cohort versus each tested fraction size. To calculate an agreement, we selected for each 100% cluster the corresponding largest cluster in the lower size cohort to be representative. The agreement was then calculated by dividing the number of samples in agreement with the total number of cases from the confusion matrix. Red line corresponds to the same calculation as for the black line, however omitting samples from the smallest SRIQ cluster 100% solution, cluster 6, entirely from all calculations. (For interpretation of the references to color in this figure legend, the reader is referred to the web version of this article.)</p></caption><graphic xlink:href="gr2"/></fig><fig id="f0015"><label>Fig. 3</label><caption><p>Characterization of SRIQ K6 solution with respect to TCGA gene expression subtypes and expression of biological metagenes. (<bold>A</bold>) UMAP expression analysis of SRIQ K6 core samples using a bag size of 1200 and a cluster diameter of 0.63 as cut-off in SRIQ for cluster definition. Only the two first UMAP components are shown. (<bold>B</bold>) TCGA gene expression subtype (TRU/PI/PP) distribution in SRIQ K6 core cluster samples (top panel) and spiral samples (lower panel). (<bold>C</bold>) TCGA gene expression subtype (TRU:left, PI:center, PP:right) Pearson centroid correlation values for SRIQ K6 core cluster samples (blue) and spiral samples (orange). (<bold>D</bold>) Expression scores of six biological metagenes versus SRIQ K6 core (blue) and spiral samples (orange). (For interpretation of the references to color in this figure legend, the reader is referred to the web version of this article.)</p></caption><graphic xlink:href="gr3"/></fig></p>
        <p id="p0090">As seen in <xref rid="f0010" ref-type="fig">Fig. 2</xref>A, SRIQ may generate different cluster solutions (e.g., K2, K3, etc.) at the same diameter cut-off, but also similar solutions (e.g. K6) at different diameter cut-offs. For the former, different cluster solutions at the same diameter cut-off often differ by one cluster (e.g. K2 and K3) (<xref rid="f0010" ref-type="fig">Fig. 2</xref>A). The reason for this is that one cluster from a lower solution may be divided into two new clusters that do not need to consist of all of the samples of the original cluster, although they usually display some similarity as exemplified in <xref rid="s0150" ref-type="sec">Supplementary Fig. 1</xref>B. Furthermore, the number of samples in clusters, as well as number of clusters, typically increases with increased diameter cut-off (<xref rid="f0010" ref-type="fig">Fig. 2</xref>A). When both cut-off diameter and the number of samples increases, but K remains the same, three scenarios could happen: i) the existing clusters are expanded upon, ii) one cluster might be split into two new valid clusters and another cluster omitted, and iii) a cluster may be omitted in support of another cluster (<xref rid="s0150" ref-type="sec">Supplementary Fig. 1</xref>C). For the purpose of technical reproducibility analysis and algorithm benchmarking we chose to focus onwards on the K6 cluster solution with a cut-off of 0.63, as it showed high stability in both core and spiral cluster solutions (<xref rid="f0010" ref-type="fig">Fig. 2</xref>A and <xref rid="s0150" ref-type="sec">Supplementary Fig. 1</xref>A), meanwhile appearing at a larger span of cut off diameters than, e.g., a K5 solution. Full data for the selected K6 solution is provided in <xref rid="s0150" ref-type="sec">Supplementary Table 1</xref>. Silhouette analysis performed revealed that the selected K6 solution median silhouette score was 0.15, with only a few samples being confounded in other cluster centers (<xref rid="s0150" ref-type="sec">Supplementary Fig. 1</xref>D).</p>
      </sec>
      <sec id="s0070">
        <label>3.1.2</label>
        <title>Assessment of SRIQ stability for key parameters</title>
        <p id="p0095">Key parameter alterations in clustering algorithms, as well as modifications in cohort composition, can infer dramatic differences in cluster number and composition <xref rid="b0175" ref-type="bibr">[35]</xref>. To assess the impact of such alterations for SRIQ we focused on cluster alterations inferred by modifications to the BagSize parameter (a key SRIQ parameter representing the number of randomly samples features, i.e., genes, used in each permutation), and modifications inferred by changes in sample numbers (i.e., cohort size/composition).</p>
        <p id="p0100">For the BagSize parameter evaluation we used the results from <xref rid="f0010" ref-type="fig">Fig. 2</xref>A as reference (BagSize = 1200) and then performed new runs in which the BagSize value was stepwise reduced from 1100 down to 300 (<xref rid="f0010" ref-type="fig">Fig. 2</xref>B). Focusing on three different cluster solutions (K3, K5, and K6) we observed that all solutions showed &gt;80% pairwise similarity to the original run, with the K3 solution showing nearly 100% similarity for each run. Both K5 and K6 showed around 10% lower pairwise similarity, with the K6 solution being more stable than the K5 solution. Furthermore, for the K5 solution the pairwise similarity started to drop at a BagSize of 500 (<xref rid="f0010" ref-type="fig">Fig. 2</xref>B).</p>
        <p id="p0105">Next, we changed the sample size for SRIQ by randomly removing an increasing fraction of the original samples, while keeping other parameters intact. As shown in <xref rid="f0010" ref-type="fig">Fig. 2</xref>C, apparent overlap between cluster assignments are seen for several clusters even when removing a substantial portion of the total sample number. This is further illustrated in <xref rid="f0010" ref-type="fig">Fig. 2</xref>D by calculation of classification agreement. As seen in <xref rid="f0010" ref-type="fig">Fig. 2</xref>C-D, small clusters (e.g. SRIQ cluster 6) have a more rapid deterioration in cluster overlaps with a negative effect on overall agreement (<xref rid="f0010" ref-type="fig">Fig. 2</xref>D) in smaller cohorts of randomly selected cases compared to the original solution.</p>
      </sec>
      <sec id="s0075">
        <label>3.1.3</label>
        <title>Core and spiral cluster samples show similar transcriptional characteristics</title>
        <p id="p0110">A feature of SRIQ is the calling of core and spiral samples, forming core and spiral clusters, respectively (<xref rid="f0005" ref-type="fig">Fig. 1</xref>A). Conceptually, it would be expected that spiral samples associated with a specific cluster should have similar, albeit necessarily not as distinct, characteristics as the core samples defining the base cluster. To test this hypothesis, we split each cluster from the K6 solution with cut-off 0.63 (shown in <xref rid="f0010" ref-type="fig">Fig. 2</xref>A) into core samples and spiral samples and compared these groups with respect to TCGA LUAD gene expression subtype (TRU/PI/PP), actual TCGA subtype centroid correlation values, as well as expression of six different metagenes representing biological processes previously reported in lung cancer <xref rid="b0155" ref-type="bibr">[31]</xref>.</p>
        <p id="p0115">As shown in <xref rid="f0015" ref-type="fig">Fig. 3</xref>B and C, analysis of subtype classification both with respect to discrete subtype status (TRU/PI/PP) and actual subtype Pearson centroid correlation values showed that spiral samples have similar patterns as the core cluster samples. Notably, with the exception of clusters 1 and 2 in the K6 solution, both core and spiral samples within specific clusters are predominantly comprised of a single molecular subtype. Cluster 1 in the K6 solution comprises a mix of TRU and PI cases, whereas cluster 2 comprises a mix of TRU and PP cases. The resemblance of spiral samples with respective core samples within a cluster was further supported when analyzing expression of the six biological metagenes (<xref rid="f0015" ref-type="fig">Fig. 3</xref>D). Kruskal-Wallis test revealed that all of the six metagene profiles were statistically significant for core cluster samples (p &lt; 0.001) with each cluster showing a distinct metagene expression difference across the six genes. Adding spiral observations still maintains significant expression profiles (p &lt; 0.05), however they become less distinct.</p>
      </sec>
      <sec id="s0080">
        <label>3.1.4</label>
        <title>Comparison of SRIQ to consensus clustering</title>
        <p id="p0120">To benchmark SRIQ versus another unsupervised algorithm used to derive gene expression subtypes we compared SRIQ clustering to consensus clustering of the same data, focusing on two stable SRIQ solutions, K3 and K6 shown originally in <xref rid="f0010" ref-type="fig">Fig. 2</xref>A. A general difference between SRIQ and consensus clustering is that SRIQ can use potentially all expression data (through bagging), whereas prefiltering, e.g. based on expression variance, is commonly used in consensus clustering to reduce the influence of for example non-informative genes and lower the computational requirements. In the SRIQ analysis for this study we did remove non-expressed transcripts across samples, as well as a set of transcripts with very low variation. Still, &gt;25000 transcripts were retained and used for the SRIQ analysis.</p>
        <p id="p0125">In a first comparison we noted that the lower number of genes used for consensus clustering, the more dissimilar the cluster results were to SRIQ. The K3 solutions appear relative similar between the two methods when choosing a feature set &gt; 6000 genes for consensus clustering (see, e.g., <xref rid="f0020" ref-type="fig">Fig. 4</xref>A and <xref rid="s0150" ref-type="sec">Supplementary Fig. 2</xref>A). For the K6 cluster solution, the two methods differed from each other irrespective of the number of features used in consensus clustering, with &lt;60% similarity for any cluster (<xref rid="s0150" ref-type="sec">Supplementary Fig. 2</xref>B and Fig. 4B). As exemplified in <xref rid="f0020" ref-type="fig">Fig. 4</xref>B, cluster 1 in the K6 consensus cluster analysis was differentiated by SRIQ into cluster 1 and 3 mainly, whereas consensus cluster 6 was not matching any SRIQ cluster specifically. In summary, as expected the two methods show agreement, but also differences for larger K solutions. To evaluate the biological relevance of the respective solutions more in depth, we proceeded to examine the transcriptional and molecular properties of the solutions.<fig id="f0020"><label>Fig. 4</label><caption><p>Comparison of SRIQ to consensus clustering, and refinement of TCGA LUAD molecular subtypes. (<bold>A</bold>) Comparison of the SRIQ K3 (irrespective of core/spiral assignment) and consensus cluster 3 group solutions. First number in each tile is the percentage of common samples and the number within brackets the sum of samples present in both clusters. Consensus clustering was performed using hierarchical clustering, ward's linkage, Pearson correlation, 2000 iterations and 70% resampling for both items (samples) and features (genes) as key parameters, whereas SRIQ was run as described in <xref rid="f0010" ref-type="fig">Fig. 2</xref>A. (<bold>B</bold>) Comparison of the SRIQ K6 (irrespective of core/spiral assignment) and consensus cluster 6 group solutions. Consensus clustering was performed as above, whereas SRIQ analysis was performed as described in <xref rid="f0010" ref-type="fig">Fig. 2</xref>A. <bold>(C)</bold> Biological metagene expression is significantly different between core TRU-classified samples stratified by SRIQ cluster 1 (C1) and 5 (C5). (<bold>D</bold>) Immune cell types from Cibersort analysis showing statistical difference between core TRU-classified samples stratified by SRIQ cluster 1 (C1) and 5 (C5). P-values calculated using Wilcoxon’s test with Bonferroni adjustment (for testing of 22 Cibersort cell types in total).</p></caption><graphic xlink:href="gr4"/></fig></p>
      </sec>
    </sec>
    <sec id="s0085">
      <label>3.2</label>
      <title>Molecular investigation of SRIQ K6 cluster solution</title>
      <sec id="s0090">
        <label>3.2.1</label>
        <title>Characterization of SRIQ K6 solution versus molecular subtypes and biological metagenes</title>
        <p id="p0130">To analyze the biological relevance of SRIQ results we focused on LUAD cases classified as core samples by the K6 solution with a cut-off of 0.63, originally shown in <xref rid="f0010" ref-type="fig">Fig. 2</xref>A and further explored in <xref rid="f0015" ref-type="fig">Fig. 3</xref>A-D.</p>
        <p id="p0135">Briefly, for the SRIQ K6 solution, cluster 1 was defined by TRU and PI classes, high immune response expression, medium number of <italic>TP53</italic> mutations and &gt;80% females. Cluster 2 was characterized by PP and TRU, high expression of the Napsin A surfactant metagene, low expression of the proliferation, immune response, and stroma/ECM metagenes, and a high frequency of <italic>KRAS</italic> and <italic>STK11</italic> mutations (52% and 55%, respectively). Characteristics of cluster 3 core samples were high expression of the stroma/ECM, basal/squamous, and immune response metagenes, 90% PI classified samples, and a high number of <italic>TP53</italic> mutations (64%). Cluster 4 consisted of 96% PP samples with high expression of the proliferation metagene, low expression of the Napsin A/surfactant metagene, and a high <italic>TP53</italic> mutation rate (85%). Cluster 5 consisted solely of TRU classified samples with high expression of the Napsin A/surfactant metagene, low expression of the proliferation metagene, and a proportionally high fraction of all <italic>EGFR</italic> mutated cases (41% of all <italic>EGFR</italic> mutations in core samples). Cluster 6 consisted mainly of PP classified samples with high mutational burden of <italic>KRAS</italic> and <italic>STK11</italic> (59% and 45%, respectively) and mixed expression of several of the biological metagenes.</p>
      </sec>
    </sec>
    <sec id="s0095">
      <label>3.3</label>
      <title>SRIQ clustering refines the TRU molecular phenotype</title>
      <p id="p0140">As shown in <xref rid="f0015" ref-type="fig">Fig. 3</xref>B, SRIQ differentiates the TCGA molecular subtypes into different clusters. E.g., SRIQ cluster 5 was primarily composed of TRU classified cases, irrespective of whether core (100% TRU, representing 34% of all core samples classified as TRU) or spiral samples were considered (89% TRU). In addition to cluster 5, SRIQ cluster 1 also harbored a high proportion of TRU cases (79% of core samples representing 46% of all core samples classified as TRU and 49% of spiral samples). To investigate the relevance of this stratification by SRIQ, we compared different molecular variables for SRIQ cluster 5 TRU core cases versus cluster 1 TRU core cases. Based on proposed biological metagenes, capturing broad transcriptional tumor intrinsic and microenvironment patterns, significant differences in expression involved both likely tumor related features like expression of Napsin A/surfactant (higher in cluster 5 vs cluster 1) and proliferation (lower in cluster 5 vs cluster 1), but also microenvironment features like immune response and stroma/ECM (lower in cluster 5 vs cluster 1) (<xref rid="f0020" ref-type="fig">Fig. 4</xref>C). Substantiating a difference in tumor microenvironment, cluster 5 TRU cases had significantly higher tumor purity on average than cluster 1 TRU cases (Wilcoxon’s test p = 0.01). Other interesting features showing trend-like differences, albeit non-significant, was a trend of higher tumor ploidy in cluster 5 cases vs cluster 1 (Wilcoxon’s test p = 0.09), while a lower exposure of the mutational signature related to smoking (signature 4 <xref rid="b0180" ref-type="bibr">[36]</xref>) was observed in cluster 5 (median exposure = 26%) compared to cluster 1 (median exposure = 32%) cases (Wilcoxon’s test p = 0.35). Together, this suggests possible refinement of the TRU phenotype based on both tumor intrinsic and tumor microenvironment features.</p>
      <sec id="s0100">
        <label>3.3.1</label>
        <title>SRIQ differentiates immune type infiltration within the TRU molecular subtype</title>
        <p id="p0145">The importance of the host immune response to malignant growth has become increasingly important in LUAD based on the clinical introduction of immune checkpoint inhibitors. While the original TCGA molecular subtypes have been proposed to align to some extent with differences in immune response, illustrated by the renaming of the original squamoid subtype <xref rid="b0095" ref-type="bibr">[19]</xref> to proximal inflammatory (PI) <xref rid="b0110" ref-type="bibr">[22]</xref>, large within subtype heterogeneity still exists. As illustrated in <xref rid="f0020" ref-type="fig">Fig. 4</xref>C, SRIQ clustering separates TRU classified core cases into one cluster (cluster 1) with high expression of immune response associated genes and one with lower expression (cluster 5). To explore whether the difference in immune response could be due to different infiltrating immune cell types, we compared 22 different immune cell type fractions obtained by Cibsersort analysis of RNA-seq data (obtained from <xref rid="b0140" ref-type="bibr">[28]</xref>) between the core sample groups. As shown in <xref rid="f0020" ref-type="fig">Fig. 4</xref>D, statistical differences, after multiple testing adjustment, between the groups were observed for several cell types, including plasma cells, CD8 T-cells, M1 macrophages (borderline non-significant), M2 macrophages, activated dendritic cells, and resting mast cells, further supporting the SRIQ stratification of TRU classified cases.</p>
      </sec>
      <sec id="s0105">
        <label>3.3.2</label>
        <title>Differential gene expression and GO enrichment between clusters</title>
        <p id="p0150">To more in detail identify transcriptional programs characterizing the SRIQ clusters we performed differential gene expression of the core clusters through a “one versus rest” approach using SAM analysis. Differentially expressed genes are illustrated in <xref rid="f0025" ref-type="fig">Fig. 5</xref>A, listed in <xref rid="s0150" ref-type="sec">Supplementary Table 3</xref>, and enriched GO terms based on gene ontology analysis are listed in <xref rid="s0150" ref-type="sec">Supplementary Table 4</xref> and illustrated in <xref rid="f0025" ref-type="fig">Fig. 5</xref>B-C for up- and down-regulated genes, respectively. Briefly, similar to the biological metagene expression patterns these results illustrate the presence of biological processes likely related to both tumor intrinsic factors and differences in the composition of the tumor microenvironment captured by SRIQ. For instance, in the high proliferative core cluster 4 enriched GO terms for up-regulated genes included DNA replication, mitotic spindle and cell cycle terms likely associated with higher intrinsic tumor proliferation, while immune response associated GO terms were enriched in down-regulated genes for this cluster, consistent with the immune cold phenotype suggested by the immune response metagene expression (likely representative of a low lymphocyte infiltrative tumor microenvironment). In opposite, in the immune response high cluster 1 immune response associated GO terms were enriched among up-regulated genes while DNA replication and spindle associated GO terms were enriched in down-regulated genes.<fig id="f0025"><label>Fig. 5</label><caption><p>Differential gene expression patterns and functional analysis for SRIQ K6 core samples. (<bold>A</bold>) Gene expression heatmap of the significantly expressed genes (n = 2417) based on SAM analysis with q-value &lt;= 5 and a fold-change &gt;= 2 for 162 core samples in total for each SRIQ cluster in a one versus rest approach. Annotation bars present biological metagene expression patterns, selected clinical information, and mutations (all variant types) for <italic>KRAS</italic>, <italic>EGFR</italic>, <italic>TP53</italic>, and <italic>STK11</italic>. SRIQ cluster solution was based on bag size 1200 and diameter cut-off 0.63 as shown in <xref rid="f0010" ref-type="fig">Fig. 2</xref>A. (<bold>B</bold>) Heatmap of up-regulated GO-terms for significant genes ordered by cluster, with the color representing statistical significance (−log(p)). Only a subset of GO-terms is listed in text, full details are shown in the corresponding Supplementary Table. (<bold>C</bold>) Heatmap of down-regulated GO-terms for significant genes ordered by cluster with the color representing statistical significance (−log(p)). Only a subset of GO-terms is listed in text, full details are shown in the corresponding Supplementary Table.</p></caption><graphic xlink:href="gr5"/></fig></p>
      </sec>
      <sec id="s0110">
        <label>3.3.3</label>
        <title>SRIQ refinement of the proximal-proliferative (PP) TCGA subtype</title>
        <p id="p0155">As seen in the heatmap in <xref rid="f0025" ref-type="fig">Fig. 5</xref>A, SRIQ clustering besides stratification of the TRU TCGA subtype also separates the PP TCGA subtype into three main nearly equally large subsets (core clusters 2, 4, and 6). Similar to the TRU case, this division appears associated with both tumor intrinsic properties and tumor microenvironment features likely representing readouts of the former (<xref rid="s0150" ref-type="sec">Supplementary Fig. 3</xref>). Briefly, PP cases in cluster 2 appear low proliferative but Napsin A/surfactant positive, driven by often concomitant <italic>KRAS</italic> and <italic>STK11</italic> alterations (e.g. 70% of <italic>KRAS</italic> mutated cases also had <italic>STK11</italic> mutations) but not <italic>TP53</italic> mutations. In contrast, PP cases in cluster 4 appear as the opposite to cluster 2, with infrequent <italic>KRAS</italic> and <italic>STK11</italic> alterations, 84% <italic>TP53</italic> alterations, very low Napsin A/surfactant expression, high tumor proliferation, and an immune cold phenotype. Finally, cluster 6 PP cases appear as the intermediate group between cluster 2 and 4, with frequent <italic>KRAS</italic> and <italic>STK11</italic> alterations, intermediate <italic>TP53</italic> mutations, and a more heterogeneous expression of the biological metagenes.</p>
      </sec>
      <sec id="s0115">
        <label>3.3.4</label>
        <title>Transcriptional features of clusters different between SRIQ and consensus clustering</title>
        <p id="p0160">To deepen our comparison between SRIQ and consensus clustering we analyzed the observed differences from <xref rid="f0020" ref-type="fig">Fig. 4</xref>B regarding the division of consensus cluster 1 samples into SRIQ cluster 1 and 3. Firstly, when considering the global gene expression pattern UMAP analysis clearly demonstrated the general separation of SRIQ cluster 1 and 3 core samples (<xref rid="f0015" ref-type="fig">Fig. 3</xref>A, irrespective of consensus cluster status). Moreover, concerning expression of the biological metagenes, SRIQ cluster 1 and 3 samples (core and spiral) have clearly different patterns for several biological metagenes, including Napsin A/surfactant, immune response, stroma/ECM and proliferation, as well as clearly differentially expressed genes and different proportions of TRU/PP/PI gene expression subtypes as previously shown in <xref rid="f0025" ref-type="fig">Fig. 3B-D and 5</xref>. Finally, unsupervised hierarchical clustering of consensus cluster 1 samples specifically showed the heterogeneity of this cluster (<xref rid="s0150" ref-type="sec">Supplementary Fig. 4</xref>A), further illustrated by UMAP analysis of the same samples (<xref rid="s0150" ref-type="sec">Supplementary Fig. 4</xref>B). Together, these results substantiate that SRIQ in this case appears to stratify samples more appropriately from a molecular standpoint.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s0120">
    <label>4</label>
    <title>Discussion</title>
    <p id="p0165">In the current study we report an algorithm, SRIQ, that is a fusion of concepts from machine learning methods (Random Forest and QT- as well as KNN clustering) for unsupervised analysis of gene expression data. Based on technical reproducibility and benchmark analyses combined with deeper molecular correlations of derived clusters in bulk LUAD RNA-seq data, we demonstrate how the method can be applied and show that SRIQ-clustering captures biologically coherent variability in previously reported transcriptional phenotypes.</p>
    <p id="p0170">The reproducibility analyses presented in <xref rid="f0010" ref-type="fig">Fig. 2</xref> demonstrate the importance of selecting a high enough bag size value for SRIQ (<xref rid="f0010" ref-type="fig">Fig. 2</xref>B). This is not surprising considering that using smaller feature sets (bag sizes) cause cluster instability in clustering methods due to selection bias, an issue not limited to SRIQ. Moreover, we show that SRIQ cluster identification, up to a point, is robust to reduced dataset sizes (<xref rid="f0010" ref-type="fig">Fig. 2</xref>C-D). As a rule in cluster analyses smaller subgroups, can only be detected by a method if their “core samples” are present in sufficient numbers. This represents a universal issue and is therefore not a specific limitation of SRIQ. Importantly, the analyses of SRIQ cluster stability and the benchmarking versus consensus clustering presented in <xref rid="f0010" ref-type="fig">Fig. 2</xref>, <xref rid="f0020" ref-type="fig">Fig. 4</xref> may serve as useful examples of how SRIQ users can explore their own data to assure optimal/robust results.</p>
    <p id="p0175">In contrast to conventional clustering algorithms, SRIQ users have an option to investigate both tight clusters, “core clusters”, which may be the core subtype representatives of the cohort, and the expanded, “spiral clusters”, which constitute samples that are neighbors to core clusters or samples representing admixtures of different cell types or subgroups. Reassuringly, we show that core and spiral cluster samples in the TCGA LUAD dataset had similar broad transcriptional profiles representing mixtures of larger transcriptional programs related to both tumor intrinsic properties (e.g., expression of Napsin A/surfactant genes associated with certain subtypes of LUAD as well as proliferation-related genes) and tumor microenvironment features such as the level of immune and stromal cell infiltration (e.g. expression of immune response and stroma/ECM metagenes) (<xref rid="f0015" ref-type="fig">Fig. 3</xref>C-D). What we believe is a second important feature of SRIQ is the possibility of producing cluster solutions at different diameter values in one run, where each solution is analyzed also for performance, accuracy and stability. Thus, a user can in a more straightforward way decide which cluster solution is appropriate to go ahead with in downstream analyses and provide a clear motivation for this choice. Finally, an important conclusion from both the technical benchmarking and the expanded molecular investigation of SRIQ results versus the established consensus clustering algorithm is that while both methods define common patient subsets, SRIQ clustering appears capable of capturing additional variability, allowing for more biologically refined clustering.</p>
    <p id="p0180">An important aim of this study was to go beyond technical validation and algorithmic benchmarking by analyzing derived cluster solutions for biological relevance and comparison with reported gene expression phenotypes in order to provide support for the usefulness of SRIQ as a method. Here, we believe the presented SRIQ results strongly support that further refinement of proposed TCGA subtypes in LUAD is feasible. Importantly, current LUAD subtypes are based on unsupervised analysis (using consensus clustering in the original study <xref rid="b0095" ref-type="bibr">[19]</xref>) of bulk tumor gene expression data <xref rid="b0095" ref-type="bibr">[19]</xref>, <xref rid="b0110" ref-type="bibr">[22]</xref>. This implies that subtypes reflect tumor specific transcriptional patterns as well as the composition of the non-malignant microenvironment. In this context, SRIQ was able to delineate both the TRU and PP TCGA subtypes into subgroups reflecting different tumor microenvironments, as evidenced by, e.g., expression patterns of the biological metagenes used in this study (<xref rid="f0015" ref-type="fig">Fig. 3</xref>, <xref rid="f0020" ref-type="fig">Fig. 4</xref>, <xref rid="f0025" ref-type="fig">Fig. 5</xref>). With the introduction of immune checkpoint inhibitors in lung cancer the role of the microenvironment and immune response is now acknowledged as an important factor to consider for both treatment prediction and prognostication <xref rid="b0185" ref-type="bibr">[37]</xref>. Thus, further refinement of LUAD gene expression subtypes may help in determining their future clinical significance/usefulness with respect to current therapy options and patient outcome.</p>
    <p id="p0185">Similar to all algorithms in the field, certain limitations of SRIQ are apparent. Here, we believe the presented SRIQ reproducibility analyses may serve as an example for independent users on how to approach the matter in their own data. Cluster solutions primarily depend on two hyperparameters: i) the minimum number of samples in clusters, and ii) the cluster diameter. As discussed above, SRIQ cannot circumvent the general problem of smaller datasets limiting the possibility to detect small or underrepresented biological subgroups (clusters). Regarding cluster diameter, cluster solutions with lower diameter values generate tight/stable clusters, whereas those with greater diameter values produce more relaxed clusters. Importantly, the diameter needs to be considered in the context of the stability and occurrence of a solution across iterations. Another important SRIQ parameter is the bag size. Based on our analyses it is evident that not choosing a very small value should in general be sufficient. The combination of a large bag size, high number of permutations, and large datasets (samples and features) can make running SRIQ computation and memory intensive. Despite taking advantage of the symmetrical nature of the pairwise similarity matrix and the parallelism by Java programming, more optimized computing strategies could be employed to facilitate the application of SRIQ to, e.g., single cell sequencing and epigenomic data. Future improvements to the provided SRIQ pipeline could include additional data pre-processing procedures for different data types, additional distance metric methods beside Pearson and Euclidean distance, additional metrics for cluster stability to facilitate cluster solution selection, and flexibility to add metadata to the clusters to, e.g., facilitate the evaluation of cluster solutions.</p>
    <p id="p0190">In summary, we have demonstrated that SRIQ is an unsupervised analysis method for gene expression data that can circumvent problematic issues in unsupervised clustering. In the case of LUAD, it can be used to provide strong support for refinement of previously proposed transcriptional subtypes based on improved separation of subtypes by better capturing tumor intrinsic and microenvironmental transcriptional patterns. As such, we believe that SRIQ can become a valuable new tool for translational cancer research and may in the future also apply to other types of high-dimensional omics data beyond gene expression.</p>
  </sec>
  <sec id="s0125">
    <title>CRediT authorship contribution statement</title>
    <p id="p0195"><bold>Jacob Karlström:</bold> Visualization, Methodology, Formal analysis, Software, Data curation, Investigation, Writing – original draft. <bold>Mattias Aine:</bold> Data curation, Writing – original draft. <bold>Johan Staaf:</bold> Formal analysis, Investigation, Supervision, Writing – original draft, Writing – review &amp; editing, Funding acquisition, Project administration, Conceptualization. <bold>Srinivas Veerla:</bold> Conceptualization, Formal analysis, Visualization, Data curation, Methodology, Software, Investigation, Writing – original draft, Writing – review &amp; editing.</p>
  </sec>
</body>
<back>
  <ref-list id="bi005">
    <title>References</title>
    <ref id="b0005">
      <label>1</label>
      <mixed-citation publication-type="other" id="h0005">World Health Organization (WHO) http://www.who.int. Accessed Nov 26 2021.</mixed-citation>
    </ref>
    <ref id="b0010">
      <label>2</label>
      <element-citation publication-type="journal" id="h0010">
        <person-group person-group-type="author">
          <name>
            <surname>Perou</surname>
            <given-names>C.M.</given-names>
          </name>
          <name>
            <surname>Sorlie</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>M.B.</given-names>
          </name>
          <name>
            <surname>van de Rijn</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Jeffrey</surname>
            <given-names>S.S.</given-names>
          </name>
          <name>
            <surname>Rees</surname>
            <given-names>C.A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular portraits of human breast tumours</article-title>
        <source>Nature</source>
        <volume>406</volume>
        <year>2000</year>
        <fpage>747</fpage>
        <lpage>752</lpage>
        <pub-id pub-id-type="pmid">10963602</pub-id>
      </element-citation>
    </ref>
    <ref id="b0015">
      <label>3</label>
      <element-citation publication-type="journal" id="h0015">
        <person-group person-group-type="author">
          <name>
            <surname>Saxena</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Prasad</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Bharill</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>O.P.</given-names>
          </name>
          <name>
            <surname>Tiwari</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A review of clustering techniques and developments</article-title>
        <source>Neurocomputing</source>
        <volume>267</volume>
        <year>2017</year>
        <fpage>664</fpage>
        <lpage>681</lpage>
      </element-citation>
    </ref>
    <ref id="b0020">
      <label>4</label>
      <element-citation publication-type="book" id="h0020">
        <person-group person-group-type="author">
          <name>
            <surname>Kaufman</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Rousseeuw</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <part-title>Partitioning around medoids (Program PAM)</part-title>
        <source>Wiley Series in Probability and Statistics</source>
        <year>1990</year>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="b0025">
      <label>5</label>
      <element-citation publication-type="journal" id="h0025">
        <person-group person-group-type="author">
          <name>
            <surname>Charrad</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Ghazzali</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Boiteau</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Niknafs</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>NbClust: an R package for determining the relevant number of clusters in a data set</article-title>
        <source>J Stat Softw</source>
        <volume>61</volume>
        <year>2014</year>
        <fpage>1</fpage>
        <lpage>36</lpage>
      </element-citation>
    </ref>
    <ref id="b0030">
      <label>6</label>
      <element-citation publication-type="journal" id="h0030">
        <person-group person-group-type="author">
          <name>
            <surname>Heyer</surname>
            <given-names>L.J.</given-names>
          </name>
          <name>
            <surname>Kruglyak</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Yooseph</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Exploring expression data: identification and analysis of coexpressed genes</article-title>
        <source>Genome Res</source>
        <volume>9</volume>
        <year>1999</year>
        <fpage>1106</fpage>
        <lpage>1115</lpage>
        <pub-id pub-id-type="pmid">10568750</pub-id>
      </element-citation>
    </ref>
    <ref id="b0035">
      <label>7</label>
      <element-citation publication-type="journal" id="h0035">
        <person-group person-group-type="author">
          <name>
            <surname>Rodriguez</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Laio</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Machine learning. Clustering by fast search and find of density peaks</article-title>
        <source>Science</source>
        <volume>344</volume>
        <year>2014</year>
        <fpage>1492</fpage>
        <lpage>1496</lpage>
        <pub-id pub-id-type="pmid">24970081</pub-id>
      </element-citation>
    </ref>
    <ref id="b0040">
      <label>8</label>
      <element-citation publication-type="journal" id="h0040">
        <person-group person-group-type="author">
          <name>
            <surname>A’lZoubi</surname>
            <given-names>W.A.</given-names>
          </name>
        </person-group>
        <article-title>A survey of clustering algorithms in association rules mining</article-title>
        <source>Int J Comput Sci Inf Technol</source>
        <volume>11</volume>
        <year>2019</year>
        <fpage>17</fpage>
        <lpage>25</lpage>
      </element-citation>
    </ref>
    <ref id="b0045">
      <label>9</label>
      <element-citation publication-type="journal" id="h0045">
        <person-group person-group-type="author">
          <name>
            <surname>Kriegel</surname>
            <given-names>H.-P.</given-names>
          </name>
          <name>
            <surname>Kröger</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Zimek</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Clustering high-dimensional data: a survey on subspace clustering, pattern-based clustering, and correlation clustering</article-title>
        <source>ACM Trans Knowl Discov Data</source>
        <volume>3</volume>
        <year>2009</year>
        <comment>Article 1</comment>
      </element-citation>
    </ref>
    <ref id="b0050">
      <label>10</label>
      <element-citation publication-type="journal" id="h0050">
        <person-group person-group-type="author">
          <name>
            <surname>Zimek</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Schubert</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Kriegel</surname>
            <given-names>H.-P.</given-names>
          </name>
        </person-group>
        <article-title>A survey on unsupervised outlier detection in high-dimensional numerical data</article-title>
        <source>Statistical Anal Data Mining</source>
        <volume>5</volume>
        <year>2012</year>
        <fpage>363</fpage>
        <lpage>387</lpage>
      </element-citation>
    </ref>
    <ref id="b0055">
      <label>11</label>
      <element-citation publication-type="journal" id="h0055">
        <person-group person-group-type="author">
          <name>
            <surname>Reunanen</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Räty</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Lintonen</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Automatic optimization of outlier detection ensembles using a limited number of outlier examples</article-title>
        <source>Int J Data Sci Anal</source>
        <volume>10</volume>
        <year>2020</year>
        <fpage>377</fpage>
        <lpage>394</lpage>
      </element-citation>
    </ref>
    <ref id="b0060">
      <label>12</label>
      <element-citation publication-type="journal" id="h0060">
        <person-group person-group-type="author">
          <name>
            <surname>Tolosi</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Lengauer</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Classification with correlated features: unreliability of feature ranking and solutions</article-title>
        <source>Bioinformatics</source>
        <volume>27</volume>
        <year>2011</year>
        <fpage>1986</fpage>
        <lpage>1994</lpage>
        <pub-id pub-id-type="pmid">21576180</pub-id>
      </element-citation>
    </ref>
    <ref id="b0065">
      <label>13</label>
      <element-citation publication-type="journal" id="h0065">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>T.-H.</given-names>
          </name>
          <name>
            <surname>Ergün</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>The instability of the Pearson correlation coefficient in the presence of coincidental outliers</article-title>
        <source>Finance Res Lett</source>
        <volume>13</volume>
        <year>2015</year>
        <fpage>243</fpage>
        <lpage>257</lpage>
      </element-citation>
    </ref>
    <ref id="b0070">
      <label>14</label>
      <element-citation publication-type="journal" id="h0070">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Random forests</article-title>
        <source>Machine Learn</source>
        <volume>45</volume>
        <year>2001</year>
        <fpage>5</fpage>
        <lpage>32</lpage>
      </element-citation>
    </ref>
    <ref id="b0075">
      <label>15</label>
      <element-citation publication-type="journal" id="h0075">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Bagging predictors</article-title>
        <source>Machine Learn</source>
        <volume>24</volume>
        <year>1996</year>
        <fpage>123</fpage>
        <lpage>140</lpage>
      </element-citation>
    </ref>
    <ref id="b0080">
      <label>16</label>
      <element-citation publication-type="journal" id="h0080">
        <person-group person-group-type="author">
          <name>
            <surname>Petersen</surname>
            <given-names>M.L.</given-names>
          </name>
          <name>
            <surname>Molinaro</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Sinisi</surname>
            <given-names>S.E.</given-names>
          </name>
          <name>
            <surname>van der Laan</surname>
            <given-names>M.J.</given-names>
          </name>
        </person-group>
        <article-title>Cross-validated bagged learning</article-title>
        <source>J Multivariate Anal</source>
        <volume>98</volume>
        <year>2007</year>
        <fpage>1693</fpage>
        <lpage>1704</lpage>
      </element-citation>
    </ref>
    <ref id="b0085">
      <label>17</label>
      <element-citation publication-type="journal" id="h0085">
        <person-group person-group-type="author">
          <name>
            <surname>Travis</surname>
            <given-names>W.D.</given-names>
          </name>
          <name>
            <surname>Brambilla</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Nicholson</surname>
            <given-names>A.G.</given-names>
          </name>
          <name>
            <surname>Yatabe</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Austin</surname>
            <given-names>J.H.M.</given-names>
          </name>
          <name>
            <surname>Beasley</surname>
            <given-names>M.B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The 2015 World Health Organization classification of lung tumors: impact of genetic, clinical and radiologic advances since the 2004 classification</article-title>
        <source>J Thorac Oncol</source>
        <volume>10</volume>
        <year>2015</year>
        <fpage>1243</fpage>
        <lpage>1260</lpage>
        <pub-id pub-id-type="pmid">26291008</pub-id>
      </element-citation>
    </ref>
    <ref id="b0090">
      <label>18</label>
      <element-citation publication-type="journal" id="h0090">
        <person-group person-group-type="author">
          <name>
            <surname>Crino</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Weder</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>van Meerbeeck</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Felip</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Early stage and locally advanced (non-metastatic) non-small-cell lung cancer: ESMO Clinical Practice Guidelines for diagnosis, treatment and follow-up</article-title>
        <source>Ann Oncol</source>
        <volume>21</volume>
        <issue>Suppl 5</issue>
        <year>2010</year>
        <fpage>v103</fpage>
        <lpage>115</lpage>
        <pub-id pub-id-type="pmid">20555058</pub-id>
      </element-citation>
    </ref>
    <ref id="b0095">
      <label>19</label>
      <element-citation publication-type="journal" id="h0095">
        <person-group person-group-type="author">
          <name>
            <surname>Wilkerson</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Cabanski</surname>
            <given-names>C.R.</given-names>
          </name>
          <name>
            <surname>Hayward</surname>
            <given-names>M.C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential pathogenesis of lung adenocarcinoma subtypes involving sequence mutations, copy number, chromosomal instability, and methylation</article-title>
        <source>PLoS ONE</source>
        <volume>7</volume>
        <year>2012</year>
        <object-id pub-id-type="publisher-id">e36530</object-id>
      </element-citation>
    </ref>
    <ref id="b0100">
      <label>20</label>
      <element-citation publication-type="journal" id="h0100">
        <person-group person-group-type="author">
          <name>
            <surname>Beer</surname>
            <given-names>D.G.</given-names>
          </name>
          <name>
            <surname>Kardia</surname>
            <given-names>S.L.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>C.C.</given-names>
          </name>
          <name>
            <surname>Giordano</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Levin</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Misek</surname>
            <given-names>D.E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene-expression profiles predict survival of patients with lung adenocarcinoma</article-title>
        <source>Nat Med</source>
        <volume>8</volume>
        <year>2002</year>
        <fpage>816</fpage>
        <lpage>824</lpage>
        <pub-id pub-id-type="pmid">12118244</pub-id>
      </element-citation>
    </ref>
    <ref id="b0105">
      <label>21</label>
      <element-citation publication-type="journal" id="h0105">
        <person-group person-group-type="author">
          <name>
            <surname>Hayes</surname>
            <given-names>D.N.</given-names>
          </name>
          <name>
            <surname>Monti</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Parmigiani</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Gilks</surname>
            <given-names>C.B.</given-names>
          </name>
          <name>
            <surname>Naoki</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Bhattacharjee</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene expression profiling reveals reproducible human lung adenocarcinoma subtypes in multiple independent patient cohorts</article-title>
        <source>J Clin Oncol</source>
        <volume>24</volume>
        <year>2006</year>
        <fpage>5079</fpage>
        <lpage>5090</lpage>
        <pub-id pub-id-type="pmid">17075127</pub-id>
      </element-citation>
    </ref>
    <ref id="b0110">
      <label>22</label>
      <mixed-citation publication-type="other" id="h0110">Cancer Genome Atlas Research N: Comprehensive molecular profiling of lung adenocarcinoma. Nature 2014, 511:543-550.</mixed-citation>
    </ref>
    <ref id="b0115">
      <label>23</label>
      <element-citation publication-type="journal" id="h0115">
        <person-group person-group-type="author">
          <name>
            <surname>Planck</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Edlund</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Botling</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Micke</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Isaksson</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Staaf</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Genomic and transcriptional alterations in lung adenocarcinoma in relation to EGFR and KRAS mutation status</article-title>
        <source>PLoS ONE</source>
        <volume>8</volume>
        <year>2013</year>
        <object-id pub-id-type="publisher-id">e78614</object-id>
      </element-citation>
    </ref>
    <ref id="b0120">
      <label>24</label>
      <element-citation publication-type="journal" id="h0120">
        <person-group person-group-type="author">
          <name>
            <surname>Ringner</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Jonsson</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Staaf</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Prognostic and Chemotherapy Predictive Value of Gene-Expression Phenotypes in Primary Lung Adenocarcinoma</article-title>
        <source>Clin Cancer Res</source>
        <volume>22</volume>
        <year>2016</year>
        <fpage>218</fpage>
        <lpage>229</lpage>
        <pub-id pub-id-type="pmid">26265693</pub-id>
      </element-citation>
    </ref>
    <ref id="b0125">
      <label>25</label>
      <element-citation publication-type="journal" id="h0125">
        <person-group person-group-type="author">
          <name>
            <surname>Ringner</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Staaf</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Consensus of gene expression phenotypes and prognostic risk predictors in primary lung adenocarcinoma</article-title>
        <source>Oncotarget</source>
        <volume>7</volume>
        <year>2016</year>
        <fpage>52957</fpage>
        <lpage>52973</lpage>
        <pub-id pub-id-type="pmid">27437773</pub-id>
      </element-citation>
    </ref>
    <ref id="b0130">
      <label>26</label>
      <mixed-citation publication-type="other" id="h0130">The Cancer Genome Atlas http://cancergenome.nih.gov/. Accessed Nov 26 2021.</mixed-citation>
    </ref>
    <ref id="b0135">
      <label>27</label>
      <element-citation publication-type="journal" id="h0135">
        <person-group person-group-type="author">
          <name>
            <surname>Dama</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Melocchi</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Dezi</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Pirroni</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Carletti</surname>
            <given-names>R.M.</given-names>
          </name>
          <name>
            <surname>Brambilla</surname>
            <given-names>D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An aggressive subtype of stage I lung adenocarcinoma with molecular and prognostic characteristics typical of advanced lung cancers</article-title>
        <source>Clin Cancer Res</source>
        <volume>23</volume>
        <year>2017</year>
        <fpage>62</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="pmid">27358486</pub-id>
      </element-citation>
    </ref>
    <ref id="b0140">
      <label>28</label>
      <element-citation publication-type="journal" id="h0140">
        <person-group person-group-type="author">
          <name>
            <surname>Thorsson</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Gibbs</surname>
            <given-names>D.L.</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>S.D.</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Bortone</surname>
            <given-names>D.S.</given-names>
          </name>
          <name>
            <surname>Ou Yang</surname>
            <given-names>T.H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The immune landscape of cancer</article-title>
        <source>Immunity</source>
        <volume>51</volume>
        <year>2019</year>
        <fpage>411</fpage>
        <lpage>412</lpage>
        <pub-id pub-id-type="pmid">31433971</pub-id>
      </element-citation>
    </ref>
    <ref id="b0145">
      <label>29</label>
      <element-citation publication-type="journal" id="h0145">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C.L.</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>
        <source>Nat Methods</source>
        <volume>12</volume>
        <year>2015</year>
        <fpage>453</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="pmid">25822800</pub-id>
      </element-citation>
    </ref>
    <ref id="b0150">
      <label>30</label>
      <element-citation publication-type="journal" id="h0150">
        <person-group person-group-type="author">
          <name>
            <surname>Tusher</surname>
            <given-names>V.G.</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Significance analysis of microarrays applied to the ionizing radiation response</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <volume>98</volume>
        <year>2001</year>
        <fpage>5116</fpage>
        <lpage>5121</lpage>
        <pub-id pub-id-type="pmid">11309499</pub-id>
      </element-citation>
    </ref>
    <ref id="b0155">
      <label>31</label>
      <element-citation publication-type="journal" id="h0155">
        <person-group person-group-type="author">
          <name>
            <surname>Karlsson</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Jonsson</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Lauss</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Brunnstrom</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Jonsson</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Borg</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide DNA methylation analysis of lung carcinoma reveals one neuroendocrine and four adenocarcinoma epitypes associated with patient outcome</article-title>
        <source>Clin Cancer Res</source>
        <volume>20</volume>
        <year>2014</year>
        <fpage>6127</fpage>
        <lpage>6140</lpage>
        <pub-id pub-id-type="pmid">25278450</pub-id>
      </element-citation>
    </ref>
    <ref id="b0160">
      <label>32</label>
      <element-citation publication-type="journal" id="h0160">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>E.Y.</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>C.M.</given-names>
          </name>
          <name>
            <surname>Kou</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Duan</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Meirelles</surname>
            <given-names>G.V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Enrichr: interactive and collaborative HTML5 gene list enrichment analysis tool</article-title>
        <source>BMC Bioinf</source>
        <volume>14</volume>
        <year>2013</year>
        <fpage>128</fpage>
      </element-citation>
    </ref>
    <ref id="b0165">
      <label>33</label>
      <element-citation publication-type="journal" id="h0165">
        <person-group person-group-type="author">
          <name>
            <surname>Kuleshov</surname>
            <given-names>M.V.</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>Rouillard</surname>
            <given-names>A.D.</given-names>
          </name>
          <name>
            <surname>Fernandez</surname>
            <given-names>N.F.</given-names>
          </name>
          <name>
            <surname>Duan</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Enrichr: a comprehensive gene set enrichment analysis web server 2016 update</article-title>
        <source>Nucleic Acids Res</source>
        <volume>44</volume>
        <year>2016</year>
        <fpage>W90</fpage>
        <lpage>97</lpage>
        <pub-id pub-id-type="pmid">27141961</pub-id>
      </element-citation>
    </ref>
    <ref id="b0170">
      <label>34</label>
      <element-citation publication-type="journal" id="h0170">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kuleshov</surname>
            <given-names>M.V.</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>D.J.B.</given-names>
          </name>
          <name>
            <surname>Evangelista</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Jenkins</surname>
            <given-names>S.L.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene set knowledge discovery with enrichr</article-title>
        <source>Curr Protoc</source>
        <volume>1</volume>
        <year>2021</year>
        <object-id pub-id-type="publisher-id">e90</object-id>
      </element-citation>
    </ref>
    <ref id="b0175">
      <label>35</label>
      <element-citation publication-type="journal" id="h0175">
        <person-group person-group-type="author">
          <name>
            <surname>Rodriguez</surname>
            <given-names>M.Z.</given-names>
          </name>
          <name>
            <surname>Comin</surname>
            <given-names>C.H.</given-names>
          </name>
          <name>
            <surname>Casanova</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Bruno</surname>
            <given-names>O.M.</given-names>
          </name>
          <name>
            <surname>Amancio</surname>
            <given-names>D.R.</given-names>
          </name>
          <name>
            <surname>Costa</surname>
            <given-names>L.D.F.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clustering algorithms: a comparative approach</article-title>
        <source>PLoS ONE</source>
        <volume>14</volume>
        <year>2019</year>
        <object-id pub-id-type="publisher-id">e0210236</object-id>
      </element-citation>
    </ref>
    <ref id="b0180">
      <label>36</label>
      <element-citation publication-type="journal" id="h0180">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>L.B.</given-names>
          </name>
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>D.C.</given-names>
          </name>
          <name>
            <surname>Aparicio</surname>
            <given-names>S.A.</given-names>
          </name>
          <name>
            <surname>Behjati</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Biankin</surname>
            <given-names>A.V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Signatures of mutational processes in human cancer</article-title>
        <source>Nature</source>
        <volume>500</volume>
        <year>2013</year>
        <fpage>415</fpage>
        <lpage>421</lpage>
        <pub-id pub-id-type="pmid">23945592</pub-id>
      </element-citation>
    </ref>
    <ref id="b0185">
      <label>37</label>
      <element-citation publication-type="journal" id="h0185">
        <person-group person-group-type="author">
          <name>
            <surname>Altorki</surname>
            <given-names>N.K.</given-names>
          </name>
          <name>
            <surname>Markowitz</surname>
            <given-names>G.J.</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Port</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Saxena</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Stiles</surname>
            <given-names>B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The lung microenvironment: an important regulator of tumour growth and metastasis</article-title>
        <source>Nat Rev Cancer</source>
        <volume>19</volume>
        <year>2019</year>
        <fpage>9</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="pmid">30532012</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="s0150" sec-type="supplementary-material">
    <label>Appendix A</label>
    <title>Supplementary data</title>
    <p id="p0220">The following are the Supplementary data to this article:<supplementary-material content-type="local-data" id="m0030"><caption><title>Supplementary data 1</title></caption><media xlink:href="mmc1.pdf"/></supplementary-material></p>
    <p id="p0225">
      <supplementary-material content-type="local-data" id="m0025">
        <caption>
          <title>Supplementary data 2</title>
        </caption>
        <media xlink:href="mmc2.pdf"/>
      </supplementary-material>
    </p>
    <p id="p0230">
      <supplementary-material content-type="local-data" id="m0020">
        <caption>
          <title>Supplementary data 3</title>
        </caption>
        <media xlink:href="mmc3.xlsx"/>
      </supplementary-material>
    </p>
    <p id="p0235">
      <supplementary-material content-type="local-data" id="m0015">
        <caption>
          <title>Supplementary data 4</title>
        </caption>
        <media xlink:href="mmc4.pdf"/>
      </supplementary-material>
    </p>
    <p id="p0240">
      <supplementary-material content-type="local-data" id="m0010">
        <caption>
          <title>Supplementary data 5</title>
        </caption>
        <media xlink:href="mmc5.xlsx"/>
      </supplementary-material>
    </p>
    <p id="p0245">
      <supplementary-material content-type="local-data" id="m0005">
        <caption>
          <title>Supplementary data 6</title>
        </caption>
        <media xlink:href="mmc6.xlsx"/>
      </supplementary-material>
    </p>
  </sec>
  <ack id="ak005">
    <sec id="s0130">
      <title>Acknowledgements</title>
      <p id="p0200">The authors would like to acknowledge Dr Pontus Eriksson at the Division of Oncology, Lund University, Sweden for constructive methodological input.</p>
    </sec>
    <sec id="s0135">
      <title>Funding</title>
      <p id="p0205">This work was supported by the <funding-source id="gp005"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100002794</institution-id><institution>Swedish Cancer Society</institution></institution-wrap></funding-source>, the <funding-source id="gp010">Mrs Berta Kamprad Foundation, Sweden</funding-source>, <funding-source id="gp015">The Swedish Research Council</funding-source>, and <funding-source id="gp020">The National Health Services</funding-source> (Region Skåne/ALF).</p>
    </sec>
    <sec id="s0140">
      <title>Conflict of interests statement</title>
      <p id="p0210">Authors declare that they have no competing interests.</p>
    </sec>
  </ack>
  <fn-group>
    <fn id="s0145" fn-type="supplementary-material">
      <label>Appendix A</label>
      <p id="p0215">Supplementary data to this article can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.csbj.2022.03.036" id="ir020">https://doi.org/10.1016/j.csbj.2022.03.036</ext-link>.</p>
    </fn>
  </fn-group>
</back>
