<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5705545</article-id>
    <article-id pub-id-type="publisher-id">248</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-017-0248-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Consensus queries in ligand-based virtual screening experiments</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1377-944X</contrib-id>
        <name>
          <surname>Berenger</surname>
          <given-names>Francois</given-names>
        </name>
        <address>
          <email>berenger@bioreg.kyushu-u.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vu</surname>
          <given-names>Oanh</given-names>
        </name>
        <address>
          <email>oanh.t.vu.2@vanderbilt.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meiler</surname>
          <given-names>Jens</given-names>
        </name>
        <address>
          <email>jens.meiler@vanderbilt.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2264 7217</institution-id><institution-id institution-id-type="GRID">grid.152326.1</institution-id><institution>Department of Chemistry, </institution><institution>Vanderbilt University, </institution></institution-wrap>Nashville, TN USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2242 4849</institution-id><institution-id institution-id-type="GRID">grid.177174.3</institution-id><institution>Division of System Cohort, Medical Institute of Bioregulation, </institution><institution>Kyushu University, </institution></institution-wrap>Fukuoka, Japan </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>11</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>11</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>60</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>6</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>11</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">In ligand-based virtual screening experiments, a known active ligand is used in similarity searches to find putative active compounds for the same protein target. When there are several known active molecules, screening using all of them is more powerful than screening using a single ligand. A consensus query can be created by either screening serially with different ligands before merging the obtained similarity scores, or by combining the molecular descriptors (i.e. chemical fingerprints) of those ligands.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We report on the discriminative power and speed of several consensus methods, on two datasets only made of experimentally verified molecules. The two datasets contain a total of 19 protein targets, 3776 known active and ~ 2 × 10<sup>6</sup> inactive molecules. Three chemical fingerprints are investigated: MACCS 166 bits, ECFP4 2048 bits and an unfolded version of MOLPRINT2D. Four different consensus policies and five consensus sizes were benchmarked.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The best consensus method is to rank candidate molecules using the maximum score obtained by each candidate molecule versus all known actives. When the number of actives used is small, the same screening performance can be approached by a consensus fingerprint. However, if the computational exploration of the chemical space is limited by speed (i.e. throughput), a consensus fingerprint allows to outperform this consensus of scores.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Similarity search</kwd>
      <kwd>Several bioactives</kwd>
      <kwd>Consensus query</kwd>
      <kwd>Ligand-based virtual screening (LBVS)</kwd>
      <kwd>Chemical fingerprint</kwd>
      <kwd>Potency scaling</kwd>
      <kwd>MACCS</kwd>
      <kwd>ECFP4</kwd>
      <kwd>MOLPRINT2D</kwd>
      <kwd>Tanimoto score</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01 GM080403</award-id>
        <award-id>R01 GM099842</award-id>
        <principal-award-recipient>
          <name>
            <surname>Meiler</surname>
            <given-names>Jens</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001691</institution-id>
            <institution>Japan Society for the Promotion of Science</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CHE 1305874</award-id>
        <principal-award-recipient>
          <name>
            <surname>Meiler</surname>
            <given-names>Jens</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Similarity searches help expand the collection of known actives in the early stages of a drug discovery project. Interestingly, similarity searches do not require a diverse collection of active and inactive molecules prior to be used. Sometimes, in a ligand-based virtual screening (LBVS) campaign, only a limited number of active compounds is known. Such compounds could be found from the scientific literature, patent searches or a moderately successful structure-based virtual screen followed by wet-lab testing. This data scarcity might render standard machine learning algorithms inapplicable. Indeed, most Quantitative Structure Activity Relationship (QSAR) methods are data hungry. While expert machine learning users may benefit from recent developments [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], most users will be left in front of several questions: (a) how many actives are needed to create a powerful classifier, (b) which chemical fingerprint should be used to encode those actives, and (c) what is the best way to combine those fingerprints.</p>
    <p id="Par5">Similarity searches that exploit the chemical similarity principle [<xref ref-type="bibr" rid="CR3">3</xref>] are some of the earliest techniques developed in chemoinformatics [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. When several ligands are known for a given protein target, they can be used simultaneously to better find novel, putative active molecules.</p>
    <p id="Par6">This study measures the performance and speed of several ways to combine the knowledge about known actives. We investigate the effect of the fingerprint choice, the number of actives and the method used to combine fingerprints. Compared to most previous studies, our datasets are only made of experimentally verified molecules. We also evaluate the effect of scoring speed in CPU-bounded experiments, to show a potential use when screening immense virtual chemical libraries. We finally discuss which combination of fingerprint, consensus size and consensus method gives the best performance or should be avoided.</p>
    <p id="Par7">Using multiple bioactive reference structures has been studied by several authors [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR14">14</xref>]. Shemetulskis et al. [<xref ref-type="bibr" rid="CR6">6</xref>] have created modal fingerprints, where a bit is set in the consensus query if it is set in a given percentage (the mode) of known active molecules. Xue et al.  [<xref ref-type="bibr" rid="CR8">8</xref>] have used all bits consistently set in compounds of a same activity class (called consensus bit patterns) and scale factors for those bits to modify the Tanimoto score. This approach is called fingerprint scaling. It increases the probability of finding active molecules by virtual screening. Wang and Bajorath [<xref ref-type="bibr" rid="CR13">13</xref>] have used bit silencing in MACCS fingerprints to create a bit-position-dependent weight vector. This weight vector modifies the Tanimoto coefficient in order to derive compound-class-directed similarity metrics that improve virtual screening performance compared to conventional Tanimoto searches. Hert et al. [<xref ref-type="bibr" rid="CR9">9</xref>] have compared merging several fingerprints into a single combined fingerprint, applying data fusion (merging of scores) to the similarity rankings of single queries and approximated substructure searches. Hert et al. found that merging similarity scores and using binary kernel discrimination are the most powerful techniques. Later, Whittle [<xref ref-type="bibr" rid="CR11">11</xref>] confirmed that fusing similarity scores using the maximum score rule (or the minimum rank if scores are not available) is one of the most powerful strategies. For a recent study of data fusion methods with fragment-like molecules, see Schultes 2015 [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p id="Par8">Ligand-based virtual screening methods have also been extended to take into account the different potency levels of known actives [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. This potency scaling technique allows to bias the search space towards the detection of increasingly potent hits [<xref ref-type="bibr" rid="CR10">10</xref>]. To bias the search, a logarithmic weighting scheme based on IC50 <xref ref-type="fn" rid="Fn1">1</xref>values was introduced. Let <inline-formula id="IEq2"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_i$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq2.gif"/></alternatives></inline-formula> be a known active molecule. <inline-formula id="IEq3"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_i$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq3.gif"/></alternatives></inline-formula> is assigned a weight <inline-formula id="IEq4"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_i$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq4.gif"/></alternatives></inline-formula> given it’s IC50 value (IC50<sub>qi</sub>) and the IC50 value of the least active molecule (IC50<sub>min</sub>):<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} w_i = log(\mathrm {IC50_{min}}) - log(\mathrm {IC50}_{q_i}) + 1.0 \end{aligned}$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">IC</mml:mi><mml:msub><mml:mn>50</mml:mn><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">IC</mml:mi><mml:mn>50</mml:mn></mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2017_248_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>This logarithmic weighting scheme ensures linear scaling over the entire potency range and attributes a weight of one to the least active molecule [<xref ref-type="bibr" rid="CR10">10</xref>]. In Vogt and Bajorath [<xref ref-type="bibr" rid="CR12">12</xref>], the same weighting scheme is used to bias two distinct virtual screening algorithms and applied to a high-throughput screening (HTS) data set of cathepsin B inhibitors. The authors observed that using multiple reference compounds and potency scaling allows to direct the search towards detection of more potent database hits.</p>
    <p id="Par9">The pharmacologically relevant chemical space is immense. A study [<xref ref-type="bibr" rid="CR15">15</xref>] estimates its size in the order of <inline-formula id="IEq7"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{33}$$\end{document}</tex-math><mml:math id="M10"><mml:msup><mml:mn>10</mml:mn><mml:mn>33</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq7.gif"/></alternatives></inline-formula> molecules, with up to 36 heavy atoms each. While the database of commercially-available compounds ZINC15 [<xref ref-type="bibr" rid="CR16">16</xref>] totals <inline-formula id="IEq8"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$335 \times 10^6$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mn>335</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq8.gif"/></alternatives></inline-formula> compounds as of May 2017, there are virtual chemical libraries with more than <inline-formula id="IEq9"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$166 \times 10^9$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mn>166</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>9</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq9.gif"/></alternatives></inline-formula> molecules [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. Hence, one can imagine scenarios where the speed of a virtual screen has its importance.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par10">In this study, only fully automatic methods are investigated on 2D fingerprints. None of these methods requires fitting to a training set. The investigated methods are all parameter-free. Implicit parameters, if any, are detailed.</p>
    <sec id="Sec3">
      <title>Datasets</title>
      <p id="Par11">Several protein targets coming from two distinct datasets were used. None of those datasets contain any decoy (i.e. molecules that have not been experimentally verified as either active or inactive). A decoy is a supposedly inactive, computationally engineered [<xref ref-type="bibr" rid="CR19">19</xref>] or randomly chosen [<xref ref-type="bibr" rid="CR8">8</xref>] molecule. Hence, in this study there is no risk that a decoy creation protocol can be reverse engineered by any of the evaluated methods. Also, some of the datasets used are real world examples since they come from HTS campaigns.<table-wrap id="Tab1"><label>Table 1</label><caption><p>The NRLiSt subset with IC50 data for all actives</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Protein target</th><th char="." align="left"># Actives</th><th char="." align="left"># Inactives</th></tr></thead><tbody><tr><td align="left">AR−</td><td char="." align="char">179</td><td char="." align="char">179</td></tr><tr><td align="left">ERα-</td><td char="." align="char">74</td><td char="." align="char">434</td></tr><tr><td align="left">ERα+</td><td char="." align="char">102</td><td char="." align="char">132</td></tr><tr><td align="left">ERβ+</td><td char="." align="char">70</td><td char="." align="char">70</td></tr><tr><td align="left">GR−</td><td char="." align="char">204</td><td char="." align="char">295</td></tr><tr><td align="left">GR+</td><td char="." align="char">74</td><td char="." align="char">369</td></tr><tr><td align="left">PR−</td><td char="." align="char">269</td><td char="." align="char">269</td></tr><tr><td align="left">PR+</td><td char="." align="char">74</td><td char="." align="char">531</td></tr><tr><td align="left">RARα−</td><td char="." align="char">41</td><td char="." align="char">133</td></tr><tr><td align="left">RXRα−</td><td char="." align="char">114</td><td char="." align="char">210</td></tr></tbody></table><table-wrap-foot><p> ‘+’ after a target name means actives (resp. inactives) have an agonist (resp. antagonist) effect. ‘−’ after a target name means the opposite</p></table-wrap-foot></table-wrap>
</p>
      <p id="Par12">Our first dataset is the manually curated nuclear receptors ligands and structures benchmarking database [<xref ref-type="bibr" rid="CR20">20</xref>] (NRLiSt BDB<xref ref-type="fn" rid="Fn2">2</xref>). The NRLiSt is an exhaustive, NR-focused, benchmarking database. The original NRLiSt contains 9905 ligands and 339 protein targets. However, for the specific needs of this study, the NRLiSt was further filtered in order to contain only protein targets for which there are at least 40 known actives and at least the same amount (or more) of tested inactives. Furthermore, only active molecules with an IC50 value are accounted for. A summary of this dataset is given in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab2"><label>Table 2</label><caption><p>The nine HTS datasets with their PubChem Summary Assay ID (SAID)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Protein target class</th><th char="." align="left">SAID</th><th char="." align="left"># Actives</th><th char="." align="left"># Inactives</th></tr></thead><tbody><tr><td align="left" rowspan="3">GPCR</td><td char="." align="char">435008</td><td char="." align="char">233</td><td char="." align="char">217,925</td></tr><tr><td char="." align="char">1798</td><td char="." align="char">187</td><td char="." align="char">61,646</td></tr><tr><td char="." align="char">435034</td><td char="." align="char">362</td><td char="." align="char">61,394</td></tr><tr><td align="left" rowspan="3">Ion channel</td><td char="." align="char">1843</td><td char="." align="char">172</td><td char="." align="char">301,321</td></tr><tr><td char="." align="char">2258</td><td char="." align="char">213</td><td char="." align="char">302,192</td></tr><tr><td char="." align="char">463087</td><td char="." align="char">703</td><td char="." align="char">100,172</td></tr><tr><td align="left">Transporter</td><td char="." align="char">488997</td><td char="." align="char">252</td><td char="." align="char">302,054</td></tr><tr><td align="left">Kinase inhibitor</td><td char="." align="char">2689</td><td char="." align="char">172</td><td char="." align="char">319,620</td></tr><tr><td align="left">Enzyme</td><td char="." align="char">485290</td><td char="." align="char">281</td><td char="." align="char">341,084</td></tr></tbody></table></table-wrap>
</p>
      <p id="Par14">The second dataset, MLQSAR,<xref ref-type="fn" rid="Fn3">3</xref> is a compilation of validated PubChem High Throughput Screens [<xref ref-type="bibr" rid="CR21">21</xref>]. PubChem provides libraries of small molecules that have been tested in HTS experiments. This dataset focuses on experiments with a single well-defined and pharmaceutically relevant protein target. A target is only retained if it has at least 150 confirmed active compounds. A summary of MLQSAR is given in Table <xref rid="Tab2" ref-type="table">2</xref>. For several targets, active molecules just have a flag and no IC50 data. There are only two targets (PubChem SAID 485290 and 435,008) for which activity values span several orders of magnitude, while this is the case for all NRLIST targets.</p>
    </sec>
    <sec id="Sec4">
      <title>Fingerprints</title>
      <p id="Par16">In this study, three different fingerprints were used. The MACCS 166 bits fingerprint as provided by Open Babel [<xref ref-type="bibr" rid="CR22">22</xref>]. The ECFP4 2048 bits fingerprint as provided by Rdkit [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>] and an unfolded MOLPRINT2D [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] implementation, referred to as UMOP2D in the text. MOLPRINT2D descriptors encode atom environment based on SYBYL atom types (i.e. atom type and hybridization state) derived from the molecular graph. Only heavy atoms and their connected neighbors up to a distance of two bonds are considered by this fingerprint. MOLPRINT2D will be available in the upcoming version of the Bio Chemical Library [<xref ref-type="bibr" rid="CR27">27</xref>]. The goal of this study is not to compare the power of individual fingerprints; see Sastry [<xref ref-type="bibr" rid="CR28">28</xref>] for an extensive comparison.</p>
    </sec>
    <sec id="Sec5">
      <title>Chemical similarity</title>
      <p id="Par17">To fairly compare methods during experiments, the Tanimoto score is used consistently. Given two binary fingerprints <inline-formula id="IEq15"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {A}}$$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="double-struck">A</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {B}}$$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="double-struck">B</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq16.gif"/></alternatives></inline-formula> of equal length:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Tani({\mathbb {A}},{\mathbb {B}})=\frac{|{\mathbb {A}} \cap {\mathbb {B}}|}{|{\mathbb {A}} \cup {\mathbb {B}}|} \end{aligned}$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>T</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="double-struck">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="double-struck">B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="double-struck">A</mml:mi><mml:mo>∩</mml:mo><mml:mi mathvariant="double-struck">B</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="double-struck">A</mml:mi><mml:mo>∪</mml:mo><mml:mi mathvariant="double-struck">B</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2017_248_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>Given two fingerprints <inline-formula id="IEq17"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {X}}$$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="double-struck">X</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {Y}}$$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="double-struck">Y</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq18.gif"/></alternatives></inline-formula> encoded as vectors of floats of length N:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Tani({\mathbb {X}},{\mathbb {Y}}) = \frac{\sum _{i=1}^Nx_i y_i}{\sum _{i=1}^N{x_i^2 + y_i^2 - x_i y_i}} \end{aligned}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>T</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="double-struck">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="double-struck">Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2017_248_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>
</p>
    </sec>
    <sec id="Sec6">
      <title>Performance metrics and curves</title>
      <p id="Par18">To assess overall classifier performance, the Area Under the receiver operating characteristic Curve (AUC) is used. To measure early retrieval performance, the Power Metric at 10% (<inline-formula id="IEq19"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {PM}_{10\%}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mtext>PM</mml:mtext><mml:mrow><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq19.gif"/></alternatives></inline-formula>) is used [<xref ref-type="bibr" rid="CR29">29</xref>]. The power metric is a function of the True Positive Rate (TPR) and False Positive Rate (FPR) at a given threshold. The power metric is statistically robust to variations in the threshold and ratio of active compounds over total number of compounds in a dataset. At the same time, the power metric is also sensitive to variations in model quality.<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} PM_{x\%} = \frac{TPR_{x\%}}{TPR_{x\%} + FPR_{x\%}} \end{aligned}$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>%</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>%</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2017_248_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>In some experiments, the accumulated number of actives is drawn. This curve is obtained by walking down a rank-ordered list of compounds (the X axis lists ranks of database molecules) and plotting on the Y axis the number of active molecules encountered so far.</p>
    </sec>
    <sec id="Sec7">
      <title>Consensus policies</title>
      <p id="Par19">In all methods described hereafter, there is no parameter fitting to any of the datasets. Also, no training using known actives and inactives is required prior to applying any of the methods.</p>
      <p id="Par20">A consensus query is formed by the combination of a set of query molecules (also called known actives) while following a consensus policy. The policy specifies how fingerprints are combined (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>A consensus fingerprint is created by combining the fingerprints of several known active molecules. The way to combine fingerprints is controlled by the consensus policy</p></caption><graphic xlink:href="13321_2017_248_Fig1_HTML" id="MO5"/></fig>
</p>
      <p id="Par21">Let <inline-formula id="IEq20"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {P}}$$\end{document}</tex-math><mml:math id="M32"><mml:mi mathvariant="double-struck">P</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq20.gif"/></alternatives></inline-formula> be the set of all protein targets. Let <italic>p</italic> be a given protein target (<inline-formula id="IEq21"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p \in {\mathbb {P}}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq21.gif"/></alternatives></inline-formula>).</p>
      <p id="Par22">Let <inline-formula id="IEq22"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {M}}$$\end{document}</tex-math><mml:math id="M36"><mml:mi mathvariant="double-struck">M</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq22.gif"/></alternatives></inline-formula> be the set of all tested molecules for <italic>p</italic>.</p>
      <p id="Par23">Let <italic>fp</italic>(<italic>m</italic>) be the fingerprint of molecule <inline-formula id="IEq23"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m \in {\mathbb {M}}.$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">M</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq23.gif"/></alternatives></inline-formula>
</p>
      <p id="Par24">Let <inline-formula id="IEq24"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {A}}$$\end{document}</tex-math><mml:math id="M40"><mml:mi mathvariant="double-struck">A</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq24.gif"/></alternatives></inline-formula> be the set of active molecules on <italic>p</italic> (<inline-formula id="IEq25"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {A}} \subset {\mathbb {M}}$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi mathvariant="double-struck">A</mml:mi><mml:mo>⊂</mml:mo><mml:mi mathvariant="double-struck">M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq25.gif"/></alternatives></inline-formula>).</p>
      <p id="Par25">Let <inline-formula id="IEq26"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {I}}$$\end{document}</tex-math><mml:math id="M44"><mml:mi mathvariant="double-struck">I</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq26.gif"/></alternatives></inline-formula> be the set of inactive molecules on <italic>p</italic> (<inline-formula id="IEq27"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {I}} = {\mathbb {M}} {\setminus} {\mathbb {A}}$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mi mathvariant="double-struck">I</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">M</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi mathvariant="double-struck">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq27.gif"/></alternatives></inline-formula>).</p>
      <p id="Par26">Let <inline-formula id="IEq28"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {Q}}$$\end{document}</tex-math><mml:math id="M48"><mml:mi mathvariant="double-struck">Q</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq28.gif"/></alternatives></inline-formula> be a randomly selected set of actives that will be used to build a consensus query of size <italic>N</italic> (<inline-formula id="IEq29"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {Q}} \subset {\mathbb {A}} \wedge |{\mathbb {Q}}| = N$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo>⊂</mml:mo><mml:mi mathvariant="double-struck">A</mml:mi><mml:mo>∧</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq29.gif"/></alternatives></inline-formula>). In this study, only two to 20 actives are used to create a consensus query (<inline-formula id="IEq30"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2 \le N \le 20$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mn>2</mml:mn><mml:mo>≤</mml:mo><mml:mi>N</mml:mi><mml:mo>≤</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq30.gif"/></alternatives></inline-formula>).</p>
      <p id="Par27">Let <inline-formula id="IEq31"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {C}} = {\mathbb {M}} \setminus {\mathbb {Q}}$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi mathvariant="double-struck">C</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">M</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq31.gif"/></alternatives></inline-formula> be the set of candidate molecules for <italic>p</italic>; sometimes referred to as the “database” of molecules to screen.</p>
      <p id="Par28">During a retrospective ligand-based virtual screening experiment, the active or inactive status of a molecule <inline-formula id="IEq32"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i \in {\mathbb {C}}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">C</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq32.gif"/></alternatives></inline-formula> is ignored, until the final computation of a performance metric or curve is triggered.</p>
      <p id="Par29">We call query <inline-formula id="IEq33"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_i$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq33.gif"/></alternatives></inline-formula> a molecule randomly drawn from <inline-formula id="IEq34"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {Q}}$$\end{document}</tex-math><mml:math id="M60"><mml:mi mathvariant="double-struck">Q</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq34.gif"/></alternatives></inline-formula>. Let <inline-formula id="IEq35"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$score(q_i, c_j) \mid q_i \in \mathbb {Q} \wedge c_j \in \mathbb {C}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo>∧</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">C</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq35.gif"/></alternatives></inline-formula> be the Tanimoto score of the fingerprint of the query molecule at index <italic>i</italic> with the fingerprint of the candidate molecule at index <italic>j</italic>. If <italic>x</italic> is a consensus query of fingerprint type, writing <inline-formula id="IEq36"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$score(x, c_j)$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq36.gif"/></alternatives></inline-formula> is also valid.</p>
      <p id="Par30">The list of policies described hereafter are: single, pessimist, optimist, realist and knowledgeable. Policies are sometimes abbreviated using their first four letter.</p>
      <p id="Par31">Let <inline-formula id="IEq37"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbb {O}$$\end{document}</tex-math><mml:math id="M66"><mml:mi mathvariant="double-struck">O</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq37.gif"/></alternatives></inline-formula> be the set of all consensus policies:</p>
      <p id="Par32"><inline-formula id="IEq38"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbb {O} = \{Sing,Oppo,Pess,Opti,Real,Know\}$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mi mathvariant="double-struck">O</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>O</mml:mi><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>O</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq38.gif"/></alternatives></inline-formula>.</p>
      <p id="Par33">Let <inline-formula id="IEq39"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$cscore(o, \mathbb {Q}, c_i)$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>o</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq39.gif"/></alternatives></inline-formula> be the consensus query score using policy <inline-formula id="IEq40"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o \in \mathbb {O}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>o</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq40.gif"/></alternatives></inline-formula> and set of known actives <inline-formula id="IEq41"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbb {Q}$$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="double-struck">Q</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq41.gif"/></alternatives></inline-formula> with candidate molecule <inline-formula id="IEq42"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i.$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq42.gif"/></alternatives></inline-formula>
</p>
      <sec id="d29e1707">
        <title>Single query</title>
        <p>In the single policy, each active is used in turn as the query molecule. This policy reproduces the average performance of using a single bioactive molecule as query instead of several.<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} cscore(Sing, q_i, c_i) = score(fp(q_i), fp(c_i)) \end{aligned}$$\end{document}</tex-math><mml:math id="M78" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2017_248_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>
</p>
      </sec>
      <sec id="d29e1814">
        <title>Opportunist consensus of scores</title>
        <p>The score assigned to a candidate molecule is the maximum score it gets over all query molecules. This consensus query is a set of fingerprints. In the literature [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR11">11</xref>], this method is classified as a data fusion method and called max of scores or minimum of ranks.<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} &amp;cons(Oppo, \mathbb {Q}) = \mathbb {Q}\\&amp;cscore(Oppo, \mathbb {Q}, c_i) = \\&amp;max\{score(fp(q_i), fp(c_i)) \forall q_i \in \mathbb {Q}\} \end{aligned}$$\end{document}</tex-math><mml:math id="M80" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>O</mml:mi><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>O</mml:mi><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∀</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2017_248_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>
</p>
      </sec>
      <sec id="d29e1985">
        <title>Pessimist</title>
        <p>The consensus query is the fingerprint resulting from doing a bitwise AND of all query fingerprints. This consensus is a single fingerprint. This is the “consensus bit pattern” from Xue et al. [<xref ref-type="bibr" rid="CR8">8</xref>]. <disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;x = cons(Pess, \mathbb {Q}) = \cap \{fp(q_i) \forall q_i \in \mathbb {Q}\}\\&amp;cscore(Pess, \mathbb {Q}, c_i) = score(x, fp(c_i)) \end{aligned}$$\end{document}</tex-math><mml:math id="M82" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∩</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∀</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2017_248_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>
</p>
      </sec>
      <sec id="d29e2149">
        <title>Optimist consensus of fingerprints</title>
        <p>he consensus query is the fingerprint resulting from doing a bit-wise OR of all query fingerprints. This consensus is a single fingerprint.<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;x = cons(Opti, \mathbb {Q}) = \cup \{fp(q_i) \forall q_i \in \mathbb {Q}\}\\&amp;cscore(Opti, \mathbb {Q}, c_i) = score(x, fp(c_i)) \end{aligned}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>O</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∪</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∀</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>O</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2017_248_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>
</p>
      </sec>
      <sec id="d29e2310">
        <title>Realist</title>
        <p> The consensus query is the float vector where each index <italic>i</italic> of the vector contains the probability for bit <italic>i</italic> of being set over all queries. This consensus is a single fingerprint.<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;x = cons(Real, \mathbb {Q}) =\\&amp;[p(bit_j = 1) \forall j \in bits(fp(q_i)) \forall q_i \in \mathbb {Q}]\\&amp;cscore(Real, \mathbb {Q}, c_i) = score(x, c_i) \end{aligned}$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∀</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2017_248_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>
</p>
      </sec>
      <sec id="d29e2510">
        <title>Knowledgeable</title>
        <p> This consensus is almost like the realist consensus, except that query molecule fingerprints are potency-scaled (cf. formula <xref rid="Equ1" ref-type="">1</xref>) prior to being taken into account. This consensus is a single fingerprint.<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\mathbb {Q}_w = potency\_scale(\mathbb {Q})\\&amp;x = cons(Know, \mathbb {Q}_w) =\\&amp;[p(bit_j = 1) \forall j \in bits(fp(q_i)) \forall q_i \in \mathbb {Q}_w]\\&amp;cscore(Know, \mathbb {Q}_w, c_i) = score(x, c_i) \end{aligned}$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>y</mml:mi><mml:mi>_</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∀</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2017_248_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>
</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Software</title>
      <p id="Par35">Our software, called Consent, is written in OCaml. OCaml is a statically-typed functional programming language allowing fast prototyping of scientific software [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
      <p id="Par36">We release all our software, scripts and datasets as open source. MACCS 166 bits (resp. ECFP4 2048 bits) fingerprints were computed using a small C++ program linked to Open Babel v2.4.1 (resp. RDkit v2015.03.1). MOLPRINT2D unfolded fingerprints are computed by Consent.</p>
      <p id="Par37">Consent can exploit multicore computers thanks to the Parmap [<xref ref-type="bibr" rid="CR31">31</xref>] library. Some of the dataset preparation, running of experiments and post processing of results were accelerated by PAR [<xref ref-type="bibr" rid="CR32">32</xref>].</p>
    </sec>
    <sec id="Sec9">
      <title>Experiments</title>
      <sec id="Sec10">
        <title>Consensus query experiments</title>
        <p id="Par38">The size of the consensus is varied from 2 to 20 actives. Experiments don’t go over 20 actives, because it is imaginable that if more than twenty actives are known for a given target, one might also have many known inactives and could be training a QSAR model. Also, some protein targets of our datasets only have 40 actives, so it is not allowed to use more than half of them to build a consensus query. Active molecules used to build a consensus query are randomly drawn from the actives of the given protein target. Actives used to build a consensus query are also removed from the database to screen. Hence, benchmarks don’t become artificially easier as the consensus size is grown.</p>
        <p id="Par39">On the NRLIST dataset, experiments are repeated at least a hundred times since this dataset is small. On the MLQSAR dataset, experiments are repeated up to 20 times. MLQSAR is quite large and calculating statistics on it is costly. When a performance curve is reported, this curve is the median curve obtained during experiments using the same (protein target, consensus size, consensus policy) experiment configuration triplet. Calculating this median curve is memory intensive, especially for MLQSAR.</p>
      </sec>
      <sec id="Sec11">
        <title>Speed experiments</title>
        <p id="Par40">Speed experiments were performed on PubChem SAID 485290, which contains 341,365 active and inactive molecules (largest dataset). The virtual screen was run once, then the median throughput (in molecule/s) of the five subsequent runs was computed.</p>
        <p id="Par41">Experiments were performed using a single core of an Intel Xeon CPU at 3.50 GHz on a Linux CentOS v6.8 workstation equipped with 64 GB or RAM.</p>
      </sec>
      <sec id="Sec12">
        <title>Potency-scaling experiments</title>
        <p id="Par42">In potency scaling experiments, two consensus policies are compared. The database of compounds for a given target is rank ordered several times and the median rank for each active molecule with each consensus policy is recorded.</p>
        <p id="Par43">To compare two consensus policies, active molecules are first ordered by decreasing IC50, then the difference of ranks between the two policies is measured. This allows to compute a delta rank plot. A negative delta rank is a positive outcome: the given active molecule went higher in the rank-ordered list of compounds (i.e. it is found earlier by the virtual screen). A positive delta rank is the opposite negative outcome.</p>
      </sec>
      <sec id="Sec13">
        <title>CPU-bounded experiments</title>
        <p id="Par44">In CPU-bounded experiments, two consensus policies are compared and the faster policy is allowed to score more molecules. For example, if policy <inline-formula id="IEq43"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_1$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq43.gif"/></alternatives></inline-formula> is two times faster than policy <inline-formula id="IEq44"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_2$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq44.gif"/></alternatives></inline-formula>. Then, <inline-formula id="IEq45"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_2$$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq45.gif"/></alternatives></inline-formula> will only screen a random half partition of the database while <inline-formula id="IEq46"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_1$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq46.gif"/></alternatives></inline-formula> will screen the whole database.</p>
        <p id="Par45">This experiment simulates an <italic>in silico</italic> combinatorial chemistry library enumeration [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR33">33</xref>–<xref ref-type="bibr" rid="CR36">36</xref>], where molecules are generated, fingerprinted and scored on the fly. The virtual screen is stopped after some amount of time, not because the immense library enumeration has finished.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Results</title>
    <sec id="Sec15">
      <title>Effect of the consensus size</title>
      <sec id="Sec16">
        <title>Discriminative power</title>
        <p id="Par46">
          <fig id="Fig2">
            <label>Fig. 2</label>
            <caption>
              <p>Effect of the consensus size on the consensus query global classification performance (AUC) and early recovery capability (<inline-formula id="IEq47"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {PM}_{1\%}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mtext>PM</mml:mtext><mml:mrow><mml:mn>1</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq47.gif"/></alternatives></inline-formula>). Experiment: HTS dataset PubChem SAID 463087, ECFP4 fingerprint and optimist consensus. Values shown are medians over 100 experiments ± 1 median absolute deviation [<xref ref-type="bibr" rid="CR37">37</xref>]</p>
            </caption>
            <graphic xlink:href="13321_2017_248_Fig2_HTML" id="MO12"/>
          </fig>
        </p>
        <p id="Par47">As the consensus size is growing, the power to discriminate between active and inactive molecules increases.</p>
        <p id="Par48">When looking at the global performance of the classifier (monitored by its AUC) as well as its early recovery capability (monitored by its <inline-formula id="IEq48"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {PM}_{1\%}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mtext>PM</mml:mtext><mml:mrow><mml:mn>1</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq48.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR29">29</xref>]), there is a clear improvement correlated with the growth in consensus size (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). On this target, there is no more improvement in early recovery capability once a consensus of size twelve is reached. A bigger consensus only improves the AUC.</p>
      </sec>
      <sec id="Sec17">
        <title>Speed</title>
        <p id="Par49">
          <fig id="Fig3">
            <label>Fig. 3</label>
            <caption>
              <p>Speed comparison between the opportunist (oppo) and optimist (opti) consensus policies on ECFP4 fingerprints as a function of the consensus size</p>
            </caption>
            <graphic xlink:href="13321_2017_248_Fig3_HTML" id="MO13"/>
          </fig>
        </p>
        <p id="Par50">While a consensus fingerprint query screens at a constant speed of ~ 130,000 molecule/s (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), this is not the case for a consensus based on scores.</p>
        <p id="Par51">Figure <xref rid="Fig3" ref-type="fig">3</xref> shows a comparison of speed between the optimist and the opportunist consensus. As the number of known actives used to build the consensus is growing, the opportunist consensus becomes slower.</p>
      </sec>
    </sec>
    <sec id="Sec18">
      <title>Effect of the consensus policy and fingerprint type</title>
      <sec id="Sec19">
        <title>NRLIST dataset</title>
        <p id="Par52">
          <fig id="Fig4">
            <label>Fig. 4</label>
            <caption>
              <p>Cumulative distribution functions of AUC values for consensus of sizes two, five and ten. The consensus was built using MACCS fingerprints in the left column, ECFP4 fingerprints in the middle and UMOP2D fingerprints on the right. The lower a curve is, the better the corresponding method. The vertical gray bar at AUC 0.5 allows to find the least random method (lowest curve)</p>
            </caption>
            <graphic xlink:href="13321_2017_248_Fig4_HTML" id="MO14"/>
          </fig>
          <fig id="Fig5">
            <label>Fig. 5</label>
            <caption>
              <p>Cumulative distribution functions of <inline-formula id="IEq50"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {PM}_{10\%}$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mtext>PM</mml:mtext><mml:mrow><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq50.gif"/></alternatives></inline-formula> values for consensus of sizes two, five and ten. The consensus was built using MACCS fingerprints in the left column, ECFP4 fingerprints in the middle and UMOP2D fingerprints on the right. The lower a curve is, the better the corresponding method</p>
            </caption>
            <graphic xlink:href="13321_2017_248_Fig5_HTML" id="MO15"/>
          </fig>
        </p>
        <p id="Par53">On this dataset, results across consensus policies and fingerprints can be seen in Fig. <xref rid="Fig4" ref-type="fig">4</xref>.</p>
        <p id="Par54">For MACCS fingerprints, the most efficient policy is the opportunist, followed by the realist consensus. The optimist consensus performs less well than a single query when the AUC reached is greater than 0.85.</p>
        <p id="Par55">For ECFP4 fingerprints, the most efficient policy is also the opportunist one. Then, the realist consensus or the optimist consensus (for AUC ≥ 0.75) are the most powerful. With this fingerprint, all consensus policies have a better performance than a single query, as can be seen in the gap between the black curve and all other curves.</p>
        <p id="Par56">For the UMOP2D fingerprint, the trend is similar than ECFP4. However, the optimist consensus is always better than the realist one and can even outperform the opportunist consensus for PM values ≥ 0.8 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>).</p>
        <p id="Par57">The realist consensus is not shown on these AUC plots. Its performance is very similar to the realist consensus but its effect is different and shown later in “<xref rid="Sec21" ref-type="sec">Effect of potency-scaling</xref>” section.</p>
        <p id="Par58">Across fingerprints, the least random and best performing method is always the opportunist consensus. However, as the consensus size gets smaller, the spread between curves (and hence the performance difference between methods) becomes smaller.</p>
        <p id="Par59">It is interesting to observe that the trend is different for each fingerprint. If something is observed for one fingerprint, it might not hold for other fingerprints.</p>
      </sec>
      <sec id="Sec20">
        <title>MLQSAR dataset</title>
        <p id="Par60">
          <fig id="Fig6">
            <label>Fig. 6</label>
            <caption>
              <p>Cumulative distribution functions of AUC values on the MLQSAR dataset. Cf. Fig. <xref rid="Fig4" ref-type="fig">4</xref> for legend details</p>
            </caption>
            <graphic xlink:href="13321_2017_248_Fig6_HTML" id="MO16"/>
          </fig>
          <fig id="Fig7">
            <label>Fig. 7</label>
            <caption>
              <p>Cumulative distribution functions of <inline-formula id="IEq53"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {PM}_{10\%}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mtext>PM</mml:mtext><mml:mrow><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq53.gif"/></alternatives></inline-formula> values on the MLQSAR dataset. Cf. Fig. <xref rid="Fig5" ref-type="fig">5</xref> for legend details</p>
            </caption>
            <graphic xlink:href="13321_2017_248_Fig7_HTML" id="MO17"/>
          </fig>
        </p>
        <p id="Par61">Results on this dataset differ from results on the NRLIST. As a general trend, the spread between curves for different consensus policies is smaller. The biggest difference is that even by looking only at AUC values, the optimist consensus on MACCS fingerprints and the realist consensus on UMOP2D fingerprints are clearly disqualified. They perform worse than a single query. While on the NRLIST, this observation can only be made by looking at CDF curves of PM values.</p>
        <p id="Par62">Experiments on this dataset show that combining the realist policy with the MACCS or ECFP4 fingerprints can outperform the performance of the opportunist consensus (left and middle columns of Figs. <xref rid="Fig6" ref-type="fig">6</xref> and <xref rid="Fig7" ref-type="fig">7</xref>, yellow curve under all other curves).<table-wrap id="Tab3"><label>Table 3</label><caption><p>Median AUC and PM values with their median absolute deviations</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Metric</th><th char="." align="left" rowspan="2">Csize</th><th align="left" rowspan="2">Policy</th><th char="±" align="left" colspan="3">MLQSAR dataset</th><th char="±" align="left" colspan="3">NRLIST dataset</th></tr><tr><th char="±" align="left">MACCS</th><th char="±" align="left">ECFP4</th><th char="±" align="left">UMOP2D</th><th char="±" align="left">MACCS</th><th char="±" align="left">ECFP4</th><th char="±" align="left">UMOP2D</th></tr></thead><tbody><tr><td align="left" rowspan="12">AUC</td><td char="." align="char" rowspan="4">2</td><td align="left">Oppo</td><td char="±" align="char">0.542±0.059<sup>✠▼</sup>
</td><td char="±" align="char">0.548±0.052<sup>✠</sup>
</td><td char="±" align="char">0.571±0.055</td><td char="±" align="char">0.643±0.119</td><td char="±" align="char">0.699±0.124</td><td char="±" align="char">0.696±0.131</td></tr><tr><td align="left">Opti</td><td char="±" align="char">0.514±0.061<sup>▼</sup>
</td><td char="±" align="char">0.542±0.046<sup>✠◊</sup>
</td><td char="±" align="char">0.564±0.057<sup>◊</sup>
</td><td char="±" align="char">0.624±0.115</td><td char="±" align="char">0.698±0.129<sup>◊</sup>
</td><td char="±" align="char">0.700± 0.142<sup>◊</sup>
</td></tr><tr><td align="left">Real</td><td char="±" align="char">0.549±0.061<sup>◊</sup>
</td><td char="±" align="char">0.052±0.053<sup>✠◊</sup>
</td><td char="±" align="char">0.518±0.060<sup>▼</sup>
</td><td char="±" align="char">0.632±0.106</td><td char="±" align="char">0.696±0.119<sup>◊</sup>
</td><td char="±" align="char">0.646±0.105</td></tr><tr><td align="left">Sing</td><td char="±" align="char">0.544±0.064<sup>◊</sup>
</td><td char="±" align="char">0.530±0.053<sup>◊</sup>
</td><td char="±" align="char">0.540±0.051</td><td char="±" align="char">0.581±0.100</td><td char="±" align="char">0.603±0.104</td><td char="±" align="char">0.598±0.122</td></tr><tr><td char="." align="char" rowspan="4">5</td><td align="left">Oppo</td><td char="±" align="char">0.543±0.055</td><td char="±" align="char">0.530±0.053</td><td char="±" align="char">0.577±0.057</td><td char="±" align="char">0.577±0.057</td><td char="±" align="char">0.814±0.088</td><td char="±" align="char">0.799±0.992</td></tr><tr><td align="left">Opti</td><td char="±" align="char">0.460±0.073<sup>▼</sup>
</td><td char="±" align="char">0.536±0.040</td><td char="±" align="char">0.569±0.051<sup>◊</sup>
</td><td char="±" align="char">0.625±0.092</td><td char="±" align="char">0.802±0.111</td><td char="±" align="char">0.802±0.098</td></tr><tr><td align="left">Real</td><td char="±" align="char">0.569±0.058<sup>◊</sup>
</td><td char="±" align="char">0.562±0.052<sup>◊</sup>
</td><td char="±" align="char">0.496±0.057<sup>▼</sup>
</td><td char="±" align="char">0.675±0.086</td><td char="±" align="char">0.774±0.087</td><td char="±" align="char">0.709±0.092</td></tr><tr><td align="left">Sing</td><td char="±" align="char">0.536±0.065</td><td char="±" align="char">0.521±0.051</td><td char="±" align="char">0.536±0.053</td><td char="±" align="char">0.574±0.100</td><td char="±" align="char">0.600±0.106</td><td char="±" align="char">0.598±0.123</td></tr><tr><td char="." align="char" rowspan="4">10</td><td align="left">Oppo</td><td char="±" align="char">0.569±0.047</td><td char="±" align="char">0.586±0.047</td><td char="±" align="char">0.607±0.051</td><td char="±" align="char">0.847±0.061</td><td char="±" align="char">0.873±0.055</td><td char="±" align="char">0.856±0.060</td></tr><tr><td align="left">Opti</td><td char="±" align="char">0.435±0.090<sup>▼</sup>
</td><td char="±" align="char">0.554±0.045</td><td char="±" align="char">0.591±0.043<sup>◊</sup>
</td><td char="±" align="char">0.601±0.078</td><td char="±" align="char">0.853±0.081</td><td char="±" align="char">0.841±0.084</td></tr><tr><td align="left">Real</td><td char="±" align="char">0.571±0.065<sup>◊</sup>
</td><td char="±" align="char">0.578±0.044</td><td char="±" align="char">0.495±0.053<sup>▼</sup>
</td><td char="±" align="char">0.705±0.078</td><td char="±" align="char">0.803±0.083</td><td char="±" align="char">0.738±0.081</td></tr><tr><td align="left">Sing</td><td char="±" align="char">0.532±0.067</td><td char="±" align="char">0.525±0.054</td><td char="±" align="char">0.537±0.049</td><td char="±" align="char">0.573±0.099</td><td char="±" align="char">0.597±0.107</td><td char="±" align="char">0.595±0.125</td></tr><tr><td align="left" rowspan="12"><inline-formula id="IEq107"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {PM}_{10\%}$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mtext>PM</mml:mtext><mml:mrow><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq107.gif"/></alternatives></inline-formula></td><td char="." align="char" rowspan="4">2</td><td align="left">Oppo</td><td char="±" align="char">0.588±0.059<sup>✠</sup>
</td><td char="±" align="char">0.615±0.058</td><td char="±" align="char">0.615±0.074</td><td char="±" align="char">0.912±0.088</td><td char="±" align="char">0.933±0.067</td><td char="±" align="char">0.933±0.067</td></tr><tr><td align="left">Opti</td><td char="±" align="char">0.542±0.071<sup>▼</sup>
</td><td char="±" align="char">0.609±0.053<sup>◊</sup>
</td><td char="±" align="char">0.621±0.073<sup>✠◊</sup>
</td><td char="±" align="char">0.875±0.116</td><td char="±" align="char">0.941±0.059<sup>◊</sup>
</td><td char="±" align="char">0.930±0.070<sup>◊</sup>
</td></tr><tr><td align="left">Real</td><td char="±" align="char">0.588±0.066<sup>✠◊</sup>
</td><td char="±" align="char">0.593±0.074<sup>✠◊</sup>
</td><td char="±" align="char">0.536±0.074<sup>▼</sup>
</td><td char="±" align="char">0.896±0.104<sup>◊</sup>
</td><td char="±" align="char">0.933±0.067<sup>◊</sup>
</td><td char="±" align="char">0.758±0.140 </td></tr><tr><td align="left">Sing</td><td char="±" align="char">0.575±0.077<sup>◊</sup>
</td><td char="±" align="char">0.585±0.075</td><td char="±" align="char">0.585±0.084</td><td char="±" align="char">0.826±0.155</td><td char="±" align="char">0.870±0.130</td><td char="±" align="char">0.832±0.163</td></tr><tr><td char="." align="char" rowspan="4">5</td><td align="left">Oppo</td><td char="±" align="char">0.600±0.058</td><td char="±" align="char">0.635±0.065</td><td char="±" align="char">0.651±0.060</td><td char="±" align="char">0.950±0.050</td><td char="±" align="char">0.968±0.032</td><td char="±" align="char">0.959±0.041</td></tr><tr><td align="left">Opti</td><td char="±" align="char">0.452±0.075<sup>▼</sup>
</td><td char="±" align="char">0.613±0.059<sup>◊</sup>
</td><td char="±" align="char">0.654±0.055<sup>◊</sup>
</td><td char="±" align="char">0.804±0.137<sup>▼</sup>
</td><td char="±" align="char">0.979±0.021</td><td char="±" align="char">0.969±0.031</td></tr><tr><td align="left">Real</td><td char="±" align="char">0.612±0.073<sup>◊</sup>
</td><td char="±" align="char">0.623±0.068<sup>◊</sup>
</td><td char="±" align="char">0.523±0.068<sup>▼</sup>
</td><td char="±" align="char">0.899±0.101</td><td char="±" align="char">0.955±0.045</td><td char="±" align="char">0.763±0.160<sup>▼</sup>
</td></tr><tr><td align="left">Sing</td><td char="±" align="char">0.569±0.086</td><td char="±" align="char">0.568±0.079</td><td char="±" align="char">0.579±0.084</td><td char="±" align="char">0.817±0.152</td><td char="±" align="char">0.866±0.130</td><td char="±" align="char">0.830±0.161</td></tr><tr><td char="." align="char" rowspan="4">10</td><td align="left">Oppo</td><td char="±" align="char">0.637±0.047</td><td char="±" align="char">0.690±0.045</td><td char="±" align="char">0.688±0.043</td><td char="±" align="char">0.964±0.036</td><td char="±" align="char">0.968±0.032</td><td char="±" align="char">0.956±0.040</td></tr><tr><td align="left">Opti</td><td char="±" align="char">0.405±0.099<sup>▼</sup>
</td><td char="±" align="char">0.660±0.051</td><td char="±" align="char">0.674±0.041<sup>◊</sup>
</td><td char="±" align="char">0.726±0.170<sup>▼</sup>
</td><td char="±" align="char">0.973±0.027</td><td char="±" align="char">0.969±0.031</td></tr><tr><td align="left">Real</td><td char="±" align="char">0.617±0.063<sup>◊</sup>
</td><td char="±" align="char">0.635±0.074</td><td char="±" align="char">0.528±0.063<sup>▼</sup>
</td><td char="±" align="char">0.896±0.090</td><td char="±" align="char">0.951±0.049</td><td char="±" align="char">0.724±0.146<sup>▼</sup>
</td></tr><tr><td align="left">Sing</td><td char="±" align="char">0.571±0.082</td><td char="±" align="char">0.576±0.078</td><td char="±" align="char">0.576±0.079</td><td char="±" align="char">0.809±0.158</td><td char="±" align="char">0.862±0.134</td><td char="±" align="char">0.830±0.155</td></tr></tbody></table><table-wrap-foot><p>‘csize’ stands for consensus size. A ‘✠’ indicates that a distribution of peformance metric values is not significantly different from the one of the single policy (Kolmogorov–Smirnov test with p-value <inline-formula id="IEq54"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 0.05$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq54.gif"/></alternatives></inline-formula>). A ‘◊’ indicates that a distribution of peformance metric values is not significantly different from the one of the opportunist policy. A ‘▼’ indicates performance worse than the single policy</p></table-wrap-foot></table-wrap>
</p>
        <p id="Par63">Table <xref rid="Tab3" ref-type="table">3</xref> provides a bird’s-eye view of results shown in Figs. <xref rid="Fig4" ref-type="fig">4</xref>, <xref rid="Fig5" ref-type="fig">5</xref>, <xref rid="Fig6" ref-type="fig">6</xref> and <xref rid="Fig7" ref-type="fig">7</xref> (same protocol but different experiment).</p>
      </sec>
    </sec>
    <sec id="Sec21">
      <title>Effect of potency-scaling</title>
      <p id="Par64">
        <fig id="Fig8">
          <label>Fig. 8</label>
          <caption>
            <p>Effect of applying potency scaling (knowledgeable policy) or not (realist policy) to build the consensus. The median change in rank is shown over 1000 experiments for all actives of the NRLIST PR-target (NRLIST target with the most active ligands) and MACCS fingerprints. Active molecules are ranked ordered from most to least potent (left to right)</p>
          </caption>
          <graphic xlink:href="13321_2017_248_Fig8_HTML" id="MO27"/>
        </fig>
      </p>
      <p id="Par65">The effect of potency scaling is that it brings highly active molecules closer to the query but pushes further away less potent molecules (Fig. <xref rid="Fig8" ref-type="fig">8</xref>).<table-wrap id="Tab4"><label>Table 4</label><caption><p>Cases where the knowledgeable consensus policy brings the most active molecules closer to the query compared to another policy</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Size</th><th align="left">Know verus real</th><th align="left">Know versus oppo</th></tr></thead><tbody><tr><td align="left">10</td><td align="left">10/10</td><td align="left">8/10</td></tr><tr><td align="left">15</td><td align="left">10/10</td><td align="left">7/10</td></tr><tr><td align="left">20</td><td align="left">10/10</td><td align="left">7/10</td></tr></tbody></table><table-wrap-foot><p>Experiment: all NRLIST targets, median change in rank over 500 experiments and ECFP4 fingerprint</p></table-wrap-foot></table-wrap>
</p>
      <p id="Par66">In our experiments (Table <xref rid="Tab4" ref-type="table">4</xref>) and in terms of bringing the most active molecules closer to the query, there is a clear advantage of the knowledgeable policy (which is potency scaled) versus the realist one. On the NRLIST, the knowledgeable policy is also better than the opportunist one. However, on the two MLQSAR targets with a wide distribution of potency values, this behavior is observed only once.</p>
      <sec id="Sec22">
        <title>CPU-bounded experiments</title>
        <p id="Par67">
          <fig id="Fig9">
            <label>Fig. 9</label>
            <caption>
              <p>CPU-bounded experiment on the NRLIST AR- target (left) and PubChem SAID 485290 (right)</p>
            </caption>
            <graphic xlink:href="13321_2017_248_Fig9_HTML" id="MO28"/>
          </fig>
          <table-wrap id="Tab5">
            <label>Table 5</label>
            <caption>
              <p>Cases where the optimist query outperforms the opportunist one in CPU-bounded experiments</p>
            </caption>
            <table frame="hsides" rules="groups">
              <thead>
                <tr>
                  <th align="left">Size</th>
                  <th char="." align="left">Speedup</th>
                  <th align="left">MLQSAR</th>
                  <th align="left">NRLIST</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">5</td>
                  <td char="." align="char">1.46</td>
                  <td align="left">6/9</td>
                  <td align="left">9/10</td>
                </tr>
                <tr>
                  <td align="left">10</td>
                  <td char="." align="char">2.05</td>
                  <td align="left">7/9</td>
                  <td align="left">8/10</td>
                </tr>
                <tr>
                  <td align="left">20</td>
                  <td char="." align="char">3.19</td>
                  <td align="left">7/9</td>
                  <td align="left">8/10</td>
                </tr>
              </tbody>
            </table>
            <table-wrap-foot>
              <p>Size: consensus size; speedup: how many times the optimist consensus is faster at scoring than the opportunist consensus. Experiment: compute the accumulated curve of actives on MLQSAR (median curve over 10 experiments) and NRLIST (median curve over 50 experiments). The number of times where the optimist curve dominates the opportunist one is reported</p>
            </table-wrap-foot>
          </table-wrap>
        </p>
        <p id="Par68">Consensus queries using a single fingerprint can be several times faster than a consensus based on scores (Table <xref rid="Tab5" ref-type="table">5</xref>). For example, a consensus query using only five actives is 1.46 times faster than a consensus of five scores. With 20 actives, it becomes 3.19 times faster.</p>
        <p id="Par69">In theory, a consensus made of N scores could be up to N times slower than a fingerprint consensus. However, our software being optimized, the slowdown is not so high.</p>
        <p id="Par70">In the case where the computational exploration of the chemical space is limited by the speed at which molecules can be scored, there is an advantage at using a consensus query which is faster than a consensus of scores (Fig. <xref rid="Fig9" ref-type="fig">9</xref> and Table <xref rid="Tab5" ref-type="table">5</xref>). In at least six out of nine targets from the MLQSAR dataset, the optimist consensus outperforms the opportunist one in CPU-bounded experiments. On the NRLIST dataset, the same trend is observed in at least eight out of ten targets.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec23">
    <title>Discussion</title>
    <p id="Par71">We say a consensus fingerprint degenerates when its performance become worse than that of a single query, either in terms of global classification (AUC) or early retrieval (<inline-formula id="IEq147"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {PM}_{x\%}$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mtext>PM</mml:mtext><mml:mrow><mml:mi>x</mml:mi><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_248_Article_IEq147.gif"/></alternatives></inline-formula>). Based on Figs. <xref rid="Fig4" ref-type="fig">4</xref>, <xref rid="Fig5" ref-type="fig">5</xref>, <xref rid="Fig6" ref-type="fig">6</xref>, <xref rid="Fig7" ref-type="fig">7</xref> and Table <xref rid="Tab3" ref-type="table">3</xref>, we give some warnings and recommendations.</p>
    <p id="Par72">It is safe to use the opportunist policy (consensus of scores) for all the fingerprints we tested. Also, five actives are enough to build a consensus query that will perform significantly differently compared to the single policy (Table <xref rid="Tab3" ref-type="table">3</xref>).</p>
    <p id="Par73">In our setting, all consensus policies are safe to use with the ECFP4 fingerprint. We note that the realistic consensus sometimes outperform the opportunist one in terms of early retrieval (middle column in Fig. <xref rid="Fig7" ref-type="fig">7</xref>; PM values ≥ 0.7).</p>
    <p id="Par74">The MACCS fingerprint combined with the optimist policy must be avoided. A diverse set of actives sets too many bits in the consensus fingerprint, rendering it non selective (left column in Figs. <xref rid="Fig5" ref-type="fig">5</xref>, <xref rid="Fig6" ref-type="fig">6</xref>, <xref rid="Fig7" ref-type="fig">7</xref>). MACCS fingerprints combined via the realist policy can be used. Their performance approaches the consensus of scores in the HTS datasets (left column in Figs. <xref rid="Fig6" ref-type="fig">6</xref>, <xref rid="Fig7" ref-type="fig">7</xref>).</p>
    <p id="Par75">The UMOP2D fingerprint combined with the realist policy must also be avoided (right column in Figs. <xref rid="Fig5" ref-type="fig">5</xref>, <xref rid="Fig6" ref-type="fig">6</xref>, <xref rid="Fig7" ref-type="fig">7</xref>). However, UMOP2D fingerprints combined via the optimist policy allow to approach the performance of the opportunist consensus in terms of AUC and PM (right column in Figs. <xref rid="Fig4" ref-type="fig">4</xref>, <xref rid="Fig5" ref-type="fig">5</xref>, <xref rid="Fig6" ref-type="fig">6</xref>, <xref rid="Fig7" ref-type="fig">7</xref>).</p>
    <p id="Par76">The pessimist consensus is not used in our study because when molecules are diverse, the number of set bits in the consensus fingerprint becomes too small, so the resulting fingerprint is non selective. This consensus has been used in the past [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR8">8</xref>], but for series of congeneric molecules while our experiments use diverse and randomly selected actives.</p>
    <p id="Par77">While we don’t completely disregard the knowledgeable policy, it must be used with caution. If the potency values spread several order of magnitudes and the potency measures are of high quality, using this policy might be useful.</p>
  </sec>
  <sec id="Sec24">
    <title>Conclusions</title>
    <p id="Par78"> In this study, the effect of consensus size, consensus policy and chemical fingerprint choice was benchmarked on decoy-free datasets. It is hoped that these results will be predictive of performance in real world applications.</p>
    <p id="Par79">The consensus policies that were extensively benchmarked are: opportunist (a consensus of scores), optimist (a union of fingerprints), realist (an average of fingerprints) and knowledgeable (an average of potency-scaled fingerprints).</p>
    <p id="Par80">Our results confirm the reliability and performance of the consensus of scores (max score/min rank).</p>
    <p id="Par81">A consensus fingerprint allows to rank-order molecules as fast as a regular fingerprint-based similarity search. If the exploration of the chemical space is limited by the speed at which molecules can be scored, an optimist consensus of ECFP4 or UMOP2D fingerprints can outperform a consensus of scores in terms of finding more active molecules.</p>
    <p id="Par82">As a final remark, consensus queries have a few advantages that are worth remembering:<list list-type="order"><list-item><p id="Par83">They can be used even when the number of active molecules is scarce. This is interesting in the case of compounds found from literature, patent searches or as a followup to a structure-based virtual screening campaign which found only a handful of actives.</p></list-item><list-item><p id="Par84">They can be used even when there is no information available about inactive molecules.</p></list-item><list-item><p id="Par85">They don’t require a training step prior to be used as classifiers.</p></list-item><list-item><p id="Par86">They are so simple that they can be created and used by non machine learning experts.</p></list-item><list-item><p id="Par87">Last but not least, consensus queries can be used as an additional method, perpendicular to other <italic>in silico</italic> approaches, to confirm which molecules to purchase for wet-lab testing.</p></list-item></list>
<bold>Availability and requirements</bold>
<list list-type="bullet"><list-item><p id="Par88">Project Name: Consent</p></list-item><list-item><p id="Par89">Project home page:</p></list-item><list-item><p id="Par90"><ext-link ext-link-type="uri" xlink:href="https://github.com/UnixJunkie/consent">https://github.com/UnixJunkie/consent</ext-link></p></list-item><list-item><p id="Par91">Software archives:</p></list-item><list-item><p id="Par92"><ext-link ext-link-type="uri" xlink:href="http://meilerlab.org/software">http://meilerlab.org/software</ext-link> or</p></list-item><list-item><p id="Par93"><ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/1006728">https://zenodo.org/record/1006728</ext-link></p></list-item><list-item><p id="Par94">Operating system: Linux, Mac OS X</p></list-item><list-item><p id="Par95">Programming language: OCaml</p></list-item><list-item><p id="Par96">Other requirements: the OCaml Package Manager (OPAM), Open Babel, RDkit</p></list-item><list-item><p id="Par97">Dataset:</p></list-item><list-item><p id="Par98"><ext-link ext-link-type="uri" xlink:href="https://data.mendeley.com/datasets/52hjy6vjwb/1">https://data.mendeley.com/datasets/52hjy6vjwb/1</ext-link></p></list-item><list-item><p id="Par99">License: GPL</p></list-item><list-item><p id="Par100">Any restrictions to use by non-academics: None</p></list-item></list>
</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par13">IC50: 50% Inhibitory Concentration. An IC50 value represents the concentration of a drug that is required to inhibit a given biological process by 50% invitro.</p>
    </fn>
    <fn id="Fn2">
      <label>2</label>
      <p id="Par130">
        <ext-link ext-link-type="uri" xlink:href="http://nrlist.drugdesign.fr">http://nrlist.drugdesign.fr.</ext-link>
      </p>
    </fn>
    <fn id="Fn3">
      <label>3</label>
      <p id="Par15">
        <ext-link ext-link-type="uri" xlink:href="http://www.meilerlab.org/qsar_pubchem_benchmark_2012.">http://www.meilerlab.org/qsar_pubchem_benchmark_2012.</ext-link>
      </p>
    </fn>
  </fn-group>
  <ack>
    <title>Authors' contributions</title>
    <p>FB designed the study, wrote the software, ran experiments and prepared figures and tables. OV implemented MOLPRINT2D fingerprints in the BCL and computed the MOLPRINT2D fingerprints that were used early in the study. All authors have analyzed the results and participated in writing the manuscript. All authors read and approved the final manuscript.</p>
    <sec id="FPar1">
      <title>Acknowledgments</title>
      <p id="Par102">Work in the Meiler laboratory is supported through NIH (R01 GM080403, R01 GM099842) and NSF (CHE 1305874). FB is a JSPS international research fellow <ext-link ext-link-type="uri" xlink:href="http://www.jsps.go.jp/english/">http://www.jsps.go.jp/english/</ext-link>. FB acknowledges the use of MarvinView v17.1.3 and JKlustor v0.07 from ChemAxon’s JChem (2017) <ext-link ext-link-type="uri" xlink:href="http://www.chemaxon.com">http://www.chemaxon.com</ext-link>.</p>
    </sec>
    <sec id="FPar2">
      <title>Competing interests</title>
      <p id="Par103">The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar4">
      <title>Consent for publication</title>
      <p id="Par105">Not applicable.</p>
    </sec>
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par104">Not applicable.</p>
    </sec>
    <sec id="FPar5">
      <title>Publisher’s Note</title>
      <p id="Par106">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lake</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Salakhutdinov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tenenbaum</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Human-level concept learning through probabilistic program induction</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>350</volume>
        <issue>6266</issue>
        <fpage>1332</fpage>
        <lpage>1338</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aab3050</pub-id>
        <pub-id pub-id-type="pmid">26659050</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altae-Tran</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ramsundar</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pappu</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Pande</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Low data drug discovery with one-shot learning</article-title>
        <source>ACS Cent Sci</source>
        <year>2017</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>283</fpage>
        <lpage>293</lpage>
        <pub-id pub-id-type="doi">10.1021/acscentsci.6b00367</pub-id>
        <pub-id pub-id-type="pmid">28470045</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Maggiora</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <source>Concepts and applications of molecular similarity</source>
        <year>1990</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bender</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Glen</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Molecular similarity: a key technique in molecular informatics</article-title>
        <source>Org Biomol Chem</source>
        <year>2004</year>
        <volume>2</volume>
        <fpage>3204</fpage>
        <lpage>3218</lpage>
        <pub-id pub-id-type="doi">10.1039/b409813g</pub-id>
        <pub-id pub-id-type="pmid">15534697</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willett</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Similarity-based virtual screening using 2D fingerprints</article-title>
        <source>Drug Discov Today</source>
        <year>2006</year>
        <volume>11</volume>
        <issue>23</issue>
        <fpage>1046</fpage>
        <lpage>1053</lpage>
        <pub-id pub-id-type="doi">10.1016/j.drudis.2006.10.005</pub-id>
        <pub-id pub-id-type="pmid">17129822</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shemetulskis</surname>
            <given-names>NE</given-names>
          </name>
          <name>
            <surname>Weininger</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Blankley</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Humblet</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Stigmata: an algorithm to determine structural commonalities in diverse datasets</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>1996</year>
        <volume>36</volume>
        <issue>4</issue>
        <fpage>862</fpage>
        <lpage>871</lpage>
        <pub-id pub-id-type="doi">10.1021/ci950169+</pub-id>
        <pub-id pub-id-type="pmid">8768771</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Singh</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Sheridan</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Fluder</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Hull</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>Mining the chemical quarry with joint chemical probes: an application of latent semantic structure indexing (LaSSI) and toposim (Dice) to chemical database mining</article-title>
        <source>J Med Chem</source>
        <year>2001</year>
        <volume>44</volume>
        <issue>10</issue>
        <fpage>1564</fpage>
        <lpage>1575</lpage>
        <pub-id pub-id-type="doi">10.1021/jm000398+</pub-id>
        <pub-id pub-id-type="pmid">11334566</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xue</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stahura</surname>
            <given-names>FL</given-names>
          </name>
          <name>
            <surname>Godden</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Bajorath</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Fingerprint scaling increases the probability of identifying molecules with similar activity in virtual screening calculations</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>2001</year>
        <volume>41</volume>
        <issue>3</issue>
        <fpage>746</fpage>
        <lpage>753</lpage>
        <pub-id pub-id-type="doi">10.1021/ci000311t</pub-id>
        <pub-id pub-id-type="pmid">11410055</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hert</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Willett</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wilton</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Acklin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Azzaoui</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jacoby</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Schuffenhauer</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Comparison of fingerprint-based methods for virtual screening using multiple bioactive reference structures</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>2004</year>
        <volume>44</volume>
        <issue>3</issue>
        <fpage>1177</fpage>
        <lpage>1185</lpage>
        <pub-id pub-id-type="doi">10.1021/ci034231b</pub-id>
        <pub-id pub-id-type="pmid">15154787</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Godden</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Stahura</surname>
            <given-names>FL</given-names>
          </name>
          <name>
            <surname>Bajorath</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Pot-dmc: a virtual screening method for the identification of potent hits</article-title>
        <source>J Med Chem</source>
        <year>2004</year>
        <volume>47</volume>
        <issue>23</issue>
        <fpage>5608</fpage>
        <lpage>5611</lpage>
        <pub-id pub-id-type="doi">10.1021/jm049505g</pub-id>
        <pub-id pub-id-type="pmid">15509158</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whittle</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gillet</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Willett</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Loesel</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Analysis of data fusion methods in virtual screening: similarity and group fusion</article-title>
        <source>J Chem Inf Modeling</source>
        <year>2006</year>
        <volume>46</volume>
        <issue>6</issue>
        <fpage>2206</fpage>
        <lpage>2219</lpage>
        <pub-id pub-id-type="doi">10.1021/ci0496144</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vogt</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bajorath</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Analysis of a high-throughput screening data set using potency-scaled molecular similarity algorithms</article-title>
        <source>J Chem Inf Modeling</source>
        <year>2007</year>
        <volume>47</volume>
        <issue>2</issue>
        <fpage>367</fpage>
        <lpage>375</lpage>
        <pub-id pub-id-type="doi">10.1021/ci6005432</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bajorath</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Bit silencing in fingerprints enables the derivation of compound class-directed similarity metrics</article-title>
        <source>J Chem Inf Modeling</source>
        <year>2008</year>
        <volume>48</volume>
        <issue>9</issue>
        <fpage>1754</fpage>
        <lpage>1759</lpage>
        <pub-id pub-id-type="doi">10.1021/ci8002045</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schultes</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kooistra</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Vischer</surname>
            <given-names>HF</given-names>
          </name>
          <name>
            <surname>Nijmeijer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Haaksma</surname>
            <given-names>EEJ</given-names>
          </name>
          <name>
            <surname>Leurs</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>de Esch</surname>
            <given-names>IJP</given-names>
          </name>
          <name>
            <surname>de Graaf</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Combinatorial consensus scoring for ligand-based virtual fragment screening: a comparative case study for serotonin 5-HT3A, histamine H1, and histamine H4 receptors</article-title>
        <source>J Chem Inf Modeling</source>
        <year>2015</year>
        <volume>55</volume>
        <issue>5</issue>
        <fpage>1030</fpage>
        <lpage>1044</lpage>
        <pub-id pub-id-type="doi">10.1021/ci500694c</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Polishchuk</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Madzhidov</surname>
            <given-names>TI</given-names>
          </name>
          <name>
            <surname>Varnek</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Estimation of the size of drug-like chemical space based on GDB-17 data</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2013</year>
        <volume>27</volume>
        <issue>8</issue>
        <fpage>675</fpage>
        <lpage>679</lpage>
        <pub-id pub-id-type="doi">10.1007/s10822-013-9672-4</pub-id>
        <pub-id pub-id-type="pmid">23963658</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sterling</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Irwin</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Zinc 15—ligand discovery for everyone</article-title>
        <source>J Chem Inf Modeling</source>
        <year>2015</year>
        <volume>55</volume>
        <issue>11</issue>
        <fpage>2324</fpage>
        <lpage>2337</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.5b00559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reymond</surname>
            <given-names>J-L</given-names>
          </name>
          <name>
            <surname>Awale</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Exploring chemical space for drug discovery using the chemical universe database</article-title>
        <source>ACS Chem Neurosci</source>
        <year>2012</year>
        <volume>3</volume>
        <issue>9</issue>
        <fpage>649</fpage>
        <lpage>657</lpage>
        <pub-id pub-id-type="doi">10.1021/cn3000422</pub-id>
        <pub-id pub-id-type="pmid">23019491</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruddigkeit</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Blum</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Reymond</surname>
            <given-names>J-L</given-names>
          </name>
        </person-group>
        <article-title>Visualization and virtual screening of the chemical universe database GDB-17</article-title>
        <source>J Chem Inf Modeling</source>
        <year>2013</year>
        <volume>53</volume>
        <issue>1</issue>
        <fpage>56</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1021/ci300535x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mysinger</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Carchia</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Irwin</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Shoichet</surname>
            <given-names>BK</given-names>
          </name>
        </person-group>
        <article-title>Directory of useful decoys, enhanced (DUD-E): better ligands and decoys for better benchmarking</article-title>
        <source>J Med Chem</source>
        <year>2012</year>
        <volume>55</volume>
        <issue>14</issue>
        <fpage>6582</fpage>
        <lpage>6594</lpage>
        <pub-id pub-id-type="doi">10.1021/jm300687e</pub-id>
        <pub-id pub-id-type="pmid">22716043</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lagarde</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ben Nasr</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jérémie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guillemain</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Laville</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Labib</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zagury</surname>
            <given-names>J-F</given-names>
          </name>
          <name>
            <surname>Montes</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Nrlist bdb, the manually curated nuclear receptors ligands and structures benchmarking database</article-title>
        <source>J Med Chem</source>
        <year>2014</year>
        <volume>57</volume>
        <issue>7</issue>
        <fpage>3117</fpage>
        <lpage>3125</lpage>
        <pub-id pub-id-type="doi">10.1021/jm500132p</pub-id>
        <pub-id pub-id-type="pmid">24666037</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butkiewicz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Mueller</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mendenhall</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Teixeira</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Weaver</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Meiler</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Benchmarking ligand-based virtual high-throughput screening with the pubchem database</article-title>
        <source>Molecules</source>
        <year>2013</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>735</fpage>
        <lpage>756</lpage>
        <pub-id pub-id-type="doi">10.3390/molecules18010735</pub-id>
        <pub-id pub-id-type="pmid">23299552</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Boyle</surname>
            <given-names>Noel</given-names>
          </name>
          <name>
            <surname>Banck</surname>
            <given-names>Michael</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>Craig</given-names>
          </name>
          <name>
            <surname>Morley</surname>
            <given-names>Chris</given-names>
          </name>
          <name>
            <surname>Vandermeersch</surname>
            <given-names>Tim</given-names>
          </name>
          <name>
            <surname>Hutchison</surname>
            <given-names>Geoffrey</given-names>
          </name>
        </person-group>
        <article-title>Open Babel: an open chemical toolbox</article-title>
        <source>J Cheminform</source>
        <year>2011</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>33</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-3-33</pub-id>
        <pub-id pub-id-type="pmid">21982300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tosco</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stiefl</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Landrum</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Bringing the MMFF force field to the RDKit: implementation and validation</article-title>
        <source>J Cheminform</source>
        <year>2014</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>37</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-014-0037-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Landrum G. RDKit: Open-source cheminformatics. <ext-link ext-link-type="uri" xlink:href="http://www.rdkit.org">http://www.rdkit.org</ext-link></mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bender</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mussa</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Glen</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Reiling</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Similarity searching of chemical databases using atom environment descriptors (MOLPRINT 2D): evaluation of performance</article-title>
        <source>Journal of Chemical Information and Computer Sciences</source>
        <year>2004</year>
        <volume>44</volume>
        <issue>5</issue>
        <fpage>1708</fpage>
        <lpage>1718</lpage>
        <pub-id pub-id-type="doi">10.1021/ci0498719</pub-id>
        <pub-id pub-id-type="pmid">15446830</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bender</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mussa</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Glen</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Reiling</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Molecular similarity searching using atom environments, information-based feature selection, and a naïve bayesian classifier</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>2004</year>
        <volume>44</volume>
        <issue>1</issue>
        <fpage>170</fpage>
        <lpage>178</lpage>
        <pub-id pub-id-type="doi">10.1021/ci034207y</pub-id>
        <pub-id pub-id-type="pmid">14741025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kothiwale</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mendenhall</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Meiler</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Bcl::conf: small molecule conformational sampling using a knowledge based rotamer library</article-title>
        <source>J Cheminform</source>
        <year>2015</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>47</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-015-0095-1</pub-id>
        <pub-id pub-id-type="pmid">26473018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sastry</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lowrie</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Sherman</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Large-scale systematic analysis of 2D fingerprint methods and parameters to improve virtual screening enrichments</article-title>
        <source>J Chem Inf Modeling</source>
        <year>2010</year>
        <volume>50</volume>
        <issue>5</issue>
        <fpage>771</fpage>
        <lpage>784</lpage>
        <pub-id pub-id-type="doi">10.1021/ci100062n</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopes</surname>
            <given-names>JCD</given-names>
          </name>
          <name>
            <surname>dos Santos</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Martins-José</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Augustyns</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>De Winter</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>The power metric: a new statistically robust enrichment-type metric for virtual screening applications with early recovery capability</article-title>
        <source>J Cheminform</source>
        <year>2017</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-016-0189-4</pub-id>
        <pub-id pub-id-type="pmid">28203291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Leroy X, Doligez D, Frisch A, Garrigue J, Rémy D, Vouillon J (2016) The ocaml system release 4.04- documentation and user’s manual</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Danelutto M, Cosmo RD (2012) A Minimal Disruption Skeleton Experiment: Seamless Map and Reduce Embedding in OCaml. Procedia Computer Science 9(0), 1837–1846. 10.1016/j.procs.2012.04.202. Proceedings of the International Conference on Computational Science, ICCS 2012</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berenger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Coti</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>KYJ</given-names>
          </name>
        </person-group>
        <article-title>PAR: a PARallel and distributed job crusher</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>22</issue>
        <fpage>2918</fpage>
        <lpage>2919</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq542</pub-id>
        <pub-id pub-id-type="pmid">20870644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kerber</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laue</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Meringer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rücker</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Molecules in silico: a graph description of chemical reactions</article-title>
        <source>J Chem Inf Modeling</source>
        <year>2007</year>
        <volume>47</volume>
        <issue>3</issue>
        <fpage>805</fpage>
        <lpage>817</lpage>
        <pub-id pub-id-type="doi">10.1021/ci600470q</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoksza</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Škoda</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Voršilák</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Svozil</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Molpher: a software framework for systematic chemical space exploration</article-title>
        <source>J Cheminform</source>
        <year>2014</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-6-7</pub-id>
        <pub-id pub-id-type="pmid">24655571</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Naderi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alvin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Mukhopadhyay</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brylinski</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A graph-based approach to construct target-focused libraries for virtual screening</article-title>
        <source>J Cheminform</source>
        <year>2016</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>14</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-016-0126-6</pub-id>
        <pub-id pub-id-type="pmid">26981157</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Naderi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alvin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mukhopadhyay</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brylinski</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Break down in order to build up: decomposing small molecules for fragment-based drug design with emolfrag</article-title>
        <source>J Chem Inf Modeling</source>
        <year>2017</year>
        <volume>57</volume>
        <issue>4</issue>
        <fpage>627</fpage>
        <lpage>631</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.6b00596</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leys</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Bernard</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Licata</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Detecting outliers: do not use standard deviation around the mean, use absolute deviation around the median</article-title>
        <source>J Exp Soc Psychol</source>
        <year>2013</year>
        <volume>49</volume>
        <issue>4</issue>
        <fpage>764</fpage>
        <lpage>766</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jesp.2013.03.013</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
