<?properties open_access?>
<?subarticle report52017?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-id journal-id-type="pmc">F1000Research</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000 Research Limited</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6738191</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.16032.3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Tool Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>epiflows: an R package for risk assessment of travel-related spread of disease</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 3; peer review: 2 approved]</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Moraga</surname>
          <given-names>Paula</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal Analysis</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5266-0201</contrib-id>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Dorigatti</surname>
          <given-names>Ilaria</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Formal Analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9959-0706</contrib-id>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Kamvar</surname>
          <given-names>Zhian N.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal Analysis</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1458-7108</contrib-id>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Piatkowski</surname>
          <given-names>Pawel</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Toikkanen</surname>
          <given-names>Salla E.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nagraj</surname>
          <given-names>VP</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-0060-566X</contrib-id>
        <xref ref-type="aff" rid="a5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Donnelly</surname>
          <given-names>Christl A.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a2">2</xref>
        <xref ref-type="aff" rid="a6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jombart</surname>
          <given-names>Thibaut</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2226-8692</contrib-id>
        <xref ref-type="aff" rid="a2">2</xref>
        <xref ref-type="aff" rid="a7">7</xref>
      </contrib>
      <aff id="a1"><label>1</label>Department of Mathematical Sciences, University of Bath, Bath, BA2 7AY, UK</aff>
      <aff id="a2"><label>2</label>MRC Centre for Global Infectious Disease Analysis, Department of Infectious Disease Epidemiology, School of Public Health, Imperial College, London, W2 1PG, UK</aff>
      <aff id="a3"><label>3</label>International Institute of Molecular and Cell Biology, Warsaw, Poland</aff>
      <aff id="a4"><label>4</label>National Institute for Health and Welfare, Helsinki, Finland</aff>
      <aff id="a5"><label>5</label>School of Medicine, Research Computing, University of Virginia, Virginia, USA</aff>
      <aff id="a6"><label>6</label>Department of Statistics, University of Oxford, Oxford, OX1 3LB, UK</aff>
      <aff id="a7"><label>7</label>Department of Infectious Disease Epidemiology, London School of Hygiene and Tropical Medicine, London, UK</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:pm865@bath.ac.uk">pm865@bath.ac.uk</email>
      </corresp>
      <fn fn-type="con">
        <p>PM, ZNK, PP and TJ developed the R package.</p>
        <p>ST and VPN contributed to the R package.</p>
        <p>ID and CAD developed the methods.</p>
        <p>ID contributed data.</p>
        <p>PM, ID and ZNK analysed the data.</p>
        <p>PM wrote the first draft of the manuscript.</p>
        <p>All authors read and approved the final manuscript.</p>
      </fn>
      <fn fn-type="COI-statement">
        <p>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>1374</elocation-id>
    <history>
      <date date-type="accepted">
        <day>10</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2019 Moraga P et al.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="f1000research-7-22646.pdf"/>
    <abstract>
      <p>As international travel increases worldwide, new surveillance tools are needed to help identify locations where diseases are most likely to be spread and prevention measures need to be implemented. In this paper we present
<italic>epiflows</italic>, an R package for risk assessment of travel-related spread of disease. 
<italic>epiflows</italic> produces estimates of the expected number of symptomatic and/or asymptomatic infections that could be introduced to other locations from the source of infection. Estimates (average and confidence intervals) of the number of infections introduced elsewhere are obtained by integrating data on the cumulative number of cases reported, population movement, length of stay and information on the distributions of the incubation and infectious periods of the disease. The package also provides tools for geocoding and visualization. We illustrate the use of
<italic>epiflows</italic> by assessing the risk of travel-related spread of yellow fever cases in Southeast Brazil in December 2016 to May 2017.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>disease surveillance</kwd>
      <kwd>outbreaks</kwd>
      <kwd>epidemics</kwd>
      <kwd>infectious</kwd>
      <kwd>R</kwd>
      <kwd>RECON</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>Imperial College Junior Research Fellowship</funding-source>
      </award-group>
      <award-group id="fund-2">
        <funding-source>UK Medical Research Council</funding-source>
      </award-group>
      <award-group id="fund-3" xlink:href="http://dx.doi.org/10.13039/501100000272">
        <funding-source>National Institute for Health Research</funding-source>
      </award-group>
      <funding-statement>ID acknowledges research funding from the Imperial College Junior Research Fellowship. 
ID, CAD and TJ thank the UK Medical Research Council for Centre funding. TJ is funded by the National Institute for Health Research Health Protection Research Unit (NIHR HPRU) in Modelling Methodology at Imperial College London in partnership with Public Health England (PHE).</funding-statement>
      <funding-statement>
        <italic>The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</italic>
      </funding-statement>
    </funding-group>
  </article-meta>
  <notes notes-type="version-changes">
    <sec sec-type="version-changes">
      <label>Revised</label>
      <title>Amendments from Version 2</title>
      <p>The previous version of the manuscript had a small error. In Section "Arguments of the estimate_risk_spread() function" we wrote `num_sim` instead of `n_sim`. This has been corrected in the new version.</p>
    </sec>
  </notes>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Infectious disease outbreaks cause significant suffering and mortality in the affected populations, and damage the health, social and economic well-being of the families affected by diseases as well as producing significant economic costs for local and national governments. As we have seen with Ebola and SARS, disease outbreaks can spread beyond national borders
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup>. Travelers can acquire a disease while staying in a foreign country, and then seed new outbreaks in their home country after their return. As international travel increases worldwide, new surveillance tools are needed to help identify locations where diseases are most likely to be spread and prevention measures need to be implemented. This is essential to limit the global spread of local outbreaks.</p>
    <p>Recently, Dorigatti
<italic>et al.</italic>
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup> developed a method to assess the risk of travel-related international spread of disease by integrating epidemiological and travel (by air, land and water) volume. The model developed by Dorigatti
<italic>et al.</italic>
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup> estimates the expected number of infections introduced elsewhere by taking into account population flows, lengths of stay, as well as the variability of the disease incubation and infectious periods. The method was applied to quantify the risk of spread of a recent outbreak of yellow fever in Southeast Brazil in December 2016 to May 2017, and was able to identify the countries that could have received travel-related disease cases capable of seeding local transmission.</p>
    <p>In this paper we present
<monospace>epiflows</monospace>, an R package that implements the method presented by Dorigatti
<italic>et al.</italic>
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup> for risk assessment of travel-related spread of disease. Using data on population movement between the location that is source of the infection and other locations, lengths of stay, as well as information about the disease incubation and infectious period distributions, the package allows the estimation of the number of (symptomatic and/or asymptomatic) infections that could be spread to other locations together with uncertainty measures. The package also provides tools for geocoding and visualization of population flows.</p>
    <p>The remainder of the paper is organized as follows. First, we briefly describe the modelling framework that is implemented in the
<monospace>epiflows</monospace> package. Second, we introduce the main components of
<monospace>epiflows</monospace> including instructions for installation and main functions. Third, we illustrate the use of the package via the assessment of the risk of travel-related spread of yellow fever cases due to population flows between Southeast Brazil and other countries in December 2016 to May 2017. Specifically, we discuss the data required and show how to perform the statistical analyses, how to interpret the results, and the visualization options. Finally, the conclusions are presented.</p>
  </sec>
  <sec>
    <title>Model</title>
    <p>In this Section we explain the modelling framework presented in
<xref rid="ref-2" ref-type="bibr">2</xref> for estimating the expected number of infections departing from one infectious location during the incubation or infectious periods. These cases comprise exportations and importations. Exportations refer to the infected residents of the infectious location (i.e. location with sustained disease transmission) that travel to other locations. Importations (also referred to as returning travelers) are people that are infected during a temporary stay in the infectious location and then return to their home location. The following Sections describe how to model exportations and importations to produce the total number of expected cases that could be spread to other locations together with uncertainty measures.</p>
    <sec>
      <title>Exportations</title>
      <p>Let
<italic>C
<sub><sub>S,W</sub></sub></italic> denote the cumulative number of infections in location
<italic>S</italic> in time window
<italic>W</italic>. Here,
<italic>W</italic> denotes the temporal window between the first and the last disease case in location
<italic>S</italic>. Note that Dorigatti
<italic>et al.</italic>
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup> calculated
<italic>C
<sub><sub>S,W</sub></sub></italic> by multiplying the number of confirmed and reported yellow fever cases by 10 to account for underreporting of asymptomatic and mild yellow fever cases.</p>
      <p>Let
<italic>pop
<sub><sub>S</sub></sub></italic> be the resident population of the infectious location
<italic>S</italic>, and
<inline-formula><mml:math id="M1"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mi>W</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> the number of residents of location
<italic>S</italic> travelling to location
<italic>D</italic> in time window
<italic>W</italic>. The per capita probability that a resident from the infectious location travelled to other location
<italic>D</italic> during the time window
<italic>W</italic> is given by</p>
      <p>
        <disp-formula>
          <mml:math id="math1">
            <mml:mrow>
              <mml:msub>
                <mml:mi>p</mml:mi>
                <mml:mi>D</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>T</mml:mi>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mi>W</mml:mi>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>p</mml:mi>
                  <mml:mi>o</mml:mi>
                  <mml:msub>
                    <mml:mi>p</mml:mi>
                    <mml:mi>S</mml:mi>
                  </mml:msub>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>⋅</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>We assume that the incubation period (
<italic>D
<sub><sub>E</sub></sub></italic>) and the infectious period (
<italic>D
<sub><sub>I</sub></sub></italic>) are random variables, with associated probability distributions that are disease-specific. Using these, we can calculate the probability
<italic>p
<sub><sub>i</sub></sub></italic> that an infection incubated or is infectious in time window
<italic>W</italic> as</p>
      <p>
        <disp-formula>
          <mml:math id="math2">
            <mml:mrow>
              <mml:msub>
                <mml:mi>p</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mo>minimum</mml:mo>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>D</mml:mi>
                        <mml:mi>E</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>D</mml:mi>
                        <mml:mi>I</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mi>W</mml:mi>
                  </mml:mfrac>
                  <mml:mo>,</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mo>⋅</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Finally, the number of residents of the infectious location
<italic>S</italic> that are infected and travel abroad during their incubation or infectious period during the time window
<italic>W</italic> can be calculated as</p>
      <p>                                                                                                                          
<italic>E
<sub><sub>S,D</sub></sub></italic> =
<italic>C
<sub><sub>S,W</sub></sub></italic> ×
<italic>p
<sub><sub>D</sub></sub></italic> ×
<italic>p
<sub><sub>i</sub></sub>.</italic>
</p>
      <p>That is,
<italic>E
<sub><sub>S,D</sub></sub></italic> is a product of the cumulative number of infections in location
<italic>S</italic> in time window
<italic>W</italic>, the per capita probability that a resident of
<italic>S</italic> travels to location
<italic>D</italic>, and the probability that an infection incubated or is infectious in time window
<italic>W</italic>.</p>
      <p>Note here that if travel data are expressed annually
<inline-formula><mml:math id="M2"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> instead of in the time window
<italic>W</italic>, travel data in the time window can be obtained as
<inline-formula><mml:math id="M3"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mi>W</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> = (
<inline-formula><mml:math id="M4"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> ×
<italic>W</italic>)/365.</p>
    </sec>
    <sec>
      <title>Importations</title>
      <p>Let
<inline-formula><mml:math id="M5"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>O</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mi>W</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> be the number of travelers visiting location
<italic>S</italic> from location
<italic>O</italic> in time window
<italic>W</italic>, and let
<italic>L
<sub><sub>O</sub></sub></italic> denote the average length of stay. The per capita risk of infection of travelers visiting location
<italic>S</italic> during their stay can be calculated as</p>
      <p>
        <disp-formula>
          <mml:math id="math3">
            <mml:mrow>
              <mml:msub>
                <mml:mi>λ</mml:mi>
                <mml:mi>S</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>C</mml:mi>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>W</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>×</mml:mo>
                  <mml:msub>
                    <mml:mi>L</mml:mi>
                    <mml:mi>O</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>p</mml:mi>
                  <mml:mi>o</mml:mi>
                  <mml:msub>
                    <mml:mi>p</mml:mi>
                    <mml:mi>S</mml:mi>
                  </mml:msub>
                  <mml:mo>×</mml:mo>
                  <mml:mi>W</mml:mi>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>⋅</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The probability of returning to the home location while incubating or infectious is given by</p>
      <p>
        <disp-formula>
          <mml:math id="math4">
            <mml:mrow>
              <mml:msub>
                <mml:mi>p</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mo>minimum</mml:mo>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>D</mml:mi>
                        <mml:mi>E</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>D</mml:mi>
                        <mml:mi>I</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>L</mml:mi>
                        <mml:mi>O</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>,</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mo>⋅</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Finally, the expected number of travelers infected during their stay in the infectious location and returning to their home location before the end of the infectious period can be calculated as the product of the number of travelers, the per capita risk of infection and the probability of returning home while incubating or infectious,</p>
      <p>
        <disp-formula>
          <mml:math id="math5">
            <mml:mrow>
              <mml:msub>
                <mml:mi>I</mml:mi>
                <mml:mrow>
                  <mml:mi>S</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>O</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:msubsup>
                <mml:mi>T</mml:mi>
                <mml:mrow>
                  <mml:mi>O</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>S</mml:mi>
                </mml:mrow>
                <mml:mi>W</mml:mi>
              </mml:msubsup>
              <mml:mo>×</mml:mo>
              <mml:msub>
                <mml:mi>λ</mml:mi>
                <mml:mi>S</mml:mi>
              </mml:msub>
              <mml:mo>×</mml:mo>
              <mml:msub>
                <mml:mi>p</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:msub>
              <mml:mo>⋅</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Note that, similarly to exportations, if travel data are expressed annually (
<inline-formula><mml:math id="M6"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>O</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>) instead of in the time window
<italic>W</italic>, travel data in the time window can be obtained as
<inline-formula><mml:math id="M7"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>O</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mi>W</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> = (
<inline-formula><mml:math id="M8"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>O</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> ×
<italic>W</italic>)/365.</p>
    </sec>
    <sec>
      <title>Total number of exportations and importations</title>
      <p>Finally, the expected number of infections departing from the infectious location
<italic>S</italic> to location
<italic>O</italic> during the incubation or infectious periods can be computed as the sum of the number of infected residents of
<italic>S</italic> travelling during their incubation or infectious periods, and the travelers from abroad that are infected during their stay in
<italic>S</italic> and return to their origin location before the end of the infectious period. That is,</p>
      <p>
        <disp-formula>
          <mml:math id="math6">
            <mml:mrow>
              <mml:msub>
                <mml:mi>T</mml:mi>
                <mml:mrow>
                  <mml:mi>S</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>O</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:msub>
                <mml:mi>E</mml:mi>
                <mml:mrow>
                  <mml:mi>S</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>O</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mi>I</mml:mi>
                <mml:mrow>
                  <mml:mi>S</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>O</mml:mi>
                  <mml:mo>⋅</mml:mo>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Average estimates and the relative uncertainty are calculated by taking into account the variability of the incubation and infectious periods. Specifically, the method samples a large number of times from the incubation and infectious distributions, which produces a full distribution for
<italic>p
<sub><sub>i</sub></sub></italic> (the probability that a disease case is incubated or infectious in the time window considered) and
<italic>p
<sub><sub>l</sub></sub></italic> (the probability of returning to the home location while incubating or infectious). This, in turn, creates variability in exportations
<italic>E
<sub><sub>S,O</sub></sub></italic> and importations
<italic>I
<sub><sub>S,O</sub></sub></italic>, and finally in the total number of infections introduced in location O,
<italic>T
<sub><sub>S,O</sub></sub></italic>.</p>
    </sec>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Implementation</title>
      <p>The
<monospace>R</monospace> package
<monospace>epiflows</monospace> [21] is hosted in the Comprehensive
<monospace>R</monospace> Archive Network (CRAN) which is the main repository for
<monospace>R</monospace> packages:
<ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=epiflows">http://CRAN.R-project.org/package=epiflows</ext-link>. Users can install
<monospace>epiflows</monospace> in
<monospace>R</monospace> by executing the following code:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#214A87">install.packages</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"epiflows"</styled-content>
          <styled-content style="font-size:15px;color:#000000">)</styled-content>
        </preformat>
      </p>
      <p>There is also a development version from GitHub which can be accessed at
<ext-link ext-link-type="uri" xlink:href="https://github.com/reconhub/epiflows">https://github.com/reconhub/epiflows</ext-link>. This version of the package may contain new features which are not incorporated in the version on CRAN yet but may be useful for some users. GitHub also includes issue tracking where users can note problems or suggestions for improvements. This development version from GitHub can be installed by using the
<monospace>install_github()</monospace> function from the
<monospace>R</monospace> package
<monospace>devtools</monospace>
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup>:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#214A87">install.packages</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"devtools"</styled-content>
          <styled-content style="font-size:15px;color:#000000">)       </styled-content>
          <styled-content style="font-size:15px;color:#214A87">library</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"devtools"</styled-content>
          <styled-content style="font-size:15px;color:#000000">)                </styled-content>
          <styled-content style="font-size:15px;color:#214A87">install_github</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"reconhub/epiflows"</styled-content>
          <styled-content style="font-size:15px;color:#000000">)</styled-content>
        </preformat>
      </p>
      <p>When installing
<monospace>epiflows</monospace>, other
<monospace>R</monospace> packages which
<monospace>epiflows</monospace> depends on are also automatically installed. These packages include
<monospace>sp</monospace>
<sup><xref rid="ref-4" ref-type="bibr">4</xref></sup> for manipulating spatial objects;
<monospace>geosphere</monospace>
<sup><xref rid="ref-5" ref-type="bibr">5</xref></sup> for calculating distances between locations; and
<monospace>leaflet</monospace>
<sup><xref rid="ref-6" ref-type="bibr">6</xref></sup> for visualization.</p>
    </sec>
    <sec>
      <title>Operation</title>
      <p>The main function of the package is
<monospace>estimate_risk_spread()</monospace> which calculates the mean and 95% confidence intervals of the number of cases spread to different locations from an infectious location. It is also possible to use this function to produce a data frame with all simulations (not just the mean and 95% confidence intervals that is computed from the simulations). This permits the user to aggregate the estimates and calculate confidence intervals with different levels using single simulations. To execute this function the following information is needed:</p>
      <list list-type="bullet">
        <list-item>
          <p>population of the infectious location,</p>
        </list-item>
        <list-item>
          <p>number of infections in the infectious location, and the first and last dates of reported cases,</p>
        </list-item>
        <list-item>
          <p>number of travelers between the infectious location and other locations,</p>
        </list-item>
        <list-item>
          <p>average length of stay of travelers from other locations visiting the infectious location,</p>
        </list-item>
        <list-item>
          <p>distributions of the incubation and infectious periods,</p>
        </list-item>
        <list-item>
          <p>number of simulations to be drawn from the incubation and infectious period distributions,</p>
        </list-item>
        <list-item>
          <p>logical value indicating whether the returned object should be a data frame with all simulations, or a data frame with the mean and lower and upper limits of a 95% confidence interval of the number of infections spread to each location.</p>
        </list-item>
      </list>
      <p>Other useful functions are
<monospace>plot()</monospace> which produces visualizations of population flows between locations, and
<monospace>add_coordinates()</monospace> which finds the coordinates of the locations.</p>
    </sec>
  </sec>
  <sec>
    <title>Use cases</title>
    <p>In this Section we provide an example on how to use
<monospace>epiflows</monospace> to calculate the number of yellow fever cases spreading from south-east Brazil to other countries due to human movement. We show how to define the arguments of the
<monospace>estimate_risk_spread()</monospace> function, interpret the results, and make visualizations with the population flows.</p>
    <sec>
      <title>Data</title>
      <p>We use the data
<monospace>YF_flows</monospace> and
<monospace>YF_locations</monospace> which are contained in the
<monospace>epiflows</monospace> package as
<monospace>data(YF_flows)</monospace> and
<monospace>data(YF_locations)</monospace>, respectively. These data contain the population size, the assumed number of yellow fever infections, dates of first and last case reporting, number of travelers and length of stay for the states of Espirito Santo, Minas Gerais, Rio de Janeiro, Sao Paulo, and for the whole region of Southeast Brazil (which comprises the four states of Espirito Santo, Minas Gerais, Rio de Janeiro and Sao Paulo) in the period December 2016 to May 2017 [19], [20].</p>
      <p>Following Dorigatti
<italic>et al.</italic>
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup>, the total number of yellow fever infections in each of the Brazilian states was calculated by multiplying the cumulative number of confirmed yellow fever cases reported in
<xref rid="ref-7" ref-type="bibr">7</xref> by 10 to account for underreporting of asymptomatic and mild yellow fever cases. The dates of first and last case reported in each state were derived as described by Dorigatti
<italic>et al.</italic>
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup>. Population data were obtained from the Brazilian Institute of Geography and Statistics website
<sup><xref rid="ref-8" ref-type="bibr">8</xref></sup>. These data also contain the number of travelers in the specified time window between the states of Espirito Santo, Minas Gerais, Rio de Janeiro, Sao Paulo (and the whole Southeast Brazilian region) and other countries. These estimates were obtained from World Tourism Organization data on the volume of air, land and water border crossings for Brazil for the year 2015
<sup><xref rid="ref-9" ref-type="bibr">9</xref></sup>, having assumed that travelers were distributed across the Brazilian states according to the relative population density and having accounted for information on the monthly distribution of tourism and on the average duration of stay of international visitors to Brazil
<sup><xref rid="ref-10" ref-type="bibr">10</xref></sup>, as detailed in
<xref rid="ref-2" ref-type="bibr">2</xref>.</p>
    </sec>
    <sec>
      <title>The epiflows object</title>
      <p>To aid in data organization between flows and metadata, we have implemented the
<monospace>epiflows</monospace> object. This inherits the
<monospace>epicontacts</monospace> object from the
<bold>epicontacts</bold> package
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup>, storing three elements:</p>
      <list list-type="simple">
        <list-item>
          <label>1.</label>
          <p><monospace>flows</monospace> — a data frame defining the number of cases flowing from one location to another</p>
        </list-item>
        <list-item>
          <label>2.</label>
          <p><monospace>locations</monospace> — a data frame listing the locations present in
<monospace>flows</monospace> and relevant metadata.</p>
        </list-item>
        <list-item>
          <label>3.</label>
          <p><monospace>vars</monospace> — a dictionary mapping column names in
<monospace>locations</monospace> to known global variables defined in
<monospace>global_vars()</monospace>. These global variables are used as default values in
<monospace>estimate_risk_spread()</monospace>.</p>
        </list-item>
      </list>
      <p>Because a flow of cases from one location to another can be thought of as a contact with a wider scope, the
<monospace>epiflows</monospace> object inherits from the
<monospace>epicontacts</monospace> object, where locations are stored in the
<monospace>linelist</monospace> element and flows are stored in the
<monospace>contacts</monospace> element (though the user does not need to interact with these elements by name). By building on the
<monospace>epicontacts</monospace> object, we ensure that all the methods for sub-setting an object of class
<monospace>epicontacts</monospace> also applies to
<monospace>epiflows</monospace>, reducing the maintenance effort.</p>
      <p>An
<monospace>epiflows</monospace> object can be created with the
<monospace>make_
<monospace>epiflows</monospace>()</monospace> function by providing a data frame
<monospace>flows</monospace> with the number of travelers between locations, a data frame
<monospace>locations</monospace> with information about the locations, and the names of the columns of data frame
<monospace>locations</monospace> indicating the name of each variable.</p>
      <p>In the data frame
<monospace>flows</monospace> each row represents the number of travelers from one location to the next.
<monospace>flows</monospace> has at least three columns: columns
<monospace>from</monospace> and
<monospace>to</monospace> indicating where the flow starts and ends, respectively, and column
<monospace>n</monospace> indicating the number of travelers that are in the flow. Data frame
<monospace>YF_flows</monospace> contains the
population flows of the Brazil data.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#214A87">library</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"epiflows"</styled-content>
          <styled-content style="font-size:15px;color:#000000">)</styled-content>
        </preformat>
      </p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">## epiflows is loaded with the following global variables in `global_vars()`:</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## coordinates, pop_size, duration_stay, first_date, last_date, num_cases</styled-content>
        </preformat>
      </p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#214A87">data</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"YF_flows"</styled-content>
          <styled-content style="font-size:15px;color:#000000">) </styled-content>
          <styled-content style="font-size:15px;color:#214A87">head</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#4F9905">YF_flows</styled-content>
          <styled-content style="font-size:15px;color:#000000">) </styled-content>
        </preformat>
      </p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">##               from    to         n
## 1   Espirito Santo Italy  2827.572
## 2     Minas Gerais Italy 15714.103
## 3   Rio de Janeiro Italy  8163.938
## 4        Sao Paulo Italy 34038.681
## 5 Southeast Brazil Italy 76281.763
## 6   Espirito Santo Spain  3270.500</styled-content>
        </preformat>
      </p>
      <p>In data frame
<monospace>locations</monospace> each row represents a location, and columns specify useful information about the locations such as ID, population, number of cases, dates and length of stay.
<monospace>locations</monospace> must contain at least one column specifying the location ID used in the
<monospace>flows</monospace> data frame.
<monospace>YF_locations</monospace> contains, for each Brazilian state considered in our example, the code (
<monospace>location_code</monospace>), the population (
<monospace>location_population</monospace>), the number of assumed infections in the time window (
<monospace>num_cases_time_window</monospace>), and the dates of the first and last case reported (
<monospace>first_date_cases</monospace> and
<monospace>last_date_cases,</monospace> respectively). It also contains
<monospace>length_of_stay</monospace> which are the lengths of stay (in days) of the travelers visiting Brazil from other countries.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#214A87">data</styled-content>
          <styled-content style="font-size:15px;color:#000000">("YF_locations")</styled-content>
          <styled-content style="font-size:15px;color:#214A87">head</styled-content>
          <styled-content style="font-size:15px;color:#000000">(YF_locations)</styled-content>
        </preformat>
      </p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">##      location_code location_population num_cases_time_window
## 1   Espirito Santo             3973697                  2600
## 2     Minas Gerais            20997560                  4870
## 3   Rio de Janeiro            16635996                   170
## 4        Sao Paulo            44749699                   200
## 5 Southeast Brazil            86356952                  7840
## 6        Argentina                  NA                    NA
##   first_date_cases last_date_cases length_of_stay
## 1       2017-01-04      2017-04-30             NA
## 2       2016-12-19      2017-04-20             NA
## 3       2017-02-19      2017-05-10             NA
## 4       2016-12-17      2017-04-20             NA
## 5       2016-12-17      2017-05-10             NA
## 6             &lt;NA&gt;            &lt;NA&gt;           10.9</styled-content>
        </preformat>
      </p>
      <p>Then, we can create an
<monospace>epiflows</monospace> object called
<monospace>Brazil_epiflows</monospace> as follows.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000">Brazil_epiflows &lt;- </styled-content>
          <styled-content style="font-size:15px;color:#214A87">make_epiflows</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#214A87">flows         = </styled-content>
          <styled-content style="font-size:15px;color:#000000">YF_flows,               </styled-content>
          <styled-content style="font-size:15px;color:#214A87">                                 locations     = </styled-content>
          <styled-content style="font-size:15px;color:#000000">YF_locations,           </styled-content>
          <styled-content style="font-size:15px;color:#214A87">                                 pop_size      = </styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"location_population"</styled-content>
          <styled-content style="font-size:15px;color:#000000">,  </styled-content>
          <styled-content style="font-size:15px;color:#214A87">                                 duration_stay = </styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"length_of_stay"</styled-content>
          <styled-content style="font-size:15px;color:#000000">,       </styled-content>
          <styled-content style="font-size:15px;color:#214A87">                                 num_cases     = </styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"num_cases_time_window"</styled-content>
          <styled-content style="font-size:15px;color:#000000">,</styled-content>
          <styled-content style="font-size:15px;color:#214A87">                                 first_date    = </styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"first_date_cases"</styled-content>
          <styled-content style="font-size:15px;color:#000000">,     </styled-content>
          <styled-content style="font-size:15px;color:#214A87">                                 last_date     = </styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"last_date_cases"       </styled-content>
          <styled-content style="font-size:15px;color:#000000">)                                                                        </styled-content>
        </preformat>
      </p>
    </sec>
    <sec>
      <title>Arguments of the
<monospace>estimate_risk_spread()</monospace> function</title>
      <p>The arguments that need to be specified in
<monospace>estimate_risk_spread()</monospace> to calculate the cases or infections introduced in other countries are as follows. The first argument is an
<monospace>epiflows</monospace> object containing the number of travelers between locations, the population size, the number of cases, and the first and last dates of reporting in the infectious location, and the average length of stay in days of travelers from other locations visiting the infectious location.</p>
      <p>The second argument of
<monospace>estimate_risk_spread()</monospace> is
<monospace>location_code</monospace> which is a character string denoting the infectious location code. We also need to specify the incubation and infectious period distributions. Specifically, we need to provide functions with a single argument
<monospace>n</monospace> that generate
<monospace>n</monospace> random incubation and infectious periods. To do this, we can use random generation functions of distributions that are implemented in R including Normal
<monospace>rnorm()</monospace>, LogNormal
<monospace>rlnorm()</monospace>, Gamma
<monospace>rgamma()</monospace>, Weibull
<monospace>rweibull()</monospace>, and Exponential
<monospace>rexp()</monospace>. Details about the meaning and arguments of these functions can be obtained by typing
<monospace>?</monospace> and the function name (e.g.,
<monospace>?rnorm</monospace>). We should consider the literature carefully before deciding on appropriate distributions. Examples of systematic reviews of incubation period distributions are
<xref rid="ref-12" ref-type="bibr">12</xref> and
<xref rid="ref-13" ref-type="bibr">13</xref>. In this example, we use the specified distributions and parameterisation following
<xref rid="ref-14" ref-type="bibr">14</xref> and
<xref rid="ref-15" ref-type="bibr">15</xref>. Thus, we assume that the incubation period
<italic>D
<sub><sub>E</sub></sub></italic> is log-normally distributed with mean 4.6 days and variance 2.7 days, and that the infectious period
<italic>D
<sub><sub>I</sub></sub></italic> is normally distributed with mean 4.5 days and variance 0.6 days. We can define functions
<monospace>incubation()</monospace> and
<monospace>infectious()</monospace> as</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000">incubation &lt;- </styled-content>
          <styled-content style="font-size:15px;color:#214A87">function</styled-content>
          <styled-content style="font-size:15px;color:#000000">(n) {</styled-content>
          <styled-content style="font-size:15px;color:#214A87">  rlnorm</styled-content>
          <styled-content style="font-size:15px;color:#000000">(n, </styled-content>
          <styled-content style="font-size:15px;color:#0000CF">1.46</styled-content>
          <styled-content style="font-size:15px;color:#000000">, </styled-content>
          <styled-content style="font-size:15px;color:#0000CF">0.35</styled-content>
          <styled-content style="font-size:15px;color:#000000">)    </styled-content>
          <styled-content style="font-size:15px;color:#000000">}                          </styled-content>
          <styled-content style="font-size:15px"/>
          <styled-content style="font-size:15px;color:#000000">infectious &lt;- </styled-content>
          <styled-content style="font-size:15px;color:#214A87">function</styled-content>
          <styled-content style="font-size:15px;color:#000000">(n) {</styled-content>
          <styled-content style="font-size:15px;color:#214A87">  rnorm</styled-content>
          <styled-content style="font-size:15px;color:#000000">(n, </styled-content>
          <styled-content style="font-size:15px;color:#0000CF">4.5</styled-content>
          <styled-content style="font-size:15px;color:#000000">, </styled-content>
          <styled-content style="font-size:15px;color:#0000CF">1.5</styled-content>
          <styled-content style="font-size:15px;color:#CF5C00">/</styled-content>
          <styled-content style="font-size:15px;color:#0000CF">1.96</styled-content>
          <styled-content style="font-size:15px;color:#000000">)  </styled-content>
          <styled-content style="font-size:15px;color:#000000">}                          </styled-content>
        </preformat>
      </p>
      <p>Argument
<monospace>n_sim</monospace> is the number of simulations to be drawn from the incubation and infectious period distributions. It is recommended to use at least 1,000 simulations. The last argument of
<monospace>estimate_risk_spread()</monospace> is
<monospace>return_all_simulations</monospace>. This is a logical value indicating whether the returned object should be a data frame with all simulations (
<monospace>return_all_simulations</monospace>= TRUE), or a data frame with the mean and lower and upper limits of a 95% confidence interval of the number of infections spread to each location (
<monospace>return_all_simulations</monospace> = FALSE).</p>
    </sec>
    <sec>
      <title>Execution of the
<monospace>estimate_risk_spread()</monospace> function</title>
      <p>Once we have constructed the objects needed to call
<monospace>estimate_risk_spread()</monospace> we can execute the function and obtain the estimated mean number of cases spread to each country and the 95% confidence intervals. The code to calculate the cases spread from Espirito Santo is the following:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#214A87">set.seed</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#0000CF">2018-07-25</styled-content>
          <styled-content style="font-size:15px;color:#000000">)                                         </styled-content>
          <styled-content style="font-size:15px;color:#000000">res &lt;- </styled-content>
          <styled-content style="font-size:15px;color:#214A87">estimate_risk_spread</styled-content>
          <styled-content style="font-size:15px;color:#000000">(Brazil_epiflows,                 </styled-content>
          <styled-content style="font-size:15px;color:#214A87">                            location_code = </styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"Espirito Santo"</styled-content>
          <styled-content style="font-size:15px;color:#000000">,</styled-content>
          <styled-content style="font-size:15px;color:#214A87">                            r_incubation = </styled-content>
          <styled-content style="font-size:15px;color:#000000">incubation,       </styled-content>
          <styled-content style="font-size:15px;color:#214A87">                            r_infectious = </styled-content>
          <styled-content style="font-size:15px;color:#000000">infectious,       </styled-content>
          <styled-content style="font-size:15px;color:#214A87">                            n_sim = </styled-content>
          <styled-content style="font-size:15px;color:#0000CF">1e5                      </styled-content>
          <styled-content style="font-size:15px;color:#000000">)                                                            </styled-content>
        </preformat>
      </p>
      <p>The results returned by
<monospace>estimate_risk_spread()</monospace> are stored in the
<monospace>res</monospace> object. This is a data frame with the columns
<monospace>mean_cases</monospace> indicating the mean number of cases spread to each location, and
<monospace>lower_limit_95CI</monospace> and
<monospace>upper_limit_95CI</monospace> indicating the lower and upper limits of 95% confidence intervals. The result object is shown below.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000">res</styled-content>
        </preformat>
      </p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">##                          mean_cases lower_limit_95CI upper_limit_95CI
## Italy                     0.2233656        0.1520966        0.3078136
## Spain                     0.2255171        0.1537452        0.3126801
## Portugal                  0.2317019        0.1565528        0.3383112
## Germany                   0.1864162        0.1259548        0.2721890
## United Kingdom            0.1613418        0.1195261        0.2089475
## United States of America  0.9253419        0.6252207        1.3511047
## Argentina                 1.1283506        0.7623865        1.6475205
## Chile                     0.2648277        0.1789370        0.3866836
## Uruguay                   0.2408942        0.1627681        0.3517426
## Paraguay                  0.1619724        0.1213114        0.1926966</styled-content>
        </preformat>
      </p>
      <p>We can plot the results with
<monospace>ggplot()</monospace> as follows (
<xref ref-type="fig" rid="f1">Figure 1</xref>).</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#214A87">library</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"ggplot2"</styled-content>
          <styled-content style="font-size:15px;color:#000000">)                                                                     </styled-content>
          <styled-content style="font-size:15px;color:#000000">res</styled-content>
          <styled-content style="font-size:15px;color:#CF5C00">$</styled-content>
          <styled-content style="font-size:15px;color:#000000">location &lt;- </styled-content>
          <styled-content style="font-size:15px;color:#214A87">rownames</styled-content>
          <styled-content style="font-size:15px;color:#000000">(res)                                                          </styled-content>
          <styled-content style="font-size:15px;color:#214A87">ggplot</styled-content>
          <styled-content style="font-size:15px;color:#000000">(res, </styled-content>
          <styled-content style="font-size:15px;color:#214A87">aes</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#214A87">x = </styled-content>
          <styled-content style="font-size:15px;color:#000000">mean_cases, </styled-content>
          <styled-content style="font-size:15px;color:#214A87">y = </styled-content>
          <styled-content style="font-size:15px;color:#000000">location)) </styled-content>
          <styled-content style="font-size:15px;color:#CF5C00">+                                       </styled-content>
          <styled-content style="font-size:15px;color:#214A87">  geom_point</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#214A87">size = </styled-content>
          <styled-content style="font-size:15px;color:#0000CF">2</styled-content>
          <styled-content style="font-size:15px;color:#000000">) </styled-content>
          <styled-content style="font-size:15px;color:#CF5C00">+                                                               </styled-content>
          <styled-content style="font-size:15px;color:#214A87">  geom_errorbarh</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#214A87">aes</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#214A87">xmin = </styled-content>
          <styled-content style="font-size:15px;color:#000000">lower_limit_95CI, </styled-content>
          <styled-content style="font-size:15px;color:#214A87">xmax = </styled-content>
          <styled-content style="font-size:15px;color:#000000">upper_limit_95CI), </styled-content>
          <styled-content style="font-size:15px;color:#214A87">height = </styled-content>
          <styled-content style="font-size:15px;color:#0000CF">.25</styled-content>
          <styled-content style="font-size:15px;color:#000000">) </styled-content>
          <styled-content style="font-size:15px;color:#CF5C00">+</styled-content>
          <styled-content style="font-size:15px;color:#214A87">  theme_bw</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#214A87">base_size = </styled-content>
          <styled-content style="font-size:15px;color:#0000CF">12</styled-content>
          <styled-content style="font-size:15px;color:#000000">, </styled-content>
          <styled-content style="font-size:15px;color:#214A87">base_family = </styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"Helvetica"</styled-content>
          <styled-content style="font-size:15px;color:#000000">) </styled-content>
          <styled-content style="font-size:15px;color:#CF5C00">+                                </styled-content>
          <styled-content style="font-size:15px;color:#214A87">  ggtitle</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"Yellow Fever Spread from Espirito Santo, Brazil"</styled-content>
          <styled-content style="font-size:15px;color:#000000">) </styled-content>
          <styled-content style="font-size:15px;color:#CF5C00">+                         </styled-content>
          <styled-content style="font-size:15px;color:#214A87">  xlab</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"Number of cases"</styled-content>
          <styled-content style="font-size:15px;color:#000000">) </styled-content>
          <styled-content style="font-size:15px;color:#CF5C00">+                                                            </styled-content>
          <styled-content style="font-size:15px;color:#214A87">  xlim</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#214A87">c</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#0000CF">0</styled-content>
          <styled-content style="font-size:15px;color:#000000">, </styled-content>
          <styled-content style="font-size:15px;color:#8F5903">NA</styled-content>
          <styled-content style="font-size:15px;color:#000000">))                                                                       </styled-content>
        </preformat>
      </p>
      <fig fig-type="figure" id="f1" orientation="portrait" position="anchor">
        <label>Figure 1. </label>
        <caption>
          <title>Mean number of yellow fever cases and 95% CI spread from Espirito Santo to other locations.</title>
        </caption>
        <graphic xlink:href="f1000research-7-22646-g0000"/>
      </fig>
      <p>Note that if we set
<monospace>return_all_simulations</monospace> equal to TRUE, the result object
<monospace>res</monospace> will be a data frame with all simulations.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000">res &lt;- </styled-content>
          <styled-content style="font-size:15px;color:#214A87">estimate_risk_spread</styled-content>
          <styled-content style="font-size:15px;color:#000000">(Brazil_epiflows,                 </styled-content>
          <styled-content style="font-size:15px;color:#214A87">                            location_code = </styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"Espirito Santo"</styled-content>
          <styled-content style="font-size:15px;color:#000000">,</styled-content>
          <styled-content style="font-size:15px;color:#214A87">                            r_incubation = </styled-content>
          <styled-content style="font-size:15px;color:#000000">incubation,       </styled-content>
          <styled-content style="font-size:15px;color:#214A87">                            r_infectious = </styled-content>
          <styled-content style="font-size:15px;color:#000000">infectious,       </styled-content>
          <styled-content style="font-size:15px;color:#214A87">                            n_sim = </styled-content>
          <styled-content style="font-size:15px;color:#0000CF">1e5</styled-content>
          <styled-content style="font-size:15px;color:#000000">,                     </styled-content>
          <styled-content style="font-size:15px;color:#214A87">                            return_all_simulations = </styled-content>
          <styled-content style="font-size:15px;color:#8F5903">TRUE    </styled-content>
          <styled-content style="font-size:15px;color:#000000">)                                                            </styled-content>
        </preformat>
      </p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#214A87">head</styled-content>
          <styled-content style="font-size:15px;color:#000000">(res)</styled-content>
        </preformat>
      </p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">##          Italy     Spain  Portugal   Germany United Kingdom
## [1,] 0.1946102 0.1967196 0.2003120 0.1611614      0.1483634
## [2,] 0.2861083 0.2875748 0.3035947 0.2442577      0.1937063
## [3,] 0.1883587 0.1904003 0.1938773 0.1559844      0.1455385
## [4,] 0.2128377 0.2151446 0.2190734 0.1762560      0.1566001
## [5,] 0.2087285 0.2109909 0.2148439 0.1728531      0.1547432
## [6,] 0.2747205 0.2744030 0.2853804 0.2296033      0.1857099
##      United States of America Argentina     Chile   Uruguay  Paraguay
## [1,]                0.7999806 0.9754866 0.2289530 0.2082646 0.1552200
## [2,]                1.2124582 1.4784567 0.3470033 0.3156478 0.1837588
## [3,]                0.7742827 0.9441508 0.2215983 0.2015745 0.1502338
## [4,]                0.8749078 1.0668519 0.2503970 0.2277709 0.1619986
## [5,]                0.8580163 1.0462546 0.2455627 0.2233735 0.1609097
## [6,]                1.1397160 1.3897558 0.3261846 0.2967103 0.1790695</styled-content>
        </preformat>
      </p>
      <p>Using
<monospace>res</monospace>, we can calculate the mean and 95% confidence intervals as follows.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000">meancases &lt;- </styled-content>
          <styled-content style="font-size:15px;color:#214A87">colMeans</styled-content>
          <styled-content style="font-size:15px;color:#000000">(res, </styled-content>
          <styled-content style="font-size:15px;color:#214A87">na.rm = </styled-content>
          <styled-content style="font-size:15px;color:#8F5903">TRUE</styled-content>
          <styled-content style="font-size:15px;color:#000000">)                                   </styled-content>
          <styled-content style="font-size:15px;color:#000000">quant     &lt;- </styled-content>
          <styled-content style="font-size:15px;color:#214A87">t</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#214A87">apply</styled-content>
          <styled-content style="font-size:15px;color:#000000">(res, </styled-content>
          <styled-content style="font-size:15px;color:#0000CF">2</styled-content>
          <styled-content style="font-size:15px;color:#000000">, </styled-content>
          <styled-content style="font-size:15px;color:#000000">stats</styled-content>
          <styled-content style="font-size:15px;color:#CF5C00">::</styled-content>
          <styled-content style="font-size:15px;color:#000000">quantile, </styled-content>
          <styled-content style="font-size:15px;color:#214A87">c</styled-content>
          <styled-content style="font-size:15px;color:#000000">(.</styled-content>
          <styled-content style="font-size:15px;color:#0000CF">025</styled-content>
          <styled-content style="font-size:15px;color:#000000">, </styled-content>
          <styled-content style="font-size:15px;color:#0000CF">.975</styled-content>
          <styled-content style="font-size:15px;color:#000000">), </styled-content>
          <styled-content style="font-size:15px;color:#214A87">na.rm = </styled-content>
          <styled-content style="font-size:15px;color:#8F5903">TRUE</styled-content>
          <styled-content style="font-size:15px;color:#000000">))</styled-content>
          <styled-content style="font-size:15px;color:#214A87">data.frame</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#214A87">mean_cases = </styled-content>
          <styled-content style="font-size:15px;color:#000000">meancases,                                         </styled-content>
          <styled-content style="font-size:15px;color:#214A87">           lower_limit_95CI = </styled-content>
          <styled-content style="font-size:15px;color:#000000">quant[, </styled-content>
          <styled-content style="font-size:15px;color:#0000CF">1</styled-content>
          <styled-content style="font-size:15px;color:#000000">],                                  </styled-content>
          <styled-content style="font-size:15px;color:#214A87">           upper_limit_95CI = </styled-content>
          <styled-content style="font-size:15px;color:#000000">quant[, </styled-content>
          <styled-content style="font-size:15px;color:#0000CF">2</styled-content>
          <styled-content style="font-size:15px;color:#000000">]                                   </styled-content>
          <styled-content style="font-size:15px;color:#000000">)                                                                          </styled-content>
        </preformat>
      </p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">##			   mean_cases lower_limit_95CI upper_limit_95CI
## Italy		    0.2233975	     0.1522848	      0.3081296
## Spain		    0.2255621	     0.1539354	      0.3130456
## Portugal		    0.2317602	     0.1567465	      0.3388166
## Germany		    0.1864633	     0.1261107	      0.2725956
## United Kingdom	    0.1613646	     0.1196739	      0.2091694
## United States of America 0.9255753	     0.6259942	      1.3531231
## Argentina		    1.1286353	     0.7633297	      1.6499817
## Chile		    0.2648933	     0.1791584	      0.3872613
## Uruguay		    0.2409532	     0.1629695	      0.3522681
## Paraguay		    0.1619776	     0.1214615	      0.1928268</styled-content>
        </preformat>
      </p>
    </sec>
    <sec>
      <title>Visualize population flows</title>
      <p>We can visualize flows of people travelling between locations using
<monospace>plot()</monospace> and passing as first parameter an
<monospace>epiflows</monospace> object containing the population flows, and as second parameter the
<monospace>type</monospace> of plot we wish to produce. Population flows can be displayed on an interactive map, as a network or as a grid between origins and destinations as described in the following sections.</p>
    </sec>
    <sec>
      <title>Flows displayed on an interactive map</title>
      <p>We can visualize population flows on an interactive map using
<monospace>plot()</monospace> with the parameter
<monospace>type="map"</monospace>. For this option to work, the
<monospace>epiflows</monospace> object needs to include the longitude and latitude of the locations in decimal degree format. If coordinates are known, they can be added to the
<monospace>epiflows</monospace> object using the
<monospace>add_coordinates()</monospace> function from the
<monospace>epiflows</monospace> package. In our example, the longitude and latitude data are in the data frame
<monospace>YF_coordinates</monospace>.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#214A87">data</styled-content>
          <styled-content style="font-size:15px;color:#000000">(</styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"YF_coordinates"</styled-content>
          <styled-content style="font-size:15px;color:#000000">)</styled-content>
          <styled-content style="font-size:15px;color:#214A87">head</styled-content>
          <styled-content style="font-size:15px;color:#000000">(YF_coordinates)  </styled-content>
          <styled-content style="font-size:15px;color:#000000;">##		   id	    lon	      lat
## 1   Espirito Santo -40.30886 -19.18342
## 2	 Minas Gerais -44.55503 -18.51218
## 3   Rio de Janeiro -43.17290 -22.90685
## 4	    Sao Paulo -46.63331 -23.55052
## 5 Southeast Brazil -46.20915 -20.33318
## 6	    Argentina -63.61667 -38.41610</styled-content>
        </preformat>
      </p>
      <p>They can be added as follows.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">Brazil_epiflows &lt;- </styled-content>
          <styled-content style="font-size:15px;color:#214A87">add_coordinates</styled-content>
          <styled-content style="font-size:15px;color:#000000">(Brazil_epiflows,                   </styled-content>
          <styled-content style="font-size:15px;color:#214A87">                                   coordinates = </styled-content>
          <styled-content style="font-size:15px;color:#000000">YF_coordinates[, </styled-content>
          <styled-content style="font-size:15px;color:#CF5C00">-</styled-content>
          <styled-content style="font-size:15px;color:#0000CF">1</styled-content>
          <styled-content style="font-size:15px;color:#000000">])</styled-content>
        </preformat>
      </p>
      <p>If coordinates are unknown, we may resort to one of the freely available tools for geocoding. For example, we can use the
<monospace>geocode()</monospace> function from the
<monospace>ggmap</monospace> package
<sup><xref rid="ref-16" ref-type="bibr">16</xref></sup>. This function finds the latitude and longitude of a given location using either the
<ext-link ext-link-type="uri" xlink:href="http://www.datasciencetoolkit.org/about">Data Science Toolkit</ext-link> or
<ext-link ext-link-type="uri" xlink:href="https://developers.google.com/maps/documentation/geocoding/">Google Maps</ext-link>. We can also use
<monospace>add_coordinates()</monospace> which uses
<monospace>geocode()</monospace> to find the coordinates and directly add them to the
<monospace>epiflows</monospace> object as follows.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">Brazil_epiflows &lt;- </styled-content>
          <styled-content style="font-size:15px;color:#214A87">add_coordinates</styled-content>
          <styled-content style="font-size:15px;color:#000000">(Brazil_epiflows, </styled-content>
          <styled-content style="font-size:15px;color:#214A87">overwrite = </styled-content>
          <styled-content style="font-size:15px;color:#8F5903">TRUE</styled-content>
          <styled-content style="font-size:15px;color:#000000">)</styled-content>
        </preformat>
      </p>
      <p>Once we have assigned coordinates to the
<monospace>epiflows</monospace> object, we can use
<monospace>plot()</monospace> with
<monospace>type="map"</monospace> to visualize the population flows between locations in an interactive map (
<xref ref-type="fig" rid="f2">Figure 2</xref>).</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#214A87">plot</styled-content>
          <styled-content style="font-size:15px;color:#000000">(Brazil_epiflows, </styled-content>
          <styled-content style="font-size:15px;color:#214A87">type = </styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"map"</styled-content>
          <styled-content style="font-size:15px;color:#000000">)</styled-content>
        </preformat>
      </p>
      <fig fig-type="figure" id="f2" orientation="portrait" position="anchor">
        <label>Figure 2. </label>
        <caption>
          <title>Population flows between Brazil states and other locations plotted using
<monospace>type = "map"</monospace>.</title>
        </caption>
        <graphic xlink:href="f1000research-7-22646-g0001"/>
      </fig>
      <p>The produced map can be zoomed and permits an easy examination of flows.
<monospace>plot()</monospace> uses the
<monospace>gcIntermediate()</monospace> function from the
<monospace>geosphere</monospace> package
<sup><xref rid="ref-5" ref-type="bibr">5</xref></sup> to obtain the great circle arcs between locations, and then uses the
<monospace>leaflet</monospace> package
<sup><xref rid="ref-6" ref-type="bibr">6</xref></sup> to create an interactive map with the connection lines. The connection lines are coloured according to flow volume, and as the mouse passes over the lines, lines highlight and information about connections is shown. We can also include parameters to specify a title, the center of the map or a color palette. An interactive version of this visualization is shown here:
<ext-link ext-link-type="uri" xlink:href="https://www.repidemicsconsortium.org/epiflows/articles/introduction.html#introduction-epiflows-map">https://www.repidemicsconsortium.org/epiflows/articles/introduction.html#introduction-epiflows-map</ext-link>.</p>
    </sec>
    <sec>
      <title>Flows displayed as a network</title>
      <p>Population flows can also be displayed as a dynamic network using
<monospace>plot()</monospace> with
<monospace>type = "network"</monospace> (
<xref ref-type="fig" rid="f3">Figure 3</xref>).</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#214A87">plot</styled-content>
          <styled-content style="font-size:15px;color:#000000">(Brazil_epiflows, </styled-content>
          <styled-content style="font-size:15px;color:#214A87">type = </styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"network"</styled-content>
          <styled-content style="font-size:15px;color:#000000">)</styled-content>
        </preformat>
      </p>
      <fig fig-type="figure" id="f3" orientation="portrait" position="anchor">
        <label>Figure 3. </label>
        <caption>
          <title>Population flows between Brazil states and other locations plotted using
<monospace>type = "network"</monospace>.</title>
        </caption>
        <graphic xlink:href="f1000research-7-22646-g0002"/>
      </fig>
      <p>This option uses the package
<monospace>visNetwork</monospace>
<sup><xref rid="ref-17" ref-type="bibr">17</xref></sup> to show the locations as nodes of a network and connections between them representing population flows. This plot is interactive and it is possible to highlight a given location and examine its population flows, as well as its population, number of cases, dates and length of stay. This type of plot can be used when coordinates of locations are missing. An interactive version of this plot can be viewed here:
<ext-link ext-link-type="uri" xlink:href="https://www.repidemicsconsortium.org/epiflows/articles/introduction.html#introduction-epiflows-vis">https://www.repidemicsconsortium.org/epiflows/articles/introduction.html#introduction-epiflows-vis</ext-link>.</p>
    </sec>
    <sec>
      <title>Flows displayed as a grid between origins and destinations</title>
      <p>Finally, population flows can also be shown as a grid between locations with the option
<monospace>type="grid"</monospace> (
<xref ref-type="fig" rid="f4">Figure 4</xref>).</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#214A87">plot</styled-content>
          <styled-content style="font-size:15px;color:#000000">(Brazil_epiflows, </styled-content>
          <styled-content style="font-size:15px;color:#214A87">type = </styled-content>
          <styled-content style="font-size:15px;color:#4F9905">"grid"</styled-content>
          <styled-content style="font-size:15px;color:#000000">)</styled-content>
        </preformat>
      </p>
      <fig fig-type="figure" id="f4" orientation="portrait" position="anchor">
        <label>Figure 4. </label>
        <caption>
          <title>Population flows between Brazil states and other locations plotted using
<monospace>type = "grid"</monospace>.</title>
        </caption>
        <graphic xlink:href="f1000research-7-22646-g0003"/>
      </fig>
      <p>This plot shows flows between locations as points by positioning origins and destination in y and x axes, respectively. When using this option, additional arguments can be passed to set the size, color or shape of the points as in function
<monospace>geom_point()</monospace> of package
<monospace>ggplot2</monospace>
<sup><xref rid="ref-18" ref-type="bibr">18</xref></sup>. As the network plot, the grid plot can be used when coordinates of locations are missing.</p>
      <supplementary-material content-type="local-data" id="DS0">
        <label>Arrivals of non-resident tourists at Brazilian national borders by country of residence</label>
        <caption>
          <p>Annual volumes of air, land and water border crossings for Brazil relative to inbound tourism from years 2011 to 2015 obtained from the World Tourism Organisation (UNWTO).</p>
        </caption>
        <media xlink:href="f1000research-7-22646-s0000.tgz">
          <caption>
            <p>Click here for additional data file.</p>
          </caption>
        </media>
        <permissions>
          <copyright-statement>Copyright: © 2019 Moraga P et al.</copyright-statement>
          <copyright-year>2019</copyright-year>
          <license xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">
            <license-p>Data associated with the article are available under the terms of the Creative Commons Zero "No rights reserved" data waiver (CC0 1.0 Public domain dedication).</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="DS1">
        <label>Trips abroad by Brazilian resident visitors to countries of destination</label>
        <caption>
          <p>Annual volumes of air, land and water border crossings for Brazil relative to outbound tourism from years 2011 to 2015 obtained from the World Tourism Organisation (UNWTO).</p>
        </caption>
        <media xlink:href="f1000research-7-22646-s0001.tgz">
          <caption>
            <p>Click here for additional data file.</p>
          </caption>
        </media>
        <permissions>
          <copyright-statement>Copyright: © 2019 Moraga P et al.</copyright-statement>
          <copyright-year>2019</copyright-year>
          <license xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">
            <license-p>Data associated with the article are available under the terms of the Creative Commons Zero "No rights reserved" data waiver (CC0 1.0 Public domain dedication).</license-p>
          </license>
        </permissions>
      </supplementary-material>
    </sec>
  </sec>
  <sec>
    <title>Summary</title>
    <p>In this article we have presented the
<monospace>epiflows</monospace> package for risk assessment of travel-related spread of disease. This package allows the estimation of the expected number of infections that could be introduced to other locations from the source of infection by integrating data on the number of cases reported, population movement, length of stay and information on the distributions of the incubation and infectious periods of the disease. The package also provides tools for geocoding and visualization which facilitate the interpretation of the results.</p>
    <p>First, we presented how to estimate exportations, importations and total number of infections using the modelling framework introduced by Dorigatti
<italic>et al.</italic>
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup>. Then, we demonstrated the use of the package by assessing the risk of travel-related spread of yellow fever cases in Southeast Brazil in December 2016 to May 2017. Specifically, we have shown how to construct an
<monospace>epiflows</monospace> object containing population flows and information about locations, and how to use the function
<monospace>estimate_risk_spread()</monospace> to obtain the average and confidence intervals of the estimated number of infections introduced elsewhere. Finally, we have shown how to visualize the results and produce maps of the population flows.</p>
    <p>International travel has an important role in the spread of infectious diseases across national borders. We think the
<monospace>epiflows</monospace> package represents a useful tool for disease surveillance that can help public health officials identify locations where diseases are most likely to spread and prevention measures are most needed.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data referenced by this article are under copyright with the following copyright statement: Copyright: © 2019 Moraga P et al.</p>
    <p>Data associated with the article are available under the terms of the Creative Commons Zero "No rights reserved" data waiver (CC0 1.0 Public domain dedication).
<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/"/>
</p>
    <p><bold>Dataset 1. Arrivals of non-resident tourists at Brazilian national borders by country of residence.</bold> Annual volumes of air, land and water border crossings for Brazil relative to inbound tourism from years 2011 to 2015 obtained from the World Tourism Organisation.
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5256/f1000research.16032.d215763">https://doi.org/10.5256/f1000research.16032.d215763</ext-link>
<sup><xref rid="ref-19" ref-type="bibr">19</xref></sup>.</p>
    <p><bold>Dataset 2. Trips abroad by Brazilian resident visitors to countries of destination.</bold> Annual volumes of air, land and water border crossings for Brazil relative to outbound tourism from years 2011 to 2015 obtained from the World Tourism Organisation.
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5256/f1000research.16032.d215765">https://doi.org/10.5256/f1000research.16032.d215765</ext-link>
<sup><xref rid="ref-20" ref-type="bibr">20</xref></sup>.</p>
  </sec>
  <sec>
    <title>Software availability</title>
    <list list-type="simple">
      <list-item>
        <label>1.</label>
        <p>Dedicated website for epiflows, including installation guidelines and documentation:
<ext-link ext-link-type="uri" xlink:href="https://www.repidemicsconsortium.org/epiflows">https://www.repidemicsconsortium.org/epiflows</ext-link>
</p>
      </list-item>
      <list-item>
        <label>2.</label>
        <p>Software available from:
<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=epiflows">https://cran.r-project.org/package=epiflows</ext-link>
</p>
      </list-item>
      <list-item>
        <label>3.</label>
        <p>Source code available from:
<ext-link ext-link-type="uri" xlink:href="https://github.com/reconhub/epiflows">https://github.com/reconhub/epiflows</ext-link>
</p>
      </list-item>
      <list-item>
        <label>4.</label>
        <p>Archived source code at time of publication:
<ext-link ext-link-type="uri" xlink:href="http://doi.org/10.5281/zenodo.1401806">http://doi.org/10.5281/zenodo.1401806</ext-link>
<sup><xref rid="ref-21" ref-type="bibr">21</xref></sup>.</p>
      </list-item>
      <list-item>
        <label>5.</label>
        <p>Software license:
<ext-link ext-link-type="uri" xlink:href="https://opensource.org/licenses/MIT">MIT License</ext-link>
</p>
      </list-item>
    </list>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We would like to thank the World Tourism Organisation for the permission to make public use of the border crossing data compiled by UNTWO and purchased on
<sup><xref rid="ref-9" ref-type="bibr">9</xref></sup>. We would also like to thank the RECON consortium for establishing the research platform where this collaborative work was implemented.</p>
  </ack>
  <ref-list>
    <ref id="ref-1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heymann</surname><given-names>DL</given-names></name><name><surname>Chen</surname><given-names>L</given-names></name><name><surname>Takemi</surname><given-names>K</given-names></name><etal/></person-group>:
<article-title>Global health security: the wider lessons from the west African Ebola virus disease epidemic.</article-title><source><italic toggle="yes">Lancet.</italic></source><year>2015</year>;<volume>385</volume>(<issue>9980</issue>):<fpage>1884</fpage>–<lpage>1901</lpage>.
<pub-id pub-id-type="doi">10.1016/S0140-6736(15)60858-3</pub-id><!--<pub-id pub-id-type="pmcid">5856330</pub-id>--><?supplied-pmid 25987157?><pub-id pub-id-type="pmid">25987157</pub-id></mixed-citation>
    </ref>
    <ref id="ref-2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dorigatti</surname><given-names>I</given-names></name><name><surname>Hamlet</surname><given-names>A</given-names></name><name><surname>Aguas</surname><given-names>R</given-names></name><etal/></person-group>:
<article-title>International risk of yellow fever spread from the ongoing outbreak in Brazil, December 2016 to May 2017.</article-title><source><italic toggle="yes">Euro Surveill.</italic></source><year>2017</year>;<volume>22</volume>(<issue>28</issue>): pii: 30572.
<pub-id pub-id-type="doi">10.2807/1560-7917.ES.2017.22.28.30572</pub-id><!--<pub-id pub-id-type="pmcid">5545764</pub-id>--><?supplied-pmid 28749337?><pub-id pub-id-type="pmid">28749337</pub-id></mixed-citation>
    </ref>
    <ref id="ref-3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wickham</surname><given-names>H</given-names></name><name><surname>Chang</surname><given-names>W</given-names></name></person-group>:
<article-title>devtools: Tools to Make Developing R Packages Easier</article-title>.
<monospace>R</monospace>package version 1.13.3.<year>2017</year><ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=devtools">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pebesma</surname><given-names>EJ</given-names></name><name><surname>Bivand</surname><given-names>RS</given-names></name></person-group>:
<article-title>Classes and methods for spatial data in
<monospace>R</monospace>.</article-title><source><italic toggle="yes">R News.</italic></source><year>2005</year>;<volume>5</volume>(<issue>2</issue>):<fpage>9</fpage>–<lpage>13</lpage>.
<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/sp/vignettes/intro_sp.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hijmans</surname><given-names>RJ</given-names></name></person-group>:
<article-title>geosphere: Spherical Trigonometry</article-title>. R package version 1.5-5.<year>2016</year><ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=geosphere">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname><given-names>J</given-names></name><name><surname>Karambelkar</surname><given-names>B</given-names></name><name><surname>Xie</surname><given-names>Y</given-names></name></person-group>:
<article-title>leaflet: Create Interactive Web Maps with the
<monospace>JavaScript</monospace> ’Leaflet’ Library</article-title>. R package version 1.1.0.<year>2017</year><ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=leaflet">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-7">
      <label>7</label>
      <mixed-citation publication-type="journal"><collab>Brasilia: Ministério da Saúde. Portuguese</collab>:
<article-title>Monitoramento dos casos e óbitos de febre amarela no Brasil, informe n. 43/2017.</article-title>[Monitoring of the cases and deaths due to yellow fever in Brazil, update n. 43/2017],<year>2017</year><ext-link ext-link-type="uri" xlink:href="http://portalarquivos.saude.gov.br/images/pdf/2017/junho/02/COES-FEBRE-AMARELA---INFORME-43---Atualiza----o-em-31maio2017.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rio de Janeiro</surname></name></person-group>:
<collab>Instituto Brasileiro de Geografia e Estatística (IBGE)</collab>:
<article-title>Estimativas populacionais para os municípios e para as Unidades da Federação brasileiros em 01.07.2016.</article-title>[Population estimates for the municipalities and for the Brazilian Federal Units on 1 July 2016.],<year>2016</year><ext-link ext-link-type="uri" xlink:href="http://www.ibge.gov.br/home/estatistica/populacao/estimativa2016/estimativa_dou.shtm">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-9">
      <label>9</label>
      <mixed-citation publication-type="journal"><collab>Madrid: UN World Tourism Organization (UNWTO)</collab>:
<article-title>Yearbook of tourism statistics dataset</article-title>.<year>2016</year><ext-link ext-link-type="uri" xlink:href="http://www.e-unwto.org/action/doSearch?ConceptID=2469&amp;target=topic&amp;pageSize=20&amp;startPage=5">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ministério do Turismo</surname></name></person-group>:
<article-title>Estudo da Demanda Turística Internacional 2015.</article-title>Study of the international tourist demand 2015,<year>2017</year><ext-link ext-link-type="uri" xlink:href="http://www.dadosefatos.turismo.gov.br/2016-02-04-11-54-03/demanda-tur%C3%ADstica-internacional.html">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagraj</surname><given-names>VP</given-names></name><name><surname>Randhawa</surname><given-names>N</given-names></name><name><surname>Campbell</surname><given-names>F</given-names></name><etal/></person-group>:
<article-title><italic>epicontacts</italic>: Handling, visualisation and analysis of epidemiological contacts [version 1; referees: 1 approved, 1 approved with reservations].</article-title><source><italic toggle="yes">F1000Res.</italic></source><year>2018</year>;<volume>7</volume>:<fpage>566</fpage>.
<pub-id pub-id-type="doi">10.12688/f1000research.14492.1</pub-id><!--<pub-id pub-id-type="pmcid">6572866</pub-id>--><?supplied-pmid 31240097?><pub-id pub-id-type="pmid">31240097</pub-id></mixed-citation>
    </ref>
    <ref id="ref-12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lessler</surname><given-names>J</given-names></name><name><surname>Reich</surname><given-names>NG</given-names></name><name><surname>Brookmeyer</surname><given-names>R</given-names></name><etal/></person-group>:
<article-title>Incubation periods of acute respiratory viral infections: a systematic review.</article-title><source><italic toggle="yes">Lancet Infect Dis.</italic></source><year>2009</year>;<volume>9</volume>(<issue>5</issue>):<fpage>291</fpage>–<lpage>300</lpage>.
<pub-id pub-id-type="doi">10.1016/S1473-3099(09)70069-6</pub-id><!--<pub-id pub-id-type="pmcid">4327893</pub-id>--><?supplied-pmid 19393959?><pub-id pub-id-type="pmid">19393959</pub-id></mixed-citation>
    </ref>
    <ref id="ref-13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rudolph</surname><given-names>KE</given-names></name><name><surname>Lessler</surname><given-names>J</given-names></name><name><surname>Moloney</surname><given-names>RM</given-names></name><etal/></person-group>:
<article-title>Incubation periods of mosquito-borne viral infections: a systematic review.</article-title><source><italic toggle="yes">Am J Trop Med Hyg.</italic></source><year>2014</year>;<volume>90</volume>(<issue>5</issue>):<fpage>882</fpage>–<lpage>891</lpage>.
<pub-id pub-id-type="doi">10.4269/ajtmh.13-0403</pub-id><!--<pub-id pub-id-type="pmcid">4015582</pub-id>--><?supplied-pmid 24639305?><pub-id pub-id-type="pmid">24639305</pub-id></mixed-citation>
    </ref>
    <ref id="ref-14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johansson</surname><given-names>MA</given-names></name><name><surname>Arana-Vizcarrondo</surname><given-names>N</given-names></name><name><surname>Biggerstaff</surname><given-names>BJ</given-names></name><etal/></person-group>:
<article-title>Incubation periods of Yellow fever virus.</article-title><source><italic toggle="yes">Am J Trop Med Hyg.</italic></source><year>2010</year>;<volume>83</volume>(<issue>1</issue>):<fpage>183</fpage>–<lpage>188</lpage>.
<pub-id pub-id-type="doi">10.4269/ajtmh.2010.09-0782</pub-id><!--<pub-id pub-id-type="pmcid">2912597</pub-id>--><?supplied-pmid 20595499?><pub-id pub-id-type="pmid">20595499</pub-id></mixed-citation>
    </ref>
    <ref id="ref-15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monath</surname><given-names>TP</given-names></name></person-group>:
<article-title>Yellow fever: an update.</article-title><source><italic toggle="yes">Lancet Infect Dis.</italic></source><year>2001</year>;<volume>1</volume>(<issue>1</issue>):<fpage>11</fpage>–<lpage>20</lpage>.
<pub-id pub-id-type="doi">10.1016/S1473-3099(01)00016-0</pub-id><?supplied-pmid 11871403?><pub-id pub-id-type="pmid">11871403</pub-id></mixed-citation>
    </ref>
    <ref id="ref-16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kahle</surname><given-names>D</given-names></name><name><surname>Wickham</surname><given-names>H</given-names></name></person-group>:
<article-title>ggmap: Spatial visualization with ggplot2.</article-title><source><italic toggle="yes">R J.</italic></source><year>2013</year>;<volume>5</volume>(<issue>1</issue>):<fpage>144</fpage>–<lpage>161</lpage>.
<pub-id pub-id-type="doi">10.32614/RJ-2013-014</pub-id></mixed-citation>
    </ref>
    <ref id="ref-17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Almende</surname><given-names>BV</given-names></name><name><surname>Thieurmel</surname><given-names>B</given-names></name><name><surname>Robert</surname><given-names>T</given-names></name></person-group>:
<article-title>visNetwork: Network Visualization using ’vis.js’ Library</article-title>. R package version 2.0.4.<year>2018</year><ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=visNetwork">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wickham</surname><given-names>H</given-names></name></person-group>:
<article-title>ggplot2: Elegant Graphics for Data Analysis.</article-title>Springer-Verlag New York,<year>2009</year>; ISBN 978-0-387-98140-6.
<pub-id pub-id-type="doi">10.1007/978-0-387-98141-3</pub-id></mixed-citation>
    </ref>
    <ref id="ref-19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moraga</surname><given-names>P</given-names></name><name><surname>Dorigatti</surname><given-names>I</given-names></name><name><surname>Kamvar</surname><given-names>ZN</given-names></name><etal/></person-group>:
<article-title>Dataset 1 in: epiflows: an R package for risk assessment of travel-related spread of disease.</article-title><source><italic toggle="yes">F1000Research.</italic></source><year>2018</year><pub-id pub-id-type="doi">10.5256/f1000research.16032.d215763</pub-id></mixed-citation>
    </ref>
    <ref id="ref-20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moraga</surname><given-names>P</given-names></name><name><surname>Dorigatti</surname><given-names>I</given-names></name><name><surname>Kamvar</surname><given-names>ZN</given-names></name><etal/></person-group>:
<article-title> Dataset 2 in: epiflows: an R package for risk assessment of travel-related spread of disease.</article-title><source><italic toggle="yes">F1000Research.</italic></source><year>2018</year><pub-id pub-id-type="doi">10.5256/f1000research.16032.d215765</pub-id></mixed-citation>
    </ref>
    <ref id="ref-21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kamvar</surname><given-names>ZN</given-names></name><name><surname>Piątkowski</surname><given-names>P</given-names></name><name><surname>Jombart</surname><given-names>T</given-names></name><etal/></person-group>:
<article-title>reconhub/epiflows: Version 0.2.1: First zenodo release (Version v0.2.1).</article-title><source><italic toggle="yes">Zenodo.</italic></source><year>2018</year><pub-id pub-id-type="doi">10.5281/zenodo.1401806</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="report52017" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.19559.r52017</article-id>
    <title-group>
      <article-title>Reviewer response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ross</surname>
          <given-names>Noam</given-names>
        </name>
        <xref ref-type="aff" rid="r52017a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2136-0000</contrib-id>
      </contrib>
      <aff id="r52017a1"><label>1</label>EcoHealth Alliance, New York City, NY, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2019 Ross N</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d35e3321" ext-link-type="doi" xlink:href="10.12688/f1000research.16032.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors have addressed all concerns I raised in the first version of this paper. </p>
    <p> I note one small error: `num_sim` is used in the text, but in the package and example code this argument is `n_sim`.</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article id="report52018" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.19559.r52018</article-id>
    <title-group>
      <article-title>Reviewer response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zelner</surname>
          <given-names>Jon</given-names>
        </name>
        <xref ref-type="aff" rid="r52018a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r52018a1"><label>1</label>Department of Epidemiology, University of Michigan, Ann Arbor, MI, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2019 Zelner J</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d35e3382" ext-link-type="doi" xlink:href="10.12688/f1000research.16032.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>These all appear to be useful/helpful changes; thanks to the authors!</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article id="report38978" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.17509.r38978</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zelner</surname>
          <given-names>Jon</given-names>
        </name>
        <xref ref-type="aff" rid="r38978a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r38978a1"><label>1</label>Department of Epidemiology, University of Michigan, Ann Arbor, MI, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>10</month>
      <year>2018</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2018 Zelner J</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d35e3439" ext-link-type="doi" xlink:href="10.12688/f1000research.16032.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>In this paper, the authors have presented and provided use-case examples for an R package that allows the estimation of the number of infections spread via travel, given information on the prevalence of disease in the sending location and the rate of flow between two locations. </p>
    <p> Although the paper builds on a published method, it should provide some additional detail about the method in the introductory sections. Specifically, in the section titled "Exportations" on page 3, the authors say that "the method assumes that the incubation period T_E and the infectious period T_I follow specific probability distributions."</p>
    <p> More explanation of the modeling assumptions will allow potential users of this package to make an informed decision about whether it will be useful to them without going back to the original manuscript in which the method was described. In addition, the reuse of "T" to indicate the rate of travel in the paragraph above and the incubation and infectious periods is confusing and should be changed.</p>
    <p> From reading the paper and looking at the github repository, it seems like it is completely up to the user to specify the distribution of the incubation and infectious periods. One potentially helpful addition to the package would be the addition of data with estimates of these quantities for different pathogens where available, along with citations/dois for the data source. This would make this more user-friendly and amenable to rapid response.</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
  <sub-article id="comment4777" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Moraga</surname>
            <given-names>Paula</given-names>
          </name>
          <aff>Lancaster University, UK</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>24</day>
        <month>7</month>
        <year>2019</year>
      </pub-date>
    </front-stub>
    <body>
      <p>Thank you for your helpful and insightful comments. Please find our responses below.</p>
      <p> 1. Thank you for pointing out the choice of incubation and infectious period distributions needs clarification. In Section "Exportations" we have mentioned we assume that the incubation period and the infectious period are random variables, with associated probability distributions that are disease-specific. We have also cited the papers we used to choice the incubation and infectious period distributions of our yellow fever example.</p>
      <p> 2. Thank you for the notation review. Now we have changed the notation of the incubation period T_E by D_E, and infectious period T_I by D_I, where letter D stands for duration. Now letter T is only used for travelers.</p>
      <p> 3. We agree on the importance of the choice distributions of incubation and infectious periods. In Section "Arguments of the estimate_risk_spread() function", we have added that we can define these distributions using random generation functions of distributions that are implemented in R. However, we decided not to provide data for incubation and infectious periods of other pathogens since we expect users to have some knowledge of the life history of the disease they want to apply it to. We have mentioned that users should consider the literature carefully before deciding on appropriate distributions, and we reference two review papers that may be useful.</p>
    </body>
  </sub-article>
</sub-article>
<sub-article id="report38778" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.17509.r38778</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ross</surname>
          <given-names>Noam</given-names>
        </name>
        <xref ref-type="aff" rid="r38778a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2136-0000</contrib-id>
      </contrib>
      <aff id="r38778a1"><label>1</label>EcoHealth Alliance, New York City, NY, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>10</month>
      <year>2018</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2018 Ross N</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d35e3550" ext-link-type="doi" xlink:href="10.12688/f1000research.16032.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors present and provide a tutorial to epiflows, an R package for calculating the risk of travel-related disease export from an epidemic area.  It is a useful implementation of an algorithm, with associated visualization tools.  It is technically sound though the scaffolding around the core algorithm is somewhat over-engineered.  </p>
    <p> Both the package design and paper description imply this package is designed for rapid risk assessment.  My comments are primarily in regard to the clarity of the description and the usability of the package API in this context.
<list list-type="bullet"><list-item><p>The `global_vars()` function is a thin wrapper around R's `options()` mechanism that obfuscates what is actually happening,  and the name itself is somewhat confusing. (There are many different uses and abuses of global variables in R). It is difficult to see how this function improves over simply telling the user that default variables are defined by `epiflows.vars` in R's options mechanism (epiflows.varnames might be clearer).</p></list-item><list-item><p>While it is mentioned that the `epiflows` object inherits from `epicontacts`, it is not clear what this means and how it is relevant to the user.  Given the epiflows object has different contents than the `epicontacts` object, it should be explained.  I see in the package vignette that subsetting methods are inherited, but given that the object contents are different, this should be demonstrated in the paper.  Otherwise it is hard to see what the advantage of this object is at all, over simply passing data frames to the algorithm function.</p></list-item><list-item><p>The paper (as well as the code demonstration and vignette in the package), spends considerable time on the conversion of the partially processed data in `YF_Brazil` to data appropriately structured to be used in the `make_epiflows()` and `estimate_risk_spread()` function. This is confusing and not very useful - most users will not have data in exactly the format of `YF_Brazil`, and it distracts from the description of the core package functionality.  It would be far clearer to introduce and demonstrate the functions first using data in its ready-to-analyze form. If the authors wish to provide an example of an actual full workflow, they should start with actual raw source data from the the supplementary data. A useful addition would also be to describe possible sources of the data needed.</p></list-item><list-item><p>The distributions of incubation and infectious periods is important and glossed over rather quickly here.  First, on page 3, the text reads, "The method assumes that the incubation period TE and the infectious period TI follow specific probability distributions."  This is unclear, I think "disease-specific" would be clearer.  Moreover, in the code tutorial, these distributions are simply assumed.  It would make more sense to describe why such distributions are selected and the source of the parameters, e.g., "For yellow fever we choose these distributions based on clinical literature describing the disease course as X to Y days of incubation and V to Z days infectious period (Citation 1, Citation 2).  Lognormal or Gamma distributions are typically used for these distributions..."</p></list-item><list-item><p>It also confusing that both individuals traveling and incubation times are shown as T in the mathematical notation.</p></list-item></list>
</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
  <sub-article id="comment4776" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Moraga</surname>
            <given-names>Paula</given-names>
          </name>
          <aff>Lancaster University, UK</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>24</day>
        <month>7</month>
        <year>2019</year>
      </pub-date>
    </front-stub>
    <body>
      <p>Thank you for your thorough review and insightful comments. We address each comment separately below.</p>
      <p> 1. In response to the comment regarding the `global_vars()`  function, we think this is a fair point. The main advantage of the use of `global_vars()`  is giving the user a way to easily recover the `epiflows.vars` option variables in the case that they made an error in specifying new variables (global_vars(reset = TRUE)).</p>
      <p> 2. Thank you for bringing to our attention that the use of epicontacts needs an explanation. Because a flow of cases from one location to another can be thought of as a contact with a wider scope, the `epiflows` object inherits from the `epicontacts` object, where locations are stored in the "linelist" element and flows are stored in the "contacts" element (though the user does not need to interact with these elements by name).  By building on the epicontacts object, we ensure that all the methods for sub-setting an object of class `epicontacts` also applies to `epiflows`, reducing the maintenance effort. We have clarified this in Section “The epiflows object” of the manuscript.</p>
      <p> 3. In order to present an example that is as clear as possible for readers, we have modified the yellow fever example and now we do not describe datasets that do not have ready-to-analyze form. Now we start by describing the YF_flows and YF_locations objects which can be directly passed to the make_epiflows() function to create the Brazil_epiflows object.</p>
      <p> 4. Thank you for pointing out the importance of the distributions of incubation and infectious periods. In Section "Exportations" we have replaced "the method assumes that the incubation period T_E and the infectious period T_I follow specific probability distributions." by "We assume that the incubation period (D_E) and the infectious period (D_I) are random variables, with associated probability distributions that are disease-specific."  In Section "Arguments of the estimate_risk_spread() function", we have cited the papers we used to choose the incubation and infectious period distributions of the yellow fever example. We decided not to provide data for incubation and infectious periods of other pathogens since we expect users to have some knowledge of the life history of the disease they want to apply it to. We have also mentioned that users should consider the literature carefully before deciding on appropriate distributions, and we reference two review papers that may be useful.</p>
      <p> 5. Thank you for the notation review. Now we have changed the notation of the incubation period T_E by D_E, and infectious period T_I by D_I, where letter D stands for duration. Now letter T is only used for travelers.</p>
    </body>
  </sub-article>
</sub-article>
