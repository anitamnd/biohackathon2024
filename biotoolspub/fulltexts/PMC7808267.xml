<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ</journal-id>
    <journal-id journal-id-type="publisher-id">peerj</journal-id>
    <journal-id journal-id-type="pmc">peerj</journal-id>
    <journal-title-group>
      <journal-title>PeerJ</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2167-8359</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Diego, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7808267</article-id>
    <article-id pub-id-type="publisher-id">10559</article-id>
    <article-id pub-id-type="doi">10.7717/peerj.10559</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Statistics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Data Science</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SMARTAR: an R package for designing and analyzing Sequential Multiple Assignment Randomized Trials</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author" corresp="yes">
        <name>
          <surname>Zhong</surname>
          <given-names>Xiaobo</given-names>
        </name>
        <email>xiaobo.zhong@mountsinai.org</email>
        <xref ref-type="aff" rid="aff-1">1</xref>
      </contrib>
      <contrib id="author-2" contrib-type="author">
        <name>
          <surname>Cheng</surname>
          <given-names>Bin</given-names>
        </name>
        <xref ref-type="aff" rid="aff-2">2</xref>
      </contrib>
      <contrib id="author-3" contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xinru</given-names>
        </name>
        <xref ref-type="aff" rid="aff-2">2</xref>
      </contrib>
      <contrib id="author-4" contrib-type="author">
        <name>
          <surname>Cheung</surname>
          <given-names>Ying Kuen</given-names>
        </name>
        <xref ref-type="aff" rid="aff-2">2</xref>
      </contrib>
      <aff id="aff-1"><label>1</label><institution>Department of Population Health Science and Policy, Icahn School of Medicine at Mount Sinai</institution>, <city>New York</city>, <state>NY</state>, <country>USA</country></aff>
      <aff id="aff-2"><label>2</label><institution>Department of Biostatistics, Columbia University</institution>, <city>New York</city>, <state>NY</state>, <country>USA</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Aly</surname>
          <given-names>Sharif</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2021-01-11">
      <day>11</day>
      <month>1</month>
      <year iso-8601-date="2021">2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>e10559</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2020-04-21">
        <day>21</day>
        <month>4</month>
        <year iso-8601-date="2020">2020</year>
      </date>
      <date date-type="accepted" iso-8601-date="2020-11-22">
        <day>22</day>
        <month>11</month>
        <year iso-8601-date="2020">2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>©2021 Zhong et al.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Zhong et al.</copyright-holder>
      <license xlink:href="https://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/10559"/>
    <abstract>
      <p>This article introduces an R package, SMARTAR (Sequential Multiple Assignment Randomized Trial with Adaptive Randomization), by which clinical investigators can design and analyze a sequential multiple assignment randomized trial (SMART) for comparing adaptive treatment strategies. Adaptive treatment strategies are commonly used in clinical practice to personalize healthcare in chronic disorder management. SMART is an efficient clinical design for selecting the best adaptive treatment strategy from a family of candidates. Although some R packages can help in adaptive treatment strategies research, they mainly focus on secondary data analysis for observational studies, instead of clinical trials. SMARTAR is the first R package provides functions that can support clinical investigators and data analysts at every step of the statistical work pipeline in clinical trial practice. In this article, we demonstrate how to use this package, using a real data example.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Adaptive Treatment Strategy</kwd>
      <kwd>Analysis</kwd>
      <kwd>Clinical Trial</kwd>
      <kwd>Design</kwd>
      <kwd>R package</kwd>
      <kwd>SMART</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source> National Cancer Institute</funding-source>
        <award-id> P30 CA196521</award-id>
      </award-group>
      <funding-statement>This work was supported by the National Cancer Institute (P30 CA196521). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p><bold>SMARTAR</bold> (<bold>S</bold>equential <bold>M</bold>ultiple <bold>A</bold>ssignment <bold>R</bold>andomized <bold>T</bold>rial with <bold>A</bold>daptive <bold>R</bold>andomization) is an R package that provides functions for primary data analysis and the design calibration of sequential multiple assignment randomization trials (SMARTs) to compare multiple adaptive treatment strategies (ATSs). An ATS is a multistage treatment procedure consisting of a sequence of decision-making rules, one per treatment decision, that allows for the selection of a treatment, based on the clinical information collected by each decision-making time point (<xref rid="ref-10" ref-type="bibr">Kosorok &amp; Moodie, 2015</xref>). An ATS is alternatively called a dynamic treatment regime (<xref rid="ref-16" ref-type="bibr">Murphy et al., 2001</xref>), a treatment policy (<xref rid="ref-11" ref-type="bibr">Lanceford, Davidian &amp; Tsiatis, 2002</xref>), or an adaptive intervention (<xref rid="ref-4" ref-type="bibr">Collins, Murphy &amp; Bierman, 2004</xref>). In comparison to traditional intervention, under which a patient receives a fixed treatment throughout the entire course, in ATS the treatment level and type can be repeatedly adjusted according to the individual’s needs, providing opportunities to optimize the treatment selection as a function of time-dependent clinical information. Therefore, the concept of ATS fits the paradigm of personalized medicine. ATS is particularly effective for managing chronic conditions, such as substance disorder, depression management, and cancer.</p>
    <p><xref ref-type="fig" rid="fig-1">Figure. 1</xref> gives <xref rid="ref-14" ref-type="bibr">Murphy</xref>’s (<xref rid="ref-14" ref-type="bibr">2005</xref>) example of a two-stage ATS for controlling heavy drinking addiction. Under this strategy, alcohol-dependent patients were first given intensive cognitive behavioral therapy (CBT) for two months in stage 1. At the end of stage 1, the patients were classified as either responders or non-responders, according to their level of heavy drinking as recorded by clinicians. The decision for stage-2 treatment was adapted to the intermediate response. Non-responders were switched to the medication of opiate antagonists (MED). On the other hand, responders were recommended telephone monitoring and counseling (TMC). Comparing to a simple nonadaptive strategy, under which all the treatment decisions are made at baseline, this ATS provides an opportunity to adjust the stage-2 treatment based on the stage-1 treatment and intermediate response of the same patient. Thus, ATS can potentially improve the treatment benefit in the long run.</p>
    <fig id="fig-1" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj.10559/fig-1</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Two-stage adaptive treatment strategy for addiction management.</title>
      </caption>
      <graphic xlink:href="peerj-09-10559-g001"/>
    </fig>
    <p>SMART is a randomized clinical trial (RCT) design aimed at selecting the optimal ATS, defined as the strategy leading to the best average value of the primary outcome. A distinct feature of SMART is that it assigns patients to different treatment arms across multiple stages by sequential randomization. <xref ref-type="fig" rid="fig-2">Figure 2A</xref> shows a SMART for alcohol addiction management in which the patients were first randomized between two treatment options (i.e., CBT and MED) at baseline and then re-randomized between four treatment options at stage 2, according to the history of stage-1 treatments and intermediate responses. For example, a patient who responds to CBT is randomized to either TMC or TM, whereas a non-responder to MED is randomized to MED or a combination of the enhanced motivational program (EM), CBT, and MED. As a result, the trial provides data on 8 ATSs as <xref rid="table-1" ref-type="table">Table 1</xref>, including the previous ATS example in <xref ref-type="fig" rid="fig-1">Fig. 1</xref>.</p>
    <fig id="fig-2" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj.10559/fig-2</object-id>
      <label>Figure 2</label>
      <caption>
        <title>(A) A SMART design for comparing two-stage ATSs for addiction (R, randomization; CBT, cognitive behavioral therapy; MED, medication; TMC, telephone monitoring and counseling; TM, telephone monitoring). (B) Example of a degenerate SMART design.</title>
      </caption>
      <graphic xlink:href="peerj-09-10559-g002"/>
    </fig>
    <table-wrap id="table-1" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj.10559/table-1</object-id>
      <label>Table 1</label>
      <caption>
        <title>Two-stage adaptive treatment strategies defined in an alcohol addiction trial.</title>
      </caption>
      <alternatives>
        <graphic xlink:href="peerj-09-10559-g008"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1"/>
            <col span="1"/>
            <col span="1"/>
            <col span="1"/>
            <col span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">Stage-1</th>
              <th align="center" colspan="2" rowspan="1">Stage-2 treatment</th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">Strategy</th>
              <th rowspan="1" colspan="1">Code</th>
              <th rowspan="1" colspan="1">treatment</th>
              <th rowspan="1" colspan="1">Respondent</th>
              <th rowspan="1" colspan="1">Non-respondent</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">(1;3,2)</td>
              <td rowspan="1" colspan="1">CBT</td>
              <td rowspan="1" colspan="1">TMC</td>
              <td rowspan="1" colspan="1">MED</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">(1;3,5)</td>
              <td rowspan="1" colspan="1">CBT</td>
              <td rowspan="1" colspan="1">TMC</td>
              <td rowspan="1" colspan="1">EM+CBT+MED</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">(1;4,2)</td>
              <td rowspan="1" colspan="1">CBT</td>
              <td rowspan="1" colspan="1">TM</td>
              <td rowspan="1" colspan="1">MED</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">(1;4,5)</td>
              <td rowspan="1" colspan="1">CBT</td>
              <td rowspan="1" colspan="1">TM</td>
              <td rowspan="1" colspan="1">EM+CBT+MED</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">(2;3,1)</td>
              <td rowspan="1" colspan="1">MED</td>
              <td rowspan="1" colspan="1">TMC</td>
              <td rowspan="1" colspan="1">MED</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">(2;3,5)</td>
              <td rowspan="1" colspan="1">MED</td>
              <td rowspan="1" colspan="1">TMC</td>
              <td rowspan="1" colspan="1">EM+CBT+MED</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">(2;4,1)</td>
              <td rowspan="1" colspan="1">MED</td>
              <td rowspan="1" colspan="1">TM</td>
              <td rowspan="1" colspan="1">MED</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">(2;5,5)</td>
              <td rowspan="1" colspan="1">MED</td>
              <td rowspan="1" colspan="1">TM</td>
              <td rowspan="1" colspan="1">EM+CBT+MED</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="table-1fn">
          <p>
            <bold>Notes.</bold>
          </p>
        </fn>
        <fn id="table-1fn1" fn-type="other">
          <p>
            <def-list id="dl1">
              <def-item>
                <term> CBT</term>
                <def>
                  <p>cognitive behavioral therapy</p>
                </def>
              </def-item>
              <def-item>
                <term> EM</term>
                <def>
                  <p>enhanced motivational program</p>
                </def>
              </def-item>
              <def-item>
                <term> MED</term>
                <def>
                  <p>medication</p>
                </def>
              </def-item>
              <def-item>
                <term> TM</term>
                <def>
                  <p>telephone monitoring</p>
                </def>
              </def-item>
              <def-item>
                <term> TMC</term>
                <def>
                  <p>telephone counseling and monitoring</p>
                </def>
              </def-item>
            </def-list>
          </p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>SMART is an advanced early phase RCT design for investigators who need to select a promising intervention from multiple candidates and move it forward to a confirmatory trial. Compared to a classic design that only randomizes patients at baseline to a series of pre-specified strategies, SMART takes advantage of sequential randomization and is thus more efficient (<xref rid="ref-9" ref-type="bibr">Ko &amp; Wahed, 2012</xref>). Suppose a study aims to evaluate the eight strategies in <xref rid="table-1" ref-type="table">Table 1</xref>. A traditional RCT design randomizes patients at baseline to eight independent groups, each of which corresponds to an ATS of interest. To obtain n patients for each ATS, assuming equal randomization probabilities, we need 8n patients in total. However, under the SMART design in <xref ref-type="fig" rid="fig-2">Fig. 2A</xref>, we can obtain data on 2n patients to evaluate each ATS, for a total sample size of 8n. SMART is being increasingly used for managing chronic diseases in which patients typically face many treatment profiles across multiple stages (e.g., cancer, depression, and substance disorder).</p>
    <p>On the other hand, the sequential feature introduces challenges in analyzing SMART data. First, unlike most classic RCT designs, under which patients are randomized to be independent treatment groups, a patient who follows a specific treatment sequence in SMART can contribute information in the evaluation of multiple strategies. For example, a patient who received CBT at stage 1, failed to respond, and was switched to MED at stage 2 in <xref ref-type="fig" rid="fig-2">Fig. 2</xref> contributed data to evaluate both strategies 1 and 3 in <xref rid="table-2" ref-type="table">Table 2</xref>. Such an overlap structure introduces covariance in statistical inference for comparison. Given SMART’s flexible design structure, most classic statistical methods used to analyze RCT cannot be directly applied to this setting (<xref rid="ref-14" ref-type="bibr">Murphy, 2005</xref>; <xref rid="ref-6" ref-type="bibr">Dawson &amp; Lavori, 2012</xref>). Another potential issue is related to the dimensionality of the SMART data. The total number of ATSs embedded in a SMART increases exponentially as the design structure becomes more complex, which typically reflects more treatment stages, more treatment options, or more intermediate response categories. For example, if we add a treatment option to the stage-2 randomization for both responders and non-responders in <xref ref-type="fig" rid="fig-2">Fig. 2</xref>, the total number of strategies embedded in this trial will increase from eight to 18. Therefore, it is crucial in SMART to control for false positive findings at a certain level (<xref rid="ref-17" ref-type="bibr">Ogbagaber, Karp &amp; Wahed, 2016</xref>; <xref rid="ref-22" ref-type="bibr">Zhong et al., 2019</xref>). For more details on ATS and SMART, see <xref rid="ref-2" ref-type="bibr">Chakraborty &amp; Murphy (2014)</xref>.</p>
    <table-wrap id="table-2" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj.10559/table-2</object-id>
      <label>Table 2</label>
      <caption>
        <title>Primary functions built into the <bold>SMARTAR</bold> package.</title>
      </caption>
      <alternatives>
        <graphic xlink:href="peerj-09-10559-g009"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1"/>
            <col span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Function</th>
              <th rowspan="1" colspan="1">Outputs</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">smartsize</td>
              <td rowspan="1" colspan="1">Results of the sample size calculation</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">getncp</td>
              <td rowspan="1" colspan="1">Value of the noncentrality parameter of the chi-squared test statistics under the alternative hypothesis of the global test</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">seqmeans</td>
              <td rowspan="1" colspan="1">Design diagram, descriptive statistics, and summarized graphics at the sequence level</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">atsmeans</td>
              <td rowspan="1" colspan="1">Descriptive statistics and summarized graphs at the ATS level</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">smartest</td>
              <td rowspan="1" colspan="1">Results of the global and pairwise tests; output simultaneous confidence intervals for ATS comparisons</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p>The development of the <bold>SMARTAR</bold> pracakge was motivated by the need for a user-friendly comprehensive R package to help data analysts and clinical investigators complete the statistical work throughout the pipeline of the entire SMART, from design to data analysis, and then report generation. Although some R packages, including iqLearn (<xref rid="ref-13" ref-type="bibr">Linn, Laber &amp; Stefanski, 2015</xref>), DTR (<xref rid="ref-19" ref-type="bibr">Tang &amp; Melguizo, 2015</xref>), DTRreg (<xref rid="ref-20" ref-type="bibr">Wallace, Moodie &amp; Stephens, 2017</xref>), and DynTxRegime (<xref rid="ref-8" ref-type="bibr">Holloway et al., 2018</xref>), were created for ATS-related research, they all focus on secondary analysis for observation studies, instead of SMARTs. These methods are not commonly used in clinical trial analysis and do not support sample size calculations, which is crucial in designing a clinical trial. By the time <bold>SMARTAR</bold> was developed, the only available R package on the Comprehensive R Archive Network (CRAN; see <xref rid="ref-18" ref-type="bibr">R Core Team, 2020</xref>) that supported sample size calculations of SMARTs was <bold>smartsizer</bold> (<xref rid="ref-1" ref-type="bibr">Artman, 2019</xref>). However, this package has two limitations. First, it provides results only generated by Monte Carlo simulations but not based on any available statistical inferential method. Second, it only supports sample size calculations based on a pairwise comparison approach. Thus, it cannot be applied to calculations based on a global comparison approach, which is important if the investigator lacks sufficient information about which pair of ATSs should be targeted at the design stage.</p>
    <p>The <bold>SMARTAR</bold> package appeals to clinical investigators and data analysts in trial practice. Compared to ATS-related R packages currently available from CRAN, this package has the following innovative features. First, it supports exploratory data analysis (EDA), an efficient approach to summarizing the characteristics of data with visual methods and widely used in clinical trials. <bold>SMARTAR</bold> provides graphical tools at two different levels: the treatment sequence level and the strategy level. It can also help generate a SMART design diagram, which is essential for design purposes. Second, it is the first R package that can construct and directly output simultaneous confidence intervals for ATS comparisons. Simultaneous confidence intervals for group comparisons are commonly reported in clinical trials, wherein multiplicity adjustment is necessary. This package allows simultaneous confidence intervals to be output, corrected by Bonferroni’s method (<xref rid="ref-7" ref-type="bibr">Dunn, 1961</xref>). Third, <bold>SMARTAR</bold> provides the results of sample size calculations based on various published statistical methods in two different ways, with a global test and with a pairwise test. An investigator can then compare the results based on various statistical methods, including a global test based on inverse probability weights (IPWs; see <xref rid="ref-17" ref-type="bibr">Ogbagaber, Karp &amp; Wahed, 2016</xref>), a likelihood-based global test (<xref rid="ref-22" ref-type="bibr">Zhong et al., 2019</xref>), an IPW-based pairwise test (<xref rid="ref-14" ref-type="bibr">Murphy, 2005</xref>), and a likelihood-based pairwise test (<xref rid="ref-5" ref-type="bibr">Dawson &amp; Lavori, 2010</xref>). Such comparisons help maximize the design efficiency in trial practice.</p>
    <p>In the remainder of this article, we first introduce some fundamental concepts and notation in designing and analyzing SMARTs, and then briefly introduce the statistical methods built in this package. We then present a general introduction of five primary functions in this package, followed by how to implement them, using a real data example.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and Methods</title>
    <sec>
      <title>Important concepts and notation</title>
      <p>We introduce some fundamental concepts and notation of ATS under the SMART framework to help further illustration. We define a stage as an interval of time during which a patient receives only one treatment. At the beginning of stage t, where t = 1, …, T and T is the total number of stages in a SMART, an evaluation O<sub>ti</sub> is made to the <italic>i</italic>th patient. Here, i = 1, …, n is the patient index and n is the total sample size. Let A<sub>ti</sub> be the treatment given to patient i at stage <italic>t</italic> and let Y <sub>i</sub> be the final primary outcome observed at the end of the study. Data collected from subject i who completes a T-stage SMART can be summarized as a longitudinal trajectory: <disp-formula id="eqn-1"><label>(1)</label><alternatives><graphic xlink:href="peerj-09-10559-e001.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \left\{ {\mathrm{O}}_{1\mathrm{i}},{\mathrm{A}}_{1\mathrm{i}},\ldots ,{\mathrm{O}}_{\mathrm{Ti}},{\mathrm{A}}_{\mathrm{Ti}},{\mathrm{Y }}_{\mathrm{i}} \right\} \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-1"><mml:mstyle displaystyle="true"><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ti</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ti</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
      <p>For example, in the alcohol addiction trial example (<xref ref-type="fig" rid="fig-2">Fig. 2A</xref>), considering that stage -1 treatment is not adaptive to baseline information, data collected from patient <italic>i</italic> can be summarized as <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i001.jpg"/><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$ \left\{ {\mathrm{A}}_{1\mathrm{i}},{\mathrm{O}}_{2\mathrm{i}},{\mathrm{A}}_{2\mathrm{i}},{\mathrm{Y }}_{\mathrm{i}} \right\} $\end{document}</tex-math><mml:math id="mml-ieqn-15"><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula>. In this case, A<sub>1i</sub> ∈ {CBT, MED} represents the stage-1 treatment a patient can possibly receive, A<sub>2i</sub> ∈ {TMC, TM, MED, EM + CBT + MED} represents the stage-2 treatment, O<sub>2i</sub> is the binary intermediate outcome measured at the end of stage-1, and Y <sub><italic>i</italic></sub> is the primary outcome defined as the percentage of days of abstinence over the entire treatment period. We use an overbar above the letter to indicate the history of that measurement up to the current time, when the event denoted by the letter occurs. For example, <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i002.jpg"/><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\bar {\mathrm{A}}}_{2\mathrm{i}}= \left\{ {\mathrm{A}}_{1\mathrm{i}},{\mathrm{A}}_{2\mathrm{i}} \right\} $\end{document}</tex-math><mml:math id="mml-ieqn-20"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula> indicates the history of treatments received by patient i at stages 1 and 2 and <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i003.jpg"/><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\bar {\mathrm{O}}}_{2\mathrm{i}}= \left\{ {\mathrm{O}}_{1\mathrm{i}},{\mathrm{O}}_{2\mathrm{i}} \right\} $\end{document}</tex-math><mml:math id="mml-ieqn-22"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula> represents the evaluation results of patient <italic>i</italic> up to O<sub>2i</sub>. We can thus simplify <xref ref-type="disp-formula" rid="eqn-1">Eq. (1)</xref> as <disp-formula id="eqn-2"><label>(2)</label><alternatives><graphic xlink:href="peerj-09-10559-e002.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \left\{ {\bar {\mathrm{O}}}_{\mathrm{Ti}},{\bar {\mathrm{A}}}_{\mathrm{Ti}},{\mathrm{Y }}_{\mathrm{i}} \right\} .\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-2"><mml:mstyle displaystyle="true"><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ti</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ti</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
      <p>We suppress the subject indicator <italic>i</italic> for convenience whenever appropriate in the remainder of this article, so that <xref ref-type="disp-formula" rid="eqn-1">Eqs. (1)</xref> and <xref ref-type="disp-formula" rid="eqn-2">(2)</xref> become <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i004.jpg"/><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$ \left\{ {\mathrm{O}}_{1},{\mathrm{A}}_{1},\ldots ,{\mathrm{O}}_{\mathrm{T}},{\mathrm{A}}_{\mathrm{T}},\mathrm{Y } \right\} $\end{document}</tex-math><mml:math id="mml-ieqn-27"><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i005.jpg"/><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$ \left\{ {\bar {\mathrm{O}}}_{\mathrm{T}},{\bar {\mathrm{A}}}_{\mathrm{T}},\mathrm{Y } \right\} $\end{document}</tex-math><mml:math id="mml-ieqn-28"><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula>, respectively. Let <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i006.jpg"/><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\mathrm{d}}_{\mathrm{t}} \left( {\bar {\mathrm{O}}}_{\mathrm{t}},{\bar {\mathrm{A}}}_{\mathrm{t}-1} \right) $\end{document}</tex-math><mml:math id="mml-ieqn-29"><mml:msub><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula> be the decision-making rules of the action of <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i007.jpg"/><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\bar {\mathrm{A}}}_{\mathrm{t}}$\end{document}</tex-math><mml:math id="mml-ieqn-30"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> conditioning on the history of <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i008.jpg"/><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$ \left( {\bar {\mathrm{O}}}_{\mathrm{t}},{\bar {\mathrm{A}}}_{\mathrm{t}-1} \right) $\end{document}</tex-math><mml:math id="mml-ieqn-31"><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula>. An ATS can be viewed as a collection of decision-making rules across different clinical historical paths and can thus be defined as <disp-formula id="eqn-3"><label>(3)</label><alternatives><graphic xlink:href="peerj-09-10559-e003.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}\mathrm{D}= \left\{ {\mathrm{d}}_{1} \left( {\bar {\mathrm{O}}}_{1} \right) ;\cdots \,;{\mathrm{d}}_{\mathrm{T}} \left( {\bar {\mathrm{O}}}_{\mathrm{T}},{\bar {\mathrm{A}}}_{\mathrm{T}-1} \right) \right\} \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-3"><mml:mstyle displaystyle="true"><mml:mi mathvariant="normal">D</mml:mi><mml:mo>=</mml:mo><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>;</mml:mo><mml:mo>⋯</mml:mo><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mstyle></mml:math></alternatives></disp-formula>wherein <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i009.jpg"/><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\mathrm{d}}_{\mathrm{t}} \left( {\bar {\mathrm{O}}}_{\mathrm{t}},{\bar {\mathrm{A}}}_{\mathrm{t}-1} \right) $\end{document}</tex-math><mml:math id="mml-ieqn-33"><mml:msub><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula>, a scalar or a vector, is a stage-specific decision-making rule for selecting A<sub>t</sub> and depends on the combination of <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i010.jpg"/><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$ \left( {\bar {\mathrm{O}}}_{\mathrm{t}},{\bar {\mathrm{A}}}_{\mathrm{t}-1} \right) $\end{document}</tex-math><mml:math id="mml-ieqn-35"><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula>. In the alcohol addiction trial example, let {1,2,3,4,5} be the treatment options CBT, MED, TMC, TM, and EM+CBT+MED, respectively, and let {0,1} be the intermediate outcomes of response and no response. We can code the eight alcohol management strategies as shown in the second column of <xref rid="table-1" ref-type="table">Table 1</xref>.</p>
      <p>In practice, it is common but not necessary to define O<sub>t</sub> as binary, to reduce the dimensionality of the SMART data. To simplify the design structure to improve efficiency, SMART also allows for the degenerate structure to reflect the knowledge of investigators from previous studies. For example, suppose an investigator already knows two factors: first, no treatment at stage 2 provides an additional effect for the initial treatment of MED; second, TMC is universally better than TM for responders to CBT. It is reasonable to degenerate the SMART design from <xref ref-type="fig" rid="fig-2">Figs. 2A</xref> to <xref ref-type="fig" rid="fig-2">2B</xref>. For more details of degenerated SMART designs, see <xref rid="ref-22" ref-type="bibr">Zhong et al. (2019)</xref>. <bold>SMARTAR</bold> can handle SMART with any design structure, including degenerate cases.</p>
    </sec>
    <sec>
      <title>Statistical methods</title>
      <p>We briefly introduce the methods commonly applied to SMART and included in this R package. Although trial practice always starts with a sample size calculation at the design stage, followed by data analysis. Given that the sample size calculation is always based on the method of the primary analysis, we first introduce the methods of comparison and then the sample size calculation. Given the aim of this article, we skip some technical details for simplicity. For more details, see the original articles of these methods.</p>
      <p>Let <italic>θ</italic> be the value of an ATS, defined as the average primary outcome of patients across all the treatment sequences under the strategy. To estimate the ATS value, IPW estimatior is common, by which the weight of estimation is constructed based on the production of randomization probabilities corresponding to an individual (<xref rid="ref-14" ref-type="bibr">Murphy, 2005</xref>). Alternatively, we can use G-computation estimation (<xref rid="ref-12" ref-type="bibr">Lavori &amp; Dawson, 2007</xref>), based on analyzing the marginal mean of the primary outcome following each treatment sequence under the ATS of interest.</p>
      <p>Let <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i011.jpg"/><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat {\theta }}_{\mathrm{g}}$\end{document}</tex-math><mml:math id="mml-ieqn-38"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> be the estimated value of the <italic>g</italic>th ATS, where g is the strategy indicator and g = 1, …,G. For example, in the alcohol addiction example, the total number of strategies G = 8 (see <xref rid="table-1" ref-type="table">Table 1</xref>). We can build a Wald-type global test with hypotheses: <disp-formula id="eqn-4"><label>(4)</label><alternatives><graphic xlink:href="peerj-09-10559-e004.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}{\mathrm{H}}_{0}:{\theta }_{1}=\cdots ={\theta }_{\mathrm{G}} \text{versus} {\mathrm{H}}_{1}:{{\theta }^{{^{\prime}}}}_{g}\mathrm{s} \text{are not all equal for g}=1,\ldots \mathrm{G}.\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-4"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msub><mml:mspace width="10.00002pt"/><mml:mtext>versus</mml:mtext><mml:mspace width="10.00002pt"/><mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="1em"/><mml:mtext>are not all equal for g</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mi mathvariant="normal">G</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
      <p>Let C = (1<sub><italic>G</italic>−1</sub>| − <italic>I</italic><sub><italic>G</italic>−1</sub>) be a (G − 1) × G contrast matrix and let <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i012.jpg"/><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat {\Sigma }$\end{document}</tex-math><mml:math id="mml-ieqn-45"><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover></mml:math></alternatives></inline-formula> be the consistent estimator of the covariance matrix of <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i013.jpg"/><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat {\Theta }={ \left( {\hat {\theta }}_{1},\ldots ,{\hat {\theta }}_{\mathrm{G}} \right) }^{\mathrm{T}}$\end{document}</tex-math><mml:math id="mml-ieqn-46"><mml:mover accent="true"><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. We can then construct a test statistic Q: <disp-formula id="eqn-5"><label>(5)</label><alternatives><graphic xlink:href="peerj-09-10559-e005.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}\mathrm{Q}=\mathrm{n}{ \left( \mathrm{C}\hat {\theta } \right) }^{\mathrm{T}}{ \left( \mathrm{C}\hat {\Sigma }{\mathrm{C}}^{\mathrm{T}} \right) }^{-1} \left( \mathrm{C}\hat {\theta } \right) .\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-5"><mml:mstyle displaystyle="true"><mml:mi mathvariant="normal">Q</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">n</mml:mi><mml:msup><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover><mml:msup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
      <p>As <italic>n</italic> → ∞, the test statistic Q approaches a central chi-squared distribution with degrees of freedom <italic>υ</italic> under the null hypothesis in <xref ref-type="disp-formula" rid="eqn-4">Eq. (4)</xref>. Under the alternative hypothesis, Q approaches a noncentral chi-squared distribution with the same degrees of freedom <italic>υ</italic> and noncentrality parameter <italic>λ</italic>. For details of this test under the general SMART design, see <xref rid="ref-22" ref-type="bibr">Zhong et al. (2019)</xref>. On the other hand, let <italic>θ</italic><sub>j</sub> and <italic>θ</italic><sub>k</sub> be the values of two strategies j and k, where j ≠ k. We can then conduct a pairwise test with the following hypotheses: <disp-formula id="eqn-6"><label>(6)</label><alternatives><graphic xlink:href="peerj-09-10559-e006.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} {\mathrm{H}}_{0}:{\theta }_{\mathrm{j}}={\theta }_{\mathrm{k}} \text{versus} {\mathrm{H}}_{1}:{\theta }_{\mathrm{j}}\not = {\theta }_{\mathrm{k}},\text{where} \mathrm{j},\mathrm{k}=1,\ldots \mathrm{G} \text{and} \mathrm{j}\not = \mathrm{k}.\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-6"><mml:mstyle displaystyle="true"><mml:mspace width="20.00003pt"/><mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mspace width="10.00002pt"/><mml:mtext>versus</mml:mtext><mml:mspace width="10.00002pt"/><mml:msub><mml:mrow><mml:mi mathvariant="normal">H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext>where</mml:mtext><mml:mspace width="1em"/><mml:mi mathvariant="normal">j</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mi mathvariant="normal">G</mml:mi><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:mi mathvariant="normal">j</mml:mi><mml:mo>≠</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
      <p>In analysis, the investigator can calculate the <italic>p</italic>-value of a pairwise test and compare it to a prespecified significance level <italic>α</italic>, adjusted for multiplicity. Both the global and pairwise tests control the overall significance level strictly, although the pairwise test is relatively conservative for large numbers of strategies. For example, eight strategies are embedded in the alcohol addiction trial (<xref ref-type="fig" rid="fig-2">Fig. 2A</xref>). Suppose we choose to control the overall significance level at 0.05; a pairwise test then needs to have a <italic>p</italic>-value of less than 0.05∕28 = 0.0018 to claim overall statistically significance. Alternatively, we can construct a series of simultaneous confidence intervals: <disp-formula id="NONUM-d2e1808"><alternatives><graphic xlink:href="peerj-09-10559-e007.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \left( {\hat {\theta }}_{\mathrm{j}}-{\hat {\theta }}_{\mathrm{k}} \right) \pm {\delta }_{\mathrm{jk}}\times \frac{{\hat {\sigma }}_{\mathrm{jk}}}{\sqrt{{\mathrm{n}}_{\mathrm{jk}}}} , \text{where} \mathrm{j},\mathrm{k}=1,\ldots \mathrm{G} \mathrm{and} \mathrm{j}\not = \mathrm{k}, \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-NONUM-d2e1808"><mml:mstyle displaystyle="true"><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>±</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">jk</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">jk</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">jk</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="2.22198pt"/><mml:mtext>where</mml:mtext><mml:mspace width="1em"/><mml:mi mathvariant="normal">j</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mi mathvariant="normal">G</mml:mi><mml:mspace width="1em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="1em"/><mml:mi mathvariant="normal">j</mml:mi><mml:mo>≠</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>and then compare the intervals to zero. To control the overall confidence level at 1 − <italic>α</italic>, we need to adjust <italic>δ</italic><sub>jk</sub> as follows: <disp-formula id="eqn-7"><label>(7)</label><alternatives><graphic xlink:href="peerj-09-10559-e008.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}\mathrm{P} \left( \left\vert \mathrm{Z} \right\vert \leq {\delta }_{\mathrm{jk}} \right) =1- \frac{\alpha }{{\mathrm{n}}_{\mathrm{p}}} \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-7"><mml:mstyle displaystyle="true"><mml:mi mathvariant="normal">P</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mfenced separators="" open="|" close="|"><mml:mrow><mml:mi mathvariant="normal">Z</mml:mi></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">jk</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:math></alternatives></disp-formula>where <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i014.jpg"/><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\mathrm{n}}_{\mathrm{p}}= \frac{(\mathrm{G}-1)\times \mathrm{G}}{2} $\end{document}</tex-math><mml:math id="mml-ieqn-67"><mml:msub><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mi mathvariant="normal">G</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow><mml:mo>×</mml:mo><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> is the number of contrasts. In the alcohol addiction trial, <italic>G</italic> = 8 and we thus obtain the value <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i015.jpg"/><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\mathrm{n}}_{\mathrm{p}}= \left( 7\times 8 \right) \div 2=28$\end{document}</tex-math><mml:math id="mml-ieqn-69"><mml:msub><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mn>7</mml:mn><mml:mo>×</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:mfenced><mml:mo>÷</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mn>28</mml:mn></mml:math></alternatives></inline-formula>.</p>
      <p>Similarly, the sample size calculation of a SMART is based on either a global test or a pairwise test, depending on the investigator’s preference and prior knowledge. In practice, an investigator can calculate the sample size of a SMART based on a global test according to the following steps.</p>
      <p><bold>Step 1</bold>: Determine the design diagram, set up the randomization probabilities, and calculate the degrees of freedom <italic>υ</italic>: <disp-formula id="eqn-8"><label>(8)</label><alternatives><graphic xlink:href="peerj-09-10559-e009.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}\mathrm{\upsilon }=\sum _{\mathrm{t}=1}^{\mathrm{T}}{\mathrm{N}}_{\mathrm{ At}}-\sum _{\mathrm{t}=1}^{\mathrm{T}}{\mathrm{N}}_{\mathrm{ Ot}}+1,\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-8"><mml:mstyle displaystyle="true"><mml:mi mathvariant="normal">υ</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo mathsize="big" movablelimits="false"> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal"> At</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mrow><mml:mo mathsize="big" movablelimits="false"> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal"> Ot</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>where <italic>N</italic><sub><italic>At</italic></sub> is the total number of treatment options and <italic>N</italic><sub><italic>Ot</italic></sub> is the total number of baseline/intermediate response categories at stage t in the design diagram.</p>
      <p><bold>Step 2</bold>: For a prespecified type I error rate <italic>α</italic> and a targeted power 1 − <italic>β</italic>, determine the noncentrality parameter <italic>λ</italic><sup>∗</sup> required under the alternative hypothesis of <xref ref-type="disp-formula" rid="eqn-4">Eq. (4)</xref> by solving <disp-formula id="eqn-9"><label>(9)</label><alternatives><graphic xlink:href="peerj-09-10559-e010.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}{\chi }_{\mathrm{\upsilon },1-\beta }^{2}({\lambda }^{\ast })={\chi }_{\mathrm{ \upsilon },\alpha }^{2}(0),\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-9"><mml:mstyle displaystyle="true"><mml:msubsup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">υ</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mfenced></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal"> υ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mn>0</mml:mn></mml:mfenced></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>where <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i016.jpg"/><tex-math id="M26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\chi }_{\mathrm{\upsilon },1-\beta }^{2}({\lambda }^{\ast })$\end{document}</tex-math><mml:math id="mml-ieqn-78"><mml:msubsup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">υ</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mfenced></mml:mrow></mml:math></alternatives></inline-formula> denotes the (1 − <italic>β</italic>)th percentile of a noncentral chi-squared distribution with <italic>υ</italic> degrees of freedom and noncentrality parameter <italic>λ</italic><sup>∗</sup>.</p>
      <p><bold>Step 3</bold>: For the given randomization probabilities, expected baseline/intermediate response rates, and sequence-specific means and variances of the primary outcome, calculate the targeted strategy values Θ<sup>∗</sup> and its covariance matrix Σ<sup>∗</sup> so that standardized overall effect size, Δ, can be calculated according to <disp-formula id="eqn-10"><label>(10)</label><alternatives><graphic xlink:href="peerj-09-10559-e011.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}\Delta ={ \left( \mathrm{C}{\Theta }^{\ast } \right) }^{\mathrm{T}}{ \left( \mathrm{C}{\Sigma }^{\ast }{\mathrm{C}}^{\mathrm{T}} \right) }^{-}(\mathrm{C}{\Theta }^{\ast }).\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-10"><mml:mstyle displaystyle="true"><mml:mi>Δ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:msup><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:msup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mi mathvariant="normal">C</mml:mi><mml:msup><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mfenced></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula><bold>Step 4</bold>: The total number of patients needed for a SMART is <disp-formula id="eqn-11"><label>(11)</label><alternatives><graphic xlink:href="peerj-09-10559-e012.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}\mathrm{n}= \frac{{\lambda }^{\ast }}{\Delta } .\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-11"><mml:mstyle displaystyle="true"><mml:mi mathvariant="normal">n</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
      <p>Alternatively, we can calculate the sample size based on a pairwise test according to the expected standardized difference between two ATS values of interest, as in a classic two-arm RCT. The parameter values needed to calculate the standardized difference can be obtained from Θ<sup>∗</sup> and Σ<sup>∗</sup> in <xref ref-type="disp-formula" rid="eqn-5">Eq. (5)</xref>. Note that a pair of strategies embedded in a SMART do not necessarily have to be independent, and the covariance varies by the design structure, randomization probabilities, intermediate response rates, and sequence-specific primary outcomes.</p>
    </sec>
    <sec>
      <title>R functions</title>
      <p>The newly developed <bold>SMARTAR</bold> package includes five primary functions: <bold><italic>smartsize</italic></bold><italic>,</italic>
<bold><italic>getncp, seqmeans</italic></bold><italic>,</italic>
<bold><italic>atsmeans</italic></bold><bold>,</bold> and <bold><italic>smartest</italic></bold> (see <xref rid="table-2" ref-type="table">Table 2</xref>). These functions provide important statistical results from the design to the analysis of a SMART for selecting the best ATS from a family of candidates. The first step of a SMART is to estimate the sample size required to achieve a targeted statistical power for a valid inference of comparison under the strict control of false positive findings. The <bold><italic>smartsize</italic></bold> function helps conduct sample size calculations in two different manners, using either a global test or a pairwise test. This function allows one to control design parameters, such as the targeted type I error rate, statistical power, the type of primary outcome, the method of estimation, and the type of test. An important parameter in powering a SMART with a global test is the noncentrality parameter <italic>λ</italic><sup>∗</sup> in (11), which can be obtained by solving <xref ref-type="disp-formula" rid="eqn-9">Eq. (9)</xref>. Generally, smaller type I error, greater statistical power, and larger degrees of freedom (reflecting the number of treatment options and the number of intermediate response categories) require a larger <italic>λ</italic><sup>∗</sup>, and hence a larger sample size. The <bold><italic>getncp</italic></bold> function returns the value of the noncentrality parameter.</p>
      <p>The SMARTAR package provides two functions, <italic>seqmeans</italic> and <italic>atsmeans</italic>, to summarize descriptive statistics at the treatment sequence level and at the ATS level. Both functions output summarized graphics for visualization. A SMART provides data consisting of multiple treatment sequences <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i017.jpg"/><tex-math id="M29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$ \left( {\bar {\mathrm{O}}}_{\mathrm{T}},{\bar {\mathrm{A}}}_{\mathrm{T}},\mathrm{Y } \right) $\end{document}</tex-math><mml:math id="mml-ieqn-91"><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mo> ¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula>. The sequence a patient will follow depends on the results of randomization and baseline/intermediate evaluation (i.e., called the tailoring variables). Only one sequence can be observed for a patient who completes the trial. The <bold><italic>seqmeans</italic></bold> function returns the descriptive statistics of all the treatment sequences embedded in the SMART. For each sequence, it gives information about the definition of the treatment sequence (e.g., stage-1 treatment, intermediate response, and stage-2 treatment for the alcohol addiction trial example), the number of patients, the mean, variance, and standard deviation of the primary outcome. This function can output the design diagram and summary graph of the descriptive statistics (i.e., a boxplot for a continuous outcome and a bar chart for a binary outcome). Alternatively, the function <bold><italic>atsmeans</italic></bold> gives descriptive statistics corresponding to the ATSs<italic>,</italic> including those identified in a SMART dataset as defined by <xref ref-type="disp-formula" rid="eqn-3">Eq. (3)</xref>, estimated values <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i018.jpg"/><tex-math id="M30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat {\theta }$\end{document}</tex-math><mml:math id="mml-ieqn-92"><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover></mml:math></alternatives></inline-formula> with confidence intervals, and the estimated variance–covariance matrix <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i019.jpg"/><tex-math id="M31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat {\Sigma }$\end{document}</tex-math><mml:math id="mml-ieqn-93"><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mo> ˆ</mml:mo></mml:mrow></mml:mover></mml:math></alternatives></inline-formula> of these strategy values. This function also provides a forest plot to show all the estimated strategy values with confidence intervals.</p>
      <p>Other than descriptive statistics, a valid conclusion of a SMART should be made based on the inference results of comparisons. Using the <bold><italic>smartest</italic></bold> function, the user can obtain the results of both global and pairwise comparisons, which are crucial for the final analysis report.</p>
    </sec>
    <sec>
      <title>Illustration with a real data example</title>
      <p>In this section, we illustrate how to apply the primary functions of <bold>SMARTAR</bold> using example data from a depression management trial. The illustration starts with the example followed by the data format applied to these functions. We then demonstrate the sample size calculation for the trial design. Afterward, we illustrate how to analyze the SMART data, including exploratory data analysis, descriptive statistics, hypothesis tests, and the use of simultaneous confidence intervals.</p>
    </sec>
    <sec>
      <title>CODIACS trial</title>
      <p><xref rid="ref-3" ref-type="bibr">Cheung, Chakraborty &amp; Davidson (2015)</xref> analyze SMART data for a subset of patients enrolled in a Comparison of Depression Interventions after Acute Coronary Syndrome (CODIACS) trial to determine further which stepped care depression management strategy should be used and which discontinued in an implementation stage. A specific task can thus be formulated as selecting the best adaptive depression management strategy for further practice, based on a reduction of Beck Depression Inventory (BDI) scores six months after enrollment, the primary endpoint of the trial. Higher BDI scores are known to be linked to more severe depression symptoms, and thus a strategy leading to a greater BDI reduction indicates a better treatment effect. In other words, the value of a depression management strategy, in this case, is the expected reduction of the BDI at six months. Each ATS, in this case, would adapt to an intermediate response, defined as a BDI reduction of at least three units during the eight-week step period. Two treatment options, medication (MED) and problem-solving therapy (PST), are considered at baseline and potentially at the end of the step period for modification. In this article, we use the CODIACS data as an example to demonstrate the usage of the primary functions in <bold>SMARTAR</bold>.</p>
    </sec>
    <sec>
      <title>Data format</title>
      <p>The <bold>SMARTAR</bold> package requires inputting wide-formatted data of a T-stage SMART with variables <disp-formula id="NONUM-d2e2666"><alternatives><graphic xlink:href="peerj-09-10559-e013.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}\{\mathrm{O}1,\mathrm{A}1,\mathrm{O}2,\mathrm{A}2,\ldots ,\mathrm{OT},\mathrm{AT},\mathrm{Y }\}. \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-NONUM-d2e2666"><mml:mstyle displaystyle="true"><mml:mrow><mml:mfenced separators="" open="{" close="}"><mml:mi mathvariant="normal">O</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">O</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">OT</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">AT</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Y</mml:mi></mml:mfenced></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
      <p>Each row of data represents the record of a patient who has completed the trial. If the stage-1 treatment is not adaptive to baseline information, O1 will be eliminated from data and the variables become <disp-formula id="NONUM-d2e2723"><alternatives><graphic xlink:href="peerj-09-10559-e014.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}\{\mathrm{A}1,\mathrm{O}2,\mathrm{A}2,\ldots ,\mathrm{OT},\mathrm{AT},\mathrm{Y }\}. \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-NONUM-d2e2723"><mml:mstyle displaystyle="true"><mml:mrow><mml:mfenced separators="" open="{" close="}"><mml:mi mathvariant="normal">A</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">O</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">OT</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">AT</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Y</mml:mi></mml:mfenced></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
      <p>Below are examples of R code and the corresponding results in the R console. We first attached the package, retrieved the data named <italic>codiacs</italic>, and then printed the summary of variables and first several rows of this dataset. Here, <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i020.jpg"/><tex-math id="M34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathrm{A}1\in \left\{ 0,1 \right\} $\end{document}</tex-math><mml:math id="mml-ieqn-97"><mml:mi mathvariant="normal">A</mml:mi><mml:mn>1</mml:mn><mml:mo>∈</mml:mo><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i021.jpg"/><tex-math id="M35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathrm{A}2\in \left\{ 0,1 \right\} $\end{document}</tex-math><mml:math id="mml-ieqn-98"><mml:mi mathvariant="normal">A</mml:mi><mml:mn>2</mml:mn><mml:mo>∈</mml:mo><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula> are the stage-1 and stage-2 treatment variables, respectively, with 0 denoting MED and 1 denoting PST. Considering that A1 is not adaptive here, there is no O1 in this dataset. The intermediate outcome <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i022.jpg"/><tex-math id="M36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathrm{O}2\in \left\{ 0,1 \right\} $\end{document}</tex-math><mml:math id="mml-ieqn-101"><mml:mi mathvariant="normal">O</mml:mi><mml:mn>2</mml:mn><mml:mo>∈</mml:mo><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula> is 0 for no response and 1 for response, and Y is the continuous primary outcome of a BDI reduction at six months. Although this dataset provides a patient indicator variable <italic>ID</italic> and treatment sequence indicator variable <italic>group</italic>, they are not necessary for this R package, because the functions will identify treatment sequence by the values of As and Os. If the variables names in the original data differ from the above, the user needs to rename them before running the functions.</p>
      <p>
        <inline-graphic xlink:href="peerj-09-10559-i023.jpg" mimetype="image" mime-subtype="png" content-type="symbol"/>
      </p>
    </sec>
    <sec>
      <title>Sample size calculation</title>
      <p>Sample size calculation is key statistical work for controlling the budget, enrollment period, and study duration of a SMART. The <bold><italic>smartsize</italic></bold> function allows one to power a SMART trial flexibly. By setting the logical operator global=TRUE, we can calculate the sample size based on the global test with the hypothesis in <xref ref-type="disp-formula" rid="eqn-4">Eq. (4)</xref>. Otherwise, the operator outputs the results based on the pairwise test. A user can also set the targeted type I and II error rates via the two arguments <italic>alpha</italic> and <italic>beta</italic>, respectively, when calling this function. By default, alpha=0.05 and beta=0.20. The <italic>family</italic> argument in this function allows the features of the primary outcome to be specified for calculation, where family=“gaussian” for a continuous primary outcome and family=“binomial” for a binary outcome. The default is family=“gaussian”. Users can also control the calculation for two different methods, method=“Gest” for G-computation estimation (default) and method=“IPW” for the IPW estimation.</p>
      <p>The R code and results of powering the CODIACS trial by the <bold><italic>smartsize</italic></bold> function are shown at the end of this section. The investigator is interested in a SMART with two stage-1 treatments, a binary intermediate outcome, and two stage-2 treatments at each decision point. The randomization probabilities are set to be 0.50 for each treatment option. To power the trial based on the global test (part 1), suppose the expected means and standard deviations of the primary outcome (i.e., BDI reduction at six months) for the eight treatment sequences are (1,8,11,10,9,6,20,12) and (10,10,10,10,10,10,10,10), respectively; an effect size Δ = 0.1213 can then be calculated by formula <xref ref-type="disp-formula" rid="eqn-7">Eq. (7)</xref> and thus coded in the function as <italic>delta=0.1213</italic>. According to formula <xref ref-type="disp-formula" rid="eqn-8">Eq. (8)</xref>, the degrees of freedom are coded as <italic>df</italic> = 5<italic/>. Therefore, the key information of the sample size calculation is the output in the R console. The noncentrality parameter of the chi-squared distribution under the alternative hypothesis in <xref ref-type="disp-formula" rid="eqn-4">Eq. (4)</xref> is denoted NCP. In this case, we have NCP=12.8249. The effect size and degrees of freedom are delta and df, respectively, and N is the total sample size required.</p>
      <p>Alternatively, an investigator can use the argument <italic>sim</italic> to input a sequence information matrix (SIM), which is a data frame containing all the required sequence-specific information for calculating the effect size and degrees of freedom. Part 2 of the example code shows the SIM and how to input it into <bold><italic>smartsize</italic></bold>. The data frame SIMatrix in this example includes the values of a series of variables {SEQ,A1,PI1,O2,P2,A2,PI2,MEAN,SD}, where SEQ is the treatment sequence indicator, A1 is the stage-1 treatment, PI1 is the stage-1 randomization probability, O2 is the intermediate response measured at the end of stage 1, P2 is the intermediate response rate, A2 is the stage-2 treatment, PI2 is the stage-2 randomization probability, MEAN is the sequence-specific mean, and SD is the sequence-specific standard deviation of the primary outcome. Note that Part 2 yields the same sample size calculation as Part 1, although the information is input into the function differently. In practice, the investigator first specifies the design structure of a SMART, based on the question of interest, clinical practice, and available treatment options. The investigator then makes the assumptions about the intermediate response rates, means, and standard deviation for each treatment sequence, based on prior knowledge. Using the SIM in Part 2 is appealing for clinical investigators who are not experts in statistical calculation. The results show that, for a SMART design with a design diagram as in <xref ref-type="fig" rid="fig-3">Fig. 3A</xref> and applied equal randomization probabilities at each decision-making point, if the sequence-specific means and standard deviations of the primary outcome are expected to be the values in the SIM in Part 2, a total sample size of 106 patients helps achieve 80% power of rejecting the null hypothesis that all eight ATSs have the same values at a significance level of 0.05. A statistician who is familiar with SMART design can first calculate the effect size and then input it into the function via <italic>delta</italic>. The effect size is an essential measure of SMART design, since we can compare different possible designs by their calibrated effect sizes in the calibration.</p>
      <fig id="fig-3" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.10559/fig-3</object-id>
        <label>Figure 3</label>
        <caption>
          <title>(A) Design diagram and (B) box plots of the sequence-specific average BDI reduction of the CODIACS trial, as output from the function seqmeans.</title>
        </caption>
        <graphic xlink:href="peerj-09-10559-g003"/>
      </fig>
      <p>In some cases, the investigator is particularly interested in comparing a pair of strategies. By specifying global=FALSE, <bold><italic>smartsize</italic></bold> can power a SMART based on a pairwise test, as shown in Part 3 of the example code. When powered by a pairwise test, the function inputs the standardized effect size of the pairwise test and returns the numbers of patients included in each ATS of the comparison, assuming equal sample sizes for the two strategies. For example, the results in Part 3 show that, if we would like to achieve 80% power in detecting a standardized difference between the two strategies of 0.90, we need to recruit 20 patients for each ATS in the planned SMART. This method is similar to powering a classic two-arm RCT based on t-tests. While the user needs to recalculate the total sample size based on the design structure. For more technical details on this method, see <xref rid="ref-14" ref-type="bibr">Murphy (2005)</xref>.</p>
      <table-wrap id="utable-1" orientation="portrait" position="anchor">
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1"/>
          </colgroup>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-graphic xlink:href="peerj-09-10559-i024.jpg" mimetype="image" mime-subtype="png" content-type="symbol"/>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>Noncentrality parameter of chi-squared test statistic</title>
      <p>An important element of inference related to global tests in SMART is the noncentrality parameter <italic>λ</italic><sup>∗</sup> of chi-squared test statistics. The function <bold><italic>getncp</italic></bold> helps obtain this value. In calling this function, the user needs to input the degrees of freedom, given the design structure of SMART, type I and II errors. Since no formula can calculate the value of <italic>λ</italic><sup>∗</sup> directly, this function starts searching for the value by calculating the left-hand side of <xref ref-type="disp-formula" rid="eqn-7">Eq. (7)</xref>, based on a prespecified value, and then approaches the targeted value until a stopping criterion is reached. In this case, the stopping criterion is the maximal absolute difference between the left- and right-hand sides in <xref ref-type="disp-formula" rid="eqn-9">Eq. (9)</xref>. In practice, the user can set the initial value of <italic>λ</italic><sup>∗</sup> by the numeric argument <italic>start</italic> and define the maximum absolute difference by <italic>d</italic>. Example 3 of the R code and the results shows the result of calling the function <bold><italic>getncp</italic></bold> in the CODIACS trial. Given the design structure, we calculate the degrees of freedom and input it by <italic>df</italic> = 5<italic/>. We set the targeted type I and II errors as <italic>alpha=0.05</italic> and <italic>beta=0.20</italic>, respectively. We then give an initial value of <italic>λ</italic><sup>∗</sup> with <italic>start=5</italic> and the maximal acceptable difference <italic>d=0.0001</italic>. Therefore, the computer starts the search process at <italic>λ</italic><sup>∗</sup> = 5 and finally returns the value of the noncentrality parameter as 12.8249. Note that, when the <bold><italic>getncp</italic></bold> function is used, the start value of <italic>λ</italic><sup>∗</sup>does not affect the results of the search, although a start value closer to the result leads to a shorter search process. On the other hand, the value of d affects the accuracy of the search. Generally, a smaller maximal acceptable difference leads to better accuracy.</p>
      <p><bold>List 3.</bold> R code and results: Example 3</p>
      <p>&gt;  getncp(<italic>df</italic> = 5,alpha=0.05,beta=0.20, <italic>d</italic> = 0.0001,start=5)</p>
      <p>[1] 12.8249</p>
    </sec>
    <sec>
      <title>Descriptive statistics</title>
      <p>Once the SMART data are collected, it is natural to summarize the features of the data by treatment sequence. The <bold><italic>seqmeans</italic></bold> function can provide these results. By specifying the argument <italic>family</italic>, it adjusts the calculation for continuous (family=“gaussian”) and binary (family =“binomial”) primary outcomes. The argument <italic>digits</italic> controls the number of rounding decimal places for the final outputs. By default, this function returns calculation results without rounding. The argument <italic>plot</italic> allows the output graphs to be selected, including the design diagram (plot= “d”) and outcome summary graphics (plot=“s”), which are box plots for a continuous outcome and bar charts for a binary outcome. Example 4 of the R code and results shows the R program for calling the function <bold><italic>seqmeans</italic></bold> using the CODIACS data and the outputs. When calling this function, we input a data object named <italic>codiacs</italic> and specify the type of outcome (i.e., BDI reduction) to be continuous by setting family=“gaussian”. Meanwhile, we choose to output the design diagram with plot=“d”. The Appendix provides a detailed summary of all the arguments. In the output data frame, the SEQ column gives the indicators of all the treatment sequences embedded in this dataset. Each sequence is defined by the values <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i025.jpg"/><tex-math id="M37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$ \left( \mathrm{A}1,\mathrm{O}2,\mathrm{A}2 \right) $\end{document}</tex-math><mml:math id="mml-ieqn-114"><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">O</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula> in the next three columns. The columns N, MEAN, VAR, and SD present the number of patients, the average value, variance, and standard deviation of the primary outcome corresponding to each treatment sequence. From these outputs, we know that the codiacs data include eight two-stage treatment sequences, defined as (A1,O2,A2), where A1=(0,1), O2=(0,1), and A2=(0,1). The output also gives the number of the patients and the mean, variance, and standard deviation of the primary outcome for each sequence. For example, the first row shows that 25 patients received medication at stage-1 (i.e., coded as 0), failed to respond (i.e., O2=0), and then continued to receive medication at stage-2 (i.e., A2=0). The average reduction in the BDI reduction at six months for these patients is 1.32, with a variance of 50.48 and a standard deviation of 7.10.</p>
      <table-wrap id="utable-3" orientation="portrait" position="anchor">
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1"/>
          </colgroup>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-graphic xlink:href="peerj-09-10559-i026.jpg" mimetype="image" mime-subtype="png" content-type="symbol"/>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>For the results of specifying plot=“d”, we obtain the design diagram in <xref ref-type="fig" rid="fig-3">Fig. 3A</xref>. The <bold><italic>seqmeans</italic></bold> function also provides a series of arguments that allow for the customization of the output graphs, such as the title, label, legend, colors, and addition of a reference line. By specifying pch=c(19,15) and legend=c(“Intermediate evaluation”, “Stage-specific treatment”), the user can separate the treatment assignment points and intermediate evaluation points into different shapes (i.e., a dot for treatment and a diamond for intermediate evaluation). We also add the title of <xref ref-type="fig" rid="fig-3">Fig. 3A</xref> by setting title=“(A) Design diagram of CODIACS trial” to inform the readers. Alternatively, specifying plot=”s” yields the box plot of the primary outcome of all eight treatment sequences in <xref ref-type="fig" rid="fig-3">Fig. 3B</xref>. In this case, we specify color=“yellow” and title=“(B) Primary outcome by treatment sequence (A1,O2,A2)”. We also set the labels xlab=“Treatment sequence” and ylab= “BDI reduction”. A reference line indicating the average BDI reduction at six months across all trial participants is added to the figure with reference=TRUE. When the primary outcome is a binary variable, we can set family=“binomial” and the function replaces the box plots with bar charts.</p>
      <p>The <bold>SMARTAR</bold> package also provides strategy-level descriptive statistics using the function <bold><italic>atsmeans</italic></bold>. By specifying an argument method=“Gest” or method=“IPW”, we can choose the method of estimation to generate the results. This function also provides options to control the calculations and outputs. For example, the logical operator <italic>common</italic> allows the pooled variance (common=TRUE) or sequence-specific variances (common=FALSE) to be used in the estimation. Another logical operator, <italic>conf</italic>, returns the confidence interval for each estimated ATS value. We can control the confidence levels by specifying the value of the argument <italic>alpha</italic> and output a forest plot of ATS values by setting the option plot=TRUE. By default, alpha=0.05 and the function automatically calculates the 95% confidence intervals.</p>
      <fig id="fig-4" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.10559/fig-4</object-id>
        <label>Figure 4</label>
        <caption>
          <title>R code and output of the astmeans function.</title>
        </caption>
        <graphic xlink:href="peerj-09-10559-g004"/>
      </fig>
      <p>We show an example of R code calling the function <bold>atsmeans</bold> using the CODIACS data and the outputs in Example 5 of R code and results. We choose to calculate the estimated strategy values by the G-computation method (method=“Gest”) and output their 95% confidence intervals (conf=TRUE, alpha=0.05). We also set plot=TRUE to generate the forest plot. Therefore, the outputs start with brief explanations of the results at the top. The first output data frame gives the estimated strategy values ($value). Each row of this matrix corresponds to a specific depression management strategy. The first column of the output in List 5, ATS, is the strategy indicator. The columns d0, d00, and d01 are the stage-1 treatment and the stage-2 treatments for non-responders and responders under the strategy indicated by the ATS. The total number of patients who followed the strategy is denoted by N, and the value and se columns denote the estimated strategy value and its standard error. The lower and upper limits of the 95% confidence interval are also shown. The second output data frame is the estimated variance–covariance matrix of the strategy values. <xref ref-type="fig" rid="fig-4">Figure 4</xref> shows the estimated values of all eight depression management strategies with 95% confidence intervals. For example, from rows 2 and 3 of $value, we know that there were 30 patients in codiacs under the ATS with indicator 2, in which patients received medication at stage 1, continued to receive medication at stage 2 if responsive, or switched to PST otherwise. The average BDI reduction at six months under this ATS is estimated to be 3.33, with a standard error of 1.24. The 95% confidence interval of this estimated strategy value is (0.90, 5.76). Similarly, there were 26 patients under ATS 3, whose strategy value is estimated to be 10.69 with a standard error of 0.64. The 95% confidence interval is (9.44, 11.95). From the variance–covariance matrix output, we know that the covariance between the estimated values of ATSs 2 and 3 is 0.0065. Note that the variance–covariance matrix is a block diagonal matrix with the upper left block corresponding to the strategies {1,2,3,4} and the lower right block corresponding to strategies {5,6,7,8}. Graphically, the estimated values of two strategies that are at least partially overlapping will have non-zero covariance; otherwise, they will be independent of each other.</p>
      <table-wrap id="utable-4" orientation="portrait" position="anchor">
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1"/>
          </colgroup>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-graphic xlink:href="peerj-09-10559-i027.jpg" mimetype="image" mime-subtype="png" content-type="symbol"/>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>Statistical comparison</title>
      <p>In this section we show an example of R code and its results calling the function <bold><italic>smartest</italic></bold> using the CODIACS data. The outputs first give a brief explanation of the results at the top and then provide three parts of the results, labeled $Strategy, $Global.test, and $Pairwise.comparisons. The first part (i.e., $Strategy) lists all the strategies embedded in the SMART, their definitions, and the number of patients who followed each strategy, which gives a snapshot of the candidates for comparison. The second part (i.e., $Global.test) provides the results of a global test under the hypothesis in <xref ref-type="disp-formula" rid="eqn-4">Eq. (4)</xref>, including the total sample size, the number of ATSs, degrees of freedom, the value of test statistic, and the <italic>p</italic>-value. In this case, a global test among the eight strategies using the CODIACS trial data of 108 patients yields a test statistic <italic>Q</italic> = 36.03. Under the null hypothesis of <xref ref-type="disp-formula" rid="eqn-4">Eq. (4)</xref>, Q follows a central chi-squared distribution with degrees of freedom <italic>ν</italic> = 5. We therefore obtain a <italic>p</italic>-value less than 0.05 and thus claim there is sufficient evidence to reject the null hypothesis that all eight depression management strategies lead to the same level of BDI score reduction at six months. This test can serve as a gate-keeping test for ATS selection in the SMART. In this case, selection only occurs when there is an adequate level of statistical evidence concerning the difference among different treatment strategies, whereas, if the result fails to reject the null hypothesis in <xref ref-type="disp-formula" rid="eqn-4">Eq. (4)</xref>, a conclusion of no overall statistical difference would be made and no further analysis would be conducted.</p>
      <p>The third part (i.e., $Pairwise.comparisons) provides the results of pairwise comparisons. Each row in this part corresponds to a pair of strategies, indicated by the label in the first column. The second, third, and fourth columns are the point estimates of the difference between the two strategy values and its <inline-formula><alternatives><inline-graphic xlink:href="peerj-09-10559-i028.jpg"/><tex-math id="M38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$ \left( 1-\alpha \right) \text{%}$\end{document}</tex-math><mml:math id="mml-ieqn-119"><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfenced><mml:mtext>%</mml:mtext></mml:math></alternatives></inline-formula> confidence limits. The fifth and sixth columns show the test statistics and <italic>p</italic>-values, respectively. The user can control the outputs with a series of arguments. This function also contains the option ntest, which allows the number of pairs of comparison n<sub>p</sub> for multiplicity adjustment to be set. The user can also control the confidence level by setting the value of alpha. These options provide flexibility for analysts to answer different research questions. In this case, we set adjust=“Bon”, which returns the simultaneous confidence intervals adjusted for Bonferroni correction; otherwise, it gives the confidence intervals without multiplicity adjustment. For example, the second row shows the results of comparing strategies 1 and 3. The difference between the two estimated values is −4.43, with a 95% simultaneous confidence interval of (−7.39, −1.46). This confidence interval does not cover zero, and thus we claim an overall difference from the comparison between these two strategies. A pairwise test of this pair returns a test statistic <italic>Z</italic> =  − 4.66 and a <italic>p</italic>-value of 0.00. Although compared to the global test, pairwise tests are more conservative due to the multiplicity adjustment, they do provide the information on the value differences between any pair of strategies and are thus important in analyzing SMARTs.</p>
      <table-wrap id="utable-5" orientation="portrait" position="anchor">
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1"/>
          </colgroup>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-graphic xlink:href="peerj-09-10559-i029.jpg" mimetype="image" mime-subtype="png" content-type="symbol"/>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>Statistical research in personalized medicine has attracted increasing interest over the past 20 years. Although the concept of personalized medicine varies by the literature and research communities, the core idea involves individual-level information as the fundamentals of clinical decisions (<xref rid="ref-10" ref-type="bibr">Kosorok &amp; Moodie, 2015</xref>). An ATS provides opportunities to adjust the treatment selection sequentially, according to the clinical history and individual responses of each patient to previous treatment, thus fits the paradigm of personalized medicine. Although more and more statistical researchers are contributing to this field, there is still a gap between theoretical statistical research and clinical trial practice. A key problem is that there is no user-friendly statistical package available for those non-statistical methodology researchers to implement these methods in practice. Therefore, we developed the <bold>SMARTAR</bold> package. This package was designed specifically for clinical investigators and data analysts to conduct statistical work in the pipeline of a clinical trial with a SMART design.</p>
    <p>Traditionally, researchers calculate the sample size of a SMART using a pairwise comparison approach, due to the relatively simple calculation (<xref rid="ref-14" ref-type="bibr">Murphy, 2005</xref>; <xref rid="ref-5" ref-type="bibr">Dawson &amp; Lavori, 2010</xref>). An investigator therefore needs to first select a pair of ATSs and then calculate the standardized difference between them in an ad hoc manner. Statisticians thus need to first derive the formulas of two strategy values and the variance of the value difference, calculate the sample size required for the two targeted strategies, and then obtain the total number of patients needed to enroll in the trial. This method reamins rather conservative when the design structure of a SMART becomes more complex, because the multiplicity adjustment will reduce the targeted type I error. Alternatively, researchers proposed powering a SMART based on an omnibus test (<xref rid="ref-17" ref-type="bibr">Ogbagaber, Karp &amp; Wahed, 2016</xref>). <xref rid="ref-22" ref-type="bibr">Zhong et al. (2019)</xref> derived the sample size calculation based on an omnibus test under a general SMART design. This method can be applied to SMARTs with various design structures, and simulations show that the gate-keeping approach based on this method has advantageous properties (i.e., strict control of type I error and high accuracy of the selection of the true best ATS) in selecting the best ATS. The primary functions of SMARTAR support all these methods.</p>
    <p>Because of the increasing interest in this field, newly developed statistical methods are published in this field every year. <xref rid="ref-3" ref-type="bibr">Cheung, Chakraborty &amp; Davidson (2015)</xref> analyze CODIACS data with the goal of selecting the best two-stage ATSs using an iterative regression-based Q-learning method. The optimal depression management strategy therefore would start with PST and switch to medication, regardless of the intermediate outcome, which is consistent with our finding using the gate-keeping approach by implementing the <bold><italic>smartest</italic></bold> function. In practice, the gate-keeping approach is preferred because it provides a <italic>p</italic>-value that helps directly control false positive findings. Due to the limited resources and time, we focus on those methods commonly used in trial practice, but not those in observational studies, such as Q-learning (<xref rid="ref-15" ref-type="bibr">Murphy, 2006</xref>) or A-learning (<xref rid="ref-21" ref-type="bibr">Zhao et al., 2015</xref>). Considering the targeted users of this R package, we believed it is the optimal solution in software development.</p>
    <p>Future updates of this package will keep focusing on clinical trial design and analysis purposes. We plan to update it by adding newly developed statistical methods for trial practice every two years. The updated version will be posted and available from CRAN and GitHub.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p><bold>SMARTAR</bold> is a comprehensive statistical software package for designing and analyzing clinical trials with a SMART design. We introduce the functions of this R package and illustrate how to apply these functions using examples with real data. This package will help clinical investigators and statisticians in practice.</p>
    <sec>
      <title>Computational details</title>
      <p>The results in this paper were obtained using R 3.6.1 with the SMARTAR 1.1.0 package. R itself and all packages used are available from the Comprehensive R Archive Network (CRAN) at <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org">https://CRAN.R-project.org</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="supplemental-information">
    <title> Supplemental Information</title>
    <supplementary-material content-type="local-data" id="supp-1">
      <object-id pub-id-type="doi">10.7717/peerj.10559/supp-1</object-id>
      <label>Supplemental Information 1</label>
      <caption>
        <title>R source package</title>
      </caption>
      <media xlink:href="peerj-09-10559-s001.gz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-2">
      <object-id pub-id-type="doi">10.7717/peerj.10559/supp-2</object-id>
      <label>Supplemental Information 2</label>
      <caption>
        <title>Example R code used to replicate all the examples</title>
      </caption>
      <media xlink:href="peerj-09-10559-s002.r">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We would like to thank Ms. Alica Brewer for providing editial help in this article. Drs. Pranav Pandit, Zhian Kamvar, and William Love helped review the R package.</p>
  </ack>
  <app-group id="app-group-1">
    <app id="app1">
      <title>Appendix 1: Summary Document for Arguments</title>
      <p>This appendix provides the detailed explanations and the options of each argument for the five key functions of the <bold>SMARTAR</bold> package, namely, <bold><italic>smartsize</italic></bold>, <bold><italic>getncp, seqmeans, atsmeans,</italic></bold> and <bold><italic>smartest</italic></bold>.</p>
      <sec>
        <title>Function 1: smartsize</title>
        <p>This function provides the result of sample size calculation for a sequential multiple assignment randomized trial (SMART). The explanations and the options of the arguments included in this function are as follows.</p>
        <list list-type="simple" id="list-1">
          <list-item>
            <label> •</label>
            <p><bold>alpha</bold>: numeric. Specify the targeted type I error of a sample size calculation. The default is alpha=0.05.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>beta</bold>: numeric. Specify the targeted type II error of a sample size calculation. The default is beta=0.20, which leads to a targeted statistical power of 0.80.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>global</bold>: logic. Specify the test of a sample size calculation. If global=TRUE, the sample size calculation will be based on the global test; if global=FALSE, the sample size calculation will be based on a pairwise test. The default is global=TRUE.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>family</bold>: specify the type of primary outcome to be analyzed. This argument includes two options, “gaussian” for a continuous primary outcome and “binomial” for a binary outcome. The default is family=“gaussian”.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>df:</bold> integer to specify the degrees of freedom for the chi-squared test statistics of the global test.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>delta</bold>: a positive real number to specify the effect size for sample size calculation. The user can choose to input the effect size of the global test, as defined by <xref rid="ref-22" ref-type="bibr">Zhong et al. (2019)</xref>, in this argument, given global=TRUE, or input the standardized difference of the two strategy values, given global=FALSE.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>sim</bold>: sequence information matrix for calculating the effect size of the global test. If users choose to power the trial by the global test, they can just input the sequence information matrix directly, instead of calculating the effect size themselves. This matrix includes all the sequence-specific information. Specifically, the matrix includes N rows, where N is the total number of sequences embedded in the SMART. Each row contains information for the sequence indicator (SEQ), tailoring variables (Ot), treatment variables (At), intermediate response rate (PT), randomization probability (PIt), sequence-specific mean (MEAN), and standard deviation (SD) of the primary outcome.</p>
          </list-item>
        </list>
      </sec>
      <sec>
        <title>Function 2: getncp</title>
        <p>This function returns the value of the noncentrality parameter of the chi-squared distribution for the test statistics of the global test under the alternative hypothesis. The theoretical value of the noncentrality parameter is a function of type I error, type II error, and degrees of freedom. The explanations and the options of the arguments included in this function are as follows.</p>
        <list list-type="simple" id="list-2">
          <list-item>
            <label> •</label>
            <p><bold>df</bold>: integer to specify the degrees of freedom for the chi-squared test statistics of the global test.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>alpha</bold>: numeric. Specify the targeted type I error of the sample size calculation. The default is alpha=0.05.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>beta</bold>: numeric. Specify the targeted type II error of the sample size calculation. The default is beta=0.20, which leads to a targeted power of 0.80.</p>
          </list-item>
        </list>
        <p>• <bold>d</bold>: critical value of the distance of the search procedure. The search for the non-centrality parameter value stops at the absolute distance between the actual power and the target power less than the value of d. The default value of <italic>d</italic> = 0.0001.</p>
      </sec>
      <sec>
        <title>Function 3: seqmeans</title>
        <p>This function outputs all the treatment sequences embedded in a SMART dataset, summarizes all the sequence-specific descriptive statistics and graphs, and provides a design diagram of the SMART. Each treatment sequence is indicated by the values of the stage-specific tailoring variables and the treatment variables corresponding to a patient who follows this sequence. The explanations and the options of the arguments included in this function are as follows.</p>
        <list list-type="simple" id="list-3">
          <list-item>
            <label> •</label>
            <p><bold>data</bold>: input data frame of the sequential multiple assignment randomized trial (SMART) data to be analyzed.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>family</bold>: type of primary outcome to be analyzed. This argument includes two options, “gaussian” for a continuous primary outcome and “binomial” for a binary outcome. The default is family=“gaussian”.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>plot:</bold> type of output figure. Here, set plot=d for design diagram of the SMART and plot=s for the figure to summarize the descriptive statistics by the treatment sequence. Specifically, plot=s will output box plots when the primary outcome is continuous (i.e., family=“gaussian”) and bar plots when the output is binary (family=“binomial”). The default is plot=d.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>digits</bold>: integer indicating the number of decimal places for the descriptive statistics in the output, including the sequence-specific mean, variance, and standard deviation. By default, digits=NULL and the function returns descriptive statistics without rounding.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>color</bold>: characters indicating the color of the boxplots and barplots. The second default is c(“yellow”,“forestgreen”). For a continuous outcome (i.e., family=“gaussian”), this option allows the color of the boxplots to be selected, and the default is color=“yellow”. For a binary outcome (i.e., family=“binomial”), this option controls the colors of the bar plots, with one for the outcome of “yes” and one for “no”. In this case, the user needs to input two characteristics. By default, color=c(“yellow”, “forestgreen”).</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>pch</bold>: two integers indicating the point shape of the tailoring variables and the treatment variables in the design diagram. It allows the points indicating baseline/intermediate evaluations and treatment assignments in the design diagram to be separated. The first integer specifies the shape of the treatment assignment points; the second integer specifies the shape of the evaluation points. The default values are pch=c(19,15), indicating a square for evaluations and dots for treatment assignments.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>title</bold>: characters to specify the title of the output figure.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>ylab</bold>: characters to specify the label of the vertical axis of the output figure.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>xlab</bold>: characters to specify the label of the horizontal axis of the output figure.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>legend</bold>: characters to specify the legend of the design diagram of the SMART. The default is legend=c(“Evaluation”,“Treatment”).</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>reference</bold>: logic argument to add a reference line to the graph of descriptive statistics of the primary outcome. The value of the reference line is equal to the average of all sequence-specific means. If TRUE, add a reference line (mean of outcome) to the box plot of the primary outcome; otherwise, do not add a reference line. The default is reference=FALSE.</p>
          </list-item>
        </list>
      </sec>
      <sec>
        <title>Function 4: atsmeans</title>
        <p>This function outputs all the ATSs embedded in a SMART dataset, with the estimated strategy values and their estimated asymptotic variance–covariance matrix. The explanations and the options of the arguments included in this function are as follows.</p>
        <list list-type="simple" id="list-4">
          <list-item>
            <label> •</label>
            <p><bold>data</bold>: input data frame of the SMART data to be analyzed.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>family</bold>: type of primary outcome to be analyzed. This argument includes two options, “gaussian” for a continuous primary outcome and “binomial” for a binary outcome. The default is family=“gaussian”.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>method</bold>: specify the method to calculate the estimated strategy values. The users can select one of two common methods, with “Gest” for the G-computation method and “IPW” for the Inversed Probability Weighting method. By default, method=“Gest”.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>digits</bold>: integer indicating the number of decimal places for descriptive statistics in the output, including the sequence-specific mean, variance, and standard deviation in the outputs. By default, digits=NULL and the function returns descriptive statistics without rounding.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>common</bold>: logic. This argument indicates whether the variance–covariance matrix of strategy values will be calculated based on the pooled variance across all the treatment sequences or not, with TRUE for pooled variance and FALSE for sequence-specific variances. The default is common=TRUE.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>conf</bold>: logic, whether the confidence intervals of the estimated strategy values are output or not. If conf=TRUE, the estimated strategy values with confidence intervals will be output. The default is conf=TRUE.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>alpha</bold>: numeric. Specify the confidence level of the estimated strategy values at (1 - <italic>α</italic>)%, given conf=TRUE. The default alpha = 0.05.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>plot</bold>: logic. If plot=TRUE, the function will output the boxplots of all the estimated strategy values with (1 - <italic>α</italic>)% confidence intervals. The default is plot=TRUE.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>title</bold>: characters to specify the title of the output graphs. The default is “Strategy values with confidence intervals”.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>color</bold>: characters indicating the color of the graph. The default is color=“forestgreen”.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>ylab</bold>: characters to specify the label of the vertical axis of the output figure. The default is “Strategy value”.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>xlab</bold>: characters to specify the label of the horizontal axis of the output figure.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>xtext</bold>: characters to specify the text of the horizontal axis of the figure.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>pch</bold>: integer to specify the shape of the points in the graphs. The default is pch=15.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>cex</bold>: integer to specify the amount by which plotting symbols should be magnified. The default is cex=2.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>lwd</bold>: integer indicating the line width. The lines refer to the width of the confidence interval. The default is lwd=1.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>ylim</bold>: integers to specify the maximum and minimum values of the <italic>y</italic>-axis.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>mar</bold>: numerical vector of the form c(bottom, left, top, right), which gives the number of lines for the margin to be specified on the four sides of the plot.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>cex.axis</bold>: magnification to be used for axis annotation relative to the current setting of cex.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>line:</bold> specification of a value for a line that overrides the default placement of the label of the horizontal axis of the graphs.</p>
          </list-item>
        </list>
      </sec>
      <sec>
        <title>Function 5: smartest</title>
        <p>This function provides the results of statistical tests comparing ATSs based on both global and pairwise tests. The explanations and the options of the arguments included in this function are as follows.</p>
        <list list-type="simple" id="list-5">
          <list-item>
            <label> •</label>
            <p><bold>data</bold>: input data frame of the sequential multiple assignment randomized trial (SMART) data to be analyzed.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>family</bold>: type of primary outcome to be analyzed. This argument includes two options, “gaussian” for a continuous primary outcome and “binomial” for a binary outcome. The default is family=“gaussian”.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>method</bold>: method to calculate the estimated strategy values. The users can select one of two common methods: “Gest” for the G-computation method and “IPW” for the Inverse Probability Weighting method. By default, method=“Gest”.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>digits</bold>: integer indicating the number of decimal places for the descriptive statistics in the output, including the sequence-specific mean, variance, and standard deviation. By default, digits=NULL and the function returns descriptive statistics without rounding.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>common</bold>: logic. This argument indicates whether the variance–covariance matrix of strategy values will be calculated based on the pooled variance across all the treatment sequences or not, with TRUE for pooled variance and FALSE for sequence-specific variances. The default is common=TRUE.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>alpha</bold>: numeric. Specifies the confidence level of the difference between each pair of estimated strategy values at (1 - <italic>α</italic>)%. The default alpha=0.05.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>adjust</bold>: argument allows calculation of the confidence intervals of the strategy value difference corrected for the multiplicity adjustment. By specifying adjust = “Bon”, the confidence interval is adjusted for Bonferroni correction. The default is adjust = NULL, which means that the estimated strategy value differences are not adjusted for multiplicity comparisons.</p>
          </list-item>
          <list-item>
            <label> •</label>
            <p><bold>ntest</bold>: integer to specify the number of pairwise comparisons adjusted for Bonferroni correction, given adjust = “Bon”.</p>
          </list-item>
        </list>
      </sec>
    </app>
    <app id="app2">
      <title>Appendix 2: Simulation Study</title>
      <p>Having introduced the background, contents, and usage of the <bold>SMARTAR</bold> package in the manuscript, we compared the results generated by the functions belonging to this R package using simulation. The simulated results were compared with the corresponding theoretical results and the simulation results reported by <xref rid="ref-22" ref-type="bibr">Zhong et al. (2019)</xref> that were not based on the SMARTAR package.</p>
      <sec>
        <title>SMART designs</title>
        <p><xref ref-type="fig" rid="fig-5">Figures 5A</xref> and <xref ref-type="fig" rid="fig-5">5B</xref> give two design structures of two-stage SMARTs considered in the simulation. <xref ref-type="fig" rid="fig-5">Figure 5A</xref> is design structure 1 (DS1), under which patients were first randomized to two treatment options at stage 1. At the end of stage 1, patients were classified as responders or non-responders. Patients were then randomly assigned to two treatment options in stage 2, according to different histories of stage-1 treatments and intermediate outcomes. As results, there are 8 ATSs embedded in DS1. <xref ref-type="fig" rid="fig-5">Figure 5B</xref> shows the DS2. There were two treatment options in stage 1 and a binary intermediate response. However, responders continued receiving the treatment in stage 1, and only non-responders were randomized into two treatment options at stage 2. DS2 led to 4 ATSs. We considered balanced randomization (BR), under which the randomization probability for each treatment option was set to be 0.50, whenever there is an option of randomization. We fixed the sample size for each simulated data at <italic>N</italic> = 200, and the simulation was conducted based on 5,000 replicates.</p>
        <fig id="fig-5" orientation="portrait" position="anchor">
          <object-id pub-id-type="doi">10.7717/peerj.10559/fig-5</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Design structures considered in the simulation.</title>
          </caption>
          <graphic xlink:href="peerj-09-10559-g005"/>
        </fig>
      </sec>
      <sec>
        <title>Outcome scenarios</title>
        <p>We set the intermediate response rate for each simulated SMART data to be 1/3 for both A<sub>1</sub> = 0 and A<sub>1</sub> = 0. Given a subject’s treatment history and intermediate outcome (A<sub>1</sub>, O<sub>2</sub>, A<sub>2</sub>), the sequence-specific primary outcome was randomly generated based on a normal distribution with mean <italic>ϕ</italic>(A<sub>1</sub>, O<sub>2</sub>, A<sub>2</sub>) and variance <italic>σ</italic><sup>2</sup> = 100, where <italic>ϕ</italic>(A<sub>1</sub>, O<sub>2</sub>, A<sub>2</sub>) was specified by <disp-formula id="NONUM-d2e4733"><alternatives><graphic xlink:href="peerj-09-10559-e015.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}\phi \left( {\mathrm{A}}_{1},{\mathrm{O}}_{2},{\mathrm{A}}_{2} \right) ={\beta }_{0}+{\beta }_{1}{\mathrm{A}}_{1}+{\beta }_{2}{\mathrm{O}}_{2}+{\beta }_{3}{\mathrm{A}}_{2}+{\beta }_{4}{\mathrm{A}}_{1}{\mathrm{O}}_{2}+{\beta }_{5}{\mathrm{A}}_{1}{\mathrm{A}}_{2}+{\beta }_{6}{\mathrm{O}}_{2}{\mathrm{A}}_{2}+{\beta }_{7}{\mathrm{A}}_{1}{\mathrm{O}}_{2}{\mathrm{A}}_{2} \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-NONUM-d2e4733"><mml:mstyle displaystyle="true"><mml:mi>ϕ</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
        <p>For A<sub>1</sub>, O<sub>2</sub>, A<sub>2</sub> ∈ {0, 1}. The parameter <disp-formula id="NONUM-d2e4965"><alternatives><graphic xlink:href="peerj-09-10559-e016.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}{ \left\{ {\beta }_{0},{\beta }_{1},{\beta }_{2},{\beta }_{3},{\beta }_{4},{\beta }_{5},{\beta }_{6},{\beta }_{7} \right\} }^{\mathrm{T}} \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-NONUM-d2e4965"><mml:mstyle displaystyle="true"><mml:msup><mml:mrow><mml:mfenced separators="" open="{" close="}"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
        <fig id="fig-6" orientation="portrait" position="anchor">
          <object-id pub-id-type="doi">10.7717/peerj.10559/fig-6</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Value patterns of adaptive treatment strategies in the simulation.</title>
          </caption>
          <graphic xlink:href="peerj-09-10559-g006"/>
        </fig>
        <p>was chosen so that the true values <italic>θ</italic>′<italic>s</italic> would follow the patterns displayed in <xref ref-type="fig" rid="fig-6">Fig. 6</xref>. Under Value Pattern 1 (VP1), strategies with the same stage-1 treatment had the same values. Under VP2, the strategy values were uniformly higher if the stage-1 treatment was A<sub>1</sub> = 1. Under VP3, the best strategy had stage-1 treatment A<sub>1</sub> = 1 while the second best had stage-1 treatment A<sub>2</sub> = 0, and so on and so forth, following an alternating pattern. The value of <italic>β</italic>′s were chosen so that the effect size of the global test was Δ = 0.05 and 0.10. For example, under VP1, setting <italic>β</italic><sub>0</sub> = <italic>β</italic><sub>1</sub> = … = <italic>β</italic><sub>7</sub> = 0 and <italic>β</italic><sub>1</sub> = 4.48 yielded the effect size Δ = 0.05. Details values of <italic>β</italic>′<italic>s</italic> for each value pattern are given in <xref rid="table-3" ref-type="table">Table 3</xref>. In summary, two design structures (i.e., DS1, DS2), 3 value patterns (i.e., VP1, VP2, and VP3), and two effect sizes (i.e., Δ = 0.05 and 0.10) yielded a total of 12 scenarios in simulation.</p>
        <table-wrap id="table-3" orientation="portrait" position="anchor">
          <object-id pub-id-type="doi">10.7717/peerj.10559/table-3</object-id>
          <label>Table 3</label>
          <caption>
            <title>Two-stage adaptive treatment strategies defined in an alcohol addiction trial.</title>
          </caption>
          <alternatives>
            <graphic xlink:href="peerj-09-10559-g010"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th rowspan="1" colspan="1">Design structure</th>
                  <th rowspan="1" colspan="1">Value pattern</th>
                  <th rowspan="1" colspan="1">Δ = 0.05</th>
                  <th rowspan="1" colspan="1">Δ = 0.10</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1">DS1</td>
                  <td rowspan="1" colspan="1">VP1</td>
                  <td rowspan="1" colspan="1">(0,4.48,0,0,0,0,0,0)</td>
                  <td rowspan="1" colspan="1">(0,6.33,0,0,0,0,0,0)</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">DS1</td>
                  <td rowspan="1" colspan="1">VP2</td>
                  <td rowspan="1" colspan="1">(0,3.63,0,2.62,0,0,0,0)</td>
                  <td rowspan="1" colspan="1">(0,5.13,0,3.70,0,0,0,0)</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">DS1</td>
                  <td rowspan="1" colspan="1">VP3</td>
                  <td rowspan="1" colspan="1">(0,1.86,0,3.73,−9.32,1.86,−0.93,0)</td>
                  <td rowspan="1" colspan="1">(0,2.64,0,5.82,−13.20,2.64,−1.32,0)</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">DS2</td>
                  <td rowspan="1" colspan="1">VP1</td>
                  <td rowspan="1" colspan="1">(0,4.48,0,0,0,0,0,0)</td>
                  <td rowspan="1" colspan="1">(0,6.33,0,0,0,0,0,0)</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">DS2</td>
                  <td rowspan="1" colspan="1">VP2</td>
                  <td rowspan="1" colspan="1">(0,0,0,2.88,12,0,0,0)</td>
                  <td rowspan="1" colspan="1">(0,0,0,4.13,17.70,0,0,0)</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">DS2</td>
                  <td rowspan="1" colspan="1">VP3</td>
                  <td rowspan="1" colspan="1">(0,−1.21,0,4.82,4.82,1.21,0,0)</td>
                  <td rowspan="1" colspan="1">(0,−1.72,0,6.87,6.87,1.72,0,0)</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="table-3fn">
              <p>
                <bold>Notes.</bold>
              </p>
            </fn>
            <fn id="table-3fn1">
              <label>*</label>
              <p>Details of design structures (DS) and value patterns (VP) are given in <xref ref-type="app" rid="app2">Appendix 2</xref>.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec>
        <title>Results</title>
        <sec>
          <title>Strategy value</title>
          <p>We observed the estimated ATS values from the atsmeans function’s outputs when the sample size of simulated SMART was fixed at <italic>N</italic> = 200. <xref ref-type="fig" rid="fig-7">Figure 7</xref> shows the true value and the first 200 estimated values of each ATS in the 5000-replicate simulation under VP2 of DS2, when the global test’s effect size was Δ = 0.05 and 0.10. The bold solid line represents the true strategy values, which were (0.00, 1.92, 4.00, 5.92) for Δ = 0.10 and (0.00, 2.77, 5.90, 8.67) for Δ = 0.10. We can see that the estimated strategy values, calculated by the <bold>atsmeans</bold> function, always fluctuated around the corresponding true values, which indicated that the estimated strategy values outputted from the <bold>atsmeans</bold> function are unbiased estimates. The simulation results under other DSs and VPs led to the same conclusion. For details of other simulations, see GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/tonizhong/SMARTAR/tree/master/Simulation">https://github.com/tonizhong/SMARTAR/tree/master/Simulation</ext-link>)</p>
          <fig id="fig-7" orientation="portrait" position="anchor">
            <object-id pub-id-type="doi">10.7717/peerj.10559/fig-7</object-id>
            <label>Figure 7</label>
            <caption>
              <title>True and the first 200 estimated adaptive treatment strategy values in the simulation.</title>
            </caption>
            <graphic xlink:href="peerj-09-10559-g007"/>
          </fig>
          <table-wrap id="table-4" orientation="portrait" position="anchor">
            <object-id pub-id-type="doi">10.7717/peerj.10559/table-4</object-id>
            <label>Table 4</label>
            <caption>
              <title>Empirical statistical powers calculated based on the <bold>SMARTAR</bold> package in simulation and reported by <xref rid="ref-22" ref-type="bibr">Zhong et al. (2019)</xref>.</title>
            </caption>
            <alternatives>
              <graphic xlink:href="peerj-09-10559-g011"/>
              <table frame="hsides" rules="groups">
                <colgroup span="1">
                  <col span="1"/>
                  <col span="1"/>
                  <col span="1"/>
                  <col span="1"/>
                  <col span="1"/>
                  <col span="1"/>
                  <col span="1"/>
                  <col span="1"/>
                </colgroup>
                <thead>
                  <tr>
                    <th rowspan="1" colspan="1">Results obtained from</th>
                    <th rowspan="1" colspan="1">Design structure</th>
                    <th align="center" colspan="3" rowspan="1">Effect size Δ = 0.05</th>
                    <th align="center" colspan="3" rowspan="1">Effect size Δ = 0.10</th>
                  </tr>
                  <tr>
                    <th rowspan="1" colspan="1"/>
                    <th rowspan="1" colspan="1"/>
                    <th rowspan="1" colspan="1">VP1</th>
                    <th rowspan="1" colspan="1">VP2</th>
                    <th rowspan="1" colspan="1">VP3</th>
                    <th rowspan="1" colspan="1">VP1</th>
                    <th rowspan="1" colspan="1">VP2</th>
                    <th rowspan="1" colspan="1">VP3</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td rowspan="1" colspan="1">SMART package</td>
                    <td rowspan="1" colspan="1">DS1</td>
                    <td rowspan="1" colspan="1">0.6620</td>
                    <td rowspan="1" colspan="1">0.6674</td>
                    <td rowspan="1" colspan="1">0.6602</td>
                    <td rowspan="1" colspan="1">0.9444</td>
                    <td rowspan="1" colspan="1">0.9470</td>
                    <td rowspan="1" colspan="1">0.9474</td>
                  </tr>
                  <tr>
                    <td rowspan="1" colspan="1">
                      <xref rid="ref-22" ref-type="bibr">Zhong et al. (2019)</xref>
                    </td>
                    <td rowspan="1" colspan="1">DS1</td>
                    <td rowspan="1" colspan="1">0.6700</td>
                    <td rowspan="1" colspan="1">0.6701</td>
                    <td rowspan="1" colspan="1">0.6720</td>
                    <td rowspan="1" colspan="1">0.9510</td>
                    <td rowspan="1" colspan="1">0.9330</td>
                    <td rowspan="1" colspan="1">0.9450</td>
                  </tr>
                  <tr>
                    <td rowspan="1" colspan="1">SMART package</td>
                    <td rowspan="1" colspan="1">DS2</td>
                    <td rowspan="1" colspan="1">0.7550</td>
                    <td rowspan="1" colspan="1">0.7526</td>
                    <td rowspan="1" colspan="1">0.7698</td>
                    <td rowspan="1" colspan="1">0.9734</td>
                    <td rowspan="1" colspan="1">0.9762</td>
                    <td rowspan="1" colspan="1">0.9758</td>
                  </tr>
                  <tr>
                    <td rowspan="1" colspan="1">
                      <xref rid="ref-22" ref-type="bibr">Zhong et al. (2019)</xref>
                    </td>
                    <td rowspan="1" colspan="1">DS2</td>
                    <td rowspan="1" colspan="1">0.7610</td>
                    <td rowspan="1" colspan="1">0.7570</td>
                    <td rowspan="1" colspan="1">0.7570</td>
                    <td rowspan="1" colspan="1">0.9770</td>
                    <td rowspan="1" colspan="1">0.9740</td>
                    <td rowspan="1" colspan="1">0.9760</td>
                  </tr>
                </tbody>
              </table>
            </alternatives>
          </table-wrap>
        </sec>
        <sec>
          <title>Actual type I error</title>
          <p>We studied the actual type I error rates of the global test in simulation, defined as the proportion of rejecting the null hypothesis of <xref ref-type="disp-formula" rid="eqn-4">Eq. (4)</xref> across 5,000 simulation replicates when the effect size Δ = 0, under both DS1 and DS2, using our R package’s <bold>smartest</bold> function. The significance level was set to be 0.05. The outcome scenario was generated by setting <italic>β</italic> = (0, 0, 0, 0, 0, 0, 0, 0)<sup>T</sup>, which led to the same value of 0 for all the ATSs. The simulations achieved type I error rates of 0.0478 and 0.0502 across 5,000 replicates under DS1 and DS2, respectively, close to the significance level of 0.05. These results were similar to those (i.e., 0.0480 for DS1 and 0.0500 for DS2) based on the simulations not relied on the <bold>SMARTAR</bold> package in <xref rid="ref-22" ref-type="bibr">Zhong et al. (2019)</xref>.</p>
          <sec>
            <title>Statistical power</title>
            <p>We also verify the empirical statistical power of the global test, defined as the proportion of rejecting the null hypothesis of <xref ref-type="disp-formula" rid="eqn-4">Eq. (4)</xref> across 5,000 simulation replicates when the effect size of a simulated data was Δ &gt; 0, based on the <bold>smartest</bold> function. The first two rows of <xref rid="table-4" ref-type="table">Table 4</xref> provide the empirical powers obtained based on the <bold>smartest</bold> function in our simulations, and those not relied on this package in <xref rid="ref-22" ref-type="bibr">Zhong et al. (2019)</xref>. We can see that the power calculated by the <bold>SMARTAR</bold> package was consistently close to the corresponding power reported in the previous study. Similar results were found across the 3 VPs (VP1, VP2, and VP3) and two effect sizes (0.05 and 0.10) when the design structure was DS2.</p>
          </sec>
        </sec>
      </sec>
    </app>
  </app-group>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn id="conflict-1" fn-type="COI-statement">
        <p>The authors declare there are no competing interests.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn id="contribution-1" fn-type="con">
        <p><xref ref-type="contrib" rid="author-1">Xiaobo Zhong</xref> conceived and designed the experiments, performed the experiments, analyzed the data, prepared figures and/or tables, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
      <fn id="contribution-2" fn-type="con">
        <p><xref ref-type="contrib" rid="author-2">Bin Cheng</xref> and <xref ref-type="contrib" rid="author-4">Ying Kuen Cheung</xref> conceived and designed the experiments, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
      <fn id="contribution-3" fn-type="con">
        <p><xref ref-type="contrib" rid="author-3">Xinru Wang</xref> performed the experiments, analyzed the data, prepared figures and/or tables, and approved the final draft.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Availability</title>
      <fn id="addinfo-1">
        <p>The following information was supplied regarding data availability:</p>
        <p>Both the R package and the data used for the illustration example are available in the <xref ref-type="supplementary-material" rid="supplemental-information">Supplementary Files</xref>.</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Artman (2019)</label>
      <element-citation publication-type="report">
        <person-group person-group-type="author">
          <name>
            <surname>Artman</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <year>2019</year>
        <article-title>Power analysis for a smart design</article-title>
        <source>Comprehensive R archive network</source>
        <uri xlink:href="https://CRAN.R-project.org">https://CRAN.R-project.org</uri>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Chakraborty &amp; Murphy (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chakraborty</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2014</year>
        <article-title>Dynamic treatment regimes</article-title>
        <source>Annual Review of Statistics and its Applications</source>
        <volume>1</volume>
        <fpage>447</fpage>
        <lpage>464</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-statistics-022513-115553</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Cheung, Chakraborty &amp; Davidson (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheung</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chakraborty</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Davidson</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <year>2015</year>
        <article-title>Sequential multiple assignments randomized trial (smart) with adaptive randomization for quality improvement in depression treatment program</article-title>
        <source>Biometrics</source>
        <volume>71</volume>
        <issue>2</issue>
        <fpage>450</fpage>
        <lpage>459</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.12258</pub-id>
        <pub-id pub-id-type="pmid">25354029</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Collins, Murphy &amp; Bierman (2004)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Collins</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bierman</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <article-title>A conceptual framework for adaptive preventive interventions</article-title>
        <source>Prevention Science</source>
        <volume>5</volume>
        <fpage>185</fpage>
        <lpage>196</lpage>
        <pub-id pub-id-type="doi">10.1023/B:PREV.0000037641.26017.00</pub-id>
        <pub-id pub-id-type="pmid">15470938</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Dawson &amp; Lavori (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dawson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lavori</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Sample size calculations for evaluating treatment policies in multi-stage design</article-title>
        <source>Clinical Trials</source>
        <volume>7</volume>
        <issue>6</issue>
        <fpage>643</fpage>
        <lpage>652</lpage>
        <pub-id pub-id-type="doi">10.1177/1740774510376418</pub-id>
        <pub-id pub-id-type="pmid">20630903</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Dawson &amp; Lavori (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dawson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lavori</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year>2012</year>
        <article-title>Efficient design and inference for multistage randomized trials of individualized treatment policies</article-title>
        <source>Biostatistics</source>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>142</fpage>
        <lpage>152</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxr016</pub-id>
        <pub-id pub-id-type="pmid">21765180</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>Dunn (1961)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dunn</surname>
            <given-names>OJ</given-names>
          </name>
        </person-group>
        <year>1961</year>
        <article-title>Multiple comparisons among means</article-title>
        <source>Journal of the American Statistical Association</source>
        <volume>56</volume>
        <issue>293</issue>
        <fpage>52</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1961.10482090</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>Holloway et al. (2018)</label>
      <element-citation publication-type="report">
        <person-group person-group-type="author">
          <name>
            <surname>Holloway</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Laber</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Linn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Davidian</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tsiatis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2018</year>
        <article-title>Methods for estimating optimal dynamic treatment regimes</article-title>
        <source>Comprehensive R archive network</source>
        <uri xlink:href="https://CRAN.R-project.org">https://CRAN.R-project.org</uri>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>Ko &amp; Wahed (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ko</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Wahed</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <year>2012</year>
        <article-title>Up-front versus sequential randomizations for inference on adaptive treatment strategies</article-title>
        <source>Statistics in Medicine</source>
        <volume>31</volume>
        <issue>9</issue>
        <fpage>812</fpage>
        <lpage>830</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.4473</pub-id>
        <pub-id pub-id-type="pmid">22362642</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Kosorok &amp; Moodie (2015)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kosorok</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moodie</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <year>2015</year>
        <source>Adaptive treatment strategies in practice: planning trials and analyzing data for personalized medicine, chapter 1</source>
        <publisher-loc>Philadelphia</publisher-loc>
        <fpage>1</fpage>
        <lpage>4</lpage>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Lanceford, Davidian &amp; Tsiatis (2002)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lanceford</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davidian</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tsiatis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>Estimation of survival distributions of treatment policies in two-stage randomization designs in clinical trials</article-title>
        <source>Biometrics</source>
        <volume>58</volume>
        <fpage>48</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="doi">10.1111/j.0006-341X.2002.00048.x</pub-id>
        <pub-id pub-id-type="pmid">11890326</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Lavori &amp; Dawson (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lavori</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Improving the efficiency of estimation in randomized trials of adaptive treatment strategies</article-title>
        <source>Clinical Trials</source>
        <volume>4</volume>
        <fpage>297</fpage>
        <lpage>308</lpage>
        <pub-id pub-id-type="doi">10.1177/1740774507081327</pub-id>
        <pub-id pub-id-type="pmid">17848491</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Linn, Laber &amp; Stefanski (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Linn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Laber</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Stefanski</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <year>2015</year>
        <article-title>iQlearn: interactive Q-learning in R</article-title>
        <source>Journal of Statistical Software</source>
        <volume>64</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v064.i01</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>Murphy (2005)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murphy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>An experimental design for the development of adaptive treatment strategies</article-title>
        <source>Statistics of Medicine</source>
        <volume>24</volume>
        <issue>10</issue>
        <fpage>1455</fpage>
        <lpage>1481</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.2022</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>Murphy (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murphy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>A generalization error for Q-learning</article-title>
        <source>Journal of Machine Learning Research</source>
        <volume>6</volume>
        <fpage>1073</fpage>
        <lpage>1097</lpage>
      </element-citation>
    </ref>
    <ref id="ref-16">
      <label>Murphy et al. (2001)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murphy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Van der Laan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Robins</surname>
            <given-names>J</given-names>
          </name>
          <collab>CPPRG</collab>
        </person-group>
        <year>2001</year>
        <article-title>Marginal mean models for dynamic regimes</article-title>
        <source>Journal of American Statistical Association</source>
        <volume>96</volume>
        <issue>456</issue>
        <fpage>1410</fpage>
        <lpage>1420</lpage>
        <pub-id pub-id-type="doi">10.1198/016214501753382327</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-17">
      <label>Ogbagaber, Karp &amp; Wahed (2016)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ogbagaber</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Karp</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wahed</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2016</year>
        <article-title>Design of sequentially randomized trials for testing adaptive treatment strategies</article-title>
        <source>Statistics in Medicine</source>
        <volume>35</volume>
        <issue>6</issue>
        <fpage>840</fpage>
        <lpage>858</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.6747</pub-id>
        <pub-id pub-id-type="pmid">26412033</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-18">
      <label>R Core Team (2020)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>R Core Team</collab>
        </person-group>
        <year>2020</year>
        <data-title>R: a language and environment for statistical computing</data-title>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
        <publisher-loc>Vienna</publisher-loc>
      </element-citation>
    </ref>
    <ref id="ref-19">
      <label>Tang &amp; Melguizo (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Melguizo</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2015</year>
        <article-title>DTR: an R package for estimation and comparison of survival outcomes of dynamic treatment regimes</article-title>
        <source>Journal of Statistical Software</source>
        <volume>65</volume>
        <issue>7</issue>
        <fpage>1</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v065.i07</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-20">
      <label>Wallace, Moodie &amp; Stephens (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wallace</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moodie</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2017</year>
        <article-title>Dynamic treatment regimen estimation via regression-based techniques: introducing T package DTRreg</article-title>
        <source>Journal of Statistical Software</source>
        <volume>80</volume>
        <issue>2</issue>
        <fpage>1</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v080.i02</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-21">
      <label>Zhao et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Laber</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kosorok</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2015</year>
        <article-title>New statistical learning methods for estimating optimal dynamic treatment regimes</article-title>
        <source>Journal of the American Statistical Association</source>
        <volume>110</volume>
        <issue>510</issue>
        <fpage>583</fpage>
        <lpage>398</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.2014.937488</pub-id>
        <pub-id pub-id-type="pmid">26236062</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-22">
      <label>Zhong et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhong</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Qian</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cheung</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <year>2019</year>
        <article-title>A gate-keeping test for selecting adaptive interventions under general designs of sequential multiple assignment randomized trials</article-title>
        <source>Contemporary Clinical Trials</source>
        <volume>85</volume>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cct.2019.105830</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
