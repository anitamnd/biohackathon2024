<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Res Notes</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Res Notes</journal-id>
    <journal-title-group>
      <journal-title>BMC Research Notes</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-0500</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4584126</article-id>
    <article-id pub-id-type="publisher-id">1462</article-id>
    <article-id pub-id-type="doi">10.1186/s13104-015-1462-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PanFP: pangenome-based functional profiles for microbial communities</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Jun</surname>
          <given-names>Se-Ran</given-names>
        </name>
        <address>
          <email>junse@ornl.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Robeson</surname>
          <given-names>Michael S.</given-names>
        </name>
        <address>
          <email>robesonms@ornl.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff3"/>
        <xref ref-type="aff" rid="Aff4"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hauser</surname>
          <given-names>Loren J.</given-names>
        </name>
        <address>
          <email>hauserlj@ornl.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schadt</surname>
          <given-names>Christopher W.</given-names>
        </name>
        <address>
          <email>schadtcw@ornl.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff3"/>
        <xref ref-type="aff" rid="Aff5"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Gorin</surname>
          <given-names>Andrey A.</given-names>
        </name>
        <address>
          <email>agor@ornl.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff6"/>
      </contrib>
      <aff id="Aff1"><label/>Comparative Genomics Group, Bioscience Division, Oak Ridge National Laboratory, Oak Ridge, TN USA </aff>
      <aff id="Aff2"><label/>Joint Institute for Computational Sciences, University of Tennessee, Knoxville, TN USA </aff>
      <aff id="Aff3"><label/>Systems Genetics, Biosciences Division, Oak Ridge National Laboratory, Oak Ridge, TN USA </aff>
      <aff id="Aff4"><label/>Fish, Wildlife and Conservation Biology, Colorado State University, Fort Collins, CO USA </aff>
      <aff id="Aff5"><label/>Department of Microbiology, University of Tennessee, Knoxville, TN USA </aff>
      <aff id="Aff6"><label/>Computer Science and Mathematics Division, Oak Ridge National Laboratory, Oak Ridge, TN USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>9</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>9</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>8</volume>
    <elocation-id>479</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>4</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>9</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Jun et al. 2015</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>For decades there has been increasing interest in understanding the relationships between microbial communities and ecosystem functions. Current DNA sequencing technologies allows for the exploration of microbial communities in two principle ways: targeted rRNA gene surveys and shotgun metagenomics. For large study designs, it is often still prohibitively expensive to sequence metagenomes at both the breadth and depth necessary to statistically capture the true functional diversity of a community. Although rRNA gene surveys provide no direct evidence of function, they do provide a reasonable estimation of microbial diversity, while being a very cost-effective way to screen samples of interest for later shotgun metagenomic analyses. However, there is a great deal of 16S rRNA gene survey data currently available from diverse environments, and thus a need for tools to infer functional composition of environmental samples based on 16S rRNA gene survey data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present a computational method called pangenome-based functional profiles (PanFP), which infers functional profiles of microbial communities from 16S rRNA gene survey data for Bacteria and Archaea. PanFP is based on pangenome reconstruction of a 16S rRNA gene operational taxonomic unit (OTU) from known genes and genomes pooled from the OTU’s taxonomic lineage. From this lineage, we derive an OTU functional profile by weighting a pangenome’s functional profile with the OTUs abundance observed in a given sample. We validated our method by comparing PanFP to the functional profiles obtained from the direct shotgun metagenomic measurement of 65 diverse communities via Spearman correlation coefficients. These correlations improved with increasing sequencing depth, within the range of 0.8–0.9 for the most deeply sequenced Human Microbiome Project mock community samples. PanFP is very similar in performance to another recently released tool, PICRUSt, for almost all of survey data analysed here. But, our method is unique in that any OTU building method can be used, as opposed to being limited to closed-reference OTU picking strategies against specific reference sequence databases.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>We developed an automated computational method, which derives an inferred functional profile based on the 16S rRNA gene surveys of microbial communities. The inferred functional profile provides a cost effective way to study complex ecosystems through predicted comparative functional metagenomes and metadata analysis. All PanFP source code and additional documentation are freely available online at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/srjun/PanFP">https://github.com/srjun/PanFP</ext-link>).</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13104-015-1462-8) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Microbial communities</kwd>
      <kwd>Metagenome</kwd>
      <kwd>16S rRNA survey</kwd>
      <kwd>Pangenome</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The complexity of microbial communities has been well studied for decades, which reveals relationship between changes in microbial communities and ecosystem functions. Using DNA sequencing technologies, microbial communities can be explored by sequencing the amplified fragments of phylogenetic marker genes (for example, 16S rRNA gene data) or all detectable DNA fragments extracted from the environmental samples (called metagenomes or shotgun metagenomes) [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. The 16S rRNA gene community data, a rapid and cost-effective approach, is commonly used to assess bacterial abundance and diversity in communities because 16S RNA occurs universally and is highly conserved among all species of Bacteria and Archaea [<xref ref-type="bibr" rid="CR3">3</xref>]. Using existing technologies, these statistically robust data can be obtained for community studies over large numbers of samples, and thousands of 16S rRNA genes are obtained for each sample. However, the functional capabilities of these communities, for example the metabolic potential for nitrogen fixation, cannot be easily derived from 16S rRNA gene studies [<xref ref-type="bibr" rid="CR4">4</xref>]. Metagenomics provides a direct view of the communities’ gene content and thus their functional capability. Such studies aim to understand how microbes interact, and perform complex functions in a variety of environments through answering questions such as, what species are present and abundant, as well as what functions are present or absent based on identification of a panel of microbial organisms, genes, variants, pathways, or metabolic functions [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. Although the generation of metagenomic data has significantly increased as a result of on-going development of high-throughput sequencing technologies, obtaining enough sequencing data to describe the metagenome of a highly diverse sample, <italic>en toto</italic>, is still cost prohibitive. Cost, computational time, and statistical robustness becomes even more intractable for large-scale studies [<xref ref-type="bibr" rid="CR7">7</xref>]. However, several recent studies have indicated that the functional content of complex communities remains more constant than the phylogenetic composition of the community [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p>Given the above, there is a need for the development of methods to better bridge the gap between 16S rRNA gene and metagenomics methods. Here we present a method for inferring the potential functional compliment of a microbial community based on the phylogenetic marker gene 16S rRNA. These predictive tools are a cost effective way to expand the utility of 16S rRNA gene-based studies and allow the development of functional hypotheses for such communities using automated methods.</p>
  </sec>
  <sec id="Sec2" sec-type="materials|methods">
    <title>Method</title>
    <p>Here, we present a new computational method called pangenome-based functional profile (PanFP), which infers the functional profiles of microbial communities based on 16S rRNA gene survey data. Our method takes the measured abundance profile of detected operational taxonomic units (OTUs), and produces a functional profile of controlled vocabulary terms with the expected abundance for the studied community. The taxonomic groupings of organisms are commonly recognized as the reflection of evolutionary relationship of organisms encoded by the shared functional content [<xref ref-type="bibr" rid="CR10">10</xref>]. Our approach ultimately relies on the taxonomic lineages of OTUs. To reflect the underlying functional capabilities of microbial communities through the standard representation of genes and gene product attributes, we utilize KEGG Orthology database [<xref ref-type="bibr" rid="CR11">11</xref>] of controlled vocabulary of functional terms (called KO terms) for all predicted proteins and functional RNAs. However, our approach naturally extends to other gene annotation databases including Gene Ontology [<xref ref-type="bibr" rid="CR12">12</xref>], Pfam [<xref ref-type="bibr" rid="CR13">13</xref>], TIGRFAMs [<xref ref-type="bibr" rid="CR14">14</xref>] in a like manner. We validated PanFP in comparison with sequenced metagenomes and an existing method, PICRUSt [<xref ref-type="bibr" rid="CR4">4</xref>] using 65 different environmental and mock community samples derived as part of the Human Metagenome Project (HMP) and other projects.</p>
  </sec>
  <sec id="Sec3">
    <title>Algorithm details</title>
    <sec id="Sec4">
      <title>A flow diagram for PanFP is depicted in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1</title>
      <sec id="Sec5">
        <title>Prerequisite: prokaryote genomes with functional annotation</title>
        <p>PanFP is not limited by the specific completion of a set of reference genomes, as taxonomically related genomes are merged into a pangenome in a straightforward way. This allows for the integration of all currently available functionally annotated genomes (complete and incomplete) into our analysis pipeline. For the purposes of this study, we only considered complete genomes of prokaryotes with their full taxonomic lineages [downloaded from the National Center for Biotechnology Information (NCBI) through <ext-link ext-link-type="uri" xlink:href="ftp://ftp.ncbi.nih.gov/genomes/Bacteria">ftp://ftp.ncbi.nih.gov/genomes/Bacteria</ext-link> on Oct, 2013]. We also considered only chromosomally encoded sequences due to the dominant role of plasmids in horizontal gene transfer [<xref ref-type="bibr" rid="CR15">15</xref>]. If an organism had multiple chromosomes, a single merged genome was assigned to the organism. We mapped KO terms to proteins using the cross-reference ID mapping between NCBI Refseq and UniProt provided by UniProt KnowledgeBase (UniProtKB) database [<xref ref-type="bibr" rid="CR16">16</xref>]. The proteins can have multiple functional roles, and thus be annotated with multiple functional terms. However, about 33 % of genes in Bacterial and Archaeal complete genomes in NCBI are annotated as “hypothetical”, and many genes are annotated with very little information, which results in many proteins without assigned functional terms [<xref ref-type="bibr" rid="CR17">17</xref>]. The functional coverage is defined as the number of proteins with functional annotations divided by the total number of proteins for a complete genome. The distribution of functional coverage of organisms is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2. Currently in our approach, only prokaryote genomes with at least 30 % of functional coverage are accepted in the pipeline to avoid the underestimation of frequency of functional genes by poor annotations of genomes pooled for pangenome construction, which resulted in ~2400 organisms. With a 10 % coverage cutoff, we retained one more complete prokaryotes compared to a 30 % cutoff that we employed almost all annotated genomes of complete prokaryotes. The 16S rRNA gene survey data (also called the OTU-sample table or OTU table) can be made by clustering 16S rRNA gene sequences at a user-defined similarity threshold through a variety of OTU picking strategies that are available via tools like QIIME [<xref ref-type="bibr" rid="CR18">18</xref>]. QIIME provides three high-level protocols for OTU picking: de novo, closed-reference, and open-reference. The closed-reference OTU picking protocol only retains OTUs that have a positive hit against a set of reference sequences (e.g. Greengenes) within a provided similarity threshold. Note that PanFP is not limited to a specific OTU-picking strategy since our method is based on the pangenome construction through OTUs’ taxonomic lineages.</p>
        <sec id="Sec6">
          <title>STEP 1: trim OTU’s taxonomic lineage</title>
          <p>At this step, we performed two tasks to fully employ our database of complete prokaryotes with functional annotation and taxonomy, which were extracted from NCBI. First, when discrepancies between OTUs’ taxonomic lineages generated by the user’s OTU processing pipeline and NCBI taxonomy are observed, the OTUs’ lineages are corrected as follows: For example, an OTU belongs to a genus group recognized by NCBI taxonomy, but to a family group that is not recognized on NCBI taxonomic hierarchy probably due to the taxonomic nomenclature updates. Then we modify the OTU’s taxonomic lineage to that above the genus level according to NCBI taxonomy. Second, we trim OTUs’ taxonomic lineages from the lowest level until at least one prokaryote genome belonging to the taxon is identified. For example, assume that a given OTU has the followinglineage: kingdom:Bacteria; phylum:Firmicutes; class:Bacilli; order:Bacillales; family:Planococcaceae; genus:<italic>Kurthia</italic>. Then, we trim the OTU’s lineage by abandoning a rank at the genus level since there are no organisms of this genus in our database of prokaryotic genomes. The OTU’s newly trimmed taxonomic information contributes to the inference of functional profiles. Thus, our method is not limited to a set of specifically completed prokaryote genomes, which allows the use of all available complete or incomplete genomes. Finally, we keep OTUs whose lineages contain at least a phylum level designation. The HMP mock community used in the study was composed of 158 OTUs with lineages up to species, 412 OTUs with lineages up to genus, 67 OTUs with lineages up to family, 12 OTUs with lineages up to order, one OTU with lineage up to class, two OTUs with no taxonomic information. For this data, after modifying OTUs’ lineages in STEP 1, we ended up 68 OTUs with lineages up to species, 452 OTUs with lineages up to genus, 114 OTUs with lineages up to family, 15 OTUs with lineages up to order, one OTU with lineage up to class, indicating that information loss of the user’s chosen taxonomy against the NCBI taxonomy mostly occurred at the species level.</p>
        </sec>
        <sec id="Sec7">
          <title>STEP 2: make a lineage-function table</title>
          <p>For each OTU, PanFP builds a pangenome by making a superset of all genes present in organisms pooled from the dataset of prokaryote genomes at the given OTU’s taxonomic lineage. Therefore, the OTUs with the same taxonomic lineages have the same pangenome. Then, PanFP derives a functional profile of the pangenome by accumulating functional compositions in the superset. In such a case that horizontal gene transfer events occur only within the OTU’s taxon that genes in genomes pooled at the OTU’s taxon are transferred to other genomes pooled at the OTU’s taxon, and no genes from genomes outside the OTU’s taxon are transferred to genomes pooled at the OTU’s taxon, our method is not affected by horizontal gene transfer since genes horizontally transferred within the OTU’s taxon are still found in a pangenome for the OTU. The functions shared by more organisms in the superset have higher occurrence. We assign the pangenome’s functional profile normalized by the number of pooled organisms to the OTU’s lineage:<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$fq(lineage_{i} ,KO_{j} ) = \frac{1}{{O_{i} }}occurrence(KO_{j} \;in\;pangenome_{i} )$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mi>f</mml:mi><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.277778em"/><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.277778em"/><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="13104_2015_1462_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <italic>pangenome</italic><sub><italic>i</italic></sub> is the pangenome for the <italic>lineage</italic><sub><italic>i</italic></sub>, and <italic>O</italic><sub><italic>i</italic></sub> is the number of organisms pooled at the <italic>lineage</italic><sub><italic>i</italic></sub>. The number of organisms available for the OTUs’ taxonomic lineage, <italic>O</italic><sub><italic>i</italic></sub>, could vary dramatically across different lineages.</p>
        </sec>
        <sec id="Sec8">
          <title>STEP 3: normalize OTU’s abundance</title>
          <p>The OTU abundance reflects 16S rRNA full number of occurrences (e.g. sequence count or relative abundance) of organisms assigned to a given OTU. To implement organismal abundance, we divide the OTUs’ abundance by the putative 16S rRNA gene copy number, which is defined as the median of 16S rRNAs copy number of the organisms pooled at the OTU’s taxonomic lineage. Again, all OTU frequencies for a given sample are normalized by the sample size such that the resulting frequencies, <italic>fq</italic> (<italic>OTU</italic><sub><italic>i</italic></sub>, <italic>sample</italic><sub><italic>j</italic></sub>) could be directly comparable between different samples.</p>
        </sec>
        <sec id="Sec9">
          <title>STEP 4: convert an OTU-sample table into a lineage-sample table</title>
          <p>An OTU-sample table is converted into a lineage-sample table by summing the frequencies of OTUs with the same lineage in a sample, as follows:<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$fq(lineage_{i} ,sample_{j} ) = \sum\limits_{{OTU_{k} \;has\;lineage}} {fq(OTU_{k} ,sample_{j} )}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mi>f</mml:mi><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>O</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mspace width="0.277778em"/><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.277778em"/><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>f</mml:mi><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>O</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="13104_2015_1462_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
        </sec>
        <sec id="Sec10">
          <title>STEP 5: convert a lineage-sample table into a function-sample table</title>
          <p>We derive a function-sample table by combining functional profiles of lineages with weights corresponding to the lineage abundance in the sample:<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$fq(KO_{i} ,sample_{j} ) = \sum\limits_{{lineage_{k} }} {fq(lineage_{k} ,sample_{j} ) \times fq(lineage_{k} ,KO_{i} )}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mi>f</mml:mi><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mi>f</mml:mi><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mi>f</mml:mi><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math><graphic xlink:href="13104_2015_1462_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
        </sec>
        <sec id="Sec11">
          <title>STEP 6: assessing the uncertainty in function-sample estimates</title>
          <p>To assess the uncertainty in function-sample estimates under the assumption that each OTU abundance profile contributes to functional terms’ profile independently, we performed bootstrapping that we selected OTUs along with their abundance across samples (i.e., rows in the OTU-sample table) as many as the number of OTUs in the OTU-sample table (i.e., the number of rows in the OTU-sample table) randomly with replacement. Therefore, some OTUs in the OTU-sample table can be represented more than once and some not at all. We produce 100 bootstrap replicates of the OTU-sample table, and corresponding 100 function-sample tables through STEP 1–STEP 5. We examine whether the estimates of functional terms neither belong to the top 2.5 % nor the bottom 2.5 % (i.e., at a 95 % confidence interval). For all of test sets used in the study (see “<xref rid="Sec12" ref-type="sec">Case study</xref>” section), all functional terms identified in STEP 5 had estimates within the 95 % confidence interval. Note that a software, PanFP does not include a step for assessing the uncertainty in function-sample estimates by bootstrapping.</p>
        </sec>
      </sec>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Case study</title>
    <p>We applied PanFP to diverse communities, which include 39 mammal gut samples, 14 soil samples, ten hypersaline microbial mats, and two synthetic mock communities from the HMP where both 16S rRNA gene data and metagenome data have been derived from the same samples. This is the same dataset used in a recently developed method, PICRUSt [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. To evaluate our method, we compared functional profiles inferred by PanFP to the sequenced metagenomes for 65 samples where PICRUSt annotated whole genome sequencing reads to KO terms using HUMAnN [<xref ref-type="bibr" rid="CR20">20</xref>]. The number of KO terms present in the 65 sequenced metagenomes is described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. The hypersaline metagenomes have the range of 263 ± 131 different KO terms, mammal gut metagenome of 1190 ± 640 KO terms, soil metagenomes of 4328 ± 402 KO terms, and the metagenomes of HMP mock communities of 6051 ± 85 KO terms where, for example, 263 ± 131 means an average of 263 KO terms and a standard deviation of 131 KO terms. The number of KO terms present in sequenced metagenomes can be affected by sequencing depth. Therefore, the small number of KO terms identified in a sequenced metagenome may lead to erroneous estimates of community functional diversity, which makes it difficult to validate metagenome prediction tools. For the comparison of PanFP–PICRUSt, we used PICRUSt-compatible closed OTU-tables (97 % identity via uclust [<xref ref-type="bibr" rid="CR21">21</xref>]). PICRUSt makes use of a 16S rRNA gene phylogeny of all OTUs available in a reference database (Greengenes [<xref ref-type="bibr" rid="CR22">22</xref>]), along with the functional composition of reference genomes assigned to these OTUs (IMG [<xref ref-type="bibr" rid="CR23">23</xref>]). From this combined information, PICRUSt infers function content at the ancestral nodes based on the 16S rRNA gene phylogeny. Therefore, the PICRUSt-compatible OTU-tables can only be constructed from the closed-reference OTU picking protocol. We note that Nelson et al. [<xref ref-type="bibr" rid="CR24">24</xref>] reported that the closed-reference OTU picking protocol introduces biases since a large number of reads (on average 35 % with large variance across different samples) which fail to be assigned to reference OTUs are discarded. Based on a PICRUSt-compatible OTU-sample table, we inferred a functional profile for each sample. Note that it took much less than one minute for functional profiles to be generated via PanFP for the HMP mock community samples on a laptop 2.6 GHz CPU. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the Spearman rank correlation between our inferred functional profiles and sequenced metagenomic functional profiles. Note that we considered only KO terms with non-zero estimates in both functional profiles being compared when calculating Spearman correlation in the study since functional profiles were represented by different sets of KO terms by different approaches. The Spearman rank correlation between the predicted PanFP and actual metagenome functional profiles improved with the increase in the number of KO terms identified in sequenced metagenomes, which corresponds to an increase of sequencing depth. This can be directly observed in our comparison of the two HMP mock communities, which showed the deepest sequencing depth among the studied samples, with correlations of ≃0.9. For all 65 samples, correlations and the number of KO terms common in both profiles are summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. As expected, the hypersaline mat samples, which were shallowly sequenced, showed artificially low correlations with our inferred functional profiles.<fig id="Fig1"><label>Fig. 1</label><caption><p>Spearman correlation between functional profiles inferred by PanFP and sequenced metagenomic functional profiles for 65 samples</p></caption><graphic xlink:href="13104_2015_1462_Fig1_HTML" id="MO4"/></fig></p>
    <p>Also, we compared our inferred functional profiles to those produced from PICRUSt. Figure <xref rid="Fig2" ref-type="fig">2</xref> is a scatter plot of the two Spearman correlations for 65 samples where X-axis represents correlation between functional profiles inferred by PanFP and sequenced metagenomic functional profiles, and Y-axis represents correlations between functional profiles inferred by PICRUSt and sequenced metagenomic functional profiles. Both of metagenome prediction methods essentially show identical performance (with <italic>p</italic> value of 0.98 by Welch two sample <italic>t</italic> test) for almost all samples. PanFP and PICRUSt build very similar functional profiles whose Spearman rank correlations considering KO terms common to both profiles are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3 where correlations have an average of 0.85. A sample labeled as Squirrel from mammal showed a much higher correlation with PICRUSt than PanFP. The two KO terms with the highest abundance in the squirrel metagenome were K07024 (whose definition is not described) and K02029 (whose definition is polar amino acid transport system permease protein). The abundance of those two KO terms showed better agreement with inferred functional profile by PICRUSt than by PanFP. For samples from HMP mock communities and soil which have better sequencing depth in terms of the number of KO terms identified compare to other test samples in our study, PanFP showed slightly better correlation with metagenomic functional profiles than PICRUSt.<fig id="Fig2"><label>Fig. 2</label><caption><p>A <italic>scatter plot</italic> of the two Spearman correlations for 65 samples: X-axis and Y-axis represent correlations between functional profiles inferred by PanFP and PICRUSt versus sequenced metagenomic functional profiles, respectively</p></caption><graphic xlink:href="13104_2015_1462_Fig2_HTML" id="MO5"/></fig></p>
    <sec id="Sec13">
      <title>Scripts</title>
      <p>PanFP includes a database of prokaryotes genomes with functional annotation by KEGG Orthology, and several Perl scripts. We provide a single easy to use script, which implements the entire PanFP pipeline from start to finish, as wells as several intermediate scripts for advanced users, so that they may tailor PanFP to their needs. For a given OTU profile, scripts perform each step with a negligible computational time as described in the “<xref rid="Sec3" ref-type="sec">Algorithm details</xref>” section.</p>
    </sec>
  </sec>
  <sec id="Sec14" sec-type="conclusions">
    <title>Conclusions</title>
    <p>We presented a new pipeline called PanFP for inferring the functional composition of microbial communities from 16S rRNA gene survey data. These inferred profiles are based on the construction of a pangenome through the OTUs’ taxonomic lineages PanFP can be extended to other phylogenetic marker genes in a similar manner. While PanFP and PICRUSt share many similarities in approach and results, there are several differences: (1) PanFP is not limited to a specific OTU-picking protocol, (2) PanFP is not confined to specific reference genomes/complete genomes, and (3) PanFP should be less sensitive to horizontal gene transfer within an OTU’s pangenome. The accuracy of our method is primarily affected by external factors, such as the taxonomic resolution of OTUs, and the availability and diversity of microbial organisms with robust functional annotation. PanFP will become increasingly more robust as the depth and breadth of microbial databases continue to grow. Note that these issues would also apply to the performance of any other metagenome prediction tools based on 16S rRNA community data.</p>
    <p>PanFP showed a remarkable accuracy for HMP mock communities with deeply sequenced metagenomes such that PanFP would provide a cost-effective new way to study complex ecosystems through comparative functional metagenomics and metadata analysis. Within the limitations described above, these comparisons should provide a statistically robust framework for highlighting the most over or under represented biological functions. Also, PanFP can serve as a first step in large metagenomics projects to identify potential samples of interest for direct metagenome sequencing.</p>
  </sec>
  <sec id="Sec15">
    <title>Availability and requirements</title>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>Project name: PanFP</p>
        </list-item>
        <list-item>
          <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/srjun/PanFP">https://github.com/srjun/PanFP</ext-link></p>
        </list-item>
        <list-item>
          <p>Operating systems(s): Linux, Mac OS X</p>
        </list-item>
        <list-item>
          <p>Programming language: Perl</p>
        </list-item>
        <list-item>
          <p>License: GNU</p>
        </list-item>
        <list-item>
          <p>Any restrictions to use by non-academics: None.</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec id="Sec16">
    <title>Availability of supporting data</title>
    <p>The data sets supporting the results of this article are included within the article and its additional files.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec17">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="13104_2015_1462_MOESM1_ESM.docx" id="MOESM1">
            <caption>
              <p>
10.1186/s13104-015-1462-8 This is a doc file which includes all supporting results (Figure S1, Figure S2, Figure S3, and Table S1).</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>OTU</term>
        <def>
          <p>operational taxonomic unit</p>
        </def>
      </def-item>
      <def-item>
        <term>KO</term>
        <def>
          <p>KEGG Orthology</p>
        </def>
      </def-item>
      <def-item>
        <term>UniProtKB</term>
        <def>
          <p>UniProt KnowledgeBase</p>
        </def>
      </def-item>
      <def-item>
        <term>NCBI</term>
        <def>
          <p>National Center for Biotechnology Information</p>
        </def>
      </def-item>
      <def-item>
        <term>PanFP</term>
        <def>
          <p>pangenome-based functional profile</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Authors’ contributions</title>
    <p>SJ and AG designed the study, and developed the method called PanFP, and prepared the manuscript. MR prepared communities survey data. All authors participated in writing, data analysis, discussions. All authors read and approved the final manuscript.</p>
    <sec id="FPar1">
      <title>Acknowledgements</title>
      <p>We would like to thank Jesse Zaneveld greatly for providing the metagenome datasets used in PICRUSt. This work was supported by the Plant–Microbe Interfaces Scientific Focus Area in the Genomic Science Program, United States Department of Energy, Office of Science, Biological and Environmental Research. Oak Ridge National Laboratory is managed by UT-Battelle, LLC, for the United States Department of Energy under Contract DE-AC05-00OR22725.</p>
      <p>This manuscript has been authored by UT-Battelle, LLC under Contract No. DE-AC05-00OR22725 with the US Department of Energy. The United States Government retains and the publisher, by accepting the article for publication, acknowledges that the United States Government retains a non-exclusive, paid-up, irrevocable, world-wide license to publish or reproduce the published form of this manuscript, or allow others to do so, for United States Government purposes. The Department of Energy will provide public access to these results of federally sponsored research in accordance with the DOE Public Access Plan (<ext-link ext-link-type="uri" xlink:href="http://energy.gov/downloads/doe-public-access-plan">http://energy.gov/downloads/doe-public-access-plan</ext-link>).</p>
    </sec>
    <sec id="FPar2">
      <title>Compliance with ethical guidelines</title>
      <p><bold>Competing interests</bold> The authors declare that they have no competing interests.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Morgan XC, Huttenhower C. Chapter 12: human microbiome analysis. Plos Comput Biol. 2012;8(12). doi:10.1371/Journal.Pcbi.1002808.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Segata N, Boernigen D, Tickle TL, Morgan XC, Garrett WS, Huttenhower C. Computational meta’omics for microbial community studies. Mol Syst Biol. 2013;9. doi:10.1038/Msb.2013.22.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pei</surname>
            <given-names>AY</given-names>
          </name>
          <name>
            <surname>Oberdorf</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Nossa</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Agarwal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chokshi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gerz</surname>
            <given-names>EA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diversity of 16S rRNA genes within individual prokaryotic genomes</article-title>
        <source>Appl Environ Microb.</source>
        <year>2010</year>
        <volume>76</volume>
        <issue>12</issue>
        <fpage>3886</fpage>
        <lpage>3897</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.02953-09</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Langille MGI, Zaneveld J, Caporaso JG, McDonald D, Knights D, Reyes JA, et al. Predictive functional profiling of microbial communities using 16S rRNA marker gene sequences. Nat Biotechnol. 2013;31(9):814. doi:10.1038/Nbt.2676.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Wooley JC, Godzik A, Friedberg I. A Primer on metagenomics. Plos Comput Biol. 2010;6(2). doi:10.1371/Journal.Pcbi.1000667.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomas</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Metagenomics—a guide from sampling to data analysis</article-title>
        <source>Microb Inform Exp</source>
        <year>2012</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1186/2042-5783-2-3</pub-id>
        <?supplied-pmid 22587947?>
        <pub-id pub-id-type="pmid">22587947</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Ni JJ, Yan QY, Yu YH. How much metagenomic sequencing is enough to achieve a given goal? Sci Rep-Uk. 2013;3. doi:10.1038/Srep01968.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Caro-Quintero</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tsementzi</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>DeLeon-Rodriguez</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Poretsky</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenomic insights into the evolution, function, and complexity of the planktonic microbial community of Lake Lanier, a temperate freshwater ecosystem</article-title>
        <source>Appl Environ Microb.</source>
        <year>2011</year>
        <volume>77</volume>
        <issue>17</issue>
        <fpage>6000</fpage>
        <lpage>6011</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.00107-11</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Steffen MM, Li Z, Effler TC, Hauser LJ, Boyer GL, Wilhelm SW. Comparative metagenomics of toxic freshwater cyanobacteria bloom communities on two continents. Plos One. 2012;7(8). doi:10.1371/journal.pone.0044002.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kämpfer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Glaeser</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Prokaryotic taxonomy in the sequencing era—the polyphasic approach revisited</article-title>
        <source>Environ Microbiol</source>
        <year>2012</year>
        <volume>14</volume>
        <issue>2</issue>
        <fpage>291</fpage>
        <lpage>317</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1462-2920.2011.02615.x</pub-id>
        <?supplied-pmid 22040009?>
        <pub-id pub-id-type="pmid">22040009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goto</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Furumichi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tanabe</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>KEGG for integration and interpretation of large-scale molecular data sets</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>D1</issue>
        <fpage>D109</fpage>
        <lpage>D114</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr988</pub-id>
        <?supplied-pmid 22080510?>
        <pub-id pub-id-type="pmid">22080510</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ashburner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ball</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cherry</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene ontology: tool for the unification of biology. The Gene Ontology Consortium</article-title>
        <source>Nat Genet.</source>
        <year>2000</year>
        <volume>25</volume>
        <issue>1</issue>
        <fpage>25</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="doi">10.1038/75556</pub-id>
        <?supplied-pmid 10802651?>
        <pub-id pub-id-type="pmid">10802651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Punta M, Coggill PC, Eberhardt RY, Mistry J, Tate J, Boursnell C, et al. The Pfam protein families database. Nucleic Acids Res. 2012;40(Database issue):D290–301. doi:10.1093/nar/gkr1065.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haft</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Selengut</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>The TIGRFAMs database of protein families</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <issue>1</issue>
        <fpage>371</fpage>
        <lpage>373</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkg128</pub-id>
        <?supplied-pmid 12520025?>
        <pub-id pub-id-type="pmid">12520025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Popa</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Dagan</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Trends and barriers to lateral gene transfer in prokaryotes</article-title>
        <source>Curr Opin Microbiol</source>
        <year>2011</year>
        <volume>14</volume>
        <issue>5</issue>
        <fpage>615</fpage>
        <lpage>623</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mib.2011.07.027</pub-id>
        <?supplied-pmid 21856213?>
        <pub-id pub-id-type="pmid">21856213</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Magrane M, Consortium U. UniProt Knowledgebase: a hub of integrated protein data. Database J Biol Databases Curation. 2011;2011:bar009. doi:10.1093/database/bar009.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yelton</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Simmons</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Wilmes</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zemla</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thelen</surname>
            <given-names>MP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A semi-quantitative, synteny-based method to improve functional predictions for hypothetical and poorly annotated bacterial and archaeal genes</article-title>
        <source>PLoS Comput Biol</source>
        <year>2011</year>
        <volume>7</volume>
        <issue>10</issue>
        <fpage>e1002230</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002230</pub-id>
        <?supplied-pmid 22028637?>
        <pub-id pub-id-type="pmid">22028637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stombaugh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>EK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>QIIME allows analysis of high-throughput community sequencing data</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>5</issue>
        <fpage>335</fpage>
        <lpage>336</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.f.303</pub-id>
        <?supplied-pmid 20383131?>
        <pub-id pub-id-type="pmid">20383131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zaneveld</surname>
            <given-names>JRR</given-names>
          </name>
          <name>
            <surname>Thurber</surname>
            <given-names>RLV</given-names>
          </name>
        </person-group>
        <article-title>Hidden state prediction: a modification of classic ancestral state reconstruction algorithms helps unravel complex symbioses</article-title>
        <source>Front Microbiol.</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>431</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2014.00431</pub-id>
        <?supplied-pmid 25202302?>
        <pub-id pub-id-type="pmid">25202302</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abubucker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Goll</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schubert</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Izard</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cantarel</surname>
            <given-names>BL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metabolic reconstruction for metagenomic data and its application to the human microbiome</article-title>
        <source>PLoS Comput Biol</source>
        <year>2012</year>
        <volume>8</volume>
        <issue>6</issue>
        <fpage>e1002358</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002358</pub-id>
        <?supplied-pmid 22719234?>
        <pub-id pub-id-type="pmid">22719234</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Search and clustering orders of magnitude faster than BLAST</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>19</issue>
        <fpage>2460</fpage>
        <lpage>2461</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq461</pub-id>
        <?supplied-pmid 20709691?>
        <pub-id pub-id-type="pmid">20709691</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McDonald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Goodrich</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nawrocki</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>DeSantis</surname>
            <given-names>TZ</given-names>
          </name>
          <name>
            <surname>Probst</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An improved Greengenes taxonomy with explicit ranks for ecological and evolutionary analyses of bacteria and archaea</article-title>
        <source>ISME J</source>
        <year>2012</year>
        <volume>6</volume>
        <issue>3</issue>
        <fpage>610</fpage>
        <lpage>618</lpage>
        <pub-id pub-id-type="doi">10.1038/ismej.2011.139</pub-id>
        <?supplied-pmid 22134646?>
        <pub-id pub-id-type="pmid">22134646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Markowitz</surname>
            <given-names>VM</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>IMA</given-names>
          </name>
          <name>
            <surname>Palaniappan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Szeto</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Grechkin</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IMG: the integrated microbial genomes database and comparative analysis system</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>D1</issue>
        <fpage>D115</fpage>
        <lpage>D122</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr1044</pub-id>
        <?supplied-pmid 22194640?>
        <pub-id pub-id-type="pmid">22194640</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Nelson MC, Morrison HG, Benjamino J, Grim SL, Graf J. Analysis, optimization and verification of illumina-generated 16S rRNA gene amplicon surveys. Plos One. 2014;9(4). doi:10.1371/journal.pone.0094249.</mixed-citation>
    </ref>
  </ref-list>
</back>
