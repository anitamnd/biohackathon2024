<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Microbiome</journal-id>
    <journal-id journal-id-type="iso-abbrev">Microbiome</journal-id>
    <journal-title-group>
      <journal-title>Microbiome</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2049-2618</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10631056</article-id>
    <article-id pub-id-type="pmid">37936197</article-id>
    <article-id pub-id-type="publisher-id">1705</article-id>
    <article-id pub-id-type="doi">10.1186/s40168-023-01705-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VBCG: 20 validated bacterial core genes for phylogenomic analysis with high fidelity and resolution</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tian</surname>
          <given-names>Renmao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Imanian</surname>
          <given-names>Behzad</given-names>
        </name>
        <address>
          <email>bimanian@iit.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.62813.3e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 7806</institution-id><institution>Institute for Food Safety and Health, </institution><institution>Illinois Institute of Technology, </institution></institution-wrap>Bedford Park, IL 60501 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/037t3ry66</institution-id><institution-id institution-id-type="GRID">grid.62813.3e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 7806</institution-id><institution>Food Science and Nutrition Department, </institution><institution>Illinois Institute of Technology, </institution></institution-wrap>Chicago, IL 60616 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>11</volume>
    <elocation-id>247</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Phylogenomic analysis has become an inseparable part of studies of bacterial diversity and evolution, and many different bacterial core genes have been collated and used for phylogenomic tree reconstruction. However, these genes have been selected based on their presence and single-copy ratio in all bacterial genomes, leaving out the gene's 'phylogenetic fidelity' unexamined.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">From 30,522 complete genomes covering 11,262 species, we examined 148 bacterial core genes that have been previously used for phylogenomic analysis. In addition to the gene presence and single-copy rations, we evaluated the gene's phylogenetic fidelity by comparing each gene's phylogeny with its corresponding <italic>16S rRNA</italic> gene tree. Out of the 148 bacterial genes, 20 validated bacterial core genes (VBCG) were selected as the core gene set with the highest bacterial phylogenetic fidelity. Compared to the larger gene set, the 20-gene core set resulted in more species having all genes present and fewer species with missing data, thereby enhancing the accuracy of phylogenomic analysis. Using <italic>Escherichia</italic> coli strains as examples of prominent bacterial foodborne pathogens, we demonstrated that the 20 VBCG produced phylogenies with higher fidelity and resolution at species and strain levels while <italic>16S rRNA</italic> gene tree alone could not.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">The 20 validated core gene set improves the fidelity and speed of phylogenomic analysis. Among other uses, this tool improves our ability to explore the evolution, typing and tracking of bacterial strains, such as human pathogens. We have developed a Python pipeline and a desktop graphic app (available on GitHub) for users to perform phylogenomic analysis with high fidelity and resolution.</p>
        <p id="Par500">
          <media xlink:href="40168_2023_1705_MOESM2_ESM.mp4" id="MOESM2">
            <caption>
              <p>Video Abstract</p>
            </caption>
          </media>
        </p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s40168-023-01705-9.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Phylogenomics</kwd>
      <kwd>Bacterial core genes</kwd>
      <kwd>Phylogenetic tree</kwd>
      <kwd>Pathogen typing</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par10">Bacterial pangenomes consist of the core genome, a set of genes present in all genomes within a clade, and the accessory genome, a set of genes found in one or more but not all members of the clade [<xref ref-type="bibr" rid="CR1">1</xref>]. While the core genome of a clade can be, and often is, different from that of another clade, it invariably contains highly conserved genes essential for the vital cellular functions of the members of that clade.</p>
    <p id="Par11">The core genome reflects the vertical accumulation of mutations on the conserved set of genes, and thus it can provide phylogenetic signals for assigning bacterial strains to their corresponding populations [<xref ref-type="bibr" rid="CR2">2</xref>]. Over the past decade, there has been a significant increase in research on bacterial core genes and their applications in phylogenomic analysis [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. Bacterial core genes are widely used for phylogenomic analysis due to a) their high level of conservation; and b) their widespread distribution among bacterial genomes. With the increased availability of massive amounts of genomic data and improved phylogenetic methods in recent years, phylogenomic analysis has become a popular approach to study bacterial evolution, diversity and ecology. Phylogenomic analysis using core genes [<xref ref-type="bibr" rid="CR7">7</xref>] has also been shown to be more accurate and robust than the traditional phylogenetic methods that use a single gene (e.g. <italic>16S rRNA</italic>) or multiple genes (e.g. MLST).</p>
    <p id="Par12">With different number of marker genes, often within a core gene set, different teams of researchers have developed tools and pipelines to simplify and streamline core gene phylogenomic analysis. In 2008, Wu et al. used 31 predefined marker genes to build a phylogenomic pipeline named AMPHORA [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. These 31 marker genes included those involved in glycolysis, DNA replication, translation etc. In 2011, Creevey et al. identified 40 bacterial core genes from 191 species [<xref ref-type="bibr" rid="CR10">10</xref>] and indicated that they had constant rate of horizontal transfer. In 2012, Dupont et al. investigated metagenome-assembled genomes (MAGs) of SAR86 (an abundant marine bacterial lineage) and estimated the genome completeness and contamination [<xref ref-type="bibr" rid="CR11">11</xref>] using 107 single-copy genes that were single-copy in &gt; 95% of bacterial genomes in the Comprehensive Microbial Resource database. In 2013, Wu et al. identified 114 bacterial core genes and multiple lineage-specific core gene sets (100 s – 1000 s) from 666 genomes by examining the genes’ universality, evenness and uniqueness [<xref ref-type="bibr" rid="CR12">12</xref>]. Later in 2016, Markus et al. developed a bioinformatic pipeline called bcgTree that used 107 essential single-copy core genes, identified by Dupont et al., as mentioned above, to reconstruct their phylogenetic history [<xref ref-type="bibr" rid="CR6">6</xref>]. This pipeline automatically extracted these genes using hidden Markov models and performed a partitioned maximum-likelihood analysis. In 2018, another group presented an up-to-date bacterial core gene set, named UBCG, which consisted of single-copy, homologous genes present in most known bacterial species [<xref ref-type="bibr" rid="CR4">4</xref>]. The 92 UBCG gene set was selected from 1,429 species covering 28 phyla with the criteria of 95% presence ratio and 95% single-copy ratio. The method was successfully used to infer phylogenomic relationships in <italic>Escherichia</italic> and related taxa, and it could be used at any taxonomic level for Bacteria. In 2021, the same group updated their bacterial core genes with more extensive genome data to UBCG2 [<xref ref-type="bibr" rid="CR5">5</xref>], which included 81 genes from 3,508 species spanning 43 phyla with the same criteria of 95% presence ratio and 95% single-copy ratio.</p>
    <p id="Par13">All the previous studies have utilized the gene presence and single-copy ratios to screen for the conserved, single-copy genes to build their phylogenies. However, this has led to an obvious shortcoming: the selected genes were not examined for their fidelity in reconstructing the phylogenetic tree, and thus they may carry incongruent evolutionary signals. A core genome phylogeny is reconstructed, like other multiple-gene trees, based on concatenated sequences of a set of selected genes. The inclusion of a gene, whose tree shows discordance with the phylogenies of the others genes in the gene set, lowers the evolutionary signal and thus the accuracy of topology and resolution of the resulting phylogeny. We, thus, propose that in order to select the genes for a core genome to reconstruct an accurate phylogeny, in addition to high presence and single-copy ratios, the genes should be examined for phylogenetic fidelity, a measure of congruity of the phylogenies of the genes within a gene set, as well. Here, we used the 16 s rRNA gene trees to evaluate and compare the phylogenetic fidelity of the candidate core genes and identified 20 high fidelity genes for bacterial phylogenomic analysis. We have developed a pipeline, VBCG, which uses the core gene set to build phylogenomic trees automatically with input of genomic sequences.</p>
    <sec id="Sec2">
      <title>Implementation</title>
      <sec id="Sec3">
        <title>Test genomes and candidate core genes</title>
        <p id="Par14">Genome information of prokaryotes was accessed Through the National Center for Biotechnology Information (NCBI) (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/genome/browse#!/prokaryotes/">https://www.ncbi.nlm.nih.gov/genome/browse#!/prokaryotes/</ext-link>) on Oct 11, 2022. In total, 30,552 finished bacterial genomes covering 11,262 species were selected and the protein sequences and rRNA genes were downloaded using a custom Python script with multiple processing. The rRNA files were then filtered to remove those with multiple <italic>16S rRNA</italic> genes that were less than 99% identical. For those with multiple copies that were &gt; 99% identical, the first copy was used as a representative. The <italic>16S rRNA</italic> genes were then clustered using CD-HIT (version 4.8.1) [<xref ref-type="bibr" rid="CR13">13</xref>] with a similarity threshold of 0.99 and an alignment coverage of 0.9 (-c 0.99 -G 0 -aL 0.9). The representative sequences (5506 sequences) were then randomly divided into 100 groups for further analysis.</p>
        <p id="Par15">We used a total of 148 genes collected from UBCG [<xref ref-type="bibr" rid="CR4">4</xref>], UBCG2 [<xref ref-type="bibr" rid="CR5">5</xref>] bac120 [<xref ref-type="bibr" rid="CR14">14</xref>] and bcgTree [<xref ref-type="bibr" rid="CR6">6</xref>] as candidate genes, which have been shown to have high presence and single-copy ratios in bacterial genomes. To acquire the HMM model files, PGAP HMM files and a PFAM file were downloaded from an NCBI website (<ext-link ext-link-type="uri" xlink:href="https://ftp.ncbi.nlm.nih.gov/hmm/current/">https://ftp.ncbi.nlm.nih.gov/hmm/current/</ext-link>) and the European Molecular Biology Laboratory's European Bioinformatics Institute (EMBL-EBI) website (<ext-link ext-link-type="uri" xlink:href="https://ftp.ebi.ac.uk/pub/databases/Pfam/current_release/">https://ftp.ebi.ac.uk/pub/databases/Pfam/current_release/</ext-link>), respectively, and the corresponding HMM models were retrieved using a custom Python script.</p>
        <p id="Par16">To annotate the candidate core genes, hmmscan of the package HMMER [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] was used to search all the protein sequences of the 5506 representative genomes against the acquired HMM models (with the trusted score cutoffs, –cut_tc), in parallel using Python package multiprocessing. The output file was parsed to assign the core genes to the proteins.</p>
      </sec>
      <sec id="Sec4">
        <title>Ubiquity and uniqueness of the core genes</title>
        <p id="Par17">The ubiquity and uniqueness of the core genes were evaluated by calculating the presence ratio and single-copy ratio of the core genes in the 5506 representative genomes. The presence ratio was defined by the number of genomes with each core gene divided by the total number of genomes. The single-copy ratio was defined by the number of genomes with only one copy of each core gene divided by total number of genomes. Only the core genes with both presence ratio and single-copy ratio &gt; 95%, respectively, were used for further analysis.</p>
      </sec>
      <sec id="Sec5">
        <title>Fidelity test for the candidate core genes</title>
        <p id="Par18">For each candidate core gene, all the proteins were divided into 50 groups corresponding to the grouping of <italic>16S rRNA</italic> genes. For each group, a phylogenetic tree was reconstructed for the <italic>16S rRNA</italic> gene and the core gene, respectively. The sequences were first aligned using MUSCLE (version 3.8.1551) [<xref ref-type="bibr" rid="CR17">17</xref>]. The multiple sequence alignment was then trimmed to remove terminal gaps. The trimmed alignment was then filtered to select conserved blocks using Gblocks (version 0.91b) [<xref ref-type="bibr" rid="CR18">18</xref>] with the minimum length of a block as three (-b4 = 3) and the maximum number of allowed gap positions as half (-b5 = h). The resulted alignment was then converted into format Phylip and was then fed to FastTree (version 2.1.10) [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] for phylogenetic tree reconstruction. The models gtr + gamma and lg + gamma were used for the <italic>16S rRNA</italic> gene and core gene protein sequences, respectively, with a bootstrap number of 100. The output trees in Newick format of <italic>16S rRNA</italic> gene and core genes of each group were compared using Dendropy (version 4.5.2) [<xref ref-type="bibr" rid="CR21">21</xref>] calculating the Robinson Foulds (RF) distance [<xref ref-type="bibr" rid="CR22">22</xref>]. The 20 core genes with the highest fidelity, also ensuring that &gt; 80% of the genomes include the whole gene set, were chosen as the validated bacterial core gene (VBCG) set.</p>
      </sec>
      <sec id="Sec6">
        <title>Comparison of multiple gene sets in fidelity</title>
        <p id="Par19">The 50 groups of genomes were used to compare the fidelity of the gene set VBCG with other gene sets. For each group, the core genes were aligned using MUSCLE and the terminal gaps were removed from the multiple alignments. Gblocks was then used to select conserved blocks. The processed alignments of the core genes were then concatenated, removing any taxa with &gt; 1 gene missing. The concatenated alignments were converted into Phylip files and fed to FastTree for phylogenetic tree reconstruction. The trees were then compared to the corresponding <italic>16S rRNA</italic> gene trees by calculating the RF distances.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results</title>
    <sec id="Sec8">
      <title>Ribosomal protein-encoding genes have high ubiquity and uniqueness in the Kingdom Bacteria</title>
      <p id="Par20">In total 30,522 rRNA gene and their corresponding protein sequences were downloaded from RefSeq database. After filtering those with multiple divergent copies, 29,781 sequences of <italic>16S rRNA</italic> genes were remained. After clustering the sequences at 99%, 5,506 representative genes were observed, which were then randomly divided into 50 groups (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>The workflow of the data analysis in this study. The filtering step indicated by an asterisk removes genomes with &gt; 2 copies of <italic>16S rRNA</italic> genes that are &lt; 99% identical. The clustering step indicated by two asterisks clusters <italic>16S rRNA</italic> genes using a cutoff of 99%</p></caption><graphic xlink:href="40168_2023_1705_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par21">The presence and single-copy ratios of the 148 core genes in the 5506 representative genomes were calculated (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). Interestingly, the 47 ribosomal proteins had much higher ubiquity (median presence ratios: 98.9%) and uniqueness (median single-copy ratios: 98.7%) than those of the other core genes (95.7% and 94.2%). Among the 50 proteins with top presence ratios, 39 were ribosomal proteins. We then selected the core genes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B, Table S<xref rid="MOESM1" ref-type="media">1</xref>) with both presence and single-copy ratios &gt; 95% for the fidelity and resolution tests (85 genes).<fig id="Fig2"><label>Fig. 2</label><caption><p>The presence and single-copy ratios of the candidate core genes in the Kingdom Bacteria. In the total core genes (<bold>A</bold>), the 47 ribosomal proteins had much higher ubiquity (median presence ratios: 98.9%) and uniqueness (median single-copy ratios: 98.7%) than those of the other core genes (95.7% and 94.2%). The dashed line demarcates the 95% ratio. In total 85 core genes (<bold>B</bold>) with both presence and single-copy ratios &gt; 95% were retained for the fidelity and resolution tests</p></caption><graphic xlink:href="40168_2023_1705_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec9">
      <title>The validated core gene tree showed the highest concordance with the 16S rRNA gene phylogeny</title>
      <p id="Par22">The 5,506 representative genes were randomly divided into 50 groups (~ 110 taxa in each group, Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The fidelity test compared the trees of the 50 groups for each of the 85 core genes with the corresponding <italic>16S rRNA</italic> gene trees based on Robinson-Foulds (RF) distance. The tests ranked the fidelity for each of the core genes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). The core gene phylogenies with the closest and farthest distances to their corresponding <italic>16S rRNA</italic> gene trees ranged from 115.9 ± 14.8 RF and 173.8 ± 9.1 RF, respectively, with the maximum being 50% higher the minimum. We then chose the top 20 genes with the highest fidelity (with lowest RF distances) as our candidate validated bacterial core gene (VBCG) set (Table S<xref rid="MOESM1" ref-type="media">2</xref>). A close examination of these 20 genes revealed that they were mostly involved in transcription (e.g. RNA polymerase) and translation (e.g. ribosomal proteins, translation initiation, elongation and termination).<fig id="Fig3"><label>Fig. 3</label><caption><p>The fidelity test of the validated core genes. The fidelity tests (<bold>A</bold>): The RF distances of the core genes trees from the corresponding <italic>16S rRNA</italic> gene trees. Each data point indicates the means and standard deviations of 50 trees (110 taxa each). The yellow dashed line indicates the top 20 genes with the highest fidelities in the left. The fidelity test and comparisons for phylogenies of multiple gene sets (<bold>B</bold>): The RF distances (brown boxes) of the trees based on the concatenated genes (top 20-gene set and all 85 gene set) from the corresponding <italic>16S rRNA</italic> gene trees of the 50 groups of genomes. The asterisk indicate significant difference from the top 20-gene set. The blue bars and right side y-axis show the taxon presence ratio of each gene set, which indicates the percentage of taxa with all members of the gene sets</p></caption><graphic xlink:href="40168_2023_1705_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par23">We then compared the phylogenetic fidelity of the top 20 gene (VBCG) set and that of all the 85 genes, by concatenating the genes and calculating the RF distances of the resulting trees from the corresponding <italic>16S rRNA</italic> gene trees of the 50 groups of genomes. As a result, the VBCG gene set had significantly lower RF distance from the corresponding <italic>16S rRNA</italic> gene trees (Paired Samples T test, <italic>p</italic> &lt; 1e-5, Fig. <xref rid="Fig3" ref-type="fig">3</xref>B) than those of the 85 gene set, which was 20% higher.</p>
    </sec>
    <sec id="Sec10">
      <title>The VBCG gene set resulted in lower missing data rate in the tree compared to that of all genes</title>
      <p id="Par24">The rationale behind selecting the top 20 genes is that these genes yield an acceptable missing data rate in the species for the phylogenetic tree. Because all the core genes have a presence ratio between 95 and 100%, only certain taxa will have all the genes of a given gene set. An advantage of using the 20-gene core set is its higher species data completeness. When comparing the 20-gene and 85-gene sets, 80.7% of species possess all 20 core genes, while only 19.3% have at least one missing gene (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). In contrast, for the larger gene set, 43% of species exhibit missing data. Given that increased missing data has been shown to reduce the accuracy of phylogenomic trees [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>], the 20-gene set offers enhanced accuracy in phylogenomic analysis due to its greater gene data presence.</p>
    </sec>
    <sec id="Sec11">
      <title>The VBCG gene set phylogeny had better resolution than that of the 16S rRNA gene</title>
      <p id="Par25">We compared the discriminative capability of VBCG set and the <italic>16S rRNA</italic> gene in tree reconstruction on the Genus <italic>Escherichia</italic> with an outgroup species from the genus <italic>Salmonella</italic>, both having member species that are commonly implicated in foodborne disease outbreaks. Our results showed that the <italic>16S rRNA</italic> gene tree had polytomies and could hardly discriminate between the species of <italic>Eschericha</italic> mainly because the <italic>16 s rRNA</italic> genes in the main group had a very high sequence similarity (&gt; 99.0% pairwise identities) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). The <italic>16 s rRNA</italic> tree also suffered from misclassification of the <italic>E. coli</italic> Str. IMT2125, which was mistakenly positioned outside the <italic>Eschericha</italic> genus. Various strains of the species <italic>E. coli,</italic> and <italic>E. fergusonii</italic> grouped together and were not well separated by species. Some of them are at the same branch, implying that they had not diverged. However, the VBCG tree showed a well-defined grouping by species, with different species nicely separated in different clades. The <italic>E. coli</italic> Str. IMT2125 was correctly positioned inside the genus. Even within each species clade, the strains were well separated with different branch lengths. In the VBCG tree, <italic>E. coli</italic> Str. 2020CK-00188 had branched within the <italic>E. fergusonii</italic> clade. While we cannot completely dismiss that this might be a mistake within the VBCG tree that begs further investigations, the likely explanation is that <italic>E. coli</italic> Str. 2020CK-00188 has been misclassified and it is not an <italic>E. coli</italic> species at all. Overall, our results indicated that a phylogeny based on the 20 VBCG genes resulted in higher resolutions (even at the strain level) compared with the corresponding tree based on <italic>16 s rRNA</italic> genes.<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparison between <italic>16S rRNA</italic> gene tree (<bold>A</bold>) and the VBCG tree (<bold>B</bold>) of concatenated core genes. The tree of the VBCG genes were reconstructed using the concatenated 20 genes of each genome. The asterisk in the <italic>16S rRNA</italic> gene tree indicates the main group of <italic>Escherichia</italic> species with pairwise identities &gt; 99.0%</p></caption><graphic xlink:href="40168_2023_1705_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>A pipeline and a desktop app for reconstructing phylogenomic trees automatically</title>
      <p id="Par26">We have built a pipeline to reconstruct phylogenomic trees with the input of assembled genomic sequences (Figure S<xref rid="MOESM1" ref-type="media">1</xref>). The pipeline first predicts the gene and protein sequences of the input genomes using Prodigal. The protein sequences are then used to identify the 20 VBCG genes with HMMER. Subsequently, the resulting VBCG genes of all the genomes are retrieved and each gene from all taxa is placed in its own single file. The genes are aligned using Muscle and the terminal gaps are removed from the multiple alignments. Gblocks is then used to select conserved blocks. The processed alignments of the core genes are then concatenated, removing any taxa with a certain number of missing genes (adjustable from one to six with four as the default). Any missing characters are replaced with question marks. The concatenated alignments are converted into Phylip files and fed into FastTree or RAxML for phylogenetic tree reconstruction.</p>
      <p id="Par27">The pipeline is written in Python 3.9, with the following dependencies: Bio &gt;  = 1.5.3, Muscle =  = 3.8, Pandas, Prodigal and HMMER. The command line-based pipeline can be run in Linux operating systems. We have also built a desktop graphic user interface (GUI) app (Figure S<xref rid="MOESM1" ref-type="media">2</xref>) on Windows for the users who have no access to a Linux system and a high-performance computer (HPC).</p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Discussion</title>
    <p id="Par28">With the increasing availability of genomic sequences in recent years, phylogenomic analysis has become a powerful critical tool for studying bacterial diversity and evolution. In the past, many marker genes and various core gene sets have been used for phylogenetic tree reconstruction [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. However, these genes have been selected based only on their presence and single-copy ratios in all bacterial genomes. The evolution of the genes within a genome is not uniform, and different genes evolve at different rates. Thus, single gene phylogenies, even from the same genome, could be quite different. The inclusion of the genes that are evolving at heterogeneous rates can weaken the phylogenetic signal, introduce noise, produce incorrect topologies, and eventually lower the resolution of the tree. In the previous methods and tools, the gene phylogenetic fidelity has not been considered, compared or tested in order to screen and select the highly concordant marker genes to include in a gene set (e.g. core genome set or its subsets) for phylogenomic analysis. Here, we have identified 20 validated bacterial core genes (VBCGs) that exhibit high fidelity and concordance in phylogeny with their corresponding <italic>16S rRNA</italic> gene trees. Moreover, we demonstrated that the VBCGs could produce superior resolution in discriminating species and strains compared to the widely used <italic>16S rRNA</italic> genes or other core gene sets. We have developed a Python pipeline and a desktop graphic app that enable users to perform phylogenomic analysis using the VBCGs with high fidelity and resolution.</p>
    <p id="Par29">In addition to a better resolution, the 20 VBCG also results in lower missing data rate and faster run-time in the phylogenomic analysis. Our 85 candidate bacterial core genes based upon the presence and single-copy ratios filtration are consistent with the UBCG2 [<xref ref-type="bibr" rid="CR5">5</xref>], which contains 81 core genes using the same ratios for filtration. However, our results have shown that the 85 core gene set without fidelity screening resulted in higher RF distances from the corresponding <italic>16 s rRNA</italic> trees than the 20 VBCG gene set. In terms of taxon coverage, the 85 core genes resulted in the inclusion of only 57% of all the species in the concatenated sequences, whereas the VBCG gene set included 80% of the species with all the 20 genes. Thus, VBCG can effectively reduce the missing data due to absence of one or more core genes in the phylogenomic tree reconstruction. In addition, the fewer number of core genes in the VBCG tool lowers the running time significantly compared to those with the larger gene sets.</p>
    <p id="Par30">Phylogenomic analysis has emerged as a powerful tool, for example, in tracking the origins of foodborne disease outbreaks. This technique involves the sequencing of whole genomes of bacterial isolates recovered from infected individuals, foods and related environments. These sequences are then used in computational analyses to reconstruct a phylogenomic tree that reveals the evolutionary relationships between these isolates. One of the main benefits of these analyses is their ability to accurately trace the spread of a particular bacterial strain across different geographical locations and over time. Phylogenomic analyses has become an indispensable tool in the hands of epidemiologists as well. A phylogenomic tree of different clinical isolates, for example, can help researchers identify the common ancestors of the pathogens and determine the direction and timeline of the transmission of the disease and the pathogen between individuals within a population. In this study, we examined the existing phylogenomic analysis tools and their related core genome gene sets, and we added a phylogenomic fidelity criterion in selecting the core genes. We have developed a new pipeline and tool that relies on a new gene set, the VBCG. The phylogenomic analysis based on the VBGC gene set retains higher number of species, achieves higher speed, and higher resolution than those reliant on other core gene sets or the <italic>16S rRNA</italic> genes as demonstrated in the phylogenomic trees reconstructed for the common foodborne pathogens <italic>Escherichia coli</italic>.</p>
  </sec>
  <sec id="Sec14">
    <title>Conclusion</title>
    <p id="Par31">In conclusion, our research used a refined selection process that takes into account gene presence, single-copy ratios, and phylogenetic fidelity, and revealed that the 20 validated bacterial core genes (VBCG) provide high phylogenetic fidelity and resolution for phylogenomic analysis, enhancing our understanding of bacterial diversity and evolution. We have developed a streamlined tool capable of producing more accurate and reliable phylogenies, even at the strain level. Our findings highlight the importance of VBCG in the efficient typing and tracking of bacterial pathogens, a valuable tool in pathogenic studies. We have made our Python pipeline and graphic desktop app available on GitHub to ensure accessibility for other researchers in the field.</p>
  </sec>
  <sec id="Sec15">
    <title>Availability and requirements</title>
    <p id="Par32">Project name: Validated Bacterial Core Genes (VBCG).</p>
    <p id="Par33">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/tianrenmaogithub/vbcg">https://github.com/tianrenmaogithub/vbcg</ext-link></p>
    <p id="Par34">Operating system(s): Linux, Windows.</p>
    <p id="Par35">Programming language: Python.</p>
    <p id="Par36">License: GNU GPL v2.0.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec16">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="40168_2023_1705_MOESM1_ESM.docx">
            <caption>
              <p>
                <bold>Additional file 1.</bold>
              </p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>VBCG</term>
        <def>
          <p id="Par4">Validated Bacterial Core Genes</p>
        </def>
      </def-item>
      <def-item>
        <term>NCBI</term>
        <def>
          <p id="Par5">National Center for Biotechnology Information</p>
        </def>
      </def-item>
      <def-item>
        <term>EMBL-EBI</term>
        <def>
          <p id="Par6">European Molecular Biology Laboratory's European Bioinformatics Institute</p>
        </def>
      </def-item>
      <def-item>
        <term>RF</term>
        <def>
          <p id="Par7">Robinson Foulds</p>
        </def>
      </def-item>
      <def-item>
        <term>GUI</term>
        <def>
          <p id="Par8">Graphic User Interface</p>
        </def>
      </def-item>
      <def-item>
        <term>HPC</term>
        <def>
          <p id="Par9">High-performance computer</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors acknowledge the Food and Drug Administration (FDA) of the U.S. Department of Health and Human Services (HHS) for the support.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>B.I. and R.T. conceptualized and designed the project; R.T. conducted the data analysis, code writing and pipeline development. R.T. and B.I. wrote the manuscript. All authors have read and agreed to the published version of the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This publication is supported by the Food and Drug Administration (FDA) of the U.S. Department of Health and Human Services (HHS) (Grant No. 5U19FD005322) as part of an award totaling $3,856,000 with 0% financed with nongovernmental sources. The funding body did not play a role in the design of the study and collection, analysis and interpretation of data and in writing the manuscript. The findings and conclusions in this manuscript are those of the authors and do not necessarily represent the official views of, nor endorsement by, the FDA, HHS, U.S. Government or Illinois Institute of Technology. For more information, please visit <ext-link ext-link-type="uri" xlink:href="https://www.fda.gov/">https://www.fda.gov/</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The source code the pipeline VBCG can be accessed on GitHub. In addition, there is a graphic user interface (GUI) version of the pipeline for Windows users (<ext-link ext-link-type="uri" xlink:href="https://github.com/tianrenmaogithub/vbcg">https://github.com/tianrenmaogithub/vbcg</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par37">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par38">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par39">The authors declare no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Segerman B. The genetic integrity of bacterial species: the core genome and the accessory genome, two different stories. Front Cell Infect Microbiol. 2012;2. 10.3389/fcimb.2012.00116. Cited 27 Feb 2023.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Munro</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Tettelin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Dunning Hotopp</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Using core genome alignments to assign bacterial species</article-title>
        <source>mSystems</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>e00236</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1128/mSystems.00236-18</pub-id>
        <?supplied-pmid 30534598?>
        <pub-id pub-id-type="pmid">30534598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shakya</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ahmed</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Davenport</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Flynn</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>C-C</given-names>
          </name>
          <name>
            <surname>Chain</surname>
            <given-names>PSG</given-names>
          </name>
        </person-group>
        <article-title>Standardized phylogenetic and molecular evolutionary analysis applied to species across the microbial tree of life</article-title>
        <source>Sci Rep</source>
        <year>2020</year>
        <volume>10</volume>
        <fpage>1723</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-58356-1</pub-id>
        <?supplied-pmid 32015354?>
        <pub-id pub-id-type="pmid">32015354</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Na</surname>
            <given-names>S-I</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>YO</given-names>
          </name>
          <name>
            <surname>Yoon</surname>
            <given-names>S-H</given-names>
          </name>
          <name>
            <surname>Ha</surname>
            <given-names>S-M</given-names>
          </name>
          <name>
            <surname>Baek</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Chun</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>UBCG: Up-to-date bacterial core gene set and pipeline for phylogenomic tree reconstruction</article-title>
        <source>J Microbiol</source>
        <year>2018</year>
        <volume>56</volume>
        <fpage>280</fpage>
        <lpage>285</lpage>
        <pub-id pub-id-type="doi">10.1007/s12275-018-8014-6</pub-id>
        <?supplied-pmid 29492869?>
        <pub-id pub-id-type="pmid">29492869</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Na</surname>
            <given-names>S-I</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chun</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>UBCG2: Up-to-date bacterial core genes and pipeline for phylogenomic analysis</article-title>
        <source>J Microbiol</source>
        <year>2021</year>
        <volume>59</volume>
        <fpage>609</fpage>
        <lpage>615</lpage>
        <pub-id pub-id-type="doi">10.1007/s12275-021-1231-4</pub-id>
        <?supplied-pmid 34052993?>
        <pub-id pub-id-type="pmid">34052993</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ankenbrand</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>bcgTree: automatized phylogenetic tree building from bacterial core genomes</article-title>
        <source>Genome</source>
        <year>2016</year>
        <volume>59</volume>
        <fpage>783</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="doi">10.1139/gen-2015-0175</pub-id>
        <?supplied-pmid 27603265?>
        <pub-id pub-id-type="pmid">27603265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeffroy</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Brinkmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Delsuc</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Philippe</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Phylogenomics: the beginning of incongruence?</article-title>
        <source>Trends Genet</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>225</fpage>
        <lpage>231</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2006.02.003</pub-id>
        <?supplied-pmid 16490279?>
        <pub-id pub-id-type="pmid">16490279</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>A simple, fast, and accurate method of phylogenomic inference</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R151</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-10-r151</pub-id>
        <?supplied-pmid 18851752?>
        <pub-id pub-id-type="pmid">18851752</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Phylogenomic analysis of bacterial and archaeal sequences with AMPHORA2</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1033</fpage>
        <lpage>1034</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts079</pub-id>
        <?supplied-pmid 22332237?>
        <pub-id pub-id-type="pmid">22332237</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Creevey</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Doerks</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fitzpatrick</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Universally distributed single-copy genes indicate a constant rate of horizontal transfer</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e22099</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0022099</pub-id>
        <?supplied-pmid 21850220?>
        <pub-id pub-id-type="pmid">21850220</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dupont</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Rusch</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Yooseph</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lombardo</surname>
            <given-names>M-J</given-names>
          </name>
          <name>
            <surname>Alexander Richter</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Valas</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic insights to SAR86, an abundant and uncultivated marine bacterial lineage</article-title>
        <source>ISME J</source>
        <year>2012</year>
        <volume>6</volume>
        <fpage>1186</fpage>
        <lpage>1199</lpage>
        <pub-id pub-id-type="doi">10.1038/ismej.2011.189</pub-id>
        <?supplied-pmid 22170421?>
        <pub-id pub-id-type="pmid">22170421</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jospin</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Systematic identification of gene families for use as “Markers” for phylogenetic and phylogeny-driven ecological studies of bacteria and archaea and their major subgroups</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e77033</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0077033</pub-id>
        <?supplied-pmid 24146954?>
        <pub-id pub-id-type="pmid">24146954</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Niu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>3150</fpage>
        <lpage>3152</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts565</pub-id>
        <?supplied-pmid 23060610?>
        <pub-id pub-id-type="pmid">23060610</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Rinke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chuvochina</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chaumeil</surname>
            <given-names>P-A</given-names>
          </name>
          <name>
            <surname>Woodcroft</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>PN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recovery of nearly 8,000 metagenome-assembled genomes substantially expands the tree of life</article-title>
        <source>Nat Microbiol</source>
        <year>2017</year>
        <volume>2</volume>
        <fpage>1533</fpage>
        <lpage>1542</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-017-0012-7</pub-id>
        <?supplied-pmid 28894102?>
        <pub-id pub-id-type="pmid">28894102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finn</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Clements</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>HMMER web server: interactive sequence similarity searching</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>W29</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr367</pub-id>
        <?supplied-pmid 21593126?>
        <pub-id pub-id-type="pmid">21593126</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Profile hidden Markov models</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>755</fpage>
        <lpage>763</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/14.9.755</pub-id>
        <?supplied-pmid 9918945?>
        <pub-id pub-id-type="pmid">9918945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>MUSCLE: a multiple sequence alignment method with reduced time and space complexity</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>113</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-5-113</pub-id>
        <?supplied-pmid 15318951?>
        <pub-id pub-id-type="pmid">15318951</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castresana</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Selection of conserved blocks from multiple alignments for their use in phylogenetic analysis</article-title>
        <source>Mol Biol Evol</source>
        <year>2000</year>
        <volume>17</volume>
        <fpage>540</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a026334</pub-id>
        <?supplied-pmid 10742046?>
        <pub-id pub-id-type="pmid">10742046</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Dehal</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>FastTree 2 – approximately maximum-likelihood trees for large alignments</article-title>
        <source>PLoS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>e9490</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id>
        <?supplied-pmid 20224823?>
        <pub-id pub-id-type="pmid">20224823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Dehal</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>FastTree: computing large minimum evolution trees with profiles instead of a distance matrix</article-title>
        <source>Mol Biol Evol</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>1641</fpage>
        <lpage>1650</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp077</pub-id>
        <?supplied-pmid 19377059?>
        <pub-id pub-id-type="pmid">19377059</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sukumaran</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Holder</surname>
            <given-names>MT</given-names>
          </name>
        </person-group>
        <article-title>DendroPy: a Python library for phylogenetic computing</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1569</fpage>
        <lpage>1571</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq228</pub-id>
        <?supplied-pmid 20421198?>
        <pub-id pub-id-type="pmid">20421198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Foulds</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>Comparison of phylogenetic trees</article-title>
        <source>Math Biosci</source>
        <year>1981</year>
        <volume>53</volume>
        <fpage>131</fpage>
        <lpage>147</lpage>
        <pub-id pub-id-type="doi">10.1016/0025-5564(81)90043-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xi</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>The impact of missing data on species tree estimation</article-title>
        <source>Mol Biol Evol</source>
        <year>2016</year>
        <volume>33</volume>
        <fpage>838</fpage>
        <lpage>860</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msv266</pub-id>
        <?supplied-pmid 26589995?>
        <pub-id pub-id-type="pmid">26589995</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wiens</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Missing data and the design of phylogenetic analyses</article-title>
        <source>J Biomed Inform</source>
        <year>2006</year>
        <volume>39</volume>
        <fpage>34</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jbi.2005.04.001</pub-id>
        <?supplied-pmid 15922672?>
        <pub-id pub-id-type="pmid">15922672</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Keren</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Whittaker</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Farag</surname>
            <given-names>IF</given-names>
          </name>
          <name>
            <surname>Doudna</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Cate</surname>
            <given-names>JHD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-resolved metagenomics reveals site-specific diversity of episymbiotic CPR bacteria and DPANN archaea in groundwater ecosystems</article-title>
        <source>Nat Microbiol</source>
        <year>2021</year>
        <volume>6</volume>
        <fpage>354</fpage>
        <lpage>365</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-020-00840-5</pub-id>
        <?supplied-pmid 33495623?>
        <pub-id pub-id-type="pmid">33495623</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Hug</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Sharon</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Castelle</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unusual biology across a group comprising more than 15% of domain Bacteria</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>523</volume>
        <fpage>208</fpage>
        <lpage>211</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14486</pub-id>
        <?supplied-pmid 26083755?>
        <pub-id pub-id-type="pmid">26083755</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Microbiome</journal-id>
    <journal-id journal-id-type="iso-abbrev">Microbiome</journal-id>
    <journal-title-group>
      <journal-title>Microbiome</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2049-2618</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10631056</article-id>
    <article-id pub-id-type="pmid">37936197</article-id>
    <article-id pub-id-type="publisher-id">1705</article-id>
    <article-id pub-id-type="doi">10.1186/s40168-023-01705-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VBCG: 20 validated bacterial core genes for phylogenomic analysis with high fidelity and resolution</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tian</surname>
          <given-names>Renmao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Imanian</surname>
          <given-names>Behzad</given-names>
        </name>
        <address>
          <email>bimanian@iit.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.62813.3e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 7806</institution-id><institution>Institute for Food Safety and Health, </institution><institution>Illinois Institute of Technology, </institution></institution-wrap>Bedford Park, IL 60501 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/037t3ry66</institution-id><institution-id institution-id-type="GRID">grid.62813.3e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 7806</institution-id><institution>Food Science and Nutrition Department, </institution><institution>Illinois Institute of Technology, </institution></institution-wrap>Chicago, IL 60616 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>11</volume>
    <elocation-id>247</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Phylogenomic analysis has become an inseparable part of studies of bacterial diversity and evolution, and many different bacterial core genes have been collated and used for phylogenomic tree reconstruction. However, these genes have been selected based on their presence and single-copy ratio in all bacterial genomes, leaving out the gene's 'phylogenetic fidelity' unexamined.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">From 30,522 complete genomes covering 11,262 species, we examined 148 bacterial core genes that have been previously used for phylogenomic analysis. In addition to the gene presence and single-copy rations, we evaluated the gene's phylogenetic fidelity by comparing each gene's phylogeny with its corresponding <italic>16S rRNA</italic> gene tree. Out of the 148 bacterial genes, 20 validated bacterial core genes (VBCG) were selected as the core gene set with the highest bacterial phylogenetic fidelity. Compared to the larger gene set, the 20-gene core set resulted in more species having all genes present and fewer species with missing data, thereby enhancing the accuracy of phylogenomic analysis. Using <italic>Escherichia</italic> coli strains as examples of prominent bacterial foodborne pathogens, we demonstrated that the 20 VBCG produced phylogenies with higher fidelity and resolution at species and strain levels while <italic>16S rRNA</italic> gene tree alone could not.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">The 20 validated core gene set improves the fidelity and speed of phylogenomic analysis. Among other uses, this tool improves our ability to explore the evolution, typing and tracking of bacterial strains, such as human pathogens. We have developed a Python pipeline and a desktop graphic app (available on GitHub) for users to perform phylogenomic analysis with high fidelity and resolution.</p>
        <p id="Par500">
          <media xlink:href="40168_2023_1705_MOESM2_ESM.mp4" id="MOESM2">
            <caption>
              <p>Video Abstract</p>
            </caption>
          </media>
        </p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s40168-023-01705-9.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Phylogenomics</kwd>
      <kwd>Bacterial core genes</kwd>
      <kwd>Phylogenetic tree</kwd>
      <kwd>Pathogen typing</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par10">Bacterial pangenomes consist of the core genome, a set of genes present in all genomes within a clade, and the accessory genome, a set of genes found in one or more but not all members of the clade [<xref ref-type="bibr" rid="CR1">1</xref>]. While the core genome of a clade can be, and often is, different from that of another clade, it invariably contains highly conserved genes essential for the vital cellular functions of the members of that clade.</p>
    <p id="Par11">The core genome reflects the vertical accumulation of mutations on the conserved set of genes, and thus it can provide phylogenetic signals for assigning bacterial strains to their corresponding populations [<xref ref-type="bibr" rid="CR2">2</xref>]. Over the past decade, there has been a significant increase in research on bacterial core genes and their applications in phylogenomic analysis [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. Bacterial core genes are widely used for phylogenomic analysis due to a) their high level of conservation; and b) their widespread distribution among bacterial genomes. With the increased availability of massive amounts of genomic data and improved phylogenetic methods in recent years, phylogenomic analysis has become a popular approach to study bacterial evolution, diversity and ecology. Phylogenomic analysis using core genes [<xref ref-type="bibr" rid="CR7">7</xref>] has also been shown to be more accurate and robust than the traditional phylogenetic methods that use a single gene (e.g. <italic>16S rRNA</italic>) or multiple genes (e.g. MLST).</p>
    <p id="Par12">With different number of marker genes, often within a core gene set, different teams of researchers have developed tools and pipelines to simplify and streamline core gene phylogenomic analysis. In 2008, Wu et al. used 31 predefined marker genes to build a phylogenomic pipeline named AMPHORA [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. These 31 marker genes included those involved in glycolysis, DNA replication, translation etc. In 2011, Creevey et al. identified 40 bacterial core genes from 191 species [<xref ref-type="bibr" rid="CR10">10</xref>] and indicated that they had constant rate of horizontal transfer. In 2012, Dupont et al. investigated metagenome-assembled genomes (MAGs) of SAR86 (an abundant marine bacterial lineage) and estimated the genome completeness and contamination [<xref ref-type="bibr" rid="CR11">11</xref>] using 107 single-copy genes that were single-copy in &gt; 95% of bacterial genomes in the Comprehensive Microbial Resource database. In 2013, Wu et al. identified 114 bacterial core genes and multiple lineage-specific core gene sets (100 s – 1000 s) from 666 genomes by examining the genes’ universality, evenness and uniqueness [<xref ref-type="bibr" rid="CR12">12</xref>]. Later in 2016, Markus et al. developed a bioinformatic pipeline called bcgTree that used 107 essential single-copy core genes, identified by Dupont et al., as mentioned above, to reconstruct their phylogenetic history [<xref ref-type="bibr" rid="CR6">6</xref>]. This pipeline automatically extracted these genes using hidden Markov models and performed a partitioned maximum-likelihood analysis. In 2018, another group presented an up-to-date bacterial core gene set, named UBCG, which consisted of single-copy, homologous genes present in most known bacterial species [<xref ref-type="bibr" rid="CR4">4</xref>]. The 92 UBCG gene set was selected from 1,429 species covering 28 phyla with the criteria of 95% presence ratio and 95% single-copy ratio. The method was successfully used to infer phylogenomic relationships in <italic>Escherichia</italic> and related taxa, and it could be used at any taxonomic level for Bacteria. In 2021, the same group updated their bacterial core genes with more extensive genome data to UBCG2 [<xref ref-type="bibr" rid="CR5">5</xref>], which included 81 genes from 3,508 species spanning 43 phyla with the same criteria of 95% presence ratio and 95% single-copy ratio.</p>
    <p id="Par13">All the previous studies have utilized the gene presence and single-copy ratios to screen for the conserved, single-copy genes to build their phylogenies. However, this has led to an obvious shortcoming: the selected genes were not examined for their fidelity in reconstructing the phylogenetic tree, and thus they may carry incongruent evolutionary signals. A core genome phylogeny is reconstructed, like other multiple-gene trees, based on concatenated sequences of a set of selected genes. The inclusion of a gene, whose tree shows discordance with the phylogenies of the others genes in the gene set, lowers the evolutionary signal and thus the accuracy of topology and resolution of the resulting phylogeny. We, thus, propose that in order to select the genes for a core genome to reconstruct an accurate phylogeny, in addition to high presence and single-copy ratios, the genes should be examined for phylogenetic fidelity, a measure of congruity of the phylogenies of the genes within a gene set, as well. Here, we used the 16 s rRNA gene trees to evaluate and compare the phylogenetic fidelity of the candidate core genes and identified 20 high fidelity genes for bacterial phylogenomic analysis. We have developed a pipeline, VBCG, which uses the core gene set to build phylogenomic trees automatically with input of genomic sequences.</p>
    <sec id="Sec2">
      <title>Implementation</title>
      <sec id="Sec3">
        <title>Test genomes and candidate core genes</title>
        <p id="Par14">Genome information of prokaryotes was accessed Through the National Center for Biotechnology Information (NCBI) (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/genome/browse#!/prokaryotes/">https://www.ncbi.nlm.nih.gov/genome/browse#!/prokaryotes/</ext-link>) on Oct 11, 2022. In total, 30,552 finished bacterial genomes covering 11,262 species were selected and the protein sequences and rRNA genes were downloaded using a custom Python script with multiple processing. The rRNA files were then filtered to remove those with multiple <italic>16S rRNA</italic> genes that were less than 99% identical. For those with multiple copies that were &gt; 99% identical, the first copy was used as a representative. The <italic>16S rRNA</italic> genes were then clustered using CD-HIT (version 4.8.1) [<xref ref-type="bibr" rid="CR13">13</xref>] with a similarity threshold of 0.99 and an alignment coverage of 0.9 (-c 0.99 -G 0 -aL 0.9). The representative sequences (5506 sequences) were then randomly divided into 100 groups for further analysis.</p>
        <p id="Par15">We used a total of 148 genes collected from UBCG [<xref ref-type="bibr" rid="CR4">4</xref>], UBCG2 [<xref ref-type="bibr" rid="CR5">5</xref>] bac120 [<xref ref-type="bibr" rid="CR14">14</xref>] and bcgTree [<xref ref-type="bibr" rid="CR6">6</xref>] as candidate genes, which have been shown to have high presence and single-copy ratios in bacterial genomes. To acquire the HMM model files, PGAP HMM files and a PFAM file were downloaded from an NCBI website (<ext-link ext-link-type="uri" xlink:href="https://ftp.ncbi.nlm.nih.gov/hmm/current/">https://ftp.ncbi.nlm.nih.gov/hmm/current/</ext-link>) and the European Molecular Biology Laboratory's European Bioinformatics Institute (EMBL-EBI) website (<ext-link ext-link-type="uri" xlink:href="https://ftp.ebi.ac.uk/pub/databases/Pfam/current_release/">https://ftp.ebi.ac.uk/pub/databases/Pfam/current_release/</ext-link>), respectively, and the corresponding HMM models were retrieved using a custom Python script.</p>
        <p id="Par16">To annotate the candidate core genes, hmmscan of the package HMMER [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] was used to search all the protein sequences of the 5506 representative genomes against the acquired HMM models (with the trusted score cutoffs, –cut_tc), in parallel using Python package multiprocessing. The output file was parsed to assign the core genes to the proteins.</p>
      </sec>
      <sec id="Sec4">
        <title>Ubiquity and uniqueness of the core genes</title>
        <p id="Par17">The ubiquity and uniqueness of the core genes were evaluated by calculating the presence ratio and single-copy ratio of the core genes in the 5506 representative genomes. The presence ratio was defined by the number of genomes with each core gene divided by the total number of genomes. The single-copy ratio was defined by the number of genomes with only one copy of each core gene divided by total number of genomes. Only the core genes with both presence ratio and single-copy ratio &gt; 95%, respectively, were used for further analysis.</p>
      </sec>
      <sec id="Sec5">
        <title>Fidelity test for the candidate core genes</title>
        <p id="Par18">For each candidate core gene, all the proteins were divided into 50 groups corresponding to the grouping of <italic>16S rRNA</italic> genes. For each group, a phylogenetic tree was reconstructed for the <italic>16S rRNA</italic> gene and the core gene, respectively. The sequences were first aligned using MUSCLE (version 3.8.1551) [<xref ref-type="bibr" rid="CR17">17</xref>]. The multiple sequence alignment was then trimmed to remove terminal gaps. The trimmed alignment was then filtered to select conserved blocks using Gblocks (version 0.91b) [<xref ref-type="bibr" rid="CR18">18</xref>] with the minimum length of a block as three (-b4 = 3) and the maximum number of allowed gap positions as half (-b5 = h). The resulted alignment was then converted into format Phylip and was then fed to FastTree (version 2.1.10) [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] for phylogenetic tree reconstruction. The models gtr + gamma and lg + gamma were used for the <italic>16S rRNA</italic> gene and core gene protein sequences, respectively, with a bootstrap number of 100. The output trees in Newick format of <italic>16S rRNA</italic> gene and core genes of each group were compared using Dendropy (version 4.5.2) [<xref ref-type="bibr" rid="CR21">21</xref>] calculating the Robinson Foulds (RF) distance [<xref ref-type="bibr" rid="CR22">22</xref>]. The 20 core genes with the highest fidelity, also ensuring that &gt; 80% of the genomes include the whole gene set, were chosen as the validated bacterial core gene (VBCG) set.</p>
      </sec>
      <sec id="Sec6">
        <title>Comparison of multiple gene sets in fidelity</title>
        <p id="Par19">The 50 groups of genomes were used to compare the fidelity of the gene set VBCG with other gene sets. For each group, the core genes were aligned using MUSCLE and the terminal gaps were removed from the multiple alignments. Gblocks was then used to select conserved blocks. The processed alignments of the core genes were then concatenated, removing any taxa with &gt; 1 gene missing. The concatenated alignments were converted into Phylip files and fed to FastTree for phylogenetic tree reconstruction. The trees were then compared to the corresponding <italic>16S rRNA</italic> gene trees by calculating the RF distances.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results</title>
    <sec id="Sec8">
      <title>Ribosomal protein-encoding genes have high ubiquity and uniqueness in the Kingdom Bacteria</title>
      <p id="Par20">In total 30,522 rRNA gene and their corresponding protein sequences were downloaded from RefSeq database. After filtering those with multiple divergent copies, 29,781 sequences of <italic>16S rRNA</italic> genes were remained. After clustering the sequences at 99%, 5,506 representative genes were observed, which were then randomly divided into 50 groups (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>The workflow of the data analysis in this study. The filtering step indicated by an asterisk removes genomes with &gt; 2 copies of <italic>16S rRNA</italic> genes that are &lt; 99% identical. The clustering step indicated by two asterisks clusters <italic>16S rRNA</italic> genes using a cutoff of 99%</p></caption><graphic xlink:href="40168_2023_1705_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par21">The presence and single-copy ratios of the 148 core genes in the 5506 representative genomes were calculated (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). Interestingly, the 47 ribosomal proteins had much higher ubiquity (median presence ratios: 98.9%) and uniqueness (median single-copy ratios: 98.7%) than those of the other core genes (95.7% and 94.2%). Among the 50 proteins with top presence ratios, 39 were ribosomal proteins. We then selected the core genes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B, Table S<xref rid="MOESM1" ref-type="media">1</xref>) with both presence and single-copy ratios &gt; 95% for the fidelity and resolution tests (85 genes).<fig id="Fig2"><label>Fig. 2</label><caption><p>The presence and single-copy ratios of the candidate core genes in the Kingdom Bacteria. In the total core genes (<bold>A</bold>), the 47 ribosomal proteins had much higher ubiquity (median presence ratios: 98.9%) and uniqueness (median single-copy ratios: 98.7%) than those of the other core genes (95.7% and 94.2%). The dashed line demarcates the 95% ratio. In total 85 core genes (<bold>B</bold>) with both presence and single-copy ratios &gt; 95% were retained for the fidelity and resolution tests</p></caption><graphic xlink:href="40168_2023_1705_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec9">
      <title>The validated core gene tree showed the highest concordance with the 16S rRNA gene phylogeny</title>
      <p id="Par22">The 5,506 representative genes were randomly divided into 50 groups (~ 110 taxa in each group, Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The fidelity test compared the trees of the 50 groups for each of the 85 core genes with the corresponding <italic>16S rRNA</italic> gene trees based on Robinson-Foulds (RF) distance. The tests ranked the fidelity for each of the core genes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). The core gene phylogenies with the closest and farthest distances to their corresponding <italic>16S rRNA</italic> gene trees ranged from 115.9 ± 14.8 RF and 173.8 ± 9.1 RF, respectively, with the maximum being 50% higher the minimum. We then chose the top 20 genes with the highest fidelity (with lowest RF distances) as our candidate validated bacterial core gene (VBCG) set (Table S<xref rid="MOESM1" ref-type="media">2</xref>). A close examination of these 20 genes revealed that they were mostly involved in transcription (e.g. RNA polymerase) and translation (e.g. ribosomal proteins, translation initiation, elongation and termination).<fig id="Fig3"><label>Fig. 3</label><caption><p>The fidelity test of the validated core genes. The fidelity tests (<bold>A</bold>): The RF distances of the core genes trees from the corresponding <italic>16S rRNA</italic> gene trees. Each data point indicates the means and standard deviations of 50 trees (110 taxa each). The yellow dashed line indicates the top 20 genes with the highest fidelities in the left. The fidelity test and comparisons for phylogenies of multiple gene sets (<bold>B</bold>): The RF distances (brown boxes) of the trees based on the concatenated genes (top 20-gene set and all 85 gene set) from the corresponding <italic>16S rRNA</italic> gene trees of the 50 groups of genomes. The asterisk indicate significant difference from the top 20-gene set. The blue bars and right side y-axis show the taxon presence ratio of each gene set, which indicates the percentage of taxa with all members of the gene sets</p></caption><graphic xlink:href="40168_2023_1705_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par23">We then compared the phylogenetic fidelity of the top 20 gene (VBCG) set and that of all the 85 genes, by concatenating the genes and calculating the RF distances of the resulting trees from the corresponding <italic>16S rRNA</italic> gene trees of the 50 groups of genomes. As a result, the VBCG gene set had significantly lower RF distance from the corresponding <italic>16S rRNA</italic> gene trees (Paired Samples T test, <italic>p</italic> &lt; 1e-5, Fig. <xref rid="Fig3" ref-type="fig">3</xref>B) than those of the 85 gene set, which was 20% higher.</p>
    </sec>
    <sec id="Sec10">
      <title>The VBCG gene set resulted in lower missing data rate in the tree compared to that of all genes</title>
      <p id="Par24">The rationale behind selecting the top 20 genes is that these genes yield an acceptable missing data rate in the species for the phylogenetic tree. Because all the core genes have a presence ratio between 95 and 100%, only certain taxa will have all the genes of a given gene set. An advantage of using the 20-gene core set is its higher species data completeness. When comparing the 20-gene and 85-gene sets, 80.7% of species possess all 20 core genes, while only 19.3% have at least one missing gene (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). In contrast, for the larger gene set, 43% of species exhibit missing data. Given that increased missing data has been shown to reduce the accuracy of phylogenomic trees [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>], the 20-gene set offers enhanced accuracy in phylogenomic analysis due to its greater gene data presence.</p>
    </sec>
    <sec id="Sec11">
      <title>The VBCG gene set phylogeny had better resolution than that of the 16S rRNA gene</title>
      <p id="Par25">We compared the discriminative capability of VBCG set and the <italic>16S rRNA</italic> gene in tree reconstruction on the Genus <italic>Escherichia</italic> with an outgroup species from the genus <italic>Salmonella</italic>, both having member species that are commonly implicated in foodborne disease outbreaks. Our results showed that the <italic>16S rRNA</italic> gene tree had polytomies and could hardly discriminate between the species of <italic>Eschericha</italic> mainly because the <italic>16 s rRNA</italic> genes in the main group had a very high sequence similarity (&gt; 99.0% pairwise identities) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). The <italic>16 s rRNA</italic> tree also suffered from misclassification of the <italic>E. coli</italic> Str. IMT2125, which was mistakenly positioned outside the <italic>Eschericha</italic> genus. Various strains of the species <italic>E. coli,</italic> and <italic>E. fergusonii</italic> grouped together and were not well separated by species. Some of them are at the same branch, implying that they had not diverged. However, the VBCG tree showed a well-defined grouping by species, with different species nicely separated in different clades. The <italic>E. coli</italic> Str. IMT2125 was correctly positioned inside the genus. Even within each species clade, the strains were well separated with different branch lengths. In the VBCG tree, <italic>E. coli</italic> Str. 2020CK-00188 had branched within the <italic>E. fergusonii</italic> clade. While we cannot completely dismiss that this might be a mistake within the VBCG tree that begs further investigations, the likely explanation is that <italic>E. coli</italic> Str. 2020CK-00188 has been misclassified and it is not an <italic>E. coli</italic> species at all. Overall, our results indicated that a phylogeny based on the 20 VBCG genes resulted in higher resolutions (even at the strain level) compared with the corresponding tree based on <italic>16 s rRNA</italic> genes.<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparison between <italic>16S rRNA</italic> gene tree (<bold>A</bold>) and the VBCG tree (<bold>B</bold>) of concatenated core genes. The tree of the VBCG genes were reconstructed using the concatenated 20 genes of each genome. The asterisk in the <italic>16S rRNA</italic> gene tree indicates the main group of <italic>Escherichia</italic> species with pairwise identities &gt; 99.0%</p></caption><graphic xlink:href="40168_2023_1705_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>A pipeline and a desktop app for reconstructing phylogenomic trees automatically</title>
      <p id="Par26">We have built a pipeline to reconstruct phylogenomic trees with the input of assembled genomic sequences (Figure S<xref rid="MOESM1" ref-type="media">1</xref>). The pipeline first predicts the gene and protein sequences of the input genomes using Prodigal. The protein sequences are then used to identify the 20 VBCG genes with HMMER. Subsequently, the resulting VBCG genes of all the genomes are retrieved and each gene from all taxa is placed in its own single file. The genes are aligned using Muscle and the terminal gaps are removed from the multiple alignments. Gblocks is then used to select conserved blocks. The processed alignments of the core genes are then concatenated, removing any taxa with a certain number of missing genes (adjustable from one to six with four as the default). Any missing characters are replaced with question marks. The concatenated alignments are converted into Phylip files and fed into FastTree or RAxML for phylogenetic tree reconstruction.</p>
      <p id="Par27">The pipeline is written in Python 3.9, with the following dependencies: Bio &gt;  = 1.5.3, Muscle =  = 3.8, Pandas, Prodigal and HMMER. The command line-based pipeline can be run in Linux operating systems. We have also built a desktop graphic user interface (GUI) app (Figure S<xref rid="MOESM1" ref-type="media">2</xref>) on Windows for the users who have no access to a Linux system and a high-performance computer (HPC).</p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Discussion</title>
    <p id="Par28">With the increasing availability of genomic sequences in recent years, phylogenomic analysis has become a powerful critical tool for studying bacterial diversity and evolution. In the past, many marker genes and various core gene sets have been used for phylogenetic tree reconstruction [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. However, these genes have been selected based only on their presence and single-copy ratios in all bacterial genomes. The evolution of the genes within a genome is not uniform, and different genes evolve at different rates. Thus, single gene phylogenies, even from the same genome, could be quite different. The inclusion of the genes that are evolving at heterogeneous rates can weaken the phylogenetic signal, introduce noise, produce incorrect topologies, and eventually lower the resolution of the tree. In the previous methods and tools, the gene phylogenetic fidelity has not been considered, compared or tested in order to screen and select the highly concordant marker genes to include in a gene set (e.g. core genome set or its subsets) for phylogenomic analysis. Here, we have identified 20 validated bacterial core genes (VBCGs) that exhibit high fidelity and concordance in phylogeny with their corresponding <italic>16S rRNA</italic> gene trees. Moreover, we demonstrated that the VBCGs could produce superior resolution in discriminating species and strains compared to the widely used <italic>16S rRNA</italic> genes or other core gene sets. We have developed a Python pipeline and a desktop graphic app that enable users to perform phylogenomic analysis using the VBCGs with high fidelity and resolution.</p>
    <p id="Par29">In addition to a better resolution, the 20 VBCG also results in lower missing data rate and faster run-time in the phylogenomic analysis. Our 85 candidate bacterial core genes based upon the presence and single-copy ratios filtration are consistent with the UBCG2 [<xref ref-type="bibr" rid="CR5">5</xref>], which contains 81 core genes using the same ratios for filtration. However, our results have shown that the 85 core gene set without fidelity screening resulted in higher RF distances from the corresponding <italic>16 s rRNA</italic> trees than the 20 VBCG gene set. In terms of taxon coverage, the 85 core genes resulted in the inclusion of only 57% of all the species in the concatenated sequences, whereas the VBCG gene set included 80% of the species with all the 20 genes. Thus, VBCG can effectively reduce the missing data due to absence of one or more core genes in the phylogenomic tree reconstruction. In addition, the fewer number of core genes in the VBCG tool lowers the running time significantly compared to those with the larger gene sets.</p>
    <p id="Par30">Phylogenomic analysis has emerged as a powerful tool, for example, in tracking the origins of foodborne disease outbreaks. This technique involves the sequencing of whole genomes of bacterial isolates recovered from infected individuals, foods and related environments. These sequences are then used in computational analyses to reconstruct a phylogenomic tree that reveals the evolutionary relationships between these isolates. One of the main benefits of these analyses is their ability to accurately trace the spread of a particular bacterial strain across different geographical locations and over time. Phylogenomic analyses has become an indispensable tool in the hands of epidemiologists as well. A phylogenomic tree of different clinical isolates, for example, can help researchers identify the common ancestors of the pathogens and determine the direction and timeline of the transmission of the disease and the pathogen between individuals within a population. In this study, we examined the existing phylogenomic analysis tools and their related core genome gene sets, and we added a phylogenomic fidelity criterion in selecting the core genes. We have developed a new pipeline and tool that relies on a new gene set, the VBCG. The phylogenomic analysis based on the VBGC gene set retains higher number of species, achieves higher speed, and higher resolution than those reliant on other core gene sets or the <italic>16S rRNA</italic> genes as demonstrated in the phylogenomic trees reconstructed for the common foodborne pathogens <italic>Escherichia coli</italic>.</p>
  </sec>
  <sec id="Sec14">
    <title>Conclusion</title>
    <p id="Par31">In conclusion, our research used a refined selection process that takes into account gene presence, single-copy ratios, and phylogenetic fidelity, and revealed that the 20 validated bacterial core genes (VBCG) provide high phylogenetic fidelity and resolution for phylogenomic analysis, enhancing our understanding of bacterial diversity and evolution. We have developed a streamlined tool capable of producing more accurate and reliable phylogenies, even at the strain level. Our findings highlight the importance of VBCG in the efficient typing and tracking of bacterial pathogens, a valuable tool in pathogenic studies. We have made our Python pipeline and graphic desktop app available on GitHub to ensure accessibility for other researchers in the field.</p>
  </sec>
  <sec id="Sec15">
    <title>Availability and requirements</title>
    <p id="Par32">Project name: Validated Bacterial Core Genes (VBCG).</p>
    <p id="Par33">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/tianrenmaogithub/vbcg">https://github.com/tianrenmaogithub/vbcg</ext-link></p>
    <p id="Par34">Operating system(s): Linux, Windows.</p>
    <p id="Par35">Programming language: Python.</p>
    <p id="Par36">License: GNU GPL v2.0.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec16">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="40168_2023_1705_MOESM1_ESM.docx">
            <caption>
              <p>
                <bold>Additional file 1.</bold>
              </p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>VBCG</term>
        <def>
          <p id="Par4">Validated Bacterial Core Genes</p>
        </def>
      </def-item>
      <def-item>
        <term>NCBI</term>
        <def>
          <p id="Par5">National Center for Biotechnology Information</p>
        </def>
      </def-item>
      <def-item>
        <term>EMBL-EBI</term>
        <def>
          <p id="Par6">European Molecular Biology Laboratory's European Bioinformatics Institute</p>
        </def>
      </def-item>
      <def-item>
        <term>RF</term>
        <def>
          <p id="Par7">Robinson Foulds</p>
        </def>
      </def-item>
      <def-item>
        <term>GUI</term>
        <def>
          <p id="Par8">Graphic User Interface</p>
        </def>
      </def-item>
      <def-item>
        <term>HPC</term>
        <def>
          <p id="Par9">High-performance computer</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors acknowledge the Food and Drug Administration (FDA) of the U.S. Department of Health and Human Services (HHS) for the support.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>B.I. and R.T. conceptualized and designed the project; R.T. conducted the data analysis, code writing and pipeline development. R.T. and B.I. wrote the manuscript. All authors have read and agreed to the published version of the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This publication is supported by the Food and Drug Administration (FDA) of the U.S. Department of Health and Human Services (HHS) (Grant No. 5U19FD005322) as part of an award totaling $3,856,000 with 0% financed with nongovernmental sources. The funding body did not play a role in the design of the study and collection, analysis and interpretation of data and in writing the manuscript. The findings and conclusions in this manuscript are those of the authors and do not necessarily represent the official views of, nor endorsement by, the FDA, HHS, U.S. Government or Illinois Institute of Technology. For more information, please visit <ext-link ext-link-type="uri" xlink:href="https://www.fda.gov/">https://www.fda.gov/</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The source code the pipeline VBCG can be accessed on GitHub. In addition, there is a graphic user interface (GUI) version of the pipeline for Windows users (<ext-link ext-link-type="uri" xlink:href="https://github.com/tianrenmaogithub/vbcg">https://github.com/tianrenmaogithub/vbcg</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par37">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par38">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par39">The authors declare no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Segerman B. The genetic integrity of bacterial species: the core genome and the accessory genome, two different stories. Front Cell Infect Microbiol. 2012;2. 10.3389/fcimb.2012.00116. Cited 27 Feb 2023.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Munro</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Tettelin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Dunning Hotopp</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Using core genome alignments to assign bacterial species</article-title>
        <source>mSystems</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>e00236</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1128/mSystems.00236-18</pub-id>
        <?supplied-pmid 30534598?>
        <pub-id pub-id-type="pmid">30534598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shakya</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ahmed</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Davenport</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Flynn</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>C-C</given-names>
          </name>
          <name>
            <surname>Chain</surname>
            <given-names>PSG</given-names>
          </name>
        </person-group>
        <article-title>Standardized phylogenetic and molecular evolutionary analysis applied to species across the microbial tree of life</article-title>
        <source>Sci Rep</source>
        <year>2020</year>
        <volume>10</volume>
        <fpage>1723</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-58356-1</pub-id>
        <?supplied-pmid 32015354?>
        <pub-id pub-id-type="pmid">32015354</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Na</surname>
            <given-names>S-I</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>YO</given-names>
          </name>
          <name>
            <surname>Yoon</surname>
            <given-names>S-H</given-names>
          </name>
          <name>
            <surname>Ha</surname>
            <given-names>S-M</given-names>
          </name>
          <name>
            <surname>Baek</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Chun</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>UBCG: Up-to-date bacterial core gene set and pipeline for phylogenomic tree reconstruction</article-title>
        <source>J Microbiol</source>
        <year>2018</year>
        <volume>56</volume>
        <fpage>280</fpage>
        <lpage>285</lpage>
        <pub-id pub-id-type="doi">10.1007/s12275-018-8014-6</pub-id>
        <?supplied-pmid 29492869?>
        <pub-id pub-id-type="pmid">29492869</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Na</surname>
            <given-names>S-I</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chun</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>UBCG2: Up-to-date bacterial core genes and pipeline for phylogenomic analysis</article-title>
        <source>J Microbiol</source>
        <year>2021</year>
        <volume>59</volume>
        <fpage>609</fpage>
        <lpage>615</lpage>
        <pub-id pub-id-type="doi">10.1007/s12275-021-1231-4</pub-id>
        <?supplied-pmid 34052993?>
        <pub-id pub-id-type="pmid">34052993</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ankenbrand</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>bcgTree: automatized phylogenetic tree building from bacterial core genomes</article-title>
        <source>Genome</source>
        <year>2016</year>
        <volume>59</volume>
        <fpage>783</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="doi">10.1139/gen-2015-0175</pub-id>
        <?supplied-pmid 27603265?>
        <pub-id pub-id-type="pmid">27603265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeffroy</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Brinkmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Delsuc</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Philippe</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Phylogenomics: the beginning of incongruence?</article-title>
        <source>Trends Genet</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>225</fpage>
        <lpage>231</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2006.02.003</pub-id>
        <?supplied-pmid 16490279?>
        <pub-id pub-id-type="pmid">16490279</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>A simple, fast, and accurate method of phylogenomic inference</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R151</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-10-r151</pub-id>
        <?supplied-pmid 18851752?>
        <pub-id pub-id-type="pmid">18851752</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Phylogenomic analysis of bacterial and archaeal sequences with AMPHORA2</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1033</fpage>
        <lpage>1034</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts079</pub-id>
        <?supplied-pmid 22332237?>
        <pub-id pub-id-type="pmid">22332237</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Creevey</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Doerks</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fitzpatrick</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Universally distributed single-copy genes indicate a constant rate of horizontal transfer</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e22099</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0022099</pub-id>
        <?supplied-pmid 21850220?>
        <pub-id pub-id-type="pmid">21850220</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dupont</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Rusch</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Yooseph</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lombardo</surname>
            <given-names>M-J</given-names>
          </name>
          <name>
            <surname>Alexander Richter</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Valas</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic insights to SAR86, an abundant and uncultivated marine bacterial lineage</article-title>
        <source>ISME J</source>
        <year>2012</year>
        <volume>6</volume>
        <fpage>1186</fpage>
        <lpage>1199</lpage>
        <pub-id pub-id-type="doi">10.1038/ismej.2011.189</pub-id>
        <?supplied-pmid 22170421?>
        <pub-id pub-id-type="pmid">22170421</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jospin</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Systematic identification of gene families for use as “Markers” for phylogenetic and phylogeny-driven ecological studies of bacteria and archaea and their major subgroups</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e77033</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0077033</pub-id>
        <?supplied-pmid 24146954?>
        <pub-id pub-id-type="pmid">24146954</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Niu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>3150</fpage>
        <lpage>3152</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts565</pub-id>
        <?supplied-pmid 23060610?>
        <pub-id pub-id-type="pmid">23060610</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Rinke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chuvochina</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chaumeil</surname>
            <given-names>P-A</given-names>
          </name>
          <name>
            <surname>Woodcroft</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>PN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recovery of nearly 8,000 metagenome-assembled genomes substantially expands the tree of life</article-title>
        <source>Nat Microbiol</source>
        <year>2017</year>
        <volume>2</volume>
        <fpage>1533</fpage>
        <lpage>1542</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-017-0012-7</pub-id>
        <?supplied-pmid 28894102?>
        <pub-id pub-id-type="pmid">28894102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finn</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Clements</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>HMMER web server: interactive sequence similarity searching</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>W29</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr367</pub-id>
        <?supplied-pmid 21593126?>
        <pub-id pub-id-type="pmid">21593126</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Profile hidden Markov models</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>755</fpage>
        <lpage>763</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/14.9.755</pub-id>
        <?supplied-pmid 9918945?>
        <pub-id pub-id-type="pmid">9918945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>MUSCLE: a multiple sequence alignment method with reduced time and space complexity</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>113</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-5-113</pub-id>
        <?supplied-pmid 15318951?>
        <pub-id pub-id-type="pmid">15318951</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castresana</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Selection of conserved blocks from multiple alignments for their use in phylogenetic analysis</article-title>
        <source>Mol Biol Evol</source>
        <year>2000</year>
        <volume>17</volume>
        <fpage>540</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a026334</pub-id>
        <?supplied-pmid 10742046?>
        <pub-id pub-id-type="pmid">10742046</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Dehal</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>FastTree 2 – approximately maximum-likelihood trees for large alignments</article-title>
        <source>PLoS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>e9490</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id>
        <?supplied-pmid 20224823?>
        <pub-id pub-id-type="pmid">20224823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Dehal</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>FastTree: computing large minimum evolution trees with profiles instead of a distance matrix</article-title>
        <source>Mol Biol Evol</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>1641</fpage>
        <lpage>1650</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp077</pub-id>
        <?supplied-pmid 19377059?>
        <pub-id pub-id-type="pmid">19377059</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sukumaran</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Holder</surname>
            <given-names>MT</given-names>
          </name>
        </person-group>
        <article-title>DendroPy: a Python library for phylogenetic computing</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1569</fpage>
        <lpage>1571</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq228</pub-id>
        <?supplied-pmid 20421198?>
        <pub-id pub-id-type="pmid">20421198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Foulds</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>Comparison of phylogenetic trees</article-title>
        <source>Math Biosci</source>
        <year>1981</year>
        <volume>53</volume>
        <fpage>131</fpage>
        <lpage>147</lpage>
        <pub-id pub-id-type="doi">10.1016/0025-5564(81)90043-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xi</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>The impact of missing data on species tree estimation</article-title>
        <source>Mol Biol Evol</source>
        <year>2016</year>
        <volume>33</volume>
        <fpage>838</fpage>
        <lpage>860</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msv266</pub-id>
        <?supplied-pmid 26589995?>
        <pub-id pub-id-type="pmid">26589995</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wiens</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Missing data and the design of phylogenetic analyses</article-title>
        <source>J Biomed Inform</source>
        <year>2006</year>
        <volume>39</volume>
        <fpage>34</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jbi.2005.04.001</pub-id>
        <?supplied-pmid 15922672?>
        <pub-id pub-id-type="pmid">15922672</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Keren</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Whittaker</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Farag</surname>
            <given-names>IF</given-names>
          </name>
          <name>
            <surname>Doudna</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Cate</surname>
            <given-names>JHD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-resolved metagenomics reveals site-specific diversity of episymbiotic CPR bacteria and DPANN archaea in groundwater ecosystems</article-title>
        <source>Nat Microbiol</source>
        <year>2021</year>
        <volume>6</volume>
        <fpage>354</fpage>
        <lpage>365</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-020-00840-5</pub-id>
        <?supplied-pmid 33495623?>
        <pub-id pub-id-type="pmid">33495623</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Hug</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Sharon</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Castelle</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unusual biology across a group comprising more than 15% of domain Bacteria</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>523</volume>
        <fpage>208</fpage>
        <lpage>211</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14486</pub-id>
        <?supplied-pmid 26083755?>
        <pub-id pub-id-type="pmid">26083755</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
