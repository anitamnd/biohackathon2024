<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6961295</article-id>
    <article-id pub-id-type="publisher-id">1913</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1913-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HIFI: estimating DNA-DNA interaction frequency from Hi-C data at restriction-fragment resolution</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cameron</surname>
          <given-names>Christopher JF</given-names>
        </name>
        <address>
          <email>christopher.cameron@mail.mcgill.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Dostie</surname>
          <given-names>Josée</given-names>
        </name>
        <address>
          <email>josee.dostie@mcgill.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9555-860X</contrib-id>
        <name>
          <surname>Blanchette</surname>
          <given-names>Mathieu</given-names>
        </name>
        <address>
          <email>blanchem@cs.mcgill.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8649</institution-id><institution-id institution-id-type="GRID">grid.14709.3b</institution-id><institution>School of Computer Science, </institution><institution>McGill University, </institution></institution-wrap>Montreal, Canada </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8649</institution-id><institution-id institution-id-type="GRID">grid.14709.3b</institution-id><institution>Department of Biochemistry and Goodman Cancer Research Center, </institution><institution>McGill University, </institution></institution-wrap>Montreal, Canada </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>1</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>1</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>11</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>2</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>12</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Hi-C is a popular technique to map three-dimensional chromosome conformation. In principle, Hi-C’s resolution is only limited by the size of restriction fragments. However, insufficient sequencing depth forces researchers to artificially reduce the resolution of Hi-C matrices at a loss of biological interpretability. We present the Hi-C Interaction Frequency Inference (HIFI) algorithms that accurately estimate restriction-fragment resolution Hi-C matrices by exploiting dependencies between neighboring fragments. Cross-validation experiments and comparisons to 5C data and known regulatory interactions demonstrate HIFI’s superiority to existing approaches. In addition, HIFI’s restriction-fragment resolution reveals a new role for active regulatory regions in structuring topologically associating domains.</p>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Chromosome conformation capture</kwd>
      <kwd>Hi-C</kwd>
      <kwd>5C</kwd>
      <kwd>ChIA-PET</kwd>
      <kwd>Topologically associating domains</kwd>
      <kwd>subTADs</kwd>
      <kwd>Density estimation</kwd>
      <kwd>Markov random field</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Cells are complex, dynamic environments that require constant regulation of their genes to ensure survival. The advent of chromosome conformation capture (3C) technologies [<xref ref-type="bibr" rid="CR1">1</xref>], and recent advances in imaging techniques [<xref ref-type="bibr" rid="CR2">2</xref>], have led to an improved understanding of genome organization and its role in gene regulation [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. Hi-C [<xref ref-type="bibr" rid="CR5">5</xref>], a high-throughput derivative of 3C, provides an unparalleled view of three-dimensional (3D) genome organization by capturing all DNA-DNA contacts found within a population of cells. Hi-C has revealed different levels of genome organization, including the topologically associating domains (TADs [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>], subTADs [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]), and chromatin compartments [<xref ref-type="bibr" rid="CR5">5</xref>]. Yet, the potential for a more refined understanding of 3D genome organization remains largely untapped [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
    <p>In a Hi-C experiment, cross-linked chromatin is digested into fragments using a restriction enzyme (RE). Restriction fragments (RF) are then proximity-ligated to obtain a library of chimeric circular DNA. Paired-end sequencing and mapping of reads to a reference genome identifies interacting RFs and their frequency count. The data is conventionally stored as a pairwise read count matrix, RC, where RC<sub><italic>i</italic>,<italic>j</italic></sub> is the number of observed interactions (read-pair count) between genomic regions <italic>i</italic> and <italic>j</italic>. Despite the great sequencing depth of typical Hi-C experiments (200–500 million read pairs), RF resolution <italic>R</italic><italic>C</italic> matrices are extremely sparse, with most RF pairs being observed either zero or one time. This sparsity makes measurements of individual interaction frequencies (IFs) between RF pairs inherently stochastic and unreliable. Increasing sequencing coverage is a partial solution, but without improved bioinformatics analyses, the depth of sequencing needed to make reliable estimates of IFs for individual RFs is unmanageable. For this reason, Hi-C data is rarely studied at RF resolution, but instead binned at fixed intervals (e.g., every 25 kb). Unfortunately, reducing the resolution of a Hi-C IF matrix leads to difficulties in studying the interactions between fine-scale genomic elements such as promoters and enhancers.</p>
    <p>To improve the resolution of Hi-C data, recent protocols suggest digesting DNA more finely, either with a 4-cutter RE [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>] or DNAse I [<xref ref-type="bibr" rid="CR12">12</xref>], followed by binning at 1 to 5 kb. While these methodologies increase the resolution of a Hi-C IF matrix, they actually worsen the problem of sparsity and stochastic noise. For example, using a 4-cutter RE instead of a 6-cutter results in a 16-fold increase in the number of RFs and a 256-fold increase in RF pairs. This problem can be alleviated by using DNA capture technologies to concentrate sequencing on a predefined set of loci [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>], but this approach loses the ability to interrogate the whole-genome conformation in a hypothesis-free manner. Instead, new bioinformatics approaches have been proposed to detect individual significant contacts at high resolution from Hi-C data [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>], and a machine learning method has been introduced to smooth Hi-C matrices at 10-kb resolution [<xref ref-type="bibr" rid="CR17">17</xref>]. Dynamic binning was also proposed as a way to adjust bin size to ensure even read coverage across the genome, enabling locally higher resolution [<xref ref-type="bibr" rid="CR18">18</xref>]. However, no approach currently exists to obtain complete and accurate IF matrices at RF resolution. Such an approach would be valuable as it would allow researchers to revisit existing datasets and get more information out of them without having to change experimental protocols or generate more experimental data.</p>
    <p>Here, we introduce the Hi-C Interaction Frequency Inference (HIFI) algorithms, a family of computational approaches that provide reliable estimates of IFs at RF resolution. HIFI algorithms reduce stochastic noise, while retaining the highest possible resolution, by taking advantage of dependencies between neighboring RFs. We validate these algorithms via cross-validation and a comparison to observations made by independent chromosome conformation assays. We further demonstrate that HIFI improves the detection of contacts between promoters and enhancers. Finally, we illustrate additional benefits of high-resolution Hi-C data analysis by using it to study how active regulatory regions are involved in structuring TADs and subTADs.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <p>HIFI algorithms aim to reliably estimate Hi-C contact frequencies between all intra-chromosomal pairs of restriction fragments. The output of a HIFI algorithm is an IF matrix per chromosome, where each entry (<italic>i</italic>,<italic>j</italic>) corresponds to the IF of RFs <italic>i</italic> and <italic>j</italic>. As REs do not digest DNA uniformly along the genome, different rows/columns correspond to regions of different sizes. Depending on the RE used, the achievable resolution of Hi-C ranges on average from 434 bp (for a four-cutter such as MboI) to 3.7 kb (for a six-cutter such as HindIII). The high-resolution analysis of Hi-C data faces multiple challenges, of which the sparsity of the observed read-pair data is the most significant. For example, a Hi-C experiment with a very high sequencing depth of one billion read pairs will yield on average approximately 0.1 read pairs per intrachromosomal matrix entry for a six-cutter RE and less than 0.001 for a four-cutter RE. Even at a relatively short distance of 100 kb, the observed number of read pairs for a four-cutter RE almost never exceeds 1. This sparsity results in the observed read-pair count for a given RF pair being a poor (high-variance) estimator of the true IF, except for rare RF pairs located in regions of the Hi-C contact map where IF values are extremely high. All existing solutions to this problem, including the methods introduced in this paper, take advantage of the fact that IFs of neighboring entries in the IF matrix are strongly correlated. In particular, the most common approach to the resolution/accuracy trade-off is to artificially reduce the resolution by binning the raw data to fixed-size intervals (e.g., 25-kb bins). This lower resolution increases the number of reads per bin pair, and thus allows for a more reliable estimation of IF, but at the cost of a loss in biological interpretability. Importantly, no unique bin size is uniformly ideal for an entire IF matrix. Portions of an IF matrix where high IFs are present could support a high-resolution analysis, whereas others, corresponding to lower IF values, may require larger bins for accurate IF estimation.</p>
    <p>More specifically, the problem addressed here is the following: consider a Hi-C dataset <italic>H</italic> produced with a given restriction enzyme <italic>e</italic>. For a given chromosome, the raw outcome is stored in an <italic>n</italic>×<italic>n</italic> intrachromosomal matrix <italic>R</italic><italic>C</italic>, where <italic>n</italic> is the number of RFs produced by <italic>e</italic>, and RC<sub><italic>i</italic>,<italic>j</italic></sub> contains the number of read pairs mapped to RF pair (<italic>i</italic>,<italic>j</italic>). Our goal is to estimate as accurately as possible the true RF-level interaction frequency matrix, I<italic>F</italic><sub><italic>true</italic></sub>, which is the theoretical <italic>n</italic>×<italic>n</italic> IF matrix one would obtain if one were to sequence an infinitely large version of <italic>H</italic> to infinite depth (scaled for the total number of read pairs). I<italic>F</italic><sub><italic>true</italic></sub> is affected by a number of library, sequencing, and mapping biases that would need to be corrected in order to allow for proper biological interpretation; many such normalization techniques already exist for this task [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR21">21</xref>]. Our goal here is not to improve upon these techniques, but to work upstream and provide the most accurate estimate of I<italic>F</italic><sub><italic>true</italic></sub>.</p>
    <p>Four approaches are introduced and assessed (see the “<xref rid="Sec8" ref-type="sec">Methods</xref>” section for details), each taking as input matrix <italic>R</italic><italic>C</italic> and producing as output an estimate of I<italic>F</italic><sub><italic>true</italic></sub>:
<list list-type="order"><list-item><p>The commonly used fixed-binning approach, where the genome is first partitioned into bins containing a fixed number of kilobase (or, alternatively, a fixed number of RFs) and the estimated IF for a given bin pair is the total number of reads whose end points fall within that pair of genomic intervals.</p></list-item><list-item><p>A simple kernel density estimation (HIFI-KDE) approach, where the IF estimate at a given matrix entry is obtained as the average of surrounding entries, weighted using a two-dimensional Gaussian distribution with a fixed standard deviation (bandwidth).</p></list-item><list-item><p>An adaptive kernel density estimation (HIFI-AKDE) approach, where the bandwidth is chosen dynamically for each matrix entry in order to ensure that a sufficient number of read pairs is available for reliable IF estimation, while maximizing the resolution.</p></list-item><list-item><p>An approach based on Markov random fields (HIFI-MRF) where dependencies between neighboring cells are modeled and used to identify the maximum <italic>a</italic>
<italic>p</italic><italic>o</italic><italic>s</italic><italic>t</italic><italic>e</italic><italic>r</italic><italic>i</italic><italic>o</italic><italic>r</italic><italic>i</italic> estimate of I<italic>F</italic><sub><italic>true</italic></sub>.</p></list-item></list></p>
    <p>Assessing the accuracy of high-resolution IF inference algorithms is challenging because I<italic>F</italic><sub><italic>true</italic></sub> is unknown, as Hi-C datasets of infinite sequencing depths are not achievable. Instead, we consider two surrogates. First, we use a cross-validation approach from existing Hi-C data. Second, we assess the predictions against data produced by Chromosome Conformation Capture Carbon Copy (5C [<xref ref-type="bibr" rid="CR22">22</xref>]), a targeted amplification protocol that achieves a much higher read count per RF pair compared to Hi-C.</p>
    <sec id="Sec3">
      <title>Cross-validation of HIFI algorithms</title>
      <p>We used cross-validation to assess the accuracy of HIFI algorithms genome-wide. Here, a Hi-C read-pair dataset of high sequencing depth produced by Rao et al. [<xref ref-type="bibr" rid="CR23">23</xref>] from GM12878 cells using HindIII was first filtered to retain only high-confidence intrachromosomal read pairs. These read pairs were then randomly partitioned into an input set (containing 80% of the set of filtered read pairs, or 607,587,043 read pairs) and a test set (20%, or 151,979,454 read pairs) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). The input set is then further downsampled into 7 subsets ranging in size from 1 to 100% of the full input set. Mapping and tabulating read pairs at RF-level resolution yields a family of read count matrices: <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {RC_{input\_ 1}}$\end{document}</tex-math><mml:math id="M2"><mml:mstyle mathvariant="normal"><mml:mi>R</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">input_</mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math><inline-graphic xlink:href="13059_2019_1913_Article_IEq1.gif"/></alternatives></inline-formula>, <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {RC_{input\_ 2}}$\end{document}</tex-math><mml:math id="M4"><mml:mstyle mathvariant="normal"><mml:mi>R</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">input_</mml:mtext><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math><inline-graphic xlink:href="13059_2019_1913_Article_IEq2.gif"/></alternatives></inline-formula>, …, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathrm {RC_{input\_ 100}}$\end{document}</tex-math><mml:math id="M6"><mml:mstyle mathvariant="normal"><mml:mi>R</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">input_</mml:mtext><mml:mn>100</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math><inline-graphic xlink:href="13059_2019_1913_Article_IEq3.gif"/></alternatives></inline-formula>, and R<italic>C</italic><sub><italic>test</italic></sub>.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Cross-validation of fixed-binning and HIFI methodologies. <bold>a</bold> Schematic representation of cross-validation methodology to assess the accuracy of fixed-binning and proposed HIFI methodologies. <bold>b</bold> Cross-validation error for canonical fixed-binning approaches, for different bin sizes, as a function of coverage, see also Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1 for similar analyses of RF fixed binning, HIFI-KDE, and HIFI-AKDE. <bold>c</bold> Analysis of canonical fixed-binning error (relative to error with one RF per bin) across genomic distance between RF-pairs. No singular bin size performs best for all genomic distances. <bold>d</bold> Comparison of errors for different approaches. For fixed binning and HIFI-KDE, the optimal bin size or bandwidth was chosen separately for each coverage level. Nonetheless, HIFI-MRF outperforms all other approaches. <bold>e</bold> Comparison of errors (relative to error obtained with fixed binning using two RFs per bin) by genomic distance of RF pairs, using as input a set of 304M read pairs (50% of total training set). HIFI-MRF performs best across all distances</p></caption><graphic xlink:href="13059_2019_1913_Fig1_HTML" id="MO1"/></fig>
</p>
      <p>Each of the four inference algorithms are evaluated by their application to each of the downsampled input matrices to obtain a predicted IF matrix, I<italic>F</italic><sub><italic>pred</italic></sub>, which is then compared to the test matrix R<italic>C</italic><sub><italic>test</italic></sub> to obtain the sum of squared errors:
<disp-formula id="Equ1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{SSE}(\text{IF}_{\text{pred}}, \text{RC}_{test}) = \sum_{i&lt; j}(\text{IF}_{\text{pred}_{{i, j}}} - {\text{RC}}_{\text{test}_{{i,j}}})^{2}   $$ \end{document}</tex-math><mml:math id="M8"><mml:mtext>SSE</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mtext>IF</mml:mtext></mml:mrow><mml:mrow><mml:mtext>pred</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mtext>RC</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">test</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mtext>IF</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>pred</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">i, j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext>RC</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>test</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">i,j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><graphic xlink:href="13059_2019_1913_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Although R<italic>C</italic><sub><italic>test</italic></sub> is clearly not equal to I<italic>F</italic><sub><italic>true</italic></sub>, because R<italic>C</italic><sub><italic>train</italic></sub> and R<italic>C</italic><sub><italic>test</italic></sub> are sampled independently, the inference approach that minimizes SSE(I<italic>F</italic><sub><italic>pred</italic></sub>,R<italic>C</italic><sub><italic>test</italic></sub>) is also the one that minimizes SSE(I<italic>F</italic><sub><italic>pred</italic></sub>,I<italic>F</italic><sub><italic>true</italic></sub>), and hence, this serves as a valid basis for comparison.</p>
      <p>Figure <xref rid="Fig1" ref-type="fig">1</xref>b and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1A show that the accuracy of fixed-binning strategies improves with input set size, and that the optimal accuracy is obtained at different bin sizes for different input set sizes: large bins are ideal for low-coverage training data, whereas smaller bins are better with high-coverage data. More importantly, the fact that read pairs are highly non-uniformly distributed in RC matrices means that the ideal bin size differs depending on the local RC density. In particular, short-range contacts, which typically have higher RC values, can support high-resolution analyses (smaller bins), but those at longer ranges are best estimated with larger bins (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c and also Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1B for similar analyses for binning based on number of RFs rather than sequence size). The HIFI-KDE approach with a fixed bandwidth generally obtains better results (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1C), but suffers from the same type of problem, where optimal results are obtained with large bandwidth values for low-coverage regions and lower bandwidth values for high coverage regions. The HIFI-AKDE approach, where different bandwidth values are chosen at each cell based on the surrounding signal density, outperform the first two approaches (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1D), with optimal performance obtained using a <italic>MinimumCount</italic> value of 100 (see the “<xref rid="Sec8" ref-type="sec">Methods</xref>” section) throughout various coverage levels. HIFI-MRF performs the best overall (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1E), except at extremely low sequencing depths (i.e., 6–12M read pairs). Indeed, for typical sequencing depths (100–250M read pairs), HIFI-MRF improves IF estimation accuracy over the entire range of genomic distances (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e) producing estimates that are 5–40% more accurate than those obtained by fixed-binning approaches and 5% more accurate than HIFI-KDE and HIFI-AKDE, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2 for an example of a HIFI-MRF-processed HiC matrix and comparison to fixed-binning analysis. We attempted to use the same strategy to evaluate HiCPlus [<xref ref-type="bibr" rid="CR17">17</xref>], a machine learning technique for high-resolution analysis of Hi-C data, but found that the model did not perform well on non-bias-corrected Hi-C data for this analysis. Finally, to further demonstrate the robustness of HIFI-MRF’s IF estimates, 2 replicates of the mouse embryonic stem cell (mESC) Hi-C data produced by Bonev et al. (2017) [<xref ref-type="bibr" rid="CR24">24</xref>] were processed separately. HIFI-MRF produced contact maps that yielded improved correlations between replicates when compared to fixed-binning approaches (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3).</p>
    </sec>
    <sec id="Sec4">
      <title>Validation against 5C data</title>
      <p>5C has been used to study the conformation of moderate-size genomic regions (100 kb-5 Mb), including the beta-globin locus [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR25">25</xref>], the <italic>HOX</italic> clusters [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>], the <italic>CFTR</italic> locus [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>], and the <italic>Xist</italic> locus [<xref ref-type="bibr" rid="CR7">7</xref>]. 5C allows for a high sequencing depth measurement of the IF of each RF pair within given genomic regions, which improves the accuracy of RF-level IF estimates. As such, 5C data constitutes an excellent benchmark to compare different inference approaches. We analyzed data from two cell types for which both 5C and Hi-C data are available: (i) a 4-Mb region around the <italic>Xist</italic> gene (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, b) in mouse embryonic stem cells (mESC; Hi-C data from Dixon et al. [<xref ref-type="bibr" rid="CR6">6</xref>]; 5C data from Nora et al. [<xref ref-type="bibr" rid="CR7">7</xref>]), and (ii) a 2.7-Mb region around the <italic>CFTR</italic> gene (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4A,B) in human GM12878 cells (5C data from Smith et al. [<xref ref-type="bibr" rid="CR29">29</xref>]; Hi-C data from Rao et al. [<xref ref-type="bibr" rid="CR23">23</xref>]). In the GM12878 dataset, which has higher Hi-C sequencing depth (760M mapped read pairs genome-wide), the correlation between raw Hi-C and 5C data is moderate (Spearman <italic>ρ</italic><sub><italic>s</italic></sub> = 0.45; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4C), but it is improved by the application of HIFI-MRF (<italic>ρ</italic><sub><italic>s</italic></sub> = 0.71; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S4D,E and S5). In the mESC dataset, with lower Hi-C sequencing coverage (122M read pairs), the correlation of raw 5C against raw Hi-C data is relatively weak (<italic>ρ</italic><sub><italic>s</italic></sub> = 0.27; Fig. <xref rid="Fig2" ref-type="fig">2</xref>c) but improves to nearly the same level as in the first dataset from the application of HIFI-MRF (<italic>ρ</italic><sub><italic>s</italic></sub> = 0.69; Fig. <xref rid="Fig2" ref-type="fig">2</xref>d, e and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6). Strata-adjusted correlation coefficients (SCC) [<xref ref-type="bibr" rid="CR30">30</xref>], which factor out correlations induced by genomic distance dependencies, are also improved by the application of HIFI-MRF. Also note how, in both cases, the intricate structure of TADs, as well as some of the finer looping events, become apparent in the HIFI-MRF-processed Hi-C data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4D). The accuracy of HIFI-MRF estimates was found to be largely independent of the fragment bias correction algorithm applied, with the four normalization algorithms implemented in Juicer [<xref ref-type="bibr" rid="CR31">31</xref>] yielding similar results (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7).
<fig id="Fig2"><label>Fig. 2</label><caption><p>Recapitulation of 5C observations by HIFI-MRF. <bold>a</bold> IF matrix obtained by 5C of the 4.5-Mb locus surrounding the <italic>Xist</italic> gene in mouse embryonic stem cells [<xref ref-type="bibr" rid="CR7">7</xref>]. Note the use of true-size heatmaps, where the height (resp. width) of a row (resp. column) is proportional to the size of the RF it represents. <bold>b</bold> Raw, RF resolution Hi-C data for the same region [<xref ref-type="bibr" rid="CR6">6</xref>]. <bold>c</bold> Correlation of 5C and raw Hi-C data at RF resolution (Pearson <italic>r</italic><sub><italic>pb</italic></sub> = 0.16, <italic>p</italic> value &lt;10<sup>−16</sup>; Spearman <italic>ρ</italic><sub><italic>s</italic></sub> = 0.27, two-sided Student’s <italic>t</italic> test <italic>p</italic> value &lt;10<sup>−16</sup>); stratum-adjusted correlation coefficient (SCC) [<xref ref-type="bibr" rid="CR30">30</xref>] = 0.05). <bold>d</bold> IF matrix estimated by HIFI-MRF from the same Hi-C data. Observe the similarity to the 5C data in <bold>a</bold>. <bold>e</bold> Correlation of 5C and HIFI-MRF-processed Hi-C data at RF resolution (Pearson <italic>r</italic><sub><italic>pb</italic></sub> = 0.26, <italic>p</italic> value &lt;10<sup>−16</sup>; Spearman <italic>ρ</italic><sub><italic>s</italic></sub> = 0.69, <italic>p</italic> value &lt;10<sup>−16</sup>); SCC = 0.10)</p></caption><graphic xlink:href="13059_2019_1913_Fig2_HTML" id="MO2"/></fig>
</p>
      <p>Indeed, the application of HIFI-MRF to Hi-C data allows for the detection of regulatory contacts that could previously only be observed using 5C. For example, Nora et al. [<xref ref-type="bibr" rid="CR7">7</xref>] used 5C to observe a long-range interaction between <italic>Tsix</italic> and its transcriptional regulator—a large intervening non-coding RNA called “Linx”—occurring in female mice as a component of X inactivation. This interaction is very clearly observed in the HIFI-MRF-processed Hi-C data (Dixon et al. [<xref ref-type="bibr" rid="CR6">6</xref>]), whereas it is difficult to distinguish from background in raw or binned Hi-C data (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, b). These results demonstrate that HIFI-MRF can be used to analyze existing Hi-C datasets and potentially lead to novel discoveries at finer genomic scales.
<fig id="Fig3"><label>Fig. 3</label><caption><p>HIFI-MRF reveals fine-scale regulatory contacts in Hi-C data. Heatmap (<bold>a</bold>) and virtual 4C [<xref ref-type="bibr" rid="CR60">60</xref>, <xref ref-type="bibr" rid="CR61">61</xref>] plots based on raw, binned, or HIFI-MRF processed data (<bold>b</bold>) showing the long-range interaction between <italic>Tsix</italic> and its transcriptional regulator, <italic>Linx</italic>, on chromosome X of female mice as observed by Nora et al. [<xref ref-type="bibr" rid="CR7">7</xref>] using 5C. This interaction is more easily observed in HIFI-MRF data than in raw or binned Hi-C data</p></caption><graphic xlink:href="13059_2019_1913_Fig3_HTML" id="MO3"/></fig>
</p>
    </sec>
    <sec id="Sec5">
      <title>Validation against externally predicted chromatin contacts</title>
      <p>To more fully assess the extent to which HIFI-MRF-processed Hi-C data can be used to identify biologically relevant contacts, we asked whether it can also confirm chromatin interactions found through alternative approaches. Specifically, we considered a set of contacts identified by chromatin interaction analysis with paired-end tag sequencing (ChIA-PET [<xref ref-type="bibr" rid="CR32">32</xref>]) in GM12878 cells, bound either by CTCF (92,114 contacts [<xref ref-type="bibr" rid="CR33">33</xref>]), RNA polymerase II (PolII—192,394 contacts [<xref ref-type="bibr" rid="CR33">33</xref>]), or RAD21 (38,952 contacts [<xref ref-type="bibr" rid="CR34">34</xref>]). A set of computationally inferred contacts identified by correlation of DNAse I hypersensitivity signals across multiple cell types [<xref ref-type="bibr" rid="CR35">35</xref>], as well as cohesin-mediated interactions in GM12878 captured by Hi-C chromatin immunoprecipitation (HiChIP [<xref ref-type="bibr" rid="CR36">36</xref>] — 10,254 contacts), were also considered. For each set of contacts, a set of negative (control) fragment pairs were chosen by randomly re-pairing the same RFs. We then measured, for each range of genomic distance, the extent to which positive contacts could be distinguished from negative contacts on the basis of normalized HIFI-MRF Hi-C data, by measuring the area under the receiver operating characteristic curve (AUROC) of a univariate predictor using the RF pair’s inferred IF value as a predictive variable. Higher AUROC values indicate improved ability to distinguish positive from negative contacts. We observe that HIFI-MRF-processed Hi-C data allows significantly better detection of validated contacts compared to fixed-binning approaches, for all 5 datasets, across all genomic distance ranges, and both at low (61M read pairs obtained by downsampling; Fig. <xref rid="Fig4" ref-type="fig">4</xref>a–c and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S8A-C, S9A,B, S10A,B) and high (608M read pairs; Fig. <xref rid="Fig4" ref-type="fig">4</xref>d–f and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S8D-F, S9C,D, S10C,D) sequencing depths. Notably, the ability to distinguish positive from negative ChIA-PET contacts is relatively poor at short distances (&lt; 50 kb) because nearly all pairs have very high IF values, but improves considerably at longer range (300–500 kb). In contrast, contacts inferred based on DHS correlations are more difficult to identify overall (AUROC &lt; 0.6), becoming increasingly so at longer ranges. We speculate that this loss in detection power may be due to an increased error rate present in this benchmark dataset. Remarkably, the application of HIFI-MRF to low-coverage Hi-C data yields predictive power that is nearly as good as in the high-coverage dataset (compare panels Fig. <xref rid="Fig4" ref-type="fig">4</xref>a–c to <xref rid="Fig4" ref-type="fig">4</xref>d–f), suggesting that HIFI-MRF is able to identify functional contacts even in Hi-C data of moderate depth. Figure <xref rid="Fig4" ref-type="fig">4</xref> also includes the results for HiCPlus [<xref ref-type="bibr" rid="CR17">17</xref>] and HMRFBayes [<xref ref-type="bibr" rid="CR15">15</xref>], an approach for the detection of significant contacts at RF resolution (see the “<xref rid="Sec8" ref-type="sec">Methods</xref>” section). Overall, HIFI-MRF clearly outperforms these two approaches, although HMRFBayes performs nearly equally well for some low-coverage datasets (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a–c). The advantage of HIFI-MRF is particularly noticeable at short- to medium-range distances (&lt; 200 kb). Taken together, these results show that using HIFI-MRF to process Hi-C data improves the ability to delineate individual chromatin contacts.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Positive/negative RF contact delineation analysis. The ability of different HiC data analysis approaches to distinguish positive from negative (control) contacts is measured, for various data sets, using the area under the receiver operating characteristic curve (AUROC) for univariate predictors using as input the predicted IF values. <bold>a</bold>, <bold>d</bold> CTCF-mediated contacts identified by ChIA-PET [<xref ref-type="bibr" rid="CR33">33</xref>]. <bold>b</bold>, <bold>e</bold> RNAPII-mediated contacts identified by ChIA-PET [<xref ref-type="bibr" rid="CR33">33</xref>], <bold>c</bold>, <bold>f</bold> Inferred enhancer-promoter linkages based on DHS correlation [<xref ref-type="bibr" rid="CR35">35</xref>]. To allow for the comparison with HiCPlus and HMRFBayes, only contacts occurring on chromosomes 9 to 22, X, and Y, and within a distance of 1 Mb, are analyzed. Top (<bold>a</bold>–<bold>c</bold>) and bottom (<bold>d</bold>–<bold>f</bold>) rows represent the performance of the classifiers applied to Hi-C data of size 60.8M (10% of input set) and 608M (100% of input set), respectively. Genome-wide results for HIFI are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8. Similar results are observed for ChIA-PET RAD21 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9)</p></caption><graphic xlink:href="13059_2019_1913_Fig4_HTML" id="MO4"/></fig>
</p>
    </sec>
    <sec id="Sec6">
      <title>HIFI allows new insight into fine-level genome organization</title>
      <p>The high accuracy and resolution afforded by HIFI enables researchers to answer questions that are difficult to address with lower-resolution analyses of Hi-C data. Here, we illustrate one such application: the high-resolution analysis of TAD and subTAD boundaries. We used a modified directionality index (DI) score, originally introduced by Dixon et al. [<xref ref-type="bibr" rid="CR6">6</xref>] (see the “<xref rid="Sec8" ref-type="sec">Methods</xref>” section), to identify 5000 TAD boundaries in the HindIII-GM12878 Hi-C data. Boundary predictions were performed at two resolutions: (i) RF resolution using HIFI-MRF-processed data (3.7 kb on average; Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, top heatmap) and (ii) classical fixed-binning approach (16 RF ≈ 50 kb per bin; Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, bottom heatmap). Using ENCODE ChIP-seq datasets [<xref ref-type="bibr" rid="CR37">37</xref>], we quantified the occupancy of DNA-binding proteins relative to TAD boundaries. Consistent with previously reported observations and models [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>], CTCF (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b) showed a remarkable enrichment immediately outside of these boundaries, with sites on the plus strand sharply peaking at upstream TAD boundaries and those on the minus strand peaking at downstream boundaries. Similar enrichments at TAD boundaries are observed for RAD21, SMC3 (cohesin complex), YY1, and ZNF143 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S12), consistent with previous reports [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR40">40</xref>–<xref ref-type="bibr" rid="CR45">45</xref>]. Although the same phenomenon is visible in fixed-binning data, the peaks are much sharper (narrower and higher) in HIFI-MRF data, indicating that RF resolution allows more accurate calls of TAD boundaries.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Analysis of RF resolution TAD and subTAD boundaries in GM12878. Analyses were performed on both Hi-C data resulting from a HindIII (3.4 kb per RF on average (<bold>a</bold>–<bold>d</bold>)) and a MboI restriction digest (434 bp per RF on average (<bold>e</bold>–<bold>h</bold>), from Rao et al. [<xref ref-type="bibr" rid="CR23">23</xref>]). TAD and subTAD boundary predictions were made on IF matrices produced either by HIFI-MRF or a fixed-binning approach (16 RF per bin, i.e., approx. 50 kb per bin for HindIII and 7 kb per bin for MboI). <bold>a</bold> IF matrices produced by HIFI-MRF (top) and fixed binning (bottom) for a 4-Mb locus surrounding the NEK6 locus (chr9:124999244-128993971). <bold>b</bold>, <bold>f</bold> CTCF occupancy as a function of distance to the nearest TAD (<bold>b</bold>) or subTAD (<bold>f</bold>) boundary, separately for sites on the forward and reverse strands. Convergent CTCF sites are enriched at both TAD and subTAD boundaries. Shaded band indicate 95% confidence intervals of the estimate of the mean occupancy. <bold>c</bold>, <bold>g</bold> Coverage of active promoters (red) and strong enhancers (green) identified by ChromHMM, as a function of the distance to the nearest TAD (<bold>c</bold>) or subTAD (<bold>g</bold>) boundary. These regions are very strongly enriched just outside of subTAD boundaries, but less so around TAD boundaries. <bold>d</bold>, <bold>h</bold> Occupancy of two transcription factors, FOXM1 and NFIC, as a function of distance to the nearest TAD (<bold>b</bold>) or subTAD (<bold>f</bold>) boundary. While most TFs have an occupancy peak at TAD and subTAD boundaries, the extent of the enrichment within TADs varies from low (e.g., FOXM1) to high (e.g., NFIC). <bold>e</bold> IF matrices produced by HIFI-MRF (top) and fixed binning (bottom) for the 200-kb NEK6 locus (chr9:126879748-127079891). Regulatory regions identified in Huang et al. [<xref ref-type="bibr" rid="CR62">62</xref>] are marked SE (super enhancer), CE1 (conventional enhancer), and NEK6-TSS1 and NEK6-TSS2 (alternative promoters). Notice how all these regions lie between visible subTADs</p></caption><graphic xlink:href="13059_2019_1913_Fig5_HTML" id="MO5"/></fig>
</p>
      <p>We next studied the role of TAD boundaries in gene regulation, by looking at the distribution of active regulatory regions, as annotated by ChromHMM [<xref ref-type="bibr" rid="CR46">46</xref>] based on cell type-specific histone marks and DNA accessibility data. We observe a moderate enrichment for active promoters immediately outside TAD boundaries (only visible in HIFI-MRF processed data) and for strong enhancers within TADs. This trend is partially reflected in the occupancy profiles of several transcription factors (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S13). These transcription factors (in particular EBF1, EP300, IKZF1, MEF2A, MEF2C, and NFIC) exhibit a gradual enrichment toward the middle of TADs, together with a small but well-defined, CTCF-like peak just outside TAD boundaries. Some (e.g., FOXM1, IRF4, and RUNX3) show a more prominent peak at TAD boundaries (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S14A-C), while others (e.g., GABPA, MYC, and SIX5) demonstrate a depletion of occupancy within TADs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S14D-F). Notice that in many cases, the enrichment at TAD boundaries is only apparent based on HIFI-MRF data and would likely be missed using data binned at 50 kb resolution.</p>
      <p>We then repeated the analysis (HIFI-MRF followed by TAD boundary calls) on Hi-C data generated on the same cell line using the 4-cutter MboI restriction enzyme, with cut sites every 434 bp on average. Due to the size of the 4-cutter IF matrices involved, analyses were limited to RF pairs within a maximum distance of 1 Mb. The extremely high resolution of this dataset (Fig. <xref rid="Fig5" ref-type="fig">5</xref>e) provides opportunities to study fine structures such as subTADs [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>], which are difficult to study at lower resolutions. We used the HIFI-MRF MboI-GM12878 data, and the same modified DI approach to identify a set of 25,000 domain boundaries, of which approximately 2500 matched a HindIII-GM12878 TAD boundary (within 25 kb). The remaining ∼ 22,500 boundaries are not detected in the HindIII data and likely correspond to subTAD boundaries. Repeating the occupancy analysis against subTAD boundaries, the same enrichment for convergent CTCF sites is observed (Fig. <xref rid="Fig5" ref-type="fig">5</xref>f), but a very different picture emerges with respect to regulatory regions. Most notably, active promoters, and to a lesser extent strong enhancers, have a clear tendency to occupy regions that lie immediately outside subTADs (Fig. <xref rid="Fig5" ref-type="fig">5</xref>g; see also example in Fig. <xref rid="Fig5" ref-type="fig">5</xref>e). Indeed, the density of active promoters is approximately 30 times higher in the 1-kb region that precedes a subTAD boundary than in the 1-kb region that follows one. A similar enrichment is found in the inter-subTAD regions for FOXM1 and NFIC (Fig. <xref rid="Fig5" ref-type="fig">5</xref>h), and nearly all transcription factors studied. These results are consistent with a model where active regulatory regions play a key role in partitioning TADs into subTADs.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Discussion and conclusions</title>
    <p>Hi-C has become a commonly used approach to map 3D chromatin organization genome-wide. Since its introduction in 2009, the method has been updated many times to improve upon accuracy and resolution, or to target specific types of contacts. However, to date, using Hi-C data to accurately and systematically identify fine-scale chromosome contacts remains challenging, mostly because the sequencing depth required to achieve high-resolution contact maps is too great. To overcome the sparsity of contact information and increase the signal-to-noise ratio, Hi-C data is traditionally binned at fixed intervals along chromosomes to produce lower-resolution matrices [<xref ref-type="bibr" rid="CR10">10</xref>]. This lower-resolution representation of Hi-C data limits its application in studies of genomic regulatory networks or mechanisms of disease, which require robust, high-resolution 3D genomics data.</p>
    <p>Here, we introduced HIFI, a family of density estimation algorithms that allow for the observation of high-resolution (at the restriction-fragment scale) genomic contacts from Hi-C data of various sequencing depths. Our results show that HIFI algorithms, and in particular those based on Markov random fields (HIFI-MRF), provide highly accurate estimates of Hi-C interaction frequency at RF resolution and outperform classical fixed-binning approaches. We demonstrate that HIFI-MRF recapitulates contact data obtained by 5C and also captures interactions detected by ChIA-PET (Fig. <xref rid="Fig4" ref-type="fig">4</xref>) better than HiCPlus and HMRFBayes [<xref ref-type="bibr" rid="CR15">15</xref>]. Unlike the former, HIFI is easy to use and does not require special equipment (GPUs) to run within a reasonable time frame. HIFI also runs more than 100 times faster than the HMRFBayes. The high resolution and accuracy provided by HIFI allows analyses and discoveries that could not be made with lower-resolution Hi-C data. For example, HIFI allows for the identification of TAD boundaries at RF resolution, which provides a unique opportunity to finely delineate the role of different DNA-binding proteins. Benefiting from the RF resolution achieved with HIFI-MRF, we show that CTCF, RAD21, SMC3, and ZNF143 are enriched just outside both TAD and subTAD boundaries, and their sharp depletion within TADs may be a major contributor to the formation of TAD boundaries (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). In addition, we detail a set of transcription factors (based on ENCODE ChIP-seq data) that are found to be enriched at RFs labeled as TAD boundaries (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b, c). Finally, we highlight the new observation that active enhancers and promoters appear to provide structure to TADs, whereby DNA located between consecutive active regulatory regions form subTADs. This is obviously just an illustration of insights that can be gained from the analysis of Hi-C at high resolution. Others would include the use of HIFI-processed Hi-C data to further dissect the mechanisms of genome organization and to prioritize non-coding variants obtained from genome-wide association (GWAS) or expression quantitative trait loci (eQTL) studies, as is starting to be done with capture Hi-C data [<xref ref-type="bibr" rid="CR47">47</xref>].</p>
    <p>Our work also addresses the extent to which the accuracy of IF estimates degrade in response to lowering sequencing depths of a Hi-C library. The accuracy of HIFI (specifically KDE, AKDE, and MRF algorithms) was shown to reduce gracefully as coverage decreased (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>d—where the SSE drops logarithmically to the size of input data). The impact of coverage depth vs. accuracy of IF estimates depends on the biological question at hand. For example, TADs can clearly be identified quite accurately at low sequencing depth (although pinpointing their precise boundaries requires higher depth), while the detection of enhancer-promoter loops may require depths much higher than those made possible by HIFI. The results presented in Fig. <xref rid="Fig4" ref-type="fig">4</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S8-S10 demonstrate that, using HIFI, a low-coverage Hi-C data set (61M reads) can be used quite effectively to recapitulate ChIA-PET and HiChIP data, obtaining results only 3–5% worse (in terms of AUC) compared to a high-coverage data set (608M reads).</p>
    <p>We next studied the extent to which loop calling is facilitated by HIFI. To this end, we developed and incorporated into HIFI a simple loop-calling program based on the algorithm used in HiCCUPS [<xref ref-type="bibr" rid="CR23">23</xref>]. This program operates directly on HIFI-processed IF matrices rather than canonical binned normalized data, which HiCCUPS may only be applied to. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11 demonstrates that HIFI-processed Hi-C data results in a higher fraction of predicted loops supported by ChIA-PET data (CTCF and RNAPII) compared to HiCCUPS. This increase is especially notable within a distance range of 250 kb.</p>
    <p>Importantly, applying HIFI to a given Hi-C matrix is akin to simulating the sequencing of the same Hi-C library at extremely high depth. Several aspects of the Hi-C experimental protocol may introduce biases in the library, including the choice of restriction enzyme or ligation/fixation approach. In fact, our initial plan was to use Rao et al.’s very deeply sequenced, MboI-digest Hi-C data [<xref ref-type="bibr" rid="CR23">23</xref>] as a basis to evaluate the processing of their HindIII data for the same cell type GM12878. This plan was thwarted by the relative lack of similarity between the two data sets at high resolution. Nonetheless, while HIFI does not aim to correct these types of biases, it may actually help to reveal and study them.</p>
    <p>While HIFI provides a significant improvement over previous methodologies for handling Hi-C matrix sparsity, there remains several directions for possible improvements. First, HIFI is relatively slow, requiring roughly an hour per chromosome (at HindIII resolution), due to the size of the matrices analyzed and the complexity of MRF-based inference. Improved algorithms, multi-threading, and GPU-based computation are expected to provide significant speedups and are under development. These improvements will also allow the calculation of confidence intervals for estimated contacts frequencies, using Markov chain Monte Carlo sampling. Machine learning (ML) approaches, such as convolutional neural nets (CNN), offer an alternative to probabilistic approaches like HIFI-MRF. In recent work by Zhang et al. [<xref ref-type="bibr" rid="CR17">17</xref>], the authors showed that CNNs can be trained on Hi-C data to increase the resolution from 40 to 10 kb. Being model-free, ML approaches have the potential to discover and take advantage of unsuspected dependencies in the data. However, these models have yet to produce RF resolution data and thus remain limited in their ability to provide biological support as shown in this manuscript. In addition, being intrinsically complex models, prediction errors may occur in unexpected manners.</p>
    <p>The impact of fragment-specific biases on RF resolution Hi-C data also deserves further studies [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR48">48</xref>]. Although HIFI is not by itself a bias correction approach, improvements to RF resolution bias estimation, based for example on the work of Gilgenast and Phillips-Cremins [<xref ref-type="bibr" rid="CR49">49</xref>], will contribute to improving HIFI’s accuracy.</p>
    <p>In conclusion, the HIFI algorithms and software described in this manuscript allow for accurate, high-resolution analyses of 3D genome organization using Hi-C data. RF resolution Hi-C data allows for the recapitulation of observations made by 5C, a better separation of positive and control/background contacts, RF resolution TAD and subTAD boundary calling, and the identification of potential DNA-DNA contacts and TF enrichments that drive changes in chromatin architecture and gene regulation. By operating upstream of many Hi-C data analysis tools (e.g., loop, TAD, and compartment predictors as well as fragment bias normalization), HIFI can easily be inserted in a number of Hi-C data analysis pipelines, and we believe that the research community will be quick to take advantage of this family of new algorithms.</p>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <sec id="Sec9">
      <title>Hi-C read-pair pre-processing</title>
      <p>The publicly available Hi-C User Pipeline (HiCUP [<xref ref-type="bibr" rid="CR50">50</xref>]) v0.5.3 was used to process raw sequencing reads. HiCUP-mapped reads to the human (hg19) genome are also filtered to remove expected artifacts resulting from the sonication and ligation steps (e.g., circularized reads, reads with dangling ends) of the Hi-C protocol. Mapped reads were further filtered for a Mapping Quality Score (MAQ) greater than 30 [<xref ref-type="bibr" rid="CR19">19</xref>]. BAM/SAM-mapped read files were then converted (by our ’BAMtoSparseMatrix.py’ script) to a raw read-pair count matrix RC, stored using a sparse matrix TSV file format, before use with HIFI.</p>
    </sec>
    <sec id="Sec10">
      <title>HIFI algorithms</title>
      <p>The HIFI package is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/BlanchetteLab/HIFI">https://github.com/BlanchetteLab/HIFI</ext-link> [<xref ref-type="bibr" rid="CR51">51</xref>] and 10.5281/zenodo.3556842
[<xref ref-type="bibr" rid="CR52">52</xref>] under the GNU Lesser General Public License. It consists of a C++ program for IF estimation, together with Python scripts for input data formatting and the true-size IF matrix visualization. This section provides algorithmic details.</p>
      <sec id="Sec11">
        <title>Fragment-specific bias calculation</title>
        <p>Factors such as fragment size, GC content, and mappability affect the observed read count matrix RC. For each fragment <italic>i</italic> of chromosome <italic>c</italic>, we estimate this bias as:
<disp-formula id="Equ2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{bias}_{i}=\frac{\sum_{j}\text{RC}_{i,j}}{\sum_{i^{\prime},j^{\prime}}\text{RC}_{i^{\prime},j^{\prime}}}\cdot n_{\text{fragments}},   $$ \end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mtext>bias</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext>RC</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext>RC</mml:mtext></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>fragments</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2019_1913_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <italic>n</italic><sub>fragments</sub> is the number of RFs on that chromosome. Computed biases are used to obtain a normalized read count matrix nRC, where <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {nRC}_{i,j}=\frac {{\text {RC}}_{i,j}}{\text {bias}_{i}\cdot \text {bias}_{j}}$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mtext>nRC</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mtext>RC</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>bias</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mtext>bias</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2019_1913_Article_IEq4.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="Sec12">
        <title>Fixed-binning approach</title>
        <p>In the fixed-binning approach, the user specifies the value binSize, which is the number of consecutive RFs to be binned together. Defining bin<sub><italic>i</italic></sub>={<italic>j</italic>:⌊<italic>j</italic>/binSize⌋=⌊<italic>i</italic>/binSize⌋}, we then obtain the following estimate of interaction frequency for RF pair (<italic>i</italic>,<italic>j</italic>):
<disp-formula id="Equ3"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{IF}^{\text{FB}_{i,j}}=\frac{\sum_{a\in \text{bin}_{i}}\sum_{b\in \text{bin}_{j}}\text{nRC}_{a,b}}{\text{binSize}^{2}}.   $$ \end{document}</tex-math><mml:math id="M14"><mml:msup><mml:mrow><mml:mtext>IF</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>FB</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mtext>bin</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mtext>bin</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext>nRC</mml:mtext></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mtext>binSize</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2019_1913_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec13">
        <title>Fixed kernel density estimation</title>
        <p>This approach follows the standard two-dimensional kernel density estimation (KDE) procedure [<xref ref-type="bibr" rid="CR53">53</xref>, <xref ref-type="bibr" rid="CR54">54</xref>], where predicted IF for RF pair (<italic>i</italic>,<italic>j</italic>) is obtained as a weighted sum of the entries of RC surrounding (<italic>i</italic>,<italic>j</italic>), parameterized by bandwidth parameter <italic>h</italic>. Specifically, we set:
<disp-formula id="Equ4"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{IF}^{\text{KDE}_{i,j}} = \frac{\sum_{a=-3h}^{3h}\sum_{b=-3h}^{3h}w(a,b;h)\cdot \text{nRC}_{i+a,j+b}}{\sum_{a=-3h}^{3h}\sum_{b=-3h}^{3h}w(a,b;h)},   $$ \end{document}</tex-math><mml:math id="M16"><mml:msup><mml:mrow><mml:mtext>IF</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>KDE</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow></mml:munderover><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>;</mml:mo><mml:mi>h</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mtext>nRC</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow></mml:munderover><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>;</mml:mo><mml:mi>h</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2019_1913_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <inline-formula id="IEq5"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$w(a,b;h)=\frac {e^{-\frac {a^{2}+b^{2}}{2h^{2}}}} {\sqrt {2\pi h^{2}}}$\end{document}</tex-math><mml:math id="M18"><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>;</mml:mo><mml:mi>h</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2019_1913_Article_IEq5.gif"/></alternatives></inline-formula>. Near the edges of the matrix, values of <italic>a</italic> and <italic>b</italic> such that indices (<italic>i</italic>+<italic>a</italic>,<italic>j</italic>+<italic>b</italic>) fall outside the matrix are excluded from the sums of both the numerator and denominator.</p>
      </sec>
      <sec id="Sec14">
        <title>Adaptive kernel density estimation</title>
        <p>This approach is similar to the fixed KDE, except that the value of the bandwidth parameter <italic>h</italic> is chosen separately for each pair (<italic>i</italic>,<italic>j</italic>). Specifically, we choose <italic>h</italic><sub><italic>i</italic>,<italic>j</italic></sub> to be the smallest value such that:
<disp-formula id="Equ5"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{cov}_{i,j}=\sum_{a=-3h}^{3h}\sum_{b=-3h}^{3h}{\text{RC}}_{i+a,j+b}\geq \text{MinimumCount},   $$ \end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mtext>cov</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mtext>RC</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mtext>MinimumCount</mml:mtext><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2019_1913_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where “MinimumCount” is a user-defined parameter (we find the MinimumCount = 100 works well in practice and use this value as the default). In other words, the regions of the matrix that tend to have larger RC values are estimated using smaller bandwidths (i.e., higher resolution), whereas those that are more sparse use larger bandwidths. HIFI-AKDE results in a fine resolution in dense regions and a lower resolution in sparser areas of the matrix. In order to speed up the computation of <italic>h</italic><sub><italic>i</italic>,<italic>j</italic></sub>, we use a pre-computed cumulative matrix, cumRC, where:
<disp-formula id="Equ6"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{cumRC}_{i,j}=\sum_{a=1}^{i}\sum_{b=1}^{j}\text{RC}_{a,b},   $$ \end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mtext>cumRC</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mtext>RC</mml:mtext></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2019_1913_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>which allows the calculation of cov<sub><italic>i</italic>,<italic>j</italic></sub> in constant time:
<disp-formula id="Equa"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \text{cov}_{i,j} = &amp; \ \text{cumRC}_{i+3h,j+3h}-\text{cumRC}_{i+3h,j-3h}\\ &amp; -\text{cumRC}_{i-3h,j+3h}+\text{cumRC}_{i-3h,j-3h} \end{array} $$ \end{document}</tex-math><mml:math id="M24"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mtext>cov</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mtext>cumRC</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext>cumRC</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext>cumRC</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>cumRC</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1913_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec15">
        <title>Markov random field estimation</title>
        <p>A Markov random field (MRF) describes a set of random variables interconnected via a lattice of dependencies. Let us denote by <inline-formula id="IEq6"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}\text {IF}^{\text {MRF}_{i, j}}$\end{document}</tex-math><mml:math id="M26"><mml:msup><mml:mrow><mml:mtext>IF</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>MRF</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2019_1913_Article_IEq6.gif"/></alternatives></inline-formula> the latent IF value we aim to estimate at position (<italic>i</italic>,<italic>j</italic>). We model dependencies between the neighboring cells using a log-normal distribution:
<disp-formula id="Equ7"><label>1</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \log(\text{IF}^{\text{MRF}_{i,j}}) \sim \mathcal{N}\left(\mu=\log(\text{MedNeigh}_{i,j}),\sigma_{i,j}^{2}\right),  $$ \end{document}</tex-math><mml:math id="M28"><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mtext>IF</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>MRF</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mtext>MedNeigh</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2019_1913_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where MedNeigh<sub><italic>i</italic>,<italic>j</italic></sub> is the median of the eight IF<sup>MRF</sup> cells surrounding cell (<italic>i</italic>,<italic>j</italic>). We chose to model this dependency using the median instead of the mean of the neighbors because it allows for sharper transitions regions such as TAD boundaries. The value of <inline-formula id="IEq7"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{i,j}^{2}$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1913_Article_IEq7.gif"/></alternatives></inline-formula> is set to <italic>α</italic>· logMedNeigh<sub><italic>i</italic>,<italic>j</italic></sub>). <italic>α</italic> determines the level of dependency between adjacent cells. A small <italic>α</italic> value results in a predicted IF matrix that is very smooth, whereas larger values result in bumpier or less smooth matrices. The value used here (<italic>α</italic>=0.2) was chosen via a grid search to maximize the likelihood of a left-out subset of the training data (validation set). However, HIFI-MRF is quite insensitive to this hyperparameter as the prior it defines is weak compared to the data itself.</p>
        <p>We model the dependency between the observed read count RC<sub><italic>i</italic>,<italic>j</italic></sub> and the estimated true IF value I<italic>F</italic><sup><italic>M</italic><italic>R</italic><italic>F</italic></sup><sub><italic>i</italic>,<italic>j</italic></sub> using a Poisson distribution:
<disp-formula id="Equ8"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{RC}_{i,j}\sim \text{Poisson}\left(\lambda=\mathrm{IF^{MRF}}_{i,j}\cdot \text{bias}_{i}\cdot \text{bias}_{j}\right).   $$ \end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mtext>RC</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>I</mml:mi><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">MRF</mml:mtext></mml:mrow></mml:msup></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mtext>bias</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mtext>bias</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2019_1913_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>HIFI also supports the use of a negative binomial distribution to model RC from IF, to allow for increased dispersal of RC values via a user-defined multiplier of variance. We then seek the matrix I<italic>F</italic><sup><italic>M</italic><italic>R</italic><italic>F</italic></sup> that maximizes Pr[RC,I<italic>F</italic><sup><italic>M</italic><italic>R</italic><italic>F</italic></sup>]= Pr[I<italic>F</italic><sup><italic>M</italic><italic>R</italic><italic>F</italic></sup>]· Pr[RC∣I<italic>F</italic><sup><italic>M</italic><italic>R</italic><italic>F</italic></sup>]. We first initialize the I<italic>F</italic><sup><italic>M</italic><italic>R</italic><italic>F</italic></sup> matrix using the output of the HIFI-AKDE algorithm. We then optimize I<italic>F</italic><sup><italic>M</italic><italic>R</italic><italic>F</italic></sup> using iterated conditional mode (ICM) [<xref ref-type="bibr" rid="CR55">55</xref>] algorithm. Each iteration involves revising the value of each entry I<italic>F</italic><sup><italic>M</italic><italic>R</italic><italic>F</italic></sup><sub><italic>i</italic>,<italic>j</italic></sub> so as to maximize the joint probability of I<italic>F</italic><sup><italic>M</italic><italic>R</italic><italic>F</italic></sup> and RC. Revising the value of I<italic>F</italic><sup><italic>M</italic><italic>R</italic><italic>F</italic></sup><sub><italic>i</italic>,<italic>j</italic></sub> only alters the probability calculation at position <italic>i</italic>,<italic>j</italic> and the eight neighboring cells (because their median may have changed), and thus probability calculations can be limited to that portion of the matrix. Because of the use of the median (rather than the mean), the joint probability function is not differentiable. Instead, the update to I<italic>F</italic><sup><italic>M</italic><italic>R</italic><italic>F</italic></sup><sub><italic>i</italic>,<italic>j</italic></sub> is performed by grid search over a small range of multiplicative factors. Convergence is usually achieved in five to ten iterations over the entire matrix.</p>
        <p>Despite using the median rather than the mean to model inter-cell dependencies, some bleed-in effect is observed at TAD boundaries. To prevent those, we designed an approach where the nRC matrix is first scanned to identify sharp horizontal or vertical transitions characteristic of TAD boundaries. Horizontal boundaries are defined by a row index <italic>i</italic> and a pair of column indices <italic>j</italic> and <italic>j</italic><sup>′</sup> and will be set if the distribution of nRC values in <inline-formula id="IEq8"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {nRC}_{i, j\ldots j^{\prime }}$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mtext>nRC</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>…</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1913_Article_IEq8.gif"/></alternatives></inline-formula> differs significantly from that in <inline-formula id="IEq9"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {nRC}_{i+1, j\dots j^{\prime }}$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mtext>nRC</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>…</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1913_Article_IEq9.gif"/></alternatives></inline-formula>, as determined by a Kolmogorov-Smirnov test. More precisely, boundaries are set greedily, starting with the most significant boundary matrix-wide, and iteratively adding more boundaries, provided they do not overlap previously set boundaries, until the KS statistic falls below a user-defined threshold (the value of 1.5 was used here). Vertical boundaries are symmetrical to horizontal boundaries. Boundaries are then used in the HIFI-MRF model to prevent certain neighbors from contributing to the neighborhood median of a given cell. Specifically, cells (<italic>i</italic><sup>′</sup>,<italic>j</italic><sup>′</sup>) that sit on the opposite side of a boundary from cell (<italic>i</italic>,<italic>j</italic>) are excluded from the neighborhood of (<italic>i</italic>,<italic>j</italic>).</p>
      </sec>
      <sec id="Sec16">
        <title>Output matrices</title>
        <p>HIFI can produce either a normalized or non-normalized output. Non-normalized outputs are obtained as <inline-formula id="IEq10"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}\text {IF}^{\text {MRF}_{i, j}} \cdot \text {bias}_{i} \cdot \text {bias}_{j}$\end{document}</tex-math><mml:math id="M38"><mml:msup><mml:mrow><mml:mtext>IF</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>MRF</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mtext>bias</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mtext>bias</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1913_Article_IEq10.gif"/></alternatives></inline-formula>. In this manuscript, normalized outputs were used throughout, except for the cross-validation experiment.</p>
      </sec>
      <sec id="Sec17">
        <title>Conversion between fixed and restriction fragment resolutions</title>
        <p>HIFI operates at RF resolution, whereas other approaches operate at fixed resolutions (e.g., 5, 25, or 50 kb). To convert from fixed to RF resolution, we tested three alternatives: the “direct” scheme, which assigns each restriction fragment the frequency of the fixed bin that their 3 <sup>′</sup> end resides within; (ii) the “counts” scheme, which divides a fixed bin’s interaction frequency by the number of 3 <sup>′</sup> fragment ends found within it and then assigns this value to each of those fragments; (iii) the “weighted” scheme, which determines the proportion of each fragment that overlaps with a given fixed bin, then assigns each fragment its relative proportion of that bin’s interaction frequency. The “direct” conversion scheme was found to be the most robust and perform more consistently across datasets and is the one that was used throughout the paper.</p>
      </sec>
    </sec>
    <sec id="Sec18">
      <title>Alternative approaches</title>
      <p>The source code for HiCPlus [<xref ref-type="bibr" rid="CR17">17</xref>] was obtained from <ext-link ext-link-type="uri" xlink:href="https://github.com/zhangyan32/HiCPlus">https://github.com/zhangyan32/HiCPlus</ext-link>. Models were trained on Hi-C data from chromosomes 1–8 at 10 kb resolution, within a range of 2 Mb, as recommended. Input and target contact frequencies were obtained from input set and test RC matrices, respectively. Models were provided 100 epochs (10 times more than recommended) to converge while ensuring overfitting did not occur.</p>
      <p>HMRFBayes [<xref ref-type="bibr" rid="CR15">15</xref>] was obtained from <ext-link ext-link-type="uri" xlink:href="http://www.unc.edu/~xuzheng/HMRFHiCFast/tutorial.php">http://www.unc.edu/~xuzheng/HMRFHiCFast/tutorial.php</ext-link>. The HMRFBayes program was provided the observed and expected contact frequencies for paired restriction fragments within 1-Mb bins along chromosomes 9-X, where the expected contact frequency was calculated as follows:
<disp-formula id="Equ9"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{Expected}_{i,j} = \frac{\text{TotalReadRow}_{i}\cdot \text{TotalReadColumn}_{j}}{\text{TotalReadPairInMatrix}}   $$ \end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mtext>Expected</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mtext>TotalReadRow</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mtext>TotalReadColumn</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext>TotalReadPairInMatrix</mml:mtext></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2019_1913_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec19">
      <title>Chromatin loop calling using HIFI data</title>
      <p>Loop calling of HIFI-processed Hi-C data was performed using an algorithm similar to HiCCUPS [<xref ref-type="bibr" rid="CR23">23</xref>]. We refer the reader to Fig. <xref rid="Fig3" ref-type="fig">3</xref>a and Supplementary material section VI.a.3 of Rao et al. [<xref ref-type="bibr" rid="CR23">23</xref>]. Here, authors of [<xref ref-type="bibr" rid="CR23">23</xref>] define a distance-normalized IF matrix IFnorm as:
<disp-formula id="Equ10"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\begin{aligned} \text{IFnorm}(i,j) = \frac{\text{IF}(i,j)}{\text{mean}\{\text{IF}(a,b): \lfloor\frac{\text{pos}(b)-\text{pos}(a)}{10,000}\rfloor = \lfloor\frac{\text{pos}(j)-\text{pos}(i)}{1000}\rfloor\}}  \end{aligned}}  $$ \end{document}</tex-math><mml:math id="M42"><mml:mtable><mml:mtr><mml:mtd><mml:mtext>IFnorm</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>IF</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mtext>mean</mml:mtext><mml:mo>{</mml:mo><mml:mtext>IF</mml:mtext><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo><mml:mo>:</mml:mo><mml:mo>⌊</mml:mo><mml:mfrac><mml:mrow><mml:mtext>pos</mml:mtext><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mtext>pos</mml:mtext><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mfrac><mml:mo>⌋</mml:mo><mml:mo>=</mml:mo><mml:mo>⌊</mml:mo><mml:mfrac><mml:mrow><mml:mtext>pos</mml:mtext><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mtext>pos</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1000</mml:mn></mml:mrow></mml:mfrac><mml:mo>⌋</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1913_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where pos(<italic>a</italic>) is the genomic position at the end of RF <italic>a</italic>. Like HiCCUPS, HIFI’s loop-calling algorithm involves two parameters <italic>p</italic> (peak size) and <italic>w</italic> (window size), both measured in bp, with <italic>p</italic>&lt;<italic>w</italic>. For each cell (<italic>i</italic>,<italic>j</italic>) in the HIFI-processed IF matrix at RF resolution, the <italic>peak</italic> around (<italic>i</italic>,<italic>j</italic>) is defined as the submatrix encompassing region [pos(<italic>i</italic>)−<italic>p</italic>..pos(<italic>i</italic>)+<italic>p</italic>]×[pos(<italic>j</italic>)−<italic>p</italic>..pos(<italic>j</italic>)+<italic>p</italic>]. Note that since the size of this submatrix is expressed in bp, the number of cells it contains can vary, depending on the size of the RFs. The average IFnorm value <italic>P</italic>(<italic>i</italic>,<italic>j</italic>) in the peak is then calculated. As with HiCCUPS, <italic>P</italic>(<italic>i</italic>,<italic>j</italic>) is compared to the average IF value found in several types of flanking regions, including (i) <italic>D</italic>(<italic>i</italic>,<italic>j</italic>)—the average IFnorm in the “donut” of size <italic>w</italic> around (<italic>i</italic>,<italic>j</italic>), (ii) <italic>H</italic>(i,j)—the average IFnorm in the left and right flanks of (<italic>i</italic>,<italic>j</italic>), (iii) <italic>V</italic>(<italic>i</italic>,<italic>j</italic>)—the average IFnorm in the top and bottom flanks of (<italic>i</italic>,<italic>j</italic>), and (iv) <italic>B</italic><italic>L</italic>(<italic>i</italic>,<italic>j</italic>)—the average score in the region to the bottom left of (<italic>i</italic>,<italic>j</italic>). The score of (<italic>i</italic>,<italic>j</italic>) is then defined as:
<disp-formula id="Equ11"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{score}(i,j) = \frac{P(i,j)}{\text{max}(D(i,j), H(I,j), V(i,j), BL(i,j))}   $$ \end{document}</tex-math><mml:math id="M44"><mml:mtext>score</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">BL</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2019_1913_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>If score(<italic>i</italic>,<italic>j</italic>)≥minScore, where minScore is a user-defined threshold (we use minScore=1), fragment pair (<italic>i</italic><sup>′</sup>,<italic>j</italic><sup>′</sup>)=arg max{IFnorm(<italic>a</italic>,<italic>b</italic>):<italic>a</italic>,<italic>b</italic>∈peak(<italic>i</italic>,<italic>j</italic>)} is identified, and repr(<italic>i</italic>,<italic>j</italic>)=(<italic>i</italic><sup>′</sup>,<italic>j</italic><sup>′</sup>) is set as the representative RF pair of the peak. Finally, candidate peaks located within a minimum distance minDist (20 kb used here) of another higher scoring candidate peak are eliminated. The remaining peaks are reported by HIFI.</p>
      <p>A false discovery rate (FDR) is assigned to each peak by repeating the peak-finding procedure on a randomly permuted IF matrix (diagonal-wise, i.e., preserving fragment distances). For each distance bin of 10 kb, the observed <italic>score</italic> values are fit to a gamma distribution and used to estimate the FDR of each predicted peak found in the non-permuted data. Similar to HiCCUPS, several pairs of values <italic>p</italic> and <italic>w</italic> were considered to enable the capture of small, sharp peaks as well as broader peaks. Both (<italic>p</italic> = 30 kb, <italic>w</italic> = 60 kb) and (<italic>p</italic> = 50 kb, <italic>w</italic> = 100 kb) were used here. The resulting HIFI chromatin loop calls were combined and sorted based on FDR values.</p>
    </sec>
    <sec id="Sec20">
      <title>Evaluation of chromatin loop-calling approaches</title>
      <p>All 3 HindIII-digest GM12878 Hi-C replicates (HIC034, HIC035, and HIC037) from Rao et al. [<xref ref-type="bibr" rid="CR23">23</xref>] were combined using Juicer [<xref ref-type="bibr" rid="CR31">31</xref>] (MAPQ value &gt; 30 and Knight-Ruiz matrix balancing [<xref ref-type="bibr" rid="CR21">21</xref>]) to obtain Hi-C matrices at 10-kb resolution (in.hic format). HiCCUPS was then applied to these matrices using default parameters, yielding a list of 21,940 potential chromatin loops genome-wide.</p>
      <p>The top 100 scoring HIFI- and HiCCUPS-predicted chromatin loops (based on FDR values) were identified at each distance bin of 10 kb (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11). The validity of predicted loops was determined by available CTCF and RNAPII ChIA-PET GM12878 libraries [<xref ref-type="bibr" rid="CR33">33</xref>]. A predicted loop was considered correct if a proximal ChIA-PET contact was present (allowing up to 10 kb of tolerance for each anchor of the loop).</p>
    </sec>
    <sec id="Sec21">
      <title>Directionality index and TAD boundary prediction</title>
      <p>The directionality index (DI) was first described by Dixon et al. [<xref ref-type="bibr" rid="CR6">6</xref>] to detect directionality bias for interactions across a Hi-C IF matrix. For RF <italic>i</italic>, the DI is usually calculated as follows:
<disp-formula id="Equ12"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{DI}(i)=\text{sign}(B-A) \cdot \left(\frac{(A-E)^{2}}{E}+\frac{(B-E)^{2}}{E}\right),   $$ \end{document}</tex-math><mml:math id="M46"><mml:mtext>DI</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext>sign</mml:mtext><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2019_1913_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <inline-formula id="IEq11"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$A=\sum _{i-\delta \leq j &lt; i}\text {IF}_{j,i}$\end{document}</tex-math><mml:math id="M48"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext>IF</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1913_Article_IEq11.gif"/></alternatives></inline-formula>, <inline-formula id="IEq12"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$B=\sum _{i &lt; j \leq i+\delta } \text {IF}_{i,j}$\end{document}</tex-math><mml:math id="M50"><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext>IF</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1913_Article_IEq12.gif"/></alternatives></inline-formula>, <inline-formula id="IEq13"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$E=\frac {(A+B)}{2}$\end{document}</tex-math><mml:math id="M52"><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2019_1913_Article_IEq13.gif"/></alternatives></inline-formula>, and <italic>δ</italic> is set to 500 kb. Due to the low coverage at RF resolution Hi-C data, the DI formula yields very noisy predictions. We thus used the following modified version:
<disp-formula id="Equ13"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{DI}^{\prime}=\text{sign}(B-A)\cdot \left(\frac{(A-E)^{2}}{E^{2}}+\frac{(B-E)^{2}}{E^{2}}\right).   $$ \end{document}</tex-math><mml:math id="M54"><mml:msup><mml:mrow><mml:mtext>DI</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext>sign</mml:mtext><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2019_1913_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>This modification transforms terms present in the right parentheses to relative rates and helps to scale the magnitude of the DI. TAD boundaries are defined as RFs whose DI<sup>′</sup> value is a local maximum or minimum in a window of 21 RFs (51 for MboI analyses) centered around it. In the case of the fixed-binning (<italic>b</italic> = 16) analysis, only RFs at the center of their bin are considered. Due to their low coverage, regions within 2 Mb of a centromere or telomere were excluded. TAD boundaries are then sorted by their absolute DI values and the top 5000 and 25,000 boundaries were selected for HindIII and MboI RF resolutions, respectively.</p>
    </sec>
    <sec id="Sec22">
      <title>Data sources and pre-processing</title>
      <p>The following Hi-C datasets were used: from Dixon et al. [<xref ref-type="bibr" rid="CR6">6</xref>], mESC with HindIII digest (GEO:GSE35156); from Rao et al. [<xref ref-type="bibr" rid="CR23">23</xref>], GM12878 with HindIII and MboI digest (GEO:GSE63525); and from Bonev et al. [<xref ref-type="bibr" rid="CR24">24</xref>], mESC with DpnII digest (GEO:GSE96107). For 5C comparisons, the following datasets were used: from Smith et al. [<xref ref-type="bibr" rid="CR29">29</xref>], GM12878 with HindIII digest (GEO:GSE75634), and from Nora et al. [<xref ref-type="bibr" rid="CR7">7</xref>], mESC with HindIII digest (GEO:GSE35721). For comparisons to ChIA-PET, the following datasets were used: from Tang et al. [<xref ref-type="bibr" rid="CR33">33</xref>], CTCF-mediated contacts (GEO:GSM1872886) and RNAPII-mediated contacts (GEO:GSM1872887), and from Fullwood et al. [<xref ref-type="bibr" rid="CR32">32</xref>], RAD21-mediated contacts (GEO:GSM1436265; replicates averaged). Paired-end tag clusters were binned to hg19 HindIII RFs to ensure comparability with other datasets. Enhancer-promoter (EP) pairs from Thurman et al. [<xref ref-type="bibr" rid="CR35">35</xref>] were obtained from https://ftp://ftp.ebi.ac.uk/pub/databases/ensembl/encode/integration_data_jan2011/byDataType/openchrom/jan2011/dhs_ gene_connectivity/genomewideCorrs_above0.7_promoterPlusMinus500kb_withGeneNames_32celltypeCategories.bed8.gzhttps://ftp://ftp.ebi.ac.uk/pub/databases/ensembl/encode/integration_data_jan2011/byDataType/openchrom/jan2011/dhs_ gene_connectivity/genomewideCorrs_above0.7_promoterPlusMinus500kb_withGeneNames_32celltypeCategories.bed8.gzhttps://ftp://ftp.ebi.ac.uk/pub/databases/ensembl/encode/integration_data_jan2011/byDataType/openchrom/jan2011/dhs_ gene_connectivity/genomewideCorrs_above0.7_promoterPlusMinus500kb_withGeneNames_32celltypeCategories.bed8.gzhttps://ftp://ftp.ebi.ac.uk/pub/databases/ensembl/encode/integration_data_jan2011/byDataType/openchrom/jan2011/dhs_ gene_connectivity/genomewideCorrs_above0.7_promoterPlusMinus500kb_withGeneNames_32celltypeCategories.bed8.gzhttps://ftp://ftp.ebi.ac.uk/pub/databases/ensembl/encode/integration_data_jan2011/byDataType/openchrom/jan2011/dhs_ gene_connectivity/genomewideCorrs_above0.7_promoterPlusMinus500kb_withGeneNames_32celltypeCategories.bed8.gz. Enhancers and promoters were then binned to their respective RFs. Cohesin-mediated chromatin contacts identified by HiChIP were taken from Supplementary Table 3 of Mumbach et al. [<xref ref-type="bibr" rid="CR36">36</xref>] and then binned to expected HindIII-digest RFs.</p>
      <p>ChIP-seq data from ENCODE [<xref ref-type="bibr" rid="CR37">37</xref>] and ChromHMM [<xref ref-type="bibr" rid="CR46">46</xref>] predictions were downloaded from the UCSC Genome browser [<xref ref-type="bibr" rid="CR56">56</xref>] and binned to HindIII and MboI RFs. For ChromHMM (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c, g), only states 1 and 4 were used (to reduce redundancy). CTCF motifs and orientation were identified in a similar manner to Fundenberg et al. [<xref ref-type="bibr" rid="CR57">57</xref>] using HOMER [<xref ref-type="bibr" rid="CR58">58</xref>] and the “CTCF_known1” PWM [<xref ref-type="bibr" rid="CR59">59</xref>]. CTCF peaks, identified by ChIP-seq, were assigned forward or reverse strand orientations based on the orientation of overlapping CTCF motifs. If both orientations were found to reside within a peak, then one orientation would be randomly chosen. Peaks with no overlapping CTCF motif were discarded.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec23">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1913_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Supplementary information.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2019_1913_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s13059-019-1913-y.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was funded by a NSERC Discovery grant to MB and a CIHR grant (MOP-142451) to JD. Authors would like to thank XQ David Wang, Maia Kaplan, Rola Dali, Jack Guo, Yanlin Zhang, Jérôme Waldispühl, Derek Ruths, Michael Hallett, Alessandro Bonetti, Michael Hoffman, Michiel de Hoon, and Nicole Francis for their useful discussions during the development of this project and manuscript.</p>
    <sec id="d29e3807">
      <title>Review history</title>
      <p>The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>CJFC conceived the study, contributed to the design of the study, implemented the computational analysis, and helped draft the manuscript. JD participated in the study design and contributed to the manuscript. MB conceived the study, coordinated the computational analysis, and helped draft the manuscript. All authors have reviewed and approved the final manuscript.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Ethics approval was not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rippe</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kleckner</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Capturing chromosome conformation</article-title>
        <source>Science</source>
        <year>2002</year>
        <volume>295</volume>
        <issue>5558</issue>
        <fpage>1306</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1067799</pub-id>
        <?supplied-pmid 11847345?>
        <pub-id pub-id-type="pmid">11847345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fraser</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Williamson</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bickmore</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Dostie</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>An overview of genome organization and how we got there: from FISH to Hi-C</article-title>
        <source>Microbiol Mol Biol Rev</source>
        <year>2015</year>
        <volume>79</volume>
        <issue>3</issue>
        <fpage>347</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1128/MMBR.00006-15</pub-id>
        <?supplied-pmid 26223848?>
        <pub-id pub-id-type="pmid">26223848</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holwerda</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>de Laat</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Chromatin loops, gene positioning, and gene expression</article-title>
        <source>Front Genet</source>
        <year>2012</year>
        <volume>3</volume>
        <fpage>217</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2012.00217</pub-id>
        <?supplied-pmid 23087710?>
        <pub-id pub-id-type="pmid">23087710</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cavalli</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Misteli</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Functional implications of genome topology</article-title>
        <source>Nat Struct Mol Biol</source>
        <year>2013</year>
        <volume>20</volume>
        <issue>3</issue>
        <fpage>290</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nsmb.2474</pub-id>
        <?supplied-pmid 23463314?>
        <pub-id pub-id-type="pmid">23463314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>van Berkum</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ragoczy</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Telling</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Amit</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Sabo</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Dorschner</surname>
            <given-names>MO</given-names>
          </name>
          <name>
            <surname>Sandstrom</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Groudine</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stamatoyannopoulos</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mirny</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>326</volume>
        <issue>5950</issue>
        <fpage>289</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1181369</pub-id>
        <?supplied-pmid 19815776?>
        <pub-id pub-id-type="pmid">19815776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <issue>7398</issue>
        <fpage>376</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11082</pub-id>
        <?supplied-pmid 3356448?>
        <pub-id pub-id-type="pmid">22495300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nora</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Giorgetti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Okamoto</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Servant</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Piolot</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>van Berkum</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Meisig</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sedat</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gribnau</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barillot</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Blüthgen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Heard</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Spatial partitioning of the regulatory landscape of the X-inactivation centre</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <issue>7398</issue>
        <fpage>381</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11049</pub-id>
        <?supplied-pmid 3555144?>
        <pub-id pub-id-type="pmid">22495304</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berlivet</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Paquette</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dumouchel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Langlais</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dostie</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kmita</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Clustering of tissue-specific sub-TADs accompanies the regulation of HoxA genes in developing limbs</article-title>
        <source>PLoS Genet</source>
        <year>2013</year>
        <volume>9</volume>
        <issue>12</issue>
        <fpage>1004018</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1004018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phillips-Cremins</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Sauria</surname>
            <given-names>AMESanyal</given-names>
          </name>
          <name>
            <surname>Gerasimova</surname>
            <given-names>TI</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Ong</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Hookway</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bland</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Wagstaff</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Dalton</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McDevitt</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Sen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Corces</surname>
            <given-names>VG</given-names>
          </name>
        </person-group>
        <article-title>Architectural protein subclasses shape 3D organization of genomes during lineage commitment</article-title>
        <source>Cell</source>
        <year>2013</year>
        <volume>153</volume>
        <issue>6</issue>
        <fpage>1281</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2013.04.053</pub-id>
        <?supplied-pmid 3712340?>
        <pub-id pub-id-type="pmid">23706625</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Belaghzal</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gibcus</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Hi-C 2.0: an optimized Hi-C procedure for high-resolution genome-wide mapping of chromosome conformation</article-title>
        <source>Methods</source>
        <year>2017</year>
        <volume>123</volume>
        <fpage>56</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2017.04.004</pub-id>
        <?supplied-pmid 28435001?>
        <pub-id pub-id-type="pmid">28435001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosa-Garrido</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chapski</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Kimball</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Karbassi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Monte</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Balderas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Pellegrini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shih</surname>
            <given-names>TT</given-names>
          </name>
          <name>
            <surname>Soehalim</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Liem</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ping</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Galjart</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Vondriska</surname>
            <given-names>TM</given-names>
          </name>
        </person-group>
        <article-title>High-resolution mapping of chromatin conformation in cardiac myocytes reveals structural remodeling of the epigenome in heart failure</article-title>
        <source>Circulation</source>
        <year>2017</year>
        <volume>136</volume>
        <issue>17</issue>
        <fpage>1613</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1161/CIRCULATIONAHA.117.029430</pub-id>
        <?supplied-pmid 28802249?>
        <pub-id pub-id-type="pmid">28802249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ay</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gulsoy</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hesson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cavanaugh</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ware</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Krumm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Blau</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Disteche</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Duan</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Using DNase Hi-C techniques to map global and local three-dimensional genome architecture at high resolution</article-title>
        <source>Methods</source>
        <year>2018</year>
        <volume>142</volume>
        <fpage>59</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2018.01.014</pub-id>
        <?supplied-pmid 29382556?>
        <pub-id pub-id-type="pmid">29382556</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mifsud</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tavares-Cadete</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Sugar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schoenfelder</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wingett</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Grey</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ewels</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Herman</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Happe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Higgs</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>LeProust</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Follows</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Luscombe</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Osborne</surname>
            <given-names>CS</given-names>
          </name>
        </person-group>
        <article-title>Mapping long-range promoter contacts in human cells with high-resolution capture Hi-C</article-title>
        <source>Nat Genet</source>
        <year>2015</year>
        <volume>47</volume>
        <issue>6</issue>
        <fpage>598</fpage>
        <lpage>606</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3286</pub-id>
        <?supplied-pmid 25938943?>
        <pub-id pub-id-type="pmid">25938943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>McGovern</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Orozco</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Duffus</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yarwood</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schoenfelder</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Barton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wallace</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Worthington</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Eyre</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Capture Hi-C reveals novel candidate genes and complex long-range interactions with related autoimmune risk loci</article-title>
        <source>Nat Commun</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>10069</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms10069</pub-id>
        <?supplied-pmid 26616563?>
        <pub-id pub-id-type="pmid">26616563</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Furey</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A hidden Markov random field-based Bayesian method for the detection of long-range chromosomal interactions in Hi-C data</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>5</issue>
        <fpage>650</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv650</pub-id>
        <?supplied-pmid 26543175?>
        <pub-id pub-id-type="pmid">26543175</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <mixed-citation publication-type="other">Carty M, Zamparo L, Sahin M, González A, Pelossof R, Elemento O, Leslie CS. An integrated model for detecting significant chromatin interactions from high-resolution Hi-C data. Nature Commun. Nat Commun; 8:15454.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>An</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Enhancing Hi-C data resolution with deep convolutional neural network HiCPlus</article-title>
        <source>Nature Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>750</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-03113-2</pub-id>
        <pub-id pub-id-type="pmid">29467363</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sauria</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Phillips-Cremins</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Corces</surname>
            <given-names>VG</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>HiFive: a tool suite for easy and efficient HiC and 5C data analysis</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>237</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0806-y</pub-id>
        <?supplied-pmid 26498826?>
        <pub-id pub-id-type="pmid">26498826</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yaffe</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic modeling of Hi-C contact maps eliminates systematic biases to characterize global chromosomal architecture</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <issue>11</issue>
        <fpage>1059</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.947</pub-id>
        <?supplied-pmid 22001755?>
        <pub-id pub-id-type="pmid">22001755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fudenberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>McCord</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Naumova</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Goloborodko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mirny</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Iterative correction of Hi-C data reveals hallmarks of chromosome organization</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>10</issue>
        <fpage>999</fpage>
        <lpage>1003</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2148</pub-id>
        <?supplied-pmid 22941365?>
        <pub-id pub-id-type="pmid">22941365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knight</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ruiz</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A fast algorithm for matrix balancing</article-title>
        <source>IMA J Numer Anal</source>
        <year>2013</year>
        <volume>33</volume>
        <fpage>1029</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1093/imanum/drs019</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dostie</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Richmond</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Arnaout</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Selzer</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Honan</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Rubio</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Krumm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lamb</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Chromosome Conformation Capture Carbon Copy (5C): a massively parallel solution for mapping interactions between genomic elements</article-title>
        <source>Genome Res</source>
        <year>2006</year>
        <volume>16</volume>
        <issue>10</issue>
        <fpage>1299</fpage>
        <lpage>309</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.5571506</pub-id>
        <?supplied-pmid 16954542?>
        <pub-id pub-id-type="pmid">16954542</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Stamenova</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Bochkov</surname>
            <given-names>ID</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Sanborn</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Machol</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Omer</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Aiden</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>
        <source>Cell</source>
        <year>2013</year>
        <volume>159</volume>
        <issue>7</issue>
        <fpage>1665</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.11.021</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonev</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mendelson Cohen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Szabo</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Fritsch</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Papadopoulos</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Lubling</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lv</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Hugnot</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cavalli</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Multiscale 3D genome rewiring during mouse neural development</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <issue>3</issue>
        <fpage>557</fpage>
        <lpage>57224</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.09.043</pub-id>
        <?supplied-pmid 5651218?>
        <pub-id pub-id-type="pmid">29053968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanyal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The long-range interaction landscape of gene promoters</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>489</volume>
        <issue>7414</issue>
        <fpage>109</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11279</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fraser</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rousseau</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shenker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ferraiuolo</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Hayashizaki</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Blanchette</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dostie</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Chromatin conformation signatures of cellular differentiation</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>4</issue>
        <fpage>37</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-4-r37</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kundu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>HFSunwoo</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Sadreyev</surname>
            <given-names>RI</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kingston</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>Polycomb repressive complex 1 generates discrete compacted domains that change during differentiation</article-title>
        <source>Mol Cell</source>
        <year>2017</year>
        <volume>65</volume>
        <issue>3</issue>
        <fpage>432</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2017.01.009</pub-id>
        <?supplied-pmid 28157505?>
        <pub-id pub-id-type="pmid">28157505</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moisan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Berlivet</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ka</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Le Gac</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dostie</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Férec</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Analysis of long-range interactions in primary human cells identifies cooperative CFTR regulatory elements</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>6</issue>
        <fpage>2564</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1300</pub-id>
        <?supplied-pmid 26615198?>
        <pub-id pub-id-type="pmid">26615198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Invariant TAD boundaries constrain cell-type-specific looping interactions between promoters and distal elements around the CFTR locus</article-title>
        <source>Am J Hum Genet</source>
        <year>2016</year>
        <volume>98</volume>
        <issue>1</issue>
        <fpage>185</fpage>
        <lpage>201</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2015.12.002</pub-id>
        <?supplied-pmid 26748519?>
        <pub-id pub-id-type="pmid">26748519</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Yardımcı</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>HiCRep: assessing the reproducibility of Hi-C data using a stratum-adjusted correlation coefficient</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>11</issue>
        <fpage>1939</fpage>
        <lpage>49</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.220640.117</pub-id>
        <?supplied-pmid 28855260?>
        <pub-id pub-id-type="pmid">28855260</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Shamim</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Machol</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Aiden</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>Juicer provides a one-click system for analyzing loop-resolution Hi-C experiments</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>95</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.07.002</pub-id>
        <?supplied-pmid 27467249?>
        <pub-id pub-id-type="pmid">27467249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fullwood</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>YF</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mohamed</surname>
            <given-names>YB</given-names>
          </name>
          <name>
            <surname>Orlov</surname>
            <given-names>YL</given-names>
          </name>
          <name>
            <surname>Velkov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Chew</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>PY</given-names>
          </name>
          <name>
            <surname>Welboren</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ooi</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Ariyaratne</surname>
            <given-names>PN</given-names>
          </name>
          <name>
            <surname>Vega</surname>
            <given-names>VB</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>PY</given-names>
          </name>
          <name>
            <surname>Choy</surname>
            <given-names>PY</given-names>
          </name>
          <name>
            <surname>Wansa</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Leow</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Yow</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Joseph</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Desai</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Thomsen</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>YK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An oestrogen-receptor-alpha-bound human chromatin interactome</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>462</volume>
        <issue>7269</issue>
        <fpage>58</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08497</pub-id>
        <?supplied-pmid 2774924?>
        <pub-id pub-id-type="pmid">19890323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>OJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Szalaj</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Trzaskoma</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Magalska</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wlodarczyk</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ruszczycki</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Michalski</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Piecuch</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>SZ</given-names>
          </name>
          <name>
            <surname>Penrad-Mobayed</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sachs</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Wilczynski</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Plewczynski</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>CTCF-mediated human 3D genome architecture reveals chromatin topology for transcription</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>163</volume>
        <issue>7</issue>
        <fpage>1611</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.11.024</pub-id>
        <?supplied-pmid 4734140?>
        <pub-id pub-id-type="pmid">26686651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heidari</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Phanstiel</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Grubert</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Jahanbani</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kasowski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>MQ</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide map of regulatory interactions in the human genome</article-title>
        <source>Genome Res</source>
        <year>2014</year>
        <volume>24</volume>
        <issue>12</issue>
        <fpage>1905</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.176586.114</pub-id>
        <?supplied-pmid 25228660?>
        <pub-id pub-id-type="pmid">25228660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <mixed-citation publication-type="other">Thurman RE, Rynes E, Humbert R, Vierstra J, Maurano MT, Haugen E, Sheffield NC, Stergachis AB, Wang H, Vernot B, Garg K, John S, Sandstrom R, Bates D, Boatman L, Canfield TK, Diegel M, Dunn D, Ebersol AK, Frum T, Giste E, Johnson AK, Johnson EM, Kutyavin T, Lajoie B, Lee BK, Lee K, London D, Lotakis D, Neph S, et al. The accessible chromatin landscape of the human genome. Nature. 2012; 489(7414).</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mumbach</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Flynn</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Khavari</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>HY</given-names>
          </name>
        </person-group>
        <article-title>HiChIP: efficient and sensitive analysis of protein-directed genome architecture</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>13</volume>
        <issue>11</issue>
        <fpage>919</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3999</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>ENCODE Project Consortium</collab>
        </person-group>
        <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <issue>7414</issue>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11247</pub-id>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanborn</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>SSP</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Jewett</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Bochkov</surname>
            <given-names>ID</given-names>
          </name>
          <name>
            <surname>Chinnappan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cutkosky</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Geeting</surname>
            <given-names>KP</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Melnikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McKenna</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stamenova</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Aiden</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>Chromatin extrusion explains key features of loop and domain formation in wild-type and engineered genomes</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2015</year>
        <volume>112</volume>
        <issue>47</issue>
        <fpage>6456</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1518552112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nichols</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Corces</surname>
            <given-names>VG</given-names>
          </name>
        </person-group>
        <article-title>A CTCF code for 3D genome architecture</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>162</volume>
        <issue>4</issue>
        <fpage>703</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.07.053</pub-id>
        <?supplied-pmid 26276625?>
        <pub-id pub-id-type="pmid">26276625</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parelho</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hadjur</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Spivakov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Leleu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sauer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gregson</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Jarmuz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Canzonetta</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Webster</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Nesterova</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cobb</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Yokomori</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dillon</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Aragon</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Merkenschlager</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cohesins functionally associate with CTCF on mammalian chromosome arms</article-title>
        <source>Cell</source>
        <year>2008</year>
        <volume>132</volume>
        <issue>3</issue>
        <fpage>422</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2008.01.011</pub-id>
        <pub-id pub-id-type="pmid">18237772</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Monahan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Rudnick</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Kehayova</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Pauli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Newberry</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Maniatis</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Role of CCCTC binding factor (CTCF) and cohesin in the generation of single-cell diversity of Protocadherin- <italic>α</italic> gene expression</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2012</year>
        <volume>109</volume>
        <issue>23</issue>
        <fpage>9125</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1205074109</pub-id>
        <?supplied-pmid 22550178?>
        <pub-id pub-id-type="pmid">22550178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zuin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>van der Reijden</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Kolovos</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Brouwer</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>van de Corput</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>van de Werken</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Knoch</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>van IJcken</surname>
            <given-names>WF</given-names>
          </name>
          <name>
            <surname>Grosveld</surname>
            <given-names>FG</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wendt</surname>
            <given-names>KS</given-names>
          </name>
        </person-group>
        <article-title>Cohesin and CTCF differentially affect chromatin architecture and gene expression in human cells</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>3</issue>
        <fpage>996</fpage>
        <lpage>1001</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1317788111</pub-id>
        <?supplied-pmid 24335803?>
        <pub-id pub-id-type="pmid">24335803</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bailey</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Desai</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Aid</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Corradin</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Cowper-Sal Lari</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Akhtar-Zaidi</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Scacheri</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Haibe-Kains</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lupien</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>ZNF143 provides sequence specificity to secure chromatin interactions at gene promoters</article-title>
        <source>Nat Commun</source>
        <year>2015</year>
        <volume>2</volume>
        <fpage>6186</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms7186</pub-id>
        <?supplied-pmid 25645053?>
        <pub-id pub-id-type="pmid">25645053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beagan</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Duong</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Titus</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lachanski</surname>
            <given-names>CV</given-names>
          </name>
          <name>
            <surname>Gillis</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Phillips-Cremins</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>YY1 and CTCF orchestrate a 3D chromatin looping switch during early neural lineage commitment</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>7</issue>
        <fpage>1139</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.215160.116</pub-id>
        <?supplied-pmid 28536180?>
        <pub-id pub-id-type="pmid">28536180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weintraub</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Zamudio</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Sigova</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Hannett</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Day</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Abraham</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Nabet</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Buckley</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>YE</given-names>
          </name>
          <name>
            <surname>Hnisz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jaenisch</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bradner</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>YY1 is a structural regulator of enhancer-promoter loops</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <issue>7</issue>
        <fpage>1573</fpage>
        <lpage>8828</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.11.008</pub-id>
        <?supplied-pmid 29224777?>
        <pub-id pub-id-type="pmid">29224777</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>ChromHMM: automating chromatin-state discovery and characterization</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>215</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1906</pub-id>
        <?supplied-pmid 22373907?>
        <pub-id pub-id-type="pmid">22373907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baxter</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Leavy</surname>
            <given-names>OC</given-names>
          </name>
          <name>
            <surname>Dryden</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Maguire</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Fedele</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Simigdala</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wingett</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Assiotis</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Fenwick</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chauhan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rust</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Orr</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dudbridge</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Haider</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fletcher</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Capture Hi-C identifies putative target genes at 33 breast cancer risk loci</article-title>
        <source>Nature Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>1028</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-03411-9</pub-id>
        <pub-id pub-id-type="pmid">29531215</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>AY</given-names>
          </name>
          <name>
            <surname>Yen</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Espinoza</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A high-resolution map of the three-dimensional chromatin interactome in human cells</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>503</volume>
        <issue>7475</issue>
        <fpage>290</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12644</pub-id>
        <?supplied-pmid 24141950?>
        <pub-id pub-id-type="pmid">24141950</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilgenast</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Phillips-Cremins</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>Systematic evaluation of statistical methods for identifying looping interactions in 5C data</article-title>
        <source>Cell Syst</source>
        <year>2019</year>
        <volume>8</volume>
        <issue>3</issue>
        <fpage>197</fpage>
        <lpage>211</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2019.02.006</pub-id>
        <?supplied-pmid 30904376?>
        <pub-id pub-id-type="pmid">30904376</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wingett</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ewels</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Furlan-Magaril</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nagano</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schoenfelder</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>HiCUP: pipeline for mapping and processing Hi-C data</article-title>
        <source>F1000Res</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>1310</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.7334.1</pub-id>
        <?supplied-pmid 26835000?>
        <pub-id pub-id-type="pmid">26835000</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <mixed-citation publication-type="other">Cameron CJF, Dostie J, Blanchette M. HIFI: estimating DNA-DNA interaction frequency from Hi-C data at restriction-fragment resolution. Github. 2019. <ext-link ext-link-type="uri" xlink:href="https://github.com/BlanchetteLab/HIFI">https://github.com/BlanchetteLab/HIFI</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <mixed-citation publication-type="other">Cameron CJF, Dostie J, Blanchette M. HIFI: estimating DNA-DNA interaction frequency from Hi-C data at restriction-fragment resolution. Source code. Zenodo. 2019. 10.5281/zenodo.3556842.</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenblatt</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Remarks on some nonparametric estimates of a density function</article-title>
        <source>Ann Math Statist</source>
        <year>1956</year>
        <volume>27</volume>
        <issue>3</issue>
        <fpage>832</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177728190</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parzen</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>On Estimation of a probability density function and mode</article-title>
        <source>Ann Math Statist</source>
        <year>1962</year>
        <volume>33</volume>
        <issue>3</issue>
        <fpage>1065</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177704472</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Besag</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>On the statistical analysis of dirty pictures</article-title>
        <source>J R Stat Soc Series B Stat Methodol</source>
        <year>1986</year>
        <volume>48</volume>
        <issue>3</issue>
        <fpage>259</fpage>
        <lpage>302</lpage>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hinrichs</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Karolchik</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Baertsch</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Barber</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Bejerano</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Clawson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Diekhans</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Furey</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Harte</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Hsu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hillman-Jackson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Pohl</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Raney</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Rosenbloom</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Siepel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Sugnet</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Sultan-Qurraie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Trumbower</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Weirauch</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zweig</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>The UCSC Genome Browser Database: update 2006</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <volume>34</volume>
        <issue>Database issue</issue>
        <fpage>590</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkj144</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fudenberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Goloborodko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Abdennur</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>LA</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Formation of chromosomal domains by loop extrusion</article-title>
        <source>Cell Rep</source>
        <year>2016</year>
        <volume>15</volume>
        <issue>9</issue>
        <fpage>2038</fpage>
        <lpage>49</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2016.04.085</pub-id>
        <?supplied-pmid 27210764?>
        <pub-id pub-id-type="pmid">27210764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Benner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Spann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bertolino</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Laslo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>JX</given-names>
          </name>
          <name>
            <surname>Murre</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Glass</surname>
            <given-names>CK</given-names>
          </name>
        </person-group>
        <article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</article-title>
        <source>Mol Cell</source>
        <year>2010</year>
        <volume>38</volume>
        <issue>4</issue>
        <fpage>576</fpage>
        <lpage>89</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2010.05.004</pub-id>
        <?supplied-pmid 20513432?>
        <pub-id pub-id-type="pmid">20513432</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Panchakshari</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Volpi</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Meyers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>YJ</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Robbiani</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Meng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gostissa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nussenzweig</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Manis</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Alt</surname>
            <given-names>FW</given-names>
          </name>
        </person-group>
        <article-title>Orientation-specific joining of AID-initiated DNA breaks promotes antibody class switching</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>525</volume>
        <issue>7567</issue>
        <fpage>134</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14970</pub-id>
        <?supplied-pmid 26308889?>
        <pub-id pub-id-type="pmid">26308889</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simonis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klous</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Splinter</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Moshkin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Willemsen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>de Wit</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>van Steensel</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>de Laat</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Nuclear organization of active and inactive chromatin domains uncovered by chromosome conformation capture-on-chip (4C)</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <issue>11</issue>
        <fpage>1348</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1038/ng1896</pub-id>
        <?supplied-pmid 17033623?>
        <pub-id pub-id-type="pmid">17033623</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Tavoosidana</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sjölinder</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Göndör</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mariano</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kanduri</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lezcano</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sandhu</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Pant</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Tiwari</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kurukuti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ohlsson</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Circular chromosome conformation capture (4C) uncovers extensive networks of epigenetically regulated intra- and interchromosomal interactions</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <issue>11</issue>
        <fpage>1341</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/ng1891</pub-id>
        <?supplied-pmid 17033624?>
        <pub-id pub-id-type="pmid">17033624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Koues</surname>
            <given-names>OI</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pyfrom</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Payton</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Oltz</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>cis-regulatory circuits regulating NEK6 kinase overexpression in transformed B cells are super-enhancer independent</article-title>
        <source>Cell Rep</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>12</issue>
        <fpage>2918</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2017.02.067</pub-id>
        <?supplied-pmid 28329684?>
        <pub-id pub-id-type="pmid">28329684</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
