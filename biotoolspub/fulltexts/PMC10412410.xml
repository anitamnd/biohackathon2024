<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10412410</article-id>
    <article-id pub-id-type="pmid">37498558</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad449</article-id>
    <article-id pub-id-type="publisher-id">btad449</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><underline>S</underline>ub-<underline>C</underline>luster <underline>I</underline>dentification through <underline>S</underline>emi-<underline>S</underline>upervised <underline>O</underline>ptimization of <underline>R</underline>are-Cell <underline>S</underline>ilhouettes (SCISSORS) in single-cell RNA-sequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0009-0004-8821-3269</contrib-id>
        <name>
          <surname>Leary</surname>
          <given-names>Jack R</given-names>
        </name>
        <aff><institution>Lineberger Comprehensive Cancer Center, University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country country="US">United States</country></aff>
        <aff><institution>Department of Biostatistics, University of Florida</institution>, Gainesville, FL 32603, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Yi</given-names>
        </name>
        <aff><institution>Department of Pharmacology, University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Morrison</surname>
          <given-names>Ashley B</given-names>
        </name>
        <aff><institution>Lineberger Comprehensive Cancer Center, University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jin</surname>
          <given-names>Chong</given-names>
        </name>
        <aff><institution>Department of Biostatistics, University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shen</surname>
          <given-names>Emily C</given-names>
        </name>
        <aff><institution>Lineberger Comprehensive Cancer Center, University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kuhlers</surname>
          <given-names>Peyton C</given-names>
        </name>
        <aff><institution>Lineberger Comprehensive Cancer Center, University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country country="US">United States</country></aff>
        <aff><institution>Department of Biostatistics, University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Su</surname>
          <given-names>Ye</given-names>
        </name>
        <aff><institution>Lineberger Comprehensive Cancer Center, University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rashid</surname>
          <given-names>Naim U</given-names>
        </name>
        <aff><institution>Lineberger Comprehensive Cancer Center, University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country country="US">United States</country></aff>
        <aff><institution>Department of Biostatistics, University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Yeh</surname>
          <given-names>Jen Jen</given-names>
        </name>
        <aff><institution>Lineberger Comprehensive Cancer Center, University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country country="US">United States</country></aff>
        <aff><institution>Department of Pharmacology, University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country country="US">United States</country></aff>
        <aff><institution>Department of Surgery, University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country country="US">United States</country></aff>
        <xref rid="btad449-cor1" ref-type="corresp"/>
        <!--jjyeh@med.unc.edu-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8684-5762</contrib-id>
        <name>
          <surname>Peng</surname>
          <given-names>Xianlu Laura</given-names>
        </name>
        <aff><institution>Lineberger Comprehensive Cancer Center, University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country country="US">United States</country></aff>
        <aff><institution>Department of Pharmacology, University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country country="US">United States</country></aff>
        <xref rid="btad449-cor1" ref-type="corresp"/>
        <!--laura.peng@med.unc.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kendziorski</surname>
          <given-names>Christina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad449-cor1">Corresponding authors. Lineberger Comprehensive Cancer Center, University of North Carolina at Chapel Hill, 450 West Drive, Chapel Hill, NC 27516, United States. E-mails: <email>laura.peng@med.unc.edu</email> (X.L.P.) and <email>jjyeh@med.unc.edu</email> (J.J.Y.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-07-27">
      <day>27</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>8</issue>
    <elocation-id>btad449</elocation-id>
    <history>
      <date date-type="received">
        <day>02</day>
        <month>2</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>13</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>09</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad449.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-cell RNA-sequencing (scRNA-seq) has enabled the molecular profiling of thousands to millions of cells simultaneously in biologically heterogenous samples. Currently, the common practice in scRNA-seq is to determine cell type labels through unsupervised clustering and the examination of cluster-specific genes. However, even small differences in analysis and parameter choosing can greatly alter clustering results and thus impose great influence on which cell types are identified. Existing methods largely focus on determining the optimal number of robust clusters, which can be problematic for identifying cells of extremely low abundance due to their subtle contributions toward overall patterns of gene expression.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present a carefully designed framework, SCISSORS, which accurately profiles subclusters within broad cluster(s) for the identification of rare cell types in scRNA-seq data. SCISSORS employs silhouette scoring for the estimation of heterogeneity of clusters and reveals rare cells in heterogenous clusters by a multi-step semi-supervised reclustering process. Additionally, SCISSORS provides a method for the identification of marker genes of high specificity to the cell type. SCISSORS is wrapped around the popular Seurat R package and can be easily integrated into existing Seurat pipelines.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>SCISSORS, including source code and vignettes, are freely available at <ext-link xlink:href="https://github.com/jr-leary7/SCISSORS" ext-link-type="uri">https://github.com/jr-leary7/SCISSORS</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <award-id>U24-CA211000</award-id>
        <award-id>R01-CA199064</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell RNA-sequencing (scRNA-seq), which has garnered tremendous interest in the field of biomedical research in the past decade, enables the study of the transcriptome of a tissue or organ at an unprecedented resolution (<xref rid="btad449-B44" ref-type="bibr">Tang <italic toggle="yes">et al.</italic> 2009</xref>, <xref rid="btad449-B50" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2017</xref>). Compared with bulk RNA-seq, which can only capture the average of gene expressions in a sample, scRNA-seq enables the profiling of the transcriptome in each individual cell simultaneously, which can theoretically lead to a more comprehensive and exhaustive understanding of each cell type. However, the computational analysis of scRNA-seq data is often challenging due to its sparse, noisy, and high dimensional features (<xref rid="btad449-B4" ref-type="bibr">Bacher and Kendziorski 2016</xref>, <xref rid="btad449-B27" ref-type="bibr">Lähnemann <italic toggle="yes">et al.</italic> 2020</xref>).</p>
    <p>As identifying cell populations is one of the principal goals of performing scRNA-seq, accurate analytical approaches for clustering cells are critical. To this end, a wide variety of clustering algorithms are employed in scRNA-seq data analysis. For example, <italic toggle="yes">k</italic>-means, a popular algorithm used widely across many fields, has been implemented as part of the methods, such as GiniClust3, SC3, and RaceID (<xref rid="btad449-B18" ref-type="bibr">Grün <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad449-B26" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad449-B13" ref-type="bibr">Dong and Yuan 2020</xref>). However, one of the assumptions of the <italic toggle="yes">k</italic>-means clustering method is that features have spherical covariance (<xref rid="btad449-B9" ref-type="bibr">Bock 1996</xref>). This is easily violated by the sparse scRNA-seq data, which feature non-independent, co-expressing genes that exhibit different variances depending on which cell types they are expressed in. In addition, <italic toggle="yes">k</italic>-means tends to produce similarly sized clusters due to the objective function it minimizes, the sum of squared errors; this is often sub-optimal for biological data where cell types appear with widely varying frequencies depending on the species, organ, and phenotype being studied (<xref rid="btad449-B38" ref-type="bibr">Pollard 1981</xref>, <xref rid="btad449-B9" ref-type="bibr">Bock 1996</xref>, <xref rid="btad449-B2" ref-type="bibr">Andrews and Hemberg 2018</xref>). This may negatively impact the performance of <italic toggle="yes">k</italic>-means and is exacerbated in the presence of rare cell types. Another method, Spectrum, has been created to accommodate negative-binomially distributed single-cell counts through its implementation of spectral clustering on only 300–8500 cells and 100 highly variable genes (<xref rid="btad449-B23" ref-type="bibr">John <italic toggle="yes">et al.</italic> 2020</xref>). However, spectral clustering is computationally expensive, with runtime scaling cubically with sample size, which is a growing constraint as single-cell datasets have grown from thousands to millions of cells (<xref rid="btad449-B27" ref-type="bibr">Lähnemann <italic toggle="yes">et al.</italic> 2020</xref>). Recently, the graph-based Louvain modularity optimization clustering algorithm as implemented in Seurat and Scanpy has been shown to be very accurate and achieves reasonable runtimes (<xref rid="btad449-B8" ref-type="bibr">Blondel <italic toggle="yes">et al.</italic> 2008</xref>, <xref rid="btad449-B14" ref-type="bibr">Duo <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad449-B48" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad449-B43" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad449-B20" ref-type="bibr">Hao <italic toggle="yes">et al.</italic> 2021</xref>). The IKAP method is built around Seurat and begins by first overclustering and then transitioning to a coarser clustering by iteratively combining the clusters whose centers are closest (<xref rid="btad449-B11" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2019</xref>). However, IKAP performance may be limited on highly heterogeneous samples, such as tumors, or developmental datasets where expression is expected to exist on a gradient (<xref rid="btad449-B11" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2019</xref>). Similar to IKAP, the recently developed MultiK method attempts to find the true number of clusters <italic toggle="yes">K</italic> in a dataset by iteratively testing many combinations of the resolution parameter <italic toggle="yes">r</italic> (<xref rid="btad449-B29" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2021</xref>). Both IKAP and MultiK are time-intensive due to the design of iterating over parameters (<xref rid="btad449-B11" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad449-B29" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2021</xref>). In addition, SAFE-clustering is an ensemble method that derives a consensus clustering from the results of several different clustering methods (<xref rid="btad449-B49" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    <p>Besides the general need for calling cell types in a dataset, the identification of rare cell types may be of particular interest. A handful of clustering methods have been developed specifically for this purpose, as the identification of rare cell types from scRNA-seq data is challenging and necessitates special methodologies. For example, GiniClust3 identifies marker genes through Gini indexing, then uses a graph-based clustering algorithm in an attempt to find rare cell types (<xref rid="btad449-B13" ref-type="bibr">Dong and Yuan 2020</xref>). However, it uses <italic toggle="yes">k</italic>-means as part of the final consensus clustering, which may compromise the accuracy of its results as the <italic toggle="yes">k</italic>-means assumptions are often violated as previously described. This is the case for CellSIUS and RaceID as well, which were designed for rare cells but also employ the <italic toggle="yes">k</italic>-means algorithm for clustering (<xref rid="btad449-B18" ref-type="bibr">Grün <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad449-B47" ref-type="bibr">Wegmann <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    <p>The gap in methods for rare cell identification motivated our development of SCISSORS, which is wrapped around Seurat and strives to achieve a biologically optimal clustering. SCISSORS employs carefully designed initial clustering and reclustering steps, which ensures the identification of cell types that are of extremely low abundance. In SCISSORS, the silhouette coefficient is used to allow the systematic estimation of intra-cluster heterogeneity, which can help determine if reclustering is needed for a cluster when biological information is insufficient. In the reclustering step, SCISSORS efficiently tests several default or user-defined combinations of parameters and determines the best parameter set, which systematically optimize the final clusters. By applying SCISSORS to a peripheral blood mononuclear cell (PBMC) dataset, as well as a pancreatic ductal adenocarcinoma (PDAC) dataset, we demonstrated that SCISSORS is able to identify cells that were overlooked in other analyses possibly due to their rare representation in the dataset. In this study, the “identification of rare cells” refers to the more rigorous statement of “the identification of evidence for the existence of rare cells” if not specified otherwise.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Silhouette score</title>
      <p>SCISSORS uses silhouette scores (<xref rid="btad449-B41" ref-type="bibr">Rousseeuw 1987</xref>) based on the cosine distance between cells to estimate the heterogeneity of derived clusters and to evaluate parameter sets during reclustering. To measure the dissimilarity or distance between two non-zero vectors, the cosine distance is defined as:
where <italic toggle="yes">a</italic> and <italic toggle="yes">b</italic> are two vectors each of length <italic toggle="yes">n</italic>. The mean distance from cell <italic toggle="yes">i</italic> to all other cells <italic toggle="yes">j</italic> in its cluster <italic toggle="yes">C<sub>m</sub></italic> is defined as:
where <italic toggle="yes">d(i, j)</italic> is the cosine distance from cell <italic toggle="yes">i</italic> to cell <italic toggle="yes">j</italic>. The minimum mean distance from cell <italic toggle="yes">i</italic> to all points in all other clusters is then calculated as:
</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:maligngroup/>
                  <mml:mi>d</mml:mi>
                  <mml:mfenced open="(" close=")" separators="|">
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi mathvariant="normal"> </mml:mi>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>-</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mo stretchy="false">∑</mml:mo>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>a</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>b</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mi mathvariant="normal"> </mml:mi>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mo stretchy="false">∑</mml:mo>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>=</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>n</mml:mi>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>a</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mn>2</mml:mn>
                                  </mml:mrow>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msqrt>
                        <mml:mi mathvariant="normal"> </mml:mi>
                        <mml:mo>×</mml:mo>
                        <mml:mi mathvariant="normal"> </mml:mi>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mo stretchy="false">∑</mml:mo>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>=</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>n</mml:mi>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>b</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mn>2</mml:mn>
                                  </mml:mrow>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msqrt>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:maligngroup/>
                  <mml:mi>a</mml:mi>
                  <mml:mfenced open="(" close=")" separators="|">
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mfenced open="|" close="|" separators="|">
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>C</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>m</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mfenced>
                        <mml:mo>-</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:munder>
                        <mml:mo stretchy="false">∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>∈</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>,</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo>≠</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:munder>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>d</mml:mi>
                      <mml:mfenced open="(" close=")" separators="|">
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>,</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:maligngroup/>
                  <mml:mi>b</mml:mi>
                  <mml:mfenced open="(" close=")" separators="|">
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">min</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>l</mml:mi>
                            <mml:mo>≠</mml:mo>
                            <mml:mi>m</mml:mi>
                          </mml:mrow>
                        </mml:munder>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>⁡</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mfenced open="|" close="|" separators="|">
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>C</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>l</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mfenced>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:munder>
                            <mml:mo stretchy="false">∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                              <mml:mo>∈</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>C</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>l</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:munder>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>d</mml:mi>
                          <mml:mfenced open="(" close=")" separators="|">
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi mathvariant="normal"> </mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:mfenced>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>The silhouette score of each individual cell in cluster <italic toggle="yes">C<sub>m</sub></italic> is then computed using the following:
</p>
      <disp-formula id="E4">
        <label>(4)</label>
        <mml:math id="M4" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:maligngroup/>
                  <mml:mi mathvariant="normal">s</mml:mi>
                  <mml:mi mathvariant="normal">i</mml:mi>
                  <mml:mi mathvariant="normal">l</mml:mi>
                  <mml:mi mathvariant="normal">h</mml:mi>
                  <mml:mi mathvariant="normal">o</mml:mi>
                  <mml:mi mathvariant="normal">u</mml:mi>
                  <mml:mi mathvariant="normal">e</mml:mi>
                  <mml:mi mathvariant="normal">t</mml:mi>
                  <mml:mi mathvariant="normal">t</mml:mi>
                  <mml:mi mathvariant="normal">e</mml:mi>
                  <mml:mfenced open="(" close=")" separators="|">
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi>a</mml:mi>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:mfenced>
                        <mml:mo>-</mml:mo>
                        <mml:mi>b</mml:mi>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>max</mml:mtext>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:mi>a</mml:mi>
                            <mml:mfenced open="(" close=")" separators="|">
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:mfenced>
                            <mml:mo>,</mml:mo>
                            <mml:mi>b</mml:mi>
                            <mml:mfenced open="(" close=")" separators="|">
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:mfenced>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>The silhouette coefficient of cluster <italic toggle="yes">C<sub>m</sub></italic> is given by:
where <italic toggle="yes">N</italic> is the number of cells in cluster <italic toggle="yes">C<sub>m</sub></italic>.</p>
      <disp-formula id="E5">
        <label>(5)</label>
        <mml:math id="M5" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:maligngroup/>
                  <mml:mtext>silhouette</mml:mtext>
                  <mml:mfenced open="(" close=")" separators="|">
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>-</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo stretchy="false">∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mi>b</mml:mi>
                              <mml:mfenced open="(" close=")" separators="|">
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                              </mml:mfenced>
                              <mml:mo>-</mml:mo>
                              <mml:mi>a</mml:mi>
                              <mml:mfenced open="(" close=")" separators="|">
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mi mathvariant="normal">max</mml:mi>
                                </mml:mrow>
                                <mml:mo>⁡</mml:mo>
                                <mml:mrow>
                                  <mml:mfenced open="(" close=")" separators="|">
                                    <mml:mrow>
                                      <mml:mi>a</mml:mi>
                                      <mml:mfenced open="(" close=")" separators="|">
                                        <mml:mrow>
                                          <mml:mi>i</mml:mi>
                                        </mml:mrow>
                                      </mml:mfenced>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi mathvariant="normal"> </mml:mi>
                                      <mml:mi>b</mml:mi>
                                      <mml:mfenced open="(" close=")" separators="|">
                                        <mml:mrow>
                                          <mml:mi>i</mml:mi>
                                        </mml:mrow>
                                      </mml:mfenced>
                                    </mml:mrow>
                                  </mml:mfenced>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
    </sec>
    <sec>
      <title>2.2 Marker gene identification</title>
      <p>Marker genes for broad clusters or subclusters were identified using a specifically designed integrative method, which is included as a function in SCISSORS. In this method, a given cluster or subcluster is first compared to background clusters, which may be the rest of the clusters or other closely related subclusters, to generate a candidate gene list. Subsequently, this candidate gene list is filtered by removing highly expressed genes in the clusters that are not of interest. The highly expressed genes are defined as the top expressed (top 10% by default) by averaging all the cells within each cluster; a user-defined percentile cutoff can also be supplied. For each of the clusters and subclusters in the PBMC3K and PDAC datasets, marker genes were identified using this function in SCISSORS, the details of which are included in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>.</p>
    </sec>
    <sec>
      <title>2.3 Package access</title>
      <p>SCISSORS, including source code and analysis vignettes for simulation and biological datasets, is freely available at <ext-link xlink:href="https://github.com/jr-leary7/SCISSORS" ext-link-type="uri">https://github.com/jr-leary7/SCISSORS</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 The SCISSORS framework</title>
      <p>The motivation of SCISSORS is rooted in the fact that cell types in a given dataset are of variable abundance, and the divergence levels between broad cell types versus between subpopulations within the same broad cell type are not comparable. This has made the estimation of the true number of cell clusters <italic toggle="yes">K</italic> difficult, especially when cell types of low abundance exist in the dataset. To solve this problem, SCISSORS proposes to execute a multi-step process that splits potentially heterogenous cell clusters into subclusters, which leads to the identification of cell types of low abundance (<xref rid="btad449-F1" ref-type="fig">Fig. 1</xref>).</p>
      <fig position="float" id="btad449-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of the SCISSORS framework. SCISSORS is a wrapper of the Seurat package and integrates multi-step semi-supervised clustering to identify cells of low abundance (rare cells) in scRNA-seq datasets. (a) SCISSORS first coarsely defines broad clusters using Louvain clustering in Seurat with conservative parameters. (b) Then, silhouette scores are calculated to infer the heterogeneity of each broad cluster. Lower silhouette score indicates higher heterogeneity of a cluster. The median silhouette score combined with biological knowledge aids the user in determining reclustering candidates. (c) In the reclustering step, combinations of reclustering parameters are tested, and the set that maximizes the silhouette scoring metric is chosen as optimal. (d) Finally, marker genes are identified for each of the clusters and subclusters to facilitate cell type annotation and further study. For the accurate identification of marker genes in subclusters or rare cells, SCISSORS integrates a carefully designed function, where the subcluster is first compared to the closely related clusters followed by a filtering step to remove highly expressed genes in the rest of the clusters</p>
        </caption>
        <graphic xlink:href="btad449f1" position="float"/>
      </fig>
      <p>With a preprocessed count matrix, the SCISSORS framework first performs an initial clustering step to define broad clusters using conservative parameters (<xref rid="btad449-F1" ref-type="fig">Fig. 1a</xref>). To evaluate the level of heterogeneity of each broad cluster, SCISSORS calculates the silhouette score of each cell, which measures how well cells fit within their assigned clusters (<xref rid="btad449-B41" ref-type="bibr">Rousseeuw 1987</xref>) (<xref rid="btad449-F1" ref-type="fig">Fig. 1b</xref>). A lower median silhouette score or large variations in the score distribution of a cluster may indicate higher heterogeneity in that cluster. This measurement aids the determination of heterogeneous broad clusters in a systematic and reproducible way, especially when biological information is lacking. The selection of heterogeneous broad clusters as reclustering candidates avoids overclustering on originally homogeneous or biologically unimportant cell clusters.</p>
      <p>In the second round of clustering, SCISSORS re-identifies HVGs from all the gene features (<xref rid="btad449-B19" ref-type="bibr">Hafemeister and Satija 2019</xref>), considering only the selected candidate broad cluster(s) instead of using the genes identified in the initial processing of the entire dataset. By doing so, SCISSORS avoids losing features that are essential in distinguishing closely related cell subpopulations from one another but are minimally representative on the scale of the entire dataset. SCISSORS then enumerates several combinations of clustering parameters to achieve optimal performance by computing and comparing their silhouette coefficients. The identified resultant subclusters can then be integrated back into the original dataset by SCISSORS and visualized (<xref rid="btad449-F1" ref-type="fig">Fig. 1c</xref>). Additional reclustering can also be performed on subclusters to further subdivide cell subpopulations until the cell types are considered fully explored.</p>
      <p>SCISSORS also integrates a function to aid with the identification of marker genes for rare cell types (<xref rid="btad449-F1" ref-type="fig">Fig. 1d</xref>). This function first compares the rare cells to other cells that fall into the same broad cluster(s) or are empirically determined as closely related cell subpopulations to derive a candidate gene list. This is because comparison within the mixture of the entire dataset may miss small differences between rare cells and their closely related cells. Then, this function filters the candidate gene list by removing the highly expressed genes in all the other clusters in the dataset. By doing so, SCISSORS can accurately identify distinguishing and highly cell-subpopulation-specific marker genes for rare cell types.</p>
    </sec>
    <sec>
      <title>3.2 Evaluation of SCISSORS in simulation test</title>
      <p>To evaluate the performance of SCISSORS systematically, we generated a collection of simulation datasets based on different combinations of parameters using two references datasets respectively, namely a human lung cancer dataset (<xref rid="btad449-B51" ref-type="bibr">Zilionis <italic toggle="yes">et al.</italic> 2019</xref>) and a human normal pancreas dataset (<xref rid="btad449-B7" ref-type="bibr">Baron <italic toggle="yes">et al.</italic> 2016</xref>). We analyzed and clustered these simulation datasets, where ground truth labels are available, by different methods including SCISSORS, Seurat (Louvain clustering), GiniClust3, CellSIUS, three representative basic algorithms (<italic toggle="yes">k</italic>-means, hierarchical, and DBSCAN), and Leiden clustering, which is generally comparable to Louvain clustering (<xref rid="btad449-B46" ref-type="bibr">Ward 1963</xref>, <xref rid="btad449-B21" ref-type="bibr">Hartigan and Wong 1979</xref>, <xref rid="btad449-B16" ref-type="bibr">Ester <italic toggle="yes">et al.</italic> 1996</xref>, <xref rid="btad449-B8" ref-type="bibr">Blondel <italic toggle="yes">et al.</italic> 2008</xref>, <xref rid="btad449-B45" ref-type="bibr">Traag <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad449-B47" ref-type="bibr">Wegmann <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad449-B13" ref-type="bibr">Dong and Yuan 2020</xref>, <xref rid="btad449-B20" ref-type="bibr">Hao <italic toggle="yes">et al.</italic> 2021</xref>). To derive a distribution of performance instead of a single point estimate for an unbiased comparison, iterations of common and reasonable parameters were used for each method (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). Comparing against the ground truth, SCISSORS showed the best recapitulation of the clustering labels measured by ARI and NMI in datasets simulated based on both the human lung cancer dataset and the human normal pancreas dataset (<xref rid="btad449-F2" ref-type="fig">Fig. 2a and b</xref>). In addition, SCISSORS had the highest median silhouette score (<xref rid="btad449-F2" ref-type="fig">Fig. 2c</xref>), indicating that resultant clusters from SCISSORS had the best cluster separations or lowest heterogeneity, indicating a lower possibility of the existence of cell subpopulations. Of note, although SCISSORS is compatible with being supervised, the simulation analysis using SCISSORS utilized the completely unsupervised mode, without setting any parameters <italic toggle="yes">a priori</italic>.</p>
      <fig position="float" id="btad449-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Evaluation of SCISSORS in simulation test. (a–c) Distributions of ARI, NMI, and silhouette score for runs of each clustering method across all simulated datasets combined. (d) <italic toggle="yes">t</italic>-SNE embedding of one representative simulated dataset with seven clusters as ground truth. Note that Clusters 5 and 6, which are located closely together in the dimension-reduced space, are composed of fewer cells than all other clusters, mimicking clusters of rare cells. (e and f) Clustering result and evaluation metrics for naively increasing the resolution parameter (<italic toggle="yes">r</italic>) in the Seurat method in the representative simulated dataset. (g and h) Evaluation metrics and clustering results for each method in the representative simulated dataset</p>
        </caption>
        <graphic xlink:href="btad449f2" position="float"/>
      </fig>
      <p>To further illustrate the superiority of SCISSORS in rare cell identification, we zoomed in on its clustering performance in one of the simulated datasets from the pancreas reference. This simulation is composed of 996 cells and 15 270 genes overall; it contains seven distinct true clusters, with two very small clusters placed closely together in the low-dimensional space, mimicking the situation of rare cell identification (<xref rid="btad449-F2" ref-type="fig">Fig. 2d</xref>). Simply increasing resolution <italic toggle="yes">r</italic> from 0.5 to 2.0 led first to a larger broad cluster being broken up. Then at around resolution <italic toggle="yes">r </italic>=<italic toggle="yes"> </italic>1.5, where two clusters of “rare” clusters were separated, another broad cluster (on the left) was wrongly split (<xref rid="btad449-F2" ref-type="fig">Fig. 2e</xref>). In addition, the clustering with the lowest resolution tested (0.5) had the highest ARI, NMI, and silhouette score, indicating that simply increasing the resolution does not lead to a better estimated clustering (<xref rid="btad449-F2" ref-type="fig">Fig. 2f</xref>). Then, we compared the performance of the eight above-mentioned methods on clustering this specific dataset. Out of all eight methods, SCISSORS achieved the highest ARI (0.987), highest NMI (0.985), and second highest silhouette score (0.693) (<xref rid="btad449-F2" ref-type="fig">Fig. 2g</xref>). In addition, SCISSORS was the only method that successfully separated the two rare clusters (<xref rid="btad449-F2" ref-type="fig">Fig. 2h</xref>).</p>
    </sec>
    <sec>
      <title>3.3 Application of SCISSORS to the PBMC3K dataset</title>
      <p>We applied SCISSORS to the widely used PBMC3K dataset, which was previously analyzed in a tutorial for Seurat (<ext-link xlink:href="https://satijalab.org/seurat/articles/pbmc3k_tutorial.html" ext-link-type="uri">https://satijalab.org/seurat/articles/pbmc3k_tutorial.html</ext-link>). We used SCISSORS to perform an initial clustering, which yielded six clusters (<xref rid="btad449-F3" ref-type="fig">Fig. 3a</xref>) with varying silhouette scores (<xref rid="btad449-F3" ref-type="fig">Fig. 3b</xref>) and marker genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). Clusters P3 and P5 were annotated as being composed of B cells and natural killer cells, respectively (<xref rid="btad449-F3" ref-type="fig">Fig. 3a</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>), and exhibited high silhouette scores, suggesting that they were relatively homogeneous (<xref rid="btad449-F3" ref-type="fig">Fig. 3b</xref>). Clusters P0 and P2 were annotated as CD4+ and CD8+ T cells separately (<xref rid="btad449-F3" ref-type="fig">Fig. 3a</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>), which were more heterogeneous as defined by lower silhouette scores (<xref rid="btad449-F3" ref-type="fig">Fig. 3b</xref>). This, along with their biological similarity, led us to combine Clusters P0 and P2 for reclustering using SCISSORS. SCISSORS reclustering identified three subclusters, namely Naive CD4+ T cells, Memory CD4+ T cells, and CD8+ T cells (<xref rid="btad449-F3" ref-type="fig">Fig. 3c and d</xref>), which reproduced the Seurat results.</p>
      <fig position="float" id="btad449-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Application of SCISSORS to the PBMC3K dataset. (a) Initial conservative clustering on the PBMC3K dataset. Six broad clusters were identified. (b) Violin plot for silhouette scores in each broad clusters. (c) Reclustering of broad clusters containing CD4+ and CD8+ T cells. (d) Top 5 marker genes identified by SCISSORS, ranked by fold-change. (e) Reclustering of candidate broad clusters containing CD14+ and FCGR3A+ monocytes. (f) Top 5 marker genes identified by SCISSORS, ranked by mean log2 fold-change. (g–i) Marker gene expression of monocyte subtypes in the three monocyte subclusters. ***<italic toggle="yes">P</italic> &lt; .05, Wilcoxon rank-sum test</p>
        </caption>
        <graphic xlink:href="btad449f3" position="float"/>
      </fig>
      <p>Clusters P1 and P4 were both annotated as containing myeloid cells and were subjected to reclustering (<xref rid="btad449-F3" ref-type="fig">Fig. 3a</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). As a result, five subclusters were identified (<xref rid="btad449-F3" ref-type="fig">Fig. 3e</xref>). Among them, SCISSORS reproducibly defined dendritic cells (DC) and platelets as Seurat (<xref rid="btad449-F3" ref-type="fig">Fig. 3e and f</xref>). The remaining cells were monocytes, which were reclustered into three subclusters (M0, M1, and M2) by SCISSORS (<xref rid="btad449-F3" ref-type="fig">Fig. 3e and f</xref>). Human monocytes are known to be divided into three major populations, namely classical, non-classical, and intermediate monocyte, which are primarily distinguished by different levels of CD14 and CD16 (FCGR3A) (<xref rid="btad449-B25" ref-type="bibr">Kapellos <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad449-B35" ref-type="bibr">Ong <italic toggle="yes">et al.</italic> 2019</xref>). Among the three monocyte subclusters identified by SCISSORS, subcluster M2 was annotated as non-classical monocyte, as it showed the highest level of FCGR3A (CD16) and a decreased level of CD14 (<xref rid="btad449-B25" ref-type="bibr">Kapellos <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad449-B35" ref-type="bibr">Ong <italic toggle="yes">et al.</italic> 2019</xref>) (<xref rid="btad449-F3" ref-type="fig">Fig. 3g and h</xref>). Interestingly, in the previously annotated CD14+ monocytes, SCISSORS identified a subcluster M1, which showed a similarly high level of CD14 (<xref rid="btad449-F3" ref-type="fig">Fig. 3h</xref>) with subcluster M0, but an intermediate level of CD16 (FCGR3A) compared with subclusters M0 and M2 (<xref rid="btad449-F3" ref-type="fig">Fig. 3h</xref>), indicating that this may be an intermediate monocyte cluster. Additionally, M1 showed a significantly higher level of HLA-DR than the rest of the monocyte subclusters (<xref rid="btad449-F3" ref-type="fig">Fig. 3i</xref>), indicating that it may consist of intermediate monocytes. Accordingly, we annotated subclusters M0, M1, and M2 as classical monocyte, intermediate monocyte, and non-classical monocyte (<xref rid="btad449-F3" ref-type="fig">Fig. 3e</xref>). To our knowledge, the intermediate monocyte cluster was not identified before in this dataset. This demonstrated that SCISSORS can identify cells that may be overlooked by traditional clustering methods due to their low abundance or high degree of similarity to neighboring cell clusters. The annotated subclusters were integrated with the non-reclustered broad clusters, all of which were visualized on the original <italic toggle="yes">t</italic>-SNE embedding (<xref rid="btad449-F4" ref-type="fig">Fig. 4a</xref>).</p>
      <fig position="float" id="btad449-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Evaluation of SCISSORS in the PBMC3K dataset. (a) Final clusters, with broad clusters without reclustering and subclusters derived by reclustering in SCISSORS. (b–e) Clusters identified by using comparable methods, including Seurat, GiniClust3, CellSIUS, and SAFE-clustering, respectively. <italic toggle="yes">t</italic>-SNE coordinates were derived in SCISSORS analysis in (a). (f) Violin plots of silhouette score distributions by each method tested. ***<italic toggle="yes">P</italic> &lt; .05, Wilcoxon rank-sum test</p>
        </caption>
        <graphic xlink:href="btad449f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 Evaluation of SCISSORS in the PBMC3K dataset</title>
      <p>We used the PBMC3K dataset to evaluate the performance of SCISSORS against other comparable methods, namely Seurat, GiniClust3, CellSIUS, and SAFE-clustering (<xref rid="btad449-B47" ref-type="bibr">Wegmann <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad449-B49" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad449-B13" ref-type="bibr">Dong and Yuan 2020</xref>, <xref rid="btad449-B20" ref-type="bibr">Hao <italic toggle="yes">et al.</italic> 2021</xref>). Cell clusters were annotated by examining the marker genes and visualized on the same <italic toggle="yes">t</italic>-SNE embedding obtained from SCISSORS application (<xref rid="btad449-F4" ref-type="fig">Fig. 4a–e</xref>). As shown above, compared with Seurat, SCISSORS reproducibly found the same eight final clusters, while also identified an extra cluster of intermediate monocytes, M1.Intermediate monocyte (<xref rid="btad449-F4" ref-type="fig">Fig. 4a and b</xref>). Clusters identified by GiniClust3 were disparate, with 4 out of 13 clusters matching Seurat labels (<xref rid="btad449-F4" ref-type="fig">Fig. 4c</xref>). The remaining 9 clusters with 117 total cells were scattered throughout the <italic toggle="yes">t</italic>-SNE embedding and did not correspond to known cell types (<xref rid="btad449-F4" ref-type="fig">Fig. 4c</xref>). CellSIUS clustered the dataset into seven clusters, which reproduced the broad cell types in Seurat labels (<xref rid="btad449-F4" ref-type="fig">Fig. 4d</xref>). However, it did not break down them into finer subpopulations, e.g. naive and memory CD4+ T cells were combined as one large CD4+ T cell cluster (<xref rid="btad449-F4" ref-type="fig">Fig. 4d</xref>). Compared with SCISSORS specifically, DC, classical monocyte, and intermediate monocyte were merged into the same cluster in CellSIUS (<xref rid="btad449-F4" ref-type="fig">Fig. 4a</xref>). With suggested parameters, SAFE-clustering did not separate the CD4+ T cells into their naïve and memory subtypes, and also failed to cluster platelets and DCs accordingly as they were of relatively lower frequency in this dataset (<xref rid="btad449-F4" ref-type="fig">Fig. 4e</xref>). Finally, silhouette scores were calculated to evaluate the clustering results from different methods. SCISSORS showed significantly higher median silhouette scores than Seurat and GiniClust3 (<xref rid="btad449-F4" ref-type="fig">Fig. 4f</xref>). Although SCISSORS did not show significantly higher silhouette scores than CellSIUS and SAFE-clustering, it better separates cell subpopulations than either method. Altogether, the final SCISSORS-identified clusters were of lower heterogeneity and more meaningful due to its extensive grouping of cells within broad clusters into smaller and biologically relevant subclusters.</p>
    </sec>
    <sec>
      <title>3.5 Pinpointing overlooked basal-like cells in a PDAC dataset</title>
      <p>We applied SCISSORS to a published PDAC dataset (<xref rid="btad449-B15" ref-type="bibr">Elyada <italic toggle="yes">et al.</italic> 2019</xref>). The initial clustering yielded 13 clusters with varying silhouette scores (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2a</xref> and <xref rid="sup1" ref-type="supplementary-material">b</xref>), indicating varying levels of intra-cluster heterogeneity. Annotation by SingleR (<xref rid="btad449-B3" ref-type="bibr">Aran <italic toggle="yes">et al.</italic> 2019</xref>) and cell markers (<xref rid="btad449-B15" ref-type="bibr">Elyada <italic toggle="yes">et al.</italic> 2019</xref>) confirmed the broad clusters of epithelial/ductal cells, activated stellate/mesenchymal stem cells, acinar cells, and multiple types of immune cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2c</xref>–<xref rid="sup1" ref-type="supplementary-material">e</xref>). This initial round of clustering and annotation does not aim to exhaustedly determine all possible cell populations. However, the silhouette scores and annotations allowed us to systematically determine candidates for the reclustering analysis.</p>
      <p>Many studies have shown the co-existence of basal-like and classical tumor cells, corresponding to the two intrinsic tumor subtypes found in PDAC patients (<xref rid="btad449-B12" ref-type="bibr">Collisson <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btad449-B30" ref-type="bibr">Moffitt <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad449-B5" ref-type="bibr">Bailey <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="btad449-B37" ref-type="bibr">Peng <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad449-B10" ref-type="bibr">Chan-Seng-Yue <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad449-B24" ref-type="bibr">Juiz <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad449-B31" ref-type="bibr">Moncada <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad449-B40" ref-type="bibr">Rashid <italic toggle="yes">et al.</italic> 2020</xref>). To understand the heterogeneity within tumor cells and study their subpopulations, we combined clusters of epithelial cells (Clusters 5 and 9) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2a</xref>) and performed reclustering. This resulted in the identification of the same subclusters as in the original study, as well as an additional subcluster that was not identified before (<xref rid="btad449-F5" ref-type="fig">Fig. 5a and b</xref>). Copy number variation (CNV) analysis (<xref rid="btad449-B32" ref-type="bibr">Müller <italic toggle="yes">et al.</italic> 2018</xref>) showed strong evidence for aberrant CNVs for this additional cluster (<xref rid="btad449-F5" ref-type="fig">Fig. 5c</xref>), supporting the presence of malignant cells. Interestingly, by performing gene set scoring using VAM (<xref rid="btad449-B17" ref-type="bibr">Frost 2020</xref>), we found that cells in this cluster were significantly enriched for Moffitt basal-like genes but were absent of Moffitt classical genes (<xref rid="btad449-F5" ref-type="fig">Fig. 5d and e</xref>). This indicated that the cluster may consist of PDAC basal-like cells. We then used DECODER to calculate the basal-like and classical weights and the ratio between them (bcRatio) for each cell (<xref rid="btad449-B37" ref-type="bibr">Peng <italic toggle="yes">et al.</italic> 2019</xref>). DECODER weights are continuous and measure the extent of basal-like-ness and classical-ness. This newly identified cluster showed high basal-like weights and bcRatio, but low classical weights, confirming that this cluster was a basal-like cell cluster (<xref rid="btad449-F5" ref-type="fig">Fig. 5f–h</xref>). Additionally, GATA6, which is thought to be a discriminating classical subtype marker (<xref rid="btad449-B34" ref-type="bibr">O’Kane <italic toggle="yes">et al.</italic> 2020</xref>), was found to be depleted in this cluster, further supporting that this is a basal-like cell cluster (<xref rid="btad449-F5" ref-type="fig">Fig. 5i</xref>). This newly identified basal-like cell cluster was composed of only 148 cells, comprising just 0.59% of the entire dataset. Therefore, this demonstrated that SCISSORS-identified subclusters of cells that showed strong evidence of being the basal-like tumor cells, which were rare in the dataset and of high biological interest but went undetected in the original study.</p>
      <fig position="float" id="btad449-F5">
        <label>Figure 5.</label>
        <caption>
          <p>Pinpointing overlooked basal-like cells in a PDAC dataset. (a) Reclustering of the epithelial/ductal cell clusters revealed six subclusters. (b) Top 5 marker genes identified by SCISSORS, ranked by fold-change. (c) CNV analysis for the identification of malignant cells. (d and e) Gene enrichment analysis for each cell in the three tumor subclusters, using VAM scores based on top 25 Moffitt basal-like and top 25 Moffitt classical genes. The identified basal-like cluster showed significantly higher basal-like gene enrichment, but lower classical gene enrichment. (f–h) Tumor subtype analysis in the three tumor subclusters, using DECODER basal-like weights, the ratio between basal-like and classical weights (bcRatio), and classical weights. The identified basal-like cluster showed enriched basal-like weights and bcRatio. (i) GATA6 expression in the identified tumor subclusters. The identified basal-like cluster showed depleted GATA6 expression. (j) Comparison of tumor subtypes called by using SCISSORS derived tumor genes, with published calls derived by the Moffitt schema. Heatmap shows consensus clustering of TCGA PAAD samples using top 10 SCISSORS tumor genes, ranked by fold-change. (k) Kaplan–Meier plots of overall survival in patients with resected PDAC for tumor subtypes derived by using SCISSORS marker genes. Log-rank test was used for survival analysis. ***<italic toggle="yes">P</italic> &lt; .05, Wilcoxon rank-sum test</p>
        </caption>
        <graphic xlink:href="btad449f5" position="float"/>
      </fig>
      <p>To investigate the potential utility of SCISSORS scRNA-seq-derived genes for analyzing bulk RNA-seq samples, we identified the top 10 basal-like and classical genes ranked by the fold-change of averaged gene expression. There were three basal-like and three classical genes that were overlapped between the Moffitt genes and SCISSORS genes. Applying the SCISSORS tumor genes to TCGA pancreatic adenocarcinoma (PAAD) dataset, we found that the patients were clustered into two subtypes (<xref rid="btad449-F5" ref-type="fig">Fig. 5j</xref>) (<xref rid="btad449-B39" ref-type="bibr">Raphael <italic toggle="yes">et al.</italic> 2017</xref>). Compared with published calls by the Moffitt schema (<xref rid="btad449-B40" ref-type="bibr">Rashid <italic toggle="yes">et al.</italic> 2020</xref>), SCISSORS-based subtype calls showed 139 (33 basal-like and 106 classical) consistent calls out of 150 samples (<xref rid="btad449-F5" ref-type="fig">Fig. 5j</xref>). Similar to TCGA PAAD, patients with basal-like tumors subtyped by SCISSORS genes showed significantly shorter survival (<italic toggle="yes">P</italic> = .025, hazard ratio = 1.723, and log-rank test) (<xref rid="btad449-F5" ref-type="fig">Fig. 5k</xref>). Thus, marker genes derived from SCISSORS <italic toggle="yes">de novo</italic> can be used to derive consistent patient subtypes in bulk RNA-seq samples.</p>
    </sec>
    <sec>
      <title>3.6 Pinpointing overlooked apCAF cells in a PDAC dataset</title>
      <p>In PDAC, cancer associated fibroblasts (CAFs) have been shown to be heterogenous (<xref rid="btad449-B33" ref-type="bibr">Öhlund <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad449-B15" ref-type="bibr">Elyada <italic toggle="yes">et al.</italic> 2019</xref>). In the same PDAC dataset, we applied SCISSORS on Cluster 8, denoted as activated stellate/mesenchymal stem cells by SingleR, to identify CAF subtypes within the larger fibroblast population (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2a</xref>). Unlike the original study, the endothelial and perivascular cells were clustered within our initial activated stellate/mesenchymal stem cell group (<xref rid="btad449-F6" ref-type="fig">Fig. 6a</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2a</xref>) likely due to the conservative parameters, we used in the initial clustering step. In addition to the endothelial and perivascular cells, we derived three additional subclusters, all of which showed enriched pan-CAF gene expression (<xref rid="btad449-F6" ref-type="fig">Fig. 6b</xref>). Among them, two of the subclusters exhibited strong enrichment of inflammatory CAF (iCAF) and myofibroblastic CAF (myCAF) genes, respectively (<xref rid="btad449-F6" ref-type="fig">Fig. 6c and d</xref>), which aligned with the discovery of iCAF and myCAF populations in the original study (<xref rid="btad449-B15" ref-type="bibr">Elyada <italic toggle="yes">et al.</italic> 2019</xref>). Interestingly, marker genes for the novel cluster identified by SCISSORS exhibited a large overlap with the antigen-presenting CAF (apCAF) subtype described previously (<xref rid="btad449-B15" ref-type="bibr">Elyada <italic toggle="yes">et al.</italic> 2019</xref>) (<xref rid="btad449-F6" ref-type="fig">Fig. 6e</xref>). After running an enrichment analysis of the originally defined apCAF marker genes using VAM (<xref rid="btad449-B17" ref-type="bibr">Frost 2020</xref>), we saw that cells in this cluster showed significant enrichment (<xref rid="btad449-F6" ref-type="fig">Fig. 6f</xref>), confirming their apCAF identity. In the original study by Elyada <italic toggle="yes">et al.</italic>, the apCAF population was only explicitly defined in scRNA-seq samples from KPC mouse models. Although the existence of the apCAF subtype was validated through mass cytometry staining of human PDAC sections, they were not identified in the original human PDAC scRNA-seq data analysis. Re-analysis using SCISSORS of the same human PDAC scRNA-seq data was able to identify this rare apCAF population; the apCAF cluster contained 23 cells and made up only 0.092% of the entire dataset. Thus, we again demonstrated that SCISSORS enabled the identification of extremely low abundance cells, such as apCAFs, which were not identified in the original study.</p>
      <fig position="float" id="btad449-F6">
        <label>Figure 6.</label>
        <caption>
          <p>Pinpointing overlooked apCAF cells in the PDAC dataset. (a) Reclustering of the fibroblast cell clusters revealed five subclusters. (b–d and f) Gene enrichment analysis for each cell in the three fibroblast subclusters, using VAM scores based on Elyada pan-CAF, iCAF, myCAF, and apCAF genes. An apCAF cell subcluster was identified showing apCAF gene enrichment. (e) Top 5 marker genes identified by SCISSORS, ranked by mean log2 fold-change. ***<italic toggle="yes">P</italic> &lt; .05, Wilcoxon rank-sum test</p>
        </caption>
        <graphic xlink:href="btad449f6" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Most clustering methods, perform a single clustering step on the entire dataset, seeking to estimate parameters that are optimal for the detection of all cell types and subtypes present in the data simultaneously. In the case of Louvain modularity optimization, which SCISSORS uses, this means determining a single set of values of the number of nearest neighbors <italic toggle="yes">k</italic> and resolution <italic toggle="yes">r</italic> that both keep large and homogeneous clusters intact and separate out rare cells that might have only faint differences in gene expression from related cell types. Decreasing <italic toggle="yes">k</italic> or increasing <italic toggle="yes">r</italic> generally results in the identification of rare cells at the expense of the overclustering of truly homogeneous groups into spurious or biologically uninteresting clusters. The inverse also occurs; increasing <italic toggle="yes">k</italic> or decreasing <italic toggle="yes">r</italic> usually leads to the preservation of homogeneous clusters along with the grouping of rare cell types into closely neighboring clusters. The application of SCISSORS eliminates the need to determine universally optimal values of <italic toggle="yes">k</italic> and <italic toggle="yes">r</italic> by providing an objective and systematic measure through the silhouette score and allowing the user the flexibility to determine if each cluster is heterogenous enough to necessitate reclustering. Furthermore, unlike other iterative-based methods e.g. MultiK (<xref rid="btad449-B29" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2021</xref>), the iterative approach in SCISSORS is relatively time-efficient (median = 4.5 min on datasets composed of 10 000 cells) because it evaluates parameter sets in parallel and is only specifically applied on selected broad clusters. The method of CellSIUS involved a similar approach as SCISSORS, where a first round of clustering is performed followed by a second round of rare cell identification (<xref rid="btad449-B47" ref-type="bibr">Wegmann <italic toggle="yes">et al.</italic> 2019</xref>). However, SCISSORS has the flexibility of integrating more than two rounds of clustering if needed; in addition, it showed greater performance in identifying rare cells in the simulation test, as well as in the application to the PBMC3K dataset.</p>
    <p>SCISSORS takes advantage of the silhouette score to systematically measure the cluster heterogeneity, which mimics the biological intra-cluster heterogeneity. When a ground truth biological state is not available, there are multiple metrics to measure the cluster quality. For example, within-cluster sum of squares and Davies–Bouldin index measure the variance within and between clusters; and Calinski–Harabasz index focus on the similarity between clusters (<xref rid="btad449-B22" ref-type="bibr">Hubert and Arabie 1985</xref>, <xref rid="btad449-B36" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic> 2011</xref>). In contrast, the silhouette score provides a more comprehensive measurement that combines all of these aspects into a single, per-observation score (<xref rid="btad449-B41" ref-type="bibr">Rousseeuw 1987</xref>). A higher silhouette coefficient indicates that clusters are well-separated from each other and the data points within each cluster are tightly grouped together, and <italic toggle="yes">vice versa</italic>. Furthermore, compared to entropy-based metrics, silhouette score is insensitive to cluster size and shape, which better fit the true biological situation, where clusters are of variable sizes and shapes (<xref rid="btad449-B22" ref-type="bibr">Hubert and Arabie 1985</xref>, <xref rid="btad449-B36" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btad449-B28" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2020</xref>). Therefore, the metric of silhouette score was purposely chosen by SCISSORS among other clustering evaluation metrics. In addition, we purposely chose to use the relative cosine distance in our implementation because of its suggested better performance on higher dimensional data than Euclidean distance (<xref rid="btad449-B1" ref-type="bibr">Aggarwal <italic toggle="yes">et al.</italic> 2001</xref>, <xref rid="btad449-B6" ref-type="bibr">Banerjee <italic toggle="yes">et al.</italic> 2005</xref>).</p>
    <p>SCISSORS generates a more biologically relevant clustering by re-selecting HVGs within each broad cluster. Rare cells appear infrequently among an ocean of other cell types, and their marker genes may be present as faint signals that might be excluded at the very beginning of an analysis due to the lack of expression in the majority of the cells and thus a low overall variance in expression. SCISSORS reconsiders all detected genes when performing reclustering in order to include genes that may be high variance within a broad cluster but are not considered as HVGs in the initial round of clustering.</p>
    <p>In addition to the efficient identification of rare cells, SCISSORS includes a carefully optimized method for the identification of marker genes for cell clusters or subclusters. In the first comparison step, by comparing rare cells only to their closely related cells in the same broad cluster, distinguishing marker genes between them can be identified, which are often of higher biological interest. In the second filtering step, SCISSORS removes highly expressed genes in the clusters that are not of interest, which excludes potentially co-expressed genes to make the marker genes as specific as possible. With cell type-specific exemplar genes derived by SCISSORS, future validation studies can be performed, including the identification of cell types on other platforms (e.g. flow cytometry), and estimation of cell proportions in bulk samples.</p>
    <p>Intuitively, rare cell identification may benefit from starting with a larger dataset. In this sense, large-scale data integration may increase the number of rare cells to be identified more effectively. With this kind of large-scale data, SCISSORS may display an advantage again by only reclustering on selected broad cell types to avoid overclustering on other clusters. SCISSORS supports the usage of integrated datasets as input, with re-integration being performed across samples within each reclustering candidate. The PCA subspace is recalculated in this setting. However, batch effects on these re-integrated data are a potential issue, which may hinder the effective clustering of the same rare cells across different studies. The batch correction issue is not specific to SCISSORS analysis and is being actively studied in the field of scRNA-seq analysis.</p>
    <p>SCISSORS is applicable to a wide range of data scales theoretically. In this study, the smaller real dataset is the PBMC3K dataset with 2700 cells, and the larger real dataset is the Elyada dataset with around 25 000 cells. Our simulation datasets range in size from 1000 to 10 000 cells. Theoretically, SCISSORS has no restriction on input dataset size. Nevertheless, we recommend using SCISSORS on datasets that are of similar scales as these tested datasets.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad449_Supplementary_Data</label>
      <media xlink:href="btad449_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to thank the University of North Carolina at Chapel Hill and the Research Computing group for providing computational resources and support that have contributed to these research results. We would like to thank Dr Hildreth Robert Frost (Department of Biomedical Data Science, Geisel School of Medicine, Dartmouth College) for his tremendous help in VAM package usage and result interpretation. We would like to thank Dr Yuchen Yang (Department of Pathology and Lab Medicine, University of North Carolina at Chapel Hill) for his generous comments in best practices when using SAFE-clustering.</p>
  </ack>
  <sec>
    <title>Author contributions</title>
    <p>X.L.P. and J.J.Y. designed the study. J.R.L., X.L.P., Y.X., A.B.M., C.J., E.C.S., P.C.K., Y.S., and N.U.R. collected the data and performed the analyses. X.L.P., J.R.L., and J.J.Y. wrote the article. All authors critically reviewed and commented on the article.</p>
  </sec>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by grant [U24-CA211000, R01-CA199064]. The funding supported the design of the study, collection, analysis, and interpretation of data, and the writing of the manuscript.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The PDAC scRNA-seq data from the study by <xref rid="btad449-B15" ref-type="bibr">Elyada et al. (2019)</xref> was obtained on NCBI dbGaP (accession number phs001840.v1.p1). The 10X Genomics PBMC3K dataset was obtained using the “SeuratData” R package (<xref rid="btad449-B42" ref-type="bibr">Satija et al. 2019</xref>). The Cancer Genome Atlas (TCGA)-normalized RNA-seq gene expression data were obtained from the Broad Institute FIREHOSE portal (<ext-link xlink:href="http://gdac.broadinstitute.org" ext-link-type="uri">http://gdac.broadinstitute.org</ext-link>).</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad449-B1">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Aggarwal</surname><given-names>CC</given-names></string-name>, <string-name><surname>Hinneburg</surname><given-names>A</given-names></string-name>, <string-name><surname>Keim</surname><given-names>DA.</given-names></string-name></person-group>  <part-title>On the surprising behavior of distance metrics in high dimensional space</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Van Den Bussche</surname><given-names>J</given-names></string-name>, <string-name><surname>Vianu</surname><given-names>V</given-names></string-name></person-group> (eds), <source>Database theory—ICDT 2001</source>, Vol. <volume>1973</volume>. <publisher-loc>Berlin, Heidelberg</publisher-loc>: <publisher-name>Springer</publisher-name>, <year>2001</year>, <fpage>420</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="btad449-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andrews</surname><given-names>TS</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M.</given-names></string-name></person-group>  <article-title>Identifying cell populations with scRNASeq</article-title>. <source>Mol Aspects Med</source>  <year>2018</year>;<volume>59</volume>:<fpage>114</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">28712804</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname><given-names>D</given-names></string-name>, <string-name><surname>Looney</surname><given-names>AP</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat Immunol</source>  <year>2019</year>;<volume>20</volume>:<fpage>163</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bacher</surname><given-names>R</given-names></string-name>, <string-name><surname>Kendziorski</surname><given-names>C.</given-names></string-name></person-group>  <article-title>Design and computational analysis of single-cell RNA-sequencing experiments</article-title>. <source>Genome Biol</source>  <year>2016</year>;<volume>17</volume>:<fpage>63</fpage>.<pub-id pub-id-type="pmid">27052890</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bailey</surname><given-names>P</given-names></string-name>, <string-name><surname>Chang</surname><given-names>DK</given-names></string-name>, <string-name><surname>Nones</surname><given-names>K</given-names></string-name></person-group>  <etal>et al</etal>; <collab>Australian Pancreatic Cancer Genome Initiative</collab>. <article-title>Genomic analyses identify molecular subtypes of pancreatic cancer</article-title>. <source>Nature</source>  <year>2016</year>;<volume>531</volume>:<fpage>47</fpage>–<lpage>52</lpage>.<pub-id pub-id-type="pmid">26909576</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Banerjee</surname><given-names>A</given-names></string-name>, <string-name><surname>Dhillon</surname><given-names>IS</given-names></string-name>, <string-name><surname>Ghosh</surname><given-names>J</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Clustering on the unit hypersphere using von Mises-Fisher distributions</article-title>. <source>J Mach Learn Res</source>  <year>2005</year>;<volume>6</volume>:<fpage>1345</fpage>–<lpage>82</lpage>.</mixed-citation>
    </ref>
    <ref id="btad449-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baron</surname><given-names>M</given-names></string-name>, <string-name><surname>Veres</surname><given-names>A</given-names></string-name>, <string-name><surname>Wolock</surname><given-names>SL</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>. <source>Cell Syst</source>  <year>2016</year>;<volume>3</volume>:<fpage>346</fpage>–<lpage>60.e4</lpage>.<pub-id pub-id-type="pmid">27667365</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blondel</surname><given-names>VD</given-names></string-name>, <string-name><surname>Guillaume</surname><given-names>J-L</given-names></string-name>, <string-name><surname>Lambiotte</surname><given-names>R</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Fast unfolding of communities in large networks</article-title>. <source>J Stat Mech</source>  <year>2008</year>;<volume>2008</volume>:<fpage>P10008</fpage>.</mixed-citation>
    </ref>
    <ref id="btad449-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bock</surname><given-names>HH.</given-names></string-name></person-group>  <article-title>Probabilistic models in cluster analysis</article-title>. <source>Comput Stat Data Anal</source>  <year>1996</year>;<volume>23</volume>:<fpage>5</fpage>–<lpage>28</lpage>.</mixed-citation>
    </ref>
    <ref id="btad449-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chan-Seng-Yue</surname><given-names>M</given-names></string-name>, <string-name><surname>Kim</surname><given-names>JC</given-names></string-name>, <string-name><surname>Wilson</surname><given-names>GW</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Transcription phenotypes of pancreatic cancer are driven by genomic events during tumor evolution</article-title>. <source>Nat Genet</source>  <year>2020</year>;<volume>52</volume>:<fpage>231</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">31932696</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>Y-C</given-names></string-name>, <string-name><surname>Suresh</surname><given-names>A</given-names></string-name>, <string-name><surname>Underbayev</surname><given-names>C</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>IKAP-Identifying K mAjor cell Population groups in single-cell RNA-sequencing analysis</article-title>. <source>Gigascience</source>  <year>2019</year>;<volume>8</volume>:<fpage>giz121</fpage>.<pub-id pub-id-type="pmid">31574155</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Collisson</surname><given-names>EA</given-names></string-name>, <string-name><surname>Sadanandam</surname><given-names>A</given-names></string-name>, <string-name><surname>Olson</surname><given-names>P</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Subtypes of pancreatic ductal adenocarcinoma and their differing responses to therapy</article-title>. <source>Nat Med</source>  <year>2011</year>;<volume>17</volume>:<fpage>500</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">21460848</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dong</surname><given-names>R</given-names></string-name>, <string-name><surname>Yuan</surname><given-names>GC.</given-names></string-name></person-group>  <article-title>GiniClust3: a fast and memory-efficient tool for rare cell type identification</article-title>. <source>BMC Bioinformatics</source>  <year>2020</year>;<volume>21</volume>:<fpage>158</fpage>.<pub-id pub-id-type="pmid">32334526</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duo</surname><given-names>A</given-names></string-name>, <string-name><surname>Robinson</surname><given-names>MD</given-names></string-name>, <string-name><surname>Soneson</surname><given-names>C.</given-names></string-name></person-group>  <article-title>A systematic performance evaluation of clustering methods for single-cell RNA-seq data</article-title>. <source>F1000Res</source>  <year>2018</year>;<volume>7</volume>:<fpage>1141</fpage>.<pub-id pub-id-type="pmid">30271584</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elyada</surname><given-names>E</given-names></string-name>, <string-name><surname>Bolisetty</surname><given-names>M</given-names></string-name>, <string-name><surname>Laise</surname><given-names>P</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Cross-species single-cell analysis of pancreatic ductal adenocarcinoma reveals antigen-presenting cancer-associated fibroblasts</article-title>. <source>Cancer Discov</source>  <year>2019</year>;<volume>9</volume>:<fpage>1102</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">31197017</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ester</surname><given-names>M</given-names></string-name>, <string-name><surname>Kriegel</surname><given-names>H-P</given-names></string-name>, <string-name><surname>Sander</surname><given-names>J</given-names></string-name></person-group>  <etal>et al</etal> A density-based algorithm for discovering clusters in large spatial databases with noise. In: <italic toggle="yes">Proceedings of the 2nd International Conference on Knowledge Discovery and Data Mining</italic>, Vol. <volume>96</volume>. <year>1996</year>, <fpage>226</fpage>–<lpage>31</lpage>. <ext-link xlink:href="https://dl.acm.org/doi/10.5555/3001460.3001507" ext-link-type="uri">https://dl.acm.org/doi/10.5555/3001460.3001507</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad449-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frost</surname><given-names>HR.</given-names></string-name></person-group>  <article-title>Variance-adjusted Mahalanobis (VAM): a fast and accurate method for cell-specific gene set scoring</article-title>. <source>Nucleic Acids Res</source>  <year>2020</year>;<volume>48</volume>:<fpage>e94</fpage>.<pub-id pub-id-type="pmid">32633778</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grün</surname><given-names>D</given-names></string-name>, <string-name><surname>Lyubimova</surname><given-names>A</given-names></string-name>, <string-name><surname>Kester</surname><given-names>L</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>. <source>Nature</source>  <year>2015</year>;<volume>525</volume>:<fpage>251</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">26287467</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hafemeister</surname><given-names>C</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group>  <article-title>Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression</article-title>. <source>Genome Biol</source>  <year>2019</year>;<volume>20</volume>:<fpage>296</fpage>.<pub-id pub-id-type="pmid">31870423</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Hao</surname><given-names>S</given-names></string-name>, <string-name><surname>Andersen-Nissen</surname><given-names>E</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Integrated analysis of multimodal single-cell data</article-title>. <source>Cell</source>  <year>2021</year>;<volume>184</volume>:<fpage>3573</fpage>–<lpage>87.e29</lpage>.<pub-id pub-id-type="pmid">34062119</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hartigan</surname><given-names>JA</given-names></string-name>, <string-name><surname>Wong</surname><given-names>MA.</given-names></string-name></person-group>  <article-title>Algorithm as 136: a K-means clustering algorithm</article-title>. <source>J R Stat Soc</source>  <year>1979</year>;<volume>28</volume>:<fpage>100</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="btad449-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hubert</surname><given-names>L</given-names></string-name>, <string-name><surname>Arabie</surname><given-names>P.</given-names></string-name></person-group>  <article-title>Comparing partitions</article-title>. <source>J Classif</source>  <year>1985</year>;<volume>2</volume>:<fpage>193</fpage>–<lpage>218</lpage>.</mixed-citation>
    </ref>
    <ref id="btad449-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>John</surname><given-names>CR</given-names></string-name>, <string-name><surname>Watson</surname><given-names>D</given-names></string-name>, <string-name><surname>Barnes</surname><given-names>MR</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Spectrum: fast density-aware spectral clustering for single and multi-omic data</article-title>. <source>Bioinformatics</source>  <year>2020</year>;<volume>36</volume>:<fpage>1159</fpage>–<lpage>66</lpage>.<pub-id pub-id-type="pmid">31501851</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Juiz</surname><given-names>N</given-names></string-name>, <string-name><surname>Elkaoutari</surname><given-names>A</given-names></string-name>, <string-name><surname>Bigonnet</surname><given-names>M</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Basal-like and classical cells coexist in pancreatic cancer revealed by single-cell analysis on biopsy-derived pancreatic cancer organoids from the classical subtype</article-title>. <source>FASEB J</source>  <year>2020</year>;<volume>34</volume>:<fpage>12214</fpage>–<lpage>28</lpage>.<pub-id pub-id-type="pmid">32686876</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kapellos</surname><given-names>TS</given-names></string-name>, <string-name><surname>Bonaguro</surname><given-names>L</given-names></string-name>, <string-name><surname>Gemund</surname><given-names>I</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Human monocyte subsets and phenotypes in major chronic inflammatory diseases</article-title>. <source>Front Immunol</source>  <year>2019</year>;<volume>10</volume>:<fpage>2035</fpage>.<pub-id pub-id-type="pmid">31543877</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Kirschner</surname><given-names>K</given-names></string-name>, <string-name><surname>Schaub</surname><given-names>MT</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat Methods</source>  <year>2017</year>;<volume>14</volume>:<fpage>483</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lähnemann</surname><given-names>D</given-names></string-name>, <string-name><surname>Köster</surname><given-names>J</given-names></string-name>, <string-name><surname>Szczurek</surname><given-names>E</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Eleven grand challenges in single-cell data science</article-title>. <source>Genome Biol</source>  <year>2020</year>;<volume>21</volume>:<fpage>31</fpage>.<pub-id pub-id-type="pmid">32033589</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>B</given-names></string-name>, <string-name><surname>Li</surname><given-names>C</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>An entropy-based metric for assessing the purity of single cell populations</article-title>. <source>Nat Commun</source>  <year>2020</year>;<volume>11</volume>:<fpage>3155</fpage>.<pub-id pub-id-type="pmid">32572028</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>S</given-names></string-name>, <string-name><surname>Thennavan</surname><given-names>A</given-names></string-name>, <string-name><surname>Garay</surname><given-names>JP</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>MultiK: an automated tool to determine optimal cluster numbers in single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>  <year>2021</year>;<volume>22</volume>:<fpage>232</fpage>.<pub-id pub-id-type="pmid">34412669</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moffitt</surname><given-names>RA</given-names></string-name>, <string-name><surname>Marayati</surname><given-names>R</given-names></string-name>, <string-name><surname>Flate</surname><given-names>EL</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Virtual microdissection identifies distinct tumor- and stroma-specific subtypes of pancreatic ductal adenocarcinoma</article-title>. <source>Nat Genet</source>  <year>2015</year>;<volume>47</volume>:<fpage>1168</fpage>–<lpage>78</lpage>.<pub-id pub-id-type="pmid">26343385</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moncada</surname><given-names>R</given-names></string-name>, <string-name><surname>Barkley</surname><given-names>D</given-names></string-name>, <string-name><surname>Wagner</surname><given-names>F</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Integrating microarray-based spatial transcriptomics and single-cell RNA-seq reveals tissue architecture in pancreatic ductal adenocarcinomas</article-title>. <source>Nat Biotechnol</source>  <year>2020</year>;<volume>38</volume>:<fpage>333</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">31932730</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Müller</surname><given-names>S</given-names></string-name>, <string-name><surname>Cho</surname><given-names>A</given-names></string-name>, <string-name><surname>Liu</surname><given-names>SJ</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>CONICS integrates scRNA-seq with DNA sequencing to map gene expression to tumor Sub-clones</article-title>. <source>Bioinformatics</source>  <year>2018</year>;<volume>34</volume>:<fpage>3217</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29897414</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Öhlund</surname><given-names>D</given-names></string-name>, <string-name><surname>Handly-Santana</surname><given-names>A</given-names></string-name>, <string-name><surname>Biffi</surname><given-names>G</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Distinct populations of inflammatory fibroblasts and myofibroblasts in pancreatic cancer</article-title>. <source>J Exp Med</source>  <year>2017</year>;<volume>214</volume>:<fpage>579</fpage>–<lpage>96</lpage>.<pub-id pub-id-type="pmid">28232471</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O'Kane</surname><given-names>GM</given-names></string-name>, <string-name><surname>Grünwald</surname><given-names>BT</given-names></string-name>, <string-name><surname>Jang</surname><given-names>G-H</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>GATA6 expression distinguishes classical and basal-like subtypes in advanced pancreatic cancer</article-title>. <source>Clin Cancer Res</source>  <year>2020</year>;<volume>26</volume>:<fpage>4901</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">32156747</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ong</surname><given-names>S-M</given-names></string-name>, <string-name><surname>Teng</surname><given-names>K</given-names></string-name>, <string-name><surname>Newell</surname><given-names>E</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>A novel, five-marker alternative to CD16-CD14 gating to identify the three human monocyte subsets</article-title>. <source>Front Immunol</source>  <year>2019</year>;<volume>10</volume>:<fpage>1761</fpage>.<pub-id pub-id-type="pmid">31402918</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname><given-names>F</given-names></string-name>, <string-name><surname>Varoquaux</surname><given-names>G</given-names></string-name>, <string-name><surname>Gramfort</surname><given-names>A.</given-names></string-name></person-group>  <article-title>Scikit-learn: machine learning in Python</article-title>. <source>JMLR</source>  <year>2011</year>;<volume>12</volume>:<fpage>2825</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="btad449-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peng</surname><given-names>XL</given-names></string-name>, <string-name><surname>Moffitt</surname><given-names>RA</given-names></string-name>, <string-name><surname>Torphy</surname><given-names>RJ</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>De novo compartment deconvolution and weight estimation of tumor samples using DECODER</article-title>. <source>Nat Commun</source>  <year>2019</year>;<volume>10</volume>:<fpage>4729</fpage>.<pub-id pub-id-type="pmid">31628300</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pollard</surname><given-names>D.</given-names></string-name></person-group>  <article-title>Strong consistency of K-means clustering</article-title>. <source>Ann Statist</source>  <year>1981</year>;<volume>9</volume>:<fpage>135</fpage>–<lpage>40</lpage>. <pub-id pub-id-type="doi">10.1214/aos/1176345339</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Raphael</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Hruban</surname><given-names>RH</given-names></string-name>, <string-name><surname>Aguirre</surname><given-names>AJ</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Integrated genomic characterization of pancreatic ductal adenocarcinoma</article-title>. <source>Cancer Cell</source>  <year>2017</year>;<volume>32</volume>:<fpage>185</fpage>–<lpage>203.e13</lpage>.<pub-id pub-id-type="pmid">28810144</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rashid</surname><given-names>NU</given-names></string-name>, <string-name><surname>Peng</surname><given-names>XL</given-names></string-name>, <string-name><surname>Jin</surname><given-names>C</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Purity Independent Subtyping of Tumors (PurIST), a clinically robust, single-sample classifier for tumor subtyping in pancreatic cancer</article-title>. <source>Clin Cancer Res</source>  <year>2020</year>;<volume>26</volume>:<fpage>82</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">31754050</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rousseeuw</surname><given-names>PJ.</given-names></string-name></person-group>  <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>. <source>J Comput Appl Math</source>  <year>1987</year>;<volume>20</volume>:<fpage>53</fpage>–<lpage>65</lpage>.</mixed-citation>
    </ref>
    <ref id="btad449-B42">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Satija</surname><given-names>R</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P</given-names></string-name>, <string-name><surname>Butler</surname><given-names>A.</given-names></string-name></person-group> SeuratData: install and manage Seurat datasets. <year>2019</year>. <ext-link xlink:href="https://rdrr.io/github/satijalab/seurat-data" ext-link-type="uri">https://rdrr.io/github/satijalab/seurat-data</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad449-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>T</given-names></string-name>, <string-name><surname>Butler</surname><given-names>A</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Comprehensive integration of single-cell data</article-title>. <source>Cell</source>  <year>2019</year>;<volume>177</volume>:<fpage>1888</fpage>–<lpage>902.e21</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>F</given-names></string-name>, <string-name><surname>Barbacioru</surname><given-names>C</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>. <source>Nat Methods</source>  <year>2009</year>;<volume>6</volume>:<fpage>377</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">19349980</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Traag</surname><given-names>VA</given-names></string-name>, <string-name><surname>Waltman</surname><given-names>L</given-names></string-name>, <string-name><surname>van Eck</surname><given-names>NJ.</given-names></string-name></person-group>  <article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title>. <source>Sci Rep</source>  <year>2019</year>;<volume>9</volume>:<fpage>5233</fpage>.<pub-id pub-id-type="pmid">30914743</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ward</surname><given-names>JH.</given-names></string-name></person-group>  <article-title>Hierarchical grouping to optimize an objective function</article-title>. <source>J Am Stat Assoc</source>  <year>1963</year>;<volume>58</volume>:<fpage>236</fpage>–<lpage>44</lpage>.</mixed-citation>
    </ref>
    <ref id="btad449-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wegmann</surname><given-names>R</given-names></string-name>, <string-name><surname>Neri</surname><given-names>M</given-names></string-name>, <string-name><surname>Schuierer</surname><given-names>S</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>CellSIUS provides sensitive and specific detection of rare cell populations from complex single-cell RNA-seq data</article-title>. <source>Genome Biol</source>  <year>2019</year>;<volume>20</volume>:<fpage>142</fpage>.<pub-id pub-id-type="pmid">31315641</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ.</given-names></string-name></person-group>  <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source>  <year>2018</year>;<volume>19</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Huh</surname><given-names>R</given-names></string-name>, <string-name><surname>Culpepper</surname><given-names>HW</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>SAFE-clustering: single-cell aggregated (from ensemble) clustering for single-cell RNA-seq data</article-title>. <source>Bioinformatics</source>  <year>2019</year>;<volume>35</volume>:<fpage>1269</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">30202935</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>GXY</given-names></string-name>, <string-name><surname>Terry</surname><given-names>JM</given-names></string-name>, <string-name><surname>Belgrader</surname><given-names>P</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat Commun</source>  <year>2017</year>;<volume>8</volume>:<fpage>14049</fpage>.<pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
    <ref id="btad449-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zilionis</surname><given-names>R</given-names></string-name>, <string-name><surname>Engblom</surname><given-names>C</given-names></string-name>, <string-name><surname>Pfirschke</surname><given-names>C</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Single-cell transcriptomics of human and mouse lung cancers reveals conserved myeloid populations across individuals and species</article-title>. <source>Immunity</source>  <year>2019</year>;<volume>50</volume>:<fpage>1317</fpage>–<lpage>34.e10</lpage>.<pub-id pub-id-type="pmid">30979687</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
