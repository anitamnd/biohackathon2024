<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10805338</article-id>
    <article-id pub-id-type="pmid">38212989</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae019</article-id>
    <article-id pub-id-type="publisher-id">btae019</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>nf-core/nanostring: a pipeline for reproducible NanoString nCounter analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6503-2180</contrib-id>
        <name>
          <surname>Peltzer</surname>
          <given-names>Alexander</given-names>
        </name>
        <aff><institution>Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG</institution>, 88400 Biberach/Riss, <country country="DE">Germany</country></aff>
        <xref rid="btae019-cor1" ref-type="corresp"/>
        <!--alexander.peltzer@boehringer-ingelheim.com-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mohr</surname>
          <given-names>Christopher</given-names>
        </name>
        <aff><institution>Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG</institution>, 88400 Biberach/Riss, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8036-1492</contrib-id>
        <name>
          <surname>Stadermann</surname>
          <given-names>Kai B</given-names>
        </name>
        <aff><institution>Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG</institution>, 88400 Biberach/Riss, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zwick</surname>
          <given-names>Matthias</given-names>
        </name>
        <aff><institution>Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG</institution>, 88400 Biberach/Riss, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schmid</surname>
          <given-names>Ramona</given-names>
        </name>
        <aff><institution>Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG</institution>, 88400 Biberach/Riss, <country country="DE">Germany</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Boeva</surname>
          <given-names>Valentina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae019-cor1">Corresponding author. Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG, 88400 Biberach/Riss, Germany. E-mail: <email>alexander.peltzer@boehringer-ingelheim.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-01-11">
      <day>11</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>1</issue>
    <elocation-id>btae019</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>02</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>22</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae019.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The NanoString™ nCounter<sup>®</sup> technology platform is a widely used targeted quantification platform for the analysis of gene expression of up to ∼800 genes. Whereas the software tools by the manufacturer can perform the analysis in an interactive and GUI driven approach, there is no portable and user-friendly workflow available that can be used to perform reproducible analysis of multiple samples simultaneously in a scalable fashion on different computing infrastructures.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present the nf-core/nanostring open-source pipeline to perform a comprehensive analysis including quality control and additional features such as expression visualization, annotation with additional metadata and input creation for differential gene expression analysis. The workflow features an easy installation, comprehensive documentation, open-source code with the possibility for further extensions, a strong portability across multiple computing environments and detailed quality metrics reporting covering all parts of the pipeline. nf-core/nanostring has been implemented in the Nextflow workflow language and supports Docker, Singularity, Podman container technologies as well as Conda environments, enabling easy deployment on any Nextflow supported compatible system, including most widely used cloud computing environments such as Google GCP or Amazon AWS.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The source code, documentation and installation instructions as well as results for continuous tests are freely available at <ext-link xlink:href="https://github.com/nf-core/nanostring" ext-link-type="uri">https://github.com/nf-core/nanostring</ext-link> and <ext-link xlink:href="https://nf-co.re/nanostring" ext-link-type="uri">https://nf-co.re/nanostring</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Boehringer Ingelheim Pharma GmbH &amp; Co</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The NanoString™ nCounter<sup>®</sup> technology platform (<xref rid="btae019-B10" ref-type="bibr">Morrow and Donaldson 2011</xref>) is a widely used targeted quantification platform for the analysis of gene expression of up to ∼800 genes. The nCounter<sup>®</sup> software suite nSolver™ provided by Nanostring Technologies can be used to perform data analysis, quality control and visualization although—as has been stated by other researchers already (<xref rid="btae019-B1" ref-type="bibr">Canouil <italic toggle="yes">et al.</italic> 2019</xref>)—the method only performs limited normalization and visualization. While these limitations can be partially overcome by utilizing other tools such as R package NACHO (<xref rid="btae019-B1" ref-type="bibr">Canouil <italic toggle="yes">et al.</italic> 2019</xref>), analyzing large numbers of samples can be cumbersome using a graphical user interface that requires dozens of settings to be configured manually and is thus not suitable for large-scale analysis projects, especially where automated reproducible analysis is key. To address these shortcomings, we developed a Nextflow (<xref rid="btae019-B14" ref-type="bibr">Tommaso <italic toggle="yes">et al.</italic> 2017</xref>)-based analysis pipeline within the nf-core (<xref rid="btae019-B3" ref-type="bibr">Ewels <italic toggle="yes">et al.</italic> 2020</xref>) framework. The pipeline can be used to perform QC, normalization, visualize optional output from nSolver<sup>®</sup>, annotate normalized gene expression tables in several standardized output formats. It also outputs a detailed report using MultiQC (<xref rid="btae019-B2" ref-type="bibr">Ewels <italic toggle="yes">et al.</italic> 2016</xref>), allowing users to assess the quality of their analyzed data quickly and explore some of the downstream analysis results that the pipeline automatically creates. Future developments will incorporate additional possibilities such as the analysis of GeoMx<sup>®</sup> data and gene score computation within the pipeline.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>The nf-core/nanostring pipeline was written using Nextflow (<xref rid="btae019-B14" ref-type="bibr">Tommaso <italic toggle="yes">et al.</italic> 2017</xref>). Nextflow is a domain specific language that enables writing data intensive analysis pipelines in a reproducible, portable, and scalable way. We also utilized the community curated nf-core (<xref rid="btae019-B3" ref-type="bibr">Ewels <italic toggle="yes">et al.</italic> 2020</xref>) template for the development of the pipeline to follow best-practices from the community and adhere to well established standards. All individual parts of the pipeline are available as Docker and Singularity containers via the Biocontainers (<xref rid="btae019-B7" ref-type="bibr">Leprevost <italic toggle="yes">et al.</italic> 2017</xref>) initiative to ensure reproducibility of each step of the analysis.</p>
    <p>The nf-core/nanostring pipeline comprised several components, that handle quality control of NanoString data, normalization of the obtained counts, annotation of the respective output matrix and the generation of expression files that allow for further downstream analyses. The outline of the pipeline is displayed in <xref rid="btae019-F1" ref-type="fig">Fig. 1</xref>, whereas the individual steps are described further in the paragraph below.</p>
    <fig position="float" id="btae019-F1">
      <label>Figure 1.</label>
      <caption>
        <p>nf-core/nanostring pipeline outline, describing the individual pipeline steps.</p>
      </caption>
      <graphic xlink:href="btae019f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Design file</title>
      <p>The pipeline requires a comma separated sample sheet file as input to describe samples and accompanying metadata. Mandatory input that needs to be specified is the location of RCC files as produced by the NanoString nCounter instrument and a sample identifier. Additional metadata can be provided by the user to allow for easier integration with downstream analysis methods.</p>
      <p>Values can also be set to NA if not available and the pipeline will then e.g. exclude samples from such analysis where the respective metadata would be a requirement for further analysis.</p>
      <p>The pipeline ultimately creates expression and normalized expression tables which can e.g. be used to perform differential gene expression analysis using other pipelines such as nf-core/differentialabundance (<xref rid="btae019-B8" ref-type="bibr">Manning <italic toggle="yes">et al.</italic> 2024</xref>) without a requirement to perform reformatting of the data tables.</p>
    </sec>
    <sec>
      <title>3.2 Nanostring QC</title>
      <p>This step of the pipeline performs quality control of the supplied RCC input data with the R package NACHO (<xref rid="btae019-B1" ref-type="bibr">Canouil <italic toggle="yes">et al.</italic> 2019</xref>) and thereby creates several diagnostic reports that can be used to assess sample quality with respect to key criteria as defined by the manufacturer. These QC metrics include Binding Density (BD), Field of View (FOV), Positive Control Linearity (PCL), Limit of Detection (LoD) as well as further key criteria required to assess the quality of a NanoString nCounter experiment. For a full list, please refer to the NACHO publication or GitHub page (<ext-link xlink:href="https://github.com/mcanouil/NACHO" ext-link-type="uri">https://github.com/mcanouil/NACHO</ext-link>) that explains the reports in more detail. The individual reporting images are furthermore integrated into the main pipeline report created via MultiQC to provide a comprehensive report for the entire pipeline run. This assists users to assess data quality and results jointly for all provided samples.</p>
    </sec>
    <sec>
      <title>3.3 Normalize</title>
      <p>The normalization step of the pipeline applies RCC normalization as described in the manufacturer documentation, e.g. takes both positive control and negative controls into account and can further be used to perform housekeeper normalization. Users can choose between both the default geometric mean (GEO) normalization (<xref rid="btae019-B11" ref-type="bibr">Nanostring Technologies Incorporated 2018</xref>) and the more advanced generalized linear model normalization (<xref rid="btae019-B15" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2016</xref>) and can customize the normalization method to their liking. By utilizing the GEO normalization, the normalized data is equivalent to output of the Nanostring nCounter analysis software. Housekeeping gene-based normalization is used to correct for variability of sample input and therefore accounts for differences between lanes in terms of amount and quality of RNA (<xref rid="btae019-B11" ref-type="bibr">Nanostring Technologies Incorporated 2018</xref>). Users furthermore receive the raw counts, normalization factors, normalized counts in a standardized set of output files and can then thus check the effects of normalization on their respective data easily. Furthermore, users receive both housekeeping normalized and nonhousekeeping results automatically. The pipeline utilizes the implementation of above methods as integrated in the NACHO R (<xref rid="btae019-B1" ref-type="bibr">Canouil <italic toggle="yes">et al.</italic> 2019</xref>) package.</p>
      <p>Future updates to the pipeline might include other options that have been shown to provide even improved normalization results in cases where technical replicates are available (<xref rid="btae019-B9" ref-type="bibr">Molania <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    </sec>
    <sec>
      <title>3.4 Annotation and expression table creation</title>
      <p>Next, the normalized gene expression matrix is annotated by combining the design input about treatment, time, and other additional metadata with the normalized expression values to allow for further downstream analysis. Users can then load the tables in downstream methods and other analysis pipelines to e.g. perform differential gene expression analysis and/or pathway analysis.</p>
    </sec>
    <sec>
      <title>3.5 Heatmap of gene expression</title>
      <p>After normalization, the pipeline creates an overview heatmap (<xref rid="btae019-B5" ref-type="bibr">Gu <italic toggle="yes">et al.</italic> 2016</xref>) of gene expression values to assess gene expression intensities on a panel level. The heatmap is generated using standard R packages such as tidyverse (<xref rid="btae019-B17" ref-type="bibr">Wickham <italic toggle="yes">et al.</italic> 2019</xref>), ggplot2 (<xref rid="btae019-B16" ref-type="bibr">Wickham 2011</xref>), and ComplexHeatmap (<xref rid="btae019-B5" ref-type="bibr">Gu <italic toggle="yes">et al.</italic> 2016</xref>). This heatmap is also available in the final pipeline report.</p>
    </sec>
    <sec>
      <title>3.6 Gene scores</title>
      <p>Users can compute gene scores inside the pipeline by supplying a custom YAML formatted description file with the desired set(s) of genes and choosing one of the available methods for computing such gene scores. Available methods include PLAGE (<xref rid="btae019-B13" ref-type="bibr">Tomfohr <italic toggle="yes">et al.</italic> 2005</xref>), GSVA (<xref rid="btae019-B6" ref-type="bibr">Hänzelmann <italic toggle="yes">et al.</italic> 2013</xref>), SINGSCORE (<xref rid="btae019-B4" ref-type="bibr">Foroutan <italic toggle="yes">et al.</italic> 2021</xref>), SAMS (<xref rid="btae019-B12" ref-type="bibr">Souiai <italic toggle="yes">et al.</italic> 2001</xref>), and SSGSEA (<xref rid="btae019-B6" ref-type="bibr">Hänzelmann <italic toggle="yes">et al.</italic> 2013</xref>) as well as several other methodologies. Subsequently computed scores are then available in the final MultiQC report of the pipeline together with tables for further analysis.</p>
    </sec>
    <sec>
      <title>3.7 Reporting</title>
      <p>To facilitate an easy exploration and interpretation of a NanoString experiment results, the pipeline combines the output information of various steps to a comprehensive MultiQC HTML report. Individual results are combined in a general report table with accompanying visualizations [e.g. from the NanoString QC, Normalization and Heatmap (<xref rid="btae019-B5" ref-type="bibr">Gu <italic toggle="yes">et al.</italic> 2016</xref>) generation steps]. As such the report provides a one-stop shop to explore the outcome of any NanoString nCounter analysis, without having to investigate multiple output files for a basic assessment. This is further extended by more detailed reports such as the NACHO QC output report that enables a detailed assessment of the NanoString experiment.</p>
    </sec>
    <sec>
      <title>3.8 Testing</title>
      <p>The pipeline utilizes and benefits from the standardized nf-core approach of testing the pipeline automatically. The accompanying test data is available via the nf-core testing data GitHub repository (Nanostring Test Data) which is also referenced in the respective continuous testing profiles that check the pipeline for consistency (Nanostring Test Profiles). Furthermore, the nf-core website hosts the documentation and the full output of such automated testing runs of the pipeline, so that users can check prior running any tests themselves what the pipeline outputs look like: (nf-co.re/nanostring Results).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>The nf-core/nanostring pipeline has been built using Nextflow and the latest nf-core framework standards (nf-core tools 2.10) to enable both standardized, portable, and reproducible analyses of NanoString nCounter data. The native support for containerization technologies, direct integration into several cloud computing providers supported by Nextflow and several other technological advances such as the pipeline resume feature make the pipeline easy to use. This also holds true in the case of beginners with low to none experience with NanoString nCounter analysis. Additional advantages of the nf-core pipeline include live monitoring as well as standardized parameter documentation via the nf-core project (<ext-link xlink:href="https://nf-co.re" ext-link-type="uri">https://nf-co.re</ext-link>). The pipeline follows the latest nf-core framework template standards and thus supports external computing infrastructure configuration files that are easily adaptable via the nf-core community. Therefore, it can be used and deployed across various institutions and research facilities with very little effort.</p>
    <p>The entire code base for the nf-core/nanostring workflow is available via GitHub in the main nf-core repository hosted for this pipeline [nf-core/nanostring: An analysis pipeline for Nanostring nCounter expression data. (github.com)]. Furthermore, all the documentation of the versioned pipeline is accessible via <ext-link xlink:href="https://nf-co.re/nanostring" ext-link-type="uri">https://nf-co.re/nanostring</ext-link> and accompanied by automatically processed example datasets that users can browse at the following location permanently: <ext-link xlink:href="https://nf-co.re/nanostring/results#nanostring" ext-link-type="uri">https://nf-co.re/nanostring/results#nanostring</ext-link>. This facilitates uptake and understanding of data analysis results by the community and potential future users.</p>
  </sec>
  <sec>
    <title>5 Conclusions</title>
    <p>NanoString nCounter is a widely utilized method for the experimental analysis of up to 800 transcriptomic targets. The nSolver software provided by the manufacturer provides a feasible graphical workbench for the analysis of respective data, however the analysis of large-scale NanoString projects can be cumbersome. Especially when considering other important aspects of modern data analysis such as automation, portability and reproducibility of analyses, the available GUI-based methods cannot fulfill modern requirements. To facilitate the analysis of NanoString nCounter data, we developed an open-source, well documented, scalable, and reproducible Nextflow-based analysis pipeline. The nf-core/nanostring pipeline provides several improvements for researchers searching for a full analysis solution for NanoString nCounter data. The pipeline can handle thousands of samples simultaneously and perform many of the required steps for quality control, normalization, and standardized reporting for NanoString data. Future additions will provide further analysis possibilities such as the integration of improved normalization methods that can be leveraged in an automated fashion and might help to improve the usefulness of the pipeline even further. Here, the pipeline also benefits from the community-driven approach as a part of the nf-core community. Other future directions might involve the ability to perform more advanced differential gene expression analyses, potentially providing output for more complex analysis projects and visual exploration.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to thank Julia F. Soellner, Germán Leparc and Raphaela Gessele for proof checking figures and general input to the manuscript.</p>
  </ack>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>All authors are employees of Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>All work in the manuscript was financed by Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae019-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Canouil</surname><given-names>M</given-names></string-name>, <string-name><surname>Bouland</surname><given-names>GA</given-names></string-name>, <string-name><surname>Bonnefond</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>NACHO: a Nanostring nCounter data QC package</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>36</volume>:<fpage>970</fpage>–<lpage>1</lpage>.</mixed-citation>
    </ref>
    <ref id="btae019-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ewels</surname><given-names>P</given-names></string-name>, <string-name><surname>Magnusson</surname><given-names>M</given-names></string-name>, <string-name><surname>Lundin</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>MultiQC: summarize analysis results for multiple tools and samples in a single report</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>3047</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">27312411</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ewels</surname><given-names>PA</given-names></string-name>, <string-name><surname>Peltzer</surname><given-names>A</given-names></string-name>, <string-name><surname>Fillinger</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>The NF-core framework for community-curated bioinformatics pipelines</article-title>. <source>Nat Biotechnol</source><year>2020</year>;<volume>38</volume>:<fpage>276</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">32055031</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Foroutan</surname><given-names>M</given-names></string-name>, <string-name><surname>Molania</surname><given-names>R</given-names></string-name>, <string-name><surname>Pfefferle</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>The ratio of exhausted to resident infiltrating lymphocytes is prognostic for colorectal cancer patient outcome</article-title>. <source>Cancer Immunol Res</source><year>2021</year>;<volume>9</volume>:<fpage>1125</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">34413087</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Eils</surname><given-names>R</given-names></string-name>, <string-name><surname>Schlesner</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Complex heatmaps reveal patterns and correlations in multidimensional genomic data</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>2847</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">27207943</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hänzelmann</surname><given-names>S</given-names></string-name>, <string-name><surname>Castelo</surname><given-names>R</given-names></string-name>, <string-name><surname>Guinney</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>GSVA: gene set variation analysis for microarray and RNA-Seq data</article-title>. <source>BMC Bioinformatics</source><year>2013</year>;<volume>14</volume>:<fpage>7</fpage>.<pub-id pub-id-type="pmid">23323831</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leprevost</surname><given-names>F</given-names></string-name>, <string-name><surname>da</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>BioContainers: an open-source and community-driven framework for software standardization</article-title>. <source>Bioinformatics</source><year>2017</year>;<volume>33</volume>:<fpage>btx192</fpage>.</mixed-citation>
    </ref>
    <ref id="btae019-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Manning</surname><given-names>J</given-names></string-name>, <string-name><surname>Wacker</surname><given-names>O</given-names></string-name>, <string-name><surname>Peltzer</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal> nf-core/differentialabundance <year>2024</year>.</mixed-citation>
    </ref>
    <ref id="btae019-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Molania</surname><given-names>R</given-names></string-name>, <string-name><surname>Gagnon-Bartsch</surname><given-names>JA</given-names></string-name>, <string-name><surname>Dobrovic</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>A new normalization for nanostring nCounter gene expression data</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>6073</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">31114909</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morrow</surname><given-names>M</given-names></string-name>, <string-name><surname>Donaldson</surname><given-names>J.</given-names></string-name></person-group><article-title>Nanostring’s nCounter—a true digital target profiling technology</article-title>. <source>PDA J Pharm Sci Technol</source><year>2011</year>;<volume>65</volume>:<fpage>692</fpage>.<pub-id pub-id-type="pmid">22294601</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B11">
      <mixed-citation publication-type="other"><collab>Nanostring Technologies Incorporated</collab>. <italic toggle="yes">Analysis Software User Manual nSolver 4.0</italic>, Nanostring Technologies <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="btae019-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Souiai</surname><given-names>O</given-names></string-name>, <string-name><surname>Tibshirani</surname><given-names>R</given-names></string-name>, <string-name><surname>Chu</surname><given-names>G.</given-names></string-name></person-group><article-title>Significance analysis of microarrays applied to the ionizing radiation response</article-title>. <source>Proc Natl Acad Sci USA</source><year>2001</year>;<volume>98</volume>:<fpage>5116</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">11309499</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tomfohr</surname><given-names>J</given-names></string-name>, <string-name><surname>Lu</surname><given-names>J</given-names></string-name>, <string-name><surname>Kepler</surname><given-names>TB</given-names></string-name></person-group><etal>et al</etal><article-title>Pathway level analysis of gene expression using singular value decomposition</article-title>. <source>BMC Bioinformatics</source><year>2005</year>;<volume>6</volume>:<fpage>225</fpage>.<pub-id pub-id-type="pmid">16156896</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tommaso</surname><given-names>PD</given-names></string-name>, <string-name><surname>Chatzou</surname><given-names>M</given-names></string-name>, <string-name><surname>Floden</surname><given-names>EW</given-names></string-name></person-group><etal>et al</etal><article-title>Nextflow enables reproducible computational workflows</article-title>. <source>Nat Biotechnol</source><year>2017</year>;<volume>35</volume>:<fpage>316</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">28398311</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>H</given-names></string-name>, <string-name><surname>Horbinski</surname><given-names>C</given-names></string-name>, <string-name><surname>Wu</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>NanoStringDiff: a novel statistical method for differential expression analysis based on NanoString nCounter data</article-title>. <source>Nucleic Acids Res</source><year>2016</year>;<volume>44</volume>:<fpage>e151</fpage>.<pub-id pub-id-type="pmid">27471031</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H.</given-names></string-name></person-group><article-title>ggplot2</article-title>. <source>Wiley Interdiscip Rev Comput Stat</source><year>2011</year>;<volume>3</volume>:<fpage>180</fpage>–<lpage>5</lpage>.</mixed-citation>
    </ref>
    <ref id="btae019-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H</given-names></string-name>, <string-name><surname>Averick</surname><given-names>M</given-names></string-name>, <string-name><surname>Bryan</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Welcome to the Tidyverse</article-title>. <source>J. Open Source Softw</source><year>2019</year>;<volume>4</volume>:<fpage>1686</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10805338</article-id>
    <article-id pub-id-type="pmid">38212989</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae019</article-id>
    <article-id pub-id-type="publisher-id">btae019</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>nf-core/nanostring: a pipeline for reproducible NanoString nCounter analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6503-2180</contrib-id>
        <name>
          <surname>Peltzer</surname>
          <given-names>Alexander</given-names>
        </name>
        <aff><institution>Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG</institution>, 88400 Biberach/Riss, <country country="DE">Germany</country></aff>
        <xref rid="btae019-cor1" ref-type="corresp"/>
        <!--alexander.peltzer@boehringer-ingelheim.com-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mohr</surname>
          <given-names>Christopher</given-names>
        </name>
        <aff><institution>Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG</institution>, 88400 Biberach/Riss, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8036-1492</contrib-id>
        <name>
          <surname>Stadermann</surname>
          <given-names>Kai B</given-names>
        </name>
        <aff><institution>Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG</institution>, 88400 Biberach/Riss, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zwick</surname>
          <given-names>Matthias</given-names>
        </name>
        <aff><institution>Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG</institution>, 88400 Biberach/Riss, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schmid</surname>
          <given-names>Ramona</given-names>
        </name>
        <aff><institution>Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG</institution>, 88400 Biberach/Riss, <country country="DE">Germany</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Boeva</surname>
          <given-names>Valentina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae019-cor1">Corresponding author. Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG, 88400 Biberach/Riss, Germany. E-mail: <email>alexander.peltzer@boehringer-ingelheim.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-01-11">
      <day>11</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>1</issue>
    <elocation-id>btae019</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>02</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>22</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae019.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The NanoString™ nCounter<sup>®</sup> technology platform is a widely used targeted quantification platform for the analysis of gene expression of up to ∼800 genes. Whereas the software tools by the manufacturer can perform the analysis in an interactive and GUI driven approach, there is no portable and user-friendly workflow available that can be used to perform reproducible analysis of multiple samples simultaneously in a scalable fashion on different computing infrastructures.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present the nf-core/nanostring open-source pipeline to perform a comprehensive analysis including quality control and additional features such as expression visualization, annotation with additional metadata and input creation for differential gene expression analysis. The workflow features an easy installation, comprehensive documentation, open-source code with the possibility for further extensions, a strong portability across multiple computing environments and detailed quality metrics reporting covering all parts of the pipeline. nf-core/nanostring has been implemented in the Nextflow workflow language and supports Docker, Singularity, Podman container technologies as well as Conda environments, enabling easy deployment on any Nextflow supported compatible system, including most widely used cloud computing environments such as Google GCP or Amazon AWS.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The source code, documentation and installation instructions as well as results for continuous tests are freely available at <ext-link xlink:href="https://github.com/nf-core/nanostring" ext-link-type="uri">https://github.com/nf-core/nanostring</ext-link> and <ext-link xlink:href="https://nf-co.re/nanostring" ext-link-type="uri">https://nf-co.re/nanostring</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Boehringer Ingelheim Pharma GmbH &amp; Co</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The NanoString™ nCounter<sup>®</sup> technology platform (<xref rid="btae019-B10" ref-type="bibr">Morrow and Donaldson 2011</xref>) is a widely used targeted quantification platform for the analysis of gene expression of up to ∼800 genes. The nCounter<sup>®</sup> software suite nSolver™ provided by Nanostring Technologies can be used to perform data analysis, quality control and visualization although—as has been stated by other researchers already (<xref rid="btae019-B1" ref-type="bibr">Canouil <italic toggle="yes">et al.</italic> 2019</xref>)—the method only performs limited normalization and visualization. While these limitations can be partially overcome by utilizing other tools such as R package NACHO (<xref rid="btae019-B1" ref-type="bibr">Canouil <italic toggle="yes">et al.</italic> 2019</xref>), analyzing large numbers of samples can be cumbersome using a graphical user interface that requires dozens of settings to be configured manually and is thus not suitable for large-scale analysis projects, especially where automated reproducible analysis is key. To address these shortcomings, we developed a Nextflow (<xref rid="btae019-B14" ref-type="bibr">Tommaso <italic toggle="yes">et al.</italic> 2017</xref>)-based analysis pipeline within the nf-core (<xref rid="btae019-B3" ref-type="bibr">Ewels <italic toggle="yes">et al.</italic> 2020</xref>) framework. The pipeline can be used to perform QC, normalization, visualize optional output from nSolver<sup>®</sup>, annotate normalized gene expression tables in several standardized output formats. It also outputs a detailed report using MultiQC (<xref rid="btae019-B2" ref-type="bibr">Ewels <italic toggle="yes">et al.</italic> 2016</xref>), allowing users to assess the quality of their analyzed data quickly and explore some of the downstream analysis results that the pipeline automatically creates. Future developments will incorporate additional possibilities such as the analysis of GeoMx<sup>®</sup> data and gene score computation within the pipeline.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>The nf-core/nanostring pipeline was written using Nextflow (<xref rid="btae019-B14" ref-type="bibr">Tommaso <italic toggle="yes">et al.</italic> 2017</xref>). Nextflow is a domain specific language that enables writing data intensive analysis pipelines in a reproducible, portable, and scalable way. We also utilized the community curated nf-core (<xref rid="btae019-B3" ref-type="bibr">Ewels <italic toggle="yes">et al.</italic> 2020</xref>) template for the development of the pipeline to follow best-practices from the community and adhere to well established standards. All individual parts of the pipeline are available as Docker and Singularity containers via the Biocontainers (<xref rid="btae019-B7" ref-type="bibr">Leprevost <italic toggle="yes">et al.</italic> 2017</xref>) initiative to ensure reproducibility of each step of the analysis.</p>
    <p>The nf-core/nanostring pipeline comprised several components, that handle quality control of NanoString data, normalization of the obtained counts, annotation of the respective output matrix and the generation of expression files that allow for further downstream analyses. The outline of the pipeline is displayed in <xref rid="btae019-F1" ref-type="fig">Fig. 1</xref>, whereas the individual steps are described further in the paragraph below.</p>
    <fig position="float" id="btae019-F1">
      <label>Figure 1.</label>
      <caption>
        <p>nf-core/nanostring pipeline outline, describing the individual pipeline steps.</p>
      </caption>
      <graphic xlink:href="btae019f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Design file</title>
      <p>The pipeline requires a comma separated sample sheet file as input to describe samples and accompanying metadata. Mandatory input that needs to be specified is the location of RCC files as produced by the NanoString nCounter instrument and a sample identifier. Additional metadata can be provided by the user to allow for easier integration with downstream analysis methods.</p>
      <p>Values can also be set to NA if not available and the pipeline will then e.g. exclude samples from such analysis where the respective metadata would be a requirement for further analysis.</p>
      <p>The pipeline ultimately creates expression and normalized expression tables which can e.g. be used to perform differential gene expression analysis using other pipelines such as nf-core/differentialabundance (<xref rid="btae019-B8" ref-type="bibr">Manning <italic toggle="yes">et al.</italic> 2024</xref>) without a requirement to perform reformatting of the data tables.</p>
    </sec>
    <sec>
      <title>3.2 Nanostring QC</title>
      <p>This step of the pipeline performs quality control of the supplied RCC input data with the R package NACHO (<xref rid="btae019-B1" ref-type="bibr">Canouil <italic toggle="yes">et al.</italic> 2019</xref>) and thereby creates several diagnostic reports that can be used to assess sample quality with respect to key criteria as defined by the manufacturer. These QC metrics include Binding Density (BD), Field of View (FOV), Positive Control Linearity (PCL), Limit of Detection (LoD) as well as further key criteria required to assess the quality of a NanoString nCounter experiment. For a full list, please refer to the NACHO publication or GitHub page (<ext-link xlink:href="https://github.com/mcanouil/NACHO" ext-link-type="uri">https://github.com/mcanouil/NACHO</ext-link>) that explains the reports in more detail. The individual reporting images are furthermore integrated into the main pipeline report created via MultiQC to provide a comprehensive report for the entire pipeline run. This assists users to assess data quality and results jointly for all provided samples.</p>
    </sec>
    <sec>
      <title>3.3 Normalize</title>
      <p>The normalization step of the pipeline applies RCC normalization as described in the manufacturer documentation, e.g. takes both positive control and negative controls into account and can further be used to perform housekeeper normalization. Users can choose between both the default geometric mean (GEO) normalization (<xref rid="btae019-B11" ref-type="bibr">Nanostring Technologies Incorporated 2018</xref>) and the more advanced generalized linear model normalization (<xref rid="btae019-B15" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2016</xref>) and can customize the normalization method to their liking. By utilizing the GEO normalization, the normalized data is equivalent to output of the Nanostring nCounter analysis software. Housekeeping gene-based normalization is used to correct for variability of sample input and therefore accounts for differences between lanes in terms of amount and quality of RNA (<xref rid="btae019-B11" ref-type="bibr">Nanostring Technologies Incorporated 2018</xref>). Users furthermore receive the raw counts, normalization factors, normalized counts in a standardized set of output files and can then thus check the effects of normalization on their respective data easily. Furthermore, users receive both housekeeping normalized and nonhousekeeping results automatically. The pipeline utilizes the implementation of above methods as integrated in the NACHO R (<xref rid="btae019-B1" ref-type="bibr">Canouil <italic toggle="yes">et al.</italic> 2019</xref>) package.</p>
      <p>Future updates to the pipeline might include other options that have been shown to provide even improved normalization results in cases where technical replicates are available (<xref rid="btae019-B9" ref-type="bibr">Molania <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    </sec>
    <sec>
      <title>3.4 Annotation and expression table creation</title>
      <p>Next, the normalized gene expression matrix is annotated by combining the design input about treatment, time, and other additional metadata with the normalized expression values to allow for further downstream analysis. Users can then load the tables in downstream methods and other analysis pipelines to e.g. perform differential gene expression analysis and/or pathway analysis.</p>
    </sec>
    <sec>
      <title>3.5 Heatmap of gene expression</title>
      <p>After normalization, the pipeline creates an overview heatmap (<xref rid="btae019-B5" ref-type="bibr">Gu <italic toggle="yes">et al.</italic> 2016</xref>) of gene expression values to assess gene expression intensities on a panel level. The heatmap is generated using standard R packages such as tidyverse (<xref rid="btae019-B17" ref-type="bibr">Wickham <italic toggle="yes">et al.</italic> 2019</xref>), ggplot2 (<xref rid="btae019-B16" ref-type="bibr">Wickham 2011</xref>), and ComplexHeatmap (<xref rid="btae019-B5" ref-type="bibr">Gu <italic toggle="yes">et al.</italic> 2016</xref>). This heatmap is also available in the final pipeline report.</p>
    </sec>
    <sec>
      <title>3.6 Gene scores</title>
      <p>Users can compute gene scores inside the pipeline by supplying a custom YAML formatted description file with the desired set(s) of genes and choosing one of the available methods for computing such gene scores. Available methods include PLAGE (<xref rid="btae019-B13" ref-type="bibr">Tomfohr <italic toggle="yes">et al.</italic> 2005</xref>), GSVA (<xref rid="btae019-B6" ref-type="bibr">Hänzelmann <italic toggle="yes">et al.</italic> 2013</xref>), SINGSCORE (<xref rid="btae019-B4" ref-type="bibr">Foroutan <italic toggle="yes">et al.</italic> 2021</xref>), SAMS (<xref rid="btae019-B12" ref-type="bibr">Souiai <italic toggle="yes">et al.</italic> 2001</xref>), and SSGSEA (<xref rid="btae019-B6" ref-type="bibr">Hänzelmann <italic toggle="yes">et al.</italic> 2013</xref>) as well as several other methodologies. Subsequently computed scores are then available in the final MultiQC report of the pipeline together with tables for further analysis.</p>
    </sec>
    <sec>
      <title>3.7 Reporting</title>
      <p>To facilitate an easy exploration and interpretation of a NanoString experiment results, the pipeline combines the output information of various steps to a comprehensive MultiQC HTML report. Individual results are combined in a general report table with accompanying visualizations [e.g. from the NanoString QC, Normalization and Heatmap (<xref rid="btae019-B5" ref-type="bibr">Gu <italic toggle="yes">et al.</italic> 2016</xref>) generation steps]. As such the report provides a one-stop shop to explore the outcome of any NanoString nCounter analysis, without having to investigate multiple output files for a basic assessment. This is further extended by more detailed reports such as the NACHO QC output report that enables a detailed assessment of the NanoString experiment.</p>
    </sec>
    <sec>
      <title>3.8 Testing</title>
      <p>The pipeline utilizes and benefits from the standardized nf-core approach of testing the pipeline automatically. The accompanying test data is available via the nf-core testing data GitHub repository (Nanostring Test Data) which is also referenced in the respective continuous testing profiles that check the pipeline for consistency (Nanostring Test Profiles). Furthermore, the nf-core website hosts the documentation and the full output of such automated testing runs of the pipeline, so that users can check prior running any tests themselves what the pipeline outputs look like: (nf-co.re/nanostring Results).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>The nf-core/nanostring pipeline has been built using Nextflow and the latest nf-core framework standards (nf-core tools 2.10) to enable both standardized, portable, and reproducible analyses of NanoString nCounter data. The native support for containerization technologies, direct integration into several cloud computing providers supported by Nextflow and several other technological advances such as the pipeline resume feature make the pipeline easy to use. This also holds true in the case of beginners with low to none experience with NanoString nCounter analysis. Additional advantages of the nf-core pipeline include live monitoring as well as standardized parameter documentation via the nf-core project (<ext-link xlink:href="https://nf-co.re" ext-link-type="uri">https://nf-co.re</ext-link>). The pipeline follows the latest nf-core framework template standards and thus supports external computing infrastructure configuration files that are easily adaptable via the nf-core community. Therefore, it can be used and deployed across various institutions and research facilities with very little effort.</p>
    <p>The entire code base for the nf-core/nanostring workflow is available via GitHub in the main nf-core repository hosted for this pipeline [nf-core/nanostring: An analysis pipeline for Nanostring nCounter expression data. (github.com)]. Furthermore, all the documentation of the versioned pipeline is accessible via <ext-link xlink:href="https://nf-co.re/nanostring" ext-link-type="uri">https://nf-co.re/nanostring</ext-link> and accompanied by automatically processed example datasets that users can browse at the following location permanently: <ext-link xlink:href="https://nf-co.re/nanostring/results#nanostring" ext-link-type="uri">https://nf-co.re/nanostring/results#nanostring</ext-link>. This facilitates uptake and understanding of data analysis results by the community and potential future users.</p>
  </sec>
  <sec>
    <title>5 Conclusions</title>
    <p>NanoString nCounter is a widely utilized method for the experimental analysis of up to 800 transcriptomic targets. The nSolver software provided by the manufacturer provides a feasible graphical workbench for the analysis of respective data, however the analysis of large-scale NanoString projects can be cumbersome. Especially when considering other important aspects of modern data analysis such as automation, portability and reproducibility of analyses, the available GUI-based methods cannot fulfill modern requirements. To facilitate the analysis of NanoString nCounter data, we developed an open-source, well documented, scalable, and reproducible Nextflow-based analysis pipeline. The nf-core/nanostring pipeline provides several improvements for researchers searching for a full analysis solution for NanoString nCounter data. The pipeline can handle thousands of samples simultaneously and perform many of the required steps for quality control, normalization, and standardized reporting for NanoString data. Future additions will provide further analysis possibilities such as the integration of improved normalization methods that can be leveraged in an automated fashion and might help to improve the usefulness of the pipeline even further. Here, the pipeline also benefits from the community-driven approach as a part of the nf-core community. Other future directions might involve the ability to perform more advanced differential gene expression analyses, potentially providing output for more complex analysis projects and visual exploration.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to thank Julia F. Soellner, Germán Leparc and Raphaela Gessele for proof checking figures and general input to the manuscript.</p>
  </ack>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>All authors are employees of Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>All work in the manuscript was financed by Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae019-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Canouil</surname><given-names>M</given-names></string-name>, <string-name><surname>Bouland</surname><given-names>GA</given-names></string-name>, <string-name><surname>Bonnefond</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>NACHO: a Nanostring nCounter data QC package</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>36</volume>:<fpage>970</fpage>–<lpage>1</lpage>.</mixed-citation>
    </ref>
    <ref id="btae019-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ewels</surname><given-names>P</given-names></string-name>, <string-name><surname>Magnusson</surname><given-names>M</given-names></string-name>, <string-name><surname>Lundin</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>MultiQC: summarize analysis results for multiple tools and samples in a single report</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>3047</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">27312411</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ewels</surname><given-names>PA</given-names></string-name>, <string-name><surname>Peltzer</surname><given-names>A</given-names></string-name>, <string-name><surname>Fillinger</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>The NF-core framework for community-curated bioinformatics pipelines</article-title>. <source>Nat Biotechnol</source><year>2020</year>;<volume>38</volume>:<fpage>276</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">32055031</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Foroutan</surname><given-names>M</given-names></string-name>, <string-name><surname>Molania</surname><given-names>R</given-names></string-name>, <string-name><surname>Pfefferle</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>The ratio of exhausted to resident infiltrating lymphocytes is prognostic for colorectal cancer patient outcome</article-title>. <source>Cancer Immunol Res</source><year>2021</year>;<volume>9</volume>:<fpage>1125</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">34413087</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Eils</surname><given-names>R</given-names></string-name>, <string-name><surname>Schlesner</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Complex heatmaps reveal patterns and correlations in multidimensional genomic data</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>2847</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">27207943</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hänzelmann</surname><given-names>S</given-names></string-name>, <string-name><surname>Castelo</surname><given-names>R</given-names></string-name>, <string-name><surname>Guinney</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>GSVA: gene set variation analysis for microarray and RNA-Seq data</article-title>. <source>BMC Bioinformatics</source><year>2013</year>;<volume>14</volume>:<fpage>7</fpage>.<pub-id pub-id-type="pmid">23323831</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leprevost</surname><given-names>F</given-names></string-name>, <string-name><surname>da</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>BioContainers: an open-source and community-driven framework for software standardization</article-title>. <source>Bioinformatics</source><year>2017</year>;<volume>33</volume>:<fpage>btx192</fpage>.</mixed-citation>
    </ref>
    <ref id="btae019-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Manning</surname><given-names>J</given-names></string-name>, <string-name><surname>Wacker</surname><given-names>O</given-names></string-name>, <string-name><surname>Peltzer</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal> nf-core/differentialabundance <year>2024</year>.</mixed-citation>
    </ref>
    <ref id="btae019-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Molania</surname><given-names>R</given-names></string-name>, <string-name><surname>Gagnon-Bartsch</surname><given-names>JA</given-names></string-name>, <string-name><surname>Dobrovic</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>A new normalization for nanostring nCounter gene expression data</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>6073</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">31114909</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morrow</surname><given-names>M</given-names></string-name>, <string-name><surname>Donaldson</surname><given-names>J.</given-names></string-name></person-group><article-title>Nanostring’s nCounter—a true digital target profiling technology</article-title>. <source>PDA J Pharm Sci Technol</source><year>2011</year>;<volume>65</volume>:<fpage>692</fpage>.<pub-id pub-id-type="pmid">22294601</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B11">
      <mixed-citation publication-type="other"><collab>Nanostring Technologies Incorporated</collab>. <italic toggle="yes">Analysis Software User Manual nSolver 4.0</italic>, Nanostring Technologies <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="btae019-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Souiai</surname><given-names>O</given-names></string-name>, <string-name><surname>Tibshirani</surname><given-names>R</given-names></string-name>, <string-name><surname>Chu</surname><given-names>G.</given-names></string-name></person-group><article-title>Significance analysis of microarrays applied to the ionizing radiation response</article-title>. <source>Proc Natl Acad Sci USA</source><year>2001</year>;<volume>98</volume>:<fpage>5116</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">11309499</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tomfohr</surname><given-names>J</given-names></string-name>, <string-name><surname>Lu</surname><given-names>J</given-names></string-name>, <string-name><surname>Kepler</surname><given-names>TB</given-names></string-name></person-group><etal>et al</etal><article-title>Pathway level analysis of gene expression using singular value decomposition</article-title>. <source>BMC Bioinformatics</source><year>2005</year>;<volume>6</volume>:<fpage>225</fpage>.<pub-id pub-id-type="pmid">16156896</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tommaso</surname><given-names>PD</given-names></string-name>, <string-name><surname>Chatzou</surname><given-names>M</given-names></string-name>, <string-name><surname>Floden</surname><given-names>EW</given-names></string-name></person-group><etal>et al</etal><article-title>Nextflow enables reproducible computational workflows</article-title>. <source>Nat Biotechnol</source><year>2017</year>;<volume>35</volume>:<fpage>316</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">28398311</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>H</given-names></string-name>, <string-name><surname>Horbinski</surname><given-names>C</given-names></string-name>, <string-name><surname>Wu</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>NanoStringDiff: a novel statistical method for differential expression analysis based on NanoString nCounter data</article-title>. <source>Nucleic Acids Res</source><year>2016</year>;<volume>44</volume>:<fpage>e151</fpage>.<pub-id pub-id-type="pmid">27471031</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H.</given-names></string-name></person-group><article-title>ggplot2</article-title>. <source>Wiley Interdiscip Rev Comput Stat</source><year>2011</year>;<volume>3</volume>:<fpage>180</fpage>–<lpage>5</lpage>.</mixed-citation>
    </ref>
    <ref id="btae019-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H</given-names></string-name>, <string-name><surname>Averick</surname><given-names>M</given-names></string-name>, <string-name><surname>Bryan</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Welcome to the Tidyverse</article-title>. <source>J. Open Source Softw</source><year>2019</year>;<volume>4</volume>:<fpage>1686</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10805338</article-id>
    <article-id pub-id-type="pmid">38212989</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae019</article-id>
    <article-id pub-id-type="publisher-id">btae019</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>nf-core/nanostring: a pipeline for reproducible NanoString nCounter analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6503-2180</contrib-id>
        <name>
          <surname>Peltzer</surname>
          <given-names>Alexander</given-names>
        </name>
        <aff><institution>Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG</institution>, 88400 Biberach/Riss, <country country="DE">Germany</country></aff>
        <xref rid="btae019-cor1" ref-type="corresp"/>
        <!--alexander.peltzer@boehringer-ingelheim.com-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mohr</surname>
          <given-names>Christopher</given-names>
        </name>
        <aff><institution>Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG</institution>, 88400 Biberach/Riss, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8036-1492</contrib-id>
        <name>
          <surname>Stadermann</surname>
          <given-names>Kai B</given-names>
        </name>
        <aff><institution>Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG</institution>, 88400 Biberach/Riss, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zwick</surname>
          <given-names>Matthias</given-names>
        </name>
        <aff><institution>Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG</institution>, 88400 Biberach/Riss, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schmid</surname>
          <given-names>Ramona</given-names>
        </name>
        <aff><institution>Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG</institution>, 88400 Biberach/Riss, <country country="DE">Germany</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Boeva</surname>
          <given-names>Valentina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae019-cor1">Corresponding author. Clinical Bioinformatics and Systems Pharmacology, Translational Medicine and Clinical Pharmacology, Boehringer Ingelheim Pharma GmbH &amp; Co. KG, 88400 Biberach/Riss, Germany. E-mail: <email>alexander.peltzer@boehringer-ingelheim.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-01-11">
      <day>11</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>1</issue>
    <elocation-id>btae019</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>02</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>22</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae019.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The NanoString™ nCounter<sup>®</sup> technology platform is a widely used targeted quantification platform for the analysis of gene expression of up to ∼800 genes. Whereas the software tools by the manufacturer can perform the analysis in an interactive and GUI driven approach, there is no portable and user-friendly workflow available that can be used to perform reproducible analysis of multiple samples simultaneously in a scalable fashion on different computing infrastructures.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present the nf-core/nanostring open-source pipeline to perform a comprehensive analysis including quality control and additional features such as expression visualization, annotation with additional metadata and input creation for differential gene expression analysis. The workflow features an easy installation, comprehensive documentation, open-source code with the possibility for further extensions, a strong portability across multiple computing environments and detailed quality metrics reporting covering all parts of the pipeline. nf-core/nanostring has been implemented in the Nextflow workflow language and supports Docker, Singularity, Podman container technologies as well as Conda environments, enabling easy deployment on any Nextflow supported compatible system, including most widely used cloud computing environments such as Google GCP or Amazon AWS.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The source code, documentation and installation instructions as well as results for continuous tests are freely available at <ext-link xlink:href="https://github.com/nf-core/nanostring" ext-link-type="uri">https://github.com/nf-core/nanostring</ext-link> and <ext-link xlink:href="https://nf-co.re/nanostring" ext-link-type="uri">https://nf-co.re/nanostring</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Boehringer Ingelheim Pharma GmbH &amp; Co</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The NanoString™ nCounter<sup>®</sup> technology platform (<xref rid="btae019-B10" ref-type="bibr">Morrow and Donaldson 2011</xref>) is a widely used targeted quantification platform for the analysis of gene expression of up to ∼800 genes. The nCounter<sup>®</sup> software suite nSolver™ provided by Nanostring Technologies can be used to perform data analysis, quality control and visualization although—as has been stated by other researchers already (<xref rid="btae019-B1" ref-type="bibr">Canouil <italic toggle="yes">et al.</italic> 2019</xref>)—the method only performs limited normalization and visualization. While these limitations can be partially overcome by utilizing other tools such as R package NACHO (<xref rid="btae019-B1" ref-type="bibr">Canouil <italic toggle="yes">et al.</italic> 2019</xref>), analyzing large numbers of samples can be cumbersome using a graphical user interface that requires dozens of settings to be configured manually and is thus not suitable for large-scale analysis projects, especially where automated reproducible analysis is key. To address these shortcomings, we developed a Nextflow (<xref rid="btae019-B14" ref-type="bibr">Tommaso <italic toggle="yes">et al.</italic> 2017</xref>)-based analysis pipeline within the nf-core (<xref rid="btae019-B3" ref-type="bibr">Ewels <italic toggle="yes">et al.</italic> 2020</xref>) framework. The pipeline can be used to perform QC, normalization, visualize optional output from nSolver<sup>®</sup>, annotate normalized gene expression tables in several standardized output formats. It also outputs a detailed report using MultiQC (<xref rid="btae019-B2" ref-type="bibr">Ewels <italic toggle="yes">et al.</italic> 2016</xref>), allowing users to assess the quality of their analyzed data quickly and explore some of the downstream analysis results that the pipeline automatically creates. Future developments will incorporate additional possibilities such as the analysis of GeoMx<sup>®</sup> data and gene score computation within the pipeline.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>The nf-core/nanostring pipeline was written using Nextflow (<xref rid="btae019-B14" ref-type="bibr">Tommaso <italic toggle="yes">et al.</italic> 2017</xref>). Nextflow is a domain specific language that enables writing data intensive analysis pipelines in a reproducible, portable, and scalable way. We also utilized the community curated nf-core (<xref rid="btae019-B3" ref-type="bibr">Ewels <italic toggle="yes">et al.</italic> 2020</xref>) template for the development of the pipeline to follow best-practices from the community and adhere to well established standards. All individual parts of the pipeline are available as Docker and Singularity containers via the Biocontainers (<xref rid="btae019-B7" ref-type="bibr">Leprevost <italic toggle="yes">et al.</italic> 2017</xref>) initiative to ensure reproducibility of each step of the analysis.</p>
    <p>The nf-core/nanostring pipeline comprised several components, that handle quality control of NanoString data, normalization of the obtained counts, annotation of the respective output matrix and the generation of expression files that allow for further downstream analyses. The outline of the pipeline is displayed in <xref rid="btae019-F1" ref-type="fig">Fig. 1</xref>, whereas the individual steps are described further in the paragraph below.</p>
    <fig position="float" id="btae019-F1">
      <label>Figure 1.</label>
      <caption>
        <p>nf-core/nanostring pipeline outline, describing the individual pipeline steps.</p>
      </caption>
      <graphic xlink:href="btae019f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Design file</title>
      <p>The pipeline requires a comma separated sample sheet file as input to describe samples and accompanying metadata. Mandatory input that needs to be specified is the location of RCC files as produced by the NanoString nCounter instrument and a sample identifier. Additional metadata can be provided by the user to allow for easier integration with downstream analysis methods.</p>
      <p>Values can also be set to NA if not available and the pipeline will then e.g. exclude samples from such analysis where the respective metadata would be a requirement for further analysis.</p>
      <p>The pipeline ultimately creates expression and normalized expression tables which can e.g. be used to perform differential gene expression analysis using other pipelines such as nf-core/differentialabundance (<xref rid="btae019-B8" ref-type="bibr">Manning <italic toggle="yes">et al.</italic> 2024</xref>) without a requirement to perform reformatting of the data tables.</p>
    </sec>
    <sec>
      <title>3.2 Nanostring QC</title>
      <p>This step of the pipeline performs quality control of the supplied RCC input data with the R package NACHO (<xref rid="btae019-B1" ref-type="bibr">Canouil <italic toggle="yes">et al.</italic> 2019</xref>) and thereby creates several diagnostic reports that can be used to assess sample quality with respect to key criteria as defined by the manufacturer. These QC metrics include Binding Density (BD), Field of View (FOV), Positive Control Linearity (PCL), Limit of Detection (LoD) as well as further key criteria required to assess the quality of a NanoString nCounter experiment. For a full list, please refer to the NACHO publication or GitHub page (<ext-link xlink:href="https://github.com/mcanouil/NACHO" ext-link-type="uri">https://github.com/mcanouil/NACHO</ext-link>) that explains the reports in more detail. The individual reporting images are furthermore integrated into the main pipeline report created via MultiQC to provide a comprehensive report for the entire pipeline run. This assists users to assess data quality and results jointly for all provided samples.</p>
    </sec>
    <sec>
      <title>3.3 Normalize</title>
      <p>The normalization step of the pipeline applies RCC normalization as described in the manufacturer documentation, e.g. takes both positive control and negative controls into account and can further be used to perform housekeeper normalization. Users can choose between both the default geometric mean (GEO) normalization (<xref rid="btae019-B11" ref-type="bibr">Nanostring Technologies Incorporated 2018</xref>) and the more advanced generalized linear model normalization (<xref rid="btae019-B15" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2016</xref>) and can customize the normalization method to their liking. By utilizing the GEO normalization, the normalized data is equivalent to output of the Nanostring nCounter analysis software. Housekeeping gene-based normalization is used to correct for variability of sample input and therefore accounts for differences between lanes in terms of amount and quality of RNA (<xref rid="btae019-B11" ref-type="bibr">Nanostring Technologies Incorporated 2018</xref>). Users furthermore receive the raw counts, normalization factors, normalized counts in a standardized set of output files and can then thus check the effects of normalization on their respective data easily. Furthermore, users receive both housekeeping normalized and nonhousekeeping results automatically. The pipeline utilizes the implementation of above methods as integrated in the NACHO R (<xref rid="btae019-B1" ref-type="bibr">Canouil <italic toggle="yes">et al.</italic> 2019</xref>) package.</p>
      <p>Future updates to the pipeline might include other options that have been shown to provide even improved normalization results in cases where technical replicates are available (<xref rid="btae019-B9" ref-type="bibr">Molania <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    </sec>
    <sec>
      <title>3.4 Annotation and expression table creation</title>
      <p>Next, the normalized gene expression matrix is annotated by combining the design input about treatment, time, and other additional metadata with the normalized expression values to allow for further downstream analysis. Users can then load the tables in downstream methods and other analysis pipelines to e.g. perform differential gene expression analysis and/or pathway analysis.</p>
    </sec>
    <sec>
      <title>3.5 Heatmap of gene expression</title>
      <p>After normalization, the pipeline creates an overview heatmap (<xref rid="btae019-B5" ref-type="bibr">Gu <italic toggle="yes">et al.</italic> 2016</xref>) of gene expression values to assess gene expression intensities on a panel level. The heatmap is generated using standard R packages such as tidyverse (<xref rid="btae019-B17" ref-type="bibr">Wickham <italic toggle="yes">et al.</italic> 2019</xref>), ggplot2 (<xref rid="btae019-B16" ref-type="bibr">Wickham 2011</xref>), and ComplexHeatmap (<xref rid="btae019-B5" ref-type="bibr">Gu <italic toggle="yes">et al.</italic> 2016</xref>). This heatmap is also available in the final pipeline report.</p>
    </sec>
    <sec>
      <title>3.6 Gene scores</title>
      <p>Users can compute gene scores inside the pipeline by supplying a custom YAML formatted description file with the desired set(s) of genes and choosing one of the available methods for computing such gene scores. Available methods include PLAGE (<xref rid="btae019-B13" ref-type="bibr">Tomfohr <italic toggle="yes">et al.</italic> 2005</xref>), GSVA (<xref rid="btae019-B6" ref-type="bibr">Hänzelmann <italic toggle="yes">et al.</italic> 2013</xref>), SINGSCORE (<xref rid="btae019-B4" ref-type="bibr">Foroutan <italic toggle="yes">et al.</italic> 2021</xref>), SAMS (<xref rid="btae019-B12" ref-type="bibr">Souiai <italic toggle="yes">et al.</italic> 2001</xref>), and SSGSEA (<xref rid="btae019-B6" ref-type="bibr">Hänzelmann <italic toggle="yes">et al.</italic> 2013</xref>) as well as several other methodologies. Subsequently computed scores are then available in the final MultiQC report of the pipeline together with tables for further analysis.</p>
    </sec>
    <sec>
      <title>3.7 Reporting</title>
      <p>To facilitate an easy exploration and interpretation of a NanoString experiment results, the pipeline combines the output information of various steps to a comprehensive MultiQC HTML report. Individual results are combined in a general report table with accompanying visualizations [e.g. from the NanoString QC, Normalization and Heatmap (<xref rid="btae019-B5" ref-type="bibr">Gu <italic toggle="yes">et al.</italic> 2016</xref>) generation steps]. As such the report provides a one-stop shop to explore the outcome of any NanoString nCounter analysis, without having to investigate multiple output files for a basic assessment. This is further extended by more detailed reports such as the NACHO QC output report that enables a detailed assessment of the NanoString experiment.</p>
    </sec>
    <sec>
      <title>3.8 Testing</title>
      <p>The pipeline utilizes and benefits from the standardized nf-core approach of testing the pipeline automatically. The accompanying test data is available via the nf-core testing data GitHub repository (Nanostring Test Data) which is also referenced in the respective continuous testing profiles that check the pipeline for consistency (Nanostring Test Profiles). Furthermore, the nf-core website hosts the documentation and the full output of such automated testing runs of the pipeline, so that users can check prior running any tests themselves what the pipeline outputs look like: (nf-co.re/nanostring Results).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>The nf-core/nanostring pipeline has been built using Nextflow and the latest nf-core framework standards (nf-core tools 2.10) to enable both standardized, portable, and reproducible analyses of NanoString nCounter data. The native support for containerization technologies, direct integration into several cloud computing providers supported by Nextflow and several other technological advances such as the pipeline resume feature make the pipeline easy to use. This also holds true in the case of beginners with low to none experience with NanoString nCounter analysis. Additional advantages of the nf-core pipeline include live monitoring as well as standardized parameter documentation via the nf-core project (<ext-link xlink:href="https://nf-co.re" ext-link-type="uri">https://nf-co.re</ext-link>). The pipeline follows the latest nf-core framework template standards and thus supports external computing infrastructure configuration files that are easily adaptable via the nf-core community. Therefore, it can be used and deployed across various institutions and research facilities with very little effort.</p>
    <p>The entire code base for the nf-core/nanostring workflow is available via GitHub in the main nf-core repository hosted for this pipeline [nf-core/nanostring: An analysis pipeline for Nanostring nCounter expression data. (github.com)]. Furthermore, all the documentation of the versioned pipeline is accessible via <ext-link xlink:href="https://nf-co.re/nanostring" ext-link-type="uri">https://nf-co.re/nanostring</ext-link> and accompanied by automatically processed example datasets that users can browse at the following location permanently: <ext-link xlink:href="https://nf-co.re/nanostring/results#nanostring" ext-link-type="uri">https://nf-co.re/nanostring/results#nanostring</ext-link>. This facilitates uptake and understanding of data analysis results by the community and potential future users.</p>
  </sec>
  <sec>
    <title>5 Conclusions</title>
    <p>NanoString nCounter is a widely utilized method for the experimental analysis of up to 800 transcriptomic targets. The nSolver software provided by the manufacturer provides a feasible graphical workbench for the analysis of respective data, however the analysis of large-scale NanoString projects can be cumbersome. Especially when considering other important aspects of modern data analysis such as automation, portability and reproducibility of analyses, the available GUI-based methods cannot fulfill modern requirements. To facilitate the analysis of NanoString nCounter data, we developed an open-source, well documented, scalable, and reproducible Nextflow-based analysis pipeline. The nf-core/nanostring pipeline provides several improvements for researchers searching for a full analysis solution for NanoString nCounter data. The pipeline can handle thousands of samples simultaneously and perform many of the required steps for quality control, normalization, and standardized reporting for NanoString data. Future additions will provide further analysis possibilities such as the integration of improved normalization methods that can be leveraged in an automated fashion and might help to improve the usefulness of the pipeline even further. Here, the pipeline also benefits from the community-driven approach as a part of the nf-core community. Other future directions might involve the ability to perform more advanced differential gene expression analyses, potentially providing output for more complex analysis projects and visual exploration.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to thank Julia F. Soellner, Germán Leparc and Raphaela Gessele for proof checking figures and general input to the manuscript.</p>
  </ack>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>All authors are employees of Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>All work in the manuscript was financed by Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae019-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Canouil</surname><given-names>M</given-names></string-name>, <string-name><surname>Bouland</surname><given-names>GA</given-names></string-name>, <string-name><surname>Bonnefond</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>NACHO: a Nanostring nCounter data QC package</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>36</volume>:<fpage>970</fpage>–<lpage>1</lpage>.</mixed-citation>
    </ref>
    <ref id="btae019-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ewels</surname><given-names>P</given-names></string-name>, <string-name><surname>Magnusson</surname><given-names>M</given-names></string-name>, <string-name><surname>Lundin</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>MultiQC: summarize analysis results for multiple tools and samples in a single report</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>3047</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">27312411</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ewels</surname><given-names>PA</given-names></string-name>, <string-name><surname>Peltzer</surname><given-names>A</given-names></string-name>, <string-name><surname>Fillinger</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>The NF-core framework for community-curated bioinformatics pipelines</article-title>. <source>Nat Biotechnol</source><year>2020</year>;<volume>38</volume>:<fpage>276</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">32055031</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Foroutan</surname><given-names>M</given-names></string-name>, <string-name><surname>Molania</surname><given-names>R</given-names></string-name>, <string-name><surname>Pfefferle</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>The ratio of exhausted to resident infiltrating lymphocytes is prognostic for colorectal cancer patient outcome</article-title>. <source>Cancer Immunol Res</source><year>2021</year>;<volume>9</volume>:<fpage>1125</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">34413087</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Eils</surname><given-names>R</given-names></string-name>, <string-name><surname>Schlesner</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Complex heatmaps reveal patterns and correlations in multidimensional genomic data</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>2847</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">27207943</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hänzelmann</surname><given-names>S</given-names></string-name>, <string-name><surname>Castelo</surname><given-names>R</given-names></string-name>, <string-name><surname>Guinney</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>GSVA: gene set variation analysis for microarray and RNA-Seq data</article-title>. <source>BMC Bioinformatics</source><year>2013</year>;<volume>14</volume>:<fpage>7</fpage>.<pub-id pub-id-type="pmid">23323831</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leprevost</surname><given-names>F</given-names></string-name>, <string-name><surname>da</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>BioContainers: an open-source and community-driven framework for software standardization</article-title>. <source>Bioinformatics</source><year>2017</year>;<volume>33</volume>:<fpage>btx192</fpage>.</mixed-citation>
    </ref>
    <ref id="btae019-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Manning</surname><given-names>J</given-names></string-name>, <string-name><surname>Wacker</surname><given-names>O</given-names></string-name>, <string-name><surname>Peltzer</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal> nf-core/differentialabundance <year>2024</year>.</mixed-citation>
    </ref>
    <ref id="btae019-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Molania</surname><given-names>R</given-names></string-name>, <string-name><surname>Gagnon-Bartsch</surname><given-names>JA</given-names></string-name>, <string-name><surname>Dobrovic</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>A new normalization for nanostring nCounter gene expression data</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>6073</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">31114909</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morrow</surname><given-names>M</given-names></string-name>, <string-name><surname>Donaldson</surname><given-names>J.</given-names></string-name></person-group><article-title>Nanostring’s nCounter—a true digital target profiling technology</article-title>. <source>PDA J Pharm Sci Technol</source><year>2011</year>;<volume>65</volume>:<fpage>692</fpage>.<pub-id pub-id-type="pmid">22294601</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B11">
      <mixed-citation publication-type="other"><collab>Nanostring Technologies Incorporated</collab>. <italic toggle="yes">Analysis Software User Manual nSolver 4.0</italic>, Nanostring Technologies <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="btae019-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Souiai</surname><given-names>O</given-names></string-name>, <string-name><surname>Tibshirani</surname><given-names>R</given-names></string-name>, <string-name><surname>Chu</surname><given-names>G.</given-names></string-name></person-group><article-title>Significance analysis of microarrays applied to the ionizing radiation response</article-title>. <source>Proc Natl Acad Sci USA</source><year>2001</year>;<volume>98</volume>:<fpage>5116</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">11309499</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tomfohr</surname><given-names>J</given-names></string-name>, <string-name><surname>Lu</surname><given-names>J</given-names></string-name>, <string-name><surname>Kepler</surname><given-names>TB</given-names></string-name></person-group><etal>et al</etal><article-title>Pathway level analysis of gene expression using singular value decomposition</article-title>. <source>BMC Bioinformatics</source><year>2005</year>;<volume>6</volume>:<fpage>225</fpage>.<pub-id pub-id-type="pmid">16156896</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tommaso</surname><given-names>PD</given-names></string-name>, <string-name><surname>Chatzou</surname><given-names>M</given-names></string-name>, <string-name><surname>Floden</surname><given-names>EW</given-names></string-name></person-group><etal>et al</etal><article-title>Nextflow enables reproducible computational workflows</article-title>. <source>Nat Biotechnol</source><year>2017</year>;<volume>35</volume>:<fpage>316</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">28398311</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>H</given-names></string-name>, <string-name><surname>Horbinski</surname><given-names>C</given-names></string-name>, <string-name><surname>Wu</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>NanoStringDiff: a novel statistical method for differential expression analysis based on NanoString nCounter data</article-title>. <source>Nucleic Acids Res</source><year>2016</year>;<volume>44</volume>:<fpage>e151</fpage>.<pub-id pub-id-type="pmid">27471031</pub-id></mixed-citation>
    </ref>
    <ref id="btae019-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H.</given-names></string-name></person-group><article-title>ggplot2</article-title>. <source>Wiley Interdiscip Rev Comput Stat</source><year>2011</year>;<volume>3</volume>:<fpage>180</fpage>–<lpage>5</lpage>.</mixed-citation>
    </ref>
    <ref id="btae019-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H</given-names></string-name>, <string-name><surname>Averick</surname><given-names>M</given-names></string-name>, <string-name><surname>Bryan</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Welcome to the Tidyverse</article-title>. <source>J. Open Source Softw</source><year>2019</year>;<volume>4</volume>:<fpage>1686</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
