<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8163799</article-id>
    <article-id pub-id-type="publisher-id">23576</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-021-23576-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Enhancing CRISPR-Cas9 gRNA efficiency prediction by data integration and deep learning</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Xiang</surname>
          <given-names>Xi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5932-0664</contrib-id>
        <name>
          <surname>Corsi</surname>
          <given-names>Giulia I.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Anthon</surname>
          <given-names>Christian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Qu</surname>
          <given-names>Kunli</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pan</surname>
          <given-names>Xiaoguang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liang</surname>
          <given-names>Xue</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Han</surname>
          <given-names>Peng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dong</surname>
          <given-names>Zhanying</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Lijun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhong</surname>
          <given-names>Jiayan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Tao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Jinbao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Xiuqing</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Hui</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Fengping</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3256-2940</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Xin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5338-5173</contrib-id>
        <name>
          <surname>Xu</surname>
          <given-names>Xun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Jian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Huanming</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bolund</surname>
          <given-names>Lars</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Church</surname>
          <given-names>George M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff10">10</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7546-4948</contrib-id>
        <name>
          <surname>Lin</surname>
          <given-names>Lin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff11">11</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Gorodkin</surname>
          <given-names>Jan</given-names>
        </name>
        <address>
          <email>gorodkin@rth.dk</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0007-7759</contrib-id>
        <name>
          <surname>Luo</surname>
          <given-names>Yonglun</given-names>
        </name>
        <address>
          <email>alun@biomed.au.dk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff11">11</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Lars Bolund Institute of Regenerative Medicine, Qingdao-Europe Advanced Institute for Life Sciences, BGI-Qingdao, Qingdao, China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.410726.6</institution-id><institution-id institution-id-type="ISNI">0000 0004 1797 8419</institution-id><institution>BGI Education Center, University of Chinese Academy of Sciences, </institution></institution-wrap>Shenzhen, China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.21155.32</institution-id><institution-id institution-id-type="ISNI">0000 0001 2034 1839</institution-id><institution>BGI-Shenzhen, </institution></institution-wrap>Shenzhen, China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.7048.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 1956 2722</institution-id><institution>Department of Biomedicine, </institution><institution>Aarhus University, </institution></institution-wrap>Aarhus, Denmark </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.5254.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 0674 042X</institution-id><institution>Center for non-coding RNA in Technology and Health, Department of Veterinary and Animal Sciences, Faculty of Health and Medical Sciences, </institution><institution>University of Copenhagen, </institution></institution-wrap>Frederiksberg, Denmark </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.5254.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 0674 042X</institution-id><institution>Department of Biology, </institution><institution>University of Copenhagen, </institution></institution-wrap>Copenhagen, Denmark </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.21155.32</institution-id><institution-id institution-id-type="ISNI">0000 0001 2034 1839</institution-id><institution>MGI, BGI-Shenzhen, </institution></institution-wrap>Shenzhen, China </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="GRID">grid.21155.32</institution-id><institution-id institution-id-type="ISNI">0000 0001 2034 1839</institution-id><institution>Guangdong Provincial Key Laboratory of Genome Read and Write, BGI-Shenzhen, </institution></institution-wrap>Shenzhen, China </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="GRID">grid.21155.32</institution-id><institution-id institution-id-type="ISNI">0000 0001 2034 1839</institution-id><institution>Guangdong Provincial Academician Workstation of BGI Synthetic Genomics, BGI-Shenzhen, </institution></institution-wrap>Shenzhen, China </aff>
      <aff id="Aff10"><label>10</label><institution-wrap><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution>Department of Genetics, </institution><institution>Blavatnik Institute, Harvard Medical School, </institution></institution-wrap>Boston, MA USA </aff>
      <aff id="Aff11"><label>11</label><institution-wrap><institution-id institution-id-type="GRID">grid.7048.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 1956 2722</institution-id><institution>Steno Diabetes Center Aarhus, Aarhus University, </institution></institution-wrap>Aarhus, Denmark </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>12</volume>
    <elocation-id>3238</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>5</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>5</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The design of CRISPR gRNAs requires accurate on-target efficiency predictions, which demand high-quality gRNA activity data and efficient modeling. To advance, we here report on the generation of on-target gRNA activity data for 10,592 SpCas9 gRNAs. Integrating these with complementary published data, we train a deep learning model, CRISPRon, on 23,902 gRNAs. Compared to existing tools, CRISPRon exhibits significantly higher prediction performances on four test datasets not overlapping with training data used for the development of these tools. Furthermore, we present an interactive gRNA design webserver based on the CRISPRon standalone software, both available via <ext-link ext-link-type="uri" xlink:href="https://rth.dk/resources/crispr/">https://rth.dk/resources/crispr/</ext-link>. CRISPRon advances CRISPR applications by providing more accurate gRNA efficiency predictions than the existing tools.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">High-quality gRNA activity data is needed for accurate on-target efficiency predictions. Here the authors generate activity data for over 10,000 gRNA and build a deep learning model CRISPRon for improved performance predictions.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>CRISPR-Cas9 genome editing</kwd>
      <kwd>Biotechnology</kwd>
      <kwd>Data acquisition</kwd>
      <kwd>Databases</kwd>
      <kwd>Genomic engineering</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100010661</institution-id>
            <institution>EC | Horizon 2020 Framework Programme (EU Framework Programme for Research and Innovation H2020)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>899417</award-id>
        <principal-award-recipient>
          <name>
            <surname>Luo</surname>
            <given-names>Yonglun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR)-associated protein 9 (Cas9) has been successfully harnessed for programmable RNA-guided genome editing in prokaryotes, humans and many other living organisms<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR5">5</xref></sup>. A successful CRISPR gene editing application depends greatly on the selection of highly efficient gRNAs. Several machine and deep learning methods have been developed in the past decade to predict on-target gRNA activity<sup><xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR16">16</xref></sup>. However, some of these models exhibit discrepancies in the parameters selected for model validation, and in the data used for testing, which directly impact on the performances reported for such tools (Supplementary Notes <xref rid="MOESM1" ref-type="media">1</xref>-<xref rid="MOESM2" ref-type="media">2</xref>). For instance, the prediction performances of the recent DeepSpCas9variants model<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> appear to be substantially higher when both canonical and noncanonical PAMs are employed for testing compared to an evaluation based solely on canonical PAMs, which are preferred for gRNA designs (Spearman’s R = 0.94 decreases to R = 0.70, Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>). While the application of more advanced machine learning strategies has relatively modest impact on gRNA activity prediction performances, a significant improvement can be achieved by increasing the size and the quality of the training data (Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    <p id="Par4">Recent models trained on large-scale data still lack full saturation of their learning curve<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR14">14</xref></sup>, thus leaving space for further data-driven improvement. At present, the amount of gRNA efficiency data suitable to develop machine learning models remains scarce, mostly due to the low homogeneity between studies in terms of experimental design and cleavage evaluation methodologies, which can vary from loss of function, e.g., Xu et al. (2015), Hart et al. (2015), and Doench et al. (2014–2016)<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref></sup>, to indels quantification, e.g., Chari et al. (2015), Wang et al. (2019), and Kim et al. (2019–2020)<sup><xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup>. It is thus essential to produce additional data from gRNA activity compatible with previous studies to develop more accurate prediction methods. To overcome the scarcity of experimental on-target efficiency data previous studies have employed techniques such as data augmentation, widely known in the field of image recognition, creating new input–output pairs by introducing minor alterations in the input sequence of experimentally validated gRNAs while considering their output, the efficiency, unaffected<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. However, while two mirrored images are encoded by highly different input matrices but maintain the same original meaning, augmented gRNA data are highly redundant and do not guarantee consistency in terms of cleavage efficiency. Thus, data quantity remains the major bottleneck for improving predictors<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR14">14</xref></sup> (see also Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    <p id="Par5">Here, we show that lentiviral surrogate vectors can faithfully capture gRNA efficiencies at endogenous genomic loci. Using this approach, we generate on-target gRNA activity data for 10,592 SpCas9 gRNAs. After integrating them with complementary published data (resulting in activity data for a total of 23,902 gRNAs), we develop a deep learning prediction model, CRISPRon, which exhibits significantly higher prediction performances on independent test datasets compared to existing tools. The analysis of features governing gRNA efficiency shows that the gRNA-DNA binding energy ΔG<sub>B</sub> is a major contributor in predicting the on-target activity of gRNAs. Furthermore, we develop an interactive gRNA design webserver based on the CRISPRon standalone software, both available via <ext-link ext-link-type="uri" xlink:href="https://rth.dk/resources/crispr/">https://rth.dk/resources/crispr/</ext-link>. The software may also be downloaded from GitHub on <ext-link ext-link-type="uri" xlink:href="https://github.com/RTH-tools/crispron/">https://github.com/RTH-tools/crispron/</ext-link><sup><xref ref-type="bibr" rid="CR22">22</xref></sup>.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>Massively parallel quantification of gRNA efficiency in cells</title>
      <p id="Par6">To generate further high-quality CRISPR on-target gRNA activity data, we established a high-throughput approach to measure gRNA activity in cells (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>) based on a barcoded gRNA oligonucleotide pool strategy as described previously<sup><xref ref-type="bibr" rid="CR23">23</xref>,<xref ref-type="bibr" rid="CR24">24</xref></sup>. Several optimizations of the original methods<sup><xref ref-type="bibr" rid="CR23">23</xref>,<xref ref-type="bibr" rid="CR24">24</xref></sup> were introduced to simplify and streamline vector cloning, lentiviral packaging and enrichment of gene edited cells (see Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). To validate if the indel frequency introduced at the 37 bp surrogate target site could recapitulate that at the corresponding endogenous sites, we analyzed indel frequency at 16 surrogate sites and their corresponding endogenous genomic loci in HEK293T cells by deep sequencing. We obtained a fine correlation between the surrogate and endogenous sites in terms of indel frequencies and profiles (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>, Spearman’s R = 0.72, <italic>p</italic>-value = 0.0016), in agreement with previous findings<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR23">23</xref>,<xref ref-type="bibr" rid="CR24">24</xref></sup>.<fig id="Fig1"><label>Fig. 1</label><caption><title>High-throughput quantification of gRNA efficiency in cells.</title><p><bold>a</bold> Schematic illustration of the lentiviral surrogate vector, oligo pool synthesis, PCR amplification, golden-gate assembly, lentivirus packaging, and transduction. <bold>b</bold> gRNA editing efficiency of all surrogate sites measured by targeted amplicon sequencing. Results are shown for HEK293T-SpCas9 cells at 2, 8, and 10 days after transduction. <bold>c</bold> Correlation between gRNA editing efficiency at 8 and 10 days after transduction. <bold>d</bold> Indel profiles (1–30 bp deletion, 1–10 bp insertion) for all surrogate sites introduced by SpCas9 in HEK293T-SpCas9 cells at 2, 8, and 10 days post transduction. <bold>e</bold> Correlation between the indel profiles measured in cells and those predicted by inDelphi. Data are presented as violin plot with median and quartiles. <bold>f</bold> Dot plot of 1-bp insertion indel frequency (mean ± 95% confidence interval), stratified by the nucleotide at N17 position of the protospacer and the type of nucleotide inserted (see also Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>). <bold>g</bold> Correlation between gRNA editing efficiencies measured in this and other major studies for common gRNA + PAM (23 nt) examples, also displayed in a Venn diagram.</p></caption><graphic xlink:href="41467_2021_23576_Fig1_HTML" id="d32e677"/></fig></p>
      <p id="Par7">We next generated a large dataset of high-quality CRISPR gRNA activity data in cells using this optimized approach. A pool of 12,000 gRNA oligos, targeting 3834 human protein-coding genes (Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>, Supplementary Note <xref rid="MOESM1" ref-type="media">4</xref>), were array-synthesized and selected to avoid large overlap with existing datasets. Targeted amplicon sequencing (depth &gt; 1000) of the surrogate oligo pool, surrogate gRNA plasmid library and transduced wild-type HEK293T cells (multiplexity of infection (MOI) of 0.3) revealed that over 99% of the designed gRNAs were present in the 12 K gRNA plasmid pool and transduced cells (Supplementary Figs. <xref rid="MOESM1" ref-type="media">4</xref>-<xref rid="MOESM1" ref-type="media">5</xref>, source data). We transduced the SpCas9-expressing and wild-type HEK293T cells with the gRNA library with a MOI of 0.3 and a transduction coverage of ~4000 cells per gRNA. A pipeline was established to analyze CRISPR-induced indels and remove sequence variants introduced by oligo-synthesis, PCRs, and deep sequencing, as well as low quantity sites (less than 200 reads, see Methods). Indel frequencies in the cells 2, 8, and 10 days after transduction were analyzed by targeted deep sequencing (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>). Following increased editing time and enrichment of edited cells (puromycin selection), indel frequency rose significantly in cells from day 2 to day 8–10 (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). Overexpression of SpCas9 by doxycycline (Dox) addition leads to a skewed distribution of gRNA efficiency (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>, Supplementary Note <xref rid="MOESM1" ref-type="media">4</xref>), thus gRNA efficiencies from Dox-treated SpCas9 cells were excluded for gRNA efficiency prediction model establishment. The indel frequency (on-target activity) of gRNAs from day 8 and 10 were well correlated (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>, Spearman’s R = 0.91). Corroborating previous findings, the indel types introduced by SpCas9 comprise mainly small deletions and 1 bp insertion (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>, Supplementary Figs. <xref rid="MOESM1" ref-type="media">7</xref>-<xref rid="MOESM1" ref-type="media">8</xref>) and compared to day 2 the indel types from day 8–10 are better correlated with the indel profiles predicted by inDelphi<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> (Fig. <xref rid="Fig1" ref-type="fig">1e</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>-<xref rid="MOESM1" ref-type="media">8</xref>, Supplementary Note <xref rid="MOESM1" ref-type="media">5</xref>), a machine learning algorithm for predicting CRISPR-induced indels. Our data also revealed that the inserted nucleotide of the most frequent indel type (1 bp insertion) is most frequently the same as N17 nucleotide of the protospacer (4 bp upstream of the PAM) (Fig. <xref rid="Fig1" ref-type="fig">1f</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>, Supplementary Note <xref rid="MOESM1" ref-type="media">5</xref>). The average gRNA activity from day 8 and 10 was used for subsequent analyses and model establishment. As a result, we obtained high-quality gRNA activity data for 10,592 gRNAs, of which 10,313 gRNAs are unique for this study (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>, Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>). To independently validate the CRISPR gRNA activity captured by the lentiviral surrogate vector library, we compared gRNA efficiencies commonly measured in our study to those of Kim et al. (2019) and Wang et al. (2019)<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup> (Fig. <xref rid="Fig1" ref-type="fig">1g</xref>). We observed a good correlation (Spearman’s R = 0.67 to both) between gRNA activities measured by our study and others, higher compared to the agreement between these two existing protocols (Spearman’s R = 0.52). Our gRNA efficiency data match characteristics of previous findings, with a preferential range of GC content between 40 and 90%<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> and stable gRNA structures being unfavorable, in particular for minimum folding energies (MFE) &lt; −7.5 kcal/mol<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref>). We conclude that the high-quality gRNA activity dataset of 10,592 gRNAs measured in cells by our study represents a valuable source to further improve the quality of CRISPR-gRNA designs.</p>
    </sec>
    <sec id="Sec4">
      <title>Enhanced gRNA efficiency prediction</title>
      <p id="Par8">We developed a deep learning model, which combines sequence and thermodynamic properties automatically extracted out of a 30 nt DNA input sequence constituted of the protospacer, the PAM and neighboring sequences for precise gRNAs activity predictions (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). In addition to the sequence composition, the model embeds the gRNA-target-DNA binding energy ΔG<sub>B</sub>, described by the energy model used in CRISPRoff<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, which encapsulates the gRNA-DNA hybridization free energy, and the DNA-DNA opening and RNA unfolding free energy penalties. ΔG<sub>B</sub> was observed to be a key feature for predicting on-target gRNA efficiency (see Supplementary Note <xref rid="MOESM1" ref-type="media">6</xref> and feature analysis below). We first trained deep learning models solely on our dataset (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>) and compared their predictions with those of existing tools on both internal and external independent test datasets. To do that, our CRISPR gRNA activity data were carefully partitioned into six subsets ensuring clustering of the closest gRNA sequences within the same partition (see Methods). The first model, pre-CRISPRon_v0, was trained with a 5-fold cross-validation while using a 6th partition as an internal independent test set solely for measuring the performance. The pre-CRISPRon_v0 and DeepSpCas9 models displayed remarkable and comparable generalization ability when tested on data from the study of one another (Spearman’s R &gt; 0.70 for both), confirming our data and Kim et al. (2019) data as highly compatible (Supplementary Data <xref rid="MOESM5" ref-type="media">2</xref>). The second model (pre-CRISPRon_v1, see Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Data <xref rid="MOESM5" ref-type="media">2</xref>) was constructed to evaluate on external independent test sets by training on all six partitions with a 6-fold cross-validation. This model displayed performances similar to those of existing tools.<fig id="Fig2"><label>Fig. 2</label><caption><title>The CRISPRon model and generalization ability on independent test sets.</title><p><bold>a</bold> Schematic representation of the CRISPRon input DNA sequence and prediction algorithm. The inputs to the deep learning network are the one-hot encoded 30mer and the binding energy (ΔG<sub>B</sub>). Note that only the filtering (convolutional) layers and the 3 fully connected layers are shown explicitly and that the thin vertical bars are the output of one layer, which serves as input for the next layer. <bold>b</bold> Performance comparison between CRISPRon and other existing models on independent test sets larger than 1000 gRNAs. N.a. not available (all gRNAs were regarded as training data due to lack of explicit train-test separation). CRISPRon_v0 was employed for testing on the internal independent test set (“Our merged set”, including gRNAs from both our study and Kim et al. (2019)). CRISPRon_v1, or simply CRISPRon, was used for the external independent test sets (for a description of the CRISPRon versions, see Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). The two-sided Steiger’s test <italic>P</italic>-values of all comparisons are reported in Supplementary Data <xref rid="MOESM5" ref-type="media">2</xref>.</p></caption><graphic xlink:href="41467_2021_23576_Fig2_HTML" id="d32e833"/></fig></p>
      <p id="Par9">Since pre-CRISPRon_v0 and DeepSpCas9 held comparable performances when trained on their respective datasets, we fused our data with that of Kim et al. (2019) using a linear rescaling based on the 30mer sequences found in both datasets, resulting in a dataset of 23,902 gRNAs (30mer, Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>). We did not fuse with the datasets measuring efficiency as indel frequency of Wang et al. (2019) and Kim et al. (2020), because of their scarce coverage of the general gRNA activity landscape (Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref> and <xref rid="MOESM1" ref-type="media">7</xref>). After dividing the joint dataset of our study and Kim et al. (2019) into six partitions as explained above, we first developed CRISPRon_v0 with a 5-fold cross-validation to evaluate the model on the internal independent test set. The CRISPRon_v0 increased the performance over pre-CRISPRon_v0 on the Kim et al. (2019) dataset, while only a minor loss (&lt;0.025 in Spearman’s R) was observed on our data (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Data <xref rid="MOESM5" ref-type="media">2</xref>). On the internal independent test set, CRISPRon_v0 exceeded the performance (Spearman’s R = 0.80) of notable predictors, such as Azimuth (R = 0.56), DeepSpCas9 (R = 0.73), DeepHF (R = 0.74), and DeepSpCas9variants (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">11</xref>). A final model, CRISPRon_v1 (hereafter called CRISPRon, see Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Data <xref rid="MOESM5" ref-type="media">2</xref>), was then trained on the full combined dataset with a 6-fold cross-validation. External independent test sets with more than 1000 gRNAs (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>) were employed for testing while again ensuring no overlap between what the respective models were trained on (see Methods). On these external independent test sets CRISPRon achieved the highest prediction performance (R ≈ [0.46, 0.68]) compared to Azimuth (R ≈ [0.36, 0.45]), DeepSpCas9variants (R ≈ [0.25, 0.31]), and to the so far top-performing models DeepSpCas9 (R ≈ [0.44, 0.52]) and DeepHF (R ≈ [0.42, 0.46]). Additional performance evaluations on datasets with less than 1000 gRNAs confirmed CRISPRon as top-performing model (Supplementary Fig. <xref rid="MOESM1" ref-type="media">11</xref>, Supplementary Data <xref rid="MOESM5" ref-type="media">2</xref>). A web interface for gRNA on-target efficiency predictions with the CRISPRon model is made available via <ext-link ext-link-type="uri" xlink:href="https://rth.dk/resources/crispr/">https://rth.dk/resources/crispr/</ext-link>. The webserver interface utilizes the IGV javascript plugin available from github<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>.</p>
    </sec>
    <sec id="Sec5">
      <title>Features important for predicting gRNA efficiency</title>
      <p id="Par10">To characterize the gRNA features with the highest impact on gRNA efficiency predictions we trained a gradient boosting regression tree (GBRT) model based on the combined data from our study and Kim et al. (2019) and applied two methods for feature analysis: the Shapley Additive exPlanations (SHAP)<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> and the Gini importance<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">12</xref>, full details in Supplementary Note <xref rid="MOESM1" ref-type="media">6</xref>). Both methods highlight that thermodynamic properties, above all ΔG<sub>B</sub>, give a considerable contribution to the learning process. The most notable sequence-composition features include the two nucleotides proximal to the PAM, where G and A are favored over C and T and the presence of the dinucleotide TT, which relates with weak binding free energies and is unfavorable.</p>
    </sec>
    <sec id="Sec6">
      <title>Limitations to the study</title>
      <p id="Par11">A few limitations of using the lentiviral surrogate vectors to capture CRISPR gRNA efficiency are highlighted for the need of future improvements. The DSBs generated by CRISPR-Cas9 are predominantly repaired by the nonhomologous end joining (NHEJ) and microhomology-mediated end joining (MMEJ) pathways, which leads to the introduction of small indels at the DSB site. However, large deletions or chromosomal rearrangements have also been reported in CRISPR editing as outcomes of repaired mediated by e.g., homology-directed repair (HDR) or single-strand annealing (SSA) in cells<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR32">32</xref></sup>. The gRNA efficiency quantification approach in this study is based on a 37 bp surrogate target site. Thus, SpCas9 editing outcomes such as large deletions or chromosomal rearrangements are not captured by our method. Earlier, we have discovered that chromatin accessibility at the editing sites affects CRISPR gene editing efficiency<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. Since the 12 K lentivirus library was randomly inserted in the genome of the targeted cells, the chromatin accessibility state of the surrogate site might be different from the endogenous target site.</p>
    </sec>
    <sec id="Sec7">
      <title>Concluding remark</title>
      <p id="Par12">In summary, we report on the generation of on-target gRNA activity data for 10,592 SpCas9 gRNAs and the development of a deep learning model, CRISPRon, which exhibits more accurate gRNA efficiency predictions than other existing tools.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <sec id="Sec9">
      <title>DNA vectors</title>
      <p id="Par13">The 3rd generation lentiviral vector backbone was generated by synthesis (Gene Universal Inc) and cloning. The human codon-optimized SpCas9 expression vector was based on a PiggyBac transposon vector, carrying a hygromycin selection cassette. All DNA vectors have been Sanger sequenced and can be acquired from the corresponding author YL’s lab. The lentiviral vector generated by this study for cloning surrogate oligos has been made available through Addgene (plasmid # 170459). A detail protocol is also made available at the shared protocols platform<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>.</p>
    </sec>
    <sec id="Sec10">
      <title>Design of the 12 K surrogate oligo pool</title>
      <p id="Par14">Each oligo consists of the BsmBI recognition site “cgtctc” with 4 bp specific nucleotides “acca” upstream, following the GGA cloning linker “aCACC”, one bp “g” for initiating transcription from U6 promoter, 20 bp gRNA sequences of “gN20”, 82 bp gRNA scaffold sequence, 37 bp surrogate target sequences (10 bp upstream sequences, 20 bp protospacer and 3 bp PAM sequences, 4 bp downstream sequence), the downstream linker “GTTTg”, and another BsmBI-binding site and its downstream flanking sequences “acgg”.</p>
      <p id="Par15">For the 12 K oligo pool was designed as below: (1) Select ~7000 genes from the drugable gene database (<ext-link ext-link-type="uri" xlink:href="http://dgidb.org">http://dgidb.org</ext-link>)<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>; (2) Discard all the exons which the DNA length is less than 23 bp with filtering; (3) Select the first three coding exons of each gene. If the exons number is less than 3, retain all the exons; (4) Extract all the possible gRNA sequences (including the PAM sequence “NGG”) in the filtered exons sequence; (5) Look up off-target sites of each gRNA with FlashFry (v 1.80)<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> and discard gRNAs with potential off-target of 0–3 bp mismatches in human genome hg19 and rank each gRNA based on the number of off-target site in an ascending order; (6) Map and extract the 10 bp upstream and 4 bp downstream flanking sequence of each selected gRNA, construct the surrogate target sequence as 10 bp upstream + 23 bp gRNA (include PAM) + 4 bp downstream = 37 bp; (7) Filter out surrogate sites with BsmBI recognition site, because of GGA cloning; (8) Compare all the selected gRNAs with the database of CRISPR-iSTOP<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>; (9) Construct the full-length sequence of each synthetic oligo, which is 170 bp; In total, the 12 K oligos target 3832 genes. The 12 K oligo pools were synthesized in Genscript® (Nanjing, China), and sequences are given in Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec11">
      <title>12 K surrogate plasmid library preparation</title>
      <p id="Par16">First, the 12 K oligos were cleaved and harvested from the microarray and diluted to 1 ng/µl. Next, we performed surrogate PCR1 (Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>). The PCR reaction was carried out using PrimeSTAR HS DNA Polymerase (Takara, Japan) following the manufacturer’s instruction. Briefly, each PCR reaction contained 1 µl oligo template, 0.2 µl PrimeSTAR polymerase, 1.6 µl dNTP mixture, 4 µl PrimeSTAR buffer, 1 µl forward primer (10 uM), and 1 µl reverse primer (10 uM) and ddH2O to a final volume of 20 µl.</p>
      <p id="Par17">The thermocycle program was 98 °C 2 min, (98 °C/10 s, 55 °C/10 s, 72 °C/30 s) with 21 cycles, then 72 °C for 7 min and 4 °C hold. To avoid amplification bias of oligos introduced by PCR, we conducted gradient thermocycles and performed PCR products gray-intensity analysis to determine the optimal PCR cycles of 21. The best thermocycles should be in the middle of an amplification curve. In this study, the PCR cycle as 21 for oligos amplification. Instead, for PCR amplification of surrogate sites from cells integrated with lentivirus, the PCR cycle was 25. The final PCR product length was 184 bp. We performed 72 parallel PCR reactions for 12 K oligos amplification, then these PCR products were pooled, and gel purified by 2% agarose gel. One microgram purified PCR product were quantified with PCR-free next generation sequencing (MGI Tech).</p>
      <p id="Par18">The PCR products of 12 K oligos were then used for Golden Gate Assembly (GGA) to generate the 12 K plasmids library. For each GGA reaction, the reaction mixture contained 100 ng lentiviral backbone vector, 10 ng purified 12 K oligos-PCR products, 1 µl T4 ligase (NEB), 2 µl T4 ligase buffer (NEB), 1 µl BsmBI restriction enzyme (ThermoFisher Scientific, FastDigestion) and ddH2O to a final volume of 20 µl. The GGA reactions were performed at 37 °C 5 min and 22 °C 10 min for 10 cycles, then 37 °C 30 min and 75 °C 15 min. Thirty six parallel GGA reactions were performed and the ligation products were pooled into one tube.</p>
      <p id="Par19">Transformation was then carried out using chemically competent DH5a cells. For each reaction, 10 µl GGA ligation product was transformed in to 50 µl competent cells and all the transformed cells were spread on one LB plate (15 cm dish in diameter) with Xgal, IPTG and Amp selection. High ligation efficiency was determined by the presence of very few blue colonies (also see Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). To ensure that there is sufficient coverage of each gRNA of the 12 K library, 42 parallel transformations were performed, and all the bacterial colonies were scraped off and pooled together for plasmids midi-prep. For NGS-based quality quantification of the library coverage, midi-prep plasmids were used as DNA templates for surrogate PCR2, followed by gel purification and NGS sequencing. The PCR primers for surrogate PCR2 are showed in Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec12">
      <title>12 K lentivirus packaging</title>
      <p id="Par20">HEK293T cells were used for lentivirus packaging. All cells were cultured in Dulbecco’s modified Eagle’s medium (DMEM) (LONZA) supplemented with 10 % fetal bovine serum (FBS) (Gibco), 1% GlutaMAX (Gibco), and penicillin/streptomycin (100 units penicillin and 0.1 mg streptomycin/mL) in a 37 °C incubator with 5% CO<sub>2</sub> atmosphere and maximum humidity. Cells were passaged every 2–3 days when the confluence was ~80–90%.</p>
      <p id="Par21">For lentivirus packaging: (Day 1) Wild-type HEK293T cells were seeded to a 10 cm culture dish, 4 × 10<sup>6</sup> cells per dish (10 dishes in total); (Day 2) Transfection. Briefly, we refreshed the medium with 7 mL fresh culture medium to 1 h before transfection (gently, as the HEK293T cells are easy to be detached from the bottom of dish); Next, we performed transfection with the PEI 40000 transfection method. For 10 cm dish transfection, the DNA/PEI mixture contains 13 µg lentiviral 12 K plasmid DNA, 3 µg pRSV-REV, 3.75 µg pMD.2 G, 13 µg pMDGP-Lg/p-RRE, 100 µg PEI 40000 solution (1 µg/µl in sterilized ddH2O), and supplemented by serum-free optiMEM without phenol red (Invitrogen) to a final volume of 1 mL. The transfection mixture was pipetted up and down several times gently, then kept at room temperature (RT) for 20 min, then added into cells in a dropwise manner and mix by swirling gently. (Day 3) Changed to fresh medium; (Day 4) Harvest and filter all the culture medium of the 10 cm dish through a 0.45 µm filter, pool the filtered media into one bottle. Each 10 cm dish generated ~7–8 mL lentivirus crude. Add polybrene solution (Sigma–Aldrich) into the crude virus to a final concentration of 8 µg/mL. Aliquot the crude virus into 15 mL tubes (5 mL/tube) and store in −80 °C freezer.</p>
    </sec>
    <sec id="Sec13">
      <title>Lentivirus titer quantification by flow cytometry (FCM)</title>
      <p id="Par22">As the 12 K lentiviral vector expresses an EGFP gene, the functional titer of our lentivirus prep was assayed by FCM. Briefly, (1) split and seed HEK293T cells to 24-well plate on day 1, 5 × 10<sup>4</sup> cells per well. Generally, 18 wells were used to perform the titter detection, a gradient volume of the crude lentivirus was added into the cells and each volume was tested by replicates. In this experiment, the crude virus gradients were 10, 20, 40, 80, and 160 µl for each well (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>). Another two wells of cells were used for cell counting before transduction; (2) Conduct lentivirus transduction when cells reach up to 60–80% confluence on day 2. Before transduction, detach the last two wells of cells using 0.05% EDTA-Trypsin to determine the total number of cells in one well (N<sub>initial</sub>). Then change the remaining wells with fresh culture medium containing 8 µg/mL polybrene, then add the gradient volume of crude virus into each well and swirling gently to mix; (3) On day 3, change to fresh medium without polybrene; (4) On day 4, harvest all the cells and wash them twice in PBS. Fix the cells in 4% formalin solution at RT for 20 min, then spin down the cell pellet at 500 × <italic>g</italic> for 5 min. Discard the supernatant and re-suspend the cell pellet carefully in 600 µl PBS, and conduct FCM analysis immediately. FCM was performed using a BD LSRFortessa<sup>TM</sup> cell analyzer with at least 30,000 events collected for each sample in replicates.</p>
      <p id="Par23">The FCM output data was analyzed by the software Flowjo vX.0.7. Percentage of GFP-positive cells was calculated as: Y% = N<sub>GFP-positive cells</sub>/N<sub>total cells</sub> × 100%. Calculate the GFP percentage of all samples. For accurate titter determination, there should be a linear relationship between the GFP-positive percentages and crude volume. The titter (Transducing Units (TU/mL) calculation according to this formula: TU/mL = (N<sub>initial</sub> × Y% × 1000)/V. V represents the crude volume (µl) used for initial transduction.</p>
    </sec>
    <sec id="Sec14">
      <title>Generation of SpCas9-expressing stable cell lines</title>
      <p id="Par24">SpCas9-expressing HEK293T (HEK293T-SpCas9) cells were generated by a PiggyBac transposon system. HEK293T cells were transfected with pPB-TRE-spCas9-Hygromycin vector and pCMV-hybase with a 9:1 ratio. Briefly, 1 × 10<sup>5</sup> HEK293T cells were seeded in 24-well plate and transfections were conducted 24 h later using lipofectamine 2000 reagent following the manufacturer’s instruction. Briefly, 450 ng pPB-TRE-spCas9-Hygromycin vectors and 50 ng pCMV-hybase were mixed in 25 µl optiMEM (tube A), then 1.5 µl lipofectamine 2000 reagent was added in another 25 µl optiMEM and mix gently (tube B). Incubate tube A and B at RT for 5 min, then add solution A into B gently and allow the mixture incubating at RT for 15 min. Add the AB mixture into cells evenly in a dropwise manner. Cells transfected with pUC19 were acted as negative control. Culture medium was changed to selection medium with 50 µg/ml hygromycin 48 h after transfection. Completion of selection took ~5–7 days until the negative cells were all dead in the untransfected cells. The cells were allowed to grow in 50 µg/ml hygromycin growth medium for 3–5 days for further expansion. PCR-based genotyping was carried out to validate the integration of Cas9 expression cassette (Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>). Although the expression of SpCas9 was controlled by a TRE promoter, we observed significant editing efficiency in cells without addition of doxycycline. Thus, the cells were used as a normal SpCas9-expressing model, while SpCas9 overexpression can be induced by Dox induction.</p>
    </sec>
    <sec id="Sec15">
      <title>12 K lentivirus library transduction</title>
      <p id="Par25">HEK293T-SpCas9 cells were cultured in growth medium with 50 µg/ml hygromycin throughout the whole experiment. For 12 K lentivirus library transduction, (1) on Day −1: 2.5 × 10<sup>6</sup> cells per 10 cm dish were seeded (in 12 dishes). For each group, one dish was used for cell number determination before transduction and one dish for drug-resistance (puromycin) test control and the remaining 10 dishes were used for the 12 K lentivirus library transduction (transduction coverage per gRNA exceeds 4000×); (2) Day 0: We first determined the approximate cell number per dish. This was used to determine the volume of crude lentivirus used for transduction using a multiplicity of infection (MOI) of 0.3. The low MOI (0.3) ensures that most infected cells receive only 1 copy of the lentivirus construct with high probability [41]. The calculation formula is: V = N × 0.3/TU. V = volume of crude lentivirus used for infection (ml); N = cell number in the dish before infection; TU = the titter of crude lentivirus (IFU/mL). The infected cells were cultured in a 37 °C incubator; (3) Day 1<bold>:</bold> 24 h after transduction, split the transduced cells of each dish to three dishes equally; (4) Day 2: For the three dishes of split (30 dishes in total, three divided into sub-groups), subgroup 1 (10 dishes) were harvested and labeled as the Day 2 after the 12 K lentivirus library transduction. All cells from this subgroup were pooled into one tube and stored in −20 °C freezer for genomic DNA extraction; The subgroup 2 (10 dishes) was changed to fresh D10 medium contains 50 µg/ml hygromycin + 1 µg/mL puromycin (Dox-free group); The subgroup 3 (10 dishes) was changed to D10 medium contains 50 µg/ml hygromycin + 1 µg/mL puromycin + 1 µg/mL doxycycline (Dox-addition group). (5) The transduced cells were spitted every 2–3 days when cell confluence reaches up to 90%. Cells from Day 2, 8, and 10 were harvested and stored in −20 °C for further genomic DNA extraction. Parallel experiments were performed using wild-type HEK293T cells.</p>
    </sec>
    <sec id="Sec16">
      <title>PCR amplification of surrogate sites from cells</title>
      <p id="Par26">Genomic DNA was extracted using the phenol-chloroform method. The genomic DNA were digested with RNase A (OMEGA) to remove RNA contamination (In this study, 50 µg RNase A worked well to digest the RNA contamination in 100–200 µg genomic DNA after incubating in 37 °C for 30 min). Then the genomic DNA was purified and subjected to surrogate PCR2 (Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>). In this study, 5 ug genomic DNA was used as temperate in one PCR reaction, which contained ~7.6 × 10<sup>5</sup> copies of surrogate construct (assuming 1 × 10<sup>6</sup> cells contain 6.6 µg genomic DNA), which covered about 63 times coverage of the 12 K library. In total, 32 parallel PCR reactions were performed to achieve approximately 2016 times coverage of each gRNA and surrogate site. For each PCR reaction, briefly, 50 µl PCR reaction system consists of 5 µg genomic DNA, 0.5 µg PrimeSTAR polymerase, 4 µl dNTP mixture, 10 µl PrimeSTAR buffer, 2.5 µl forward primer (10 uM), and 2.5 µl reverse primer (10 uM) and supplemented with ddH2O to a final volume of 50 µl. The thermocycle program was 98 °C 2 min, (98 °C for 10 s, 55 °C for 10 s, 72 °C for 30 s) with 25 cycles, then 72 °C for 7 min and 4 °C hold. Then purify all the PCR products by 2% gel, pool the products together and conduct deep amplicon sequencing.</p>
    </sec>
    <sec id="Sec17">
      <title>Deep amplicon sequencing</title>
      <p id="Par27">MGISEQ-2000 (DNBseq-G400) was used to perform the amplicons deep sequencing following the standard operation protocol. First, PCR-free library was prepared using MGIeasy FS PCR-free DNA library Prep kit following the manufacturer’s instruction. Briefly, measure the concentration of purified PCR products using Qubit 4 <sup>TM</sup> fluorometer (Invitrogen) and dilute the concentration of each sample to 10 ng/µl. Ten microliters diluted PCR product was mixed with an A-Tailing reaction which contained A-Tailing enzyme and buffer, incubated at 37 °C for 30 minutes then 65 °C for 15 min to inactive the enzyme. Then the A-Tailed sample was mixed with PCR Free index adapters (MGI.), T4 DNA Ligase and T4 ligase buffer to add index adapter at both 3’ and 5’ ends of PCR products. The reaction was incubated at 23 °C for 30 min and then purified with XP beads. Then denature the PCR products to be single-strand DNA (ssDNA) by incubating at 95 °C for 3 min and keep on 4 °C for the subsequent step. Transform the ssDNA to be circles using cyclase (MGI) at 37 °C for 30 min and then digested to remove linear DNA using Exo enzyme at 37 °C for 30 min. Purify the products again by XP beads and assay the concentration of library by Qubit 4 <sup>TM</sup> fluorometer. The amplicons libraries were subjected to deep sequencing on the MGISEQ-2000 platform. In this study, for each lane four samples (6 ng each) were pooled together for deep sequencing. To avoid sequencing bias induced by base unbalance of surrogate PCR products, 12 ng whole-genome DNA library (balance library) was mixed with the four PCR samples in a final concentration of 1.5 ng/µl and sequenced in one lane. All the samples were subjected to pair-ended 150 bp deep sequencing on MGISEQ-2000 platform.</p>
    </sec>
    <sec id="Sec18">
      <title>Data analysis</title>
      <p id="Par28">In order to evaluate the sequencing quality of amplicons and filter the low-quality sequencing data, Fastqc-0.11.3 and fastp-0.19.6<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> were used with default parameters for each sample. The clean sequencing reads of pair-ended segments were merged using FLASh-1.2.1<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> to obtain full-length reads. In order to obtain the amplified fragment reads of each surrogate reference sequence, BsmBI Linker was removed from the surrogate reference sequence. The BWA-MEM algorithm<sup><xref ref-type="bibr" rid="CR39">39</xref></sup> of bwa was used for local alignment, and the reads of all samples were divided into 12,000 independent libraries. Due to the existence of sequencing or oligo-synthesis introduced errors, each library was then filtered. As SpCas9 mainly causes insertions and deletions, the length of surrogate sequence is expected to change from its original 37 bp. We adopt the following steps for data processing and filtering: (1) Obtain the sequence containing gRNA + scaffold fragment as dataset1. (2) Obtain the sequence containing GTTTGAAT in dataset1 as dataset2 (BsmBI linker fragments changed in orientation (GTTTGGAG− &gt; GTTTGAAT)). (3) Extract the intermediate surrogate sequence from dataset2, which removed the length limit. In order to eliminate the interference of background noise before analyzing editing efficiency, all mutations or indels found in WT HEK293T cells group were removed.</p>
      <p id="Par29">The total editing efficiency for each gRNA was calculated according to the following formula:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{Total}}\,{\mathrm{editing}}\,{\mathrm{efficiency}}=\frac{({\mathrm{Num}}.\,{\mathrm{reads}}\,{\mathrm{with}}\,{\mathrm{length}}\ne 37\;{\mathrm{bp}})}{({\mathrm{Tot}}.\,{\mathrm{num}}.\,{\mathrm{of}}\,{\mathrm{reads}})} \%$$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="normal">Total</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">editing</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">efficiency</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Num</mml:mi><mml:mo>.</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">reads</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">with</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">length</mml:mi><mml:mo>≠</mml:mo><mml:mn>37</mml:mn><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">bp</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Tot</mml:mi><mml:mo>.</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">num</mml:mi><mml:mo>.</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">of</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">reads</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mi>%</mml:mi></mml:math><graphic xlink:href="41467_2021_23576_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par30">The average fraction of indels from 30 bp deletion to 10 bp insertion was calculated according to the following formula:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{Average}}\,{\mathrm{indels}}\,{\mathrm{fraction}}=\frac{({\mathrm{Num}}.\,{\mathrm{reads}}\,{\mathrm{with}}\,{\mathrm{length}}\,{\mathrm{range}}[7,47]\;{\mathrm{bp}})}{({\mathrm{Tot}}.\,{\mathrm{num}}.\,{\mathrm{of}}\,{\mathrm{reads}}\,{\mathrm{of}}\,12{\mathrm{K}}\,{\mathrm{library}})} \%$$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="normal">Average</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">indels</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">fraction</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Num</mml:mi><mml:mo>.</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">reads</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">with</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">length</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">range</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>7</mml:mn><mml:mo>,</mml:mo><mml:mn>47</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">bp</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Tot</mml:mi><mml:mo>.</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">num</mml:mi><mml:mo>.</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">of</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">reads</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">of</mml:mi><mml:mspace width="0.25em"/><mml:mn>12</mml:mn><mml:mi mathvariant="normal">K</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">library</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mi>%</mml:mi></mml:math><graphic xlink:href="41467_2021_23576_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec19">
      <title>Data collection and preprocessing for machine learning</title>
      <p id="Par31">The 12 K dataset was preprocessed by removing gRNAs supported by less than 200 reads and by intersecting the datasets of gRNAs with efficiencies measured at day 8 (<italic>N</italic> = 10,655) and day 10 (<italic>N</italic> = 10,933), thus retaining data for 10,592 gRNAs. For training, efficiencies measured at day 8 and day 10, positively correlated (Pearson’s <italic>r</italic> = 0.91), were averaged. The following additional datasets were downloaded: Kim (2019–2020)<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup>; Wang (2019)<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>; Xu (2015)<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup>, Chari (2015, 293 T cells)<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>; and Hart (2015) Hct1162lib1Avg<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> as collected by Haeussler et al.<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>; Doench (2014–2016) from the public repository of the Azimuth project<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>. For the dataset by Doench et al. (2014) only data from human cells was used, while for the later dataset (2016) we filtered for the genes CCDC101, CUL3, HPRT1, MED12, NF1, NF2, TADA1, TADA2B, as previously recommended<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR40">40</xref></sup>, and excluded gRNAs marked for low early time point (ETP). The Wang (2019) dataset was filtered from gRNAs for which no context was defined in the corresponding study<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Based on the method used to evaluate gRNA activity, datasets were distinguished into two categories: loss of gene function studies, which comprises Xu (2015), Hart (2015), and Doench (2014–2016) and indel-based, including Kim (2019–2020), Wang (2019), Chari (2015) and this study.</p>
      <p id="Par32">The datasets were preprocessed by removing gRNAs matching one of the following criteria: (1) Not present in hg38 (except for exogenous constructs); (2) No match to the target gene based on GENCODE annotations (v 32); (3) High variance in efficiency between different experimental settings, above the threshold: upper quartile + 1.5× variance interquartile range; (4) Target gene with less than 10 designed gRNAs; (5) Related to a PAM different from 5’-NGG-3’ (6) Expressed from a tRNA system; (7) Targeting the last 10% of the merged coding sequences (CDSs) annotated for a target gene (nonsense mediated decay or polymorphic pseudogene transcripts were excluded). Points 2, 4, and 7 were applicable only in the case of loss of function studies. The Kim (2019–2020) datasets were further processed by averaging duplicated 30mer gRNA + context entries (avg. difference between max. and min. indel frequency of replicates = 8.6 and 6.7 in the studies of 2019 and 2020, respectively). Efficiency values not reported as indel frequencies were ranked-normalized with the SciPy rankdata function<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> and normalized efficiencies were averaged between experimental conditions.</p>
      <p id="Par33">After preprocessing, each dataset contained the following number of unique 30mer, gRNA + context sequences: Kim (2019): 13,359; Kim (2020): 8742; Xu (2015): 971; Chari (2015): 1,224; Hart (2015): 4001; Doench (2014): 781; Doench (2016): 2145; Wang (2019): 55,022; this study: 10,592. See Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref> for more details about filtered data. Ours and Kim (2019) datasets were combined by building a linear regression model on overlapping elements (49 pairs) and applying it to scale gRNA efficiencies from our study to those of Kim et al. (2019). Efficiencies were averaged for overlapping 30mers. The merged dataset consisted of 23,902 gRNA + context sequences (30mers).</p>
    </sec>
    <sec id="Sec20">
      <title>Generation of gRNA and target DNA features</title>
      <p id="Par34">Features were extracted from a 30mer DNA sequence composed by the target DNA protospacer (20 nt) and the following flanking regions: 4 nt upstream, 3 nt PAM, and 3 nt downstream from the PAM. Position-specific single and di-nucleotides were one-hot encoded, binarizing the presence/absence of a certain nucleotide with the values 0 (absent) or 1 (present). They were denoted as N_X, with N in the set [A,T,G,C] and X being the position on the 30mer. Nucleotides surrounding the “GG” Cas9 binding site were also binarized and denoted as NGGX_YZ, where Y and Z are the nucleotides upstream and downstream from the motif. Sliding windows of 1 and 2 nt were used to count the occurrences of each single and dinucleotide in the 30mer sequences. These position-independent features were labeled by the nucleotide or dinucleotide they account for. The GC content was obtained as the sum of Gs and Cs in the protospacer sequence. The melting temperatures were computed with the Biopython 1.77 Tm_staluc method<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> for three nonoverlapping segments of the protospacer, at positions 3–7, 8–15, and 16–20, referred to as MT_[S,E], where S and E are the start and end positions of the segment. The spacer folding free energy of ensemble and the ΔG<sub>B</sub> RNA–DNA binding energy were computed using the energy function in the CRISPRoff pipeline 1.1.1<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, provided with RNAfold 2.2.5<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>.</p>
    </sec>
    <sec id="Sec21">
      <title>Generation of dataset partitions</title>
      <p id="Par35">The datasets used for training were divided into partitions of approximately equal size (±1 gRNA) accounting for data similarity, to assign highly similar gRNAs to the same partition. This was implemented as follows: (1) we computed the pairwise Hamming distance between all gRNAs based on their on-hot encoded 30mer sequences (gRNA + context) with the SciPy <italic>pdist</italic> function<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> (normalized distances from <italic>pdist</italic> were multiplied by the size of the one-hot encoded array (1 × 120)); (2) for each gRNA <italic>x</italic> we stored a list of all gRNAs with Hamming distance ≤ 8 in the one-hot space, which corresponds to a sequence difference ≤ 4 nt; these were regarded as gRNAs “similar” to gRNA <italic>x</italic>; (3) gRNAs similar to at least one other gRNA in the dataset were the first to be distributed, randomly, in the partitions; whenever a gRNA <italic>x</italic> was assigned to a partition, all the gRNAs <italic>y</italic>, <italic>z</italic>… similar to it (and recursively those similar to <italic>y, z</italic>, …) were also added to the same partition; (4) once all similar gRNAs were exhausted the remaining gRNAs, not similar to any other, were split into three subsets based on their efficiency (inefficient: up to efficiency percentile 25 (25p), medium-efficient: from 25 to 75p, and highly efficient: above 75p) and the gRNAs in these three subsets were distributed to the partitions pseudo-randomly by assigning a balanced amount of inefficient, medium-efficient and highly efficient gRNAs to each of the partitions until they reached their predetermined size. To preserve gRNAs from the test set of Kim et al. (2019) in a single partition, used as internal independent test set to compare the performances of CRISPRon and DeepSpCas9, the gRNAs in the test set of Kim et al. (2019) were collected in an initial group, which was assigned to the partition destined for usage as internal independent test set prior any other data partitioning. Other gRNAs in the merged dataset similar to any of the gRNAs present in this initial group were added to it during the generations of the partitions, to maintain the internal test set fully independent.</p>
    </sec>
    <sec id="Sec22">
      <title>Test settings for the evaluation and comparison of models</title>
      <p id="Par36">Test datasets (both internal and external) were made fully independent by removing all gRNAs highly similar to a gRNA in the training sets of any of the models being compared as follows: (1) the pairwise Hamming distance between the gRNAs in the test and training datasets was computed using the on-hot encoded 20 nt gRNA sequences with the SciPy <italic>cdist</italic> function<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> (normalized distances from <italic>cdist</italic> were multiplied by the size of the one-hot encoded array (1 × 80)); (2) gRNAs with Hamming distance ≤ 6 in the one-hot space, which corresponds to a sequence difference ≤ 3 nt, were removed. While for the generation of dataset partitions gRNA similarities were computed on 30mer gRNA + context sequences, the sole 20 nt gRNA spacers were employed during the processing of the test datasets because in the dataset of Wang et al. (2019) target contexts are highly different from those in other datasets for identical gRNAs. More restrictive thresholds of similarity (sequence difference ≤ 4 or 5) were also tested. No difference in the general performance of CRISPRon (v0 and v1) and in the comparison with other models were observed, and all of the significant improvements remained as such (Supplementary Data <xref rid="MOESM5" ref-type="media">2</xref>). Notably, the fluctuations in performances given by different similarity thresholds were both positive and negative.</p>
    </sec>
    <sec id="Sec23">
      <title>Gradient boosting regression trees (GBRTs) for features analysis</title>
      <p id="Par37">Validation hyperparameters were chosen from the following screen: learning rate chosen from [0.08, 0.09, 0.1], maximum tree depth chosen from [3, 5, 7], minimum number of samples to generate a new split chosen from [5, 10, 15, 20], minimum number of samples to be present in a leaf node chosen from [5, 10, 15, 20], total number of trees in the model chosen from [400, 600, 800, 1000]. The validation of hyperparameters was made twice, the first time on five out of six partitions of the dataset, preserving the 6th partition as internal independent test set, and the second time on all six partitions. Selected hyperparameters are reported in Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>. During the validation, each GBRT was initialized five times with different seeds and the best model of the 5 was chosen for each fold/validation set. Predictions were computed by averaging the output of the best GBRTs chosen for each fold. When comparing multiple predictors, independent test datasets were cleaned from gRNAs with ≤3 nt difference on the 20 nt sequence of a gRNA in the training set of any compared predictor.</p>
    </sec>
    <sec id="Sec24">
      <title>The CRISPRon deep learning model</title>
      <p id="Par38">The training of our deep learning models uses the Keras/Tensorflow 2.2.0<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> neural network framework with Python 3.8.3. Our strategy takes outset in the deep learning strategies by Wang et al.<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> and Kim et al. (2019, 2020)<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup>. We employed a one-hot encoding of the input sequence (30mer gRNA + context), which was fed into a number of 3, 5, and 7 sized filters acting directly on the one-hot encoded sequence. The convolutions, which are the outputs of the filters, were flattened and fed into two sequential fully connected layers before giving the gRNA efficiency as the final output (for the full model layout see Supplementary Fig. <xref rid="MOESM1" ref-type="media">13</xref>). The number of weights and the layout of the convolutions as well as those of the two final fully connected layers are identical to the architecture used in Kim et al. 2019 and since the hyperparameters and layout of their model was substantially interrogated, we have not attempted further optimizations of this part of our model for CRISPRon. However, the inclusion of an important biological parameter in the deep learning framework was optimized as detailed below.</p>
      <p id="Par39">The partitioning of the data in to 6 subsets used for the GBRT were reused in the training of the deep learning models (see Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). As in the regular machine learning above, the deep learning models were initially trained on 5-fold cross-validation with the 6th partition set aside for internal independent testing. Each training in the 5-fold cross-validation was repeated 10 times using random seeds and the best model of the 10 was chosen for each fold/validation set. The final output is the average of the output of the best models chosen for each fold. Finally, the process was repeated using all six data partitions for 6-fold cross-validation without an internal independent test set.</p>
      <p id="Par40">The most important biological parameters obtained from the GBRT model Gini and SHAP analysis were ΔG<sub>B</sub>, the GC content of the 30mer and the folding energy of the spacer gRNA. Of these, ΔG<sub>B</sub> was a far better representative of the on-target efficiency and we therefore decided to include ΔG<sub>B</sub> in our deep learning model<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. Direct inclusion of ΔG<sub>B</sub> along-side the convolutions led to an improvement of the mean square error (MSE) from 143.15 to 141.76 on the average of the 5-fold cross-validations of the combined dataset from our study and Kim et al. (2019) (see Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">13</xref>-<xref rid="MOESM1" ref-type="media">14</xref> for the model layouts, Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref> for the results). Collecting the convolutions in a separate fully connected layer before combining the fully connected layer with ΔG<sub>B</sub> led to a further improvement of the average MSE on the 5-fold cross-validation from 144.73 with three fully connected layers but without ΔG<sub>B</sub> to 140.83 with ΔG<sub>B</sub> (see Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">15</xref>-<xref rid="MOESM1" ref-type="media">16</xref> for the model layouts, Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref> for the results). The model with convolutions collected in a fully connected layer before combination with ΔG<sub>B</sub> thus became our final CRISPRon model as outlined in Fig. <xref rid="Fig2" ref-type="fig">2a</xref> with details in Supplementary Fig. <xref rid="MOESM1" ref-type="media">16</xref>. This model was trained on the combined dataset from our study and Kim et al. (2019) dataset, split in six partitions, using 6-fold cross-validation. The final CRISPRon-v1.0 output is the average output of the best models obtained from each of the six validation sets after 10 repetitions (see Supplementary Table <xref rid="MOESM1" ref-type="media">6</xref>).</p>
      <p id="Par41">All the models were trained and evaluated using the MSE and the training was performed in epochs, where the weights were updated after each batch of 500 examples. The training was stopped when the performance on the validation set did not improve for 100 consecutive epochs and the best performing model by MSE on the validation set was kept. In effect, the training typically ran for 500–1500 epochs in total. The introduction of ΔG<sub>B</sub> in the model changed the convergence behavior and we therefore screened for optimal learning rates testing learning as follows. We trained deep learning models on the LK-5 datasets using the layouts with only two fully connected layers and direct inclusion of ΔG<sub>B</sub> and tested learning rates of 0.001, 0.0005, 0.0001, and 0.00005 in ten repetitions on each of the 5-fold validation sets (Supplementary Table <xref rid="MOESM1" ref-type="media">7</xref>). The optimal learning rate was 0.0001 using ADAM optimization and as above using a batch size of 500. The hyperparameters were used in the further training of the final CRISPRon deep learning model, which includes an extra fully connected layer for collection of the convolutions prior to the inclusion of ΔG<sub>B.</sub></p>
    </sec>
    <sec id="Sec25">
      <title>Reporting summary</title>
      <p id="Par42">Further information on research design is available in the <xref rid="MOESM6" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec26">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="41467_2021_23576_MOESM1_ESM.pdf">
          <caption>
            <p>Supplementary Information</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="41467_2021_23576_MOESM2_ESM.pdf">
          <caption>
            <p>Peer Review File</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM3">
        <media xlink:href="41467_2021_23576_MOESM3_ESM.pdf">
          <caption>
            <p>Description of Additional Supplementary Files</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM4">
        <media xlink:href="41467_2021_23576_MOESM4_ESM.xlsx">
          <caption>
            <p>Supplementary Data 1</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM5">
        <media xlink:href="41467_2021_23576_MOESM5_ESM.xlsx">
          <caption>
            <p>Supplementary Data 2</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM6">
        <media xlink:href="41467_2021_23576_MOESM6_ESM.pdf">
          <caption>
            <p>Reporting summary</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec27">
        <title>Source data</title>
        <p id="Par45">
          <media position="anchor" xlink:href="41467_2021_23576_MOESM7_ESM.xlsx" id="MOESM7">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic>Nature Communications</italic> thanks the anonymous reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Xi Xiang, Giulia I. Corsi, Christian Anthon, Kunli Qu.</p>
    </fn>
    <fn>
      <p>These authors jointly supervised this work: Jan Gorodkin, Yonglun Luo.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-021-23576-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This project was partially supported by the Sanming Project of Medicine in Shenzhen (SZSM201612074, to L.B. and Y.L.), Qingdao-Europe Advanced Institute for Life Sciences Grant (Y.L.), Guangdong Provincial Key Laboratory of Genome Read and Write (No. 2017B030301011 to X.X.), Guangdong Provincial Academician Workstation of BGI Synthetic Genomics (No. 2017B090904014 to X.X.), the Innovation Fund Denmark (4108-00008B, 4096-00001B to J.G.) and the Danish Research Council (9041-00317B to J.G.), Danish Research Council (9041-00317B to Y.L.), European Union’s Horizon 2020 research and innovation program under grant agreement No 899417 (Y.L.), the Lundbeck Foundation (R219–2016-1375 to L.L.), the DFF Sapere Aude Starting grant (8048-00072 A to L.L.), and the National Human Genome Research Institute of the National Institutes of Health (RM1HG008525 to G.C.). We thank the China National GeneBank for the support of executing the project under the framework of Genome Read and Write.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Y.L. and J.G. conceived the idea. L.B., G.M.C., C.A., L.L., and Y.L. supervised and coordinated the experimental part of the study. J.G. supervised and coordinated the computational part of the study. X.X., K.Q., X.L., and X.P. performed most of the experimental work. G.I.C., C.A., X.X., and X.P. analyzed the data. G.I.C., C.A., and J.G. developed the machine learning methods. G.I.C. and C.A. implemented the deep learning methods and webserver. All authors have contributed to the execution of the experiments and studies. X.X., G.I.C., L.L., C.A., J.G., and Y.L. drafted the manuscript. All authors discussed the results and contributed to the final manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>High-throughput sequencing data have been deposited to the China National GeneBank (accession number CNP0001031) and the GEO repository (accession number GSE173708). The gRNA efficiency data are provided in Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>. The Drugable gene database can be accessed to the link <ext-link ext-link-type="uri" xlink:href="http://dgidb.org">http://dgidb.org</ext-link>. The lentivirus vector used for cloning surrogate oligonucleotides is made available through Addgene (Plasmid #170459). <xref rid="Sec27" ref-type="sec">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>CRISPRon website and source via: <ext-link ext-link-type="uri" xlink:href="https://rth.dk/resources/crispr/">https://rth.dk/resources/crispr/</ext-link> and on <ext-link ext-link-type="uri" xlink:href="https://github.com/RTH-tools/crispron.">https://github.com/RTH-tools/crispron</ext-link><sup><xref ref-type="bibr" rid="CR22">22</xref></sup>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par43">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jinek</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A programmable dual-RNA-guided DNA endonuclease in adaptive bacterial immunity</article-title>
        <source>Science</source>
        <year>2012</year>
        <volume>337</volume>
        <fpage>816</fpage>
        <lpage>821</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1225829</pub-id>
        <pub-id pub-id-type="pmid">22745249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Farboud, B. et al. Enhanced genome editing with Cas9 ribonucleoprotein in diverse cells and organisms. <italic>J. Vis. Exp.</italic><bold>135</bold>, 57350 (2018).</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mali</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-guided human genome engineering via Cas9</article-title>
        <source>Science</source>
        <year>2013</year>
        <volume>339</volume>
        <fpage>823</fpage>
        <lpage>826</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1232033</pub-id>
        <pub-id pub-id-type="pmid">23287722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hwang</surname>
            <given-names>WY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Efficient genome editing in zebrafish using a CRISPR-Cas system</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>227</fpage>
        <lpage>229</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2501</pub-id>
        <pub-id pub-id-type="pmid">23360964</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cong</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiplex genome engineering using CRISPR/Cas systems</article-title>
        <source>Science</source>
        <year>2013</year>
        <volume>339</volume>
        <fpage>819</fpage>
        <lpage>823</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1231143</pub-id>
        <pub-id pub-id-type="pmid">23287718</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muhammad Rafid</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Toufikuzzaman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rahman</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Rahman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>CRISPRpred(SEQ): a sequence-based method for sgRNA on target activity prediction using traditional machine learning</article-title>
        <source>BMC Bioinformatics</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>223</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-020-3531-9</pub-id>
        <pub-id pub-id-type="pmid">32487025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prediction of the sequence-specific cleavage activity of Cas9 variants</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>1328</fpage>
        <lpage>1336</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0537-9</pub-id>
        <pub-id pub-id-type="pmid">32514125</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimized CRISPR guide RNA design for two high-fidelity Cas9 variants by deep learning</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>4284</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-12281-8</pub-id>
        <pub-id pub-id-type="pmid">31537810</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>HK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SpCas9 activity prediction by DeepSpCas9, a deep learning-based model with high generalization performance</article-title>
        <source>Sci. Adv.</source>
        <year>2019</year>
        <volume>5</volume>
        <fpage>eaax9249</fpage>
        <pub-id pub-id-type="doi">10.1126/sciadv.aax9249</pub-id>
        <pub-id pub-id-type="pmid">31723604</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Listgarten</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prediction of off-target activities for the end-to-end design of CRISPR guide RNAs</article-title>
        <source>Nat. Biomed. Eng.</source>
        <year>2018</year>
        <volume>2</volume>
        <fpage>38</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1038/s41551-017-0178-6</pub-id>
        <pub-id pub-id-type="pmid">29998038</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chuai</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DeepCRISPR: optimized CRISPR guide RNA design by deep learning</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>80</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1459-4</pub-id>
        <pub-id pub-id-type="pmid">29945655</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rahman</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Rahman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>CRISPRpred: a flexible and efficient tool for sgRNAs on-target activity prediction in CRISPR/Cas9 systems</article-title>
        <source>PLoS ONE</source>
        <year>2017</year>
        <volume>12</volume>
        <fpage>e0181943</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0181943</pub-id>
        <pub-id pub-id-type="pmid">28767689</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chari</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yeo</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Chavez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>sgRNA Scorer 2.0: a species-independent model to predict CRISPR/Cas9 activity</article-title>
        <source>ACS Synth. Biol.</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>902</fpage>
        <lpage>904</lpage>
        <pub-id pub-id-type="doi">10.1021/acssynbio.6b00343</pub-id>
        <pub-id pub-id-type="pmid">28146356</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doench</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimized sgRNA design to maximize activity and minimize off-target effects of CRISPR-Cas9</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>184</fpage>
        <lpage>191</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3437</pub-id>
        <pub-id pub-id-type="pmid">26780180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wong</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>WU-CRISPR: characteristics of functional guide RNAs for the CRISPR/Cas9 system</article-title>
        <source>Genome Biol.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>218</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0784-0</pub-id>
        <pub-id pub-id-type="pmid">26521937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moreno-Mateos</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CRISPRscan: designing highly efficient sgRNAs for CRISPR-Cas9 targeting in vivo</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>982</fpage>
        <lpage>988</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3543</pub-id>
        <pub-id pub-id-type="pmid">26322839</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sequence determinants of improved CRISPR sgRNA design</article-title>
        <source>Genome Res.</source>
        <year>2015</year>
        <volume>25</volume>
        <fpage>1147</fpage>
        <lpage>1157</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.191452.115</pub-id>
        <pub-id pub-id-type="pmid">26063738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hart</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-resolution CRISPR screens reveal fitness genes and genotype-specific cancer liabilities</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>163</volume>
        <fpage>1515</fpage>
        <lpage>1526</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.11.015</pub-id>
        <pub-id pub-id-type="pmid">26627737</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doench</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rational design of highly active sgRNAs for CRISPR-Cas9-mediated gene inactivation</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>1262</fpage>
        <lpage>1267</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3026</pub-id>
        <pub-id pub-id-type="pmid">25184501</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chari</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mali</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Moosburner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Unraveling CRISPR-Cas9 genome engineering parameters via a library-on-library approach</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>823</fpage>
        <lpage>826</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3473</pub-id>
        <pub-id pub-id-type="pmid">26167643</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Sabatini</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Genetic screens in human cells using the CRISPR-Cas9 system</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>343</volume>
        <fpage>80</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1246981</pub-id>
        <pub-id pub-id-type="pmid">24336569</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Corsi, G. I., Gorodkin, J. &amp; Anthon, C. <italic>CRISPRon github page.</italic>10.5281/zenodo.4725572. (2021).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Allen, F. et al. Predicting the mutations generated by repair of Cas9-induced double-strand breaks. <italic>Nat. Biotechnol</italic>. <bold>37</bold>, 64–72 (2019).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>MW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Predictable and precise template-free CRISPR editing of pathogenic variants</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>563</volume>
        <fpage>646</fpage>
        <lpage>651</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0686-x</pub-id>
        <pub-id pub-id-type="pmid">30405244</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Labuhn</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Refined sgRNA efficacy prediction improves large- and small-scale CRISPR-Cas9 applications</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>1375</fpage>
        <lpage>1385</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1268</pub-id>
        <pub-id pub-id-type="pmid">29267886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jensen</surname>
            <given-names>KT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromatin accessibility and guide sequence secondary structure affect CRISPR-Cas9 gene editing efficiency</article-title>
        <source>FEBS Lett.</source>
        <year>2017</year>
        <volume>591</volume>
        <fpage>1892</fpage>
        <lpage>1901</lpage>
        <pub-id pub-id-type="doi">10.1002/1873-3468.12707</pub-id>
        <pub-id pub-id-type="pmid">28580607</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alkan</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wenzel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Anthon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Havgaard</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Gorodkin</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>CRISPR-Cas9 off-targeting assessment with nucleic acid duplex energy parameters</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>177</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1534-x</pub-id>
        <pub-id pub-id-type="pmid">30367669</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Robinson, J. T., Thorvaldsdóttir, H., Turner, D. &amp; Mesirov, J. P. igv.js: an embeddable JavaScript implementation of the Integrative Genomics Viewer (IGV). <italic>bioRxiv</italic><ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2020.05.03.075499v1">https://www.biorxiv.org/content/10.1101/2020.05.03.075499v1</ext-link> (2020).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Lundberg, S. M. &amp; Lee, S.-I. A Unified Approach to Interpreting Model Predictions. In <italic>Advances in Neural Information Processing Systems</italic> Vol. 30. (eds. Guyon, I.) 4765–4774 (Curran Associates Inc., 2017).</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Random forests</article-title>
        <source>Mach. Learn.</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>5</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cullot</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CRISPR-Cas9 genome editing induces megabase-scale chromosomal truncations</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1136</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-09006-2</pub-id>
        <pub-id pub-id-type="pmid">30850590</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kosicki</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tomberg</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bradley</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Repair of double-strand breaks induced by CRISPR-Cas9 leads to large deletions and complex rearrangements</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>765</fpage>
        <lpage>771</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4192</pub-id>
        <pub-id pub-id-type="pmid">30010673</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Xiang, X. &amp; Luo, Y. <italic>High throughput quantification of CRISPR gRNA efficiency based on surrogate lentivirus libraries</italic>. 10.17504/protocols.io.bt9jnr4n. (2021).</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cotto</surname>
            <given-names>KC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DGIdb 3.0: a redesign and expansion of the drug-gene interaction database</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D1068</fpage>
        <lpage>D1073</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1143</pub-id>
        <pub-id pub-id-type="pmid">29156001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>FlashFry: a fast and flexible tool for large-scale CRISPR target design</article-title>
        <source>BMC Biol.</source>
        <year>2018</year>
        <volume>16</volume>
        <fpage>74</fpage>
        <pub-id pub-id-type="doi">10.1186/s12915-018-0545-0</pub-id>
        <pub-id pub-id-type="pmid">29976198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuscu</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CRISPR-STOP: gene silencing through base-editing-induced nonsense mutations</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>710</fpage>
        <lpage>712</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4327</pub-id>
        <pub-id pub-id-type="pmid">28581493</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>NGS QC Toolkit: a toolkit for quality control of next generation sequencing data</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>e30619</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0030619</pub-id>
        <pub-id pub-id-type="pmid">22312429</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Magoc</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>FLASH: fast length adjustment of short reads to improve genome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2957</fpage>
        <lpage>2963</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr507</pub-id>
        <pub-id pub-id-type="pmid">21903629</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Toward better understanding of artifacts in variant calling from high-coverage samples</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2843</fpage>
        <lpage>2851</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu356</pub-id>
        <pub-id pub-id-type="pmid">24974202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haeussler</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation of off-target and on-target scoring algorithms and integration into the guide RNA selection tool CRISPOR</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>148</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-1012-2</pub-id>
        <pub-id pub-id-type="pmid">27380939</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Virtanen</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>
        <source>Nat. Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>261</fpage>
        <lpage>272</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>
        <pub-id pub-id-type="pmid">32015543</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lorenz</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ViennaRNA Package 2.0</article-title>
        <source>Algorithms Mol. Biol.</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>26</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-6-26</pub-id>
        <pub-id pub-id-type="pmid">22115189</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Abadi, M. et al. <italic>TensorFlow: Large-scale machine learning on heterogeneous systems</italic>. tensorflow.org. (2015).</mixed-citation>
    </ref>
  </ref-list>
</back>
