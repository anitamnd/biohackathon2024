<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2844998</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btq067</article-id>
    <article-id pub-id-type="publisher-id">btq067</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Databases and Ontologies</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Accelerated similarity searching and clustering of large compound sets by geometric embedding and locality sensitive hashing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cao</surname>
          <given-names>Yiqun</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Tao</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Girke</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup> Department of Computer Science &amp; Engineering and <sup>2</sup> Department of Botany &amp; Plant Sciences, University of California, Riverside, CA 92521, USA</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Jonathan Wren</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>4</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>2</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>2</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>26</volume>
    <issue>7</issue>
    <fpage>953</fpage>
    <lpage>959</lpage>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>8</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>11</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>2</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2010. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Similarity searching and clustering of chemical compounds by structural similarities are important computational approaches for identifying drug-like small molecules. Most algorithms available for these tasks are limited by their speed and scalability, and cannot handle today's large compound databases with several million entries.</p>
      <p><bold>Results:</bold> In this article, we introduce a new algorithm for accelerated similarity searching and clustering of very large compound sets using embedding and indexing (EI) techniques. First, we present <italic>EI-Search</italic> as a general purpose similarity search method for finding objects with similar features in large databases and apply it here to searching and clustering of large compound sets. The method embeds the compounds in a high-dimensional Euclidean space and searches this space using an efficient index-aware nearest neighbor search method based on locality sensitive hashing (LSH). Second, to cluster large compound sets, we introduce the <italic>EI-Clustering</italic> algorithm that combines the EI-Search method with Jarvis–Patrick clustering. Both methods were tested on three large datasets with sizes ranging from about 260 000 to over 19 million compounds. In comparison to sequential search methods, the EI-Search method was 40–200 times faster, while maintaining comparable recall rates. The EI-Clustering method allowed us to significantly reduce the CPU time required to cluster these large compound libraries from several months to only a few days.</p>
      <p><bold>Availability:</bold> Software implementations and online services have been developed based on the methods introduced in this study. The online services provide access to the generated clustering results and ultra-fast similarity searching of the PubChem Compound database with subsecond response time.</p>
      <p>
        <bold>Contact:</bold>
        <email>thomas.girke@ucr.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq067/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Software tools for mining the available small molecule space play an important role in many bioscience and biomedical areas. They are ranging from drug discovery, chemical biology and chemical genomics to medicinal chemistry (Haggarty, <xref ref-type="bibr" rid="B21">2005</xref>; Oprea, <xref ref-type="bibr" rid="B28">2002</xref>; Oprea <italic>et al.</italic>, <xref ref-type="bibr" rid="B29">2007</xref>; Savchuk <italic>et al.</italic>, <xref ref-type="bibr" rid="B32">2004</xref>; Strausberg and Schreiber, <xref ref-type="bibr" rid="B36">2003</xref>). Currently, the structures of over 20 million distinct small molecules are available in open access databases, like PubChem (Austin <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2004</xref>), ChemBank (Seiler <italic>et al.</italic>, <xref ref-type="bibr" rid="B33">2008</xref>), NCI (Ihlenfeldt <italic>et al.</italic>, <xref ref-type="bibr" rid="B22">2002</xref>), ChemMine (Girke <italic>et al.</italic>, <xref ref-type="bibr" rid="B20">2005</xref>), ChemDB (Chen <italic>et al.</italic>, <xref ref-type="bibr" rid="B12">2007</xref>) and ZINC (Irwin and Shoichet, <xref ref-type="bibr" rid="B23">2005</xref>). To analyze these important data resources, efficient structure similarity search tools are essential for retrieving chemical and bioactivity information from databases (Chen and Reynolds, <xref ref-type="bibr" rid="B13">2002</xref>; Sheridan and Kearsley, <xref ref-type="bibr" rid="B34">2002</xref>). In addition, they are often useful for predicting bioactive small molecules (Cao <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">2008</xref>; Cheng <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2007</xref>).</p>
    <p>A variety of structure similarity search methods are available (reviewed by Willett <italic>et al.</italic>, <xref ref-type="bibr" rid="B43">1998</xref>). Unfortunately, they are often not fast enough forsystematic analyses of very large compound collections with millions of compounds. This is because most of these methods sequentially compare a query structure against all entries in the database and then rank the results by a chosen scoring system, and thus the cost to perform similarity searches grows linearly with the size of the compound database. Therefore, more efficient and sophisticated search methods need to be developed to utilize the available chemical space efficiently.</p>
    <p>Clustering of compound sets is essential on practically all stages of the discovery process of bioactive compounds (reviewed by Downs and Barnard, <xref ref-type="bibr" rid="B16">2002</xref>). Commonly, structure similarity-based clustering utilizes the pairwise similarity measures generated by the above compound search methods to partition the data into discrete groups of similar compounds. An example is Jarvis–Patrick clustering, which is among the most widely used clustering methods in cheminformatics (Willett, <xref ref-type="bibr" rid="B41">1987</xref>). Alternatively, they can be used to build hierarchical trees that represent the similarity relationships among all items in a compound dataset. One of the main challenges in this area is the difficulty to cluster the millions of compound structures that are currently available in the public domain. This is because many cluster analysis approaches multiply the complexity of a chosen similarity search method by the number of compounds in the dataset. They often require the calculation of all-against-all similarities for the compounds under investigation and the computational cost grows quadratically with the size of the dataset. Therefore, novel clustering methods need to be developed for exploring this vast chemical space efficiently.</p>
    <p>A few methods have been proposed to accelerate the nearest neighbor searching in compound databases. Agrafiotis and Lobanov (<xref ref-type="bibr" rid="B2">1999</xref>) reported an algorithm based on <italic>k</italic>-dimensional (or <italic>k</italic>-d) trees for diversity analyses. This problem is relevant to clustering (Bentley, <xref ref-type="bibr" rid="B7">1975</xref>) and the method can possibly be adopted to nearest neighbor searching. It works by representing each chemical compound as a multidimensional vector and organizing the compound dataset in a <italic>k</italic>-d tree structure to speedup diversity analyses. However, the vector representation used is very limited and the <italic>k</italic>-d tree cannot handle high-dimensional vector data. Later the authors proposed a new data structure called μ-tree to perform guided nearest neighbor search of compounds in general metric space (Xu and Agrafiotis, <xref ref-type="bibr" rid="B44">2003</xref>). A μ-tree organizes the database in recursively partitioned Voronoi regions and represents these partitions as a tree. The method greatly reduces the number of similarity comparisons required for the nearest neighbor search by applying an efficient branch and bound strategy. As a distance-based indexing method, the μ-tree approach does not require the compounds to be represented as multidimensional vectors. However, it requires the similarity measure used to be a metric. Swamidass and Baldi (<xref ref-type="bibr" rid="B37">2007</xref>) used upper bounds on similarity measures for structural fingerprints to reduce the number of molecules that need to be considered in the nearest neighbor searches. Later, Baldi <italic>et al.</italic> (<xref ref-type="bibr" rid="B6">2008</xref>) employed tighter bounds to achieve further time savings. These latter two methods have been designed to be used only with fingerprint-based similarity measures.</p>
    <p>A variety of data structures and algorithms have been proposed to accelerate the nearest neighbor search in multidimensional Euclidean space (reviewed by Bohm <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2001</xref>). These methods, often referred to as multidimensional access methods (MAMs), have not been widely used in similarity searching and clustering of chemical compounds. The reason for this may be the popularity of non-Euclidean similarity coefficients in chemical structure similarity searching, which are not immediately compatible with MAMs. Moreover, Fu <italic>et al.</italic> (<xref ref-type="bibr" rid="B18">2000</xref>) reported that the embedding of the generic metric space into multidimensional space can introduce considerable inaccuracy in the nearest neighbor search applications.</p>
    <p>In this article, we introduce the embedding and indexing (EI)-Search and EI-Clustering methods for ultra-fast similarity searching and clustering of very large datasets using an EI strategy. First, we introduce an efficient embedding algorithm. Subsequently, we describe the design of EI-Search and EI-Clustering, and test their efficiency and accuracy. Finally, experimental test results for three large compound datasets are presented and discussed.</p>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHOD</title>
    <sec id="SEC2.1">
      <title>2.1 Embedding compounds in Euclidean space</title>
      <p>The foundation of our algorithms is the usage of embedding techniques to build multidimensional vector representations of compound structures, which can be used to approximate compound dissimilarities by the inter-vector distances. Embedding objects in Euclidean space offers many benefits, such as the possibility of accelerating the nearest neighbor search. In addition, they are useful for <italic>all-pair</italic> query approaches used in data visualization, clustering and data mining (Faloutsos and Lin, <xref ref-type="bibr" rid="B17">1995</xref>).</p>
      <p>The problem of geometric embedding has previously been studied and applied to the nearest neighbor search in metric space. Three of the most widely used methods in this area are multidimensional scaling (MDS; Kruskal and Wish, <xref ref-type="bibr" rid="B25">1978</xref>), stochastic proximity embedding (SPE; Agrafiotis, <xref ref-type="bibr" rid="B1">2003</xref>; Agrafiotis and Xu, <xref ref-type="bibr" rid="B4">2002</xref>; Smellie <italic>et al.</italic>, <xref ref-type="bibr" rid="B35">2006</xref>) and FastMap (Faloutsos and Lin, <xref ref-type="bibr" rid="B17">1995</xref>). MDS is used to discover structures in datasets by representing the relationships among its objects as spacial distances in a low-dimensional display plane. It is computationally expensive because it depends on the availability of all pairwise dissimilarities among the objects in a dataset. As a result, it becomes quickly infeasible for compound databases with more than a few thousand entries.</p>
      <p>Many variances of MDS have been proposed to solve the problem for large datasets. Chang and Lee (<xref ref-type="bibr" rid="B11">1973</xref>) selected from the whole dataset a smaller number of representative objects, called <italic>pivots</italic>, and applied classic MDS to this subset. The remaining objects were then embedded to the same Euclidean space based on their distances to the pivots.</p>
      <p>SPE is an alternative to MDS. As a self-organizing algorithm, SPE starts with an initial assignment of data points to coordinates and carries out iterative pairwise refinement steps by adjusting randomly selected pairs of coordinates to better approximate the corresponding dissimilarity values. SPE is very efficient and is reported to scale linearly with the size of the dataset.</p>
      <p>FastMap is another fast alternative of MDS with linear-time complexity. It gains its computational efficiency by directly calculating the induced vectors rather than iterative improvement steps used by most MDS implementations. However, the proper choice of the set of <italic>pivot objects</italic> can be complicated by the presence of large numbers of <italic>outlier compounds</italic> that are not similar to any other compounds in a compound library.</p>
      <p>This study presents an alternative embedding method that is accurate and robust enough to process very large compound datasets. The initial steps of the embedding procedure are similar to the method from Chang and Lee (<xref ref-type="bibr" rid="B11">1973</xref>), but it differs significantly in its final optimization steps. The method starts by dividing all compounds into two sets: a small <italic>reference compound set</italic> and a much larger <italic>target compound set</italic>. The reference compound set is a user-definable parameter that can be generated by maximum diversity or random selection methods of compounds in a given library. Traditional MDS is applied to obtain the coordinates of the induced <italic>reference vectors</italic> for the reference compounds. Subsequently, an induced <italic>target vector</italic> is obtained for each target compound by computing the vector coordinates that can best preserve its dissimilarity to all reference compounds. More specifically, for the <italic>i</italic>-th target compound <italic>o</italic><sub><italic>i</italic></sub>, the following stress function is minimized:
<disp-formula id="M1"><label>(1)</label><graphic xlink:href="btq067m1"/></disp-formula>
In this equation, <italic>d</italic>(<italic>o</italic><sub><italic>i</italic></sub>, <italic>r</italic><sub><italic>j</italic></sub>) is the dissimilarity value between target compound <italic>o</italic><sub><italic>i</italic></sub> and reference compound <italic>r</italic><sub><italic>j</italic></sub>. The variable <inline-formula><inline-graphic xlink:href="btq067i1.jpg"/></inline-formula> is the coordinate of the <italic>j</italic>-th induced reference vector obtained by applying MDS to the reference compounds. The unknown coordinate of the <italic>i</italic>-th target vector is <italic>x</italic><sub><italic>i</italic></sub>, and <inline-formula><inline-graphic xlink:href="btq067i2.jpg"/></inline-formula> gives the Euclidean distance between <italic>x</italic><sub><italic>i</italic></sub> and <inline-formula><inline-graphic xlink:href="btq067i3.jpg"/></inline-formula>. By minimizing the stress function with a global optimization algorithm, the coordinate <italic>x</italic><sub><italic>i</italic></sub> can be computed so that it best preserves the dissimilarities from target compound <italic>o</italic><sub><italic>i</italic></sub> to all reference compounds.</p>
      <p>Two very important parameters in our modified version of the MDS algorithm are the number of dimensions <italic>D</italic> and the reference compound set. Large <italic>D</italic> values will not increase the minimum value of the stress function, and thus will never negatively impact the embedding quality. To maximize the embedding quality, our method can be used with conservatively large <italic>D</italic> values of over 100, but at the expense of longer computation times for both the embedding and the downstream similarity searches. Often <italic>D</italic> values &gt;100 may not be necessary for many types of molecular descriptors (e.g. physicochemical), due to their frequently high redundancy and correlation among each other (Agrafiotis and Xu, <xref ref-type="bibr" rid="B4">2002</xref>). It might also be possible to take advantage of low intrinsic dimensionality of some similarity measures, using methods such as ISOMAP (Tenenbaum <italic>et al.</italic>, <xref ref-type="bibr" rid="B38">2000</xref>) and locally linear embedding (LLE; Roweis and Saul, <xref ref-type="bibr" rid="B31">2000</xref>). However, our tests using ISOMAP with atom pair descriptor also showed that <italic>D</italic> values &gt;100 may still be necessary for some molecular descriptors to achieve satisfactory accuracy.</p>
      <p>The reference compound set is the second important parameter for our approach. The size of the set, <italic>R</italic>, directly controls the complexity of the stress function. Therefore, the larger the reference compound set, the longer the embedding time. Furthermore, both the size and the composition of the reference set have an influence on the embedding quality. This is because the induced reference vectors serve as similarity landmarks to position each target compound in the embedding space according to its dissimilarity profile to all reference compounds. To minimize ambiguous placements, the reference set should ideally be chosen as diversely as possible and cover the entire chemical space of the target compounds. However, our benchmark tests for structure similarity searching and clustering, have shown that randomly selecting reference compounds is sufficient to obtain robust results (<xref ref-type="sec" rid="SEC3.5">Section 3.5</xref>). This is partly because <italic>R</italic> is usually much larger than the number of <italic>D</italic>. Due to this redundancy, choosing one or several suboptimal reference compounds will not have a great impact on the embedding quality.</p>
      <p>Moreover, it is important to identify the smallest values for <italic>R</italic> and <italic>D</italic>, which can achieve satisfactory accuracy. Increasing either value will result in longer processing time. This does not only apply to the embedding of the compound database, but also to every query structure used in similarity searches, because both components have to go through the embedding process. This slightly offsets the time saving gained by the other parts of the algorithm. Agrafiotis <italic>et al.</italic> (<xref ref-type="bibr" rid="B3">2001</xref>) presented a neural network-based method that could reduce the embedding time of our method significantly. However, in our tests we were not able to achieve embedding qualities with this method that were sufficient for similarity search and clustering applications (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq067/DC1">Supplementary Table S-1</ext-link>).</p>
      <p>Compared to the quadratic time complexity of traditional MDS methods, our algorithm offers large time savings. Given similar distributions of pairwise dissimilarities and a fixed number of reference compounds, the running time of the above embedding algorithm is roughly linear to the number of compounds. Because each target compound is processed independently, our method can be easily parallelized on computers with multiple CPU cores or compute clusters. This is a very desirable feature when processing very large compound databases. The related SPE method is in its current form less effective for processing very large datasets because of the challenges involved in implementing a parallelized version of this algorithm. Our tests with a publicly available implementation of the SPE algorithm show that its unparallelized compute times on very large datasets with millions of compounds are too long to obtain embeddings of high enough qualities to perform accurate nearest neighbor searches with acceptable recall rates (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq067/DC1">Supplementary Table S-2</ext-link>). Nevertheless, SPE is a powerful algorithm that can be easily utilized as an alternative embedding method by our EI-Search and EI-Clustering tools.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 EI-Search</title>
      <p>After the compounds are embedded into the <italic>D</italic>-dimensional Euclidean space, structure similarity searches can be performed by a nearest neighbor search in the embedding space. For this, the query compound is embedded into the same <italic>D</italic>-dimensional Euclidean space. Subsequently, the corresponding induced vector is used to perform a nearest neighbor search in the embedding space. This search method offers great time savings and flexibility for similarity searches because of two major reasons. First, compared to other similarity measures used for comparing compound structures, Euclidean distances can be calculated very efficiently. Second, many MAMs can be employed in the nearest neighbor search to further improve its time efficiency.</p>
      <p>Although many MAMs have been proposed to speedup the nearest neighbor search problem, most of them are affected by the dimensionality problem, often referred to as <italic>the curse of dimensionality</italic>. This is the phenomenon that for various geometric search problems, including the nearest neighbor search, the best algorithms known have performance trends that degrade exponentially with an increase in dimensionality (Weber <italic>et al.</italic>, <xref ref-type="bibr" rid="B40">1998</xref>). Our tests also confirmed that the SR-tree method (Katayama, <xref ref-type="bibr" rid="B24">1997</xref>) becomes slower than sequential scans of the dataset as soon as <italic>D</italic> is set to values &gt;100. However, our tests also indicated that the dissimilarities between compound structures can only be preserved reliably with large <italic>D</italic> values of at least 100. Thus, it is important for our method to combine high-dimensional embedding and an indexing method that are both insensitive to the dimensionality problem.</p>
      <p>It has become increasingly popular to use the approximate nearest neighbor search in high-dimensional space to avoid the dimensionality problem. One of these approximation approaches utilizes a spatial index using locality sensitivity hashing (LSH) to perform the fast nearest neighbor search in Euclidean space. LSH uses a family of hashing functions to map database objects into buckets. It is designed to join related items based on a given similarity measure with high probability. Accordingly, many hashing functions vary with respect to their similarity measures. For example, Gionis <italic>et al.</italic> (<xref ref-type="bibr" rid="B19">1999</xref>) introduced in the original LSH paper a bit sampling-based LSH approach that uses the Hamming distance measure. Datar <italic>et al.</italic> (<xref ref-type="bibr" rid="B15">2004</xref>) proposed an LSH scheme for p-stable distributions along with Euclidean distances. However, so far no hashing functions have been developed for the similarity measures that are commonly used for comparing compound structures. This limitation can be addressed by embedding compounds in Euclidean space and building for them a spatial index using induced vectors in embedding space.</p>
      <p>Taking advantage of the above embedding and the LSH-based spatial indexing approaches, we designed an efficient approximate compound structure similarity search algorithm. This algorithm is named <italic>EI-Search</italic> after its two key components: <italic>embedding</italic> and <italic>indexing</italic>. The algorithm first preprocesses the compound dataset by embedding it into a high-dimensional Euclidean space and generating a spatial index using LSH. When searching for <italic>k</italic> compounds that are most similar to a given query compound, a two-step approach is employed to reduce the error introduced in the embedding process and the approximate nearest neighbor search. First, the query compound is embedded in the same Euclidean space. The resulting induced vector is then used in an index-assisted nearest neighbor search of the embedding space to retrieve a candidate set consisting of γ · <italic>k</italic> vectors that are most similar to it. The <italic>relaxation ratio</italic> γ is a user-defined parameter that controls the trade-off between processing time and search accuracy. Larger values for γ result in larger candidate sets and possibly higher accuracy, but at the cost of longer search times. Second, a refinement step applies exact structure similarity searches to the candidate set obtained in the first step. This allows the selection of the final <italic>k</italic> compounds that are most similar to the query structure.</p>
      <p>Compared to commonly used structure similarity search methods, EI-Search has several advantages. The most important ones are its time efficiency and compatibility with a wide range of similarity measurements. This makes the method potentially useful for accelerating similarity searches of a variety of data objects that are of relevance to many life science and non-life science areas.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 EI-Clustering</title>
      <p>In addition to similarity searching, Euclidean space representations can be used for clustering large datasets very efficiently. For example, spatial join can be used to perform single linkage clustering by finding all vector pairs, which are separated by a distance below a given threshold (Brinkhoff <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">1993</xref>). The nearest neighbor information required for Jarvis–Patrick clustering can also be obtained very efficiently in Euclidean space by using an efficient algorithm for the all-nearest-neighbors problem (Vaidya, <xref ref-type="bibr" rid="B39">1989</xref>).</p>
      <p>In this article, we introduce a new clustering method, <italic>EI-Clustering</italic>, that takes advantage of the accelerated search speed provided by EI-Search to cluster very large sets of chemical compounds under the Jarvis–Patrick clustering framework. Jarvis–Patrick clustering requires a nearest neighbor table, which consists of <italic>p</italic> nearest neighbors for each compound in the dataset. This information is then used to join compounds into clusters that share at least <italic>m</italic> nearest neighbors. The values for <italic>p</italic> and <italic>m</italic> are user-defined parameters. In case of EI-Clustering, the EI-Search method generates the nearest neighbor information for each compound in the dataset. The resulting nearest neighbor table is then used as direct input for Jarvis–Patrick clustering. When clustering very large datasets, EI-Clustering is particularly efficient due to its fast computation of the nearest neighbor table.</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 EVALUATION</title>
    <sec id="SEC3.1">
      <title>3.1 Implementation</title>
      <p>We implemented the EI-Search and EI-Clustering algorithms as C++ programs. Internally, they use the L-BFGS-B library (Zhu <italic>et al.</italic>, <xref ref-type="bibr" rid="B45">1997</xref>) for the global optimization step in the embedding procedure. For the LSH-based spatial indexing, we utilized the <italic>lshkit</italic> library that implements the MPLSH algorithm, a variant of LSH that requires fewer hash tables and offers large space savings as well as shorter query time (Lv <italic>et al.</italic>, <xref ref-type="bibr" rid="B26">2007</xref>). In addition, we wrote a reusable C++ library for calculating atom pair descriptors. We were particularly interested in testing atom pair descriptors because of their superior performance in structure similarity searching (Chen and Reynolds, <xref ref-type="bibr" rid="B13">2002</xref>). To also include in our tests one of the most widely used fingerprint methods, we employed the fingerprint descriptors used by PubChem and utilized a fingerprint implementation provided by the NIH Chemical Genomics Center (<xref ref-type="bibr" rid="B27">2009</xref>). Jarvis–Patrick clustering was performed with a custom program implemented in C++.</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Datasets and testing platform</title>
      <p>To test the performance of the proposed methods, benchmark comparisons for similarity searching and clustering were performed using the publicly available compound structures from NCI and PubChem. The NCI dataset consisted of 260 071 compounds. After removing entries that did not generate any usable atom pair descriptors, 260 027 compound structures were used from this collection. From PubChem, we used the structures from the PubChem Compound dataset. From this collection, we selected two sets: one subset consisting of 2.3 million compounds with at least five non-hydrogen bonds (PubChem Subset) as well as the entire PubChem Compound library with over all 19 million compounds (PubChem Compound).</p>
      <p>The tests were performed on a Linux computer equipped with Xeon CPUs clocked at 2.4 GHz and 16 GB of RAM. For parallelized computations, a computer cluster was used with the exact same hardware configuration per compute node. Compute times are given as total CPU hours throughout the text.</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Time efficiency of embedding</title>
      <p>First, we evaluated the running time of our modified MDS algorithm for different parameters. For this, the compounds from all three datasets were embedded into a high-dimensional Euclidean space.</p>
      <sec id="SEC3.3.1">
        <title>3.3.1 Time efficiency with respect to the size of the dataset</title>
        <p>Our results show that the time required for embedding increases almost linearly with the number of compounds in the library (Table S-3 in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq067/DC1">Supplementary Materials</ext-link>). The average time to embed one compound varies only slightly across the three datasets and is below 0.3 s using a practical parameter set. Because the embedding algorithm processes each compound independently after applying MDS to the reference compound set, it is trivial to further reduce its computation time by using a compute cluster. In our experiments, it took around 10 min to process the 260 027 compounds of the NCI dataset using 87 CPUs. Similarly, the 19 million compounds of the PubChem Compound library could be processed in less than a day using 80 CPUs.</p>
      </sec>
      <sec id="SEC3.3.2">
        <title>3.3.2 Time efficiency with respect to the embedding parameters</title>
        <p>As discussed above, the number of dimensions <italic>D</italic> and the number of reference compounds <italic>R</italic> are the two main factors that will affect the embedding time. To estimate their impact, we randomly selected from the NCI library seven reference compound sets with sizes ranging from 240 to 800 compounds. These reference sets were used in independent test runs of our embedding algorithm where <italic>D</italic> was set to a fixed value to study the influence of <italic>R</italic> on the total CPU time. Similarly, to model the impact of <italic>D</italic>, the value of <italic>R</italic> was fixed to three times the value of <italic>D</italic> and the total CPU time was collected using <italic>D</italic> values ranging from 120 to 260. These ranges were chosen to ensure high-quality embedding, but also to keep the computation within manageable time limits. Our test results (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq067/DC1">Supplementary Fig. S-1</ext-link>) indicate that the total CPU time of our method grows linearly with <italic>R</italic>, and exponentially with <italic>D</italic>. Based on this time behavior, the values for <italic>R</italic> and <italic>D</italic> should be chosen as small as possible, but large enough to maintain an embedding quality that is sufficient for the downstream similarity search and clustering steps (see below).</p>
      </sec>
      <sec id="SEC3.3.3">
        <title>3.3.3 Time efficiency and global optimization parameters</title>
        <p>Solving the global optimization problem accounts for most of the embedding time. Therefore, the parameter choice of this step has a great impact on the time efficiency of the embedding step of our method. Using less stringent termination conditions for the L-BFGS-B algorithm, will typically reduce the embedding time, but at a cost of embedding quality. For example, the average time to embed one compound could be easily cut into half with a small loss in accuracy (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq067/DC1">Supplementary Table S-3</ext-link>). Although the preprocessing of new datasets is time consuming, our method is relatively flexible with respect to adding new entries to an already preprocessed library. Because all entries are embedded independently, one can easily add new ones without repeating this process for the entire dataset. This meets the work flow requirements of many large compound databases, where minor updates occur frequently, but major revisions are rare.</p>
      </sec>
    </sec>
    <sec id="SEC3.4">
      <title>3.4 Quality of embedding</title>
      <p>As pointed out by previous studies, embedding metric representations of objects in Euclidean space may reduce the accuracy of the nearest neighbor searches (Fu <italic>et al.</italic>, <xref ref-type="bibr" rid="B18">2000</xref>). However, when the parameters for our embedding method are chosen properly, the method is accurate enough to be used in the prescreening step of EI-Search (as shown in <xref ref-type="sec" rid="SEC3.5">Section 3.5</xref>). As a performance test of the embedding step, we randomly selected 10 million compound pairs from the NCI dataset, computed their atom pair-based Tanimoto similarity coefficients and compared them with the corresponding distance values obtained from the induced vectors. The two datasets were highly correlated, as indicated by a Pearson's correlation coefficient of 0.79. Additionally, the agreement among the datasets was evaluated by grouping the Tanimoto coefficients into 10 similarity intervals from 0 to 1 using increments of 0.1. Subsequently, the distributions of the vector distances for each interval were plotted in the form of box plots. In this representation, a low degree of overlap among the boxes from adjacent intervals indicates a strong agreement between the two methods. The box plots obtained from our tests show only a moderate overlap among adjacent intervals, and only minor to no overlap among more distant intervals (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq067/DC1">Supplementary Fig. S-2</ext-link>). This indicates a strong agreement among the two methods for the majority of the compounds with some inconsistencies at the interval boundaries, but for a much smaller number of cases. For example, for high Tanimoto similarities ranging from 0.8 to 1, the similarities of the corresponding vectors pairs (1−distance) fall all into a very narrow range 0.75–1.0. The two methods also agree very well in the low similarity range. This is indicated by the fact that 98.17% of all compound pairs with a Tanimoto coefficient &lt;0.4 are placed into a very similar range (&lt;0.38) in vector space. Based on these results, our embedding method appears to preserve well-separated ranges of Tanimoto coefficients in a robust manner.</p>
    </sec>
    <sec id="SEC3.5">
      <title>3.5 Accuracy of EI-Search</title>
      <p>To further examine the accuracy of the EI-Search method for compound similarity searching, we implemented an EI-Search program and tested it with different parameters. The accuracy of EI-Search is measured by the <italic>recall rate</italic>. When retrieving the <italic>k</italic> most similar compounds to a query structure, the recall rate is defined as the percentage of compounds obtained with EI-Search that are also returned by sequential search methods. To evaluate the impact of the different parameters used by EI-Search, the program was run using different values of <italic>D</italic>, <italic>R</italic>, <italic>k</italic> and γ. In each run, the recall rates for 1000 random queries from the NCI dataset were calculated.</p>
      <p>First, we compared the recall rates when searching for the <italic>k</italic> most similar compounds with different <italic>R</italic> and γ values while the values of <italic>k</italic> and <italic>D</italic> were fixed. (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq067/DC1">Supplementary Fig. S-3a</ext-link> shows the results for constant <italic>k</italic> and <italic>D</italic> values of 100 and 140, respectively.) The results indicate that increasing γ from 1 to 50 results in a significant improvement of the recall performance, while this effect starts to plateau off at values of &gt;20. With respect to the number of reference compounds <italic>R</italic>, the recall rate increases from values 240 to 420. Based on these results, a good empirical choice for <italic>R</italic> is between two and three times the value of <italic>D</italic>. Another observation is the fact that the effect of <italic>R</italic> diminishes for γ values &gt;20. In other words, large enough γ values can compensate a suboptimal choice of <italic>R</italic>. For example, when γ was set to 20, and <italic>k</italic> to 100 and <italic>D</italic> to 140, the best and worst recall rates were 97.87% and 97.35%, respectively. This corresponds to a difference of only 0.52%.</p>
      <p>Similarly, we investigated the correlation between the recall rates and the values of <italic>D</italic> and γ. According to the results from the previous tests, the <italic>R</italic> values were always set to three times the values of <italic>D</italic>. When searching for the <italic>k</italic> most similar compounds the recall rates were collected for different <italic>D</italic> and γ values while the value of <italic>k</italic> was fixed. <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq067/DC1">Supplementary Figure S-3b</ext-link> shows the results for a <italic>k</italic> value of 100. These results indicate that the recall rates consistently improve with the number of dimensions. This effect is much stronger for smaller γ values. For example, when <italic>k</italic> was set to 100 and γ to 1, then the recall rate could be improved from 58.35% to 65.57% for <italic>D</italic> values of 120 and 260, respectively. For large γ values above 20 this effect is again much less pronounced. While larger γ values will result in an increase in processing time, their impact is less severe than increasing the value of <italic>D</italic>. Accordingly, we chose in the subsequent experiments the <italic>D</italic> values as small as possible and the γ values as large as necessary to maintain both high accuracy and time efficiency of the method.</p>
    </sec>
    <sec id="SEC3.6">
      <title>3.6 Time efficiency of EI-Search</title>
      <p>While maintaining high recall rates, EI-Search was able to greatly reduce the time for performing structure similarity searches in large compound databases. To examine the time efficiency of EI-Search, 1000 random queries were performed on each of the three datasets using first the EI-Search program and then exhaustive sequential searches with the atom pair and fingerprint similarity search programs. For each comparison we used for EI-Search the same descriptor type as for the sequential search methods. The query compounds were randomly selected from the dataset. To obtain realistic search results, the 100 most similar compounds with a minimum similarity of 0.5 were retrieved for each query. Atom pair descriptors combined with Tanimoto coefficients were used as similarity measure. For the PubChem Compound library, we also included in the tests the Tanimoto similarities of PubChem's fingerprints. According to the above parameter optimization results, we used in all tests the following settings: <italic>R</italic>=300, <italic>D</italic>=120 and γ=30. The obtained search times and recall rates are listed in <xref ref-type="table" rid="T1">Table 1</xref>.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Performance tests of EI-Search</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Dataset<hr/></th><th align="left" rowspan="1" colspan="1">NCI<hr/></th><th align="left" rowspan="1" colspan="1">PubChem Subset<hr/></th><th align="left" colspan="2" rowspan="1">PubChem Compound<hr/></th></tr><tr><th align="left" rowspan="1" colspan="1">Descriptor type</th><th align="left" rowspan="1" colspan="1">Atom pair</th><th align="left" rowspan="1" colspan="1">Atom pair</th><th align="left" rowspan="1" colspan="1">Atom pair</th><th align="left" rowspan="1" colspan="1">Fingerprint</th></tr></thead><tbody align="left"><tr><td align="left" colspan="5" rowspan="1">Average search time (s)</td></tr><tr><td align="left" rowspan="1" colspan="1"> Sequential search</td><td align="left" rowspan="1" colspan="1">0.800</td><td align="left" rowspan="1" colspan="1">11.570</td><td align="left" rowspan="1" colspan="1">93.121</td><td align="left" rowspan="1" colspan="1">19.658</td></tr><tr><td align="left" rowspan="1" colspan="1"> EI-Search</td><td align="left" rowspan="1" colspan="1">0.067</td><td align="left" rowspan="1" colspan="1">0.170</td><td align="left" rowspan="1" colspan="1">0.427</td><td align="left" rowspan="1" colspan="1">0.499</td></tr><tr><td colspan="5" align="left" rowspan="1">Recall of EI-Search (%)</td></tr><tr><td align="left" rowspan="1" colspan="1"> Mean</td><td align="left" rowspan="1" colspan="1">99.95</td><td align="left" rowspan="1" colspan="1">99.60</td><td align="left" rowspan="1" colspan="1">97.38</td><td align="left" rowspan="1" colspan="1">96.32</td></tr><tr><td align="left" rowspan="1" colspan="1"> SD</td><td align="left" rowspan="1" colspan="1">0.44</td><td align="left" rowspan="1" colspan="1">1.82</td><td align="left" rowspan="1" colspan="1">5.61</td><td align="left" rowspan="1" colspan="1">11.54</td></tr></tbody></table><table-wrap-foot><fn><p>Search times and recall rates are listed for searching three large compound sets with EI-Search and the sequential search methods. The same descriptor type was used for each comparison pair. The experiments were performed on the same hardware using the same embedding and relaxation parameters (<italic>R</italic> = 300, <italic>D</italic> = 120 and γ = 30). The LSH parameters were supplied by <italic>lshkit</italic>.</p></fn></table-wrap-foot></table-wrap>
</p>
      <p>Several conclusions can be drawn from <xref ref-type="table" rid="T1">Table 1</xref>. First, in comparison to the highly accurate atom pair method, EI-Search achieves in the atom pair descriptor tests very high recall rates ranging from 97.38% to 99.95%. In comparison to the fingerprint method, the recall rate of the corresponding EI-Search is slightly lower with 96.32%. The reason for this reduction may be the fact that fingerprints provide less accurate similarity measures than atom pairs (Chen and Reynolds, <xref ref-type="bibr" rid="B13">2002</xref>). This could result in less robust rankings of the nearest neighbor search results, and therefore a slightly lower recall rate is reasonable. Second, EI-Search provides significant time savings for the nearest neighbor searches. For example, the average time required to search &gt;19 million compounds of the PubChem Compound dataset is reduced for the atom pair approach from &gt;93 to &lt;0.5 s, and for the fingerprint method from &gt;19 to &lt;0.5 s. This corresponds to accelerations by our EI-Search method of over 200 and 40 folds, respectively. Third, while the search time for the exhaustive sequential search methods increases linearly with the size of the databases, this increase is less than linear for the EI-Search method. For instance, searching the PubChem Subset dataset with EI-Search takes on average only 2.5 times longer than searching the NCI dataset, that has one-ninth of the size of PubChem Subset. Finally, another outstanding feature of EI-Search is the fact that its search speed is much less impacted by the complexity of the similarity measure used for database searching than this is the case for the exhaustive methods. For instance, the switch from the fingerprint similarity measure to the more computationally expensive atom pair similarity measure results only in a minor increase of EI-Search's query time, while it is a &gt;4-fold increase for the exhaustive sequential search methods.</p>
    </sec>
    <sec id="SEC3.7">
      <title>3.7 Accuracy and time efficiency of EI-Clustering</title>
      <p>To test the performance of our EI-Clustering method for partitioning large compound sets, we clustered all three compound sets with the Jarvis–Patrick algorithm. The required nearest neighbor tables were generated with EI-Search and the exhaustive sequential search methods. EI-Search was run with the same embedding and searching parameters (<italic>R</italic>=300, <italic>D</italic>=120 and γ=30) as in the previous section. The LSH parameters were slightly changed to achieve higher accuracy. The process of generating the nearest neighbor tables was parallelized on a computer cluster. For each clustering result, the total search time was calculated for all utilized CPUs. To measure the agreement among the clustering results, we computed the Jaccard partition coefficient for each pair of clustering results (<xref ref-type="table" rid="T2">Table 2</xref>). Jaccard coefficients close to zero indicate low similarities and values close to one indicate high similarities among the evaluated cluster sets.
<table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>Performance tests for EI-Clustering</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Dataset<hr/></th><th align="left" rowspan="1" colspan="1">NCI<hr/></th><th align="left" rowspan="1" colspan="1">PubChem Subset<hr/></th><th align="left" colspan="2" rowspan="1">PubChem Compound<hr/></th></tr><tr><th align="left" rowspan="1" colspan="1">Similarity measure</th><th align="left" rowspan="1" colspan="1">Atom pair</th><th align="left" rowspan="1" colspan="1">Atom pair</th><th align="left" rowspan="1" colspan="1">Atom pair</th><th align="left" rowspan="1" colspan="1">Fingerprint</th></tr></thead><tbody align="left"><tr><td colspan="5" align="left" rowspan="1">Total clustering time (h)</td></tr><tr><td align="left" rowspan="1" colspan="1"> Jarvis–Patrick</td><td align="left" rowspan="1" colspan="1">72.9</td><td align="left" rowspan="1" colspan="1">7355.6</td><td align="left" rowspan="1" colspan="1">N/A</td><td align="left" rowspan="1" colspan="1">N/A</td></tr><tr><td align="left" rowspan="1" colspan="1"> EI-Clustering</td><td align="left" rowspan="1" colspan="1">3.5</td><td align="left" rowspan="1" colspan="1">92.2</td><td align="left" rowspan="1" colspan="1">1517.2</td><td align="left" rowspan="1" colspan="1">2869.71</td></tr><tr><td align="left" rowspan="1" colspan="1">Jaccard coefficient</td><td align="left" rowspan="1" colspan="1">0.9913</td><td align="left" rowspan="1" colspan="1">0.9887</td><td align="left" rowspan="1" colspan="1">N/A</td><td align="left" rowspan="1" colspan="1">N/A</td></tr></tbody></table><table-wrap-foot><fn><p>The table compares the time and accuracy performance of EI-Clustering with Jarvis–Patrick clustering when using exhaustive search methods for generating the required nearest neighbor information. The compute time is given in hours of total CPU time. The agreement among the clustering results is given in the last row in form of Jaccard partition coefficients. Clustering of the PubChem Compound dataset was not possible with the exhaustive search methods due to their insufficient performance on this large dataset.</p></fn></table-wrap-foot></table-wrap>
</p>
      <p>The results in <xref ref-type="table" rid="T2">Table 2</xref> show that the EI-Clustering method can dramatically reduce the processing time of the Jarvis–Patrick clustering approach while maintaining a high level of agreement with the results obtained by Jarvis–Patrick clustering with exhaustive nearest neighbor search methods (Jaccard coefficients &gt;0.98). The total CPU time to process over 2.3 million compounds from the PubChem Subset could be reduced from over 306 days to just 4 days. This is a major improvement, because it makes it feasible to cluster millions of compounds in a few days on a regular workstation or in a few hours when a small computer cluster is available. By running EI-Search on 80 CPUs on a computer cluster, we were able to cluster the entire PubChem Compound library in only a day. Because EI-Clustering spends most of the time running EI-Search, which runs in time sublinear in the size of the dataset, the compute time of EI-Clustering is subquadratic to the size of the dataset. Therefore, EI-Clustering scales much more efficiently to larger datasets than traditional methods. The superior speed of EI-Clustering comes at the cost of a larger memory footprint compared to the other methods. Most of the memory is consumed by its LSH index. For example, when clustering the 19 million PubChem Compound library, the LSH index requires around 13 GB of memory. Considering the performance of today's research workstations, this memory requirement appears to be manageable.</p>
    </sec>
    <sec id="SEC3.8">
      <title>3.8 Availability of the programs and data</title>
      <p>The EI-Search and EI-Clustering programs can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://chemmine.ucr.edu/ei/">http://chemmine.ucr.edu/ei/</ext-link>. The same web site features an online service using EI-Search for ultra-fast similarity searching of the PubChem Compound library with subsecond response time. In addition, the site provides access to the EI-Clustering results of the entire PubChem Compound library that are based on atom pair and PubChem fingerprint descriptors.</p>
    </sec>
  </sec>
  <sec id="SEC4">
    <title>4 CONCLUSIONS AND FUTURE WORK</title>
    <p>In this study, we have presented EI-Search and EI-Clustering as efficient methods for accelerating structure similarity searches and clustering of very large compound datasets. The acceleration is achieved by applying <italic>embedding and indexing</italic> techniques to represent chemical compounds in a high-dimensional Euclidean space and to employ ultra-fast prescreening of the compound dataset using the LSH-assisted nearest neighbor search in the embedding space. Our tests show that the method can dramatically reduce the search time of large databases, by a factor of 40–200 folds when searching the 100 closest compounds to a query. Recently published acceleration methods achieved only a 5.5-fold reduction in search time when using a Tanimoto threshold of 0.8 and up to 20-fold with a relatively restrictive threshold of 0.9 (Baldi <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2008</xref>; Swamidass and Baldi, <xref ref-type="bibr" rid="B37">2007</xref>). Another limitation of these methods is their narrow utility spectrum that is currently restricted to fingerprint-based searches. In contrast to this, the EI-Search framework is designed to be useful for a wide spectrum of similarity measures. After embedding, EI-Search will run in most cases with comparable time efficiencies independent of the complexity of the similarity measure. This can be particularly useful for accelerating searches that use much more accurate, but computationally very expensive similarity measures, such as maximum common substructures or 3D approaches (Cao <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">2008</xref>; Raymond <italic>et al.</italic>, <xref ref-type="bibr" rid="B30">2003</xref>; Willett, <xref ref-type="bibr" rid="B42">2005</xref>).</p>
    <p>By taking advantage of the fast similarity search speed of EI-Search, we developed EI-Clustering into an effective clustering method for very large datasets. The method accelerated the clustering of the three test datasets used in this study by 20–80 folds. Most importantly, the EI-Clustering made it feasible to cluster datasets of almost 20 million entries within acceptable time limits. Due to its subquadratic running time, the EI-Clustering method should scale well enough to cluster even larger datasets with tens or even hundreds of millions of objects.</p>
    <p>In the future, we will expand the performance and utility spectrum of the EI-Search and EI-Clustering methods on several levels. First, several statistical methods will be employed to further improve the embedding algorithm by dynamically optimizing its parameters and the selection of the most effective reference compounds. Second, the EI-Search method will be tested and optimized for the usage of a variety of more complex similarity measures that are available for compound structures. Finally, additional clustering algorithms, besides Jarvis–Patrick clustering, will be incorporated into the EI-Clustering method.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>[Supplementary Data]</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="btq067_index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="btq067_1.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We acknowledge the support from the Bioinformatics Core Facility, the Center for Plant Cell Biology (CEPCEB) and the Institute for Integrative Genome Biology (IIGB) at UC Riverside.</p>
    <p><italic>Funding</italic>: National Science Foundation (grants IOB-0420033, IOB-0420152, IGERT-0504249 and IIS-0711129).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Agrafiotis</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Stochastic proximity embedding</article-title>
        <source>J. Comput. Chem.</source>
        <year>2003</year>
        <volume>24</volume>
        <fpage>1215</fpage>
        <lpage>1221</lpage>
        <pub-id pub-id-type="pmid">12820129</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Agrafiotis</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lobanov</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>An efficient implementation of distance-based diversity measures based on kd trees</article-title>
        <source>J. Chem. Inf. Comput. Sci.</source>
        <year>1999</year>
        <volume>39</volume>
        <fpage>51</fpage>
        <lpage>58</lpage>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Agrafiotis</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multidimensional scaling and visualization of large molecular similarity tables</article-title>
        <source>J. Comput. Chem.</source>
        <year>2001</year>
        <volume>22</volume>
        <fpage>488</fpage>
        <lpage>500</lpage>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Agrafiotis</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A self-organizing principle for learning nonlinear manifolds</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2002</year>
        <volume>99</volume>
        <fpage>15869</fpage>
        <lpage>15872</lpage>
        <pub-id pub-id-type="pmid">12444256</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Austin</surname>
            <given-names>CP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NIH molecular libraries initiative</article-title>
        <source>Science</source>
        <year>2004</year>
        <volume>306</volume>
        <fpage>1138</fpage>
        <lpage>1139</lpage>
        <pub-id pub-id-type="pmid">15542455</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baldi</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Speeding up chemical database searches using a proximity filter based on the logical exclusive OR</article-title>
        <source>J. Chem. Inf. Model.</source>
        <year>2008</year>
        <volume>48</volume>
        <fpage>1367</fpage>
        <lpage>1378</lpage>
        <pub-id pub-id-type="pmid">18593143</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bentley</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Multidimensional binary search trees used for associative searching</article-title>
        <source>Comm. ACM</source>
        <year>1975</year>
        <volume>18</volume>
        <fpage>509</fpage>
        <lpage>517</lpage>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bohm</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Searching in high-dimensional spaces: index structures for improving the performance of multimedia databases</article-title>
        <source>ACM Comput. Surv.</source>
        <year>2001</year>
        <volume>33</volume>
        <fpage>322</fpage>
        <lpage>373</lpage>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Brinkhoff</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Efficient processing of spatial joins using R-trees</article-title>
        <source>Proceedings of ACM SIGMOD Conference on Management of Data.</source>
        <year>1993</year>
        <publisher-loc>New York, NY</publisher-loc>
        <publisher-name>ACM</publisher-name>
        <fpage>237</fpage>
        <lpage>246</lpage>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A maximum common substructure-based algorithm for searching and predicting drug-like compounds</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>i366</fpage>
        <pub-id pub-id-type="pmid">18586736</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A heuristic relaxation method for nonlinear mapping in cluster analysis</article-title>
        <source>IEEE Trans. Syst. Man Cybernet.</source>
        <year>1973</year>
        <volume>3</volume>
        <fpage>197200</fpage>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>JH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChemDB update—full-text search and virtual chemical space</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2348</fpage>
        <lpage>2351</lpage>
        <pub-id pub-id-type="pmid">17599932</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Reynolds</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Performance of similarity measures in 2D fragment-based similarity searching: comparison of structural descriptors and similarity coefficients</article-title>
        <source>J. Chem. Inf. Comput. Sci.</source>
        <year>2002</year>
        <volume>42</volume>
        <fpage>1407</fpage>
        <lpage>1414</lpage>
        <pub-id pub-id-type="pmid">12444738</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>AC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure-based maximal affinity model predicts small-molecule druggability</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2007</year>
        <volume>25</volume>
        <fpage>71</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="pmid">17211405</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Datar</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Locality-sensitive hashing scheme based on p-stable distributions</article-title>
        <source>Proceedings of the Twentieth Annual Symposium on Computational Geometry.</source>
        <year>2004</year>
        <publisher-loc>New York, NY</publisher-loc>
        <publisher-name>ACM</publisher-name>
        <fpage>253</fpage>
        <lpage>262</lpage>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Downs</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Barnard</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Clustering methods and their uses in computational chemistry</article-title>
        <source>Rev. Comput. Chem.</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>40</lpage>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Faloutsos</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>FastMap: a fast algorithm for indexing, data-mining and visualization of traditional and multimedia datasets</article-title>
        <source>Proceedings of the ACM SIGMOD Conference on Management of Data.</source>
        <year>1995</year>
        <publisher-loc>New York, NY</publisher-loc>
        <publisher-name>ACM</publisher-name>
        <fpage>163</fpage>
        <lpage>174</lpage>
      </element-citation>
    </ref>
    <ref id="B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dynamic vp-tree indexing for n-nearest neighbor search given pair-wise distances</article-title>
        <source>VLDB J.</source>
        <year>2000</year>
        <volume>9</volume>
        <fpage>154</fpage>
        <lpage>173</lpage>
      </element-citation>
    </ref>
    <ref id="B19">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gionis</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Similarity search in high dimensions via hashing</article-title>
        <source>Proceedings of the International Conference on Very Large Data Bases.</source>
        <year>1999</year>
        <publisher-loc>San Francisco</publisher-loc>
        <publisher-name>Morgan Kaufmann Publishers Inc.</publisher-name>
        <fpage>518</fpage>
        <lpage>529</lpage>
      </element-citation>
    </ref>
    <ref id="B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Girke</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChemMine. A compound mining database for chemical genomics</article-title>
        <source>Plant Physiol.</source>
        <year>2005</year>
        <volume>138</volume>
        <fpage>573</fpage>
        <lpage>577</lpage>
        <pub-id pub-id-type="pmid">15955920</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haggarty</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>The principle of complementarity: chemical versus biological space</article-title>
        <source>Curr. Opin. Chem. Biol.</source>
        <year>2005</year>
        <volume>9</volume>
        <fpage>296</fpage>
        <lpage>303</lpage>
        <pub-id pub-id-type="pmid">15939332</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ihlenfeldt</surname>
            <given-names>WD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Enhanced CACTVS browser of the open NCI database</article-title>
        <source>J. Chem. Inf. Comput. Sci.</source>
        <year>2002</year>
        <volume>42</volume>
        <fpage>46</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="pmid">11855965</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irwin</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Shoichet</surname>
            <given-names>BK</given-names>
          </name>
        </person-group>
        <article-title>ZINC—a free database of commercially available compounds for virtual screening</article-title>
        <source>J. Chem. Inf. Model.</source>
        <year>2005</year>
        <volume>45</volume>
        <fpage>177</fpage>
        <lpage>182</lpage>
        <pub-id pub-id-type="pmid">15667143</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Katayama</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>The SR-tree: an index structure for high-dimensional nearest neighbor queries</article-title>
        <source>Proceedings of the ACM SIGMOD Conference on Management of Data.</source>
        <year>1997</year>
        <publisher-loc>New York, NY</publisher-loc>
        <publisher-name>ACM</publisher-name>
        <fpage>369</fpage>
        <lpage>380</lpage>
      </element-citation>
    </ref>
    <ref id="B25">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kruskal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wish</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Multidimensional Scaling.</source>
        <year>1978</year>
        <publisher-name>Sage Publications</publisher-name>
      </element-citation>
    </ref>
    <ref id="B26">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lv</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multi-probe LSH: efficient indexing for high-dimensional similarity search</article-title>
        <source>Proceedings of the International Conference on Very Large Data Bases.</source>
        <year>2007</year>
        <publisher-name>VLDB Endowment</publisher-name>
        <fpage>950</fpage>
        <lpage>961</lpage>
      </element-citation>
    </ref>
    <ref id="B27">
      <element-citation publication-type="journal">
        <collab>NIH Chemical Genomics Center</collab>
        <source>PubChem Fingerprint for JChem.</source>
        <year>2009</year>
        <comment>Available at <ext-link ext-link-type="uri" xlink:href="http://ncgc.nih.gov/resources/software.html">http://ncgc.nih.gov/resources/software.html</ext-link> (last accessed date March 1, 2010)</comment>
      </element-citation>
    </ref>
    <ref id="B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oprea</surname>
            <given-names>TI</given-names>
          </name>
        </person-group>
        <article-title>Chemical space navigation in lead discovery</article-title>
        <source>Curr. Opin. Chem. Biol.</source>
        <year>2002</year>
        <volume>6</volume>
        <fpage>384</fpage>
        <lpage>389</lpage>
        <pub-id pub-id-type="pmid">12023120</pub-id>
      </element-citation>
    </ref>
    <ref id="B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oprea</surname>
            <given-names>TI</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systems chemical biology</article-title>
        <source>Nat. Chem. Biol.</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>447</fpage>
        <lpage>450</lpage>
        <pub-id pub-id-type="pmid">17637771</pub-id>
      </element-citation>
    </ref>
    <ref id="B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raymond</surname>
            <given-names>JW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of chemical clustering methods using graph- and fingerprint-based similarity measures</article-title>
        <source>J. Mol. Graph Model.</source>
        <year>2003</year>
        <volume>21</volume>
        <fpage>421</fpage>
        <lpage>433</lpage>
        <pub-id pub-id-type="pmid">12543138</pub-id>
      </element-citation>
    </ref>
    <ref id="B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roweis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Saul</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Nonlinear dimensionality reduction by locally linear embedding</article-title>
        <source>Science</source>
        <year>2000</year>
        <volume>290</volume>
        <fpage>2323</fpage>
        <pub-id pub-id-type="pmid">11125150</pub-id>
      </element-citation>
    </ref>
    <ref id="B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Savchuk</surname>
            <given-names>NP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exploring the chemogenomic knowledge space with annotated chemical libraries</article-title>
        <source>Curr. Opin. Chem. Biol.</source>
        <year>2004</year>
        <volume>8</volume>
        <fpage>412</fpage>
        <lpage>417</lpage>
        <pub-id pub-id-type="pmid">15288252</pub-id>
      </element-citation>
    </ref>
    <ref id="B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seiler</surname>
            <given-names>KP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChemBank: a small-molecule screening and cheminformatics resource database</article-title>
        <source>Nucleic Acids. Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <issue>Database issue</issue>
        <fpage>351</fpage>
        <lpage>359</lpage>
      </element-citation>
    </ref>
    <ref id="B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sheridan</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Kearsley</surname>
            <given-names>SK</given-names>
          </name>
        </person-group>
        <article-title>Why do we need so many chemical similarity search methods?</article-title>
        <source>Drug Discov. Today</source>
        <year>2002</year>
        <volume>7</volume>
        <fpage>903</fpage>
        <lpage>911</lpage>
        <pub-id pub-id-type="pmid">12546933</pub-id>
      </element-citation>
    </ref>
    <ref id="B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smellie</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Visualization and interpretation of high content screening data</article-title>
        <source>J. Chem. Inf. Model.</source>
        <year>2006</year>
        <volume>46</volume>
        <fpage>201</fpage>
        <lpage>207</lpage>
        <pub-id pub-id-type="pmid">16426056</pub-id>
      </element-citation>
    </ref>
    <ref id="B36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Strausberg</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Schreiber</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>From knowing to controlling: a path from genomics to drugs using small molecule probes</article-title>
        <source>Science</source>
        <year>2003</year>
        <volume>300</volume>
        <fpage>294</fpage>
        <lpage>295</lpage>
        <pub-id pub-id-type="pmid">12690189</pub-id>
      </element-citation>
    </ref>
    <ref id="B37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Swamidass</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Baldi</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Bounds and algorithms for fast exact searches of chemical fingerprints in linear and sub-linear time</article-title>
        <source>J. Chem. Inf. Model.</source>
        <year>2007</year>
        <volume>47</volume>
        <fpage>302</fpage>
        <pub-id pub-id-type="pmid">17326616</pub-id>
      </element-citation>
    </ref>
    <ref id="B38">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tenenbaum</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A global geometric framework for nonlinear dimensionality reduction</article-title>
        <source>Science</source>
        <year>2000</year>
        <volume>290</volume>
        <fpage>2319</fpage>
        <pub-id pub-id-type="pmid">11125149</pub-id>
      </element-citation>
    </ref>
    <ref id="B39">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaidya</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>An O (<italic>n</italic> log <italic>n</italic>) algorithm for the all-nearest-neighbors problem</article-title>
        <source>Discrete Comput. Geom.</source>
        <year>1989</year>
        <volume>4</volume>
        <fpage>101</fpage>
        <lpage>115</lpage>
      </element-citation>
    </ref>
    <ref id="B40">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A quantitative analysis and performance study for similarity-search methods in high-dimensional spaces</article-title>
        <source>Proceedings of the International Conference on Very Large Data Bases.</source>
        <year>1998</year>
        <publisher-name>IEEE</publisher-name>
        <fpage>194</fpage>
        <lpage>205</lpage>
      </element-citation>
    </ref>
    <ref id="B41">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Willett</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Similarity and Clustering in Chemical Information Systems.</source>
        <year>1987</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>John Wiley &amp; Sons, Inc.</publisher-name>
      </element-citation>
    </ref>
    <ref id="B42">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willett</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Searching techniques for databases of two- and three-dimensional chemical structures</article-title>
        <source>J. Med. Chem.</source>
        <year>2005</year>
        <volume>48</volume>
        <fpage>4183</fpage>
        <lpage>4199</lpage>
        <pub-id pub-id-type="pmid">15974568</pub-id>
      </element-citation>
    </ref>
    <ref id="B43">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willett</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Chemical similarity searching</article-title>
        <source>J. Chem. Inf. Comput. Sci.</source>
        <year>1998</year>
        <volume>38</volume>
        <fpage>983</fpage>
        <lpage>996</lpage>
      </element-citation>
    </ref>
    <ref id="B44">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Agrafiotis</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Nearest neighbor search in general metric spaces using a tree data structure with a simple heuristic</article-title>
        <source>J. Chem. Inf. Comput. Sci.</source>
        <year>2003</year>
        <volume>43</volume>
        <fpage>1933</fpage>
        <lpage>1941</lpage>
        <pub-id pub-id-type="pmid">14632443</pub-id>
      </element-citation>
    </ref>
    <ref id="B45">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>L-BFGS-B: Fortran subroutines for large-scale bound constrained optimization</article-title>
        <source>ACM Trans. Math. Softw.</source>
        <year>1997</year>
        <volume>23</volume>
        <fpage>550</fpage>
        <lpage>560</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
