<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5729461</article-id>
    <article-id pub-id-type="publisher-id">1985</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-017-1985-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>pyAmpli: an amplicon-based variant filter pipeline for targeted resequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3304-0706</contrib-id>
        <name>
          <surname>Beyens</surname>
          <given-names>Matthias</given-names>
        </name>
        <address>
          <email>matthias.beyens@uantwerpen.be</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boeckx</surname>
          <given-names>Nele</given-names>
        </name>
        <address>
          <email>nele.boeckx@uantwerpen.be</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Van Camp</surname>
          <given-names>Guy</given-names>
        </name>
        <address>
          <email>guy.vancamp@uantwerpen.be</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Op de Beeck</surname>
          <given-names>Ken</given-names>
        </name>
        <address>
          <email>ken.opdebeeck@uantwerpen.be</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vandeweyer</surname>
          <given-names>Geert</given-names>
        </name>
        <address>
          <email>geert.vandeweyer@uantwerpen.be</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0790 3681</institution-id><institution-id institution-id-type="GRID">grid.5284.b</institution-id><institution>Center of Medical Genetics, </institution><institution>University of Antwerp, </institution></institution-wrap>Prins Boudewijnlaan 43, 2650 Antwerp, Belgium </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0790 3681</institution-id><institution-id institution-id-type="GRID">grid.5284.b</institution-id><institution>Center of Oncological Research, </institution><institution>University of Antwerp, </institution></institution-wrap>Universiteitsplein 1, 2610 Antwerp, Belgium </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>12</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>12</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>554</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>9</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>12</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Haloplex targeted resequencing is a popular method to analyze both germline and somatic variants in gene panels. However, involved wet-lab procedures may introduce false positives that need to be considered in subsequent data-analysis. No variant filtering rationale addressing amplicon enrichment related systematic errors, in the form of an all-in-one package, exists to our knowledge.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present pyAmpli, a platform independent parallelized Python package that implements an amplicon-based germline and somatic variant filtering strategy for Haloplex data. pyAmpli can filter variants for systematic errors by user pre-defined criteria. We show that pyAmpli significantly increases specificity, without reducing sensitivity, essential for reporting true positive clinical relevant mutations in gene panel data.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">pyAmpli is an easy-to-use software tool which increases the true positive variant call rate in targeted resequencing data. It specifically reduces errors related to PCR-based enrichment of targeted regions.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-017-1985-1) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Targeted resequencing</kwd>
      <kwd>Variant filtering</kwd>
      <kwd>Somatic</kwd>
      <kwd>Germline</kwd>
      <kwd>Next-generation sequencing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003130</institution-id>
            <institution>Fonds Wetenschappelijk Onderzoek</institution>
          </institution-wrap>
        </funding-source>
        <award-id>12D1717N</award-id>
        <principal-award-recipient>
          <name>
            <surname>Vandeweyer</surname>
            <given-names>Geert</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par9">Low-cost targeted resequencing using specific gene panels in large sample cohorts is widely used in diagnostic settings and forms the current gold standard for multiple reasons. For instance, in hearing loss, screening of specific genes can be more efficient than whole exome, or whole genome sequencing due to reduced sequencing and analysis costs [<xref ref-type="bibr" rid="CR1">1</xref>]. Second, data interpretation outside known disease genes is difficult and has limited added value in clinical settings. Finally, it is a cost-effective technique for ultra-deep sequencing which enables detection of low-allelic variants, for instance needed to pinpoint subclonal IgHV rearrangements in chronic lymphocytic leukemia [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p id="Par10">Target enrichment methods can be divided into amplicon or multiplex PCR-based approaches, showing vertical enrichment blocks of identical fragments, and hybridization capture-based techniques, showing more bell-shaped enrichment of random fragments (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) [<xref ref-type="bibr" rid="CR3">3</xref>]. Here, we focused specifically on the analysis of the Haloplex Target Enrichment System, which can enrich up to thousands of exons. The Haloplex technology was originally developed by Olink Bioscience (prof. Olle Ericsson, Uppsala, Sweden) from where it has been commercialized by the spin-off company Halo Genomics. To date, the technology is further developed and supplied by Agilent Technologies (Santa Clara, USA). Although the technique is hybridization based, it results in amplicon-like data due to non-random restriction enzyme fragmentation and subsequent PCR amplification. The ligation-dependent selection for circular fragments increases target specificity towards fragments where the start and end positions correspond to restriction sites. However, a significant fraction of aspecific amplicons, not corresponding to predicted restriction fragments, is often present in the library, and can induce spurious variants. These variants can be visually recognised by not being present in genuine amplicons (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). Second, coverage is not uniform across the captured fragments, possibly resulting in false-negative heterozygous variants when both alleles are not sufficiently captured. Finally, PCR duplicates cannot be removed without the usage of molecular barcode tags, as these are inherent to the technology. Here, one could hypothesize that true variants should be present in multiple overlapping amplicons, as these correspond to independent captures by definition [<xref ref-type="bibr" rid="CR4">4</xref>]. Introduction of incorrect nucleotides during PCR is therefore indistinguishable from true subclonal variants with low-allelic frequency.<fig id="Fig1"><label>Fig. 1</label><caption><p>Sashimi target enrichment plots. <italic>mTOR</italic> Exon 54 coverage for two different target enrichment methods is represented by a Sashimi plot: 1) hybridization capture-based technique, showing more bell-shaped enrichment of random fragments (red histogram) and 2) amplicon- or multiplex PCR-based approach, showing vertical enrichment blocks of identical fragments (blue histogram)</p></caption><graphic xlink:href="12859_2017_1985_Fig1_HTML" id="MO1"/></fig>
<fig id="Fig2"><label>Fig. 2</label><caption><p>Vertical read blocks and variant calling bias visualization. Typical vertically enriched read blocks are illustrated in (2<bold>a</bold> and 2<bold>b</bold>). Aspecific fragments, not corresponding to predicted amplicons are shown in (2<bold>a)</bold> and variants restricted to read ends are shown in (2<bold>b</bold>). Called variants are indicated by a red dashed rectangular. Reads are given in blue and pink colored horizontal bars, indicating read orientation. Theoretical manufacturer designed Haloplex probes are presented in green colored horizontal bars below their corresponding enriched reads</p></caption><graphic xlink:href="12859_2017_1985_Fig2_HTML" id="MO2"/></fig>
</p>
    <p id="Par11">To the best of our knowledge, no variant filtering rationale, in the format of an all-in-one package, exists that takes these targeted resequencing specific biases into account to differentiate false-positive from true-positive variants. Here, we present pyAmpli, a platform independent parallelized Python package that leverages amplicon specific information during variant filtering. Although user applied variant calling algorithms (e.g. VarScan2 and GATK Unified Genotyper) return various variant quality and reliability scores, these parameters are limited in amplicon- or PCR-based enrichment methods as they do not include amplicon information. Further, they are only suitable for hard filtering of variants. As such, variant hard filtering is exclusively based on the information available in the variant calling file generated by the chosen variant caller algorithm. pyAmpli uses solely the variant calling file for extraction of the variant’s position and further uses the sample’s alignment file to extract amplicon information.</p>
    <p id="Par12">pyAmpli can be applied in an oncological setting, after somatic tumor-normal variant calling as well in germline disease-gene screening projects. Our variant filtering algorithm ensures an enrichment of true-positive variants via a seven-step multi-staged categorization pipeline (Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par13">The pyAmpli package is developed using Python 2.7 [<xref ref-type="bibr" rid="CR5">5</xref>]. The package is freely available for downstream variant analysis across various computing platforms. pyAmpli requires the following dependencies: <italic>pysam</italic> [<xref ref-type="bibr" rid="CR6">6</xref>] is required for reading alignment files, <italic>PyVCF</italic> [<xref ref-type="bibr" rid="CR7">7</xref>] for reading, formatting and generating variant files and <italic>pyYAML</italic> [<xref ref-type="bibr" rid="CR8">8</xref>] for reading the user configuration file.</p>
    <sec id="Sec3">
      <title>Input</title>
      <p id="Par14">The package provides both somatic and germline variant filtering. The default somatic mode of pyAmpli requires an amplicon-design file provided by the manufacturer, a paired tumor-normal variant calling file (VCF) and a normal and tumor alignment file (BAM) as input. The amplicon-design file is a BED file containing genomic location and probe identifier names for each included restriction fragment. Germline variants filtering requires an amplicon-design file, a single sample VCF and alignment file. Default and optimized settings for both somatic and germline parameters are included in the software as YAML configuration files. Command-line usage of pyAmpli in somatic mode is illustrated by Listing 1.</p>
      <p id="Par15">
pyAmpli
<bold>.</bold>
py somatic
<list list-type="bullet"><list-item><p id="Par16">
bn
<italic>normal_sample_chr1.bam.</italic>
</p></list-item><list-item><p id="Par17">
bt
<italic>tumor_sample_chr1.bam.</italic>
</p></list-item><list-item><p id="Par18">
v
<italic>somatic_variants_chr1.vcf.</italic>
</p></list-item><list-item><p id="Par19">
d
<italic>amplicon_design_chr1.bed.</italic>
</p></list-item><list-item><p id="Par20">
od
<italic>output_directory</italic>
</p></list-item></list>
</p>
      <p id="Par21">Listing 1</p>
    </sec>
    <sec id="Sec4">
      <title>Variant processing</title>
      <p id="Par22">The variant processing workflow of pyAmpli can be summarized as follows. If supplied, a configuration file with user-defined thresholds is read-in, otherwise default settings are used. Next, the amplicon-design file provided by the manufacturer is processed into an easy accessible dictionary. Subsequently, every input variant present in the VCF is subjected to variant filtering analysis. The main variant analysis starts by assigning aligned read pairs overlapping the variant position to amplicons specified in the design file, discarding aspecific amplicons. Second, the ratio of variant-containing amplicons over all predicted amplicons covering the target position is calculated. Based on this ratio, variants are then categorized in 7 categories, as discussed below: <italic>DepthFail</italic>, <italic>OneAmpPass</italic>, <italic>LowAmpFail</italic>, <italic>MatchAmpPass</italic>, <italic>PositionFail</italic>, <italic>NormalFail</italic> and <italic>AmpPass</italic>. pyAmpli adds the final variant category to the <italic>FILTER</italic> field of the output VCF file (v4.1-formatted). Additional metrics, including the amplicon ratio and several amplicon counts are added to the <italic>INFO</italic> field to allow users to easily perform further downstream selection of variant categories (Table <xref rid="Tab1" ref-type="table">1</xref>). A detailed decision diagram of pyAmpli’s filter logic is given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Additional VCF information fields. After running pyAmpli a new VCF is generated with additional <italic>INFO</italic> fields. These fields provide the user information on amplicon fractions, counts and offsets of reference and alternative alleles</p></caption><table frame="hsides" rules="groups"><thead><tr><th>INFO ID</th><th>Description</th></tr></thead><tbody><tr><td>AmpFR</td><td>Amplicon fraction for reference allele</td></tr><tr><td>AmpFA</td><td>Amplicon fraction for alternative allele</td></tr><tr><td>AmpCR</td><td>Amplicon count for reference allele</td></tr><tr><td>AmpCA</td><td>Amplicon count for alternative allele</td></tr><tr><td>AmpC</td><td>Amplicon total count</td></tr><tr><td>AmpF_OA</td><td>Amplicon count offset compared to allelic depth, for alternative allele</td></tr><tr><td>AmpF_OR</td><td>Amplicon count offset compared to allelic depth, for reference allele</td></tr></tbody></table></table-wrap>
</p>
    </sec>
    <sec id="Sec5">
      <title>Variant categories</title>
      <p id="Par23">Variants are evaluated for each of the following criteria, in the order given here, and assigned to the first matching category (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). When all criteria are passed, a variant is classified as high quality, corresponding to the label <italic>AmpPass.</italic>
</p>
      <sec id="Sec6">
        <title>DepthFail: variants with low read evidence</title>
        <p id="Par24">In a first step, variants with insufficient coverage by genuine read-pairs are flagged as low read evidence variants, and not subjected to further variant filtering. <italic>FILTER</italic> field flags <italic>DepthFail</italic> and <italic>DepthFailTumor/Normal</italic> are set, respectively in germline and somatic modes. Users have the flexibility to define their own <italic>DepthFail</italic> cut-off by adjusting the <italic>min_depth_normal</italic> and/or <italic>min_depth_tumor</italic> values in the configuration file.</p>
      </sec>
      <sec id="Sec7">
        <title>OneAmpPass: variants with panel design limitations</title>
        <p id="Par25">Variants covered by and present in a single theoretical amplicon, as a design limitation, might be more prone for systemic enrichment artefacts. As we have insufficient information to evaluate the reliability of these variants, they are flagged as <italic>OneAmpPass,</italic> and not subjected to further filtering.</p>
      </sec>
      <sec id="Sec8">
        <title>LowAmpFail: variants with low amount of covered amplicons</title>
        <p id="Par26">When variants are covered by multiple theoretical amplicons, we can infer variant reliability based on the number of amplicons containing the variant. Variants covered by more than two overlapping theoretical amplicons are flagged as <italic>LowAmpFail</italic> if the alternative allele is present in reads corresponding to less than three of these amplicons.</p>
        <p id="Par27">Variants covered by just two theoretical amplicons are handled separately. These variants are flagged as <italic>LowAmpFail</italic> if the alternative allele is present in reads corresponding to only one of both amplicons.</p>
      </sec>
      <sec id="Sec9">
        <title>MatchAmpPass: variants with low amount of covered amplicons</title>
        <p id="Par28">Variants covered by just two theoretical amplicons are handled separately as <italic>MatchAmpPass</italic> if the alternative allele is present in reads from both amplicons, to indicate the limited discriminative power.</p>
      </sec>
      <sec id="Sec10">
        <title>PositionFail: positional biases</title>
        <p id="Par29">Variants only present in the first two positions of either 3′ or 5′ read ends are flagged as <italic>PositionFail</italic>. This enrichment artefact is typically seen in Haloplex gene panels, because fragments are reproducibly generated by restriction enzymes, which cut only recognized sequences and generate non-random fragments [<xref ref-type="bibr" rid="CR9">9</xref>]. Users can adjust the <italic>min_read_pos</italic> (default 2) and <italic>min_read_pos_fraction</italic> (default 10) in the configuration file, i.e. variants will be flagged as <italic>PositionFail</italic> if more than 10% of the total reads contain the alternative allele in the first two positions of either 3′ or 5′ read ends.</p>
      </sec>
      <sec id="Sec11">
        <title>NormalFail: low-fraction variants in normal samples</title>
        <p id="Par30">This filter is only applied in somatic mode and is more subjective to user settings. When considering paired tumor-normal samples, somatic variants are not expected to be present in the patient’s paired normal tissue sample. First, this can be indicative for a false-positive somatic variant in the tumor tissue sample, that is in fact a true-positive low-fraction germline variant in the normal sample. Secondly, it might be a systemic enrichment artefact that is more pronounced in the tumor sample and therefore called as somatic. Lastly, it could be a reliable somatic variant. This may be explained by field cancerization, which is the occurrence of genetic, epigenetic and biochemical aberrations in structurally intact cells in histologically normal tissue adjacent to cancerous lesions [<xref ref-type="bibr" rid="CR10">10</xref>]. By default, somatic variants present in more than 1% of reads from the normal sample are flagged as <italic>NormalFail</italic>. To allow the effect of field cancerization, the user can adjust the threshold (<italic>min_frac</italic>) for flagging these variants in the configuration file.</p>
      </sec>
      <sec id="Sec12">
        <title>AmpPass: threshold-passing variants</title>
        <p id="Par31">As mentioned above, variants passing all user-defined filters are flagged as high-quality variants, using the <italic>AmpPass</italic> label.</p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>Performance evaluation</title>
      <p id="Par32">We benchmarked pyAmpli on VCF and BAM files generated on in-house data. We calculated and validated the true and false positive rates. Next, we estimated runtime for batch processing.</p>
    </sec>
    <sec id="Sec14">
      <title>Pre-pyAmpli bioinformatic processing of benchmark samples</title>
      <p id="Par33">Haloplex libraries were generated following the manufacturers guidelines (Protocol F1, July 2015, Agilent, CA, USA) and sequenced on an Illumina HiSeq1500 platform. Reads were trimmed for adapter sequence with Trimmomatic <italic>v0.36</italic>, and aligned with BWA <italic>v0.7.4</italic> to version hg19 of the human genome. Germline variants were called using GATK Unified Genotyper <italic>v3.3.0</italic> on 21 normal colon tissue samples. Somatic/loss-of-heterozygosity (LOH) variants were called using VarScan2 <italic>v2.3.9</italic> on 115 colon tumor-normal tissue pairs. Tumor sample is defined as either primary colon tumor or metastatic tissue.</p>
    </sec>
    <sec id="Sec15">
      <title>Benchmarking</title>
      <p id="Par34">True and false positive rates were estimated as follows. Variants present in ExAc <italic>r1.0</italic>, COSMIC <italic>v81</italic> or dbSNP <italic>v142</italic> databases were assumed true positive, and false positive otherwise. Next, variants were categorized according to variant type (germline, somatic and LOH) and filtering status (i.e. passing pyAmpli filtering or failing). To validate pyAmpli variant classification, 37 somatic variants were selected and validated by Sanger sequencing on a 3130xl Genetic Analyzer platform (Applied Biosystems Inc.).</p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Results and discussion</title>
    <p id="Par35">Current variant calling algorithms return variant quality and reliability scores in their VCFs. The calculated scores do not provide any amplicon information for reliable variant filtering. Further, necessity for amplicon-based filtering was made clear in a Sanger sequencing validation experiment by Samorodnitsky and colleagues. They showed that alternative alleles covered by less amplicons than present in their design are prone to be false positive findings [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p id="Par36">There are analysis pipelines optimized for amplicon sequencing data, such as SureCall (Agilent Technologies, USA) and SeqNext (JSI medical systems, Germany), available. Although, latter software packages are able to call variants, the downstream variant filtering relies on ‘hard’ filters and information regarding the amplicon itself is lacking. Further, researchers still need to visually inspect all the data and judge the validity, and eventually manually flag the variants, which is a time-consuming step. Another disadvantage of these tools is that they are incompatible for paired variant calling. Of course, we do not discourage using SureCall or SeqNext variant analysis pipeline. The software output can serve as input for pyAmpli. To the best of our knowledge, no downstream post-processing tools as pyAmpli exists. pyAmpli will add useful variant and amplicon parameters that will guide the end-user for a legit variant interpretation and a hopefully desired decrease in analysis time per patient.</p>
    <p id="Par37">We present a new convenient variant filtering tool pyAmpli targeted at the reduction of systematic biases present in resequencing data generated using amplicon-based enrichment protocols. These protocols give rise to recurrent artefacts, as illustrated for Haloplex enrichment in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. First, aspecifically enriched amplicons can introduce false positive variant calls. In case of Haloplex, these can be identified by the absence of corresponding restriction sites in the design file. Consequently, variants present only in aspecific amplicons and absent from genuine amplicons, can be labelled as false positives (<italic>LowAmpFail</italic> category, Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). Second, Fig. <xref rid="Fig2" ref-type="fig">2b</xref> shows variants restricted to read ends, likely corresponding to systemic enrichment artefacts (<italic>PositionFail</italic> category). Whereas these artefacts are relevant for both germline and somatic variant evaluation purposes, an additional filter is present to specifically evaluate somatic variants.</p>
    <sec id="Sec17">
      <title>pyAmpli true and false positive rate</title>
      <p id="Par38">In general, applying the pyAmpli germline filter on GATK Unified Genotyper calls of 21 normal tissue samples, increases the true positive rate from 39% (15,673 variants) to 64% (11,368) (Table <xref rid="Tab2" ref-type="table">2</xref>). VarScan2 is proven to be a sensitive caller, however the tumor-normal variant calls lack high specificity. Applying pyAmpli somatic filtering settings on somatic and LOH variants of 115 tumor-normal tissue pairs increases the true positive rate from 29% (4028) and 45% (934) to 37% (885) and 81% (208), respectively (Table <xref rid="Tab2" ref-type="table">2</xref>). After validation by Sanger sequencing of 37 variants, 21, 12, 4 and 0 variants were categorized as true positive, true negative, false positive and false negative, respectively (Additional file <xref rid="MOESM2" ref-type="media">2</xref>).<table-wrap id="Tab2"><label>Table 2</label><caption><p>pyAmpli true and false positive rates.False and true positive rates in percentages before (−) and after (+) pyAmpli germline, somatic and LOH variant filtering with corresponding total variant number for ratio calculation. Germline variants were called with the GATK Unified Genotyper. Somatic and LOH variants were called with VarScan2</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Variant</th><th>Filter</th><th>True positive rate (%)</th><th>False positive rate (%)</th><th>Number of variants</th></tr></thead><tbody><tr><td>Germline</td><td>–</td><td>39</td><td>61</td><td>15,673</td></tr><tr><td/><td>+</td><td>64</td><td>36</td><td>11,368</td></tr><tr><td>Somatic</td><td>–</td><td>29</td><td>71</td><td>4028</td></tr><tr><td/><td>+</td><td>37</td><td>63</td><td>885</td></tr><tr><td>LOH</td><td>–</td><td>45</td><td>55</td><td>934</td></tr><tr><td/><td>+</td><td>81</td><td>19</td><td>208</td></tr></tbody></table></table-wrap>
</p>
      <p id="Par39">pyAmpli allows the user to select for true positive variants in gene panel data. Further, user-defined settings, based on their in-house validation cohorts, can be implemented in the variant filtering by adjusting the YAML configuration file.</p>
    </sec>
    <sec id="Sec18">
      <title>Performance</title>
      <p id="Par40">We obtained the time required for variant filtering using a set of 115 colon tumor-normal pairs with an average of 289 variants per sample. Using the available parallel variant filtering functionality with 16 processing threads, we obtained an average CPU runtime per variant of 16.03 ms (16-core AMD Opteron™ 6378, 64-bit Linux 4.4.0–22-generic) (Additional file <xref rid="MOESM3" ref-type="media">3</xref>). Further upscaling has marginal benefits due to I/O limitations.</p>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Conclusions</title>
    <p id="Par41">pyAmpli is a fast and parallel python program tailored to improve moderate true positive rates and reduce high false positive rates observed in PCR-based targeted enrichment strategies, in comparison to hybridisation-based capturing approaches. Although it was validated on Haloplex data, its principles are applicable to all PCR-based methods, such as Molecular Inversion Probes (MIPs) or multiplex PCR. Usage requires minimal input and limited programming skills from the user and only commodity computational resources. Output is generated in VCF v4.1 format and can be easily post-processed by the user.</p>
  </sec>
  <sec id="Sec20">
    <title>Availability and requirements</title>
    <p id="Par42"><bold>Project name</bold>: pyAmpli<bold>.</bold></p>
    <p id="Par43"><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="https://mbeyens.github.io/pyAmpli">https://mbeyens.github.io/pyAmpli</ext-link>. The repository provides the package, quick-start examples and command-line examples for easy testing and performing essential processing.</p>
    <p id="Par44"><bold>Operating system(s)</bold>: any supporting Python 2.7 (tested on Ubuntu 14.04.4 LTS)<bold>.</bold></p>
    <p id="Par45"><bold>Programming language</bold>: Python 2.7<bold>.</bold></p>
    <p id="Par46"><bold>Other requirements</bold>: pysam &gt; =0.8.4, PyVCF &gt; =0.6.8, pyYAML &gt; =3.11, setuptools &gt; =20.2.2, samtools &gt; =0.1.18, pigz &gt; =2.3.4<bold>.</bold></p>
    <p id="Par47"><bold>License</bold>: The GPL-v3 license (<ext-link ext-link-type="uri" xlink:href="https://opensource.org/licenses/GPL-3.0">https://opensource.org/licenses/GPL-3.0</ext-link>).</p>
    <p id="Par48"><bold>Any restrictions to use by non-academics</bold>: None</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec21">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2017_1985_MOESM1_ESM.docx">
            <label>Additional file 1:</label>
            <caption>
              <p>pyAmpli variant filter decision diagram. (DOCX 209 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2017_1985_MOESM2_ESM.docx">
            <label>Additional file 2:</label>
            <caption>
              <p>Sanger sequencing variant validation. (DOCX 71 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2017_1985_MOESM3_ESM.docx">
            <label>Additional file 3:</label>
            <caption>
              <p>pyAmpli CPU runtime. (DOCX 132 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BAM</term>
        <def>
          <p id="Par4">Binary alignment file</p>
        </def>
      </def-item>
      <def-item>
        <term>LOH</term>
        <def>
          <p id="Par5">Loss-of-heterozygosity</p>
        </def>
      </def-item>
      <def-item>
        <term>MIPs</term>
        <def>
          <p id="Par6">Molecular inversion probes</p>
        </def>
      </def-item>
      <def-item>
        <term>PCR</term>
        <def>
          <p id="Par7">Polymerase chain reaction</p>
        </def>
      </def-item>
      <def-item>
        <term>VCF</term>
        <def>
          <p id="Par8">Variant calling file</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (10.1186/s12859-017-1985-1) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par49">This work was supported by the Research Foundation Flanders (FWO, grant no. 12D1717N). The funding body did not influence in any way the study design and collection, analysis and interpretation of data. Nor did it participate in writing of the manuscript.</p>
    </sec>
    <sec id="FPar2">
      <title>Availability of data and materials</title>
      <p id="Par50">The pyAmpli package is available under the GPL-v3 license from <ext-link ext-link-type="uri" xlink:href="https://mbeyens.github.io/pyAmpli">https://mbeyens.github.io/pyAmpli</ext-link>. The repository provides also quick-start examples and command-line scripts for easy testing and performing essential processing.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>The pyAmpli package was designed by MB and GV, implemented by MB, NB and GV and documented by MB and GV. The manuscript was written by MB, GV, KOdB and GVC. All authors revised and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par51">Not applicable.</p>
    </sec>
    <sec id="FPar4">
      <title>Consent for publication</title>
      <p id="Par52">Not applicable.</p>
    </sec>
    <sec id="FPar5">
      <title>Competing interests</title>
      <p id="Par53">The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar6">
      <title>Publisher’s Note</title>
      <p id="Par54">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sommen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schrauwen</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Vandeweyer</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Boeckx</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Corneveaux</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>van den Ende</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Boudewyns</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>De Leenheer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Janssens</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Claes</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Verstreken</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Strenzke</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Predöhl</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wuyts</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Mortier</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bitner-Glindzicz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moser</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Coucke</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Huentelman</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Van Camp</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>DNA diagnostics of hereditary hearing loss: a targeted resequencing approach combined with a mutation classification system</article-title>
        <source>Hum Mutat</source>
        <year>2016</year>
        <volume>37</volume>
        <fpage>812</fpage>
        <lpage>819</lpage>
        <pub-id pub-id-type="doi">10.1002/humu.22999</pub-id>
        <?supplied-pmid 27068579?>
        <pub-id pub-id-type="pmid">27068579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatopoulos</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Timbs</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bruce</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Clifford</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Robbe</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Burns</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vavoulis</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Antoniou</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dreau</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Schuh</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Targeted deep sequencing reveals relevant subclonal IgHV rearrangements in chronic lymphocytic leukemia</article-title>
        <source>Leukemia</source>
        <year>2017</year>
        <volume>31</volume>
        <fpage>837</fpage>
        <lpage>845</lpage>
        <pub-id pub-id-type="doi">10.1038/leu.2016.307</pub-id>
        <?supplied-pmid 27795555?>
        <pub-id pub-id-type="pmid">27795555</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Samorodnitsky</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Datta</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jewell</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Hagopian</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Miya</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wing</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Damodaran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lippus</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Reeser</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Bhatt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Timmers</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Roychowdhury</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Comparison of custom capture for targeted next-generation DNA sequencing</article-title>
        <source>J Mol Diagn</source>
        <year>2015</year>
        <volume>17</volume>
        <fpage>64</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jmoldx.2014.09.009</pub-id>
        <?supplied-pmid 25528188?>
        <pub-id pub-id-type="pmid">25528188</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leanne de Kock</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Revil</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Badescu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rivera</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sabbaghian</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sandoval</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hopman</surname>
            <given-names>SMJ</given-names>
          </name>
          <name>
            <surname>Merks</surname>
            <given-names>JHM</given-names>
          </name>
          <name>
            <surname>van Hagen</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Bouts</surname>
            <given-names>AHM</given-names>
          </name>
          <name>
            <surname>Plager</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Ramasubramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Forsmark</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Doyle</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Toler</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Callahan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Engelenberg</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Soglio</surname>
            <given-names>DB-D</given-names>
          </name>
          <name>
            <surname>Priest</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Ragoussis</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Foulkes</surname>
            <given-names>WD</given-names>
          </name>
        </person-group>
        <article-title>High-sensitiviy sequencing reveals multi-organ somatic mosaicism causing DICER1 syndrome</article-title>
        <source>J Med Genet</source>
        <year>2016</year>
        <volume>53</volume>
        <fpage>43</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1136/jmedgenet-2015-103428</pub-id>
        <?supplied-pmid 26475046?>
        <pub-id pub-id-type="pmid">26475046</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Rossum</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>de Boer</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Interactively testing remote servers using the python programming language</article-title>
        <source>CWI Q</source>
        <year>1991</year>
        <volume>4</volume>
        <fpage>283</fpage>
        <lpage>303</lpage>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">James C. PyVCF. <ext-link ext-link-type="uri" xlink:href="https://pyvcf.readthedocs.io">https://pyvcf.readthedocs.io</ext-link> (2012). Accessed 28 Jul 2017.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Kirill S. PyYAML. <ext-link ext-link-type="uri" xlink:href="http://pyyaml.org">http://pyyaml.org</ext-link> (2006). Accessed 28 Jul 2017.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Samorodnitsky</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Jewell</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Hagopian</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Miya</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wing</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Lyon</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Damodaran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bhatt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reeser</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Datta</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roychowdhury</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of hybridization capture versus amplicon-based methods for whole-exome sequencing</article-title>
        <source>Hum Mutat</source>
        <year>2015</year>
        <volume>36</volume>
        <fpage>903</fpage>
        <lpage>914</lpage>
        <pub-id pub-id-type="doi">10.1002/humu.22825</pub-id>
        <?supplied-pmid 26110913?>
        <pub-id pub-id-type="pmid">26110913</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Slaughter</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Southwick</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>Smejkal</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Field cancerization in oral stratified squamous epithelium: clinical implications of multicentric origin</article-title>
        <source>Cancer</source>
        <year>1953</year>
        <volume>6</volume>
        <fpage>963</fpage>
        <lpage>968</lpage>
        <pub-id pub-id-type="doi">10.1002/1097-0142(195309)6:5&lt;963::AID-CNCR2820060515&gt;3.0.CO;2-Q</pub-id>
        <?supplied-pmid 13094644?>
        <pub-id pub-id-type="pmid">13094644</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
