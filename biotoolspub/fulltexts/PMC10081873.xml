<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10081873</article-id>
    <article-id pub-id-type="pmid">36961339</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad154</article-id>
    <article-id pub-id-type="publisher-id">btad154</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HiCube: interactive visualization of multiscale and multimodal Hi-C and 3D genome data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ye</surname>
          <given-names>Tiantian</given-names>
        </name>
        <aff><institution>Department of Statistics, University of California Riverside</institution>, Riverside, CA 92521, <country country="US">United States</country></aff>
        <xref rid="btad154-cor1" ref-type="corresp"/>
        <!--tye002@ucr.edu-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hu</surname>
          <given-names>Yangyang</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering, University of California Riverside</institution>, Riverside, CA 92521, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pun</surname>
          <given-names>Sydney</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering, University of California Riverside</institution>, Riverside, CA 92521, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4097-1621</contrib-id>
        <name>
          <surname>Ma</surname>
          <given-names>Wenxiu</given-names>
        </name>
        <aff><institution>Department of Statistics, University of California Riverside</institution>, Riverside, CA 92521, <country country="US">United States</country></aff>
        <xref rid="btad154-cor1" ref-type="corresp"/>
        <!--wenxiu.ma@ucr.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Alkan</surname>
          <given-names>Can</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad154-cor1">Corresponding author. Department of Statistics, University of California Riverside, 900 University Ave, Riverside, CA 92521, United States. E-mail: <email>tye002@ucr.edu</email> (T.Y.), <email>wenxiu.ma@ucr.edu</email> (W.M.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-03-24">
      <day>24</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>4</issue>
    <elocation-id>btad154</elocation-id>
    <history>
      <date date-type="received">
        <day>01</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>22</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>18</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>07</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Â© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad154.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>HiCube is a lightweight web application for interactive visualization and exploration of diverse types of genomics data at multiscale resolutions. Especially, HiCube displays synchronized views of Hi-C contact maps and 3D genome structures with user-friendly annotation and configuration tools, thereby facilitating the study of 3D genome organization and function.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>HiCube is implemented in Javascript and can be installed via NPM. The source code is freely available at GitHub (<ext-link xlink:href="https://github.com/wmalab/HiCube" ext-link-type="uri">https://github.com/wmalab/HiCube</ext-link>).</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35GM133678</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>DBI-1751317</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Recent advances in high-throughput sequencing technologies have led to a vast accumulation of diverse types of genomics data. Among them, the Hi-C technique (<xref rid="btad154-B4" ref-type="bibr">Lieberman-Aiden et al. 2009</xref>) and its variants have provided unprecedented opportunities for studying the 3D genome organization and function. Integrative analyses of Hi-C and other genomics data have yielded better understanding of both the structural and functional roles of the chromatin (<xref rid="btad154-B7" ref-type="bibr">Zhang et al. 2022</xref>). Therefore, there exists a high demand to fast and interactively visualize and explore multimodal Hi-C and 3D genome data.</p>
    <p>Recently, several visualization tools for Hi-C and 3D genome data have been developed (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). However, most of the existing tools focus on the visualization of 2D Hi-C contact maps together with 1D genomics, transcriptomics, and epigenomics tracks, while few pay attention to 3D genome structures. Currently, WashU Epigenome Browser (<xref rid="btad154-B3" ref-type="bibr">Li et al. 2022</xref>), Nucleome Browser (<xref rid="btad154-B8" ref-type="bibr">Zhu et al. 2022</xref>), TADkit (<xref rid="btad154-B6" ref-type="bibr">Serra et al. 2017</xref>), and HiC3D-Viewer (<xref rid="btad154-B1" ref-type="bibr">Djekidel et al. 2017</xref>) are the only tools that support simultaneous visualization of 2D Hi-C data and 3D genome structure data. However, WashU Epigenome Browser and TADkit cannot display inter-chromosomal interactions in Hi-C, and TADkit is no longer maintained. HiC3D-Viewer does not support zoom or pan operations to navigate the 2D Hi-C heatmap. In addition, both WashU Epigenome Browser and Nucleome Browser are designed for public datasets and web services, and therefore provide less local usage support and fewer types of user custom annotations.</p>
    <p>Therefore, we developed HiCube, a lightweight web application that allows fast and interactive visualization and exploration of diverse types of genomics data (including 1D gene annotations, RNA-seq, ChIP-seq, ATAC-seq etc., 2D Hi-C contact maps, and 3D genome structures) at multiscale resolutions. We designed a user-friendly graphical user interface (GUI) for users to navigate (e.g. zoom or pan) on either genome-wide or chromosome-wide Hi-C maps, create annotations [such as topologically associating domains (TADs) and chromatin loops], configure display options, and export publication-ready images. HiCube can be installed locally to use private data, and it can load tracks from both remote servers and local storage. A detailed comparison between HiCube and other Hi-C and 3D genome visualization tools is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. In particular, two unique features of HiCube are worth noting: zoom view for multiscale visualization, and paired view instances for comparative visualization.</p>
    <p>HiCube is implemented in Javascript and can be installed via NPM. The source code is publicly available at <ext-link xlink:href="https://github.com/wmalab/HiCube" ext-link-type="uri">https://github.com/wmalab/HiCube</ext-link>.</p>
  </sec>
  <sec>
    <title>2 Components and implementation</title>
    <p>HiCube consists of three key modules: (i) visualization of 1D and 2D data, (ii) visualization of 3D data, and (iii) configuration panels (<xref rid="btad154-F1" ref-type="fig">Fig.Â 1</xref>). The 1D and 2D visualization is implemented using HiGlass (<xref rid="btad154-B2" ref-type="bibr">Kerpedjiev et al. 2018</xref>), a fast visualization library for large-scale genomic data using tiling inspired by maps. The 3D visualization is implemented using Three.js, a Javascript library to display 3D graphics using WebGL. These two visualization components are unified under the React framework, which allows synchronization among 1D, 2D, and 3D view instances. The configure panels contain multiple user-friendly tools for adding data, changing display options, selecting zoom view regions, creating annotations, and exporting publication images.</p>
    <fig position="float" id="btad154-F1">
      <label>Figure 1.</label>
      <caption>
        <p>HiCube user interface. As an example, maternal (left, case #1) and paternal (right, case #2) difference at the local H19-IGF2 region (top, zoom view) and at global scale (bottom, base view) are displayed. The genome position bars on top display/change the current viewing regions for each view instances. The leftmost side is a set of buttons to switch between different control panels: add new case and tracks, edit track configurations, activate tools to select/create zoom view, or add/edit annotations, export configurations and figures, user guide</p>
      </caption>
      <graphic xlink:href="btad154f1" position="float"/>
    </fig>
    <p>HiCube takes three different types of input data: (i) 1D and 2D data in the tileset format, which can be created from cooler, bigWig, BED, BEDPE, BedGraph, etc. using HiGlass (<xref rid="btad154-B2" ref-type="bibr">Kerpedjiev et al. 2018</xref>). Users can either retrieve public datasets from the HiGlass API server, or load private datasets from local server using the HiGlass Docker container; (ii) 3D genome structure data in the g3d format (<xref rid="btad154-B3" ref-type="bibr">Li et al. 2022</xref>) from local storage; (iii) quantitative annotations, in the format of either genomic intervals (similar to BED) or paired-end genomic intervals (similar to BEDPE), with an optional score value to represent the signal intensity for 1D or 2D annotations, respectively. Users can create annotations from mouse selection, or enter/upload a list of intervals. Annotations are shown on all 1D, 2D, and 3D view instances. In particular, for quantitative annotation, users can visualize the signal intensity distribution on the 3D structure. A JSON format configuration file which defines all view instances can be downloaded, and loaded later to restore the view instances. User-selected annotations can also be exported for record keeping.</p>
    <p>Two unique features of HiCube are the zoom view and paired view instances. Genome architecture is hierarchical; chromatins are organized at multiple scales from chromatin loops, to (sub-)TADs, A/B compartments, and chromosomes. To better illustrate the chromatin conformation at different scale levels, a zoom view can be created from mouse selection for 1D, 2D, and 3D view instances to display finer details such as loops and TADs at a higher resolution, while the default base view shows coarser features like A/B compartments at a lower resolution. Besides zoom view, another common demand is to compare genomics data side-by-side between different alleles, cells, or experimental conditions. Paired view instances can be utilized in such applications to facilitate comparative 3D genome analysis. After the view instance of the first condition is initialized, a second condition can be added, where every new track in the second condition is paired with its counterpart in the first condition. Later, any adjustments made on one view instance will be synchronized to the other, including changing base (or zoom) view regions, adding annotations, or configuring the display options such as height, width, color, etc.</p>
    <p><xref rid="btad154-F1" ref-type="fig">FigureÂ 1</xref> illustrates an example of the HiCube user interface comparing the H19-IGF2 region on maternal (left) and paternal (right) chromosomes, where the genomic and 3D locations of the H19/IGF2 Distal Anchor Domain (HIDAD), H19, and IGF2 are labeled to show the differences in proximity between HIDAD and the others between the two parental chromosomes (<xref rid="btad154-B5" ref-type="bibr">Rao et al. 2014</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad154_Supplementary_Data</label>
      <media xlink:href="btad154_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors would like to thank Tao Jiang for valuable discussion and suggestions, Piyush Mundhra for contribution to the initial prototyping, Michael Strobel, Jingong Huang, and Guoyao Hao for software testing and feedback, and the referees for constructive suggestions.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> is available at <italic toggle="yes">Bioinformatics</italic> online.</p>
    <p>Conflict of interest: None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Institute of Health [R35GM133678] and the National Science Foundation [DBI-1751317].</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad154-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Djekidel</surname><given-names>MN</given-names></string-name>, <string-name><surname>Wang</surname><given-names>M</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>MQ</given-names></string-name></person-group><etal>et al</etal><article-title>HiC-3DViewer: a new tool to visualize Hi-C data in 3D space</article-title>. <source>Quant Biol</source><year>2017</year>;<volume>5</volume>:<fpage>183</fpage>â<lpage>90</lpage>.</mixed-citation>
    </ref>
    <ref id="btad154-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kerpedjiev</surname><given-names>P</given-names></string-name>, <string-name><surname>Abdennur</surname><given-names>N</given-names></string-name>, <string-name><surname>Lekschas</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>HiGlass: web-based visual exploration and analysis of genome interaction maps</article-title>. <source>Genome Biol</source><year>2018</year>;<volume>19</volume>:<fpage>1</fpage>â<lpage>12</lpage>.<pub-id pub-id-type="pmid">29301551</pub-id></mixed-citation>
    </ref>
    <ref id="btad154-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>D</given-names></string-name>, <string-name><surname>Purushotham</surname><given-names>D</given-names></string-name>, <string-name><surname>Harrison</surname><given-names>JK</given-names></string-name></person-group><etal>et al</etal><article-title>WashU epigenome browser update 2022</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:W774â81.</mixed-citation>
    </ref>
    <ref id="btad154-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lieberman-Aiden</surname><given-names>E</given-names></string-name>, <string-name><surname>van Berkum</surname><given-names>NL</given-names></string-name>, <string-name><surname>Williams</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>. <source>Science</source><year>2009</year>;<volume>326</volume>:<fpage>289</fpage>â<lpage>93</lpage>.<pub-id pub-id-type="pmid">19815776</pub-id></mixed-citation>
    </ref>
    <ref id="btad154-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rao</surname><given-names>SSP</given-names></string-name>, <string-name><surname>Huntley</surname><given-names>MH</given-names></string-name>, <string-name><surname>Durand</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>. <source>Cell</source><year>2014</year>;<volume>159</volume>:<fpage>1665</fpage>â<lpage>80</lpage>.<pub-id pub-id-type="pmid">25497547</pub-id></mixed-citation>
    </ref>
    <ref id="btad154-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Serra</surname><given-names>F</given-names></string-name>, <string-name><surname>BaÃ¹</surname><given-names>D</given-names></string-name>, <string-name><surname>Goodstadt</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Automatic analysis and 3D-modelling of Hi-C data using TADbit reveals structural features of the fly chromatin colors</article-title>. <source>PLoS Comput Biol</source><year>2017</year>;<volume>13</volume>:<fpage>e1005665</fpage>.<pub-id pub-id-type="pmid">28723903</pub-id></mixed-citation>
    </ref>
    <ref id="btad154-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>R</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>T</given-names></string-name>, <string-name><surname>Ma</surname><given-names>J.</given-names></string-name></person-group><article-title>Multiscale and integrative single-cell Hi-C analysis with Higashi</article-title>. <source>Nat Biotechnol</source><year>2022</year>;<volume>40</volume>:<fpage>254</fpage>â<lpage>61</lpage>.<pub-id pub-id-type="pmid">34635838</pub-id></mixed-citation>
    </ref>
    <ref id="btad154-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Nucleome browser: an integrative and multimodal data navigation platform for 4D nucleome</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>:<fpage>911</fpage>â<lpage>3</lpage>.<pub-id pub-id-type="pmid">35864167</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
