<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8428613</article-id>
    <article-id pub-id-type="pmid">33538766</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab058</article-id>
    <article-id pub-id-type="publisher-id">btab058</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Compartor: a toolbox for the automatic generation of moment equations for dynamic compartment populations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pietzsch</surname>
          <given-names>Tobias</given-names>
        </name>
        <aff><institution>Max Planck Institute of Molecular Cell Biology and Genetics</institution>, 01307 Dresden, <country country="DE">Germany</country></aff>
        <aff><institution>Center for Systems Biology Dresden</institution>, 01307 Dresden, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Duso</surname>
          <given-names>Lorenzo</given-names>
        </name>
        <aff><institution>Max Planck Institute of Molecular Cell Biology and Genetics</institution>, 01307 Dresden, <country country="DE">Germany</country></aff>
        <aff><institution>Center for Systems Biology Dresden</institution>, 01307 Dresden, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1300-6076</contrib-id>
        <name>
          <surname>Zechner</surname>
          <given-names>Christoph</given-names>
        </name>
        <xref rid="btab058-cor1" ref-type="corresp"/>
        <aff><institution>Max Planck Institute of Molecular Cell Biology and Genetics</institution>, 01307 Dresden, <country country="DE">Germany</country></aff>
        <aff><institution>Center for Systems Biology Dresden</institution>, 01307 Dresden, <country country="DE">Germany</country></aff>
        <aff><institution>Cluster of Excellence Physics of Life, TU Dresden</institution>, 01062 Dresden, <country country="DE">Germany</country></aff>
        <!--zechner@mpi-cbg.de-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab058-cor1">To whom correspondence should be addressed. <email>zechner@mpi-cbg.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-02-04">
      <day>04</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>17</issue>
    <fpage>2782</fpage>
    <lpage>2784</lpage>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>21</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>21</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab058.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Many biochemical processes in living organisms take place inside compartments that can interact with each other and remodel over time. In a recent work, we have shown how the stochastic dynamics of a compartmentalized biochemical system can be effectively studied using moment equations. With this technique, the time evolution of a compartment population is summarized using a finite number of ordinary differential equations, which can be analyzed very efficiently. However, the derivation of moment equations by hand can become time-consuming for systems comprising multiple reactants and interactions. Here we present Compartor, a toolbox that automatically generates the moment equations associated with a user-defined compartmentalized system. Through the moment equation method, Compartor renders the analysis of stochastic population models accessible to a broader scientific community.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>Compartor is provided as a Python package and is available at <ext-link xlink:href="https://pypi.org/project/compartor/" ext-link-type="uri">https://pypi.org/project/compartor/</ext-link>. Source code and usage tutorials for Compartor are available at <ext-link xlink:href="https://github.com/zechnerlab/Compartor" ext-link-type="uri">https://github.com/zechnerlab/Compartor</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>German Federal Ministry of Education and Research [BMBF</institution>
          </institution-wrap>
        </funding-source>
        <award-id>01/S18026A-F</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>competence center for Big Data ScaDS2 project and the core funding of the Max Planck Institute of Molecular Cell Biology and Genetics</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Moment-based approaches provide an effective means to study the dynamics of noisy biochemical networks (<xref rid="btab058-B7" ref-type="bibr">Ruess and Lygeros, 2015</xref>; <xref rid="btab058-B9" ref-type="bibr">Schnoerr et al., 2017</xref>; <xref rid="btab058-B10" ref-type="bibr">Singh and Hespanha, 2006</xref>). These approaches are based on systems of ordinary differential equations (ODEs), which capture the statistical properties of the reaction network such as average concentrations and their variability. However, the derivation of moment equations by hand can become exceedingly tedious, especially for systems comprising multiple chemical species and reactions. To address this problem, toolboxes have been developed to generate moment equations directly from the stoichiometric specification of a network, which greatly boosts the applicability of these approaches (<xref rid="btab058-B2" ref-type="bibr">Fan <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab058-B4" ref-type="bibr">Hespanha, 2007</xref>; <xref rid="btab058-B5" ref-type="bibr">Kazeroonian <italic toggle="yes">et al.</italic>, 2016</xref>).</p>
    <p>Existing moment generators apply to well-mixed reaction environments or compartmentalized systems with fixed spatial arrangement. However, many biological processes are organized within compartments that can remodel and interact dynamically. Examples include cell growth and division dynamics in cell communities or the fusion and fission events of sub-cellular transport vesicles. In our recent theoretical work (<xref rid="btab058-B1" ref-type="bibr">Duso and Zechner, 2020</xref>), we have shown how the method of moments can be extended to such situations. In this framework, we consider a population of reaction compartments where both the molecular contents and the compartments themselves can stochastically interact and change over time. Manually deriving moment equations for such models is even more tedious than for standard reaction systems, because additional higher-order statistics arise.</p>
    <p>In this work we present Compartor, an automatic moment equation generator for stochastic compartment populations. Compartor starts from a set of provided interaction rules and derives the associated moment equations. In its current version, equations can be exported as LaTeX, Python or Julia code. In the following, we explain Compartor and illustrate it for an examplary model (see <xref rid="btab058-F1" ref-type="fig">Fig. 1</xref>). A short tutorial on the usage of Compartor is provided in dedicated Jupyter notebooks at <ext-link xlink:href="https://github.com/zechnerlab/Compartor" ext-link-type="uri">https://github.com/zechnerlab/Compartor</ext-link>.</p>
    <fig position="float" id="btab058-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Usage example of Compartor. (<bold>A</bold>) Definition of the transition classes for the considered exemplary model. (<bold>B</bold>) Illustration of the transition classes for the considered model. The white-filled ovals represent compartments, while the green and orange circles denote two different molecular species. The intake process generates new compartments containing a Poisson-distributed amount of green molecules with mean parameter <italic toggle="yes">λ</italic>. (<bold>C</bold>) One-step derivation of a closed system of moment equations for a set of desired moments. Here, Compartor recognized automatically the need of including additional moment dynamics and applied a third-order Gamma closure. (<bold>D,E</bold>) Plot of the expected number of compartments <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo>〈</mml:mo><mml:mi>N</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula>, and the total molecular amounts <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mo>〈</mml:mo><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mo>〈</mml:mo><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula>, surrounded above and below by one standard deviation. Full lines and shaded areas show the result of moment equations (ODEs), while dots and error bars correspond to the average of 10<sup>4</sup> stochastic simulations (SSA) (<xref rid="btab058-B3" ref-type="bibr">Gillespie, 2007</xref>). The standard deviation for <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mo>〈</mml:mo><mml:mi>N</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula> is obtained from the moment equations as <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msqrt><mml:mrow><mml:mo>〈</mml:mo><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>〉</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>N</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, and analogously for the other moments. The rate constants were set to <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mi>F</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.05</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The initial condition is given by one compartment with 20 green molecules and zero orange molecules</p>
      </caption>
      <graphic xlink:href="btab058f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>Compartor is based on the formalism introduced by <xref rid="btab058-B1" ref-type="bibr">Duso and Zechner (2020)</xref>. A compartment population consists of a time-varying number <italic toggle="yes">N</italic>(<italic toggle="yes">t</italic>) of compartments, each associated with a <italic toggle="yes">D</italic>-dimensional molecular content <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">X</mml:mi><mml:mo>⊆</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mi>D</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>. The state of the population at time <italic toggle="yes">t</italic> is fully characterized by knowing the number <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of compartments for each possible content <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">X</mml:mi></mml:mrow></mml:math></inline-formula>. A population moment is generally defined as the sum <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">X</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msup></mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">γ</italic> is a vector of non-negative integer exponents. In particular, <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:msup><mml:mi>M</mml:mi><mml:mn mathvariant="bold">0</mml:mn></mml:msup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo mathvariant="bold">∈</mml:mo><mml:mi mathvariant="double-struck">X</mml:mi></mml:mrow></mml:munder><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> corresponds to the number of compartments at time <italic toggle="yes">t</italic>. Note that any population moment is an integer random variable that evolves stochastically. We denote the expectation of a moment <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> by <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mo>〈</mml:mo><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>γ</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula>. Our goal is to derive equations that describe the expected evolution of a certain set of moments or functions thereof. Compartor allows the user to specify the dynamical rules—which we refer to as <italic toggle="yes">transition classes—</italic>that govern the compartment population and generates the corresponding system of moment equations.</p>
    <sec>
      <title>2.1 Defining the model</title>
      <p>In Compartor, the user defines a transition class through a stoichiometric-like equation where the reactant compartments on the left-hand side are converted into the product compartments on the right-hand side (see <xref rid="btab058-F1" ref-type="fig">Fig. 1A</xref>). The tool supports transition classes up to order two, meaning that at most two compartments can react with one another during an event. Similarly, biochemical reactions inside a single compartment are restricted to at most two reactant molecules.</p>
      <p>The definition of a transition class requires a propensity function that determines the transition rate in dependency of the involved compartment contents. Note that propensity functions must be polynomials in <bold>x</bold> for the moment method to be applicable. The specification of the transition propensities occurs together with the definition of the associated transition classes, as shown in the script of <xref rid="btab058-F1" ref-type="fig">Figure 1A</xref>. An illustration of the four transition classes defining this example is provided in <xref rid="btab058-F1" ref-type="fig">Figure 1B</xref>. For further information about the definition of transition classes, the reader may refer to <xref rid="btab058-B1" ref-type="bibr">Duso and Zechner (2020)</xref>.</p>
    </sec>
    <sec>
      <title>2.2 Moment equation generation</title>
      <p>For the specified population model, the user provides Compartor with a set of moments for which equations should be derived. Compartor then carries out the necessary symbolic computations and returns the corresponding moment equations. Note that the derived system of moment equations is often not closed, meaning that it may involve other moments for which equations have not yet been generated. In these cases, the tool detects the presence of additional moments for which the governing equations are missing. The user can then opt to generate further equations for these moments or, alternatively, ask Compartor to apply a moment closure to approximate them by functions of the available ones. Currently, Compartor supports mean-field and third-order Gamma closures (<xref rid="btab058-B6" ref-type="bibr">Lakatos <italic toggle="yes">et al.</italic>, 2015</xref>).</p>
      <p>As shown in <xref rid="btab058-F1" ref-type="fig">Figure 1C</xref>, the tool offers a one-step feature to automatically handle the process of moment identification, equation generation and moment closure. This is accomplished by iteratively expanding the system of equations until it closes by itself, or until the highest-order moments reach order three, at which point the proposed Gamma and/or mean-field closures are applied. When the user does not specify any initial set of desired moments, Compartor returns the minimal system of moment equations sufficient to describe the expected dynamics of compartment number and total mass for each chemical species. In <xref rid="btab058-F1" ref-type="fig">Figure 1D and E</xref>, we show the solution of the system of moment equations for the given example. The obtained moment trajectories are in agreement with the Monte Carlo averages obtained by exact stochastic simulations.</p>
    </sec>
    <sec>
      <title>2.3 Code export</title>
      <p>At any time, the user can decide to export the equations generated by Compartor as LaTeX source, or as Python or Julia code compatible with standard ODE solvers in the respective language.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Discussion</title>
    <p>Compartor is a code generator that enables efficient analysis of stochastic compartment population models through the moment equation method. The tool can be applied to arbitrary models comprising compartment interactions and biochemistry up to second order. Additionally, the propensity functions must satisfy a polynomial form for the moment equation method to be applicable. Compartor is equipped with mean-field and third-order multivariate Gamma closures to approximate systems whose moment dynamics is not closed. We emphasize that the accuracy of any moment closure is model dependent (<xref rid="btab058-B8" ref-type="bibr">Schnoerr <italic toggle="yes">et al.</italic>, 2014</xref>) and, consequently, the obtained system of equations needs to be validated case by case. Future releases may extend Compartor to account for additional closure schemes and kinetic laws.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the German Federal Ministry of Education and Research [BMBF, 01/S18026A-F] by funding the competence center for Big Data ScaDS2 project and the core funding of the Max Planck Institute of Molecular Cell Biology and Genetics.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab058-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duso</surname><given-names>L.</given-names></string-name>, <string-name><surname>Zechner</surname><given-names>C.</given-names></string-name></person-group> (<year>2020</year>) 
<article-title>Stochastic reaction networks in dynamic compartment populations</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>117</volume>, <fpage>22674</fpage>–<lpage>22683</lpage>.<pub-id pub-id-type="pmid">32868438</pub-id></mixed-citation>
    </ref>
    <ref id="btab058-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fan</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>MEANS: python package for Moment Expansion Approximation, iNference and Simulation</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2863</fpage>–<lpage>2865</lpage>.<pub-id pub-id-type="pmid">27153663</pub-id></mixed-citation>
    </ref>
    <ref id="btab058-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gillespie</surname><given-names>D.T.</given-names></string-name></person-group> (<year>2007</year>) 
<article-title>Stochastic simulation of chemical kinetics</article-title>. <source>Annu. Rev. Phys. Chem</source>., <volume>58</volume>, <fpage>35</fpage>–<lpage>55</lpage>.<pub-id pub-id-type="pmid">17037977</pub-id></mixed-citation>
    </ref>
    <ref id="btab058-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hespanha</surname><given-names>J.P.</given-names></string-name></person-group> (<year>2007</year>) StochDynTools — a MATLAB toolbox to compute moment dynamics for stochastic networks of bio-chemical reactions. <ext-link xlink:href="https://web.ece.ucsb.edu/~hespanha/software/stochdyntool.html" ext-link-type="uri">https://web.ece.ucsb.edu/~hespanha/software/stochdyntool.html</ext-link> (2 February 2020, date last accessed).</mixed-citation>
    </ref>
    <ref id="btab058-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kazeroonian</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Cerena: chemical reaction network analyzer—a toolbox for the simulation and analysis of stochastic chemical kinetics</article-title>. <source>PLoS One</source>, <volume>11</volume>, <fpage>e0146732</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">26807911</pub-id></mixed-citation>
    </ref>
    <ref id="btab058-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lakatos</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Multivariate moment closure techniques for stochastic kinetic models</article-title>. <source>J. Chem. Phys</source>., <volume>143</volume>, <fpage>094107</fpage>.<pub-id pub-id-type="pmid">26342359</pub-id></mixed-citation>
    </ref>
    <ref id="btab058-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ruess</surname><given-names>J.</given-names></string-name>, <string-name><surname>Lygeros</surname><given-names>J.</given-names></string-name></person-group> (<year>2015</year>) 
<article-title>Moment-based methods for parameter inference and experiment design for stochastic biochemical reaction networks</article-title>. <source>ACM Trans. Model. Comput. Simul</source>., <volume>25</volume>, <fpage>1</fpage>–<lpage>25</lpage>.</mixed-citation>
    </ref>
    <ref id="btab058-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schnoerr</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>Validity conditions for moment closure approximations in stochastic chemical kinetics</article-title>. <source>J. Chem. Phys</source>., <volume>141</volume>, <fpage>084103</fpage>.<pub-id pub-id-type="pmid">25173001</pub-id></mixed-citation>
    </ref>
    <ref id="btab058-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schnoerr</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Approximation and inference methods for stochastic biochemical kinetics – a tutorial review</article-title>. <source>J. Phys. A Math. Theor</source>., <volume>50</volume>, <fpage>093001</fpage>.</mixed-citation>
    </ref>
    <ref id="btab058-B10">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Singh</surname><given-names>A.</given-names></string-name>, <string-name><surname>Hespanha</surname><given-names>J.P.</given-names></string-name></person-group> (<year>2006</year>) Lognormal moment closures for biochemical reactions. In <italic toggle="yes">Proceedings of the 45th IEEE Conference on Decision and Control</italic>. IEEE, San Diego, CA, USA, pp. <fpage>2063</fpage>–<lpage>2068</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
