<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10234764</article-id>
    <article-id pub-id-type="pmid">37220900</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad337</article-id>
    <article-id pub-id-type="publisher-id">btad337</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scME: a dual-modality factor model for single-cell multiomics embedding</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Bin</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="equal">Resources</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="equal">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="equal">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <aff><institution>Department of Automation, School of Aerospace Engineering, Xiamen University</institution>, Xiamen 361102, Fujian, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Fan</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="equal">Resources</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="http://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="equal">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role>
        <aff><institution>Department of Automation, School of Aerospace Engineering, Xiamen University</institution>, Xiamen 361102, Fujian, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6469-9541</contrib-id>
        <name>
          <surname>Zeng</surname>
          <given-names>Feng</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Resources" vocab-term-identifier="http://credit.niso.org/contributor-roles/resources" degree-contribution="equal">Resources</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="equal">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="http://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="equal">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Automation, School of Aerospace Engineering, Xiamen University</institution>, Xiamen 361102, Fujian, <country country="CN">China</country></aff>
        <aff><institution>Department of Neuroscience, School of Medicine, Xiamen University</institution>, <addr-line>Xiamen</addr-line>, Fujian 361005, <country country="CN">China</country></aff>
        <aff><institution>National Institute for Data Science in Health and Medicine, School of Medicine, Xiamen University</institution>, Xiamen 361005, <country country="CN">China</country></aff>
        <xref rid="btad337-cor1" ref-type="corresp"/>
        <!--zengfeng@xmu.edu.cn-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad337-cor1">Corresponding author. Department of Automation, School of Aerospace Engineering, Xiamen University, No.4221-134, Xiang'an S Rd, Xiang'An, Xiamen, Fujian 361102, China. E-mail: <email>zengfeng@xmu.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-05-23">
      <day>23</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>6</issue>
    <elocation-id>btad337</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>19</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>01</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad337.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-cell multiomics technologies are emerging to characterize different molecular features of cells. This gives rise to an issue of combining various kinds of molecular features to dissect cell heterogeneity. Most single-cell multiomics integration methods focus on shared information among modalities while complementary information specific to each modality is often discarded.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>To disentangle and combine shared and complementary information across modalities, we develop a dual-modality factor model named scME by using deep factor modeling. Our results demonstrate that scME can generate a better joint representation of multiple modalities than those generated by other single-cell multiomics integration algorithms, which gives a clear elucidation of nuanced differences among cells. We also demonstrate that the joint representation of multiple modalities yielded by scME can provide salient information to improve both single-cell clustering and cell-type classification. Overall, scME will be an efficient method for combining various kinds of molecular features to facilitate the dissection of cell heterogeneity.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The code is public for academic use and available on the GitHub site (<ext-link xlink:href="https://github.com/bucky527/scME" ext-link-type="uri">https://github.com/bucky527/scME</ext-link>).</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Natural Science Foundation of Fujian Province, China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2019J01041</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Although single-cell RNA sequencing (<xref rid="btad337-B6" ref-type="bibr">Hwang <italic toggle="yes">et al.</italic> 2018</xref>) has been a powerful tool to investigate the transcriptional dynamics of cells in living things, it is increasingly aware of that cell heterogeneity cannot be fully and correctly determined with the use of only one kind of molecular feature, i.e. CD4+ and CD8+ T-cell subtypes. Moreover, the unimodal dataset is limited to revealing the complex structure of biological information processing, where multiple distinct molecules are cascaded to ensure the correctness of cell fate decisions and functions. Several single-cell multiomics technologies are encouragingly emerging to address these issues by measuring various kinds of molecular features instead of one kind of molecular feature. For example, CITE-seq (<xref rid="btad337-B16" ref-type="bibr">Stoeckius <italic toggle="yes">et al.</italic> 2017</xref>) can quantify transcripts and cell-surface proteins in the same cells with oligonucleotide-conjugated antibodies. SHARE-seq (<xref rid="btad337-B12" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2020</xref>) and 10× Multiome (<xref rid="btad337-B19" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad337-B15" ref-type="bibr">Satpathy <italic toggle="yes">et al.</italic> 2019</xref>) can quantify transcripts and chromatin openness in the same cells. Single-cell multiomics bring up new tasks requiring new computational methods to effectively process multimodal information and combine different kinds of molecular features to discover insightful biological events.</p>
    <p>A task of fundamental multimodal data processing is joint representation learning of multiple modalities, which aims to embed cells in a low-dimensional space so that one cell and its neighboring cells share similar multimodal features. To obtain a proper joint low-dimensional embedding for a multimodal dataset, one needs to overcome the following challenges. First, single-cell multiomics confront diverse sources and types of noise. Data quality varies vastly across modalities. To address this issue, Weighted Nearest Neighbor (WNN) (<xref rid="btad337-B4" ref-type="bibr">Hao <italic toggle="yes">et al.</italic> 2021</xref>) estimates the utility of a modality based on the consistency of the information contained in local neighborhoods defined by <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi mathvariant="normal">k</mml:mi></mml:math></inline-formula>-nearest neighboring (KNN). WNN devises a weighted strategy to compute the joint embedding of multimodal data, where results can be impacted by modalities with good information utility. Second, the information provided by multiple modalities is complicated, describing various aspects of cell characteristics. Conceptually, multimodal information can be cataloged into two kinds (<xref rid="btad337-B10" ref-type="bibr">Lin and Zhang 2022</xref>). One kind of multimodal information is shared information across modalities that can lead to a consistent statement about the state of a cell. For example, if shared information claims that one set of cells is different from the other set of cells, these two sets of cells shall be separated in every modality. The other kind of multimodal information is complementary information that provides distinct cell characteristics in a modality, which are not observable in other modalities. On the one hand, it is difficult to identify shared information and complementary information. On the other hand, it is difficult to combine shared information and complementary information, well balancing the contribution of distinct information to downstream tasks such as clustering and classification.</p>
    <p>Accurate identification and combination of shared and complementary information are critical for joint representation learning of single-cell multiomics. The commonly adopted approach is to retain shared information. For example, MOFA+ (<xref rid="btad337-B1" ref-type="bibr">Argelaguet <italic toggle="yes">et al.</italic> 2020</xref>) uses principal component analysis (PCA) to extract the shared information across various modalities and discard complementary information. To deal with the complexity of multimodal data, totalVI (<xref rid="btad337-B3" ref-type="bibr">Gayoso <italic toggle="yes">et al.</italic> 2021</xref>) uses a variational autoencoder (<xref rid="btad337-B8" ref-type="bibr">Kingma and Welling 2014</xref>) instead of PCA to compute the shared information among modalities. Though totalVI is powerful, a method that can effectively distinguish and combine both shared and complementary information, to reveal the variations among cells maximally, is still lacking.</p>
    <p>To address the above issue, we designed a factor model involving one common latent variable to describe shared information across modalities and the other latent variables to describe complementary information in each modality. We implemented the factor model with an architecture resembling that of supervised deep generative models, which have been recently recognized as effective factorizing methods to extract information relating to factors (<xref rid="btad337-B7" ref-type="bibr">Kim and Mnih 2018</xref>). In practice, there are no precise definitions of shared information and complementary information and no means to distinguish them. To tackle this difficulty, we run clustering on each modality at the beginning and use the clustering labels as the indicator of modality-specific information to supervise factorization and parameter estimation. This behaves like self-supervised learning. The proposed factor model is trained by using stochastic variational inference (<xref rid="btad337-B5" ref-type="bibr">Hoffman <italic toggle="yes">et al.</italic> 2013</xref>) and thus is highly scalable. We hypothesized that the combination of the common latent variable and the distinct information specific to a modality shall provide sufficient information for accurate reconstruction of the observations in all modalities. We conducted a series of experiments to demonstrate that the factor model significantly improves cross-modality data integration and generates joint embedding that is useful for several downstream tasks, including clustering, classification, and data visualization.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Supervised deep generative model for factor analysis</title>
      <p>To maximumly utilize multimodal information, the key is to recognize and extract both shared information and complementary information across multiple modalities. In this article, we introduce a dual-modality factor model for the extraction of information on various properties of single-cell multiomics (<xref rid="btad337-F1" ref-type="fig">Figure 1</xref>). The proposed dual-modality factor model is derived from the supervised deep generative model. Supervised deep generative models have been broadly applied in the field of single-cell data analysis. In addition to dimensionality reduction and classification, supervised deep generative models can be interpreted as factor models. From the perspective of factor model, supervised deep generative models can be represented as the following generation process controlled by a set of factors. For simplicity, let us consider a factor model with two factors. One of the factors is data label <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>y</mml:mi></mml:math></inline-formula>, which indicates the principal factor affecting the variation of data. The other factor <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is to describe the impact of the resting factor(s) that cannot be characterized or is unknown at the moment. Thus, the complete state of data can be represented by the following equation,
</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:maligngroup/>
                  <mml:mi>z</mml:mi>
                  <mml:mo>∼</mml:mo>
                  <mml:mi>y</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>z</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>u</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo> </mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>Then, it is to generate a data <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi>X</mml:mi></mml:math></inline-formula> from the complete state <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi>z</mml:mi></mml:math></inline-formula> as follows,
</p>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:maligngroup/>
                  <mml:mi>X</mml:mi>
                  <mml:mo>∼</mml:mo>
                  <mml:mi>z</mml:mi>
                  <mml:mo>#</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>In the aforementioned factor model, the data label <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>y</mml:mi></mml:math></inline-formula> is to represent the axis of variation in data to be extracted. After training with the cross-entropy loss, the supervised deep generative models are capable of extracting information regarding the variation of <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi>y</mml:mi></mml:math></inline-formula>. Unexplainable data variation can be captured by <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Factor models based on the supervised deep generative models are increasingly used for disentangled representation learning in computer vision. It has been used to successfully disentangle the style factor and the digit factor in the image data of handwritten digits (<xref rid="btad337-B14" ref-type="bibr">Paige <italic toggle="yes">et al.</italic> 2017</xref>). Here, we extend the model to the factorization of single-cell multiomics.</p>
    </sec>
    <sec>
      <title>2.2 scME model</title>
      <p>Enlightened by the factorization of supervised deep generative learning, we proposed and developed a dual-modality factor model for the analysis of single-cell multiomics. For clarity and simplicity of illustration, we use CITE-seq (<xref rid="btad337-B16" ref-type="bibr">Stoeckius <italic toggle="yes">et al.</italic> 2017</xref>) throughout the article. For CITE-seq, a cell has two modalities, including the RNA modality and protein modality. First of all, we introduce the general concept of the dual-modality factor model. We define a latent variable <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to denote the shared information. Additionally, we involve two distinct latent variables <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to represent the complementary information of the RNA modality and the protein modality, respectively. Due to a lack of precise definitions regarding shared information and complementary information, it is difficult to factorize the complicated information contained in single-cell multiomics. To overcome the difficulty, we adopt a self-supervised-like strategy. Specifically, we perform Leiden clustering (<xref rid="btad337-B18" ref-type="bibr">Traag <italic toggle="yes">et al.</italic> 2019</xref>) on the RNA modality and the protein modality at the beginning. Then, the clustering labels of the two modalities are used as <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to indicate the modality-specific information. The latent state of the RNA modality can be specified by using the shared information <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the complementary information <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as follows,
</p>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:maligngroup/>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>Z</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>R</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>∼</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>Z</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>M</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>Y</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>R</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>#</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>Similarly, the latent state of the protein modality can be specified by using the shared information <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the complementary information <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, that is,
</p>
      <disp-formula id="E4">
        <label>(4)</label>
        <mml:math id="M4" display="block" overflow="scroll">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:maligngroup/>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>Z</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>∼</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>Z</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>M</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>Y</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>#</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>After the specification of the latent states, the observations <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of two modalities can be reconstructed with the well-defined generative processes <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as follows,
</p>
      <disp-formula id="E5">
        <label>(5)</label>
        <mml:math id="M5" display="block" overflow="scroll">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:maligngroup/>
                  <mml:mtable columnalign="left">
                    <mml:mtr>
                      <mml:mtd>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>X</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>R</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>∼</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>G</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>R</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>R</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>X</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>∼</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>G</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>P</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfenced>
                        <mml:mo>#</mml:mo>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>The detailed information regarding the latent factors and generative processes are given in the following.</p>
      <p>Suppose there is a CITE-seq dataset comprised of <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> cells, where we denote the RNA modality as <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> and the protein modality <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>, <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:math></inline-formula>, respectively. First, we specify the distribution models regarding <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The shared information <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is modeled with a standard normal distribution,
where <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mn mathvariant="bold">0</mml:mn><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the zero-mean vector and <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>×</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the identity matrix. The number <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mi>d</mml:mi></mml:math></inline-formula> is the dimension of the low-dimensional embedding space. Since the complementary information are discrete clustering labels, <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are modeled with the categorical distribution as follows,
and
where <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mn>1,1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represent the parameters of the non-informative prior Dirichlet distributions over <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The number of clusters in the RNA modality is <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The number of clusters in the protein modality is <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
      <disp-formula id="E6">
        <label>(6)</label>
        <mml:math id="M6" display="block" overflow="scroll">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:maligngroup/>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>Z</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>M</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>∼</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mfenced open="(" close=")" separators="|">
                    <mml:mrow>
                      <mml:mn mathvariant="bold">0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mi mathvariant="bold-italic">I</mml:mi>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>#</mml:mo>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <disp-formula id="E7">
        <label>(7)</label>
        <mml:math id="M7" display="block" overflow="scroll">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:maligngroup/>
                  <mml:mtable columnalign="left">
                    <mml:mtr>
                      <mml:mtd>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo>θ</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>R</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>∼</mml:mo>
                        <mml:mi mathvariant="normal">Dirichlet</mml:mi>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mn mathvariant="bold">1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>R</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>Y</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>R</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>∼</mml:mo>
                        <mml:mi mathvariant="normal">Categorical</mml:mi>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mo>θ</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>R</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfenced>
                        <mml:mo>#</mml:mo>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <disp-formula id="E8">
        <label>(8)</label>
        <mml:math id="M8" display="block" overflow="scroll">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:maligngroup/>
                  <mml:mtable columnalign="left">
                    <mml:mtr>
                      <mml:mtd>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo>θ</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>∼</mml:mo>
                        <mml:mi mathvariant="normal">Dirichlet</mml:mi>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mn mathvariant="bold">1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>P</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>Y</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>∼</mml:mo>
                        <mml:mi mathvariant="normal">Categorical</mml:mi>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mo>θ</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>P</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfenced>
                        <mml:mo>#</mml:mo>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>Next, we specify the modality-specific generation process. To generate the observations of the RNA modality, the generation process starts with the generation of the modality-specific latent state <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> followed by a multinomial generation process. The complete generation process of RNA observations is formulated as follows,
where <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">wdr</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the multiple layer neural networks. Similarly, the generation of the protein observations is formulated as follows,
where <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">wdp</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the multiple layer neural networks.</p>
      <disp-formula id="E9">
        <label>(9)</label>
        <mml:math id="M9" display="block" overflow="scroll">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo>μ</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>R</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">Σ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>R</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>f</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>w</mml:mi>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mfenced open="(" close=")" separators="|">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>Y</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>R</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>∼</mml:mo>
                      <mml:mi mathvariant="normal">Normal</mml:mi>
                      <mml:mfenced open="(" close=")" separators="|">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mo>μ</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>R</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">Σ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>R</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>#</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mtable columnalign="left">
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mo>γ</mml:mo>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>R</mml:mi>
                                    <mml:mo>,</mml:mo>
                                    <mml:mi>i</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:mo>α</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>R</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>=</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>f</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="italic">wdr</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mfenced open="(" close=")" separators="|">
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>Z</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>R</mml:mi>
                                    <mml:mo>,</mml:mo>
                                    <mml:mi>i</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mfenced>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>X</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>R</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>∼</mml:mo>
                            <mml:mi mathvariant="normal">NegativeBinomial</mml:mi>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mo>γ</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>R</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mo>α</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>R</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                            <mml:mo>,</mml:mo>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <disp-formula id="E10">
        <label>(10)</label>
        <mml:math id="M10" display="block" overflow="scroll">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo>μ</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">Σ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>f</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>w</mml:mi>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mfenced open="(" close=")" separators="|">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>Y</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>P</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>∼</mml:mo>
                      <mml:mi mathvariant="normal">Normal</mml:mi>
                      <mml:mfenced open="(" close=")" separators="|">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mo>μ</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>P</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">Σ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>P</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>#</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mtable columnalign="left">
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mo>γ</mml:mo>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>p</mml:mi>
                                    <mml:mo>,</mml:mo>
                                    <mml:mi>i</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:mo>α</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>=</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>f</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="italic">wdp</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mfenced open="(" close=")" separators="|">
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>Z</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>p</mml:mi>
                                    <mml:mo>,</mml:mo>
                                    <mml:mi>i</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mfenced>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>X</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>P</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>∼</mml:mo>
                            <mml:mi mathvariant="normal">NegativeBinomial</mml:mi>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mo>γ</mml:mo>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>p</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>i</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>,</mml:mo>
                                  <mml:mo>α</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>p</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:mo>,</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>To utilize the scalable variational inference, we design the variational distribution over the latent variables as the following product of factorized distributions,
</p>
      <disp-formula id="E11">
        <label>(11)</label>
        <mml:math id="M11" display="block" overflow="scroll">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:maligngroup/>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>q</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">ϕ</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mfenced open="(" close=")" separators="|">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>P</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo> </mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo> </mml:mo>
                          <mml:mi>X</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>X</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>P</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>q</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">ϕ</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mfenced open="(" close=")" separators="|">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo> </mml:mo>
                    <mml:mrow>
                      <mml:mo> </mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>P</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>q</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>ϕ</mml:mo>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mfenced open="(" close=")" separators="|">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo> </mml:mo>
                    <mml:mrow>
                      <mml:mo> </mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>X</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>q</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>ϕ</mml:mo>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mfenced open="(" close=")" separators="|">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>P</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo> </mml:mo>
                    <mml:mrow>
                      <mml:mo> </mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>X</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>P</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>#</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>The loss function is comprised of two components. The first component is the likelihood that the proposed dual-modality factor model generates the observed data of both two modalities. Due to that the true data distribution is unknown, the data likelihood is approximated by the variational distribution. Therefore, the evidence lower bound (ELBO) can be obtained as follows,
</p>
      <disp-formula id="E12">
        <label>(12)</label>
        <mml:math id="M12" display="block" overflow="scroll">
          <mml:mi mathvariant="normal">ELBO</mml:mi>
          <mml:mo>=</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mi>E</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>q</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>ϕ</mml:mo>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:msub>
          <mml:mfenced open="[" close="]" separators="|">
            <mml:mrow>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">log</mml:mi>
                </mml:mrow>
                <mml:mo>⁡</mml:mo>
                <mml:mo> </mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>θ</mml:mo>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mfenced open="(" close=")" separators="|">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>X</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>Z</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">log</mml:mi>
                    </mml:mrow>
                    <mml:mo>⁡</mml:mo>
                    <mml:mo> </mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>θ</mml:mo>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfenced open="(" close=")" separators="|">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>X</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>P</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>Z</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>Z</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>P</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:mfenced>
          <mml:mo>+</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mi>D</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>K</mml:mi>
              <mml:mi>L</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mo>(</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>q</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>ϕ</mml:mo>
              </mml:mrow>
            </mml:msub>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>Z</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>Z</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>R</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>Z</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>|</mml:mo>
            <mml:mo>|</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>p</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>θ</mml:mo>
                </mml:mrow>
              </mml:msub>
              <mml:mfenced open="(" close=")" separators="|">
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>Z</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>M</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:mrow>
          <mml:mo>)</mml:mo>
          <mml:mo>#</mml:mo>
          <mml:mo>+</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mi>D</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>K</mml:mi>
              <mml:mi>L</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mo>(</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>q</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>ϕ</mml:mo>
              </mml:mrow>
            </mml:msub>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>Z</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>R</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>X</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>R</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>Y</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>R</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>|</mml:mo>
            <mml:mo>|</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>p</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>θ</mml:mo>
                </mml:mrow>
              </mml:msub>
              <mml:mfenced open="(" close=")" separators="|">
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>Z</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>R</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:mrow>
          <mml:mo>)</mml:mo>
          <mml:mo>+</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mi>D</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>K</mml:mi>
              <mml:mi>L</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mo>(</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>q</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>ϕ</mml:mo>
              </mml:mrow>
            </mml:msub>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>Z</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>X</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>Y</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mfenced>
            <mml:mfenced open="‖" close="" separators="|">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>θ</mml:mo>
                  </mml:mrow>
                </mml:msub>
                <mml:mfenced open="(" close=")" separators="|">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
              </mml:mrow>
            </mml:mfenced>
          </mml:mrow>
          <mml:mo>)</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>The other component regards the accuracy of label prediction. For the prediction of RNA cluster labels and protein cluster labels, we use the binary cross-entropy losses (BCE) for two modalities, that is,
where <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal"> </mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are two multiple layer neural networks for label prediction, where the last layer adopts the Softmax activation function. The total loss function is defined as.
</p>
      <disp-formula id="E046">
        <label>(13)</label>
        <mml:math id="M046" display="block" overflow="scroll">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mi mathvariant="normal">B</mml:mi>
                <mml:mi mathvariant="normal">CE</mml:mi>
                <mml:mfenced open="(" close=")" separators="|">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>Y</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>R</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mrow>
                              <mml:mi>Y</mml:mi>
                            </mml:mrow>
                            <mml:mo>^</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>R</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>Y</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>R</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">log</mml:mi>
                  </mml:mrow>
                  <mml:mo>⁡</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mrow>
                              <mml:mi>Y</mml:mi>
                            </mml:mrow>
                            <mml:mo>^</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>R</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mfenced open="(" close=")" separators="|">
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mo>-</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>Y</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>R</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">log</mml:mi>
                  </mml:mrow>
                  <mml:mo>⁡</mml:mo>
                  <mml:mrow>
                    <mml:mfenced open="(" close=")" separators="|">
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo>-</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mover accent="true">
                                <mml:mrow>
                                  <mml:mi>Y</mml:mi>
                                </mml:mrow>
                                <mml:mo>^</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>R</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi>Y</mml:mi>
                              </mml:mrow>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                          <mml:mi>R</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfenced open="(" close=")" separators="|">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>Z</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>#</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mtable columnalign="left">
                        <mml:mtr>
                          <mml:mtd>
                            <mml:mi mathvariant="normal">B</mml:mi>
                            <mml:mi mathvariant="normal">CE</mml:mi>
                            <mml:mfenced open="(" close=")" separators="|">
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>Y</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>P</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mrow>
                                          <mml:mi>Y</mml:mi>
                                        </mml:mrow>
                                        <mml:mo>^</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>P</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mfenced>
                            <mml:mo>=</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>Y</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>P</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">log</mml:mi>
                              </mml:mrow>
                              <mml:mo>⁡</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mrow>
                                          <mml:mi>Y</mml:mi>
                                        </mml:mrow>
                                        <mml:mo>^</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>P</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mo>+</mml:mo>
                            <mml:mfenced open="(" close=")" separators="|">
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>-</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>Y</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>P</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mfenced>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">log</mml:mi>
                              </mml:mrow>
                              <mml:mo>⁡</mml:mo>
                              <mml:mrow>
                                <mml:mfenced open="(" close=")" separators="|">
                                  <mml:mrow>
                                    <mml:mn>1</mml:mn>
                                    <mml:mo>-</mml:mo>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:mover accent="true">
                                            <mml:mrow>
                                              <mml:mi>Y</mml:mi>
                                            </mml:mrow>
                                            <mml:mo>^</mml:mo>
                                          </mml:mover>
                                        </mml:mrow>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>P</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                </mml:mfenced>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mover accent="true">
                                    <mml:mrow>
                                      <mml:mi>Y</mml:mi>
                                    </mml:mrow>
                                    <mml:mo>^</mml:mo>
                                  </mml:mover>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>P</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>=</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>f</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>C</mml:mi>
                                <mml:mi>P</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mfenced open="(" close=")" separators="|">
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>Z</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>M</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mfenced>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="E13">
        <label>(14)</label>
        <mml:math id="M13" display="block" overflow="scroll">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:maligngroup/>
                  <mml:mi mathvariant="script" class="calligraphy">L</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mi mathvariant="italic">ELBO</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:mi mathvariant="italic">BCE</mml:mi>
                  <mml:mfenced open="(" close=")" separators="|">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>Y</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi>Y</mml:mi>
                              </mml:mrow>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>+</mml:mo>
                  <mml:mi mathvariant="italic">BCE</mml:mi>
                  <mml:mfenced open="(" close=")" separators="|">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>Y</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>P</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi>Y</mml:mi>
                              </mml:mrow>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>P</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>#</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>We estimate the parameters of the proposed dual-modality factor model using the Adam optimizer and stochastic variational inference (<xref rid="btad337-B5" ref-type="bibr">Hoffman <italic toggle="yes">et al.</italic> 2013</xref>) algorithm.</p>
    </sec>
    <sec>
      <title>2.3 Datasets and preprocessing</title>
      <sec>
        <title>2.3.1 Datasets</title>
        <p>We used four benchmarking datasets to evaluate the performances of the dual-modality factor model and the state-of-the-art methods. The four datasets are CBMC (<xref rid="btad337-B9" ref-type="bibr">Linderman <italic toggle="yes">et al.</italic> 2022</xref>), BMNC (<xref rid="btad337-B17" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic> 2019</xref>), BM2 (<xref rid="btad337-B11" ref-type="bibr">Luecken <italic toggle="yes">et al.</italic> 2021</xref>), and SLN (<xref rid="btad337-B3" ref-type="bibr">Gayoso <italic toggle="yes">et al.</italic> 2021</xref>), which are generated by CITE-seq. All four benchmarking datasets are also available on the National Center for Biotechnology Information (NCBI) GEO database. The statistics and GEO accession numbers of the four datasets are given in <xref rid="btad337-T1" ref-type="table">Table 1</xref>.</p>
        <table-wrap position="float" id="btad337-T1">
          <label>Table 1.</label>
          <caption>
            <p>Statistics and GEO accession numbers of four datasets.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col valign="top" align="left" span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="left" span="1"/>
              <col valign="top" align="left" span="1"/>
              <col valign="top" align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Datasets</th>
                <th align="center" rowspan="1" colspan="1">Cell size</th>
                <th align="center" rowspan="1" colspan="1">Species</th>
                <th align="center" rowspan="1" colspan="1">Protocol</th>
                <th align="center" rowspan="1" colspan="1">GEO</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">BMNC</td>
                <td rowspan="1" colspan="1">30 672</td>
                <td rowspan="1" colspan="1">Homo sapiens</td>
                <td rowspan="1" colspan="1">CITE-seq</td>
                <td rowspan="1" colspan="1">GSE128639</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">BM2</td>
                <td rowspan="1" colspan="1">120 000</td>
                <td rowspan="1" colspan="1">Homo sapiens</td>
                <td rowspan="1" colspan="1">CITE-seq</td>
                <td rowspan="1" colspan="1">GSE194122</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">SLN</td>
                <td rowspan="1" colspan="1">32 648</td>
                <td rowspan="1" colspan="1">Mus musculus</td>
                <td rowspan="1" colspan="1">CITE-seq</td>
                <td rowspan="1" colspan="1">GSE150599</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">CBMC</td>
                <td rowspan="1" colspan="1">8617</td>
                <td rowspan="1" colspan="1">Homo sapiens</td>
                <td rowspan="1" colspan="1">CITE-seq</td>
                <td rowspan="1" colspan="1">GSE100866</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </sec>
      <sec>
        <title>2.3.2 <italic toggle="yes">Data preprocessing, visualization, and clustering</italic></title>
        <p>All datasets are preprocessed following the standard instructions of the Seurat protocol (<xref rid="btad337-B2" ref-type="bibr">Butler <italic toggle="yes">et al.</italic> 2018</xref>). For the RNA modality, we filtered out the genes expressed in &lt;200 cells. After that, 2000 highly variable genes selected by FindVariableFeatures were used for downstream analyses. For the protein modality, all proteins are used in downstream analyses. Specifically, for BMNC, BM2, SLN, and CBMC, we used 25, 134, 111, and 10 protein features, respectively. We use RunUMAP to generate UMAP (<xref rid="btad337-B13" ref-type="bibr">McInnes <italic toggle="yes">et al.</italic> 2018</xref>) plots in the article.</p>
        <p>To generate clusters for the factorization of complementary information, we first use RunPCA to compute the principal components for both RNA and protein modalities. Then, we use FindNeighbors with the top 30 principal components (PCs) to construct the KNN graph for the RNA modality. For the protein modality, we use FindNeighbors with 10 PCs to construct the KNN graphs. Next, we apply FindClusters to find clusters in both modalities using the Leiden clustering algorithm (<xref rid="btad337-B18" ref-type="bibr">Traag <italic toggle="yes">et al.</italic> 2019</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Evaluation metrics</title>
      <sec>
        <title>2.4.1 <italic toggle="yes">Metrics for clustering evaluation</italic></title>
        <p>We use the normalized mutual information (NMI) and adjusted Rand index (ARI) to evaluate the clustering performance. The definition of NMI metric is as follows. Let <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mi>Y</mml:mi></mml:math></inline-formula> and <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> be the true cluster labels and the predicted cluster labels. The function <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mi>I</mml:mi></mml:math></inline-formula> is to compute mutual entropy between two variables. The function <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mi>H</mml:mi><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>to compute Shannon entropy between two variables. The NMI metric is defined as,
</p>
        <disp-formula id="E14">
          <label>(15)</label>
          <mml:math id="M14" display="block" overflow="scroll">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:maligngroup/>
                    <mml:mi>N</mml:mi>
                    <mml:mi>M</mml:mi>
                    <mml:mi>I</mml:mi>
                    <mml:mfenced open="(" close=")" separators="|">
                      <mml:mrow>
                        <mml:mi>Y</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mrow>
                              <mml:mi>Y</mml:mi>
                            </mml:mrow>
                            <mml:mo>^</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                        <mml:mo>×</mml:mo>
                        <mml:mi>I</mml:mi>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:mi>Y</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mrow>
                              <mml:mover accent="true">
                                <mml:mrow>
                                  <mml:mi>Y</mml:mi>
                                </mml:mrow>
                                <mml:mo>^</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mfenced open="[" close="]" separators="|">
                          <mml:mrow>
                            <mml:mi>H</mml:mi>
                            <mml:mfenced open="(" close=")" separators="|">
                              <mml:mrow>
                                <mml:mi>Y</mml:mi>
                              </mml:mrow>
                            </mml:mfenced>
                            <mml:mo>+</mml:mo>
                            <mml:mi>H</mml:mi>
                            <mml:mfenced open="(" close=")" separators="|">
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mover accent="true">
                                    <mml:mrow>
                                      <mml:mi>Y</mml:mi>
                                    </mml:mrow>
                                    <mml:mo>^</mml:mo>
                                  </mml:mover>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mfenced>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>#</mml:mo>
                    <mml:mo>.</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>NMI is a real value between 0 and 1. Generally speaking, a favorable clustering result will obtain a high NMI score.</p>
        <p>ARI is to evaluate the similarity between the clustering labels and the true labels. In theory, <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> data points can generate a total of <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></inline-formula> data pairs.</p>
        <p>The relationship of the pairwise data points can be separated into four categories. The first kind of relationship is the agreement of aggregation. That is, two data points of a pair are reported in the same cluster not only by the true labels but also by the clustering labels. The number of the aggregation agreements is denoted as <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mi>a</mml:mi></mml:math></inline-formula>. The second kind of relationship is the agreement of separation. That is, a pair of data points that are with distinct true labels are also assigned to different clusters by the clustering labels. The number of the separation agreements is denoted as <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mi>b</mml:mi></mml:math></inline-formula>. The rest kinds of the relationships represent the disagreement between the true labels and the clustering labels on the data pairs. Rand index (RI) defined by <xref rid="E15" ref-type="disp-formula">Equation (16)</xref> is to compute the chance that the true labels and the clustering labels will agree on a randomly chosen pair. ARI is an adjustment of RI, which is more commonly used in single-cell analysis.
</p>
        <disp-formula id="E15">
          <label>(16)</label>
          <mml:math id="M15" display="block" overflow="scroll">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:maligngroup/>
                    <mml:mi mathvariant="normal">RI</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi>a</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>b</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:mfrac linethickness="0pt">
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo> </mml:mo>
                    <mml:mo>#</mml:mo>
                    <mml:mo>.</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <disp-formula id="E16">
          <label>(17)</label>
          <mml:math id="M16" display="block" overflow="scroll">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:maligngroup/>
                    <mml:mi mathvariant="normal">ARI</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">RI</mml:mi>
                        <mml:mo>-</mml:mo>
                        <mml:mi mathvariant="normal">ExpectedRI</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">max</mml:mi>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:mi mathvariant="normal">RI</mml:mi>
                          </mml:mrow>
                        </mml:mfenced>
                        <mml:mo>-</mml:mo>
                        <mml:mi mathvariant="normal">ExpectedRI</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>#</mml:mo>
                    <mml:mo>.</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </sec>
      <sec>
        <title>2.4.2 <italic toggle="yes">Metrics for classification evaluation</italic></title>
        <p>In addition to clustering, we evaluate the multimodal single-cell integration methods by running the cell-type classification on the integrated results. We assess the classification using several metrics, including accuracy, precision, recall, <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mi mathvariant="normal">F</mml:mi><mml:mn>1</mml:mn></mml:math></inline-formula>, and Matthews’s correlation coefficient (MCC). These metrics are defined upon true positives (TP), true negatives (TN), false positives (FP), and false negatives (FN) as described in the following equations,
</p>
        <disp-formula id="E17">
          <label>(18)</label>
          <mml:math id="M17" display="block" overflow="scroll">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:maligngroup/>
                    <mml:mo> </mml:mo>
                    <mml:mi mathvariant="italic">Accuracy</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">TP</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi mathvariant="normal">TN</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">TP</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi mathvariant="normal">TN</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi mathvariant="normal">FP</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi mathvariant="normal">FN</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>#</mml:mo>
                    <mml:mo>.</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <disp-formula id="E18">
          <label>(19)</label>
          <mml:math id="M18" display="block" overflow="scroll">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:maligngroup/>
                    <mml:mi>P</mml:mi>
                    <mml:mi mathvariant="italic">recision</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">TP</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">TP</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi mathvariant="normal">FP</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>#</mml:mo>
                    <mml:mo>.</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <disp-formula id="E19">
          <label>(20)</label>
          <mml:math id="M19" display="block" overflow="scroll">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:maligngroup/>
                    <mml:mo> </mml:mo>
                    <mml:mi mathvariant="italic">Recall</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">TP</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">TP</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi mathvariant="normal">FN</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>#</mml:mo>
                    <mml:mo>.</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <disp-formula id="E20">
          <label>(21)</label>
          <mml:math id="M20" display="block" overflow="scroll">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:maligngroup/>
                    <mml:mo> </mml:mo>
                    <mml:mi>F</mml:mi>
                    <mml:mn>1</mml:mn>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                        <mml:mo>×</mml:mo>
                        <mml:mi mathvariant="normal">Precision</mml:mi>
                        <mml:mo>×</mml:mo>
                        <mml:mi mathvariant="normal">Recall</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">Precision</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi mathvariant="normal">Recall</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>#</mml:mo>
                    <mml:mo>.</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <disp-formula id="E21">
          <label>(22)</label>
          <mml:math id="M21" display="block" overflow="scroll">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:maligngroup/>
                    <mml:mi>M</mml:mi>
                    <mml:mi>C</mml:mi>
                    <mml:mi>C</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">TP</mml:mi>
                        <mml:mo>×</mml:mo>
                        <mml:mi mathvariant="normal">TN</mml:mi>
                        <mml:mo>-</mml:mo>
                        <mml:mi mathvariant="normal">FP</mml:mi>
                        <mml:mo>×</mml:mo>
                        <mml:mi mathvariant="normal">FN</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msqrt>
                          <mml:mfenced open="(" close=")" separators="|">
                            <mml:mrow>
                              <mml:mi mathvariant="normal">TP</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mi mathvariant="normal">FP</mml:mi>
                            </mml:mrow>
                          </mml:mfenced>
                          <mml:mfenced open="(" close=")" separators="|">
                            <mml:mrow>
                              <mml:mi mathvariant="normal">TP</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mi mathvariant="normal">FN</mml:mi>
                            </mml:mrow>
                          </mml:mfenced>
                          <mml:mfenced open="(" close=")" separators="|">
                            <mml:mrow>
                              <mml:mi mathvariant="normal">TN</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mi mathvariant="normal">FP</mml:mi>
                            </mml:mrow>
                          </mml:mfenced>
                          <mml:mfenced open="(" close=")" separators="|">
                            <mml:mrow>
                              <mml:mi mathvariant="normal">TN</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mi mathvariant="normal">FN</mml:mi>
                            </mml:mrow>
                          </mml:mfenced>
                        </mml:msqrt>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>#</mml:mo>
                    <mml:mo>.</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </sec>
    </sec>
    <sec>
      <title>2.5 Comparison methods</title>
      <p>We selected three methods for comparison, including Seurat V4, totalVI, and MOFA+ (<xref rid="btad337-T2" ref-type="table">Table 2</xref>). Seurat V4 provides a joint KNN graph for a given multimodal data. To visualize cell embedding, we input the KNN graph to the RunUMAP function to compute the 2D representations of cells. For clustering and classification, the 20D representations of cells are computed by using RunUMAP. Both totalVI and MOFA+ compute the embedding of cells from the given RNA and protein data straightforwardly. We used the latest release of these methods and ran with the default parameters throughout the experiments in the article.</p>
      <table-wrap position="float" id="btad337-T2">
        <label>Table 2.</label>
        <caption>
          <p>Methods for single-cell multimodal analysis.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Method</th>
              <th rowspan="1" colspan="1">Methodology</th>
              <th rowspan="1" colspan="1">Language</th>
              <th rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Seurat</td>
              <td rowspan="1" colspan="1">Weighted nearest neighbor analysis</td>
              <td rowspan="1" colspan="1">R</td>
              <td rowspan="1" colspan="1">
                <xref rid="btad337-B4" ref-type="bibr">Hao <italic toggle="yes">et al.</italic> (2021)</xref>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">totalVI</td>
              <td rowspan="1" colspan="1">Deep generative model</td>
              <td rowspan="1" colspan="1">Python</td>
              <td rowspan="1" colspan="1">
                <xref rid="btad337-B3" ref-type="bibr">Gayoso <italic toggle="yes">et al.</italic> (2021)</xref>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MOFA+</td>
              <td rowspan="1" colspan="1">Factor analysis</td>
              <td rowspan="1" colspan="1">R</td>
              <td rowspan="1" colspan="1">
                <xref rid="btad337-B1" ref-type="bibr">Argelaguet <italic toggle="yes">et al.</italic> (2020)</xref>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 scME leverages the shared and complementary information to improve the embedding of single-cell multiomics</title>
      <p>First, we used the BMNC dataset to demonstrate the concepts introduced in the article and to show the improvements brought by scME. The embeddings generated by using the RNA modality and the protein modality separately were depicted in <xref rid="btad337-F2" ref-type="fig">Fig. 2A and B</xref>. The RNA and protein modalities could provide distinct relationships among cells. It was found that most cell types were separated in both two modalities. However, there existed a few cell types that could be detected in one modality but could not be detected in the other modality. For example, the cell type cDC2 was clearly separated from the cell types GMP and Prog_DC in the UMAP visualization of the RNA modality. Contrastingly, in the protein modality, cDC2 clustered with GMP and Prog_DC. Another example of complementary information regards the clustering of the cell types CD4 Memory, CD4 Naïve, and CD8 Naïve. These T-cell subtypes were difficult to be separated by using gene expression. But the expression of the surface proteins CD4 and CD8 were such considerably different that three T-cell subtypes were separated in the protein modality.</p>
      <fig position="float" id="btad337-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of scME model.</p>
        </caption>
        <graphic xlink:href="btad337f1" position="float"/>
      </fig>
      <fig position="float" id="btad337-F2">
        <label>Figure 2.</label>
        <caption>
          <p>UMAP visualization of human bone marrow dataset (BMNC). (A) UMAP visualization of the RNA modality. (B) UMAP visualization of the protein modality. (C–F) UMAP visualization of the low-dimensional representations generated by scME, totalVI, Seurat, and MOFA+. All figures annotated with the labels provided by data generators.</p>
        </caption>
        <graphic xlink:href="btad337f2" position="float"/>
      </fig>
      <p>We determined the proportion of the shared and complementary information in the BMNC dataset based on the cell–cell relationships using two different modalities. Separately for the RNA and protein modalities, we utilized the Leiden algorithm to determine the relationship between each pair of cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). If two cells are grouped into the same clusters in both modalities or are separated in both modalities, the pair is regarded as an instance of shared information. Otherwise, a pair of cells is considered to represent a single instance of complementary information. Approximately 10.5% of 470 370 456 cell pairs in BMNC were found to have inconsistent clustering relationships, indicating that the paired cells are grouped to the same clusters in one modality but to different clusters in the other modality. Consequently, it is expected that the combination of shared and complementary information will optimize the characterization of the differences among cells.</p>
      <p>We used UMAP to display the low-dimensional multimodal embedding results generated by scME, totalVI, Seurat, and MOFA+. Overall, scME provided a multimodal embedding, where distinct cell types were clearly separated away from each other (<xref rid="btad337-F2" ref-type="fig">Fig. 2C</xref>). In the multimodal embedding results of totalVI and MOFA+, it remained difficult to distinguish cDC2 from either GMP or Prog_DC (<xref rid="btad337-F2" ref-type="fig">Fig. 2D and E</xref>). We also found that scME improved the characterization of nuanced cell heterogeneity in both two modalities. For example, the differences between Naïve B cells and Memory B cells were subtle in the RNA modality (<xref rid="btad337-F2" ref-type="fig">Fig. 2A</xref>) as well as in the protein modality (<xref rid="btad337-F2" ref-type="fig">Fig. 2B</xref>). As shown in <xref rid="btad337-F2" ref-type="fig">Fig. 2C</xref>, scME could leverage the combination of different kinds of information of multiple modalities to enhance the separation of the B-cell subtypes, and eventually, to improve the identification of nuanced cell heterogeneity. In contrast, in the co-embedding results of totalVI, Seurat, and MOFA+, the B-cell subtypes with subtle molecular differences were difficult to be separated.</p>
      <p>scME revealed some tiny clusters that were not observed by other methods. Let’s consider CD4+ Memory T as an example. Compared with the result yielded by Seurat, scME divided the cells of CD4+ Memory T into one large cluster with the identity 3 and two tiny clusters recognized by the identities 22 and 24 (<xref rid="btad337-F3" ref-type="fig">Fig. 3A</xref>). We conducted differential expression analysis on three clusters for the RNA and protein modalities separately (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1 and S2</xref>). The expression levels of genes were not significantly different among three clusters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>). But several proteins were differentially expressed, including CD69 and CD25 (<xref rid="btad337-F3" ref-type="fig">Fig. 3B</xref>). This result demonstrates that scME is more effective to capture the cell-to-cell variability.</p>
      <fig position="float" id="btad337-F3">
        <label>Figure 3.</label>
        <caption>
          <p>scME reveals novel cell clusters. (A) The Seurat and scME-generated UMAPs of CD4+ naïve T cells. (B) Violin plot of differentially expressed proteins.</p>
        </caption>
        <graphic xlink:href="btad337f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 scME improves single-cell clustering</title>
      <p>The above results show that scME can generate the informative joint representation of multiple modalities. But it is uncertain whether the joint representation of multiple modalities can improve single-cell clustering. To validate this, we applied scME, totalVI, Seurat, and MOFA+ to obtain the low-dimensional multimodal embedding for the four datasets. Next, we ran the Leiden clustering algorithm on the multimodal embedding results. The accuracy of single-cell clustering was assessed with the ARI and NMI metrics. We performed single-cell clustering on the RNA and protein modalities individually to provide the evaluation baseline. We also involved a vanilla auto-encoder (AE) to provide a baseline for multimodal integration. Briefly, the data of two modalities were straightforwardly concatenated and input to the vanilla AE to compute the multimodal embedding. Totally, we conducted 20 replicate experiments and reported the average values. All the experimental results were given in <xref rid="btad337-T3" ref-type="table">Tables 3</xref> and <xref rid="btad337-T4" ref-type="table">4</xref>.</p>
      <table-wrap position="float" id="btad337-T3">
        <label>Table 3.</label>
        <caption>
          <p>ARI statistics of single-cell clustering.<sup>a</sup></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Method</th>
              <th align="center" rowspan="1" colspan="1">scME</th>
              <th align="center" rowspan="1" colspan="1">RNA</th>
              <th align="center" rowspan="1" colspan="1">Protein</th>
              <th align="center" rowspan="1" colspan="1">AE</th>
              <th align="center" rowspan="1" colspan="1">Seurat</th>
              <th align="center" rowspan="1" colspan="1">totalVI</th>
              <th align="center" rowspan="1" colspan="1">MOFA+</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">BMNC</td>
              <td rowspan="1" colspan="1">
                <bold>0.7371</bold>
              </td>
              <td rowspan="1" colspan="1">0.6596</td>
              <td rowspan="1" colspan="1">0.6233</td>
              <td rowspan="1" colspan="1">0.6875</td>
              <td rowspan="1" colspan="1">0.7366</td>
              <td rowspan="1" colspan="1">0.5433</td>
              <td rowspan="1" colspan="1">0.5598</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">BM2</td>
              <td rowspan="1" colspan="1">
                <bold>0.7914</bold>
              </td>
              <td rowspan="1" colspan="1">0.5452</td>
              <td rowspan="1" colspan="1">0.5484</td>
              <td rowspan="1" colspan="1">0.6374</td>
              <td rowspan="1" colspan="1">0.7741</td>
              <td rowspan="1" colspan="1">0.5908</td>
              <td rowspan="1" colspan="1">0.4953</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CBMC</td>
              <td rowspan="1" colspan="1">
                <bold>0.7742</bold>
              </td>
              <td rowspan="1" colspan="1">0.5829</td>
              <td rowspan="1" colspan="1">0.5142</td>
              <td rowspan="1" colspan="1">0.6819</td>
              <td rowspan="1" colspan="1">0.6916</td>
              <td rowspan="1" colspan="1">0.5596</td>
              <td rowspan="1" colspan="1">0.5446</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SLN</td>
              <td rowspan="1" colspan="1">0.7375</td>
              <td rowspan="1" colspan="1">0.4332</td>
              <td rowspan="1" colspan="1">0.6165</td>
              <td rowspan="1" colspan="1">0.5341</td>
              <td rowspan="1" colspan="1">
                <bold>0.7620</bold>
              </td>
              <td rowspan="1" colspan="1">0.4588</td>
              <td rowspan="1" colspan="1">0.5147</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <label>a</label>
            <p>The numbers in bold are the best performances.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="btad337-T4">
        <label>Table 4.</label>
        <caption>
          <p>NMI statistics of single-cell clustering.<sup>a</sup></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Method</th>
              <th align="center" rowspan="1" colspan="1">scME</th>
              <th align="center" rowspan="1" colspan="1">RNA</th>
              <th align="center" rowspan="1" colspan="1">Protein</th>
              <th align="center" rowspan="1" colspan="1">AE</th>
              <th align="center" rowspan="1" colspan="1">Seurat</th>
              <th align="center" rowspan="1" colspan="1">totalVI</th>
              <th align="center" rowspan="1" colspan="1">MOFA+</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">BMNC</td>
              <td rowspan="1" colspan="1">
                <bold>0.8605</bold>
              </td>
              <td rowspan="1" colspan="1">0.7301</td>
              <td rowspan="1" colspan="1">0.7847</td>
              <td rowspan="1" colspan="1">0.7931</td>
              <td rowspan="1" colspan="1">0.7973</td>
              <td rowspan="1" colspan="1">0.6789</td>
              <td rowspan="1" colspan="1">0.7722</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">BM2</td>
              <td rowspan="1" colspan="1">
                <bold>0.8893</bold>
              </td>
              <td rowspan="1" colspan="1">0.7208</td>
              <td rowspan="1" colspan="1">0.7648</td>
              <td rowspan="1" colspan="1">0.7685</td>
              <td rowspan="1" colspan="1">0.8610</td>
              <td rowspan="1" colspan="1">0.7909</td>
              <td rowspan="1" colspan="1">0.7537</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CBMC</td>
              <td rowspan="1" colspan="1">
                <bold>0.8406</bold>
              </td>
              <td rowspan="1" colspan="1">0.7111</td>
              <td rowspan="1" colspan="1">0.7936</td>
              <td rowspan="1" colspan="1">0.7183</td>
              <td rowspan="1" colspan="1">0.7380</td>
              <td rowspan="1" colspan="1">0.7566</td>
              <td rowspan="1" colspan="1">0.7153</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SLN</td>
              <td rowspan="1" colspan="1">
                <bold>0.8306</bold>
              </td>
              <td rowspan="1" colspan="1">0.6039</td>
              <td rowspan="1" colspan="1">0.7049</td>
              <td rowspan="1" colspan="1">0.6731</td>
              <td rowspan="1" colspan="1">0.7979</td>
              <td rowspan="1" colspan="1">0.6719</td>
              <td rowspan="1" colspan="1">0.6513</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn2">
            <label>a</label>
            <p>The numbers in bold are the best performances.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Both ARI and NMI statistics suggested that scME obtained several advantages. First, the integration of multimodal information improved single-cell clustering. For all four datasets, scME generated more accurate clustering results in comparison with those using the unimodal feature. For example, in the results of the CBMC dataset, the ARI metrics of the clustering based on the RNA modality and the protein modality are 0.5829 and 0.5142, respectively. These results implied that the differences among cells in the CBMC dataset were subtle either in the RNA or protein modalities. scME increased the ARI metric up to 0.8742. Second, scME can make effective use of both shared and complementary information to improve clustering. Interestingly, we found that the performances of totalVI and MOFA+ were worse than that of the vanilla AE. Taking the SLN dataset as an example, both ARI and NMI statistics showed that the vanilla AE outperformed totalVI and MOFA+. Both scME and Seurat relied on the combination of various multimodal information. As expected, the results of these two methods were better than that of the vanilla AE. Encouragingly, scME was superior to Seurat in almost all four datasets except the SLN dataset. Taken together, the above results implied that scME can effectively integrate two modalities and provide informative joint representations for clustering.</p>
    </sec>
    <sec>
      <title>3.3 scME improves cell-type classification</title>
      <p>Finally, we evaluated the accuracy of cell-type classification based on either the multimodal or unimodal embedding. For each embedding, a support vector machine was trained with the given cell embedding for predicting cell types. We evaluated the comparison methods by using the 5-fold cross-validation. The metrics of accuracy, precision, recall, F1, and MCC were reported in <xref rid="btad337-F4" ref-type="fig">Fig. 4</xref> and <xref rid="btad337-T5" ref-type="table">Table 5</xref>.</p>
      <fig position="float" id="btad337-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Results of the classification task. We conducted 5-fold cross-validation and computed the classification metrics including accuracy, precision, recall, F1, and MCC. Each row corresponds to the results of a dataset and each column corresponds to a metric.</p>
        </caption>
        <graphic xlink:href="btad337f4" position="float"/>
      </fig>
      <table-wrap position="float" id="btad337-T5">
        <label>Table 5.</label>
        <caption>
          <p>Performance evaluation of comparison methods on cell-type classification.<sup>a</sup></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Dataset</th>
              <th align="center" rowspan="1" colspan="1">Metric</th>
              <th align="center" rowspan="1" colspan="1">scME</th>
              <th align="center" rowspan="1" colspan="1">MOFA+</th>
              <th align="center" rowspan="1" colspan="1">totalVI</th>
              <th align="center" rowspan="1" colspan="1">Seurat</th>
              <th align="center" rowspan="1" colspan="1">AE</th>
              <th align="center" rowspan="1" colspan="1">RNA</th>
              <th align="center" rowspan="1" colspan="1">Protein</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">BMNC</td>
              <td rowspan="1" colspan="1">Accuracy</td>
              <td rowspan="1" colspan="1">
                <bold>0.9993</bold>
              </td>
              <td rowspan="1" colspan="1">0.9491</td>
              <td rowspan="1" colspan="1">0.9556</td>
              <td rowspan="1" colspan="1">0.9625</td>
              <td rowspan="1" colspan="1">0.9346</td>
              <td rowspan="1" colspan="1">0.8462</td>
              <td rowspan="1" colspan="1">0.9766</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Precision</td>
              <td rowspan="1" colspan="1">
                <bold>0.9993</bold>
              </td>
              <td rowspan="1" colspan="1">0.9491</td>
              <td rowspan="1" colspan="1">0.9556</td>
              <td rowspan="1" colspan="1">0.9625</td>
              <td rowspan="1" colspan="1">0.9346</td>
              <td rowspan="1" colspan="1">0.8462</td>
              <td rowspan="1" colspan="1">0.9766</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Recall</td>
              <td rowspan="1" colspan="1">
                <bold>0.9993</bold>
              </td>
              <td rowspan="1" colspan="1">0.9491</td>
              <td rowspan="1" colspan="1">0.9556</td>
              <td rowspan="1" colspan="1">0.9625</td>
              <td rowspan="1" colspan="1">0.9346</td>
              <td rowspan="1" colspan="1">0.8462</td>
              <td rowspan="1" colspan="1">0.9766</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">F1</td>
              <td rowspan="1" colspan="1">
                <bold>0.9939</bold>
              </td>
              <td rowspan="1" colspan="1">0.8142</td>
              <td rowspan="1" colspan="1">0.8395</td>
              <td rowspan="1" colspan="1">0.8863</td>
              <td rowspan="1" colspan="1">0.7562</td>
              <td rowspan="1" colspan="1">0.7027</td>
              <td rowspan="1" colspan="1">0.9434</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">MCC</td>
              <td rowspan="1" colspan="1">
                <bold>0.9992</bold>
              </td>
              <td rowspan="1" colspan="1">0.9424</td>
              <td rowspan="1" colspan="1">0.9497</td>
              <td rowspan="1" colspan="1">0.9575</td>
              <td rowspan="1" colspan="1">0.9258</td>
              <td rowspan="1" colspan="1">0.8256</td>
              <td rowspan="1" colspan="1">0.9735</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">BM2</td>
              <td rowspan="1" colspan="1">Accuracy</td>
              <td rowspan="1" colspan="1">
                <bold>0.9043</bold>
              </td>
              <td rowspan="1" colspan="1">0.8550</td>
              <td rowspan="1" colspan="1">0.8699</td>
              <td rowspan="1" colspan="1">0.6583</td>
              <td rowspan="1" colspan="1">0.8853</td>
              <td rowspan="1" colspan="1">0.5451</td>
              <td rowspan="1" colspan="1">0.7615</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Precision</td>
              <td rowspan="1" colspan="1">
                <bold>0.9043</bold>
              </td>
              <td rowspan="1" colspan="1">0.8550</td>
              <td rowspan="1" colspan="1">0.8699</td>
              <td rowspan="1" colspan="1">0.6583</td>
              <td rowspan="1" colspan="1">0.8853</td>
              <td rowspan="1" colspan="1">0.5451</td>
              <td rowspan="1" colspan="1">0.7615</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Recall</td>
              <td rowspan="1" colspan="1">
                <bold>0.9043</bold>
              </td>
              <td rowspan="1" colspan="1">0.8550</td>
              <td rowspan="1" colspan="1">0.8699</td>
              <td rowspan="1" colspan="1">0.6583</td>
              <td rowspan="1" colspan="1">0.8853</td>
              <td rowspan="1" colspan="1">0.5451</td>
              <td rowspan="1" colspan="1">0.7615</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">F1</td>
              <td rowspan="1" colspan="1">0.7459</td>
              <td rowspan="1" colspan="1">0.6337</td>
              <td rowspan="1" colspan="1">0.6888</td>
              <td rowspan="1" colspan="1">0.4040</td>
              <td rowspan="1" colspan="1">
                <bold>0.7630</bold>
              </td>
              <td rowspan="1" colspan="1">0.2409</td>
              <td rowspan="1" colspan="1">0.4524</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">MCC</td>
              <td rowspan="1" colspan="1">
                <bold>0.8936</bold>
              </td>
              <td rowspan="1" colspan="1">0.8413</td>
              <td rowspan="1" colspan="1">0.8572</td>
              <td rowspan="1" colspan="1">0.6087</td>
              <td rowspan="1" colspan="1">0.8747</td>
              <td rowspan="1" colspan="1">0.5305</td>
              <td rowspan="1" colspan="1">0.7359</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CBMC</td>
              <td rowspan="1" colspan="1">Accuracy</td>
              <td rowspan="1" colspan="1">
                <bold>0.9052</bold>
              </td>
              <td rowspan="1" colspan="1">0.8700</td>
              <td rowspan="1" colspan="1">0.8886</td>
              <td rowspan="1" colspan="1">0.8059</td>
              <td rowspan="1" colspan="1">0.8240</td>
              <td rowspan="1" colspan="1">0.8982</td>
              <td rowspan="1" colspan="1">0.7125</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Precision</td>
              <td rowspan="1" colspan="1">
                <bold>0.9052</bold>
              </td>
              <td rowspan="1" colspan="1">0.8700</td>
              <td rowspan="1" colspan="1">0.8886</td>
              <td rowspan="1" colspan="1">0.8059</td>
              <td rowspan="1" colspan="1">0.8240</td>
              <td rowspan="1" colspan="1">0.8982</td>
              <td rowspan="1" colspan="1">0.7125</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Recall</td>
              <td rowspan="1" colspan="1">
                <bold>0.9052</bold>
              </td>
              <td rowspan="1" colspan="1">0.8700</td>
              <td rowspan="1" colspan="1">0.8886</td>
              <td rowspan="1" colspan="1">0.8059</td>
              <td rowspan="1" colspan="1">0.8240</td>
              <td rowspan="1" colspan="1">0.8982</td>
              <td rowspan="1" colspan="1">0.7125</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">F1</td>
              <td rowspan="1" colspan="1">0.8967</td>
              <td rowspan="1" colspan="1">0.8891</td>
              <td rowspan="1" colspan="1">
                <bold>0.8987</bold>
              </td>
              <td rowspan="1" colspan="1">0.7015</td>
              <td rowspan="1" colspan="1">0.7490</td>
              <td rowspan="1" colspan="1">0.8815</td>
              <td rowspan="1" colspan="1">0.3637</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">MCC</td>
              <td rowspan="1" colspan="1">
                <bold>0.8868</bold>
              </td>
              <td rowspan="1" colspan="1">0.8455</td>
              <td rowspan="1" colspan="1">0.8692</td>
              <td rowspan="1" colspan="1">0.7757</td>
              <td rowspan="1" colspan="1">0.7903</td>
              <td rowspan="1" colspan="1">0.8783</td>
              <td rowspan="1" colspan="1">0.6708</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SLN</td>
              <td rowspan="1" colspan="1">Accuracy</td>
              <td rowspan="1" colspan="1">0.8588</td>
              <td rowspan="1" colspan="1">0.7868</td>
              <td rowspan="1" colspan="1">
                <bold>0.9067</bold>
              </td>
              <td rowspan="1" colspan="1">0.8139</td>
              <td rowspan="1" colspan="1">0.8159</td>
              <td rowspan="1" colspan="1">0.6921</td>
              <td rowspan="1" colspan="1">0.7666</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Precision</td>
              <td rowspan="1" colspan="1">0.8588</td>
              <td rowspan="1" colspan="1">0.7868</td>
              <td rowspan="1" colspan="1">
                <bold>0.9067</bold>
              </td>
              <td rowspan="1" colspan="1">0.8139</td>
              <td rowspan="1" colspan="1">0.8159</td>
              <td rowspan="1" colspan="1">0.6921</td>
              <td rowspan="1" colspan="1">0.7666</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Recall</td>
              <td rowspan="1" colspan="1">0.8588</td>
              <td rowspan="1" colspan="1">0.7868</td>
              <td rowspan="1" colspan="1">
                <bold>0.9067</bold>
              </td>
              <td rowspan="1" colspan="1">0.8139</td>
              <td rowspan="1" colspan="1">0.8159</td>
              <td rowspan="1" colspan="1">0.6921</td>
              <td rowspan="1" colspan="1">0.7666</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">F1</td>
              <td rowspan="1" colspan="1">0.7603</td>
              <td rowspan="1" colspan="1">0.6079</td>
              <td rowspan="1" colspan="1">
                <bold>0.8732</bold>
              </td>
              <td rowspan="1" colspan="1">0.5443</td>
              <td rowspan="1" colspan="1">0.6550</td>
              <td rowspan="1" colspan="1">0.4513</td>
              <td rowspan="1" colspan="1">0.5407</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">MCC</td>
              <td rowspan="1" colspan="1">0.8341</td>
              <td rowspan="1" colspan="1">0.7489</td>
              <td rowspan="1" colspan="1">
                <bold>0.8907</bold>
              </td>
              <td rowspan="1" colspan="1">0.7810</td>
              <td rowspan="1" colspan="1">0.7835</td>
              <td rowspan="1" colspan="1">0.6326</td>
              <td rowspan="1" colspan="1">0.7240</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn3">
            <label>a</label>
            <p>The numbers in bold are the best performances.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Overall, the results prove that scME outperformed other methods. First, scME extracted useful features from two modality data to improve the discrimination of cell types. It is noticed that the unimodal embedding, either RNA or protein, generated the worst cell-type classification results for most of the benchmarking datasets. It is interesting that the accuracy of Seurat’s multimodal embedding was worse than that of the unimodal embedding in the cases of BM2 and CBMC. As demonstrated by the results of MOFA+ and totalVI, shared information generated the robust and accurate cell-type predictions in most benchmarking datasets. Encouragingly, the combination of complementary information with shared information indeed improved the cell-type classification. scME achieved better classification results than the other methods in all metrics. We also calculated receiver operating characteristic (ROC) curves and precision–recall (P-R) curves. As can be seen from the ROC and P-R curves (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S7 and S8</xref>), our method performs better than other models.</p>
      <p>Second, scME improved the discrimination of rare cell types. It is noticed that for all benchmarking datasets, the F1 score was usually worse than the classification accuracy for all methods. Because the F1 score is defined by averaging F1 scores over cell types, this phenomenon implied that rare cell types impacted the classification accuracy. Among the comparison methods, the F1 scores of MOFA+ and totalVI declined significantly. For example, the F1 scores of MOFA+ were as low as 0.6337 and 0.6079 for the BM2 and SLN datasets, respectively. Rare cell types also impacted the accuracy of scME, but the influences were the least for most benchmarking datasets. It implied that the combination of the shared and complementary information can help the classification of rare cell types.</p>
    </sec>
    <sec>
      <title>3.4 Clustering method and hyperparameter selection</title>
      <p>Our algorithm relies on clustering to determine the shared and complementary information between modalities. Hence, the parameters of a clustering algorithm, such as resolution of the Leiden algorithm, could affect the efficacy of our algorithm. To give a reference assisting the determination of the resolution parameter of the Leiden algorithm, we assessed the impacts of a variety of resolutions by using the four datasets. The resolution of the Leiden algorithm was progressively increased from 0.1 to 5. Both ARI and NMI were calculated to evaluate the performance. Intriguingly, a common phenomenon was obtained that the resolution of 1 generated the best results for the four datasets (<xref rid="btad337-F5" ref-type="fig">Fig. 5</xref>). We also compared the impacts of different clustering algorithms, including the Leiden algorithm, the KMeans algorithm, and the DBSCAN algorithm, on the performance of our method. The results demonstrate that the Leiden algorithm is more compatible with our method (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>).</p>
      <fig position="float" id="btad337-F5">
        <label>Figure 5.</label>
        <caption>
          <p>Performance of scME when using different resolution parameters of the Leiden algorithm.</p>
        </caption>
        <graphic xlink:href="btad337f5" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>As single-cell multiomics advance, it is urgently needed that a method can utilize the information from different modalities to maximize the dissection of cell heterogeneity. In this article, we presented a dual-modality factor model based on deep neural networks for the extraction of shared information and complementary information across various modalities. We have conducted a series of experiments and showed that combining shared and complementary information can significantly improve the joint embedding of multiple modalities. Moreover, the resultant multimodal embedding provides salient information that can dramatically improve both single-cell clustering and cell-type classification. Along with the development of single-cell multiomics, more and more single-cell modality datasets will be generated for the solution of a variety of biological and medical questions. The concept and the method of factorization proposed in this article will impact these single-cell multiomics studies. The conceptual framework of the factorization and combination of the RNA and protein modalities in CITE-seq can be extended to deal with various modalities. In the future, we will take efforts to generalize the proposed deep neural network-based factor model to involve more multimodal information for the exploration of cell heterogeneity and complex regulatory networks underlying the precise control of cell fate decisions and function.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad337_Supplementary_Data</label>
      <media xlink:href="btad337_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank the anonymous reviewers for their insightful comments.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>The authors declare no competing interests.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was partly supported by the Natural Science Foundation of Fujian Province, China [2019J01041].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All datasets analyzed in this article are publicly available as listed in <xref rid="btad337-T1" ref-type="table">Table 1</xref>. The code is public for academic use and available on the GitHub site (<ext-link xlink:href="https://github.com/bucky527/scME" ext-link-type="uri">https://github.com/bucky527/scME</ext-link>).</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad337-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Argelaguet</surname><given-names>R</given-names></string-name>, <string-name><surname>Arnol</surname><given-names>D</given-names></string-name>, <string-name><surname>Bredikhin</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>MOFA+: a statistical framework for comprehensive integration of multi-modal single-cell data</article-title>. <source>Genome Biol</source><year>2020</year>;<volume>21</volume>:<fpage>17</fpage>.<pub-id pub-id-type="pmid">31969180</pub-id></mixed-citation>
    </ref>
    <ref id="btad337-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>A</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P</given-names></string-name>, <string-name><surname>Smibert</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>36</volume>:<fpage>411</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="btad337-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gayoso</surname><given-names>A</given-names></string-name>, <string-name><surname>Steier</surname><given-names>Z</given-names></string-name>, <string-name><surname>Lopez</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Joint probabilistic modeling of single-cell multi-omic data with totalVI</article-title>. <source>Nat Methods</source><year>2021</year>;<volume>18</volume>:<fpage>272</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">33589839</pub-id></mixed-citation>
    </ref>
    <ref id="btad337-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Hao</surname><given-names>S</given-names></string-name>, <string-name><surname>Andersen-Nissen</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Integrated analysis of multimodal single-cell data</article-title>. <source>Cell</source><year>2021</year>;<volume>184</volume>:<fpage>3573</fpage>–<lpage>87.e29</lpage>.<pub-id pub-id-type="pmid">34062119</pub-id></mixed-citation>
    </ref>
    <ref id="btad337-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hoffman</surname><given-names>MD</given-names></string-name>, <string-name><surname>Blei</surname><given-names>DM</given-names></string-name>, <string-name><surname>Wang</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Stochastic variational inference</article-title>. <source>J Mach Learn Res</source><year>2013</year>;<volume>14</volume>:<fpage>1303</fpage>–<lpage>1347</lpage>.</mixed-citation>
    </ref>
    <ref id="btad337-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hwang</surname><given-names>B</given-names></string-name>, <string-name><surname>Lee</surname><given-names>JH</given-names></string-name>, <string-name><surname>Bang</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell RNA sequencing technologies and bioinformatics pipelines</article-title>. <source>Exp Mol Med</source><year>2018</year>;<volume>50</volume>:<fpage>1</fpage>–<lpage>14</lpage>.</mixed-citation>
    </ref>
    <ref id="btad337-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>H</given-names></string-name>, <string-name><surname>Mnih</surname><given-names>A.</given-names></string-name></person-group> Disentangling by factorising. In: <italic toggle="yes">International Conference on Machine Learning</italic>, Stockholmsmässan, Stockholm SWEDEN. <year>2018</year>, <fpage>2649</fpage>–<lpage>58</lpage>.</mixed-citation>
    </ref>
    <ref id="btad337-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Kingma</surname><given-names>DP</given-names></string-name>, <string-name><surname>Welling</surname><given-names>M.</given-names></string-name></person-group> Auto-encoding variational bayes. In: <italic toggle="yes">International Conference on Learning Representations (ICLR)</italic>. 2014, pp. 1–14.</mixed-citation>
    </ref>
    <ref id="btad337-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Linderman</surname><given-names>GC</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>J</given-names></string-name>, <string-name><surname>Roulis</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Zero-preserving imputation of single-cell RNA-seq data</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>11</fpage>.<pub-id pub-id-type="pmid">35013180</pub-id></mixed-citation>
    </ref>
    <ref id="btad337-B10">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>KZ</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>NR.</given-names></string-name></person-group> Quantifying common and distinct information in single-cell multimodal data with Tilted-CCA. <italic toggle="yes">bioRxiv</italic>, <year>2022</year>, preprint: not peer reviewed. <pub-id pub-id-type="doi">10.1101/2022.10.07.511320</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad337-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Luecken</surname><given-names>MD</given-names></string-name></person-group>, Burkhardt DB, Cannoodt R <etal>et al</etal> A sandbox for prediction and integration of DNA, RNA, and proteins in single cells. In: <italic toggle="yes">Thirty-fifth Conference on Neural Information Processing Systems Datasets and Benchmarks Track (Round 2)</italic>. <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="btad337-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>S</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>B</given-names></string-name>, <string-name><surname>LaFave</surname><given-names>LM</given-names></string-name></person-group><etal>et al</etal><article-title>Chromatin potential identified by shared single-cell profiling of RNA and chromatin</article-title>. <source>Cell</source><year>2020</year>;<volume>183</volume>:<fpage>1103</fpage>–<lpage>16.e20</lpage>.<pub-id pub-id-type="pmid">33098772</pub-id></mixed-citation>
    </ref>
    <ref id="btad337-B13">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>McInnes</surname><given-names>L</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J</given-names></string-name>, <string-name><surname>Melville</surname><given-names>J.</given-names></string-name></person-group> Umap: Uniform manifold approximation and projection for dimension reduction. <italic toggle="yes">arXiv, arXiv:1802.03426</italic>, <year>2018</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad337-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paige</surname><given-names>B</given-names></string-name>, <string-name><surname>van de Meent</surname><given-names>JW</given-names></string-name>, <string-name><surname>Desmaison</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Learning disentangled representations with semi-supervised deep generative models</article-title>. <source>Adv Neural Inf Process Syst</source><year>2017</year>;<volume>30</volume>.</mixed-citation>
    </ref>
    <ref id="btad337-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satpathy</surname><given-names>AT</given-names></string-name>, <string-name><surname>Granja</surname><given-names>JM</given-names></string-name>, <string-name><surname>Yost</surname><given-names>KE</given-names></string-name></person-group><etal>et al</etal><article-title>Massively parallel single-cell chromatin landscapes of human immune cell development and intratumoral T cell exhaustion</article-title>. <source>Nat Biotechnol</source><year>2019</year>;<volume>37</volume>:<fpage>925</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">31375813</pub-id></mixed-citation>
    </ref>
    <ref id="btad337-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stoeckius</surname><given-names>M</given-names></string-name>, <string-name><surname>Hafemeister</surname><given-names>C</given-names></string-name>, <string-name><surname>Stephenson</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title>. <source>Nat Methods</source><year>2017</year>;<volume>14</volume>:<fpage>865</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">28759029</pub-id></mixed-citation>
    </ref>
    <ref id="btad337-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>T</given-names></string-name>, <string-name><surname>Butler</surname><given-names>A</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Comprehensive integration of single-cell data</article-title>. <source>Cell</source><year>2019</year>;<volume>177</volume>:<fpage>1888</fpage>–<lpage>902.e21</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="btad337-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Traag</surname><given-names>VA</given-names></string-name>, <string-name><surname>Waltman</surname><given-names>L</given-names></string-name>, <string-name><surname>van Eck</surname><given-names>NJ</given-names></string-name></person-group><etal>et al</etal><article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title>. <source>Sci Rep</source><year>2019</year>;<volume>9</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">30626917</pub-id></mixed-citation>
    </ref>
    <ref id="btad337-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>GXY</given-names></string-name>, <string-name><surname>Terry</surname><given-names>JM</given-names></string-name>, <string-name><surname>Belgrader</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat Commun</source><year>2017</year>;<volume>8</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">28232747</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
