<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">nargab</journal-id>
    <journal-title-group>
      <journal-title>NAR Genomics and Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2631-9268</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10689045</article-id>
    <article-id pub-id-type="pmid">38046273</article-id>
    <article-id pub-id-type="doi">10.1093/nargab/lqad105</article-id>
    <article-id pub-id-type="publisher-id">lqad105</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00030</subject>
        <subject>AcademicSubjects/SCI00980</subject>
        <subject>AcademicSubjects/SCI01060</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Pipelines and Workflows for Biological Data Analysis</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scPipe: an extended preprocessing pipeline for comprehensive single-cell ATAC-Seq data integration in R/Bioconductor</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2229-8106</contrib-id>
        <name>
          <surname>Amarasinghe</surname>
          <given-names>Shanika L</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
        <aff><institution>The Australian Regenerative Medicine Institute, Monash University</institution>, Clayton, Victoria, 3800, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Phil</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Voogd</surname>
          <given-names>Oliver</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Haoyu</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Du</surname>
          <given-names>Mei R M</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Su</surname>
          <given-names>Shian</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brown</surname>
          <given-names>Daniel V</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Department of Medical Biology, The University of Melbourne</institution>, Parkville, Victoria, 3010, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jabbari</surname>
          <given-names>Jafar S</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Department of Medical Biology, The University of Melbourne</institution>, Parkville, Victoria, 3010, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bowden</surname>
          <given-names>Rory</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Department of Medical Biology, The University of Melbourne</institution>, Parkville, Victoria, 3010, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7383-0609</contrib-id>
        <name>
          <surname>Ritchie</surname>
          <given-names>Matthew E</given-names>
        </name>
        <!--mritchie@wehi.edu.au-->
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Department of Medical Biology, The University of Melbourne</institution>, Parkville, Victoria, 3010, <country country="AU">Australia</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +61 3 9345 2856; Fax: +61 3 9347 0852; Email: <email>mritchie@wehi.edu.au</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-30">
      <day>30</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>5</volume>
    <issue>4</issue>
    <elocation-id>lqad105</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of NAR Genomics and Bioinformatics.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="lqad105.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p><monospace>scPipe</monospace> is a flexible R/Bioconductor package originally developed to analyse platform-independent single-cell RNA-Seq data. To expand its preprocessing capability to accommodate new single-cell technologies, we further developed <monospace>scPipe</monospace> to handle single-cell ATAC-Seq and multi-modal (RNA-Seq and ATAC-Seq) data. After executing multiple data cleaning steps to remove duplicated reads, low abundance features and cells of poor quality, a <italic toggle="yes">SingleCellExperiment</italic> object is created that contains a sparse count matrix with features of interest in the rows and cells in the columns. Quality control information (e.g. counts per cell, features per cell, total number of fragments, fraction of fragments per peak) and any relevant feature annotations are stored as metadata. We demonstrate that <monospace>scPipe</monospace> can efficiently identify ‘true’ cells and provides flexibility for the user to fine-tune the quality control thresholds using various feature and cell-based metrics collected during data preprocessing. Researchers can then take advantage of various downstream single-cell tools available in Bioconductor for further analysis of scATAC-Seq data such as dimensionality reduction, clustering, motif enrichment, differential accessibility and cis-regulatory network analysis. The <monospace>scPipe</monospace> package enables a complete beginning-to-end pipeline for single-cell ATAC-Seq and RNA-Seq data analysis in R.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Australian Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000923</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>200102903</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Health and Medical Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000925</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2017257</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Chan Zuckerberg Initiative</institution>
            <institution-id institution-id-type="DOI">10.13039/100014989</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2019-002443</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>Introduction</title>
    <p>Single-cell sequencing technology has undergone rapid development in the past decade to allow researchers to study cellular heterogeneity across multiple omic modalities, including the transcriptome, epigenome and proteome. Single Cell Assay for Transposase Accessible Chromatin Sequencing (scATAC-Seq), is a relatively recent approach for profiling chromatin accessibility at single-cell resolution (<xref rid="B1" ref-type="bibr">1</xref>) that has been widely used to define chromatin state across cell types, discover cis- and trans- regulatory regions, identify master regulators, and characterise gene regulatory networks (<xref rid="B2" ref-type="bibr">2</xref>).</p>
    <p>The four main protocols for scATAC-Seq include the combinatorial indexing approach (sci-ATAC-Seq) (<xref rid="B3" ref-type="bibr">3</xref>), microfluidics-based methods (scATAC-Seq) (<xref rid="B1" ref-type="bibr">1</xref>), nano-well based protocols (μscATAC-Seq) (<xref rid="B4" ref-type="bibr">4</xref>) and droplet-based (10X scATAC-Seq, dscATAC-Seq and dsciATAC-seq) approaches (<xref rid="B5" ref-type="bibr">5</xref>,<xref rid="B6" ref-type="bibr">6</xref>).</p>
    <p>The general workflow for scATAC-Seq data analysis comprises of (i) preprocessing: demultiplexing, adaptor trimming, read mapping, quality control, cell calling and multiplet removal <italic toggle="yes">(optional)</italic>; (ii) feature matrix construction: defining regions via peak calling or genome binning, counting defined features, transformation and dimensionality reduction and (iii) downstream analysis: cell clustering, secondary peak calling, visualisation, differential accessibility analysis and <italic toggle="yes">cis</italic>-regulatory network analysis (<xref rid="B7" ref-type="bibr">7</xref>,<xref rid="B8" ref-type="bibr">8</xref>).</p>
    <p>The growing popularity of scATAC-Seq technology warrants the development of analysis tools that can preprocess this type of data efficiently and effectively. There are currently 14 tools that can preprocess scATAC-Seq data that are summarised in Table <xref rid="tbl1" ref-type="table">1</xref>. Some are written in R (i.e. <monospace>ArchR</monospace>, <monospace>BROCKMAN</monospace>, <monospace>ChromSCape</monospace>, <monospace>chromVAR</monospace>, <monospace>Destin</monospace>, <monospace>scABC</monospace>, <monospace>SCRAT</monospace>, <monospace>Snaptools</monospace>) while others are Python and Shell based. Furthermore, the feature matrix construction step varies amongst these tools where some of them use bulk peak calls, TSS regions, <italic toggle="yes">k</italic>-mers, or a genome binning approach. It has been shown previously that out of these, a genome binning approach is more sensitive to the detection of rare open chromatin regions present in a sub-population of cells (<xref rid="B9" ref-type="bibr">9</xref>).</p>
    <table-wrap position="float" id="tbl1">
      <label>Table 1.</label>
      <caption>
        <p>Summary of current packages available for scATAC-Seq data preprocessing</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Method / tool name</th>
            <th rowspan="1" colspan="1">Year</th>
            <th rowspan="1" colspan="1">Language</th>
            <th rowspan="1" colspan="1">Input</th>
            <th rowspan="1" colspan="1">Multiple</th>
            <th rowspan="1" colspan="1">Feature matrix</th>
          </tr>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1">Technologies?</th>
            <th rowspan="1" colspan="1">Construction method</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>APEC</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">Python</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">FASTQ</italic>, matrix + peaks</td>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <tex-math id="M0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\checkmark$\end{document}</tex-math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>ArchR</monospace>
            </td>
            <td rowspan="1" colspan="1">2020</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">BAM</italic>, fragments</td>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <tex-math id="M0001a" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\checkmark$\end{document}</tex-math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">Bin</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>BROCKMAN</monospace>
            </td>
            <td rowspan="1" colspan="1">2018</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">FASTQ</italic>
            </td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">k</italic>-mer</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>Cell Ranger ATAC</monospace>
            </td>
            <td rowspan="1" colspan="1">2018</td>
            <td rowspan="1" colspan="1">Command line</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">FASTQ</italic>
            </td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>ChromSCape</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">R Shiny</td>
            <td rowspan="1" colspan="1">Various</td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Bin, Peak, TSS</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>chromVAR</monospace>
            </td>
            <td rowspan="1" colspan="1">2017</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">BAM</italic> + peaks</td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Motif, <italic toggle="yes">k</italic>-mer</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Cusanovich <italic toggle="yes">et al.</italic> 2018</td>
            <td rowspan="1" colspan="1">2015</td>
            <td rowspan="1" colspan="1">Scripts</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">BAM</italic>
            </td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>Destin</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">FASTQ</italic>, <italic toggle="yes">BAM</italic> + peaks</td>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <tex-math id="M0002" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\checkmark$\end{document}</tex-math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>Gene scoring</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">Scripts</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">FASTQ</italic>
            </td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">TSS</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>scABC</monospace>
            </td>
            <td rowspan="1" colspan="1">2018</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">FASTQ</italic>
            </td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>scasat</monospace>
            </td>
            <td rowspan="1" colspan="1">2018</td>
            <td rowspan="1" colspan="1">JupyterNotebook</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">BAM</italic>s</td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>scATAC-pro</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">Command line</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">FASTQ</italic>, various</td>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <tex-math id="M0003" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\checkmark$\end{document}</tex-math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>SCRAT</monospace>
            </td>
            <td rowspan="1" colspan="1">2017</td>
            <td rowspan="1" colspan="1">R,WEB</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">BAM</italic>s</td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Various</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>Snaptool</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">Python</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">FASTQ</italic>
            </td>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <tex-math id="M0004" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\checkmark$\end{document}</tex-math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">Bin, Peak</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>A current limitation of these tools is that most cannot handle data from multiple technologies (i.e. droplet-based and plate-based) or they require the use of specific data structures that have limited compatibility with current well-known, light-weight, single-cell data structures such as <italic toggle="yes">SingleCellExperiment</italic> objects (<italic toggle="yes">SCEs</italic>) in R/Bioconductor.</p>
    <p>In this study, we extend <monospace>scPipe</monospace> (<xref rid="B10" ref-type="bibr">10</xref>) to enable handling of scATAC-Seq data and generation of <italic toggle="yes">SCE</italic> objects that can be manipulated using various <italic toggle="yes">SCE</italic>-friendly downstream analysis tools available in R/Bioconductor (<xref rid="B11" ref-type="bibr">11</xref>). An <italic toggle="yes">SCE</italic> container, most popular for scRNA-Seq data storage, can easily be used to store scATAC-Seq data due to its flexibility (i.e., rows representing features (genomic regions) and columns representing cells). <monospace>scPipe</monospace> is able to take scATAC-Seq reads (<italic toggle="yes">FASTQ</italic> format) as input, which are demultiplexed (if needed) and filtered based on quality and Ns (i.e. non-called bases), aligned to the reference genome and filtered based on various quality metrics such as mapping rate, fraction of reads mapping to the mitochondrial genes and the number of duplicate or high-quality reads. Cleaned up data will then be used to conduct cell calling and optionally peak calling, to generate the final feature by cell sparse matrix which is stored as a <italic toggle="yes">SCE</italic> object. These improvements also allow <monospace>scPipe</monospace> to be used for multiome projects that collect both scRNA-Seq and scATAC-Seq on the same cells.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>Materials and methods</title>
    <sec id="SEC2-1">
      <title>Architecture of the <monospace>scPipe</monospace> scATAC-Seq module</title>
      <p><monospace>scPipe</monospace> was developed using the R (<xref rid="B12" ref-type="bibr">12</xref>) / Bioconductor (<xref rid="B13" ref-type="bibr">13</xref>) platform, with the underlying code written in C++, R and Python with the <monospace>Rcpp</monospace> (<xref rid="B14" ref-type="bibr">14</xref>) and <monospace>reticulate</monospace> (<xref rid="B15" ref-type="bibr">15</xref>) packages used to wrap the C++ and Python code for R, respectively. Data from both UMI (Unique Molecular Identifiers) and non-UMI protocols can be handled by <monospace>scPipe</monospace>. The pipeline for scATAC-Seq data preprocessing is initiated with <italic toggle="yes">FASTQ</italic> files and outputs include a feature count matrix and a variety of quality control (QC) statistics and a standalone HTML report generated using <monospace>rmarkdown</monospace> (<xref rid="B16" ref-type="bibr">16</xref>) that contains a summary of the QC statistics collected during data preprocessing.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Demultiplexing and read alignment</title>
      <p>Demultiplexing is performed by the <italic toggle="yes">sc_atac_trim_barcode()</italic> function (Figure <xref rid="F1" ref-type="fig">1A</xref>) using a similar approach to that used in <monospace>scPipe</monospace> for scRNA-Seq analysis. The scATAC-Seq module can accommodate data in .<italic toggle="yes">fastq</italic> format as well as .<italic toggle="yes">csv</italic> format, with the user defining which format the data is in and the relevant demultiplexing strategy will be executed. In brief, the barcode is either extracted from the reads themselves based on the entries in a <italic toggle="yes">csv</italic> file where the second column of the file contains the barcodes or from the sequences of a complementary <italic toggle="yes">FASTQ</italic> file and appended to the read names in the <italic toggle="yes">FASTQ</italic> files containing the ATAC sequences.</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of the <monospace>scPipe</monospace> scATAC-Seq module and its QC outputs. <bold>(A)</bold> The pipeline is shown on the left and the QC metrics gathered during preprocessing are shown on the right. Purple coloured boxes denote the inputs and light colour purple define the inputs that are optionally accepted as they are not incorporated into current scATAC-Seq library preparations yet. Blue colour box depicts the final output. Black boxes denote the main pipeline steps that should be followed. Green boxes denote the steps that are running within these the main pipeline without having to call them specifically, still can also be called separately if needed. <bold>(B)</bold> QC plot showing the separation of ‘cell’ and ‘non-cell’ based on the fraction of fragments overlappping peaks (y-axis) vs total number of fragments (x-axis) after cell calling step of scPipe. <bold>(C)</bold> QC plot showing the separation of cell and ‘non-cell’ based on read density (y-axis) versus total number of fragments (x-axis) after cell calling step of scPipe. <bold>(D)</bold> QC plot showing the fraction of features overlapping different functional regions (i.e., Peaks, TSS, Promoter, Enhancer, Mitochondrial genes).</p>
        </caption>
        <graphic xlink:href="lqad105fig1" position="float"/>
      </fig>
      <p>A read correction step is incorporated to ensure sequencing errors that appear in barcodes are identified and removed to avoid unwanted data loss. In summary, after the barcodes are determined, error correction is carried out with a hamming distance of 1 to correct for sequencing errors. Each barcode can be optionally validated against a known list of valid barcodes (either as is or the reverse complement) and the frequency of each valid barcode is then counted. <monospace>scPipe</monospace> corrects barcodes that are not matched to the valid barcode list by allowing for one mismatched base in comparison with the valid barcode list, and counting the number of corrected barcodes in the complete dataset. In the case that multiple sequences are found matching the valid barcode list with one mismatched base, each mismatched base’s quality (Q) score is compared and the sequence with the lowest <italic toggle="yes">Q</italic> score at the mismatch position is considered valid.</p>
      <p>Demultiplexed data is stored in four data files; i.e. complete-match: no error correction was necessary for the data in this file; partial-match: error-corrected reads; no-match: data that were unable to be demultiplexed even after error correction; and full-data: a concatenated version of the data across the 3 aforementioned categories. The user is able to select either one of the more stringent files or the complete dataset for downstream analysis (by default, the complete dataset is used).</p>
      <p>Read alignment is run with the function <italic toggle="yes">sc_aligning()</italic> which uses <italic toggle="yes">Rsubread::align()</italic> (<xref rid="B17" ref-type="bibr">17</xref>) internally (Figure <xref rid="F1" ref-type="fig">1A</xref>). The user has to define the technology (i.e. RNA or ATAC) to execute the most appropriate alignment approach (i.e. single-end alignment for RNA and paired-end for ATAC). The resulting <italic toggle="yes">BAM</italic> file contains the read name in the first column, and unmapped reads are denoted by an asterisk (*).</p>
    </sec>
    <sec id="SEC2-3">
      <title>Demultiplexing aligned reads, removing duplicates, creating fragments and peak calling</title>
      <p>Demultiplexing aligned reads is performed by the <italic toggle="yes">sc_atac_bam_tagging()</italic> function which extracts the barcode information from the read names of the aligned <italic toggle="yes">BAM</italic> file and generates a new column with the tag CB:z: to record the cell barcode (Figure <xref rid="F1" ref-type="fig">1A</xref>). As some reads may not have an assigned barcode, this column in the resulting demultiplexed <italic toggle="yes">BAM</italic> file may be empty in such positions.</p>
      <p>The main difference in the scATAC-Seq module compared to original scRNA-Seq module is the need to extract biological information from both reads in the former. Therefore, it was important to retain both reads (i.e. forward and reverse) for scATAC-Seq data as compared to retaining only the forward of the pair of reads for scRNA-Seq module where reverse will be the barcode followed by the polyA tail, which can be discarded after demultiplexing of the read takes place.</p>
      <p>Removal of duplicate reads uses <monospace>samtools</monospace>, where the <italic toggle="yes">BAM</italic> file is processed with the <italic toggle="yes">removeduplicates</italic> function (<xref rid="B18" ref-type="bibr">18</xref>). This step can be run externally to <monospace>scPipe</monospace> and the resulting <italic toggle="yes">BAM</italic> file can be re-entered to the <monospace>scPipe</monospace> pipeline if <monospace>samtools</monospace> is not installed locally.</p>
      <p>Fragment file generation was adopted from a python-based tool named <monospace>Sinto</monospace> (version 0.8) (<xref rid="B19" ref-type="bibr">19</xref>). Briefly, the fragment file is in .<italic toggle="yes">BED</italic> format created from the aligned read file (i.e. <italic toggle="yes">BAM</italic>) with the position of each Tn5 integration site, barcode of the cell that the fragment belongs to and the number of times the fragment was sequenced while collapsing the PCR duplicates. This is achieved by first extracting the cell barcode sequence associated with each read and adjusting the alignment positions for the 9 bp Tn5 shift by applying +4/−5 to the start and end position of the paired reads. Next, fragments below a certain quality threshold and a size larger than a maximum provided by the user are removed before collapsing any duplicates (if present). This python-based capability was integrated into the <monospace>scPipe</monospace> R package using <monospace>basilisk</monospace> (<xref rid="B20" ref-type="bibr">20</xref>). Feature matrix construction can be via a .<italic toggle="yes">bed</italic> file provided to the workflow (e.g. bulk peak file from <monospace>MACS3</monospace>) or using the reference genome (i.e. ‘<monospace>genome_bin</monospace>’ approach). In the ‘<monospace>genome_bin</monospace>’ approach, the genome is cut in to chunks of user-defined size and the overlap is calculated between the <italic toggle="yes">bed</italic> file and the fragment file. Using such an approach is resource intensive, yet more sensitive to rare open regions than using a bulk approach. Furthermore, being able to converge on the same features via this approach will make downstream integration of the multiple scATAC-Seq data sets more convenient. An optional peak calling step can also be carried out using the R version of <monospace>MACS3</monospace> (<monospace>MACSr</monospace> (<xref rid="B21" ref-type="bibr">21</xref>)) which has been implemented to execute bulk-level peak calling across all the data. This is a faster method than the in-built <italic toggle="yes">genome</italic>−<italic toggle="yes">bin</italic> approach described above to identify features to generate the feature × cell matrix.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Generating the feature × cell matrix, <monospace>SCE</monospace> objects and QC statistics</title>
      <p>The externally created (e.g. via <monospace>Cell Ranger</monospace>) or <monospace>scPipe</monospace> generated feature matrix and fragment file is used as the main input to generate the feature × cell count matrix. This step involves multiple filtering steps including cell calling and row-wise (i.e. feature-level), and column-wise (i.e. cell-level) filtering as well as read correction for the Tn5 cut site. A <italic toggle="yes">GenomicAlignments</italic> object (<xref rid="B22" ref-type="bibr">22</xref>) is generated for the fragments with cell barcode information and the feature file (peaks/bins) with the feature coordinate information which is then overlapped to generate the unfiltered counts matrix. This matrix then enters the cell calling step to distinguish ‘true’ cells from ambient background DNA. It has been previously been shown that filtering cells based on multiple QC metrics is the most effective approach to do cell calling (<xref rid="B7" ref-type="bibr">7</xref>), and this approach has been adopted in <monospace>scPipe</monospace>. This can be called with the parameter <italic toggle="yes">cell_calling=filter</italic> within the <italic toggle="yes">sc_atac_feature_counting()</italic> function. The resulting matrix is then converted to a binary matrix as well as a <italic toggle="yes">SCE</italic> object (<xref rid="B11" ref-type="bibr">11</xref>). An HTML report is generated using <monospace>rmarkdown</monospace> as an optional output of this step. This report summarises the QC metrics gathered during preprocessing to allow data quality to be visually assessed (Figure <xref rid="F1" ref-type="fig">1B−D</xref>), and is easy to share with collaborators. <monospace>ScPipe</monospace>’s ATAC-Seq module also logs all details in the workflow so that a user can track the progress if a step fails or wants to further explore the pipeline parameters used.</p>
    </sec>
    <sec id="SEC2-5">
      <title>Integration of <monospace>SCE</monospace> objects</title>
      <p>Another important aspect of <monospace>scPipe</monospace> is the ability to integrate datasets where a common barcode file is available to match the cells between <italic toggle="yes">SCE</italic> objects to create a combined <italic toggle="yes">SCE</italic> object, as occurs for example in 10X Genomics multiome experiments. The R/Bioconductor package <monospace>MultiAssayExperiment</monospace> is used for this (<xref rid="B23" ref-type="bibr">23</xref>) to output combined <italic toggle="yes">SCE</italic> objects with <monospace>colData()</monospace> from the same barcodes bound together (Figure <xref rid="F1" ref-type="fig">1A</xref>). If there are barcodes with missing data from one or more <italic toggle="yes">SCE</italic> objects, they will still be included with the addition of ‘NAs’ to columns corresponding to the cells that do not share common barcodes. Storing data in this way allows the user to further leverage Bioconductor software and design principles to make biologically relevant inferences (e.g. to correct for batch effects, perform integration and clustering).</p>
    </sec>
    <sec id="SEC2-6">
      <title>Human lung adenocarcinoma cell line dataset</title>
      <p>The cell culture and sample preparation of mixtures of cells from different cell lines was performed as previously described (<xref rid="B24" ref-type="bibr">24</xref>). Briefly, five human lung adenocarcinoma cell lines (A549, H1975, H2228, H838 and HCC827) were obtained from ATCC (<ext-link xlink:href="https://www.atcc.org/" ext-link-type="uri">https://www.atcc.org/</ext-link>) and cultured separately in Roswell Park Memorial Institute (RPMI) 1640 medium with 10% fetal calf serum and 1% penicillin-streptomycin at 37°C with 5% carbon dioxide until near 100% confluency. Cells were counted manually using a hemocytometer and mixed with equal number to form single-cell suspension with around 2 000 000 cells. Cells were permeabilised with nuclei EZ Lysis Buffer from Sigma-Aldrich supplemented with Protector RNase Inhibitor and filtered to isolate nuclei. Nuclei underwent fluorescence-activated nuclei sorting (FANS) and 1 600 000 nuclei were output from the sorter. After concentrating the nuclei suspension to achieve 10 000 nuclei recovery during Gel Bead-In EMulsions (GEM) generation, 11 960 nuclei were input to form GEMs that were used to generate 10× Multiome (GEX + ATAC) libraries. The cDNA library was sequenced using Illumina NextSeq 500 with recommended cycles and the ATAC library was sequenced using Illumina NextSeq 500 with the custom recipe. FASTQ files were then generated with <monospace>Cell Ranger ARC</monospace> 2.0.0 <italic toggle="yes">mkfastq</italic>. The raw data are available from GEO under accession number GSE224045.</p>
      <p>We have processed the scATAC-Seq data in two ways; (i) via the <monospace>Cell Ranger ATAC</monospace> pipeline, and (ii) via the <monospace>scPipe</monospace> pipeline. The scRNA-Seq data was processed through the standard <monospace>Cell Ranger</monospace> pipeline. The paired read were aligned to the hg38 reference. The tool <monospace>demuxlet</monospace> (<xref rid="B25" ref-type="bibr">25</xref>) was used to assign the cell line identity (i.e. ground truth) to the data using variant information as previously described (<xref rid="B24" ref-type="bibr">24</xref>). Next we developed custom scripts (available via GitHub) using mainly <monospace>ggplot2</monospace>(<xref rid="B26" ref-type="bibr">26</xref>), <monospace>Seurat</monospace> (<xref rid="B27" ref-type="bibr">27</xref>) and <monospace>NMI</monospace> R packages to generate plots for visualisation and comparison.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>Results</title>
    <sec id="SEC3-1">
      <title>Resource requirements of <monospace>scPipe</monospace> on scATAC-Seq data</title>
      <p>We ran the <monospace>scPipe</monospace> scATAC-Seq pipeline on both the 20% and 80% GEMs to profile time and memory usage. For the 20% sample, which contains 31,749,732 reads, the pipeline ran for approximately 140 minutes, and required approximately 85 GB of RAM allocated. The longest processing step was <italic toggle="yes">sc_aligning</italic>, which internally uses <monospace>Rsubread</monospace>, and required 63 minutes to complete. For the 80% sample, containing 112,463,635 reads, the pipeline required approximately 604 minutes (10 hours) to complete and 540 GB of RAM allocated.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Downstream comparison between <monospace>scPipe</monospace> and <monospace>Cell Ranger ATAC</monospace></title>
      <p>We compared the clusters identified from <monospace>scPipe</monospace> preprocessed data to those obtained from the <monospace>Cell Ranger ATAC</monospace> pipeline, a popular tool for 10X scATAC-Seq preprocessing. A dataset that contains around 5,800 cells with ground truth available in the form of cell line identity labels obtained using variant information was used to compare the results from the two approaches (Figure <xref rid="F2" ref-type="fig">2A</xref>). <monospace>Cell Ranger</monospace> returned 5728 cells and <monospace>scPipe</monospace> 5599 cells after QC, with 5267 in common (Figure <xref rid="F2" ref-type="fig">2B</xref>). Inspection of features overlapping the mitochondrial genes as a QC metric shows that <monospace>Cell Ranger</monospace> has called more dead/poor quality cells that should be excluded from downstream analysis (Figure <xref rid="F2" ref-type="fig">2C</xref>). On the other hand, the mitochondrial contamination is lower and similar for <monospace>scPipe</monospace>-only called cells and those identified by <monospace>scPipe</monospace> in common with <monospace>Cell Ranger</monospace> (Figure <xref rid="F2" ref-type="fig">2C’</xref>). Overall, there was high concordance between the called cell (Figure <xref rid="F2" ref-type="fig">2D</xref>) and feature counts (Figure <xref rid="F2" ref-type="fig">2D’</xref>) within for the cells in common between the two pipelines. Moreover, ‘<monospace>scPipe</monospace>-only’ called cells contained counts and features that were more similar those found in common than the counts and features from ‘<monospace>Cell Ranger</monospace>-only’ called cells, whose distributions were concentrated towards the lower ranges for both quantities. The UMAP (<xref rid="B28" ref-type="bibr">28</xref>) generated from the <monospace>Cell Ranger</monospace> output shows that the 129 cells that appear in the <monospace>Cell Ranger</monospace> results but not in <monospace>scPipe</monospace> tend to cluster together away from the large clusters or in the margins of them (Figure <xref rid="F2" ref-type="fig">2E</xref>). In contrast, the UMAP generated from the <monospace>scPipe</monospace> output shows that the cells that only appear in <monospace>scPipe</monospace> results but not in <monospace>Cell Ranger</monospace> tend to be located within the main clusters (Figure <xref rid="F2" ref-type="fig">2E’</xref>).</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>Comparing <monospace>scPipe</monospace> and <monospace>Cell Ranger</monospace> on a 10× dataset. <bold>(A)</bold> Summary of experimental design, which used cells from five distinct lung adenocarcinoma cell lines. An equal mixture of cells and nuclei were captured by the 10X protocol, and sequenced on the Illumina platform (see Materials and Methods). <italic toggle="yes">FASTQ</italic> files were generated by <monospace>Cell Ranger ARC</monospace> 2.0.0 and these reads were processed by <monospace>scPipe</monospace> and <monospace>Cell Ranger</monospace>. The panels of this figure pertain to the 80% results. <bold>(B)</bold> Venn diagram showing the overlap of cell barcodes detected by <monospace>Cell Ranger</monospace> and <monospace>scPipe</monospace>. <bold>(C)</bold> Box plot showing the percentage of mitochondrial gene counts in cells that are called by <monospace>Cell Ranger</monospace> and are common with/unique in comparison to <monospace>scPipe</monospace> or (C’) <monospace>scPipe</monospace> and are common with/unique in comparison to <monospace>Cell Ranger</monospace> output. <bold>(D)</bold> Scatter plot of the per cell total counts and <bold>(D’)</bold> number of features per cell obtained from <monospace>Cell Ranger</monospace> and <monospace>scPipe</monospace> in cells called in common between the two and cells that were unique to each of the two pipelines. Marginal density plots show the count distributions for each category. <bold>(E)</bold> UMAP plot generated for <monospace>Cell Ranger</monospace> and <bold>(E’)</bold><monospace>scPipe</monospace> output. Cell barcodes that only exist in (E) <monospace>Cell Ranger</monospace> or (E’) <monospace>scPipe</monospace> are highlighted in red. <bold>(F)</bold> UMAP coloured by the ground truth for <monospace>Cell Ranger</monospace> and <bold>(F’)</bold><monospace>scPipe</monospace>. <monospace>Seurat</monospace> identified clusters are demarcated by coloured lines and numbered. The ARI and NMI values calculated per dataset are shown in the top right of the panels.</p>
        </caption>
        <graphic xlink:href="lqad105fig2" position="float"/>
      </fig>
      <p>Comparison of the cell line labels assigned to these cells using <monospace>demuxlet</monospace> (<xref rid="B25" ref-type="bibr">25</xref>) to the clustering results obtained using the scATAC-Seq data alone in a <monospace>Seurat</monospace> analysis, was made by calculating the adjusted rand index (ARI) and normalised mutual information (NMI) scores which should be closer to 1 when the clustering is highly concordant between the two approaches. For the <monospace>Cell Ranger</monospace> data, an ARI of 0.56 and NMI of 0.64 (Figure <xref rid="F2" ref-type="fig">2F</xref>) were obtained. The <monospace>scPipe</monospace> generated output resulted in a higher ARI of 0.68 and NMI of 0.75 (Figure <xref rid="F2" ref-type="fig">2F’</xref>), indicating better concordance between the <monospace>Seurat</monospace> clustering and <monospace>demuxlet</monospace> results. Taken together, <monospace>scPipe</monospace> seemed to identify higher quality cells that were better separated according to the biological signal present in the data relative to the <monospace>Cell Ranger</monospace> processed data.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>Discussion</title>
    <p>To ensure flexibility, <monospace>scPipe</monospace> can preprocess data from a variety of different scATAC-Seq protocols that includes droplet-based and plate-based methods. <monospace>scPipe</monospace> can also handle combinatorial barcoding options when demultiplexing the reads, and can handle Unique Molecular Identifier (UMI) based scATAC-Seq approaches if they arise in the future. The resulting preprocessed data output by <monospace>scPipe</monospace> is stored in a versatile <italic toggle="yes">SingleCellExperiment</italic> (<italic toggle="yes">SCE</italic>) format, which means that the data can be further analysed downstream using <italic toggle="yes">SCE</italic>-object friendly tools available in R/Bioconductor. We demonstrate that data preprocessing with <monospace>scPipe</monospace>’s scATAC-Seq preprocessing workflow produces comparable results to those from 10×’s <monospace>Cell Ranger ATAC</monospace> pipeline. As the integration of numerous large-scale data modalities becomes more routine, <monospace>scPipe</monospace> provides convenient and scalable preprocessing options for both scRNA-Seq and scATAC-Seq data, allowing data integration and joint analyses.</p>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>Acknowledgements</title>
    <p>This work was supported by funding from the Chan Zuckerberg Initiative DAF, an advised fund of Silicon Valley Community Foundation (Grant No. 2019-002443 to M.E.R.), Australian National Health and Medical Research Council (NHMRC) Investigator Grant (2017257 to M.E.R.), the Australian Research Council (Discovery Project No. 200102903 to M.E.R.), the Genomics Innovation Hub, Victorian State Government Operational Infrastructure Support, Australian Government NHMRC IRIISS and support from the Australian Cancer Research Foundation. The authors are grateful to Dr Saskia Freytag and Mr Reza Ghamsari for providing feedback on this manuscript.</p>
  </ack>
  <sec sec-type="data-availability" id="SEC5">
    <title>Data availability</title>
    <p><monospace>scPipe</monospace>’s scATAC-Seq preprocessing module is available from Bioconductor, DOI: <ext-link xlink:href="https://doi.org/doi:10.18129/B9.bioc.scPipe" ext-link-type="uri">https://doi.org/doi:10.18129/B9.bioc.scPipe</ext-link>. The code used for the timing calculations and generating Figure <xref rid="F2" ref-type="fig">2</xref> (panels B–F) are available from Zenodo, DOI: <ext-link xlink:href="https://zenodo.org/doi/10.5281/zenodo.10185302" ext-link-type="uri">https://zenodo.org/doi/10.5281/zenodo.10185302</ext-link>.</p>
  </sec>
  <sec id="SEC6">
    <title>Funding</title>
    <p>Australian Research Council [200102903]; National Health and Medical Research Council [2017257]; Chan Zuckerberg Initiative [2019-002443].</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>References</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buenrostro</surname>  <given-names>J.D.</given-names></string-name>, <string-name><surname>Wu</surname>  <given-names>B.</given-names></string-name>, <string-name><surname>Litzenburger</surname>  <given-names>U.M.</given-names></string-name>, <string-name><surname>Ruff</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Gonzales</surname>  <given-names>M.L.</given-names></string-name>, <string-name><surname>Snyder</surname>  <given-names>M.P.</given-names></string-name>, <string-name><surname>Chang</surname>  <given-names>H.Y.</given-names></string-name>, <string-name><surname>Greenleaf</surname>  <given-names>W.J.</given-names></string-name></person-group>  <article-title>Single-cell chromatin accessibility reveals principles of regulatory variation</article-title>. <source>Nature</source>. <year>2015</year>; <volume>523</volume>:<fpage>486</fpage>–<lpage>490</lpage>.<pub-id pub-id-type="pmid">26083756</pub-id>
</mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baek</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Lee</surname>  <given-names>I.</given-names></string-name></person-group>  <article-title>Single-cell ATAC sequencing analysis: from data preprocessing to hypothesis generation</article-title>. <source>Comput. Struct. Biotechnol. J.</source>  <year>2020</year>; <volume>18</volume>:<fpage>1429</fpage>–<lpage>1439</lpage>.<pub-id pub-id-type="pmid">32637041</pub-id>
</mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cusanovich</surname>  <given-names>D.A.</given-names></string-name>, <string-name><surname>Hill</surname>  <given-names>A.J.</given-names></string-name>, <string-name><surname>Aghamirzaie</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Daza</surname>  <given-names>R.M.</given-names></string-name>, <string-name><surname>Pliner</surname>  <given-names>H.A.</given-names></string-name>, <string-name><surname>Berletch</surname>  <given-names>J.B.</given-names></string-name>, <string-name><surname>Filippova</surname>  <given-names>G.N.</given-names></string-name>, <string-name><surname>Huang</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Christiansen</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>DeWitt</surname>  <given-names>W.S.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>A Single-cell atlas of in vivo mammalian chromatin accessibility</article-title>. <source>Cell</source>. <year>2018</year>; <volume>174</volume>:<fpage>1309</fpage>–<lpage>1324</lpage>.<pub-id pub-id-type="pmid">30078704</pub-id>
</mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mezger</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Klemm</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Mann</surname>  <given-names>I.</given-names></string-name>, <string-name><surname>Brower</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Mir</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Bostick</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Farmer</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Fordyce</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Linnarsson</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Greenleaf</surname>  <given-names>W.</given-names></string-name></person-group>  <article-title>High-throughput chromatin accessibility profiling at single-cell resolution</article-title>. <source>Nat. Commun.</source>  <year>2018</year>; <volume>9</volume>:<fpage>6</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">29295974</pub-id>
</mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satpathy</surname>  <given-names>A.T.</given-names></string-name>, <string-name><surname>Granja</surname>  <given-names>J.M.</given-names></string-name>, <string-name><surname>Yost</surname>  <given-names>K.E.</given-names></string-name>, <string-name><surname>Qi</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Meschi</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>McDermott</surname>  <given-names>G.P.</given-names></string-name>, <string-name><surname>Olsen</surname>  <given-names>B.N.</given-names></string-name>, <string-name><surname>Mumbach</surname>  <given-names>M.R.</given-names></string-name>, <string-name><surname>Pierce</surname>  <given-names>S.E.</given-names></string-name>, <string-name><surname>Corces</surname>  <given-names>M.R.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Massively parallel single-cell chromatin landscapes of human immune cell development and intratumoral T cell exhaustion</article-title>. <source>Nat. Biotechnol.</source>  <year>2019</year>; <volume>37</volume>:<fpage>925</fpage>–<lpage>936</lpage>.<pub-id pub-id-type="pmid">31375813</pub-id>
</mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lareau</surname>  <given-names>C.A.</given-names></string-name>, <string-name><surname>Duarte</surname>  <given-names>F.M.</given-names></string-name>, <string-name><surname>Chew</surname>  <given-names>J.G.</given-names></string-name>, <string-name><surname>Kartha</surname>  <given-names>V.K.</given-names></string-name>, <string-name><surname>Burkett</surname>  <given-names>Z.D.</given-names></string-name>, <string-name><surname>Kohlway</surname>  <given-names>A.S.</given-names></string-name>, <string-name><surname>Pokholok</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Aryee</surname>  <given-names>M.J.</given-names></string-name>, <string-name><surname>Steemers</surname>  <given-names>F.J.</given-names></string-name>, <string-name><surname>Lebofsky</surname>  <given-names>R.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Droplet-based combinatorial indexing for massive-scale single-cell chromatin accessibility</article-title>. <source>Nat. Biotechnol.</source>  <year>2019</year>; <volume>37</volume>:<fpage>916</fpage>–<lpage>924</lpage>.<pub-id pub-id-type="pmid">31235917</pub-id>
</mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Uzun</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Zhu</surname>  <given-names>Q.</given-names></string-name>, <string-name><surname>Chen</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Tan</surname>  <given-names>K.</given-names></string-name></person-group>  <article-title>scATAC-pro: a comprehensive workbench for single-cell chromatin accessibility sequencing data</article-title>. <source>Genome Biol.</source>  <year>2020</year>; <volume>21</volume>:<fpage>94</fpage>.<pub-id pub-id-type="pmid">32312293</pub-id>
</mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Lareau</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Andreani</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Vinyard</surname>  <given-names>M.E.</given-names></string-name>, <string-name><surname>Garcia</surname>  <given-names>S.P.</given-names></string-name>, <string-name><surname>Clement</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Andrade-Navarro</surname>  <given-names>M.A.</given-names></string-name>, <string-name><surname>Buenrostro</surname>  <given-names>J.D.</given-names></string-name>, <string-name><surname>Pinello</surname>  <given-names>L.</given-names></string-name></person-group>  <article-title>Assessment of computational methods for the analysis of single-cell ATAC-seq data</article-title>. <source>Genome Biol.</source>  <year>2020</year>; <volume>20</volume>:<fpage>241</fpage>.</mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fang</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Preissl</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Li</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Hou</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Lucero</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Motamedi</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Shiau</surname>  <given-names>A.K.</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Xie</surname>  <given-names>F.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Comprehensive analysis of single cell ATAC-seq data with SnapATAC</article-title>. <source>Nat. Commun.</source>  <year>2021</year>; <volume>12</volume>:<fpage>1337</fpage>.<pub-id pub-id-type="pmid">33637727</pub-id>
</mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tian</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Su</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Dong</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Amann-Zalcenstein</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Biben</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Seidi</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Hilton</surname>  <given-names>D.J.</given-names></string-name>, <string-name><surname>Naik</surname>  <given-names>S.H.</given-names></string-name>, <string-name><surname>Ritchie</surname>  <given-names>M.E.</given-names></string-name></person-group>  <article-title>scPipe: a flexible R/Bioconductor preprocessing pipeline for single-cell RNA-sequencing data</article-title>. <source>PLoS Comput. Biol.</source>  <year>2018</year>; <volume>14</volume>:<fpage>e1006361</fpage>.<pub-id pub-id-type="pmid">30096152</pub-id>
</mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amezquita</surname>  <given-names>R.A.</given-names></string-name>, <string-name><surname>Lun</surname>  <given-names>A.T.</given-names></string-name>, <string-name><surname>Becht</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Carey</surname>  <given-names>V.J.</given-names></string-name>, <string-name><surname>Carpp</surname>  <given-names>L.N.</given-names></string-name>, <string-name><surname>Geistlinger</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Marini</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Rue-Albrecht</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Risso</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Soneson</surname>  <given-names>C.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Orchestrating single-cell analysis with Bioconductor</article-title>. <source>Nat. Methods</source>. <year>2019</year>; <volume>17</volume>:<fpage>137</fpage>–<lpage>145</lpage>.<pub-id pub-id-type="pmid">31792435</pub-id>
</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="book"><collab>R Core Team</collab>  <source>R: a Language and Environment for Statistical Computing</source>. <year>2020</year>; <publisher-loc>Vienna, Austria</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huber</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Carey</surname>  <given-names>V.J.</given-names></string-name>, <string-name><surname>Gentleman</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Anders</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Carlson</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Carvalho</surname>  <given-names>B.S.</given-names></string-name>, <string-name><surname>Bravo</surname>  <given-names>H.C.</given-names></string-name>, <string-name><surname>Davis</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Gatto</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Girke</surname>  <given-names>T.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>. <source>Nat. Methods</source>. <year>2015</year>; <volume>12</volume>:<fpage>115</fpage>–<lpage>121</lpage>.<pub-id pub-id-type="pmid">25633503</pub-id>
</mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Eddelbuettel</surname>  <given-names>D.</given-names></string-name></person-group>  <source>Seamless R and C++ Integration with Rcpp</source>. <year>2013</year>; <publisher-loc>NY</publisher-loc><publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Allaire</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Ushey</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Tang</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Eddelbuettel</surname>  <given-names>D.</given-names></string-name></person-group>  <article-title>reticulate: R Interface to Python</article-title>. <year>2017</year>; <uri xlink:href="https://github.com/rstudio/reticulate">https://github.com/rstudio/reticulate</uri>.</mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Allaire</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Xie</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>McPherson</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Luraschi</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Ushey</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Atkins</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Wickham</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Cheng</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Chang</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Iannone</surname>  <given-names>R.</given-names></string-name></person-group>  <article-title>rmarkdown: Dynamic Documents for R , R package version 2.7</article-title>. <year>2021</year>; <uri xlink:href="https://github.com/rstudio/rmarkdown">https://github.com/rstudio/rmarkdown.</uri>.</mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liao</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Smyth</surname>  <given-names>G.K.</given-names></string-name>, <string-name><surname>Shi</surname>  <given-names>W.</given-names></string-name></person-group>  <article-title>The R package Rsubread is easier, faster, cheaper and better for alignment and quantification of RNA sequencing reads</article-title>. <source>Nucleic Acids Res.</source>  <year>2019</year>; <volume>47</volume>:<fpage>e47</fpage>.<pub-id pub-id-type="pmid">30783653</pub-id>
</mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Handsaker</surname>  <given-names>B.</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Fennell</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Ruan</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Homer</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Marth</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Abecasis</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R.</given-names></string-name></person-group>  <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>; <volume>25</volume>:<fpage>2078</fpage>–<lpage>2079</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id>
</mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Stuart</surname>  <given-names>T.</given-names></string-name></person-group>  <article-title>Sinto: single-cell analysis tools</article-title>. <year>2022</year>; <uri xlink:href="https://github.com/timoast/sinto">https://github.com/timoast/sinto</uri>.</mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lun</surname>  <given-names>A.T.L.</given-names></string-name></person-group>  <article-title>basilisk: a Bioconductor package for managing Python environments</article-title>. <source>J. Open Source Softw.</source>  <year>2022</year>; <volume>7</volume>:<fpage>4742</fpage>.</mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hu</surname>  <given-names>Q.</given-names></string-name></person-group>  <article-title>MACSr: MACS: model-based analysis for ChIP-Seq</article-title>. <year>2022</year>; <uri xlink:href="https://bioconductor.org/packages/MACSr">https://bioconductor.org/packages/MACSr</uri>.</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lawrence</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Huber</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Pagès</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Aboyoun</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Carlson</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Gentleman</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Morgan</surname>  <given-names>M.T.</given-names></string-name>, <string-name><surname>Carey</surname>  <given-names>V.J.</given-names></string-name></person-group>  <article-title>Software for Computing and annotating Genomic ranges</article-title>. <source>PLoS Comput. Biol.</source>  <year>2013</year>; <volume>9</volume>:<fpage>e1003118</fpage>.<pub-id pub-id-type="pmid">23950696</pub-id>
</mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramos</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Schiffer</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Re</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Azhar</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Basunia</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Rodriguez</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Chan</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Chapman</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Davis</surname>  <given-names>S.R.</given-names></string-name>, <string-name><surname>Gomez-Cabrero</surname>  <given-names>D.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Software for the integration of multiomics experiments in bioconductor</article-title>. <source>Cancer Res.</source>  <year>2017</year>; <volume>77</volume>:<fpage>e39</fpage>–<lpage>e42</lpage>.<pub-id pub-id-type="pmid">29092936</pub-id>
</mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tian</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Dong</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Freytag</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Cao</surname>  <given-names>K.A.L.</given-names></string-name>, <string-name><surname>Su</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>JalalAbadi</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Amann-Zalcenstein</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Weber</surname>  <given-names>T.S.</given-names></string-name>, <string-name><surname>Seidi</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Jabbari</surname>  <given-names>J.S.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Benchmarking single cell RNA-sequencing analysis pipelines using mixture control experiments</article-title>. <source>Nat. Methods</source>. <year>2019</year>; <volume>16</volume>:<fpage>479</fpage>–<lpage>487</lpage>.<pub-id pub-id-type="pmid">31133762</pub-id>
</mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kang</surname>  <given-names>H.M.</given-names></string-name>, <string-name><surname>Subramaniam</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Targ</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Nguyen</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Maliskova</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Wan</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Wong</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Byrnes</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Lanata</surname>  <given-names>C.M.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Multiplexed droplet single-cell RNA-sequencing using natural genetic variation</article-title>. <source>Nat. Biotechnol.</source>  <year>2017</year>; <volume>36</volume>:<fpage>89</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">29227470</pub-id>
</mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Wickham</surname>  <given-names>H.</given-names></string-name></person-group>  <source>ggplot2: Elegant Graphics for Data Analysis</source>. <year>2016</year>; <publisher-loc>NY</publisher-loc><publisher-name>Springer-Verlag</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Butler</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Hoffman</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Hafemeister</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Papalexi</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>III</surname>  <given-names>W. M.M.</given-names></string-name>, <string-name><surname>Hao</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Stoeckius</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Smibert</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Satija</surname>  <given-names>R.</given-names></string-name></person-group>  <article-title>Comprehensive Integration of Single-Cell Data</article-title>. <source>Cell</source>. <year>2019</year>; <volume>177</volume>:<fpage>1888</fpage>–<lpage>1902</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id>
</mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McInnes</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Healy</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Saul</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Großberger</surname>  <given-names>L.</given-names></string-name></person-group>  <article-title>UMAP: Uniform Manifold Approximation and Projection</article-title>. <source>J. Open Source Softw.</source>  <year>2018</year>; <volume>3</volume>:<fpage>861</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">nargab</journal-id>
    <journal-title-group>
      <journal-title>NAR Genomics and Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2631-9268</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10689045</article-id>
    <article-id pub-id-type="pmid">38046273</article-id>
    <article-id pub-id-type="doi">10.1093/nargab/lqad105</article-id>
    <article-id pub-id-type="publisher-id">lqad105</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00030</subject>
        <subject>AcademicSubjects/SCI00980</subject>
        <subject>AcademicSubjects/SCI01060</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Pipelines and Workflows for Biological Data Analysis</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scPipe: an extended preprocessing pipeline for comprehensive single-cell ATAC-Seq data integration in R/Bioconductor</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2229-8106</contrib-id>
        <name>
          <surname>Amarasinghe</surname>
          <given-names>Shanika L</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
        <aff><institution>The Australian Regenerative Medicine Institute, Monash University</institution>, Clayton, Victoria, 3800, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Phil</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Voogd</surname>
          <given-names>Oliver</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Haoyu</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Du</surname>
          <given-names>Mei R M</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Su</surname>
          <given-names>Shian</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brown</surname>
          <given-names>Daniel V</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Department of Medical Biology, The University of Melbourne</institution>, Parkville, Victoria, 3010, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jabbari</surname>
          <given-names>Jafar S</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Department of Medical Biology, The University of Melbourne</institution>, Parkville, Victoria, 3010, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bowden</surname>
          <given-names>Rory</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Department of Medical Biology, The University of Melbourne</institution>, Parkville, Victoria, 3010, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7383-0609</contrib-id>
        <name>
          <surname>Ritchie</surname>
          <given-names>Matthew E</given-names>
        </name>
        <!--mritchie@wehi.edu.au-->
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Department of Medical Biology, The University of Melbourne</institution>, Parkville, Victoria, 3010, <country country="AU">Australia</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +61 3 9345 2856; Fax: +61 3 9347 0852; Email: <email>mritchie@wehi.edu.au</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-30">
      <day>30</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>5</volume>
    <issue>4</issue>
    <elocation-id>lqad105</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of NAR Genomics and Bioinformatics.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="lqad105.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p><monospace>scPipe</monospace> is a flexible R/Bioconductor package originally developed to analyse platform-independent single-cell RNA-Seq data. To expand its preprocessing capability to accommodate new single-cell technologies, we further developed <monospace>scPipe</monospace> to handle single-cell ATAC-Seq and multi-modal (RNA-Seq and ATAC-Seq) data. After executing multiple data cleaning steps to remove duplicated reads, low abundance features and cells of poor quality, a <italic toggle="yes">SingleCellExperiment</italic> object is created that contains a sparse count matrix with features of interest in the rows and cells in the columns. Quality control information (e.g. counts per cell, features per cell, total number of fragments, fraction of fragments per peak) and any relevant feature annotations are stored as metadata. We demonstrate that <monospace>scPipe</monospace> can efficiently identify ‘true’ cells and provides flexibility for the user to fine-tune the quality control thresholds using various feature and cell-based metrics collected during data preprocessing. Researchers can then take advantage of various downstream single-cell tools available in Bioconductor for further analysis of scATAC-Seq data such as dimensionality reduction, clustering, motif enrichment, differential accessibility and cis-regulatory network analysis. The <monospace>scPipe</monospace> package enables a complete beginning-to-end pipeline for single-cell ATAC-Seq and RNA-Seq data analysis in R.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Australian Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000923</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>200102903</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Health and Medical Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000925</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2017257</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Chan Zuckerberg Initiative</institution>
            <institution-id institution-id-type="DOI">10.13039/100014989</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2019-002443</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>Introduction</title>
    <p>Single-cell sequencing technology has undergone rapid development in the past decade to allow researchers to study cellular heterogeneity across multiple omic modalities, including the transcriptome, epigenome and proteome. Single Cell Assay for Transposase Accessible Chromatin Sequencing (scATAC-Seq), is a relatively recent approach for profiling chromatin accessibility at single-cell resolution (<xref rid="B1" ref-type="bibr">1</xref>) that has been widely used to define chromatin state across cell types, discover cis- and trans- regulatory regions, identify master regulators, and characterise gene regulatory networks (<xref rid="B2" ref-type="bibr">2</xref>).</p>
    <p>The four main protocols for scATAC-Seq include the combinatorial indexing approach (sci-ATAC-Seq) (<xref rid="B3" ref-type="bibr">3</xref>), microfluidics-based methods (scATAC-Seq) (<xref rid="B1" ref-type="bibr">1</xref>), nano-well based protocols (μscATAC-Seq) (<xref rid="B4" ref-type="bibr">4</xref>) and droplet-based (10X scATAC-Seq, dscATAC-Seq and dsciATAC-seq) approaches (<xref rid="B5" ref-type="bibr">5</xref>,<xref rid="B6" ref-type="bibr">6</xref>).</p>
    <p>The general workflow for scATAC-Seq data analysis comprises of (i) preprocessing: demultiplexing, adaptor trimming, read mapping, quality control, cell calling and multiplet removal <italic toggle="yes">(optional)</italic>; (ii) feature matrix construction: defining regions via peak calling or genome binning, counting defined features, transformation and dimensionality reduction and (iii) downstream analysis: cell clustering, secondary peak calling, visualisation, differential accessibility analysis and <italic toggle="yes">cis</italic>-regulatory network analysis (<xref rid="B7" ref-type="bibr">7</xref>,<xref rid="B8" ref-type="bibr">8</xref>).</p>
    <p>The growing popularity of scATAC-Seq technology warrants the development of analysis tools that can preprocess this type of data efficiently and effectively. There are currently 14 tools that can preprocess scATAC-Seq data that are summarised in Table <xref rid="tbl1" ref-type="table">1</xref>. Some are written in R (i.e. <monospace>ArchR</monospace>, <monospace>BROCKMAN</monospace>, <monospace>ChromSCape</monospace>, <monospace>chromVAR</monospace>, <monospace>Destin</monospace>, <monospace>scABC</monospace>, <monospace>SCRAT</monospace>, <monospace>Snaptools</monospace>) while others are Python and Shell based. Furthermore, the feature matrix construction step varies amongst these tools where some of them use bulk peak calls, TSS regions, <italic toggle="yes">k</italic>-mers, or a genome binning approach. It has been shown previously that out of these, a genome binning approach is more sensitive to the detection of rare open chromatin regions present in a sub-population of cells (<xref rid="B9" ref-type="bibr">9</xref>).</p>
    <table-wrap position="float" id="tbl1">
      <label>Table 1.</label>
      <caption>
        <p>Summary of current packages available for scATAC-Seq data preprocessing</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Method / tool name</th>
            <th rowspan="1" colspan="1">Year</th>
            <th rowspan="1" colspan="1">Language</th>
            <th rowspan="1" colspan="1">Input</th>
            <th rowspan="1" colspan="1">Multiple</th>
            <th rowspan="1" colspan="1">Feature matrix</th>
          </tr>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1">Technologies?</th>
            <th rowspan="1" colspan="1">Construction method</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>APEC</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">Python</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">FASTQ</italic>, matrix + peaks</td>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <tex-math id="M0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\checkmark$\end{document}</tex-math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>ArchR</monospace>
            </td>
            <td rowspan="1" colspan="1">2020</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">BAM</italic>, fragments</td>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <tex-math id="M0001a" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\checkmark$\end{document}</tex-math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">Bin</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>BROCKMAN</monospace>
            </td>
            <td rowspan="1" colspan="1">2018</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">FASTQ</italic>
            </td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">k</italic>-mer</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>Cell Ranger ATAC</monospace>
            </td>
            <td rowspan="1" colspan="1">2018</td>
            <td rowspan="1" colspan="1">Command line</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">FASTQ</italic>
            </td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>ChromSCape</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">R Shiny</td>
            <td rowspan="1" colspan="1">Various</td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Bin, Peak, TSS</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>chromVAR</monospace>
            </td>
            <td rowspan="1" colspan="1">2017</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">BAM</italic> + peaks</td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Motif, <italic toggle="yes">k</italic>-mer</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Cusanovich <italic toggle="yes">et al.</italic> 2018</td>
            <td rowspan="1" colspan="1">2015</td>
            <td rowspan="1" colspan="1">Scripts</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">BAM</italic>
            </td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>Destin</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">FASTQ</italic>, <italic toggle="yes">BAM</italic> + peaks</td>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <tex-math id="M0002" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\checkmark$\end{document}</tex-math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>Gene scoring</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">Scripts</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">FASTQ</italic>
            </td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">TSS</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>scABC</monospace>
            </td>
            <td rowspan="1" colspan="1">2018</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">FASTQ</italic>
            </td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>scasat</monospace>
            </td>
            <td rowspan="1" colspan="1">2018</td>
            <td rowspan="1" colspan="1">JupyterNotebook</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">BAM</italic>s</td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>scATAC-pro</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">Command line</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">FASTQ</italic>, various</td>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <tex-math id="M0003" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\checkmark$\end{document}</tex-math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>SCRAT</monospace>
            </td>
            <td rowspan="1" colspan="1">2017</td>
            <td rowspan="1" colspan="1">R,WEB</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">BAM</italic>s</td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Various</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>Snaptool</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">Python</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">FASTQ</italic>
            </td>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <tex-math id="M0004" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\checkmark$\end{document}</tex-math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">Bin, Peak</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>A current limitation of these tools is that most cannot handle data from multiple technologies (i.e. droplet-based and plate-based) or they require the use of specific data structures that have limited compatibility with current well-known, light-weight, single-cell data structures such as <italic toggle="yes">SingleCellExperiment</italic> objects (<italic toggle="yes">SCEs</italic>) in R/Bioconductor.</p>
    <p>In this study, we extend <monospace>scPipe</monospace> (<xref rid="B10" ref-type="bibr">10</xref>) to enable handling of scATAC-Seq data and generation of <italic toggle="yes">SCE</italic> objects that can be manipulated using various <italic toggle="yes">SCE</italic>-friendly downstream analysis tools available in R/Bioconductor (<xref rid="B11" ref-type="bibr">11</xref>). An <italic toggle="yes">SCE</italic> container, most popular for scRNA-Seq data storage, can easily be used to store scATAC-Seq data due to its flexibility (i.e., rows representing features (genomic regions) and columns representing cells). <monospace>scPipe</monospace> is able to take scATAC-Seq reads (<italic toggle="yes">FASTQ</italic> format) as input, which are demultiplexed (if needed) and filtered based on quality and Ns (i.e. non-called bases), aligned to the reference genome and filtered based on various quality metrics such as mapping rate, fraction of reads mapping to the mitochondrial genes and the number of duplicate or high-quality reads. Cleaned up data will then be used to conduct cell calling and optionally peak calling, to generate the final feature by cell sparse matrix which is stored as a <italic toggle="yes">SCE</italic> object. These improvements also allow <monospace>scPipe</monospace> to be used for multiome projects that collect both scRNA-Seq and scATAC-Seq on the same cells.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>Materials and methods</title>
    <sec id="SEC2-1">
      <title>Architecture of the <monospace>scPipe</monospace> scATAC-Seq module</title>
      <p><monospace>scPipe</monospace> was developed using the R (<xref rid="B12" ref-type="bibr">12</xref>) / Bioconductor (<xref rid="B13" ref-type="bibr">13</xref>) platform, with the underlying code written in C++, R and Python with the <monospace>Rcpp</monospace> (<xref rid="B14" ref-type="bibr">14</xref>) and <monospace>reticulate</monospace> (<xref rid="B15" ref-type="bibr">15</xref>) packages used to wrap the C++ and Python code for R, respectively. Data from both UMI (Unique Molecular Identifiers) and non-UMI protocols can be handled by <monospace>scPipe</monospace>. The pipeline for scATAC-Seq data preprocessing is initiated with <italic toggle="yes">FASTQ</italic> files and outputs include a feature count matrix and a variety of quality control (QC) statistics and a standalone HTML report generated using <monospace>rmarkdown</monospace> (<xref rid="B16" ref-type="bibr">16</xref>) that contains a summary of the QC statistics collected during data preprocessing.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Demultiplexing and read alignment</title>
      <p>Demultiplexing is performed by the <italic toggle="yes">sc_atac_trim_barcode()</italic> function (Figure <xref rid="F1" ref-type="fig">1A</xref>) using a similar approach to that used in <monospace>scPipe</monospace> for scRNA-Seq analysis. The scATAC-Seq module can accommodate data in .<italic toggle="yes">fastq</italic> format as well as .<italic toggle="yes">csv</italic> format, with the user defining which format the data is in and the relevant demultiplexing strategy will be executed. In brief, the barcode is either extracted from the reads themselves based on the entries in a <italic toggle="yes">csv</italic> file where the second column of the file contains the barcodes or from the sequences of a complementary <italic toggle="yes">FASTQ</italic> file and appended to the read names in the <italic toggle="yes">FASTQ</italic> files containing the ATAC sequences.</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of the <monospace>scPipe</monospace> scATAC-Seq module and its QC outputs. <bold>(A)</bold> The pipeline is shown on the left and the QC metrics gathered during preprocessing are shown on the right. Purple coloured boxes denote the inputs and light colour purple define the inputs that are optionally accepted as they are not incorporated into current scATAC-Seq library preparations yet. Blue colour box depicts the final output. Black boxes denote the main pipeline steps that should be followed. Green boxes denote the steps that are running within these the main pipeline without having to call them specifically, still can also be called separately if needed. <bold>(B)</bold> QC plot showing the separation of ‘cell’ and ‘non-cell’ based on the fraction of fragments overlappping peaks (y-axis) vs total number of fragments (x-axis) after cell calling step of scPipe. <bold>(C)</bold> QC plot showing the separation of cell and ‘non-cell’ based on read density (y-axis) versus total number of fragments (x-axis) after cell calling step of scPipe. <bold>(D)</bold> QC plot showing the fraction of features overlapping different functional regions (i.e., Peaks, TSS, Promoter, Enhancer, Mitochondrial genes).</p>
        </caption>
        <graphic xlink:href="lqad105fig1" position="float"/>
      </fig>
      <p>A read correction step is incorporated to ensure sequencing errors that appear in barcodes are identified and removed to avoid unwanted data loss. In summary, after the barcodes are determined, error correction is carried out with a hamming distance of 1 to correct for sequencing errors. Each barcode can be optionally validated against a known list of valid barcodes (either as is or the reverse complement) and the frequency of each valid barcode is then counted. <monospace>scPipe</monospace> corrects barcodes that are not matched to the valid barcode list by allowing for one mismatched base in comparison with the valid barcode list, and counting the number of corrected barcodes in the complete dataset. In the case that multiple sequences are found matching the valid barcode list with one mismatched base, each mismatched base’s quality (Q) score is compared and the sequence with the lowest <italic toggle="yes">Q</italic> score at the mismatch position is considered valid.</p>
      <p>Demultiplexed data is stored in four data files; i.e. complete-match: no error correction was necessary for the data in this file; partial-match: error-corrected reads; no-match: data that were unable to be demultiplexed even after error correction; and full-data: a concatenated version of the data across the 3 aforementioned categories. The user is able to select either one of the more stringent files or the complete dataset for downstream analysis (by default, the complete dataset is used).</p>
      <p>Read alignment is run with the function <italic toggle="yes">sc_aligning()</italic> which uses <italic toggle="yes">Rsubread::align()</italic> (<xref rid="B17" ref-type="bibr">17</xref>) internally (Figure <xref rid="F1" ref-type="fig">1A</xref>). The user has to define the technology (i.e. RNA or ATAC) to execute the most appropriate alignment approach (i.e. single-end alignment for RNA and paired-end for ATAC). The resulting <italic toggle="yes">BAM</italic> file contains the read name in the first column, and unmapped reads are denoted by an asterisk (*).</p>
    </sec>
    <sec id="SEC2-3">
      <title>Demultiplexing aligned reads, removing duplicates, creating fragments and peak calling</title>
      <p>Demultiplexing aligned reads is performed by the <italic toggle="yes">sc_atac_bam_tagging()</italic> function which extracts the barcode information from the read names of the aligned <italic toggle="yes">BAM</italic> file and generates a new column with the tag CB:z: to record the cell barcode (Figure <xref rid="F1" ref-type="fig">1A</xref>). As some reads may not have an assigned barcode, this column in the resulting demultiplexed <italic toggle="yes">BAM</italic> file may be empty in such positions.</p>
      <p>The main difference in the scATAC-Seq module compared to original scRNA-Seq module is the need to extract biological information from both reads in the former. Therefore, it was important to retain both reads (i.e. forward and reverse) for scATAC-Seq data as compared to retaining only the forward of the pair of reads for scRNA-Seq module where reverse will be the barcode followed by the polyA tail, which can be discarded after demultiplexing of the read takes place.</p>
      <p>Removal of duplicate reads uses <monospace>samtools</monospace>, where the <italic toggle="yes">BAM</italic> file is processed with the <italic toggle="yes">removeduplicates</italic> function (<xref rid="B18" ref-type="bibr">18</xref>). This step can be run externally to <monospace>scPipe</monospace> and the resulting <italic toggle="yes">BAM</italic> file can be re-entered to the <monospace>scPipe</monospace> pipeline if <monospace>samtools</monospace> is not installed locally.</p>
      <p>Fragment file generation was adopted from a python-based tool named <monospace>Sinto</monospace> (version 0.8) (<xref rid="B19" ref-type="bibr">19</xref>). Briefly, the fragment file is in .<italic toggle="yes">BED</italic> format created from the aligned read file (i.e. <italic toggle="yes">BAM</italic>) with the position of each Tn5 integration site, barcode of the cell that the fragment belongs to and the number of times the fragment was sequenced while collapsing the PCR duplicates. This is achieved by first extracting the cell barcode sequence associated with each read and adjusting the alignment positions for the 9 bp Tn5 shift by applying +4/−5 to the start and end position of the paired reads. Next, fragments below a certain quality threshold and a size larger than a maximum provided by the user are removed before collapsing any duplicates (if present). This python-based capability was integrated into the <monospace>scPipe</monospace> R package using <monospace>basilisk</monospace> (<xref rid="B20" ref-type="bibr">20</xref>). Feature matrix construction can be via a .<italic toggle="yes">bed</italic> file provided to the workflow (e.g. bulk peak file from <monospace>MACS3</monospace>) or using the reference genome (i.e. ‘<monospace>genome_bin</monospace>’ approach). In the ‘<monospace>genome_bin</monospace>’ approach, the genome is cut in to chunks of user-defined size and the overlap is calculated between the <italic toggle="yes">bed</italic> file and the fragment file. Using such an approach is resource intensive, yet more sensitive to rare open regions than using a bulk approach. Furthermore, being able to converge on the same features via this approach will make downstream integration of the multiple scATAC-Seq data sets more convenient. An optional peak calling step can also be carried out using the R version of <monospace>MACS3</monospace> (<monospace>MACSr</monospace> (<xref rid="B21" ref-type="bibr">21</xref>)) which has been implemented to execute bulk-level peak calling across all the data. This is a faster method than the in-built <italic toggle="yes">genome</italic>−<italic toggle="yes">bin</italic> approach described above to identify features to generate the feature × cell matrix.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Generating the feature × cell matrix, <monospace>SCE</monospace> objects and QC statistics</title>
      <p>The externally created (e.g. via <monospace>Cell Ranger</monospace>) or <monospace>scPipe</monospace> generated feature matrix and fragment file is used as the main input to generate the feature × cell count matrix. This step involves multiple filtering steps including cell calling and row-wise (i.e. feature-level), and column-wise (i.e. cell-level) filtering as well as read correction for the Tn5 cut site. A <italic toggle="yes">GenomicAlignments</italic> object (<xref rid="B22" ref-type="bibr">22</xref>) is generated for the fragments with cell barcode information and the feature file (peaks/bins) with the feature coordinate information which is then overlapped to generate the unfiltered counts matrix. This matrix then enters the cell calling step to distinguish ‘true’ cells from ambient background DNA. It has been previously been shown that filtering cells based on multiple QC metrics is the most effective approach to do cell calling (<xref rid="B7" ref-type="bibr">7</xref>), and this approach has been adopted in <monospace>scPipe</monospace>. This can be called with the parameter <italic toggle="yes">cell_calling=filter</italic> within the <italic toggle="yes">sc_atac_feature_counting()</italic> function. The resulting matrix is then converted to a binary matrix as well as a <italic toggle="yes">SCE</italic> object (<xref rid="B11" ref-type="bibr">11</xref>). An HTML report is generated using <monospace>rmarkdown</monospace> as an optional output of this step. This report summarises the QC metrics gathered during preprocessing to allow data quality to be visually assessed (Figure <xref rid="F1" ref-type="fig">1B−D</xref>), and is easy to share with collaborators. <monospace>ScPipe</monospace>’s ATAC-Seq module also logs all details in the workflow so that a user can track the progress if a step fails or wants to further explore the pipeline parameters used.</p>
    </sec>
    <sec id="SEC2-5">
      <title>Integration of <monospace>SCE</monospace> objects</title>
      <p>Another important aspect of <monospace>scPipe</monospace> is the ability to integrate datasets where a common barcode file is available to match the cells between <italic toggle="yes">SCE</italic> objects to create a combined <italic toggle="yes">SCE</italic> object, as occurs for example in 10X Genomics multiome experiments. The R/Bioconductor package <monospace>MultiAssayExperiment</monospace> is used for this (<xref rid="B23" ref-type="bibr">23</xref>) to output combined <italic toggle="yes">SCE</italic> objects with <monospace>colData()</monospace> from the same barcodes bound together (Figure <xref rid="F1" ref-type="fig">1A</xref>). If there are barcodes with missing data from one or more <italic toggle="yes">SCE</italic> objects, they will still be included with the addition of ‘NAs’ to columns corresponding to the cells that do not share common barcodes. Storing data in this way allows the user to further leverage Bioconductor software and design principles to make biologically relevant inferences (e.g. to correct for batch effects, perform integration and clustering).</p>
    </sec>
    <sec id="SEC2-6">
      <title>Human lung adenocarcinoma cell line dataset</title>
      <p>The cell culture and sample preparation of mixtures of cells from different cell lines was performed as previously described (<xref rid="B24" ref-type="bibr">24</xref>). Briefly, five human lung adenocarcinoma cell lines (A549, H1975, H2228, H838 and HCC827) were obtained from ATCC (<ext-link xlink:href="https://www.atcc.org/" ext-link-type="uri">https://www.atcc.org/</ext-link>) and cultured separately in Roswell Park Memorial Institute (RPMI) 1640 medium with 10% fetal calf serum and 1% penicillin-streptomycin at 37°C with 5% carbon dioxide until near 100% confluency. Cells were counted manually using a hemocytometer and mixed with equal number to form single-cell suspension with around 2 000 000 cells. Cells were permeabilised with nuclei EZ Lysis Buffer from Sigma-Aldrich supplemented with Protector RNase Inhibitor and filtered to isolate nuclei. Nuclei underwent fluorescence-activated nuclei sorting (FANS) and 1 600 000 nuclei were output from the sorter. After concentrating the nuclei suspension to achieve 10 000 nuclei recovery during Gel Bead-In EMulsions (GEM) generation, 11 960 nuclei were input to form GEMs that were used to generate 10× Multiome (GEX + ATAC) libraries. The cDNA library was sequenced using Illumina NextSeq 500 with recommended cycles and the ATAC library was sequenced using Illumina NextSeq 500 with the custom recipe. FASTQ files were then generated with <monospace>Cell Ranger ARC</monospace> 2.0.0 <italic toggle="yes">mkfastq</italic>. The raw data are available from GEO under accession number GSE224045.</p>
      <p>We have processed the scATAC-Seq data in two ways; (i) via the <monospace>Cell Ranger ATAC</monospace> pipeline, and (ii) via the <monospace>scPipe</monospace> pipeline. The scRNA-Seq data was processed through the standard <monospace>Cell Ranger</monospace> pipeline. The paired read were aligned to the hg38 reference. The tool <monospace>demuxlet</monospace> (<xref rid="B25" ref-type="bibr">25</xref>) was used to assign the cell line identity (i.e. ground truth) to the data using variant information as previously described (<xref rid="B24" ref-type="bibr">24</xref>). Next we developed custom scripts (available via GitHub) using mainly <monospace>ggplot2</monospace>(<xref rid="B26" ref-type="bibr">26</xref>), <monospace>Seurat</monospace> (<xref rid="B27" ref-type="bibr">27</xref>) and <monospace>NMI</monospace> R packages to generate plots for visualisation and comparison.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>Results</title>
    <sec id="SEC3-1">
      <title>Resource requirements of <monospace>scPipe</monospace> on scATAC-Seq data</title>
      <p>We ran the <monospace>scPipe</monospace> scATAC-Seq pipeline on both the 20% and 80% GEMs to profile time and memory usage. For the 20% sample, which contains 31,749,732 reads, the pipeline ran for approximately 140 minutes, and required approximately 85 GB of RAM allocated. The longest processing step was <italic toggle="yes">sc_aligning</italic>, which internally uses <monospace>Rsubread</monospace>, and required 63 minutes to complete. For the 80% sample, containing 112,463,635 reads, the pipeline required approximately 604 minutes (10 hours) to complete and 540 GB of RAM allocated.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Downstream comparison between <monospace>scPipe</monospace> and <monospace>Cell Ranger ATAC</monospace></title>
      <p>We compared the clusters identified from <monospace>scPipe</monospace> preprocessed data to those obtained from the <monospace>Cell Ranger ATAC</monospace> pipeline, a popular tool for 10X scATAC-Seq preprocessing. A dataset that contains around 5,800 cells with ground truth available in the form of cell line identity labels obtained using variant information was used to compare the results from the two approaches (Figure <xref rid="F2" ref-type="fig">2A</xref>). <monospace>Cell Ranger</monospace> returned 5728 cells and <monospace>scPipe</monospace> 5599 cells after QC, with 5267 in common (Figure <xref rid="F2" ref-type="fig">2B</xref>). Inspection of features overlapping the mitochondrial genes as a QC metric shows that <monospace>Cell Ranger</monospace> has called more dead/poor quality cells that should be excluded from downstream analysis (Figure <xref rid="F2" ref-type="fig">2C</xref>). On the other hand, the mitochondrial contamination is lower and similar for <monospace>scPipe</monospace>-only called cells and those identified by <monospace>scPipe</monospace> in common with <monospace>Cell Ranger</monospace> (Figure <xref rid="F2" ref-type="fig">2C’</xref>). Overall, there was high concordance between the called cell (Figure <xref rid="F2" ref-type="fig">2D</xref>) and feature counts (Figure <xref rid="F2" ref-type="fig">2D’</xref>) within for the cells in common between the two pipelines. Moreover, ‘<monospace>scPipe</monospace>-only’ called cells contained counts and features that were more similar those found in common than the counts and features from ‘<monospace>Cell Ranger</monospace>-only’ called cells, whose distributions were concentrated towards the lower ranges for both quantities. The UMAP (<xref rid="B28" ref-type="bibr">28</xref>) generated from the <monospace>Cell Ranger</monospace> output shows that the 129 cells that appear in the <monospace>Cell Ranger</monospace> results but not in <monospace>scPipe</monospace> tend to cluster together away from the large clusters or in the margins of them (Figure <xref rid="F2" ref-type="fig">2E</xref>). In contrast, the UMAP generated from the <monospace>scPipe</monospace> output shows that the cells that only appear in <monospace>scPipe</monospace> results but not in <monospace>Cell Ranger</monospace> tend to be located within the main clusters (Figure <xref rid="F2" ref-type="fig">2E’</xref>).</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>Comparing <monospace>scPipe</monospace> and <monospace>Cell Ranger</monospace> on a 10× dataset. <bold>(A)</bold> Summary of experimental design, which used cells from five distinct lung adenocarcinoma cell lines. An equal mixture of cells and nuclei were captured by the 10X protocol, and sequenced on the Illumina platform (see Materials and Methods). <italic toggle="yes">FASTQ</italic> files were generated by <monospace>Cell Ranger ARC</monospace> 2.0.0 and these reads were processed by <monospace>scPipe</monospace> and <monospace>Cell Ranger</monospace>. The panels of this figure pertain to the 80% results. <bold>(B)</bold> Venn diagram showing the overlap of cell barcodes detected by <monospace>Cell Ranger</monospace> and <monospace>scPipe</monospace>. <bold>(C)</bold> Box plot showing the percentage of mitochondrial gene counts in cells that are called by <monospace>Cell Ranger</monospace> and are common with/unique in comparison to <monospace>scPipe</monospace> or (C’) <monospace>scPipe</monospace> and are common with/unique in comparison to <monospace>Cell Ranger</monospace> output. <bold>(D)</bold> Scatter plot of the per cell total counts and <bold>(D’)</bold> number of features per cell obtained from <monospace>Cell Ranger</monospace> and <monospace>scPipe</monospace> in cells called in common between the two and cells that were unique to each of the two pipelines. Marginal density plots show the count distributions for each category. <bold>(E)</bold> UMAP plot generated for <monospace>Cell Ranger</monospace> and <bold>(E’)</bold><monospace>scPipe</monospace> output. Cell barcodes that only exist in (E) <monospace>Cell Ranger</monospace> or (E’) <monospace>scPipe</monospace> are highlighted in red. <bold>(F)</bold> UMAP coloured by the ground truth for <monospace>Cell Ranger</monospace> and <bold>(F’)</bold><monospace>scPipe</monospace>. <monospace>Seurat</monospace> identified clusters are demarcated by coloured lines and numbered. The ARI and NMI values calculated per dataset are shown in the top right of the panels.</p>
        </caption>
        <graphic xlink:href="lqad105fig2" position="float"/>
      </fig>
      <p>Comparison of the cell line labels assigned to these cells using <monospace>demuxlet</monospace> (<xref rid="B25" ref-type="bibr">25</xref>) to the clustering results obtained using the scATAC-Seq data alone in a <monospace>Seurat</monospace> analysis, was made by calculating the adjusted rand index (ARI) and normalised mutual information (NMI) scores which should be closer to 1 when the clustering is highly concordant between the two approaches. For the <monospace>Cell Ranger</monospace> data, an ARI of 0.56 and NMI of 0.64 (Figure <xref rid="F2" ref-type="fig">2F</xref>) were obtained. The <monospace>scPipe</monospace> generated output resulted in a higher ARI of 0.68 and NMI of 0.75 (Figure <xref rid="F2" ref-type="fig">2F’</xref>), indicating better concordance between the <monospace>Seurat</monospace> clustering and <monospace>demuxlet</monospace> results. Taken together, <monospace>scPipe</monospace> seemed to identify higher quality cells that were better separated according to the biological signal present in the data relative to the <monospace>Cell Ranger</monospace> processed data.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>Discussion</title>
    <p>To ensure flexibility, <monospace>scPipe</monospace> can preprocess data from a variety of different scATAC-Seq protocols that includes droplet-based and plate-based methods. <monospace>scPipe</monospace> can also handle combinatorial barcoding options when demultiplexing the reads, and can handle Unique Molecular Identifier (UMI) based scATAC-Seq approaches if they arise in the future. The resulting preprocessed data output by <monospace>scPipe</monospace> is stored in a versatile <italic toggle="yes">SingleCellExperiment</italic> (<italic toggle="yes">SCE</italic>) format, which means that the data can be further analysed downstream using <italic toggle="yes">SCE</italic>-object friendly tools available in R/Bioconductor. We demonstrate that data preprocessing with <monospace>scPipe</monospace>’s scATAC-Seq preprocessing workflow produces comparable results to those from 10×’s <monospace>Cell Ranger ATAC</monospace> pipeline. As the integration of numerous large-scale data modalities becomes more routine, <monospace>scPipe</monospace> provides convenient and scalable preprocessing options for both scRNA-Seq and scATAC-Seq data, allowing data integration and joint analyses.</p>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>Acknowledgements</title>
    <p>This work was supported by funding from the Chan Zuckerberg Initiative DAF, an advised fund of Silicon Valley Community Foundation (Grant No. 2019-002443 to M.E.R.), Australian National Health and Medical Research Council (NHMRC) Investigator Grant (2017257 to M.E.R.), the Australian Research Council (Discovery Project No. 200102903 to M.E.R.), the Genomics Innovation Hub, Victorian State Government Operational Infrastructure Support, Australian Government NHMRC IRIISS and support from the Australian Cancer Research Foundation. The authors are grateful to Dr Saskia Freytag and Mr Reza Ghamsari for providing feedback on this manuscript.</p>
  </ack>
  <sec sec-type="data-availability" id="SEC5">
    <title>Data availability</title>
    <p><monospace>scPipe</monospace>’s scATAC-Seq preprocessing module is available from Bioconductor, DOI: <ext-link xlink:href="https://doi.org/doi:10.18129/B9.bioc.scPipe" ext-link-type="uri">https://doi.org/doi:10.18129/B9.bioc.scPipe</ext-link>. The code used for the timing calculations and generating Figure <xref rid="F2" ref-type="fig">2</xref> (panels B–F) are available from Zenodo, DOI: <ext-link xlink:href="https://zenodo.org/doi/10.5281/zenodo.10185302" ext-link-type="uri">https://zenodo.org/doi/10.5281/zenodo.10185302</ext-link>.</p>
  </sec>
  <sec id="SEC6">
    <title>Funding</title>
    <p>Australian Research Council [200102903]; National Health and Medical Research Council [2017257]; Chan Zuckerberg Initiative [2019-002443].</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>References</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buenrostro</surname>  <given-names>J.D.</given-names></string-name>, <string-name><surname>Wu</surname>  <given-names>B.</given-names></string-name>, <string-name><surname>Litzenburger</surname>  <given-names>U.M.</given-names></string-name>, <string-name><surname>Ruff</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Gonzales</surname>  <given-names>M.L.</given-names></string-name>, <string-name><surname>Snyder</surname>  <given-names>M.P.</given-names></string-name>, <string-name><surname>Chang</surname>  <given-names>H.Y.</given-names></string-name>, <string-name><surname>Greenleaf</surname>  <given-names>W.J.</given-names></string-name></person-group>  <article-title>Single-cell chromatin accessibility reveals principles of regulatory variation</article-title>. <source>Nature</source>. <year>2015</year>; <volume>523</volume>:<fpage>486</fpage>–<lpage>490</lpage>.<pub-id pub-id-type="pmid">26083756</pub-id>
</mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baek</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Lee</surname>  <given-names>I.</given-names></string-name></person-group>  <article-title>Single-cell ATAC sequencing analysis: from data preprocessing to hypothesis generation</article-title>. <source>Comput. Struct. Biotechnol. J.</source>  <year>2020</year>; <volume>18</volume>:<fpage>1429</fpage>–<lpage>1439</lpage>.<pub-id pub-id-type="pmid">32637041</pub-id>
</mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cusanovich</surname>  <given-names>D.A.</given-names></string-name>, <string-name><surname>Hill</surname>  <given-names>A.J.</given-names></string-name>, <string-name><surname>Aghamirzaie</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Daza</surname>  <given-names>R.M.</given-names></string-name>, <string-name><surname>Pliner</surname>  <given-names>H.A.</given-names></string-name>, <string-name><surname>Berletch</surname>  <given-names>J.B.</given-names></string-name>, <string-name><surname>Filippova</surname>  <given-names>G.N.</given-names></string-name>, <string-name><surname>Huang</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Christiansen</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>DeWitt</surname>  <given-names>W.S.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>A Single-cell atlas of in vivo mammalian chromatin accessibility</article-title>. <source>Cell</source>. <year>2018</year>; <volume>174</volume>:<fpage>1309</fpage>–<lpage>1324</lpage>.<pub-id pub-id-type="pmid">30078704</pub-id>
</mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mezger</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Klemm</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Mann</surname>  <given-names>I.</given-names></string-name>, <string-name><surname>Brower</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Mir</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Bostick</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Farmer</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Fordyce</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Linnarsson</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Greenleaf</surname>  <given-names>W.</given-names></string-name></person-group>  <article-title>High-throughput chromatin accessibility profiling at single-cell resolution</article-title>. <source>Nat. Commun.</source>  <year>2018</year>; <volume>9</volume>:<fpage>6</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">29295974</pub-id>
</mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satpathy</surname>  <given-names>A.T.</given-names></string-name>, <string-name><surname>Granja</surname>  <given-names>J.M.</given-names></string-name>, <string-name><surname>Yost</surname>  <given-names>K.E.</given-names></string-name>, <string-name><surname>Qi</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Meschi</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>McDermott</surname>  <given-names>G.P.</given-names></string-name>, <string-name><surname>Olsen</surname>  <given-names>B.N.</given-names></string-name>, <string-name><surname>Mumbach</surname>  <given-names>M.R.</given-names></string-name>, <string-name><surname>Pierce</surname>  <given-names>S.E.</given-names></string-name>, <string-name><surname>Corces</surname>  <given-names>M.R.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Massively parallel single-cell chromatin landscapes of human immune cell development and intratumoral T cell exhaustion</article-title>. <source>Nat. Biotechnol.</source>  <year>2019</year>; <volume>37</volume>:<fpage>925</fpage>–<lpage>936</lpage>.<pub-id pub-id-type="pmid">31375813</pub-id>
</mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lareau</surname>  <given-names>C.A.</given-names></string-name>, <string-name><surname>Duarte</surname>  <given-names>F.M.</given-names></string-name>, <string-name><surname>Chew</surname>  <given-names>J.G.</given-names></string-name>, <string-name><surname>Kartha</surname>  <given-names>V.K.</given-names></string-name>, <string-name><surname>Burkett</surname>  <given-names>Z.D.</given-names></string-name>, <string-name><surname>Kohlway</surname>  <given-names>A.S.</given-names></string-name>, <string-name><surname>Pokholok</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Aryee</surname>  <given-names>M.J.</given-names></string-name>, <string-name><surname>Steemers</surname>  <given-names>F.J.</given-names></string-name>, <string-name><surname>Lebofsky</surname>  <given-names>R.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Droplet-based combinatorial indexing for massive-scale single-cell chromatin accessibility</article-title>. <source>Nat. Biotechnol.</source>  <year>2019</year>; <volume>37</volume>:<fpage>916</fpage>–<lpage>924</lpage>.<pub-id pub-id-type="pmid">31235917</pub-id>
</mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Uzun</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Zhu</surname>  <given-names>Q.</given-names></string-name>, <string-name><surname>Chen</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Tan</surname>  <given-names>K.</given-names></string-name></person-group>  <article-title>scATAC-pro: a comprehensive workbench for single-cell chromatin accessibility sequencing data</article-title>. <source>Genome Biol.</source>  <year>2020</year>; <volume>21</volume>:<fpage>94</fpage>.<pub-id pub-id-type="pmid">32312293</pub-id>
</mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Lareau</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Andreani</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Vinyard</surname>  <given-names>M.E.</given-names></string-name>, <string-name><surname>Garcia</surname>  <given-names>S.P.</given-names></string-name>, <string-name><surname>Clement</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Andrade-Navarro</surname>  <given-names>M.A.</given-names></string-name>, <string-name><surname>Buenrostro</surname>  <given-names>J.D.</given-names></string-name>, <string-name><surname>Pinello</surname>  <given-names>L.</given-names></string-name></person-group>  <article-title>Assessment of computational methods for the analysis of single-cell ATAC-seq data</article-title>. <source>Genome Biol.</source>  <year>2020</year>; <volume>20</volume>:<fpage>241</fpage>.</mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fang</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Preissl</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Li</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Hou</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Lucero</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Motamedi</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Shiau</surname>  <given-names>A.K.</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Xie</surname>  <given-names>F.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Comprehensive analysis of single cell ATAC-seq data with SnapATAC</article-title>. <source>Nat. Commun.</source>  <year>2021</year>; <volume>12</volume>:<fpage>1337</fpage>.<pub-id pub-id-type="pmid">33637727</pub-id>
</mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tian</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Su</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Dong</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Amann-Zalcenstein</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Biben</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Seidi</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Hilton</surname>  <given-names>D.J.</given-names></string-name>, <string-name><surname>Naik</surname>  <given-names>S.H.</given-names></string-name>, <string-name><surname>Ritchie</surname>  <given-names>M.E.</given-names></string-name></person-group>  <article-title>scPipe: a flexible R/Bioconductor preprocessing pipeline for single-cell RNA-sequencing data</article-title>. <source>PLoS Comput. Biol.</source>  <year>2018</year>; <volume>14</volume>:<fpage>e1006361</fpage>.<pub-id pub-id-type="pmid">30096152</pub-id>
</mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amezquita</surname>  <given-names>R.A.</given-names></string-name>, <string-name><surname>Lun</surname>  <given-names>A.T.</given-names></string-name>, <string-name><surname>Becht</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Carey</surname>  <given-names>V.J.</given-names></string-name>, <string-name><surname>Carpp</surname>  <given-names>L.N.</given-names></string-name>, <string-name><surname>Geistlinger</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Marini</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Rue-Albrecht</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Risso</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Soneson</surname>  <given-names>C.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Orchestrating single-cell analysis with Bioconductor</article-title>. <source>Nat. Methods</source>. <year>2019</year>; <volume>17</volume>:<fpage>137</fpage>–<lpage>145</lpage>.<pub-id pub-id-type="pmid">31792435</pub-id>
</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="book"><collab>R Core Team</collab>  <source>R: a Language and Environment for Statistical Computing</source>. <year>2020</year>; <publisher-loc>Vienna, Austria</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huber</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Carey</surname>  <given-names>V.J.</given-names></string-name>, <string-name><surname>Gentleman</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Anders</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Carlson</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Carvalho</surname>  <given-names>B.S.</given-names></string-name>, <string-name><surname>Bravo</surname>  <given-names>H.C.</given-names></string-name>, <string-name><surname>Davis</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Gatto</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Girke</surname>  <given-names>T.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>. <source>Nat. Methods</source>. <year>2015</year>; <volume>12</volume>:<fpage>115</fpage>–<lpage>121</lpage>.<pub-id pub-id-type="pmid">25633503</pub-id>
</mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Eddelbuettel</surname>  <given-names>D.</given-names></string-name></person-group>  <source>Seamless R and C++ Integration with Rcpp</source>. <year>2013</year>; <publisher-loc>NY</publisher-loc><publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Allaire</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Ushey</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Tang</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Eddelbuettel</surname>  <given-names>D.</given-names></string-name></person-group>  <article-title>reticulate: R Interface to Python</article-title>. <year>2017</year>; <uri xlink:href="https://github.com/rstudio/reticulate">https://github.com/rstudio/reticulate</uri>.</mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Allaire</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Xie</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>McPherson</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Luraschi</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Ushey</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Atkins</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Wickham</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Cheng</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Chang</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Iannone</surname>  <given-names>R.</given-names></string-name></person-group>  <article-title>rmarkdown: Dynamic Documents for R , R package version 2.7</article-title>. <year>2021</year>; <uri xlink:href="https://github.com/rstudio/rmarkdown">https://github.com/rstudio/rmarkdown.</uri>.</mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liao</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Smyth</surname>  <given-names>G.K.</given-names></string-name>, <string-name><surname>Shi</surname>  <given-names>W.</given-names></string-name></person-group>  <article-title>The R package Rsubread is easier, faster, cheaper and better for alignment and quantification of RNA sequencing reads</article-title>. <source>Nucleic Acids Res.</source>  <year>2019</year>; <volume>47</volume>:<fpage>e47</fpage>.<pub-id pub-id-type="pmid">30783653</pub-id>
</mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Handsaker</surname>  <given-names>B.</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Fennell</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Ruan</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Homer</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Marth</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Abecasis</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R.</given-names></string-name></person-group>  <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>; <volume>25</volume>:<fpage>2078</fpage>–<lpage>2079</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id>
</mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Stuart</surname>  <given-names>T.</given-names></string-name></person-group>  <article-title>Sinto: single-cell analysis tools</article-title>. <year>2022</year>; <uri xlink:href="https://github.com/timoast/sinto">https://github.com/timoast/sinto</uri>.</mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lun</surname>  <given-names>A.T.L.</given-names></string-name></person-group>  <article-title>basilisk: a Bioconductor package for managing Python environments</article-title>. <source>J. Open Source Softw.</source>  <year>2022</year>; <volume>7</volume>:<fpage>4742</fpage>.</mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hu</surname>  <given-names>Q.</given-names></string-name></person-group>  <article-title>MACSr: MACS: model-based analysis for ChIP-Seq</article-title>. <year>2022</year>; <uri xlink:href="https://bioconductor.org/packages/MACSr">https://bioconductor.org/packages/MACSr</uri>.</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lawrence</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Huber</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Pagès</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Aboyoun</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Carlson</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Gentleman</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Morgan</surname>  <given-names>M.T.</given-names></string-name>, <string-name><surname>Carey</surname>  <given-names>V.J.</given-names></string-name></person-group>  <article-title>Software for Computing and annotating Genomic ranges</article-title>. <source>PLoS Comput. Biol.</source>  <year>2013</year>; <volume>9</volume>:<fpage>e1003118</fpage>.<pub-id pub-id-type="pmid">23950696</pub-id>
</mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramos</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Schiffer</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Re</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Azhar</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Basunia</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Rodriguez</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Chan</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Chapman</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Davis</surname>  <given-names>S.R.</given-names></string-name>, <string-name><surname>Gomez-Cabrero</surname>  <given-names>D.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Software for the integration of multiomics experiments in bioconductor</article-title>. <source>Cancer Res.</source>  <year>2017</year>; <volume>77</volume>:<fpage>e39</fpage>–<lpage>e42</lpage>.<pub-id pub-id-type="pmid">29092936</pub-id>
</mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tian</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Dong</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Freytag</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Cao</surname>  <given-names>K.A.L.</given-names></string-name>, <string-name><surname>Su</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>JalalAbadi</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Amann-Zalcenstein</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Weber</surname>  <given-names>T.S.</given-names></string-name>, <string-name><surname>Seidi</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Jabbari</surname>  <given-names>J.S.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Benchmarking single cell RNA-sequencing analysis pipelines using mixture control experiments</article-title>. <source>Nat. Methods</source>. <year>2019</year>; <volume>16</volume>:<fpage>479</fpage>–<lpage>487</lpage>.<pub-id pub-id-type="pmid">31133762</pub-id>
</mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kang</surname>  <given-names>H.M.</given-names></string-name>, <string-name><surname>Subramaniam</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Targ</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Nguyen</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Maliskova</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Wan</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Wong</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Byrnes</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Lanata</surname>  <given-names>C.M.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Multiplexed droplet single-cell RNA-sequencing using natural genetic variation</article-title>. <source>Nat. Biotechnol.</source>  <year>2017</year>; <volume>36</volume>:<fpage>89</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">29227470</pub-id>
</mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Wickham</surname>  <given-names>H.</given-names></string-name></person-group>  <source>ggplot2: Elegant Graphics for Data Analysis</source>. <year>2016</year>; <publisher-loc>NY</publisher-loc><publisher-name>Springer-Verlag</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Butler</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Hoffman</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Hafemeister</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Papalexi</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>III</surname>  <given-names>W. M.M.</given-names></string-name>, <string-name><surname>Hao</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Stoeckius</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Smibert</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Satija</surname>  <given-names>R.</given-names></string-name></person-group>  <article-title>Comprehensive Integration of Single-Cell Data</article-title>. <source>Cell</source>. <year>2019</year>; <volume>177</volume>:<fpage>1888</fpage>–<lpage>1902</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id>
</mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McInnes</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Healy</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Saul</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Großberger</surname>  <given-names>L.</given-names></string-name></person-group>  <article-title>UMAP: Uniform Manifold Approximation and Projection</article-title>. <source>J. Open Source Softw.</source>  <year>2018</year>; <volume>3</volume>:<fpage>861</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">nargab</journal-id>
    <journal-title-group>
      <journal-title>NAR Genomics and Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2631-9268</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10689045</article-id>
    <article-id pub-id-type="pmid">38046273</article-id>
    <article-id pub-id-type="doi">10.1093/nargab/lqad105</article-id>
    <article-id pub-id-type="publisher-id">lqad105</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00030</subject>
        <subject>AcademicSubjects/SCI00980</subject>
        <subject>AcademicSubjects/SCI01060</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Pipelines and Workflows for Biological Data Analysis</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scPipe: an extended preprocessing pipeline for comprehensive single-cell ATAC-Seq data integration in R/Bioconductor</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2229-8106</contrib-id>
        <name>
          <surname>Amarasinghe</surname>
          <given-names>Shanika L</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
        <aff><institution>The Australian Regenerative Medicine Institute, Monash University</institution>, Clayton, Victoria, 3800, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Phil</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Voogd</surname>
          <given-names>Oliver</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Haoyu</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Du</surname>
          <given-names>Mei R M</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Su</surname>
          <given-names>Shian</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brown</surname>
          <given-names>Daniel V</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Department of Medical Biology, The University of Melbourne</institution>, Parkville, Victoria, 3010, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jabbari</surname>
          <given-names>Jafar S</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Department of Medical Biology, The University of Melbourne</institution>, Parkville, Victoria, 3010, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bowden</surname>
          <given-names>Rory</given-names>
        </name>
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Department of Medical Biology, The University of Melbourne</institution>, Parkville, Victoria, 3010, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7383-0609</contrib-id>
        <name>
          <surname>Ritchie</surname>
          <given-names>Matthew E</given-names>
        </name>
        <!--mritchie@wehi.edu.au-->
        <aff><institution>The Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, Victoria, 3052, <country country="AU">Australia</country></aff>
        <aff><institution>Department of Medical Biology, The University of Melbourne</institution>, Parkville, Victoria, 3010, <country country="AU">Australia</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +61 3 9345 2856; Fax: +61 3 9347 0852; Email: <email>mritchie@wehi.edu.au</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-30">
      <day>30</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>5</volume>
    <issue>4</issue>
    <elocation-id>lqad105</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of NAR Genomics and Bioinformatics.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="lqad105.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p><monospace>scPipe</monospace> is a flexible R/Bioconductor package originally developed to analyse platform-independent single-cell RNA-Seq data. To expand its preprocessing capability to accommodate new single-cell technologies, we further developed <monospace>scPipe</monospace> to handle single-cell ATAC-Seq and multi-modal (RNA-Seq and ATAC-Seq) data. After executing multiple data cleaning steps to remove duplicated reads, low abundance features and cells of poor quality, a <italic toggle="yes">SingleCellExperiment</italic> object is created that contains a sparse count matrix with features of interest in the rows and cells in the columns. Quality control information (e.g. counts per cell, features per cell, total number of fragments, fraction of fragments per peak) and any relevant feature annotations are stored as metadata. We demonstrate that <monospace>scPipe</monospace> can efficiently identify ‘true’ cells and provides flexibility for the user to fine-tune the quality control thresholds using various feature and cell-based metrics collected during data preprocessing. Researchers can then take advantage of various downstream single-cell tools available in Bioconductor for further analysis of scATAC-Seq data such as dimensionality reduction, clustering, motif enrichment, differential accessibility and cis-regulatory network analysis. The <monospace>scPipe</monospace> package enables a complete beginning-to-end pipeline for single-cell ATAC-Seq and RNA-Seq data analysis in R.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Australian Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000923</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>200102903</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Health and Medical Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000925</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2017257</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Chan Zuckerberg Initiative</institution>
            <institution-id institution-id-type="DOI">10.13039/100014989</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2019-002443</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>Introduction</title>
    <p>Single-cell sequencing technology has undergone rapid development in the past decade to allow researchers to study cellular heterogeneity across multiple omic modalities, including the transcriptome, epigenome and proteome. Single Cell Assay for Transposase Accessible Chromatin Sequencing (scATAC-Seq), is a relatively recent approach for profiling chromatin accessibility at single-cell resolution (<xref rid="B1" ref-type="bibr">1</xref>) that has been widely used to define chromatin state across cell types, discover cis- and trans- regulatory regions, identify master regulators, and characterise gene regulatory networks (<xref rid="B2" ref-type="bibr">2</xref>).</p>
    <p>The four main protocols for scATAC-Seq include the combinatorial indexing approach (sci-ATAC-Seq) (<xref rid="B3" ref-type="bibr">3</xref>), microfluidics-based methods (scATAC-Seq) (<xref rid="B1" ref-type="bibr">1</xref>), nano-well based protocols (μscATAC-Seq) (<xref rid="B4" ref-type="bibr">4</xref>) and droplet-based (10X scATAC-Seq, dscATAC-Seq and dsciATAC-seq) approaches (<xref rid="B5" ref-type="bibr">5</xref>,<xref rid="B6" ref-type="bibr">6</xref>).</p>
    <p>The general workflow for scATAC-Seq data analysis comprises of (i) preprocessing: demultiplexing, adaptor trimming, read mapping, quality control, cell calling and multiplet removal <italic toggle="yes">(optional)</italic>; (ii) feature matrix construction: defining regions via peak calling or genome binning, counting defined features, transformation and dimensionality reduction and (iii) downstream analysis: cell clustering, secondary peak calling, visualisation, differential accessibility analysis and <italic toggle="yes">cis</italic>-regulatory network analysis (<xref rid="B7" ref-type="bibr">7</xref>,<xref rid="B8" ref-type="bibr">8</xref>).</p>
    <p>The growing popularity of scATAC-Seq technology warrants the development of analysis tools that can preprocess this type of data efficiently and effectively. There are currently 14 tools that can preprocess scATAC-Seq data that are summarised in Table <xref rid="tbl1" ref-type="table">1</xref>. Some are written in R (i.e. <monospace>ArchR</monospace>, <monospace>BROCKMAN</monospace>, <monospace>ChromSCape</monospace>, <monospace>chromVAR</monospace>, <monospace>Destin</monospace>, <monospace>scABC</monospace>, <monospace>SCRAT</monospace>, <monospace>Snaptools</monospace>) while others are Python and Shell based. Furthermore, the feature matrix construction step varies amongst these tools where some of them use bulk peak calls, TSS regions, <italic toggle="yes">k</italic>-mers, or a genome binning approach. It has been shown previously that out of these, a genome binning approach is more sensitive to the detection of rare open chromatin regions present in a sub-population of cells (<xref rid="B9" ref-type="bibr">9</xref>).</p>
    <table-wrap position="float" id="tbl1">
      <label>Table 1.</label>
      <caption>
        <p>Summary of current packages available for scATAC-Seq data preprocessing</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Method / tool name</th>
            <th rowspan="1" colspan="1">Year</th>
            <th rowspan="1" colspan="1">Language</th>
            <th rowspan="1" colspan="1">Input</th>
            <th rowspan="1" colspan="1">Multiple</th>
            <th rowspan="1" colspan="1">Feature matrix</th>
          </tr>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1">Technologies?</th>
            <th rowspan="1" colspan="1">Construction method</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>APEC</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">Python</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">FASTQ</italic>, matrix + peaks</td>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <tex-math id="M0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\checkmark$\end{document}</tex-math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>ArchR</monospace>
            </td>
            <td rowspan="1" colspan="1">2020</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">BAM</italic>, fragments</td>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <tex-math id="M0001a" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\checkmark$\end{document}</tex-math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">Bin</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>BROCKMAN</monospace>
            </td>
            <td rowspan="1" colspan="1">2018</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">FASTQ</italic>
            </td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">k</italic>-mer</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>Cell Ranger ATAC</monospace>
            </td>
            <td rowspan="1" colspan="1">2018</td>
            <td rowspan="1" colspan="1">Command line</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">FASTQ</italic>
            </td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>ChromSCape</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">R Shiny</td>
            <td rowspan="1" colspan="1">Various</td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Bin, Peak, TSS</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>chromVAR</monospace>
            </td>
            <td rowspan="1" colspan="1">2017</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">BAM</italic> + peaks</td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Motif, <italic toggle="yes">k</italic>-mer</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Cusanovich <italic toggle="yes">et al.</italic> 2018</td>
            <td rowspan="1" colspan="1">2015</td>
            <td rowspan="1" colspan="1">Scripts</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">BAM</italic>
            </td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>Destin</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">FASTQ</italic>, <italic toggle="yes">BAM</italic> + peaks</td>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <tex-math id="M0002" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\checkmark$\end{document}</tex-math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>Gene scoring</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">Scripts</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">FASTQ</italic>
            </td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">TSS</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>scABC</monospace>
            </td>
            <td rowspan="1" colspan="1">2018</td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">FASTQ</italic>
            </td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>scasat</monospace>
            </td>
            <td rowspan="1" colspan="1">2018</td>
            <td rowspan="1" colspan="1">JupyterNotebook</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">BAM</italic>s</td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>scATAC-pro</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">Command line</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">FASTQ</italic>, various</td>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <tex-math id="M0003" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\checkmark$\end{document}</tex-math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">Peak</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>SCRAT</monospace>
            </td>
            <td rowspan="1" colspan="1">2017</td>
            <td rowspan="1" colspan="1">R,WEB</td>
            <td rowspan="1" colspan="1"><italic toggle="yes">BAM</italic>s</td>
            <td rowspan="1" colspan="1">×</td>
            <td rowspan="1" colspan="1">Various</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace>Snaptool</monospace>
            </td>
            <td rowspan="1" colspan="1">2019</td>
            <td rowspan="1" colspan="1">Python</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">FASTQ</italic>
            </td>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <tex-math id="M0004" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\checkmark$\end{document}</tex-math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">Bin, Peak</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>A current limitation of these tools is that most cannot handle data from multiple technologies (i.e. droplet-based and plate-based) or they require the use of specific data structures that have limited compatibility with current well-known, light-weight, single-cell data structures such as <italic toggle="yes">SingleCellExperiment</italic> objects (<italic toggle="yes">SCEs</italic>) in R/Bioconductor.</p>
    <p>In this study, we extend <monospace>scPipe</monospace> (<xref rid="B10" ref-type="bibr">10</xref>) to enable handling of scATAC-Seq data and generation of <italic toggle="yes">SCE</italic> objects that can be manipulated using various <italic toggle="yes">SCE</italic>-friendly downstream analysis tools available in R/Bioconductor (<xref rid="B11" ref-type="bibr">11</xref>). An <italic toggle="yes">SCE</italic> container, most popular for scRNA-Seq data storage, can easily be used to store scATAC-Seq data due to its flexibility (i.e., rows representing features (genomic regions) and columns representing cells). <monospace>scPipe</monospace> is able to take scATAC-Seq reads (<italic toggle="yes">FASTQ</italic> format) as input, which are demultiplexed (if needed) and filtered based on quality and Ns (i.e. non-called bases), aligned to the reference genome and filtered based on various quality metrics such as mapping rate, fraction of reads mapping to the mitochondrial genes and the number of duplicate or high-quality reads. Cleaned up data will then be used to conduct cell calling and optionally peak calling, to generate the final feature by cell sparse matrix which is stored as a <italic toggle="yes">SCE</italic> object. These improvements also allow <monospace>scPipe</monospace> to be used for multiome projects that collect both scRNA-Seq and scATAC-Seq on the same cells.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>Materials and methods</title>
    <sec id="SEC2-1">
      <title>Architecture of the <monospace>scPipe</monospace> scATAC-Seq module</title>
      <p><monospace>scPipe</monospace> was developed using the R (<xref rid="B12" ref-type="bibr">12</xref>) / Bioconductor (<xref rid="B13" ref-type="bibr">13</xref>) platform, with the underlying code written in C++, R and Python with the <monospace>Rcpp</monospace> (<xref rid="B14" ref-type="bibr">14</xref>) and <monospace>reticulate</monospace> (<xref rid="B15" ref-type="bibr">15</xref>) packages used to wrap the C++ and Python code for R, respectively. Data from both UMI (Unique Molecular Identifiers) and non-UMI protocols can be handled by <monospace>scPipe</monospace>. The pipeline for scATAC-Seq data preprocessing is initiated with <italic toggle="yes">FASTQ</italic> files and outputs include a feature count matrix and a variety of quality control (QC) statistics and a standalone HTML report generated using <monospace>rmarkdown</monospace> (<xref rid="B16" ref-type="bibr">16</xref>) that contains a summary of the QC statistics collected during data preprocessing.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Demultiplexing and read alignment</title>
      <p>Demultiplexing is performed by the <italic toggle="yes">sc_atac_trim_barcode()</italic> function (Figure <xref rid="F1" ref-type="fig">1A</xref>) using a similar approach to that used in <monospace>scPipe</monospace> for scRNA-Seq analysis. The scATAC-Seq module can accommodate data in .<italic toggle="yes">fastq</italic> format as well as .<italic toggle="yes">csv</italic> format, with the user defining which format the data is in and the relevant demultiplexing strategy will be executed. In brief, the barcode is either extracted from the reads themselves based on the entries in a <italic toggle="yes">csv</italic> file where the second column of the file contains the barcodes or from the sequences of a complementary <italic toggle="yes">FASTQ</italic> file and appended to the read names in the <italic toggle="yes">FASTQ</italic> files containing the ATAC sequences.</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of the <monospace>scPipe</monospace> scATAC-Seq module and its QC outputs. <bold>(A)</bold> The pipeline is shown on the left and the QC metrics gathered during preprocessing are shown on the right. Purple coloured boxes denote the inputs and light colour purple define the inputs that are optionally accepted as they are not incorporated into current scATAC-Seq library preparations yet. Blue colour box depicts the final output. Black boxes denote the main pipeline steps that should be followed. Green boxes denote the steps that are running within these the main pipeline without having to call them specifically, still can also be called separately if needed. <bold>(B)</bold> QC plot showing the separation of ‘cell’ and ‘non-cell’ based on the fraction of fragments overlappping peaks (y-axis) vs total number of fragments (x-axis) after cell calling step of scPipe. <bold>(C)</bold> QC plot showing the separation of cell and ‘non-cell’ based on read density (y-axis) versus total number of fragments (x-axis) after cell calling step of scPipe. <bold>(D)</bold> QC plot showing the fraction of features overlapping different functional regions (i.e., Peaks, TSS, Promoter, Enhancer, Mitochondrial genes).</p>
        </caption>
        <graphic xlink:href="lqad105fig1" position="float"/>
      </fig>
      <p>A read correction step is incorporated to ensure sequencing errors that appear in barcodes are identified and removed to avoid unwanted data loss. In summary, after the barcodes are determined, error correction is carried out with a hamming distance of 1 to correct for sequencing errors. Each barcode can be optionally validated against a known list of valid barcodes (either as is or the reverse complement) and the frequency of each valid barcode is then counted. <monospace>scPipe</monospace> corrects barcodes that are not matched to the valid barcode list by allowing for one mismatched base in comparison with the valid barcode list, and counting the number of corrected barcodes in the complete dataset. In the case that multiple sequences are found matching the valid barcode list with one mismatched base, each mismatched base’s quality (Q) score is compared and the sequence with the lowest <italic toggle="yes">Q</italic> score at the mismatch position is considered valid.</p>
      <p>Demultiplexed data is stored in four data files; i.e. complete-match: no error correction was necessary for the data in this file; partial-match: error-corrected reads; no-match: data that were unable to be demultiplexed even after error correction; and full-data: a concatenated version of the data across the 3 aforementioned categories. The user is able to select either one of the more stringent files or the complete dataset for downstream analysis (by default, the complete dataset is used).</p>
      <p>Read alignment is run with the function <italic toggle="yes">sc_aligning()</italic> which uses <italic toggle="yes">Rsubread::align()</italic> (<xref rid="B17" ref-type="bibr">17</xref>) internally (Figure <xref rid="F1" ref-type="fig">1A</xref>). The user has to define the technology (i.e. RNA or ATAC) to execute the most appropriate alignment approach (i.e. single-end alignment for RNA and paired-end for ATAC). The resulting <italic toggle="yes">BAM</italic> file contains the read name in the first column, and unmapped reads are denoted by an asterisk (*).</p>
    </sec>
    <sec id="SEC2-3">
      <title>Demultiplexing aligned reads, removing duplicates, creating fragments and peak calling</title>
      <p>Demultiplexing aligned reads is performed by the <italic toggle="yes">sc_atac_bam_tagging()</italic> function which extracts the barcode information from the read names of the aligned <italic toggle="yes">BAM</italic> file and generates a new column with the tag CB:z: to record the cell barcode (Figure <xref rid="F1" ref-type="fig">1A</xref>). As some reads may not have an assigned barcode, this column in the resulting demultiplexed <italic toggle="yes">BAM</italic> file may be empty in such positions.</p>
      <p>The main difference in the scATAC-Seq module compared to original scRNA-Seq module is the need to extract biological information from both reads in the former. Therefore, it was important to retain both reads (i.e. forward and reverse) for scATAC-Seq data as compared to retaining only the forward of the pair of reads for scRNA-Seq module where reverse will be the barcode followed by the polyA tail, which can be discarded after demultiplexing of the read takes place.</p>
      <p>Removal of duplicate reads uses <monospace>samtools</monospace>, where the <italic toggle="yes">BAM</italic> file is processed with the <italic toggle="yes">removeduplicates</italic> function (<xref rid="B18" ref-type="bibr">18</xref>). This step can be run externally to <monospace>scPipe</monospace> and the resulting <italic toggle="yes">BAM</italic> file can be re-entered to the <monospace>scPipe</monospace> pipeline if <monospace>samtools</monospace> is not installed locally.</p>
      <p>Fragment file generation was adopted from a python-based tool named <monospace>Sinto</monospace> (version 0.8) (<xref rid="B19" ref-type="bibr">19</xref>). Briefly, the fragment file is in .<italic toggle="yes">BED</italic> format created from the aligned read file (i.e. <italic toggle="yes">BAM</italic>) with the position of each Tn5 integration site, barcode of the cell that the fragment belongs to and the number of times the fragment was sequenced while collapsing the PCR duplicates. This is achieved by first extracting the cell barcode sequence associated with each read and adjusting the alignment positions for the 9 bp Tn5 shift by applying +4/−5 to the start and end position of the paired reads. Next, fragments below a certain quality threshold and a size larger than a maximum provided by the user are removed before collapsing any duplicates (if present). This python-based capability was integrated into the <monospace>scPipe</monospace> R package using <monospace>basilisk</monospace> (<xref rid="B20" ref-type="bibr">20</xref>). Feature matrix construction can be via a .<italic toggle="yes">bed</italic> file provided to the workflow (e.g. bulk peak file from <monospace>MACS3</monospace>) or using the reference genome (i.e. ‘<monospace>genome_bin</monospace>’ approach). In the ‘<monospace>genome_bin</monospace>’ approach, the genome is cut in to chunks of user-defined size and the overlap is calculated between the <italic toggle="yes">bed</italic> file and the fragment file. Using such an approach is resource intensive, yet more sensitive to rare open regions than using a bulk approach. Furthermore, being able to converge on the same features via this approach will make downstream integration of the multiple scATAC-Seq data sets more convenient. An optional peak calling step can also be carried out using the R version of <monospace>MACS3</monospace> (<monospace>MACSr</monospace> (<xref rid="B21" ref-type="bibr">21</xref>)) which has been implemented to execute bulk-level peak calling across all the data. This is a faster method than the in-built <italic toggle="yes">genome</italic>−<italic toggle="yes">bin</italic> approach described above to identify features to generate the feature × cell matrix.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Generating the feature × cell matrix, <monospace>SCE</monospace> objects and QC statistics</title>
      <p>The externally created (e.g. via <monospace>Cell Ranger</monospace>) or <monospace>scPipe</monospace> generated feature matrix and fragment file is used as the main input to generate the feature × cell count matrix. This step involves multiple filtering steps including cell calling and row-wise (i.e. feature-level), and column-wise (i.e. cell-level) filtering as well as read correction for the Tn5 cut site. A <italic toggle="yes">GenomicAlignments</italic> object (<xref rid="B22" ref-type="bibr">22</xref>) is generated for the fragments with cell barcode information and the feature file (peaks/bins) with the feature coordinate information which is then overlapped to generate the unfiltered counts matrix. This matrix then enters the cell calling step to distinguish ‘true’ cells from ambient background DNA. It has been previously been shown that filtering cells based on multiple QC metrics is the most effective approach to do cell calling (<xref rid="B7" ref-type="bibr">7</xref>), and this approach has been adopted in <monospace>scPipe</monospace>. This can be called with the parameter <italic toggle="yes">cell_calling=filter</italic> within the <italic toggle="yes">sc_atac_feature_counting()</italic> function. The resulting matrix is then converted to a binary matrix as well as a <italic toggle="yes">SCE</italic> object (<xref rid="B11" ref-type="bibr">11</xref>). An HTML report is generated using <monospace>rmarkdown</monospace> as an optional output of this step. This report summarises the QC metrics gathered during preprocessing to allow data quality to be visually assessed (Figure <xref rid="F1" ref-type="fig">1B−D</xref>), and is easy to share with collaborators. <monospace>ScPipe</monospace>’s ATAC-Seq module also logs all details in the workflow so that a user can track the progress if a step fails or wants to further explore the pipeline parameters used.</p>
    </sec>
    <sec id="SEC2-5">
      <title>Integration of <monospace>SCE</monospace> objects</title>
      <p>Another important aspect of <monospace>scPipe</monospace> is the ability to integrate datasets where a common barcode file is available to match the cells between <italic toggle="yes">SCE</italic> objects to create a combined <italic toggle="yes">SCE</italic> object, as occurs for example in 10X Genomics multiome experiments. The R/Bioconductor package <monospace>MultiAssayExperiment</monospace> is used for this (<xref rid="B23" ref-type="bibr">23</xref>) to output combined <italic toggle="yes">SCE</italic> objects with <monospace>colData()</monospace> from the same barcodes bound together (Figure <xref rid="F1" ref-type="fig">1A</xref>). If there are barcodes with missing data from one or more <italic toggle="yes">SCE</italic> objects, they will still be included with the addition of ‘NAs’ to columns corresponding to the cells that do not share common barcodes. Storing data in this way allows the user to further leverage Bioconductor software and design principles to make biologically relevant inferences (e.g. to correct for batch effects, perform integration and clustering).</p>
    </sec>
    <sec id="SEC2-6">
      <title>Human lung adenocarcinoma cell line dataset</title>
      <p>The cell culture and sample preparation of mixtures of cells from different cell lines was performed as previously described (<xref rid="B24" ref-type="bibr">24</xref>). Briefly, five human lung adenocarcinoma cell lines (A549, H1975, H2228, H838 and HCC827) were obtained from ATCC (<ext-link xlink:href="https://www.atcc.org/" ext-link-type="uri">https://www.atcc.org/</ext-link>) and cultured separately in Roswell Park Memorial Institute (RPMI) 1640 medium with 10% fetal calf serum and 1% penicillin-streptomycin at 37°C with 5% carbon dioxide until near 100% confluency. Cells were counted manually using a hemocytometer and mixed with equal number to form single-cell suspension with around 2 000 000 cells. Cells were permeabilised with nuclei EZ Lysis Buffer from Sigma-Aldrich supplemented with Protector RNase Inhibitor and filtered to isolate nuclei. Nuclei underwent fluorescence-activated nuclei sorting (FANS) and 1 600 000 nuclei were output from the sorter. After concentrating the nuclei suspension to achieve 10 000 nuclei recovery during Gel Bead-In EMulsions (GEM) generation, 11 960 nuclei were input to form GEMs that were used to generate 10× Multiome (GEX + ATAC) libraries. The cDNA library was sequenced using Illumina NextSeq 500 with recommended cycles and the ATAC library was sequenced using Illumina NextSeq 500 with the custom recipe. FASTQ files were then generated with <monospace>Cell Ranger ARC</monospace> 2.0.0 <italic toggle="yes">mkfastq</italic>. The raw data are available from GEO under accession number GSE224045.</p>
      <p>We have processed the scATAC-Seq data in two ways; (i) via the <monospace>Cell Ranger ATAC</monospace> pipeline, and (ii) via the <monospace>scPipe</monospace> pipeline. The scRNA-Seq data was processed through the standard <monospace>Cell Ranger</monospace> pipeline. The paired read were aligned to the hg38 reference. The tool <monospace>demuxlet</monospace> (<xref rid="B25" ref-type="bibr">25</xref>) was used to assign the cell line identity (i.e. ground truth) to the data using variant information as previously described (<xref rid="B24" ref-type="bibr">24</xref>). Next we developed custom scripts (available via GitHub) using mainly <monospace>ggplot2</monospace>(<xref rid="B26" ref-type="bibr">26</xref>), <monospace>Seurat</monospace> (<xref rid="B27" ref-type="bibr">27</xref>) and <monospace>NMI</monospace> R packages to generate plots for visualisation and comparison.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>Results</title>
    <sec id="SEC3-1">
      <title>Resource requirements of <monospace>scPipe</monospace> on scATAC-Seq data</title>
      <p>We ran the <monospace>scPipe</monospace> scATAC-Seq pipeline on both the 20% and 80% GEMs to profile time and memory usage. For the 20% sample, which contains 31,749,732 reads, the pipeline ran for approximately 140 minutes, and required approximately 85 GB of RAM allocated. The longest processing step was <italic toggle="yes">sc_aligning</italic>, which internally uses <monospace>Rsubread</monospace>, and required 63 minutes to complete. For the 80% sample, containing 112,463,635 reads, the pipeline required approximately 604 minutes (10 hours) to complete and 540 GB of RAM allocated.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Downstream comparison between <monospace>scPipe</monospace> and <monospace>Cell Ranger ATAC</monospace></title>
      <p>We compared the clusters identified from <monospace>scPipe</monospace> preprocessed data to those obtained from the <monospace>Cell Ranger ATAC</monospace> pipeline, a popular tool for 10X scATAC-Seq preprocessing. A dataset that contains around 5,800 cells with ground truth available in the form of cell line identity labels obtained using variant information was used to compare the results from the two approaches (Figure <xref rid="F2" ref-type="fig">2A</xref>). <monospace>Cell Ranger</monospace> returned 5728 cells and <monospace>scPipe</monospace> 5599 cells after QC, with 5267 in common (Figure <xref rid="F2" ref-type="fig">2B</xref>). Inspection of features overlapping the mitochondrial genes as a QC metric shows that <monospace>Cell Ranger</monospace> has called more dead/poor quality cells that should be excluded from downstream analysis (Figure <xref rid="F2" ref-type="fig">2C</xref>). On the other hand, the mitochondrial contamination is lower and similar for <monospace>scPipe</monospace>-only called cells and those identified by <monospace>scPipe</monospace> in common with <monospace>Cell Ranger</monospace> (Figure <xref rid="F2" ref-type="fig">2C’</xref>). Overall, there was high concordance between the called cell (Figure <xref rid="F2" ref-type="fig">2D</xref>) and feature counts (Figure <xref rid="F2" ref-type="fig">2D’</xref>) within for the cells in common between the two pipelines. Moreover, ‘<monospace>scPipe</monospace>-only’ called cells contained counts and features that were more similar those found in common than the counts and features from ‘<monospace>Cell Ranger</monospace>-only’ called cells, whose distributions were concentrated towards the lower ranges for both quantities. The UMAP (<xref rid="B28" ref-type="bibr">28</xref>) generated from the <monospace>Cell Ranger</monospace> output shows that the 129 cells that appear in the <monospace>Cell Ranger</monospace> results but not in <monospace>scPipe</monospace> tend to cluster together away from the large clusters or in the margins of them (Figure <xref rid="F2" ref-type="fig">2E</xref>). In contrast, the UMAP generated from the <monospace>scPipe</monospace> output shows that the cells that only appear in <monospace>scPipe</monospace> results but not in <monospace>Cell Ranger</monospace> tend to be located within the main clusters (Figure <xref rid="F2" ref-type="fig">2E’</xref>).</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>Comparing <monospace>scPipe</monospace> and <monospace>Cell Ranger</monospace> on a 10× dataset. <bold>(A)</bold> Summary of experimental design, which used cells from five distinct lung adenocarcinoma cell lines. An equal mixture of cells and nuclei were captured by the 10X protocol, and sequenced on the Illumina platform (see Materials and Methods). <italic toggle="yes">FASTQ</italic> files were generated by <monospace>Cell Ranger ARC</monospace> 2.0.0 and these reads were processed by <monospace>scPipe</monospace> and <monospace>Cell Ranger</monospace>. The panels of this figure pertain to the 80% results. <bold>(B)</bold> Venn diagram showing the overlap of cell barcodes detected by <monospace>Cell Ranger</monospace> and <monospace>scPipe</monospace>. <bold>(C)</bold> Box plot showing the percentage of mitochondrial gene counts in cells that are called by <monospace>Cell Ranger</monospace> and are common with/unique in comparison to <monospace>scPipe</monospace> or (C’) <monospace>scPipe</monospace> and are common with/unique in comparison to <monospace>Cell Ranger</monospace> output. <bold>(D)</bold> Scatter plot of the per cell total counts and <bold>(D’)</bold> number of features per cell obtained from <monospace>Cell Ranger</monospace> and <monospace>scPipe</monospace> in cells called in common between the two and cells that were unique to each of the two pipelines. Marginal density plots show the count distributions for each category. <bold>(E)</bold> UMAP plot generated for <monospace>Cell Ranger</monospace> and <bold>(E’)</bold><monospace>scPipe</monospace> output. Cell barcodes that only exist in (E) <monospace>Cell Ranger</monospace> or (E’) <monospace>scPipe</monospace> are highlighted in red. <bold>(F)</bold> UMAP coloured by the ground truth for <monospace>Cell Ranger</monospace> and <bold>(F’)</bold><monospace>scPipe</monospace>. <monospace>Seurat</monospace> identified clusters are demarcated by coloured lines and numbered. The ARI and NMI values calculated per dataset are shown in the top right of the panels.</p>
        </caption>
        <graphic xlink:href="lqad105fig2" position="float"/>
      </fig>
      <p>Comparison of the cell line labels assigned to these cells using <monospace>demuxlet</monospace> (<xref rid="B25" ref-type="bibr">25</xref>) to the clustering results obtained using the scATAC-Seq data alone in a <monospace>Seurat</monospace> analysis, was made by calculating the adjusted rand index (ARI) and normalised mutual information (NMI) scores which should be closer to 1 when the clustering is highly concordant between the two approaches. For the <monospace>Cell Ranger</monospace> data, an ARI of 0.56 and NMI of 0.64 (Figure <xref rid="F2" ref-type="fig">2F</xref>) were obtained. The <monospace>scPipe</monospace> generated output resulted in a higher ARI of 0.68 and NMI of 0.75 (Figure <xref rid="F2" ref-type="fig">2F’</xref>), indicating better concordance between the <monospace>Seurat</monospace> clustering and <monospace>demuxlet</monospace> results. Taken together, <monospace>scPipe</monospace> seemed to identify higher quality cells that were better separated according to the biological signal present in the data relative to the <monospace>Cell Ranger</monospace> processed data.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>Discussion</title>
    <p>To ensure flexibility, <monospace>scPipe</monospace> can preprocess data from a variety of different scATAC-Seq protocols that includes droplet-based and plate-based methods. <monospace>scPipe</monospace> can also handle combinatorial barcoding options when demultiplexing the reads, and can handle Unique Molecular Identifier (UMI) based scATAC-Seq approaches if they arise in the future. The resulting preprocessed data output by <monospace>scPipe</monospace> is stored in a versatile <italic toggle="yes">SingleCellExperiment</italic> (<italic toggle="yes">SCE</italic>) format, which means that the data can be further analysed downstream using <italic toggle="yes">SCE</italic>-object friendly tools available in R/Bioconductor. We demonstrate that data preprocessing with <monospace>scPipe</monospace>’s scATAC-Seq preprocessing workflow produces comparable results to those from 10×’s <monospace>Cell Ranger ATAC</monospace> pipeline. As the integration of numerous large-scale data modalities becomes more routine, <monospace>scPipe</monospace> provides convenient and scalable preprocessing options for both scRNA-Seq and scATAC-Seq data, allowing data integration and joint analyses.</p>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>Acknowledgements</title>
    <p>This work was supported by funding from the Chan Zuckerberg Initiative DAF, an advised fund of Silicon Valley Community Foundation (Grant No. 2019-002443 to M.E.R.), Australian National Health and Medical Research Council (NHMRC) Investigator Grant (2017257 to M.E.R.), the Australian Research Council (Discovery Project No. 200102903 to M.E.R.), the Genomics Innovation Hub, Victorian State Government Operational Infrastructure Support, Australian Government NHMRC IRIISS and support from the Australian Cancer Research Foundation. The authors are grateful to Dr Saskia Freytag and Mr Reza Ghamsari for providing feedback on this manuscript.</p>
  </ack>
  <sec sec-type="data-availability" id="SEC5">
    <title>Data availability</title>
    <p><monospace>scPipe</monospace>’s scATAC-Seq preprocessing module is available from Bioconductor, DOI: <ext-link xlink:href="https://doi.org/doi:10.18129/B9.bioc.scPipe" ext-link-type="uri">https://doi.org/doi:10.18129/B9.bioc.scPipe</ext-link>. The code used for the timing calculations and generating Figure <xref rid="F2" ref-type="fig">2</xref> (panels B–F) are available from Zenodo, DOI: <ext-link xlink:href="https://zenodo.org/doi/10.5281/zenodo.10185302" ext-link-type="uri">https://zenodo.org/doi/10.5281/zenodo.10185302</ext-link>.</p>
  </sec>
  <sec id="SEC6">
    <title>Funding</title>
    <p>Australian Research Council [200102903]; National Health and Medical Research Council [2017257]; Chan Zuckerberg Initiative [2019-002443].</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>References</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buenrostro</surname>  <given-names>J.D.</given-names></string-name>, <string-name><surname>Wu</surname>  <given-names>B.</given-names></string-name>, <string-name><surname>Litzenburger</surname>  <given-names>U.M.</given-names></string-name>, <string-name><surname>Ruff</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Gonzales</surname>  <given-names>M.L.</given-names></string-name>, <string-name><surname>Snyder</surname>  <given-names>M.P.</given-names></string-name>, <string-name><surname>Chang</surname>  <given-names>H.Y.</given-names></string-name>, <string-name><surname>Greenleaf</surname>  <given-names>W.J.</given-names></string-name></person-group>  <article-title>Single-cell chromatin accessibility reveals principles of regulatory variation</article-title>. <source>Nature</source>. <year>2015</year>; <volume>523</volume>:<fpage>486</fpage>–<lpage>490</lpage>.<pub-id pub-id-type="pmid">26083756</pub-id>
</mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baek</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Lee</surname>  <given-names>I.</given-names></string-name></person-group>  <article-title>Single-cell ATAC sequencing analysis: from data preprocessing to hypothesis generation</article-title>. <source>Comput. Struct. Biotechnol. J.</source>  <year>2020</year>; <volume>18</volume>:<fpage>1429</fpage>–<lpage>1439</lpage>.<pub-id pub-id-type="pmid">32637041</pub-id>
</mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cusanovich</surname>  <given-names>D.A.</given-names></string-name>, <string-name><surname>Hill</surname>  <given-names>A.J.</given-names></string-name>, <string-name><surname>Aghamirzaie</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Daza</surname>  <given-names>R.M.</given-names></string-name>, <string-name><surname>Pliner</surname>  <given-names>H.A.</given-names></string-name>, <string-name><surname>Berletch</surname>  <given-names>J.B.</given-names></string-name>, <string-name><surname>Filippova</surname>  <given-names>G.N.</given-names></string-name>, <string-name><surname>Huang</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Christiansen</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>DeWitt</surname>  <given-names>W.S.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>A Single-cell atlas of in vivo mammalian chromatin accessibility</article-title>. <source>Cell</source>. <year>2018</year>; <volume>174</volume>:<fpage>1309</fpage>–<lpage>1324</lpage>.<pub-id pub-id-type="pmid">30078704</pub-id>
</mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mezger</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Klemm</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Mann</surname>  <given-names>I.</given-names></string-name>, <string-name><surname>Brower</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Mir</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Bostick</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Farmer</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Fordyce</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Linnarsson</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Greenleaf</surname>  <given-names>W.</given-names></string-name></person-group>  <article-title>High-throughput chromatin accessibility profiling at single-cell resolution</article-title>. <source>Nat. Commun.</source>  <year>2018</year>; <volume>9</volume>:<fpage>6</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">29295974</pub-id>
</mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satpathy</surname>  <given-names>A.T.</given-names></string-name>, <string-name><surname>Granja</surname>  <given-names>J.M.</given-names></string-name>, <string-name><surname>Yost</surname>  <given-names>K.E.</given-names></string-name>, <string-name><surname>Qi</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Meschi</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>McDermott</surname>  <given-names>G.P.</given-names></string-name>, <string-name><surname>Olsen</surname>  <given-names>B.N.</given-names></string-name>, <string-name><surname>Mumbach</surname>  <given-names>M.R.</given-names></string-name>, <string-name><surname>Pierce</surname>  <given-names>S.E.</given-names></string-name>, <string-name><surname>Corces</surname>  <given-names>M.R.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Massively parallel single-cell chromatin landscapes of human immune cell development and intratumoral T cell exhaustion</article-title>. <source>Nat. Biotechnol.</source>  <year>2019</year>; <volume>37</volume>:<fpage>925</fpage>–<lpage>936</lpage>.<pub-id pub-id-type="pmid">31375813</pub-id>
</mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lareau</surname>  <given-names>C.A.</given-names></string-name>, <string-name><surname>Duarte</surname>  <given-names>F.M.</given-names></string-name>, <string-name><surname>Chew</surname>  <given-names>J.G.</given-names></string-name>, <string-name><surname>Kartha</surname>  <given-names>V.K.</given-names></string-name>, <string-name><surname>Burkett</surname>  <given-names>Z.D.</given-names></string-name>, <string-name><surname>Kohlway</surname>  <given-names>A.S.</given-names></string-name>, <string-name><surname>Pokholok</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Aryee</surname>  <given-names>M.J.</given-names></string-name>, <string-name><surname>Steemers</surname>  <given-names>F.J.</given-names></string-name>, <string-name><surname>Lebofsky</surname>  <given-names>R.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Droplet-based combinatorial indexing for massive-scale single-cell chromatin accessibility</article-title>. <source>Nat. Biotechnol.</source>  <year>2019</year>; <volume>37</volume>:<fpage>916</fpage>–<lpage>924</lpage>.<pub-id pub-id-type="pmid">31235917</pub-id>
</mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Uzun</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Zhu</surname>  <given-names>Q.</given-names></string-name>, <string-name><surname>Chen</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Tan</surname>  <given-names>K.</given-names></string-name></person-group>  <article-title>scATAC-pro: a comprehensive workbench for single-cell chromatin accessibility sequencing data</article-title>. <source>Genome Biol.</source>  <year>2020</year>; <volume>21</volume>:<fpage>94</fpage>.<pub-id pub-id-type="pmid">32312293</pub-id>
</mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Lareau</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Andreani</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Vinyard</surname>  <given-names>M.E.</given-names></string-name>, <string-name><surname>Garcia</surname>  <given-names>S.P.</given-names></string-name>, <string-name><surname>Clement</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Andrade-Navarro</surname>  <given-names>M.A.</given-names></string-name>, <string-name><surname>Buenrostro</surname>  <given-names>J.D.</given-names></string-name>, <string-name><surname>Pinello</surname>  <given-names>L.</given-names></string-name></person-group>  <article-title>Assessment of computational methods for the analysis of single-cell ATAC-seq data</article-title>. <source>Genome Biol.</source>  <year>2020</year>; <volume>20</volume>:<fpage>241</fpage>.</mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fang</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Preissl</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Li</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Hou</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Lucero</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Motamedi</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Shiau</surname>  <given-names>A.K.</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Xie</surname>  <given-names>F.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Comprehensive analysis of single cell ATAC-seq data with SnapATAC</article-title>. <source>Nat. Commun.</source>  <year>2021</year>; <volume>12</volume>:<fpage>1337</fpage>.<pub-id pub-id-type="pmid">33637727</pub-id>
</mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tian</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Su</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Dong</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Amann-Zalcenstein</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Biben</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Seidi</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Hilton</surname>  <given-names>D.J.</given-names></string-name>, <string-name><surname>Naik</surname>  <given-names>S.H.</given-names></string-name>, <string-name><surname>Ritchie</surname>  <given-names>M.E.</given-names></string-name></person-group>  <article-title>scPipe: a flexible R/Bioconductor preprocessing pipeline for single-cell RNA-sequencing data</article-title>. <source>PLoS Comput. Biol.</source>  <year>2018</year>; <volume>14</volume>:<fpage>e1006361</fpage>.<pub-id pub-id-type="pmid">30096152</pub-id>
</mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amezquita</surname>  <given-names>R.A.</given-names></string-name>, <string-name><surname>Lun</surname>  <given-names>A.T.</given-names></string-name>, <string-name><surname>Becht</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Carey</surname>  <given-names>V.J.</given-names></string-name>, <string-name><surname>Carpp</surname>  <given-names>L.N.</given-names></string-name>, <string-name><surname>Geistlinger</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Marini</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Rue-Albrecht</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Risso</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Soneson</surname>  <given-names>C.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Orchestrating single-cell analysis with Bioconductor</article-title>. <source>Nat. Methods</source>. <year>2019</year>; <volume>17</volume>:<fpage>137</fpage>–<lpage>145</lpage>.<pub-id pub-id-type="pmid">31792435</pub-id>
</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="book"><collab>R Core Team</collab>  <source>R: a Language and Environment for Statistical Computing</source>. <year>2020</year>; <publisher-loc>Vienna, Austria</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huber</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Carey</surname>  <given-names>V.J.</given-names></string-name>, <string-name><surname>Gentleman</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Anders</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Carlson</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Carvalho</surname>  <given-names>B.S.</given-names></string-name>, <string-name><surname>Bravo</surname>  <given-names>H.C.</given-names></string-name>, <string-name><surname>Davis</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Gatto</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Girke</surname>  <given-names>T.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>. <source>Nat. Methods</source>. <year>2015</year>; <volume>12</volume>:<fpage>115</fpage>–<lpage>121</lpage>.<pub-id pub-id-type="pmid">25633503</pub-id>
</mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Eddelbuettel</surname>  <given-names>D.</given-names></string-name></person-group>  <source>Seamless R and C++ Integration with Rcpp</source>. <year>2013</year>; <publisher-loc>NY</publisher-loc><publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Allaire</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Ushey</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Tang</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Eddelbuettel</surname>  <given-names>D.</given-names></string-name></person-group>  <article-title>reticulate: R Interface to Python</article-title>. <year>2017</year>; <uri xlink:href="https://github.com/rstudio/reticulate">https://github.com/rstudio/reticulate</uri>.</mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Allaire</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Xie</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>McPherson</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Luraschi</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Ushey</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Atkins</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Wickham</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Cheng</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Chang</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Iannone</surname>  <given-names>R.</given-names></string-name></person-group>  <article-title>rmarkdown: Dynamic Documents for R , R package version 2.7</article-title>. <year>2021</year>; <uri xlink:href="https://github.com/rstudio/rmarkdown">https://github.com/rstudio/rmarkdown.</uri>.</mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liao</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Smyth</surname>  <given-names>G.K.</given-names></string-name>, <string-name><surname>Shi</surname>  <given-names>W.</given-names></string-name></person-group>  <article-title>The R package Rsubread is easier, faster, cheaper and better for alignment and quantification of RNA sequencing reads</article-title>. <source>Nucleic Acids Res.</source>  <year>2019</year>; <volume>47</volume>:<fpage>e47</fpage>.<pub-id pub-id-type="pmid">30783653</pub-id>
</mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Handsaker</surname>  <given-names>B.</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Fennell</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Ruan</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Homer</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Marth</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Abecasis</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R.</given-names></string-name></person-group>  <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>; <volume>25</volume>:<fpage>2078</fpage>–<lpage>2079</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id>
</mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Stuart</surname>  <given-names>T.</given-names></string-name></person-group>  <article-title>Sinto: single-cell analysis tools</article-title>. <year>2022</year>; <uri xlink:href="https://github.com/timoast/sinto">https://github.com/timoast/sinto</uri>.</mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lun</surname>  <given-names>A.T.L.</given-names></string-name></person-group>  <article-title>basilisk: a Bioconductor package for managing Python environments</article-title>. <source>J. Open Source Softw.</source>  <year>2022</year>; <volume>7</volume>:<fpage>4742</fpage>.</mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hu</surname>  <given-names>Q.</given-names></string-name></person-group>  <article-title>MACSr: MACS: model-based analysis for ChIP-Seq</article-title>. <year>2022</year>; <uri xlink:href="https://bioconductor.org/packages/MACSr">https://bioconductor.org/packages/MACSr</uri>.</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lawrence</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Huber</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Pagès</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Aboyoun</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Carlson</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Gentleman</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Morgan</surname>  <given-names>M.T.</given-names></string-name>, <string-name><surname>Carey</surname>  <given-names>V.J.</given-names></string-name></person-group>  <article-title>Software for Computing and annotating Genomic ranges</article-title>. <source>PLoS Comput. Biol.</source>  <year>2013</year>; <volume>9</volume>:<fpage>e1003118</fpage>.<pub-id pub-id-type="pmid">23950696</pub-id>
</mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramos</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Schiffer</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Re</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Azhar</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Basunia</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Rodriguez</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Chan</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Chapman</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Davis</surname>  <given-names>S.R.</given-names></string-name>, <string-name><surname>Gomez-Cabrero</surname>  <given-names>D.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Software for the integration of multiomics experiments in bioconductor</article-title>. <source>Cancer Res.</source>  <year>2017</year>; <volume>77</volume>:<fpage>e39</fpage>–<lpage>e42</lpage>.<pub-id pub-id-type="pmid">29092936</pub-id>
</mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tian</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Dong</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Freytag</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Cao</surname>  <given-names>K.A.L.</given-names></string-name>, <string-name><surname>Su</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>JalalAbadi</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Amann-Zalcenstein</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Weber</surname>  <given-names>T.S.</given-names></string-name>, <string-name><surname>Seidi</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Jabbari</surname>  <given-names>J.S.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Benchmarking single cell RNA-sequencing analysis pipelines using mixture control experiments</article-title>. <source>Nat. Methods</source>. <year>2019</year>; <volume>16</volume>:<fpage>479</fpage>–<lpage>487</lpage>.<pub-id pub-id-type="pmid">31133762</pub-id>
</mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kang</surname>  <given-names>H.M.</given-names></string-name>, <string-name><surname>Subramaniam</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Targ</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Nguyen</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Maliskova</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Wan</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Wong</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Byrnes</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Lanata</surname>  <given-names>C.M.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Multiplexed droplet single-cell RNA-sequencing using natural genetic variation</article-title>. <source>Nat. Biotechnol.</source>  <year>2017</year>; <volume>36</volume>:<fpage>89</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">29227470</pub-id>
</mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Wickham</surname>  <given-names>H.</given-names></string-name></person-group>  <source>ggplot2: Elegant Graphics for Data Analysis</source>. <year>2016</year>; <publisher-loc>NY</publisher-loc><publisher-name>Springer-Verlag</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Butler</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Hoffman</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Hafemeister</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Papalexi</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>III</surname>  <given-names>W. M.M.</given-names></string-name>, <string-name><surname>Hao</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Stoeckius</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Smibert</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Satija</surname>  <given-names>R.</given-names></string-name></person-group>  <article-title>Comprehensive Integration of Single-Cell Data</article-title>. <source>Cell</source>. <year>2019</year>; <volume>177</volume>:<fpage>1888</fpage>–<lpage>1902</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id>
</mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McInnes</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Healy</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Saul</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Großberger</surname>  <given-names>L.</given-names></string-name></person-group>  <article-title>UMAP: Uniform Manifold Approximation and Projection</article-title>. <source>J. Open Source Softw.</source>  <year>2018</year>; <volume>3</volume>:<fpage>861</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
