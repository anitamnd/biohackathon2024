<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3608065</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-13-291</article-id>
    <article-id pub-id-type="pmid">23137144</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-13-291</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Isotope pattern deconvolution for peptide mass spectrometry by non-negative least squares/least absolute deviation template matching</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Slawski</surname>
          <given-names>Martin</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>ms@cs.uni-saarland.de</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Hussong</surname>
          <given-names>Rene</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>rene.hussong@uni.lu</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Tholey</surname>
          <given-names>Andreas</given-names>
        </name>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>a.tholey@iem.uni-kiel.de</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Jakoby</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>t.jakoby@iem.uni-kiel.de</email>
      </contrib>
      <contrib contrib-type="author" id="A5">
        <name>
          <surname>Gregorius</surname>
          <given-names>Barbara</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>b.gregorius@iem.uni-kiel.de</email>
      </contrib>
      <contrib contrib-type="author" id="A6">
        <name>
          <surname>Hildebrandt</surname>
          <given-names>Andreas</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I5">5</xref>
        <email>ahildebr@uni-mainz.de</email>
      </contrib>
      <contrib contrib-type="author" id="A7">
        <name>
          <surname>Hein</surname>
          <given-names>Matthias</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>hein@cs.uni-saarland.de</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Computer Science, Saarland University, Saarbrücken, Germany</aff>
    <aff id="I2"><label>2</label>Center for Bioinformatics, Saarland University, Saarbrücken, Germany</aff>
    <aff id="I3"><label>3</label>Luxembourg Centre for Systems Biomedicine (LCSB), University of Luxembourg, Esch-sur-AlzetteLuxembourg</aff>
    <aff id="I4"><label>4</label>Division for Systematic Proteome Research, Institute for Experimental Medicine, , Kiel, Germany</aff>
    <aff id="I5"><label>5</label>Institut für Informatik, Johannes-Gutenberg -Universität, Mainz, Germany</aff>
    <pub-date pub-type="collection">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>11</month>
      <year>2012</year>
    </pub-date>
    <volume>13</volume>
    <fpage>291</fpage>
    <lpage>291</lpage>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>3</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>10</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2012 Slawski et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>Slawski et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/13/291"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>The robust identification of isotope patterns originating from peptides being analyzed through mass spectrometry (MS) is often significantly hampered by noise artifacts and the interference of overlapping patterns arising e.g. from post-translational modifications. As the classification of the recorded data points into either ‘noise’ or ‘signal’ lies at the very root of essentially every proteomic application, the quality of the automated processing of mass spectra can significantly influence the way the data might be interpreted within a given biological context.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We propose non-negative least squares/non-negative least absolute deviation regression to fit a raw spectrum by templates imitating isotope patterns. In a carefully designed validation scheme, we show that the method exhibits excellent performance in pattern picking. It is demonstrated that the method is able to disentangle complicated overlaps of patterns.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>We find that regularization is not necessary to prevent overfitting and that thresholding is an effective and user-friendly way to perform feature selection. The proposed method avoids problems inherent in regularization-based approaches, comes with a set of well-interpretable parameters whose default configuration is shown to generalize well without the need for fine-tuning, and is applicable to spectra of different platforms. The <monospace>R</monospace> package <monospace>IPPD</monospace> implements the method and is available from the Bioconductor platform (<ext-link ext-link-type="uri" xlink:href="http://bioconductor.fhcrc.org/help/bioc-views/devel/bioc/html/IPPD.html">http://bioconductor.fhcrc.org/help/bioc-views/devel/bioc/html/IPPD.html</ext-link>).</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Mass spectrometry (MS), often in conjunction with high performance liquid chromatography (HPLC), is the de-facto standard analytical tool to derive important biological knowledge about the protein content of whole cells, organelles, or biomedical samples like tumour or blood plasma. Within a typical experimental setup, purified proteins of the sample under study are digested by an enzyme. Before entering the mass spectrometer, peptides are separated chromatographically according to their physico-chemical properties in order to avoid a massive overlapping of peptide signals within a single scan. Nevertheless, due to the sheer number of peptides present in a sample, interfering patterns still occur frequently, not least because of post-translational modifications such as the deamidation of asparagines or glutamine residues. In order to obtain an unambiguous assignment of the signals, and in particular their isotope patterns, which is a prerequisite for a proper identification and quantification, every data point in <italic>m</italic>/<italic>z</italic>
dimension is classified either as ‘signal’ or as ‘noise’ during the so-called feature detection phase. As this processing lies at the very root of every proteomic application, the quality of feature detection can have dramatic impact on the finally derived results and conclusions. In view of the large amount of data even a single MS experiment can produce, automated analysis is indispensable. However, due to various artifacts arising from electric and chemical noise and baseline trends, the identification of isotope patterns is error-prone and time consuming. In addition, severe overlaps of peptide signals within the same mass spectrometric scan can hamper a straightforward analysis furthermore. In recent years, numerous procedures have been developed to process this data (cf., e.g., [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B8">8</xref>]). Within this paper, we propose a novel method that is demonstrated to perform especially well in challenging situations, characterized e.g. by strong local variations in noise and intensity levels or the presence of isotope patterns of different charges exhibiting overlap, which in many cases may be difficult to resolve even for a human expert by visual inspection. Existing software typically depends on a large set of parameters requiring careful fine-tuning, often being rather sensitive to changes in the measurement process like the change of the platform, which makes a proper parameter choice a laboursome task. In contrast, the proposed method has been designed to depend on a comparatively small set of well-interpretable parameters whose default configuration is shown to be robust, yielding mostly excellent, but at least competitive performance on spectra of different platforms. In a nutshell, our method uses non-negative least squares or non-negative least absolute deviation regression to fit a spectrum <italic>s</italic> by a large dictionary of templates mimicking isotope patterns; since true positions and charges of isotope patterns in the spectrum are unknown in advance, regions where the signal exceeds a local measure of noise are identified and then a vast set of templates is placed in those regions. In the spirit of sparse recovery, a small subset of the templates, which reasonably explains the observed signal, is selected by applying hard thresholding with a locally adaptive choice of the threshold to the regression coefficients obtained previously. Our method is related to a formerly proposed template-based approach (<monospace>NITPICK</monospace>, [<xref ref-type="bibr" rid="B3">3</xref>]). As opposed to the present work, <monospace>NITPICK</monospace> uses <italic>ℓ</italic><sub>1</sub>-regularized non-negative least squares. Without non-negativity constraints, this procedure is known as the lasso [<xref ref-type="bibr" rid="B9">9</xref>]. Reference [<xref ref-type="bibr" rid="B10">10</xref>] contains the first application of the lasso to the problem studied in the present paper. Given a dramatic increase in occurrence of high-dimensional datasets in recent years and the resulting need for feature selection, the lasso, due to computationally and theoretically appealing properties, has meanwhile become so popular that it can be regarded as a standard tool of modern data analysis [<xref ref-type="bibr" rid="B11">11</xref>]. In this respect, <monospace>NITPICK</monospace> follows the usual paradigm suggesting that <italic>ℓ</italic><sub>1</sub>-regularization is the method of choice. In the present paper, we argue for a deviation from that paradigm mainly in view of the following two aspects. First, a major benefit of our fitting+thresholding approach is that parameter choice is more user-friendly, since the threshold can be interpreted in terms of a signal-to-noise ratio. This is unlike the regularization parameter of the lasso, which can in general not be related directly to the signal. In the presence of heterogeneous noise and model misspecifications, the ‘right amount’ of regularization is notoriously difficult to choose. Second, there is a substantial body of work showing that non-negativity constraints alone may suffice to recover a sparse target. Non-negative least squares + thresholding is analyzed in [<xref ref-type="bibr" rid="B12">12</xref>], where it is shown that it can significantly outperform the usual <italic>ℓ</italic><sub>1</sub>-approach with respect to sparse recovery. See Section “Sparse recovery with non-negativity constraints: non-negative least squares + thresholding vs. the non-negative lasso” for a detailed discussion.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>A spectrum is understood as a sequence of pairs <inline-formula><mml:math id="M1" name="1471-2105-13-291-i1" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, where <italic>x</italic><sub><italic>i</italic></sub>=<italic>m</italic><sub><italic>i</italic></sub>/<italic>z</italic><sub><italic>i</italic></sub> is a mass (<italic>m</italic><sub><italic>i</italic></sub>, measured in Dalton <italic>Da</italic>) to charge (<italic>z</italic><sub><italic>i</italic></sub>), and <italic>y</italic><sub><italic>i</italic></sub>
is the intensity, i.e. the abundance of a particular mass (modulo charge state), observed at <italic>x</italic><sub><italic>i</italic></sub>, <italic>i</italic>=1,…,<italic>n</italic>, which are assumed to be ordered increasingly.</p>
    <sec>
      <title>Template model</title>
      <p>The <inline-formula><mml:math id="M2" name="1471-2105-13-291-i2" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi></mml:math></inline-formula> are modeled as a positive combination of templates designed on the basis of prior knowledge about peak shape and composition of isotope patterns. If our model were perfectly correct, we could write
</p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <mml:math id="M3" name="1471-2105-13-291-i3" overflow="scroll">
            <mml:mi mathvariant="bold-italic">y</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mstyle mathvariant="bold">
              <mml:mo>Φ</mml:mo>
            </mml:mstyle>
            <mml:msup>
              <mml:mrow>
                <mml:mstyle mathvariant="bold-italic">
                  <mml:mi>β</mml:mi>
                </mml:mstyle>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>∗</mml:mo>
              </mml:mrow>
            </mml:msup>
            <mml:mo>=</mml:mo>
            <mml:munderover>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>C</mml:mi>
              </mml:mrow>
            </mml:munderover>
            <mml:msub>
              <mml:mrow>
                <mml:mstyle mathvariant="bold-italic">
                  <mml:mo>Φ</mml:mo>
                </mml:mstyle>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msubsup>
              <mml:mrow>
                <mml:mstyle mathvariant="bold-italic">
                  <mml:mi>β</mml:mi>
                </mml:mstyle>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>∗</mml:mo>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:mspace width="0.3em"/>
            <mml:msub>
              <mml:mrow>
                <mml:mstyle mathvariant="bold-italic">
                  <mml:mo>Φ</mml:mo>
                </mml:mstyle>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mo>[</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mstyle mathvariant="bold-italic">
                  <mml:mi>φ</mml:mi>
                </mml:mstyle>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mo>…</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mstyle mathvariant="bold-italic">
                  <mml:mi>φ</mml:mi>
                </mml:mstyle>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:msub>
            <mml:mo>]</mml:mo>
            <mml:mo>,</mml:mo>
            <mml:mspace width="2.77695pt"/>
            <mml:mspace width="2.77695pt"/>
            <mml:mi>c</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mo>…</mml:mo>
            <mml:mo>,</mml:mo>
            <mml:mi>C</mml:mi>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <bold>
Φ
</bold> is a non-negative matrix of templates and <bold><italic>β</italic></bold><sup>∗</sup> is a non-negative coefficient vector. Both <bold>
Φ
</bold> and <bold><italic>β</italic></bold><sup>∗</sup> can be arranged according to charge states <italic>c</italic>=1,…,<italic>C</italic>. Each sub-matrix <bold>
Φ
</bold><sub><italic>c</italic></sub> can in turn be divided into columns <inline-formula><mml:math id="M4" name="1471-2105-13-291-i4" overflow="scroll"><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>φ</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>φ</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, where the entries of each column vector store the evaluations of a template <italic>φ</italic><sub><italic>c</italic>,<italic>j</italic></sub>, <italic>j</italic>=1,…,<italic>p</italic><sub><italic>c</italic></sub>, at the <italic>x</italic><sub><italic>i</italic></sub>, <italic>i</italic>=1,…,<italic>n</italic>. It is assumed that only a small fraction of the templates in <bold>
Φ
</bold> are needed to represent the signal, i.e. <bold><italic>β</italic></bold><sup>∗</sup>
is highly sparse. The templates are of the form
</p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <mml:math id="M5" name="1471-2105-13-291-i5" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>φ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:munder>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
                <mml:mo>∈</mml:mo>
              </mml:mrow>
            </mml:munder>
            <mml:msub>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mspace width="2.77695pt"/>
            <mml:msub>
              <mml:mrow>
                <mml:mi>ψ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>k</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold-italic">
                      <mml:mi>휃</mml:mi>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>where the <italic>ψ</italic><sub><italic>c</italic>,<italic>j</italic>,<italic>k</italic></sub>
are functions representing a single peak within an isotope pattern, depending on a location <italic>m</italic><sub><italic>c</italic>,<italic>j</italic></sub> and a parameter vector <bold><italic>θ</italic></bold><sub><italic>c</italic>,<italic>j</italic></sub>. In general, peaks can be modeled by Gaussian, Lorentzian, and sech<sup>2</sup> shapes, cf. [<xref ref-type="bibr" rid="B13">13</xref>]. Due to their similarity, we restrict ourselves to the Gaussian, but provide in addition the exponentially modified Gaussian (EMG, cf., e.g., [<xref ref-type="bibr" rid="B14">14</xref>]), a model for a possibly skewed peak as occuring frequently in MALDI-TOF recordings, where late ion formation in the gas phase leads to tailed peaks [<xref ref-type="bibr" rid="B15">15</xref>]. The EMG is parameterized by <inline-formula><mml:math id="M6" name="1471-2105-13-291-i6" overflow="scroll"><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>휃</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:math></inline-formula> (for <italic>α</italic><sub><italic>c</italic>,<italic>j</italic></sub><italic>↓</italic>0, one obtains a Gaussian)
</p>
      <p>
        <disp-formula id="bmcM3">
          <label>(3)</label>
          <mml:math id="M7" name="1471-2105-13-291-i7" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>ψ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>j</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>(</mml:mo>
                  <mml:mi>x</mml:mi>
                  <mml:mo>)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>α</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>c</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>exp</mml:mo>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:munderover>
                            <mml:mrow>
                              <mml:mi>σ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>c</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:munderover>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                          <mml:munderover>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>c</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:munderover>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:mo>+</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>μ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>c</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:mo>(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>m</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>c</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>j</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>k</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>c</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mspace width="6em"/>
                  <mml:mo>×</mml:mo>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:mi>F</mml:mi>
                      <mml:mfenced open="(" close=")">
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>σ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>c</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>j</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>α</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>c</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>j</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mfrac>
                          <mml:mo>+</mml:mo>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>μ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>c</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>j</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:mo>(</mml:mo>
                              <mml:mi>x</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>m</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>c</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>j</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>k</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>σ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>c</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>j</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:mspace width="3em"/>
                  <mml:mi>F</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi>t</mml:mi>
                  <mml:mo>)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi mathsize="big">∫</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mi>∞</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msqrt>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                          <mml:mi>Π</mml:mi>
                        </mml:mrow>
                      </mml:msqrt>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>exp</mml:mo>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mi>u</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mi>du.</mml:mi>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>In (2), the nonnegative weights <italic>a</italic><sub><italic>c</italic>,<italic>j</italic>,<italic>k</italic></sub>
equal the height of the isotopic peak <italic>k</italic> within the pattern <italic>j</italic> of charge state <italic>c</italic>. These heights are computed according to the averagine model [<xref ref-type="bibr" rid="B16">16</xref>]. The <italic>m</italic><sub><italic>c</italic>,<italic>j</italic>,<italic>k</italic></sub> are calculated from <italic>m</italic><sub><italic>c</italic>,<italic>j</italic></sub>
as <inline-formula><mml:math id="M8" name="1471-2105-13-291-i8" overflow="scroll"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>κ</mml:mi><mml:mfrac><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>, where <italic>κ</italic>
usually ranges between 1.002 and 1.008 Dalton, see e.g. [<xref ref-type="bibr" rid="B17">17</xref>]. Note that in Eq. (2) the location of the most intense peak (<italic>a</italic><sub><italic>c</italic>,<italic>j</italic>,0</sub>=max<sub><italic>k</italic></sub><italic>a</italic><sub><italic>c</italic>,<italic>j</italic>,<italic>k</italic></sub>) is taken as characteristic location of the template instead of using the finally reported monoisotopic position: we set <italic>m</italic><sub><italic>c</italic>,<italic>j</italic>,0</sub>=<italic>m</italic><sub><italic>c</italic>,<italic>j</italic></sub> so that the remaining <italic>m</italic><sub><italic>c</italic>,<italic>j</italic>,<italic>k</italic></sub>, <italic>k</italic>≠0, are computed by shifting <italic>m</italic><sub><italic>c</italic>,<italic>j</italic></sub> in both directions along the <italic>m</italic>/<italic>z</italic> axis. With the normalization max<sub><italic>x</italic></sub><italic>φ</italic><sub><italic>c</italic>,<italic>j</italic></sub>(<italic>x</italic>)=1 for all <italic>c,j</italic>, the entries of <bold><italic>β</italic></bold><sup>∗</sup>
can be interpreted as intensities of the most intense peaks of the templates. The construction scheme is illustrated in Figure <xref ref-type="fig" rid="F1">1</xref>.
</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>Template model.</bold> Illustration of the template construction (charge state <italic>c</italic>=2) for an EMG peak shape with a moderately strong right tailing.</p>
        </caption>
        <graphic xlink:href="1471-2105-13-291-1"/>
      </fig>
    </sec>
    <sec>
      <title>Parameter estimation</title>
      <p>The parameters <italic>θ</italic><sub><italic>c</italic>,<italic>j</italic></sub>=(<italic>α</italic><sub><italic>c</italic>,<italic>j</italic></sub><italic>σ</italic><sub><italic>c</italic>,<italic>j</italic></sub><italic>μ</italic><sub><italic>c</italic>,<italic>j</italic></sub>)<sup>⊤</sup>
of the peaks (3) are unknown in practice. Following a central paradigm of our framework, which is to relieve the user of performing laboursome fine-tuning of parameters, we have developed a systematic procedure automatically providing estimates of these parameters, which is considerably more efficient and flexible than a grid search. For instance, the parameters may additionally depend on the <italic>m</italic>/<italic>z</italic>-position. Our framework for parameter estimation extends a conceptually similar approach in [<xref ref-type="bibr" rid="B18">18</xref>] designed for a Gaussian peak shape.</p>
      <p>In a first step, we apply a simple peak detection algorithm to the spectrum to identify disjoint regions <inline-formula><mml:math id="M9" name="1471-2105-13-291-i9" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>⊂</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2.77695pt"/><mml:mspace width="2.77695pt"/><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:math></inline-formula>, of well-resolved peaks. For each region, we fit the chosen peak shape to the data <inline-formula><mml:math id="M10" name="1471-2105-13-291-i10" overflow="scroll"><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> using nonlinear least squares:
</p>
      <p>
        <disp-formula id="bmcM4">
          <label>(4)</label>
          <mml:math id="M11" name="1471-2105-13-291-i11" overflow="scroll">
            <mml:munder>
              <mml:mrow>
                <mml:mo>min</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mstyle mathvariant="bold-italic">
                  <mml:mi>휃</mml:mi>
                </mml:mstyle>
              </mml:mrow>
            </mml:munder>
            <mml:munder>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>∈</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="script">R</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:munder>
            <mml:msup>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>y</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>−</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ψ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold-italic">
                      <mml:mi>휃</mml:mi>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>yielding an estimate <inline-formula><mml:math id="M12" name="1471-2105-13-291-i12" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>휃</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>, where <inline-formula><mml:math id="M13" name="1471-2105-13-291-i13" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denotes an estimation for the mode of the peak in region <inline-formula><mml:math id="M14" name="1471-2105-13-291-i14" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. This concept is sketched in Figure <xref ref-type="fig" rid="F2">2</xref>. The nonlinear least squares problem (4) is solved by using a general purpose nonlinear least squares routine available in most scientific computing environments, e.g. <monospace>nls</monospace> in <monospace>R</monospace>. Once the sequence of estimators <inline-formula><mml:math id="M15" name="1471-2105-13-291-i15" overflow="scroll"><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>휃</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:math></inline-formula> has been obtained, they are subject to a suitable aggregation procedure. In the simplest case, one could simply take averages. For spectra where peak shape characteristics, in particular peak width, are known to vary systematically with <italic>m</italic>/<italic>z</italic> position, we use the pairs <inline-formula><mml:math id="M16" name="1471-2105-13-291-i16" overflow="scroll"><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>휃</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:math></inline-formula> as input into a linear regression procedure to infer the parameters of pre-specified trend functions. Formally, we model each component <italic>θ</italic><sub><italic>l</italic></sub> of <bold><italic>θ</italic></bold> as a linear combination of known functions <italic>g</italic><sub><italic>l</italic>,<italic>m</italic></sub>
of <italic>x</italic>=<italic>m</italic>/<italic>z</italic> and an error component <italic>ε</italic><sub><italic>l</italic></sub>, i.e.
</p>
      <p>
        <disp-formula id="bmcM5">
          <label>(5)</label>
          <mml:math id="M17" name="1471-2105-13-291-i17" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>휃</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:munderover>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:munderover>
            <mml:msub>
              <mml:mrow>
                <mml:mi>ν</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>l</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>m</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>g</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>l</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>m</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>ε</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>for which a linear trend i.e. <italic>θ</italic><sub><italic>l</italic></sub>(<italic>x</italic>)=<italic>ν</italic><sub><italic>l</italic>,1</sub> + <italic>ν</italic><sub><italic>l</italic>,2</sub><italic>x</italic>, is one of the most common special cases. In [<xref ref-type="bibr" rid="B19">19</xref>], a set of instrument-specific models for the peak width is provided, all of which can be fitted by our approach.
</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Parameter estimation.</bold> Illustration of peak parameter estimation. The figure displays a well-resolved peak in the region <inline-formula><mml:math id="M18" name="1471-2105-13-291-i18" overflow="scroll"><mml:mi mathvariant="script">R</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mspace width="2.77695pt"/><mml:mn>941</mml:mn><mml:mi>.</mml:mi><mml:mn>3</mml:mn><mml:mspace width="2.77695pt"/><mml:mi mathvariant="italic">Th</mml:mi><mml:mspace width="2.77695pt"/><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>941</mml:mn><mml:mi>.</mml:mi><mml:mn>9</mml:mn><mml:mspace width="2.77695pt"/><mml:mi mathvariant="italic">Th</mml:mi><mml:mo>}</mml:mo></mml:math></inline-formula>. In this example, the size of <inline-formula><mml:math id="M19" name="1471-2105-13-291-i19" overflow="scroll"><mml:mi mathvariant="script">R</mml:mi></mml:math></inline-formula> equals 33, i.e. there are 33 pairs {(<italic>x</italic><sub><italic>i</italic></sub>,<italic>y</italic><sub><italic>i</italic></sub>)}
that enter a nonlinear least squares problem of the form (4). Under the assumption of an EMG model, the resulting fit is indicated by a solid line.</p>
        </caption>
        <graphic xlink:href="1471-2105-13-291-2"/>
      </fig>
      <p>We refrain from using least squares regression to determine the parameters in (5) due to its sensitivity to possible outliers, which arise from poorly resolved, wiggly or overlapping isotope patterns, which may affect the quality of the estimates <inline-formula><mml:math id="M20" name="1471-2105-13-291-i20" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>휃</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Therefore, the linear model is fitted in a robust way by using least absolute deviation regression. Given the resulting estimates of the parameters {<italic>ν</italic><sub><italic>l</italic>,<italic>m</italic></sub>}, <italic>m</italic>/<italic>z</italic>-specific estimates for the parameters in (3) are obtained by evaluating (5).</p>
    </sec>
    <sec>
      <title>Template fitting</title>
      <p>The computation of the design matrix <bold>
Φ
</bold>
requires a set of <italic>m</italic>/<italic>z</italic>
positions at which templates are placed. In general, one has to choose positions from the interval [<italic>x</italic><sub>1</sub>,<italic>x</italic><sub><italic>n</italic></sub>]. We instead restrict ourselves to a suitable subset of the set <inline-formula><mml:math id="M21" name="1471-2105-13-291-i21" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. The deviations from the positions of the true underlying isotope patterns is then at least in the order of the sampling rate, but this can be improved by means of a postprocessing step described in Section “Postprocessing and thresholding”. Using the whole set <inline-formula><mml:math id="M22" name="1471-2105-13-291-i22" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> may be computationally infeasible if <italic>n</italic> is large and is in fact not necessary since isotope patterns occur very sparsely in the spectrum. Therefore, we apply a pre-selection step on the basis of what we term ‘local noise level’ (LNL). The LNL is defined as the median of the intensities <italic>y</italic><sub><italic>i</italic></sub>
falling into a sliding window of fixed width around a specific position. For <italic>x</italic>∈[<italic>x</italic><sub>1</sub>,<italic>x</italic><sub><italic>n</italic></sub>], we define the local noise level based on sliding window width <italic>h</italic> as
</p>
      <p>
        <disp-formula id="bmcM6">
          <label>(6)</label>
          <mml:math id="M23" name="1471-2105-13-291-i23" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>LNL</mml:mtext>
                  <mml:mo>(</mml:mo>
                  <mml:mi>x</mml:mi>
                  <mml:mo>)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mtext>median</mml:mtext>
                  <mml:mo>(</mml:mo>
                  <mml:mo>{</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>y</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>:</mml:mo>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mi>i</mml:mi>
                  <mml:mo>∈</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="script">I</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>}</mml:mo>
                  <mml:mo>)</mml:mo>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mspace width="2.4em"/>
                      <mml:mi mathvariant="script">I</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mo>{</mml:mo>
                  <mml:mi>i</mml:mi>
                  <mml:mo>:</mml:mo>
                  <mml:mspace width="2.77695pt"/>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>∈</mml:mo>
                  <mml:mo>[</mml:mo>
                  <mml:mi>x</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mi>h</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>x</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:mi>h</mml:mi>
                  <mml:mo>]</mml:mo>
                  <mml:mo>}</mml:mo>
                  <mml:mi>.</mml:mi>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>Given the LNL, we place templates at position <italic>x</italic><sub><italic>i</italic></sub>
(one for each charge state) if the corresponding <italic>y</italic><sub><italic>i</italic></sub>
exceeds LNL(<italic>x</italic><sub><italic>i</italic></sub>)
by a factor <monospace>factor.place</monospace>. Section “Finding a set of default parameters” describes how we determined defaults for the two parameters <italic>h</italic> and <monospace>factor.place</monospace>. In fact, the LNL is a central quantity in our framework, because it does not only influence the placement, but also the selection of templates (see Section “Postprocessing and thresholding” below). Choosing <italic>h</italic> too small typically has the effect that the LNL is overestimated such that true peaks might be incorrectly classified as noise. Conversely, choosing <italic>h</italic> too large leads to an underestimation, thereby increasing the computational burden as well as the number of spurious patterns included in the final list. The advantages of working with the median are obvious: easy computation, robustness and equivariance with respect to monotone transformations. Similar notions of local noise can be found in the literature, see e.g. [<xref ref-type="bibr" rid="B8">8</xref>] where a truncated mean is used. Given the positions of the templates, we generate the matrix <bold>
Φ
</bold>
according to Eqs. (1) and (2). In the fitting step, we compute a non-negative least squares (<italic>q</italic>=2) or alternatively non-negative least absolute deviation (<italic>q</italic>=1) fit by determining a minimizer <inline-formula><mml:math id="M24" name="1471-2105-13-291-i24" overflow="scroll"><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> of the criterion
</p>
      <p>
        <disp-formula id="bmcM7">
          <label>(7)</label>
          <mml:math id="M25" name="1471-2105-13-291-i25" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:munder>
                    <mml:mrow>
                      <mml:mo>min</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>β</mml:mi>
                      </mml:mstyle>
                      <mml:mo>≥</mml:mo>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mn>0</mml:mn>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:munder>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mfenced open="∥" close="∥">
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">y</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mo>Φ</mml:mo>
                          </mml:mstyle>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mi>β</mml:mi>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>q</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>q</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mi>q</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mtext>or</mml:mtext>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mi>q</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>The optimization problem (7) is a quadratic (<italic>q</italic>=2) or linear (<italic>q</italic>=1) program and is solved using interior point methods (e.g. [<xref ref-type="bibr" rid="B20">20</xref>]). The details are relegated to Appendix “Fitting with non-negativity constraints” section. As far as the choice of <italic>q</italic> is concerned, we point out that <italic>q</italic>=1 yields a robust fit that can deal better with deviations from model assumptions, i.e. deviations from the averagine model or from the peak model. However, in general, we are unable to provide any recommendation about how to choose <italic>q</italic>. Therefore, in our validation, both are evaluated.</p>
      <sec>
        <title>Comparison with pepex</title>
        <p>In prior work [<xref ref-type="bibr" rid="B21">21</xref>], subsequently referred to as ‘pepex’, non-negative least squares fitting is used as well. An important difference to our approach is that the matrix <bold>
Φ
</bold> is not constructed from the convolution of isotope distributions and peak shapes as described in Section “Template model”. Instead, peak detection is applied first to reduce the raw intensity data to peak clusters, a step that is usually referred to as centroiding. At the second stage, called de-isotoping, peak clusters are fitted by a design matrix containing isotope distributions themselves, not convolved versions. While the approach is computationally more attractive and avoids estimation of peak shape parameters (cf. Section “Parameter estimation”), the division into centroiding and de-isotoping may lead to poor performance for low resolution and noisy data, or in the presence of overlapping patterns. In these cases, peak detection is little reliable. In our template-based approach, there is no separation of centroiding and de-isotoping. It performs much better in the aforementioned cases, since it operates directly on the data and is hence less affected if single peaks of a pattern are difficult to detect. This reasoning is supported by our evaluation in Section “Results and discussion” as well as that in [<xref ref-type="bibr" rid="B3">3</xref>]. At the same time, our approach can in principle be applied to centroided spectra as well. In this case, the columns of the matrix <bold>
Φ
</bold> directly represent isotope distributions instead of isotopic patterns.</p>
      </sec>
    </sec>
    <sec>
      <title>Postprocessing and thresholding</title>
      <p>While indeed a considerable fraction of the entries of <inline-formula><mml:math id="M26" name="1471-2105-13-291-i26" overflow="scroll"><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> are precisely equal to zero, treating all positions for which the corresponding entry differs from zero as locations of isotope patterns would yield a huge number of false positives, at least because of regions, in which noise fitting reduces the objective in (7). Therefore, the fitting step of the previous section is accompanied by a thresholding step, with the aim to separate signal from noise. However, fitting followed by thresholding alone does not lead to a proper output. The strategy could be successful if our template model were free of any kind of misspecification. Even when neglecting possible misfits of the averagine model, we still have to cope with two sources of systematic errors − a limited sampling rate and mismatches in the peak model. These are the main reasons for what we term ‘peak splitting’, referring to the phenomenon that several templates are used to fit precisely one pattern. Figure <xref ref-type="fig" rid="F3">3</xref> illustrates the effect of sampling in a noiseless setting. In the top panel, the signal is sampled in such a way that the top of the peak is lost. When placing two templates at the two sampling points <italic>x</italic><sub><italic>l</italic></sub><italic>x</italic><sub><italic>u</italic></sub>
of maximum signal, non-negative least squares fitting attributes weights <inline-formula><mml:math id="M27" name="1471-2105-13-291-i27" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of roughly equal size to the templates. The postprocessing procedure outlined below yields a suitable correction. One might object that ‘peak splitting’ is a problem inherent in our entirely fitting-oriented approach (7) not incorporating any form of regularization. The bottom panel of Figure <xref ref-type="fig" rid="F3">3</xref> shows the solution path of the non-negative lasso [<xref ref-type="bibr" rid="B22">22</xref>] given by <inline-formula><mml:math id="M28" name="1471-2105-13-291-i28" overflow="scroll"><mml:mo>{</mml:mo><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2.77695pt"/><mml:mi>λ</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2.77695pt"/><mml:mspace width="2.77695pt"/><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>argmin</mml:mtext></mml:mrow><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle><mml:mo>≥</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mfenced open="∥" close="∥"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mo>Φ</mml:mo></mml:mstyle><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mn>1</mml:mn></mml:mstyle></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:math></inline-formula>. One obtains two nearly parallel trajectories, demonstrating that only a heavily biased fit, which would undesirably lead to the exclusion of additional smaller signals, could accomplish the selection of only one template.
</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Peak splitting.</bold> Lower panel: Non-negative least squares fit of the sampled signal with and without postprocessing. Upper panel: Solution path of the non-negative lasso for the same data.</p>
        </caption>
        <graphic xlink:href="1471-2105-13-291-3"/>
      </fig>
      <p>To a large extent, ‘peak splitting’ can be corrected by means of the following merging procedure, which we regard as postprocessing of the fitting step (7) and which we apply prior to thresholding. Given an estimate <inline-formula><mml:math id="M29" name="1471-2105-13-291-i29" overflow="scroll"><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>, we define <inline-formula><mml:math id="M30" name="1471-2105-13-291-i30" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mspace width="2.77695pt"/><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>⊂</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="2.77695pt"/><mml:mspace width="2.77695pt"/><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo></mml:math></inline-formula> as the set of all template locations where the corresponding coefficient exceeds 0.
</p>
      <p>1. Separately for each <italic>c</italic>, divide the sets <inline-formula><mml:math id="M31" name="1471-2105-13-291-i31" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> into groups <inline-formula><mml:math id="M32" name="1471-2105-13-291-i32" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> of ‘adjacent’ positions. Positions are said to be adjacent if their distance on the <italic>m</italic>/<italic>z</italic>
scale is below a certain tolerance <monospace>ppm</monospace> specified in parts-per-million, cf. Section “Finding a set of default parameters”. In the context of ‘peak splitting’, the templates at locations sharing the same group are assumed to fit precisely one true underlying peak.</p>
      <p>2. With the notation of Eq. (2), for each <italic>c</italic>=1,…,<italic>C</italic>,
and for <italic>g</italic>=1,…,<italic>G</italic><sub><italic>c</italic></sub>, we solve the following optimization problem.
</p>
      <p>
        <disp-formula id="bmcM8">
          <label>(8)</label>
          <mml:math id="M33" name="1471-2105-13-291-i33" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mover accent="false">
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                        </mml:mrow>
                        <mml:mo>~</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mover accent="false">
                        <mml:mrow>
                          <mml:mi>β</mml:mi>
                        </mml:mrow>
                        <mml:mo>~</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mtext>argmin</mml:mtext>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>m</mml:mi>
                            <mml:mrow>
                              <mml:mtext>c,g</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:munder>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>β</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>c</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>g</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mspace width="0.3em"/>
                  <mml:mspace width="0.3em"/>
                  <mml:munderover accentunder="false" accent="false">
                    <mml:mrow>
                      <mml:mi mathsize="big">∫</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mi>∞</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>∞</mml:mi>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mspace width="0.3em"/>
                  <mml:mspace width="0.3em"/>
                  <mml:mspace width="0.3em"/>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mfenced open="(" close=")">
                        <mml:mrow>
                          <mml:munder>
                            <mml:mrow>
                              <mml:mi mathsize="big">∑</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>m</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>c</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>j</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>∈</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi mathvariant="script">G</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>c</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>g</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:munder>
                          <mml:mspace width="0.3em"/>
                          <mml:mspace width="0.3em"/>
                          <mml:mspace width="0.3em"/>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="false">
                                <mml:mrow>
                                  <mml:mi>β</mml:mi>
                                </mml:mrow>
                                <mml:mo>^</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>c</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ψ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>m</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>c</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>j</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mfenced open="(" close=")">
                            <mml:mi>x</mml:mi>
                          </mml:mfenced>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>β</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>c</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ψ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>m</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>c</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>g</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mfenced open="(" close=")">
                            <mml:mi>x</mml:mi>
                          </mml:mfenced>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mspace width="0.3em"/>
                  <mml:mspace width="0.3em"/>
                  <mml:mi mathvariant="italic">dx</mml:mi>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>with the aim to find a location <inline-formula><mml:math id="M34" name="1471-2105-13-291-i34" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and a weight <inline-formula><mml:math id="M35" name="1471-2105-13-291-i35" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of the most intense peak <inline-formula><mml:math id="M36" name="1471-2105-13-291-i36" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> within an isotope pattern <italic>φ</italic><sub><italic>c</italic>,<italic>g</italic></sub> approximating the fit of the most intense peaks <inline-formula><mml:math id="M37" name="1471-2105-13-291-i37" overflow="scroll"><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mspace width="2.77695pt"/><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math></inline-formula> within the isotope patterns <inline-formula><mml:math id="M38" name="1471-2105-13-291-i38" overflow="scroll"><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mspace width="2.77695pt"/><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math></inline-formula> best in a least squares sense.</p>
      <p>3. One ends up with sets <inline-formula><mml:math id="M39" name="1471-2105-13-291-i39" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math></inline-formula> and coefficients <inline-formula><mml:math id="M40" name="1471-2105-13-291-i40" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="2.77695pt"/><mml:mspace width="2.77695pt"/><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:math></inline-formula>.</p>
      <p>The additional benefit of solving (8) in step two as compared to the selection of the template with the largest coefficient within each group as proposed in [<xref ref-type="bibr" rid="B3">3</xref>] is that we are able to determine the location of the pattern even more accurately as predetermined by a limited sampling rate, since in (8) we optimize the location over a continuum. The optimization problem (8) can be solved fast and accurately by sampling the integrand on a fine grid of points and then solving a nonlinear least squares problem with optimization variables <italic>m</italic><sub><italic>c</italic>,<italic>g</italic></sub> and <italic>β</italic><sub><italic>c</italic>,<italic>g</italic></sub>.</p>
      <p>All candidate positions <inline-formula><mml:math id="M41" name="1471-2105-13-291-i41" overflow="scroll"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> are assigned a signal-to-noise ratio
</p>
      <p>
        <disp-formula id="bmcM9">
          <label>(9)</label>
          <mml:math id="M42" name="1471-2105-13-291-i42" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mtext>ratio</mml:mtext>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>g</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mtext>GOF</mml:mtext>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>+</mml:mo>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mover accent="false">
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                  </mml:mrow>
                  <mml:mo>~</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>g</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mo>·</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mover accent="false">
                      <mml:mrow>
                        <mml:mi>β</mml:mi>
                      </mml:mrow>
                      <mml:mo>~</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>g</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mtext>LNL</mml:mtext>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>+</mml:mo>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mover accent="false">
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                      <mml:mo>~</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>g</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mfrac>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <inline-formula><mml:math id="M43" name="1471-2105-13-291-i43" overflow="scroll"><mml:msub><mml:mrow><mml:mtext>LNL</mml:mtext></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>max</mml:mo><mml:mfenced open="{" close="}"><mml:mrow><mml:mtext>LNL</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mtext>median</mml:mtext><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mtext>LNL</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math></inline-formula> is a truncated version of the local noise level, with a lower bound included to avoid that the denominator in (9) takes on tiny values in low-intensity regions. The factor <inline-formula><mml:math id="M44" name="1471-2105-13-291-i44" overflow="scroll"><mml:msub><mml:mrow><mml:mtext>GOF</mml:mtext></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> represents a goodness-of-fit adjustment, a correction which aims at downweighting spurious peaks in low-intensity noise regions. These are not hard to distinguish from signal regions, which, in view of the presence of peak patterns, tend to be considerably regular. In order to spot noise regions, we fit the spectrum by <italic>single</italic> peaks (3) placed at each datum <italic>x</italic><sub><italic>i</italic></sub>, <italic>i</italic>=1,…,<italic>n</italic>, where the peak shape model, the associated peak shape parameters and the parameter <italic>q</italic> are chosen according to the choice made for template generation (Sections “Template model”) and template fitting (Section “Template fitting”), respectively. Denote the residuals of the resulting fit by <inline-formula><mml:math id="M45" name="1471-2105-13-291-i45" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. A local measure of goodness-of-fit is defined by
</p>
      <p>
        <disp-formula id="bmcM10">
          <label>(10)</label>
          <mml:math id="M46" name="1471-2105-13-291-i46" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mtext>GOF</mml:mtext>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>+</mml:mo>
                </mml:mrow>
              </mml:msub>
              <mml:mfenced open="(" close=")">
                <mml:mi>x</mml:mi>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:mo>min</mml:mo>
              <mml:mfenced open="{" close="}">
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mo>−</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mo mathsize="big">∑</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>∈</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi mathvariant="script">I</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>q</mml:mi>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mo mathsize="big">∑</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>∈</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi mathvariant="script">I</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>y</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>q</mml:mi>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>,</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mi>.</mml:mi>
                  <mml:mn>5</mml:mn>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>,</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The idea underlying this procedure is that in noise regions, the fit to the data will be poor, and consequently, the size of the residuals is expected to be large relative to the signal, hence leading to a low goodness-of-fit statistic. The truncation at 0.5 limits the influence of this correction. A final list is generated by checking whether the signal-to-noise ratios (9) exceed a ‘significance threshold’ <italic>t</italic> specified by the user. We do not give a general guideline for choosing <italic>t</italic>, because a reasonable choice is very specific to experimental conditions, e.g. the platform used and the composition of the spectrum. It is important to note that while <italic>t</italic> itself is constant, we take into account that the noise level is heterogeneous, since thresholding is based on the ratios (9), where the local noise level enters.</p>
    </sec>
    <sec>
      <title>Finding a set of default parameters</title>
      <p>Apart from the signal-to-noise threshold <italic>t</italic>, we have introduced the parameters <monospace>window</monospace>, i.e. the width <italic>h</italic> of the sliding window required for the computation of the local noise level (6), the template placement parameter <monospace>factor.place</monospace> and the parts-per-million tolerance <monospace>ppm</monospace> within which peaks are considered to be merged by the postprocessing procedure. With the exception of the threshold <italic>t</italic>, we have fixed all parameters to a default setting which we expect to give reasonable (albeit potentially suboptimal) results on spectra different from the ones analyzed here, without the need of manual tuning. In order to find such a default setting, we performed a grid search using only one selected spectrum of those described in Section “Datasets” below. While our default setting, which can be found in the HTML manual of the <monospace>R</monospace> package <monospace>IPPD</monospace>, already performs well, we recommend to do such a calibration to optimize the performance of our method.</p>
    </sec>
    <sec>
      <title>Sparse recovery with non-negativity constraints: non-negative least squares + thresholding vs. the non-negative lasso</title>
      <p>We believe that our preference for the first alternative is a major methodological contribution that has potential to impact related problems where non-negativity problems come into play. In the present section, we provide, at a high level, a series of arguments rooting in the statistics and signal processing literature that clarify our contribution and support our preference.</p>
      <sec>
        <title>Linear models and usual paradigms in statistics</title>
        <p>The fact that we favour non-negative least squares + thresholding may seem implausible since it questions or partially even contradicts paradigms about high-dimensional statistical inference. Consider the linear model
</p>
        <p>
          <disp-formula id="bmcM11">
            <label>(11)</label>
            <mml:math id="M47" name="1471-2105-13-291-i47" overflow="scroll">
              <mml:mi mathvariant="bold-italic">y</mml:mi>
              <mml:mo>≈</mml:mo>
              <mml:mstyle mathvariant="bold-italic">
                <mml:mo>Φ</mml:mo>
              </mml:mstyle>
              <mml:msup>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>∗</mml:mo>
                </mml:mrow>
              </mml:msup>
              <mml:mo>,</mml:mo>
              <mml:mspace width="2em"/>
              <mml:mi mathvariant="bold-italic">y</mml:mi>
              <mml:mo>∈</mml:mo>
              <mml:msup>
                <mml:mrow>
                  <mml:mi mathvariant="double-struck">R</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>n</mml:mi>
                </mml:mrow>
              </mml:msup>
              <mml:mo>,</mml:mo>
              <mml:mspace width="1em"/>
              <mml:mstyle mathvariant="bold-italic">
                <mml:mo>Φ</mml:mo>
              </mml:mstyle>
              <mml:mo>∈</mml:mo>
              <mml:msup>
                <mml:mrow>
                  <mml:mi>â</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>n</mml:mi>
                  <mml:mo>×</mml:mo>
                  <mml:mi>p</mml:mi>
                </mml:mrow>
              </mml:msup>
              <mml:mo>,</mml:mo>
            </mml:math>
          </disp-formula>
        </p>
        <p>which corresponds to model (1), where ‘≈’ is used instead of ‘=’ to account for stochastic noise or model misspecifications. Linear models of the form (10) have been and continue to be objects of central interest in statistical modelling.
</p>
        <p>• Classical work in statistics shows that under mild conditions if the number of sample <italic>n</italic> grows at a faster rate than the number of features <italic>p</italic>, the ordinary least squares estimator <inline-formula><mml:math id="M48" name="1471-2105-13-291-i48" overflow="scroll"><mml:msup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>ols</mml:mtext></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:msup><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> (in probability) as <italic>n</italic>→<italic>∞</italic>.</p>
        <p>• Since many contemporary datasets, like the MS datasets of the present paper, are characterized by a large <italic>p</italic>, which is of the same order as <italic>n</italic> or even larger, the first bullet has considerably lost relevance. Translated to MS datasets, it provides a statement about the case where the resolution tends to infinity. Therefore, modern statistical theory studies regimes in which <italic>p</italic> is allowed to grow at a faster rate than <italic>n</italic>, with a focus on results that hold for finite sample sizes. These results hinge on some sort of sparsity assumption on <bold><italic>β</italic></bold><sup>∗</sup>, the simplest being that <bold><italic>β</italic></bold><sup>∗</sup>
is zero except for some index set (support) of small cardinality. In this context, a multitude of results has been proved (see e.g. [<xref ref-type="bibr" rid="B23">23</xref>] for an overview) indicating that the lasso estimate <inline-formula><mml:math id="M49" name="1471-2105-13-291-i49" overflow="scroll"><mml:msup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>lasso</mml:mtext></mml:mrow></mml:msup></mml:math></inline-formula> is a statistically optimal procedure in the sense that <italic>if the regularization parameter is chosen in the right way</italic>, the squared Euclidean distance <inline-formula><mml:math id="M50" name="1471-2105-13-291-i50" overflow="scroll"><mml:mo>∥</mml:mo><mml:msup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>lasso</mml:mtext></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> is nearly of the same order as that of an estimator one could construct if the non-zeroes of <bold><italic>β</italic></bold><sup>∗</sup>
were known.</p>
        <p>The second bullet provides quite some justification for <monospace>NITPICK</monospace>, which is based on the lasso. However, as detailed below, the italicized part can be critical. On the other hand, there are several results that support our approach.</p>
      </sec>
      <sec>
        <title>The power of non-negativity constraints</title>
        <p>• It turns out that the non-negativity constraint <bold><italic>β</italic></bold>≥<bold><italic>0</italic></bold>
imposed in non-negative least squares (NNLS) may lead to a drastically better performance than that of the <italic>ordinary</italic> least squares estimator in ‘large <italic>p</italic>’ situations provided <bold>
Φ
</bold>
satisfies additional conditions. Roughly speaking, it is shown in [<xref ref-type="bibr" rid="B12">12</xref>] that if <bold>
Φ
</bold>
has non-negative entries, which is fulfilled for the template matching problem of Section “Template model”, the NNLS estimator <inline-formula><mml:math id="M51" name="1471-2105-13-291-i51" overflow="scroll"><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> does not overfit and is unique even in the singular case (<italic>p</italic>&gt;<italic>n</italic>). These results indicate that NNLS may behave surprisingly well in a high-dimensional setup, without using <italic>ℓ</italic><sub>1</sub>-regularization, which is often propagated in the literature as basically the only option ([<xref ref-type="bibr" rid="B24">24</xref>], Section 16.2.2).</p>
        <p>• There are several recent papers [<xref ref-type="bibr" rid="B25">25</xref>-<xref ref-type="bibr" rid="B27">27</xref>] in the sparse recovery literature in which it is shown that a sparse, <italic>non-negative</italic> vector can be recovered from few linear measurements <italic>n</italic>≪<italic>p</italic>. In [<xref ref-type="bibr" rid="B12">12</xref>], these results are extended to a noisy setup. More specifically, it is shown that NNLS + thresholding can consistently recover <bold><italic>β</italic></bold><sup>∗</sup>
and its support. Very recently, using similar conditions as in [<xref ref-type="bibr" rid="B12">12</xref>], Meinshausen [<xref ref-type="bibr" rid="B28">28</xref>] has established several guarantees of NNLS in a high-dimensional setup.</p>
        <p>One should bear in mind that the non-negativity constraints are essential for our approach. Thresholding the unconstrained ordinary least squares estimator <inline-formula><mml:math id="M52" name="1471-2105-13-291-i52" overflow="scroll"><mml:msup><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>ols</mml:mtext></mml:mrow></mml:msup></mml:math></inline-formula> in general leads to poor results in the ‘large <italic>p</italic>’ situation.</p>
      </sec>
      <sec>
        <title>Shortcomings of <italic>ℓ</italic><sub>1</sub>-regularization in theory</title>
        <p>In [<xref ref-type="bibr" rid="B12">12</xref>], it is not only shown that NNLS + thresholding is a sound strategy to perform sparse recovery of a non-negative target, but also examples are given where the non-negative lasso is outperformed even if its regularization parameter is set to match theoretical results and regardless of whether subsequent thresholding as advocated in [<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B30">30</xref>] is used or not. In particular, inferiority of the lasso arises in the presence of small, yet significantly non-zero entries in <bold><italic>β</italic></bold><sup>∗</sup>. These are specifically affected by the non-negligible bias of <italic>ℓ</italic><sub>1</sub>-regularization [<xref ref-type="bibr" rid="B31">31</xref>]. It is important to note that the comparison in [<xref ref-type="bibr" rid="B12">12</xref>] does not contradict prior comparisons of the lasso (aka soft thresholding) and (hard) thresholding for <italic>orthonormal designs</italic> (<bold>
Φ
</bold><sup>⊤</sup><bold>
Φ
</bold>=<bold><italic>I</italic></bold>) in [<xref ref-type="bibr" rid="B32">32</xref>,<xref ref-type="bibr" rid="B33">33</xref>], where both approaches perform similarly well and non-negativity constraints are not particularly important. Orthonormal designs, which lead to greatly simplified estimation problem are not of interest in the context of the paper, since the template matrix <bold>
Φ
</bold>
is far from being orthonormal.</p>
      </sec>
      <sec>
        <title>Shortcomings of <italic>ℓ</italic><sub>1</sub>-regularization in practice</title>
        <p>The study in [<xref ref-type="bibr" rid="B12">12</xref>] is of more theoretical nature, since all constants of the problem, in particular the noise level, are known, so that the regularization parameter can be set in an optimal fashion. This can realistically not be accomplished in practice. Likewise, the information-theoretic criterion employed in [<xref ref-type="bibr" rid="B3">3</xref>] as well as the data-splitting approach of [<xref ref-type="bibr" rid="B34">34</xref>] rely on knowledge of the noise level, or a consistent estimate thereof, which is hard to obtain in the ‘large <italic>p</italic>’ situation [<xref ref-type="bibr" rid="B35">35</xref>]. In any case, the regularization parameter remains a quantity that is hard to grasp and hence hard to set for a practitioner, since it cannot be related directly to the signal. In contrast, the threshold <italic>t</italic> admits a straightforward interpretation.</p>
        <p>Moreover, when using <italic>ℓ</italic><sub>1</sub>-regularization, data fitting and model selection are coupled. While this is often regarded as advantage, since model selection is performed automatically, we think that it is preferable to have a clear separation between data fitting and model selection, which is a feature of our approach. Prior to thresholding, the output of our fitting approach gives rise to a ranking which we obtain without the necessity to specify any parameter. Selection is completely based on a single fit simply by letting the the threshold vary. On the contrary, if one wants to reduce the number of features selected by the lasso, one resets the regularization parameter and solves a new optimization problem. Note that it is in general not possible to compute the entire solution path of the lasso [<xref ref-type="bibr" rid="B22">22</xref>] for the MS datasets used for the present paper, where the dimension of <bold>
Φ
</bold> is in the ten thousands so that the active set algorithm of [<xref ref-type="bibr" rid="B22">22</xref>] is prohibitively slow. In this regard, model selection by thresholding is computationally more attractive.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <p>For the assessment of the pattern picking performance, in total eight spectra generated by two different ionization methods, matrix assisted laser desorption/ionization (MALDI) and electrospray ionization (ESI), respectively, form the basis of the evaluation. While MALDI has been coupled to a time-of-flight (TOF) mass analyzer, ESI MS spectra have been recorded on both a linear ion trap (LTQ) and an Orbitrap mass analyzer. In addition, a series of spectra were prepared with the aim of investigating in detail the method’s performance in the presence of overlapping peptides.</p>
    <sec>
      <title>Datasets</title>
      <p>For MALDI mass spectra (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>), time of flight mass analysis was performed; spectra were recorded on an ABI MALDI-TOF/TOF 4800 instrument in positive ion mode using <italic>α</italic>-cyano-4-hydroxy-cinnamic acid (CHCA) as matrix. Nanospray ESI spectra (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>) were measured in positive ion mode on a Thermo LTQ Orbitrap Velos MS; both high resolution measurements using the Orbitrap mass analyzer (referred to as ‘Orbitrap’) and, alternatively, low resolution linear ion trap (IT) measurements were performed with this setup. This experiment has been chosen in order to demonstrate the utility of our method at different concentration levels, that it is robust with respect to changes in the data-generating process and that the method is capable of handling singly charged ions, the main form generated by MALDI MS, as well as higher charged ions formed in ESI MS. Tryptic digests (performed in 40 mM ammonium bicarbonate) of model proteins were used as analytes: bovine myoglobin and chicken egg lysozyme (10 and 500 fmol each) for MALDI-TOF experiments, and lysozyme (250 and 1000 fmol) for ESI experiments. Disulfide bonds were reduced with dithiothreitol (DTT) prior to alkylation, free cysteine residues were alkylated by iodacetamide. No further sample pretreatment was performed prior to MS analysis. When referring to these spectra, we omit that tryptic digests are given: e.g., the term ‘MALDI-TOF myoglobin spectrum (500 fmol)’ means the respective tryptic digest.</p>
      <p>To demonstrate explicitly the method’s ability to separate strongly overlapping patterns even in the case of badly resolved signals, 22 additional spectra have been generated in positive ion mode on a Bruker Daltonics HCT Ultra Ion Trap MS with an electrospray ion source. Three synthetic peptides (cf. Section “Unmixing of overlaps” for details) with sequences corresponding to tryptic peptides from bovine serum albumin (BSA) were used as analytes. In each measurement two out of three peptides were mixed in different ratios to get overlapping peptide signals, also with different charge states. Two different concentrations (500 fmol/<italic>μ</italic>l and 1000 fmol/<italic>μ</italic>l) were injected into the mass spectrometer via a Cole-Parmer syringe pump.</p>
    </sec>
    <sec>
      <title>Validation strategy</title>
      <p>Validation of pattern picking is notoriously difficult, because a gold standard which is satisfactory from both statistical and biological points of view is missing. In this context, a major problem one has to account for is that spectra frequently contain patterns whose shape is not distinguishable from those of peptides, but which are in fact various artifacts resulting e.g. from impurities during sample preparation and measurement. These artifacts do not constitute biologically relevant information and are, in this sense, ‘false positives’. An important instance are signals derived from the matrix (or from matrix-clusters) frequently observed in MALDI MS. The pattern of these signals is similar to that of peptides; nevertheless, due to their molecular composition, which differs significantly from that of an average peptide, the exact masses can be used to exclude these signals from the data analysis. On the other hand, from a statistical perspective which judges a method according to how well it is able to detect specific patterns in a given dataset, a qualification as ‘true positive’ is justified. With the aim to unify these aspects, we have worked out a dual validation scheme. In order to reduce the number of artifacts, all automatically generated lists of candidates for peptide masses as well as the lists of a human expert (see below) are postprocessed by a peptide mass filter [<xref ref-type="bibr" rid="B36">36</xref>]: only peptides whose monoisotopic mass deviated less than 200 ppm from the closest peptide mass center<sup>a</sup> are used for subsequent evaluation.</p>
      <sec>
        <title>Comparison with manual annotation</title>
        <p>The first part investigates how well a method is able to support a human expert who annotates the spectra manually. More specifically, the automatically generated lists are matched to the manual annotation such that an entry of the list (potential peptide mass) is declared ‘true positive’ whenever there is a corresponding mass in the manual annotation deviating by no more than <italic>Δ</italic> ppm. Otherwise, it is declared ‘false positive’. In order to adapt <italic>Δ</italic>
ppm to the resolution of the different mass lines, we used the following strategy: assuming that most of the peptides will have a mass larger than 700 Da, we determined the spacing <italic>Δ</italic><sub><italic>m</italic>/<italic>z</italic></sub> between neighboring data points in <italic>m</italic>/<italic>z</italic>
direction for each mass spectrum in the lower mass range. If we further assume that a simple manual annotation by visual inspection can result in a mass deviation from the ‘correct’ mass position of at most <italic>Δ</italic><sub><italic>m</italic>/<italic>z</italic></sub>, we can derive the following tolerance values: <italic>Δ</italic>=100 ppm for ion trap recordings, <italic>Δ</italic>=50 ppm in the case of MALDI-TOF recordings<sup>b</sup> and <italic>Δ</italic>=20
ppm for Orbitrap data.</p>
        <p>As the performance of our as well as those of all competing methods depends on a threshold-like parameter governing, crudely speaking, the trade-off between precision and recall, we explore the performance for a range of reasonable parameter values, instead of fixing an (arbitrary) value, which we believe to be little meaningful. The results are then visualized as ROC curve, in which each point in the (Recall, Precision)-plane corresponds to a specific choice of the parameter. Formally, we introduce binary variables {<italic>B</italic><sub><italic>i</italic></sub>(<italic>t</italic>)} for each mass <italic>i</italic> contained in the list of cardinality <inline-formula><mml:math id="M53" name="1471-2105-13-291-i53" overflow="scroll"><mml:mover accent="false"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> when setting the threshold equal to <italic>t</italic>, where <italic>B</italic><sub><italic>i</italic></sub>(<italic>t</italic>)
equals 1 if the mass is matched and 0 otherwise, and denote by <italic>L</italic> the number of masses of the manual annotation. The true positive rate (recall, <italic>R</italic>), and the positive predictive value (precision, <italic>P</italic>) associated with threshold <italic>t</italic> are then defined by <inline-formula><mml:math id="M54" name="1471-2105-13-291-i54" overflow="scroll"><mml:mi>R</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>, <inline-formula><mml:math id="M55" name="1471-2105-13-291-i55" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></inline-formula>. An ROC curve results from a sequence of pairs {<italic>R</italic>(<italic>t</italic>),<italic>P</italic>(<italic>t</italic>)}
for varying <italic>t</italic>.</p>
      </sec>
      <sec>
        <title>Database query</title>
        <p>The second part evaluates the lists in terms of a query to the Mascot search engine [<xref ref-type="bibr" rid="B37">37</xref>], version 2.2.04. In particular, we account for a major problem of a manual annotation, namely that peptides yielding weak MS signals might easily be overlooked, but might be detected by methods designed to extract those weak signals. Since we are especially interested in demonstrating the method’s ability to separate overlapping patterns, we adapted the standard search parameters of Mascot’s peptide mass fingerprint routine to allow two missed cleavage sites and to incorporate the following (variable) post-translational modifications: ‘Oxidation (M)’, ‘Carbamidomethyl (C)’, ‘Amidated (Protein C-term)’, ‘Deamidated (NQ)’. In particular, the latter two modifications will frequently trigger MS signals interleaving with the pattern of their unmodified counterpart: in the case of a deamidation the modified ion shows a mass of approx. 0.98 Da more compared to the amidated peptide. The same mass tolerances as for the manual annotation are used. As for the comparison with the manual annotation, we evaluate several lists corresponding to different choices of the threshold. Instead of an ROC curve, which turned out to be visually unpleasant, we display the statistics (score, coverage and fraction of hits) of two lists per method, namely of those achieving the best score and the best coverage, respectively. The complete set of results as well as further details of our evaluation like the manual annotation are contained in Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>.</p>
      </sec>
    </sec>
    <sec>
      <title>Competing methods</title>
      <p>We compare our method in its two variants depending on the choice of the fitting criterion (cf. Eq. (7)), labelled <italic>l</italic><sub>1</sub>
(<italic>q</italic>=1) and <italic>l</italic><sub>2</sub>
(<italic>q</italic>=2), respectively, with the following competing methods.</p>
      <sec>
        <title>Lasso</title>
        <p>The ‘lasso’ method in this paper serves as surrogate for NITPICK. Since the ‘lasso’ is embedded into our framework while implementing a methodology that closely resembles NITPICK, we use the ‘lasso’ for the sake of convenience, to avoid an involved parameter optimization for NITPICK. Our lasso implementation benefits from the improved merging procedure of Section “Postprocessing and thresholding”. To accomodate a heterogeneous noise level, <monospace>NITPICK</monospace> divides spectra into bins. This can be avoided by determining a minimizer <inline-formula><mml:math id="M56" name="1471-2105-13-291-i56" overflow="scroll"><mml:mover accent="false"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>λ</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> of the weighted non-negative lasso problem
</p>
        <p>
          <disp-formula id="bmcM12">
            <label>(12)</label>
            <mml:math id="M57" name="1471-2105-13-291-i57" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:munder>
                      <mml:mrow>
                        <mml:mo>min</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mstyle mathvariant="bold-italic">
                          <mml:mi>β</mml:mi>
                        </mml:mstyle>
                        <mml:mo>≥</mml:mo>
                        <mml:mstyle mathvariant="bold-italic">
                          <mml:mn>0</mml:mn>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:munder>
                    <mml:mo>∥</mml:mo>
                    <mml:mi mathvariant="bold-italic">y</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mstyle mathvariant="bold-italic">
                      <mml:mo>Φ</mml:mo>
                    </mml:mstyle>
                    <mml:mstyle mathvariant="bold-italic">
                      <mml:mi>β</mml:mi>
                    </mml:mstyle>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mo>∥</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>+</mml:mo>
                    <mml:mi>λ</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mstyle mathvariant="bold-italic">
                          <mml:mn>1</mml:mn>
                        </mml:mstyle>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>⊤</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi mathvariant="bold-italic">W</mml:mi>
                    <mml:mstyle mathvariant="bold-italic">
                      <mml:mi>β</mml:mi>
                    </mml:mstyle>
                    <mml:mo>,</mml:mo>
                    <mml:mspace width="2.77695pt"/>
                    <mml:mspace width="2.77695pt"/>
                    <mml:mi>λ</mml:mi>
                    <mml:mo>&gt;</mml:mo>
                    <mml:mn>0</mml:mn>
                    <mml:mo>,</mml:mo>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <bold><italic>W</italic></bold> is a diagonal matrix with entries <italic>w</italic><sub><italic>c</italic>,<italic>j</italic></sub>=LNL<sub> + </sub>(<italic>m</italic><sub><italic>c</italic>,<italic>j</italic></sub>), <italic>j</italic>=1,…,<italic>p</italic><sub><italic>c</italic></sub>, <italic>c</italic>=1,…,<italic>C</italic>, whose purpose is to re-scale the amount of <italic>ℓ</italic><sub>1</sub>-regularization according to the local noise level. The columns of the template matrix <bold>
Φ
</bold> in (8)). The parameter <italic>λ</italic>
here plays the role of the threshold <italic>t</italic>, cf. Section “Validation strategy”.</p>
      </sec>
      <sec>
        <title>Pepex</title>
        <p>As discussed in Section “Template fitting”, pepex performs centroiding and de-isotoping separately. De-isotoping is based on non-negative least squares. Since pepex is limited to detect patterns of charge state one, its performance is only assessed for MALDI-TOF spectra. Accordingly, when comparing the ouptput of pepex with the manual annotation, the few patterns of charge state two are excluded. The parameters <monospace>nm</monospace>, <monospace>pft</monospace>, <monospace>mincd</monospace>, <monospace>maxcd</monospace> and <monospace>nsam</monospace> were set to optimize performance with respect to manual annotation. The ROC curves are based on peaklists resulting from ten different choices of the signal-to-noise parameter <monospace>snr</monospace>.</p>
      </sec>
      <sec>
        <title>Isotope wavelet</title>
        <p>As opposed to our method, this approach is not able to handle overlaps. On the other hand, it typically shows strong performance in noisy and low intensity regions or on datasets with extremely low concentrations [<xref ref-type="bibr" rid="B39">39</xref>,<xref ref-type="bibr" rid="B40">40</xref>]. While the isotope wavelet is not limited to charge one, it is run in charge one only mode for the MALDI-TOF spectra, to achieve more competitive performance. For the sake of fair of comparison, the result of the isotope wavelet on the MALDI-TOF spectra are evaluated in the same way as those of pepex.</p>
      </sec>
      <sec>
        <title>Vendor</title>
        <p>The parameter setting for the ABI MALDI-TOF/TOF MS software was as follows: Local Noise Width (<italic>m</italic>/<italic>z</italic>) 250, Min Peak Width at FWHM 2.9. The Cluster Area Optimization S/N threshold has been dynamically adapted to about three times the S/N threshold as suggested by the ABI documentation. Since the vendor software is limited to charge one, its outputs are evaluated in the same way as those of pepex. Given the disproportionally high effort needed to find an optimal parameter setting of the vendor software for ESI spectra, its performance is not assessed.</p>
      </sec>
    </sec>
    <sec>
      <title>Results</title>
      <sec>
        <title>Manual annotation vs. database query</title>
        <p>When inspecting Figures <xref ref-type="fig" rid="F4">4</xref> and <xref ref-type="fig" rid="F5">5</xref> on the one hand and Table <xref ref-type="table" rid="T1">1</xref> on the other hand, one notices that results of the evaluation based on the manual annotation are not in full accordance with the results of the database query. The difference is most striking for the MALDI-TOF spectra at 500 fmol, where our methods (<italic>l</italic><sub>1</sub> and <italic>l</italic><sub>2</sub>) yield a significant improvement, which does not become apparent from the database query. This is because only a fraction of the manual annotation is actually confirmed by the database query. The part which is not matched likely consists of artifacts due to contamination or chemical noise as well as of specific modifications not captured by the database query. In light of this, our dual validation scheme indeed makes sense.
</p>
        <fig id="F4" position="float">
          <label>Figure 4</label>
          <caption>
            <p><bold>Results for pattern picking, MALDI-TOF.</bold> Pattern picking performance for the MALDI-TOF spectra as described in Section “Datasets”. The points in the (Recall,Precision)-plane correspond to different choices of a method-specific threshold(-like) parameter.</p>
          </caption>
          <graphic xlink:href="1471-2105-13-291-4"/>
        </fig>
        <fig id="F5" position="float">
          <label>Figure 5</label>
          <caption>
            <p><bold>Results for pattern picking, ESI.</bold> Pattern picking performance for the ESI spectra as described in Section “Datasets”. The points in the (Recall,Precision)-plane correspond to different choices of a method-specific threshold(-like) parameter.</p>
          </caption>
          <graphic xlink:href="1471-2105-13-291-5"/>
        </fig>
        <table-wrap position="float" id="T1">
          <label>Table 1</label>
          <caption>
            <p>Mascot results</p>
          </caption>
          <table frame="hsides" rules="groups" border="1">
            <colgroup>
              <col align="left"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
            </colgroup>
            <thead valign="top">
              <tr>
                <th align="left">
                  <bold>MALDI Myo 500 fmol</bold>
                </th>
                <th align="left">
                  <bold>score</bold>
                </th>
                <th align="left">
                  <bold>cvrg</bold>
                </th>
                <th align="left">
                  <bold>hits</bold>
                </th>
                <th align="left">
                  <bold>score</bold>
                </th>
                <th align="left">
                  <bold>cvrg</bold>
                </th>
                <th align="left">
                  <bold>hits</bold>
                </th>
              </tr>
            </thead>
            <tbody valign="top">
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>1</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">211.0<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.85</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.94<hr/></td>
                <td align="left" valign="bottom">96.8<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.96</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.04<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>2</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">211.0<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.85</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.94<hr/></td>
                <td align="left" valign="bottom">49.6<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.96</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.04<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">lasso<hr/></td>
                <td align="left" valign="bottom">207.0<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.85</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>1.00</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">142.0<hr/></td>
                <td align="left" valign="bottom">0.91<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.37</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">pepex<hr/></td>
                <td align="left" valign="bottom">
                  <bold>223.0</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>0.85</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>1.00</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">142.0<hr/></td>
                <td align="left" valign="bottom">0.90<hr/></td>
                <td align="left" valign="bottom">0.17<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">vendor<hr/></td>
                <td align="left" valign="bottom">
                  <bold>223.0</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>0.85</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.94<hr/></td>
                <td align="left" valign="bottom">
                  <bold>174.0</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.90<hr/></td>
                <td align="left" valign="bottom">0.29<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">wavelet<hr/></td>
                <td align="left" valign="bottom">207.0<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.85</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>1.00</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">156.0<hr/></td>
                <td align="left" valign="bottom">0.90<hr/></td>
                <td align="left" valign="bottom">0.14<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <bold>MALDI Lys 500 fmol</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>score</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>cvrg</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>hits</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>score</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>cvrg</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>hits</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>1</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">167.0<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.81</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.57<hr/></td>
                <td align="left" valign="bottom">133.0<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.83</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>0.37</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>2</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">168.0<hr/></td>
                <td align="left" valign="bottom">0.80<hr/></td>
                <td align="left" valign="bottom">0.64<hr/></td>
                <td align="left" valign="bottom">
                  <bold>144.0</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>0.83</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.34<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">lasso<hr/></td>
                <td align="left" valign="bottom">151.0<hr/></td>
                <td align="left" valign="bottom">0.64<hr/></td>
                <td align="left" valign="bottom">0.77<hr/></td>
                <td align="left" valign="bottom">112.0<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.83</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>0.37</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">pepex<hr/></td>
                <td align="left" valign="bottom">
                  <bold>172.0</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.80<hr/></td>
                <td align="left" valign="bottom">0.63<hr/></td>
                <td align="left" valign="bottom">135.0<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.83</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.25<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">vendor<hr/></td>
                <td align="left" valign="bottom">146.0<hr/></td>
                <td align="left" valign="bottom">0.64<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.75</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">91.4<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.83</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.20<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">wavelet<hr/></td>
                <td align="left" valign="bottom">127.0<hr/></td>
                <td align="left" valign="bottom">0.58<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.75</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">113.0<hr/></td>
                <td align="left" valign="bottom">0.81<hr/></td>
                <td align="left" valign="bottom">0.20<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <bold>MALDI Myo 10 fmol</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>score</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>cvrg</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>hits</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>score</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>cvrg</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>hits</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>1</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>211.0</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>0.85</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.94<hr/></td>
                <td align="left" valign="bottom">82.2<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.95</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.04<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>2</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">207.0<hr/></td>
                <td align="left" valign="bottom">0.74<hr/></td>
                <td align="left" valign="bottom">
                  <bold>1.00</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">109.0<hr/></td>
                <td align="left" valign="bottom">0.90<hr/></td>
                <td align="left" valign="bottom">0.14<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">lasso<hr/></td>
                <td align="left" valign="bottom">195.0<hr/></td>
                <td align="left" valign="bottom">0.77<hr/></td>
                <td align="left" valign="bottom">0.87<hr/></td>
                <td align="left" valign="bottom">
                  <bold>146.0</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.85<hr/></td>
                <td align="left" valign="bottom">0.46<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">pepex<hr/></td>
                <td align="left" valign="bottom">97.8<hr/></td>
                <td align="left" valign="bottom">0.80<hr/></td>
                <td align="left" valign="bottom">0.22<hr/></td>
                <td align="left" valign="bottom">97.8<hr/></td>
                <td align="left" valign="bottom">0.80<hr/></td>
                <td align="left" valign="bottom">0.22<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">vendor<hr/></td>
                <td align="left" valign="bottom">123.0<hr/></td>
                <td align="left" valign="bottom">0.62<hr/></td>
                <td align="left" valign="bottom">0.62<hr/></td>
                <td align="left" valign="bottom">123.0<hr/></td>
                <td align="left" valign="bottom">0.62<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.62</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">wavelet<hr/></td>
                <td align="left" valign="bottom">131.0<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.85</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.13<hr/></td>
                <td align="left" valign="bottom">131.0<hr/></td>
                <td align="left" valign="bottom">0.85<hr/></td>
                <td align="left" valign="bottom">0.13<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <bold>MALDI Lys 10 fmol</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>score</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>cvrg</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>hits</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>score</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>cvrg</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>hits</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>1</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>89.0</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.35<hr/></td>
                <td align="left" valign="bottom">
                  <bold>1.00</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>73.7</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.54<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.23</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>2</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>89.0</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.35<hr/></td>
                <td align="left" valign="bottom">
                  <bold>1.00</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">35.4<hr/></td>
                <td align="left" valign="bottom">0.72<hr/></td>
                <td align="left" valign="bottom">0.09<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">lasso<hr/></td>
                <td align="left" valign="bottom">81.9<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.46</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.70<hr/></td>
                <td align="left" valign="bottom">46.0<hr/></td>
                <td align="left" valign="bottom">0.74<hr/></td>
                <td align="left" valign="bottom">0.10<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">pepex<hr/></td>
                <td align="left" valign="bottom">47.1<hr/></td>
                <td align="left" valign="bottom">0.17<hr/></td>
                <td align="left" valign="bottom">
                  <bold>1.00</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">31.2<hr/></td>
                <td align="left" valign="bottom">0.53<hr/></td>
                <td align="left" valign="bottom">0.12<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">vendor<hr/></td>
                <td align="left" valign="bottom">62.7<hr/></td>
                <td align="left" valign="bottom">0.23<hr/></td>
                <td align="left" valign="bottom">
                  <bold>1.00</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">43.2<hr/></td>
                <td align="left" valign="bottom">0.34<hr/></td>
                <td align="left" valign="bottom">0.16<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">wavelet<hr/></td>
                <td align="left" valign="bottom">55.4<hr/></td>
                <td align="left" valign="bottom">0.23<hr/></td>
                <td align="left" valign="bottom">0.45<hr/></td>
                <td align="left" valign="bottom">43.8<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.82</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.10<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <bold>Orbi Lys 1000 fmol</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>score</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>cvrg</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>hits</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>score</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>cvrg</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>hits</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>1</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">149.0<hr/></td>
                <td align="left" valign="bottom">0.70<hr/></td>
                <td align="left" valign="bottom">0.78<hr/></td>
                <td align="left" valign="bottom">138.0<hr/></td>
                <td align="left" valign="bottom">0.80<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.53</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>2</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">139.0<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.80</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.50<hr/></td>
                <td align="left" valign="bottom">
                  <bold>139.0</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.80<hr/></td>
                <td align="left" valign="bottom">0.50<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">lasso<hr/></td>
                <td align="left" valign="bottom">
                  <bold>159.0</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.63<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.87</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">120.0<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.81</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.29<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">wavelet<hr/></td>
                <td align="left" valign="bottom">105.0<hr/></td>
                <td align="left" valign="bottom">0.69<hr/></td>
                <td align="left" valign="bottom">0.44<hr/></td>
                <td align="left" valign="bottom">95.1<hr/></td>
                <td align="left" valign="bottom">0.80<hr/></td>
                <td align="left" valign="bottom">0.23<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <bold>IT Lys 1000 fmol</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>score</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>cvrg</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>hits</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>score</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>cvrg</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>hits</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>1</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">78.7<hr/></td>
                <td align="left" valign="bottom">0.63<hr/></td>
                <td align="left" valign="bottom">0.28<hr/></td>
                <td align="left" valign="bottom">70.9<hr/></td>
                <td align="left" valign="bottom">0.74<hr/></td>
                <td align="left" valign="bottom">0.17<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>2</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">82.1<hr/></td>
                <td align="left" valign="bottom">0.72<hr/></td>
                <td align="left" valign="bottom">0.36<hr/></td>
                <td align="left" valign="bottom">35.4<hr/></td>
                <td align="left" valign="bottom">0.85<hr/></td>
                <td align="left" valign="bottom">0.13<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">lasso<hr/></td>
                <td align="left" valign="bottom">103.0<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.84</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.33<hr/></td>
                <td align="left" valign="bottom">
                  <bold>76.8</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>0.99</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>0.21</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">wavelet<hr/></td>
                <td align="left" valign="bottom">
                  <bold>107.0</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.79<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.63</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">69.8<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.99</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.11<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <bold>Orbi Lys 250 fmol</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>score</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>cvrg</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>hits</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>score</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>cvrg</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>hits</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>1</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">107.0<hr/></td>
                <td align="left" valign="bottom">0.63<hr/></td>
                <td align="left" valign="bottom">0.50<hr/></td>
                <td align="left" valign="bottom">100.0<hr/></td>
                <td align="left" valign="bottom">0.80<hr/></td>
                <td align="left" valign="bottom">0.31<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>2</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">103.0<hr/></td>
                <td align="left" valign="bottom">0.63<hr/></td>
                <td align="left" valign="bottom">0.52<hr/></td>
                <td align="left" valign="bottom">66.9<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.81</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.14<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">lasso<hr/></td>
                <td align="left" valign="bottom">
                  <bold>108.0</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.63<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.77</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>107.0</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.80<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.27</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">wavelet<hr/></td>
                <td align="left" valign="bottom">80.6<hr/></td>
                <td align="left" valign="bottom">
                  <bold>0.70</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.22<hr/></td>
                <td align="left" valign="bottom">80.6<hr/></td>
                <td align="left" valign="bottom">0.70<hr/></td>
                <td align="left" valign="bottom">0.22<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <bold>IT Lys 250fmol</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>score</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>cvrg</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>hits</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>score</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>cvrg</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>hits</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>1</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">59.4<hr/></td>
                <td align="left" valign="bottom">0.46<hr/></td>
                <td align="left" valign="bottom">0.16<hr/></td>
                <td align="left" valign="bottom">59.4<hr/></td>
                <td align="left" valign="bottom">0.46<hr/></td>
                <td align="left" valign="bottom">0.16<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">
                  <italic>l</italic>
                  <sub>2</sub>
                  <hr/>
                </td>
                <td align="left" valign="bottom">37.0<hr/></td>
                <td align="left" valign="bottom">0.59<hr/></td>
                <td align="left" valign="bottom">0.14<hr/></td>
                <td align="left" valign="bottom">37.0<hr/></td>
                <td align="left" valign="bottom">0.59<hr/></td>
                <td align="left" valign="bottom">0.14<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">lasso<hr/></td>
                <td align="left" valign="bottom">
                  <bold>66.3</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>0.84</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">0.20<hr/></td>
                <td align="left" valign="bottom">
                  <bold>66.3</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>0.84</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>0.20</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left">wavelet</td>
                <td align="left">56.3</td>
                <td align="left">0.59</td>
                <td align="left">
                  <bold>0.36</bold>
                </td>
                <td align="left">21.3</td>
                <td align="left">0.75</td>
                <td align="left">0.12</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>Corresponding Mascot results for the data shown in Figures <xref ref-type="fig" rid="F4">4</xref> and <xref ref-type="fig" rid="F5">5</xref>. The left halves of the tables report the statistics when choosing the threshold(-like) parameter to optimize the score, the right halves when optimizing the coverage (cvrg, given as fraction). The column ‘hits’ contains the fraction of masses that could be matched to peptide masses in the database.</p>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec>
        <title>Comparison</title>
        <p>Figure <xref ref-type="fig" rid="F4">4</xref> and Table <xref ref-type="table" rid="T1">1</xref> reveal an excellent performance of our methods (<italic>l</italic><sub>1</sub> and <italic>l</italic><sub>2</sub>) throughout all MALDI-TOF spectra under consideration. For the myoglobin spectra high sequence coverages are attained that clearly stand above those of competing methods. For the spectra at 10 fmol, only the performance of lasso is competetive with that of our methods in terms of the Mascot score; all other competitors, including the vendor software which has been tailored to process these spectra, are significantly weaker. In particular, the strikingly high proportion of ‘hits’ (≥94%) indicates that even at moderate concentration levels, our methods still distinguish well between signal and noise. This observation is strongly supported by the ROC curves in Figure <xref ref-type="fig" rid="F4">4</xref>, where the precision drops comparatively slowly with increasing recall. In this regard, our methodology clearly contrasts with approaches like the isotope wavelet that aim at achieving high protein sequence coverage. The latter often requires the selection of extremely lowly abundant peptide signals hidden in noise at the expense of reduced specificity.</p>
        <p>For MALDI-TOF spectra at high concentration levels, pepex achieves the best scores and is competitive with respect to sequence coverage. However, the performance of pepex degrades dramatically at lower concentration levels, as it is unambiguously shown by both parts of the evaluation. In particular, the database scores are the worst among all methods compared. This provides some support for our reasoning at the end of Section “Template fitting”.</p>
        <p>For the ESI spectra, our methods in total fall a bit short of the lasso (particularly for the ion trap spectra), but perform convincingly as well, thereby demonstrating that they can deal well with multiple charge states. This is an important finding, since the presence of multiple charges makes the sparse recovery problem as formulated in model (1) much more challenging, because the number of parameters to be estimated as well as the correlations across templates are increased. In spite of these difficulties, Figure <xref ref-type="fig" rid="F5">5</xref> and Table <xref ref-type="table" rid="T1">1</xref> suggest that the performance of our pure fitting approach (7) does not appear to be affected. Using a more difficult set of spectra, the capability to process ESI data with impressive success is additionally shown in the next section.</p>
      </sec>
      <sec>
        <title>Additional remarks</title>
        <p>• In Figure <xref ref-type="fig" rid="F4">4</xref>, the area under the curve (AUC) of our methods attained for myoglobin is higher for lower concentration. At first glance, this may seem contradictory since an increase in concentration should lead to a simplified problem. However, a direct comparison of the AUCs is problematic, since the number of true positives (17 at 10 fmol, 106 at 500 fmol) is rather different. For instance, there are choices of the threshold that yield 18 true positives and not a single false positive for both of our methods at 500 fmol, yet the AUC is lower.</p>
        <p>• The fact that some of the ROCs start in the lower left corner results from outputs containing only false positives.</p>
      </sec>
    </sec>
    <sec>
      <title>Unmixing of overlaps</title>
      <sec>
        <title>Motivation</title>
        <p>One of the main advantages of our method over more simplistic pattern picking methods is the ability to disentangle isotope patterns of overlapping peptide signals, whose presence may lead to a significantly more challening pattern picking problem as e.g. discussed in [<xref ref-type="bibr" rid="B41">41</xref>] in the slightly different context of intact protein mass spectra. Therefore, a potential application for our approach will be the analysis of a certain class of posttranslational modifications, the deamidation of amino acid residues containing a carboxamide side chain functionality. The deamidation of asparagine (Asn) or glutamine (Gln) residues, yielding aspartic acid (Asp) or glutamic acid (Glu) residues, respectively, is an important posttranslational modification, which can have immense effects on the structure of peptides [<xref ref-type="bibr" rid="B42">42</xref>] and is of great relevance in a number of pathophysiological events [<xref ref-type="bibr" rid="B43">43</xref>]. During the deamidation, the side chain carboxamide is hydrolysed, which is accompanied by a mass increase of 0.98 Da. Thus, in a spectrum of a mixture of the amidated and deamidated form, a direct overlap of both signals can be observed. It has to be noted that additionally to the amidated/deamidated forms, in case of Asn deamidation, a second product containing an iso-peptide bond is formed, too, which has the same molecular behaviour; these two forms can be identified solely by their differential MS/MS behavior.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>The peptides analyzed here in order to assess the performance of our approach were synthesized by means of Fmoc-solid phase peptide synthesis; sequences corresponding to tryptic peptides from bovine serum albumin (BSA) with the sequences listed in Table <xref ref-type="table" rid="T2">2</xref> were selected.
</p>
        <table-wrap position="float" id="T2">
          <label>Table 2</label>
          <caption>
            <p>Peptides mixed together</p>
          </caption>
          <table frame="hsides" rules="groups" border="1">
            <colgroup>
              <col align="left"/>
              <col align="left"/>
              <col align="left"/>
            </colgroup>
            <thead valign="top">
              <tr>
                <th align="left">
                  <bold>sequence</bold>
                </th>
                <th align="left">
                  <bold>sequence residueno. in BSA</bold>
                </th>
                <th align="left">
                  <bold>monoisotopic mass(protonated) / charge</bold>
                </th>
              </tr>
            </thead>
            <tbody valign="top">
              <tr>
                <td align="left" valign="bottom">GACLLPK<hr/></td>
                <td align="justify" valign="bottom">198-204<hr/></td>
                <td align="justify" valign="bottom">351.20437 / +2<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">CCTKPESER<hr/></td>
                <td align="justify" valign="bottom">460-468<hr/></td>
                <td align="justify" valign="bottom">351.48816 / +3<hr/></td>
              </tr>
              <tr>
                <td align="left">VLASSAR</td>
                <td align="justify">212-218</td>
                <td align="justify">352.20850 / +2</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <p>In each measurement two out of the three listed peptides were mixed together in different ratios (Additional file <xref ref-type="supplementary-material" rid="S4">4</xref>). Given such a spectrum, we study the question whether our method returns the true underlying composition. We classify the output of our method as correct interpretation of the spectrum if the templates corresponding to the true underlying peptides achieve signal-to-noise-ratios of at least one and these ratios are the two largest among all templates used for fitting. This procedure corresponds to a selection-optimal choice of the threshold based on the knowledge of the true composition of the spectrum. This simplification may be justified in view of the extreme difficulty of the problem as illustrated in Figure <xref ref-type="fig" rid="F6">6</xref>, in particular in view of lowly resolved spectra with an average <italic>m</italic>/<italic>z</italic>-spacing of 0.06 Da. For the remaining parameters, we compare a grid search (performed separately for each spectrum) and the default parameter set (Section “3 and Figure <xref ref-type="fig" rid="F6">6</xref> indicate that already the default parameter setting is able to solve successfully a wide range of problem instances. As one would expect, Table <xref ref-type="table" rid="T3">3</xref> and Figure <xref ref-type="fig" rid="F6">6</xref> suggest that the higher the concentration and the more balanced the amplitudes of the overlapping peptides, the more likely it is that the overlap can be resolved. On the other hand, the higher the degree of overlap of the peptides, which depends on both their charges and the distance of their positions, the more difficult the problem is. This becomes obvious when considering the overlap of the two peptides located at 351.2 and 351.4 Da, respectively.
</p>
        <fig id="F6" position="float">
          <label>Figure 6</label>
          <caption>
            <p><bold>Unmixing of overlap.</bold> Graphical representation of selected overlap problems as tabulated in Table <xref ref-type="table" rid="T3">3</xref>. The experimental setups are given in the title of the plots. The dots represent the signal, while solid and dashed lines represent the templates used by our method to match the signal, using the default parameter setting and the choice for the threshold as explained in the text. The grey area represents the overall fit when using the selected templates.</p>
          </caption>
          <graphic xlink:href="1471-2105-13-291-6"/>
        </fig>
        <table-wrap position="float" id="T3">
          <label>Table 3</label>
          <caption>
            <p>Unmixing of overlaps</p>
          </caption>
          <table frame="hsides" rules="groups" border="1">
            <colgroup>
              <col align="left"/>
              <col/>
              <col/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
            </colgroup>
            <thead valign="top">
              <tr>
                <th align="center" valign="bottom">
                  <bold>peptides</bold>
                  <hr/>
                </th>
                <th colspan="5" align="center" valign="bottom">
                  <bold>351.2(2)/352.2(2)</bold>
                  <hr/>
                </th>
                <th colspan="4" align="center" valign="bottom">
                  <bold>351.4(3)/352.2(2)</bold>
                  <hr/>
                </th>
                <th colspan="4" align="center" valign="bottom">
                  <bold>351.2(2)/351.4(3)</bold>
                  <hr/>
                </th>
              </tr>
              <tr>
                <th align="center">
                  <bold>proportion</bold>
                </th>
                <th align="center">
                  <bold>1:1</bold>
                </th>
                <td> </td>
                <th align="center">
                  <bold>1:5</bold>
                </th>
                <th align="center">
                  <bold>5:1</bold>
                </th>
                <th align="center">
                  <bold>1:1</bold>
                </th>
                <th align="center">
                  <bold>1:5</bold>
                </th>
                <th align="center">
                  <bold>5:1</bold>
                </th>
                <th align="center">
                  <bold>10:1</bold>
                </th>
                <th align="center">
                  <bold>1:1</bold>
                </th>
                <th align="center">
                  <bold>1:5</bold>
                </th>
                <th align="center">
                  <bold>5:1</bold>
                </th>
                <th align="center">
                  <bold>1:10</bold>
                </th>
                <td> </td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="left" valign="bottom">fmol<hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="left" valign="bottom">500<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">all<hr/></td>
                <td align="left" valign="bottom">1000<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="left" valign="bottom">500<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
                <td align="center" valign="bottom">x<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
                <td align="center" valign="bottom">−<hr/></td>
              </tr>
              <tr>
                <td align="left">default</td>
                <td align="left">1000</td>
                <td align="center">x</td>
                <td align="center">x</td>
                <td align="center">−</td>
                <td align="center">x</td>
                <td align="center">−</td>
                <td align="center">x</td>
                <td align="center">x</td>
                <td align="center">−</td>
                <td align="center">x</td>
                <td align="center">−</td>
                <td align="center">−</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>Results of the analyses of the series of spectra containing two overlapping target peptides. The first column contains the <italic>m</italic>/<italic>z</italic>
positions and the charges (in brackets) of the two peptides. The two middle columns indicate whether the corresponding problem is successfully solved (‘x’) or not (‘−’) when optimizing over a grid of parameter combinations (column ‘all’) and when using the default parameter set (column ‘default’).</p>
          </table-wrap-foot>
        </table-wrap>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusion</title>
    <p>We have proposed a template matching approach for feature extraction in proteomic mass spectra. The main methodological innovation is a framework for sparse recovery in which sparsity is not promoted explicitly by a regularization term, as it is usually done and was done in previous work. We fully exploit the strength of non-negativity constraints, which permits us to circumvent the delicate choice of a ‘proper’ amount of regularization, an ever-lasting problem in statistics, and to work with thresholding instead. The latter is not only computationally attractive, because one does not have to repeatedly solve the same optimization problem for different choices of the regularization parameter, but also increases user-friendliness, since the threshold is directly related to the signal-to-noise ratio, the quantity domain experts are interested in. The replacement of a regularization parameter by a threshold is a cornerstone in our conceptual design guided by the principle to relieve the user from laboursome fine tuning of parameters. We believe that a small set of well-interpretable parameters with suitable defaults additionally improves robustness and reproducibility of results. In this context, we would like to emphasize again that apart from the threshold, the user does not have to specify any parameters before running our software.</p>
    <p>In a comprehensive experimental study involving instruments of varying resolution and spectra of varying concentration levels, where we comparatively assess the performance of our approach on the basis of an elaborate dual validation scheme, it is demonstrated that the performance for pattern picking is excellent for MALDI-TOF spectra and outstands due to its specificity in selecting signal and only little noise. A major strength of the method is its ability to unmix overlapping peptide signals as shown for a series of ESI spectra. In total, we demonstrate that our approach is broadly applicable to a variety of spectra. While our approach is guided by a concrete application in proteomics, the framework is general enough to be of much of use for related deconvolution problems emerging in other fields − only the templates have to be adjusted according to the specific application.</p>
    <p>While in this paper, we have focused on single spectra, the approach can be extended to process whole LC-MS runs, as it has already been implemented in our <monospace>R</monospace> package <monospace>IPPD</monospace>. More precisely, the sweep line scheme of [<xref ref-type="bibr" rid="B44">44</xref>] is used to agglomerate the results from single spectra. To apply our methods on a routine basis, an improved implementation, notably parallelization, is required, since e.g. processing a single spectrum of the Maxquant datasets [<xref ref-type="bibr" rid="B2">2</xref>] takes 10s on average on a Unix system equipped with an Intel(R) Core(TM)2 Duo CPU T9400 (2.53GHz) and 4 GB main memory. There is much room for an improvement, since our implementation is based on interpreted <monospace>R</monospace> code.</p>
    <p>Concerning future directions of research, a question we have not yet answered in a satisfactory way is the choice of the fitting criterion. While both criteria (least squares and least absolute deviation) employed in this paper perform well, their implicit assumption of additive noise might be questionable [<xref ref-type="bibr" rid="B45">45</xref>]. It is worth investigating whether a multiplicative noise model could even yield better results. Second, one might ask whether the performance could be further improved when it is used jointly with the isotope wavelet, which is affected by overlaps, but has the potential to achieve higher protein sequence coverage.</p>
  </sec>
  <sec>
    <title>Endnotes</title>
    <p><sup>a</sup>Monoisotopic peptide mass centers are modelled by: 1.000485·<italic>m</italic><sub><italic>n</italic></sub> + 0.029, where <italic>m</italic><sub><italic>n</italic></sub> denotes the nominal mass.<sup>b</sup>For the MALDI-TOF lysozyme datasets an extended search tolerance of 100ppm was applied due to experimental miscalibration of the MS.</p>
  </sec>
  <sec>
    <title>Appendix</title>
  </sec>
  <sec>
    <title>Fitting with non-negativity constraints</title>
    <p>In the following, we provide the details concerning optimization problem (7). In view of the special structure of <bold>
Φ
</bold>, (7) is computationally tractable even if <italic>n</italic> and the number of templates are in the ten thousands. We exploit the sparsity of the problem arising from templates which are highly localized, i.e. the domain on which they are numerically different from zero covers only a small part of the whole <italic>m</italic>/<italic>z</italic> range of the spectrum. As a consequence both <bold>
Φ
</bold>
and the Gram matrix <bold>
Φ
</bold><sup>⊤</sup><bold>
Φ
</bold>, which is crucial in the computation, can conveniently be handled by using software for sparse matrices. For <monospace>R</monospace>, such software is available in the <monospace>Matrix</monospace> package [<xref ref-type="bibr" rid="B46">46</xref>].</p>
    <sec>
      <title>Non-negative least squares</title>
      <p>Consider the quadratic program
</p>
      <p>
        <disp-formula id="bmcM13">
          <label>(13)</label>
          <mml:math id="M58" name="1471-2105-13-291-i58" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:munder>
                    <mml:mrow>
                      <mml:mo>min</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>β</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>∥</mml:mo>
                  <mml:mi mathvariant="bold-italic">y</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mo>Φ</mml:mo>
                  </mml:mstyle>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo>∥</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM14">
          <label>(14)</label>
          <mml:math id="M59" name="1471-2105-13-291-i59" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mtext>subject to</mml:mtext>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                  <mml:mo>≥</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mi>.</mml:mi>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>In order to solve (12), we use the so-called log-barrier method which amounts to solving a sequence of an unconstrained nonlinear convex problems in which the constraints <italic>I</italic>(<italic>β</italic><sub><italic>j</italic></sub>≥0), <italic>j</italic>=1,…,<italic>p</italic>, are taken into account by incorporating log-barrier terms −log(<italic>β</italic><sub><italic>j</italic></sub>)/<italic>γ</italic> in the objective. As <italic>γ</italic>→<italic>∞</italic>, the log-barrier acts like a function which equals + <italic>∞</italic>
if <italic>β</italic><sub><italic>j</italic></sub>&lt;0
and zero otherwise. Beginning with a moderately sized starting value for <italic>γ</italic>, we solve the convex problem
</p>
      <p>
        <disp-formula id="bmcM15">
          <label>(15)</label>
          <mml:math id="M60" name="1471-2105-13-291-i60" overflow="scroll">
            <mml:munder>
              <mml:mrow>
                <mml:mo>min</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mstyle mathvariant="bold-italic">
                  <mml:mi>β</mml:mi>
                </mml:mstyle>
              </mml:mrow>
            </mml:munder>
            <mml:mfrac>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:mfrac>
            <mml:mo>∥</mml:mo>
            <mml:mi mathvariant="bold-italic">y</mml:mi>
            <mml:mo>−</mml:mo>
            <mml:mstyle mathvariant="bold-italic">
              <mml:mo>Φ</mml:mo>
            </mml:mstyle>
            <mml:mstyle mathvariant="bold-italic">
              <mml:mi>β</mml:mi>
            </mml:mstyle>
            <mml:msubsup>
              <mml:mrow>
                <mml:mo>∥</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>−</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>γ</mml:mi>
              </mml:mrow>
            </mml:mfrac>
            <mml:munderover>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
            </mml:munderover>
            <mml:mo>log</mml:mo>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>β</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>using Newton’s method. The gradient and Hessian with respect to <bold><italic>β</italic></bold>, respectively, are given by
</p>
      <p>
        <disp-formula id="bmcM16">
          <label>(16)</label>
          <mml:math id="M61" name="1471-2105-13-291-i61" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>∇</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>β</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:msub>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mo>Φ</mml:mo>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>⊤</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>(</mml:mo>
                  <mml:mi mathvariant="bold-italic">y</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mo>Φ</mml:mo>
                  </mml:mstyle>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                  <mml:mo>)</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>γ</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo>[</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>/</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>β</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mspace width="2.77695pt"/>
                      <mml:mo>…</mml:mo>
                      <mml:mspace width="2.77695pt"/>
                      <mml:mn>1</mml:mn>
                      <mml:mo>/</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>β</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>]</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>⊤</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mi>.</mml:mi>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo>∇</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>β</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mo>Φ</mml:mo>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>⊤</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mo>Φ</mml:mo>
                  </mml:mstyle>
                  <mml:mo>+</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>γ</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mtext>diag</mml:mtext>
                  <mml:mo>(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>/</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>β</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>,</mml:mo>
                  <mml:mo>…</mml:mo>
                  <mml:mo>,</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>/</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>β</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>)</mml:mo>
                  <mml:mi>.</mml:mi>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>The Newton descent direction <bold><italic>d</italic></bold><sub><bold><italic>β</italic></bold></sub> is obtained from the linear system
</p>
      <p>
        <disp-formula id="bmcM17">
          <label>(17)</label>
          <mml:math id="M62" name="1471-2105-13-291-i62" overflow="scroll">
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mo>∇</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msubsup>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mo>−</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>∇</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
              </mml:msub>
              <mml:mi>.</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Solution of linear systems of this structure constitutes the main computational effort to be made. Fast solutions are obtained by using <monospace>CHOLMOD</monospace>[<xref ref-type="bibr" rid="B47">47</xref>], which offers an efficient implementation for computing the Cholesky factorization of sparse symmetric, positive definite matrices. Since the diagonal of <inline-formula><mml:math id="M63" name="1471-2105-13-291-i63" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> changes from one Newton iteration to the next, one Cholesky factorization has to be performed per Newton step. Once we have solved (14) for a specific <italic>γ</italic>, we solve a new problem of the type (14) for <italic>γ</italic>·<italic>M</italic>, <italic>M</italic>&gt;1. This is repeated until <italic>γ</italic>
exceeds a predefined maximum value. For a thorough account on the log-barrier method, we refer to [<xref ref-type="bibr" rid="B20">20</xref>].</p>
    </sec>
    <sec>
      <title>Complexity analysis of non-negative least squares</title>
      <p>We here provide the order of magnitude of floating points operations (flops) required per update (i.e. per Newton step) for the specific non-negative least squares problems considered for this paper. In our implementation, we exploit that the templates contained in the matrix <bold>
Φ
</bold>
are highly localized. As a result, after a suitable column permutation, the matrix <bold>
Φ
</bold><sup>⊤</sup><bold>
Φ
</bold> is roughly a band matrix with bandwidth <italic>k</italic> no larger than only few hundreds. The dominant operation is solving the linear system <inline-formula><mml:math id="M64" name="1471-2105-13-291-i64" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow></mml:msub></mml:math></inline-formula> with the help of the Cholesky factorization, which can be done in <italic>O</italic>(<italic>p</italic><italic>k</italic><sup>2</sup>)
flops (e.g. [<xref ref-type="bibr" rid="B20">20</xref>], p.670). Our algorithm terminates after usually no more than one hundred Newton steps.</p>
    </sec>
    <sec>
      <title>Non-negative least absolute deviation</title>
      <p>Consider the optimization problem
</p>
      <p>
        <disp-formula id="bmcM18">
          <label>(18)</label>
          <mml:math id="M65" name="1471-2105-13-291-i65" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:munder>
                    <mml:mrow>
                      <mml:mo>min</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>β</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mo>∥</mml:mo>
                  <mml:mi mathvariant="bold-italic">y</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mo>Φ</mml:mo>
                  </mml:mstyle>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>∥</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM19">
          <label>(19)</label>
          <mml:math id="M66" name="1471-2105-13-291-i66" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mtext>subject to</mml:mtext>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                  <mml:mo>≥</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mi>.</mml:mi>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>Problem (15) can be recast as the following linear program.
</p>
      <p>
        <disp-formula id="bmcM20">
          <label>(20)</label>
          <mml:math id="M67" name="1471-2105-13-291-i67" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:munder>
                    <mml:mrow>
                      <mml:mo>min</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">r</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>⊤</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mn>1</mml:mn>
                  </mml:mstyle>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mtext>subject to</mml:mtext>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mo>Φ</mml:mo>
                  </mml:mstyle>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                  <mml:mo>−</mml:mo>
                  <mml:mi mathvariant="bold-italic">y</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:mi mathvariant="bold-italic">r</mml:mi>
                  <mml:mo>≥</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mi mathvariant="bold-italic">y</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mo>Φ</mml:mo>
                  </mml:mstyle>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                  <mml:mo>+</mml:mo>
                  <mml:mi mathvariant="bold-italic">r</mml:mi>
                  <mml:mo>≥</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mi mathvariant="bold-italic">r</mml:mi>
                  <mml:mo>≥</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                  <mml:mo>≥</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mi>.</mml:mi>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>For its solution, we use the log-barrier method sketched in the previous paragraph. After incorporating log-barrier terms for all constraints, the objectives of the unconstrained convex problems are of the form
</p>
      <p>
        <disp-formula id="bmcM21">
          <label>(21)</label>
          <mml:math id="M68" name="1471-2105-13-291-i68" overflow="scroll">
            <mml:mrow>
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>⊤</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mstyle mathvariant="bold-italic">
                      <mml:mn>1</mml:mn>
                    </mml:mstyle>
                    <mml:mo>−</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>γ</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mspace width="0.3em"/>
                    <mml:mfenced open="(" close=")">
                      <mml:mrow>
                        <mml:munderover accentunder="false" accent="false">
                          <mml:mrow>
                            <mml:mi mathsize="big">∑</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:munderover>
                        <mml:mfenced open="(" close=")">
                          <mml:mtext>log</mml:mtext>
                          <mml:mfenced open="(" close=")">
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>ξ</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo>+</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mfenced>
                          <mml:mo>+</mml:mo>
                          <mml:mtext>log</mml:mtext>
                          <mml:mfenced open="(" close=")">
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>ξ</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo>−</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mfenced>
                          <mml:mo>+</mml:mo>
                          <mml:mtext>log</mml:mtext>
                          <mml:mfenced open="(" close=")">
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>r</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mfenced>
                        </mml:mfenced>
                        <mml:mo>+</mml:mo>
                        <mml:munderover accentunder="false" accent="false">
                          <mml:mrow>
                            <mml:mi mathsize="big">∑</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>p</mml:mi>
                          </mml:mrow>
                        </mml:munderover>
                        <mml:mo>log</mml:mo>
                        <mml:mfenced open="(" close=")">
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>β</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mo>,</mml:mo>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p> where we have used the notational shortcuts
</p>
      <p>
        <disp-formula id="bmcM22">
          <label>(22)</label>
          <mml:math id="M69" name="1471-2105-13-291-i69" overflow="scroll">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>ξ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>+</mml:mo>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mo>Φ</mml:mo>
                      </mml:mstyle>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>β</mml:mi>
                      </mml:mstyle>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>y</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>ξ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>y</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mo>Φ</mml:mo>
                      </mml:mstyle>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>β</mml:mi>
                      </mml:mstyle>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mi>i</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mo>…</mml:mo>
                  <mml:mo>,</mml:mo>
                  <mml:mi>n.</mml:mi>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>The gradients w.r.t. <bold><italic>r</italic></bold>
and <bold><italic>β</italic></bold>, respectively, are given by
</p>
      <p>
        <disp-formula id="bmcM23">
          <label>(23)</label>
          <mml:math id="M70" name="1471-2105-13-291-i70" overflow="scroll">
            <mml:mrow>
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>∇</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">r</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mstyle mathvariant="bold-italic">
                      <mml:mn>1</mml:mn>
                    </mml:mstyle>
                    <mml:mo>−</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>γ</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mfenced open="[" close="]">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>ξ</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mo>+</mml:mo>
                                  </mml:mrow>
                                </mml:msubsup>
                                <mml:mo>+</mml:mo>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>ξ</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mo>−</mml:mo>
                                  </mml:mrow>
                                </mml:msubsup>
                                <mml:mo>+</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>r</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                            <mml:mspace width="2.77695pt"/>
                            <mml:mo>…</mml:mo>
                            <mml:mspace width="2.77695pt"/>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>ξ</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>n</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mo>+</mml:mo>
                                  </mml:mrow>
                                </mml:msubsup>
                                <mml:mo>+</mml:mo>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>ξ</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>n</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mo>−</mml:mo>
                                  </mml:mrow>
                                </mml:msubsup>
                                <mml:mo>+</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>r</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>n</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>⊤</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>,</mml:mo>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>∇</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mstyle mathvariant="bold-italic">
                          <mml:mi>β</mml:mi>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>γ</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>(</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mstyle mathvariant="bold-italic">
                          <mml:mo>Φ</mml:mo>
                        </mml:mstyle>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>⊤</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>(</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mo>Ξ</mml:mo>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>+</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>−</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mo>Ξ</mml:mo>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>)</mml:mo>
                    <mml:mstyle mathvariant="bold-italic">
                      <mml:mn>1</mml:mn>
                    </mml:mstyle>
                    <mml:mo>+</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>/</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>β</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mspace width="1em"/>
                        <mml:mspace width="0.3em"/>
                        <mml:mo>…</mml:mo>
                        <mml:mspace width="0.3em"/>
                        <mml:mspace width="1em"/>
                        <mml:mn>1</mml:mn>
                        <mml:mo>/</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>β</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>p</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>⊤</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>)</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:mspace width="2.77695pt"/>
                    <mml:mspace width="2.77695pt"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mstyle mathvariant="bold-italic">
                          <mml:mo>Ξ</mml:mo>
                        </mml:mstyle>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>±</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>=</mml:mo>
                    <mml:mtext>diag</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>ξ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>±</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>,</mml:mo>
                    <mml:mo>…</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>ξ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>±</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>)</mml:mo>
                    <mml:mi>.</mml:mi>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p> Introducing <bold><italic>R</italic></bold>=diag(<italic>r</italic><sub>1</sub>,…,<italic>r</italic><sub><italic>n</italic></sub>) and <bold><italic>B</italic></bold>=diag(<italic>β</italic><sub>1</sub>,…,<italic>β</italic><sub><italic>p</italic></sub>), the Hessian is given by the block matrix
</p>
      <p>
        <disp-formula id="bmcM24">
          <label>(24)</label>
          <mml:math id="M71" name="1471-2105-13-291-i71" overflow="scroll">
            <mml:mrow>
              <mml:mfenced open="[" close="]">
                <mml:mrow>
                  <mml:mtable class="array" columnalign="left">
                    <mml:mtr>
                      <mml:mtd>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mo>∇</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>r</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo>∇</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>r</mml:mi>
                            </mml:mstyle>
                            <mml:mspace width="2.77695pt"/>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>β</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mo>∇</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>r</mml:mi>
                            </mml:mstyle>
                            <mml:mspace width="2.77695pt"/>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>β</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>⊤</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mo>∇</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>β</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:mfenced open="[" close="]">
                <mml:mrow>
                  <mml:mtable class="array" columnalign="left">
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>γ</mml:mi>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>(</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>[</mml:mo>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mstyle mathvariant="bold-italic">
                                  <mml:mo>Ξ</mml:mo>
                                </mml:mstyle>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo>+</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mo>]</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>+</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>[</mml:mo>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mstyle mathvariant="bold-italic">
                                  <mml:mo>Ξ</mml:mo>
                                </mml:mstyle>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo>−</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mo>]</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>+</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>R</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>)</mml:mo>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>γ</mml:mi>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>(</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>[</mml:mo>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mstyle mathvariant="bold-italic">
                                  <mml:mo>Ξ</mml:mo>
                                </mml:mstyle>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo>+</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mo>]</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mstyle mathvariant="bold-italic">
                          <mml:mo>Φ</mml:mo>
                        </mml:mstyle>
                        <mml:mo>−</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>[</mml:mo>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mstyle mathvariant="bold-italic">
                                  <mml:mo>Ξ</mml:mo>
                                </mml:mstyle>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo>−</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mo>]</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mstyle mathvariant="bold-italic">
                          <mml:mo>Φ</mml:mo>
                        </mml:mstyle>
                        <mml:mo>)</mml:mo>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>γ</mml:mi>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>(</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mo>Φ</mml:mo>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>⊤</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>[</mml:mo>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mstyle mathvariant="bold-italic">
                                  <mml:mo>Ξ</mml:mo>
                                </mml:mstyle>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo>+</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mo>]</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>−</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mo>Φ</mml:mo>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>⊤</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>[</mml:mo>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mstyle mathvariant="bold-italic">
                                  <mml:mo>Ξ</mml:mo>
                                </mml:mstyle>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo>−</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mo>]</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>)</mml:mo>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>γ</mml:mi>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>(</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mo>Φ</mml:mo>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>⊤</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>(</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>[</mml:mo>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mstyle mathvariant="bold-italic">
                                  <mml:mo>Ξ</mml:mo>
                                </mml:mstyle>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo>+</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mo>]</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>+</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>[</mml:mo>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mstyle mathvariant="bold-italic">
                                  <mml:mo>Ξ</mml:mo>
                                </mml:mstyle>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo>−</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mo>]</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>)</mml:mo>
                        <mml:mstyle mathvariant="bold-italic">
                          <mml:mo>Φ</mml:mo>
                        </mml:mstyle>
                        <mml:mo>)</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>B</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>)</mml:mo>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mfenced>
              <mml:mi>.</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The linear system for the Newton descent directions reads
</p>
      <p>
        <disp-formula id="bmcM25">
          <label>(25)</label>
          <mml:math id="M72" name="1471-2105-13-291-i72" overflow="scroll">
            <mml:mrow>
              <mml:mfenced open="[" close="]">
                <mml:mrow>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mo>∇</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>r</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo>∇</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>r</mml:mi>
                            </mml:mstyle>
                            <mml:mspace width="2.77695pt"/>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>β</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mo>∇</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>r</mml:mi>
                            </mml:mstyle>
                            <mml:mspace width="2.77695pt"/>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>β</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>⊤</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mo>∇</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>β</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mfenced>
              <mml:mspace width="1em"/>
              <mml:mfenced open="[" close="]">
                <mml:mrow>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>d</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>r</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>d</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>β</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:mo>−</mml:mo>
              <mml:mfenced open="[" close="]">
                <mml:mrow>
                  <mml:mtable class="array" columnalign="left">
                    <mml:mtr>
                      <mml:mtd>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo>∇</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>r</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo>∇</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mi>β</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mfenced>
              <mml:mi>.</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Note that <inline-formula><mml:math id="M73" name="1471-2105-13-291-i73" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> is diagonal, so it is a cheap operation to resolve for <bold><italic>d</italic></bold><sub><bold><italic>r</italic></bold></sub>
once <bold><italic>d</italic></bold><sub><bold><italic>β</italic></bold></sub> is known:
</p>
      <p>
        <disp-formula id="bmcM26">
          <label>(26)</label>
          <mml:math id="M74" name="1471-2105-13-291-i74" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">r</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mo>−</mml:mo>
              <mml:msup>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo>∇</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msup>
              <mml:mo>(</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>∇</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">r</mml:mi>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
              </mml:msub>
              <mml:mspace width="2.77695pt"/>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
              </mml:msub>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>∇</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">r</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>)</mml:mo>
              <mml:mi>.</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Plugging this into the second block of the linear system, one obtains
</p>
      <p>
        <disp-formula id="bmcM27">
          <label>(27)</label>
          <mml:math id="M75" name="1471-2105-13-291-i75" overflow="scroll">
            <mml:mrow>
              <mml:mo>−</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mo>∇</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">r</mml:mi>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>⊤</mml:mo>
                </mml:mrow>
              </mml:msubsup>
              <mml:msup>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo>∇</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msup>
              <mml:mo>(</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>∇</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">r</mml:mi>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
              </mml:msub>
              <mml:mspace width="2.77695pt"/>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
              </mml:msub>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>∇</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">r</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>)</mml:mo>
              <mml:mo>+</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mo>∇</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msubsup>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mo>−</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>∇</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p> which is equivalent to
</p>
      <p>
        <disp-formula id="bmcM28">
          <label>(28)</label>
          <mml:math id="M76" name="1471-2105-13-291-i76" overflow="scroll">
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mo>∇</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>−</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mo>∇</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">r</mml:mi>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>⊤</mml:mo>
                </mml:mrow>
              </mml:msubsup>
              <mml:msup>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo>∇</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msup>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>∇</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">r</mml:mi>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
              </mml:msub>
              <mml:mo>)</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mo>−</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>∇</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
              </mml:msub>
              <mml:mo>+</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mo>∇</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">r</mml:mi>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>β</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>⊤</mml:mo>
                </mml:mrow>
              </mml:msubsup>
              <mml:msup>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo>∇</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msup>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>∇</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">r</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mi>.</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>In order to solve the linear system, we proceed as for non-negative least squares. The computational cost of this operation is roughly the same, since the sparse structure of <bold>
Φ
</bold><sup>⊤</sup><bold>
Φ
</bold>
can still be exploited. For non-negative least squares, re-computation of the Hessian <inline-formula><mml:math id="M77" name="1471-2105-13-291-i77" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> only involves a diagonal update, an operation of negligible computational cost. However, for non-negative least absolute deviation, computation <inline-formula><mml:math id="M78" name="1471-2105-13-291-i78" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>β</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> involves the matrix multiplication (<bold>
Φ
</bold><sup>⊤</sup>([<bold><italic>Ξ</italic></bold><sup> + </sup>]<sup>−2</sup> + [<bold><italic>Ξ</italic></bold><sup>−</sup>]<sup>−2</sup>)<bold>
Φ
</bold>), i.e. essentially a repeated computation of a scaled Gram matrix. In spite of the special structure of <bold>
Φ
</bold><sup>⊤</sup><bold>
Φ
</bold>, the computational cost is of the same order as the solution of the linear system even when using a self-written routine for matrix multiplication tailored to the specific structure.</p>
    </sec>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>MS and MH devised the methodology as presented in Section “Methods”. MS implemented the Bioconductor package, with contributions by RH and MH. The comparative data analysis was performed by RH, MS, MH and AH; RH and AH performed the MASCOT queries. AT developed the experimental design and provided an interpretation of the MS data. TJ and BG conducted the MS experiments and produced the results of the vendor software. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p>MALDI-TOF spectra.</p>
      </caption>
      <media xlink:href="1471-2105-13-291-S1.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p>ESI spectra.</p>
      </caption>
      <media xlink:href="1471-2105-13-291-S2.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p>Evaluation and results.</p>
      </caption>
      <media xlink:href="1471-2105-13-291-S3.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S4">
      <caption>
        <title>Additional file 4</title>
        <p>Overlapping peptide signals.</p>
      </caption>
      <media xlink:href="1471-2105-13-291-S4.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Markus Martin for setting up the Bruker Daltonics HCT Ultra Ion Trap MS and Bart van den Berg for measuring the LC-MS datasets used in the vignette of the <monospace>R</monospace> package <monospace>IPPD</monospace>. We thank Fredrik Levander and Thorsteinn Rognvaldsson for providing us the pepex implementation. We thank the reviewers and an associate editor whose comments and suggestions led to a substantial improvement over previous drafts.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>Clusters of Excellence ‘Multimodal Computing and Interaction’ (to M.S., R.H. and B.G.), ‘Inflammation@Interfaces’ (to A.T. and T.J.) within the Excellence Initiative of the German Federal Government; DFG (grants BIZ4:1-4 to R.H. and A.H.).</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mo</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Mo</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Goodlett</surname>
          <given-names>DR</given-names>
        </name>
        <name>
          <surname>Hood</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Omenn</surname>
          <given-names>GS</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Lin</surname>
          <given-names>B</given-names>
        </name>
        <article-title>WaveletQuant, an improved quantification software based on wavelet signal threshold de-noising for labeled quantitative proteomic analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>219</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-219</pub-id>
        <pub-id pub-id-type="pmid">20429928</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cox</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Mann</surname>
          <given-names>M</given-names>
        </name>
        <article-title>MaxQuant enables high peptide identification rates, individualized p.p.b.-range mass accuracies and proteome-wide protein quantification</article-title>
        <source>Nat Biotechnol</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>1367</fpage>
        <lpage>1372</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1511</pub-id>
        <pub-id pub-id-type="pmid">19029910</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Renard</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Kirchner</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Steen</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Steen</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Hamprecht</surname>
          <given-names>F</given-names>
        </name>
        <article-title>NITPICK: peak identification for mass spectrometry data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>355</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-355</pub-id>
        <pub-id pub-id-type="pmid">18755032</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hoopmann</surname>
          <given-names>MR</given-names>
        </name>
        <name>
          <surname>Finney</surname>
          <given-names>GL</given-names>
        </name>
        <name>
          <surname>MacCoss</surname>
          <given-names>MJ</given-names>
        </name>
        <article-title>High-speed data reduction, feature detection, and MS/MS spectrum quality assessment of shotgun proteomics data sets using high-resolution mass spectrometry</article-title>
        <source>Anal Chem</source>
        <year>2007</year>
        <volume>79</volume>
        <fpage>5620</fpage>
        <lpage>5632</lpage>
        <pub-id pub-id-type="doi">10.1021/ac0700833</pub-id>
        <pub-id pub-id-type="pmid">17580982</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gambin</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Dutkowski</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Karczmarski</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kluge</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Kowalczyk</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Ostrowski</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Poznanski</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Tiuryn</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Bakun</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Dadlez</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Automated reduction and interpretation of multidimensional mass spectra for analysis of complex peptide mixtures</article-title>
        <source>Int J Mass Spectrom</source>
        <year>2007</year>
        <volume>260</volume>
        <fpage>20</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ijms.2006.06.011</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mantini</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Petrucci</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Pieragostino</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Del</surname>
          <given-names>Boccio</given-names>
          <suffix>P</suffix>
        </name>
        <name>
          <surname>Di</surname>
          <given-names>Nicola</given-names>
          <suffix>M</suffix>
        </name>
        <name>
          <surname>Di</surname>
          <given-names>Ilio</given-names>
          <suffix>C</suffix>
        </name>
        <name>
          <surname>Federici</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Sacchetta</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Comani</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Urbani</surname>
          <given-names>A</given-names>
        </name>
        <article-title>LIMPIC: a computational method for the separation of protein MALDI-TOF-MS signals from noise</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>101</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-101</pub-id>
        <pub-id pub-id-type="pmid">17386085</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Noy</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Fasulo</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Improved model-based, platform-independent feature extraction for mass spectrometry</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2528</fpage>
        <lpage>2535</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm385</pub-id>
        <pub-id pub-id-type="pmid">17698491</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kaur</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>O’Connor</surname>
          <given-names>PB</given-names>
        </name>
        <article-title>Algorithms for automatic interpretation of high resolution mass spectra</article-title>
        <source>J Am Soc Mass Spectrom</source>
        <year>2006</year>
        <volume>17</volume>
        <fpage>459</fpage>
        <lpage>468</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jasms.2005.11.024</pub-id>
        <pub-id pub-id-type="pmid">16464606</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tibshirani</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Regression shrinkage and variable selection via the lasso</article-title>
        <source>J R Stat Soc Ser B</source>
        <year>1996</year>
        <volume>58</volume>
        <fpage>671</fpage>
        <lpage>686</lpage>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Du</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Angeletti</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Automatic deconvolution of isotope resolved mass spectra using variable Selection and quantized peptide mass distribution</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>3385</fpage>
        <lpage>3392</lpage>
        <pub-id pub-id-type="doi">10.1021/ac052212q</pub-id>
        <pub-id pub-id-type="pmid">16689541</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tibshirani</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Regression shrinkage and selection via the lasso: a retrospective (with discussion)</article-title>
        <source>J R Stat Soc Ser B</source>
        <year>2011</year>
        <volume>73</volume>
        <fpage>273</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9868.2011.00771.x</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="book">
        <name>
          <surname>Slawski</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Hein</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Sparse recovery by thresholded non-negative least squares</article-title>
        <source>Advances in Neural Information Processing Systems 24</source>
        <year>2011</year>
        <publisher-name>MIT press, Cambridge, Massachusetts</publisher-name>
        <fpage>1926</fpage>
        <lpage>1934</lpage>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lange</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Gropl</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Reinert</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Kohlbacher</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Hildebrandt</surname>
          <given-names>A</given-names>
        </name>
        <article-title>High-accuracy peak picking of proteomics data using wavelet techniques</article-title>
        <source>Pac Symp Biocomput</source>
        <year>2006</year>
        <volume>11</volume>
        <fpage>243</fpage>
        <lpage>254</lpage>
        <pub-id pub-id-type="pmid">17094243</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="book">
        <name>
          <surname>Schulz-Trieglaff</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Hussong</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Gröpl</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Hildebrandt</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Reinert</surname>
          <given-names>K</given-names>
        </name>
        <article-title>A fast and accurate algorithm for the quantification of peptides from mass spectrometry data</article-title>
        <source>Proceedings of the Eleventh Annual International Conference on Research in Computational Molecular Biology (RECOMB 2007), Volume 11,</source>
        <year>2007</year>
        <publisher-name>Springer, Berlin</publisher-name>
        <fpage>437</fpage>
        <lpage>487</lpage>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zubarev</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Accurate monoisotopic mass measurements of peptides: possibilities and limitations of high resolution time-of-flight particle desorption mass spectrometry</article-title>
        <source>Rapid Commun Mass Spectrom</source>
        <year>1996</year>
        <volume>10</volume>
        <issue>11</issue>
        <fpage>1386</fpage>
        <lpage>1392</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1097-0231(199608)10:11&lt;1386::AID-RCM652&gt;3.0.CO;2-T</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Senko</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Beu</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>McLafferty</surname>
          <given-names>F</given-names>
        </name>
        <article-title>Determination of monoisotopic masses and ion populations for large biomolecules from resolved isotopic distributions</article-title>
        <source>J Am Soc Mass Spectrom</source>
        <year>1995</year>
        <volume>6</volume>
        <fpage>229</fpage>
        <lpage>233</lpage>
        <pub-id pub-id-type="doi">10.1016/1044-0305(95)00017-8</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Horn</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Zubarev</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>McLafferty</surname>
          <given-names>FW</given-names>
        </name>
        <article-title>Automated reduction and interpretation of high resolution electrospray mass spectra of large molecules</article-title>
        <source>J Am Soc Mass Spectrom</source>
        <year>2000</year>
        <volume>11</volume>
        <fpage>320</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="doi">10.1016/S1044-0305(99)00157-9</pub-id>
        <pub-id pub-id-type="pmid">10757168</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lou</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Renard</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Kirchner</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Koethe</surname>
          <given-names>U</given-names>
        </name>
        <name>
          <surname>Graf</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Steen</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Steen</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Mayer</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Hamprecht</surname>
          <given-names>F</given-names>
        </name>
        <article-title>Deuteration distribution estimation with improved sequence coverage for HDX/MS experiments</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1535</fpage>
        <lpage>1541</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq165</pub-id>
        <pub-id pub-id-type="pmid">20439256</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Suits</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Hoekman</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Rosenling</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Bischoff</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Horvatovich</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Threshold-avoiding proteomics pipeline</article-title>
        <source>Anal Chem</source>
        <year>2011</year>
        <volume>83</volume>
        <fpage>7786</fpage>
        <lpage>7794</lpage>
        <pub-id pub-id-type="doi">10.1021/ac201332j</pub-id>
        <pub-id pub-id-type="pmid">21879761</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="book">
        <name>
          <surname>Boyd</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Vandenberghe</surname>
          <given-names>L</given-names>
        </name>
        <source>Convex Optimization</source>
        <year>2004</year>
        <publisher-name>Cambridge University Press, New York</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Samuelsson</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Dalevi</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Levander</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Rognvaldsson</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Modular, scriptable and automated analysis tools for high-throughput peptide mass fingerprinting</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>3628</fpage>
        <lpage>3635</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth460</pub-id>
        <pub-id pub-id-type="pmid">15297302</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Efron</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Hastie</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Johnstone</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Tibshirani</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Least Angle Regression (with discussion)</article-title>
        <source>Ann Stat</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>407</fpage>
        <lpage>499</lpage>
        <pub-id pub-id-type="doi">10.1214/009053604000000067</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>van de Geer</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Bühlmann</surname>
          <given-names>P</given-names>
        </name>
        <article-title>On the conditions used to prove oracle results for the Lasso</article-title>
        <source>Electron J Stat</source>
        <year>2009</year>
        <volume>3</volume>
        <fpage>1360</fpage>
        <lpage>1392</lpage>
        <pub-id pub-id-type="doi">10.1214/09-EJS506</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="book">
        <name>
          <surname>Hastie</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Tibshirani</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Friedman</surname>
          <given-names>J</given-names>
        </name>
        <source>The Elements of Statistical Learning, 2nd Edition</source>
        <year>2008</year>
        <publisher-name>Springer, New York</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bruckstein</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Elad</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Zibulevsky</surname>
          <given-names>M</given-names>
        </name>
        <article-title>On the uniqueness of nonnegative sparse solutions to underdetermined systems of equations</article-title>
        <source>IEEE Trans Inf Theory</source>
        <year>2008</year>
        <volume>54</volume>
        <fpage>4813</fpage>
        <lpage>4820</lpage>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="book">
        <name>
          <surname>Wang</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Tang</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Conditions for a unique non-negative solution to an underdetermined system</article-title>
        <source>Proceedings of Allerton Conference on Communication, Control, and Computing, Volume 49,</source>
        <year>2009</year>
        <publisher-name>IEEE Press, Piscataway, New Jersey</publisher-name>
        <fpage>301</fpage>
        <lpage>307</lpage>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Donoho</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Tanner</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Counting the faces of randomly-projected hypercubes and orthants, with applications</article-title>
        <source>Discrete Comput Geometry</source>
        <year>2010</year>
        <volume>43</volume>
        <fpage>522</fpage>
        <lpage>541</lpage>
        <pub-id pub-id-type="doi">10.1007/s00454-009-9221-z</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="book">
        <name>
          <surname>Meinshausen</surname>
          <given-names>N</given-names>
        </name>
        <source>Sign-constrained least squares estimation for high-dimensional regression</source>
        <year>2012</year>
        <publisher-name>Department of Statistics, Oxford University</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Meinshausen</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Yu</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Lasso-type recovery of sparse representations for high-dimensional data</article-title>
        <source>Ann Stat</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>246</fpage>
        <lpage>270</lpage>
        <pub-id pub-id-type="doi">10.1214/07-AOS582</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="book">
        <name>
          <surname>Zhou</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Thresholding Procedures for high dimensional variable selection and statistical estimation</article-title>
        <source>Advances in Neural Information Processing Systems 22</source>
        <year>2009</year>
        <publisher-name>MIT press, Cambridge, Massachusetts</publisher-name>
        <fpage>2304</fpage>
        <lpage>2312</lpage>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhang</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Some sharp performance bounds for least squares regression with L1 regularization</article-title>
        <source>Ann Stat</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>2109</fpage>
        <lpage>2144</lpage>
        <pub-id pub-id-type="doi">10.1214/08-AOS659</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Donoho</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Johnstone</surname>
          <given-names>I</given-names>
        </name>
        <article-title>Ideal spatial adaption by Wavelet shrinkage</article-title>
        <source>Biometrika</source>
        <year>1994</year>
        <volume>81</volume>
        <fpage>425</fpage>
        <lpage>455</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/81.3.425</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Variable selection via nonconcave penalized likelihood and its oracle properties</article-title>
        <source>J Am Stat Association</source>
        <year>2001</year>
        <volume>97</volume>
        <fpage>210</fpage>
        <lpage>221</lpage>
      </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wasserman</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Roeder</surname>
          <given-names>K</given-names>
        </name>
        <article-title>High-dimensional variable selection</article-title>
        <source>Ann Stat</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>2178</fpage>
        <lpage>2201</lpage>
        <pub-id pub-id-type="doi">10.1214/08-AOS646</pub-id>
        <pub-id pub-id-type="pmid">19784398</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Guo</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Hao</surname>
          <given-names>N</given-names>
        </name>
        <article-title>Variance estimation using refitted cross-validation in ultrahigh dimensional regression</article-title>
        <source>J R Stat Soc Ser B</source>
        <year>2012</year>
        <volume>74</volume>
        <fpage>37</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9868.2011.01005.x</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wolski</surname>
          <given-names>WE</given-names>
        </name>
        <name>
          <surname>Farrow</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Emde</surname>
          <given-names>AK</given-names>
        </name>
        <name>
          <surname>Lehrach</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Lalowski</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Reinert</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Analytical model of peptide mass cluster centres with applications</article-title>
        <source>Proteome Sci</source>
        <year>2006</year>
        <volume>4</volume>
        <fpage>18</fpage>
        <pub-id pub-id-type="doi">10.1186/1477-5956-4-18</pub-id>
        <pub-id pub-id-type="pmid">16995952</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Perkins</surname>
          <given-names>DN</given-names>
        </name>
        <name>
          <surname>Pappin</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Creasy</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Cottrell</surname>
          <given-names>JS</given-names>
        </name>
        <article-title>Probability-based protein identification by searching sequence databases using mass spectrometry data</article-title>
        <source>Electrophoresis</source>
        <year>1999</year>
        <volume>20</volume>
        <fpage>3551</fpage>
        <lpage>3567</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1522-2683(19991201)20:18&lt;3551::AID-ELPS3551&gt;3.0.CO;2-2</pub-id>
        <pub-id pub-id-type="pmid">10612281</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Friedman</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Hastie</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Tibshirani</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Regularized paths for generalized linear models via coordinate descent</article-title>
        <source>J Stat Software</source>
        <year>2010</year>
        <volume>33</volume>
        <fpage>1</fpage>
        <lpage>22</lpage>
      </mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="book">
        <name>
          <surname>Hussong</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Tholey</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Hildebrandt</surname>
          <given-names>A</given-names>
        </name>
        <person-group person-group-type="editor">Siebes APJM, Berthold MR, Glen RC, Feelders AJ</person-group>
        <article-title>Efficient Analysis of Mass Spectrometry Data Using the Isotope Wavelet</article-title>
        <source>COMPLIFE 2007: The Third International Symposium on Computational Life Science, Volume 940(1),</source>
        <year>2007</year>
        <publisher-name>AIP, Melville</publisher-name>
        <fpage>139</fpage>
        <lpage>149</lpage>
      </mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hussong</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Gregorius</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Tholey</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Hildebrandt</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Highly accelerated feature detection in proteomics data sets using modern graphics processing units</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1937</fpage>
        <lpage>1943</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp294</pub-id>
        <pub-id pub-id-type="pmid">19447788</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Liu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Inbar</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Dorrestein</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Wyne</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Edwards</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Souda</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Whitelegge</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Bafna</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Pevzner</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Decovolution and database search of complex tandem mass spectra of intact proteins</article-title>
        <source>Mol Cell Proteomics</source>
        <year>2010</year>
        <volume>9</volume>
        <fpage>2772</fpage>
        <lpage>2782</lpage>
        <pub-id pub-id-type="doi">10.1074/mcp.M110.002766</pub-id>
        <pub-id pub-id-type="pmid">20855543</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B42">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tholey</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Pipkorn</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Bossemeyer</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Kinzel</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Reed</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Influence of myristoylation, phosphorylation, and deamidation on the structural behavior of the N-Terminus of the Catalytic subunit of CAMP-Dependent protein kinase</article-title>
        <source>Biochemistry</source>
        <year>2001</year>
        <volume>40</volume>
        <fpage>225</fpage>
        <lpage>231</lpage>
        <pub-id pub-id-type="doi">10.1021/bi0021277</pub-id>
        <pub-id pub-id-type="pmid">11141074</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B43">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Reissner</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Aswad</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Deamidation and isoaspartate formation in proteins: unwanted alterations or surreptitious signals?</article-title>
        <source>Cell Mol Life Sci</source>
        <year>2003</year>
        <volume>60</volume>
        <fpage>1281</fpage>
        <lpage>1295</lpage>
        <pub-id pub-id-type="doi">10.1007/s00018-003-2287-5</pub-id>
        <pub-id pub-id-type="pmid">12943218</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B44">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schulz-Trieglaff</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Hussong</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Gröpl</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Leinenbach</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Hildebrandt</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Huber</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Reinert</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Computational quantification of peptides from LC-MS data</article-title>
        <source>J Comput Biol</source>
        <year>2008</year>
        <volume>15</volume>
        <fpage>685</fpage>
        <lpage>704</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2007.0117</pub-id>
        <pub-id pub-id-type="pmid">18707556</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B45">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Du</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Stolovitzky</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Horvatovich</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Bischoff</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Lim</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Suits</surname>
          <given-names>F</given-names>
        </name>
        <article-title>A noise model for mass spectrometry based proteomics</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>1070</fpage>
        <lpage>1077</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn078</pub-id>
        <pub-id pub-id-type="pmid">18353791</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B46">
      <mixed-citation publication-type="other">
        <name>
          <surname>Bates</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Maechler</surname>
          <given-names>M</given-names>
        </name>
        <source>Matrix: Sparse and Dense Matrix Classes and Methods</source>
        <year>2009</year>
        <comment>[R package version 0.999375-21]</comment>
      </mixed-citation>
    </ref>
    <ref id="B47">
      <mixed-citation publication-type="other">
        <name>
          <surname>Davis</surname>
          <given-names>T</given-names>
        </name>
        <source>CHOLMOD: sparse supernodal Cholesky factorization and update/downdate</source>
        <year>2005</year>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
