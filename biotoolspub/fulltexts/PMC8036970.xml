<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 201905//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Cancers (Basel)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Cancers (Basel)</journal-id>
    <journal-id journal-id-type="publisher-id">cancers</journal-id>
    <journal-title-group>
      <journal-title>Cancers</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2072-6694</issn>
    <publisher>
      <publisher-name>MDPI</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8036970</article-id>
    <article-id pub-id-type="doi">10.3390/cancers13071659</article-id>
    <article-id pub-id-type="publisher-id">cancers-13-01659</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ImmunoAIzer: A Deep Learning-Based Computational Framework to Characterize Cell Distribution and Gene Mutation in Tumor Microenvironment</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-6721-6944</contrib-id>
        <name>
          <surname>Bian</surname>
          <given-names>Chang</given-names>
        </name>
        <xref ref-type="aff" rid="af1-cancers-13-01659">1</xref>
        <xref ref-type="aff" rid="af2-cancers-13-01659">2</xref>
        <xref ref-type="author-notes" rid="fn1-cancers-13-01659">†</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Yu</given-names>
        </name>
        <xref ref-type="aff" rid="af1-cancers-13-01659">1</xref>
        <xref ref-type="aff" rid="af2-cancers-13-01659">2</xref>
        <xref ref-type="author-notes" rid="fn1-cancers-13-01659">†</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lu</surname>
          <given-names>Zhihao</given-names>
        </name>
        <xref ref-type="aff" rid="af3-cancers-13-01659">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>An</surname>
          <given-names>Yu</given-names>
        </name>
        <xref ref-type="aff" rid="af1-cancers-13-01659">1</xref>
        <xref ref-type="aff" rid="af4-cancers-13-01659">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Hanfan</given-names>
        </name>
        <xref ref-type="aff" rid="af1-cancers-13-01659">1</xref>
        <xref ref-type="aff" rid="af5-cancers-13-01659">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kong</surname>
          <given-names>Lingxin</given-names>
        </name>
        <xref ref-type="aff" rid="af1-cancers-13-01659">1</xref>
        <xref ref-type="aff" rid="af2-cancers-13-01659">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Du</surname>
          <given-names>Yang</given-names>
        </name>
        <xref ref-type="aff" rid="af1-cancers-13-01659">1</xref>
        <xref ref-type="aff" rid="af2-cancers-13-01659">2</xref>
        <xref rid="c1-cancers-13-01659" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tian</surname>
          <given-names>Jie</given-names>
        </name>
        <xref ref-type="aff" rid="af1-cancers-13-01659">1</xref>
        <xref ref-type="aff" rid="af2-cancers-13-01659">2</xref>
        <xref ref-type="aff" rid="af4-cancers-13-01659">4</xref>
        <xref ref-type="aff" rid="af5-cancers-13-01659">5</xref>
        <xref rid="c1-cancers-13-01659" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Stadlbauer</surname>
          <given-names>Andreas</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="editor">
        <name>
          <surname>Meyer-Baese</surname>
          <given-names>Anke</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
      <contrib contrib-type="editor">
        <name>
          <surname>Zimmermann</surname>
          <given-names>Max</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <aff id="af1-cancers-13-01659"><label>1</label>CAS Key Laboratory of Molecular Imaging, The State Key Laboratory of Management and Control for Complex Systems, Institute of Automation, Chinese Academy of Sciences, Beijing 100190, China; <email>bianchang2018@ia.ac.cn</email> (C.B.); <email>wangyu2019@ia.ac.cn</email> (Y.W.); <email>yuan1989@buaa.edu.cn</email> (Y.A.); <email>wanghanfan2020@163.com</email> (H.W.); <email>konglingxin17@mails.ucas.ac.cn</email> (L.K.)</aff>
    <aff id="af2-cancers-13-01659"><label>2</label>School of Artificial Intelligence, University of Chinese Academy of Sciences, Beijing 100049, China</aff>
    <aff id="af3-cancers-13-01659"><label>3</label>Department of Gastrointestinal Oncology, Key Laboratory of Carcinogenesis and Translational Research (Ministry of Education), Peking University Cancer Hospital &amp; Institute, Beijing 100142, China; <email>zhihaolupku@bjmu.edu.cn</email></aff>
    <aff id="af4-cancers-13-01659"><label>4</label>Beijing Advanced Innovation Center for Big Data-Based Precision Medicine, School of Medicine Science and Engineering, Beihang University, Beijing 100191, China</aff>
    <aff id="af5-cancers-13-01659"><label>5</label>School of Life Science and Technology, Xidian University, Xi’an 710071, China</aff>
    <author-notes>
      <corresp id="c1-cancers-13-01659"><label>*</label>Correspondence: <email>yang.du@ia.ac.cn</email> (Y.D.); <email>jie.tian@ia.ac.cn</email> (J.T.)</corresp>
      <fn id="fn1-cancers-13-01659">
        <label>†</label>
        <p>These authors contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>01</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <volume>13</volume>
    <issue>7</issue>
    <elocation-id>1659</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 by the authors.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="pmc" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Simple Summary</title>
        <p>A comprehensive evaluation of immune cell distribution in the tumor microenvironment (TME) and tumor gene mutation status may contribute to therapeutic optimization of cancer patients. In this study, we aimed to demonstrate that deep learning (DL)-based computational frameworks have remarkable potential as a tool to analyze the spatial distribution of immune cells and cancer cells in TME and detect tumor gene mutations. TME analysis can benefit from the computational framework, mainly due to its efficiency and low cost. Cells distribution in TME and tumor gene mutation status can be characterized accurately and efficiently. This may lead to a reduced working load of pathologists and may result in an improved and more standardized workflow.</p>
      </sec>
      <sec>
        <title>Abstract</title>
        <p>Spatial distribution of tumor infiltrating lymphocytes (TILs) and cancer cells in the tumor microenvironment (TME) along with tumor gene mutation status are of vital importance to the guidance of cancer immunotherapy and prognoses. In this work, we developed a deep learning-based computational framework, termed ImmunoAIzer, which involves: (1) the implementation of a semi-supervised strategy to train a cellular biomarker distribution prediction network (CBDPN) to make predictions of spatial distributions of CD3, CD20, PanCK, and DAPI biomarkers in the tumor microenvironment with an accuracy of 90.4%; (2) using CBDPN to select tumor areas on hematoxylin and eosin (H&amp;E) staining tissue slides and training a multilabel tumor gene mutation detection network (TGMDN), which can detect APC, KRAS, and TP53 mutations with area-under-the-curve (AUC) values of 0.76, 0.77, and 0.79. These findings suggest that ImmunoAIzer could provide comprehensive information of cell distribution and tumor gene mutation status of colon cancer patients efficiently and less costly; hence, it could serve as an effective auxiliary tool for the guidance of immunotherapy and prognoses. The method is also generalizable and has the potential to be extended for application to other types of cancers other than colon cancer.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>deep learning</kwd>
      <kwd>cell distribution</kwd>
      <kwd>biomarker</kwd>
      <kwd>tumor gene mutation</kwd>
      <kwd>tumor microenvironment (TME)</kwd>
      <kwd>semi-supervised learning</kwd>
      <kwd>hematoxylin and eosin (H&amp;E)</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1-cancers-13-01659">
    <title>1. Introduction</title>
    <p>The tumor microenvironment (TME) is the internal environment in which tumor grows [<xref rid="B1-cancers-13-01659" ref-type="bibr">1</xref>,<xref rid="B2-cancers-13-01659" ref-type="bibr">2</xref>,<xref rid="B3-cancers-13-01659" ref-type="bibr">3</xref>]. The understanding of TME, especially the spatial distribution of tumor infiltrating lymphocytes (TILs) within TME, can be of great importance to offer guidance for immunotherapy [<xref rid="B4-cancers-13-01659" ref-type="bibr">4</xref>,<xref rid="B5-cancers-13-01659" ref-type="bibr">5</xref>,<xref rid="B6-cancers-13-01659" ref-type="bibr">6</xref>,<xref rid="B7-cancers-13-01659" ref-type="bibr">7</xref>] and evaluating prognosis of cancer [<xref rid="B8-cancers-13-01659" ref-type="bibr">8</xref>]. Moreover, tumor gene mutation status is also of vital importance for the prediction of drug efficacy [<xref rid="B9-cancers-13-01659" ref-type="bibr">9</xref>], disease-free survival [<xref rid="B10-cancers-13-01659" ref-type="bibr">10</xref>], and immunotherapy response [<xref rid="B11-cancers-13-01659" ref-type="bibr">11</xref>,<xref rid="B12-cancers-13-01659" ref-type="bibr">12</xref>]. As such, a comprehensive evaluation of immune cell distribution in TMEs and tumor gene mutation status may offer guidance for patient selection and therapeutic optimization.</p>
    <p>Currently, the histological analysis of hematoxylin and eosin (H&amp;E)-stained tissue is considered the gold standard for pathologic diagnoses. Multiplexed immunohistochemistry (mIHC) techniques can help pathologists interpret clinically relevant cellular subtypes and biomolecules, and are widely applied in TME analysis [<xref rid="B13-cancers-13-01659" ref-type="bibr">13</xref>,<xref rid="B14-cancers-13-01659" ref-type="bibr">14</xref>,<xref rid="B15-cancers-13-01659" ref-type="bibr">15</xref>]. The mIHC-based methods allow simultaneous display of the cellular expressions of several biomarkers on tissue slides; thus, they offer more comprehensive insight into disease heterogeneity. However, mIHC has certain limitations [<xref rid="B16-cancers-13-01659" ref-type="bibr">16</xref>]. First, the multiplexed staining method is both time- and cost-consuming. Second, spectrum overlapping can affect the accuracy of the staining results. Third, a professional pathologist is often required to interpret mIHC-based images; thus, the interpretation is subject to individual subjectivity. Therefore, there is an urgent need to develop an alternative and more efficient method to complement the existing mIHC approach to characterize different cell types in the TME.</p>
    <p>A computational framework may provide a more comprehensive, accurate, and objective method to assist in therapeutic optimization [<xref rid="B17-cancers-13-01659" ref-type="bibr">17</xref>]. The application of deep learning (DL) in medical image processing, especially histological image analysis, has been shown to extract valuable information that is imperceptible to humans [<xref rid="B18-cancers-13-01659" ref-type="bibr">18</xref>,<xref rid="B19-cancers-13-01659" ref-type="bibr">19</xref>,<xref rid="B20-cancers-13-01659" ref-type="bibr">20</xref>]. Recent advances in DL and digital pathology have made it possible to derive fluorescence images from transmitted light images of unlabeled fixed or live biological samples [<xref rid="B21-cancers-13-01659" ref-type="bibr">21</xref>], thus demonstrating the capability and reliability of DL methodology as a tool to facilitate biomarker prediction tasks. Burlingame et al. introduced an adversarial deep learning method that they used to infer fluorescence images based on the H&amp;E-stained tissue from a patient with pancreatic ductal adenocarcinoma [<xref rid="B22-cancers-13-01659" ref-type="bibr">22</xref>], further verifying the practicability of DL-based methods as a type of prediction tool for complex human tissues. Moreover, previous research has also suggested that a DL neural network can detect gene mutations based on H&amp;E images [<xref rid="B23-cancers-13-01659" ref-type="bibr">23</xref>], demonstrating the potential application of DL-based methods in the field of pathological image analysis. Hence, we hypothesized that DL may facilitate the evaluation of immune cell and cancer cell distribution in TMEs by predicting the cellular biomarker distribution, meanwhile offer guidance for tumor gene mutation analysis.</p>
    <p>Despite the advancements of DL-based methods in medical image analysis, most existing DL-based methods are fully supervised and require a large amount of labeled data for training to achieve an acceptable level of performance, especially when they are applied to pixel-level segmentation tasks. However, the annotation of medical image data can be very laborious and time-consuming, and it often requires professional pathologists to ensure accuracy [<xref rid="B24-cancers-13-01659" ref-type="bibr">24</xref>]. Thus, it would be very beneficial to develop semi-supervised DL- based computational methods [<xref rid="B25-cancers-13-01659" ref-type="bibr">25</xref>] to leverage unlabeled image data to increase the efficiency. Moreover, The Cancer Genome Atlas (TCGA) dataset contains a massive amount of H&amp;E staining data from cancer patients; however, it remains underutilized and can be useful for a semi-supervised approach.</p>
    <p>In this study, we proposed a computational framework, termed ImmunoAIzer, which can use H&amp;E images to provide comprehensive and valuable information for pathologists to aid TME analysis. ImmunoAIzer contains two components: (1) a semi-supervised cellular biomarker distribution prediction network (CBDPN) which can make predictions of the spatial distribution of CD3, CD20, PanCK, and DAPI on H&amp;E images; (2) a tumor gene mutation detection network (TGMDN), which can detect APC, TP53, and KRAS gene mutations from H&amp;E images. The flowchart of ImmunoAIzer is described in <xref ref-type="fig" rid="cancers-13-01659-f001">Figure 1</xref>. In general, our proposed computational framework can reveal TILs and cancer cells distribution in TME, and facilitate tumor gene mutation assessment. These factors allow the framework to be used as an effective auxiliary tool for the comprehensive evaluation of TME and as a reference for the therapeutic optimization. Furthermore, our method can be extended for application to different cancer types.</p>
  </sec>
  <sec id="sec2-cancers-13-01659">
    <title>2. Materials and Methods</title>
    <sec id="sec2dot1-cancers-13-01659">
      <title>2.1. Dataset Establishment</title>
      <p>The data we used in our work includes two parts: (1) data used for CBDPN training and validation, and (2) data used for TGMDN training and validation.</p>
      <p>For the CBDPN, the dataset included two types of data: (1) pixel-level labeled H&amp;E image data of 8697 H&amp;E image patches and their corresponding label masks of 8 colon cancer patients from Peking University Cancer Hospital and Institute, and (2) unlabeled image data of 50,801 H&amp;E image patches of 60 colon cancer patients acquired from the TCGA dataset, Colon Adenocarcinoma (COAD) project. For the tissue samples acquired from Peking University Cancer Hospital and Institute, the H&amp;E and mIHC stains were conducted. PanCK was used to characterize tumor cells, and CD3 and CD20 were used to characterize TILs [<xref rid="B26-cancers-13-01659" ref-type="bibr">26</xref>], and DAPI for nuclei. The staining and scanning protocols are described in <xref ref-type="app" rid="app2-cancers-13-01659">Appendix A</xref>. First, in order to facilitate annotation, a registration procedure was performed after acquisition of the H&amp;E and mIHC images to ensure that the H&amp;E and mIHC images were spatially registered. Second, the registered H&amp;E and mIHC whole slide images (WSI) were tiled into 512 × 512-pixel patches, and were pixel-level annotated by 3 board certified pathologists. Third, a color normalization [<xref rid="B27-cancers-13-01659" ref-type="bibr">27</xref>,<xref rid="B28-cancers-13-01659" ref-type="bibr">28</xref>] procedure was conducted to improve the image quality. Finally, we conducted a data augmentation procedure to obtain 8697 H&amp;E image patches of which the training, validation, and testing image data ratio was set to be approximately 8:1:1, yielding 6937 image patches in the training set, 946 image patches in the validation set, and 814 images in the test set. The whole data processing pipeline is illustrated in <xref ref-type="app" rid="app1-cancers-13-01659">Figure S1</xref>. The registration procedure and other post-processing details are described in <xref ref-type="app" rid="app3-cancers-13-01659">Appendix B</xref>. Additionally, for the unlabeled image data from the TCGA dataset, the WSIs of 60 patients were tiled into 512 × 512-pixel patches, yielding 50,801 image patches in total, among which 10,200 image patches of 35 patients with background proportion below 50% were utilized for semi-supervised training, and 40,601 image patches of the other 25 patients were utilized for performance validation.</p>
      <p>For the TGMDN, H&amp;E-stained WSIs from 446 colon cancer patients with gene mutations were selected from the TCGA dataset COAD project. In order to make sure that the dataset contains sufficient images with mutations, we chose those which were mutated in at least 10% of the tumor areas. The WSIs were tiled into 512 × 512-pixel patches. For each H&amp;E-stained slide, only patches predicted through our CBDPN to have a PanCK-positive area of more than 50% were selected for implementation. This condition was necessary to choose the images of the tumor area. Finally, we used CBDPN to select 44,534 image patches from 339 patients for the task. The training, validation, and testing image ratio was set to be approximately 14:3:3, respectively, yielding 31,174 H&amp;E image patches in the training set, 6680 H&amp;E images in the validation set, and 6680 H&amp;E images in the test set. All of the H&amp;E patches were intensity-normalized [<xref rid="B27-cancers-13-01659" ref-type="bibr">27</xref>,<xref rid="B28-cancers-13-01659" ref-type="bibr">28</xref>] prior to training.</p>
    </sec>
    <sec id="sec2dot2-cancers-13-01659">
      <title>2.2. CBDPN Training and Validation</title>
      <sec id="sec2dot2dot1-cancers-13-01659">
        <title>2.2.1. Semi-Supervised Mechanism</title>
        <p>In order to tackle the problem of insufficient labeled data and the heavy burden of annotation work, our semi-supervised biomarker distribution prediction network utilizes an adversarial learning paradigm [<xref rid="B29-cancers-13-01659" ref-type="bibr">29</xref>], the structure of which consists of a generator and a discriminator. In order to better extract useful features from pathological images and optimize performance, the generator was structured to have an encoder–decoder form. The generator can be any form of segmentation network which takes in the original H&amp;E image and outputs the class probability maps and the discriminator is organized the same as [<xref rid="B29-cancers-13-01659" ref-type="bibr">29</xref>]. Note that the generator can also be used as an independent, fully supervised biomarker distribution prediction network. The semi-supervised network structure is illustrated in <xref ref-type="fig" rid="cancers-13-01659-f002">Figure 2</xref>.</p>
        <p>Given an input H&amp;E image, <inline-formula><mml:math id="mm1"><mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of size H × W × 3, the segmentation network of the generator is denoted as <inline-formula><mml:math id="mm2"><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mfenced><mml:mo>·</mml:mo></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>; the predicted probability map, <inline-formula><mml:math id="mm3"><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mfenced><mml:mrow><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of size H × W × C where <inline-formula><mml:math id="mm4"><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> is the category number; the applied categories were background, PanCK-positive area, CD3 and CD20-positive area, and DAPI. Note that CD3 and CD20 positive cells were regarded as one class as TILs in our study [<xref rid="B26-cancers-13-01659" ref-type="bibr">26</xref>]. The discriminator is denoted as <inline-formula><mml:math id="mm5"><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mfenced><mml:mo>·</mml:mo></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, which takes in a probability map of size H × W × C and outputs a confidence map of size H × W × 1. In this study, we applied two possible inputs to the discriminator: (1) a biomarker distribution prediction, <inline-formula><mml:math id="mm6"><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mfenced><mml:mrow><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and (2) a one-hot-encoded mask vector, <inline-formula><mml:math id="mm7"><mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Each pixel <inline-formula><mml:math id="mm8"><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> of the discriminator output map indicates whether the pixel was sampled from the ground truth labeled by the pathologists <italic>p</italic> = 1 or from the predictions made by our segmentation network <italic>p</italic> = 0. In this way, we can leverage both labeled data and unlabeled data to train the network.</p>
        <p>The generator was trained by minimizing the multitask loss function:<disp-formula id="FD1-cancers-13-01659"><label>(1)</label><mml:math id="mm9"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm10"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm11"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm12"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> represent multiclass cross-entropy loss, adversarial loss, and semi-supervised loss, respectively. In (1), <inline-formula><mml:math id="mm13"><mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm14"><mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are two weighted parameters. As the network is trained on the labeled data, the cross-entropy loss is calculated as:<disp-formula id="FD2-cancers-13-01659"><label>(2)</label><mml:math id="mm15"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mstyle mathsize="120%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mstyle mathsize="120%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mfenced><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>The adversarial learning strategy is applied to maximize loss <inline-formula><mml:math id="mm16"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, as follows:<disp-formula id="FD3-cancers-13-01659"><label>(3)</label><mml:math id="mm17"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mi>log</mml:mi><mml:mfenced><mml:mrow><mml:mi>D</mml:mi><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:mi>S</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>This loss function was applied to fool the discriminator by maximizing the probability of the predicted results being generated from the ground-truth label mask.</p>
        <p>The discriminator was trained by applying the spatial cross-entropy loss of the two causes; this was achieved by performing the following operation:<disp-formula id="FD4-cancers-13-01659"><label>(4)</label><mml:math id="mm18"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mfenced><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:mi>S</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mi>log</mml:mi><mml:mfenced><mml:mrow><mml:mi>D</mml:mi><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
under the condition that the input is given as the output of the generator, <inline-formula><mml:math id="mm19"><mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>; alternatively, under the condition that the sample input was taken from the ground truth labels, <inline-formula><mml:math id="mm20"><mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. In (4), <inline-formula><mml:math id="mm21"><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> represents the confidence map of <inline-formula><mml:math id="mm22"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> at coordinates <inline-formula><mml:math id="mm23"><mml:mrow><mml:mrow><mml:mfenced><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>; <inline-formula><mml:math id="mm24"><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is similarly defined.</p>
        <p>Note that <inline-formula><mml:math id="mm25"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> was not applied in the case of unlabeled data because there was no ground-truth mask. To prevent the prediction from being overcorrected by the adversarial loss, we applied a smaller <inline-formula><mml:math id="mm26"><mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to the loss function. The segmentation network outputs an initial prediction, <inline-formula><mml:math id="mm27"><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, and the discriminator generates a confidence map, <inline-formula><mml:math id="mm28"><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mfenced><mml:mrow><mml:mi>S</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, to indicate the regions that are sufficiently close to the ground-truth biomarker distribution masks. A threshold was applied to establish the trustworthy region, i.e., the region that can be used as the label to reasonably train the segmentation network in a self-taught manner. The resulting semi-supervised loss is defined as:<disp-formula id="FD5-cancers-13-01659"><label>(5)</label><mml:math id="mm29"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mstyle mathsize="120%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mstyle mathsize="120%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mi>I</mml:mi><mml:mfenced><mml:mrow><mml:mi>D</mml:mi><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:mi>S</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>·</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>n</mml:mi><mml:mrow><mml:mfenced><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mi>log</mml:mi><mml:mfenced><mml:mrow><mml:mi>S</mml:mi><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>In (5), <inline-formula><mml:math id="mm30"><mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mfenced><mml:mo>·</mml:mo></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> is the indicator function, <inline-formula><mml:math id="mm31"><mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the threshold used to select the trustworthy region, <inline-formula><mml:math id="mm32"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the one-hot-encoded ground truth, and <inline-formula><mml:math id="mm33"><mml:mrow><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>n</mml:mi><mml:mrow><mml:mfenced><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="mm34"><mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mi>S</mml:mi><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec id="sec2dot2dot2-cancers-13-01659">
        <title>2.2.2. CBPDN Structure</title>
        <p>In order to better extract features from pathological images, we equipped CBDPN with a combination of residual blocks [<xref rid="B30-cancers-13-01659" ref-type="bibr">30</xref>], and Inception V3 [<xref rid="B31-cancers-13-01659" ref-type="bibr">31</xref>] architecture as the backbone. The Inception V3 architecture comprises inception units, with each inception unit consisting of several nonlinear convolutional modules at various resolutions, which makes it very useful for pathology-related image-processing tasks. We added two residual blocks after the first max-pooling layer to improve the feature-extraction performance. The network structure is illustrated in <xref ref-type="fig" rid="cancers-13-01659-f003">Figure 3</xref>. In addition, the structure details of each block are described in <xref ref-type="app" rid="app1-cancers-13-01659">Figure S3</xref>. CBPDN can be used as the generator in the semi supervised mechanism described in <xref ref-type="sec" rid="sec2dot2dot1-cancers-13-01659">Section 2.2.1</xref> and it can also be used independently as a fully supervised segmentation network.</p>
        <p>For the discriminator, it consists of 5 convolution layers with 4 × 4 kernel in the stride of 2. The channels of these layers are 64, 128, 256, 512, and 1, respectively. Each convolution layer is followed by batch normalization and Leaky ReLU. An up-sampling layer is added to the last layer to rescale the output to the size of the input map to transform the model into a fully convolutional network.</p>
      </sec>
      <sec id="sec2dot2dot3-cancers-13-01659">
        <title>2.2.3. Test Set Validation</title>
        <p>For CBPDN performance evaluation, first, we applied the dataset with labeled images in independent training and testing experiments using CBDPN and three conventional segmentation networks, i.e., UNet [<xref rid="B32-cancers-13-01659" ref-type="bibr">32</xref>], DeepLabV3 [<xref rid="B33-cancers-13-01659" ref-type="bibr">33</xref>], and DeepLabV3+ [<xref rid="B34-cancers-13-01659" ref-type="bibr">34</xref>] in the fully supervised manner, to prove the superiority of our proposed approach in making predictions of the biomarker distribution. Second, to prove the effectiveness of the semi-supervised mechanism, we incorporated CBDPN and the other three networks with the semi-supervised structure. It is worth mentioning that in this case, the segmentation networks were used as the generator of the entire structure described in <xref ref-type="fig" rid="cancers-13-01659-f002">Figure 2</xref>. Further, 10,200 unlabeled H&amp;E image patches were added in the training phase. In addition, 814 H&amp;E images with labels were used for validation.</p>
        <p>The metrics used to evaluate the performance of the biomarker distribution prediction network were the dice coefficient, and intersection-over-union (IoU), precision, recall. We used TP, FP, TN, and FN to denote the true-positive, false-positive, true-negative, and false-negative predictions, respectively. In addition, <inline-formula><mml:math id="mm35"><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> are used to represent the prediction result and the ground truth map, respectively. Further, <inline-formula><mml:math id="mm36"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> denotes the total number of classes. The IoU and Dice metrics are defined as:<disp-formula id="FD6-cancers-13-01659"><label>(6)</label><mml:math id="mm37"><mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>o</mml:mi><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow><mml:mi>k</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD7-cancers-13-01659"><label>(7)</label><mml:math id="mm38"><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:msubsup><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow><mml:mi>k</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
which measure the overlap between prediction <inline-formula><mml:math id="mm39"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> and ground truth <inline-formula><mml:math id="mm40"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
        <p>The precision score was calculated as follows:<disp-formula id="FD8-cancers-13-01659"><label>(8)</label><mml:math id="mm41"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mi>k</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>The recall score was calculated as follows:<disp-formula id="FD9-cancers-13-01659"><label>(9)</label><mml:math id="mm42"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mstyle mathsize="70%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mi>k</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>For each patch, the prediction result and the ground truth label were compressed into one channel and each pixel was labeled to represent one specific marker. For the prediction result, the label with the highest probability of each pixel point being predicted is considered to be the final marker classification of that pixel. In addition, the final metrics were calculated on pixel-level by averaging the metric of each prediction class.</p>
      </sec>
      <sec id="sec2dot2dot4-cancers-13-01659">
        <title>2.2.4. TCGA Dataset Validation</title>
        <p>In order to prove the robustness and generalization ability of CBDPN, we used 43,601 H&amp;E image patches of 25 colon cancer patients from the TCGA dataset for further validation. Because the corresponding mIHC staining images of the TCGA WSIs were not available, we were unable to make label masks and calculate the accuracy and dice coefficient. Instead, we calculated the PanCK-positive cell fraction and CD3- and CD20-positive cell fractions given by our optimal model, and then compared the results to the cell fractions determined based on the molecular information available in the TCGA dataset. The TCGA benchmark cell fraction was obtained from molecular genomics assays based on DNA methylation arrays and RNA sequencing data. This is a reasonable approach because PanCK is typically used to characterize tumor cells, and CD3 and CD20 are used to characterize TILs [<xref rid="B26-cancers-13-01659" ref-type="bibr">26</xref>].</p>
      </sec>
      <sec id="sec2dot2dot5-cancers-13-01659">
        <title>2.2.5. CBDPN-Based Cell Quantification</title>
        <p>In order to prove the utility of CBDPN in clinical scenarios, considering programmed cell death protein 1 (PD-1) is a crucial biomarker for TILs [<xref rid="B35-cancers-13-01659" ref-type="bibr">35</xref>,<xref rid="B36-cancers-13-01659" ref-type="bibr">36</xref>,<xref rid="B37-cancers-13-01659" ref-type="bibr">37</xref>], we also tested the ability of CBDPN to aid quantification of PD-1-expressing cells in TME in the presence of anti-PD-1 immunofluorescence staining. We first acquired H&amp;E images and anti-PD-1 immunofluorescence images of the same tissue. We used CBDPN to acquire cell-specific biomarker distribution in TME, and then we used ImageJ software [<xref rid="B38-cancers-13-01659" ref-type="bibr">38</xref>] to preprocess the anti-PD-1 immunofluorescence image to determine PD-1-positive cell distribution. Finally, we merge the cell-specific biomarker distribution generated by CBDPN and the PD-1-positive cell distribution image to gain visualization of the spatial distribution of PD-1-expressing TILs. The quantification can then be achieved by using ImageJ software (Version 1.52p, Fiji-64bit).</p>
        <p>In clinical settings, pathologists often use mIHC staining images and Inform software [<xref rid="B39-cancers-13-01659" ref-type="bibr">39</xref>] (PerkinElmer, Waltham, MA, USA) to characterize and quantify the PD-1 expression in TME. Inform software (Version 2.4) uses mIHC image as input to experimentally measure cell proportion. The basic workflow is that Inform software first localizes nuclei distribution on the mIHC WSI and then detects the type of fluorescence marker closest to each nucleus to determine the biomarker expression status at cellular level.</p>
        <p>To validate the accuracy of our CBDPN-based cell quantification method, we compared our results with the results calculated using the commercial Inform software based on mIHC WSIs of the same tissues.</p>
      </sec>
    </sec>
    <sec id="sec2dot3-cancers-13-01659">
      <title>2.3. TGMDN Training and Validation</title>
      <sec id="sec2dot3dot1-cancers-13-01659">
        <title>2.3.1. TGMDN Structure</title>
        <p>For the TGMDN, we used the ShuffleNet V2 [<xref rid="B40-cancers-13-01659" ref-type="bibr">40</xref>] network to conduct the multilabel training process to detect APC, TP53, and KRAS mutations in colon cancer patients. ShuffleNet V2 was selected because it has demonstrated good performance on gene mutation detection tasks [<xref rid="B41-cancers-13-01659" ref-type="bibr">41</xref>]. The network learned the features of each of the three mutations, with each mutation classification corresponding to an independent binary classification. We implemented a binary cross-entropy loss function and sigmoid layer to replace the softmax layer; this allowed each H&amp;E patch to be associated with several binary labels. The entire network structure is illustrated in <xref ref-type="fig" rid="cancers-13-01659-f004">Figure 4</xref>.</p>
      </sec>
      <sec id="sec2dot3dot2-cancers-13-01659">
        <title>2.3.2. TGMDN Evaluation</title>
        <p>To test the performance of the TGMDN, we tested the detection accuracy on the test set containing 6680 H&amp;E image patches from TCGA dataset and calculated the receiver operating characteristic (ROC) of these three mutations.</p>
        <p>Moreover, in order to better understand the gene mutation association, we also employed a t-SNE method [<xref rid="B42-cancers-13-01659" ref-type="bibr">42</xref>], utilizing the values of the last fully connected layer of our TGMDN as input, to visualize how the mutations and patches were organized in the multidimensional space of the network.</p>
      </sec>
    </sec>
    <sec id="sec2dot4-cancers-13-01659">
      <title>2.4. Implementation Details</title>
      <p>Our method is implemented based on the PyTorch DL framework using Python [<xref rid="B43-cancers-13-01659" ref-type="bibr">43</xref>]. Two pieces of TESLA V100 GPUs were employed to accelerate the training. For semi-supervised CBDPN training, the batch size was set as 8 and the initial learning rate was set as 0.001 for the generator, and 10<sup>−6</sup> for the discriminator. <inline-formula><mml:math id="mm43"><mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> was set as 0.1; <inline-formula><mml:math id="mm44"><mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> was set as 0.01 and 0.001 for labeled and unlabeled data, respectively, and <inline-formula><mml:math id="mm45"><mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> was set as 0.5. To train the predictive network, we use the Adam optimizer method, where the momentum is 0.9, and the weight decay is 10<sup>−8</sup>. We first train the generator for 10,000 steps and then train the generator and discriminator simultaneously for 300,000 steps. We start the semi-supervised training after training 100,000 steps with labeled data. For TGMDN training, we implemented the RMSprop optimization to train the network for 100 epochs with batch size as 16. We set the momentum as 0.9, and the weight decay as 10<sup>−8</sup>. The initial learning rate is 0.01. Statistical analysis is conducted using Prism 6 software.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec3-cancers-13-01659">
    <title>3. Results</title>
    <sec id="sec3dot1-cancers-13-01659">
      <title>3.1. CBDPN for the Prediction of Cellular Biomarker Distribution in TME</title>
      <sec id="sec3dot1dot1-cancers-13-01659">
        <title>3.1.1. Fully-Supervised Experiment Results</title>
        <p>We used CBDPN, UNet, DeeplabV3, and DeeplabV3+ to train the biomarker prediction model. The results on our test set (including 814 H&amp;E image patches) are summarized in <xref rid="cancers-13-01659-t001" ref-type="table">Table 1</xref>. As observed, our CBDPN yielded optimal results in the fully supervised experiments. Our proposed network achieved the highest scores for accuracy, precision, IoU, and dice among the four networks. Although CBDPN did not achieve the highest score for recall, it achieved the best dice coefficient, which provides information on the trade-off between precision and recall. The results prove the effectiveness and reliability of CBDPN in predicting cell biomarker distributions.</p>
      </sec>
      <sec id="sec3dot1dot2-cancers-13-01659">
        <title>3.1.2. Semi-Supervised Experiment Results</title>
        <p>We incorporate CBDPN, UNet, DeeplabV3, and DeeplabV3+ with the semi-supervised structure to train the biomarker prediction model. Note that in this case, the segmentation networks were used as the generator of the whole structure. By incorporating with the semi-supervised structure, CBDPN was demonstrated to be capable of predicting cellular biomarker distributions that are similar to the corresponding mIHC staining results (<xref ref-type="fig" rid="cancers-13-01659-f005">Figure 5</xref>). An example of an H&amp;E-stained slide is shown in <xref ref-type="fig" rid="cancers-13-01659-f005">Figure 5</xref>A; the corresponding mIHC image and prediction generated by CBDPN are shown in <xref ref-type="fig" rid="cancers-13-01659-f005">Figure 5</xref>B,C, respectively. In <xref ref-type="fig" rid="cancers-13-01659-f005">Figure 5</xref>D, we compared results generated by CBDPN and other three conventional segmentation networks under the semi-supervised structure. The visualization of the feature maps obtained after softmax operation are illustrated in <xref ref-type="app" rid="app1-cancers-13-01659">Figure S4</xref>. It can be seen that our method yielded cellular biomarker distribution prediction results that were similar to the results of mIHC staining analysis.</p>
        <p>The quantified results of our test set (including 814 H&amp;E patches with labels) are summarized in <xref rid="cancers-13-01659-t002" ref-type="table">Table 2</xref>. As observed, our CBDPN also achieved optimal results in the semi-supervised experiments. The results of all performance indicators revealed that CBDPN consistently outperformed the other networks. Our semi-supervised strategy also proved to be effective in the biomarker distribution prediction task, as it increased accuracy by 2.9%, up to 90.4% in the case of CBDPN. Increases were also observed in the tests conducted using the other three networks. The semi-supervised mechanism enables unlabeled images being trained in a self-taught manner, so that more image data can be leveraged in the training phase.</p>
      </sec>
      <sec id="sec3dot1dot3-cancers-13-01659">
        <title>3.1.3. TCGA Dataset Validation Results</title>
        <p>To confirm the generalizability and robust of our model, we also used data of 25 patients from TCGA dataset for validation. A prediction result visualization of TCGA whole slide image (WSI) is shown in <xref ref-type="fig" rid="cancers-13-01659-f006">Figure 6</xref>. Board certified pathologists were asked to make judgements of the spatial distribution of TILs on the H&amp;E WSI. It can be seen that TIL clusters predicted by our method is consistent with the judgment of pathologists. We compared proportions of cancer cells and TILs calculated based on CBDPN predictions and molecular information provided by TCGA. The details are illustrated in <xref ref-type="fig" rid="cancers-13-01659-f007">Figure 7</xref>. The scatter plot is shown in <xref ref-type="fig" rid="cancers-13-01659-f007">Figure 7</xref>A, <italic>p</italic> values analysis and Pearson correlation coefficients are shown in <xref ref-type="fig" rid="cancers-13-01659-f007">Figure 7</xref>B. Pearson correlation coefficients for PanCK and TILs experiments are 0.7942 and 0.5875, respectively, accompanied by significant <italic>p</italic> values. The results of the statistical analysis revealed agreement between the cell proportions calculated by the CBDPN and those determined based on the molecular information of TCGA dataset. The number of image patches of the WSIs used in this experiment is described in <xref ref-type="fig" rid="cancers-13-01659-f007">Figure 7</xref>C and races and genders distribution of these 25 patients is shown in <xref ref-type="fig" rid="cancers-13-01659-f007">Figure 7</xref>D. These results prove that our proposed biomarker prediction network has good generalizability and robustness across various tissue samples.</p>
      </sec>
      <sec id="sec3dot1dot4-cancers-13-01659">
        <title>3.1.4. CBDPN-Based Cell Quantification Analysis</title>
        <p>PD-1, a critical immune checkpoint molecule, plays an important role in determining the TME immune status. In this study, we tested the ability of CBDPN to help quantify PD-1 expression in TME in the presence of anti-PD-1 immunofluorescence staining.</p>
        <p>In total, all of the 94,662 H&amp;E image patches of WSIs of four colon cancer patients from Peking University Cancer Hospital and Institute were analyzed by CBDPN in the cell quantification experiment. One sample image is shown in <xref ref-type="fig" rid="cancers-13-01659-f008">Figure 8</xref>. <xref ref-type="fig" rid="cancers-13-01659-f008">Figure 8</xref>A shows the H&amp;E image and <xref ref-type="fig" rid="cancers-13-01659-f008">Figure 8</xref>B shows the anti-PD-1 immunofluorescence-stained image of the same tissue. The prediction result generated by CBPDN is shown in <xref ref-type="fig" rid="cancers-13-01659-f008">Figure 8</xref>C, and the merged image showing PD-1 expressing TILs is shown in <xref ref-type="fig" rid="cancers-13-01659-f008">Figure 8</xref>D. The sizes of the four WSIs are described in <xref ref-type="app" rid="app1-cancers-13-01659">Table S1</xref>. We compared results obtained via our approach, and those obtained by applying the commercial Inform software to analyze the mIHC image of the same tissue. CD3 and CD20-positive cell percentage comparison results are described in <xref ref-type="fig" rid="cancers-13-01659-f009">Figure 9</xref>A,B. In addition, PD-1-expressing CD3 and CD20-positive cell percentage comparison results are described in <xref ref-type="fig" rid="cancers-13-01659-f009">Figure 9</xref>C,D. The results showed that most of the cells expressing PD-1 were TILs. Further, agreement can be seen between results based on CBDPN and Inform software, with Pearson correlation values as 0.9998 and 0.9834 for the two quantification experiments accompanied by highly significant <italic>p</italic> values. This further proves that our proposed method can help quantify TILs and PD-1-expressing TILs in TME accurately. Moreover, quantification using CBDPN was achieved at a lower cost and faster speed than conventional methods based on mIHC, and thus it can be beneficial for TME analysis. We believe that, given the ability of our network to quantify PD-1 expression, CBDPN could also be used to facilitate the quantification of other biomarkers in the presence of certain immunochemistry stains.</p>
      </sec>
    </sec>
    <sec id="sec3dot2-cancers-13-01659">
      <title>3.2. TGMDN for the Detection of Tumor Gene Mutations</title>
      <sec id="sec3dot2dot1-cancers-13-01659">
        <title>3.2.1. Detection of Tumor Gene Mutations from H&amp;E Images</title>
        <p>We next focused on predicting APC, KRAS, and TP53 gene mutations in the colon cancer tumor areas by using H&amp;E image data as the input to a multilabel prediction network. We selected 446 patients in total, and the gene mutation status of the dataset is illustrated in <xref ref-type="app" rid="app1-cancers-13-01659">Supplementary Figure S2</xref>. In total 44,534 H&amp;E patches were used in the gene mutation detection experiment, of which 31,174 H&amp;E image patches were included in the training set, 6680 H&amp;E image patches in the validation set, and 6680 H&amp;E image patches in the test set.</p>
        <p>The receiver operating characteristic (ROC) curves are shown in <xref ref-type="fig" rid="cancers-13-01659-f010">Figure 10</xref>. The area-under-the-curve (AUC) values for <italic>APC</italic>, <italic>TP53</italic>, and <italic>KRAS</italic> were 0.76, 0.79, and 0.77, respectively, indicating that these three gene mutations were detectable in the tumor areas analyzed by TGMDN.</p>
      </sec>
      <sec id="sec3dot2dot2-cancers-13-01659">
        <title>3.2.2. Visualization of Network Features</title>
        <p>The cluster results based on t-SNE are shown in <xref ref-type="fig" rid="cancers-13-01659-f011">Figure 11</xref>A–C, with each dot representing an image patch and its color intensity indicating the probability of our model to predict the tumor gene mutation. The H&amp;E patch-embedded representation (<xref ref-type="fig" rid="cancers-13-01659-f011">Figure 11</xref>D) can be used to visualize patches predicted to have similar mutations, and thus possess the potential to help reveal the associations of gene mutations. In <xref ref-type="fig" rid="cancers-13-01659-f011">Figure 11</xref>D, the clusters in the top-left enlargement comprise patches constituting APC and TP53 gene mutations. The clusters in the center reveal the co-existence of TP53 and KRAS gene mutations. Finally, the clusters in the bottom-right enlargement comprise patches that confirm the co-existence of APC and KRAS gene mutations. These findings suggest that our ImmunoAIzer-TGMDN can be used to identify such genotype–phenotype association in colon cancer.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec4-cancers-13-01659">
    <title>4. Discussion</title>
    <p>In this work, we proposed a computational framework, termed ImmunoAIzer, which takes H&amp;E image patches as inputs and consists of two components: (1) CBDPN to make predictions of the spatial distribution of CD3, CD20, PanCK, and DAPI in TME, and (2) TGMDN to detect APC, TP53, and KRAS mutations.</p>
    <p>Our study demonstrates that CBDPN can make predictions of distributions of CD3, CD20, PanCK, and DAPI with an accuracy of 90.4%, demonstrating that it can be used to reveal the spatial distributions of TILs and cancer cells in TME, and is therefore of significant value as a tool for TME analysis. To maximize the utility of our proposed ImmunoAIzer framework as a tool for clinical application, we incorporated a tumor gene detection network. We used TGMDN to predict the mutation status of three of the most common mutations in TCGA COAD project, namely, APC, TP53, and KRAS. The predicted AUC values for these three mutations were 0.76, 0.79, and 0.77, respectively; these results demonstrate the feasibility of TGMDN as a tool to predict tumor gene mutation status. In general, our approach demonstrates that DL-based methods can be reasonably applied to predict the spatial distribution of TILs and cancer cells in TME, meanwhile to detect gene mutations of colon cancer patients based on histological image data. This can be highly beneficial for the guidance of immunotherapy and prognoses.</p>
    <p>The spatial distribution of TILs and cancer cells in TME is of crucial importance for the guidance of immunotherapy and prognosis. The acquisition of such information often requires mIHC staining, which can be time- and cost-consuming, and the interpretation of the staining result can be compromised by individual subjectivity; this highlights the necessity for the development of a standardized methodology to provide pathologists with comprehensive references for TME analysis. Despite advances in DL-based computational methods, current fully supervised DL-based methods often require large amount of annotated image data to achieve good generalization ability and robustness. However, it can be extremely time consuming to annotate each cell on histological image in practice. Thus, our proposed computational framework ImmunoAIzer includes a semi-supervised CBDPN to leverage both labeled and unlabeled image data to make accurate and robust predictions of spatial distribution of TILs and cancer cells in TME, which highly reduces the burden of annotation work and makes it more suitable for clinical use. The increasing data size can contribute to the robustness of the model and improve the generalization performance as well as prediction accuracy on the test set. These account for the improvement of models when switching from fully to semi-supervised strategy. Both CBDPN and UNet adopted the idea of multi-scale feature fusion, which makes both of them superior in pathological image data processing tasks. However, CBDPN not only conducts a feature concatenation process between the encoder and decoder, but also used a series of multi-resolution convolutional modules within the encoder structure to enhance the feature extraction performance, which made the performance advantage of CBPDN more obvious when the data size is increased. The results demonstrate the effectiveness of the semi-supervised mechanism to make full use of information encoded in the unlabeled image data to boost prediction performance. To the best of our knowledge, ImmunoAIzer is the first DL-based computational framework that utilizes a semi-supervised learning strategy to make predictions of the spatial distribution of immune cells and cancer cells in TME. Moreover, the incorporation of anti-PD-1 immunofluorescence staining image enables the CBDPN to be used to aid quantification of the PD-1-positive cells in TME. The implementation of CBDPN offers significant time and cost savings compared to stain-based methods. These findings demonstrate that the ImmunoAIzer can serve as an auxiliary tool for providing guidance for TME analysis.</p>
    <p>Meanwhile, the results of incorporating a gene mutation detection network that enables detections about APC, TP53, and KRAS mutations revealed the potential of computational methods for implementation in gene mutation detection tasks. The t-SNE cluster results provided further insight into the associations between APC, TP53, and KRAS mutations; this type of information can be well utilized in tumor gene mutation association studies. Thus, this study is also useful as a reference for tumor gene mutation analysis, and as a general introduction to computational methods as a valuable tool for clinical usage.</p>
    <p>The necessity of a tool with the ability to increase the amount of useful information that can be acquired from histological images is increasingly being acknowledged as critical for therapeutic optimization and patient selection [<xref rid="B44-cancers-13-01659" ref-type="bibr">44</xref>]. ImmunoAIzer is reproducible and provides an efficient tool for the cellular biomarker distribution prediction and tumor gene mutation detection. Moreover, the dataset consists of H&amp;E images with pixel-level labels which can be used to facilitate development of other DL-based computational tools.</p>
    <p>It is worth mentioning that our model was initially trained on H&amp;E data from colon cancer patients, the performance of the model on other cancer types has yet to be validated. However, we believe this methodology is generalizable and could be used to analyze data of other cancer types. In our future work, we will extend the application of ImmunoAIzer to other cancer types and immune biomarkers. For the network structure, the attention mechanism [<xref rid="B45-cancers-13-01659" ref-type="bibr">45</xref>] can be further incorporated into the convolution process to optimize the model and thus improve the prediction accuracy. We hope that by applying our computational framework to recognize a wider range of pathological features in TME, we will be able to gain more insights and offer more guidance for therapeutic optimization and prognoses.</p>
  </sec>
  <sec sec-type="conclusions" id="sec5-cancers-13-01659">
    <title>5. Conclusions</title>
    <p>ImmunoAIzer can utilize H&amp;E images to provide comprehensive information about spatial distribution of TILs and cancer cells in TME, meanwhile detect tumor gene mutations as APC, KRAS, and TP53. Our work demonstrates the potential of DL-based tools to aid pathologists in clinical use.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The authors would like to acknowledge the instrumental and technical support of Multi-modal biomedical imaging experimental platform, Institute of Automation, Chinese Academy of Sciences.</p>
  </ack>
  <fn-group>
    <fn>
      <p><bold>Publisher’s Note:</bold> MDPI stays neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <app-group>
    <app id="app1-cancers-13-01659">
      <title>Supplementary Materials</title>
      <p>The following are available online at <uri xlink:href="https://www.mdpi.com/article/10.3390/cancers13071659/s1">https://www.mdpi.com/article/10.3390/cancers13071659/s1</uri>, Table S1: Scanned image sizes of the four H&amp;E whole slide images (WSIs) for cell quantification experiment. Figure S1: Construction pipeline of the dataset with H&amp;E images and corresponding pixel-level labels. Figure S2: Distribution of most frequently mutated genes of the 446 cases from TCGA COAD project. Figure S3: Internal structure of CBPDN blocks. Figure S4: Feature maps obtained after softmax operation of CBDPN. </p>
      <supplementary-material content-type="local-data" id="cancers-13-01659-s001">
        <media xlink:href="cancers-13-01659-s001.pdf">
          <caption>
            <p>Click here for additional data file.</p>
          </caption>
        </media>
      </supplementary-material>
    </app>
  </app-group>
  <notes>
    <title>Author Contributions</title>
    <p>Conceptualization, C.B., Y.D. and J.T.; Methodology, C.B., Y.W., Y.D. and Y.A.; Software, C.B., Y.W. and L.K.; Formal Analysis, C.B. and Y.W.; Investigation, C.B., Y.W. and Y.D.; Resources, Y.D., Z.L. and J.T.; Data Curation, C.B., Y.W., H.W. and L.K.; Writing—Original Draft, C.B., Y.W. and Y.D.; Writing—Review &amp; Editing, C.B., Y.W., Y.D., Y.A., H.W., L.K., Z.L. and J.T.; Visualization, C.B., Y.W., Y.D. and J.T.; Supervision, Y.D. and J.T.; Project Administration, Y.D. and J.T.; Funding Acquisition, Y.D. and J.T. All authors have read and agreed to the published version of the manuscript.</p>
  </notes>
  <notes>
    <title>Funding</title>
    <p>This work was supported by Beijing Natural Science Foundation under grant No. 7212207; Ministry of Science and Technology of China under Grant No. 2017YFA0205; National Natural Science Foundation of China under Grant Nos. 81871514, 81227901, 81470083, 91859119, 61671449, 81527805, 61901472; National Public Welfare Basic Scientific Research Program of Chinese Academy of Medical Sciences under Grant No. 2018PT32003, 2017PT32004, National Key R&amp;D Program of China under Grant Nos. 2018YFC0910602, 2017YFA0205200, 2017YFA0700401, 2016YFA0100902, 2016YFC0103702. National Natural Science Foundation of shaanxi Provience under Grant No. 2019JM-459.</p>
  </notes>
  <notes>
    <title>Institutional Review Board Statement</title>
    <p>The study was conducted according to the guidelines of the Declaration of Helsinki, and approved by the Institutional Review Board (or Ethics Committee) of Key laboratory of Carcinogenesis and Translational Research (Ministry of Education), Peking University Cancer Hospital &amp; Institute (IRB: 2020ms01, approval date: 1 February 2020).</p>
  </notes>
  <notes>
    <title>Informed Consent Statement</title>
    <p>Informed consent was obtained from all subjects involved in the study.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data Availability Statement</title>
    <p>The labeled data used for CBDPN can be downloaded from: <uri xlink:href="https://data.mendeley.com/datasets/g52z2hmxrx/1">https://data.mendeley.com/datasets/g52z2hmxrx/1</uri> (accessed on 20 February 2021). The original scanning WSIs can be accessed at: <uri xlink:href="https://data.mendeley.com/datasets/6rkw48wspj/draft?a=a324f843-526f-4dac-a8e5-c26ca52c58f0">https://data.mendeley.com/datasets/6rkw48wspj/draft?a=a324f843-526f-4dac-a8e5-c26ca52c58f0</uri> (accessed on 20 February 2021). The source code can be accessed at <uri xlink:href="https://github.com/BianChang/ImmunoAIzer">https://github.com/BianChang/ImmunoAIzer</uri> (accessed on 20 February 2021). The unlabeled original WSIs used for CBDPN and TGMDN can be downloaded from the TCGA dataset: <uri xlink:href="https://portal.gdc.cancer.gov/">https://portal.gdc.cancer.gov/</uri> (accessed on 8 February 2021).</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Conflicts of Interest</title>
    <p>The authors declare no conflict of interest.</p>
  </notes>
  <app-group>
    <app id="app2-cancers-13-01659">
      <title>Appendix A</title>
      <p>In this appendix, we will describe our staining and scanning protocols.</p>
      <p>We acquired tissue samples from eight colon cancer patients from the Key Laboratory of Carcinogenesis and Translational Research (Ministry of Education), Peking University Cancer Hospital and Institute. The mIHC images were obtained using a PANO 7-plex IHC kit (Panovue, Beijing, China). We applied different colored chromogens including CD3 and CD20 to label TILs [<xref rid="B26-cancers-13-01659" ref-type="bibr">26</xref>], PanCK to label cancer cells and DAPI to label other cell nuclei. Then, performed horseradish peroxidase-conjugated secondary antibody incubation and tyramide signal amplification. A microwave heat treatment was applied to the samples after each tumor-specific antigen operation. DAPI (Sigma-Aldrich, Shanghai, China) was used to stain nuclei. After the mIHC slides were scanned and the mIHC stain was verified, the sample slides were treated using microwave and then bleached using sterile water. The slides were further processed for H&amp;E staining using an H&amp;E staining kit (Solarbio, Beijing, China).</p>
      <p>In order to acquire a clear view of the structural details of the pathological tissue, the H&amp;E- and mIHC-stained slides were scanned at 40× magnification using a high-resolution Mantra system scanner (PerkinElmer, Waltham, MA, USA).</p>
    </app>
    <app id="app3-cancers-13-01659">
      <title>Appendix B</title>
      <p>In this appendix, we will describe the image processing procedure during constructing the dataset.</p>
      <p>The registration procedure was performed as follows:<list list-type="order"><list-item><p>Coarse block matching: Generally, the original WSIs are extremely large in size and thus difficult to process in their entirety owing to RAM limitations. To address this problem, we randomly selected 15 candidate blocks (~5000 × ~4000 pixels) in each mIHC staining WSI. Then, a normalized correlation matrix was calculated by correlating each of the ~5000 × ~4000-pixel blocks with the corresponding block extracted from the whole-slide grayscale H&amp;E image of the same size. The block with the highest correlation score was considered to be the coarsely matched H&amp;E block for the two staining blocks.</p></list-item><list-item><p>Global registration: After acquiring coarsely matched block pairs. A global registration step was carried out to correct the slight rotation angle. We extracted feature vectors (descriptors) and their corresponding locations from the block pairs; we then matched the features using the descriptors [<xref rid="B46-cancers-13-01659" ref-type="bibr">46</xref>]. Next, the M-estimator sample consensus algorithm was used to calculate the transformation matrix [<xref rid="B47-cancers-13-01659" ref-type="bibr">47</xref>]. After the rotation was applied, the images were cropped, removing 50 pixels on each side to eliminate the undefined areas that resulted from the rotation.</p></list-item><list-item><p>Elastic registration: After Step 2, an elastic registration between H&amp;E image blocks and globally registered mIHC image blocks was conducted by applying a diffeomorphic demons algorithm [<xref rid="B48-cancers-13-01659" ref-type="bibr">48</xref>] to correct the distortions induced by warping and various aberrations.</p></list-item></list></p>
      <p>After the registration procedure was completed, the registered block pairs were tiled into patches of 512 × 512 pixels and pixel-level annotated by 3 board certified pathologists. Then, all of the H&amp;E image patches were processed to apply stain intensity normalization [<xref rid="B27-cancers-13-01659" ref-type="bibr">27</xref>,<xref rid="B28-cancers-13-01659" ref-type="bibr">28</xref>]. Finally, an image augmentation step was carried out to enrich the dataset and improve generalizability. We applied image augmentation to all H&amp;E patches. The transformations that were applied to our original H&amp;E patches included the Gaussian blur, flipping, rotations, and Gaussian noise. The augmentation code implemented in this study was taken from <uri xlink:href="https://github.com/codebox/image_augmentor">https://github.com/codebox/image_augmentor</uri> (accessed on 2 February 2021).</p>
    </app>
  </app-group>
  <ref-list>
    <title>References</title>
    <ref id="B1-cancers-13-01659">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Balkwill</surname>
            <given-names>F.R.</given-names>
          </name>
          <name>
            <surname>Capasso</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hagemann</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>The tumor microenvironment at a glance</article-title>
        <source>J. Cell Sci.</source>
        <year>2012</year>
        <volume>125</volume>
        <fpage>5591</fpage>
        <lpage>5596</lpage>
        <pub-id pub-id-type="doi">10.1242/jcs.116392</pub-id>
        <pub-id pub-id-type="pmid">23420197</pub-id>
      </element-citation>
    </ref>
    <ref id="B2-cancers-13-01659">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hanahan</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Coussens</surname>
            <given-names>L.M.</given-names>
          </name>
        </person-group>
        <article-title>Accessories to the crime: Functions of cells recruited to the tumor microenvironment</article-title>
        <source>Cancer Cell</source>
        <year>2012</year>
        <volume>21</volume>
        <fpage>309</fpage>
        <lpage>322</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccr.2012.02.022</pub-id>
        <?supplied-pmid 22439926?>
        <pub-id pub-id-type="pmid">22439926</pub-id>
      </element-citation>
    </ref>
    <ref id="B3-cancers-13-01659">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whiteside</surname>
            <given-names>T.J.O.</given-names>
          </name>
        </person-group>
        <article-title>The tumor microenvironment and its role in promoting tumor growth</article-title>
        <source>Oncogene</source>
        <year>2008</year>
        <volume>27</volume>
        <fpage>5904</fpage>
        <lpage>5912</lpage>
        <pub-id pub-id-type="doi">10.1038/onc.2008.271</pub-id>
        <?supplied-pmid 18836471?>
        <pub-id pub-id-type="pmid">18836471</pub-id>
      </element-citation>
    </ref>
    <ref id="B4-cancers-13-01659">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cristescu</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Mogg</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Ayers</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Albright</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Yearley</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Sher</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X.Q.</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>H.C.</given-names>
          </name>
          <name>
            <surname>Nebozhyn</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pan-tumor genomic biomarkers for PD-1 checkpoint blockade-based immunotherapy</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>362</volume>
        <fpage>eaar3593</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aar3593</pub-id>
        <pub-id pub-id-type="pmid">30309915</pub-id>
      </element-citation>
    </ref>
    <ref id="B5-cancers-13-01659">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Du</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>Y.H.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>J.J.</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>J.J.</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Advances in molecular imaging of immune checkpoint targets in malignancies: Current and future prospect</article-title>
        <source>Eur. Radiol.</source>
        <year>2019</year>
        <volume>29</volume>
        <fpage>4294</fpage>
        <lpage>4302</lpage>
        <pub-id pub-id-type="doi">10.1007/s00330-018-5814-3</pub-id>
        <?supplied-pmid 30506221?>
        <pub-id pub-id-type="pmid">30506221</pub-id>
      </element-citation>
    </ref>
    <ref id="B6-cancers-13-01659">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Du</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>Y.F.</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>Z.G.</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Noninvasive imaging in cancer immunotherapy: The way to precision medicine</article-title>
        <source>Cancer Lett.</source>
        <year>2019</year>
        <volume>466</volume>
        <fpage>13</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1016/j.canlet.2019.08.009</pub-id>
        <pub-id pub-id-type="pmid">31499119</pub-id>
      </element-citation>
    </ref>
    <ref id="B7-cancers-13-01659">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenberg</surname>
            <given-names>S.A.</given-names>
          </name>
          <name>
            <surname>Spiess</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Lafreniere</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>A New Approach To the Adoptive Immunotherapy of Cancer with Tumor-Infiltrating Lymphocytes</article-title>
        <source>Science</source>
        <year>1986</year>
        <volume>233</volume>
        <fpage>1318</fpage>
        <lpage>1321</lpage>
        <pub-id pub-id-type="doi">10.1126/science.3489291</pub-id>
        <pub-id pub-id-type="pmid">3489291</pub-id>
      </element-citation>
    </ref>
    <ref id="B8-cancers-13-01659">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roth</surname>
            <given-names>A.D.</given-names>
          </name>
          <name>
            <surname>Delorenzi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Tejpar</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Klingbiel</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Fiocca</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>d’Ario</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Cisar</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Labianca</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Cunningham</surname>
            <given-names>D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated Analysis of Molecular and Clinical Prognostic Factors in Stage II/III Colon Cancer</article-title>
        <source>J. Natl. Cancer Inst.</source>
        <year>2012</year>
        <volume>104</volume>
        <fpage>1635</fpage>
        <lpage>1646</lpage>
        <pub-id pub-id-type="doi">10.1093/jnci/djs427</pub-id>
        <pub-id pub-id-type="pmid">23104212</pub-id>
      </element-citation>
    </ref>
    <ref id="B9-cancers-13-01659">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Markowitz</surname>
            <given-names>S.D.</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Willis</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Willson</surname>
            <given-names>J.K.V.</given-names>
          </name>
        </person-group>
        <article-title>Focus on colon cancer</article-title>
        <source>Cancer Cell</source>
        <year>2002</year>
        <volume>1</volume>
        <fpage>233</fpage>
        <lpage>236</lpage>
        <pub-id pub-id-type="doi">10.1016/S1535-6108(02)00053-3</pub-id>
        <pub-id pub-id-type="pmid">12086859</pub-id>
      </element-citation>
    </ref>
    <ref id="B10-cancers-13-01659">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Westra</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Schaapveld</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hollema</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>de Boer</surname>
            <given-names>J.P.</given-names>
          </name>
          <name>
            <surname>Kraak</surname>
            <given-names>M.M.J.</given-names>
          </name>
          <name>
            <surname>de Jong</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>ter Elst</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Mulder</surname>
            <given-names>N.H.</given-names>
          </name>
          <name>
            <surname>Buys</surname>
            <given-names>C.H.C.M.</given-names>
          </name>
          <name>
            <surname>Hofstra</surname>
            <given-names>R.M.W.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Determination of TP53 mutation is more relevant than microsatellite instability status for the prediction of disease-free survival in adjuvant-treated stage III colon cancer patients</article-title>
        <source>J. Clin. Oncol.</source>
        <year>2005</year>
        <volume>23</volume>
        <fpage>5635</fpage>
        <lpage>5643</lpage>
        <pub-id pub-id-type="doi">10.1200/JCO.2005.04.096</pub-id>
        <pub-id pub-id-type="pmid">16110022</pub-id>
      </element-citation>
    </ref>
    <ref id="B11-cancers-13-01659">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>W.T.</given-names>
          </name>
          <name>
            <surname>Overman</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Boutin</surname>
            <given-names>A.T.</given-names>
          </name>
          <name>
            <surname>Shang</surname>
            <given-names>X.Y.</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Dey</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J.X.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>G.C.</given-names>
          </name>
          <name>
            <surname>Lan</surname>
            <given-names>Z.D.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>KRAS-IRF2 Axis Drives Immune Suppression and Immune Therapy Resistance in Colorectal Cancer</article-title>
        <source>Cancer Cell</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>559</fpage>
        <lpage>572</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccell.2019.02.008</pub-id>
        <?supplied-pmid 30905761?>
        <pub-id pub-id-type="pmid">30905761</pub-id>
      </element-citation>
    </ref>
    <ref id="B12-cancers-13-01659">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yarchoan</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hopkins</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Jaffee</surname>
            <given-names>E.M.</given-names>
          </name>
        </person-group>
        <article-title>Tumor Mutational Burden and Response Rate to PD-1 Inhibition</article-title>
        <source>N. Engl. J. Med.</source>
        <year>2017</year>
        <volume>377</volume>
        <fpage>2500</fpage>
        <lpage>2501</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMc1713444</pub-id>
        <pub-id pub-id-type="pmid">29262275</pub-id>
      </element-citation>
    </ref>
    <ref id="B13-cancers-13-01659">
      <label>13.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kalra</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Multiplex Immunohistochemistry for Mapping the Tumor Microenvironment</article-title>
        <source>Signal Transduction Immunohistochemistry: Methods and Protocols</source>
        <person-group person-group-type="editor">
          <name>
            <surname>Kalyuzhny</surname>
            <given-names>A.E.</given-names>
          </name>
        </person-group>
        <publisher-name>Springer</publisher-name>
        <publisher-loc>New York, NY, USA</publisher-loc>
        <year>2017</year>
        <fpage>237</fpage>
        <lpage>251</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-4939-6759-9_17</pub-id>
      </element-citation>
    </ref>
    <ref id="B14-cancers-13-01659">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stack</surname>
            <given-names>E.C.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C.C.</given-names>
          </name>
          <name>
            <surname>Roman</surname>
            <given-names>K.A.</given-names>
          </name>
          <name>
            <surname>Hoyt</surname>
            <given-names>C.C.</given-names>
          </name>
        </person-group>
        <article-title>Multiplexed immunohistochemistry, imaging, and quantitation: A review, with an assessment of Tyramide signal amplification, multispectral imaging and multiplex analysis</article-title>
        <source>Methods</source>
        <year>2014</year>
        <volume>70</volume>
        <fpage>46</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2014.08.016</pub-id>
        <pub-id pub-id-type="pmid">25242720</pub-id>
      </element-citation>
    </ref>
    <ref id="B15-cancers-13-01659">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsujikawa</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Borkar</surname>
            <given-names>R.N.</given-names>
          </name>
          <name>
            <surname>Azimi</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Thibault</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>Y.H.</given-names>
          </name>
          <name>
            <surname>Balter</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kawashima</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Choe</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Sauer</surname>
            <given-names>D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantitative Multiplex Immunohistochemistry Reveals Myeloid-Inflamed Tumor-Immune Complexity Associated with Poor Prognosis</article-title>
        <source>Cell Rep.</source>
        <year>2017</year>
        <volume>19</volume>
        <fpage>203</fpage>
        <lpage>217</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2017.03.037</pub-id>
        <pub-id pub-id-type="pmid">28380359</pub-id>
      </element-citation>
    </ref>
    <ref id="B16-cancers-13-01659">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blom</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Paavolainen</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Bychkov</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Turkki</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Maki-Teeri</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Hemmes</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Valimaki</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Lundin</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kallioniemi</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Pellinen</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Systems pathology by multiplexed immunohistochemistry and whole-slide digital image analysis</article-title>
        <source>Sci. Rep.</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>15580</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-15798-4</pub-id>
        <?supplied-pmid 29138507?>
        <pub-id pub-id-type="pmid">29138507</pub-id>
      </element-citation>
    </ref>
    <ref id="B17-cancers-13-01659">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ionescu</surname>
            <given-names>G.V.</given-names>
          </name>
          <name>
            <surname>Fergie</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Berks</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Harkness</surname>
            <given-names>E.F.</given-names>
          </name>
          <name>
            <surname>Hulleman</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Brentnall</surname>
            <given-names>A.R.</given-names>
          </name>
          <name>
            <surname>Cuzick</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>D.G.</given-names>
          </name>
          <name>
            <surname>Astley</surname>
            <given-names>S.M.</given-names>
          </name>
        </person-group>
        <article-title>Prediction of reader estimates of mammographic density using convolutional neural networks</article-title>
        <source>J. Med. Imaging</source>
        <year>2019</year>
        <volume>6</volume>
        <fpage>031405</fpage>
        <pub-id pub-id-type="doi">10.1117/1.JMI.6.3.031405</pub-id>
        <?supplied-pmid 30746393?>
        <pub-id pub-id-type="pmid">30746393</pub-id>
      </element-citation>
    </ref>
    <ref id="B18-cancers-13-01659">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campanella</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Hanna</surname>
            <given-names>M.G.</given-names>
          </name>
          <name>
            <surname>Geneslaw</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Miraflor</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Silva</surname>
            <given-names>V.W.K.</given-names>
          </name>
          <name>
            <surname>Busam</surname>
            <given-names>K.J.</given-names>
          </name>
          <name>
            <surname>Brogi</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Reuter</surname>
            <given-names>V.E.</given-names>
          </name>
          <name>
            <surname>Klimstra</surname>
            <given-names>D.S.</given-names>
          </name>
          <name>
            <surname>Fuchs</surname>
            <given-names>T.J.</given-names>
          </name>
        </person-group>
        <article-title>Clinical-grade computational pathology using weakly supervised deep learning on whole slide images</article-title>
        <source>Nat. Med.</source>
        <year>2019</year>
        <volume>25</volume>
        <fpage>1301</fpage>
        <lpage>1309</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-019-0508-1</pub-id>
        <pub-id pub-id-type="pmid">31308507</pub-id>
      </element-citation>
    </ref>
    <ref id="B19-cancers-13-01659">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rivenson</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H.D.</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Z.S.</given-names>
          </name>
          <name>
            <surname>de Haan</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y.B.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y.C.</given-names>
          </name>
          <name>
            <surname>Gunaydin</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Zuckerman</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Chong</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Sisk</surname>
            <given-names>A.E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Virtual histological staining of unlabelled tissue-autofluorescence images via deep learning</article-title>
        <source>Nat. Biomed. Eng.</source>
        <year>2019</year>
        <volume>3</volume>
        <fpage>466</fpage>
        <lpage>477</lpage>
        <pub-id pub-id-type="doi">10.1038/s41551-019-0362-y</pub-id>
        <pub-id pub-id-type="pmid">31142829</pub-id>
      </element-citation>
    </ref>
    <ref id="B20-cancers-13-01659">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saltz</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Hou</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Kurc</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Samaras</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Shroyer</surname>
            <given-names>K.R.</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>T.H.</given-names>
          </name>
          <name>
            <surname>Batiste</surname>
            <given-names>R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial Organization and Molecular Correlation of Tumor-Infiltrating Lymphocytes Using Deep Learning on Pathology Images</article-title>
        <source>Cell Rep.</source>
        <year>2018</year>
        <volume>23</volume>
        <fpage>181</fpage>
        <lpage>193</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2018.03.086</pub-id>
        <pub-id pub-id-type="pmid">29617659</pub-id>
      </element-citation>
    </ref>
    <ref id="B21-cancers-13-01659">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christiansen</surname>
            <given-names>E.M.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>S.J.</given-names>
          </name>
          <name>
            <surname>Ando</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Javaherian</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Skibinski</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Lipnick</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Mount</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>O’Neil</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>A.K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>In Silico Labeling: Predicting Fluorescent Labels in Unlabeled Images</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>173</volume>
        <fpage>792</fpage>
        <lpage>803</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.03.040</pub-id>
        <pub-id pub-id-type="pmid">29656897</pub-id>
      </element-citation>
    </ref>
    <ref id="B22-cancers-13-01659">
      <label>22.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Burlingame</surname>
            <given-names>E.A.</given-names>
          </name>
          <name>
            <surname>Margolin</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>J.W.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>Y.H.</given-names>
          </name>
        </person-group>
        <article-title>SHIFT: Speedy histopathological-to-immunofluorescent translation of whole slide images using conditional generative adversarial networks</article-title>
        <source>Medical Imaging 2018: Digital Pathology</source>
        <publisher-name>SPIE</publisher-name>
        <publisher-loc>Houston, TX, USA</publisher-loc>
        <year>2018</year>
        <volume>Volume 10581</volume>
        <fpage>1058105</fpage>
        <pub-id pub-id-type="doi">10.1117/12.2293249</pub-id>
      </element-citation>
    </ref>
    <ref id="B23-cancers-13-01659">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coudray</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Ocampo</surname>
            <given-names>P.S.</given-names>
          </name>
          <name>
            <surname>Sakellaropoulos</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Narula</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Snuderl</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Fenyö</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Moreira</surname>
            <given-names>A.L.</given-names>
          </name>
          <name>
            <surname>Razavian</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Tsirigos</surname>
            <given-names>A.J.N.m.</given-names>
          </name>
        </person-group>
        <article-title>Classification and mutation prediction from non–small cell lung cancer histopathology images using deep learning</article-title>
        <source>Nat. Med.</source>
        <year>2018</year>
        <volume>24</volume>
        <fpage>1559</fpage>
        <lpage>1567</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-018-0177-5</pub-id>
        <pub-id pub-id-type="pmid">30224757</pub-id>
      </element-citation>
    </ref>
    <ref id="B24-cancers-13-01659">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Litjens</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Kooi</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Bejnordi</surname>
            <given-names>B.E.</given-names>
          </name>
          <name>
            <surname>Setio</surname>
            <given-names>A.A.A.</given-names>
          </name>
          <name>
            <surname>Ciompi</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Ghafoorian</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>van der Laak</surname>
            <given-names>J.A.W.M.</given-names>
          </name>
          <name>
            <surname>van Ginneken</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Sanchez</surname>
            <given-names>C.I.</given-names>
          </name>
        </person-group>
        <article-title>A survey on deep learning in medical image analysis</article-title>
        <source>Med. Image Anal.</source>
        <year>2017</year>
        <volume>42</volume>
        <fpage>60</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.1016/j.media.2017.07.005</pub-id>
        <?supplied-pmid 28778026?>
        <pub-id pub-id-type="pmid">28778026</pub-id>
      </element-citation>
    </ref>
    <ref id="B25-cancers-13-01659">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chapelle</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Scholkopf</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Zien</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Semi-supervised learning (chapelle, o. et al., eds.; 2006) [book reviews]</article-title>
        <source>IEEE Trans. Neural Netw.</source>
        <year>2009</year>
        <volume>20</volume>
        <fpage>542</fpage>
        <pub-id pub-id-type="doi">10.1109/TNN.2009.2015974</pub-id>
      </element-citation>
    </ref>
    <ref id="B26-cancers-13-01659">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Wimberly</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Lannin</surname>
            <given-names>D.R.</given-names>
          </name>
          <name>
            <surname>Nixon</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Rimm</surname>
            <given-names>D.L.</given-names>
          </name>
          <name>
            <surname>Bossuyt</surname>
            <given-names>V.</given-names>
          </name>
        </person-group>
        <article-title>Multiplexed Quantitative Analysis of CD3, CD8, and CD20 Predicts Response to Neoadjuvant Chemotherapy in Breast Cancer</article-title>
        <source>Clin. Cancer Res.</source>
        <year>2014</year>
        <volume>20</volume>
        <fpage>5995</fpage>
        <lpage>6005</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-14-1622</pub-id>
        <pub-id pub-id-type="pmid">25255793</pub-id>
      </element-citation>
    </ref>
    <ref id="B27-cancers-13-01659">
      <label>27.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Macenko</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Niethammer</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Marron</surname>
            <given-names>J.S.</given-names>
          </name>
          <name>
            <surname>Borland</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Woosley</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Guan</surname>
            <given-names>X.J.</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>N.E.</given-names>
          </name>
        </person-group>
        <article-title>A Method for Normalizing Histology Slides for Quantitative Analysis</article-title>
        <source>Proceedings of the 2009 IEEE International Symposium on Biomedical Imaging: From Nano To Macro</source>
        <conf-loc>Boston, MA, USA</conf-loc>
        <conf-date>28 June–1 July 2009</conf-date>
        <volume>Volume 1–2</volume>
        <fpage>1107</fpage>
        <lpage>1110</lpage>
        <pub-id pub-id-type="doi">10.1109/Isbi.2009.5193250</pub-id>
      </element-citation>
    </ref>
    <ref id="B28-cancers-13-01659">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vahadane</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>T.Y.</given-names>
          </name>
          <name>
            <surname>Sethi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Albarqouni</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L.C.</given-names>
          </name>
          <name>
            <surname>Baust</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Steiger</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Schlitter</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Esposito</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Navab</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>Structure-Preserving Color Normalization and Sparse Stain Separation for Histological Images</article-title>
        <source>IEEE T Med. Imaging</source>
        <year>2016</year>
        <volume>35</volume>
        <fpage>1962</fpage>
        <lpage>1971</lpage>
        <pub-id pub-id-type="doi">10.1109/TMI.2016.2529665</pub-id>
        <?supplied-pmid 27164577?>
        <pub-id pub-id-type="pmid">27164577</pub-id>
      </element-citation>
    </ref>
    <ref id="B29-cancers-13-01659">
      <label>29.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Hung</surname>
            <given-names>W.C.</given-names>
          </name>
          <name>
            <surname>Tsai</surname>
            <given-names>Y.H.</given-names>
          </name>
          <name>
            <surname>Liou</surname>
            <given-names>Y.T.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y.Y.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>M.H.</given-names>
          </name>
        </person-group>
        <article-title>Adversarial Learning for Semi-Supervised Semantic Segmentation</article-title>
        <source>Proceedings of the British Machine Vision Conference</source>
        <conf-loc>Newcastle, UK</conf-loc>
        <conf-date>3–6 September 2018</conf-date>
      </element-citation>
    </ref>
    <ref id="B30-cancers-13-01659">
      <label>30.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Deep residual learning for image recognition</article-title>
        <source>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</source>
        <conf-loc>Las Vegas, NV, USA</conf-loc>
        <conf-date>27–30 June 2016</conf-date>
        <fpage>770</fpage>
        <lpage>778</lpage>
      </element-citation>
    </ref>
    <ref id="B31-cancers-13-01659">
      <label>31.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Szegedy</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Vanhoucke</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Ioffe</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Shlens</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Wojna</surname>
            <given-names>Z.</given-names>
          </name>
        </person-group>
        <article-title>Rethinking the Inception Architecture for Computer Vision</article-title>
        <source>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</source>
        <conf-loc>Las Vegas, NV, USA</conf-loc>
        <conf-date>26 June–1 July 2016</conf-date>
        <pub-id pub-id-type="doi">10.1109/Cvpr.2016.308</pub-id>
      </element-citation>
    </ref>
    <ref id="B32-cancers-13-01659">
      <label>32.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Ronneberger</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Brox</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>U-Net: Convolutional Networks for Biomedical Image Segmentation</article-title>
        <source>Proceedings of the International Conference on Medical Image Computing and Computer-Assisted Intervention</source>
        <conf-loc>Munich, Germany</conf-loc>
        <conf-date>5–9 October 2015</conf-date>
        <volume>Volume 9351</volume>
        <fpage>234</fpage>
        <lpage>241</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-319-24574-4_28</pub-id>
      </element-citation>
    </ref>
    <ref id="B33-cancers-13-01659">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>L.-C.</given-names>
          </name>
          <name>
            <surname>Papandreou</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Schroff</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Adam</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Rethinking Atrous Convolution for Semantic Image Segmentation</article-title>
        <source>arXiv</source>
        <year>2017</year>
        <pub-id pub-id-type="arxiv">1706.05587</pub-id>
      </element-citation>
    </ref>
    <ref id="B34-cancers-13-01659">
      <label>34.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>L.-C.</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Papandreou</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Schroff</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Adam</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Encoder-decoder with atrous separable convolution for semantic image segmentation</article-title>
        <source>Proceedings of the European Conference on Computer Vision (ECCV)</source>
        <conf-loc>Munich, Germany</conf-loc>
        <conf-date>8–14 September 2018</conf-date>
        <fpage>801</fpage>
        <lpage>818</lpage>
      </element-citation>
    </ref>
    <ref id="B35-cancers-13-01659">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Topalian</surname>
            <given-names>S.L.</given-names>
          </name>
          <name>
            <surname>Hodi</surname>
            <given-names>F.S.</given-names>
          </name>
          <name>
            <surname>Brahmer</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Gettinger</surname>
            <given-names>S.N.</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>D.C.</given-names>
          </name>
          <name>
            <surname>McDermott</surname>
            <given-names>D.F.</given-names>
          </name>
          <name>
            <surname>Powderly</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Carvajal</surname>
            <given-names>R.D.</given-names>
          </name>
          <name>
            <surname>Sosman</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Atkins</surname>
            <given-names>M.B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Safety, Activity, and Immune Correlates of Anti-PD-1 Antibody in Cancer</article-title>
        <source>N. Engl. J. Med.</source>
        <year>2012</year>
        <volume>366</volume>
        <fpage>2443</fpage>
        <lpage>2454</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa1200690</pub-id>
        <?supplied-pmid 22658127?>
        <pub-id pub-id-type="pmid">22658127</pub-id>
      </element-citation>
    </ref>
    <ref id="B36-cancers-13-01659">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wyss</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Dislich</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Koelzer</surname>
            <given-names>V.H.</given-names>
          </name>
          <name>
            <surname>Galvan</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Hadrich</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Inderbitzin</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Lugli</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Zlobec</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>M.D.</given-names>
          </name>
        </person-group>
        <article-title>Stromal PD-1/PD-L1 Expression Predicts Outcome in Colon Cancer Patients</article-title>
        <source>Clin. Colorectal Cancer</source>
        <year>2019</year>
        <volume>18</volume>
        <fpage>E20</fpage>
        <lpage>E38</lpage>
        <pub-id pub-id-type="doi">10.1016/j.clcc.2018.09.007</pub-id>
        <pub-id pub-id-type="pmid">30389315</pub-id>
      </element-citation>
    </ref>
    <ref id="B37-cancers-13-01659">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sehdev</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Cramer</surname>
            <given-names>H.M.</given-names>
          </name>
          <name>
            <surname>Ibrahim</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Younger</surname>
            <given-names>A.E.</given-names>
          </name>
          <name>
            <surname>O’Neil</surname>
            <given-names>B.H.</given-names>
          </name>
        </person-group>
        <article-title>Pathological Complete Response with Anti-PD-1 Therapy in a Patient with Microsatellite Instable High, BRAF Mutant Metastatic Colon Cancer: A Case Report and Review of Literature</article-title>
        <source>Discov. Med.</source>
        <year>2016</year>
        <volume>21</volume>
        <fpage>341</fpage>
        <lpage>347</lpage>
        <pub-id pub-id-type="pmid">27355330</pub-id>
      </element-citation>
    </ref>
    <ref id="B38-cancers-13-01659">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schindelin</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Arganda-Carreras</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Frise</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Kaynig</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Longair</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Pietzsch</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Preibisch</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Rueden</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Saalfeld</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fiji: An open-source platform for biological-image analysis</article-title>
        <source>Nat. Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>676</fpage>
        <lpage>682</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2019</pub-id>
        <pub-id pub-id-type="pmid">22743772</pub-id>
      </element-citation>
    </ref>
    <ref id="B39-cancers-13-01659">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kramer</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Latham</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Diepeveen</surname>
            <given-names>L.A.</given-names>
          </name>
          <name>
            <surname>Mou</surname>
            <given-names>L.J.</given-names>
          </name>
          <name>
            <surname>Laurent</surname>
            <given-names>G.J.</given-names>
          </name>
          <name>
            <surname>Elsegood</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Ochoa-Callejero</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Yeoh</surname>
            <given-names>G.C.</given-names>
          </name>
        </person-group>
        <article-title>InForm software: A semi-automated research tool to identify presumptive human hepatic progenitor cells, and other histological features of pathological significance</article-title>
        <source>Sci. Rep.</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>3418</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-018-21757-4</pub-id>
        <pub-id pub-id-type="pmid">29467378</pub-id>
      </element-citation>
    </ref>
    <ref id="B40-cancers-13-01659">
      <label>40.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>H.-T.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>ShuffleNet V2: Practical Guidelines for Efficient CNN Architecture Design</article-title>
        <source>Proceedings of the European Conference on Computer Vision</source>
        <conf-loc>Munich, Germany</conf-loc>
        <conf-date>8–14 September 2018</conf-date>
        <fpage>122</fpage>
        <lpage>138</lpage>
      </element-citation>
    </ref>
    <ref id="B41-cancers-13-01659">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kather</surname>
            <given-names>J.N.</given-names>
          </name>
          <name>
            <surname>Heij</surname>
            <given-names>L.R.</given-names>
          </name>
          <name>
            <surname>Grabsch</surname>
            <given-names>H.I.</given-names>
          </name>
          <name>
            <surname>Loeffler</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Echle</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Muti</surname>
            <given-names>H.S.</given-names>
          </name>
          <name>
            <surname>Krause</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Niehues</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Sommer</surname>
            <given-names>K.A.</given-names>
          </name>
          <name>
            <surname>Bankhead</surname>
            <given-names>P.J.N.C.</given-names>
          </name>
        </person-group>
        <article-title>Pan-cancer image-based detection of clinically actionable genetic alterations</article-title>
        <source>Nat. Cancer</source>
        <year>2020</year>
        <volume>1</volume>
        <fpage>789</fpage>
        <lpage>799</lpage>
        <pub-id pub-id-type="doi">10.1038/s43018-020-0087-6</pub-id>
        <?supplied-pmid 33763651?>
        <pub-id pub-id-type="pmid">33763651</pub-id>
      </element-citation>
    </ref>
    <ref id="B42-cancers-13-01659">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van der Maaten</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Visualizing data using t-SNE</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>2579</fpage>
        <lpage>2625</lpage>
      </element-citation>
    </ref>
    <ref id="B43-cancers-13-01659">
      <label>43.</label>
      <element-citation publication-type="gov">
        <person-group person-group-type="author">
          <name>
            <surname>Paszke</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Gross</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Chintala</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Chanan</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>DeVito</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Desmaison</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Antiga</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Lerer</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Automatic Differentiation in Pytorch</article-title>
        <comment>Available online: <ext-link ext-link-type="uri" xlink:href="https://openreview.net/forum?id=BJJsrmfCZ">https://openreview.net/forum?id=BJJsrmfCZ</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2021-02-20">(accessed on 20 February 2021)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B44-cancers-13-01659">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gurcan</surname>
            <given-names>M.N.</given-names>
          </name>
          <name>
            <surname>Boucheron</surname>
            <given-names>L.E.</given-names>
          </name>
          <name>
            <surname>Can</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Madabhushi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Rajpoot</surname>
            <given-names>N.M.</given-names>
          </name>
          <name>
            <surname>Yener</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Histopathological image analysis: A review</article-title>
        <source>IEEE Rev. Biomed. Eng.</source>
        <year>2009</year>
        <volume>2</volume>
        <fpage>147</fpage>
        <lpage>171</lpage>
        <pub-id pub-id-type="doi">10.1109/RBME.2009.2034865</pub-id>
        <pub-id pub-id-type="pmid">20671804</pub-id>
      </element-citation>
    </ref>
    <ref id="B45-cancers-13-01659">
      <label>45.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>L.C.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Yuille</surname>
            <given-names>A.L.</given-names>
          </name>
        </person-group>
        <article-title>Attention to Scale: Scale-aware Semantic Image Segmentation</article-title>
        <source>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</source>
        <conf-loc>Las Vegas, NV, USA</conf-loc>
        <conf-date>26 June–1 July 2016</conf-date>
        <fpage>3640</fpage>
        <lpage>3649</lpage>
        <pub-id pub-id-type="doi">10.1109/Cvpr.2016.396</pub-id>
      </element-citation>
    </ref>
    <ref id="B46-cancers-13-01659">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lowe</surname>
            <given-names>D.G.</given-names>
          </name>
        </person-group>
        <article-title>Distinctive image features from scale-invariant keypoints</article-title>
        <source>Int. J. Comput. Vis.</source>
        <year>2004</year>
        <volume>60</volume>
        <fpage>91</fpage>
        <lpage>110</lpage>
        <pub-id pub-id-type="doi">10.1023/B:VISI.0000029664.99615.94</pub-id>
      </element-citation>
    </ref>
    <ref id="B47-cancers-13-01659">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torr</surname>
            <given-names>P.H.S.</given-names>
          </name>
          <name>
            <surname>Zisserman</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>MLESAC: A new robust estimator with application to estimating image geometry</article-title>
        <source>Comput. Vis. Image Underst.</source>
        <year>2000</year>
        <volume>78</volume>
        <fpage>138</fpage>
        <lpage>156</lpage>
        <pub-id pub-id-type="doi">10.1006/cviu.1999.0832</pub-id>
      </element-citation>
    </ref>
    <ref id="B48-cancers-13-01659">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vercauteren</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Pennec</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Perchant</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ayache</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>Diffeomorphic demons: Efficient non-parametric image registration</article-title>
        <source>Neuroimage</source>
        <year>2009</year>
        <volume>45</volume>
        <fpage>S61</fpage>
        <lpage>S72</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2008.10.040</pub-id>
        <pub-id pub-id-type="pmid">19041946</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="cancers-13-01659-f001" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Study protocol workflow. (<bold>A</bold>) ImmunoAIzer includes: a cellular biomarker distribution prediction network (CBDPN) and a tumor gene mutation detection network (TGMDN). (<bold>B</bold>) CBDPN takes H&amp;E image patches as input and makes predictions of the spatial distribution of CD3 and CD20, pan-cytokeratin (PanCK) and DAPI in TME. (<bold>C</bold>) TGMDN takes H&amp;E image patches as input and detects adenomatous polyposis coli gene (APC), tumor protein P53 gene (TP53), and kirsten rat sarcoma viral oncogene (KRAS) mutations. (TCGA: The Cancer Genome Atlas; H&amp;E: hematoxylin and eosin)</p>
    </caption>
    <graphic xlink:href="cancers-13-01659-g001"/>
  </fig>
  <fig id="cancers-13-01659-f002" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Semi-supervised structure for the ImmunoAIzer cellular biomarker prediction networks. Note that the generator and discriminator structure in this figure is only schematic, a detailed introduction about the generator structures will be given in the following sections.</p>
    </caption>
    <graphic xlink:href="cancers-13-01659-g002"/>
  </fig>
  <fig id="cancers-13-01659-f003" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p>CBPDN structure to predict biomarker distributions. Inception blocks A to D are a series of convolutional modules at various resolutions which are used extract features at different levels, and Inception block E is used to promote high dimensional representations to boost prediction performance. Details of the module structure are described in <xref ref-type="app" rid="app1-cancers-13-01659">Figure S3</xref>.</p>
    </caption>
    <graphic xlink:href="cancers-13-01659-g003"/>
  </fig>
  <fig id="cancers-13-01659-f004" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <p>TGMDN structure to detect tumor gene mutations.</p>
    </caption>
    <graphic xlink:href="cancers-13-01659-g004"/>
  </fig>
  <fig id="cancers-13-01659-f005" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <p>Cellular biomarker prediction results. (<bold>A</bold>) H&amp;E-stained colon cancer slides: the middle image shows an H&amp;E-stained slide (~5500 × 4000 pixels). (The left and right images show enlarged views.) (<bold>B</bold>) mIHC image of the same tissue sample. (<bold>C</bold>) Predictions of our proposed biomarker prediction network. (<bold>D</bold>) 512 × 512 patch-wise results for our proposed method and UNet, DeepLabV3 and DeepLabV3+ under the semi-supervised structure.</p>
    </caption>
    <graphic xlink:href="cancers-13-01659-g005"/>
  </fig>
  <fig id="cancers-13-01659-f006" orientation="portrait" position="float">
    <label>Figure 6</label>
    <caption>
      <p>Visualization of the prediction result of a whole slide image (WSI) from the TCGA dataset. (<bold>A</bold>) H&amp;E stained WSI (filename: TCGA-AZ-4616-01Z-00-DX1). The red arrows indicate pathologists confirmed tumor infiltrating lymphocytes (TILs) clusters. (<bold>B</bold>) Prediction result acquired using semi-supervised CBDPN.</p>
    </caption>
    <graphic xlink:href="cancers-13-01659-g006"/>
  </fig>
  <fig id="cancers-13-01659-f007" orientation="portrait" position="float">
    <label>Figure 7</label>
    <caption>
      <p>TCGA dataset validation results. (<bold>A</bold>) Scatter plot of the PanCK-positive cell proportion: results based on CBDPN versus results based on molecular information provided by TCGA. (<bold>B</bold>) Scatter plot of the TILs proportion: results based on CBDPN (Note that TILs were labeled by CD3 and CD20 in this study) versus results based on molecular information provided by TCGA. (<bold>C</bold>) Correlation analysis between results based on CBDPN and results based on TCGA information. (<bold>D</bold>) Distribution of the number of tiles per case. (<bold>E</bold>) Races and genders distribution of the cases used in this experiment.</p>
    </caption>
    <graphic xlink:href="cancers-13-01659-g007"/>
  </fig>
  <fig id="cancers-13-01659-f008" orientation="portrait" position="float">
    <label>Figure 8</label>
    <caption>
      <p>PD-1 distribution analysis with the ImmunoAIzer CBDPN. (<bold>A</bold>) H&amp;E-stained colon cancer sample slide. (<bold>B</bold>) Anti-PD-1 immunofluorescence-stained image of the same tissue slide. (<bold>C</bold>) Cell-specific biomarker distribution image generated by CBDPN. (<bold>D</bold>) Merged image showing the stained PD-1-positive cells overlaid on our predicted cell-specific biomarker distribution image, the orange area represents PD-1-positive TILs.</p>
    </caption>
    <graphic xlink:href="cancers-13-01659-g008"/>
  </fig>
  <fig id="cancers-13-01659-f009" orientation="portrait" position="float">
    <label>Figure 9</label>
    <caption>
      <p>Comparative analysis of cell quantification based on semi-supervised CBDPN and commercial Inform Software (Version 2.4). (<bold>A</bold>) Bar chart comparison of CD3- and CD20-positive cell percentage calculated based on CBDPN and Inform software. (<bold>B</bold>) Correlation analysis of CD3- and CD20-positive cell percentage calculated based on CBDPN and Inform software. (<bold>C</bold>) Bar chart comparison of PD-1-expressing TILs percentage calculated based on CBDPN and Inform software. (<bold>D</bold>) Correlation analysis of PD-1-expressing TILs percentage calculated based on CBDPN and Inform software.</p>
    </caption>
    <graphic xlink:href="cancers-13-01659-g009"/>
  </fig>
  <fig id="cancers-13-01659-f010" orientation="portrait" position="float">
    <label>Figure 10</label>
    <caption>
      <p>Receiver operating characteristic curves for tumor gene mutation detection network. (<bold>A</bold>) Receiver operating characteristic curve (ROC) and area under curve (AUC) value for adenomatous polyposis coli gene (APC), tumor protein P53 gene (TP53), and kirsten rat sarcoma viral oncogene (KRAS) mutations. (<bold>B</bold>) ROC curve and AUC value for APC mutation. (<bold>C</bold>) ROC curve and AUC value for KRAS mutation. (<bold>D</bold>) ROC curve and AUC value for TP53 mutation.</p>
    </caption>
    <graphic xlink:href="cancers-13-01659-g010"/>
  </fig>
  <fig id="cancers-13-01659-f011" orientation="portrait" position="float">
    <label>Figure 11</label>
    <caption>
      <p>Two-dimensional visualization of TGMDN output obtained by implementing the t-SNE Algorithm. (<bold>A</bold>) Cluster result of <italic>APC</italic> mutation probability generated by the TGMDN. (<bold>B</bold>) Cluster result of <italic>TP53</italic> mutation probability generated by the TGMDN. (<bold>C</bold>) Cluster result of <italic>KRAS</italic> mutation probability generated by the TGMDN. (<bold>D</bold>) Patch-embedded t-SNE representation with magnifications showing specific mutations that were detected based on the H&amp;E image data from test set that were obtained from the TCGA Colon adenocarcinoma (COAD) project.</p>
    </caption>
    <graphic xlink:href="cancers-13-01659-g011"/>
  </fig>
  <table-wrap id="cancers-13-01659-t001" orientation="portrait" position="float">
    <object-id pub-id-type="pii">cancers-13-01659-t001_Table 1</object-id>
    <label>Table 1</label>
    <caption>
      <p>Fully-supervised learning comparisons of the four networks on the test set.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Network</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Accuracy</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Precision</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Recall</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Dice</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">IoU</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">UNet</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.873</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.799</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">
            <bold>0.871</bold>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.825</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.714</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DeepLab V3</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.856</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.776</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.836</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.797</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.677</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DeepLab V3+</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.863</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.778</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.858</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.805</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.690</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">CBPDN</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
            <bold>0.875</bold>
          </td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
            <bold>0.806</bold>
          </td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.865</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
            <bold>0.827</bold>
          </td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
            <bold>0.717</bold>
          </td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn>
        <p>The bold font indicates the best result.
</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap id="cancers-13-01659-t002" orientation="portrait" position="float">
    <object-id pub-id-type="pii">cancers-13-01659-t002_Table 2</object-id>
    <label>Table 2</label>
    <caption>
      <p>Semi-supervised learning comparisons of the four networks on the test set.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Network</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Accuracy</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Precision</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Recall</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Dice</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">IoU</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">UNet</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.891</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.804</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.863</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.824</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.711</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DeepLab V3</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.868</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.789</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.859</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.813</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.701</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">DeepLab V3+</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.872</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.803</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.865</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.823</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.712</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">CBPDN</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
            <bold>0.904</bold>
          </td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
            <bold>0.854</bold>
          </td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
            <bold>0.901</bold>
          </td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
            <bold>0.872</bold>
          </td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
            <bold>0.788</bold>
          </td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn>
        <p>The bold font indicates the best result.
</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
