<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <?epub October-23-2009?>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2800219</article-id>
    <article-id pub-id-type="pmid">19854940</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkp853</article-id>
    <article-id pub-id-type="publisher-id">gkp853</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MMBGX: a method for estimating expression at the isoform level and detecting differential splicing using whole-transcript Affymetrix arrays</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Turro</surname>
          <given-names>Ernest</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lewin</surname>
          <given-names>Alex</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rose</surname>
          <given-names>Anna</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dallman</surname>
          <given-names>Margaret J.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Richardson</surname>
          <given-names>Sylvia</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Department of Epidemiology and Public Health, Imperial College London, Norfolk Place, London W2 1PG and <sup>2</sup>Centre for Integrative Systems Biology, Imperial College London, South Kensington, London SW7 2AZ, UK</aff>
    <author-notes>
      <corresp id="COR1">*To whom correspondence should be addressed. Tel: <phone>+44 (0) 2075941942</phone>; Email: <email>ernest.turro@ic.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>1</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>10</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>10</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>38</volume>
    <issue>1</issue>
    <fpage>e4</fpage>
    <lpage>e4</lpage>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>9</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>9</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>9</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2009. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.5/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5/uk/">http://creativecommons.org/licenses/by-nc/2.5/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Affymetrix has recently developed whole-transcript GeneChips—‘Gene’ and ‘Exon’ arrays—which interrogate exons along the length of each gene. Although each probe on these arrays is intended to hybridize perfectly to only one transcriptional target, many probes match multiple transcripts located in different parts of the genome or alternative isoforms of the same gene. Existing statistical methods for estimating expression do not take this into account and are thus prone to producing inflated estimates. We propose a method, Multi-Mapping Bayesian Gene eXpression (MMBGX), which disaggregates the signal at ‘multi-match’ probes. When applied to Gene arrays, MMBGX removes the upward bias of gene-level expression estimates. When applied to Exon arrays, it can further disaggregate the signal between alternative transcripts of the same gene, providing expression estimates of individual splice variants. We demonstrate the performance of MMBGX on simulated data and a tissue mixture data set. We then show that MMBGX can estimate the expression of alternative isoforms within one experimental condition, confirming our results by RT-PCR. Finally, we show that our method for detecting differential splicing has a lower error rate than standard exon-level approaches on a previously validated colon cancer data set.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>Oligonucleotide microarrays allow biomedical researchers to estimate the expression of thousands of genes simultaneously through their mRNA transcripts. Labelled fragments of the transcripts in the form of single-stranded RNA or DNA are hybridized onto an array containing hundreds of thousands of complementary DNA 25-mers and then scanned. The colour intensities at each probe reflect the degree of hybridization and form the raw data used to make inference on transcript abundance in the sample.</p>
    <p>Traditional Affymetrix arrays, 3′ GeneChips, use perfect match (PM) and mismatch (MM) probe pairs that target the 3′-end of each gene of interest via its RNA products. The PM probes match the target transcript exactly, whereas the MM probes match it exactly but for a complementary base on the 13th position. The purpose of the MM probes is to capture the degree to which RNAs other than the target transcripts bind to the corresponding PM probes (i.e. non-specific hybridization). The probes on 3′-arrays have been found to exhibit varying propensities to bind to target RNA according to the base composition of their sequences (<xref ref-type="bibr" rid="B1">1</xref>) and methods for estimating expression levels that incorporate probe affinity effects have shown demonstrable advances over methods in which these effects are ignored (<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B3">3</xref>).</p>
    <p>In whole-transcript arrays, PM probes are distributed over the whole length of each gene and probe affinity effects can be estimated according to GC content, the proportion of G and C bases in the sequence. Rather than one MM probe for each PM probe, they contain several hundred ‘background probes’ for each of the 26 possible GC proportions on the PM probes (<xref ref-type="bibr" rid="B4">4</xref>). In contrast with existing methods, which use point estimates (<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>) or probe filtering [cf. DABG in (<xref ref-type="bibr" rid="B7">7</xref>)] to account for non-specific hybridization, we use the empirical distribution of the GC-specific background probe intensities to fully incorporate the background noise uncertainty into our modelling of the data (cf. <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Figure S1</ext-link>).</p>
    <p>Both 3′ and whole-transcript arrays contain probes that map to multiple transcribed locations on the genome and are therefore prone to hybridizing perfectly to transcripts other than the intended target (<xref ref-type="fig" rid="F1">Figure 1</xref>A). On the human Gene 1.0 ST array, for instance, almost one in 10 gene-targeting probesets contain one or more probes mapping to non-target genes. If this effect is not accounted for, signal extraction algorithms may yield biased results. This bias is observed in real data where the PM intensities of probes that map to multiple targets are on average consistently higher than those of single-match probes (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Figure S2</ext-link>).
<fig id="F1" position="float"><label>Figure 1.</label><caption><p>Illustration of the two types of multi-match probes. (<bold>A</bold>) One probe shares a subsequence with two separate transcribed regions. Such a probe would belong to two probesets—one targeting each region. (<bold>B</bold>) Probes under the leftmost exon capture signal from isoform 1, while the other probes capture signal from isoforms 1 and 2. In order to estimate expression at the isoform level, probes should be grouped into two probesets—one targeting each isoform. If both isoforms are present in the sample, the probe signal will tend to be higher at the multi-match probes than at the single-match probes.</p></caption><graphic xlink:href="gkp853f1"/></fig></p>
    <p>An additional kind of multi-mapping may be modelled in the denser Exon arrays: the mapping of probes to exons belonging to different isoforms of the same gene, an effect that may be exploited to detect alternative and differential splicing (<xref ref-type="fig" rid="F1">Figure 1</xref>B). Current methods for Exon arrays (<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>) focus on detecting large changes in the expression of individual exons relative to the gene. Thus they do not detect nor quantify the abundance of each individual isoform. Our model can directly estimate isoform-level expression and therefore can be used to compare the expression of variants between conditions and even within one sample.</p>
    <p>Bayesian hierarchical modelling provides a coherent framework for making inference from data with a nested structure. As such, it can be usefully applied to microarray data (<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>), where parameters may be shared at different levels, ranging from probes and probesets to array samples and biological or technical conditions. Here, we present a fully hierarchical Bayesian model for expression analysis, MMBGX, that takes into account the design of the new arrays and the one-to-many mappings between probes and probesets. We have constructed graphs of these mappings for two types of probesets. On the Gene arrays, we use probesets that represent genes as annotated by Affymetrix and on the Exon arrays, we use probesets that represent genes or transcripts (i.e. isoforms) as annotated by (<xref ref-type="bibr" rid="B12">12</xref>). We show evidence of the bias incurred if multi-mapping is not taken into account and demonstrate the ability of MMBGX to disaggregate the signal between various isoforms of the same gene. The method provides posterior summaries for each gene or transcript that encode the full uncertainty in the expression parameter estimates and may be used to detect differential expression (<xref ref-type="bibr" rid="B13">13</xref>). The implementation uses a recently developed adaptive Markov chain Monte Carlo (MCMC) algorithm (<xref ref-type="bibr" rid="B14">14</xref>) and shared-memory parallelism to achieve good computational performance. In the ‘Results’ section, we assess the method using simulated and real Gene array data, comparing our gene-level results with those of two other widely available methods. We then present the results of our transcript-level analysis on a single-condition mouse Exon array data set and validate some of our predictions by RT-PCR. Finally, we compare MMBGX's; ability to detect differential splicing between experimental conditions to a standard exon-level approach by analysing a previously published and validated colon cancer data set. Note that throughout the article, we use the phrase ‘differential splicing’ to refer to gene-normalized differential transcript expression, which may involve more than one splice site, as well as the usual meaning of gene-normalized differential inclusion of a single exon. The MMBGX software package and accompanying instructions are freely available from <ext-link ext-link-type="uri" xlink:href="http://bgx.org.ukhttp://bgx.org.uk">http://bgx.org.ukhttp://bgx.org.uk</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>MATERIALS AND METHODS</title>
    <sec>
      <title>Re-annotation of Exon array probes</title>
      <p>The Exon arrays contain a large superset of the probes in the Gene arrays, covering virtually every known exon on the target genomes, and thus permitting expression summarization at the exon level. While exon and gene-level expression summarization may reveal useful differences in exon retention or exclusion patterns across samples, it is the quantification of alternative splice variants—the ultimate determinants of protein products—that is biologically most interesting.</p>
      <p>In order to address this challenge, we required a re-annotation of the probes on the Exon arrays that group them into probesets that target transcripts rather than genes or exons. Our aim was to construct a graph between probes and probesets largely based on the phenomenon illustrated in <xref ref-type="fig" rid="F1">Figure 1</xref>B. A solution was found by combining the Ensembl database, which contains tens of thousands of known transcripts, with X:Map (<xref ref-type="bibr" rid="B15">15</xref>), which contains hits between Affymetrix probes and Ensembl transcripts. In this way, probes are grouped into probesets that target any number of transcripts, be they alternative isoforms of the same gene or transcripts from entirely separate genes.</p>
    </sec>
    <sec>
      <title>Hierarchical model</title>
      <p>Using the BGX method (<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B11">11</xref>) for the analysis of 3′ GeneChips as a starting point, we developed a new model that (i) accounts for the use of global GC content-specific background probes instead of probe-specific MM probes and (ii) accounts for the complex mapping between probesets and probes explicitly. Signal from multi-match probes is split in a logical way to obtain unbiased estimates of expression at the gene level for Gene arrays and the transcript or gene level for Exon arrays. While probes may be grouped into probesets that target genes as well as individual transcripts, for simplicity, we refer to probeset targets only as ‘transcripts’ below.</p>
      <p>Perfect match probe intensities, <italic>PM</italic>s, are modelled as arising partly from specific hybridization, <italic>S</italic> (the signal), and partly from non-specific hybridization, <italic>H</italic>, both of which are probe (<italic>j</italic>), condition (<italic>c</italic>) and replicate (<italic>r</italic>) specific:
<disp-formula id="M1"><label>1</label><graphic xlink:href="gkp853m1"/></disp-formula>
Note how, unlike Equation (4.1) in Hein <italic>et al.</italic> (<xref ref-type="bibr" rid="B11">11</xref>), Equation (<xref ref-type="bibr" rid="B1">1</xref>) does not group probes into probesets, thus accommodating for the fact that one or more transcripts may contribute to the signal intensity observed at a PM probe. Also, we do not assume an additional additive error, as the model would then be overparameterized. The quantity of interest is the unknown signal, <italic>S</italic><sub><italic>jcr</italic></sub>, and <italic>H</italic><sub><italic>jcr</italic></sub> encapsulates the noise.</p>
      <p>We wish to model the signal on the log-scale to account for multiplicative error. In the simple case where a single transcript <italic>g</italic> in condition <italic>c</italic> is linked to the probe signal, <italic>S</italic><sub><italic>jcr</italic></sub>, this suggests the model
<disp-formula id="M2"><label>2</label><graphic xlink:href="gkp853m2"/></disp-formula>
where μ<sub><italic>gc</italic></sub> is the probeset-level log expression measure, σ<sub><italic>gc</italic></sub>² is an error term and in this case there is a one-to-one mapping from probe <italic>j</italic> to probeset <italic>g</italic>.</p>
      <p>We know from the multi-mapping structure, however, that two or more transcripts may in fact contribute to the signal. We therefore need to model the contribution of each transcript to the signal of one probe. We assume that the contribution to the signal and its variance is additive on the real scale. This assumption is based on the fact that the means and variances of multi-match probes are consistently higher than those of single-match probes (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Figure S2</ext-link>). Since the μ<sub><italic>gc</italic></sub> and σ<sub><italic>gc</italic></sub>² parameters are on the log-scale but their contribution to the signal are additive on the real scale, we need to exponentiate before summing and finally go back to the log-scale. Allowing for any number of transcript contributions to the signal, the signal parameter, <italic>S</italic><sub><italic>jcr</italic></sub>, therefore follows the following distribution:
<disp-formula id="M3"><label>3</label><graphic xlink:href="gkp853m3"/></disp-formula>
where <italic>G</italic>( <italic>j</italic> ) indexes the set of transcripts matched by probe <italic>j</italic> [see <xref ref-type="fig" rid="F2">Figure 2</xref> for graphical examples of <italic>G</italic>( <italic>j</italic> )]. When <italic>G</italic>( <italic>j</italic> ) contains only one index, Equation (<xref ref-type="bibr" rid="B3">3</xref>) reduces to the simpler Equation (<xref ref-type="bibr" rid="B2">2</xref>).
<fig id="F2" position="float"><label>Figure 2.</label><caption><p>A cluster of interconnected probesets on the human Gene 1.0 ST array. The ellipses represent probesets and the dots represent probes. Probesets are linked to their component probes by edges. For example, probeset 7926979, which probes a region on chromosome 10, and probeset 8132692, which probes a region on chromosome 7, share two probes. Probesets 7988175 and 7988206 are identical but nominally probe two separate regions on chromosome 15. As an example of Equation (<xref ref-type="disp-formula" rid="M3">3</xref>), if <italic>j</italic> indexed either of the two probes linking probesets 7927979 and 8132692, then the elements of <italic>G</italic>(<italic>j</italic>) would be the indices of probesets 7927979 and 8132692.</p></caption><graphic xlink:href="gkp853f2"/></fig></p>
      <p>The non-specific binding parameter, <italic>H</italic>, log-transformed, follows a GC content (<italic>k</italic>)- and array (<italic>r</italic>)- specific normal distribution:
<disp-formula id="M4"><label>4</label><graphic xlink:href="gkp853m4"/></disp-formula>
where <italic>k</italic>(<italic>j</italic>) indexes the GC content category of probe <italic>j</italic>.</p>
      <p>The mean and variance, <inline-formula><inline-graphic xlink:href="gkp853i1.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="gkp853i2.jpg"/></inline-formula>, respectively, are estimated empirically from the logarithms of the GC content-specific background probes. While most methods plug the median background measurement into the non-specific hybridization parameter (in our case, <italic>H</italic><sub><italic>jcr</italic></sub>) (<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>), we allow a degree of variability, consistent with the observed variability in background probe measurements (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Figure S1</ext-link>). Thus, the model accounts for <italic>PM</italic>s that are lower than the corresponding median background measurement through allowing a lower <italic>H</italic>, rather than relying solely on a high error in the signal, which may bias this error upwards.</p>
      <p>We conclude the full specification of our model by assuming priors similar to those used in BGX (<xref ref-type="bibr" rid="B11">11</xref>). We place a <italic>U</italic>(0,15) prior on μ<sub><italic>gc</italic></sub>, which amply covers the range of possible expression values, a <italic>N</italic>(α<sub><italic>c</italic></sub>,β<sub><italic>c</italic></sub>²) prior on <inline-formula><inline-graphic xlink:href="gkp853i3.jpg"/></inline-formula> and a Γ(1.2,0.2) prior on <inline-formula><inline-graphic xlink:href="gkp853i4.jpg"/></inline-formula>. Note that a lower bound of 0 on μ's; prior restricts the mean of <italic>S</italic> to a minimim value of 1 even though theoretically it may be as low as 0. However, a comparison of the model with an alternative less-computationally tractable model in which <inline-formula><inline-graphic xlink:href="gkp853i5.jpg"/></inline-formula> follows a truncated normal distribution [as in (<xref ref-type="bibr" rid="B11">11</xref>)] showed that they gave virtually indistinguishable results. Specifying a prior for α<sub><italic>c</italic></sub> leads to slow mixing of the MCMC sampler, making reliable inference computationally inefficient. We therefore developed an empirical Bayes algorithm that estimates α<sub><italic>c</italic></sub> accurately and fix it to this value (see Algorithm S1 in the <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Data</ext-link>). In the process, estimates of <italic>S</italic><sub><italic>jcr</italic></sub>, <italic>H</italic><sub><italic>jcr</italic></sub>, μ<sub><italic>gc</italic></sub>, σ<sub><italic>gc</italic></sub>² and β<sub><italic>c</italic></sub>² are computed and set to starting values for the respective samplers in order to speed up convergence. The central parameter of Equation (<xref ref-type="disp-formula" rid="M3">3</xref>), μ<sub><italic>gc</italic></sub>, acts as the transcript-level log expression measure.</p>
    </sec>
    <sec>
      <title>Detecting differential splicing</title>
      <p>Using the posterior distribution of log expression for genes and their transcript variants, we devised the following statistic as a measure of the probability of differential splicing:
<disp-formula id="M5"><label>5</label><graphic xlink:href="gkp853m5"/></disp-formula>
where μ<sub><italic>tc</italic></sub> is the expression level of transcript <italic>t</italic> in condition <italic>c</italic> and μ<sub><italic>g</italic>(<italic>t</italic>)<italic>j</italic></sub> is the expression level of the gene containing transcript <italic>t</italic> in condition <italic>c</italic>. The quantity <italic>p</italic><sub><italic>t</italic></sub> is the posterior probability that transcript <italic>t</italic> is more up-regulated in condition 1 relative to condition 2 than its corresponding gene. Hence, values of <italic>p</italic><sub><italic>t</italic></sub> close to 1/0 indicate over/under-expression of transcript <italic>t</italic> after normalizing for gene-level expression changes. However, transcripts expressed at very low levels in both conditions may have <italic>p</italic><sub><italic>t</italic></sub> close to 1 or 0 if other transcripts of the gene are differentially expressed. Transcripts should therefore be filtered out if their overall expression level remains below the threshold (e.g. μ<sub><italic>t</italic>·</sub>&lt;1.5 on the natural log-scale), and if the probability that they are up-regulated is within a certain range [e.g. <italic>P</italic>(μ<sub><italic>t</italic>2</sub> &lt;μ<sub><italic>t</italic>1</sub>) ∈ (0.05,0.95)].</p>
      <p>To compare differential splicing results per gene, we define a gene-level quantity:
<disp-formula id="M6"><label>6</label><graphic xlink:href="gkp853m6"/></disp-formula>
where <italic>t</italic>(<italic>g</italic>) is the list of non-filtered transcripts produced by gene <italic>g</italic>. If a gene produces only one non-filtered transcript [i.e. |t(<italic>g</italic>)|=1], then that gene is filtered out as a candidate for differential splicing. Restricting the set of potential genes that can be called as being differentially spliced reduces the chance of producing a false positive result, even though in cases where unknown isoforms are present, a false negative result may occur.</p>
    </sec>
    <sec>
      <title>Normalization</title>
      <p>Replicate GeneChip hybridizations exhibit variability of non-biological origin. A popular method of bringing the log-scale true signals into par is quantile normalization (<xref ref-type="bibr" rid="B16">16</xref>), which forces the distribution of signals across arrays to be exactly the same. Our models normalize the arrays implicitly by assuming exchangeability of the log-scale true signals for all replicates within conditions, while allowing for array-specific distributions of the non-specific hybridization terms. Specifically, σ<sub><italic>gc</italic></sub>² captures variability between probe-level signal, <italic>S</italic><sub><italic>jcr</italic></sub>, within all arrays belonging to the same condition.</p>
      <p>Researchers may nonetheless prefer to use σ<sub><italic>gc</italic></sub>² as a measure only of within-array variability and choose their own preferred cross-array normalization method. This can be achieved simply by setting each array to belong to a different condition. Thus, array-specific expression measures, μ<sub><italic>gc</italic></sub>,<italic>c</italic> = 1,…,<italic>A</italic>, where <italic>A</italic> is the number of arrays, are obtained and can be subsequently normalized using any preferred method.</p>
    </sec>
    <sec>
      <title>Implementation and parallelism performance</title>
      <p>A C++ implementation of a MCMC algorithm was written and incorporated into a freely available R package (cf. <ext-link ext-link-type="uri" xlink:href="http://r-project.org">http://r-project.org</ext-link>) called MMBGX. The software outputs a thousand samples from the posterior distribution of each parameter, thus providing a comprehensive measure of uncertainty associated with each estimate.</p>
      <sec>
        <title>Sampling algorithm</title>
        <p>The parameters <italic>S</italic><sub><italic>jcr</italic></sub>, <italic>H</italic><sub><italic>jcr</italic></sub>, μ<sub><italic>gc</italic></sub> and σ<sub><italic>gc</italic></sub>² in the model are estimated using a Random Walk Metropolis–Hastings algorithm, where the full conditional distributions are updated by proposing new values from a Gaussian distribution centred on the current value and accepted or rejected according to the Metropolis–Hastings ratio. Since we set <italic>PM</italic><sub><italic>jcr</italic></sub> to be equal to the sum of the probe-level signal parameter, <italic>S</italic><sub><italic>jcr</italic></sub>, and the non-specific hybridization parameter, <italic>H</italic><sub><italic>jcr</italic></sub>, we only need to sample one of the two parameters in the MCMC scheme. We do this for each probe by proposing a new value <italic>S</italic>′<sub><italic>jcr</italic></sub> and setting <italic>H</italic>′<sub><italic>jcr</italic></sub> = <italic>PM</italic><sub><italic>jcr</italic></sub>−<italic>S</italic>′<sub><italic>jcr</italic></sub>. The Adaptive Metropolis-Within-Gibbs algorithm (<xref ref-type="bibr" rid="B14">14</xref>) is used during the burn-in period to improve mixing efficiency of the chains, as described in (<xref ref-type="bibr" rid="B3">3</xref>). The hyperprior on β<sub><italic>c</italic></sub>² is conjugate with the prior on σ<sub><italic>gc</italic></sub>², allowing the hyperparameter β<sub><italic>c</italic></sub>² to be sampled directly using a Gibbs algorithm.</p>
      </sec>
      <sec>
        <title>Structure and input files</title>
        <p>The MMBGX package contains files describing the multi-mapping structure between probes and probesets for the Gene and Exon arrays targeting the human, mouse and rat genomes. The Gene array structure files were constructed using Affymetrix's; Transcript Cluster Annotation and Probe Group files (available from <ext-link ext-link-type="uri" xlink:href="http://affymetrix.com">http://affymetrix.com</ext-link>). The former was used to produce a list of probesets matching the reference genome only—that is, excluding alternative haplotypes such as the COX or QBL assemblies—and the latter was used to extract the probe–probeset mappings and determine the background probe Affy IDs. The Exon array structure files were constructed using the Ensembl (<xref ref-type="bibr" rid="B12">12</xref>) and X:Map (<xref ref-type="bibr" rid="B15">15</xref>) databases to determine probe–probeset mappings at the Ensembl transcript and gene level and the Probe Group files were used to map the PM and background probes to Affy IDs. The only necessary data inputs to make inference using MMBGX are the experimental CEL files containing the probe intensity measurements. These may be read into R using the <italic>affy</italic> Bioconductor package (<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org">http://bioconductor.org</ext-link>).</p>
      </sec>
      <sec>
        <title>Shared-memory parallelism</title>
        <p>In recent years there has been a marked shift in focus by CPU manufacturers towards multi-core and multi-CPU computing. As of 2008, most high-end desktop or server computers contain eight cores and trends suggest this quantity will continue to increase exponentially. This development allows software designed to solve problems through simultaneous computations to be run in a much smaller amount of time.</p>
        <p>MMBGX was adapted to take advantage of all available cores using the OpenMP application programming interface (<ext-link ext-link-type="uri" xlink:href="http://openmp.org">http://openmp.org</ext-link>), which simplifies the spawning of threads to be executed by each core. By exploiting conditional independence relationships between parameters, components of <italic>S</italic><sub><italic>jcr</italic></sub> may be updated simultaneously by multiple threads, followed by components of μ<sub><italic>gc</italic></sub> and σ<sub><italic>gc</italic></sub>². For the update of β<sub><italic>c</italic></sub>², a summation over transcripts is parallelized and the component sums reduced to a final result. Summations of various parameters throughout the MCMC for the purpose of calculating mean estimates are also parallelized, while output of trace values to file streams is partitioned as far as possible. The result is a substantial speedup over the serial version of the programme (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Figure S3</ext-link>), allowing gene-level analysis on a modern 8-core computer of human Gene and Exon arrays in ∼20 min and 1 h, respectively, and transcript-level analysis of Exon arrays in ∼2 h. Since parameters are shared between replicate arrays, the computation time for <italic>k</italic> replicate arrays is less than <italic>k</italic> times the computation time for one array. For instance, a transcript-level analysis of four human exon replicates takes only 66% longer (3 h 20 min) than a single-array analysis.</p>
      </sec>
    </sec>
    <sec>
      <title>Mouse Exon 1.0 ST arrays and RT-PCR</title>
      <p>Bone marrow cells from male C57Bl/6 mice (8–10 weeks old, Harlan, UK) were differentiated into bone marrow derived dendritic cells (BMDCs) in the presence of 20 ng/ml GM-CSF in DMEM (Sigma, UK) + 10% FCS + 100 U penicillin/100 μg/ml streptomycin for 8 days. On day 8, cells were replated on tissue culture plates precoated with 10 μg/ml human IgG1 (Sigma, UK) for 4 h before cells were harvested and total RNA isolated using the Absolutely RNA micro prep kit (Agilent, UK). Three biological repeats were processed separately for hybridization to mouse exon 1.0 ST chips (Affymetrix, UK) according to the manufacturer's; instructions.</p>
      <p>For validation of MMBGX, 125 ng total RNA from BMDCs treated as above was reverse transcribed (High Capacity cDNA Archive Kit, Applied Biosystems, UK). Primers for PCR were designed in exons flanking spliced exons for genes to be validated. The primer sequences are listed in <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Data S1</ext-link>. PCR products were amplified from 1 μl cDNA in 35 cycles and analysed on 2% agarose gels.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>RESULTS</title>
    <sec>
      <title>Accounting for multi-mapping signal bias</title>
      <p>The Affymetrix Gene array annotation files group probes into probesets each targeting, with some exceptions (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Data S2</ext-link>), a specific gene. However, some probes match several transcribed regions of the genome at once and are therefore assigned to multiple probesets (<xref ref-type="fig" rid="F1">Figure 1</xref>A). Such ‘multi-match’ probes should not be treated as independent measurements of one gene within one probeset because they capture the signal from other unintended genes as well. In effect, the probe intensities reflect the sum of each matching gene's; transcription level. Algorithms that do not disaggregate the signal accordingly are prone to yielding inflated expression estimates. Since no widely available gene expression summarization algorithm addresses this problem, researchers sometimes discard multi-mapping probe measurements from the analysis altogether. However, this cannot be done within standard analysis software such as Partek Genomics Suite (<ext-link ext-link-type="uri" xlink:href="http://partek.com">http://partek.com</ext-link>) (Partek Customer Support, personal communication), as it requires the creation of special probe group files for the arrays. Moreover, such a workaround removes the upward bias but precludes the use of all the information contained in the data, thus increasing the error in the expression estimates. We performed a masked analysis using MMBGX, by discarding probes matching to multiple probesets. <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Figure S4</ext-link> shows the extent of the increase in estimate errors. A large set of genes has to be discarded in this type of analysis, since all probes of each gene are multi-matching: 1196 for mouse, 1179 for human and 614 for rat. However, the expression of genes that are completely eliminated by masking can be well estimated by MMBGX (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Figure S4</ext-link>).</p>
      <p>We call probesets with at least one multi-match probe ‘multi-mapping probesets’. On the human Gene 1.0 ST arrays, 9.4% of probesets are multi-mapping due to 3.7% of unique probes belonging to more than one probeset. The relationships between probes and probesets may be illustrated as a graph (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Figure S5</ext-link>). Each cluster in the graph consists of a set of probesets connected via a network of shared probes. A cluster may be illustrated using ellipses to represent probesets and dots to represent probes. Probesets are linked to their component probes by edges and the number of edges attached to a probe reflects the number of transcripts it measures (<xref ref-type="fig" rid="F2">Figure 2</xref>).</p>
      <p>Probes that belong to multiple probesets targeting different genes (illustrated in <xref ref-type="fig" rid="F1">Figure 1</xref>B) may bias upwards the expression estimates of each gene. We assessed this bias on the Gene arrays by comparing our model to a ‘naive’ version that treats each PM as uniquely matching one locus even if it is assigned to multiple gene-targeting probesets. This is in effect how other microarray analysis software interpret the data. Using the human Gene 1.0 ST array data set, available from Affymetrix, we implemented our model and its naive version and confirmed that the multi-mapping model splits the gene expression signal across matching probes, whereas the naive model ignores the multi-mapping networks and therefore overestimates the signal (<xref ref-type="fig" rid="F3">Figure 3</xref>).
<fig id="F3" position="float"><label>Figure 3.</label><caption><p>Scatterplots of the log expression measures obtained from Gene array data between the MMBGX model and a naive version that treats each probe as uniquely matching one probeset. (<bold>A</bold>) The scatterplot for probesets with non-multi-mapping probes, and (<bold>B</bold>) the scatterplot for multi-mapping probesets. Expression intensities for non-multi-mapping probesets are approximately on the <italic>y</italic> = <italic>x</italic> line, while the expression intensities for multi-mapping probesets are overestimated by the naive model.</p></caption><graphic xlink:href="gkp853f3"/></fig></p>
    </sec>
    <sec>
      <title>Performance on simulated data</title>
      <p>We checked the algorithm and implementation for correctness by comparing parameter estimates to true simulated values. First we used the mapping structure from the human Gene 1.0 ST array. We generated PM probe data from the model for one array using <italic>a</italic><sub><italic>c</italic></sub> = 0.25, <italic>b</italic><sub><italic>c</italic></sub>² = 0.625, μ<sub><italic>gc</italic></sub>∼<italic>U</italic>(1.5,8) and calculated <inline-formula><inline-graphic xlink:href="gkp853i6.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="gkp853i7.jpg"/></inline-formula> values using background probe data from a real data set.</p>
      <p>The log expression measure, μ<sub><italic>gc</italic></sub>, is estimated well for non-multi-mapping transcripts (<xref ref-type="fig" rid="F4">Figure 4</xref>A) as is the signal from multi-mapping probesets with at least one single-match probe (<xref ref-type="fig" rid="F4">Figure 4</xref>B). As expected, when there are no single-match probes capturing signal purely from the intended transcript, there is increased variability and shrinkage towards the mean at low and high levels of μ<sub><italic>gc</italic></sub> (<xref ref-type="fig" rid="F4">Figure 4</xref>C). This is due to the inherent ambiguity of the relative contributions of signal from highly overlapping multi-mapping probesets. To make sure that this shrinkage did not lead to misleading results, we verified that the Monte Carlo Standard Error (MCSE) on the estimates for probesets with no single-match probes was higher than for probesets with at least one single-match probe (<xref ref-type="fig" rid="F4">Figure 4</xref>D). Indeed, 95% of the true simulated μ<sub><italic>gc</italic></sub> values fell within a central 95% credible intervals obtained from the estimated μ<sub><italic>gc</italic></sub> posterior distributions.
<fig id="F4" position="float"><label>Figure 4.</label><caption><p>Plots showing the ability of MMBGX to recover gene-level log expression values from simulated human Gene array data. (<bold>A</bold>) The scatterplot shows that the model implementation recovers the simulated expression values, μ<sub><italic>gc</italic></sub>, for non-multi-mapping probesets accurately; (<bold>B</bold>) the scatterplot shows that the expression for multi-mapping probesets with one or more probes that uniquely match the intended transcript is also well-estimated; (<bold>C</bold>) the scatterplot shows that the expression for multi-mapping probesets with no probes that uniquely match the intended transcript has higher variance and shrinkage towards the mean at low and high levels of expression, μ<sub><italic>gc</italic></sub>; (<bold>D</bold>) the density lines show that the shrunk estimates of μ<sub><italic>gc</italic></sub> (i.e. those hailing from multi-mapping probesets with no single-match probes) have a higher MCSE than the non-shrunk estimates (i.e. hailing from multi-mapping probesets with at least one single-match probe).</p></caption><graphic xlink:href="gkp853f4"/></fig></p>
      <p>The Ensembl/X:Map transcript mappings to the human Exon 1.0 ST array were also used to simulate data as above. The probe–probeset graph is far more interconnected for the Exon arrays than for the Gene arrays, with about half the probesets being composed of &lt;10% single-match probes (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Figure S6</ext-link>). The expression signal is recovered very well for probesets containing at least 10% single-match probes and it is only for the highly multi-mapping probesets that shrinkage becomes significant (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Figure S7</ext-link>). Again, this did not give rise to misleading results, as the central 95% credible intervals obtained from the μ<sub><italic>gc</italic></sub> posterior distributions contained the true simulated value in ∼~95% of cases.</p>
    </sec>
    <sec>
      <title>Differential gene expression</title>
      <sec>
        <title>Gene array mixture data set</title>
        <p>To test the performance of MMBGX on real Gene array data, we analysed a human Gene 1.0 ST array data set, available from Affymetrix, which was produced from various mixtures of brain and heart RNA samples. A single RNA pool was created for nine mixture levels, 0/100, 5/95, 10/90, 25/75, 50/50, 75/25, 90/10, 95/5,100/0, all of which were hybridized to three replicates except for the 50/50 mixture, which was hybridized to nine replicates.</p>
        <p>A comparison of the pure brain with the pure heart pools should neatly differentiate brain from heart-expressed transcripts. A closer inspection of these transcripts across all mixture levels should indicate a progressive increase in brain-expressed transcripts and a progressive decrease in heart-expressed transcripts.</p>
        <p>MMBGX was run on the full data set and the two extreme conditions—pure brain and pure heart—were compared. Using differences in the posterior distributions of the log expression parameter, we were able to clearly distinguish brain- and heart-specific genes (<xref ref-type="fig" rid="F5">Figure 5</xref>). We also found that the log expression of genes predicted to be brain specific follow a consistent upward trend as the brain sample proportion increases and a consistent downward trend as the heart sample proportion decreases, as expected. Transcripts occurring in equal abundance in the two pure conditions have flat intensities across mixture levels (<xref ref-type="fig" rid="F6">Figure 6</xref>).
<fig id="F5" position="float"><label>Figure 5.</label><caption><p>Histogram of the probability that the expression value of a transcript is greater in the pure brain sample than in the pure heart sample. The two peaks at 0 and 1 capture the brain- and heart-expressed transcripts, respectively, while the hump in the centre represents genes that are expressed equally in both tissues.</p></caption><graphic xlink:href="gkp853f5"/></fig>
<fig id="F6" position="float"><label>Figure 6.</label><caption><p>Plots showing MMBGX log expression values of three types of genes at different brain/heart mixture levels. Fifty transcripts for which <italic>P</italic>(μ<sub><italic>g</italic>9</sub>−μ<sub><italic>g</italic>1</sub> &lt; 0) = 0, <italic>P</italic>(μ<sub><italic>g</italic>9</sub>−μ<sub><italic>g</italic>1</sub> &lt; 0) = 1 and 0.45 &lt; <italic>P</italic>(μ<sub><italic>g</italic>9</sub>−μ<sub><italic>g</italic>1</sub> &lt; 0) &lt; 0.55) were randomly chosen and defined as ‘brain-expressed’, ‘heart-expressed’ and ‘equally-expressed’. The group mean of the nine mixture levels was subtracted from the nine values for each group of fifty transcripts and plotted (<bold>A</bold>–<bold>C</bold>). As expected, the intensities of (<bold>A</bold>) brain-, (<bold>B</bold>) equally and (<bold>C</bold>) heart-expressed transcripts are upward-sloping, flat and downward-sloping respectively, showing that MMBGX is adequately capturing concentration changes.</p></caption><graphic xlink:href="gkp853f6"/></fig></p>
      </sec>
      <sec>
        <title>Comparison with RMA and PLIER</title>
        <p>One of the arrays in the pure heart sample was analysed using the methods provided in the Affymetrix analysis software, RMA (<xref ref-type="bibr" rid="B17">17</xref>) and PLIER (<xref ref-type="bibr" rid="B5">5</xref>), in addition to MMBGX. There was good concordance between the three methods for non-multi-mapping probesets (<xref ref-type="fig" rid="F7">Figure 7</xref>), despite a small subset of probesets having a much lower PLIER expression value on the log-scale than either RMA or MMBGX (data not shown). The typical shrinkage induced by MMBGX for low values was already observed in BGX (<xref ref-type="bibr" rid="B11">11</xref>). However, the purpose of the comparisons is to contrast multi-mapping and non-multi-mapping probesets. As expected, the multi-mapping probeset estimates are inflated by RMA and PLIER relative to MMBGX as these methods do not split the signal according to the multiple probe matches on the genome. Conversely, when RMA and PLIER are compared with each other, no significant difference between the multi-mapping and non-multi-mapping expectation lines is observed as neither method takes into account the multi-mapping structure of the chips.
<fig id="F7" position="float"><label>Figure 7.</label><caption><p>(<bold>A–C</bold>) Density contours of scatterplots comparing expression measures obtained by MMBGX, RMA and PLIER. Separate contours are plotted for multi-mapping (red) and non-multi-mapping (black) probesets. Both RMA and PLIER have a tendency to overestimate expression values for multi-mapping probesets relative to MMBGX, as they ignore the fact that some probes map to multiple regions on the genome. There is no perceptible difference in the plots comparing RMA with PLIER between multi-mapping and non-multi-mapping probesets. This is because neither method takes into account the multi-mapping structure of the chips.</p></caption><graphic xlink:href="gkp853f7"/></fig></p>
      </sec>
    </sec>
    <sec>
      <title>Estimation of isoform expression within one sample and validation by RT-PCR</title>
      <p>When applied to Exon arrays, MMBGX has the ability to estimate the abundance of specific isoforms of each gene, even within a single sample. Thus, MMBGX offers a more fine-grained evaluation of the composition of mRNA products than gene- or exon-level approaches. In order to show that our approach is able to discern the abundance of alternative variants, we ran MMBGX on the Exon array data set described in the section ‘Materials and Methods’ section, including three additional treatments besides IgG1, and used the estimates to create two groups of genes fulfilling certain criteria. The first group contains genes with two highly expressed isoforms, thus we expect RT-PCR to detect both transcripts. The second group consists of genes with two transcripts expressed at very different levels. For this group, we expect RT-PCR to produce a very bright band for the higher expressed transcript and a faint band or possibly no band at all for the lower expressed transcript. As the gel images were virtually identical for the four treatments, only the results for IgG1 are shown. Primer sequences used for the RT-PCR experiments are listed in Note S1 in the <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Data</ext-link>.</p>
      <p>For the first validation group, we picked genes that had two transcripts with mean log expression values above 6 in one of the conditions, resulting in a list of 36 genes. We then excluded genes with transcripts that did not share flanking exons or were otherwise unsuitable for testing by RT-PCR, leaving a selection of seven genes. cDNA of three out of the seven genes was then amplified to check the presence of both isoforms. <xref ref-type="fig" rid="F8">Figure 8</xref>A shows, for each variant in each gene, the full posterior distributions of μ, their exonic structure and the corresponding RT-PCR products. The expression of two isoforms of Cd97 and Clec5a are confirmed by two clear bands of correct size for each gene. For B4galt5, we were also able to detect the two predicted isoforms, although there was a notable difference between the two bands and the abundance of the spliced isoform appeared to be lower than anticipated.
<fig id="F8" position="float"><label>Figure 8.</label><caption><p>Verification of isoform-level predictions by RT-PCR. Two groups of genes from mouse Exon array data were selected for validation by RT-PCR. For each gene the posterior density of the log expression parameter, μ, the exonic structure for two isoforms (not to scale) and length of the corresponding PCR products are shown. Black: full length isoform, pink: spliced isoform. Below, agarose gels of RT-PCR products are shown. RT-PCR was repeated at least three times and a representative gel is shown. (<bold>A</bold>) Genes with two isoforms with a mean log expression value greater than 6 in one of the conditions. Both isoforms can be detected for all three genes. (<bold>B</bold>) Genes with two transcripts with a difference in mean log expression of at least 5.5 between the isoforms in one of the conditions. The isoforms that were predicted to have higher expression levels were correctly identified as shown by RT-PCR.</p></caption><graphic xlink:href="gkp853f8"/></fig></p>
      <p>For the second validation group, we picked genes with exactly two annotated transcripts with mean log expression values differing by at least 5.5 in one of the conditions, resulting in a list of 27 genes. As before, the list was narrowed down by filtering genes which were unsuitable for testing by RT-PCR, leaving a selection of seven genes. We chose three genes with non-overlapping distribution curves of the two isoforms and used RT-PCR to check whether the correct prediction of the higher expressed isoform could be confirmed. In each of the three cases the highly expressed transcript was correctly identified (<xref ref-type="fig" rid="F8">Figure 8</xref>B). The transcript with a low predicted expression level in Csf2rb2 yielded a faint band, whereas the Rac1 and Slc23a2 transcripts with predicted low levels of expression could not be detected. Our results show that MMBGX is able to estimate the expression of alternative isoforms within one sample. Other currently available methods used on Exon arrays are designed to find differential splicing between conditions and therefore cannot be tested on this data (cf. next section).</p>
    </sec>
    <sec sec-type="methods">
      <title>Differential splicing and comparison to exon-level methods on a colon cancer data set</title>
      <p>Comparisons between MMBGX, which works at the Ensembl transcript level, with methods that work at the exon level pose two major difficulties. First, an exon that is predicted to be differentially spliced by an exon-level method may not be listed as being alternatively included by transcripts on Ensembl. This is advantageous in that it restricts the search space to only known events thereby reducing the false positive rate, but it is disadvantageous if it prevents the detection of real events in a sample. Second, an alternatively spliced exon may belong to or be skipped by several Ensembl transcripts. Therefore, each time an exon is declared to be differentially spliced by an exon-level method and RT-PCR verification is performed, we need to group the Ensembl transcripts by whether or not they include the exon and the flanking exons targeted by the primers. In the example shown in <xref ref-type="fig" rid="F9">Figure 9</xref>, a detection of differential splicing for exon 2 by an exon-level method needs to be compared with the MMBGX probability of differential splicing of transcript A and the set of transcripts C and D. Each set of transcripts relates to one gel band, even though there may be variation within the set (e.g. between transcripts C and D). Any transcripts that do not include the exons matching the primers (e.g. transcript B), are not targeted by RT-PCR.
<fig id="F9" position="float"><label>Figure 9.</label><caption><p>Illustrative schematic of the structure of four variants. Each exon is targeted by one exon–probeset. If differential splicing is predicted for exon 2, RT-PCR primers may be designed matching flanking exons 1 and 3. The resulting short gel product would show the expression of transcript A, while the long product would show the total expression of the two transcripts C and D. Any transcripts that do not include the exons matching the primers, in this case transcript B, are not targeted by RT-PCR.</p></caption><graphic xlink:href="gkp853f9"/></fig></p>
      <sec>
        <title>Comparison between MMBGX and the Splicing Index</title>
        <p>Despite these difficulties, we attempted a broad comparison between existing methods and MMBGX by analysing a previously published colon cancer data set (<xref ref-type="bibr" rid="B18">18</xref>). Although several methods exist to detect differential splicing at the exon–probeset level (<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>), they are all variations on a similar approach. Namely, they search for deviations in the fold change at the exon–probeset level from the expected fold change observed at the gene–probeset level. The most commonly used metric is the Splicing Index (<xref ref-type="bibr" rid="B7">7</xref>): the log fold change of the gene–normalized intensities of exon–probesets between conditions. The data set presented in (<xref ref-type="bibr" rid="B18">18</xref>) consists of 10 paired normal/tumour human Exon array samples. The authors initially filtered their exon-probesets by applying a <italic>t</italic>-test between conditions in the Splicing Index. After RT-PCR testing of 42 candidates drawn from this list, extra filters were applied in order to maximize the rate of true positives, resulting in a list of 168 candidate genes (provided by the authors in their <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary File 3</ext-link>).</p>
        <p>Out of the 42 genes tested by RT-PCR, 13 showed some evidence of differential splicing. In addition, eight further genes that had been previously reported as being differential spliced in colon tumours but were not significant in their workflow were also tested by RT-PCR. Of these, three tested positive. Therefore, in total, 50 genes were tested by RT-PCR and 16 of those produced evidence of differential splicing between normal tissues and tumours.</p>
        <p>We ran MMBGX on both sets of arrays at the transcript and the gene level. Out of 35 913 Ensembl genes, 10 825 are known to produce more than one isoform. After filtering out genes expressing only one transcript in this data set, this list was reduced to 4928 genes, which we shall refer to as the ‘multi-isoform set’. Of the 168 candidates declared significant by Gardina <italic>et al.</italic> (<xref ref-type="bibr" rid="B18">18</xref>), 95 belong to this ‘multi-isoform set’ and shall be referred to as the ‘Gardina subset’. Out of the set of 16 genes positively validated by RT-PCR, 15 belong to the ‘multi-isoform set’ (all except LGR5, which Ensembl currently lists as producing only one isoform) and shall be referred to as the ‘RT-PCR validated subset’.</p>
        <p>In order to compare results per gene, we consider the quantity <italic>p</italic><sub><italic>g</italic></sub> defined in the Dectecting differential splicing section. <xref ref-type="fig" rid="F10">Figure 10</xref> shows a histogram of <italic>p</italic><sub><italic>g</italic></sub>, for the ‘multi-isoform set’ (that is, all genes that MMBGX declares to be expressing more than one transcript, whether differentially spliced or not). Also shown are the two subsets: the ‘Gardina subset’ and the ‘RT-PCR validated subset’. The genes in the ‘Gardina subset’ tend to have higher values of <italic>p</italic><sub><italic>g</italic></sub> than the ‘multi-isoform set’ as a whole, showing that genes declared significant in the Gardina workflow will also tend to be declared significant by MMBGX. Note, however, that the ‘Gardina subset’ includes many events that tested negative by RT-PCR. The ‘RT-PCR validated subset’ of genes tend to have an even higher value of <italic>p</italic><sub><italic>g</italic></sub> than the ‘Gardina subset’, showing that MMBGX agrees even better with the validated RT-PCR results.
<fig id="F10" position="float"><label>Figure 10.</label><caption><p>Barplot of the probability of differential transcript use, <italic>p</italic><sub><italic>g</italic></sub>, for genes in the ‘multi-isoform set’, the ‘Gardina subset’ and the ‘RT-PCR validated subset’. Genes in the ‘Gardina subset’ tend to have a higher value of <italic>p</italic><sub><italic>g</italic></sub> than the ‘multi-isoform set’ as a whole. The ‘RT-PCR validated subset’ of genes tend to have even higher values of <italic>p</italic><sub><italic>g</italic></sub> than the ‘Gardina subset’.</p></caption><graphic xlink:href="gkp853f10"/></fig></p>
      </sec>
      <sec sec-type="results">
        <title>Comparison between MMBGX and the RT-PCR results of the Gardina data set</title>
        <p>We further present a more detailed comparison of the MMBGX and RT-PCR results, working at the transcript level, as MMBGX is designed to do. Gel images were provided in Gardina <italic>et al.</italic>, for 12 of the 16 positively validated genes (the nine validated genes from the Gardina workflow that the authors considered to be convincing and three additional validated genes that had been previously reported). Amongst the 12 genes, there are 27 gel bands. Each band corresponds to the inclusion or exclusion of a set of exons and the flanking primers. In order to compare with the MMBGX results, we have to find the groups of transcripts which contain or skip that exon, and also contain the flanking exons targeted by the primers. Hence, for each gel band we have a group of one or more corresponding transcripts.</p>
        <p>MMBGX provides a richer level of output than exon-level methods. Many genes have several transcripts containing a particular exon but differing at other sites. MMBGX is able to distinguish between these transcripts.</p>
        <p>For example, <xref ref-type="fig" rid="F11">Figure 11</xref> shows the posterior densities of the MMBGX log expression measure of three ATP2B4 transcripts in the normal and tumour conditions. Transcripts ENST00000391954 and ENST00000341360 include exon 21 and are down-regulated in the tumour samples, while transcript ENST00000357681 skips exon 21 and is up-regulated. This is consistent with the gel image, which shows less brightness of the band corresponding to inclusion of exon 21 in the tumour samples and vice versa for the band corresponding to exclusion of exon 21. Moreover, we can tell from the shape and support of the density plots that the signal observed in the shorter gel band is dominated by the expression of ENST00000341360 rather than ENST00000391954, illustrating the richness of information provided by the MMBGX output. This kind of information cannot be obtained using exon-level statistics such as the Splicing Index, as they do not discriminate between transcripts that share a significant differentially spliced exon.
<fig id="F11" position="float"><label>Figure 11.</label><caption><p>Densities of the posterior probabilities of log expression for three ATP2B4 transcript variants are shown. The two transcripts that include exon 21 are down-regulated in the tumour samples, while the transcript that skips exon 21 is up-regulated in the tumour samples. This corresponds to evidence from RT-PCR validations, where the band that includes exon 21 is brighter in the tumour samples than in the normal samples and <italic>vice versa</italic> for the band that excludes exon 21 [image taken from (<xref ref-type="bibr" rid="B18">18</xref>)].</p></caption><graphic xlink:href="gkp853f11"/></fig></p>
        <p><xref ref-type="table" rid="T1">Table 1</xref> shows the 27 gel bands and transcript groups for these 12 genes. Also shown is the direction of the relative expression change indicated by MMBGX and RT-PCR. For the RT-PCR, Δ<sub>GEL</sub> is defined for each gel band: −, 0 or + for decrease, no change and increase, respectively, in the tumour samples. For MMBGX, there is a measure per transcript, with Δ<sub>MMBGX</sub> = + indicating <italic>p</italic><sub><italic>t</italic></sub> &lt; 0.5 and Δ<sub>MMBGX</sub> = − indicating <italic>p</italic><sub><italic>t</italic></sub> &gt; 0.5). The table includes <inline-formula><inline-graphic xlink:href="gkp853i8.jpg"/></inline-formula>. Large values of this quantity indicate that MMBGX considers transcript <italic>t</italic> to be differentially spliced with high probability (subject to filtering). The table also indicates whether or not each transcript is filtered according to the criterion in the ‘Decting differential splicing’ section. In order to assess the agreement between MMBGX and the RT-PCR results, we give a label to each gel band. Where Δ<sub>GEL</sub> is either + or −, if all non-filtered transcripts have the correct sign of Δ<sub>MMBGX</sub> and at least one is significant, we label the agreement as ‘good’. If all non-filtered transcripts have the wrong sign of Δ<sub>MMBGX</sub> and at least one is significant, we label the agreement as ‘contradictory’. If none of the transcripts are significant, we label the agreement as ‘non-significant’. If significant transcripts corresponding to the same band have different Δ<sub>MMBGX</sub>, the band is labelled ‘inconclusive’. Finally, where Δ<sub>GEL</sub> = 0, the agreement is labelled as ‘good’ only if all transcripts are not significant. These labels are given in the last column of <xref ref-type="table" rid="T1">Table 1</xref>.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>MMBGX results for all the Ensembl transcripts targeted by the RT-PCR experiments for which gel images are available in Gardina <italic>et al.</italic></p></caption><table frame="hsides" rules="groups"><tr><td rowspan="1" colspan="1"><inline-graphic xlink:href="gkp853i11.jpg"/></td></tr></table><table-wrap-foot><fn><p>For each gene, two or more gel bands are listed. Each band matches a set of Ensembl transcripts for which various MMBGX results are shown. The fourth column shows whether there is agreement in the relative direction of change in transcript use between MMBGX and the gel image. The fifth column gives the probability of differential transcript use, while the sixth column gives the fold change for each transcript. Transcripts with predicted expression close to zero in both conditions are marked as filtered. The concordance between the MMBGX results and the RT-PCR validation is shown in the right-most column. Genes above the thick line were significant in the Gardina workflow, while genes below it were not.</p></fn></table-wrap-foot></table-wrap></p>
        <p>Altogether, 24 bands were scored by us. The MMBGX results for 10 bands agreed well with the RT-PCR, 9 were non-significant, 3 were inconclusive and 2 were contradictory. Three of the bands did not match any transcripts listed on the Ensembl database. Only the MMBGX results for two of the bands, both relating to ITGB4, contradicted the RT-PCR validation in direction of change. Note that the Gardina workflow did not pick up ITGB4 as a candidate for differential splicing since it was part of the eight previously reported genes (cf. <xref ref-type="fig" rid="F12">Figure 12</xref>), suggesting that the microarray data contradicts the RT-PCR data for this gene.
<fig id="F12" position="float"><label>Figure 12.</label><caption><p>A schematic of the MMBGX validation of the colon cancer data set and its comparison to the Gardina workflow. Out of 168 genes in the Gardina workflow, 42 were validated by RT-PCR as were an additional eight genes picked because they had been reported in previous studies. Gel bands for 12 positively validated genes were provided by Gardina <italic>et al.</italic>, nine from their workflow and three from previous studies. The MMBGX and Gardina workflow results for the 12 positively validated genes and 34 negatively validated genes are shown.</p></caption><graphic xlink:href="gkp853f12"/></fig></p>
        <p>Out of the 50 genes tested, 34 produced negative RT-PCR results for differential splicing. Of these, 17 genes had incompatible Ensembl annotation. These probesets either mapped to an intron, an exon shared by all transcripts of a gene, a gene with only one isoform, a promoter exon or a poly-A termination exon. As such, these events could not be incorrectly called by MMBGX, illustrating one of the strengths of restricting the search to known isoforms. Out of the remaining 17 genes, only three, FAM44B, GBA and CDH11 were declared significant by MMBGX. However, in the case of CDH11 the significant result was due to only a small difference in the up-regulation of the two alternative isoforms (FC of 1.55 for ENST00000268603 and FC of 1.21 for ENST00000268602). This is shown in detail in <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Table S1</ext-link>.</p>
      </sec>
      <sec>
        <title>Comparison between MMBGX, COSIE and FIRMA</title>
        <p>Finally, we analysed the data set using two recent exon-level methods, COSIE (<xref ref-type="bibr" rid="B19">19</xref>) and FIRMA (<xref ref-type="bibr" rid="B9">9</xref>), which have been shown to improve upon the original Splicing Index. We obtained COSIE presplicing indices and FIRMA scores for each exon-level probeset and calculated the <italic>P</italic>-values for a difference in means using paired <italic>t</italic>-tests. For each method, we estimated two thresholds for the <italic>P</italic>-values based on a false discovery rate (FDR) of 0.2 and 0.3 using Storey's; method (<xref ref-type="bibr" rid="B20">20</xref>). For each of the 12 positively validated genes for which gel images were provided, we checked whether the exon-probesets targeting the validated differentially spliced exons had <italic>P</italic>-values below the threshold. If so, the genes were declared true positives, otherwise they were declared false negatives. For the 36 negatively validated genes, we counted those with any probeset <italic>P</italic>-value below the threshold as false positives and the others as true negatives. From the results in <xref ref-type="fig" rid="F11">Figure 12</xref>, we can see that in terms of the true negatives, COSIE and FIRMA gave equivalent results but that COSIE performed slightly better for detecting true positives. MMBGX outperformed both in terms of power, finding 7 out of the 12 positively validated genes, whereas for a similar level of false positives, COSIE only found 3. These results are shown in detail in <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Tables S2 and S3</ext-link>.</p>
        <p>To summarize, amongst the 46 genes tested by RT-PCR (the 12 positives where a gel image was provided and the 34 negatives), 38 MMBGX results agreed and 6 disagreed (where a gene with a ‘good’ result and no ‘contradictory’ results counts as an agreement), giving an error rate of 0.14. The Gardina workflow method agreed on 14 genes and disagreed on 32, giving an error rate of 0.73. Hence, the MMBGX results are much more consistent with the RT-PCR results, despite the fact that the candidates for RT-PCR testing were chosen on the basis of the Gardina workflow method. MMBGX also outperformed COSIE, which had an error rate of 0.26 (FDR &lt; 0.2) and 0.50 (FDR &lt; 0.3) and FIRMA, which had an error rate of 0.28 (FDR &lt; 0.2) and 0.54 (FDR &lt; 0.3). These results are shown in <xref ref-type="fig" rid="F12">Figure 12</xref>.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>DISCUSSION</title>
    <sec>
      <title>Non-specific hybridization and probe-affinity effects</title>
      <p>Our model treats non-specific hybridization at the probe level as exchangeable within groups of probes with similar GC content. Each GC content category <italic>k</italic>( <italic>j</italic> ) captures probe <italic>j</italic>'s affinity effect through the means and variances of the log-scale background intensities, <inline-formula><inline-graphic xlink:href="gkp853i9.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="gkp853i10.jpg"/></inline-formula>. However, it has been shown—albeit in the case of RNA–DNA hybridizations on 3′ chips—that probe affinity effects depend not only on overall GC content but also on the precise positioning of each of the bases on an oligonucleotide (<xref ref-type="bibr" rid="B1">1</xref>). If a different predictor of affinity than GC content is preferred, it can be incorporated into MMBGX by binning the background probes according to this predictor and mapping the PM's; to the appropriate bin. Therefore, while in this article we used Affymetrix's; simple GC content-based scheme, more sophisticated schemes can be integrated into the models in a straightforward way.</p>
      <p>Sequence-specific effects in Affymetrix microarrays have to date been modelled as part of the background noise by exploiting information in the MM probes on 3′-arrays or the background probes on whole-transcript arrays (e.g. GCRMA, PLIER, MMBGX). However, it is reasonable to assume that these effects apply not only to the non-specific hybridization component of the probe intensities, but also to the signal component. Some methods have included multiplicative probe effects (e.g. RMA) to account for systematic effects between probes, but these do not use the sequence information for each probe. In future work, we aim to refine our method by incorporating GC-specific affinity effects in the modelling of the probe-level signal as well as the non-specific hybridization.</p>
    </sec>
    <sec>
      <title>Reliance on comprehensive transcript annotation</title>
      <p>Transcript-level analysis relies on the comprehensiveness of the annotations used. If a transcript is highly abundant in a sample but is not targeted by a specific probeset, the signal from a different but similar transcript may be overestimated, yielding a false positive. In cases where an unknown real transcript is highly abundant in a sample and contains all the exons in a smaller Ensembl transcript, the Ensembl transcript acts as an unbiased proxy for the real transcript. Conversely, if an Ensembl transcript is more extensive than a real, unknown and highly abundant transcript, the Ensembl transcript acts as a downward-biased proxy due to its inclusion of unexpressed exons. Therefore, it is advisable to use MMBGX in conjunction with an effective exon-level method, such as COSIE, to ensure that novel events are not missed. At the time of writing, the human and mouse Exon arrays were found to target 52 743 and 40 420 Ensembl transcripts, respectively, and newly verified transcripts are being added on a regular basis. Thus, with each revision of Ensembl, the chance of being confounded by an unknown transcript is reduced. The rat genome, with only 34 006 known transcripts, has been less extensively annotated, so caution should be exercised when interpreting MMBGX results from rat data. Naturally, alternative sources of annotation may be used to construct the MMBGX probe–probeset structure files and interrogate a more extensive, although possibly less established, set of transcripts.</p>
    </sec>
    <sec sec-type="methods">
      <title>Comparison to methods for custom-built junction arrays and tiling arrays</title>
      <p>Other methods have been developed that rely on custom-built arrays with junction probes and cannot straightforwardly be applied to Exon arrays. GenASAP estimates the expression of alternative isoforms uniquely distinguishable by inclusion or exclusion of a single predefined cassette exon (<xref ref-type="bibr" rid="B21">21</xref>). DECONV, like MMBGX, tries to disaggregate the signal at probes targeting multiple transcripts but requires arrays specifically designed to capture predefined gene structures (<xref ref-type="bibr" rid="B22">22</xref>). The principal advantage of using Exon arrays and MMBGX relative to custom junction arrays and these approaches is that, as improved transcript annotation becomes available, MMBGX may be incorporated into a re-analysis of the data without needing to redesign the array and repeat the experiment. More recently, ahierarchical Bayesian model (<xref ref-type="bibr" rid="B23">23</xref>) has been proposed to estimate isoform expression using tiling arrays. A very large number of arrays (91 in the case of 5-bp offsets along the human genome) are required for a single sample, however, which may make the approach impractical.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>CONCLUSION</title>
    <p>We have presented a fully hierarchical Bayesian model to estimate expression values from whole-transcript GeneChip microarrays. It is, to our knowledge, the first method to use the multi-mapping structure between probes and probesets to split the expression signal in a logical way and to model Exon array data at the transcript rather than the gene or exon level. MMBGX uses the rich transcriptional annotation on the Ensembl databases to detect and quantify the expression of alternative splice variants. With successive Ensembl releases, predictions can be updated and improved accordingly. Given the established importance of alternative splicing to the proteome (<xref ref-type="bibr" rid="B24">24</xref>), we hope that MMBGX will prove useful in characterizing the roles of alternative isoforms in different tissues and species during normal development and in disease.</p>
  </sec>
  <sec>
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkp853/DC1">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p>EU (grant FP6-36495); BBSRC (grants BBG0003521 and BBC5196701). Funding for open access charge: BBSRC.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>[Supplementary Data]</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="gkp853_index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="gkp853_1.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We would like to thank William Astle for valuable discussions, Tim Yates for help using the X:Map database and the reviewers for their constructive comments.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Naef</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Magnasco</surname>
            <given-names>MO</given-names>
          </name>
        </person-group>
        <article-title>Solving the riddle of the bright mismatches: labeling and effective binding in oligonucleotide arrays</article-title>
        <source>Phys. Rev. E Stat. Nonlin. Soft Matter Phys.</source>
        <year>2003</year>
        <volume>68</volume>
        <issue>Pt 1</issue>
        <fpage>011906</fpage>
        <pub-id pub-id-type="pmid">12935175</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Martinez-Murillo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Spencer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>A model-based background adjustment for oligonucleotide expression arrays</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>2004</year>
        <volume>99</volume>
        <fpage>909</fpage>
        <lpage>917</lpage>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turro</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bochkina</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hein</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>BGX: a Bioconductor package for the Bayesian integrated analysis of Affymetrix GeneChips</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>439</fpage>
        <pub-id pub-id-type="pmid">17997843</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <collab>Affymetrix, Inc</collab>
        <article-title>Affymetrix GeneChip Exon Array Design</article-title>
        <source>Technical report</source>
        <year>2005</year>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://www.affymetrix.com/support/technical/technotes/exon_array_design_technote.pdf">http://www.affymetrix.com/support/technical/technotes/exon_array_design_technote.pdf</ext-link>
        </comment>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <collab>Affymetrix, Inc</collab>
        <article-title>Affymetrix Guide to Probe Logarithmic Intensity Error (PLIER) Estimation</article-title>
        <source>Technical report</source>
        <year>2005</year>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://www.affymetrix.com/support/technical/technotes/plier_technote.pdf">http://www.affymetrix.com/support/ technical/technotes/plier_technote.pdf</ext-link>
        </comment>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <collab>Affymetrix Inc</collab>
        <article-title>Affymetrix Exon Array Background Correction</article-title>
        <source>Technical report</source>
        <year>2005</year>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://www.affymetrix.com/support/technical/whitepapers/exon_background_correction_whitepaper.pdf">http://www.affymetrix.com/support/technical/whitepapers/exon_ background_correction_whitepaper.pdf</ext-link>
        </comment>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clark</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Schweitzer</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>TX</given-names>
          </name>
          <name>
            <surname>Staples</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Blume</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>Discovery of tissue-specific exons using comprehensive human exon microarrays</article-title>
        <source>Genome Biol.</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R64</fpage>
        <pub-id pub-id-type="pmid">17456239</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <collab>Affymetrix Inc</collab>
        <article-title>Affymetrix Alternative Transcript Analysis Methods for Exon Arrays</article-title>
        <source>Technical report</source>
        <year>2005</year>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://www.affymetrix.com/support/technical/whitepapers/exon_alt_transcript_analysis_whitepaper.pdf">http://www.affymetrix.com/support/technical/whitepapers/exon_alt_ transcript_analysis_whitepaper.pdf</ext-link>
        </comment>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Purdom</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Conboy</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Lapuk</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>FIRMA: a method for detection of alternative splicing from exon array data</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>1707</fpage>
        <lpage>1714</lpage>
        <pub-id pub-id-type="pmid">18573797</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frigessi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>van deWiel</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Holden</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Svendsrud</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Glad</surname>
            <given-names>IK</given-names>
          </name>
          <name>
            <surname>Lyng</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide estimation of transcript concentrations from spotted cDNA microarray data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>e143</fpage>
        <pub-id pub-id-type="pmid">16204447</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hein</surname>
            <given-names>AMK</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Causton</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Ambler</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>BGX: a fully Bayesian integrated approach to the analysis of Affymetrix GeneChip data</article-title>
        <source>Biostatistics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>349</fpage>
        <lpage>373</lpage>
        <pub-id pub-id-type="pmid">15831583</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Flicek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Aken</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Beal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ballester</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Caccamo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Coates</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cunningham</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cutts</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl 2008</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>D707</fpage>
        <lpage>D714</lpage>
        <pub-id pub-id-type="pmid">18000006</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hein</surname>
            <given-names>AMK</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A powerful method for detecting differentially expressed genes from genechip arrays that does not require replicates</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>353</fpage>
        <pub-id pub-id-type="pmid">16857053</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>GO</given-names>
          </name>
          <name>
            <surname>Rosenthal</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Examples of Adaptive MCMC</article-title>
        <year>2006</year>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://www.probability.ca/jeff/ftpdir/adaptex.pdf">http://www.probability.ca/jeff/ftpdir/adaptex.pdf</ext-link>
        </comment>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yates</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Okoniewski</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>X:map: annotation and visualization of genome structure for Affymetrix exon array analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>D780</fpage>
        <lpage>D786</lpage>
        <pub-id pub-id-type="pmid">17932061</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolstad</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Astrand</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>A comparison of normalization methods for high density oligonucleotide array data based on variance and bias</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>185</fpage>
        <lpage>193</lpage>
        <pub-id pub-id-type="pmid">12538238</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Hobbs</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Collin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beazer-Barclay</surname>
            <given-names>YD</given-names>
          </name>
          <name>
            <surname>Antonellis</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Scherf</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Exploration, normalization, and summaries of high density oligonucleotide array probe level data</article-title>
        <source>Biostatistics</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>249</fpage>
        <lpage>264</lpage>
        <pub-id pub-id-type="pmid">12925520</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardina</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Shimada</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Staples</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Veitch</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schweitzer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Awad</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sugnet</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dee</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Alternative splicing and differential gene expression in colon cancer detected by a whole genome exon array</article-title>
        <source>BMC Genomics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>325</fpage>
        <pub-id pub-id-type="pmid">17192196</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaidatzis</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jacobeit</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Oakeley</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Overestimation of alternative splicing caused by variable probe characteristics in exon arrays</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <comment>10.1093/nar/gkp508 [Epub ahead of print]</comment>
      </element-citation>
    </ref>
    <ref id="B20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>A direct approach to false discovery rates</article-title>
        <source>J. Roy. Stat. Soc. Ser. B (Stat. Methodol.)</source>
        <year>2002</year>
        <volume>64</volume>
        <fpage>479</fpage>
        <lpage>498</lpage>
      </element-citation>
    </ref>
    <ref id="B21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shai</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>QD</given-names>
          </name>
          <name>
            <surname>Blencowe</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Frey</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Inferring global levels of alternative splicing isoforms using a generative model of microarray data</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>606</fpage>
        <lpage>613</lpage>
        <pub-id pub-id-type="pmid">16403798</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hubbell</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cline</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Siani-Rose</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Ares</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kulp</surname>
            <given-names>DC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene structure-based splice variant deconvolution using a microarray platform</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <issue>Suppl 1</issue>
        <fpage>i315</fpage>
        <lpage>i322</lpage>
        <pub-id pub-id-type="pmid">12855476</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>A hierarchical bayesian model for comparing transcriptomes at the individual transcript isoform level</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>e75</fpage>
        <pub-id pub-id-type="pmid">19417075</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garcia-Blanco</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Baraniak</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Lasda</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>Alternative splicing in disease and therapy</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2004</year>
        <volume>22</volume>
        <fpage>535</fpage>
        <lpage>546</lpage>
        <pub-id pub-id-type="pmid">15122293</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
