<?DTDIdentifier.IdentifierValue http://www.biomedcentral.com/xml/article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4074385</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-15-182</article-id>
    <article-id pub-id-type="pmid">24925680</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-15-182</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Skewer: a fast and accurate adapter trimmer for next-generation sequencing paired-end reads</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Jiang</surname>
          <given-names>Hongshan</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>hongshan.jiang@gmail.com</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Lei</surname>
          <given-names>Rong</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>leirong2009@gmail.com</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Ding</surname>
          <given-names>Shou-Wei</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>shou-wei.ding@ucr.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Zhu</surname>
          <given-names>Shuifang</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>zhushf@netchina.com.cn</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Institute of Plant Quarantine Research, Chinese Academy of Inspection and Quarantine, Huixinli 241, Beijing, 100029 China</aff>
    <aff id="I2"><label>2</label>Department of Plant Pathology and Microbiology and Institute for Integrative Biology, University of California, Riverside, 900 University Ave, 92521 Riverside, USA</aff>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <volume>15</volume>
    <fpage>182</fpage>
    <lpage>182</lpage>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>3</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>6</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2014 Jiang et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Jiang et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/15/182"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Adapter trimming is a prerequisite step for analyzing next-generation sequencing (NGS) data when the reads are longer than the target DNA/RNA fragments. Although typically used in small RNA sequencing, adapter trimming is also used widely in other applications, such as genome DNA sequencing and transcriptome RNA/cDNA sequencing, where fragments shorter than a read are sometimes obtained because of the limitations of NGS protocols. For the newly emerged Nextera long mate-pair (LMP) protocol, junction adapters are located in the middle of all properly constructed fragments; hence, adapter trimming is essential to gain the correct paired reads. However, our investigations have shown that few adapter trimming tools meet both efficiency and accuracy requirements simultaneously. The performances of these tools can be even worse for paired-end and/or mate-pair sequencing.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>To improve the efficiency of adapter trimming, we devised a novel algorithm, the <italic>bit-masked k-difference matching algorithm</italic>, which has <italic>O</italic>(<italic>k</italic><italic>n</italic>) expected time with <italic>O</italic>(<italic>m</italic>) space, where <italic>k</italic> is the maximum number of differences allowed, <italic>n</italic> is the read length, and <italic>m</italic> is the adapter length. This algorithm makes it possible to fully enumerate all candidates that meet a specified threshold, e.g. error ratio, within a short period of time. To improve the accuracy of this algorithm, we designed a simple and easy-to-explain statistical scoring scheme to evaluate candidates in the pattern matching step. We also devised scoring schemes to fully exploit the paired-end/mate-pair information when it is applicable. All these features have been implemented in an industry-standard tool named <italic>Skewer</italic> (<ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/skewer">https://sourceforge.net/projects/skewer</ext-link>). Experiments on simulated data, real data of small RNA sequencing, paired-end RNA sequencing, and Nextera LMP sequencing showed that <italic>Skewer</italic> outperforms all other similar tools that have the same utility. Further, <italic>Skewer</italic> is considerably faster than other tools that have comparative accuracies; namely, one times faster for single-end sequencing, more than 12 times faster for paired-end sequencing, and 49% faster for LMP sequencing.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p><italic>Skewer</italic> achieved as yet unmatched accuracies for adapter trimming with low time bound.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Next generation sequencing</kwd>
      <kwd>Adapter trimming</kwd>
      <kwd>Approximate string matching</kwd>
      <kwd>Local sequence alignment</kwd>
      <kwd>Barcode demultiplexing</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Adapter sequences are short oligonucleotides used to be ligated to the ends of DNA fragments of interest, so that they can be combined with primers for amplification. When the sequencing read length is greater than that of the target DNA, the adapter sequence is read out, sometimes partially, next to the unknown target DNA sequence. To recover the target DNA sequence, it is essential to identify the adapter sequence and trim it.</p>
    <p>Adapter trimming was first used in small RNA (sRNA) sequencing, where typical lengths of the target fragments range from 18 nucleotides (nt) to 30 nt, while the typical read length is 36 nt. Another important application for adapter trimming is DNase-Seq, which is a high-resolution technique used to profile hypersensitive sites that are frequently bound by transcription factors. Recent studies showed that the sequencing of short reads (50–100 base pairs (bp)) gives better results [<xref ref-type="bibr" rid="B1">1</xref>].</p>
    <p>For all the next-generation sequencing (NGS) applications including chromosomal DNA sequencing or complementary DNA (cDNA) sequencing, double-stranded DNA is first fragmented using nebulization or ultrasonics to obtain lengths of several hundreds bp. The ends of the fragments are then repaired and ligated with adapters. After purification, the adapter-ligated fragments are either poured on slides/chips as water-in-oils or attached to flow-cells for cluster generation. After several cycles of emulsion-PCR or bridge-PCR, the amplified templates are ready for sequencing. Fragmentation is a stochastic process that is influenced by the varied force field and thermodynamic stability of different parts of the sequence; e.g. parts with different GC content. To improve the enrichment rate and to cover the target genome or transcriptome more evenly, the sample preparation protocol usually requires fragments to be enriched in a specified length range. Even when longer average fragment lengths are chosen, the inherent nature of fragment size selection cannot always prevent short fragments and primer-dimmers from going on to the next stage. Therefore, there are nearly always reads that need to be trimmed. For the newly emerged Nextera long mate-pair (LMP) protocol, junction adapters that connect paired target fragments exist in all properly constructed fragments; thus, adapter trimming is essential to gain correct paired reads.</p>
    <p>Adapter trimming is different from contaminant removal and is usually associated with NGS protocols where adapters are synthesized and specified by the reagent vendors. Given a known adapter pattern and a read sequence, adapter trimming is usually modeled as a semi-global sequence alignment, also called end-space free alignment, where any space at the end of or beginning of the alignment does not incur penalties.</p>
    <p>Semi-global sequence alignment can be performed using the <italic>Smith-Waterman</italic> algorithm [<xref ref-type="bibr" rid="B2">2</xref>] with minor revisions of the boundary condition as implemented in <italic>Cutadapt</italic>[<xref ref-type="bibr" rid="B3">3</xref>], which has a time complexity of <italic>O</italic>(<italic>m</italic><italic>n</italic>), where <italic>m</italic> is the pattern length, and <italic>n</italic> is the sequence length. A trickier solution, i.e. Ukkonen’s algorithm for <italic>k</italic>-difference matching [<xref ref-type="bibr" rid="B4">4</xref>], has an expected time of <italic>O</italic>(<italic>k</italic><italic>n</italic>), where <italic>k</italic>&lt;<italic>m</italic> is the maximum number of differences allowed. Further improvements in Ukkonen’s algorithm by bitwise parallelism were proposed by Myer [<xref ref-type="bibr" rid="B5">5</xref>] and implemented in Btrim [<xref ref-type="bibr" rid="B6">6</xref>], which has a time complexity of <italic>O</italic>(<italic>m</italic><italic>n</italic>/<italic>w</italic>), where <italic>w</italic> is the word length of the computer; e.g. <italic>w</italic> equals 64 for a 64-bit machine. In practice, Myer’s bit-vector dynamic programming algorithm is the fastest <italic>k</italic>-difference matching algorithm currently available. However, Myer’s algorithm is more appropriate for searching patterns in text and is difficult to adapt to deal with sequencing quality values in NGS data.</p>
    <p>Other popular adapter trimmers are available; e.g. <italic>Fastx_clipper</italic> in the <italic>FastX-Toolkit</italic> (<ext-link ext-link-type="uri" xlink:href="http://hannonlab.cshl.edu/fastx_toolkit/">http://hannonlab.cshl.edu/fastx_toolkit/</ext-link>), <italic>SeqTrim</italic> (<ext-link ext-link-type="uri" xlink:href="https://github.com/dariogf/SeqtrimNext">https://github.com/dariogf/SeqtrimNext</ext-link>) [<xref ref-type="bibr" rid="B7">7</xref>], <italic>TagCleaner</italic>[<xref ref-type="bibr" rid="B8">8</xref>], and <italic>EA-Tools</italic> (<ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/ea-utils/">http://code.google.com/p/ea-utils/</ext-link>). Recently published trimmers are: <italic>SeqPrep</italic> (<ext-link ext-link-type="uri" xlink:href="https://github.com/jstjohn/SeqPrep">https://github.com/jstjohn/SeqPrep</ext-link>) which focuses on paired-end (PE) reads; <italic>Flexbar</italic>[<xref ref-type="bibr" rid="B9">9</xref>], a flexible barcode demultiplexer that uses the <italic>Needleman-Wunsch</italic> algorithm [<xref ref-type="bibr" rid="B10">10</xref>] for pair-wise global sequence alignments, which has the same time complexity as that of <italic>Smith-Waterman</italic> algorithm; <italic>Trimmomatic</italic> (<ext-link ext-link-type="uri" xlink:href="http://www.usadellab.org/cms/index.php?page=trimmomatic">http://www.usadellab.org/cms/index.php?page=trimmomatic</ext-link>), which is a part of an integrated tool <italic>RobiNA</italic>[<xref ref-type="bibr" rid="B11">11</xref>]; <italic>Scythe</italic> (<ext-link ext-link-type="uri" xlink:href="https://github.com/vsbuffalo/scythe">https://github.com/vsbuffalo/scythe</ext-link>), which uses a Naive Bayesian approach to classify contaminants in reads; <italic>TrimGalore</italic> (<ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.babraham.ac.uk/projects/trim_galore/">http://www.bioinformatics.babraham.ac.uk/projects/trim_galore/</ext-link>), which internally invokes <italic>Cutadapt</italic> with an extension to handle PE reads; <italic>AdapterRemoval</italic>[<xref ref-type="bibr" rid="B12">12</xref>], which is carefully tuned for trimming adapters from both single-end (SE) or PE reads; <italic>AlienTrimmer</italic>[<xref ref-type="bibr" rid="B13">13</xref>], which is based on <italic>k</italic>-mer decomposition for contaminant detection; and <italic>NextClip</italic>[<xref ref-type="bibr" rid="B14">14</xref>], which is dedicated to trimming adapters within Nextera LMP reads.</p>
    <p>For sRNA sequencing data, a simple script can handle the adapter trimming task with acceptable accuracy and speed. However, trimming adapter sequences from genome sequencing data requires tools that are much more efficient, because the volume of data is much larger. Some very fast tools such as <italic>Btrim</italic> and <italic>Trimmomatic</italic> tend to over-simplify the underlying model. <italic>Btrim</italic> neglects the quality values associated with base calls for adapter trimming although it does use quality values for quality trimming [<xref ref-type="bibr" rid="B6">6</xref>]. <italic>Trimmomatic</italic> adopts a hash-based search followed by a simple score-based search, both of which neglect insertions and deletions for adapter matching (<ext-link ext-link-type="uri" xlink:href="http://www.usadellab.org/cms/index.php?page=trimmomatic">http://www.usadellab.org/cms/index.php?page=trimmomatic</ext-link>). To gain sufficient accuracy, most of the adaptor trimming algorithms use conventional pair-wise alignment algorithms such as the <italic>Smith-Waterman</italic> or <italic>Needleman-Wunsch</italic> algorithms; however, these alignment algorithms are inefficient for adapter trimming compared with more sophisticated algorithms [<xref ref-type="bibr" rid="B5">5</xref>].</p>
    <p>In a typical application of adapter trimming, e.g. for sRNA sequencing, usually only a short prefix of the full-length adapter is scanned to reduce run time. However, this strategy may increase the possibility of random hits and cause biases in the trimmed sequences. Even when the specified pattern is of sufficient length, for reads where the 3’ end overlaps with a short prefix of the adaptor pattern, it is hard to judge whether the overlap is from finding the adapter sequence or from sequence homology. On the one hand, over-trimming of a bona fide part of the sequence causes loss of information; on the other hand, leaving an adapter untrimmed causes noise in the downstream analysis.</p>
    <p>In this paper, we propose a <italic>bit-masked k-difference matching</italic> dynamic programming algorithm with <italic>O</italic>(<italic>k</italic><italic>n</italic>) expected time and <italic>O</italic>(<italic>m</italic>) space in which the information within the adapter sequences is transferred into bits. We developed a carefully designed statistical scheme that incorporates quality values (and PE information when applicable), and implemented an industry-standard Linux program called <italic>Skewer</italic> to address the trimming problem accurately and efficiently.</p>
  </sec>
  <sec>
    <title>Results and discussions</title>
    <sec>
      <title>Features</title>
      <p>The algorithm and statistical scoring schemes are implemented as a Linux program <italic>Skewer</italic> using C++. A comparison of the main features of <italic>Skewer</italic> with those of existing mainstream adapter trimmers are presented in Table <xref ref-type="table" rid="T1">1</xref>.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Main features of various adapter trimmers</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left"> </th>
              <th colspan="4" align="center">
                <bold>Adapter trimming</bold>
              </th>
              <th align="left"> </th>
              <th align="left"> </th>
              <th colspan="2" align="center">
                <bold>Quality control</bold>
              </th>
              <th colspan="4" align="center">
                <bold>Other</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">
                <bold>Method</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>5’</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>3’</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>SE</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>PE</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>LMP</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Multi</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Ns</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Q</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Barcode</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Merge</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>gzip Files</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>MT</bold>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left" valign="bottom">FastX<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">SeqTrim<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">TagCleaner<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">EA-Tools<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Cutadapt<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">TrimGalore<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">SeqPrep<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Btrim<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Scythe<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Flexbar<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Trimmomatic<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">AdapterRemoval<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">AlienTrimmer<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">NextClip<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">○<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
              <td align="center" valign="bottom">×<hr/></td>
            </tr>
            <tr>
              <td align="left">Skewer</td>
              <td align="center">○</td>
              <td align="center">○</td>
              <td align="center">○</td>
              <td align="center">○</td>
              <td align="center">○</td>
              <td align="center">○</td>
              <td align="center">○</td>
              <td align="center">○</td>
              <td align="center">○</td>
              <td align="center">×</td>
              <td align="center">○</td>
              <td align="center">○</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>For each method, the table shows if it is able to: i) identify adapters in the 5’ end of reads, ii) identify adapters in the 3’ end of reads, iii) process single-end (SE) reads, iv) process paired-end (PE) reads, v) process Nextera long mate-pair (LMP) reads, vi) search for multiple different adapters (Multi), vii) trim subsequences of multiple degenerative characters (Ns), viii) trim low-quality nucleotides (Q), ix) separate multiplexed reads based on barcodes, x) merge overlapped pairs into longer single-end reads, xi) process gzip files directly, and xii) run with multiple threads simultaneously (MT). (○: Yes; ×: No).</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Experiment environment</title>
      <p>The server that was used for the experiments had 4 × 8-core Intel®; 2.67GHz CPUs, 1T memory, and RAID with bandwidths of 266MB/s and 262MB/s for reading and writing respectively. The operating system (OS) was the <italic>Red Hat Enterprise Linux Server release 6.3</italic>.</p>
    </sec>
    <sec>
      <title>Experiments on simulated data</title>
      <sec>
        <title>General information</title>
        <p>We simulated 10 million 100 bp + 100 bp PE Solexa reads from the <italic>Arabidopsis thaliana</italic> genome using ART, a NGS read simulator [<xref ref-type="bibr" rid="B15">15</xref>], with some revision on the source codes for simulating adapter-contaminated reads (<ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/skewer/files/Simulator/">http://sourceforge.net/projects/skewer/files/Simulator/</ext-link>). The trained profile was from the real sequencing data of <italic>A. thaliana</italic> where about 36% of the reads were contaminated with adapters. We compared <italic>Skewer</italic> with mainstream adapter trimmers that can handle PE reads as well as four representative adapter trimmers that can handle only SE reads.</p>
        <p>To assess trimming quality, we defined the following metrics: <italic>FP</italic> (<italic>false positive</italic>) as the number of reads that were over-trimmed, either for trimming non-contaminant reads (<italic>false trimming</italic>), noted as <italic>F</italic><italic>P</italic>_<italic>f</italic><italic>t</italic>, or for <italic>over-trimming</italic> contaminant reads, noted as <italic>F</italic><italic>P</italic>_<italic>o</italic><italic>t</italic>; <italic>FN</italic> (<italic>false negative</italic>) as the number of reads that were under-trimmed, either for not trimming contaminant reads (<italic>false retaining</italic>), noted as <italic>F</italic><italic>N</italic>_<italic>f</italic><italic>r</italic>, or <italic>under-trimming</italic> contaminant reads, noted as <italic>F</italic><italic>N</italic>_<italic>u</italic><italic>t</italic>; and <italic>TN</italic> (<italic>true negative</italic>) as the number of untrimmed non-contaminant reads.</p>
        <p>From these numbers, we defined the <italic>positive predictive value</italic> (PPV) as the ratio of the number of correctly trimmed reads to the number of trimmed reads; <italic>sensitivity</italic> (Sen) as the ratio of the number of correctly trimmed reads to the number of contaminant reads; and <italic>specificity</italic> (Spec) as the ratio of the number of untrimmed non-contaminant reads to the number of non-contaminant reads as follows: </p>
        <p>
          <disp-formula id="bmcM1">
            <label>(1)</label>
            <mml:math id="M1" name="1471-2105-15-182-i1" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mtext mathvariant="italic">PPV</mml:mtext>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mtext mathvariant="italic">TP</mml:mtext>
                    <mml:mo>/</mml:mo>
                    <mml:mo>(</mml:mo>
                    <mml:mtext mathvariant="italic">TP</mml:mtext>
                    <mml:mo>+</mml:mo>
                    <mml:mtext mathvariant="italic">FP</mml:mtext>
                    <mml:mo>_</mml:mo>
                    <mml:mtext mathvariant="italic">ft</mml:mtext>
                    <mml:mo>+</mml:mo>
                    <mml:mtext mathvariant="italic">FP</mml:mtext>
                    <mml:mo>_</mml:mo>
                    <mml:mtext mathvariant="italic">ot</mml:mtext>
                    <mml:mo>+</mml:mo>
                    <mml:mtext mathvariant="italic">FN</mml:mtext>
                    <mml:mo>_</mml:mo>
                    <mml:mtext mathvariant="italic">ut</mml:mtext>
                    <mml:mo>)</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="bmcM2">
            <label>(2)</label>
            <mml:math id="M2" name="1471-2105-15-182-i2" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mtext mathvariant="italic">Sen</mml:mtext>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mtext mathvariant="italic">TP</mml:mtext>
                    <mml:mo>/</mml:mo>
                    <mml:mo>(</mml:mo>
                    <mml:mtext mathvariant="italic">TP</mml:mtext>
                    <mml:mo>+</mml:mo>
                    <mml:mtext mathvariant="italic">FN</mml:mtext>
                    <mml:mo>_</mml:mo>
                    <mml:mtext mathvariant="italic">fr</mml:mtext>
                    <mml:mo>+</mml:mo>
                    <mml:mtext mathvariant="italic">FN</mml:mtext>
                    <mml:mo>_</mml:mo>
                    <mml:mtext mathvariant="italic">ut</mml:mtext>
                    <mml:mo>+</mml:mo>
                    <mml:mtext mathvariant="italic">FP</mml:mtext>
                    <mml:mo>_</mml:mo>
                    <mml:mtext mathvariant="italic">ot</mml:mtext>
                    <mml:mo>)</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="bmcM3">
            <label>(3)</label>
            <mml:math id="M3" name="1471-2105-15-182-i3" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mtext mathvariant="italic">Spec</mml:mtext>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mtext mathvariant="italic">TN</mml:mtext>
                    <mml:mo>/</mml:mo>
                    <mml:mo>(</mml:mo>
                    <mml:mtext mathvariant="italic">TN</mml:mtext>
                    <mml:mo>+</mml:mo>
                    <mml:mtext mathvariant="italic">FP</mml:mtext>
                    <mml:mo>_</mml:mo>
                    <mml:mtext mathvariant="italic">ft</mml:mtext>
                    <mml:mo>)</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>Finally, we defined the <italic>Matthew’s correlation coefficient</italic> (mCC), which is a quality measure for pattern recognition, as: </p>
        <p>
          <disp-formula id="bmcM4">
            <label>(4)</label>
            <mml:math id="M4" name="1471-2105-15-182-i4" overflow="scroll">
              <mml:mspace width="0.3em"/>
              <mml:mspace width="0.3em"/>
              <mml:mspace width="0.3em"/>
              <mml:mspace width="0.3em"/>
              <mml:mtext mathvariant="italic">mCC</mml:mtext>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mtext mathvariant="italic">TP</mml:mtext>
                  <mml:mo>·</mml:mo>
                  <mml:mtext mathvariant="italic">TN</mml:mtext>
                  <mml:mo>−</mml:mo>
                  <mml:mtext mathvariant="italic">FP</mml:mtext>
                  <mml:mo>·</mml:mo>
                  <mml:mtext mathvariant="italic">FN</mml:mtext>
                </mml:mrow>
                <mml:mrow>
                  <mml:msqrt>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mtext mathvariant="italic">TP</mml:mtext>
                      <mml:mo>+</mml:mo>
                      <mml:mtext mathvariant="italic">FP</mml:mtext>
                      <mml:mo>)</mml:mo>
                      <mml:mo>(</mml:mo>
                      <mml:mtext mathvariant="italic">TP</mml:mtext>
                      <mml:mo>+</mml:mo>
                      <mml:mtext mathvariant="italic">FN</mml:mtext>
                      <mml:mo>)</mml:mo>
                      <mml:mo>(</mml:mo>
                      <mml:mtext mathvariant="italic">TN</mml:mtext>
                      <mml:mo>+</mml:mo>
                      <mml:mtext mathvariant="italic">FP</mml:mtext>
                      <mml:mo>)</mml:mo>
                      <mml:mo>(</mml:mo>
                      <mml:mtext mathvariant="italic">TN</mml:mtext>
                      <mml:mo>+</mml:mo>
                      <mml:mtext mathvariant="italic">FN</mml:mtext>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:msqrt>
                </mml:mrow>
              </mml:mfrac>
            </mml:math>
          </disp-formula>
        </p>
      </sec>
      <sec>
        <title>Primary result</title>
        <p>Each method was run with its default parameters, except that the minimum output fragment length and the thread number (if applied) were set to 1.</p>
        <p>The results obtained from these runs are listed in Table <xref ref-type="table" rid="T2">2</xref> and details are available in Table S1 of Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>. <italic>FastX</italic>, an earlier and widely adopted NGS adapter trimmer, had a relatively low <italic>mCC</italic> (0.6683) and a low processing speed (0.92<italic>M</italic><italic>b</italic><italic>p</italic>/<italic>s</italic>); <italic>SeqTrim</italic> had a similar overall performance as <italic>FastX</italic> (0.6618), but it had the slowest processing speed (0.03<italic>M</italic><italic>b</italic><italic>p</italic>/<italic>s</italic>) of all the trimmers tested despite its extensive logging utility; <italic>TagCleaner</italic> was clearly the most conservative of the trimmers (<italic>F</italic><italic>P</italic>=0), but it had the lowest sensitivity (45.50<italic>%</italic>) and was notably slower than <italic>FastX</italic> (58.7<italic>%</italic> of the speed); <italic>EA-Tools</italic> had the highest sensitivity (99.72<italic>%</italic>) for processing SE reads and was orders of magnitude faster (13<italic>X</italic>∼400<italic>X</italic>) than the slow trimmers; <italic>Cutadapt</italic>, the most widely accepted adapter trimmer, exhibited a good compromise between sensitivity and specificity (96.27<italic>%</italic> vs. 96.93<italic>%</italic>), and had the highest <italic>mCC</italic> (0.9286) among the existing tools for processing SE reads; <italic>TrimGalore</italic>, a wrapper for <italic>Cutadapt</italic>, had a performance that was equivalent to <italic>EA-tools</italic> with default settings, but it was considerably slower than <italic>EA-tools</italic> (28.2<italic>%</italic>∼31.6<italic>%</italic> of the speed); <italic>SeqPrep</italic>, a dedicated PE reads adapter trimmer and merger, had the highest <italic>mCC</italic> (0.9975) among the existing tools for processing PE reads, but it was slow (0.64<italic>M</italic><italic>b</italic><italic>p</italic>/<italic>s</italic>); <italic>Btrim</italic> had the highest speed (23.63<italic>M</italic><italic>b</italic><italic>p</italic>/<italic>s</italic>) for adapter trimming, but it had low sensitivity (53.44<italic>%</italic>); <italic>Scythe</italic> had an <italic>mCC</italic> similar to that of <italic>Cutadapt</italic> for SE reads adapter trimming, but was more conservative; <italic>Flexbar</italic> had slightly lower metrics and about 20% lower processing speed than <italic>TrimGalore</italic>; <italic>Trimmomatic</italic> was among the most conservative ones, but it had an acceptable sensitivity (72.31<italic>%</italic>) and a relatively high speed (16.73<italic>M</italic><italic>b</italic><italic>p</italic>/<italic>s</italic>); <italic>AlienTrimmer</italic> had similar metrics to <italic>Btrim</italic>, but was much slower (1.64<italic>M</italic><italic>b</italic><italic>p</italic>/<italic>s</italic>); and <italic>AdapterRemoval</italic> had a similar overall performance as <italic>SeqPrep</italic> for PE reads processing, but unlike <italic>SeqPrep</italic> it can also handle SE reads.</p>
        <table-wrap position="float" id="T2">
          <label>Table 2</label>
          <caption>
            <p>Performance of adapter trimmers on 2Gbp simulated data</p>
          </caption>
          <table frame="hsides" rules="groups" border="1">
            <colgroup>
              <col align="left"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
            </colgroup>
            <thead valign="top">
              <tr>
                <th colspan="2" align="center">
                  <bold>Method (Single End/Paired End)</bold>
                </th>
                <th align="right">
                  <bold>Speed (Mbp/s)</bold>
                </th>
                <th align="right">
                  <bold>Memory (Mb)</bold>
                </th>
                <th align="right">
                  <bold>PPV (%)</bold>
                </th>
                <th align="right">
                  <bold>Sen. (%)</bold>
                </th>
                <th align="right">
                  <bold>Spec. (%)</bold>
                </th>
                <th align="right">
                  <bold>mCC</bold>
                </th>
              </tr>
            </thead>
            <tbody valign="top">
              <tr>
                <td align="left" valign="bottom">FastX<hr/></td>
                <td align="right" valign="bottom">SE<hr/></td>
                <td align="right" valign="bottom">0.92<hr/></td>
                <td align="right" valign="bottom">13.8<hr/></td>
                <td align="right" valign="bottom">68.90<hr/></td>
                <td align="right" valign="bottom">90.84<hr/></td>
                <td align="right" valign="bottom">77.97<hr/></td>
                <td align="right" valign="bottom">0.6683<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">SeqTrim<hr/></td>
                <td align="right" valign="bottom">SE<hr/></td>
                <td align="right" valign="bottom">0.03<hr/></td>
                <td align="right" valign="bottom">115.7<hr/></td>
                <td align="right" valign="bottom">67.07<hr/></td>
                <td align="right" valign="bottom">85.27<hr/></td>
                <td align="right" valign="bottom">81.24<hr/></td>
                <td align="right" valign="bottom">0.6618<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">TagCleaner<hr/></td>
                <td align="right" valign="bottom">SE<hr/></td>
                <td align="right" valign="bottom">0.54<hr/></td>
                <td align="right" valign="bottom">37.6<hr/></td>
                <td align="right" valign="bottom">100.0<hr/></td>
                <td align="right" valign="bottom">45.50<hr/></td>
                <td align="right" valign="bottom">100.0<hr/></td>
                <td align="right" valign="bottom">0.5898<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">EA-Tools<hr/></td>
                <td align="right" valign="bottom">SE<hr/></td>
                <td align="right" valign="bottom">12.04<hr/></td>
                <td align="right" valign="bottom">17.7<hr/></td>
                <td align="right" valign="bottom">59.24<hr/></td>
                <td align="right" valign="bottom">99.72<hr/></td>
                <td align="right" valign="bottom">61.32<hr/></td>
                <td align="right" valign="bottom">0.6010<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="right" valign="bottom">PE<hr/></td>
                <td align="right" valign="bottom">11.54<hr/></td>
                <td align="right" valign="bottom">30.0<hr/></td>
                <td align="right" valign="bottom">59.16<hr/></td>
                <td align="right" valign="bottom">99.43<hr/></td>
                <td align="right" valign="bottom">61.36<hr/></td>
                <td align="right" valign="bottom">0.5983<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">Cutadapt<hr/></td>
                <td align="right" valign="bottom">SE<hr/></td>
                <td align="right" valign="bottom">4.36<hr/></td>
                <td align="right" valign="bottom">34.5<hr/></td>
                <td align="right" valign="bottom">94.55<hr/></td>
                <td align="right" valign="bottom">96.27<hr/></td>
                <td align="right" valign="bottom">96.93<hr/></td>
                <td align="right" valign="bottom">0.9286<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="right" valign="bottom">PE<hr/></td>
                <td align="right" valign="bottom">3.44<hr/></td>
                <td align="right" valign="bottom">42.8<hr/></td>
                <td align="right" valign="bottom">94.55<hr/></td>
                <td align="right" valign="bottom">96.00<hr/></td>
                <td align="right" valign="bottom">96.93<hr/></td>
                <td align="right" valign="bottom">0.9266<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">TrimGalore<hr/></td>
                <td align="right" valign="bottom">SE<hr/></td>
                <td align="right" valign="bottom">3.81<hr/></td>
                <td align="right" valign="bottom">19.4<hr/></td>
                <td align="right" valign="bottom">59.24<hr/></td>
                <td align="right" valign="bottom">99.72<hr/></td>
                <td align="right" valign="bottom">61.32<hr/></td>
                <td align="right" valign="bottom">0.6010<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="right" valign="bottom">PE<hr/></td>
                <td align="right" valign="bottom">3.26<hr/></td>
                <td align="right" valign="bottom">19.6<hr/></td>
                <td align="right" valign="bottom">59.16<hr/></td>
                <td align="right" valign="bottom">99.44<hr/></td>
                <td align="right" valign="bottom">61.36<hr/></td>
                <td align="right" valign="bottom">0.5984<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">SeqPrep<hr/></td>
                <td align="right" valign="bottom">PE<hr/></td>
                <td align="right" valign="bottom">0.64<hr/></td>
                <td align="right" valign="bottom">22.0<hr/></td>
                <td align="right" valign="bottom">99.84<hr/></td>
                <td align="right" valign="bottom">99.82<hr/></td>
                <td align="right" valign="bottom">99.92<hr/></td>
                <td align="right" valign="bottom">0.9975<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">Btrim<hr/></td>
                <td align="right" valign="bottom">SE<hr/></td>
                <td align="right" valign="bottom">23.63<hr/></td>
                <td align="right" valign="bottom">11.2<hr/></td>
                <td align="right" valign="bottom">99.96<hr/></td>
                <td align="right" valign="bottom">53.44<hr/></td>
                <td align="right" valign="bottom">100.0<hr/></td>
                <td align="right" valign="bottom">0.6503<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="right" valign="bottom">PE<hr/></td>
                <td align="right" valign="bottom">5.79<hr/></td>
                <td align="right" valign="bottom">15.3<hr/></td>
                <td align="right" valign="bottom">99.89<hr/></td>
                <td align="right" valign="bottom">53.30<hr/></td>
                <td align="right" valign="bottom">100.0<hr/></td>
                <td align="right" valign="bottom">0.6490<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">Scythe<hr/></td>
                <td align="right" valign="bottom">SE<hr/></td>
                <td align="right" valign="bottom">3.15<hr/></td>
                <td align="right" valign="bottom">11.2<hr/></td>
                <td align="right" valign="bottom">99.56<hr/></td>
                <td align="right" valign="bottom">90.86<hr/></td>
                <td align="right" valign="bottom">99.92<hr/></td>
                <td align="right" valign="bottom">0.9283<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">Flexbar<hr/></td>
                <td align="right" valign="bottom">SE<hr/></td>
                <td align="right" valign="bottom">2.82<hr/></td>
                <td align="right" valign="bottom">9.5<hr/></td>
                <td align="right" valign="bottom">57.90<hr/></td>
                <td align="right" valign="bottom">99.12<hr/></td>
                <td align="right" valign="bottom">59.48<hr/></td>
                <td align="right" valign="bottom">0.5814<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="right" valign="bottom">PE<hr/></td>
                <td align="right" valign="bottom">2.70<hr/></td>
                <td align="right" valign="bottom">9.7<hr/></td>
                <td align="right" valign="bottom">57.77<hr/></td>
                <td align="right" valign="bottom">99.09<hr/></td>
                <td align="right" valign="bottom">59.29<hr/></td>
                <td align="right" valign="bottom">0.5795<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">Trimmomatic<hr/></td>
                <td align="right" valign="bottom">SE<hr/></td>
                <td align="right" valign="bottom">16.73<hr/></td>
                <td align="right" valign="bottom">2593.0<hr/></td>
                <td align="right" valign="bottom">99.99<hr/></td>
                <td align="right" valign="bottom">72.31<hr/></td>
                <td align="right" valign="bottom">100.0<hr/></td>
                <td align="right" valign="bottom">0.7907<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="right" valign="bottom">PE<hr/></td>
                <td align="right" valign="bottom">16.40<hr/></td>
                <td align="right" valign="bottom">2292.0<hr/></td>
                <td align="right" valign="bottom">100.0<hr/></td>
                <td align="right" valign="bottom">71.54<hr/></td>
                <td align="right" valign="bottom">100.0<hr/></td>
                <td align="right" valign="bottom">0.7850<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">AdapterRemoval<hr/></td>
                <td align="right" valign="bottom">SE<hr/></td>
                <td align="right" valign="bottom">1.67<hr/></td>
                <td align="right" valign="bottom">6.3<hr/></td>
                <td align="right" valign="bottom">75.09<hr/></td>
                <td align="right" valign="bottom">97.74<hr/></td>
                <td align="right" valign="bottom">81.89<hr/></td>
                <td align="right" valign="bottom">0.7675<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="right" valign="bottom">PE<hr/></td>
                <td align="right" valign="bottom">0.73<hr/></td>
                <td align="right" valign="bottom">8.3<hr/></td>
                <td align="right" valign="bottom">99.93<hr/></td>
                <td align="right" valign="bottom">94.47<hr/></td>
                <td align="right" valign="bottom">99.97<hr/></td>
                <td align="right" valign="bottom">0.9566<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">AlienTrimmer<hr/></td>
                <td align="right" valign="bottom">SE<hr/></td>
                <td align="right" valign="bottom">1.64<hr/></td>
                <td align="right" valign="bottom">2319.9<hr/></td>
                <td align="right" valign="bottom">85.62<hr/></td>
                <td align="right" valign="bottom">57.11<hr/></td>
                <td align="right" valign="bottom">99.96<hr/></td>
                <td align="right" valign="bottom">0.6769<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="right" valign="bottom">PE<hr/></td>
                <td align="right" valign="bottom">1.61<hr/></td>
                <td align="right" valign="bottom">2248.9<hr/></td>
                <td align="right" valign="bottom">83.71<hr/></td>
                <td align="right" valign="bottom">55.67<hr/></td>
                <td align="right" valign="bottom">99.95<hr/></td>
                <td align="right" valign="bottom">0.6659<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">Skewer<hr/></td>
                <td align="right" valign="bottom">SE<hr/></td>
                <td align="right" valign="bottom">8.79<hr/></td>
                <td align="right" valign="bottom">13.6<hr/></td>
                <td align="right" valign="bottom">94.56<hr/></td>
                <td align="right" valign="bottom">96.32<hr/></td>
                <td align="right" valign="bottom">96.93<hr/></td>
                <td align="right" valign="bottom">0.9291<hr/></td>
              </tr>
              <tr>
                <td align="left"> </td>
                <td align="right">PE</td>
                <td align="right">8.88</td>
                <td align="right">22.2</td>
                <td align="right">100.0</td>
                <td align="right">99.86</td>
                <td align="right">100.0</td>
                <td align="right">0.9989</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>Methods that process only single-end (SE) or paired-end (PE) reads are indicated.</p>
          </table-wrap-foot>
        </table-wrap>
        <p>The results of the runs listed in Table <xref ref-type="table" rid="T2">2</xref> show that <italic>Skewer</italic> outperformed all the mainstream tools in terms of <italic>mCC</italic> for both SE and PE trimming (0.9291 and 0.9989 respectively), although <italic>Skewer</italic> was only marginally better than <italic>Cutadapt</italic> and <italic>Scythe</italic> in SE trimming. Furthermore, <italic>Skewer</italic> was substantially faster (one times faster for SE and more than 12 times faster for PE trimming) than the tools that had comparative performances.</p>
        <p><italic>Trimmomatic</italic> and <italic>AlienTrimmer</italic> both used above 2<italic>G</italic> bytes peak memory. Most of the other trimmers used less than 50<italic>M</italic> bytes memory except <italic>SeqTrim</italic>, which used 115.7<italic>M</italic> bytes. Although <italic>Skewer</italic> did not have the least memory usage, its memory consumption (less than 35<italic>M</italic> bytes, see Table S2 of Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> for details) was far from a bottleneck on a 64-bit computer. In fact, <italic>Skewer</italic> uses additional memory to facilitate the processing of IUPAC (International Union of Pure and Applied Chemistry) characters and for parallel computing.</p>
      </sec>
      <sec>
        <title>Scalability for parallel computing</title>
        <p>We ran various adapter trimmers that support multi-threading to compare their scalability under a parallel computing environment. <italic>SeqTrim</italic> was excluded because it is too slow to gain comparative speed even with tens of threads. In addition, <italic>Cutadapt</italic>, <italic>AdapterRemoval</italic>, and other tools were not included because they currently lack a multi-threading function. In the eight threads case, for both the uncompressed and compressed inputs, <italic>Skewer</italic> achieved the highest speedup among the adapter trimmers tested (7.87 for uncompressed input, and 4.54 for compressed input) (see Table S2 of Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> for details).</p>
      </sec>
      <sec>
        <title>Receiver operating characteristic (ROC) curves</title>
        <p>ROC curves for various adapter trimmers under different stringencies were plotted and are shown in Figure <xref ref-type="fig" rid="F1">1</xref> and Figure <xref ref-type="fig" rid="F2">2</xref> (see Table S3 of Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> for details).</p>
        <fig id="F1" position="float">
          <label>Figure 1</label>
          <caption>
            <p><bold>ROC curves of various adapter trimmers for processing single-end reads of simulated data.</bold> ROC: receiver operating characteristic.</p>
          </caption>
          <graphic xlink:href="1471-2105-15-182-1"/>
        </fig>
        <fig id="F2" position="float">
          <label>Figure 2</label>
          <caption>
            <p><bold>ROC curves of various adapter trimmers for processing paired-end reads of simulated data.</bold> ROC: receiver operating characteristic.</p>
          </caption>
          <graphic xlink:href="1471-2105-15-182-2"/>
        </fig>
        <p>In high stringency (left) regions, both <italic>Trimmomatic</italic> and <italic>Cutadapt</italic> performed well in that they had low FPRs (false positive rates) and high TPRs (true positive rates); however, as the stringency decreases, both their performance degrade gradually (Figure <xref ref-type="fig" rid="F1">1</xref>). A similar trend was seen for <italic>TrimGalore</italic> where the ROC curve shifted to the upper-right region. This implies that these trimmers greedily picked up the first candidate that met the stringency rather than select the optimal one. The ROC curve for <italic>AlienTrimmer</italic> was similar to the above ones, but with a worse performance. <italic>FastX</italic> may adopt some optimization technique, however, its performance was worse than those of <italic>Trimmomatic</italic> and <italic>Cutadapt</italic> within all the stringency range. Other adapter trimmers showed advantages on a specific metric; e.g. <italic>AdapterRemoval</italic>, <italic>Flexbar</italic>, and <italic>EA-Tools</italic> were the most sensitive, while <italic>TagCleaner</italic>, <italic>Btrim</italic>, and <italic>Scythe</italic> were the most conservative. <italic>SeqTrim</italic> appeared only as a dot in the ROC curves plot, because it does not provide a stringency threshold. <italic>Skewer</italic> outperformed the other adapter trimmers in that it had the least FPR to gain a specific TPR, when TPR &gt; 95%.</p>
        <p>ROC curves for the adapter trimmers that are aware of PE information were plotted and are shown in Figure <xref ref-type="fig" rid="F2">2</xref>. Other trimmers that can process PE reads have worse ROC curves than corresponding ROC curves for processing SE reads since the second reads usually have lower sequencing qualities. From Figure <xref ref-type="fig" rid="F2">2</xref>, we can see that <italic>Skewer</italic> had a nearly perfect ROC curve close to the upper-left corner. For example, it achieved a TPR of 99.951% with a FPR of 0.001%.</p>
      </sec>
    </sec>
    <sec>
      <title>Experiments on real data</title>
      <sec>
        <title>sRNA sequencing data for <italic>Caenorhabditis elegans</italic></title>
        <p>A recently published real sRNA data set (short read archive [SRA:SRR014966]) [<xref ref-type="bibr" rid="B16">16</xref>], which includes 14,251,981 reads of small non-coding RNA (ncRNA) from <italic>C. elegans</italic>, was used to evaluate the adapter trimmers. Because it is hard to recover all the underlying sRNA fragments for sequencing, we aligned the trimmed reads to the reference genome and used delta of the number of uniquely aligned reads relative to the number of uniquely aligned raw reads, noted as <italic>TT</italic> (<italic>true trimming</italic>), as a substitute for <italic>true positive</italic>. We also used delta of number of non-uniquely aligned reads relative to the number of non-uniquely aligned raw reads, noted as <italic>FT</italic> (<italic>false trimming</italic>), as a substitute for <italic>false positive</italic>. The rationale was that correct-trimming tends to change unaligned fragments to uniquely aligned fragments (<italic>true positive</italic>), while over-trimming tends to change uniquely aligned fragments to non-uniquely aligned fragments (<italic>false positive</italic>). Note that these metrics tolerate tiny mistakes that can be rescued by the alignment software and are useful for practical evaluation.</p>
        <p>To evaluate the performances under various trimming stringencies, all the tools were used to trim adapter sequences from the <italic>C. elegans</italic> data set using various trimming stringency. Next the processed reads were aligned to the <italic>C. elegans</italic> genome [<xref ref-type="bibr" rid="B17">17</xref>] (version 10) using Bowtie2 [<xref ref-type="bibr" rid="B18">18</xref>] (version 2.1.0). We then used the above metrics for final plotting, with higher <italic>FT</italic> representing lower stringency.</p>
        <p>The results are presented in Table S4 and Table S5 of Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>, and illustrated in Figure <xref ref-type="fig" rid="F3">3</xref>. <italic>AdapterRemoval</italic> and <italic>Flexbar</italic> exhibited similar performance curves, while <italic>AdapterRemoval</italic> was slightly better than <italic>Flexbar</italic> within all the tested stringency range; and <italic>TrimGalore</italic> and <italic>Cutadapt</italic> had similar curves, while <italic>TrimGalore</italic> was slightly better than <italic>Cutadapt</italic> at all the stringencies. Under high stringency, <italic>EA-Tools</italic>, <italic>Skewer</italic>, and <italic>TrimGalore</italic> shared the first rank in terms of low <italic>FT</italic> and high <italic>TT</italic>; <italic>Trimmomatic</italic>, <italic>AdapterRemoval</italic>, and <italic>Schythe</italic> were ranked second under middle stringency, middle low stringency, and low stringency respectively; and <italic>Skewer</italic> ranked first at all the stringencies.</p>
        <fig id="F3" position="float">
          <label>Figure 3</label>
          <caption>
            <p>Performance of various adapter trimmers on real small RNA data [SRA:SRR014966].</p>
          </caption>
          <graphic xlink:href="1471-2105-15-182-3"/>
        </fig>
      </sec>
      <sec>
        <title>Paired-end RNA sequencing data for <italic>Drosophila simulans</italic></title>
        <p>A real RNA-Seq data set with 27,005,344 pairs of 101 bp reads (short read archive [SRA:SRR330569]) from the gonads and carcasses of <italic>D. simulans</italic> was used to compare the performances of the adapter trimmers in trimming artificial contaminants from PE reads.</p>
        <p>For the evaluation, we first used each of the tools that can deal with PE reads with default setting to trim adapters from the reads, with the exception that the minimum output fragment length was set to 20 and quality trimming was inhibited. We then used TopHat [<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B20">20</xref>] (version 2.0.10) to align the processed reads to the reference genome of <italic>D. simulans</italic>[<xref ref-type="bibr" rid="B21">21</xref>] (dsim revision 1.4). Finally the number of uniquely and concordantly aligned pairs was used as the performance metrics.</p>
        <p>The results are presented in Table S6 of Additional file <xref ref-type="supplementary-material" rid="S3">3</xref> and illustrated in Figure <xref ref-type="fig" rid="F4">4</xref>. <italic>Skewer</italic> outperformed the other adapter trimmers in terms of the number of uniquely and concordantly aligned pairs of the trimmed PE reads. <italic>Trimmomatic</italic> and <italic>AdapterRemoval</italic>, both of which performed well in processing the sRNA data, performed poorly in processing the long PE data. This finding implies that these tools may be tuned specifically for trimming adapters from sRNA data. Similarly, <italic>Btrim</italic> also performed less well with the PE data in this experiment. After investigating the processed data, we found that <italic>Btrim</italic> could recognize only the occurrence of the whole adapter sequence with a limited tolerance for insertions and deletions. It should be noted that all quality trimming was inhibited from these experiments to compare the adapter trimming performance alone. However, in real applications, quality trimming, which is outside of the scope of this paper, has been reported to improve the mapping rate and facilitate downstream data analysis [<xref ref-type="bibr" rid="B22">22</xref>].</p>
        <fig id="F4" position="float">
          <label>Figure 4</label>
          <caption>
            <p>Performance of various adapter trimmers on real paired-end data [SRA:SRR330569].</p>
          </caption>
          <graphic xlink:href="1471-2105-15-182-4"/>
        </fig>
      </sec>
      <sec>
        <title>Nextera long mate pair (LMP) data for <italic>Arabidopsis thaliana</italic></title>
        <p>A 5-kb insert size Nextera LMP library of <italic>A. thaliana</italic> Col-0 with 6,602,426 pairs of 251bp reads (European Nucleotide Archive [ENA:ERA264981]) and a 400-bp insert size Illumina HiSeq PE library of the same species with 17,341,797 pairs of 100 bp reads [ENA:SRR519624] were sequenced previously and used to demonstrate the utility of NextClip [<xref ref-type="bibr" rid="B14">14</xref>], a dedicated tool for trimming adapters from Nextera LMP libraries.</p>
        <p>To compare <italic>Skewer</italic> with NextClip, we followed a validation procedure similar to the one described for NextClip [<xref ref-type="bibr" rid="B14">14</xref>]. Briefly, the LMP library was first trimmed using the adaptor trimmer. Then the trimmed LMP reads and the PE reads were de novo assembled using ABySS [<xref ref-type="bibr" rid="B23">23</xref>]. The time needed for the adapter trimming and the N50 lengths of the scaffolds were used as the metrics for the evaluation.</p>
        <p>The result is listed in Table <xref ref-type="table" rid="T3">3</xref> (see Additional file <xref ref-type="supplementary-material" rid="S4">4</xref> for relevant commands in detail), from which we can see that Skewer marginally outperforms NextClip in terms of assembly statistics (N50 length etc.) of the trimmed reads. In addition, Skewer is about 49% faster than NextClip in single thread mode.</p>
        <table-wrap position="float" id="T3">
          <label>Table 3</label>
          <caption>
            <p>Comparison of NextClip and Skewer in processing Nextera long mate-pair (LMP) reads (ERA264981)</p>
          </caption>
          <table frame="hsides" rules="groups" border="1">
            <colgroup>
              <col align="left"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
            </colgroup>
            <thead valign="top">
              <tr>
                <th align="left" valign="bottom">
                  <bold>Reads for scaffolding</bold>
                  <hr/>
                </th>
                <th align="center" valign="bottom">
                  <bold>Time for trimming adapters from Nextera LMP library (s)</bold>
                  <hr/>
                </th>
                <th colspan="3" align="center" valign="bottom">
                  <bold>Assembly</bold>
                  <hr/>
                </th>
              </tr>
              <tr>
                <th align="left"> </th>
                <th align="center"> </th>
                <th align="right">
                  <bold>Pieces</bold>
                </th>
                <th align="right">
                  <bold>N50 length</bold>
                </th>
                <th align="right">
                  <bold>Total length (Mbp)</bold>
                </th>
              </tr>
            </thead>
            <tbody valign="top">
              <tr>
                <td align="left" valign="bottom">None<hr/></td>
                <td align="center" valign="bottom">N/A<hr/></td>
                <td align="right" valign="bottom">14097<hr/></td>
                <td align="right" valign="bottom">19150<hr/></td>
                <td align="right" valign="bottom">105.80<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">Paired end (PE) only<hr/></td>
                <td align="center" valign="bottom">N/A<hr/></td>
                <td align="right" valign="bottom">11781<hr/></td>
                <td align="right" valign="bottom">23496<hr/></td>
                <td align="right" valign="bottom">104.84<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">PE and NextClip processed<hr/></td>
                <td align="center" valign="bottom">1480.39<hr/></td>
                <td align="right" valign="bottom">6080<hr/></td>
                <td align="right" valign="bottom">309342<hr/></td>
                <td align="right" valign="bottom">111.55<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">PE and Skewer processed<hr/></td>
                <td align="center" valign="bottom">993.49 (single thread)<hr/></td>
                <td align="right" valign="bottom">5806<hr/></td>
                <td align="right" valign="bottom">312317<hr/></td>
                <td align="right" valign="bottom">112.52<hr/></td>
              </tr>
              <tr>
                <td align="left"> </td>
                <td align="center">155.96 (8 threads)</td>
                <td align="center"> </td>
                <td align="center"> </td>
                <td align="center"> </td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>We presented a novel algorithm and applied it to adapter trimming. The inherent advantage of the proposed <italic>bit-masked k-difference matching</italic> dynamic programming algorithm makes it possible to search adapter sequence pattern in an exhaustive yet efficient manner. Moreover, by using carefully designed scoring schemes for adapter pattern matching in both SE and PE sequencing data, the resultant <italic>Skewer</italic> tool was shown to achieve accuracies that were not matched by other similar tools that are currently available. Importantly, <italic>Skewer</italic> was not optimized for specific applications (e.g. sRNA sequencing); however, compared with other adapter trimmers, it performed well over all NGS applications.</p>
    <p>Read lengths and throughputs of NGS technologies are likely to keep increasing; therefore, efficient and accurate adapter trimming methods will continue to be important in the preprocessing steps in applications such as genome resequencing, de novo sequencing, transcriptome sequencing, as well as sRNA sequencing.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Problem definition</title>
      <sec>
        <title>Notation</title>
        <p>The <italic>Levenshtein distance</italic> between two strings <italic>A</italic>=<italic>a</italic><sub>1</sub><italic>a</italic><sub>2</sub>… <italic>a</italic><sub>|<italic>A</italic>|</sub>, <italic>B</italic>=<italic>b</italic><sub>1</sub><italic>b</italic><sub>2</sub>…<italic>b</italic><sub>|<italic>B</italic>|</sub>, noted as ∥<italic>A</italic>,<italic>B</italic>∥<sub><italic>l</italic><italic>e</italic><italic>v</italic></sub>, is given by a recursive formula (assuming |<italic>A</italic>|&gt;0,|<italic>B</italic>|&gt;0): </p>
        <p>
          <disp-formula>
            <mml:math id="M5" name="1471-2105-15-182-i5" overflow="scroll">
              <mml:mrow>
                <mml:mspace width="-15.0pt"/>
                <mml:msub>
                  <mml:mrow>
                    <mml:mfenced open="∥" close="∥">
                      <mml:mrow>
                        <mml:mi>A</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>B</mml:mi>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext mathvariant="italic">lev</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mspace width="0.3em"/>
                <mml:mo>:</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mtext mathvariant="italic">min</mml:mtext>
                <mml:mspace width="0.3em"/>
                <mml:mfenced open="{">
                  <mml:mrow>
                    <mml:mspace width="0.3em"/>
                    <mml:mspace width="0.3em"/>
                    <mml:mspace width="0.3em"/>
                    <mml:mtable class="array" columnalign="left">
                      <mml:mtr>
                        <mml:mtd>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mfenced open="∥" close="∥">
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>a</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>a</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>…</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>a</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>|</mml:mo>
                                      <mml:mi>A</mml:mi>
                                      <mml:mo>|</mml:mo>
                                      <mml:mo>−</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>,</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>b</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>b</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>…</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>b</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>|</mml:mo>
                                      <mml:mi>B</mml:mi>
                                      <mml:mo>|</mml:mo>
                                      <mml:mo>−</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext mathvariant="italic">lev</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>+</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>δ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>a</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>|</mml:mo>
                                  <mml:mi>A</mml:mi>
                                  <mml:mo>|</mml:mo>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>b</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>|</mml:mo>
                                  <mml:mi>B</mml:mi>
                                  <mml:mo>|</mml:mo>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mfenced open="∥" close="∥">
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>a</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>a</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>…</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>a</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>|</mml:mo>
                                      <mml:mi>A</mml:mi>
                                      <mml:mo>|</mml:mo>
                                      <mml:mo>−</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>B</mml:mi>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext mathvariant="italic">lev</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mfenced open="∥" close="∥">
                                <mml:mrow>
                                  <mml:mi>A</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>b</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>b</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>…</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>b</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>|</mml:mo>
                                      <mml:mi>B</mml:mi>
                                      <mml:mo>|</mml:mo>
                                      <mml:mo>−</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext mathvariant="italic">lev</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mfenced>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p> where <italic>δ</italic><sub><italic>a</italic>,<italic>b</italic></sub>=1 if <italic>a</italic>≠<italic>b</italic>, otherwise <italic>δ</italic><sub><italic>a</italic>,<italic>b</italic></sub>=0. When <italic>m</italic><italic>i</italic><italic>n</italic>(|<italic>A</italic>|,|<italic>B</italic>|)=0, ∥<italic>A</italic>,<italic>B</italic>∥<sub><italic>l</italic><italic>e</italic><italic>v</italic></sub>:=<italic>m</italic><italic>a</italic><italic>x</italic>(|<italic>A</italic>|,|<italic>B</italic>|).</p>
      </sec>
      <sec>
        <title><italic>k</italic>-difference problem</title>
        <p>Given a sequence <italic>S</italic>=<italic>s</italic><sub>1</sub><italic>s</italic><sub>2</sub>…<italic>s</italic><sub><italic>n</italic></sub>, a query pattern <italic>P</italic>=<italic>p</italic><sub>1</sub><italic>p</italic><sub>2</sub>…<italic>p</italic><sub><italic>m</italic></sub>, and a threshold <italic>k</italic>(0≤<italic>k</italic>&lt;<italic>m</italic>), search all substrings of <italic>S</italic>, noted as {<italic>P</italic><sup>′</sup>}, such that ∥<italic>P</italic><sup>′</sup>,<italic>P</italic>∥<sub><italic>l</italic><italic>e</italic><italic>v</italic></sub>≤<italic>k</italic>.</p>
      </sec>
      <sec>
        <title>Extended <italic>k</italic>-difference problem</title>
        <p>Given a sequence <italic>S</italic>=<italic>s</italic><sub>1</sub><italic>s</italic><sub>2</sub>…<italic>s</italic><sub><italic>n</italic></sub>, a query pattern <italic>P</italic>=<italic>p</italic><sub>1</sub><italic>p</italic><sub>2</sub>…<italic>p</italic><sub><italic>m</italic></sub>, and a threshold <italic>e</italic>(0≤<italic>e</italic>&lt;1,⌊<italic>n</italic>×<italic>e</italic>⌋=<italic>k</italic>), search all substrings of <italic>S</italic>, noted as {<italic>P</italic><sup>′</sup>}, such that ∥<italic>P</italic><sup>′</sup>,<italic>P</italic>∥<sub><italic>l</italic><italic>e</italic><italic>v</italic></sub>≤<italic>k</italic>; and all suffixes of <italic>S</italic>, noted as {<italic>S</italic><sup>′</sup>}, such that ∃ a prefix of <italic>P</italic>, noted as <italic>P</italic><sup>′</sup>, and ∥<italic>S</italic><sup>′</sup>,<italic>P</italic><sup>′</sup>∥<sub><italic>l</italic><italic>e</italic><italic>v</italic></sub>≤|<italic>S</italic><sup>′</sup>|×<italic>e</italic></p>
      </sec>
    </sec>
    <sec>
      <title>Algorithms</title>
      <p>For the <italic>k-difference problem</italic>, the classic approach [<xref ref-type="bibr" rid="B2">2</xref>] computes a (<italic>m</italic>+1)×(<italic>n</italic>+1) dynamic programming matrix C[0..m,0..n] using the following recurrence: </p>
      <p>
        <disp-formula>
          <mml:math id="M6" name="1471-2105-15-182-i6" overflow="scroll">
            <mml:mrow>
              <mml:mi>C</mml:mi>
              <mml:mo stretchy="false">[</mml:mo>
              <mml:mi>i</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>j</mml:mi>
              <mml:mo stretchy="false">]</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mtext mathvariant="italic">min</mml:mtext>
              <mml:mfenced open="{">
                <mml:mrow>
                  <mml:mtable class="array" columnalign="left">
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mi>C</mml:mi>
                        <mml:mo>[</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mi>j</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>]</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>δ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext mathvariant="italic">ij</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mi>C</mml:mi>
                        <mml:mo>[</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mi>j</mml:mi>
                        <mml:mo>]</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mi>C</mml:mi>
                        <mml:mo>[</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>j</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>]</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p> where </p>
      <p>
        <disp-formula>
          <mml:math id="M7" name="1471-2105-15-182-i7" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>δ</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext mathvariant="italic">ij</mml:mtext>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mfenced open="{">
                <mml:mrow>
                  <mml:mtable class="array" columnalign="left">
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mn>0</mml:mn>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mtext>if</mml:mtext>
                        <mml:mspace width="1em"/>
                        <mml:mspace width="1em"/>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>p</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>s</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mtext>otherwise</mml:mtext>
                        <mml:mi>.</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p> with initialization at the upper boundary by <italic>C</italic>[0,<italic>j</italic>]=0, and at the left boundary by <italic>C</italic>[<italic>i</italic>,0]=<italic>i</italic>, for <italic>i</italic>=1,2,…,<italic>m</italic> and <italic>j</italic>=1,2,…,<italic>n</italic>. Finally, the algorithm tests the last row of the matrix, i.e. <italic>C</italic>[<italic>m</italic>,<italic>j</italic>], and reports those elements that are no greater than <italic>k</italic>. This algorithm has <italic>O</italic>(<italic>m</italic><italic>n</italic>) time and <italic>O</italic>(<italic>m</italic><italic>n</italic>) space complexity.</p>
      <p>The space bound can be easily reduced to <italic>O</italic>(<italic>m</italic>) if matrix <italic>C</italic> is computed by columns, noted as <italic>C</italic><sub><italic>j</italic></sub> for <italic>j</italic>=1,2,…<italic>n</italic>, and report a match each time <italic>C</italic><sub><italic>j</italic></sub>[<italic>m</italic>]≤<italic>k</italic>, because computing column <italic>C</italic><sub><italic>j</italic></sub> requires only the knowledge of previous column <italic>C</italic><sub><italic>j</italic>−1</sub>. With careful design, <italic>C</italic><sub><italic>j</italic></sub> and <italic>C</italic><sub><italic>j</italic>−1</sub> can share one column vector, as proposed by Ukkonen [<xref ref-type="bibr" rid="B4">4</xref>].</p>
      <p>Ukkonen also observed that for columns that have the last element greater than <italic>k</italic>, there is a boundary index of <italic>C</italic><sub><italic>j</italic></sub>, noted as <italic>l</italic><italic>a</italic><italic>c</italic>(<italic>C</italic><sub><italic>j</italic></sub>), such that <italic>C</italic><sub><italic>j</italic></sub>[<italic>l</italic><italic>a</italic><italic>c</italic>(<italic>C</italic><sub><italic>j</italic></sub>)]=<italic>k</italic> and <italic>C</italic><sub><italic>j</italic></sub>[<italic>l</italic>]&gt;<italic>k</italic> for <italic>l</italic>=<italic>l</italic><italic>a</italic><italic>c</italic>(<italic>C</italic><sub><italic>j</italic></sub>)+1,…<italic>m</italic>. It is easy to prove that <italic>l</italic><italic>a</italic><italic>c</italic>(<italic>C</italic><sub><italic>j</italic></sub>)≤<italic>l</italic><italic>a</italic><italic>c</italic>(<italic>C</italic><sub><italic>j</italic>−1</sub>)+1. Using this observation, Ukkonen reduced the time from <italic>O</italic>(<italic>m</italic><italic>n</italic>) to expected <italic>O</italic>(<italic>k</italic><italic>n</italic>) [<xref ref-type="bibr" rid="B4">4</xref>].</p>
      <p>Our algorithm was developed from Ukkonen’s algorithm; however, we use a queue instead of an array to store all elements of current column above the boundary index. When there is a new element that corresponds to the topmost element of the new column, all elements in the queue shift automatically to the next (lower) position, just as elements transfer in the diagonals of matrix <italic>C</italic>. This process inherently keeps the basic properties of Ukkonen’s algorithm and facilitates subsequent improvements.</p>
      <sec>
        <title>Lemma 1</title>
        <p>In the dynamic programming matrix <italic>C</italic> for tackling the <italic>k</italic>-difference problem, the values of elements along each diagonal are monotonically non-decreasing.</p>
        <p>The proof is provided in Additional file <xref ref-type="supplementary-material" rid="S5">5</xref> Appendix A.</p>
      </sec>
      <sec>
        <title>Theorem 1</title>
        <p>All the matched elements of the query pattern and sequence are equal to their precursors in the diagonal and do not need to be updated in the dynamic programming process.</p>
      </sec>
      <sec>
        <title><italic>Proof</italic>.</title>
        <p>This theorem is a direct consequence of Lemma 1 and the dynamic programming recurrence, when <italic>δ</italic><sub><italic>i</italic><italic>j</italic></sub>=0.</p>
        <p>In other words, only mismatched elements need to be updated in the dynamic programming process. If bit-vectors that denote mismatched positions of comparison between the adapter sequence and each of the four nucleotide characters are pre-computed and a bit-vector that marks all positions of the queue elements that exceed the <italic>k</italic>-difference constraint is maintained, then unnecessary computations in updating the column vector can be inhibited. This is the key point that led to the main improvement of our algorithm over Ukkonen’s algorithm.</p>
        <p>As listed in Algorithm 1, the <italic>bit-masked k-difference matching algorithm</italic> has the following characteristics: </p>
        <p>• Use a queue instead of an array to store all elements of the current column above boundary index.</p>
        <p>• In preprocessing, calculate for each of four nucleotide characters a bit-vector that denotes the mismatched positions compared with the adapter.</p>
        <p>• Mark the internal cells that exceed the <italic>k</italic>-difference constraint by a bit-vector which shifts as the queue pushes it.</p>
        <p>• When processing the column starting from each input nucleotide, update only the cells that mismatch and have not been marked.</p>
        <p>This algorithm uses a queue of size <italic>m</italic> and several bit vectors of size ⌈<italic>m</italic>/<italic>w</italic>⌉, where <italic>w</italic> is the word length of the computer (for example <italic>w</italic> equals 64 for a 64-bit machine), and hence has a space of <italic>O</italic>(<italic>m</italic>). For each of the <italic>n</italic> characters in a target sequence, the character enters the queue once and exits from the queue at most once. For a random sequence, the expected size of the queue is <italic>O</italic>(<italic>k</italic>); hence, generally the algorithm has <italic>O</italic>(<italic>k</italic><italic>n</italic>) expected time. However, because it is restricted by the bit-mask operations, each element in the queue usually updates at most <italic>k</italic>+1 times. Because bit operations are negligible compared with element update operations, this algorithm achieves <italic>O</italic>(<italic>k</italic><italic>n</italic>) worst-case time in practice, which is better than the <italic>O</italic>(<italic>k</italic><italic>n</italic>) expected time for Ukkonen’s algorithm.<disp-formula><graphic xlink:href="1471-2105-15-182-i8.gif"/></disp-formula></p>
        <p>Algorithm 1 can be improved further by avoiding all unnecessary updates through constant time bit operations within each iteration cycle of the target nucleotide. The basic principle is that when an element in a diagonal of the original dynamic programming matrix has a value that is derived from an adjacent diagonal (i.e. an indel occurs in the corresponding path), the score and associated index of the element will remain unchanged if the precursor remains unchanged.</p>
        <p>Although the above improvement can reduce the theoretical time complexity from expected <italic>O</italic>(<italic>k</italic><italic>n</italic>) to worst-case <italic>O</italic>(<italic>k</italic><italic>n</italic>), experiments on large volumes of real data showed that the reduced element update operations did not compensate for the additional bit operations.</p>
        <p>For the <italic>extended k-difference problem</italic>, an additional step bounded by <italic>O</italic>(<italic>m</italic>) is performed to check all the elements remained in the queue if no hit was found in previous steps.</p>
      </sec>
    </sec>
    <sec>
      <title>Deal with base-call qualities</title>
      <p>The main advantage of the <italic>bit-masked k-difference matching algorithm</italic> over <italic>Myer’s bit-vector algorithm</italic> is that it can be extended to handle base-call quality values.</p>
      <p>To handle base-call quality values, we introduce the following parameters: <italic>P</italic><sub><italic>m</italic><italic>i</italic><italic>n</italic></sub>=−<italic>l</italic><italic>o</italic><italic>g</italic><sub>10</sub>(1/3), the minimum penalty for a mismatch; <italic>P</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>=−<italic>l</italic><italic>o</italic><italic>g</italic><sub>10</sub>(10<sup>40/(−10)</sup>/3), the maximum penalty for a mismatch; <italic>d</italic><italic>e</italic><italic>l</italic><italic>t</italic><italic>a</italic>=<italic>P</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>, the penalty for an insertion or deletion. The penalty of a mismatch with quality value <italic>q</italic> is calculated as: </p>
      <p>
        <disp-formula>
          <mml:math id="M8" name="1471-2105-15-182-i9" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="center">
              <mml:mtr>
                <mml:mtd class="eqnarray-1">
                  <mml:mi>P</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi>q</mml:mi>
                  <mml:mo>)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mfenced open="{">
                    <mml:mrow>
                      <mml:mtable class="array" columnalign="center">
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>P</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="italic">min</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd>
                            <mml:mi>q</mml:mi>
                            <mml:mo>≤</mml:mo>
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>P</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="italic">min</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:mi>q</mml:mi>
                            <mml:mo>/</mml:mo>
                            <mml:mn>40</mml:mn>
                            <mml:mo>×</mml:mo>
                            <mml:mo>(</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>P</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="italic">max</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>P</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="italic">min</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>)</mml:mo>
                          </mml:mtd>
                          <mml:mtd>
                            <mml:mn>0</mml:mn>
                            <mml:mo>&lt;</mml:mo>
                            <mml:mi>q</mml:mi>
                            <mml:mo>&lt;</mml:mo>
                            <mml:mn>40</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>P</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="italic">max</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd>
                            <mml:mi>q</mml:mi>
                            <mml:mo>≥</mml:mo>
                            <mml:mn>40</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mtd>
                <mml:mtd class="eqnarray-2"/>
                <mml:mtd class="eqnarray-3"/>
                <mml:mtd>
                  <mml:mtext/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>It is trivial to prove that <italic>P</italic>(<italic>q</italic>)=−<italic>l</italic><italic>o</italic><italic>g</italic><sub>10</sub>(10<sup><italic>q</italic>/(−10)</sup>/3) when 0&lt;<italic>q</italic>&lt;40. This score is the negative logarithm of the probability that the corresponding base is actually a match to the adapter sequence with sequencing error.</p>
      <p>Note that the scoring scheme herein only induces penalties for mismatches and insertions/deletions. For matches, because the possibility of false matching based on sequence homology reduces exponentially as the matching length increases, the false matching possibility can be reduced by setting a longer alignment length. When PE information is available, the false matching possibility can be reduced to a minimum.</p>
      <p>The extended version of Algorithm 1 that can take quality values into consideration is outlined in Additional file <xref ref-type="supplementary-material" rid="S6">6</xref> Appendix B.</p>
    </sec>
    <sec>
      <title>Deal with paired-end information</title>
      <p>Unlike the standard SE sequencing, PE sequencing reads out each DNA template twice, in opposite directions from different ends. The underlying fact is that all the PE reads that need to be trimmed must have the preserved paired sequences reverse-complement to each other, as illustrated in Figure <xref ref-type="fig" rid="F5">5</xref> and Additional file <xref ref-type="supplementary-material" rid="S7">7</xref> Appendix C.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p>Layout of paired-end reads that have adapter contaminants.</p>
        </caption>
        <graphic xlink:href="1471-2105-15-182-5"/>
      </fig>
      <p>Using this property, the program first finds all <italic>k</italic>-difference occurrences of adapters in both paired reads using the extended version of Algorithm 1 with quality values considered. Then the reverse-complementary property of each trimmed paired sequences is checked. Next, all candidates are evaluated with a scoring scheme that takes into account the fitness of adapter sequences in paired reads and the alignment of reverse-complementary counter-parts. Finally, the program outputs the optimal occurrence, if any.</p>
      <p>The scoring scheme we used is as follows: </p>
      <p>
        <disp-formula>
          <mml:math id="M9" name="1471-2105-15-182-i10" overflow="scroll">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mspace width="1em"/>
                  <mml:mtext mathvariant="italic">score</mml:mtext>
                  <mml:mo>(</mml:mo>
                  <mml:mtext mathvariant="italic">idx</mml:mtext>
                  <mml:mo>)</mml:mo>
                  <mml:mo>=</mml:mo>
                </mml:mtd>
                <mml:mtd>
                  <mml:mtext mathvariant="italic">pscore</mml:mtext>
                  <mml:mo>(</mml:mo>
                  <mml:mtext mathvariant="italic">read</mml:mtext>
                  <mml:mn>1</mml:mn>
                  <mml:mo>[</mml:mo>
                  <mml:mtext mathvariant="italic">idx</mml:mtext>
                  <mml:mo>…</mml:mo>
                  <mml:mtext mathvariant="italic">readLen</mml:mtext>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>]</mml:mo>
                  <mml:mo>,</mml:mo>
                  <mml:mtext mathvariant="italic">adapter</mml:mtext>
                  <mml:mn>1</mml:mn>
                  <mml:mo>)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd/>
                <mml:mtd>
                  <mml:mo>+</mml:mo>
                  <mml:mtext mathvariant="italic">pscore</mml:mtext>
                  <mml:mo>(</mml:mo>
                  <mml:mtext mathvariant="italic">read</mml:mtext>
                  <mml:mn>2</mml:mn>
                  <mml:mo>[</mml:mo>
                  <mml:mtext mathvariant="italic">idx</mml:mtext>
                  <mml:mo>…</mml:mo>
                  <mml:mtext mathvariant="italic">readLen</mml:mtext>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>]</mml:mo>
                  <mml:mo>,</mml:mo>
                  <mml:mtext mathvariant="italic">adapter</mml:mtext>
                  <mml:mn>2</mml:mn>
                  <mml:mo>)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd/>
                <mml:mtd>
                  <mml:mo>+</mml:mo>
                  <mml:mtext mathvariant="italic">pscore</mml:mtext>
                  <mml:mo>(</mml:mo>
                  <mml:mtext mathvariant="italic">read</mml:mtext>
                  <mml:mn>1</mml:mn>
                  <mml:mo>[</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>…</mml:mo>
                  <mml:mtext mathvariant="italic">idx</mml:mtext>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>]</mml:mo>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd/>
                <mml:mtd>
                  <mml:mtext mathvariant="italic">revComp</mml:mtext>
                  <mml:mo>(</mml:mo>
                  <mml:mtext mathvariant="italic">read</mml:mtext>
                  <mml:mn>2</mml:mn>
                  <mml:mo>[</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>…</mml:mo>
                  <mml:mtext mathvariant="italic">idx</mml:mtext>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>]</mml:mo>
                  <mml:mo>)</mml:mo>
                  <mml:mo>)</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>idx</italic> is the start position for trimming, <italic>p</italic><italic>s</italic><italic>c</italic><italic>o</italic><italic>r</italic><italic>e</italic>(<italic>x</italic>,<italic>y</italic>)=|<italic>x</italic>|×<italic>P</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>−<italic>p</italic><italic>e</italic><italic>n</italic><italic>a</italic><italic>l</italic><italic>t</italic><italic>y</italic>(<italic>x</italic>,<italic>y</italic>), <italic>P</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> is the maximum penalty for a difference, <italic>p</italic><italic>e</italic><italic>n</italic><italic>a</italic><italic>l</italic><italic>t</italic><italic>y</italic>(<italic>x</italic>,<italic>y</italic>) is the penalty for matching <italic>x</italic> and <italic>y</italic> as calculated by the <italic>k-difference matching algorithms</italic>, and <italic>r</italic><italic>e</italic><italic>v</italic><italic>C</italic><italic>o</italic><italic>m</italic><italic>p</italic>(<italic>x</italic>) denotes the reverse complementary sequence of <italic>x</italic>. The goal is to find the <italic>idx</italic> that meets the <italic>k</italic>-difference requirement and maximizes the <italic>score</italic> function.</p>
    </sec>
    <sec>
      <title>Deal with Nextera LMP information</title>
      <p>Mate-pair library sequencing allows the generation of long-insert PE libraries that are useful in the scaffolding process of de novo genome assembly and in the detection of long-range genome structural variations. In the Nextera LMP library construction process, there are additional reactions called “tagmentation” and “circularization” before the normal PE library construction. The tagmentation reaction uses a specially engineered transposome to fragment the DNA sample and tag the DNA fragments by attaching a pair of biotinylated junction adapters simultaneously to the ends. Next, the tagmented DNA molecules are circularized and sheared by ultrasonics, and the sub-fragments containing the original junction parts are enriched via the biotin tag in the junction adapter.</p>
      <p>Trimming adapters from Nextera LMP reads is like a reverse process of Nextera LMP library construction. To process Nextera mate-pair reads, the program first trims the adapters as if it is dealing with PE reads. Then, it trims junction adapters from the processed paired reads separately using the extended version of Algorithm 1.</p>
    </sec>
  </sec>
  <sec>
    <title>Availability of supporting data</title>
    <p>The data sets supporting the results of this article are available from high-throughput DNA and RNA sequence read archive: http://www.ncbi.nlm.nih.gov/sra/?term=SRR014966, http://www.ncbi.nlm.nih.gov/sra/?term=SRR330569, http:// www.ncbi.nlm.nih.gov/sra/?term=ERA264981, and http:// www.ncbi.nlm.nih.gov/sra/?term=SRR519624.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>SZ and SWD supervised the project. HJ conceived the algorithm, developed the program, and performed the data analysis. RL explained NGS protocols and provided biological perspectives on trimming effects. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p>Tabular metrics of experiments on simulated data.</p>
      </caption>
      <media xlink:href="1471-2105-15-182-S1.xlsx">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p>Tabular metrics of experiments on real sRNA data.</p>
      </caption>
      <media xlink:href="1471-2105-15-182-S2.xlsx">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p>Tabular metrics of experiments on real PE RNA-Seq data.</p>
      </caption>
      <media xlink:href="1471-2105-15-182-S3.xlsx">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S4">
      <caption>
        <title>Additional file 4</title>
        <p>Commands for conducting experiments on real LMP data.</p>
      </caption>
      <media xlink:href="1471-2105-15-182-S4.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S5">
      <caption>
        <title>Additional file 5</title>
        <p>Proofs of some fundamental lemmas.</p>
      </caption>
      <media xlink:href="1471-2105-15-182-S5.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S6">
      <caption>
        <title>Additional file 6</title>
        <p>Details of extended algorithms.</p>
      </caption>
      <media xlink:href="1471-2105-15-182-S6.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S7">
      <caption>
        <title>Additional file 7</title>
        <p>An example for adapter trimming of real PE data.</p>
      </caption>
      <media xlink:href="1471-2105-15-182-S7.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>We thank Dr. Zhongxin Guo for providing a large volume of the real genome resequencing data and sRNA sequencing data used for this study. This work was supported by the National Key Technology R&amp;D Program of China (2012BAK11B01), the Basic Scientific Research Foundation of the Chinese Academy of Inspection and Quarantine (CAIQ) (2013JK003), and the Special Fund of CAIQ for Pest Identification and Monitoring.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>He</surname>
          <given-names>HH</given-names>
        </name>
        <name>
          <surname>Meyer</surname>
          <given-names>CA</given-names>
        </name>
        <name>
          <surname>Hu</surname>
          <given-names>SS</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>MW</given-names>
        </name>
        <name>
          <surname>Zang</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Rao</surname>
          <given-names>PK</given-names>
        </name>
        <name>
          <surname>Fei</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Xu</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Long</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>XS</given-names>
        </name>
        <name>
          <surname>Brown</surname>
          <given-names>M</given-names>
        </name>
        <article-title>
Refined dnase-seq protocol and data analysis reveals intrinsic bias in transcription factor footprint identification
</article-title>
        <source>Nature Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>73</fpage>
        <lpage>78</lpage>
        <pub-id pub-id-type="pmid">24317252</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Smith</surname>
          <given-names>TF</given-names>
        </name>
        <name>
          <surname>Waterman</surname>
          <given-names>MS</given-names>
        </name>
        <article-title>
Identification of common molecular subsequences
</article-title>
        <source>J Mol Biol</source>
        <year>1981</year>
        <volume>147</volume>
        <issue>1</issue>
        <fpage>195</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="pmid">7265238</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Martin</surname>
          <given-names>M</given-names>
        </name>
        <article-title>
Cutadapt removes adapter sequences from high-throughput sequencing reads
</article-title>
        <source>EMBnet.journal</source>
        <year>2011</year>
        <volume>17</volume>
        <fpage>10</fpage>
        <lpage>12</lpage>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ukkonen</surname>
          <given-names>E</given-names>
        </name>
        <article-title>
Finding approximate patterns in strings
</article-title>
        <source>J Algorithm</source>
        <year>1985</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>132</fpage>
        <lpage>137</lpage>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Myers</surname>
          <given-names>G</given-names>
        </name>
        <article-title>
A fast bit-vector algorithm for approximate string matching based on dynamic programming
</article-title>
        <source>J ACM</source>
        <year>1999</year>
        <volume>46</volume>
        <issue>3</issue>
        <fpage>395</fpage>
        <lpage>415</lpage>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kong</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>
Btrim: a fast, lightweight adapter and quality trimming program for next-generation sequencing technologies
</article-title>
        <source>Genomics</source>
        <year>2011</year>
        <volume>98</volume>
        <issue>2</issue>
        <fpage>152</fpage>
        <lpage>153</lpage>
        <pub-id pub-id-type="pmid">21651976</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Falgueras</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Lara</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Fernandez-Pozo</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Canton</surname>
          <given-names>FR</given-names>
        </name>
        <name>
          <surname>Perez-Trabado</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Claros</surname>
          <given-names>MG</given-names>
        </name>
        <article-title>
Seqtrim: a high-throughput pipeline for pre-processing any type of sequence read
</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>38</fpage>
        <pub-id pub-id-type="pmid">20089148</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schmieder</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Lim</surname>
          <given-names>YW</given-names>
        </name>
        <name>
          <surname>Rohwer</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Edwards</surname>
          <given-names>R</given-names>
        </name>
        <article-title>
Tagcleaner: Identification and removal of tag sequences from genomic and metagenomic datasets
</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>341</fpage>
        <pub-id pub-id-type="pmid">20573248</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dodt</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Roehr</surname>
          <given-names>JT</given-names>
        </name>
        <name>
          <surname>Ahmed</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Dieterich</surname>
          <given-names>C</given-names>
        </name>
        <article-title>
Flexbar–flexible barcode and adapter processing for next-generation sequencing platforms
</article-title>
        <source>Biology (Basel)</source>
        <year>2012</year>
        <volume>1</volume>
        <issue>3</issue>
        <fpage>895</fpage>
        <lpage>905</lpage>
        <pub-id pub-id-type="pmid">24832523</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Needleman</surname>
          <given-names>SB</given-names>
        </name>
        <name>
          <surname>Wunsch</surname>
          <given-names>CD</given-names>
        </name>
        <article-title>
A general method applicable to the search for similarities in the amino acid sequence of two proteins
</article-title>
        <source>J Mol Biol</source>
        <year>1970</year>
        <volume>48</volume>
        <issue>3</issue>
        <fpage>443</fpage>
        <lpage>453</lpage>
        <pub-id pub-id-type="pmid">5420325</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lohse</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Bolger</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Nagel</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fernie</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Lunn</surname>
          <given-names>JE</given-names>
        </name>
        <name>
          <surname>Stitt</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Usadel</surname>
          <given-names>B</given-names>
        </name>
        <article-title>
Robina: a user-friendly, integrated software solution for rna-seq-based transcriptomics
</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>Web Server issue</issue>
        <fpage>622</fpage>
        <lpage>627</lpage>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lindgreen</surname>
          <given-names>S</given-names>
        </name>
        <article-title>
Adapterremoval: easy cleaning of next-generation sequencing reads
</article-title>
        <source>BMC Res Notes</source>
        <year>2012</year>
        <volume>5</volume>
        <fpage>337</fpage>
        <pub-id pub-id-type="pmid">22748135</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Criscuolo</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Brisse</surname>
          <given-names>S</given-names>
        </name>
        <article-title>
Alientrimmer: a tool to quickly and accurately trim off multiple short contaminant sequences from high-throughput sequencing reads
</article-title>
        <source>Genomics</source>
        <year>2013</year>
        <volume>102</volume>
        <issue>5–6</issue>
        <fpage>500</fpage>
        <lpage>506</lpage>
        <pub-id pub-id-type="pmid">23912058</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Leggett</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Clavijo</surname>
          <given-names>BJ</given-names>
        </name>
        <name>
          <surname>Clissold</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Clark</surname>
          <given-names>MD</given-names>
        </name>
        <name>
          <surname>Caccamo</surname>
          <given-names>M</given-names>
        </name>
        <article-title>
Nextclip: an analysis and read preparation tool for nextera long mate pair libraries
</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>4</issue>
        <fpage>566</fpage>
        <lpage>568</lpage>
        <pub-id pub-id-type="pmid">24297520</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Huang</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>GT</given-names>
        </name>
        <article-title>
Art: a next-generation sequencing read simulator
</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="pmid">22199392</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kato</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>de Lencastre</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Pincus</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Slack</surname>
          <given-names>FJ</given-names>
        </name>
        <article-title>
Dynamic expression of small non-coding rnas, including novel micrornas and pirnas/21u-rnas, during caenorhabditis elegans development
</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>5</issue>
        <fpage>54</fpage>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hillier</surname>
          <given-names>LW</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>GT</given-names>
        </name>
        <name>
          <surname>Quinlan</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Dooling</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Fewell</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Barnett</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Fox</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Glasscock</surname>
          <given-names>JI</given-names>
        </name>
        <name>
          <surname>Hickenbotham</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Huang</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Magrini</surname>
          <given-names>VJ</given-names>
        </name>
        <name>
          <surname>Richt</surname>
          <given-names>RJ</given-names>
        </name>
        <name>
          <surname>Sander</surname>
          <given-names>SN</given-names>
        </name>
        <name>
          <surname>Stewart</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Stromberg</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Tsung</surname>
          <given-names>EF</given-names>
        </name>
        <name>
          <surname>Wylie</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Schedl</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Wilson</surname>
          <given-names>RK</given-names>
        </name>
        <name>
          <surname>Mardis</surname>
          <given-names>ER</given-names>
        </name>
        <article-title>
Whole-genome sequencing and variant discovery in c. elegans
</article-title>
        <source>Nat Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <issue>2</issue>
        <fpage>183</fpage>
        <lpage>188</lpage>
        <pub-id pub-id-type="pmid">18204455</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Langmead</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Salzberg</surname>
          <given-names>SL</given-names>
        </name>
        <article-title>
Fast gapped-read alignment with bowtie 2
</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>4</issue>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Trapnell</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Pachter</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Salzberg</surname>
          <given-names>SL</given-names>
        </name>
        <article-title>
Tophat: discovering splice junctions with rna-seq
</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>9</issue>
        <fpage>1105</fpage>
        <lpage>1111</lpage>
        <pub-id pub-id-type="pmid">19289445</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kim</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Pertea</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Trapnell</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Pimentel</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Kelley</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Salzberg</surname>
          <given-names>SL</given-names>
        </name>
        <article-title>
Tophat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions
</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>36</fpage>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Consortium</surname>
          <given-names>F</given-names>
        </name>
        <article-title>
The flybase database of the drosophila genome projects and community literature
</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <issue>1</issue>
        <fpage>172</fpage>
        <lpage>175</lpage>
        <pub-id pub-id-type="pmid">12519974</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Del Fabbro</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Scalabrin</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Morgante</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Giorgi</surname>
          <given-names>FM</given-names>
        </name>
        <article-title>
An extensive evaluation of read trimming effects on illumina ngs data analysis
</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>12</issue>
        <fpage>85024</fpage>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Simpson</surname>
          <given-names>JT</given-names>
        </name>
        <name>
          <surname>Wong</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Jackman</surname>
          <given-names>SD</given-names>
        </name>
        <name>
          <surname>Schein</surname>
          <given-names>JE</given-names>
        </name>
        <name>
          <surname>Jones</surname>
          <given-names>SJ</given-names>
        </name>
        <name>
          <surname>Birol</surname>
          <given-names>I</given-names>
        </name>
        <article-title>
Abyss: a parallel assembler for short read sequence data
</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <issue>6</issue>
        <fpage>1117</fpage>
        <lpage>1123</lpage>
        <pub-id pub-id-type="pmid">19251739</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
