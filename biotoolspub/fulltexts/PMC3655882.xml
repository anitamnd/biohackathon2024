<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3655882</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-14-109</article-id>
    <article-id pub-id-type="pmid">23530580</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-14-109</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TPMS: a set of utilities for querying collections of gene trees</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Bigot</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>thomas.bigot@univ-lyon1.fr</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Daubin</surname>
          <given-names>Vincent</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>vincent.daubin@univ-lyon1.fr</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Lassalle</surname>
          <given-names>Florent</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>florent.lassalle@univ-lyon1.fr</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A4">
        <name>
          <surname>Perrière</surname>
          <given-names>Guy</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>guy.perriere@univ-lyon1.fr</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Laboratoire de Biométrie et Biologie Évolutive, UMR CNRS 5558, Université Claude Bernard – Lyon 1, 43 bd. du 11 Novembre 1918, 69622 Villeurbanne Cedex, France</aff>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>3</month>
      <year>2013</year>
    </pub-date>
    <volume>14</volume>
    <fpage>109</fpage>
    <lpage>109</lpage>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>11</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>3</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2013 Bigot et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Bigot et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/14/109"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>The information in large collections of phylogenetic trees is useful for many comparative genomic studies. Therefore, there is a need for flexible tools that allow exploration of such collections in order to retrieve relevant data as quickly as possible.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>In this paper, we present TPMS (Tree Pattern-Matching Suite), a set of programs for handling and retrieving gene trees according to different criteria. The programs from the suite include utilities for tree collection building, specific tree-pattern search strategies and tree rooting. Use of TPMS is illustrated through three examples: systematic search for incongruencies in a large tree collection, a short study on the Coelomata/Ecdysozoa controversy and an evaluation of the level of support for a recently published Mammal phylogeny.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>TPMS is a powerful suite allowing to quickly retrieve sets of trees matching complex patterns in large collection or to root trees using more rigorous approaches than the classical midpoint method. As it is made of a set of command-line programs, it can be easily integrated in any sequence analysis pipeline for an automated use.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Comparative genomics is a central approach in sequence analysis, and many important biological results have been obtained through its use. Among the different programs and packages developed for comparative genomics, those using the information contained in phylogenetic trees are of special interest. Indeed, the explicative power brought by trees has still no match for problems like orthology detection, Horizontal Gene Transfer (HGT) prediction, or large-scale evolutionary studies. For orthologs detection, the most rigorous approach to determine whether homologous genes are orthologous or paralogous consists in comparing a gene tree to the species tree considered as a reference [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B4">4</xref>]. Similarly, the same approach can be used for HGT detection [<xref ref-type="bibr" rid="B5">5</xref>]. Lastly, various kind of evolutionary studies have been made possible only through the use of large collection of trees, <italic>e.g.</italic>, detection of positive selection in vertebrate evolution [<xref ref-type="bibr" rid="B6">6</xref>], analysis of DNA methylation levels in mammals [<xref ref-type="bibr" rid="B7">7</xref>], or GC-content evolution [<xref ref-type="bibr" rid="B8">8</xref>].</p>
    <p>The problem is that manual browsing of collections containing thousands of gene trees is a tedious – and now, almost impossible to perform – task, and automated tools are required for large scale studies. Therefore, we have developed TPMS, a set of programs devoted to tree manipulation and query. Its central functionality is a pattern-matching algorithm aimed at finding gene trees containing specific motifs. Those patterns are written using an extended Newick format and they usually include some kind of constraint, such as node nature (duplication, speciation), subtree content, or level of statistical support for the nodes (<italic>e.g.</italic>, bootstrap, jackknife or aLRT). The second main functionality brought by TPMS is a tree-rooting tool based on the use of a gene unicity score and taxonomic criteria. Its aim is to place the root of a gene tree in order to minimize the incongruencies observed between this tree and a reference species tree.</p>
    <p>The tree pattern search algorithm used by TPMS is an improved version of the one we previously published [<xref ref-type="bibr" rid="B1">1</xref>]. The main improvement is the possibility to query tree collections built by the users. Our previous version was implemented in FamFetch, a Graphical User Interface (GUI) that was only able to query a set of predefined databases installed on a centralized server [<xref ref-type="bibr" rid="B9">9</xref>].</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p>TPMS is a set of C++ command-line programs that require the Bio++ [<xref ref-type="bibr" rid="B10">10</xref>] and Boost (<ext-link ext-link-type="uri" xlink:href="http://www.boost.org/">http://www.boost.org/</ext-link>) libraries to run and it is not dependent on the use of the gene families databases developed in our group [<xref ref-type="bibr" rid="B9">9</xref>]. Binaries are provided for Linux and MacOSX (Intel architectures only), as well as C++ source code and documentation.</p>
    <sec>
      <title>Tree collection building</title>
      <p>TPMS needs to be run on a collection built in the RAP format [<xref ref-type="bibr" rid="B1">1</xref>]. With this format, all the trees are included in a single text file. The header of this file consists in a reference species tree in Newick format that contains taxa names on its internal nodes and leaves. Names on leaves correspond to species and names on internal nodes correspond to higher taxonomic groups. All taxonomic groups allow the use of synonyms. For instance, in the example file distributed with TPMS, the leaf corresponding to <italic>Escherichia coli</italic> strain K12 substrain W3110 is written as:</p>
      <p>The different synonyms are separated by a slash and it is possible to use any of them when building a query.</p>
      <p>Individual gene trees are listed after the reference species tree. Each entry is written in Newick format and has associated information consisting in the tree name and a list of associations between the sequences names used at the leaves and their corresponding species names:</p>
      <p>The species tree can contain unresolved nodes (multifurcations), but not the individual gene trees since the tree pattern matching algorithm used only supports binary trees [<xref ref-type="bibr" rid="B1">1</xref>].</p>
      <p>The program <italic>tpms_mkdb</italic> is provided in order to produce a collection in the suitable format. To run this program, the minimal requirements are a species tree file and a collection of gene trees in Newick format. Using the information provided in these two files, the user must then build another file containing the association between all the sequences names used in the gene trees and the species to which they belong. Note that <italic>tpms_mkdb</italic> provides a functionality for facilitating this task. This functionality returns a ready-to-complete list of all the sequences names found in the gene trees files. Then the user has to fill the blanks with corresponding species names.</p>
    </sec>
    <sec>
      <title>Tree pattern-matching</title>
      <p>The tree pattern-matching algorithm itself is implemented in the <italic>tpms_query</italic> program. This is a C++ version of the one used in FamFetch, and a complete description of the algorithm can be found in [<xref ref-type="bibr" rid="B1">1</xref>]. Like in the original program, both the target tree and the tree pattern need to be rooted.</p>
      <p>Tree patterns have to be written in an extended Newick format, and they can include different criteria. Let <italic>υ</italic> be a node from the pattern <italic>P</italic>, and let <italic>ω</italic> and <italic>φ</italic> be the two sons of <italic>υ</italic>. In our format, <italic>υ</italic> is described by three strings separated by slashes. The first two strings contains the constraints put on <italic>υ</italic>, whereas the third one – which is only suitable for leaves – describes the set of taxa allowed at this level. The simplest pattern only contains the list of taxa to be found on the leaves with their respective positions. For instance, the pattern <monospace>((//Homo sapiens,</monospace><monospace>//Pan troglodytes),</monospace><monospace>//Rodentia)</monospace> will find all the gene trees in which a subtree with sequences from <italic>Homo sapiens</italic> and <italic>Pan troglodytes</italic> species are grouped, while sequences from Rodents are located outside of this group. It is possible to accurately ask for the inclusion or the exclusion of specific taxa through the use of + and − signs. In this case, the pattern <monospace>((//Homo sapiens,</monospace><monospace>//Pan troglodytes),</monospace><monospace>//Mammalia −Primates)</monospace> will find all the gene trees in which a subtree with sequences from <italic>H. sapiens</italic> and <italic>P. troglodytes</italic> species are grouped, while any sequences from Mammals that are not from Primates are located outside this group. This pattern is less constrained than the first one, and the trees it selects will include all those selected by the first one.</p>
      <p>It is also possible to introduce taxonomic constraints on one of the two sons of the node matching to <italic>υ</italic> in the gene tree. This constraint is written on <italic>ω</italic>, but is put on its father node since the node matching on <italic>ω</italic> is not necessarily the direct son of the node matching on <italic>υ</italic>. This kind of constraint is put after the first slash, and examples of accepted and rejected topologies for a simple pattern are given in Figure <xref ref-type="fig" rid="F1">1</xref>.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>Example of a subtree constraint.</bold> In the pattern shown in the lower part of the figure, a constraint has been put on the node leading to <italic>P. troglodytes</italic>. The pattern is shown in red, and the subtree constraint is shown in green. This pattern with this constraint will find all the trees in which a subtree with sequences from <italic>P. troglodytes</italic> and <italic>M. musculus</italic> species are grouped. Non-Primates are forbidden from <italic>ν</italic><sub>1</sub>, the common ancestor of <italic>P. troglodytes</italic> and <italic>M. musculus</italic>, to the node matching to <italic>P. troglodytes</italic>. Tree (<bold>A</bold>) is rejected, since the pattern does not allow <italic>B. taurus</italic> (which is not a Primate) to be in the subtree containing <italic>P. troglodytes</italic> (generated by <italic>ν</italic><sub>1</sub>). On the other hand, tree (<bold>B</bold>) is accepted, as the subtree generated by <italic>ν</italic><sub>1</sub> contains only primates.</p>
        </caption>
        <graphic xlink:href="1471-2105-14-109-1"/>
      </fig>
      <p>Constraints other than purely taxonomic ones can be introduced on nodes. First, it is possible to search for patterns including a threshold for internal branches statistical support. For instance, the pattern <monospace>(//Homo sapiens, //Mus musculus)$90</monospace> will select all the gene trees in which a subtree with sequences from <italic>H. sapiens</italic> and <italic>Mus Musculus</italic> are grouped, this with an associated bootstrap ≥90<italic>%</italic>. Also, constraints on speciation or duplication can be set on nodes if the program is running on a reconciled trees collection. This kind of nodes can be specified by the use of letters S or D. The pattern <monospace>(//Homo sapiens, //Mus musculus)D</monospace> will find all the gene trees in which a subtree with sequences from <italic>H. sapiens</italic> and <italic>M. musculus</italic> are grouped, while the node that groups them is a duplication node. Lastly, it is possible to specify that a connection between two nodes in the gene tree is direct. This is specified through the use of the exclamation mark. Therefore, the pattern <monospace>(!//Homo sapiens, //Mus musculus)</monospace> will retrieve only gene trees in which the common ancestor of <italic>H. sapiens</italic> and <italic>Mus musculus</italic> has the leaf <italic>H. sapiens</italic> as a direct son.</p>
    </sec>
    <sec>
      <title>Tree rooting</title>
      <p>Tree rooting is an essential step in phylogeny as it orients the tree and enables the evolutionary history it summarizes to be interpreted. We have therefore implemented two rooting strategies in the <italic>tpms_computation</italic> program: the first one aims at maximizing the size of subtrees with unicopy sequences while the second one tries to maximize the accuracy of taxonomic affectations for nodes. The first approach introduces a score on the internal nodes of a rooted tree. Given a node <inline-formula><mml:math id="M1" name="1471-2105-14-109-i3" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>, its score <italic>u</italic><sub><italic>i</italic></sub> is obtained by the product of the number of sequences by species encountered in the subtree generated by the node considered. A score equal to 1 means that the corresponding subtree only contains one sequence for each species. Now, let <italic>T</italic> be a rooted tree, its unicity score <italic>U</italic><sup>(<italic>T</italic>)</sup> is equal to: </p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <mml:math id="M2" name="1471-2105-14-109-i4" overflow="scroll">
            <mml:msup>
              <mml:mrow>
                <mml:mi>U</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mi>T</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:msup>
            <mml:mo>=</mml:mo>
            <mml:munderover>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>n</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:munderover>
            <mml:mo>ln</mml:mo>
            <mml:mfenced open="(" close=")">
              <mml:mrow>
                <mml:munderover>
                  <mml:mrow>
                    <mml:mi>u</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>T</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:munderover>
              </mml:mrow>
            </mml:mfenced>
          </mml:math>
        </disp-formula>
      </p>
      <p>In a unrooted tree with <italic>n</italic> leaves, there are 2<italic>n</italic>−3 possible positions for the root. TPMS will try every position, and for each one, computes the unicity score of the corresponding rooted tree. Then, the rooting that is kept is the one that minimizes <italic>U</italic><sup>(<italic>T</italic>)</sup>. This approach favors duplications closer to the root than to the leaves. It minimizes the number of duplication events, and is therefore based on a parsimony reasoning. This method can be useful to extract unicopy subtrees from gene families containing many copies for some species. It can automatically split trees containing paralogs into several subtrees. Figure <xref ref-type="fig" rid="F2">2</xref> shows two rooting examples of a simple gene tree containing six sequences from three different species.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Example of unicity score computing for a gene tree with two different rootings.</bold> In this tree, we have six sequences <italic>a</italic><sub>1</sub>, <italic>a</italic><sub>2</sub>, <italic>b</italic><sub>1</sub>, <italic>b</italic><sub>2</sub>, <italic>b</italic><sub>3</sub> and <italic>c</italic>. Sequences <italic>a</italic><sub>1</sub> and <italic>a</italic><sub>2</sub> belong to species <italic>A</italic>; <italic>b</italic><sub>1</sub>, <italic>b</italic><sub>2</sub> and <italic>b</italic><sub>3</sub> belong to species <italic>B</italic>; and <italic>c</italic> belongs to species <italic>C</italic>. Scores of internal nodes are given in the circles. In this example, the rooting for topology (<bold>A</bold>) gives the unicity score <italic>U</italic><sup>(<italic>T</italic>)</sup>= ln(6)+ ln(6)+ ln(4)+ ln(2)+ ln(1)≈5.663, and the rooting for topology (<bold>B</bold>) gives the score <italic>U</italic><sup>(<italic>T</italic>)</sup>= ln(6)+ ln(4)+ ln(1)+ ln(1)+ ln(1)≈3.178. The rooting in (<bold>B</bold>) is therefore preferred over the one in (<bold>A</bold>).</p>
        </caption>
        <graphic xlink:href="1471-2105-14-109-2"/>
      </fig>
      <p>The second rooting method uses the reference species tree included in the header of the tree collection. During the rooting procedure, each internal node <italic>ν</italic><sub><italic>i</italic></sub> of the gene tree is associated with the taxonomic group corresponding to the Lowest Common Ancestor (LCA) in the species tree. Then, a distance <italic>d</italic><sub><italic>i</italic></sub> is computed for each node. This distance is equal to the number of nodes between the root of the species tree, and the node of the taxonomic group in the species tree associated with the node in the gene tree. Note that the taxa from the species tree that are not present in the gene tree are not taken into account in this distance computation. Therefore, the sum of node distances for a rooted tree <italic>T</italic> is equal to: </p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <mml:math id="M3" name="1471-2105-14-109-i5" overflow="scroll">
            <mml:msup>
              <mml:mrow>
                <mml:mi>D</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mi>T</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:msup>
            <mml:mo>=</mml:mo>
            <mml:munderover>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>n</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:munderover>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>d</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mi>T</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:msubsup>
          </mml:math>
        </disp-formula>
      </p>
      <p>Again, TPMS will try all the 2<italic>n</italic>−3 rooting positions and will keep the one maximizing <italic>D</italic><sup>(<italic>T</italic>)</sup>. Indeed, higher <italic>D</italic><sup>(<italic>T</italic>)</sup> values correspond to better taxonomic affectations (<italic>i.e.</italic>, resulting trees that are more congruent to the reference species tree). Figure <xref ref-type="fig" rid="F3">3</xref> shows an example of two possible rootings for a bacterial gene tree, this considering a reference species tree.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Example of distance score computing for a gene tree with two different rootings.</bold> The reference species tree is shown in (<bold>A</bold>), with the names of the taxonomic groups written on the nodes (Bacteria, <italic>γ</italic>-Proteobacteria and Enterobacteria). The rooting given in (<bold>B</bold>) gives a sum of distances <italic>D</italic><sup>(<italic>T</italic>)</sup>=1+0+0=1, while the rooting given in (<bold>C</bold>) gives a sum of distances <italic>D</italic><sup>(<italic>T</italic>)</sup>=1+1+0=2. The rooting in (<bold>C</bold>) is therefore preferred over the one in (<bold>B</bold>).</p>
        </caption>
        <graphic xlink:href="1471-2105-14-109-3"/>
      </fig>
      <p>Usually, the two approaches are used in sequence, the first one is efficient to isolate clusters of unique sequences, but it can lead to many <italic>ex aequo</italic>. The problem is that, among those <italic>ex aequo</italic>, some of them can contain obviously erroneous polyphyletic groups. On the other hand, the second approach will find the solutions that are more consistent to the species tree. It can be therefore used to solve those <italic>ex aequo</italic> in the right way, as it will remove the solutions that are in violation of the reference. If more candidates still remains after those two steps, the root is placed on the solution having the longest branch. In case of branch lengths equality, placement is arbitrary on one of the remaining possibilities.</p>
    </sec>
  </sec>
  <sec>
    <title>Data sets</title>
    <p>For the detection of tree incongruencies in complete genomes, we performed the search on the 128674 gene trees available from HOGENOM release 5 (<ext-link ext-link-type="uri" xlink:href="http://pbil.univ-lyon1.fr/databases/hogenom/">http://pbil.univ-lyon1.fr/databases/hogenom/</ext-link>). Those trees include a total of respectively 2789275 bacterial, 138474 archaeal and 738819 eukaryotic sequences. For the Ecdysozoa/Coelomata controversy and the mammals phylogeny study, we used the 14190 gene trees available from HOMOLENS release 5 (<ext-link ext-link-type="uri" xlink:href="http://pbil.univ-lyon1.fr/databases/homolens.php">http://pbil.univ-lyon1.fr/databases/homolens.php</ext-link>). For the first two studies, the reference species tree used was the one provided by NCBI (<ext-link ext-link-type="uri" xlink:href="http://ftp.ncbi.nih.gov/pub/taxonomy/">http://ftp.ncbi.nih.gov/pub/taxonomy/</ext-link>) and for the mammal phylogeny we used a slightly modified version of the tree published by Dos Reis <italic>et al.</italic>[<xref ref-type="bibr" rid="B11">11</xref>]. Those modifications were made to match the species tree available in HOMOLENS as three species from [<xref ref-type="bibr" rid="B11">11</xref>] were not available in this database: <italic>Pongo abelii</italic>, <italic>Vicugna pacos</italic> and <italic>Canis familiaris</italic>. They were replaced respectively by <italic>Pongo pygmaeus</italic>, <italic>Lama pacos</italic> and a clade grouping <italic>Canis lupus familiaris</italic> and <italic>Ailuropoda melanoleuca</italic>.</p>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Incongruencies detection</title>
      <p>The program <italic>tpms_computation</italic> can be used to detect taxonomic incongruencies. As seen above, each node in a gene tree can be assigned to its LCA, this using the information provided by the reference species tree. To detect the incongruencies, the approach used is to see if a leaf or a node in a gene tree induces a perturbation in this taxonomy affectation. Exploration of the tree starts from the leaves and goes up to the root. For each node, the algorithm masks the subtree it generates. If this masking leads to a taxonomic assignation change on its grandfather node, then this subtree is pruned. A perturbation index is associated to this incongruency, it correspond to the distance (in nodes numbers and with ignoring the taxa that are not present in the gene tree) between the former taxonomic affectation and the one realized after the masking process. This operation is repeated until all the existing incongruencies have been detected. Lastly, to be considered as a true incongruency, the involved branch must have a support value greater than a threshold given by the user.</p>
      <p>A simple example of detection is given in Figure <xref ref-type="fig" rid="F4">4</xref>. In this example, <italic>Staphylococcus aureus</italic>, a Firmicute, is wrongly grouped with <italic>Escherichia coli</italic>, an Enterobacteria. Masking the node leading to <italic>S. aureus</italic> leads to a change from Bacteria to Enterobacteria in the taxonomic assignation of its grandfather node. As the number of nodes separating Bacteria from Enterobacteria in the species tree used, the perturbation index associated with this incongruency is equal to 2.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Example of incongruency detection in a subtree.</bold> The reference species tree is shown in (<bold>A</bold>), with the names of the taxonomic groups written on the nodes. For each internal node, the distance <italic>d</italic> to the root is written in red. The subtree containing the incongruency is shown in (<bold>B1</bold>), with <italic>S. aureus</italic> being the misplaced taxon. In this subtree, the taxonomic group associated to the grandfather of <italic>S. aureus</italic> is Bacteria and its distance to the root in the species tree is <italic>d</italic>=0. In (<bold>B2</bold>) the father node of <italic>S. aureus</italic> is removed. The root of this subtree has now two sons <italic>E. coli</italic> and <italic>S. dysenteriae</italic>. The new taxonomic affectation of this node becomes Enterobacteria, which corresponds to a distance to the root <italic>d</italic>=2, in the species tree. Therefore, perturbation induced by the misplacement of <italic>S. aureus</italic> is equal to 2−0=2.</p>
        </caption>
        <graphic xlink:href="1471-2105-14-109-4"/>
      </fig>
      <p>Over the 128674 gene trees available in HOGENOM, <italic>tpms_computation</italic> found 110359 incongruencies supported by bootstrap values ≥90<italic>%</italic>, this corresponds to an average of 0.86 errors per tree. Different events could explain the incongruencies observed: phylogenetic reconstruction errors (such as long branch attraction artefacts), errors in the NCBI species tree, wrong gene tree rooting by TPMS, hidden paralogies (as the gene trees from HOGENOM are not reconciled), incomplete lineage sorting and HGTs. Due to that fact, it is remarkable that their frequency is relatively low, with less than 1 error per tree on average.</p>
      <p>The number of intra and inter-domain incongruencies detected is shown in Figure <xref ref-type="fig" rid="F5">5</xref>. An intra-domain incongruency is when a species is placed inside its domain but outside the taxonomic group it belongs to and an inter-domain incongruency is when a species is wrongly located in another domain than the one it belongs to. A good way to see if our method can be used to detect HGTs is to look at its ability to identify well-known transfers such as the ones observed between mitochondria or chloroplast and the nucleus of eukaryotes. For that purpose, we looked at the incongruences found with the 374 eukaryotic genes labelled as mitochondrial in HOGENOM 5. Among those genes, 252 (67.4%) were found to be involved in an incongruency placing them among Bacteria. Similarly, among the 377 genes labelled as chloroplastic, 249 (66%) were found to be involved in an incongruency placing them among Bacteria.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Number of incongruencies inferred between and inside the three domains of life.</bold> The three domains (Archaea, Bacteria and Eukaryota) are represented respectively by the letters A, B and E. For inter-domain incongruencies, the arrows give the direction of the switch observed.</p>
        </caption>
        <graphic xlink:href="1471-2105-14-109-5"/>
      </fig>
    </sec>
    <sec>
      <title>Coelomata/Ecdysozoa controversy</title>
      <p>The issue of whether coelomates form a single clade, the Coelomata, or whether all animals that moult an exoskeleton (such as the coelomate arthropods and the pseudocoelomate nematodes) form a distinct clade, the Ecdysozoa, is still a major open-ended subject in evolutionary biology. While single-gene based phylogenies supported the Ecdysozoa hypothesis [<xref ref-type="bibr" rid="B12">12</xref>-<xref ref-type="bibr" rid="B14">14</xref>], a first wave of phylogenomic analyses mostly favored the Coelomata [<xref ref-type="bibr" rid="B15">15</xref>-<xref ref-type="bibr" rid="B17">17</xref>]. More recently, those results were challenged by other genomic-scale studies [<xref ref-type="bibr" rid="B18">18</xref>-<xref ref-type="bibr" rid="B20">20</xref>], shifting again the balance toward Ecdysozoa. Here we present a short example showing how it is possible to retrieve the trees supporting either hypothesis.</p>
      <p>Using TPMS, the patterns to find are <monospace>(//Fungi,</monospace><monospace>(/Nematoda/Nematoda,</monospace><monospace>(/Chordata/Chordata, /Arthropoda/Arthropoda)</monospace><monospace>$80)</monospace><monospace>$80)</monospace>and<monospace>(//</monospace><monospace>Fungi,</monospace><monospace>(/Chordata/Chordata,</monospace><monospace>(/Nematoda/</monospace><monospace>Nematoda,</monospace><monospace>/Arthropoda/Arthropoda)</monospace><monospace>$80)</monospace><monospace>$80)</monospace>, respectively for Coelomata and Ecdysozoa hypotheses with a bootstrap support ≥80<italic>%</italic>. We performed the search into a collection built with the HOMOLENS database, this with several thresholds for bootstrap values (Table <xref ref-type="table" rid="T1">1</xref>). Excepted for the search performed with no minimal value for bootstrap scores, the results returned were systematically in favor of the Coelomata hypothesis.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Number of tree patterns matching Coelomata or Ecdysozoa hypotheses</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="right"/>
            <col align="right"/>
            <col align="right"/>
            <col align="right"/>
            <col align="right"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left"> </th>
              <th align="right"><bold>no thr</bold>.</th>
              <th align="right">
                <bold>
                  <italic>≥</italic>
                </bold>
                <bold>8</bold>
                <bold>0</bold>
                <bold>
                  <italic>%</italic>
                </bold>
              </th>
              <th align="right">
                <bold>
                  <italic>≥</italic>
                </bold>
                <bold>8</bold>
                <bold>5</bold>
                <bold>
                  <italic>%</italic>
                </bold>
              </th>
              <th align="right">
                <bold>
                  <italic>≥</italic>
                </bold>
                <bold>9</bold>
                <bold>0</bold>
                <bold>
                  <italic>%</italic>
                </bold>
              </th>
              <th align="right">
                <bold>
                  <italic>≥</italic>
                </bold>
                <bold>9</bold>
                <bold>5</bold>
                <bold>
                  <italic>%</italic>
                </bold>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="bottom">Coelomata<hr/></td>
              <td align="right" valign="bottom">768<hr/></td>
              <td align="right" valign="bottom">241<hr/></td>
              <td align="right" valign="bottom">174<hr/></td>
              <td align="right" valign="bottom">110<hr/></td>
              <td align="right" valign="bottom">54<hr/></td>
            </tr>
            <tr>
              <td align="left">Ecdysozoa</td>
              <td align="right">1309</td>
              <td align="right">149</td>
              <td align="right">83</td>
              <td align="right">45</td>
              <td align="right">20</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The queries corresponding to the two hypotheses have returned the numbers of patterns shown in the table. Five different thresholds have been used for bootstrap, from no threshold to values higher than 95%.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Note that this small example is only aimed at showing the possibilities provided by TPMS in terms of tree pattern search. To fully validate the result presented above it would be necessary to go back to the sequence alignments and test for the relative evolutionary rates of individual genes, this in order to avoid systematic biases leading to reconstruction artefacts such as long branch attraction. Indeed, the only nematode genome available in HOGENOM 5 is <italic>Caenorhabditis elegans</italic>, and this organism is known to have genes with high evolutionary rates, leading frequently to such kind of artefacts [<xref ref-type="bibr" rid="B21">21</xref>].</p>
    </sec>
    <sec>
      <title>Mammals phylogeny</title>
      <p>In order to find sets of orthologs in a specific taxon it is possible to query a collection using a pattern corresponding to the subtree of a species tree containing the given taxon. If a gene tree contains exactly this pattern, then the most parsimonious hypothesis is that the matching sequences are orthologous. The search for exact patterns in TPMS requires a direct link between nodes, which is specified by the exclamation mark. For instance, to query a collection to find orthologous genes inside the <italic>Rodentia</italic> order, we must select all the gene trees containing the TPMS pattern <monospace>((((!//Rattus Norvegicus,</monospace><monospace>!//Mus</monospace><monospace>Musculus)!, !//Dipodomys ordii)!, !// Cavia Porcellus) !, !// Spermophilus</monospace><monospace>Tridecemlineatus)</monospace>. This feature can be used to test the support level for nodes in a species tree. As an example, we used the mammals phylogeny published by Dos Reis <italic>et al.</italic>[<xref ref-type="bibr" rid="B11">11</xref>]. For that purpose, we extracted all possible subtrees in this tree and used the corresponding patterns to perform searches in HOMOLENS. Complete listing of the patterns in TPMS format is provided as Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>.</p>
      <p>Figure <xref ref-type="fig" rid="F6">6</xref> shows the tree topology of the Dos Reis <italic>et al.</italic> phylogeny in which the node level of support is given as the ratio of the number of families matching the pattern over the total number of eligible families (<italic>i.e.</italic>, the HOMOLENS families containing the species found in the subtree). As expected, both numbers decrease as we move from the leaves to the root of the tree due to the fact that deep nodes correspond to subtrees containing a growing number of taxa. A consequence is that the level of support also decreases when moving to the deepest parts of the tree. This goes to an extreme with the nodes corresponding to <italic>Boreoeutheria</italic>, <italic>Eutheria</italic> and <italic>Theria</italic> as they have a support equal to zero in terms of families matching the pattern. This is due to the fact that it is not possible to specify fuzzy patterns in which some species are optional for the search. This would allow to put constraint on the placement of a species in a tree, without rejecting patterns which do not include this species. As we are restricted to strict patterns, finding families containing a large number of species and exactly matching this pattern is difficult.</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>Mammal phylogeny support through the number of matching gene trees.</bold> For each node, the number of families matching the pattern over the number of eligible families is given. Red arrow shows the branch displacement required to obtain an alternative topology in which <italic>Chiroptera</italic> is a sister group of <italic>E. caballus</italic> and their father node is a sister group of <italic>Carnivora</italic>.</p>
        </caption>
        <graphic xlink:href="1471-2105-14-109-6"/>
      </fig>
      <p>This method can also be used to test alternative hypotheses in a tree. For instances, the <italic>Pegasoferae</italic> node has the lowest support (168/6466) when looking at all the other nodes located at the same level in the tree. Moreover, Waddell <italic>et al.</italic>[<xref ref-type="bibr" rid="B22">22</xref>] made the hypothesis that <italic>Chiroptera</italic> is in fact a sister group of <italic>Equus caballus</italic>. To test this hypothesis we searched for the number of gene families supporting it. For that purpose, we used the pattern <monospace>((!//Equus</monospace><monospace>caballus,</monospace><monospace>(!//Pteropus</monospace><monospace>vampyrus,</monospace><monospace>!//Myotis</monospace><monospace>lucifugus)!)!,</monospace><monospace>((!//Canis</monospace><monospace>lupus</monospace><monospace>familiaris,</monospace><monospace>!//Ailuropoda</monospace><monospace>melanoleuca)!,</monospace><monospace>!//Felis catus)!)</monospace>. With this pattern, we obtained a support level of 6/6466 for <italic>Pegasoferae</italic>, which is significantly lower than the one observed with the original topology.</p>
    </sec>
  </sec>
  <sec>
    <title>Discussion and conclusion</title>
    <p>TPMS is a useful set of programs that can be used in a wide range of phylogenetic problems. It has high performance due to its implementation in a compiled language and the fact that all individual programs are multithreaded. Multithreading allows an optimal use on the multi-core architectures that are now common even for desktop computers. For instance, the two pattern searches (with no threshold for bootstrap values) performed on a collection containing 14190 trees to identify the ones supporting the Coelomata or the Ecdyzosoa hypotheses took only six seconds on an Intel Xeon 2.67 GHz with four cores.</p>
    <p>For the tree pattern search, the most recent program available to perform this kind of task is PhyloPattern [<xref ref-type="bibr" rid="B23">23</xref>]. It is implemented in Java and Prolog and its users have to write their queries as Prolog predicates, which can be very difficult for non-experts. Also, this program cannot be used to root trees or to search for HGTs. Moreover, its performance will be far below the ones of TPMS, due to the fact it is written with interpreted languages.</p>
    <p>For the automated tree rooting procedure, different alternatives to the two strategies proposed by TPMS are available. Due to its simplicity, the classical midpoint method looks like a good choice, but this is usually a poor solution. Indeed, midpoint rooting implies that the molecular clock hypothesis is approximately true for the sequences used and, most of the time, this is not the case [<xref ref-type="bibr" rid="B24">24</xref>]. Other common approaches are mostly based on algorithms identifying roots that minimize the number of gene duplication and losses, but they require reconciled trees and therefore they need a reliable reference species tree [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B26">26</xref>]. In the case of TPMS, the rooting strategy based on the use of an unicity score does not require the availability of such reference tree. This alternative is useful in the case of gene trees containing prokaryotic sequences, as no trusted species tree exist for these organisms. Also, reconciliation methods usually performs poorly with prokaryotic sequences as they do not introduce the possibility of HGTs events.</p>
    <p>The application of TPMS for efficient large-scale identification of putative HGTs would require some improvements. Presently, the algorithm is already able to search for incongruent patterns in which a subtree is responsible for a topological shift from the reference species tree. The problem is that the automated procedure provided does not guarantee that the rooting is optimal for prokaryotic species when performing “generic” searches (<italic>e.g.</italic>, searches among the whole Bacteria or Archaea). If there is a lot of HGTs in a tree, our algorithm can lead to a wrong rooting, causing partially wrong taxonomic assignments, and therefore false positives. On the other hand, using TPMS with an explicit transfer pattern (a taxon nested in another when it is not supposed to be according to the species tree) can be very efficient. A method like Prunier, which is specifically devoted to the detection of HGTs is of course more efficient than TPMS in that area but the drawback is that it is limited to unicopy gene families [<xref ref-type="bibr" rid="B5">5</xref>].</p>
    <p>In the future, we have planned to add functionalities mainly to increase the user-friendliness. For instance, a module automatically completing the species names when building the file containing the associations between sequence names and the species to which they belong is under development. This module works with the remote-acnuc library [<xref ref-type="bibr" rid="B27">27</xref>] and requires that the considered species are referenced in the general sequence collections.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> TPMS<bold>Project home page:</bold><ext-link ext-link-type="uri" xlink:href="http://pbil.univ-lyon1.fr/software/tpms/">http://pbil.univ-lyon1.fr/software/tpms/</ext-link><bold>Operating system(s):</bold> Unix-like operating systems such as Linux and MacOSX (Intel)<bold>Progamming language:</bold> C++<bold>Other requirements:</bold> Bio++ and Boost libraries<bold>License:</bold> GNU GPL</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>TB did all software development, documentation writing and web site set-up, FL participated to conception of the rooting algorithms, VD participated to the incongruencies detection research, GP supervised TPMS development and wrote the manuscript. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Set of TPMS patterns corresponding to all possible subtrees from the tree shown in Figure </bold>6.</p>
      </caption>
      <media xlink:href="1471-2105-14-109-S1.txt" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>This work has been supported by ANR grant ANR-08-GENM-025 for the MetaSoil project and ANR grant ANR-10-BINF-01-01 for the Ancestrome project.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dufayard</surname>
          <given-names>JF</given-names>
        </name>
        <name>
          <surname>Duret</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Penel</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Gouy</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Rechenmann</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Perrière</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Tree pattern matching in phylogenetic trees: automatic search for orthologs or paralogs in homologous gene sequence databases</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>14</volume>
        <fpage>2596</fpage>
        <lpage>2603</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti325</pub-id>
        <pub-id pub-id-type="pmid">15713731</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gabaldón</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Large-scale assignment of orthology: back to phylogenetics?</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>14</volume>
        <fpage>235</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-10-235</pub-id>
        <pub-id pub-id-type="pmid">18983710</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Altenhoff</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Dessimoz</surname>
          <given-names>C</given-names>
        </name>
        <article-title>Phylogenetic and functional assessment of orthologs inference projects and methods</article-title>
        <source>PLoS Comput Biol</source>
        <year>2009</year>
        <volume>14</volume>
        <fpage>e1000262</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000262</pub-id>
        <pub-id pub-id-type="pmid">19148271</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pryszcz</surname>
          <given-names>LP</given-names>
        </name>
        <name>
          <surname>Huerta-Cepas</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Gabaldón</surname>
          <given-names>T</given-names>
        </name>
        <article-title>MetaPhOrs: orthology and paralogy predictions from multiple phylogenetic evidence using a consistency-based confidence score</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>14</volume>
        <fpage>e32</fpage>
        <pub-id pub-id-type="pmid">21149260</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Abby</surname>
          <given-names>SS</given-names>
        </name>
        <name>
          <surname>Tannier</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Gouy</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Daubin</surname>
          <given-names>V</given-names>
        </name>
        <article-title>Detecting lateral gene transfers by statistical reconciliation of phylogenetic forests</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>14</volume>
        <fpage>324</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-324</pub-id>
        <pub-id pub-id-type="pmid">20550700</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Studer</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Penel</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Duret</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Robinson-Rechavi</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Pervasive positive selection on duplicated and nonduplicated vertebrate protein coding genes</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>14</volume>
        <fpage>1393</fpage>
        <lpage>1402</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.076992.108</pub-id>
        <pub-id pub-id-type="pmid">18562677</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Meunier</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Khelifi</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Navratil</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Duret</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Homology-dependent methylation in primate repetitive DNA</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2005</year>
        <volume>14</volume>
        <fpage>5471</fpage>
        <lpage>5476</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0408986102</pub-id>
        <pub-id pub-id-type="pmid">15797989</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Belle</surname>
          <given-names>EM</given-names>
        </name>
        <name>
          <surname>Duret</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Galtier</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Eyre-Walker</surname>
          <given-names>A</given-names>
        </name>
        <article-title>The decline of isochores in mammals: an assessment of the GC content variation along the mammalian phylogeny</article-title>
        <source>J Mol Evol</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>653</fpage>
        <lpage>660</lpage>
        <pub-id pub-id-type="doi">10.1007/s00239-004-2587-x</pub-id>
        <pub-id pub-id-type="pmid">15461422</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Penel</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Arigon</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Dufayard</surname>
          <given-names>JF</given-names>
        </name>
        <name>
          <surname>Sertier</surname>
          <given-names>AS</given-names>
        </name>
        <name>
          <surname>Daubin</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Duret</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Gouy</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Perrière</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Databases of homologous gene families for comparative genomics</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>14</volume>
        <issue>Suppl 6</issue>
        <fpage>S3</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-S6-S3</pub-id>
        <pub-id pub-id-type="pmid">19534752</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dutheil</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Gaillard</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Bazin</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Glemin</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Ranwez</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Galtier</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Belkhir</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Bio++: a set of C++ libraries for sequence analysis, phylogenetics, molecular evolution and population genetics</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>14</volume>
        <fpage>188</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-188</pub-id>
        <pub-id pub-id-type="pmid">16594991</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dos Reis</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Inoue</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Hasegawa</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Asher</surname>
          <given-names>RJ</given-names>
        </name>
        <name>
          <surname>Donoghue</surname>
          <given-names>PCJ</given-names>
        </name>
        <collab>Yang Z</collab>
        <article-title>Phylogenomic datasets provide both precision and accuracy in estimating the timescale of placental mammal phylogeny</article-title>
        <source>Proc R Soc B</source>
        <year>2012</year>
        <volume>14</volume>
        <fpage>3491</fpage>
        <lpage>3500</lpage>
        <pub-id pub-id-type="doi">10.1098/rspb.2012.0683</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Manuel</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Kruse</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Muller</surname>
          <given-names>WE</given-names>
        </name>
        <name>
          <surname>Le Parco</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>The comparison of beta-thymosin homologues among metazoa supports an arthropod-nematode clade</article-title>
        <source>J Mol Evol</source>
        <year>2000</year>
        <volume>14</volume>
        <fpage>378</fpage>
        <lpage>381</lpage>
        <pub-id pub-id-type="pmid">11040289</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ruiz-Trillo</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Paps</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Loukota</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Ribera</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Jondelius</surname>
          <given-names>U</given-names>
        </name>
        <name>
          <surname>Baguna</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Riutort</surname>
          <given-names>M</given-names>
        </name>
        <article-title>A phylogenetic analysis of myosin heavy chain type II sequences corroborates that Acoela and Nemertodermatida are basal bilaterians</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2002</year>
        <volume>14</volume>
        <fpage>11246</fpage>
        <lpage>11251</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.172390199</pub-id>
        <pub-id pub-id-type="pmid">12177440</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mallatt</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Winchell</surname>
          <given-names>CJ</given-names>
        </name>
        <article-title>Testing the new animal phylogeny: first use of combined large-subunit and small-subunit rRNA gene sequences to classify the protostomes</article-title>
        <source>Mol Biol Evol</source>
        <year>2002</year>
        <volume>14</volume>
        <fpage>289</fpage>
        <lpage>301</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a004082</pub-id>
        <pub-id pub-id-type="pmid">11861888</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Blair</surname>
          <given-names>JE</given-names>
        </name>
        <name>
          <surname>Ikeo</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Gojobori</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Hedges</surname>
          <given-names>SB</given-names>
        </name>
        <article-title>The evolutionary position of nematodes</article-title>
        <source>BMC Evol Biol</source>
        <year>2002</year>
        <volume>14</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2148-2-7</pub-id>
        <pub-id pub-id-type="pmid">11985779</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wolf</surname>
          <given-names>YI</given-names>
        </name>
        <name>
          <surname>Rogozin</surname>
          <given-names>IB</given-names>
        </name>
        <name>
          <surname>Koonin</surname>
          <given-names>EV</given-names>
        </name>
        <article-title>Coelomata and not Ecdysozoa: evidence from genome-wide phylogenetic analysis</article-title>
        <source>Genome Res</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>29</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="pmid">14707168</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zheng</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Rogozin</surname>
          <given-names>IB</given-names>
        </name>
        <name>
          <surname>Koonin</surname>
          <given-names>EV</given-names>
        </name>
        <name>
          <surname>Przytycka</surname>
          <given-names>TM</given-names>
        </name>
        <article-title>Support for the Coelomata clade of animals from a rigorous analysis of the pattern of intron conservation</article-title>
        <source>Mol Biol Evol</source>
        <year>2007</year>
        <volume>14</volume>
        <fpage>2583</fpage>
        <lpage>2592</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msm207</pub-id>
        <pub-id pub-id-type="pmid">17893400</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dopazo</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Dopazo</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Genome-scale evidence of the nematode-arthropod clade</article-title>
        <source>Genome Biol</source>
        <year>2005</year>
        <volume>14</volume>
        <fpage>R41</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2005-6-5-r41</pub-id>
        <pub-id pub-id-type="pmid">15892869</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lartillot</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Philippe</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Improvement of molecular phylogenetic inference and the phylogeny of Bilateria</article-title>
        <source>Philos Trans R Soc B</source>
        <year>2008</year>
        <volume>14</volume>
        <fpage>1463</fpage>
        <lpage>1472</lpage>
        <pub-id pub-id-type="doi">10.1098/rstb.2007.2236</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Holton</surname>
          <given-names>TA</given-names>
        </name>
        <name>
          <surname>Pisani</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Deep genomic-scale analyses of the metazoa reject Coelomata: evidence from single- and multigene families analyzed under a supertree and supermatrix paradigm</article-title>
        <source>Genome Biol Evol</source>
        <year>2010</year>
        <volume>14</volume>
        <fpage>310</fpage>
        <lpage>324</lpage>
        <pub-id pub-id-type="doi">10.1093/gbe/evq016</pub-id>
        <pub-id pub-id-type="pmid">20624736</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Denver</surname>
          <given-names>DR</given-names>
        </name>
        <name>
          <surname>Morris</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Lynch</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Thomas</surname>
          <given-names>WK</given-names>
        </name>
        <article-title>High mutation rate and predominance of insertions in the Caenorhabditis elegans nuclear genome</article-title>
        <source>Nature</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>679</fpage>
        <lpage>682</lpage>
        <pub-id pub-id-type="doi">10.1038/nature02697</pub-id>
        <pub-id pub-id-type="pmid">15295601</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Waddell</surname>
          <given-names>PJ</given-names>
        </name>
        <name>
          <surname>Shelley</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Evaluating placental inter-ordinal phylogenies with novel sequences including RAG1, γ-fibrinogen, ND6, and mt-tRNA, plus MCMC-driven nucleotide, amino acid, and codon models</article-title>
        <source>Mol Phylogenet Evol</source>
        <year>2003</year>
        <volume>14</volume>
        <fpage>197</fpage>
        <lpage>224</lpage>
        <pub-id pub-id-type="doi">10.1016/S1055-7903(03)00115-5</pub-id>
        <pub-id pub-id-type="pmid">12878459</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gouret</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Thompson</surname>
          <given-names>JD</given-names>
        </name>
        <name>
          <surname>Pontarotti</surname>
          <given-names>P</given-names>
        </name>
        <article-title>PhyloPattern: regular expression to identify complex patterns in phylogenetic trees</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>14</volume>
        <fpage>298</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-298</pub-id>
        <pub-id pub-id-type="pmid">19765311</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>WH</given-names>
        </name>
        <article-title>So, what about the molecular clock hypothesis?</article-title>
        <source>Curr Opin Genet Dev</source>
        <year>1993</year>
        <volume>14</volume>
        <fpage>896</fpage>
        <lpage>901</lpage>
        <pub-id pub-id-type="doi">10.1016/0959-437X(93)90011-D</pub-id>
        <pub-id pub-id-type="pmid">8118215</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Eulenstein</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Mirkin</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Vingron</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Duplication-based measures of difference between gene and species trees</article-title>
        <source>J Comput Biol</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>135</fpage>
        <lpage>148</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.1998.5.135</pub-id>
        <pub-id pub-id-type="pmid">9541877</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Górecki</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Eulenstein</surname>
          <given-names>O</given-names>
        </name>
        <article-title>Algorithms: simultaneous error-correction and rooting for gene tree reconciliation and the gene duplication problem</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>14</volume>
        <issue>Suppl 10</issue>
        <fpage>S14</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-S10-S14</pub-id>
        <pub-id pub-id-type="pmid">22759419</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gouy</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Delmotte</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Remote access to ACNUC nucleotide and protein sequence databases at PBIL</article-title>
        <source>Biochimie</source>
        <year>2008</year>
        <volume>14</volume>
        <fpage>555</fpage>
        <lpage>562</lpage>
        <pub-id pub-id-type="doi">10.1016/j.biochi.2007.07.003</pub-id>
        <pub-id pub-id-type="pmid">17825976</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
