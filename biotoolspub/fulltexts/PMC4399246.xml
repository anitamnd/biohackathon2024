<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4399246</article-id>
    <article-id pub-id-type="publisher-id">1497</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-015-1497-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SNPchiMp v.3: integrating and standardizing single nucleotide polymorphism data for livestock species</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Nicolazzi</surname>
          <given-names>Ezequiel L</given-names>
        </name>
        <address>
          <email>ezequiel.nicolazzi@tecnoparco.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Caprera</surname>
          <given-names>Andrea</given-names>
        </name>
        <address>
          <email>andrea.caprera@tecnoparco.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Nazzicari</surname>
          <given-names>Nelson</given-names>
        </name>
        <address>
          <email>nelson.nazzicari@tecnoparco.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cozzi</surname>
          <given-names>Paolo</given-names>
        </name>
        <address>
          <email>paolo.cozzi@tecnoparco.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Strozzi</surname>
          <given-names>Francesco</given-names>
        </name>
        <address>
          <email>francesco.strozzi@tecnoparco.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lawley</surname>
          <given-names>Cindy</given-names>
        </name>
        <address>
          <email>clawley@illumina.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pirani</surname>
          <given-names>Ali</given-names>
        </name>
        <address>
          <email>ali_pirani@affymetrix.com</email>
        </address>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Soans</surname>
          <given-names>Chandrasen</given-names>
        </name>
        <address>
          <email>csoans@illumina.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brew</surname>
          <given-names>Fiona</given-names>
        </name>
        <address>
          <email>fiona_brew@affymetrix.com</email>
        </address>
        <xref ref-type="aff" rid="Aff4"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jorjani</surname>
          <given-names>Hossein</given-names>
        </name>
        <address>
          <email>hossein.jorjani@slu.se</email>
        </address>
        <xref ref-type="aff" rid="Aff5"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Evans</surname>
          <given-names>Gary</given-names>
        </name>
        <address>
          <email>g.evans@neogeneurope.com</email>
        </address>
        <xref ref-type="aff" rid="Aff6"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Simpson</surname>
          <given-names>Barry</given-names>
        </name>
        <address>
          <email>bsimpson@neogen.com</email>
        </address>
        <xref ref-type="aff" rid="Aff7"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tosser-Klopp</surname>
          <given-names>Gwenola</given-names>
        </name>
        <address>
          <email>gwenola.tosser@toulouse.inra.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff8"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brauning</surname>
          <given-names>Rudiger</given-names>
        </name>
        <address>
          <email>rudiger.brauning@agresearch.co.nz</email>
        </address>
        <xref ref-type="aff" rid="Aff9"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Williams</surname>
          <given-names>John L</given-names>
        </name>
        <address>
          <email>john.williams@tecnoparco.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stella</surname>
          <given-names>Alessandra</given-names>
        </name>
        <address>
          <email>alessandra.stella@tecnoparco.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff10"/>
      </contrib>
      <aff id="Aff1"><label/>Bioinformatics and Biostatistical Genomics group, Fondazione Parco Tecnologico Padano, Via Einstein, Loc. Cascina Codazza, 26900 Lodi, Italy </aff>
      <aff id="Aff2"><label/>Illumina Inc, 5200 Illumina Way, San Diego, CA 92121 USA </aff>
      <aff id="Aff3"><label/>Affymetrix Inc, 3420 Central Expressway, Santa Clara, CA 95051 USA </aff>
      <aff id="Aff4"><label/>Affymetrix UK Ltd, Mercury Park, Wycombe Lane, High Wycombe, HP10 0HH UK </aff>
      <aff id="Aff5"><label/>Interbull center, Uppsala, S-75007 Sweden </aff>
      <aff id="Aff6"><label/>GeneSeek, a Neogen Company, Auchincruive, Ayr KA6 5HU Scotland, UK </aff>
      <aff id="Aff7"><label/>GeneSeek, a Neogen Company, Lincoln, NE 68504 USA </aff>
      <aff id="Aff8"><label/>Génétique, Physiologie et Systèmes d’Élevage, Institut National de la Recherche Agronomique &amp; Ecole Nationale Vétérinaire de Toulouse &amp; Ecole Nationale Supérieure Agronomique de Toulouse, Castanet-Tolosan, 31326 France </aff>
      <aff id="Aff9"><label/>AgResearch, Invermay Agricultural Centre, PB 50034 Mosgiel, New Zealand </aff>
      <aff id="Aff10"><label/>Istituto di Biologia e Biotecnologia Agraria, Consiglio Nazionale delle Ricerche, Via Einstein, Cascina Codazza, Lodi 26900 Italy </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>4</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>4</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>16</volume>
    <issue>1</issue>
    <elocation-id>283</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>11</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>3</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Nicolazzi et al.; licensee BioMed Central. 2015</copyright-statement>
      <license license-type="open-access">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>In recent years, the use of genomic information in livestock species for genetic improvement, association studies and many other fields has become routine. In order to accommodate different market requirements in terms of genotyping cost, manufacturers of single nucleotide polymorphism (SNP) arrays, private companies and international <italic>consortia</italic> have developed a large number of arrays with different content and different SNP density. The number of currently available SNP arrays differs among species: ranging from one for goats to more than ten for cattle, and the number of arrays available is increasing rapidly. However, there is limited or no effort to standardize and integrate array- specific (e.g. SNP IDs, allele coding) and species-specific (i.e. past and current assemblies) SNP information.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Here we present SNPchiMp v.3, a solution to these issues for the six major livestock species (cow, pig, horse, sheep, goat and chicken). Original data was collected directly from SNP array producers and specific international genome consortia, and stored in a MySQL database. The database was then linked to an open-access web tool and to public databases. SNPchiMp v.3 ensures fast access to the database (retrieving within/across SNP array data) and the possibility of annotating SNP array data in a user-friendly fashion.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>This platform allows easy integration and standardization, and it is aimed at both industry and research. It also enables users to easily link the information available from the array producer with data in public databases, without the need of additional bioinformatics tools or pipelines. In recognition of the open-access use of Ensembl resources, SNPchiMp v.3 was officially credited as an Ensembl E!mpowered tool. Availability at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.tecnoparco.org/SNPchimp">http://bioinformatics.tecnoparco.org/SNPchimp.</ext-link></p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>SNP</kwd>
      <kwd>Array</kwd>
      <kwd>Illumina</kwd>
      <kwd>Affymetrix</kwd>
      <kwd>GeneSeek</kwd>
      <kwd>Integration</kwd>
      <kwd>Standardization</kwd>
      <kwd>Imputation</kwd>
      <kwd>Ensembl</kwd>
      <kwd>NCBI</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>In Europe, agriculture represents approximately 1.7% of the total added gross value [<xref ref-type="bibr" rid="CR1">1</xref>]. This share differs greatly among member countries, ranging from 0.9% in Luxembourg to 13% in Romania. European livestock output is estimated to be worth approximately 165 billion Euros [<xref ref-type="bibr" rid="CR2">2</xref>] per year. Although the number of animals for all livestock species has decreased steadily since the 1980, increased farming efficiency and genetic improvement of animals have led to overall increasing yields. Research on genetic characteristics of livestock species has increased since the availability of genome sequences of major livestock species and the consequent availability of SNP arrays. Livestock genetic improvement, breeding, conservation and many other related sectors now rely on SNP array technology, as it provides rapid access to highly accurate genome-wide information on individuals at relatively low cost. Thousands of individuals have been genotyped worldwide [<xref ref-type="bibr" rid="CR3">3</xref>-<xref ref-type="bibr" rid="CR6">6</xref>], and this information has been used mainly for selection in breeding programmes. However, the amount of genomic information available on each animal differs depending on the type of genotyping array used. Furthermore, the number of SNP arrays available is rapidly increasing. It is common practice within all major livestock species to periodically exchange genotype data, which might be obtained from different SNP arrays. Imputation methods may then be used to predict the missing data [<xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR8">8</xref>]. Although exchanging information is routine, the difficulties in comparing and merging data is usually an underappreciated burden. There is an urgent need for standardization and tools to integrate SNP data and related information. In addition accessory information including annotation, allele formats, flanking sequences, etc. is often difficult to retrieve, especially for SNP arrays that are no longer commercially available. Integration and standardization difficulties are compounded as basic information such as SNP IDs (e.g. names) are not consistent across array suppliers, and in some cases, not even between array releases from the same supplier. In addition, SNP IDs are not always searchable in public databases and in particular Ensembl and NCBI. Even when SNP related information is available, it often requires the download of large datasets and extensive data manipulation to obtain the required information. Moreover, reference genome assemblies are regularly updated, with consequent changes in SNP coordinates and occasionally in the allele orientation coding. Cattle is the most extreme example for this, where there are currently two reference genome assemblies (UMD3.1 and BTAU4.6) [<xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR10">10</xref>] being used in parallel. SNP producers usually provide SNP coordinates quoting the UMD3.1 assembly. The cattle genome was one of the first livestock genomes to be published [<xref ref-type="bibr" rid="CR11">11</xref>] and the subsequent releases have greatly increased quality and stability of the sequence. The reference genome assemblies on other livestock species are more recent and still relatively unstable [<xref ref-type="bibr" rid="CR12">12</xref>], with ongoing work to improve the draft assemblies. The SNPchiMP v.3 presented here is the first tool able to tackle all the above problems for livestock species in an integrated, user-friendly and open-access fashion.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Data</title>
      <p>The SNP data contained in SNPchiMp v.3 can be divided into two main categories: the original data coming from the producer and the information from public databases. Current and historical original data free from intellectual property was collected directly from producers (Illumina, Neogen-GeneSeek and Affymetrix) and International genome consortia (the International Sheep Genomics Consortium [<xref ref-type="bibr" rid="CR13">13</xref>] and the International Goat Genome Consortium [<xref ref-type="bibr" rid="CR14">14</xref>]). Some of the information contained in SNPchiMp v.3 is directly available from the manufacturers/consortia websites [<xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR16">16</xref>].</p>
      <p>As a result of extensive data collection, a total of 23 SNP arrays (12 cow, 4 pig, 3 horse, 2 sheep, 1 goat and 1 chicken) are currently stored in SNPchiMP, with a total of 3,993,814 SNP and their cross-references.</p>
      <p>Public database information was handled in two ways: i) dbSNP database builds from June 2012 [<xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref>] onwards for all six livestock species were downloaded and stored on a local server; ii) tools to interrogate Ensembl databases directly through the web were built, either for querying information for single SNP or to access the Ensembl Biomart [<xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref>] and/or VeP [<xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR22">22</xref>] tools.</p>
      <p>A key feature of SNPchiMp, which is essential to integrate all above sources of information, was obtaining the links between commercial SNP IDs and dbSNP RefSeq (rs) IDs. Affymetrix already provides such association in its SNP knowledge base, whereas all other companies and <italic>consortia</italic>, which use Illumina-based technology and software, do not provide such information. For these, associations for all species were obtained by matching commercial SNP IDs against the “Submitter ID” or flanking sequences in the locally stored dbSNP database, following a similar procedure as specified in [<xref ref-type="bibr" rid="CR23">23</xref>] for cattle. However, full flanking sequence BLAST [<xref ref-type="bibr" rid="CR24">24</xref>] against the reference genomes of the six species was not performed, as this procedure was proven to be considerably time- and resource-consuming, and redundant with respect to independent checks performed over the whole dataset.</p>
    </sec>
    <sec id="Sec4">
      <title>Database</title>
      <p>SNPchiMp v.3 stores the data on a MySQL Server instance version 5.1.73. Data are internally organized as shown in the entity-relationship shown in Figure <xref rid="Fig1" ref-type="fig">1</xref>. The different species were considered separately, by replicating the same set of tables for each using a naming scheme (e.g. prefix " &lt; spec &gt; " for each species). The core data was simplified in order to require only four tables:<list list-type="bullet"><list-item><p>&lt;spec &gt; _arrays contains general SNP array information, including official SNP array name, the assembly used for the design, and the number of SNP contained.</p></list-item><list-item><p>&lt;spec &gt; _SNPall contains the original SNP information provided by producers for all arrays. This table includes commercial SNP names and rs IDs (if assigned), all possible alleles coding for that SNP, the Interbull index (if available; only for cattle) and a code for the taxa (for internal control).</p></list-item><list-item><p>&lt;spec &gt; _ALLmap contains all available assembly mapping for all SNPs. As such, it is in a one-to-many relationship with &lt; spec &gt; _SNPall, as a SNP can be mapped on more than one assembly (and more than one position on a different assembly).</p></list-item><list-item><p>&lt;spec &gt; _SSinfo contains SNP IDs submitted to dbSNP (ss ID). This table is in a one-to-many relationship with &lt; org &gt; _SNPall, as each rs ID usually contains several ss IDs (e.g. the same SNP was submitted by multiple groups). A Boolean flag (i.e. true/false) was added to identify which of the ss IDs was used to link the commercial SNP name to the RefSeq ID.</p></list-item></list><fig id="Fig1"><label>Figure 1</label><caption><p>Basic entity-relationship model for each species in the tool. Primary keys of each table are in bold. Black circles indicate required fields (e.g. non-NULL).</p></caption><graphic xlink:href="12864_2015_1497_Fig1_HTML" id="MO1"/></fig></p>
      <p>Two additional redundant tables were created for each species, for performance purposes:<list list-type="bullet"><list-item><p>&lt;spec &gt; _snp_across_arrays records the presence (or absence) of SNP across arrays. As such, the table structure is species-specific and the number of columns differs depending on the number of available SNP arrays. The table has two columns that describe the SNP (commercial SNP names and, if available, rs ID) and one Boolean column for each array, recording the presence/absence of that SNP in the specified array, respectively.</p></list-item><list-item><p>&lt;spec &gt; _join_ &lt; assembly &gt; is a set of tables. For each species, there are as many of these tables as the number of available assemblies. Each table represents a join between the four core tables, restricted to a single assembly. This data design enhances data compartmentalization with respect to assemblies.</p></list-item></list></p>
    </sec>
    <sec id="Sec5">
      <title>Query engine</title>
      <p>The query engine relies on a PHP application programming interface (API) written <italic>ad hoc</italic> to facilitate dynamically built SQL queries of the SNPchiMp v.3 database (Figure <xref rid="Fig2" ref-type="fig">2</xref>). Each user input is validated and translated into a SQL query. A conservative approach was applied to ensure the security of the information contained in the database, such that a user request that fails validation returns an error status and a set of case-specific error messages. For valid requests, the engine works in two different modes: one to produce a “preview” of the data requested by the user and one to perform the full query of the database. In the first mode, the engine interrogates the MySQL database, parses a subset of 25 elements of the result and returns a properly formatted PHP object. In the second mode, when a full query is requested, the engine returns the mediated user-defined SQL query using a pipeline, which directly connects the database output to the user. This facilitates massive downloads of data to the web-server with no need for pre-processing.<fig id="Fig2"><label>Figure 2</label><caption><p>Schematic view of query engine and user interface functionalities.</p></caption><graphic xlink:href="12864_2015_1497_Fig2_HTML" id="MO2"/></fig></p>
      <p>Extensive testing is performed before releasing new information. This is carried out using <italic>ad hoc</italic> development environments built specifically to avoid any conflict or unpredicted modifications to the production environment, which is publicly accessible.</p>
    </sec>
  </sec>
  <sec id="Sec6" sec-type="discussion">
    <title>Results and discussion</title>
    <p>The tool presented here is the evolution of two previous versions. SNPchiMp v.1 [<xref ref-type="bibr" rid="CR23">23</xref>] was specifically focused on bovine cattle and contained only 6 SNP arrays. SNPchiMp v.2 [<xref ref-type="bibr" rid="CR25">25</xref>] was a first attempt to enlarge the included set of species and SNP arrays. These two previous versions of SNPchimp were progressive upgrades, useful to gradually improve the tool and to generate interest among stakeholders and researchers. Since then, the strong interaction and collaboration with major industries and international genome consortia was the basis of the version presented here. In fact, SNPchiMp v.3 includes a notable growth in the amount of data regarding new species and chips (e.g. nearly two-fold increase from version 2). More than just a quantitative improvement, this was also a major qualitative change allowing a wider audience addressing common problems in multiple species. From the technological point of view, the whole tool has been completely rebuilt. Performance, database structure and technology and languages behind the user interface were highly improved to allow current and future scalability and reliability. In addition, this version includes a completely new functionality for direct interrogation of the BioMart and VeP Ensembl resources (i.e. for SNP array automatic annotation).</p>
    <p>The key to ensure data reliability was to obtain current and historical original data directly from producers and international genome consortia. As SNPchiMp v.3 aimed at the animal genetics community as a whole, only SNP arrays (or SNP information) that were free from intellectual property (IP) were considered. Once the data was obtained, a specific design of the MySQL database was chosen. The strong compartmentalization between different species was one of the most important design choices. This ensured smaller table size, and thus easier updates and additions. Moreover, it reduced the probability that corruption in one dataset propagates to others, thus providing higher structure stability. In any case, the original data was stored in the database without modifying the data itself (i.e. data was just integrated, standardized and arranged to a MySQL database format), thus users are not forced to store large annotation files anymore. In fact, users do not need to build cross-reference or cross-SNP array files anymore, as all these are already included in the functionalities of this tool (using original information). Another important design choice was the creation of two (controlled) redundant tables per species. These tables were useful to enhance the performance of the most common queries (by reducing the number of “joins” that need to be performed) and, hence, runtime.</p>
    <p>The choice of producing a “preview” page of the queries was also linked to high performance, as PHP objects are easy to render graphically and parsing time is very short. Specifically, the “preview” functionality was included to reduce the number of unwanted downloads, which would be both tedious for the user and resource-consuming for the server.</p>
    <p>A strong effort was put into the design of an appealing, user-friendly and easy-to-manage website that included the interface to interrogate the database. Differently from previous versions, the SNPchiMp v.3 website was built using the Joomla content management system (CMS) v.3.2.2 [<xref ref-type="bibr" rid="CR26">26</xref>]. It was functionally and structurally divided in three main areas: a documentation section, a software section and the database interface.</p>
    <p>The documentation area was highly improved from previous versions. Now it contains general information on the SNPchiMp, the data used, news with an RSS feed (Resource description framework Site Summary) and contact details.</p>
    <p>The new software section (“Tools”) consists of a webpage that points to useful tools, usually linked to SNPchiMp v.3 outputs (but not necessarily) and either produced in-house or by third parties. All software present in this section is open-access, and all contributors are encouraged to make their scripts open-source. Currently, the Tools menu contains software to extract Affymetrix Axiom genotypes (AffyPipe) [<xref ref-type="bibr" rid="CR27">27</xref>], to convert Illumina-like allele coding and map information (iConvert) [<xref ref-type="bibr" rid="CR28">28</xref>] and a multi-purpose software for SNP data management and analysis (Plato 2.0) [<xref ref-type="bibr" rid="CR29">29</xref>].</p>
    <p>The database interface is the true core of SNPchiMp v.3, and of course was present in the other two versions of the tool. Although background functionalities were completely rebuilt, special attention was taken to maintain user experience as similar as possible to earlier versions. User access to the database is driven by two functions, specifically designed to efficiently query either all SNP array information (“Download” menu) or a subset of SNPs (“Browse” menu). After selecting the desired species, a series of dialog forms and JQuery-Javascript functions (i.e. for radio and box buttons) help users perform the required query of the database in a user-friendly fashion. No SQL coding skills or knowledge of the underlying database is required. User choices consist of the selection of the desired SNP array, genome assembly and the level of detail required for the expected results. For both download and browse functions a subset of the first 25 rows of the query results is shown in a preview table. After being previewed, the resulting dataset can be downloaded by simply clicking on a “download” button.</p>
    <p>Three specific features are available when the Browse feature is used to query a subset of SNPs. Firstly, the preview page with results that contains links to related external resources/databases. On each row of the SNP table, two links for SNP specific Ensembl Locations/Variations and NCBI dbSNP pages are displayed. The second feature included in this section, which was not available in earlier version of this tool, was included in response to requests from the animal genetics community, and is the possibility to perform a straightforward SNP array specific annotation. SNPchiMp v.3 facilitates this by direct use of the Ensembl BioMart resources, using a “URL based access” interface to the Biomart Central Portal [<xref ref-type="bibr" rid="CR30">30</xref>]. The SNPchiMp v.3 interface prepares the Biomart URL, containing the specified query parameters, in order to visualize the required subset of data. This avoids any need for programming or specific knowledge of the data-mining tools involved. More advanced users can refine their queries with an additional set of options as required. The third feature facilitates the direct interrogation of Ensembl’s Variant Effect Predictor (VeP) tool using a REpresentational State Transfer (REST) interface. A Python CGI script was created to submit the data to Ensembl’s VeP REST API and visualize the results within the SNPchiMp v.3 interface. Results are displayed in a table where Ensembl VeP annotations are reported for each SNP. This solution ensures the stability of the service provided, as it avoids the need to install and update data and/or software for each new Ensembl data release as the REST interface automatically accesses the most up-to-date Ensembl version.</p>
  </sec>
  <sec id="Sec7" sec-type="conclusions">
    <title>Conclusions</title>
    <p>The need for SNP data standardization and integration is underappreciated. Here we present a tool that allows users to avoid performing the long and time-consuming series of steps required to integrate, standardize, and annotate SNP array data in the major livestock species.</p>
    <p>From its initial release [<xref ref-type="bibr" rid="CR23">23</xref>], this tool was completely rebuilt both on the back- and on the front-end, in order to enhance manageability and user-friendliness. SNPchiMp v.3 now considers six livestock species, for a total of 23 SNP arrays and allows direct and easy annotation of SNP array data in multiple species using Ensembl resources. It also provides standalone software for basic SNP data management. Its maintenance and constant update is ensured by the strong collaboration between SNP array producers, International Genome Consortia and the animal genetics community. In recognition of the open-access use of Ensembl resources, SNPchiMp v.3 was officially credited as an Ensembl E!mpowered tool [<xref ref-type="bibr" rid="CR31">31</xref>].</p>
  </sec>
  <sec id="Sec8">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> SNPchiMp v.3</p>
    <p>
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.tecnoparco.org/SNPchimp">http://bioinformatics.tecnoparco.org/SNPchimp</ext-link>
    </p>
    <p><bold>Operating system(s):</bold> Platform independent</p>
    <p><bold>Programming language:</bold> PHP, JQuery-Javascript, SQL, Python</p>
    <p><bold>Other requirements:</bold> none</p>
    <p><bold>License:</bold> GNU GPL</p>
    <p><bold>Any restrictions to use by non-academics:</bold> none</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>Ezequiel L Nicolazzi, Andrea Caprera and Nelson Nazzicari contributed equally to this work.</p>
    </fn>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>ELN, AC, NN, FS, JLW and AS conceived the study. ELN retrieved the data, integrated the SNP array information and coordinated the activity. NN built the database structure and the engine for the web-tool. AC built the user interface, and the connection to external databases, including Ensembl Biomart. PC built the scripts to link this tool to Ensembl Variant Effect Predictor. CS, CL, AP, FB, HJ, GE, GTK, RB and BS provided current and historical original data, helped in the revision of the manuscript and in the improvement of functionalities of the tool. ELN, AC, NN and PC drafted the manuscript. All authors reviewed, gave useful comments and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>George Wiggans and Gary Roher (USDA, USA), Maurizio Marusi (ANAFI, Italy) and John McEwan (AgResearch, New Zealand) are greatly acknowledged for providing almost real-time news on SNP array updates. We also thank the three unknown reviewers for their useful comments and suggestions. The research leading to these results has received funding from the European Union’s Seventh Framework Programme for research, technological development and demonstration under grant agreement n° 289592 - Gene2Farm.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Eurostat 2014 [<ext-link ext-link-type="uri" xlink:href="http://ec.europa.eu/eurostat/web/agriculture/data/main-tables">http://ec.europa.eu/eurostat/web/agriculture/data/main-tables</ext-link>]</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>European Union</collab>
        </person-group>
        <source>Agriculture, forestry and fishery statistics</source>
        <year>2013</year>
        <publisher-loc>Luxembourg</publisher-loc>
        <publisher-name>Eurostat Pocketbooks</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lund</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Janss</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Guldbrandtsen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Brøndum</surname>
            <given-names>RF</given-names>
          </name>
        </person-group>
        <article-title>Invited review: genomic evaluation of cattle in a multi-breed context</article-title>
        <source>Livest Sci</source>
        <year>2014</year>
        <volume>166</volume>
        <fpage>101</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/j.livsci.2014.05.008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petersen</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Mickelson</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Cothran</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Axelsson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic diversity in the modern horse illustrated from genome-wide SNP data</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0054997</pub-id>
        <?supplied-pmid 23383025?>
        <pub-id pub-id-type="pmid">23383025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Heaton MP, Leymaster KA, Kalbfleisch TS, Kijas JW, Clarke SM, McEwan J, et al. SNPs for Parentage Testing and Traceability in Globally Diverse Breeds of Sheep. PLoS ONE. 2014;9:e94851.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Grossen C, Keller L, Biebach I, the International Goat Genome Consortium, Croll D. Introgression from Domestic Goat Generated Variation at the Major Histocompatibility Complex of Alpine Ibex. PLoS Genet. 2014;10:e1004438.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pausch</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aigner</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Emmerling</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Edel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Götz</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fries</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Imputation of high-density genotypes in the Fleckvieh cattle population</article-title>
        <source>Genet Sel Evol.</source>
        <year>2013</year>
        <volume>45</volume>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-45-3</pub-id>
        <?supplied-pmid 23406470?>
        <pub-id pub-id-type="pmid">23406470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hayes</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Bowman</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Daetwyler</surname>
            <given-names>HD</given-names>
          </name>
          <name>
            <surname>Kijas</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>van der Werf</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Accuracy of genotype imputation in sheep breeds</article-title>
        <source>Anim Genet.</source>
        <year>2012</year>
        <volume>43</volume>
        <fpage>72</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-2052.2011.02208.x</pub-id>
        <?supplied-pmid 22221027?>
        <pub-id pub-id-type="pmid">22221027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zimin</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Florea</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Puiu</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A whole-genome assembly of the domestic cow, Bos taurus</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R42</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-4-r42</pub-id>
        <?supplied-pmid 19393038?>
        <pub-id pub-id-type="pmid">19393038</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Bovine Genome Project [<ext-link ext-link-type="uri" xlink:href="http://www.hgsc.bcm.edu/other-mammals/bovine-genome-project">www.hgsc.bcm.edu/other-mammals/bovine-genome-project</ext-link>]</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>The Bovine Genome Sequencing and Analysis Consortium</collab>
          <name>
            <surname>Elsik</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Tellam</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Worley</surname>
            <given-names>KC</given-names>
          </name>
        </person-group>
        <article-title>The genome sequence of taurine cattle: a window to ruminant biology and evolution</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>324</volume>
        <fpage>522</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1169588</pub-id>
        <pub-id pub-id-type="pmid">19390049</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A reference genome of the domestic goat (Capra hircus) generated by Illumina sequencing and whole genome mapping</article-title>
        <source>Nature Biotechnol.</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>135</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2478</pub-id>
        <pub-id pub-id-type="pmid">23263233</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">International Sheep Genomics Consortium [<ext-link ext-link-type="uri" xlink:href="http://www.sheephapmap.org">http://www.sheephapmap.org</ext-link>]</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">International Goat Genome Consortium [<ext-link ext-link-type="uri" xlink:href="http://www.goatgenome.org">http://www.goatgenome.org</ext-link>]</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Illumina customer download [<ext-link ext-link-type="uri" xlink:href="http://support.illumina.com/array/downloads.ilmn">http://support.illumina.com/array/downloads.ilmn</ext-link>]</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Affmetrix support [<ext-link ext-link-type="uri" xlink:href="http://www.affymetrix.com/support/index.affx">http://www.affymetrix.com/support/index.affx</ext-link>]</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">NCBI dbSNP [<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/snp/">http://www.ncbi.nlm.nih.gov/snp/</ext-link>]</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">SNPchiMp v.3 Data source [<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.tecnoparco.org/SNPchimp/index.php/data-source">http://bioinformatics.tecnoparco.org/SNPchimp/index.php/data-source</ext-link>]</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Kinsella RJ, Kähäri A, Haider S, Zamora J, Proctor G, Spudich G, et al. Ensembl BioMarts: a hub for data retrieval across taxonomic space. Database. 2011;2011:bar030.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Ensembl BioMart [<ext-link ext-link-type="uri" xlink:href="http://www.ensembl.org/biomart/martview/">http://www.ensembl.org/biomart/martview/</ext-link>]</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">McLaren W, Pritchard B, Rios D, Chen Y, Flicek P, Cunningham F. Deriving the consequences of genomic variants with the Ensembl API and SNP Effect Predictor. Bioinformatics. 2010;26(16):2069-70.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Ensembl Variant Effect Predictor [<ext-link ext-link-type="uri" xlink:href="http://www.ensembl.org/info/docs/tools/vep/index.html">http://www.ensembl.org/info/docs/tools/vep/index.html</ext-link>]</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nicolazzi</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Picciolini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Strozzi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Schnabel</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Lawley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pirani</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SNPchiMp: a database to disentangle the SNPchimp jungle in bovine livestock</article-title>
        <source>BMC genomics</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>123</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-15-123</pub-id>
        <?supplied-pmid 24517501?>
        <pub-id pub-id-type="pmid">24517501</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>A greedy algorithm for aligning DNA sequences</article-title>
        <source>J Comput Biol.</source>
        <year>2000</year>
        <volume>7</volume>
        <fpage>203</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1089/10665270050081478</pub-id>
        <?supplied-pmid 10890397?>
        <pub-id pub-id-type="pmid">10890397</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Nicolazzi EL, Nazzicari N, Caprera A, Fojadelli I, Strozzi F, Schnabel RD, et al. SNPchiMp v.2: An open acces web tool for SNP data management on Bovine, Porcine and Equine livestock. Proceedings of 10<sup>th</sup> World Congress of Genetics Applied to Livestock Production (WCGALP), 2014, <ext-link ext-link-type="uri" xlink:href="https://asas.org/docs/default-source/wcgalp-proceedings-oral/157_paper_9057_manuscript_406_0.pdf?sfvrsn=2">https://asas.org/docs/default-source/wcgalp-proceedings-oral/157_paper_9057_manuscript_406_0.pdf?sfvrsn=2.</ext-link></mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Joomla [<ext-link ext-link-type="uri" xlink:href="https://www.joomla.com/">https://www.joomla.com/</ext-link>]</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nicolazzi</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Iamartino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>AffyPipe: an open-source pipeline for Affymetrix Axiom genotyping workflow</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>3118</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu486</pub-id>
        <?supplied-pmid 25028724?>
        <pub-id pub-id-type="pmid">25028724</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">iConvert repository [<ext-link ext-link-type="uri" xlink:href="https://github.com/nicolazzie/SNPchimpRepo/tree/master/iConvert">https://github.com/nicolazzie/SNPchimpRepo/tree/master/iConvert</ext-link>]</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Plato software download [<ext-link ext-link-type="uri" xlink:href="http://ritchielab.psu.edu/software/plato-download">http://ritchielab.psu.edu/software/plato-download</ext-link>]</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haider</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ballester</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Smedleyt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rice</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kasprzyk</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>BioMart Central Portal—unified access to biological data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>W23</fpage>
        <lpage>W27</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp265</pub-id>
        <?supplied-pmid 19420058?>
        <pub-id pub-id-type="pmid">19420058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Ensembl-powered websites [<ext-link ext-link-type="uri" xlink:href="http://www.ensembl.org/info/about/ensembl_powered.html">http://www.ensembl.org/info/about/ensembl_powered.html</ext-link>]</mixed-citation>
    </ref>
  </ref-list>
</back>
