<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6907144</article-id>
    <article-id pub-id-type="publisher-id">1862</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1862-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>scPred</italic>: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Alquicira-Hernandez</surname>
          <given-names>Jose</given-names>
        </name>
        <address>
          <email>j.alquicira@garvan.org.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sathe</surname>
          <given-names>Anuja</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ji</surname>
          <given-names>Hanlee P.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nguyen</surname>
          <given-names>Quan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Powell</surname>
          <given-names>Joseph E.</given-names>
        </name>
        <address>
          <email>j.powell@garvan.org.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9983 6924</institution-id><institution-id institution-id-type="GRID">grid.415306.5</institution-id><institution>Garvan Institute of Medical Research, </institution></institution-wrap>Darlinghurst, Sydney, Australia </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9320 7537</institution-id><institution-id institution-id-type="GRID">grid.1003.2</institution-id><institution>Institute for Molecular Bioscience, </institution><institution>University of Queensland, </institution></institution-wrap>Brisbane, Australia </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419368956</institution-id><institution-id institution-id-type="GRID">grid.168010.e</institution-id><institution>Division of Oncology, Department of Medicine, </institution><institution>Stanford University School of Medicine, </institution></institution-wrap>Stanford, USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419368956</institution-id><institution-id institution-id-type="GRID">grid.168010.e</institution-id><institution>Stanford Genome Technology Center, </institution><institution>Stanford University, </institution></institution-wrap>Palo Alto, USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 4902 0432</institution-id><institution-id institution-id-type="GRID">grid.1005.4</institution-id><institution>Faculty of Medicine, </institution><institution>University of New South Wales, </institution></institution-wrap>Darlinghurst, Sydney, Australia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>264</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>5</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Single-cell RNA sequencing has enabled the characterization of highly specific cell types in many tissues, as well as both primary and stem cell-derived cell lines. An important facet of these studies is the ability to identify the transcriptional signatures that define a cell type or state. In theory, this information can be used to classify an individual cell based on its transcriptional profile. Here, we present <italic>scPred</italic>, a new generalizable method that is able to provide highly accurate classification of single cells, using a combination of unbiased feature selection from a reduced-dimension space, and machine-learning probability-based prediction method. We apply <italic>scPred</italic> to scRNA-seq data from pancreatic tissue, mononuclear cells, colorectal tumor biopsies, and circulating dendritic cells and show that <italic>scPred</italic> is able to classify individual cells with high accuracy. The generalized method is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/powellgenomicslab/scPred/">https://github.com/powellgenomicslab/scPred/</ext-link>.</p>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Individual cells are the basic building blocks of organisms, and while a human consists of an estimated 30 trillion cells, each one of them is unique at a transcriptional level. Performing bulk or whole-tissue RNA sequencing, which combines the contents of millions of cells, masks most of the differences between cells as the resulting data comprises of the averaged signal from all cells. Single-cell RNA-sequencing (scRNA-seq) has emerged as a revolutionary technique, which can be used to identify the unique transcriptomic profile of each cell. Using this information, we are now able to address questions that previously could not be answered, including the identification of new cell types [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>], resolving the cellular dynamics of developmental processes [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR8">8</xref>], and identify gene regulatory mechanisms that vary between cell subtypes [<xref ref-type="bibr" rid="CR9">9</xref>]. Cell type identification and discovery of subtypes has emerged as one of the most important early applications of scRNA-seq [<xref ref-type="bibr" rid="CR10">10</xref>]. Prior to the arrival of scRNA-seq, the traditional methods to classify cells were based on microscopy, histology, and pathological criteria [<xref ref-type="bibr" rid="CR11">11</xref>]. In the field of immunology, cell surface markers have been widely used to distinguish cell subtypes [<xref ref-type="bibr" rid="CR12">12</xref>], for a wide range of purposes. While this approach is desirable in practical terms for cell isolation, e.g., via fluorescence-activated cell sorting (FACS), these markers may not reflect the overall heterogeneity at a transcriptomic and phenotypic level from mixed cell populations [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. Unsupervised and supervised clustering approaches have been used to determine groups of cells based on similar transcriptional signatures within a sample [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>], and frequently, cells within a cluster are collectively labeled based on the average expression levels of canonical markers [<xref ref-type="bibr" rid="CR17">17</xref>]. The cluster-based classification methods assume that all cells within a cluster are the same type and thus can be labeled collectively. This assumption is frequently wrong, with clusters often containing small percentages of multiple cell types in addition to a major cell type. A method that classifies each cell individually, without clustering first, solves these problems and should provide higher overall accuracy in cell labeling. To be able to predict the classification of a single cell based upon its transcriptome read-out, first, a prediction model needs to be built where the effects of given features are estimated. It is clear that both the selection of features and estimation of their effects play a critical role in the overall prediction performance. Unlike prediction methods that use data derived from bulk RNA-seq data where gene expression averages are used as features, phenotype prediction at single-cell level faces new challenges. Firstly, cell-to-cell differences must be considered to define and predict cell types. Using only a subset of genes (e.g., differentially expressed genes) will likely exclude discriminant sources of variation across cells. An additional limitation is the inconsistency seen between statistical methods used to identify differentially expressed genes [<xref ref-type="bibr" rid="CR18">18</xref>]. Finally, if the number of observations that define a specific subtype of cells is high, then classification algorithms can be computationally expensive or suffer from overfitting. There are numerous applications for which prediction of a cell state or type from its scRNA-seq data can play an important role. An obvious example is in the burgeoning use of single-cell data in characterizing disease states and underlying biology at single-cell resolution [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. The granular nature of single-cell characterization has enormous implications for the accurate prediction of specific cell subtypes and pathological-related states. We anticipate that such prediction strategies will play an important role in the early diagnosis of diseases or informing personalized treatment. Similarly, efforts arising from the Human Cell Atlas [<xref ref-type="bibr" rid="CR10">10</xref>] are set to create a comprehensive reference atlas of most cell subtypes in the human body, meaning cells from new samples can be mapped against this reference. Here, we introduce <italic>scPred</italic>, a method that takes advantage of dimensionality reduction and orthogonalization of gene expression values to accurately predict specific cell types or states of single cells from their transcriptional data (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>). <italic>scPred</italic> can be applied to any situation where cells can be labeled into discrete categories, including cell subtypes or defined cell states.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Summary of the scPred method. <bold>a</bold> Training step. A gene expression matrix is eigendecomposed via singular value decomposition (SVD) to obtain orthonormal linear combinations of the gene expression values. Only PCs explaining greater than 0.01% of the variance of the dataset are considered for the feature selection and model training steps. Informative PCs are selected using a two-tailed Wilcoxon signed-rank test for each cell class distribution (see the “<xref rid="Sec9" ref-type="sec">Methods</xref>” section). The cells-PCs matrix is randomly split into k groups and the first <italic>k</italic> group is considered as a testing dataset for cross-validation. The remaining <italic>K</italic>-1 groups (shown as a single training fold) are used to train a machine learning classification model (a support vector machine). The model parameters are tuned, and each <italic>k</italic> group is used as a testing dataset to evaluate the prediction performance of a <italic>f</italic><sub>i</sub>(<italic>x</italic>) model trained with the remaining <italic>K</italic>-1 groups. The best model in terms of prediction performance is selected. <bold>b</bold> Prediction step. The gene expression values of the cells from an independent test or validation dataset are projected onto the principal component basis from the training model, and the informative PCs are used to predict the class probabilities of each cell using the trained prediction model(s) <italic>f</italic><sub>b</sub>(<italic>x</italic>)</p></caption><graphic xlink:href="13059_2019_1862_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par3"><italic>scPred</italic> is a generalized method for classifying a single cell based on its transcriptional data. The method uses a combination of decomposing the variance structure of a gene expression matrix to identify limited informative features, and a machine learning approach to estimate the effect of these features on classifying cells (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). In doing so, it is able to incorporate a large number of small differences in the mean and variance of gene expression between different cell types in the prediction model. This removes the need to perform gene-specific analyses such as to identify informative features. <italic>scPred</italic> has two main steps. Firstly, a prediction model is built using a training cohort of single-cell data, where the identity of the cells is already known. Secondly, the application of the prediction model to single-cell data obtained from independent sample, with each cell then assigned a conditional class probability (<italic>y = 1|f</italic>) of belonging to a given cell subtype or state. <italic>scPred</italic> incorporates a rejection option to avoid assigning cells to a class when the conditional class probability is lower than a given value. In the case of binary classification, this means that Pr<italic>(y = 1|f)</italic> and Pr<italic>(y = 0|f)</italic> should be higher than a probability threshold for a cell to be assigned to any class respectively. When the maximum probability across all classes is lower than the threshold, then a cell is labeled as “unassigned.” Sensitivity and specificity metrics reported in this paper consider the “unassigned” label as incorrect. Therefore, computed probabilities for cells in the test dataset are below the threshold, all of them are labeled as unassigned, and the sensitivity and specificity are both equal to zero (see the “<xref rid="Sec9" ref-type="sec">Methods</xref>” section). This criterion avoids misclassifying cells when some cell types are not considered in the prediction model but are present in the test data. For all analyses in this paper, we used a strict threshold of 0.9. This threshold can be changed in the software implementation. Here, we present the results of the application of <italic>scPred</italic> under four distinct scenarios.</p>
    <sec id="Sec3">
      <title><italic>scPred</italic> can accurately predict tumor epithelial cells from gastric cancer</title>
      <p id="Par4">We initially sought to demonstrate the performance of <italic>scPred</italic> by making computational predictions of tumor and non-tumor cells based on their transcriptomes and validating our classification using a cell-specific independent immunohistochemistry assay targeting the MLH1 and PMS2 protein expression. We used this information as an RNA-independent gold-standard to annotate the status of all cells. The loss of MLH1 protein expression has been shown to be related to a hypermutable state of microsatellite instability which can be detected at single-cell resolution from the raw scRNA-seq data [<xref ref-type="bibr" rid="CR20">20</xref>]. Along with the protein depletion confirmed by the immunochemistry assay, we confirmed the loss of expression of MLH1 at the RNA level, as well as the upregulation of EPCAM and TFF3 in tumor cells, which are known to be overexpressed in cancer cells [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). Thus, we have a method for linking the observed scRNA-seq data to the immunohistochemistry-labeled classification for each cell. We obtained surgical biopsies from stage IIA intestinal gastric adenocarcinoma along with matched-normal epithelium from two patients and measure the protein expression of MLH1 and PMS2 to validate the presence of tumor cells. Then, we generated scRNA-seq data for four samples using the Chromium platform (10X Genomics). For the first pair of samples, we obtained 1905 epithelial cells based on the expression of EpCAM, and from these identified tumor cells based on the microsatellite stability, and trained a model to detect differences between tumor and non-tumor epithelial cells. Using cells from the second pair of samples, we then applied this model to classify cells using just the scRNA-seq data. We then confirmed our predictions using the observation of microsatellite instability. Overall, we obtained a sensitivity of 0.979 and specificity of 0.974 (AUROC = 0.999, AUPRC = 0.999, F1 score = 0.990) across the ten bootstrap replicates (Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). To demonstrate the increase in performance from using the principal components selected by <italic>scPred</italic> as features, we compared the prediction performance of <italic>scPred</italic> against five baselines. First, we fitted an SVM model using <italic>scPred</italic> and used only the intercept of the hyperplane as a predictor to evaluate any bias in the predictor due to class proportions. We obtained sensitivity and specificity equal to zero (AUROC = 0.5 and AUPRC = 0) and thus show no bias when cell classification is attempted for unequal ratios of cells. Then, we evaluated the contribution of the informative principal components by setting all the coefficients of the hyperplane to 1. We found that the sensitivity was 0 and the specificity 0.995 (AUROC = 0.496, AUPRC = 0.538, F1 = 0.000), which indicates that the predictors should be weighted to separate the cells accurately into tumor and non-tumor. To demonstrate the importance of the feature selection performed by <italic>scPred</italic>, we used all principal components as predictors to having a baseline of the expected classification from all data. We obtained sensitivity and specificity equal to zero (AUROC = 0 and AUPRC = 0.398, F1 = 000), which implies that the informative principal components recover the cell-type informative variance from the entire data. To evaluate how the global cell composition can predict tumor status, we calculated the per-cell mean of the log2(CPM + 1) and trained a model using these values as a predictor. After performing the predictions on the test data, we obtained a sensitivity of 0.894 and specificity of 0.902 (AUROC = 0.912, AUPRC = 0.912, F1 = 0.916). The lower performance compared to the default <italic>scPred</italic> algorithm demonstrates using principal components for feature selection captures variance in gene expression that cell-type specific. Finally, we calculated the differentially expressed genes between tumor and non-tumor cells to obtain a set of discriminant genes. We used these genes as features to train a model, and after the predictions, we obtained sensitivity and specificity of 0.903 and 0.909 respectively (AUROC = 0.937, AUPRC = 0.931, F1 = 0.922). For all analyses, we performed ten bootstrap replicates with the same data partitions used before. These results show that <italic>scPred</italic> yields higher accuracy than our baseline models and outperforms predictions based on differentially expressed genes (see Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). Next, we investigated the effect of sequencing depth and the number of cells of a given cell type on the prediction performance of <italic>scPred</italic>. First, we down-sampled the reads from each cell in the training data by scaling the gene counts so that each cell had fewer than a fixed <italic>N</italic> number of reads. We evaluated a range of sequencing depths from an average of 5000 to 40,000 reads per cell to train the models and predicted the cell types from the test data. We repeated this process ten times using the same data partitions from previous analyses. The sensitivity of the classification showed no changes across sequencing depths, while the specificity, AUROC, and AUPRC showed a considerable decrease once the average reads per cell are 20,000 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). Based on the cellranger output, we estimate that 20,000 reads per cell represent approximately 50% saturation of the library. We, therefore, recommend training models on cells that have been sequenced to high saturation. Finally, we assessed the impact of the cell population size in the prediction accuracy by performing bootstrap iterations of classifying cells using a training model generated with between 100 and 900 randomly sampled tumor cells. We observed a small effect on the AUROC, AUPRC, F1 score, sensitivity, and specificity until the number of tumor cells included in the training model was less than 200. When only 100 cells were included (AUROC = 0.996, AUPRC = 0.996, F1 = 0.990), the mean sensitivity dropped down to 0.741 while the specificity changed from 0.974 to 0.885 with respect to the 953 cells used originally (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). Collectively, these results show that <italic>scPred</italic> can accurately classify cells provided they are not a very rare type in the training data.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Classification performance of tumor cells from gastric adenocarcinoma. scPred shows high prediction accuracy to classify tumor cells (0.979 (95% bootstrap CI 0.973–0.984) and non-tumor cells 0.974 (95% bootstrap CI 0.960–0.989). scPred outperforms predictions based on differentially expressed genes and per-cell mean of log2(CPM + 1) (prediction baseline). Ten bootstrap replicates were used to assess the prediction performance of all methods</p></caption><graphic xlink:href="13059_2019_1862_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title><italic>scPred</italic> can accurately predict cell subtype using scRNA-seq data generated across different platforms</title>
      <p id="Par5">Given the rapid development of single-cell sequencing assays and technologies, we anticipate that a prediction model for a given cell subtype(s) will often be built with data generated from an alternative platform to that used for independent test samples. To assess the robustness of <italic>scPred</italic>, we sought to evaluate the performance using training data generated from multiple platforms and testing the prediction accuracy for independent cells sequenced on another platform. We chose to develop a prediction model using <italic>scPred</italic> to classify subtypes of islets of Langerhans cells from scRNA-seq data generated from pancreas tissue due to their limited abundance (4.5% in a pancreatic tissue sample) [<xref ref-type="bibr" rid="CR23">23</xref>], and thus will represent a class of cells that is expected to be more difficult to predict based on their low relative existence compared to other cells. Islets of Langerhans are composed mainly of four distinct cell types, namely α (alpha), β (beta), δ (delta), and γ (gamma) cells, that are responsible for producing glucagon, insulin, somatostatin, and pancreatic-polypeptides, respectively [<xref ref-type="bibr" rid="CR24">24</xref>]. We generated a training reference cohort of scRNA-seq data from a total of 4292 cells from three independent studies undertaken by Muraro et al. [<xref ref-type="bibr" rid="CR25">25</xref>], Segerstolpe et al. [<xref ref-type="bibr" rid="CR3">3</xref>], and Xin et al. [<xref ref-type="bibr" rid="CR26">26</xref>] that had sequenced cells using CEL-seq2 [<xref ref-type="bibr" rid="CR27">27</xref>], Smart-Seq2 [<xref ref-type="bibr" rid="CR28">28</xref>], and SMARTer [<xref ref-type="bibr" rid="CR29">29</xref>], respectively. Details of the training cohort data are given in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S2. Importantly, using the Seurat alignment method [<xref ref-type="bibr" rid="CR30">30</xref>], we are able to demonstrate that between platform and between sample batch effects can be removed for the training cohort (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The best fit models from <italic>scPred</italic> for α, β, δ, and γ cells used between 14 and 18 PCs, which represents a small feature space for prediction in an independent data, and correspondingly will reduce the computational requirements of <italic>scPred</italic> in the testing phase. Using the prediction classifier model trained from the aligned reference cohort data, we naively predicted the cell type of each of 7932 cells [<xref ref-type="bibr" rid="CR31">31</xref>], collected from four healthy individuals, using their scRNA-seq data generated using inDrop [<xref ref-type="bibr" rid="CR32">32</xref>]. The testing data includes a heterogeneous mix cell islets of Langerhans cells, meaning non-α, β, δ, and γ cells, such as epsilon, endothelial, or T cells, provide a negative control. We classified a cell as a specific cell subtype based on a class probability (Pr<italic>(y = 1|f)</italic>) greater than 0.9. The overall accuracy of the predictions was evaluated based on the known cell identities determined based on the expression of classic markers (GCG, INS, SST, and PPY). For islets of Langerhans cells, the prediction model built by <italic>scPred</italic> using the scRNA-seq data from the reference cohort was able to predict cell type with an average accuracy of 97.68% (Table <xref rid="Tab1" ref-type="table">1</xref> and Fig. <xref rid="Fig3" ref-type="fig">3</xref>) and accurately labeling 94.9% heterogeneous populations of other cells. For example, of the 2302 α cells in the test cohort, our <italic>scPred</italic> model classified 2264 cells correctly. Of the 38 misclassified cells, 33 were unassigned to another target cell type, which also demonstrates a high specificity of the model. We observed the same pattern for all cell types tested (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3). To further support this conclusion, the mean Pr<italic>(y = 1|f)</italic> for cells classified as α, β, δ, and γ was 0.994–0.997, while cells classified as other (i.e., epsilon, endothelial, or T cells) had a mean Pr<italic>(y = 1|f)</italic> of 0.307 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). To evaluate the effect of the Seurat manifold alignment on data integration across platforms, we performed the sample cell classifications using trained models developed using unaligned data. We observed a reduction of 31% in sensitivity and only 0.7% in specificity (see Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S4). Then, we compared the performance of other prediction models (k-nearest neighbors, elastic net, Naive Bayes, multivariate adaptive regression splines, random forests, and generalized linear model) to support vector machines. Overall, support vector machines with a radial kernel showed the highest accuracy for detecting cells from the islets of Langerhans while reducing the proportion of other cells being miss-classified (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S5). Together, these results show that support vector machines are ideal for classifying single cells from an informative feature eigenspace.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Principal component alignment of pancreatic cells. <bold>a</bold> Training (Muraro, Segerstolpe, and Xin) datasets [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] were used to generate the training eigenspace. The test dataset (Baron et al. [<xref ref-type="bibr" rid="CR31">31</xref>]) was projected, and all datasets were aligned using Seurat. No batch effect is observed after the alignment. <bold>b</bold> α, β, δ, and γ cells are included in the training datasets. The prediction dataset contains also 2326 “other” cell types such as epsilon, acinar, stellate, ductal, endothelial, Schwann, and T cells (bright green cells). After the dataset alignment, cells cluster by cell type. The <italic>X</italic>-axis shows variance explained (exp.var.), principal components (PC), and aligned principal components (APC)</p></caption><graphic xlink:href="13059_2019_1862_Fig3_HTML" id="MO3"/></fig>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Prediction of pancreatic cells. The training panel corresponds to the Muraro, Segerstolpe, and Xin datasets used as a reference to train the prediction models for each cell type from the islets of Langerhans. As part of the training, no other cell types were considered. The test information corresponds to the Baron [<xref ref-type="bibr" rid="CR31">31</xref>] dataset used to measure the performance of the trained models in an independent dataset. The Baron dataset contains epsilon, acinar, stellate, ductal, endothelial, Schwann, and T cells referred as “Other” in this table. The accuracy is defined as the fraction of cells correctly assigned for each cell type of interest. The accuracy for the remaining cells corresponds to the fraction of cells from the test dataset that are correctly unassigned to any of the classes of interest (negative controls) as a consensus across all four prediction models</p></caption><graphic position="anchor" xlink:href="13059_2019_1862_Tab1_HTML" id="MO4"/></table-wrap></p>
      <p id="Par6">To further demonstrate the application of a <italic>scPred</italic> model in multiple datasets, we trained a prediction model on the Baron data and assessed its prediction performance on the Muraro, Segerstolpe and Xin datasets. We obtained an average accuracy of 0.98, 0.92, 0.93, and 0.82 for alpha, beta, delta, and gamma cells respectively using the Baron dataset as reference only (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S6). Finally, we compared the performance of <italic>scPred</italic> with <italic>scmap</italic> [<xref ref-type="bibr" rid="CR33">33</xref>], <italic>CaSTLe</italic> [<xref ref-type="bibr" rid="CR34">34</xref>], <italic>singleCellNet</italic> [<xref ref-type="bibr" rid="CR35">35</xref>], and <italic>scID</italic> [<xref ref-type="bibr" rid="CR36">36</xref>] methods. For <italic>scmap</italic>, we applied both cluster and cell projection algorithms to annotate cells based on their proximity to the reference dataset. <italic>Scmap</italic> failed to identify all gamma cells using both algorithms and exhibited low performance classifying delta cells by yielding at most 14% of accuracy using the Baron dataset as reference (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Tables S7 and S8). Likewise, <italic>CaSTLe</italic> exhibited an accuracy of zero for classifying gamma cells in both Segerstolpe and Xin datasets and very poor accuracy to detect beta and delta cells (see Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S9). <italic>singleCellMap</italic> suffered from very low accuracy for gamma cells with only 9% of accuracy (see Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S10). <italic>scID</italic> classified gamma cells from the Segerstolpe and Xin datasets with high accuracy (96% and 94% respectively), however, it failed to classify 99% from the Muraro dataset (see Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S11). These results show that the features selected from the decomposed training data are able to define hyperplanes that are able to separate individual cells by cell type, based upon linear combinations of scRNA-seq data fitted to a <italic>scPred</italic> models.</p>
    </sec>
    <sec id="Sec5">
      <title>Accurate prediction of peripheral blood mononuclear cells</title>
      <p id="Par7">Peripheral blood mononuclear cells (PBMCs) comprise diverse groups of cells that are extensively studied because of their role in mediating adaptive and innate immune responses as well as their implication in autoimmune, metabolic, and infectious diseases [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]. Here, we aimed to classify PBMCs from which their cell identity was determined based on fluorescence-activated cell sorting (FACS) [<xref ref-type="bibr" rid="CR39">39</xref>]. For doing so, we developed a hierarchical tree-based prediction approach in which individual cells are classified along with categories following the hematopoietic lineage of PBMCs (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>). This strategy decomposes the problem of predicting closely related cells by training models for cell types that are comparable in terms of their variance and hierarchic organization in the hematopoietic lineage. Firstly, a cell is classified as myeloid, lymphoid, or progenitor. Secondly, all cells predicted as lymphoid are further subcategorized into B cells, T cells, and Natural Killer. Finally, the cytotoxic state of the predicted T cells is assigned. For each level in the hierarchy, a <italic>scPred</italic> model was trained. To verify the performance of this approach, we compared the cell type information derived from FACS versus the predictions made by <italic>scPred</italic> based exclusively on the transcriptome. We performed ten bootstrap replicates to estimate to test the performance of our approach by splitting the 94,655 PBMCs into training and test groups. Overall, 97.67% of the cells from the test group (45, 884 out of 47, 328) were classified correctly (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Notably, the highest and lowest accuracies obtained for a cell-type group were 99.7% and 95.13% for lymphoid cells and cytotoxic T cells respectively. Bootstrap 95% confidence intervals are reported in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S12. These results demonstrate that <italic>scPred</italic> can accurately classify cells that share very similar transcriptional profiles.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Prediction results of PBMCs. The average number of cells for each cell type across all ten bootstrap replicates is shown. (i) First, every single cell was classified as myeloid, lymphoid, or blood progenitor. (ii) A second layer of prediction is used to classify all lymphoid cells as B cells, T cells, or natural killer. (iii) Finally, all T cells are subclassified as cytotoxic or non-cytotoxic. Confidence intervals for mean estimates are included in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S12</p></caption><graphic xlink:href="13059_2019_1862_Fig4_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Accurate prediction of human dendritic cells from data generated across laboratories</title>
      <p id="Par8">We next sought to evaluate the performance of <italic>scPred</italic> when the training and testing cells sequenced using the same protocol but in different laboratories. For developing single cell-based diagnostic tests, this is an important consideration, as in the majority of cases a predictive model will be developed using sequence data generated from different laboratories to those conducting testing. Between-site effects could bias the predictive performance of a test if the between-site batch effects are confounded with the model classification features. While between-site variance for bulk-RNA-sequencing is small [<xref ref-type="bibr" rid="CR40">40</xref>], it has not yet been fully evaluated for scRNA-Seq. We chose to evaluate the performance of <italic>scPred</italic> by building a prediction model to identify dendritic cells from peripheral blood samples [<xref ref-type="bibr" rid="CR1">1</xref>]. Dendritic cells are antigen-presenting cells, and their main function is to process antigen material and present it on the cell surface to T cells, acting as messengers between the innate and adaptive immune systems. Using the cell type classification based on scRNA-seq and flow validation given in Villani et al. [<xref ref-type="bibr" rid="CR1">1</xref>], we built a <italic>scPred</italic> prediction model using scRNA-seq data generated using the SMART-seq2 protocol for 660 dendritic cells. The best fit model from <italic>scPred</italic> used 11 PCs, which collectively explained 5.97% of the variance in the entire training data cohort.</p>
      <p id="Par9">We then applied our model to predict dendritic cells from two independent test data cohorts consisting of scRNA-seq data from a heterogeneous mix of cells from peripheral blood (461 cells) and umbilical cord (420 cells), also generated using the SMART-Seq2 protocol in a different laboratory [<xref ref-type="bibr" rid="CR41">41</xref>]. Notably, the accuracy for peripheral blood-derived cells was 98% (Table <xref rid="Tab2" ref-type="table">2</xref>, Fig. <xref rid="Fig5" ref-type="fig">5</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S13). When we applied the <italic>scPred</italic> model to the cells obtained from an umbilical cord, the overall accuracy was 82%. This lower prediction accuracy possibly reflects a contamination or incorrect original classification of cells obtained from the umbilical cord. To evaluate this, we looked for differentially expressed genes between the 60 cells with a dendritic cell class probability of &lt; 0.9 and the remaining cord cells (see Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S14). We identified upregulation of genes overlapping the T cell receptor gamma locus: TRGC2, TARP, and X06776 (a truncated mRNA from the TRG gamma gene). Additionally, an over-representation of myeloid and neutrophil-related biological processes for upregulated genes was identified in these cells (see Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S15). All gene ontologies corresponded to myeloid cells, and the presence transcripts from a T cell specialized locus suggests the presence of T cells or alternatively greater heterogeneity in cord-derived cells. Collectively, these results demonstrate that <italic>scPred</italic> is able to accurately predict cell classes using a model trained on data generated in a different laboratory to the test data, without the need to normalize data between sites. This implies that any potential batch effects, or laboratory effects, are not captured in the informative features used to develop the prediction model.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Prediction of dendritic cells from Breton et al. test data. The first column corresponds to the sample origin of the dendritic cells analyzed by Breton et al. The second column shows the class label assigned by scPred. The accuracy is reported by sample origin. Importantly, only 10 dendritic cells out of 461 were classified as monocytes. This demonstrates the high accuracy achieved by scPred to distinguish dendritic cells from monocytes from peripheral blood. For umbilical cord derived-cells, only 14 out of 420 cells were classified as monocytes and 60 were unassigned as their probability to belong to any of the classes from the training set was low. As discussed in the main text, we argue that these cells correspond to other cell subtypes</p></caption><graphic position="anchor" xlink:href="13059_2019_1862_Tab2_HTML" id="MO6"/></table-wrap>
<fig id="Fig5"><label>Fig. 5</label><caption><p>Prediction of human dendritic cells. <bold>a</bold> The training dataset (Villani et al.) of dendritic cells and monocytes was eigendecomposed (orange and yellow points and density lines). <bold>b</bold> Dendritic cells from the test dataset (Breton et al) were projected onto the training eigenspace (purple points). scPred predicted 98% of dendritic cells derived from peripheral blood correctly and 82% from umbilical cord (Breton et al.). Blue points correspond to cells that were misclassified and black points to unassigned cells</p></caption><graphic xlink:href="13059_2019_1862_Fig5_HTML" id="MO7"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Accurate classification when cell types are imbalanced</title>
      <p id="Par10">Primary tumors contain cells that are both tumor and non-tumor cells of varying types. However, importantly, tumor cells originate from the same cell subtypes of one or more of the original healthy cells in a tissue. Numerous methods exist for classifying (or diagnosing) a whole tissue biopsy as either cancerous or non-cancerous based on DNA genotyping [<xref ref-type="bibr" rid="CR42">42</xref>], transcriptome profiling [<xref ref-type="bibr" rid="CR43">43</xref>, <xref ref-type="bibr" rid="CR44">44</xref>], or histochemistry [<xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR46">46</xref>]. Most of these methods work well, but are unable to accurately classify heterogeneity at a cellular level, and do not work if the percentage of tumor cells in a biopsy is small. We applied <italic>scPred</italic> to predict epithelial tumor cells from a heterogeneous population of cells from tumor- and normal mucosa-matched samples from 11 colorectal cancer patients [<xref ref-type="bibr" rid="CR47">47</xref>]. Of the 275 cells from colorectal cancer samples, the imbalance in the proportions of colorectal cancer epithelial stem/TA-like cells compared to healthy controls was a 1:5 ratio of normal to tumor cells. The prediction accuracy was evaluated using a bootstrapping method, training on a randomly sampled 75% of the data and predicting on the remaining 25%, while correcting for class imbalance using the smote algorithm [<xref ref-type="bibr" rid="CR48">48</xref>]. To estimate the variance of prediction accuracy, 50 bootstraps were performed, and the mean across replicates was calculated (see the “<xref rid="Sec9" ref-type="sec">Methods</xref>” section). Overall, the mean area under the receiver-characteristic function was 96.4 with 95% confidence intervals of 95.5–97.2 (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). Likewise, the mean precision-recall curve was 0.992 (95% confidence intervals of 0.989–0.995) (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b). Given the imbalance in the proportions of colorectal cancer, the high area under the precision-recall curve and small confidence intervals indicate that <italic>scPred</italic> is robust to class imbalance in the training data. The high specificity of the model under this scenario implies that a single-cell prediction method would be able to accurately diagnose disease status using scRNA-seq data from a limited number of cells. For example, here, the mean sensitivity for tumor cells is 0.761 and the specificity is 0.958. Thus, if in a patient sample 100 cells were single-cell sequenced, the probability of incorrectly classifying 10 cells as a tumor cell from a healthy individual would be 6.3 × 10<sup>−7</sup>. Conversely, once 10 cells are correctly classified tumor cells in a true tumor biopsy, the probability of accurately diagnosing the disease state is approximately 1.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Prediction results of colorectal cancer epithelial stem/TA-like cells. The performance of the prediction was measured using the receiver operating characteristic area under the curve (ROC AUC) and the precision-recall area under the curve (PR AUC). 95% confidence bands are shown in both cases for 50 bootstrap replicates. <bold>a</bold> ROC AUC. The area under the curve shows the relationship between the cells incorrectly assigned to that come from tumor samples versus the ones that were correctly assigned by the prediction model as tumor cells using a series of different threshold points. <bold>b</bold> PR AUC. The area under the curve measures the relationship between the cells correctly classified as tumor cells versus the fraction of cells correctly assigned as tumor cells from the total number of cells classified as tumor cells. An AUC value of 0.992 shows robustness to class imbalance</p></caption><graphic xlink:href="13059_2019_1862_Fig6_HTML" id="MO8"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par11">Single-cell RNA sequencing has provided the ability to analyze the transcriptomic profile of individual cells, leading to the identification of novel cell types and the characterization of heterogeneous cell populations. Here, we introduced <italic>scPred</italic>, a novel method to classify single cells based on singular value decomposition and a support vector machine model. <italic>scPred</italic> takes advantage of the informative signals spread across orthonormal linear combinations of the gene expression values and minimizes the incorporation of noise to the prediction model by excluding principal components with a low contribution to the variance explained. <italic>scPred</italic> uses support vector machines as a default machine learning approach as it is suitable for large datasets and accounts for various sources of data [<xref ref-type="bibr" rid="CR49">49</xref>]. Supervised machine learning methods have been used in previous studies to classify various cell types such as retinal bipolar cells [<xref ref-type="bibr" rid="CR50">50</xref>] and embryonic stem cells [<xref ref-type="bibr" rid="CR51">51</xref>]. Here, we have shown that <italic>scPred</italic> shows high accuracy in a variety of relevant biological and clinical scenarios which include predicting pathological cell states from gastric and colorectal cancer as well as characterizing the cell-type composition of peripheral blood mononuclear cells. Collectively, our results show that <italic>scPred</italic> is able to accurately classify individual cells from an independent sample to those used to train the prediction model. However, the ability to do so even when using a training cohort of cells whose scRNA-seq data is assayed from different platforms has important implications for a practical implementation of <italic>scPred</italic>. The ability to build a single-cell training cohort using data generated from multiple platforms means that composite reference datasets can be generated, which will increase the predictive accuracy of <italic>scPred</italic> through a more accurate estimate of the model effects. One of the advantages of <italic>scPred</italic> is that by reducing the dimensions of the gene expression matrix via singular value decomposition we also decrease the number of features to be fit, reducing both the computational requirements for prediction and the prediction model parameter space. While we have used a support vector machine method, the <italic>scPred</italic> software can be easily adjusted to use other classification algorithms [<xref ref-type="bibr" rid="CR52">52</xref>], allowing a user to choose the models that suit the effect distributions of their data best.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <p id="Par12">The <italic>scPred</italic> method is split into two major steps. First, a prediction model is built using a training dataset of scRNA-seq data. The second step is the application of this prediction model to scRNA-seq data obtained from independent sample, with each cell then assigned a probability of belonging to a given class based on the fit of its scRNA-seq expression levels in the prediction model. Below, we have outlined the methods for each of these steps. We start with a single-cell gene expression matrix <italic>C</italic><sub>Train</sub> (CPM values—count per million mapped reads) obtained from different characterization classes: for example, from different cell subtypes, cells obtained from disease versus control samples, or cells defined as different states.</p>
    <sec id="Sec10">
      <title>Training step</title>
      <p id="Par13">The training expression matrix is log2-transformed log<sub>2</sub>(<italic>G</italic><sub>Train</sub>+1) to linearize the expression values for each gene and stabilize the variance across a large expression range. Let <italic>G</italic><sub>Train</sub> be the log<sub>2</sub>-transformed expression matrix <italic>C</italic><sub>Train</sub> with <italic>n</italic> single cells and <italic>m</italic> genes:</p>
      <p id="Par14">
        <disp-formula id="Equa">
          <alternatives>
            <tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {G}_{\mathrm{Train}}=\left[\begin{array}{ccccc}{x}_{11}&amp; {x}_{12}&amp; {x}_{13}&amp; \cdots &amp; {x}_{1m}\\ {}{x}_{21}&amp; {x}_{22}&amp; {x}_{23}&amp; \cdots &amp; {x}_{2m}\\ {}\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ {}{x}_{n1}&amp; {x}_{n2}&amp; {x}_{n3}&amp; \cdots &amp; {x}_{nm}\end{array}\right] $$\end{document}</tex-math>
            <mml:math id="M2" display="block">
              <mml:msub>
                <mml:mi>G</mml:mi>
                <mml:mtext>Train</mml:mtext>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mfenced close="]" open="[" separators=",">
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mn>11</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mn>12</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mn>13</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋯</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mi>m</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mn>21</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mn>22</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mn>23</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋯</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                          <mml:mi>m</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>⋮</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋮</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋮</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋱</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋮</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                          <mml:mn>3</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋯</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mi mathvariant="italic">nm</mml:mi>
                      </mml:msub>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mfenced>
            </mml:math>
            <graphic xlink:href="13059_2019_1862_Article_Equa.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par15">We subsequently center and scale <italic>G</italic><sub>Train</sub> using the mean and standard deviation of gene expression values of each gene, calculated using the following formulas:</p>
      <p id="Par16">
        <disp-formula id="Equb">
          <alternatives>
            <tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu =\frac{1}{n}\sum \limits_{i=1}^n{x}_1\kern1.00em \sigma =\sqrt{\frac{1}{n-1}\sum \limits_{i=1}^n{\left({x}_i-\mu \right)}^2} $$\end{document}</tex-math>
            <mml:math id="M4" display="block">
              <mml:mi>μ</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mi>n</mml:mi>
              </mml:mfrac>
              <mml:munderover>
                <mml:mo movablelimits="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mi>n</mml:mi>
              </mml:munderover>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:mspace width="0.5em"/>
              <mml:mspace width="0.5em"/>
              <mml:mi>σ</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:msqrt>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:munderover>
                    <mml:mo movablelimits="false">∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>n</mml:mi>
                  </mml:munderover>
                  <mml:msup>
                    <mml:mfenced close=")" open="(">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:mi>μ</mml:mi>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                </mml:mrow>
              </mml:msqrt>
            </mml:math>
            <graphic xlink:href="13059_2019_1862_Article_Equb.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par17">Each mean is subtracted from all <italic>m</italic><sub><italic>th</italic></sub> elements of their corresponding <italic>n</italic><sub><italic>th</italic></sub> row, and the result is divided by the respective standard deviation as follows:</p>
      <p id="Par18">
        <disp-formula id="Equc">
          <alternatives>
            <tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ M=\left[\begin{array}{ccccc}\left({x}_{11}-{\mu}_1\right)/{\sigma}_1&amp; \left({x}_{12}-{\mu}_2\right)/{\sigma}_2&amp; \left({x}_{13}-{\mu}_3\right)/{\sigma}_3&amp; \cdots &amp; \left({x}_{1m}-{\mu}_m\right)/{\sigma}_m\\ {}\left({x}_{21}-{\mu}_1\right)/{\sigma}_1&amp; \left({x}_{22}-{\mu}_2\right)/{\sigma}_2&amp; \left({x}_{23}-{\mu}_3\right)/{\sigma}_3&amp; \cdots &amp; \left({x}_{2m}-{\mu}_m\right)/{\sigma}_m\\ {}\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ {}\left({x}_{n1}-{\mu}_1\right)/{\sigma}_1&amp; \left({x}_{n2}-{\mu}_2\right)/{\sigma}_2&amp; \left({x}_{n3}-{\mu}_3\right)/{\sigma}_3&amp; \vdots &amp; \left({x}_{nm}-{\mu}_m\right)/{\sigma}_m\end{array}\right] $$\end{document}</tex-math>
            <mml:math id="M6" display="block">
              <mml:mi>M</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mfenced close="]" open="[">
                <mml:mtable columnalign="center center center center center" columnspacing="1em" rowspacing="4pt">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>11</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>μ</mml:mi>
                          </mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>/</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>12</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>μ</mml:mi>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>/</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>13</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>μ</mml:mi>
                          </mml:mrow>
                          <mml:mn>3</mml:mn>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>/</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mn>3</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋯</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:mi>m</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>μ</mml:mi>
                          </mml:mrow>
                          <mml:mi>m</mml:mi>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>/</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mi>m</mml:mi>
                      </mml:msub>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow/>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>21</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>μ</mml:mi>
                          </mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>/</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>22</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>μ</mml:mi>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>/</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>23</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>μ</mml:mi>
                          </mml:mrow>
                          <mml:mn>3</mml:mn>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>/</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mn>3</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋯</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:mi>m</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>μ</mml:mi>
                          </mml:mrow>
                          <mml:mi>m</mml:mi>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>/</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mi>m</mml:mi>
                      </mml:msub>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow/>
                      <mml:mo>⋮</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋮</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋮</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋱</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋮</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow/>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>μ</mml:mi>
                          </mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>/</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>μ</mml:mi>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>/</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>μ</mml:mi>
                          </mml:mrow>
                          <mml:mn>3</mml:mn>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>/</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mn>3</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋮</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                            <mml:mi>m</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>μ</mml:mi>
                          </mml:mrow>
                          <mml:mi>m</mml:mi>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>/</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mi>m</mml:mi>
                      </mml:msub>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mfenced>
            </mml:math>
            <graphic xlink:href="13059_2019_1862_Article_Equc.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par19">We next calculate orthogonal vectors for the gene expression values using a singular value decomposition (SVD) method. To do so, the matrix <italic>M</italic> needs to be factorized into the product of three matrices as follows:</p>
      <p id="Par20"><disp-formula id="Equd"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ M=U\sum {V}^T $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:mo>∑</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:math><graphic xlink:href="13059_2019_1862_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>where <italic>U</italic> and <italic>V</italic> are orthonormal matrices and Σ a diagonal matrix.</p>
      <p id="Par21">First, we compute the product <italic>MM</italic><sup><italic>T</italic></sup>. To find <italic>U</italic>, we orthogonally diagonalize <italic>MM</italic><sup><italic>T</italic></sup>.</p>
      <p id="Par22">
        <disp-formula id="Eque">
          <alternatives>
            <tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ M{M}^T=\left(U\sum {V}^T\right)\left(V{\sum}^T{U}^T\right)=U\sum {\sum}^T{U}^T= UD{U}^{-1} $$\end{document}</tex-math>
            <mml:math id="M10" display="block">
              <mml:mi>M</mml:mi>
              <mml:msup>
                <mml:mi>M</mml:mi>
                <mml:mi>T</mml:mi>
              </mml:msup>
              <mml:mo>=</mml:mo>
              <mml:mfenced close=")" open="(">
                <mml:mrow>
                  <mml:mi>U</mml:mi>
                  <mml:mo>∑</mml:mo>
                  <mml:msup>
                    <mml:mi>V</mml:mi>
                    <mml:mi>T</mml:mi>
                  </mml:msup>
                </mml:mrow>
              </mml:mfenced>
              <mml:mfenced close=")" open="(">
                <mml:mrow>
                  <mml:mi>V</mml:mi>
                  <mml:msup>
                    <mml:mo>∑</mml:mo>
                    <mml:mi>T</mml:mi>
                  </mml:msup>
                  <mml:msup>
                    <mml:mi>U</mml:mi>
                    <mml:mi>T</mml:mi>
                  </mml:msup>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:mi>U</mml:mi>
              <mml:mo>∑</mml:mo>
              <mml:msup>
                <mml:mo>∑</mml:mo>
                <mml:mi>T</mml:mi>
              </mml:msup>
              <mml:msup>
                <mml:mi>U</mml:mi>
                <mml:mi>T</mml:mi>
              </mml:msup>
              <mml:mo>=</mml:mo>
              <mml:mi mathvariant="italic">UD</mml:mi>
              <mml:msup>
                <mml:mi>U</mml:mi>
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msup>
            </mml:math>
            <graphic xlink:href="13059_2019_1862_Article_Eque.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par23">Then, <italic>U</italic> contains the eigenvectors of <italic>MM</italic><sup><italic>T</italic></sup> (or left singular vectors of <italic>M</italic>) and <italic>D</italic> its eigenvalues.</p>
      <p id="Par24">
        <disp-formula id="Equf">
          <alternatives>
            <tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ U=\left[\begin{array}{ccc}{c}_{11}&amp; \cdots &amp; {c}_{1n}\\ {}\vdots &amp; \ddots &amp; \cdots \\ {}{c}_{1n}&amp; \cdots &amp; {c}_{nn}\end{array}\right] $$\end{document}</tex-math>
            <mml:math id="M12" display="block">
              <mml:mi>U</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mfenced close="]" open="[" separators=",">
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>c</mml:mi>
                        <mml:mn>11</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋯</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>c</mml:mi>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>⋮</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋱</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋯</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>c</mml:mi>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>⋯</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>c</mml:mi>
                        <mml:mi mathvariant="italic">nn</mml:mi>
                      </mml:msub>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mfenced>
            </mml:math>
            <graphic xlink:href="13059_2019_1862_Article_Equf.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par25">Similarly, to calculate <italic>V</italic>, we compute the product <italic>M</italic><sup><italic>T</italic></sup><italic>M</italic> and diagonalize <italic>M</italic><sup><italic>T</italic></sup><italic>M</italic> to calculate its eigenvectors and eigenvalues.</p>
      <p id="Par26"><disp-formula id="Equg"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {M}^TM=\left(V{\sum}^T{U}^T\right)\left(U\sum {V}^T\right)=V{\sum}^T\sum {V}^T= VD{V}^{-}1 $$\end{document}</tex-math><mml:math id="M14" display="block"><mml:msup><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>V</mml:mi><mml:msup><mml:mo>∑</mml:mo><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mi>U</mml:mi><mml:mo>∑</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:msup><mml:mo>∑</mml:mo><mml:mi>T</mml:mi></mml:msup><mml:mo>∑</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="italic">VD</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mo>−</mml:mo></mml:msup><mml:mn>1</mml:mn></mml:math><graphic xlink:href="13059_2019_1862_Article_Equg.gif" position="anchor"/></alternatives></disp-formula><italic>V</italic> contains the eigenvectors of <italic>M</italic><sup><italic>T</italic></sup><italic>M</italic> (or right singular vectors of <italic>M</italic>) and <italic>D</italic> its eigenvalues.</p>
      <p id="Par27"><disp-formula id="Equh"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ V=\left[\begin{array}{ccc}{v}_{11}&amp; \cdots &amp; {v}_{1m}\\ {}\vdots &amp; \ddots &amp; \vdots \\ {}{v}_{1m}&amp; \cdots &amp; {v}_{mm}\end{array}\right] $$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=","><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>v</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="italic">mm</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1862_Article_Equh.gif" position="anchor"/></alternatives></disp-formula>Σ is a diagonal matrix with the squared root eigenvalues of <italic>M</italic><sup><italic>T</italic></sup><italic>M</italic> (or singular values of <italic>M</italic>) along the diagonal.</p>
      <p id="Par28">
        <disp-formula id="Equi">
          <alternatives>
            <tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \sum =\left[\begin{array}{ccc}{s}_{11}&amp; &amp; \\ {}&amp; \ddots &amp; \\ {}&amp; &amp; {s}_{nm}\end{array}\right] $$\end{document}</tex-math>
            <mml:math id="M18" display="block">
              <mml:mo>∑</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfenced close="]" open="[" separators=",">
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>s</mml:mi>
                        <mml:mn>11</mml:mn>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd/>
                    <mml:mtd/>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd/>
                    <mml:mtd>
                      <mml:mo>⋱</mml:mo>
                    </mml:mtd>
                    <mml:mtd/>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd/>
                    <mml:mtd/>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi>s</mml:mi>
                        <mml:mi mathvariant="italic">nm</mml:mi>
                      </mml:msub>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mfenced>
            </mml:math>
            <graphic xlink:href="13059_2019_1862_Article_Equi.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par29">The matrix product <italic>U</italic>Σ gives the principal components (PCs) or “scores”, which are a new set of uncorrelated linear variables that capture the maximum variance from the single-cell expression matrix <italic>M</italic>. The individual squared values of the diagonal entries of Σ divided by the sum of all squared values give the variance explained by each principal component. PCs are in descending order according to the variance each of them explains.</p>
      <p id="Par30">
        <disp-formula id="Equj">
          <alternatives>
            <tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ S=U\sum $$\end{document}</tex-math>
            <mml:math id="M20" display="block">
              <mml:mi>S</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mi>U</mml:mi>
              <mml:mo>∑</mml:mo>
            </mml:math>
            <graphic xlink:href="13059_2019_1862_Article_Equj.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par31">We next identify the PCs whose scores have significant differences between the classification cell classes. We initially create a subspace of <italic>S</italic> (namely <italic>R</italic> with <italic>n</italic> rows and <italic>r</italic> columns -dimensions-), such that each dimension explains at least 0.01% of the variance of the matrix <italic>M</italic>. However, it is important to note that at this stage, we do not select features to fit in a prediction model. To identify the informative dimensions, a two-tailed Wilcoxon rank-sum test is performed for each PC to assess whether there is a significant difference in the distributions of PC scores for cells in different classes. The resulting <italic>p</italic> values are adjusted for multiple testing using a Benjamini-Hochberg false discovery rate correction. Columns from <italic>R</italic> are ranked in ascending order based on their corresponding <italic>p</italic> values. This step allows us to identify PCs with the largest difference in their distributions of the scores between the classes, and thus is expected to be the most informative as features used as input predictors in a classification model.</p>
      <p id="Par32">From <italic>R</italic>, we create a subspace <italic>F</italic> with only <italic>f</italic> columns with associated adjusted <italic>p</italic> values less than 0.05. The columns of <italic>F</italic> are used as features to train a support vector machine model with a radial kernel. A support vector classifier consists of a subspace (called hyperplane) of dimension <italic>h</italic>-1 with regard to its ambient high dimensional space <italic>H</italic> with <italic>h</italic> dimensions, which linearly separates the observations (cells) according to the class they belong to. A margin around the hyperplane is defined in order to minimize the misclassifications. The width of the margin is determined by observations called <italic>support vectors</italic>. Here, we find a hyperplane that separates single cells based on their PC scores into the classification classes. Those cells that define the margin can be thought of as <italic>supporting cells</italic> of the hyperplane.</p>
      <p id="Par33">When the observations cannot be separated in the feature space using a linear boundary, a “kernel trick” is used to map observations into a high-dimensional space where they can be linearly separated by a hyperplane. Let Φ be a function that maps single cells from a <italic>F</italic> space of <italic>f</italic> dimensions to a higher dimensional space <italic>H</italic>.</p>
      <p id="Par34">
        <disp-formula id="Equk">
          <alternatives>
            <tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \varPhi :F\to H $$\end{document}</tex-math>
            <mml:math id="M22" display="block">
              <mml:mi>Φ</mml:mi>
              <mml:mo>:</mml:mo>
              <mml:mi>F</mml:mi>
              <mml:mo>→</mml:mo>
              <mml:mi>H</mml:mi>
            </mml:math>
            <graphic xlink:href="13059_2019_1862_Article_Equk.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par35">And <italic>k</italic>(<italic>x</italic>, <italic>x</italic><sub>1</sub>) be a kernel function that returns the inner product of the images of two cells (based on the values of the <italic>f</italic> principal components in <italic>F</italic>).</p>
      <p id="Par36"><italic>k</italic>(<italic>x</italic>, <italic>x</italic><sub>1</sub>) = 〈<italic>Φ</italic>(<italic>x</italic>), <italic>Φ</italic>(<italic>x</italic><sub><italic>i</italic></sub>)〉</p>
      <p id="Par37">However, instead of computing a feature map Φ for all observations, the following shortcut is possible using a Gaussian radial basis kernel [<xref ref-type="bibr" rid="CR53">53</xref>]:</p>
      <p id="Par38"><disp-formula id="Equl"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\langle \varPhi (x),\varPhi \left({x}_i\right)\right\rangle =\mathit{\exp}\left(-\sigma \parallel x-{x}_1{\parallel}^2\right) $$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mfenced close="〉" open="〈" separators=","><mml:mrow><mml:mi>Φ</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>Φ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo mathvariant="italic">exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo>−</mml:mo><mml:mi>σ</mml:mi><mml:mo>∥</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mo>∥</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1862_Article_Equl.gif" position="anchor"/></alternatives></disp-formula>where <italic>σ</italic> is a constant greater than zero estimated via cross-validation. Thus, Eq. (7) can be rewritten as:</p>
      <p id="Par39">
        <disp-formula id="Equm">
          <alternatives>
            <tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ k\left(x,{x}_i\right)=\mathit{\exp}\left(-\sigma \parallel x-{x}_i{\parallel}^2\right) $$\end{document}</tex-math>
            <mml:math id="M26" display="block">
              <mml:mi>k</mml:mi>
              <mml:mfenced close=")" open="(" separators=",">
                <mml:mi>x</mml:mi>
                <mml:msub>
                  <mml:mi>x</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:mo mathvariant="italic">exp</mml:mo>
              <mml:mfenced close=")" open="(">
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mi>σ</mml:mi>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>x</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:msup>
                    <mml:mo>∥</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                </mml:mrow>
              </mml:mfenced>
            </mml:math>
            <graphic xlink:href="13059_2019_1862_Article_Equm.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par40">Hence, the coordinates of the cells in <italic>H</italic> are not computed.</p>
      <p id="Par41">Then, we can define a function <italic>f</italic>(<italic>x</italic>) that returns a decision value which indicates whether a cell belongs to a class or the other using the kernel function.</p>
      <p id="Par42"><disp-formula id="Equn"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ f(x)=\sum \limits_{i=1}^n{\alpha}_ik\left(x,{x}_i\right) $$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>k</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>x</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1862_Article_Equn.gif" position="anchor"/></alternatives></disp-formula><italic>α</italic><sub>i</sub> parameters are estimated by solving the following minimization problem:</p>
      <p id="Par43"><disp-formula id="Equo"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ t\left(w,\xi \right)=\frac{1}{2}\parallel w{\parallel}^2+\frac{C}{n}\sum \limits_{i=1}^n{\xi}_i $$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mi>t</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>w</mml:mi><mml:mi>ξ</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>∥</mml:mo><mml:mi>w</mml:mi><mml:msup><mml:mo>∥</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><graphic xlink:href="13059_2019_1862_Article_Equo.gif" position="anchor"/></alternatives></disp-formula>subject to</p>
      <p id="Par44">
        <disp-formula id="Equp">
          <alternatives>
            <tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{ccc}{\forall}_i\in \left\{1,\dots, n\right\}&amp; &amp; {y}_i\left(\left\langle {x}_i,w\right\rangle +b\right)\ge 1-{\xi}_i\\ {}&amp; {\xi}_i\ge 0&amp; \end{array}} $$\end{document}</tex-math>
            <mml:math id="M32" display="block">
              <mml:mtable displaystyle="true">
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mo>∀</mml:mo>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo>∈</mml:mo>
                    <mml:mfenced close="}" open="{" separators=",,">
                      <mml:mn>1</mml:mn>
                      <mml:mo>…</mml:mo>
                      <mml:mi>n</mml:mi>
                    </mml:mfenced>
                  </mml:mtd>
                  <mml:mtd/>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mi>y</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mfenced close=")" open="(">
                      <mml:mrow>
                        <mml:mfenced close="〉" open="〈" separators=",">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:mi>w</mml:mi>
                        </mml:mfenced>
                        <mml:mo>+</mml:mo>
                        <mml:mi>b</mml:mi>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mo>≥</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mi>ξ</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd/>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mi>ξ</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo>≥</mml:mo>
                    <mml:mn>0</mml:mn>
                  </mml:mtd>
                  <mml:mtd/>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="13059_2019_1862_Article_Equp.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par45">And being the hyperplane defined by the following set:</p>
      <p id="Par46"><disp-formula id="Equq"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\{x\in H|\left\langle w,x\right\rangle +b=0\right\} $$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mfenced close="}" open="{" separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mfenced close="〉" open="〈" separators=","><mml:mi>w</mml:mi><mml:mi>x</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1862_Article_Equq.gif" position="anchor"/></alternatives></disp-formula><italic>w</italic> is a weight vector in the feature space <italic>N</italic> perpendicular to the hyperplane which helps to define the margin, <italic>ξ</italic> is a slack variable that allows each cell to be on the wrong side of the hyperplane or the margin in order to deal with outliers, <italic>n</italic> is the number of observations (cells), <italic>y</italic><sub><italic>i</italic></sub> is a variable that indicates whether the cell <italic>x</italic><sub><italic>i</italic></sub> belongs to one class (<italic>y</italic> = 1) or the other (<italic>y</italic> = − 1), and <italic>C</italic> is a cost parameter that penalizes the sum of <italic>ξ</italic><sub><italic>i</italic></sub> . As <italic>C</italic> increases, the margin becomes wider and more tolerant of violations by cells. By enlarging the feature space using a polynomial kernel, the cells are linearly separated in <italic>H</italic> [<xref ref-type="bibr" rid="CR54">54</xref>]. To train the model, we determine the cost <italic>C</italic> and <italic>σ</italic> parameters via cross-validation and select the values that maximize the prediction performance. Finally, class probabilities are calculated using a sigmoid function fitted on the decision values returned by the classifier <italic>f</italic>(<italic>x</italic>) [<xref ref-type="bibr" rid="CR53">53</xref>].</p>
      <p id="Par47">
        <disp-formula id="Equr">
          <alternatives>
            <tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \Pr \left(y=1|f\right)=\frac{1}{1+{e}^{Af+B}} $$\end{document}</tex-math>
            <mml:math id="M36" display="block">
              <mml:mo>Pr</mml:mo>
              <mml:mfenced close=")" open="(" separators="|">
                <mml:mrow>
                  <mml:mi>y</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mi>f</mml:mi>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mo>+</mml:mo>
                  <mml:msup>
                    <mml:mi>e</mml:mi>
                    <mml:mrow>
                      <mml:mi mathvariant="italic">Af</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>B</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
              </mml:mfrac>
            </mml:math>
            <graphic xlink:href="13059_2019_1862_Article_Equr.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par48">The final trained model consists of a set of parameters that maximizes the margin between the training observations and the hyperplane in order to separate single cells according to their classification class. K-fold cross-validation is performed as described in the <italic>caret</italic> package [<xref ref-type="bibr" rid="CR52">52</xref>]. If the number of classes is more than two for the response variable, then <italic>n</italic> binary classification models are trained. For each classification model, we categorized all cells into two classes depending on the class being studied: <italic>positive class</italic> (cell type(s) of interest) and <italic>negative class</italic> (remaining cell types), “one-versus-all” approach.</p>
    </sec>
    <sec id="Sec11">
      <title>Prediction step</title>
      <p id="Par49">Once the model has been trained and evaluated, it can be used to classify single cells from an independent dataset from which the cell classes are unknown. Here, we apply the trained model(s) to classify cells from a testing dataset.</p>
      <p id="Par50">Given a test expression matrix <italic>C</italic><sub>Test</sub> with <italic>n</italic> single cells as rows and <italic>m</italic> genes as columns, let <italic>G</italic><sub>Test</sub> be the log<sub>2</sub>-transformed expression matrix <italic>C</italic><sub>Test</sub>:</p>
      <p id="Par51"><disp-formula id="Equs"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {G}_{\mathrm{Test}}=\left[\begin{array}{ccccc}{x}_{11}&amp; {x}_{12}&amp; {x}_{13}&amp; \cdots &amp; {x}_{1m}\\ {}{x}_{21}&amp; {x}_{22}&amp; {x}_{23}&amp; \cdots &amp; {x}_{2m}\\ {}\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ {}{x}_{n1}&amp; {x}_{n2}&amp; {x}_{n3}&amp; \cdots &amp; {x}_{nm}\end{array}\right] $$\end{document}</tex-math><mml:math id="M38" display="block"><mml:msub><mml:mi>G</mml:mi><mml:mtext>Test</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=","><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mn>13</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mn>23</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="italic">nm</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1862_Article_Equs.gif" position="anchor"/></alternatives></disp-formula>The matrix is centered and scaled using the means and variances calculated from <italic>G</italic><sub>Train</sub>:</p>
      <p id="Par52"><disp-formula id="Equt"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {M}_{\mathrm{Test}}=\left[\begin{array}{ccccc}\left({x}_{11}-{\mu}_1\right)/{\sigma}_1&amp; \left({x}_{12}-{\mu}_2\right)/{\sigma}_2&amp; \left({x}_{13}-{\mu}_3\right)/{\sigma}_3&amp; \cdots &amp; \left({x}_{1m}-{\mu}_m\right)/{\sigma}_m\\ {}\left({x}_{21}-{\mu}_1\right)/{\sigma}_1&amp; \left({x}_{22}-{\mu}_2\right)/{\sigma}_2&amp; \left({x}_{23}-{\mu}_3\right)/{\sigma}_3&amp; \cdots &amp; \left({x}_{2m}-{\mu}_m\right)/{\sigma}_m\\ {}\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ {}\left({x}_{n1}-{\mu}_1\right)/{\sigma}_1&amp; \left({x}_{n2}-{\mu}_2\right)/{\sigma}_2&amp; \left({x}_{n3}-{\mu}_3\right)/{\sigma}_3&amp; \cdots &amp; \left({x}_{nm}-{\mu}_m\right)/{\sigma}_m\end{array}\right] $$\end{document}</tex-math><mml:math id="M40" display="block"><mml:msub><mml:mi>M</mml:mi><mml:mtext>Test</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=","><mml:mtable><mml:mtr><mml:mtd><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>13</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>21</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>22</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>23</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="italic">nm</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1862_Article_Equt.gif" position="anchor"/></alternatives></disp-formula>and <italic>M</italic><sub>Test</sub> is projected onto the training PCA coordinate basis using the rotation matrix <italic>V</italic> after log2-transforming and scaling the data according to the training feature space:</p>
      <p id="Par53"><disp-formula id="Equu"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ P={M}_{\mathrm{test}}V $$\end{document}</tex-math><mml:math id="M42" display="block"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mtext>test</mml:mtext></mml:msub><mml:mi>V</mml:mi></mml:math><graphic xlink:href="13059_2019_1862_Article_Equu.gif" position="anchor"/></alternatives></disp-formula><italic>P</italic> contains the projection of the single cells from test dataset onto the PCs from the training data. Informative PCs listed in the <italic>R</italic> training subspace are extracted from <italic>R</italic> and used as features to predict the classification classes of the cells from the test dataset using the trained support vector machine model (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>).</p>
      <p id="Par54">If more than two models were trained, all cells in <italic>P</italic> are classified using the <italic>c</italic> trained models. If the maximum probability obtained across all models is greater than a threshold (0.9 by default), the cell is labeled according to the positive class corresponding to model the highest probability; otherwise, the cell is labeled as “Unassigned.”</p>
    </sec>
    <sec id="Sec12">
      <title>Predicting cell type from scRNA-seq data using <italic>scPred</italic></title>
      <p id="Par55">Our <italic>scPred</italic> method provides a generalized framework to classify a given cell based on its gene expression values. Importantly, our method is designed to solve the problem of individual gene feature selection and enable subtle effects spread across many genes to be utilized through orthogonal components of variance. In doing so, we anticipate an increase in the prediction performance over current gene-centric feature selection, as <italic>scPred</italic> will incorporate the small effects of many genes. To demonstrate both the utility and performance of <italic>scPred</italic>, we first validated the performance against an orthogonal molecular assay and then addressed three distinct biological examples of classification of single cells: firstly, by predicting specific α, β, δ, and γ cell subtypes from pancreas islets of Langerhans; secondly, classifying dendritic cells using a heterogeneous mix of single cells as a reference; and finally, identifying the presence of cancer cells from a heterogeneous composition of cells from whole tissue in both tumors and matched healthy controls. For all datasets, we removed all cells above or below 3 median absolute deviations (MAD) from the median library size, mitochondrial, and ribosomal gene expression. Furthermore, all genes with zero counts across all cells and genes not expressed in at least 1% of the whole population were discarded. Finally, all count matrices were transformed to CPM values, and genes being expressed more than five CPM were preserved. <italic>scPred</italic> predicts cells using a default probability threshold of 0.9 to ensure high confidence in the classification. All cells below this threshold for each cell type are labeled as unassigned. Here, we define sensitivity as the proportion of cells that were correctly classified for the cell type of interest, based on the default threshold with respect to the remaining cells that do not belong to this cell type (i.e., number of cells correctly classified from the positive class/(cells correctly classified from the negative class + unassigned cells that belong to the positive class). Likewise, specificity is the proportion of the cells from the negative class that were correctly classified with respect to the remaining cells from that class and the unassigned cells that belong to the negative class). Therefore, for the case of binary classification, sensitivity and specificity can both be zero if all cells from the positive and negative classes had a probability lower than 0.9 for each class respectively. The area under the AUROC and AUPRC were determined using the MLmetrics R package from CRAN <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/MLmetrics/index.html">https://cran.r-project.org/web/packages/MLmetrics/index.html</ext-link>.</p>
    </sec>
    <sec id="Sec13">
      <title>Gastric cancer tumor versus non-tumor prediction</title>
      <p id="Par56">The collection of this data was conducted in compliance with the Helsinki Declaration. The institutional review board at Stanford University School of Medicine approved the study protocol (19071), and informed consent was obtained. We collected two matched sets of two samples including gastric primary cancer, and normal stomach tissue. Tissue biopsies were obtained from surgical resection of a primary gastric adenocarcinoma and matched adjacent normal tissue. Immediately 10 min after resection, the tumor sample was stored in RPMI medium on ice for less than 1 h. The samples were then microdissected and dissociated into a cellular suspension by the gentleMACS Octo Dissociator as per the manufacturer’s recommendations and the 37C_h_TDK_3 program (Miltenyi Biotec, Bergisch Gladbach, Germany). Single-cell RNA-seq was performed after thawing cryopreserved sample stored in liquid nitrogen in DMSO. Histopathology of this gastric cancer revealed moderate to poorly differentiated features with a 60–70% tumor fraction. Immunohistochemistry demonstrated a loss of MLH1 and PMS2 expression. The loss of these proteins indicated that this tumor had microsatellite instability (MSI) where cancer cells have a hypermutable state because of loss of DNA mismatch repair. The tumor tissue was disaggregated into a single-cell suspension and analyzed scRNA-seq. We used the Chromium Controller instrument (10X Genomics Inc., Pleasanton, CA) and the Single Cell 3′ Reagent kit (v2) to prepare individually barcoded scRNA-seq libraries following the manufacturer’s standard protocol. Briefly, single-cell suspensions were loaded on a Chromium and were partitioned in droplets. Reverse transcription is performed, followed by droplet breaking, and cDNA amplification. Each cDNA molecule thus contained the read 1 sequencing primer, a 16-bp cell-identifying barcode, and a 10-bp UMI sequence. We performed enzymatic fragmentation, end-repair, and A-tailing followed by ligation of a single-end adapter containing the read 2 priming site. Finally, sequencing libraries were quantified by qPCR before sequencing using 26 × 98 paired-end reads. The Cellranger software suite was used to process scRNA-seq data, sample demultiplexing, barcode processing, and single-cell 3′ gene counting. Cellranger provided a gene-by-cell matrix, which contains the read count distribution of each gene for each cell. The gene expression matrix was split according to the disease status of each cell (defined by the presence of microsatellite instability) to create a training dataset. We selected only class informative PCs explaining at least 0.01% of the variance and using an adjusted alpha threshold of 0.05. Tenfold cross-validations were performed to train a support vector machine model with a radial kernel. The trained model was applied to independent cells to evaluate classification accuracy. To train two of the baseline models using SVM, we set all the coefficients of the hyperplane to 0 and 1 respectively. We trained a model using all principal components to evaluate the performance of the feature selection of <italic>scPred</italic>. Differentially gene expression analysis was performed using edgeR [<xref ref-type="bibr" rid="CR55">55</xref>] to obtain discriminant genes between tumor and non-tumor cells to be used as predictors. Ten bootstrap replicates were performed for all baseline models using the same dataset partitions from the main prediction analysis using <italic>scPred</italic>.</p>
    </sec>
    <sec id="Sec14">
      <title>Prediction of islets of Langerhans subtypes</title>
      <p id="Par57">We considered three independent datasets to train a prediction model to classify α (alpha), β (beta), δ (delta), and γ (gamma) cell subtypes: Muraro et al. [<xref ref-type="bibr" rid="CR25">25</xref>] consisting of 1522 cells from a CEL-Seq2 protocol, Segerstolpe et al. [<xref ref-type="bibr" rid="CR3">3</xref>] consisting of scRNA-seq data from 1321 cells generated using the Smart-Seq2 protocol, and 1349 cells from Xin et al. [<xref ref-type="bibr" rid="CR26">26</xref>] whose gene expression levels were assayed using the SMARTer protocol (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). We integrated the three datasets using the intersection of genes between them and obtained a single aggregated matrix. We applied the Seurat alignment approach [<xref ref-type="bibr" rid="CR30">30</xref>] to account for technical differences across the different datasets used for the training dataset. First, we determined the most variable genes (528) in at least two of the three datasets to compute the loadings and the first 30 PCs using the implicitly restarted Lanczos bidiagonalization algorithm [<xref ref-type="bibr" rid="CR56">56</xref>]. Then, we used the loadings from the training eigendecomposition to project the testing dataset (Baron et al.) and obtained the cell embeddings. After the alignment, no batch effect was observed (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Then, we trained a prediction model considering only class-informative PCs using a multiple testing corrected alpha level of 0.05 using (see <italic>scPred</italic> in the “<xref rid="Sec9" ref-type="sec">Methods</xref>” section) using the scores from the aligned training eigenspace only. Tenfold cross-validations were performed to train a support vector machine model with a radial kernel. To assess the performance of our prediction model, we predicted the specific cell types of 7932 cells using their scRNA-seq data generated using the inDrop protocol [<xref ref-type="bibr" rid="CR31">31</xref>]. In addition to our main analysis, we trained a prediction model using the Baron dataset only as a training reference and applied the model to classify cells from the Muraro, Segerstolpe, and Xin datasets respectively using the same methodology described above. We then compared the prediction performance of <italic>scmap</italic> [<xref ref-type="bibr" rid="CR33">33</xref>], <italic>caSTLe</italic> [<xref ref-type="bibr" rid="CR34">34</xref>], <italic>singleCellNet</italic> [<xref ref-type="bibr" rid="CR35">35</xref>], and <italic>scID</italic> [<xref ref-type="bibr" rid="CR36">36</xref>] following the same approach. To train the classifiers using <italic>scmap</italic>, we used 500 genes as features. Cluster and cell projections were performed using both algorithms. For the <italic>caSTLe</italic> cell classification, we reproduced the pipeline code from <ext-link ext-link-type="uri" xlink:href="https://github.com/yuvallb/CaSTLe">https://github.com/yuvallb/CaSTLe</ext-link> using the Baron data as source dataset and the Muraro, Segerstolpe, and Xin as the target dataset. Code for <italic>singleCellNe</italic>t and <italic>scID</italic> was obtained from <ext-link ext-link-type="uri" xlink:href="https://github.com/pcahan1/singleCellNet">https://github.com/pcahan1/singleCellNet</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/BatadaLab/scID">https://github.com/BatadaLab/scID</ext-link> respectively.</p>
    </sec>
    <sec id="Sec15">
      <title>Prediction of peripheral blood mononuclear cells</title>
      <p id="Par58">We used the dataset obtained by Zheng et al. [<xref ref-type="bibr" rid="CR39">39</xref>] to train and test prediction models to deconvolute the cell-type identity of peripheral blood mononuclear cells. We defined three layers of prediction based on the hierarchy of PBMCs in the hematopoietic lineage and trained a <italic>scPred</italic> model for each of them using a training partition from the dataset. Then, every single cell from the test fold was classified as follows: the first model classifies the cell as myeloid, lymphoid, or blood progenitor based on a feature eigenspace including all these cells. Furthermore, all cells classified as lymphoid are subcategorized into B cell, T cell, or Natural Killer using a second classifier trained to distinguish between these classes. Finally, predicted T cells are subclassified into cytotoxic and non-cytotoxic. Ten bootstrap replicates were performed to calculate a 95% confidence interval of the accuracies for every cell type.</p>
    </sec>
    <sec id="Sec16">
      <title>Prediction of dendritic cells: training data of dendritic cells and monocytes</title>
      <p id="Par59">scRNA-seq data was obtained using a Smart-Seq2 protocol [<xref ref-type="bibr" rid="CR1">1</xref>]. After quality control, 660 dendritic cells and 335 monocytes were used to train a prediction model applying a 0.01% variance-explained filter and a corrected alpha level of 0.05 to select the informative PCs. Tenfold cross-validations were performed to train a support vector machine model with a radial kernel. We tested the <italic>scPred</italic> prediction model against dendritic cells from an independent study [<xref ref-type="bibr" rid="CR41">41</xref>], whose scRNA-seq data had been generated using the SMART-Seq 2 protocol. After quality control, 150 primary human conventional dendritic cells (cDCs), 420 cord blood pre-cDCs, and 311 blood pre-cDCs were kept. The final training model consisted of only 11 discriminant PCs explaining 5.97% of the variance from the Villani et al. dataset. The training error of the model was 0.018, and 232 cells were used as support vectors. Differential expression analysis between the unassigned cells and remaining cells from cord blood was performed using edgeR [<xref ref-type="bibr" rid="CR55">55</xref>]. Genes with a log fold-change greater or lower than 2 and an adjusted <italic>p</italic> value less than 0.05 were considered as differentially expressed. Gene ontology analysis was performed using <ext-link ext-link-type="uri" xlink:href="http://pantherdb.org/">http://pantherdb.org/</ext-link>.</p>
    </sec>
    <sec id="Sec17">
      <title>Prediction of colorectal cancer cells</title>
      <p id="Par60">We obtained the human colorectal cancer dataset under the GEO accession number GSE81861. We analyzed only the stemTA cell subtype as they are the most abundant epithelial subpopulation. After quality control, 275 cells stemTA cells and 21,933 genes were kept. The gene expression matrix was split according to the sample origin of each cell (tumor or normal) to create a training and testing dataset such that the former partition contained 75% of cells and the latter 25%. To create the partitions, we used the SMOTE algorithm [<xref ref-type="bibr" rid="CR48">48</xref>] to account for class imbalance. We selected only class-informative PCs explaining at least 0.01% of the variance and using an adjusted alpha threshold of 0.05. Tenfold cross-validations were performed to train a support vector machine model with a radial kernel. Finally, we obtained the areas under the ROC and precision-recall curves to measure the performance of <italic>scPred</italic>. Ten bootstrap replicates were performed.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1862_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Figure S1.</bold> Expression of EPCAM, MLH1, and TFF3. <bold>Figure S2.</bold> Effect of the sequencing depth on prediction performance of gastric tumour cells. <bold>Figure S3.</bold> Effect of the number of cells on prediction performance of gastric tumour cells. <bold>Figure S4.</bold> Distribution of conditional class probabilities for single cells from the Baron test dataset across all four models.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2019_1862_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2: Table S1.</bold> Classification performance comparison between scPred and other prediction baseline methods. For all methods, results are reported using the same data set partitions across all bootstrap replicates. <bold>Table S2.</bold> Summary of pancreas datasets. Training dataset consisted of 4292 cells and 32 human samples in total. <bold>Table S3.</bold> Prediction results of pancreatic cells from Baron dataset. <bold>Table S5.</bold> Prediction performance of pancreatic cells from Baron et al. dataset using different prediction models described in Table S1. <bold>Table S12</bold>. Accuracy performance for all PBMC subtypes. Percentile 95% confidence intervals are shown for ten boostrap replicates. <bold>Table S13.</bold> Prediction of dendritic cells from Breton et al. dataset using different prediction models.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2019_1862_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3: Table S4.</bold> Prediction results of pancreatic cells without Seurat alignment. <bold>Table S6.</bold> Prediction results using Baron dataset as reference. <bold>Table S7.</bold> Classification performance of scmap-cluster using the Baron dataset as training. <bold>Table S8.</bold> Classification performance of scmap-cell using the Baron dataset as training. <bold>Table S9.</bold> Classification performance of caSTLe using the Baron dataset as training. <bold>Table S10.</bold> Classification performance of singleCellNet using the Baron dataset as training. <bold>Table S11.</bold> Classification performance of scID using the Baron dataset as training. <bold>Table S14</bold>. Differentially expressed genes between unassigned cells by scPred and remaining cord blood-derived cells. <bold>Table S15</bold>. Gene ontology overrepresentation results of overexpressed genes from unassigned cells.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s13059-019-1862-5.</p>
  </sec>
  <ack>
    <title>Peer review information</title>
    <p>Barbara Cheifet was the primary editor on this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>JAH and JEP developed the <italic>scPred</italic> method. JEP, QN, and JAH designed the statistical framework of <italic>scPred</italic>. AS and HPJ obtained, processed, and sequenced the gastric cancer samples from clinical patients. JEP and JAH conceived the idea of the project. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>JAH is supported by the University of Queensland under a Research Training Program and a UQ Research Training scholarships. JEP is supported by National Health and Medical Research Council Fellowship (APP1107599). This work was supported by National Health and Medical Research Council project grant (APP1143163) and Australian Research Council Discovery project (DP180101405).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p><italic>scPred</italic> is implemented in R as a package based on S4 objects. The <italic>scPred</italic> class allows the eigen decomposition, feature selection, training, and prediction steps in a straightforward and user-friendly fashion. <italic>scPred</italic> supports any classification method available from the caret package [<xref ref-type="bibr" rid="CR52">52</xref>]. The default model in <italic>scPred</italic> is the support vector machine with a radial kernel. The choice of this method is based on its superior performance when compared to alternative machine learning methods (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S5 and S13). However, it is important to note that the best model will be the one that models the distribution of true effects of the fitted PCs best. Therefore, we anticipate certain scenarios where alternative classification methods should be selected instead of the support vector machine. The <italic>scPred</italic> object contains slots to store the eigen decomposition, informative features selected, and trained models, meaning models can be applied without re-computing the initial training step. The package also includes functions for exploratory data analysis, feature selection, and graphical interpretation. All analyses were run in a personal computer with 16-GB RAM memory and a 2.5-GHz Intel Core i7 processor.</p>
    <p><italic>scPred</italic> is available from Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/powellgenomicslab/scPred">https://github.com/powellgenomicslab/scPred</ext-link> [<xref ref-type="bibr" rid="CR57">57</xref>] under the MIT license and on zenodo at doi:10.5281/zenodo.3391594 [<xref ref-type="bibr" rid="CR58">58</xref>].</p>
    <p>Generated data for prediction of tumor cells from gastric cancer may be found in [<xref ref-type="bibr" rid="CR59">59</xref>]. Data used for prediction of pancreatic cells may be found in GEO (GSE85241, GSE81608, GSE84133) and ArrayExpress (E-MTAB-5061) [<xref ref-type="bibr" rid="CR60">60</xref>–<xref ref-type="bibr" rid="CR63">63</xref>]. Data used for prediction of peripheral blood mononuclear cells may be found from 10X Genomics [<xref ref-type="bibr" rid="CR64">64</xref>]. Data used for prediction of dendritic cells and monocytes may be found in the Single Cell Portal and GEO (GSE89232) [<xref ref-type="bibr" rid="CR65">65</xref>, <xref ref-type="bibr" rid="CR66">66</xref>]. Data used for prediction of colorectal cancer cells may be found in GEO (GSE81861) [<xref ref-type="bibr" rid="CR67">67</xref>].</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par61">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par62">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Villani</surname>
            <given-names>Alexandra-Chloé</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>Rahul</given-names>
          </name>
          <name>
            <surname>Reynolds</surname>
            <given-names>Gary</given-names>
          </name>
          <name>
            <surname>Sarkizova</surname>
            <given-names>Siranush</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>Karthik</given-names>
          </name>
          <name>
            <surname>Fletcher</surname>
            <given-names>James</given-names>
          </name>
          <name>
            <surname>Griesbeck</surname>
            <given-names>Morgane</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>Andrew</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>Shiwei</given-names>
          </name>
          <name>
            <surname>Lazo</surname>
            <given-names>Suzan</given-names>
          </name>
          <name>
            <surname>Jardine</surname>
            <given-names>Laura</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>David</given-names>
          </name>
          <name>
            <surname>Stephenson</surname>
            <given-names>Emily</given-names>
          </name>
          <name>
            <surname>Nilsson</surname>
            <given-names>Emil</given-names>
          </name>
          <name>
            <surname>Grundberg</surname>
            <given-names>Ida</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>David</given-names>
          </name>
          <name>
            <surname>Filby</surname>
            <given-names>Andrew</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Weibo</given-names>
          </name>
          <name>
            <surname>De Jager</surname>
            <given-names>Philip L.</given-names>
          </name>
          <name>
            <surname>Rozenblatt-Rosen</surname>
            <given-names>Orit</given-names>
          </name>
          <name>
            <surname>Lane</surname>
            <given-names>Andrew A.</given-names>
          </name>
          <name>
            <surname>Haniffa</surname>
            <given-names>Muzlifah</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>Aviv</given-names>
          </name>
          <name>
            <surname>Hacohen</surname>
            <given-names>Nir</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>356</volume>
        <issue>6335</issue>
        <fpage>eaah4573</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aah4573</pub-id>
        <?supplied-pmid 28428369?>
        <pub-id pub-id-type="pmid">28428369</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grün</surname>
            <given-names>Dominic</given-names>
          </name>
          <name>
            <surname>Lyubimova</surname>
            <given-names>Anna</given-names>
          </name>
          <name>
            <surname>Kester</surname>
            <given-names>Lennart</given-names>
          </name>
          <name>
            <surname>Wiebrands</surname>
            <given-names>Kay</given-names>
          </name>
          <name>
            <surname>Basak</surname>
            <given-names>Onur</given-names>
          </name>
          <name>
            <surname>Sasaki</surname>
            <given-names>Nobuo</given-names>
          </name>
          <name>
            <surname>Clevers</surname>
            <given-names>Hans</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>Alexander</given-names>
          </name>
        </person-group>
        <article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>525</volume>
        <issue>7568</issue>
        <fpage>251</fpage>
        <lpage>255</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14966</pub-id>
        <?supplied-pmid 26287467?>
        <pub-id pub-id-type="pmid">26287467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>Åsa</given-names>
          </name>
          <name>
            <surname>Palasantza</surname>
            <given-names>Athanasia</given-names>
          </name>
          <name>
            <surname>Eliasson</surname>
            <given-names>Pernilla</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>Eva-Marie</given-names>
          </name>
          <name>
            <surname>Andréasson</surname>
            <given-names>Anne-Christine</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Xiaoyan</given-names>
          </name>
          <name>
            <surname>Picelli</surname>
            <given-names>Simone</given-names>
          </name>
          <name>
            <surname>Sabirsh</surname>
            <given-names>Alan</given-names>
          </name>
          <name>
            <surname>Clausen</surname>
            <given-names>Maryam</given-names>
          </name>
          <name>
            <surname>Bjursell</surname>
            <given-names>Magnus K.</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>David M.</given-names>
          </name>
          <name>
            <surname>Kasper</surname>
            <given-names>Maria</given-names>
          </name>
          <name>
            <surname>Ämmälä</surname>
            <given-names>Carina</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>Rickard</given-names>
          </name>
        </person-group>
        <article-title>Single-Cell Transcriptome Profiling of Human Pancreatic Islets in Health and Type 2 Diabetes</article-title>
        <source>Cell Metabolism</source>
        <year>2016</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.020</pub-id>
        <?supplied-pmid 27667667?>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Treutlein</surname>
            <given-names>Barbara</given-names>
          </name>
          <name>
            <surname>Brownfield</surname>
            <given-names>Doug G.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Angela R.</given-names>
          </name>
          <name>
            <surname>Neff</surname>
            <given-names>Norma F.</given-names>
          </name>
          <name>
            <surname>Mantalas</surname>
            <given-names>Gary L.</given-names>
          </name>
          <name>
            <surname>Espinoza</surname>
            <given-names>F. Hernan</given-names>
          </name>
          <name>
            <surname>Desai</surname>
            <given-names>Tushar J.</given-names>
          </name>
          <name>
            <surname>Krasnow</surname>
            <given-names>Mark A.</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>Stephen R.</given-names>
          </name>
        </person-group>
        <article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>509</volume>
        <issue>7500</issue>
        <fpage>371</fpage>
        <lpage>375</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13173</pub-id>
        <?supplied-pmid 24739965?>
        <pub-id pub-id-type="pmid">24739965</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Qiao</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq analysis maps development of human germline cells and gonadal niche interactions</article-title>
        <source>Cell Stem Cell</source>
        <year>2017</year>
        <volume>20</volume>
        <fpage>891</fpage>
        <lpage>892</lpage>
        <pub-id pub-id-type="doi">10.1016/j.stem.2017.05.009</pub-id>
        <?supplied-pmid 28575695?>
        <pub-id pub-id-type="pmid">28575695</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petropoulos</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Edsgärd</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reinius</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Panula</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Codeluppi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reyes</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Linnarsson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lanner</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq reveals lineage and x chromosome dynamics in human preimplantation embryos</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>167</volume>
        <fpage>285</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.08.009</pub-id>
        <?supplied-pmid 27662094?>
        <pub-id pub-id-type="pmid">27662094</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rizvi</surname>
            <given-names>Abbas H</given-names>
          </name>
          <name>
            <surname>Camara</surname>
            <given-names>Pablo G</given-names>
          </name>
          <name>
            <surname>Kandror</surname>
            <given-names>Elena K</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>Thomas J</given-names>
          </name>
          <name>
            <surname>Schieren</surname>
            <given-names>Ira</given-names>
          </name>
          <name>
            <surname>Maniatis</surname>
            <given-names>Tom</given-names>
          </name>
          <name>
            <surname>Rabadan</surname>
            <given-names>Raul</given-names>
          </name>
        </person-group>
        <article-title>Single-cell topological RNA-seq analysis reveals insights into cellular differentiation and development</article-title>
        <source>Nature Biotechnology</source>
        <year>2017</year>
        <volume>35</volume>
        <issue>6</issue>
        <fpage>551</fpage>
        <lpage>560</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3854</pub-id>
        <?supplied-pmid 28459448?>
        <pub-id pub-id-type="pmid">28459448</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Treutlein</surname>
            <given-names>Barbara</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>Qian Yi</given-names>
          </name>
          <name>
            <surname>Camp</surname>
            <given-names>J. Gray</given-names>
          </name>
          <name>
            <surname>Mall</surname>
            <given-names>Moritz</given-names>
          </name>
          <name>
            <surname>Koh</surname>
            <given-names>Winston</given-names>
          </name>
          <name>
            <surname>Shariati</surname>
            <given-names>Seyed Ali Mohammad</given-names>
          </name>
          <name>
            <surname>Sim</surname>
            <given-names>Sopheak</given-names>
          </name>
          <name>
            <surname>Neff</surname>
            <given-names>Norma F.</given-names>
          </name>
          <name>
            <surname>Skotheim</surname>
            <given-names>Jan M.</given-names>
          </name>
          <name>
            <surname>Wernig</surname>
            <given-names>Marius</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>Stephen R.</given-names>
          </name>
        </person-group>
        <article-title>Dissecting direct reprogramming from fibroblast to neuron using single-cell RNA-seq</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>534</volume>
        <issue>7607</issue>
        <fpage>391</fpage>
        <lpage>395</lpage>
        <pub-id pub-id-type="doi">10.1038/nature18323</pub-id>
        <?supplied-pmid 27281220?>
        <pub-id pub-id-type="pmid">27281220</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaitin</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Weiner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yofe</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lara-Astiaso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Keren-Shaul</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>David</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Salame</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Amit</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Dissecting immune circuits by linking crispr pooled screens with single-cell rna-seq</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>167</volume>
        <fpage>1883</fpage>
        <lpage>1896</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.11.039</pub-id>
        <?supplied-pmid 27984734?>
        <pub-id pub-id-type="pmid">27984734</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Regev A, Teichmann SA, Lander ES, Amit I, Benoist C, Birney E, Bodenmiller B, Campbell P, Carninci P, Clatworthy M, Clevers H, Deplancke B, Dunham I, Eberwine J, Eils R, Enard W, Farmer A, Fugger L, GÃ¶ttgens B, Hacohen N, Haniffa M, Hemberg M, Kim S, Klenerman P, Kriegstein A, Lein E, Linnarsson S, Lundberg E, Lundeberg J, Majumder P, Marioni JC, Merad M, Mhlanga M, Nawijn M, Netea M, Nolan G, Pe’er D, Phillipakis A, Ponting CP, Quake S, Reik W, Rozenblatt-Rosen O, Sanes J, Satija R, Schumacher TN, Shalek A, Shapiro E, Sharma P, Shin JW, Stegle O, Stratton M, Stubbington MJT, Theis FJ, Uhlen M, van Oudenaarden A, Wagner A, Watt F, Weissman J, Wold B, Xavier R, Yosef N. The human cell atlas. eLife. 2017;15.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arendt</surname>
            <given-names>Detlev</given-names>
          </name>
          <name>
            <surname>Musser</surname>
            <given-names>Jacob M.</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>Clare V. H.</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>Aviv</given-names>
          </name>
          <name>
            <surname>Cepko</surname>
            <given-names>Connie</given-names>
          </name>
          <name>
            <surname>Erwin</surname>
            <given-names>Douglas H.</given-names>
          </name>
          <name>
            <surname>Pavlicev</surname>
            <given-names>Mihaela</given-names>
          </name>
          <name>
            <surname>Schlosser</surname>
            <given-names>Gerhard</given-names>
          </name>
          <name>
            <surname>Widder</surname>
            <given-names>Stefanie</given-names>
          </name>
          <name>
            <surname>Laubichler</surname>
            <given-names>Manfred D.</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>Günter P.</given-names>
          </name>
        </person-group>
        <article-title>The origin and evolution of cell types</article-title>
        <source>Nature Reviews Genetics</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>12</issue>
        <fpage>744</fpage>
        <lpage>757</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg.2016.127</pub-id>
        <?supplied-pmid 27818507?>
        <pub-id pub-id-type="pmid">27818507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Papalexi</surname>
            <given-names>Efthymia</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>Rahul</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA sequencing to explore immune cell heterogeneity</article-title>
        <source>Nature Reviews Immunology</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>35</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.1038/nri.2017.76</pub-id>
        <?supplied-pmid 28787399?>
        <pub-id pub-id-type="pmid">28787399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grün</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vanoudenaarden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Design and analysis of single-cell sequencing experiments</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>163</volume>
        <fpage>799</fpage>
        <lpage>810</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.10.039</pub-id>
        <?supplied-pmid 26544934?>
        <pub-id pub-id-type="pmid">26544934</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Defining cell types and states with single-cell genomics. (report)</article-title>
        <source>Cold Spring Harbor Laboratory Press</source>
        <year>2015</year>
        <volume>25</volume>
        <fpage>1491</fpage>
        <lpage>1498</lpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Basu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bialas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kamitaki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Martersteck</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Weitz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sanes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mccarroll</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id>
        <?supplied-pmid 26000488?>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Kiselev VY, Kirschner K, Schaub MT, Andrews T, Yiu A, Chandra T, Natarajan KN, Reik W, Barahona M, Green AR, Hemberg M. SC3: consensus clustering of single-cell RNA-seq data. Nat Methods. 2017;14:483–6.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stegle</surname>
            <given-names>Oliver</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>Sarah A.</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>John C.</given-names>
          </name>
        </person-group>
        <article-title>Computational and analytical challenges in single-cell transcriptomics</article-title>
        <source>Nature Reviews Genetics</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>3</issue>
        <fpage>133</fpage>
        <lpage>145</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3833</pub-id>
        <?supplied-pmid 25628217?>
        <pub-id pub-id-type="pmid">25628217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Molin AD, Baruzzo G, Camillo BD. Single-cell RNA-sequencing: Assessment of differential expression analysis methods. Front Genet. 2017;9(62):50-60.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">A. K. Shalek and M. Benson, “Single-cell analyses to tailor treatments,” Sci Transl Med 2017; 9 408.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Andor</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Catalanotti</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Sathe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Belhocine</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stafford</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bent</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>DeMare</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hepler</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jett</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Maheshwari</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Makarewicz</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Rahimi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sawhney</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Sauzade</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shuga</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sullivan-Bibee</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Weinstein</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kubit</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Grimes</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Suarez</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Poultsides</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Schnall-Levin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bharadwaj</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>HP</given-names>
          </name>
        </person-group>
        <source>Joint single-cell DNA-seq and RNA-seq of gastric cancer reveals subclonal signatures of genomic instability and gene expression</source>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taniguchi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kurokawa</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Takahashi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mikami</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Miyazaki</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Makino</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Prognostic value of trefoil factor 3 expression in patients with gastric cancer. (report)</article-title>
        <source>World J Surg</source>
        <year>2018</year>
        <volume>42</volume>
        <issue>12</issue>
        <fpage>3997</fpage>
        <pub-id pub-id-type="doi">10.1007/s00268-018-4737-0</pub-id>
        <?supplied-pmid 30039286?>
        <pub-id pub-id-type="pmid">30039286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wenqi</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Shanshan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bei</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yafei</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Feihu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Jie</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Daiming</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Epcam is overexpressed in gastric cancer and its downregulation suppresses proliferation of gastric cancer</article-title>
        <source>J Cancer Res Clin Oncol</source>
        <year>2009</year>
        <volume>135</volume>
        <issue>9</issue>
        <fpage>1277</fpage>
        <lpage>1285</lpage>
        <pub-id pub-id-type="doi">10.1007/s00432-009-0569-5</pub-id>
        <?supplied-pmid 19294417?>
        <pub-id pub-id-type="pmid">19294417</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">C. Ionescu-Tirgoviste, P. A. Gagniuc, E. Gubceac, L. Mardare, I. Popescu, S. Dima, and M. Militaru, “A 3D map of the islet routes throughout the healthy human pancreas,” Scientific Reports 2015; 5 .</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blodgett</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Redick</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Harlan</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Surprising heterogeneity of pancreatic islet cell subsets</article-title>
        <source>Cell Systems</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>330</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.10.009</pub-id>
        <?supplied-pmid 27788358?>
        <pub-id pub-id-type="pmid">27788358</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muraro</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Dharmadhikari</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Grün</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Groen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dielen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jansen</surname>
            <given-names>EWL</given-names>
          </name>
          <name>
            <surname>van Gurp</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Engelse</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Carlotti</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>de Koning</surname>
            <given-names>EJP</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A single-cell transcriptome atlas of the human pancreas</article-title>
        <source>Cell Systems</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>385</fpage>
        <lpage>4712</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.09.002</pub-id>
        <?supplied-pmid 27693023?>
        <pub-id pub-id-type="pmid">27693023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Okamoto</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Adler</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yancopoulos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gromada</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Rna sequencing of single human islet cells reveals type 2 diabetes genes</article-title>
        <source>Cell Metab</source>
        <year>2016</year>
        <volume>24</volume>
        <fpage>608</fpage>
        <lpage>615</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.018</pub-id>
        <?supplied-pmid 27667665?>
        <pub-id pub-id-type="pmid">27667665</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Hashimshony T, Senderovich N, Avital G, Klochendler A, de Leeuw Y, Anavy L, Gennert D, Li S, Livak KJ, Rozenblatt-Rosen O, Dor Y, Regev A, Yanai I. CEL-Seq2: sensitive highly-multiplexed single-cell RNA-seq. Genome Biol. 2016;17.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picelli</surname>
            <given-names>Simone</given-names>
          </name>
          <name>
            <surname>Björklund</surname>
            <given-names>Åsa K</given-names>
          </name>
          <name>
            <surname>Faridani</surname>
            <given-names>Omid R</given-names>
          </name>
          <name>
            <surname>Sagasser</surname>
            <given-names>Sven</given-names>
          </name>
          <name>
            <surname>Winberg</surname>
            <given-names>Gösta</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>Rickard</given-names>
          </name>
        </person-group>
        <article-title>Smart-seq2 for sensitive full-length transcriptome profiling in single cells</article-title>
        <source>Nature Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>11</issue>
        <fpage>1096</fpage>
        <lpage>1098</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2639</pub-id>
        <?supplied-pmid 24056875?>
        <pub-id pub-id-type="pmid">24056875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goetz</surname>
            <given-names>Jillian J</given-names>
          </name>
          <name>
            <surname>Trimarchi</surname>
            <given-names>Jeffrey M</given-names>
          </name>
        </person-group>
        <article-title>Transcriptome sequencing of single cells with Smart-Seq</article-title>
        <source>Nature Biotechnology</source>
        <year>2012</year>
        <volume>30</volume>
        <issue>8</issue>
        <fpage>763</fpage>
        <lpage>765</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2325</pub-id>
        <?supplied-pmid 22871714?>
        <pub-id pub-id-type="pmid">22871714</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>Andrew</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>Paul</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>Peter</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>Efthymia</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>Rahul</given-names>
          </name>
        </person-group>
        <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
        <source>Nature Biotechnology</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>5</issue>
        <fpage>411</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id>
        <?supplied-pmid 29608179?>
        <pub-id pub-id-type="pmid">29608179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>Maayan</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>Adrian</given-names>
          </name>
          <name>
            <surname>Wolock</surname>
            <given-names>Samuel L.</given-names>
          </name>
          <name>
            <surname>Faust</surname>
            <given-names>Aubrey L.</given-names>
          </name>
          <name>
            <surname>Gaujoux</surname>
            <given-names>Renaud</given-names>
          </name>
          <name>
            <surname>Vetere</surname>
            <given-names>Amedeo</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>Jennifer Hyoje</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>Bridget K.</given-names>
          </name>
          <name>
            <surname>Shen-Orr</surname>
            <given-names>Shai S.</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>Allon M.</given-names>
          </name>
          <name>
            <surname>Melton</surname>
            <given-names>Douglas A.</given-names>
          </name>
          <name>
            <surname>Yanai</surname>
            <given-names>Itai</given-names>
          </name>
        </person-group>
        <article-title>A Single-Cell Transcriptomic Map of the Human and Mouse Pancreas Reveals Inter- and Intra-cell Population Structure</article-title>
        <source>Cell Systems</source>
        <year>2016</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>346-360.e4</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id>
        <?supplied-pmid 27667365?>
        <pub-id pub-id-type="pmid">27667365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mazutis</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Akartuna</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Tallapragada</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Peshkin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Weitz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kirschner</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <fpage>1187</fpage>
        <lpage>1201</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.04.044</pub-id>
        <?supplied-pmid 26000487?>
        <pub-id pub-id-type="pmid">26000487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>Vladimir Yu</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>Andrew</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>Martin</given-names>
          </name>
        </person-group>
        <article-title>scmap: projection of single-cell RNA-seq data across data sets</article-title>
        <source>Nature Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>359</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4644</pub-id>
        <?supplied-pmid 29608555?>
        <pub-id pub-id-type="pmid">29608555</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman</surname>
            <given-names>Yuval</given-names>
          </name>
          <name>
            <surname>Rokach</surname>
            <given-names>Lior</given-names>
          </name>
          <name>
            <surname>Shay</surname>
            <given-names>Tal</given-names>
          </name>
        </person-group>
        <article-title>Correction: CaSTLe - Classification of single cells by transfer learning: Harnessing the power of publicly available single cell RNA sequencing experiments to annotate new experiments</article-title>
        <source>PLOS ONE</source>
        <year>2018</year>
        <volume>13</volume>
        <issue>11</issue>
        <fpage>e0208349</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0208349</pub-id>
        <?supplied-pmid 30481223?>
        <pub-id pub-id-type="pmid">30481223</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tan</surname>
            <given-names>Yuqi</given-names>
          </name>
          <name>
            <surname>Cahan</surname>
            <given-names>Patrick</given-names>
          </name>
        </person-group>
        <article-title>SingleCellNet: A Computational Tool to Classify Single Cell RNA-Seq Data Across Platforms and Across Species</article-title>
        <source>Cell Systems</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>207-213.e2</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2019.06.004</pub-id>
        <?supplied-pmid 31377170?>
        <pub-id pub-id-type="pmid">31377170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Boufea K, Seth S, Batada NN. scID: Identification of transcriptionally equivalent cell populations across single-cell RNA-seq data using discriminant analysis. bioRxiv. 2018.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kemppainen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Orešič</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Perspectives on systems modelling of human peripheral blood mononuclear cells</article-title>
        <source>Front Mol Biosci</source>
        <year>2017</year>
        <volume>4</volume>
        <fpage>96</fpage>
        <pub-id pub-id-type="doi">10.3389/fmolb.2017.00096</pub-id>
        <?supplied-pmid 29376056?>
        <pub-id pub-id-type="pmid">29376056</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Autissier</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Soulas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Burdo</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>KC</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of a 12âcolor flow cytometry panel to study lymphocyte, monocyte, and dendritic cell subsets in humans</article-title>
        <source>Cytometry Part A</source>
        <year>2010</year>
        <volume>77</volume>
        <issue>5</issue>
        <fpage>410</fpage>
        <lpage>419</lpage>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Zheng GXY, Terry JM, Belgrader P, Ryvkin P, Bent ZW, Wilson R, Ziraldo SB, Wheeler TD, McDermott GP, Zhu J, Gregory MT, Shuga J, Montesclaros L, Underwood JG, Masquelier DA, Nishimura SY, Schnall-Levin M, Wyatt PW, Hindson CM, Bharadwaj R, Wong A, Ness KD, Beppu LW, Deeg HJ, McFarland C, Loeb KR, Valente WJ, Ericson NG, Stevens EA, Radich JP, Mikkelsen TS, Hindson BJ, Bielas JH. Massively parallel digital transcriptional profiling of single cells. Nat Commun. 2017;8:1.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Hoen PACT, Friedländer MR, Almlöf J, Sammeth M, Pulyakhina I, Anvar SY, Laros JFJ, Buermans HPJ, Karlberg O, Brännvall M, Dunnen JTD, Ommen GJBV, Gut IG, Guigó R, Estivill X, Syvänen AC, Dermitzakis ET, Lappalainen T. Reproducibility of high-throughput mRNA and small RNA sequencing across laboratories. Nature Biotechnol. 2013;31:1015–22.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breton</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Valieris</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tojal da Silva</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nussenzweig</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Human dendritic cells (dcs) are derived from distinct circulating precursors that are pre-committed to become cd1c + or cd141 + dcs</article-title>
        <source>J Exp Med</source>
        <year>2016</year>
        <volume>213</volume>
        <fpage>2861</fpage>
        <lpage>2870</lpage>
        <pub-id pub-id-type="doi">10.1084/jem.20161135</pub-id>
        <?supplied-pmid 27864467?>
        <pub-id pub-id-type="pmid">27864467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zarkavelis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Boussios</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Papadaki</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Katsanos</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Christodoulou</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Pentheroudakis</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Current and future biomarkers in colorectal cancer</article-title>
        <source>Ann Gastroenterol</source>
        <year>2017</year>
        <volume>30</volume>
        <issue>6</issue>
        <fpage>613</fpage>
        <lpage>621</lpage>
        <?supplied-pmid 29118555?>
        <pub-id pub-id-type="pmid">29118555</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barrett</surname>
            <given-names>Christian L.</given-names>
          </name>
          <name>
            <surname>DeBoever</surname>
            <given-names>Christopher</given-names>
          </name>
          <name>
            <surname>Jepsen</surname>
            <given-names>Kristen</given-names>
          </name>
          <name>
            <surname>Saenz</surname>
            <given-names>Cheryl C.</given-names>
          </name>
          <name>
            <surname>Carson</surname>
            <given-names>Dennis A.</given-names>
          </name>
          <name>
            <surname>Frazer</surname>
            <given-names>Kelly A.</given-names>
          </name>
        </person-group>
        <article-title>Systematic transcriptome analysis reveals tumor-specific isoforms for ovarian cancer diagnosis and therapy</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <year>2015</year>
        <volume>112</volume>
        <issue>23</issue>
        <fpage>E3050</fpage>
        <lpage>E3057</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1508057112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Billatos</surname>
            <given-names>Ehab</given-names>
          </name>
          <name>
            <surname>Vick</surname>
            <given-names>Jessica L.</given-names>
          </name>
          <name>
            <surname>Lenburg</surname>
            <given-names>Marc E.</given-names>
          </name>
          <name>
            <surname>Spira</surname>
            <given-names>Avrum E.</given-names>
          </name>
        </person-group>
        <article-title>The Airway Transcriptome as a Biomarker for Early Lung Cancer Detection</article-title>
        <source>Clinical Cancer Research</source>
        <year>2018</year>
        <volume>24</volume>
        <issue>13</issue>
        <fpage>2984</fpage>
        <lpage>2992</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-16-3187</pub-id>
        <?supplied-pmid 29463557?>
        <pub-id pub-id-type="pmid">29463557</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ervine</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McBride</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kelly</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Loughrey</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Double immunohistochemistry enhances detection of lymphatic and venous invasion in early-stage colorectal cancer</article-title>
        <source>Virchows Arch</source>
        <year>2015</year>
        <volume>467</volume>
        <fpage>265</fpage>
        <lpage>271</lpage>
        <pub-id pub-id-type="doi">10.1007/s00428-015-1792-x</pub-id>
        <?supplied-pmid 26077465?>
        <pub-id pub-id-type="pmid">26077465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martinuzzi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pastorino</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Andreotti</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Garuti</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Minuto</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fiocca</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>BianchiScarrÃ</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ghiorzo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Grillo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mastracci</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>A combination of immunohistochemistry and molecular approaches improves highly sensitive detection of braf mutations in papillary thyroid cancer</article-title>
        <source>Endocrine</source>
        <year>2016</year>
        <volume>53</volume>
        <fpage>672</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="doi">10.1007/s12020-015-0720-9</pub-id>
        <?supplied-pmid 26296380?>
        <pub-id pub-id-type="pmid">26296380</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Huipeng</given-names>
          </name>
          <name>
            <surname>Courtois</surname>
            <given-names>Elise T</given-names>
          </name>
          <name>
            <surname>Sengupta</surname>
            <given-names>Debarka</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>Yuliana</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Kok Hao</given-names>
          </name>
          <name>
            <surname>Goh</surname>
            <given-names>Jolene Jie Lin</given-names>
          </name>
          <name>
            <surname>Kong</surname>
            <given-names>Say Li</given-names>
          </name>
          <name>
            <surname>Chua</surname>
            <given-names>Clarinda</given-names>
          </name>
          <name>
            <surname>Hon</surname>
            <given-names>Lim Kiat</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>Wah Siew</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>Mark</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>Paul Jongjoon</given-names>
          </name>
          <name>
            <surname>Wee</surname>
            <given-names>Lawrence J K</given-names>
          </name>
          <name>
            <surname>Hillmer</surname>
            <given-names>Axel M</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>Iain Beehuat</given-names>
          </name>
          <name>
            <surname>Robson</surname>
            <given-names>Paul</given-names>
          </name>
          <name>
            <surname>Prabhakar</surname>
            <given-names>Shyam</given-names>
          </name>
        </person-group>
        <article-title>Reference component analysis of single-cell transcriptomes elucidates cellular heterogeneity in human colorectal tumors</article-title>
        <source>Nature Genetics</source>
        <year>2017</year>
        <volume>49</volume>
        <issue>5</issue>
        <fpage>708</fpage>
        <lpage>718</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3818</pub-id>
        <?supplied-pmid 28319088?>
        <pub-id pub-id-type="pmid">28319088</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Torgo L. Data mining with R, learning with case studies. Chapman and Hall/CRC; 2010.</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ben-Hur</surname>
            <given-names>Asa</given-names>
          </name>
          <name>
            <surname>Ong</surname>
            <given-names>Cheng Soon</given-names>
          </name>
          <name>
            <surname>Sonnenburg</surname>
            <given-names>Sören</given-names>
          </name>
          <name>
            <surname>Schölkopf</surname>
            <given-names>Bernhard</given-names>
          </name>
          <name>
            <surname>Rätsch</surname>
            <given-names>Gunnar</given-names>
          </name>
        </person-group>
        <article-title>Support Vector Machines and Kernels for Computational Biology</article-title>
        <source>PLoS Computational Biology</source>
        <year>2008</year>
        <volume>4</volume>
        <issue>10</issue>
        <fpage>e1000173</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000173</pub-id>
        <?supplied-pmid 18974822?>
        <pub-id pub-id-type="pmid">18974822</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lapan</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Whitney</surname>
            <given-names>IE</given-names>
          </name>
          <name>
            <surname>Tran</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Kowalczyk</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Adiconis</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Levin</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mccarroll</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Cepko</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sanes</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>166</volume>
        <issue>5</issue>
        <fpage>1308</fpage>
        <lpage>1323</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.07.054</pub-id>
        <?supplied-pmid 27565351?>
        <pub-id pub-id-type="pmid">27565351</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Using neural networks for reducing the dimensions of single-cell RNA-seq data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>17</issue>
        <fpage>e156</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx681</pub-id>
        <?supplied-pmid 28973464?>
        <pub-id pub-id-type="pmid">28973464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">M. Kuhn, “Building predictive models in r using the caret package,” Journal of Statistical Software. 2008; 28.</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">K. Hornik, A. Smola, A. Karatzoglou, and A. Zeileis, “kernlab - an s4 package for kernel methods in r,” J Stat Software 2004; 11.</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>James</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Witten</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>An Introduction to Statistical Learning with Applications in R. Springer texts in statistics An introduction to statistical learning</source>
        <year>2013</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer New York : Imprint: Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR : a bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baglama</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Reichel</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Augmented implicitly restarted lanczos bidiagonalization methods</article-title>
        <source>SIAM J Sci Comput</source>
        <year>2005</year>
        <volume>27</volume>
        <issue>1</issue>
        <fpage>19</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1137/04060593X</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Alquicira-Hernandez J, Sathe A, Ji HP, Nguyen Q, Powell JE. <italic>scPred</italic>: accurate supervised method for cell-type classification from single-cell RNA-seq data. Github. 2019 <ext-link ext-link-type="uri" xlink:href="https://github.com/powellgenomicslab/scPred">https://github.com/powellgenomicslab/scPred</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">Alquicira-Hernandez J, Sathe A, Ji HP, Nguyen Q, Powell JE. <italic>scPred</italic>: accurate supervised method for cell-type classification from single-cell RNA-seq data. Zenodo. 2019 doi:10.5281/zenodo.3391594.</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Andor N, Sathe A, Ji HP. Single-cell genomic analysis of gastrointestinal cancer. dbGap. 2019 <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/study.cgi?study_id=phs001818">https://www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/study.cgi?study_id=phs001818</ext-link>. v1.p1.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <mixed-citation publication-type="other">Muraro MJ, Dharmadhikari G, de Koning E, van Oudenaarden A. A single-cell transcriptome atlas of the human pancreas. Gene Expression Omnibus. 2016. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE85241">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE85241</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <mixed-citation publication-type="other">Palasantza A, Sandberg R, Segerstolpe A. (2018, January 29). Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes. ArrayExpress. 2016. <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-5061">https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-5061</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <mixed-citation publication-type="other">Xin Y, Gromada J. Gene Expression Omnibus. (2018, January 29). RNA sequencing of single human islet cells reveals type 2 diabetes genes. 2016. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE81608">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE81608</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <mixed-citation publication-type="other">Veres A, Baron M. (2018, January 29). A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure. 2016. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE84133">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE84133</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <mixed-citation publication-type="other">Zheng Grace XY, Terry JM, Belgrader P, Ryvkin P, Bent ZW, Wilson R, Ziraldo SB, Wheeler TD, McDermott GP, Zhu J, Gregory MT, Shuga J, Montesclaros L, Underwood JG, Masquelier DA, Nishimura SY, Schnall-Levin M, Wyatt PW, Hindson CM, Bharadwaj R, Wong A, Ness KD, Beppu LW, Deeg HJ, McFarland C, Loeb KR, Valente WJ, Ericson NG, Stevens EA, Radich JP, Mikkelsen TS, Hindson BJ, Bielas JH. (2019, January 3). Massively parallel digital transcriptional profiling of single cells. 10X Genomics datasets. 2019. <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets">https://support.10xgenomics.com/single-cell-gene-expression/datasets</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <mixed-citation publication-type="other">Villani AC, Satija R, Reynolds G, Sarkizova S, Shekhar K, Fletcher J, Griesbeck M, Butler A, Zheng S, Lazo S, Jardine L, Dixon D, Stephenson E, Nilsson E, Grundberg I, McDonald D, Filby A, Li W, De Jager PL, Rozenblatt-Rosen O, Lane AA, Haniffa M, Regev A, Hacohen N. (2018, January 29). Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors. Single Cell Portal. 2017. <ext-link ext-link-type="uri" xlink:href="https://portals.broadinstitute.org/single_cell/study/SCP43/atlas-of-human-blood-dendritic-cells-and-monocytes">https://portals.broadinstitute.org/single_cell/study/SCP43/atlas-of-human-blood-dendritic-cells-and-monocytes</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <mixed-citation publication-type="other">Oliveira T, Satija R. Gene Expression Omnibus. (2018, January 29). Single-cell RNA-seq reveals heterogeneity within human pre-cDCs. 2016. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE89232">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE89232</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <mixed-citation publication-type="other">Li H, Courtois ET. (2018, January 29). Reference component analysis of single-cell transcriptomes elucidates cellular heterogeneity in human colorectal tumors. Gene Expression Omnibus. 2017. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE81861">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE81861</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
