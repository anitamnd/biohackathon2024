<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4058918</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu267</article-id>
    <article-id pub-id-type="publisher-id">btu267</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb 2014 Proceedings Papers Committee</subject>
        <subj-group subj-group-type="heading">
          <subject>Original Papers</subject>
          <subj-group subj-group-type="heading">
            <subject>Mass Spectrometry and Proteomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Pipasic: similarity and expression correction for strain-level identification and quantification in metaproteomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Penzlin</surname>
          <given-names>Anke</given-names>
        </name>
        <xref ref-type="aff" rid="btu267-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="btu267-FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lindner</surname>
          <given-names>Martin S.</given-names>
        </name>
        <xref ref-type="aff" rid="btu267-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="btu267-FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Doellinger</surname>
          <given-names>Joerg</given-names>
        </name>
        <xref ref-type="aff" rid="btu267-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu267-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dabrowski</surname>
          <given-names>Piotr Wojtek</given-names>
        </name>
        <xref ref-type="aff" rid="btu267-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu267-AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nitsche</surname>
          <given-names>Andreas</given-names>
        </name>
        <xref ref-type="aff" rid="btu267-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Renard</surname>
          <given-names>Bernhard Y.</given-names>
        </name>
        <xref ref-type="aff" rid="btu267-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btu267-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="btu267-AFF1"><sup>1</sup>Research Group Bioinformatics (NG4), <sup>2</sup>Centre for Biological Threats and Special Pathogens 1 (ZBS 1), <sup>3</sup>Centre for Biological Threats and Special Pathogens 6 (ZBS 6) and <sup>4</sup>Central Administration 4 (IT), Robert Koch Institute, 13353 Berlin, Germany</aff>
    <author-notes>
      <corresp id="btu267-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="btu267-FN1">
        <p><sup>†</sup>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>12</issue>
    <fpage>i149</fpage>
    <lpage>i156</lpage>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Metaproteomic analysis allows studying the interplay of organisms or functional groups and has become increasingly popular also for diagnostic purposes. However, difficulties arise owing to the high sequence similarity between related organisms. Further, the state of conservation of proteins between species can be correlated with their expression level, which can lead to significant bias in results and interpretation. These challenges are similar but not identical to the challenges arising in the analysis of metagenomic samples and require specific solutions.</p>
      <p><bold>Results:</bold> We introduce Pipasic (peptide intensity-weighted proteome abundance similarity correction) as a tool that corrects identification and spectral counting-based quantification results using peptide similarity estimation and expression level weighting within a non-negative lasso framework. Pipasic has distinct advantages over approaches only regarding unique peptides or aggregating results to the lowest common ancestor, as demonstrated on examples of viral diagnostics and an acid mine drainage dataset.</p>
      <p><bold>Availability and implementation:</bold> Pipasic source code is freely available from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/pipasic/">https://sourceforge.net/projects/pipasic/</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>RenardB@rki.de</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu267/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online</p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>In contrast to classical proteomic approaches, metaproteomics and environmental proteomics studies aim at deciphering the interplay of different organisms contained within an environmental sample (<xref rid="btu267-B24" ref-type="bibr">Muth <italic>et al.</italic>, 2013</xref>). Throughout the past years, this idea has seen increasing application primarily in three fields: aqueous ecosystems, terrestrial systems and eukaryotic host microbiomes (<xref rid="btu267-B12" ref-type="bibr">Hettich <italic>et al.</italic>, 2013</xref>). In addition, metaproteomic approaches have become of interest also for clinical diagnostics, e.g. for characterizing the state of an infection (<xref rid="btu267-B10" ref-type="bibr">Fouts <italic>et al.</italic>, 2012</xref>) or for identifying and strain-level typing of bacteria (<xref rid="btu267-B18" ref-type="bibr">Karlsson <italic>et al.</italic>, 2012</xref>).</p>
    <p>Similar to metagenomic approaches (<xref rid="btu267-B35" ref-type="bibr">Wooley <italic>et al.</italic>, 2010</xref>), the analysis of environmental samples and the interplay of organisms offer an enormous potential to further the characterization and understanding of these systems. At the same time, challenges in metaproteomics are manifold and relate to all steps of the analysis. Particularly, this includes the handling of the resulting large and complex datasets of spectra derived from mass spectrometry (MS) experiments and their meaningful comparison with reference proteomes of organisms. It can by no means be generally assumed that this set of references—in particular for bacteria or viruses—is complete or representative for the given sample (<xref rid="btu267-B21" ref-type="bibr">Lindner <italic>et al.</italic>, 2013</xref>). Depending on the sample of interest, the number of organisms of interest may vary significantly from tens to thousands and more. In all cases, it is non-trivial to identify the correct origin of a spectrum and thereby to allow either the identification of organisms or the quantification of either organisms or key biological processes.</p>
    <p>While many goals and strategies correlate for metagenomic and metaproteomic approaches, several distinct differences are noteworthy. In metaproteomic approaches, expression levels are analyzed and thus quantitative measures differ even for proteins from a single organism. This can be highly insightful for functional analyses (<xref rid="btu267-B24" ref-type="bibr">Muth <italic>et al.</italic>, 2013</xref>), but poses an additional challenge for data analysis. Further, while the method is designed to be unbiased, it cannot be assumed that all proteins are extracted and captured by MS in a metaproteomics experiment. However, as it is an orthogonal technique to metagenomics, metaproteomic and metagenomic approaches have differing error profiles and can jointly provide a much deeper insight than each method on its own (<xref rid="btu267-B12" ref-type="bibr">Hettich <italic>et al.</italic>, 2013</xref>), even in cases such as the quantification of strains when metagenomics is usually preferable owing to lower demands on material and longer sequences. It should be noted that metaproteomic approaches require the availability of reference proteomes or genomes and cannot assemble them from a given sample as in metagenome protocols [e.g. <xref rid="btu267-B19" ref-type="bibr">Lai <italic>et al.</italic> (2012)</xref>].</p>
    <p>While numerous tools have been introduced for metagenomic data analysis (see <xref rid="btu267-B34" ref-type="bibr">Teeling and Glockner (2012)</xref> for an overview), only comparatively few tools exist with focus on the specific difficulties arising in the analysis of metaproteomic data. These cover a broad field ranging from specialized approaches for visualization (<xref rid="btu267-B23" ref-type="bibr">Mehlan <italic>et al.</italic>, 2013</xref>) to the scalability of database search algorithms (<xref rid="btu267-B16" ref-type="bibr">Jagtap <italic>et al.</italic>, 2013</xref>, <xref rid="btu267-B15" ref-type="bibr">2012b</xref>) and to metaproteogenomics and the difficulty of identifying a suitable reference database (<xref rid="btu267-B30" ref-type="bibr">Rooijers <italic>et al.</italic>, 2011</xref>; <xref rid="btu267-B32" ref-type="bibr">Seifert <italic>et al.</italic>, 2013</xref>).</p>
    <p>One key difficulty that is hindering metaproteomic data analysis is the ambiguity of peptide identifications (<xref rid="btu267-B12" ref-type="bibr">Hettich <italic>et al.</italic>, 2013</xref>; <xref rid="btu267-B24" ref-type="bibr">Muth <italic>et al.</italic>, 2013</xref>; <xref rid="btu267-B32" ref-type="bibr">Seifert <italic>et al.</italic>, 2013</xref>). Even more pronounced than in classical bottom-up proteomic approaches (<xref rid="btu267-B25" ref-type="bibr">Nesvizhskii, 2010</xref>), one spectrum can not only match to several peptides occurring in multiple proteins of the same organism, but may match to proteins in different organisms. This is particularly common for closely related organisms with sufficient sequence similarity and for well-conserved proteins. Consequently, this problem hinders the correct identification and quantification of the species present in a sample. While also common in metagenomics (<xref rid="btu267-B20" ref-type="bibr">Lindner and Renard, 2013</xref>), it is even more challenging in proteomics because peptides are commonly shorter than sequencing reads and thereby less likely to be unique. Furthermore, expression levels are not necessarily uncorrelated to the state of conservation of a protein and thereby constitute a potentially large bias when disregarded.</p>
    <p>Currently, two major ideas are used to address this difficulty: either the analysis is based primarily on unique peptides that are specific for a single organism (<xref rid="btu267-B18" ref-type="bibr">Karlsson <italic>et al.</italic>, 2012</xref>; <xref rid="btu267-B22" ref-type="bibr">Lo <italic>et al.</italic>, 2007</xref>; <xref rid="btu267-B30" ref-type="bibr">Rooijers <italic>et al.</italic>, 2011</xref>) or the phylogenetic resolution is reduced. This can be achieved by limiting the analysis to a set of well-chosen representative species that have no significant overlap (<xref rid="btu267-B4" ref-type="bibr">Chourey <italic>et al.</italic>, 2013</xref>) or by dynamically allocating results to the lowest common ancestor that allows a distinction (<xref rid="btu267-B13" ref-type="bibr">Huson <italic>et al.</italic>, 2007</xref>; <xref rid="btu267-B14" ref-type="bibr">Jagtap <italic>et al.</italic>, 2012a</xref>; <xref rid="btu267-B31" ref-type="bibr">Schneider <italic>et al.</italic>, 2011</xref>). When disregarding shared peptides and focusing on unique peptides, it is feasible to identify the species present in an organism as long as the coverage is high enough to observe a sufficient number of these peptides with sufficient confidence. This can be a challenge in metaproteomic experiments, which commonly have low coverage for individual species (<xref rid="btu267-B12" ref-type="bibr">Hettich <italic>et al.</italic>, 2013</xref>), and resulting difficulties in the reliability of peptide identifications (<xref rid="btu267-B28" ref-type="bibr">Renard <italic>et al.</italic>, 2010</xref>) can lead to false conclusions. Furthermore, quantitative information derived exclusively from distinct unique peptides is not necessarily representative for the presence of organisms or functional groups. When using representatives or lowest common ancestor, the resolution of the approach is reduced and it may no longer be possible to distinguish strains or related species.</p>
    <p>Within this contribution, we introduce Pipasic (peptide intensity-weighted proteome abundance similarity correction) as a tool for metaproteomic data analysis, which overcomes the limitations of these two strategies. Pipasic uses all peptide identifications available, not only unique peptides, and generates a strain-specific quantitative output without resorting to a lower phylogenetic resolution. This is possible because Pipasic builds on a similarity correction approach from metagenomics (<xref rid="btu267-B20" ref-type="bibr">Lindner and Renard, 2013</xref>), which implicitly weights and corrects observed abundances based on the experiment-specific expected similarity between reference genomes. Further, Pipasic avoids potential bias by estimating the similarity only for expressed proteins, which may correlate with the state of conservation of proteins.</p>
    <p>We evaluate Pipasic in two settings: a diagnostic setting where we distinguish two closely related cowpox virus strains at varying concentrations and a metaproteomic dataset from an acid mine drainage (AMD) environment. We compare Pipasic to a MEGAN-based (<xref rid="btu267-B13" ref-type="bibr">Huson <italic>et al.</italic>, 2007</xref>) analysis as a commonly used lowest common ancestor approach (<xref rid="btu267-B14" ref-type="bibr">Jagtap <italic>et al.</italic>, 2012a</xref>) and analyze the impact of the expression level correction and unique peptides.</p>
  </sec>
  <sec>
    <title>2 METHODS</title>
    <p>Pipasic is a method for estimating corrected proteome abundances in a metaproteomic dataset and builds on the GASiC approach (<xref rid="btu267-B20" ref-type="bibr">Lindner and Renard, 2013</xref>), extending it to the specific features of metaproteomic data. The overall workflow is outlined in <xref ref-type="fig" rid="btu267-F1">Figure 1</xref>. As input, Pipasic takes a metaproteomic dataset containing a set of tandem mass spectra data and a set of <italic>N</italic> reference proteomes <inline-formula><mml:math id="n1"><mml:mrow><mml:msub><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1..</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> of organisms or functional groups that are expected to be potentially contained within the sample. The goal then is to quantify the contribution of these references to the spectral data at hand. The first step is the identification of the metaproteomic spectra with the peptides in the reference proteomes. The number of identified spectra per proteome is the naïve <italic>observed abundance</italic> estimate. The second step calculates a matrix containing the pairwise similarities of the reference proteomes, reflecting only those proteins expressed in the sample according to their expression level. The results of the first two steps are then used to estimate the corrected proteome abundances.
<fig id="btu267-F1" position="float"><label>Fig. 1.</label><caption><p>Method overview. Pipasic involves three main steps: (i) peptide identification: here metaproteomic peptide spectra are identified by a database search. The number of matches to the proteomes is the observed abundances. (ii) Similarity estimation: the similarities between the reference proteomes are calculated and stored in a similarity matrix. This incorporates the adjustment to only regard expressed proteins and to weight them according to their expression level. (iii) Similarity correction: the observed abundances are corrected using the similarity matrix yielding corrected abundances </p></caption><graphic xlink:href="btu267f1"/></fig></p>
    <p>There are two main differences to the genomics-based GASiC approach: first, expression levels are analyzed in metaproteomics. Compared with the homogeneous coverage in metagenomic whole genome sequencing, each protein—even within a single organism—will have a different expression level. These expression levels directly influence the similarity estimation. Second, the number of spectra is typically lower than the number of reads in metagenomics. This requires the proteomes to have sufficiently high numbers of matching spectra that the probabilistic correction step works correctly. Therefore, abundance estimates may be distorted if the coverage is low or the proteome only contains few proteins.</p>
    <sec id="SEC2.1">
      <title>2.1 Peptide identification</title>
      <p>The peptide spectra in the metaproteomic dataset are searched separately against each reference proteome using an appropriate database search algorithm. The choice of peptide search tool is not restricted; we tested searches with InsPecT (<xref rid="btu267-B33" ref-type="bibr">Tanner <italic>et al.</italic>, 2005</xref>), Sequest/Tide (<xref rid="btu267-B6" ref-type="bibr">Diament and Noble, 2011</xref>) and BICEPS (<xref rid="btu267-B29" ref-type="bibr">Renard <italic>et al.</italic>, 2012</xref>). It is crucial for Pipasic that matches to all reference proteomes are reported instead of a subset of best hits as commonly done by many search engines. We generally run the peptide identification and false discovery rate (FDR) computation separately for each reference proteome to be more independent of database size and quality effects (<xref rid="btu267-B17" ref-type="bibr">Jeong <italic>et al.</italic>, 2012</xref>) and further to allow a more fine-grained probabilistic weighting of peptide identifications against presence of a species. However, Pipasic can also be run with a joint peptide identification and FDR computation for all reference proteomes.</p>
      <p>To ensure specificity, we apply a standard decoy database strategy (<xref rid="btu267-B3" ref-type="bibr">Bradshaw <italic>et al.</italic>, 2006</xref>) using a reverse database. A FDR is calculated for each identification; identifications below a user-defined FDR threshold are discarded. For each proteome <inline-formula><mml:math id="n2"><mml:mrow><mml:msub><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the number of FDR-controlled identifications is called the observed proteome abundance. Normalizing the observed abundances of all proteomes to one yields relative observed abundances <italic>r</italic><sub>i</sub>.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Proteome similarity estimation</title>
      <p>The similarity of two reference proteins can be computed in various ways, e.g. based on mismatch statistics or alignment scores. However, for the application to metaproteomics, the quantity of interest is the similarity that may lead to an ambiguous spectra-to-species assignment. The equivalent similarity estimation step in the metagenomic GASiC method involves the simulation of short reads for each genome, which are then mapped to all other genomes. This carefully reflects the risk of incorrectly assigning a read. One could estimate proteome similarities in the same way by simulating spectra for each proteome and identifying them among all other proteomes. However, simulating a significant number of spectra using a simulation method such as the MSSimulator (<xref rid="btu267-B2" ref-type="bibr">Bielow <italic>et al.</italic>, 2011</xref>) is particularly time-consuming and practically infeasible.</p>
      <sec id="SEC2.2.1">
        <title>2.2.1 String comparison</title>
        <p>As a significantly faster alternative, we thus regard the reference proteomes as sets of protein sequences, i.e. sets of strings. Because the proteins in the experiment are typically digested into tryptic peptides before the spectra are acquired, we perform an <italic>in silico</italic> digestion of the reference proteomes, yielding a list of short peptide strings for each proteome. For a proteome, we search all short peptide strings in all other proteomes using exact string matching. To account for the amino acids with indistinguishable masses, we replace all occurrences of I by L and Q by K. We do not regard any ambiguity arising from variable modifications (such as oxidized M) because the analysis on the sequence level cannot incorporate the knowledge whether the potential modification indeed occurs. The fraction of tryptic peptides in proteome <inline-formula><mml:math id="n3"><mml:mrow><mml:msub><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> that can be found in another proteome <inline-formula><mml:math id="n4"><mml:mrow><mml:msub><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is denoted the unweighted similarity <inline-formula><mml:math id="n5"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Thus, we obtain the—unweighted—similarity matrix <inline-formula><mml:math id="n6"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1..</mml:mn><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1..</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec id="SEC2.2.2">
        <title>2.2.2 Weighting by the expression level</title>
        <p>A reference proteome often contains proteins that were not expressed or measured in the experiment. This may either result from the fact that not all proteins are expressed or that expression levels span several orders of magnitude and may be below the detection limit or from biases in sample preparation or MS acquisition (<xref rid="btu267-B12" ref-type="bibr">Hettich <italic>et al.</italic>, 2013</xref>). The similarity of the expressed proteins may strongly differ from the overall similarity because proteins of key cellular functions may be better conserved as well as higher expressed than other proteins of an organism. Thus, we reflect these particular effects in the similarity estimation by introducing weights for all peptides. The weight <italic>w</italic><sub>p</sub> for the tryptic peptide <italic>p</italic> in proteome <inline-formula><mml:math id="n7"><mml:mrow><mml:msub><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is calculated as follows:
<list list-type="order"><list-item><p>Assign a preliminary weight <inline-formula><mml:math id="n8"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>∼</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to each peptide <italic>p</italic>: add <inline-formula><mml:math id="n9"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="n10"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>∼</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for each spectrum that was identified with <italic>p</italic>, where <italic>N</italic><sub>p</sub> is the number of peptides the spectrum can be identified with.</p></list-item><list-item><p>For each protein <inline-formula><mml:math id="n11"><mml:mrow><mml:mi>P</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, set the peptide weights <inline-formula><mml:math id="n12"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width=".5em"/><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula>, to the average preliminary peptide weight: <inline-formula><mml:math id="n13"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>∼</mml:mo></mml:mover><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>Normalize the sum of all weights to one: <inline-formula><mml:math id="n14"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.</p></list-item></list>
</p>
        <p>The matrix entry <italic>a</italic><sub><italic>ij</italic></sub> of the weighted similarity matrix <italic>A</italic> is calculated by summing over the weights of the peptides in <inline-formula><mml:math id="n15"><mml:mrow><mml:msub><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> that were found in <inline-formula><mml:math id="n16"><mml:mrow><mml:msub><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>:
<disp-formula><mml:math id="n17"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mspace width=".5em"/><mml:mtext>if</mml:mtext><mml:mspace width=".5em"/><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
      </sec>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Similarity correction</title>
      <p>The similarity correction step corrects the relative observed abundance <italic>r</italic><sub>i</sub> of proteome <inline-formula><mml:math id="n18"><mml:mrow><mml:msub><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> by estimating the true abundance <italic>c</italic><sub>i</sub>. This step is mathematically identical to the GASiC correction step: the relative observed abundance <italic>r</italic><sub>i</sub> of proteome <inline-formula><mml:math id="n19"><mml:mrow><mml:msub><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is assumed to be a mixture of the true abundances <italic>c</italic><sub>j</sub> weighted with the similarity matrix entry <italic>a</italic><sub>ij</sub> and can thus be written as
<disp-formula><mml:math id="n20"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>
In matrix notation, we can write this equation more briefly as
<disp-formula><mml:math id="n21"><mml:mrow><mml:mi>A</mml:mi><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>c</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>r</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="n22"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>c</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="n23"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>r</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. Directly solving the linear system of equations for <bold>c</bold> may lead to numerically unstable results. Furthermore, we require the estimated abundances to be ≥ 0 and the sum over all abundances to be ≤ 1. Thus, we formulate the solution for <bold>c</bold> as a non-negative lasso (<xref rid="btu267-B9" ref-type="bibr">Efron <italic>et al.</italic>, 2004</xref>; <xref rid="btu267-B27" ref-type="bibr">Renard <italic>et al.</italic>, 2008</xref>) problem:
<disp-formula><mml:math id="n24"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mo>=</mml:mo><mml:munder><mml:mtext>argmin</mml:mtext><mml:mstyle mathvariant="bold"><mml:mi mathvariant="bold">c</mml:mi></mml:mstyle></mml:munder><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>A</mml:mi><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>c</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>r</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mn>2</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>s</mml:mtext><mml:mo>.</mml:mo><mml:mtext>t</mml:mtext><mml:mo>.</mml:mo><mml:mspace width=".5em"/><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mtext>i</mml:mtext></mml:msub><mml:mo>≥</mml:mo><mml:mtext>0</mml:mtext><mml:mspace width=".5em"/><mml:mo>∀</mml:mo><mml:mtext>i and</mml:mtext><mml:mspace width=".5em"/><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mtext>i</mml:mtext></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mtext>|</mml:mtext><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mtext>i</mml:mtext></mml:msub><mml:mtext>|</mml:mtext></mml:mrow></mml:mstyle><mml:mo>≤</mml:mo><mml:mtext>1</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p>
      <p>In our implementation, we solve this problem with the COBYLA method implemented in SciPy (<xref rid="btu267-B26" ref-type="bibr">Oliphant, 2007</xref>).</p>
      <p>Similarly to the GASiC framework, it is possible to obtain statistically more robust estimates by bootstrapping from the set of spectra and iterating the similarity correction step. Statistical tests for the presence of a proteome as well as error estimates for the obtained abundances can then be computed from the distribution of abundance estimates.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Technical details</title>
      <p>Pipasic is implemented as Python scripts where performance-critical parts are calculated using the scientific computing libraries SciPy and NumPy. Currently, Pipasic is designed to directly work with either InsPecT or Sequest/Tide for peptide identification. Pipasic is freely available from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/pipasic/">https://sourceforge.net/projects/pipasic/</ext-link></p>
    </sec>
  </sec>
  <sec>
    <title>3 EXPERIMENTS AND RESULTS</title>
    <p>To evaluate Pipasic and the impact of the various algorithmic steps, we conducted two experiments. First, we demonstrate the accuracy of the method on a mixture of real datasets of cowpox viruses with a known ground truth. Here, we can identify the benefits of individual steps and compare Pipasic with a metaproteomic analysis based on MEGAN and unique peptides. In a second experiment, we apply Pipasic to a published AMD dataset showing that our method is also able to provide corrected abundance estimates for datasets from a natural environment.</p>
    <sec id="SEC3.1">
      <title>3.1 Performance evaluation</title>
      <p>The goal of the first experiment is the quantitative evaluation of the Pipasic method using gold standard ground truth data. In this experiment, we first provide evidence that including the expression information for similarity estimation significantly improves the abundance estimates. Secondly, we demonstrate that Pipasic provides more accurate results with regard to identification and quantification than the analysis with MEGAN and based on unique peptides.</p>
      <p>The idea behind this experiment is to mix two pure proteomic MS datasets of highly similar proteomes in predefined ratios. The challenge for the computational method is to correctly estimate the fraction of each proteome in the dataset. To this end, we rely on two datasets containing two different but closely related cowpox virus strains: <italic>Krefeld</italic> (Kre) and <italic>Brighton Red</italic> (BR). A more thorough description of these datasets is available in (Doellinger <italic>et al.</italic>, unpublished data). HEp-2 (ATCC-CRL-23) cells were infected with the individual viruses and the viruses were then purified, collected by centrifugation and washed. The viral particles were then dissolved in ammonium bicarbonate. Proteins were digested with trypsin, desalted and fractionated. The peptide fractions were then analyzed with an Easy-nanoLC (Thermo Fisher Scientific) coupled online to an LTQ Orbitrap Discovery mass spectrometer (Thermo Fisher Scientific).</p>
      <p>To reduce the number of contaminating spectra, we searched both datasets against the human reference proteome and removed all matches below a 5% FDR. To create the reference proteomes for both viruses, their viral DNA sequences were assembled and genes were identified based on existing NCBI annotations for cowpox viruses. The reference proteomes for both strains were created by translating the identified genes into proteins (Doellinger <italic>et al.</italic>, unpublished data).</p>
      <p>We now mixed the remaining spectra to create 11 artificial datasets with mixtures ranging from 100% Kre strain to 100% BR strain by sampling spectra from the original datasets such that each dataset contained 3000 spectra in total. To ensure a balanced spectrum quality in all datasets, we sampled high- and low-quality spectra in a 1:1 ratio from the original datasets where high quality was defined as spectra within the 5% FDR range when searched against the corresponding reference proteome.</p>
      <sec id="SEC3.1.1">
        <title>3.1.1 Unweighted versus weighted Pipasic</title>
        <p>We processed the 11 datasets with Pipasic as described in the Section 2 using InsPecT for peptide identification and both the unweighted and expression-weighted similarity matrix. <xref ref-type="fig" rid="btu267-F2">Figure 2</xref> shows the calculated abundance estimates plotted over the true fraction of Kre spectra on the x-axis, such that the estimates for one dataset lie in a column. The dashed lines represent the observed abundances and emphasize the major challenge with these datasets: high relative abundance values are assigned to both proteomes, as the bulk of the spectra could not be identified uniquely. Although the unweighted correction (dash-dotted lines) clearly improves on the observed abundances, we can still see the discrepancy to the ground truth (solid circles). The expression-weighted correction (solid lines) yields the best approximation of the true abundances. The error bars show the 95% confidence interval of our estimates, which was estimated by 100-fold bootstrapping from our datasets. In particular, the weighted correction estimates zero or low abundances if a proteome was not or almost not contained in the metaproteomic dataset.
<fig id="btu267-F2" position="float"><label>Fig. 2.</label><caption><p>Effect of Pipasic correction: the relative abundances of 11 mixed cowpox virus Kre/BR datasets were corrected with Pipasic without and with expression correction. The observed abundances (dashed lines) are insufficient estimates for the true abundances (solid dots): in the extreme cases of pure Kre or BR datasets the absent virus still receives 45% abundance. The unweighted correction (dash–dotted line) improves on this, but best results are obtained using the expression-weighted similarity matrices (solid line). The error bars indicate the 95% confidence interval after 100-fold bootstrapping </p></caption><graphic xlink:href="btu267f2"/></fig></p>
        <p>Furthermore, we repeated the experiment using the 20% BR/80% Kre dataset, but successively increased the number of reference proteomes by adding proteomes of other DNA viruses to the database (BR and Kre proteomes were always present). We used up to 20 proteomes (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu267/-/DC1">Supplementary Text</ext-link>) and measured the Pipasic run time and estimation accuracy by calculating the root mean squared error. Both metrics are shown in <xref ref-type="fig" rid="btu267-F3">Figure 3</xref>. The most time-consuming step of Pipasic is peptide identification, and therefore, its linear contribution is stronger than the contribution of the similarity matrix calculation with quadratic complexity. We also see that the error of the estimated abundances is low for all considered database sizes and only increases slightly with the number of proteomes.
<fig id="btu267-F3" position="float"><label>Fig. 3.</label><caption><p>Influence of reference database size on Pipasic prediction accuracy and run time. A dataset containing 20% BR and 80% Kre was searched against a reference proteome database with increasing size. Prediction accuracy was measured using the root mean squared error of the BR and Kre estimates. The run time was measured for the complete Pipasic run, including peptide identification with InsPecT and abundance correction, but without bootstrapping. The error is low for all database sizes and only increases slightly with the database size. The run time increases linearly with the number of reference proteomes, as peptide identification is the most time-consuming step in the pipeline </p></caption><graphic xlink:href="btu267f3"/></fig></p>
      </sec>
      <sec id="SEC3.1.2">
        <title>3.1.2 Comparison to MEGAN</title>
        <p>To compare Pipasic with currently used approaches, we also applied MEGAN to the data, which parses the results of a BLAST (<xref rid="btu267-B1" ref-type="bibr">Altschul <italic>et al.</italic>, 1990</xref>) search against a reference database. An underlying phylogenetic tree allows assigning of shared identifications to lowest common ancestor nodes in the tree, expressing the degree of ambiguity in the results. In this way, MEGAN raises the significance of the unique identifications for the evaluation of the experiment.</p>
        <p>We searched all 11 mixed cowpox virus datasets against the Kre and BR reference proteome databases using InsPecT to identify each spectrum with a peptide sequence. Then we searched the peptide sequences with BLASTP in the reference proteomes, such that all identifications could be placed to the correct position in the phylogenetic tree with MEGAN. <xref ref-type="fig" rid="btu267-F4">Figure 4</xref>a shows the output of MEGAN for the dataset containing 10% Kre and 90% BR spectra. The size of the circles is log-proportional to the number of assigned spectra, visualizing that the majority of spectra was assigned to the higher level Orthopoxvirus node. The leaves, representing Kre and BR, obtained relatively few spectra: only 8.4% of all matches were unique. In <xref ref-type="fig" rid="btu267-F4">Figure 4</xref>b, we plotted for each dataset both the unique matches to each proteome as well as the sum of shared Cowpox virus and unique matches. Because the number of shared matches is much higher than the number of unique matches, the sum of unique and shared (dashed lines) is not informative, as both proteomes obtain close to 50% relative abundance. The number of unique matches (dash–dotted lines) contains more information, and the resulting relative abundances are closer to the ground truth. However, in the case of pure datasets, still a significant number of spectra is matching uniquely to the absent species (about 15%). Here, the Pipasic estimates (solid lines) are much closer to the ground truth.
<fig id="btu267-F4" position="float"><label>Fig. 4.</label><caption><p>Comparison of Pipasic and MEGAN on the cowpox virus datasets. (<bold>a</bold>) MEGAN output for the 10% Kre/90% BR dataset. (<bold>b</bold>) Comparison of MEGAN and Pipasic on all 11 mixed cowpox virus datasets. For MEGAN, the number of unique and shared matches (dashed lines) shows almost no difference between the two proteomes because the number of unique matches is low. The number of unique matches (dash–dotted lines) provides abundances closer to the ground truth, but Pipasic (solid lines) yields the best estimates </p></caption><graphic xlink:href="btu267f4"/></fig></p>
      </sec>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 AMD experiment</title>
      <p>In the second experiment, we demonstrate the applicability of Pipasic to metaproteomic data originating from a natural environment, which is more complex than our <italic>in silico</italic> metaproteome. With this experiment, we show that Pipasic automatically corrects abundances of highly similar reference proteomes without affecting the abundances of other unrelated proteomes. For that purpose, we used metaproteomic spectra of an AMD biofilm dataset described in <xref rid="btu267-B5" ref-type="bibr">Denef <italic>et al.</italic> (2010)</xref>. AMD biofilms are bacterial communities in a highly acidic environment. Thus, AMD communities are not as complex as other microbial communities and their composition is well understood.</p>
      <p>We downloaded the metaproteomic spectra of sample 20 run 2 and the corresponding protein database from the authors’ Web site (<ext-link ext-link-type="uri" xlink:href="http://compbio.ornl.gov/biofilm_amd_PIGT">http://compbio.ornl.gov/biofilm_amd_PIGT/</ext-link> accessed in March 2013). As the protein database contained sequences for all dominant organisms, we manually divided the database into six reference proteomes: <italic>Leptospirillum</italic> group II and III (Lepto2 and Lepto3), <italic>Ferroplasma acidarmanus</italic> Type I and II (Fer1 and Fer2), G-plasma and others, like contaminants and unassigned archaea and bacteria. Then we searched the spectra in the reference proteomes with Tide and counted the number of matching spectra. We applied Pipasic with data weighting on the results to obtain the corrected abundance estimates.</p>
      <p>The results of this experiment are shown in <xref ref-type="table" rid="btu267-T1">Table 1</xref>. Here, the effect of the correction is not as pronounced as in the previous experiment owing to the relatively low similarity values (maximum 0.21 compared with 0.92). Lepto3 receives the strongest absolute correction (−359 PSMs) owing to the protein sequence similarities with Lepto2, which receives low relative correction. Fer1 and Fer2 have the highest proteome similarities in this experiment (0.21/0.19); their abundances were reduced in sum by 48.3%. G-plasma has the least similarity to the other proteomes (&lt;0.04) and therefore receives only little correction by 3%. Notably, the correction within the Lepto group is asymmetric: Lepto3 receives stronger relative correction than Lepto2. Two opposing factors contribute to this effect: first, the number of peptide spectrum matches to Lepto2 is more than twice as high as to Lepto3 (<xref ref-type="table" rid="btu267-T1">Table 1</xref>) and, second, the probability to find a Lepto2 spectrum in Lepto3 (<xref ref-type="fig" rid="btu267-F5">Fig. 5</xref>) is ∼30% higher than vice versa. Taken together, the difference in abundance dominates the correction in the Lepto group, such that the absolute number of Lepto2 peptides that can also be found in Lepto3 is much higher than vice versa.
<fig id="btu267-F5" position="float"><label>Fig. 5.</label><caption><p>Pipasic similarity matrix with data weighting for the AMD experiment. The matrix entries encode the probability that a peptide in a source proteome can be found in a target proteome, modulated by the metaproteomic data (see Section 2). Here we see that the intra-group matrix coefficients for the Fer and Lepto group are greater than the inter-group coefficients. This means in practice that Pipasic corrects abundances within but not between the two groups. It is noteworthy that the matrix coefficients can be asymmetric, which has the effect that abundance can be shifted from one proteome to another rather than correcting both proteomes equally </p></caption><graphic xlink:href="btu267f5"/></fig>
<table-wrap id="btu267-T1" position="float"><label>Table 1.</label><caption><p>AMD dataset abundance estimation</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Proteome</th><th rowspan="1" colspan="1">Fer1</th><th rowspan="1" colspan="1">Fer2</th><th rowspan="1" colspan="1">Lepto2</th><th rowspan="1" colspan="1">Lepto3</th><th rowspan="1" colspan="1">G-Plasma</th><th rowspan="1" colspan="1">Other</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Observed PSMs</td><td rowspan="1" colspan="1">195</td><td rowspan="1" colspan="1">189</td><td rowspan="1" colspan="1">4470</td><td rowspan="1" colspan="1">2014</td><td rowspan="1" colspan="1">692</td><td rowspan="1" colspan="1">87</td></tr><tr><td rowspan="1" colspan="1">Pipasic estimate</td><td rowspan="1" colspan="1">111</td><td rowspan="1" colspan="1">88</td><td rowspan="1" colspan="1">4281</td><td rowspan="1" colspan="1">1655</td><td rowspan="1" colspan="1">671</td><td rowspan="1" colspan="1">32</td></tr><tr><td rowspan="1" colspan="1">Relative correction (%)</td><td rowspan="1" colspan="1">43.1</td><td rowspan="1" colspan="1">53.4</td><td rowspan="1" colspan="1">4.2</td><td rowspan="1" colspan="1">17.8</td><td rowspan="1" colspan="1">3.0</td><td rowspan="1" colspan="1">63.2</td></tr></tbody></table><table-wrap-foot><fn id="btu267-TF1"><p><italic>Note</italic>: The peptide spectrum matches (PSM) were counted for each proteome and subsequently corrected with Pipasic using a weighted similarity matrix. The results show a strong relative correction for the highly similar Fer 1/2 and only small relative correction for Lepto 2/3 and G-Plasma.</p></fn></table-wrap-foot></table-wrap></p>
      <p>This experiment demonstrates that the proposed Pipasic method can handle real metaproteomic data and the calculated estimates are in agreement with the expectation. The two main groups Fer1/2 and Lepto2/3 receive abundance corrections within each group, but not between the groups. This is noteworthy because we did not require any prior information other than the reference proteomes and shows that the similarity estimates reflect the nature of the microbial community.</p>
    </sec>
  </sec>
  <sec>
    <title>4 DISCUSSION</title>
    <p>The experiments indicate that Pipasic allows the reliable separation of highly similar strains in metaproteomics experiments. It can be used for reliably identifying and quantifying the contributions of organisms and functional units even in cases when—as in the cowpox virus data experiment—92% of all expressed tryptic peptides are identical. In particular, Pipasic allows having a phylogenetic resolution down to the strain level, which is inherently not feasible for lowest common ancestor approaches for highly related species. This is also clearly visible in the comparison with MEGAN on the cowpox virus strain data (<xref ref-type="fig" rid="btu267-F4">Fig. 4</xref>).</p>
    <p>Given its reliability, Pipasic is preferable to approaches relying solely on the analysis of unique peptides. <xref ref-type="fig" rid="btu267-F4">Figure 4</xref> indicates the risk of analyzing unique peptides for highly related strains. Even though the overall number of identified peptides per species is above 1000, which is high for a metaproteomic setting, the number of unique peptides remains low owing to the sequence similarity. Thus, only few peptide identifications out of a thousand decide on the identification of a species when relying on unique peptides. The example in <xref ref-type="fig" rid="btu267-F4">Figure 4</xref> highlights the risk: even in cases when the ground truth contains 0% spectra of the Kre strain, MEGAN finds 17 unique peptides; this effect was also observed when using the more conservative OMSSA (<xref rid="btu267-B11" ref-type="bibr">Geer <italic>et al.</italic>, 2004</xref>) search engine instead of InsPecT. These may incorrectly be interpreted as proof of the presence of the Kre strain. However, given that the original peptide identification search was conducted at a 5% FDR and given the large number of spectra searched, these identifications are incorrect. Because Pipasic leverages the computed similarity and the shared peptides into the analysis, it is less at risk to overvalue these incorrect identifications and correctly reduces the presence of the Kre strain in this example down to a level where it cannot be distinguished from a 0% presence.</p>
    <p>This example also indicates that the statistical model behind Pipasic contains and quantifies uncertainty. A bootstrapping strategy in the abundance estimation step allows us to obtain confidence statements for all estimates, and thereby the definition of cutoffs for diagnostic decisions can be supported by statistical statements. The reliability of an estimate obviously primarily depends on data abundance—the number of supporting spectra—as well as on the computed and weighted similarity of the species of interest.</p>
    <p>Pipasic computes its similarity correction adjusted to the expression level of proteins. The cowpox virus data experiment clearly indicates the significance of this step for the results. This step highlights a major difference between metaproteomics and metagenomics: although the main idea of the metagenomic method could be applied in metaproteomics, the method itself must be tuned to the underlying difference in the biological data. The expression level correction should also be applicable and helpful in metatranscriptomics settings where also expression level information can be confounded with the state of conservation. Here, we applied the correction only for complete proteomes of species because the number of spectra per species was limited. In large-scale experiments, it should also be feasible to adjust for protein groups separately.</p>
    <p>With regard to quantification, Pipasic currently relies exclusively on spectral counts. While we observe positive results for both the expression level correction and the quantification in the cowpox virus experiment, spectral counts have been shown to have limitations with regard to the quantitative range and precision that they cover. Methods combining the intensity of mass spectra with spectral counts, e.g. <xref rid="btu267-B7" ref-type="bibr">Dicker <italic>et al.</italic> (2010)</xref>, could in principle be integrated into the Pipasic framework and further improve the quantification exactness.</p>
    <p>One general difficulty for metaproteomics is that all analyses depend on the completeness of the provided reference proteomes because purely <italic>de novo</italic> peptide identification approaches are not yet sufficiently reliable (<xref rid="btu267-B12" ref-type="bibr">Hettich <italic>et al.</italic>, 2013</xref>). Thus, any quantification or identification by Pipasic is also at risk of only reflecting the available reference proteomes. Using an error-tolerant peptide search strategy such as BICEPS (<xref rid="btu267-B29" ref-type="bibr">Renard <italic>et al.</italic>, 2012</xref>), peptides containing up to two amino acid substitutions can be included and thereby this risk can be reduced.</p>
    <p>Pipasic is currently not optimized for large-scale datasets and can become computationally expensive because peptide identifications need to be performed separately against all reference proteomes and all pairwise string comparisons need to be computed and accounted for. To overcome this, a two-step procedure may be helpful to first identify all species having unique identifications with existing methodology and then to run Pipasic on those subsets that are expected to have a high sequence similarity to ensure specificity of results.</p>
  </sec>
  <sec>
    <title>5 CONCLUSION</title>
    <p>With this contribution, we introduced Pipasic as a tool for identification and quantification in metaproteomics. Pipasic focuses on correcting observed proteome abundances without having to exclusively assign ambiguous peptide spectrum matches to their correct origin among a potentially large number of reference proteomes. Its particular strength is that it computes the peptide level similarity between reference proteomes and thereby can reliably distinguish on the strain level. Further, Pipasic includes the expression level in the analysis and thereby avoids bias resulting from the correlation of conservation and expression in metaproteomics. Pipasic is implemented in Python and freely available as an open-source project.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors would like to acknowledge all members of the Research Group Bioinformatics (NG 4, Robert Koch Institute) for critical discussion and Mathias Kuhring for critical reading of the manuscript.</p>
    <p><italic>Funding</italic>: B.Y.R. acknowledges financial support by <funding-source>Deutsche Forschungsgemeinschaft (DFG)</funding-source>, grant number (<award-id>RE3474/2-1</award-id>).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu267-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>J. Mol. Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bielow</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MSSimulator: simulation of mass spectrometry data</article-title>
        <source>J. Proteome Res.</source>
        <year>2011</year>
        <volume>10</volume>
        <fpage>2922</fpage>
        <lpage>2929</lpage>
        <pub-id pub-id-type="pmid">21526843</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bradshaw</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reporting protein identification data: the next generation of guidelines</article-title>
        <source>Mol. Cell. Proteomics</source>
        <year>2006</year>
        <volume>5</volume>
        <fpage>787</fpage>
        <lpage>788</lpage>
        <pub-id pub-id-type="pmid">16670253</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chourey</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Environmental proteomics reveals early microbial community responses to biostimulation at a uranium- and nitrate-contaminated site</article-title>
        <source>Proteomics</source>
        <year>2013</year>
        <volume>13</volume>
        <fpage>2921</fpage>
        <lpage>2930</lpage>
        <pub-id pub-id-type="pmid">23894087</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Denef</surname>
            <given-names>VJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Proteogenomic basis for ecological divergence of closely related bacteria in natural acidophilic microbial communities</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2010</year>
        <volume>107</volume>
        <fpage>2383</fpage>
        <lpage>2390</lpage>
        <pub-id pub-id-type="pmid">20133593</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diament</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Faster SEQUEST searching for peptide identification from tandem mass spectra</article-title>
        <source>J. Proteome Res.</source>
        <year>2011</year>
        <volume>10</volume>
        <fpage>3871</fpage>
        <lpage>3879</lpage>
        <pub-id pub-id-type="pmid">21761931</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dicker</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Increased power for the analysis of label-free LC-MS/MS proteomics data by combining spectral counts and peptide peak attributes</article-title>
        <source>Mol. Cell. Proteomics</source>
        <year>2010</year>
        <volume>9</volume>
        <fpage>2704</fpage>
        <lpage>2718</lpage>
        <pub-id pub-id-type="pmid">20823122</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Least angle regression</article-title>
        <source>Ann. Stat.</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>407</fpage>
        <lpage>499</lpage>
      </element-citation>
    </ref>
    <ref id="btu267-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fouts</surname>
            <given-names>DE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated next-generation sequencing of 16S rDNA and metaproteomics differentiate the healthy urine microbiome from asymptomatic bacteriuria in neuropathic bladder associated with spinal cord injury</article-title>
        <source>J. Transl. Med.</source>
        <year>2012</year>
        <volume>10</volume>
        <fpage>174</fpage>
        <pub-id pub-id-type="pmid">22929533</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geer</surname>
            <given-names>LY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Open mass spectrometry search algorithm</article-title>
        <source>J. Proteome Res.</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>958</fpage>
        <lpage>964</lpage>
        <pub-id pub-id-type="pmid">15473683</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hettich</surname>
            <given-names>RL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metaproteomics: harnessing the power of high performance mass spectrometry to identify the suite of proteins that control metabolic activities in microbial communities</article-title>
        <source>Anal. Chem.</source>
        <year>2013</year>
        <volume>85</volume>
        <fpage>4203</fpage>
        <lpage>4214</lpage>
        <pub-id pub-id-type="pmid">23469896</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MEGAN analysis of metagenomic data</article-title>
        <source>Genome Res.</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>377</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="pmid">17255551</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jagtap</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep metaproteomic analysis of human salivary supernatant</article-title>
        <source>Proteomics</source>
        <year>2012a</year>
        <volume>12</volume>
        <fpage>992</fpage>
        <lpage>1001</lpage>
        <pub-id pub-id-type="pmid">22522805</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jagtap</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Workflow for analysis of high mass accuracy salivary data set using MaxQuant and ProteinPilot search algorithm</article-title>
        <source>Proteomics</source>
        <year>2012b</year>
        <volume>12</volume>
        <fpage>1726</fpage>
        <lpage>1730</lpage>
        <pub-id pub-id-type="pmid">22623410</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jagtap</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A two-step database search method improves sensitivity in peptide sequence matches for metaproteomics and proteogenomics studies</article-title>
        <source>Proteomics</source>
        <year>2013</year>
        <volume>13</volume>
        <fpage>1352</fpage>
        <lpage>1357</lpage>
        <pub-id pub-id-type="pmid">23412978</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeong</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>False discovery rates in spectral identification</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>Suppl. 16</issue>
        <fpage>S2</fpage>
        <pub-id pub-id-type="pmid">23176207</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karlsson</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Strain-level typing and identification of bacteria using mass spectrometry-based proteomics</article-title>
        <source>J. Proteome Res.</source>
        <year>2012</year>
        <volume>11</volume>
        <fpage>2710</fpage>
        <lpage>2720</lpage>
        <pub-id pub-id-type="pmid">22452665</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lai</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A <italic>de novo</italic> metagenomic assembly program for shotgun DNA reads</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1455</fpage>
        <lpage>1462</lpage>
        <pub-id pub-id-type="pmid">22495746</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lindner</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Renard</surname>
            <given-names>BY</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic abundance estimation and diagnostic testing on species level</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>e10</fpage>
        <pub-id pub-id-type="pmid">22941661</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lindner</surname>
            <given-names>MS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analyzing genome coverage profiles with applications to quality control in metagenomics</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>1260</fpage>
        <lpage>1267</lpage>
        <pub-id pub-id-type="pmid">23589648</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lo</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Strain-resolved community proteomics reveals recombining genomes of acidophilic bacteria</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>446</volume>
        <fpage>537</fpage>
        <lpage>541</lpage>
        <pub-id pub-id-type="pmid">17344860</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mehlan</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Data visualization in environmental proteomics</article-title>
        <source>Proteomics</source>
        <year>2013</year>
        <volume>13</volume>
        <fpage>2805</fpage>
        <lpage>2821</lpage>
        <pub-id pub-id-type="pmid">23913834</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muth</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Searching for a needle in a stack of needles: challenges in metaproteomics data analysis</article-title>
        <source>Mol. Biosystems</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>578</fpage>
        <lpage>585</lpage>
      </element-citation>
    </ref>
    <ref id="btu267-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nesvizhskii</surname>
            <given-names>AI</given-names>
          </name>
        </person-group>
        <article-title>A survey of computational methods and error rate estimation procedures for peptide and protein identification in shotgun proteomics</article-title>
        <source>J. Proteomics</source>
        <year>2010</year>
        <volume>73</volume>
        <fpage>2092</fpage>
        <lpage>2123</lpage>
        <pub-id pub-id-type="pmid">20816881</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oliphant</surname>
            <given-names>TE</given-names>
          </name>
        </person-group>
        <article-title>Python for scientific computing</article-title>
        <source>Comput. Sci. Eng.</source>
        <year>2007</year>
        <volume>9</volume>
        <fpage>10</fpage>
        <lpage>20</lpage>
      </element-citation>
    </ref>
    <ref id="btu267-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Renard</surname>
            <given-names>BY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NITPICK: peak identification for mass spectrometry data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>355</fpage>
        <pub-id pub-id-type="pmid">18755032</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Renard</surname>
            <given-names>BY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Estimating the confidence of peptide identifications without decoy databases</article-title>
        <source>Anal. Chem.</source>
        <year>2010</year>
        <volume>82</volume>
        <fpage>4314</fpage>
        <lpage>4318</lpage>
        <pub-id pub-id-type="pmid">20455556</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Renard</surname>
            <given-names>BY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Overcoming species boundaries in peptide identification with Bayesian information criterion-driven error-tolerant peptide search (BICEPS)</article-title>
        <source>Mol. Cell. Proteomics</source>
        <year>2012</year>
        <comment><bold>11</bold>, M111.014167</comment>
      </element-citation>
    </ref>
    <ref id="btu267-B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rooijers</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An iterative workflow for mining the human intestinal metaproteome</article-title>
        <source>BMC Genomics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>6</fpage>
        <pub-id pub-id-type="pmid">21208423</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schneider</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure and function of the symbiosis partners of the lung lichen (<italic>Lobaria pulmonaria L. Hoffm</italic>.) analyzed by metaproteomics</article-title>
        <source>Proteomics</source>
        <year>2011</year>
        <volume>11</volume>
        <fpage>2752</fpage>
        <lpage>2756</lpage>
        <pub-id pub-id-type="pmid">21604374</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seifert</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioinformatic progress and applications in metaproteogenomics for bridging the gap between genomic sequences and metabolic functions in microbial communities</article-title>
        <source>Proteomics</source>
        <year>2013</year>
        <volume>13</volume>
        <fpage>2786</fpage>
        <lpage>2804</lpage>
        <pub-id pub-id-type="pmid">23625762</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tanner</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>InsPecT: identification of posttranslationally modified peptides from tandem mass spectra</article-title>
        <source>Anal. Chem.</source>
        <year>2005</year>
        <volume>77</volume>
        <fpage>4626</fpage>
        <lpage>4639</lpage>
        <pub-id pub-id-type="pmid">16013882</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teeling</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Glockner</surname>
            <given-names>FO</given-names>
          </name>
        </person-group>
        <article-title>Current opportunities and challenges in microbial metagenome analysis–a bioinformatic perspective</article-title>
        <source>Brief. Bioinform.</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>728</fpage>
        <lpage>742</lpage>
        <pub-id pub-id-type="pmid">22966151</pub-id>
      </element-citation>
    </ref>
    <ref id="btu267-B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wooley</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A primer on metagenomics</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>e1000667</fpage>
        <pub-id pub-id-type="pmid">20195499</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
