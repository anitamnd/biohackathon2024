<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20031101//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2975632</article-id>
    <article-id pub-id-type="pmid">21079731</article-id>
    <article-id pub-id-type="publisher-id">10-PONE-RA-19713R1</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0013875</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline">
        <subject>Computational Biology/Alternative Splicing</subject>
        <subject>Computational Biology/Genomics</subject>
        <subject>Molecular Biology/Bioinformatics</subject>
        <subject>Molecular Biology/RNA Splicing</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HMMSplicer: A Tool for Efficient and Sensitive Discovery of Known and Novel Splice Junctions in RNA-Seq Data</article-title>
      <alt-title alt-title-type="running-head">HMMSplicer</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Dimon</surname>
          <given-names>Michelle T.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sorber</surname>
          <given-names>Katherine</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>DeRisi</surname>
          <given-names>Joseph L.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Department of Biochemistry and Biophysics, University of California San Francisco, San Francisco, California, United States of America</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Biological and Medical Informatics Program, University of California San Francisco, San Francisco, California, United States of America</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>Howard Hughes Medical Institute, Bethesda, Maryland, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gibas</surname>
          <given-names>Cynthia</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">University of North Carolina at Charlotte, United States of America</aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>joe@derisilab.ucsf.edu</email></corresp>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: MTD KS JLD. Performed the experiments: MTD KS. Analyzed the data: MTD. Wrote the paper: MTD KS JLD.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>11</month>
      <year>2010</year>
    </pub-date>
    <volume>5</volume>
    <issue>11</issue>
    <elocation-id>e13875</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>6</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>9</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Dimon et al.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>High-throughput sequencing of an organism's transcriptome, or RNA-Seq, is a valuable and versatile new strategy for capturing snapshots of gene expression. However, transcriptome sequencing creates a new class of alignment problem: mapping short reads that span exon-exon junctions back to the reference genome, especially in the case where a splice junction is previously unknown.</p>
      </sec>
      <sec>
        <title>Methodology/Principal Findings</title>
        <p>Here we introduce HMMSplicer, an accurate and efficient algorithm for discovering canonical and non-canonical splice junctions in short read datasets. HMMSplicer identifies more splice junctions than currently available algorithms when tested on publicly available <italic>A. thaliana</italic>, <italic>P. falciparum</italic>, <italic>and H. sapiens</italic> datasets without a reduction in specificity.</p>
      </sec>
      <sec>
        <title>Conclusions/Significance</title>
        <p>HMMSplicer was found to perform especially well in compact genomes and on genes with low expression levels, alternative splice isoforms, or non-canonical splice junctions. Because HHMSplicer does not rely on pre-built gene models, the products of inexact splicing are also detected. For <italic>H. sapiens</italic>, we find 3.6% of 3′ splice sites and 1.4% of 5′ splice sites are inexact, typically differing by 3 bases in either direction. In addition, HMMSplicer provides a score for every predicted junction allowing the user to set a threshold to tune false positive rates depending on the needs of the experiment. HMMSplicer is implemented in Python. Code and documentation are freely available at <ext-link ext-link-type="uri" xlink:href="http://derisilab.ucsf.edu/software/hmmsplicer">http://derisilab.ucsf.edu/software/hmmsplicer</ext-link>.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="16"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>RNA-Seq, which applies high-throughput sequencing technology to an organism's transcriptome, has revolutionized the study of RNA dynamics within a cell <xref rid="pone.0013875-Wang1" ref-type="bibr">[1]</xref>. Millions of short read sequences allow both the presence and abundance of transcripts to be ascertained. RNA-Seq has been shown to have a better dynamic range for gene expression levels than microarrays <xref rid="pone.0013875-Wilhelm1" ref-type="bibr">[2]</xref> and enables scientists to view the transcriptome at single nucleotide resolution. Thus this technique combines the genome-wide scale of microarrays with the transcript variant detection power of Expressed Sequence Tags (ESTs).</p>
    <p>RNA-Seq reads fall into two main classes: reads with full-length alignments to the genome and reads that span exon-exon junctions. Current sequencing runs produce tens of gigabases and it is likely that terabase sequences will be a reality in the near future. This massive output necessitates rapid techniques to analyze the data in a reasonable amount of time. For full-length alignments of sequence reads back to a reference genome, recent tools that rely on the Burrows-Wheeler Transform have yielded significant improvements in speed and accuracy. These include BWA <xref rid="pone.0013875-Li1" ref-type="bibr">[3]</xref>, SOAPv2 <xref rid="pone.0013875-Li2" ref-type="bibr">[4]</xref> and Bowtie <xref rid="pone.0013875-Langmead1" ref-type="bibr">[5]</xref>.</p>
    <p>The more difficult RNA-Seq challenge is aligning reads that bridge exon-exon junctions since they by definition form gapped alignments to the genome with very short flanking sequence. These exon-exon junction reads reveal the exact location of splicing events, an intricate process wherein the intron in a pre-mRNA transcript is removed and the flanking exons are joined together. This tightly regulated process is coordinated by the spliceosome, a complex of many small-nuclear ribonuceloproteins (snRNPs) (reviewed in <xref rid="pone.0013875-Wahl1" ref-type="bibr">[6]</xref>). The spliceosome facilitates nucleophilic attack of the phosphodiester bond at the 5′ splice site (5′SS) by the branch point sequence. The 3′-hydroxyl at the 5′SS then reacts with the start of the next exon, the 3′ splice site (3′SS), ligating the exons and releasing the intron lariat. The branch point sequence, 5′SS and 3′SS are defined by short motifs within the intron sequence. In metazoans, the consensus splice site motifs are <underline>GT</underline>RAGT for the first six bp of the intron (5′SS) and Y<underline>AG</underline> as the last 3 bp of the intron (3′SS). However, these motifs are extremely degenerate, leaving just ‘GT-AG’ as fairly reliable splice sites, found in 98% of known human introns <xref rid="pone.0013875-Stamm1" ref-type="bibr">[7]</xref>. Although most splicing in eukaryotic cells is performed by the spliceosome, non-spliceosomal splicing occurs and can be essential. One well-characterized example is the splicing of yeast <italic>HAC1</italic> and the homologous <italic>XBP1</italic> in metazoans <xref rid="pone.0013875-Yoshida1" ref-type="bibr">[8]</xref>. In yeast, the transcription factor HAC1p regulates the unfolded protein response. HAC1p is, in turn, regulated by unconventional splicing of <italic>HAC1</italic> mRNA <xref rid="pone.0013875-Cox1" ref-type="bibr">[9]</xref>. This splicing is not accomplished by the spliceosome. Instead, the protein Ire1p cleaves the <italic>HAC1</italic> mRNA in two places and the resulting edges are ligated with tRNA ligase <xref rid="pone.0013875-Sidrauski1" ref-type="bibr">[10]</xref>. In metazoans, <italic>XBP1</italic> is cleaved in a homologous manner, with the non-canonical splice boundaries CA-AG instead of GT-AG.</p>
    <p>During the past decade, there has been a growing appreciation of the importance of alternative splicing as a mechanism for organisms to increase proteomic diversity and regulatory complexity (reviewed in <xref rid="pone.0013875-Nilsen1" ref-type="bibr">[11]</xref> and <xref rid="pone.0013875-Shepard1" ref-type="bibr">[12]</xref>). The model of static exon and intron definitions yielding a single mRNA transcript and single protein sequence from each gene has proven overly simplistic. In reality, alternative splicing, the creation of multiple mRNA transcripts from a single pre-mRNA sequence by differential splicing, is extensive in multicellular organisms, increasing with organismal complexity. Recent RNA-Seq studies suggest that virtually all multi-exonic human transcripts have alternative isoforms <xref rid="pone.0013875-Wang2" ref-type="bibr">[13]</xref>, <xref rid="pone.0013875-Pan1" ref-type="bibr">[14]</xref>. The extent of alternative splicing, as well as the balance between types of alternative splicing (<italic>e.g.</italic> alternate 5′SS versus exon-skipping splicing), differs by organism <xref rid="pone.0013875-Nagasaki1" ref-type="bibr">[15]</xref>. The regulation of splicing in different tissues and developmental stages, as well as the mechanisms for its regulation, is a subject of ongoing research <xref rid="pone.0013875-Nilsen1" ref-type="bibr">[11]</xref>, <xref rid="pone.0013875-Sen1" ref-type="bibr">[16]</xref>, <xref rid="pone.0013875-Yano1" ref-type="bibr">[17]</xref>. Therefore, the ability to detect alternative splice isoforms with accuracy and sensitivity is key to comprehensive RNA-Seq analysis.</p>
    <p>Aligning exon-spanning reads to the genome is difficult. Instead of a single full-length alignment, an algorithm must break a short read into two even shorter pieces and align each piece accurately. One early approach to short read splice junction detection was alignment using existing gene annotations, as done by ERANGE <xref rid="pone.0013875-Mortazavi1" ref-type="bibr">[18]</xref>. While this approach was necessary to align very short reads (36 nt or less) back to mammalian genomes, it does not address the question of novel junctions and cannot be used for organisms with incomplete or inaccurate genome annotations. Another early approach was to use BLAT <xref rid="pone.0013875-Kent1" ref-type="bibr">[19]</xref>, a tool developed for the alignment of longer EST sequence. This method can provide good results but requires extensive effort by the researcher to post-process and filter the search results, which could be achieved by the construction and training of a support vector machine specific to the organism and dataset <xref rid="pone.0013875-Nagalakshmi1" ref-type="bibr">[20]</xref>. In addition, BLAT searches on mammalian genomes can be slow.</p>
    <p>The current leading algorithm for finding novel junctions in RNA-Seq data is TopHat <xref rid="pone.0013875-Trapnell1" ref-type="bibr">[21]</xref>. TopHat uses full-length read alignments to build a set of exon ‘islands’, then searches for short reads that bridge these exon islands. The strength of this approach is that the resulting set of putative gene models can be used to estimate transcript abundance, as in the recently released Cufflinks software <xref rid="pone.0013875-Trapnell2" ref-type="bibr">[22]</xref>. However, the algorithm must be able to define exon islands, which can be difficult when the coverage is low or uneven or when introns are small. While TopHat can find GT-AG, GC-AG, and AT-AC splice sites under ideal conditions, it does not extract any other splice sites. As a result, TopHat performs best on mammalian transcripts with relatively high abundance, but can stumble in more compact genomes and with non-canonical junctions.</p>
    <p>Recently, several algorithms have been published that match reads more directly to the genome, including SplitSeek <xref rid="pone.0013875-Ameur1" ref-type="bibr">[23]</xref>, SuperSplat <xref rid="pone.0013875-Bryant1" ref-type="bibr">[24]</xref>, and SpliceMap <xref rid="pone.0013875-Au1" ref-type="bibr">[25]</xref>. SplitSeek divides the read into two non-overlapping anchors and initially detects junctions as places where the two anchors map to different places on a chromosome (i.e. the two exons with the intron between them), with no requirement for specific splice sites. These initial junctions are further supported by reads where only a single anchor maps to an exon - however, the requirement for at least one read split evenly across the exon-exon boundary reduces sensitivity in low coverage datasets and transcripts. Additionally, SplitSeek only supports ABI SOLiD reads currently. SuperSplat is another algorithm that reports non-canonical junctions (junctions with intron edges other than GT-AG, GC-AG, or AT-AC). However, this algorithm requires both pieces of a read to be exact matches to the reference sequence so it is not robust against sequencing errors or SNPs. SpliceMap divides reads in half, aligns each read half to the genome, then locates the remaining part of the read downstream within the maximum intron size. However, this algorithm considers only canonical splice junctions and requires read lengths of 50 nt or greater. In addition, although SplitSeek, SuperSplat, and SpliceMap all provide methods to filter the resulting junctions by the number and types of supporting reads, none provide a score that predicts the accuracy of a junction.</p>
    <p>Here we introduce HMMSplicer, an accurate and efficient algorithm for finding canonical and non-canonical splice junctions in short-read datasets. The design of HMMSplicer was conceived to circumvent the inherent bias introduced by relying upon previously defined biological information. HMMSplicer begins by dividing each read in half, then seeding the read-halves against the genome and using a Hidden Markov Model to determine the exon boundary. The second piece of the read is then matched downstream. Both canonical and non-canonical junctions are reported. Finally, a score is assigned to each junction, dependent only on the strength of the alignment and the number and quality of bases supporting the splice junction. The scoring algorithm is highly accurate at distinguishing between true and false positives, aiding in novel splice junction discovery for both canonical and non-canonical junctions. HMMSplicer was benchmarked against TopHat and SpliceMap. It outperformed TopHat across a range of genome sizes, but most dramatically in compact genomes and in transcripts with low sequence read coverage. Compared to SpliceMap, it performed similarly in a human dataset and outperformed SpliceMap on an <italic>A. thaliana</italic> dataset.</p>
  </sec>
  <sec id="s2">
    <title>Results</title>
    <sec id="s2a">
      <title>Algorithm Overview</title>
      <p>An overview of the HMMSplicer algorithm is shown in <xref ref-type="fig" rid="pone-0013875-g001">Figure 1</xref>. Before the HMMSplicer algorithm begins, full-length alignments to the genome are detected using Bowtie <xref rid="pone.0013875-Langmead1" ref-type="bibr">[5]</xref> and removed from the dataset. HMMSplicer begins by dividing the remaining reads in half and aligning each half to the genome. All alignments for both read halves are considered autonomously and are not resolved until the final scoring step. Once a read-half is aligned, a Hidden Markov Model (HMM) is used to detect the most probable splice position. The HMM is trained on a subset of read-half alignments to best reflect the quality and base composition of the dataset and genome. Next, the remaining portion of the read is aligned downstream of the exon-intron boundary, completing the junction definition. Finally, identical junctions are collapsed into a single junction and all junctions are scored, filtered by score, and divided by splice-site edges, with canonical (GT-AG and GC-AG) junctions in one result set and non-canonical edges in a second result set.</p>
      <fig id="pone-0013875-g001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0013875.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>HMMSplicer pipeline.</title>
          <p>After removing reads that have full-length alignments to the genome, reads are divided in half and aligned to the genome (step 1 as defined in the <xref ref-type="sec" rid="s4">Materials and Methods</xref>). The HMM is trained using a subset of the read-half alignments (step 2a). The HMM bins quality scores into five levels. Although only three levels are shown in this overview for simplification, the values for all five levels can be found in <xref ref-type="table" rid="pone-0013875-t001">Table 1</xref>. The trained HMM is then used to determine the splice position within each read-half alignment (step 2b). The remaining second piece of the read is then matched downstream to find the other intron edge (step 3). The initial set of splice junctions then proceed to rescue (step 4) and filter and collapse (step 5) to generate the final set of splice junctions.</p>
        </caption>
        <graphic xlink:href="pone.0013875.g001"/>
      </fig>
    </sec>
    <sec id="s2b">
      <title>Algorithm parameters</title>
      <p>Our first step was to test the assumptions underlying HMMSplicer's algorithm by evaluating performance relative to key parameters: the required read length, the robustness of the HMM, and the ability to match the second piece of a read. First we examined the ability of read-halves to seed within a genome by measuring the fraction of read-halves aligned in the Bowtie read-half alignment step for various read-half sizes and genome sizes (<xref ref-type="fig" rid="pone-0013875-g002">Figure 2a</xref>). For the human genome, HMMSplicer performs optimally for reads 45 nt or longer (read-halves of 22 nt or longer), though shorter reads can be used. Simulation results, described below, confirm this assessment, showing a higher false positive rate when aligning 40 nt reads to the human genome. Next, we validated the robustness of the HMM training. An essential feature of HMMSplicer is that the HMM used to determine where the splice occurs within the read is trained from a subset of the input read set by an unsupervised algorithm. For the HMM training to be robust, it must train to similar values for an input read set, regardless of the initial values or the subset of reads used for training. This was validated using the human read set. Training sets ranging from 50 to 50,000 read-half alignments were used to train the HMM with two different sets of initial HMM values. For the first set of initial values, we used completely even values, i.e. a 50/50 probability of a match or mismatch for each quality score. For the second set, we used values close to those we expected as trained HMM values (<xref ref-type="table" rid="pone-0013875-t001">Table 1</xref>). Training for each combination of training set size and initial value was repeated 10 times with different random subsets to measure the mean and standard deviation of the trained values. The results show that the HMM training converges on similar values regardless of training set size and initial values. The two most variable parameters are shown in <xref ref-type="fig" rid="pone-0013875-g002">Figure 2b</xref>, all other parameters showed less variability across the conditions (data not shown). Smaller training sets showed more variability so a default training set size of 10,000 was selected for HMMSplicer as sufficient to sample the space. Finally, mapping of sequences of various sizes within an 80 kbp maximum intron was analyzed to determine the optimal anchor size (<xref ref-type="fig" rid="pone-0013875-g002">Figure 2c</xref>). In the human genome, for sequences less than 8 nt in length, the most common result was multiple matches, whereas at 8 nt and above, a unique, correct match was the most likely result. Based on these data, the default anchor size was set at 8 nt for the default maximum intron size of 80 kbp. For compact genomes with smaller maximum intron sizes, such as the <italic>P. falciparum</italic> and <italic>A. thaliana</italic> datasets below, a shorter anchor size of 6 nt can be matched uniquely (data not shown).</p>
      <fig id="pone-0013875-g002" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0013875.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Algorithm parameters.</title>
          <p><bold>a</bold>) Percent of oligos able to map within a genome as a function of oligo size. The solid lines show the percentages if oligos are able to map up to 50 times within the genome (the value used in HMMSplicer seeding). The dashed lines show the percentages if a unique match is required. <bold>b</bold>) HMM training. The values for the two most variable parameters of the HMM are shown here, with the x-axis representing different training set sizes and initial HMM parameters. The error bars show the standard deviation of ten repetitions of training. HMMSplicer uses a training subset size of 10,000. <bold>c</bold>) Effect of size, in bases, for the second piece of the read. The percent of second pieces uniquely mapping within 80 kbp of the first piece increases as the size of the second piece increases, while the percent of second pieces mapping to multiple locations decreases.</p>
        </caption>
        <graphic xlink:href="pone.0013875.g002"/>
      </fig>
      <table-wrap id="pone-0013875-t001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0013875.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>HMM Parameter Values.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0013875-t001-1" xlink:href="pone.0013875.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">1→2</td>
                <td align="left" rowspan="1" colspan="1">2→1</td>
                <td align="left" rowspan="1" colspan="1">1: high</td>
                <td align="left" rowspan="1" colspan="1">1: med-high</td>
                <td align="left" rowspan="1" colspan="1">1: medium</td>
                <td align="left" rowspan="1" colspan="1">1: med-low</td>
                <td align="left" rowspan="1" colspan="1">1: low</td>
                <td align="left" rowspan="1" colspan="1">2: high</td>
                <td align="left" rowspan="1" colspan="1">2: med-high</td>
                <td align="left" rowspan="1" colspan="1">2: medium</td>
                <td align="left" rowspan="1" colspan="1">2: med-low</td>
                <td align="left" rowspan="1" colspan="1">2: low</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Initial Value Set 1</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Initial Value Set 2</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0.7</td>
                <td align="left" rowspan="1" colspan="1">0.7</td>
                <td align="left" rowspan="1" colspan="1">0.7</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">0.4</td>
                <td align="left" rowspan="1" colspan="1">0.3</td>
                <td align="left" rowspan="1" colspan="1">0.3</td>
                <td align="left" rowspan="1" colspan="1">0.3</td>
                <td align="left" rowspan="1" colspan="1">0.3</td>
                <td align="left" rowspan="1" colspan="1">0.3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>A. thaliana</italic> Trained Values</td>
                <td align="left" rowspan="1" colspan="1">0.916</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0.983</td>
                <td align="left" rowspan="1" colspan="1">0.976</td>
                <td align="left" rowspan="1" colspan="1">0.971</td>
                <td align="left" rowspan="1" colspan="1">0.949</td>
                <td align="left" rowspan="1" colspan="1">0.832</td>
                <td align="left" rowspan="1" colspan="1">0.271</td>
                <td align="left" rowspan="1" colspan="1">0.261</td>
                <td align="left" rowspan="1" colspan="1">0.259</td>
                <td align="left" rowspan="1" colspan="1">0.259</td>
                <td align="left" rowspan="1" colspan="1">0.276</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>P. falciparum</italic> Trained Values</td>
                <td align="left" rowspan="1" colspan="1">0.938</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0.942</td>
                <td align="left" rowspan="1" colspan="1">0.879</td>
                <td align="left" rowspan="1" colspan="1">0.853</td>
                <td align="left" rowspan="1" colspan="1">0.786</td>
                <td align="left" rowspan="1" colspan="1">0.669</td>
                <td align="left" rowspan="1" colspan="1">0.368</td>
                <td align="left" rowspan="1" colspan="1">0.334</td>
                <td align="left" rowspan="1" colspan="1">0.333</td>
                <td align="left" rowspan="1" colspan="1">0.317</td>
                <td align="left" rowspan="1" colspan="1">0.281</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>H. sapiens</italic> Trained Values</td>
                <td align="left" rowspan="1" colspan="1">0.934</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0.948</td>
                <td align="left" rowspan="1" colspan="1">0.925</td>
                <td align="left" rowspan="1" colspan="1">0.886</td>
                <td align="left" rowspan="1" colspan="1">0.791</td>
                <td align="left" rowspan="1" colspan="1">0.605</td>
                <td align="left" rowspan="1" colspan="1">0.283</td>
                <td align="left" rowspan="1" colspan="1">0.264</td>
                <td align="left" rowspan="1" colspan="1">0.258</td>
                <td align="left" rowspan="1" colspan="1">0.261</td>
                <td align="left" rowspan="1" colspan="1">0.256</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt101">
            <label/>
            <p>The initial and trained values for the HMM. The first two columns (“1→2” and “2→1”) show the probability of transitioning from State 1 to State 2 and the reverse. The probability of transitioning from State 2 to State 1 is fixed at 0 (indicating a 100% probability of remaining in State 2). For each state, the probability of a match at each quality bin is reported. The initial values were used to validate the HMM. HMMSplicer uses Initial Value Set 2, though the initial values do not impact the final trained values (see <xref ref-type="fig" rid="pone-0013875-g002">Figure 2b</xref>). The trained values are shown for each dataset analyzed. The Human values are the same as those shown in <xref ref-type="fig" rid="pone-0013875-g001">Figure 1</xref>, though in more detail.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="s2c">
      <title>Benchmark Tests</title>
      <p>HMMSplicer's performance was analyzed on simulated reads and three publicly available experimental datasets (<xref ref-type="table" rid="pone-0013875-t002">Tables 2</xref> and <xref ref-type="table" rid="pone-0013875-t003">3</xref>). The simulation dataset, generated from human chromosome 20, provides a measurement of the number of junctions detected and the false positive rate at different read lengths and coverage levels. However, simulation results do not model all the complexities found in experimental datasets, such as uneven coverage with a bias towards higher coverage of GC-rich regions, uneven distribution of sequence transversions, and inaccurate quality scores <xref rid="pone.0013875-Dohm1" ref-type="bibr">[26]</xref>. Three experimental datasets were selected from the NCBI Short Reads Archive (SRA), each representing a real world challenge. The first experimental dataset, ∼80 million reads from <italic>Arabidopsis thaliana</italic>, allowed analysis of HMMSplicer's performance using a dataset with low quality reads. The next experimental dataset, ∼14 million reads in <italic>Plasmodium falciparum</italic>, was used to assess performance in the context of uneven coverage and high AT content. The final experimental dataset, ∼10 million paired-end reads from <italic>Homo sapiens</italic>, was used to test HMMSplicer's performance in a larger metazoan genome. This dataset also provided a platform for analyzing transcripts with low abundance, alternative splicing and non-canonical splice sites.</p>
      <table-wrap id="pone-0013875-t002" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0013875.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Simulation Results.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0013875-t002-2" xlink:href="pone.0013875.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td colspan="2" align="left" rowspan="1"/>
                <td colspan="2" align="left" rowspan="1">HMMSplicer</td>
                <td colspan="2" align="left" rowspan="1">TopHat</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Read Length</td>
                <td align="left" rowspan="1" colspan="1">Coverage Level</td>
                <td align="left" rowspan="1" colspan="1"># True Positives</td>
                <td align="left" rowspan="1" colspan="1">% False Positives</td>
                <td align="left" rowspan="1" colspan="1"># True Positives</td>
                <td align="left" rowspan="1" colspan="1">% False Positives</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>40 bp</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">1484</td>
                <td align="left" rowspan="1" colspan="1">0.7</td>
                <td align="left" rowspan="1" colspan="1">451</td>
                <td align="left" rowspan="1" colspan="1">1.1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">3478</td>
                <td align="left" rowspan="1" colspan="1">1.3</td>
                <td align="left" rowspan="1" colspan="1">1858</td>
                <td align="left" rowspan="1" colspan="1">1.1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">3835</td>
                <td align="left" rowspan="1" colspan="1">2.8</td>
                <td align="left" rowspan="1" colspan="1">2825</td>
                <td align="left" rowspan="1" colspan="1">1.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">25</td>
                <td align="left" rowspan="1" colspan="1">3908</td>
                <td align="left" rowspan="1" colspan="1">4.7</td>
                <td align="left" rowspan="1" colspan="1">3490</td>
                <td align="left" rowspan="1" colspan="1">2.0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">50</td>
                <td align="left" rowspan="1" colspan="1">3928</td>
                <td align="left" rowspan="1" colspan="1">8.3</td>
                <td align="left" rowspan="1" colspan="1">3630</td>
                <td align="left" rowspan="1" colspan="1">3.3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>45 bp</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">1630</td>
                <td align="left" rowspan="1" colspan="1">0.2</td>
                <td align="left" rowspan="1" colspan="1">503</td>
                <td align="left" rowspan="1" colspan="1">0.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">3634</td>
                <td align="left" rowspan="1" colspan="1">0.8</td>
                <td align="left" rowspan="1" colspan="1">2422</td>
                <td align="left" rowspan="1" colspan="1">0.9</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">3861</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="left" rowspan="1" colspan="1">3458</td>
                <td align="left" rowspan="1" colspan="1">1.3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">25</td>
                <td align="left" rowspan="1" colspan="1">3928</td>
                <td align="left" rowspan="1" colspan="1">2.2</td>
                <td align="left" rowspan="1" colspan="1">3849</td>
                <td align="left" rowspan="1" colspan="1">2.0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">50</td>
                <td align="left" rowspan="1" colspan="1">3947</td>
                <td align="left" rowspan="1" colspan="1">4.1</td>
                <td align="left" rowspan="1" colspan="1">3901</td>
                <td align="left" rowspan="1" colspan="1">3.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>50 bp</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">1701</td>
                <td align="left" rowspan="1" colspan="1">0.2</td>
                <td align="left" rowspan="1" colspan="1">457</td>
                <td align="left" rowspan="1" colspan="1">0.7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">3646</td>
                <td align="left" rowspan="1" colspan="1">0.3</td>
                <td align="left" rowspan="1" colspan="1">2619</td>
                <td align="left" rowspan="1" colspan="1">0.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">3893</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">3579</td>
                <td align="left" rowspan="1" colspan="1">1.1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">25</td>
                <td align="left" rowspan="1" colspan="1">3943</td>
                <td align="left" rowspan="1" colspan="1">1.1</td>
                <td align="left" rowspan="1" colspan="1">3858</td>
                <td align="left" rowspan="1" colspan="1">2.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">50</td>
                <td align="left" rowspan="1" colspan="1">3958</td>
                <td align="left" rowspan="1" colspan="1">1.6</td>
                <td align="left" rowspan="1" colspan="1">3908</td>
                <td align="left" rowspan="1" colspan="1">3.1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>55 bp</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">1711</td>
                <td align="left" rowspan="1" colspan="1">0.3</td>
                <td align="left" rowspan="1" colspan="1">390</td>
                <td align="left" rowspan="1" colspan="1">0.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">3677</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">2697</td>
                <td align="left" rowspan="1" colspan="1">0.7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">3898</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">3581</td>
                <td align="left" rowspan="1" colspan="1">1.1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">25</td>
                <td align="left" rowspan="1" colspan="1">3948</td>
                <td align="left" rowspan="1" colspan="1">1.1</td>
                <td align="left" rowspan="1" colspan="1">3870</td>
                <td align="left" rowspan="1" colspan="1">1.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">50</td>
                <td align="left" rowspan="1" colspan="1">3965</td>
                <td align="left" rowspan="1" colspan="1">2.5</td>
                <td align="left" rowspan="1" colspan="1">3915</td>
                <td align="left" rowspan="1" colspan="1">3.1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>60 bp</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">1684</td>
                <td align="left" rowspan="1" colspan="1">0.1</td>
                <td align="left" rowspan="1" colspan="1">433</td>
                <td align="left" rowspan="1" colspan="1">0.9</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">3671</td>
                <td align="left" rowspan="1" colspan="1">0.3</td>
                <td align="left" rowspan="1" colspan="1">2629</td>
                <td align="left" rowspan="1" colspan="1">0.7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">3906</td>
                <td align="left" rowspan="1" colspan="1">0.4</td>
                <td align="left" rowspan="1" colspan="1">3581</td>
                <td align="left" rowspan="1" colspan="1">0.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">25</td>
                <td align="left" rowspan="1" colspan="1">3951</td>
                <td align="left" rowspan="1" colspan="1">0.9</td>
                <td align="left" rowspan="1" colspan="1">3869</td>
                <td align="left" rowspan="1" colspan="1">1.5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">50</td>
                <td align="left" rowspan="1" colspan="1">3966</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="left" rowspan="1" colspan="1">3930</td>
                <td align="left" rowspan="1" colspan="1">2.9</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>65 bp</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">1698</td>
                <td align="left" rowspan="1" colspan="1">0.1</td>
                <td align="left" rowspan="1" colspan="1">405</td>
                <td align="left" rowspan="1" colspan="1">0.7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">3684</td>
                <td align="left" rowspan="1" colspan="1">0.4</td>
                <td align="left" rowspan="1" colspan="1">2609</td>
                <td align="left" rowspan="1" colspan="1">0.6</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">3904</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">3525</td>
                <td align="left" rowspan="1" colspan="1">0.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">25</td>
                <td align="left" rowspan="1" colspan="1">3945</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="left" rowspan="1" colspan="1">3838</td>
                <td align="left" rowspan="1" colspan="1">1.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">50</td>
                <td align="left" rowspan="1" colspan="1">3966</td>
                <td align="left" rowspan="1" colspan="1">1.3</td>
                <td align="left" rowspan="1" colspan="1">3928</td>
                <td align="left" rowspan="1" colspan="1">2.4</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>70 bp</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">1629</td>
                <td align="left" rowspan="1" colspan="1">0.1</td>
                <td align="left" rowspan="1" colspan="1">1038</td>
                <td align="left" rowspan="1" colspan="1">0.7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">3626</td>
                <td align="left" rowspan="1" colspan="1">0.2</td>
                <td align="left" rowspan="1" colspan="1">3297</td>
                <td align="left" rowspan="1" colspan="1">1.6</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">3893</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">3785</td>
                <td align="left" rowspan="1" colspan="1">2.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">25</td>
                <td align="left" rowspan="1" colspan="1">3951</td>
                <td align="left" rowspan="1" colspan="1">0.7</td>
                <td align="left" rowspan="1" colspan="1">3931</td>
                <td align="left" rowspan="1" colspan="1">6.5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">50</td>
                <td align="left" rowspan="1" colspan="1">3960</td>
                <td align="left" rowspan="1" colspan="1">1.2</td>
                <td align="left" rowspan="1" colspan="1">3958</td>
                <td align="left" rowspan="1" colspan="1">12.9</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>75 bp</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">1613</td>
                <td align="left" rowspan="1" colspan="1">0.2</td>
                <td align="left" rowspan="1" colspan="1">943</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">3613</td>
                <td align="left" rowspan="1" colspan="1">0.4</td>
                <td align="left" rowspan="1" colspan="1">3101</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">3899</td>
                <td align="left" rowspan="1" colspan="1">0.5</td>
                <td align="left" rowspan="1" colspan="1">3734</td>
                <td align="left" rowspan="1" colspan="1">0.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">25</td>
                <td align="left" rowspan="1" colspan="1">3955</td>
                <td align="left" rowspan="1" colspan="1">0.6</td>
                <td align="left" rowspan="1" colspan="1">3939</td>
                <td align="left" rowspan="1" colspan="1">1.5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">50</td>
                <td align="left" rowspan="1" colspan="1">3966</td>
                <td align="left" rowspan="1" colspan="1">1.2</td>
                <td align="left" rowspan="1" colspan="1">3966</td>
                <td align="left" rowspan="1" colspan="1">2.4</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt102">
            <label/>
            <p>HMMSplicer and TopHat were run on read sets from 40 to 75 bp long at coverage levels from 1× to 50× on 503 non-overlapping gene transcripts from Human Chr20.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap id="pone-0013875-t003" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0013875.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Datasets.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0013875-t003-3" xlink:href="pone.0013875.t003"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Accession Number</td>
                <td align="left" rowspan="1" colspan="1">Number of Reads</td>
                <td align="left" rowspan="1" colspan="1">Read Length</td>
                <td align="left" rowspan="1" colspan="1">HMMSplicer time (min)</td>
                <td align="left" rowspan="1" colspan="1">TopHat time (min)</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>
                    <italic>H. sapiens</italic>
                  </bold>
                </td>
                <td align="left" rowspan="1" colspan="1">SRX011552(used for quality model)</td>
                <td align="left" rowspan="1" colspan="1">N/A</td>
                <td align="left" rowspan="1" colspan="1">75</td>
                <td align="left" rowspan="1" colspan="1">N/A</td>
                <td align="left" rowspan="1" colspan="1">N/A</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>
                    <italic>A. thaliana</italic>
                  </bold>
                </td>
                <td align="left" rowspan="1" colspan="1">SRX002554</td>
                <td align="left" rowspan="1" colspan="1">79,106,696</td>
                <td align="left" rowspan="1" colspan="1">50</td>
                <td align="left" rowspan="1" colspan="1">326</td>
                <td align="left" rowspan="1" colspan="1">1162</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>
                    <italic>H. sapiens</italic>
                  </bold>
                </td>
                <td align="left" rowspan="1" colspan="1">SRX011550</td>
                <td align="left" rowspan="1" colspan="1">9,669,944paired end</td>
                <td align="left" rowspan="1" colspan="1">45</td>
                <td align="left" rowspan="1" colspan="1">880</td>
                <td align="left" rowspan="1" colspan="1">645 ( or 271)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>
                    <italic>P. falciparum</italic>
                  </bold>
                </td>
                <td align="left" rowspan="1" colspan="1">SRX001454 SRX001455SRX001456 SRX001457</td>
                <td align="left" rowspan="1" colspan="1">14,139,995</td>
                <td align="left" rowspan="1" colspan="1">46<xref ref-type="table-fn" rid="nt103">*</xref>
</td>
                <td align="left" rowspan="1" colspan="1">108</td>
                <td align="left" rowspan="1" colspan="1">188 (or 45)</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt103">
            <label/>
            <p>*The 48-bp reads in the NCBI SRA set have a 2 bp initial barcode that was trimmed, resulting in 46 bp reads.</p>
          </fn>
          <fn id="nt104">
            <label/>
            <p>Datasets used for benchmark tests. For <italic>H. sapiens</italic> and <italic>P. falciparum</italic>, two times are given for TopHat. For <italic>H. sapiens</italic>, the longer time is with more sensitive settings, but the shorter time resulted in less than 5% fewer junctions at a similar specificity. For <italic>P. falciparum</italic>, the longer time is with more sensitive but less stringent settings whereas the shorter time is for the more stringent settings that resulted in significantly fewer junctions but with a much higher specificity.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="s2d">
      <title>HMMSplicer combines high sensitivity with a low false positive rate</title>
      <p>HMMSplicer was first tested on simulated read sets to determine its performance in an environment where true and false positive rates could be definitively measured. For the simulation, reads from 503 non-overlapping gene models on human chromosome 20 were generated at varying read lengths and coverage levels. For an accurate quality model, we used the error model from a human dataset <xref rid="pone.0013875-Heap1" ref-type="bibr">[27]</xref>. In this read set, the second paired end read was extended to 75 bases, allowing us to simulate longer reads. The program maq was used to generate reads of length 40, 45, 50, 55, 60, 65, 70, and 75 bp at 1×, 5×, 10×, 25×, and 50× coverage <xref rid="pone.0013875-Li3" ref-type="bibr">[28]</xref>. TopHat was run on the same simulated dataset for comparison.</p>
      <p>HMMSplicer's false positive rate was low overall, rising with short reads and high coverage (<xref ref-type="table" rid="pone-0013875-t002">Table 2</xref>). The highest false positive rate, 8.3% was seen for 40 bp reads at 50× coverage, re-iterating the conclusion from parameter testing (above) that HMMSplicer performs ideally in the human genome with reads at least 45 bp long. At a length of 45 bp, the false positive rate for 50× coverage was 4.2%, while for reads 50 bp or longer the false positive rate never exceeded 2.5%, with most error rates remaining under 1%.</p>
      <p>HMMSplicer was effective at identifying junctions, even at low coverage levels (<xref ref-type="fig" rid="pone-0013875-g003">Figure 3a</xref>). With 50 bp reads at 1× coverage, HMMSplicer was able to identify more than 40% of all the junctions in the set (1701 of 4043). At 5× coverage, more than 90% of the junctions were found (3646 of 4043). Higher coverage levels increase the number of junctions found, and at 50× coverage more than 98% of the junctions are found (3958 of 4043). While TopHat finds similar number of junctions at higher coverage levels, HMMSplicer finds three times as many junctions at 1× coverage with reads less than 70 bp long, and more than 50% more junctions with reads 70 or 75 bp long. Seventy-seven junctions were never detected by either program, even at 50× coverage and 75 bp reads. These junctions either had a homologous region within the genome or encompassed tiny initial or final exons that, because the simulated transcripts did not include UTR regions, had artificially low coverage.</p>
      <p>One of HMMSplicer's strengths is that the algorithm provides scores for each junction, indicating the confidence of the prediction. To judge the accuracy of the scoring algorithm, Receiver Operator Characteristic (ROC) curves were generated comparing the true positive and false positive rate (<xref ref-type="fig" rid="pone-0013875-g003">Figure 3b</xref>). To measure true and false positive rate, simulation results for all scores were considered. Predicted junctions that aligned to the correct source of the simulated read were considered correct, while predicted junctions that aligned to another location were considered false. The ROC curves show that the HMMSplicer scoring algorithm was highly accurate, with the inflection point for 10× coverage and 50 bp reads including 98.7% of the true junctions and only 6.7% of the false junctions. At the default score threshold, 99.3% of true junctions and only 13.3% of the incorrect junctions were included.</p>
    </sec>
    <sec id="s2e">
      <title>HMMSplicer performs well on datasets with low quality sequence reads</title>
      <p>High-throughput sequencing datasets can have high error rates, however there is still useful data to be gleaned from these datasets. The first dataset, ∼79 million reads, each 50 bp long, in <italic>Arabidopsis thaliana</italic>, evaluated the performance of HMMSplicer with variable quality sequence reads <xref rid="pone.0013875-Lister1" ref-type="bibr">[29]</xref>. <italic>A. thaliana</italic>, a model plant species, has a genome of 125 million base pairs with ∼25,500 protein-coding genes <xref rid="pone.0013875-Analysis1" ref-type="bibr">[30]</xref>. The mean exon and intron sizes are 78 bp and 268 bp, respectively, with an average of 4.5 introns per gene <xref rid="pone.0013875-Deutsch1" ref-type="bibr">[31]</xref>.</p>
      <p>We analyzed these low-quality reads, using a minimum intron length of 5 bp, a maximum intron length of 6 kbp, and an anchor size of 6 bp. The gene models in the most recent release of The Arabidopsis Information Resource (TAIR9, <ext-link ext-link-type="uri" xlink:href="http://www.arabidopsis.org">http://www.arabidopsis.org</ext-link>) contain introns from 3 bp to 11,603 bp long with 99.9% of the introns falling between 5 and 6,000 bp. At the default score threshold, HMMSplicer detected 14,982 junctions, with 95% (14,217) of the predicted junctions matching TAIR9 annotations (<xref ref-type="fig" rid="pone-0013875-g004">Figure 4a</xref>). The relatively low number of junctions found overall despite the size of the dataset is likely a result of low read quality. The low quality also decreases the HMMSplicer scores, causing a sharper decrease in the number of junctions at higher score thresholds compared to other datasets (<xref ref-type="fig" rid="pone-0013875-g004">Figure 4a</xref>).</p>
      <fig id="pone-0013875-g003" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0013875.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Simulation results.</title>
          <p>(<bold>a</bold>) Results for HMMSplicer and TopHat for 50 and 75 bp reads. Although values are similar at higher coverage levels, HMMSplicer exhibits substantial increases in sensitivity at lower coverage levels. (<bold>b</bold>) ROC curve for the 50 bp simulation results at 1×, 10×, and 50× coverage demonstrates that HMMSplicer's scoring algorithm accurately discriminates between true and false junctions. The number in parentheses is the area under the curve for each coverage level.</p>
        </caption>
        <graphic xlink:href="pone.0013875.g003"/>
      </fig>
      <fig id="pone-0013875-g004" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0013875.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Overview of HMMSplicer and TopHat results in (a) <italic>A. thaliana</italic>, and (b) <italic>P. falciparum</italic> and (c) <italic>H. sapiens</italic>.</title>
          <p>For each dataset, HMMSplicer results are shown at five different score thresholds. The numbers on the bottom axis (200 to 600) are the thresholds for junctions with multiple reads; the threshold was set 200 points higher for junctions with a single read. The * indicates HMMSplicer's default score threshold. SpliceMap results are shown for the <italic>A. thaliana</italic> dataset only, as SpliceMap cannot be run datasets with reads less than 50 nt long. For <italic>P. falciparum</italic>, TopHat was run with two different parameter sets. TopHat A was run with a segment length of 23 resulting in more junctions but a lower specificity whereas TopHat B used the default segment length of 25 resulting in fewer junctions with more specificity.</p>
        </caption>
        <graphic xlink:href="pone.0013875.g004"/>
      </fig>
      <p>TopHat and SpliceMap were also run on the <italic>A. thaliana</italic> dataset. TopHat, run with a minimum intron size of 5 bp and a maximum intron size of 6 kbp, was able to locate only 6,346 junctions, less than half the number found by HMMSplicer, with 91.7% (5,820) of these predictions matching TAIR9 annotations (<xref ref-type="fig" rid="pone-0013875-g004">Figure 4a</xref>). SpliceMap was run with the same 6 kbp maximum intron size (the minimum intron size is not configurable). SpliceMap found 9,438 junctions, 92.8% of which match TAIR9 annotations. Although SpliceMap found more junctions than TopHat, HMMSplicer found 50% more junctions than SpliceMap with a higher percentage matching TAIR9 annotations than either competitor.</p>
    </sec>
    <sec id="s2f">
      <title>HMMSplicer performs well in datasets with uneven coverage</title>
      <p>The <italic>P. falciparum</italic> genome is fairly compact and AT-rich, containing approximately 5,300 genes in 23 million base pairs <xref rid="pone.0013875-Gardner1" ref-type="bibr">[32]</xref>. In the latest genome annotation (PlasmoDB 6.3, <ext-link ext-link-type="uri" xlink:href="http://www.plasmodb.org">http://www.plasmodb.org</ext-link>), the average exon size is 890 bp and the average intron size is 168 bp with an average of 1.54 introns per gene. Previous research on an earlier release of the genome annotation indicated that approximately 24% of the gene models predicted for <italic>P. falciparum</italic> are incorrect <xref rid="pone.0013875-Lu1" ref-type="bibr">[33]</xref>. The malaria research community has focused on improving the genome annotation, and the most recent genome annotation release addresses many incorrect annotations. However, there are still numerous unconfirmed gene models with limited or no EST evidence.</p>
      <p>The <italic>P. falciparum</italic> read set was published in the NCBI SRA following work on the Long March technique <xref rid="pone.0013875-Sorber1" ref-type="bibr">[34]</xref>. The dataset downloaded from NCBI SRA contains 14,139,995 reads, each 46 bp long. This dataset has uneven coverage with coverage varying significantly even within a single transcript. To detect splice junctions in this dataset, HMMSplicer was run with a minimum intron size of 10 bp, a maximum intron size of 1 kbp and an anchor size of 6 bp. This range includes 99.6% of the known introns in the current <italic>P. falciparum</italic> genome annotation. At the default score threshold, HMMSplicer identified 4,323 junctions in this dataset, 85.2% of which overlapped either known gene models or ESTs (<xref ref-type="fig" rid="pone-0013875-g004">Figure 4c</xref>). TopHat found 3,138 junctions in this dataset with 77.7% aligning to known gene models or ESTs. By re-running TopHat with more stringent alignment parameters, the percent of confirmed junctions was boosted to 94.8%, but this resulted in a 71% decrease in the number of found junctions (885). In contrast, the output of HMMSplicer can be filtered for more stringent confirmed junction percentages simply by raising the score threshold. SpliceMap could not be tested on this dataset because the reads are less than the minimum 50 nt length required by the algorithm.</p>
    </sec>
    <sec id="s2g">
      <title>HMMSplicer performs well in large metazoan genomes</title>
      <p>The <italic>Homo sapiens</italic> genome is large (3.2 billion base pairs with ∼25,000 genes), and contains both short exons (∼59 bp on average) and large introns (∼6,553 bp) <xref rid="pone.0013875-Deutsch1" ref-type="bibr">[31]</xref>, creating a significant challenge for identifying splice junctions. However, the human genome is well annotated with abundant EST evidence, allowing evaluation of HMMSplicer's performance on transcripts with low abundance, alternatively spliced junctions, and non-canonical junctions. Although the human genome is well studied, the complications of tissue-specific expression and widespread alternative splicing mean that many splicing events have not yet been detected. For our benchmark tests, we selected a human dataset containing 9,669,944 paired-end reads, each 45 bp long, from a single individual's resting CD4 cells <xref rid="pone.0013875-Heap1" ref-type="bibr">[27]</xref>. The version of the genome used for analysis was the February 2009 human reference sequence (GRCh37) produced by the Genome Reference Consortium. Two reference sets were used to identify known introns. The first set represents known genes and well-studied alternates (genes present in the manually curated RefSeq <xref rid="pone.0013875-Pruitt1" ref-type="bibr">[35]</xref>), while the second set represents a more extensive set of junctions, including many alternative splicing events (RefSeq genes and an additional 8,556,822 mRNAs and ESTs from GenBank <xref rid="pone.0013875-Benson1" ref-type="bibr">[36]</xref>).</p>
      <p>HMMSplicer was run with a minimum intron length of 5 bp and a maximum intron length of 80,000 bp, covering 99.1% of known introns in the human genome. Because HMMSplicer must match the second piece of the read downstream of the initial exon edge identified, the HMMSplicer algorithm is sensitive to maximum intron size. For efficient and accurate matching in 80 kbp introns, we used an anchor size of 8 nt, instead of the 6 nt anchor used in <italic>A. thaliana</italic>. At the default score threshold, HMMSplicer found 101,664 junctions, 87% of which (88,162) matched known genes or ESTs/mRNAs (<xref ref-type="fig" rid="pone-0013875-g004">Figure 4b</xref>). TopHat was run with the default intron size range of 70 to 500,000 bp, which covers 99.9% of known introns in the human genome. TopHat found 72,771 junctions, of which 93.0% (67,664 junctions) matched known genes or ESTs/mRNAs. Increasing the score threshold to 600 for junctions supported by multiple reads (800 for junctions supported by a single read) yields a similar confirmed junction rate of 91.8% and leads HMMSplicer to find 89,130 junctions, 22% more than TopHat.</p>
      <p>Because this publicly available 45 nt dataset is too short for analysis by SpliceMap (which requires 50 nt reads), we were unable to directly compare HMMSplicer to SpliceMap on this dataset. Instead, we ran HMMSplicer on the human dataset analyzed in the SpliceMap publication <xref rid="pone.0013875-Au1" ref-type="bibr">[25]</xref>, a set of 23,412,226 paired end reads of 50 nt each from a human brain sample (GEO Accession number GSE19166). SpliceMap is published as finding 175,401 splice junctions in this dataset with 82.96% EST validation. Filtering lowers the number of junctions found while raising the validation rate, so that at a validation rate of 94.5%, SpliceMap detected 121,718 junctions. HMMSplicer was run on the same dataset with default parameters, yielding similar results of 177,890 junctions with 84.2% EST validation at the default score threshold. Raising the score threshold to 800 (1000 for single junctions) we found 131,007 junctions with 94.5% EST validation. Our comparisons suggest that HMMSplicer finds slightly more (7%) junctions than SpliceMap at an equivalent EST validation level (94.5%) in this human dataset.</p>
    </sec>
    <sec id="s2h">
      <title>HMMSplicer identifies many junctions in low abundance transcripts</title>
      <p>A recent RNA-Seq study across 24 tissues in humans showed that ∼75% of mRNA in a cell is from ubiquitously expressed genes <xref rid="pone.0013875-Ramskld1" ref-type="bibr">[37]</xref>. Furthermore, although transcripts from ∼11,000 to ∼15,000 genes were detected (depending on the tissue), the 1000 genes with the highest expression levels contributed more than half the mRNA in each tissue. The importance of RNA-Seq in the detection of novel splice junctions is not in these ubiquitous highly expressed genes, which generally have EST coverage, but in the tissue-specific genes with lower transcript abundance.</p>
      <p>Therefore, we measured HMMSplicer's capacity for detection of junctions in low-abundance transcripts in the human resting CD4 cell dataset. In RNA-Seq experiments with non-normalized cDNA samples, the coverage level of a gene varies depending on relative transcript abundance. A convenient measure of read coverage relative to the transcript abundance is Read Per Kilobase per Million reads mapped (RPKM) <xref rid="pone.0013875-Mortazavi1" ref-type="bibr">[18]</xref> which counts the number of reads that map to a gene, normalized by the length of the gene in kilobases, per million reads mapped to the genome. <xref ref-type="fig" rid="pone-0013875-g005">Figure 5</xref> shows the number of predicted junctions matching RefSeq-defined introns at different RPKM levels. HMMSplicer identified more junctions than TopHat at all RPKM levels, but the difference is greatest at low values of RPKM. This is relevant to many RNA-Seq experiments. In this dataset, 75% of genes had an RPKM of 10 or less.</p>
      <fig id="pone-0013875-g005" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0013875.g005</object-id>
        <label>Figure 5</label>
        <caption>
          <title>Human results compared by transcript abundance.</title>
          <p>Transcript abundance was measured as Reads Per Kilobase per Million reads mapped (RPKM) and the genes were binned by RPKM to show the number of RefSeq junctions found at different levels of transcript abundance. For genes with an RPKM less than 10, HMMSplicer found 76.2% more junctions, whereas for genes with an RPKM above 50, HMMSplicer found only 6.7% more junctions. While a smaller number of highly expressed genes dominate the mRNA population, 74.8% of genes have RPKM values less than 10.</p>
        </caption>
        <graphic xlink:href="pone.0013875.g005"/>
      </fig>
    </sec>
    <sec id="s2i">
      <title>Sequence-level analysis reveals alternate 5′ and 3′ splice sites</title>
      <p>HMMSplicer's approach allows discrimination of closely spaced alternative splice sites, providing a method to study fundamental questions about the biology of splicing which have not yet been addressed with RNA-Seq experiments. Alternative splicing analysis in RNA-Seq data frequently focuses on quantifying isoform expression level, such as in a recent study measuring isoform abundance based on relative coverage levels of exons <xref rid="pone.0013875-Richard1" ref-type="bibr">[38]</xref>. This is an important application, but the sequence-level detail of RNA-Seq data provides the power to examine alternative splicing at a finer level of detail. Analysis within the human resting CD4 cell dataset showed instances where splice sites varied slightly from known intron boundaries, suggesting an inexact splicing event. To investigate these results further, all junctions overlapping RefSeq introns with fewer than 15 bp differences in splice sites were examined and the number of bases added or removed from the exon boundary was counted. Overall, there were 997 instances (1.4% of junctions which match RefSeq) where an intron possessed an alternate 5′SS and 2,577 (3.6% of junctions which match RefSeq) instances of an alternate 3′SS. Alternative splicing which maintained the reading frame (<italic>i.e.</italic> added or removed a multiple of 3 bases from the transcript) was clearly preferred for the 3′ splice site (<xref ref-type="fig" rid="pone-0013875-g006">Figure 6</xref>). This result is not surprising given that the 3′SS motif, Y<underline>AG</underline>, is shorter and shows more variation than the 5′SS motif, <underline>GT</underline>RAGT <xref rid="pone.0013875-Wahl1" ref-type="bibr">[6]</xref>. To investigate this result further, WebLogos <xref rid="pone.0013875-Crooks1" ref-type="bibr">[39]</xref> were constructed from the sequences at the alternate 3′SS that were off by 3 bases. Analysis of these WebLogos found at the alternate 3′SS shows repetition of the splice motif (<italic>i.e.</italic> YAGYAG).</p>
      <fig id="pone-0013875-g006" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0013875.g006</object-id>
        <label>Figure 6</label>
        <caption>
          <title>Alternative 5′ and 3′ splice sites.</title>
          <p>HMMSplicer results within 15 bp of RefSeq introns were analyzed to measure the number of bases added or removed from the spliced transcript. There were 997 instances where the intron had an alternate 5′ splice site (5′SS, shown in grey) and 2,577 instances of an alternate 3′ splice site (3′SS site, shown in black). The most common alternative splice was 3 bases removed or added to the exon at the 3′SS. TopHat results showed a similar pattern, though only 875 alternates (262 5′SS alternates and 613 3′SS alternates) are found, less than a quarter of the HMMSplicer results. WebLogos were constructed from the sequences at the 1,099 alternate 3′SS with three bases removed from the transcript and the 460 alternate 3′SS with three bases added to the transcript. For these, the green dashed line shows the alternate splice site while the red dashed line shows the canonical splice site. In both cases, a repetition of the YAG splice motif is evident.</p>
        </caption>
        <graphic xlink:href="pone.0013875.g006"/>
      </fig>
    </sec>
    <sec id="s2j">
      <title>HMMSplicer identifies non-canonical junctions</title>
      <p>We next analyzed the ability of HMMSplicer to identify junctions with splice sites other than GT-AG using the human resting CD4 dataset for analysis. The most common splice sites, GT-AG, GC-AG, and AT-AC, are found in 98.3%, 1.5% and 0.2% of human introns, respectively <xref rid="pone.0013875-Stamm1" ref-type="bibr">[7]</xref>. By default, HMMSplicer attempts to adjust intron edges to GT-AG, GC-AG or AT-AC but includes only GT-AG and GC-AG introns in the set of canonical junction predictions. The user can alter the splice sites for adjustment and filtering or can eliminate these steps entirely. We examined the splice sites in junctions found by HMMSplicer. Counting only junctions that matched known mRNA/ESTs, HMMSplicer detected 87,245 GT-AG junctions, 791 GC-AG junctions, and 97 AT-AC junctions. This is 99% GT-AG, 0.9% GC-AG, and 0.1% AT-AC, which corresponds well with the published rates. The ratio of junctions that match known junctions is much lower for non-GT-AG junctions (20.3% for GC-AG and 6.5% for AT-AC). To resolve whether HMMSplicer non-canonical junctions are false positives or novel instances, further experimental validation will be required. Regardless, HMMSplicer provides all junctions and allows the user to filter based on the experiment's objectives.</p>
      <p>Although rare, there are also splice junctions that do not have GT-AG, GC-AG or AT-AC splice sites. For example, the <italic>HAC1</italic> mRNA and its metazoan homologue <italic>XBP1</italic> are spliced by Ire1p with the non-canonical splice sites CA-AG, initiating the unfolded protein response <xref rid="pone.0013875-Yoshida1" ref-type="bibr">[8]</xref>. HMMSplicer's non-canonical junction results on the human dataset contained three reads spanning the <italic>XBP1</italic> non-canonical intron with scores ranging from 927 to 971 (<xref ref-type="fig" rid="pone-0013875-g007">Figure 7</xref>). The sequence at the beginning of the intron is identical to the initial exon sequence, so the HMM was unable to resolve the exact junction edges correctly. This resulted in two possible predictions, one 2 bp upstream from the actual site and one 4 bp downstream from the actual site. Collapsing identical junctions resulted therefore in two junctions, one with a score of 1024 and one with a score of 1030, which put them in the top 0.5% of the collapsed non-canonical junctions.</p>
      <fig id="pone-0013875-g007" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0013875.g007</object-id>
        <label>Figure 7</label>
        <caption>
          <title>XBP1 non-canonical intron.</title>
          <p>HMMSplicer discovers the non-canonical <italic>XBP1</italic> intron. HMMSplicer identifies three reads containing the non-canonical CA-AG splice site in <italic>XBP1</italic>. Because the reads are fairly evenly split, both read-halves aligned to the genome. The edges identified by HMMSplicer are 2 and 4 bp off from the actual splice site because the sequence at the beginning of the intron repeats the sequence at the beginning of the subsequent exon. When identical junctions are collapsed, there are two junctions, one with a score of 1024 and one with a score of 1030, which puts them in the top 0.5% of the collapsed non-canonical junctions.</p>
        </caption>
        <graphic xlink:href="pone.0013875.g007"/>
      </fig>
    </sec>
    <sec id="s2k">
      <title>HMMSplicer finds true novel junctions in genomes with incomplete annotation</title>
      <p>To determine if unconfirmed junctions predicted by HMMSplicer represent true novel junctions or false positive predictions, we experimentally validated four previously unknown junctions predicted from the organism with the least thorough annotation, <italic>P. falciparum</italic> (<xref ref-type="fig" rid="pone-0013875-g008">Figure 8</xref>). All four junctions were relatively high scoring but no EST or experimental data exists for comparison, and each case conflicts with the current PlasmoDB gene model. The first junction (score = 1300), in PFC0285c (predicted to encode the beta subunit of the class II chaperonin tailless complex polypeptide 1 ring complex), suggests an additional exon at the 5′ end of the gene model, possibly belonging to the 5′ untranslated region (UTR). The second junction (score = 1198) belongs to PF07_0101, a conserved <italic>Plasmodium</italic> protein of unknown function. This previously unknown junction excises 291bp out of the middle of the first annotated exon, which would result in a protein 97 amino acids (aa) shorter. The third and fourth junctions, with scores of 1261 and 1175, respectively, are in PFD0185c, another gene of unknown function conserved across <italic>Plasmodium</italic> species. One junction lies within the predicted gene, splicing out 85bp and leading to a frameshift near the 3′ end, while the other appears to splice together two exons in the 3′UTR. RT-PCR followed by sequence analysis verified all four splice junctions predicted by HMMSplicer (<xref ref-type="fig" rid="pone-0013875-g008">Figure 8</xref>), confirming HMMSplicer's ability to predict true novel junctions from RNA-Seq data.</p>
      <fig id="pone-0013875-g008" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0013875.g008</object-id>
        <label>Figure 8</label>
        <caption>
          <title>Experimental confirmation of predicted <italic>Plasmodium falciparum</italic> splice junctions.</title>
          <p>Schematics of the predicted splice junctions and sequenced RT-PCR products for <bold>a</bold>) PFC0285c, <bold>b</bold>) PF07_0101, and <bold>c</bold>) PFD0185c. For PFC0285c, the verified junction likely splices an additional exon in the 5′UTR to the coding region of the gene. The confirmed junction in PF07_0101 splices out 291 nt (97 aa) from the first exon, which could represent an alternative protein-coding isoform, or an error in the gene model. The demonstrated junctions in PFD0185c excise 85bp near the 3′ end of the gene, causing a frameshift, and appear to splice two exons within the 3′UTR of the gene together. Again, the junction within the gene model may represent an alternative splicing event or an error in the gene model. ESTs near all three areas are included to provide the direction of the genes.</p>
        </caption>
        <graphic xlink:href="pone.0013875.g008"/>
      </fig>
    </sec>
  </sec>
  <sec id="s3">
    <title>Discussion</title>
    <p>HMMSplicer is an efficient and accurate algorithm for finding canonical and non-canonical splice junctions in short read data. Our benchmark tests on simulated data and three publicly available datasets show that HMMSplicer is able to detect junctions in compact and mammalian genomes with high specificity and sensitivity. The real world challenges in these datasets include low quality reads and uneven coverage. Built on Bowtie, HMMSplicer is fast, comparable in CPU time to TopHat. Analysis also demonstrates HMMSplicer's ability to find splice junctions on transcripts with low abundance, alternative splicing, and non-canonical junctions.</p>
    <p>Comparisons with TopHat show that HMMSplicer is able to find more junctions with a similar level of specificity in each of these datasets. Comparisons with SpliceMap show that HMMSplicer has similar performance, yielding slightly more (7%) EST matching junctions in paired-end human datasets. However, in the low sequence quality <italic>A. thaliana</italic> dataset, HMMSplicer significantly outperforms SpliceMap. HMMSplicer was not compared to SplitSeek <xref rid="pone.0013875-Ameur1" ref-type="bibr">[23]</xref> as this algorithm only processes colorspace reads. Though the algorithm is similar, we anticipate that HMMSplicer would be more sensitive than SplitSeek, since this algorithm requires at least one read to be split evenly across the splice junction. HMMSplicer, TopHat, and SpliceMap are all free from this constraint. Finally, the SuperSplat <xref rid="pone.0013875-Bryant1" ref-type="bibr">[24]</xref> algorithm is the only other currently available algorithm that detects non-canonical junctions to our knowledge. Unfortunately, the current version of SuperSplat does not align reads with any mismatches, and also has large memory requirements (5–32 GB to index the <italic>A. thaliana</italic> genome).</p>
    <p>A major strength of HMMSplicer is that it is the only software package that provides a score for each junction, reflecting the strength of the junction prediction, which allows tuning of HMMSplicer's results to an experiment. While many splice junction algorithms filter on specific attributes to improve validation rates, for example, SpliceMap has filtering to remove junctions with only a single supporting read, HMMSplicer's score provides a more flexible way to tune true and false positive rates for the experiment. The score is based solely on the number of bases on each side of the junction, the quality of those bases, and the junction's similarity to potential full-length matches. Re-annotation experiments would necessitate a higher threshold to avoid false positives, but experiments looking for novel junctions could use a lower threshold to include as many true positives as possible. The threshold can also be tuned for non-ideal datasets, such as the low quality <italic>A. thaliana</italic> dataset. The score is highly predictive despite the fact that it does not include biological factors such as splice site or intron length in its calculation, making it ideal for detection of novel splice junctions.</p>
    <p>Alternative splicing is an area of intense research where HMMSplicer's approach provides a significant advantage over algorithms that rely on exon islands, such as TopHat. In the case of alternate 5′ or 3′ splice sites, the major isoform may mask the signal from a minor isoform, especially in genes without high sequence coverage. HMMSplicer accurately identifies small variations in 5′ and 3′ splice sites. These small variations in splice sites, most frequently 3 nucleotides added or removed from the transcript at the 3′ splice site (1 amino acid added/removed from the translated protein), demonstrate how the repetition of the splice motif can cause inexact splicing. HMMSplicer's unbiased approach to alignment, combined with the sequence level power of RNA-Seq, has enormous potential for biological inquiry into alternative splicing.</p>
    <p>The depth of RNA-Seq and the unbiased approach of HMMSplicer also allow investigation into non-canonical splicing. HMMSplicer allows the researcher to define canonical splice sites, and returns both canonical and non-canonical results. Scores in HMMSplicer's predicted junctions aid the discovery process, as evidenced by the <italic>XBP1</italic> example in the human dataset. In HMMSplicer's results, it was ranked in the top 0.5% of the non-canonical splice results.</p>
    <p>In conclusion, HMMSplicer is a valuable addition to the algorithms available for finding splice junctions in RNA-Seq data. The software, documentation and details about the datasets and analysis can be found at <ext-link ext-link-type="uri" xlink:href="http://derisilab.ucsf.edu/software/hmmsplicer">http://derisilab.ucsf.edu/software/hmmsplicer</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods" id="s4">
    <title>Materials and Methods</title>
    <sec id="s4a">
      <title>Algorithm Description</title>
      <p>The HMMSplicer algorithm has four main steps: seeding reads within the reference genome, finding the splice position, matching the second piece of the read, and scoring/filtering splice junctions. <xref ref-type="fig" rid="pone-0013875-g001">Figure 1</xref> shows an overview diagram of the HMMSplicer pipeline.</p>
      <p>As a pre-analysis step, dataset reads are aligned to the reference genome using Bowtie <xref rid="pone.0013875-Langmead1" ref-type="bibr">[5]</xref>. Reads with full-length alignments to the genome contain no junctions and are therefore removed from consideration. These genome-matching reads may be used to build a coverage track that can be viewed in the UCSC Genome Browser <xref rid="pone.0013875-Kent2" ref-type="bibr">[40]</xref> or other applications.</p>
      <sec id="s4a1">
        <title>Step 1. Read-half alignment</title>
        <p>To determine the read's seed location within the genome, we assume that each read spans at most a single exon-exon junction. Reads are divided in half, rounding down for reads of odd length, and both read-halves are aligned to the genome using Bowtie (current version 0.12.2), although other full-length alignment algorithms may also be used. This approach will locate an alignment for both read halves if the read is somewhat evenly split across a junction, and these alignments are carried through the algorithm independently until they are resolved during scoring. However, if the read matches unevenly across the junction (<italic>e.g.</italic> if one side of a 45 nt read is 35 nt long and the other side is 10 nt long, referred to as a “35/10 split”), only the longer side will be seeded in this step. A read-half may not align if the larger half falls on another exon-exon junction or if sequencing errors prevent an alignment. Alternatively, a read half may have multiple alignments. As long as the duplicates are below a repeat threshold (50 alignments by default), all seeds are continued through until the filtering part of the algorithm; duplicate junction locations for a read are resolved at that point. For clarity in the text below, the half of the read that seeded will be referred to as the ‘first half’ and will be described as if the initial half of the read matched to the 5′ edge of the intron, with all sequences in the sense direction. In reality, either half of the read could match to either edge of the intron.</p>
      </sec>
      <sec id="s4a2">
        <title>Step 2. Determine Splice Site Position</title>
        <p>The alignment of a read-half determines an outside edge of the spliced read alignment, but does not determine where the exon-intron boundary occurs. To return to our previous example read with a 35/10 split, the first half of the read, corresponding to 22 bases, will be aligned but it will be unclear that the first side extends to 35 bases. A simplistic approach to this problem would be to extend the seed until a mismatch occurs but this approach ignores both the additional information available in quality scores and the high error rate inherent in many high-throughput sequencing technologies. Continuing from the 35/10 split example, imagine, after the first 22 bases of read-half, there is one mismatch to the genome at a low quality base and then 12 bases in a row which match the genome. The simplistic approach would be to assume the read stopped aligned after the first mismatch, suggesting the split is 22/23 instead of 35/10, resulting in an incorrect junction alignment. To avoid this type of error, HMMSplicer utilizes a two-state Hidden Markov Model (HMM) to determine the optimal splice position within each read. State 1 describes a read aligning to the genome. In this state, we expect that most bases in the read match their partner in the genome, and that the probability of matching will vary based on the read base quality (high quality bases are less likely to be sequencing errors and thus more likely to match). State 2 is cessation of alignment to the genome. In this state, matches between the read and the genome are essentially random and do not depend on quality. For example, a genome with a GC content of 50% would yield an expected probability of 25% for each base to match the target genome location, regardless of sequence quality score. The most probable transition point from State 1 to State 2 defines the optimal splice position. In the 35/10 split example, the HMM would evaluate the probability of a 22/23 split, with 10 matches in a row in State 2 (where the probability of a match is only 25%) compared to the probability of a 35/10 split where a low quality base causes a single mismatch while remaining in State 1. Assuming the probability of a mismatch in State 1 in a low quality base was about 30% (a typical value), the 35/10 split would be more probable than the 22/23 split. (All other possible splits would also be considered, but these would be low probability compared to the 22/23 and 35/10 split options.)</p>
        <p>Within each state of the HMM, the quality is binned into five levels, representing low, medium-low, medium, medium-high, and high quality scores. Using five bins provides the best balance between having sufficient bins to distinguish quality levels, while maintaining enough bases within each quality bin that the HMM can be adequately trained using a random subset of reads. Using a separate bin for each quality score created situations where one or more quality score were under-trained because quality scores are not evenly distributed from zero to forty. Increasing the training subset size can ameliorate this problem, however results with more quality bins were not significantly better than results with five quality bins (data not shown).</p>
        <p>The HMM is trained on a randomly selected subset of the input read set. The training is accomplished using the Baum-Welch algorithm <xref rid="pone.0013875-Baum1" ref-type="bibr">[41]</xref>, an expectation maximization technique that finds the most likely parameters for an HMM given a training set of emissions. For HMMSplicer, emissions are strings of match/mismatch values derived from the alignment of the whole read to the genome at the position of each seed match. By using an unsupervised training method, the HMM values can be trained without additional input from the user, such as known genome annotations. This allows for a more sophisticated approach than the simplistic model described above while maintaining model unbiased by additional information such as known genome annotation. This training allows the values to be optimal for any particular genome and sequencing run. For example, genome specific training can adjust for biases in genomic nucleotide composition. One of the datasets used in our testing is <italic>P. falciparum</italic>, which has a genome that is 80% AT. This reduced complexity makes the probability of a match in random sequence higher than the 25% that it would be in a genome with balanced nucleotide distributions. In addition, training provides a way to validate the model. The premise behind the model is that in State 1 the probability of a match should increase with the quality of a base, but in State 2 the probability of a match should be independent of the quality score. If this model is accurate then regardless of initial values, the trained HMM should reflect this expectation. The outcome of the training, detailed in the <xref ref-type="sec" rid="s2">Results</xref> section above, confirm the robustness of the model to different initial values. The HMM values for each parameter, before training and after training with each dataset studied, are given in <xref ref-type="table" rid="pone-0013875-t001">Table 1</xref>. For each organism, the model trains as expected. Parameters in State 1 show a higher rate of matches than mismatches, varying by quality score, while parameters in State 2 remain at approximately 25% probability of a match regardless of quality. The only exception is for <italic>P. falciparum</italic>, where the probability of a mismatch in State 2 varies from 37% to 28% depending on quality because of the 80% AT bias in the genome.</p>
        <p>After the HMM is trained, it is run for every read-half alignment, yielding the coordinates of the first piece of the read alignment, including the first exon-intron boundary of the splice junction. In the event of multiple equally probable splice positions, the splice position with the shortest second piece is selected. A falsely short second piece may still match within the maximum intron distance and has the potential to be adjusted to the correct splice site in the canonical splice-site adjustment (see below for details). On the other hand, a second piece with false bases added to the beginning will likely not match within the maximum intron distance causing the read to be discarded. If the remaining part of the read is too short (eight nucleotides or fewer by default), the alignment is set aside. Uncertainty in the precise location of the splice junction and short alignment can be further resolved in a subsequent evaluation process described below.</p>
      </sec>
      <sec id="s4a3">
        <title>Step 3. Determine Spliced Exon position</title>
        <p>Once the splice position has been determined, the first exon-intron boundary has been identified. To determine the second exon-intron boundary, the remaining part of the read, (the ‘second piece’), must be aligned. To reduce search space to a manageable and biologically relevant size, a default of 80 kbp downstream of the initial alignment is considered, although the user may adjust this to the most appropriate value for the organism and experiment. HMMSplicer first determines potential location positions by using the initial eight nucleotides of the second piece as an anchor (this anchor size may also be tuned to the organism and experiment), searching for all locations within the maximum intron size where this anchor matches exactly. To accommodate possible sequencing errors in these initial eight nucleotides, exact matches for the next eight nucleotides (<italic>i.e.</italic> positions 9–16 of the second piece) are found and are added to the set of anchors. For each position where an anchor has an exact match, the entire second piece of the read is compared to the genome and the number of mismatches is counted. The alignment with the fewest mismatches is selected as the best match. In the event of multiple best matches, the read is set aside to be resolved later.</p>
        <p>At this point, a preliminary splice junction has been defined. However, the exact splice positions may be offset from the actual intron-exon boundaries by a few nucleotides, especially in cases where the sequence at the beginning of the intron matches that at the beginning of the second exon. In these cases, sequence alone cannot define the correct edges. To aid in correct splice edge definition, HMMSplicer uses an assumption about the biology of splice sites. The most common splice sites, GT-AG, GC-AG, and AT-AC, are found in 98.3%, 1.5% and 0.2% of human introns, respectively <xref rid="pone.0013875-Stamm1" ref-type="bibr">[7]</xref>. By default, HMMSplicer uses these three splice sites (in order of their frequency of usage) to adjust intron-exon boundaries, though the sequences can be changed or the feature can be turned off entirely. Given the frequency of these three splice sites compared to other splice sites, the use of splice sites for intron-exon boundary adjustment introduces a conservative assumption and can help resolve small ambiguities in the position of the splice site prediction. To perform the adjustment, both splice edges are moved an equivalent number of nucleotides to reach a canonical splice site, where possible. Junctions already at canonical edges and junctions that cannot be adjusted to canonical edges remain unchanged.</p>
        <p>HMMSplicer provides a score for each predicted junction that does not rely on any biological information or assumptions about splicing machinery beyond the user-configurable adjustment to canonical splice sites, leaving the user free to apply the appropriate data processing filters for the experiment. The goal of the scoring approach is to use available information maximally while minimizing assumptions. For example, a score that incorporated the intron size distribution of the organism could have been more accurate, but would have introduced a strong bias toward typical intron sizes. Similarly, a scoring algorithm that penalizes non-canonical junction edges would have introduced a bias towards canonical splice sites. Instead, HMMSplicer's score uses information only about the genome sequence, read sequence, read quality, and splice position to derive a score. The researcher can introduce further filtering to the result set, based on the needs of the experiment, but the score is free from these biases.</p>
        <p>To accomplish this goal, we chose an information-based approach to the score algorithm, akin to a BLAST bit score rather than the probability-based E-value <xref rid="pone.0013875-Crooks1" ref-type="bibr">[39]</xref>. The initial step of the scoring algorithm is to measure the amount of information in the alignment of one side of the junction read. Assuming each possible nucleotide is equally likely and the reported read nucleotide was certain (no sequencing errors) there would be four equally possible nucleotides at each position of the read, resulting in 2 bits per position (log<sub>2</sub>(4)). However, the reported nucleotide is not certain, and this uncertainty is encoded by the quality of the nucleotide. To scale for this, we multiply the 2 bits by the probability that the nucleotide call is correct, given the quality score. The sum of the information in each matching position of the read piece alignment is then used as the score for that read piece.</p>
        <p>Given:<disp-formula><graphic xlink:href="pone.0013875.e001.jpg" mimetype="image" position="float"/></disp-formula>
</p>
        <p>Score for one side is calculated as:<disp-formula><graphic xlink:href="pone.0013875.e002.jpg" mimetype="image" position="float"/><label>(1)</label></disp-formula>
</p>
        <p>Both sides of the junction are scored using equation (1). To combine the scores for the individual read pieces, they are multiplied, giving a strong bias to evenly split reads. The score increase is greater for evenly split reads than for reads with uneven piece sizes. For example, comparing 50 nt reads and 70 nt reads, a 10/40 split compared to a 10/60 split will, under ideal conditions, raise the score from 400 to 600. By contrast, a 25/25 split compared to a 35/35 split will raise the score from 625 to 1225, a much more dramatic increase. This increase reflects the fact that a 10/40 to 10/60 split does not increase the information available as much as a 25/25 split to a 35/35 split.</p>
        <p>Next, the score is corrected for the similarity to a full-length alignment. For each junction, if we hypothesize that the junction may actually be a full-length alignment, there are two possible positions for this alignment, either the left side is correct and the right side should be moved left adjacent to it, or the reverse. Both these possible full-length alignments are scored and the better alignment is kept. Half of this score is subtracted from the initial junction information as follows:<disp-formula><graphic xlink:href="pone.0013875.e003.jpg" mimetype="image" position="float"/><label>(2)</label></disp-formula>
</p>
        <p>Where h<sub>a</sub> is the score for the left side, h<sub>b</sub> is the score for the right side, h<sub>a′</sub> is the score for the left side when moved adjacent to the right side and h<sub>b′</sub> is the score for the right side when moved adjacent to the left side. F is set to 0.5, an empirically derived value that gives the best score results when tested on the human dataset (data not shown).</p>
        <p>As a final step, the scores are normalized to the range 0–1200, with most scores less than 1000 in practice. This is simply for easy visualization in the UCSC Genome Browser. The BED file output from HMMSplicer can be uploaded directly to the UCSC Genome Browser, which uses grey-scale to represent scores from 0–1000. To perform this scaling, the multiplier is 1200 divided by the theoretical maximum score for a read of the given length. When calculating the theoretical maximum, equation (1) reduces to the length of the read piece times 2 bits. Thus, if the read length is even, the multiplier is:<disp-formula><graphic xlink:href="pone.0013875.e004.jpg" mimetype="image" position="float"/><label>(3a)</label></disp-formula>If the read length is odd, the multiplier is:<disp-formula><graphic xlink:href="pone.0013875.e005.jpg" mimetype="image" position="float"/><label>(3b)</label></disp-formula>
</p>
        <p>All together, the full equation for the score value is:<disp-formula><graphic xlink:href="pone.0013875.e006.jpg" mimetype="image" position="float"/><label>(4)</label></disp-formula>
</p>
        <p>Once splice junctions have been detected and scored, HMMSplicer resolves instances where both halves of a read were aligned independently, as well as instances where one or both read halves created multiple alignments. For reads where independent read half alignments converged on the same junction position, a single copy of the junction is saved. For reads where the read halves had multiple seed positions, if one position has a score much higher than the other(s), that position is retained. If a read matches in multiple positions and all positions have close scores (by default, scores with differences less than 20, but this is user configurable), reads are saved in a separate set of output results reserved for duplicates.</p>
      </sec>
      <sec id="s4a4">
        <title>Step 4: Rescue</title>
        <p>Reads that cannot be matched uniquely can be used to lend support to a junction previously identified in the dataset. HMMSplicer attempts to rescue matches where the location of the first piece of the read is uniquely identified, but the location of the second piece is not. There are two sources of such reads: 1) reads with a second piece fewer than eight bases long and 2) reads where the second piece matched equally well to multiple locations within the maximum intron size. In both cases, HMMSplicer can apply the information from mapping the initial part of the read to rescue the read using other junctions found in the dataset. If another read ends at the same point as this read (i.e. has the same junction edge on the known side), the algorithm examines the other side of the junction to determine if the initial bases of the exon sequence match the second piece of this read. If so, this junction is assumed to be the source of the read.</p>
      </sec>
      <sec id="s4a5">
        <title>Step 5: Filter and Collapse</title>
        <p>Finally, initial junction-spanning reads are filtered and collapsed to yield a final set of predicted junctions. Splice junctions are divided into populations that do and do not match the most frequent splice sites (‘GT-AG’ and ‘GC-AG’ by default). Regardless of whether the user chooses to impose these splice site position sequences into the search, nonconforming junctions are saved and ranked separately. All reads creating the same intron are collapsed into a single junction with the score for these reads increased in relation to number of additionally covered bases. Distinct reads covering the same junction add significantly to a its potential to be real, but two identical reads may be from the same source, such as PCR amplification artifacts. To follow the previous example, a 35/10 split (35 bp on the first exon, 10 bp on the second exon) combined with another 35/10 split would not increase the score, but the 35/10 split plus a 10/35 split would yield a substantial boost to the score because the covered bases would now be now 35/35. To be exact, imagine the 10/35 junction read has a score of 800 and the 35/10 junction read has a score of 600. The higher score read is considered first, then the second read is collapsed onto it. In this case, the new junction adds 25 bases out of a total of, now, 70 bases covered, so a value of (25 / 70) * 600 is added to the original score of 800, yielding a collapsed score of 1214.2.</p>
        <p>Collapsed junction predictions are then filtered by score. Multiple error-free reads spanning the same splice junction align to the correct splice site, facilitating determination of splice boundaries. In contrast, because sequencing errors are distributed throughout the read with three possible wrong base substitutions, reads with errors that create false positive junctions tend to be scattered as single, incorrect alignments. Previous studies concur that true junctions are more likely than false junctions to be covered by more than one read <xref rid="pone.0013875-DeBona1" ref-type="bibr">[42]</xref>. Therefore, junctions covered by a single read are evaluated more stringently than junctions covered by multiple reads, with a higher score threshold set for junctions covered by a single read. The default score thresholds for HMMSplicer are 600 for junctions covered by a single read and 400 for junctions covered by multiple reads. These score thresholds were optimal for the benchmark datasets, but ultimately the score threshold will depend on the number of reads used in the experiment (datasets with more reads may require higher score thresholds) and the purpose of the experiment (re-annotation studies will require higher score thresholds than studies looking for novel junctions).</p>
      </sec>
    </sec>
    <sec id="s4b">
      <title>Benchmark Methods</title>
      <p>For the benchmark tests, all analysis was performed on an 8-core Mac Pro with 16 GB of RAM. HMMSplicer was run with default parameters unless otherwise noted. TopHat version 1.0.12 was used. TopHat was run with the best parameters for the dataset/organism, though the only parameter found to have a large effect on results was segment length. For reads shorter than 50 nt, segment lengths of half the read length were used for TopHat, as it was found to dramatically increase the number of splice junctions found (i.e. 30,381 junctions identified for the default segment length of 25 versus 68,946 junctions identified with a reduced segment length of 22 in the human dataset). For the simulation dataset, TopHat was run with the default parameters, except with a segment length of 20 and 22 for reads 40 and 44 nt long. The <italic>A. thaliana</italic> dataset was run with default parameters except for a minimum intron size of 5 and a maximum intron size of 6000. The <italic>H. sapiens</italic> dataset was run with a segment length of 22 using the butterfly search and microexon search parameters. The <italic>H. sapiens</italic> dataset is paired end and, based on information in the publication <xref rid="pone.0013875-Heap1" ref-type="bibr">[27]</xref>, an inner mate distance of 210 was used. SpliceMap was run on the <italic>A. thaliana</italic> dataset by the SpliceMap first author using a 6 kbp maximum intron size (personal communication).</p>
      <p>For most of the analysis, canonical splice junction results from HMMSplicer were used (<italic>i.e.</italic> GT-AG and GC-AG splice sites), as they are most comparable to results from other algorithms. <xref ref-type="table" rid="pone-0013875-t003">Table 3</xref> contains general characteristics of the datasets downloaded from NCBI SRA, including accession numbers.</p>
    </sec>
    <sec id="s4c">
      <title>Experimental Validation in <italic>Plasmodium falciparum</italic>
</title>
      <sec id="s4c1">
        <title>Cell culture, RNA preparation, and poly-A selection</title>
        <p><italic>Plasmodium falciparum</italic> 3D7 Oxford parasites were sorbitol synchronized in early ring stage, then synchronized again 24 and 32 hours later for a total of 3 synchronizations during 2 consecutive cell cycles. Culture conditions were as in Bozdech et al, 2003. Post-synchronization, maximum invasion (number of schizonts = number of rings) was observed by smear and 50mL of 2% hematocrit, 10% parasitemia culture was harvested 44 hours post-invasion (late schizogeny). Harvested cells were centrifuged at 1,500 g for 5 min, washed in phosphate-buffered saline (PBS), and pelleted at 1,500 g for 5 min. The cell pellet was rapidly frozen in liquid nitrogen and stored at −80°C. Total RNA was harvested from the frozen pellet using 10mL Trizol (Invitrogen Corp., Carlsbad, CA). 238ug of total RNA was poly-A selected using the Micro Fasttrack 2.0 kit (Invitrogen Corp., Carlsbad, CA).</p>
      </sec>
      <sec id="s4c2">
        <title>DNase treatment, reverse transcription, PCR, and sequencing</title>
        <p>3.6ug of poly-A selected RNA was treated twice with 2uL of TURBO DNase according to the manufacturer's instructions for the TURBO DNase-free kit (Applied Biosystems/Ambion, Austin, TX). Treated RNA tested negative for residual genomic DNA by PCR amplification in the following mix: 1× Herculase II Fusion buffer, 0.25mM dATP, 0.25mM dTTP, 0.0625mM dCTP, 0.0625mM dGTP, 0.25uM PF11_0062-F primer (<named-content content-type="gene">5′-ACTGGTCCAGATGGAAAGA AAAA-3′</named-content>), 0.25uM PF11_0062-R (<named-content content-type="gene">5′-GGAGGTAAATTTTGTTACAGCTTTGGTTCC-3′</named-content>), and 0.4uL of Herculase II Fusion polymerase (Stratagene, La Jolla, CA). PCR conditions were 95°C for 2 min, then 40 cycles of 95°C for 30 sec, 52°C for 45 sec, 65°C for 3 min, and finally 65°C for 7 min. 2ug of DNased RNA was melted at 65°C for 5 minutes in the presence of 817.5ng random hexamer, and then cooled at room temperature for 5 minutes. To reverse transcribe cDNA, 0.25mM dATP, 0.25mM dTTP, 0.0625mM dCTP, 0.0625mM dGTP, 1× First Strand buffer, 10M DDT, and 1090U Superscript III reverse transcriptase (Invitrogen, Carlsbad, CA) were added and the reaction was incubated at 42°C for 1.5 hours. 1uL of this reverse transcription mix was used for each junction confirming PCR using the previous described mix and cycling conditions, with the following changes: 0.5uM of the appropriate forward and reverse primers were used and 30 cycles of PCR were performed. Primer sequences are listed in <xref ref-type="table" rid="pone-0013875-t004">Table 4</xref>. PCR reactions were cleaned up with Zymo-5 DNA columns (Zymo Research Corp., Orange, CA). 100ng of each PCR product was a-extended by incubation at 37°C for 30 minutes in the presence of 16.7mM dATP, 1× NEB buffer 2, and 5U Klenow exo<sup>−</sup> (New England Biolabs, Ipswich, MA). Extended products were then TOPO TA cloned and transformed into chemically competent TOP10 cells (Invitrogen, Carlsbad, CA). Transformations were plated on LB+ampicillin plates spread with 100uL 40mg/mL Xgal. After 16 hours of growth, colony PCR was performed on white colonies with the following PCR mix: 1× Taq buffer, 2mM MgCl<sub>2</sub>, 0.5uM M13F, 0.5uM M13R, 0.25mM dATP, 0.25mM dTTP, 0.0625mM dCTP, 0.0625mM dGTP, and 0.5U Taq polymerase (Invitrogen, Carlsbad, CA). PCR conditions were 95°C for 2 min, then 30 cycles of 95°C for 30 sec, 52°C for 45 sec, 65°C for 3 min, and finally 65°C for 7 min. Following precipitation with 3 volumes of isopropanol, 1/4 of each PCR product was primer extended in Sanger sequencing reactions in the presence of 1uM M13F, 1× sequencing buffer, and 0.5uL BigDye Terminator (Applied Biosystems Inc., Foster City, CA). Cycling conditions were 94°C for 2 min, then 60 cycles of 94°C for 30 sec, 50°C for 1 min, 60°C for 1 min, and finally 60°C for 7 min. Sequencing reactions were precipitated with 1/4 volume 125mM EDTA and 1 volume 100% ethanol, and then resuspended in HiDi formamide and run on a 3130xl Genetic Analyzer (Applied Biosystems Inc., Foster City, CA).</p>
        <table-wrap id="pone-0013875-t004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0013875.t004</object-id>
          <label>Table 4</label>
          <caption>
            <title>Primer Sequences.</title>
          </caption>
          <alternatives>
            <graphic id="pone-0013875-t004-4" xlink:href="pone.0013875.t004"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Name</td>
                  <td align="left" rowspan="1" colspan="1">Sequence</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">PF07_0101 F</td>
                  <td align="left" rowspan="1" colspan="1">
                    <named-content content-type="gene">TGGGTTATCTGATCATCAAGGA</named-content>
                  </td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">PF07_0101 R</td>
                  <td align="left" rowspan="1" colspan="1">
                    <named-content content-type="gene">TTTTATGAGTGTCGTCCCTTTTT</named-content>
                  </td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">PFD0185c F1</td>
                  <td align="left" rowspan="1" colspan="1">
                    <named-content content-type="gene">CGCACTACCATATTTATGCCTCT</named-content>
                  </td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">PFD0185c R1</td>
                  <td align="left" rowspan="1" colspan="1">
                    <named-content content-type="gene">AGTAGAAGGAGGGAGGAGCA</named-content>
                  </td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">PFD0185c F2</td>
                  <td align="left" rowspan="1" colspan="1">
                    <named-content content-type="gene">TTCGCGTGATGAAGAAGATG</named-content>
                  </td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">PFD0185c R2</td>
                  <td align="left" rowspan="1" colspan="1">
                    <named-content content-type="gene">CAAGCCCACATATAAATCAAGGA</named-content>
                  </td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">PFC0285c F</td>
                  <td align="left" rowspan="1" colspan="1">
                    <named-content content-type="gene">TATCTTCTTGGGCCCCTTCT</named-content>
                  </td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">PFC0285c R</td>
                  <td align="left" rowspan="1" colspan="1">
                    <named-content content-type="gene">TGTGAATGCGTGAAGGATTT</named-content>
                  </td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt105">
              <label/>
              <p>Primers used for experimental validation.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Polly Fordyce, Victoria Newman, J. Graham Ruby and Peter Skewes-Cox for critical reading of the manuscript and Michael Cary for insightful discussions on the algorithm. We also thank Kin Fai Au and John C. Mu for running the SpliceMap program on the <italic>A. thaliana</italic> dataset.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement">
      <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
    </fn>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding: </bold>This work was supported by the Howard Hughes Medical Institute. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="pone.0013875-Wang1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics.</article-title>
        <source>Nat Rev Genet</source>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Wilhelm1">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilhelm</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Marguerat</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Watt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schubert</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wood</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2008</year>
        <article-title>Dynamic repertoire of a eukaryotic transcriptome surveyed at single-nucleotide resolution.</article-title>
        <source>Nature</source>
        <volume>453</volume>
        <fpage>1239</fpage>
        <lpage>1243</lpage>
        <pub-id pub-id-type="pmid">18488015</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Li1">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform.</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Li2">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>SOAP2: an improved ultrafast tool for short read alignment.</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>1966</fpage>
        <lpage>1967</lpage>
        <pub-id pub-id-type="pmid">19497933</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Langmead1">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome.</article-title>
        <source>Genome Biol</source>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Wahl1">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wahl</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Will</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Lührmann</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>The Spliceosome: Design Principles of a Dynamic RNP Machine.</article-title>
        <source>Cell</source>
        <volume>136</volume>
        <fpage>701</fpage>
        <lpage>718</lpage>
        <pub-id pub-id-type="pmid">19239890</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Stamm1">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamm</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Riethoven</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Le Texier</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Gopalakrishnan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kumanduri</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2006</year>
        <article-title>ASD: a bioinformatics resource on alternative splicing.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>34</volume>
        <fpage>D46</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="pmid">16381912</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Yoshida1">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yoshida</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Matsui</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yamamoto</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Okada</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mori</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <year>2001</year>
        <article-title>XBP1 mRNA is induced by ATF6 and spliced by IRE1 in response to ER stress to produce a highly active transcription factor.</article-title>
        <source>Cell</source>
        <volume>107</volume>
        <fpage>881</fpage>
        <lpage>891</lpage>
        <pub-id pub-id-type="pmid">11779464</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Cox1">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year>1996</year>
        <article-title>A Novel Mechanism for Regulating Activity of a Transcription Factor That Controls the Unfolded Protein Response.</article-title>
        <source>Cell</source>
        <volume>87</volume>
        <fpage>391</fpage>
        <lpage>404</lpage>
        <pub-id pub-id-type="pmid">8898193</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Sidrauski1">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sidrauski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year>1996</year>
        <article-title>tRNA ligase is required for regulated mRNA splicing in the unfolded protein response.</article-title>
        <source>Cell</source>
        <volume>87</volume>
        <fpage>405</fpage>
        <lpage>413</lpage>
        <pub-id pub-id-type="pmid">8898194</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Nilsen1">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nilsen</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Graveley</surname>
            <given-names>BR</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Expansion of the eukaryotic proteome by alternative splicing.</article-title>
        <source>Nature</source>
        <volume>463</volume>
        <fpage>457</fpage>
        <lpage>463</lpage>
        <pub-id pub-id-type="pmid">20110989</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Shepard1">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shepard</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Hertel</surname>
            <given-names>KJ</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>The SR protein family.</article-title>
        <source>Genome Biol</source>
        <volume>10</volume>
        <fpage>242</fpage>
        <pub-id pub-id-type="pmid">19857271</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Wang2">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khrebtukova</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2008</year>
        <article-title>Alternative isoform regulation in human tissue transcriptomes.</article-title>
        <source>Nature</source>
        <volume>456</volume>
        <fpage>470</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="pmid">18978772</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Pan1">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shai</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Frey</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Blencowe</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Deep surveying of alternative splicing complexity in the human transcriptome by high-throughput sequencing.</article-title>
        <source>Nat Genet</source>
        <volume>40</volume>
        <fpage>1413</fpage>
        <lpage>1415</lpage>
        <pub-id pub-id-type="pmid">18978789</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Nagasaki1">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagasaki</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Arita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nishizawa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Suwa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gotoh</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Species-specific variation of alternative splicing and transcriptional initiation in six eukaryotes.</article-title>
        <source>Gene</source>
        <volume>364</volume>
        <fpage>53</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="pmid">16219431</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Sen1">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Talukdar</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tam</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Muscleblind-like 1 (Mbnl1) promotes insulin receptor exon 11 inclusion via binding to a downstream evolutionarily conserved intronic enhancer.</article-title>
        <source>J Biol Chem</source>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Yano1">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yano</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hayakawa-Yano</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Mele</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Darnell</surname>
            <given-names>RB</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Nova2 Regulates Neuronal Migration through an RNA Switch in Disabled-1 Signaling.</article-title>
        <source>Neuron</source>
        <volume>66</volume>
        <fpage>848</fpage>
        <lpage>858</lpage>
        <pub-id pub-id-type="pmid">20620871</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Mortazavi1">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>McCue</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schaeffer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq.</article-title>
        <source>Nat Methods</source>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Kent1">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>BLAT–the BLAST-like alignment tool.</article-title>
        <source>Genome Res</source>
        <volume>12</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Nagalakshmi1">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagalakshmi</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Waern</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raha</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2008</year>
        <article-title>The transcriptional landscape of the yeast genome defined by RNA sequencing.</article-title>
        <source>Science</source>
        <volume>320</volume>
        <fpage>1344</fpage>
        <lpage>1349</lpage>
        <pub-id pub-id-type="pmid">18451266</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Trapnell1">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>TopHat: discovering splice junctions with RNA-Seq.</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>1105</fpage>
        <lpage>1111</lpage>
        <pub-id pub-id-type="pmid">19289445</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Trapnell2">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kwan</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation.</article-title>
        <source>Nat Biotechnol</source>
        <volume>28</volume>
        <fpage>511</fpage>
        <lpage>515</lpage>
        <pub-id pub-id-type="pmid">20436464</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Ameur1">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ameur</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wetterbom</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Feuk</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gyllensten</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Global and unbiased detection of splice junctions from RNA-seq data.</article-title>
        <source>Genome Biol</source>
        <volume>11</volume>
        <fpage>R34</fpage>
        <pub-id pub-id-type="pmid">20236510</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Bryant1">
      <label>24</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Bryant</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Priest</surname>
            <given-names>HD</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Mockler</surname>
            <given-names>TC</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Supersplat – spliced RNA-seq alignment.</article-title>
        <comment>Bioinformatics Available at: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20410051">http://www.ncbi.nlm.nih.gov/pubmed/20410051</ext-link>. Accessed 7 June 2010</comment>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Au1">
      <label>25</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Au</surname>
            <given-names>KF</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Xing</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Detection of splice junctions from paired-end RNA-seq data by SpliceMap.</article-title>
        <comment>Nucleic Acids Res Available at: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20371516">http://www.ncbi.nlm.nih.gov/pubmed/20371516</ext-link>. Accessed 7 June 2010</comment>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Dohm1">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dohm</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Lottaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Borodina</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Himmelbauer</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Substantial biases in ultra-short read data sets from high-throughput DNA sequencing.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>36</volume>
        <fpage>e105</fpage>
        <pub-id pub-id-type="pmid">18660515</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Heap1">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heap</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>JHM</given-names>
          </name>
          <name>
            <surname>Downes</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Healy</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>KA</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Genome-wide analysis of allelic expression imbalance in human primary cells by high-throughput transcriptome resequencing.</article-title>
        <source>Hum Mol Genet</source>
        <volume>19</volume>
        <fpage>122</fpage>
        <lpage>134</lpage>
        <pub-id pub-id-type="pmid">19825846</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Li3">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores.</article-title>
        <source>Genome Res</source>
        <volume>18</volume>
        <fpage>1851</fpage>
        <lpage>1858</lpage>
        <pub-id pub-id-type="pmid">18714091</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Lister1">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lister</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>O'Malley</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Tonti-Filippini</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gregory</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Berry</surname>
            <given-names>CC</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2008</year>
        <article-title>Highly integrated single-base resolution maps of the epigenome in Arabidopsis.</article-title>
        <source>Cell</source>
        <volume>133</volume>
        <fpage>523</fpage>
        <lpage>536</lpage>
        <pub-id pub-id-type="pmid">18423832</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Analysis1">
      <label>30</label>
      <element-citation publication-type="journal">
        <year>2000</year>
        <article-title>Analysis of the genome sequence of the flowering plant Arabidopsis thaliana.</article-title>
        <source>Nature</source>
        <volume>408</volume>
        <fpage>796</fpage>
        <lpage>815</lpage>
        <pub-id pub-id-type="pmid">11130711</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Deutsch1">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deutsch</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>1999</year>
        <article-title>Intron-exon structures of eukaryotic model organisms.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>27</volume>
        <fpage>3219</fpage>
        <lpage>3228</lpage>
        <pub-id pub-id-type="pmid">10454621</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Gardner1">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Fung</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Berriman</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2002</year>
        <article-title>Genome sequence of the human malaria parasite Plasmodium falciparum.</article-title>
        <source>Nature</source>
        <volume>419</volume>
        <fpage>498</fpage>
        <lpage>511</lpage>
        <pub-id pub-id-type="pmid">12368864</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Lu1">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Valenzuela</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>cDNA sequences reveal considerable gene prediction inaccuracy in the Plasmodium falciparum genome.</article-title>
        <source>BMC Genomics</source>
        <volume>8</volume>
        <fpage>255</fpage>
        <pub-id pub-id-type="pmid">17662120</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Sorber1">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sorber</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chiu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Webster</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dimon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ruby</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2008</year>
        <article-title>The long march: a sample preparation technique that enhances contig length and coverage by high-throughput short-read sequencing.</article-title>
        <source>PLoS ONE</source>
        <volume>3</volume>
        <fpage>e3495</fpage>
        <pub-id pub-id-type="pmid">18941527</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Pruitt1">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Tatusova</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Maglott</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>NCBI Reference Sequence (RefSeq): a curated non-redundant sequence database of genomes, transcripts and proteins.</article-title>
        <source>Nucl Acids Res</source>
        <volume>33</volume>
        <fpage>D501</fpage>
        <lpage>504</lpage>
        <pub-id pub-id-type="pmid">15608248</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Benson1">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Karsch-Mizrachi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Ostell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <article-title>GenBank: update.</article-title>
        <source>Nucl Acids Res</source>
        <volume>32</volume>
        <fpage>D23</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="pmid">14681350</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Ramskld1">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramsköld</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Burge</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>An abundance of ubiquitously expressed genes revealed by tissue transcriptome sequence data.</article-title>
        <source>PLoS Comput Biol</source>
        <volume>5</volume>
        <fpage>e1000598</fpage>
        <pub-id pub-id-type="pmid">20011106</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Richard1">
      <label>38</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Richard</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Sultan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nürnberger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schrinner</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Prediction of alternative isoforms from exon expression levels in RNA-Seq experiments.</article-title>
        <comment>Nucleic Acids Res Available at: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20150413">http://www.ncbi.nlm.nih.gov/pubmed/20150413</ext-link>. Accessed 1 March 2010</comment>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Crooks1">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crooks</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Hon</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chandonia</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>SE</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <article-title>WebLogo: a sequence logo generator.</article-title>
        <source>Genome Res</source>
        <volume>14</volume>
        <fpage>1188</fpage>
        <lpage>1190</lpage>
        <pub-id pub-id-type="pmid">15173120</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Kent2">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Sugnet</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Furey</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Roskin</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Pringle</surname>
            <given-names>TH</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2002</year>
        <article-title>The Human Genome Browser at UCSC.</article-title>
        <source>Genome Research</source>
        <volume>12</volume>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0013875-Baum1">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baum</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Petrie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Soules</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <year>1970</year>
        <article-title>A Maximization Technique Occurring in the Statistical Analysis of Probabilistic Functions of Markov Chains.</article-title>
        <source>The Annals of Mathematical Statistics</source>
        <volume>41</volume>
        <fpage>164</fpage>
        <lpage>171</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0013875-DeBona1">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Bona</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ossowski</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schneeberger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Rätsch</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Optimal spliced alignments of short sequence reads.</article-title>
        <source>Bioinformatics</source>
        <volume>24</volume>
        <fpage>i174</fpage>
        <lpage>180</lpage>
        <pub-id pub-id-type="pmid">18689821</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
