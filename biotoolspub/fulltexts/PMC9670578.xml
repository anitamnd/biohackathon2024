<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9670578</article-id>
    <article-id pub-id-type="publisher-id">5019</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-05019-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>lmerSeq: an R package for analyzing transformed RNA-Seq data with linear mixed effects models</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3772-1691</contrib-id>
        <name>
          <surname>Vestal</surname>
          <given-names>Brian E.</given-names>
        </name>
        <address>
          <email>vestalb@njhealth.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wynn</surname>
          <given-names>Elizabeth</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moore</surname>
          <given-names>Camille M.</given-names>
        </name>
        <address>
          <email>mooreca@njhealth.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.240341.0</institution-id><institution-id institution-id-type="ISNI">0000 0004 0396 0728</institution-id><institution>Center for Genes, Environment and Health, </institution><institution>National Jewish Health, </institution></institution-wrap>1400 Jackson St, Denver, CO 80206 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.430503.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 0703 675X</institution-id><institution>Department of Biostatistics and Informatics, </institution><institution>University of Colorado Denver, </institution></institution-wrap>Anschutz Medical Campus, Aurora, CO USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>489</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Studies that utilize RNA Sequencing (RNA-Seq) in conjunction with designs that introduce dependence between observations (e.g. longitudinal sampling) require specialized analysis tools to accommodate this additional complexity. This R package contains a set of utilities to fit linear mixed effects models to transformed RNA-Seq counts that properly account for this dependence when performing statistical analyses.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In a simulation study comparing lmerSeq and two existing methodologies that also work with transformed RNA-Seq counts, we found that lmerSeq was comprehensively better in terms of nominal error rate control and statistical power.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Existing R packages for analyzing transformed RNA-Seq data with linear mixed models are limited in the variance structures they allow and/or the transformation methods they support. The lmerSeq package offers more flexibility in both of these areas and gave substantially better results in our simulations.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>RNA-Seq</kwd>
      <kwd>Linear mixed models</kwd>
      <kwd>Correlated data</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100005508</institution-id>
            <institution>Boettcher Foundation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par13">Increasingly, RNA sequencing (RNA-Seq) studies utilize complex designs that induce correlation between observations. Examples include repeatedly measuring subjects over time, sampling related family members, or examining multiple tissue types from the same subject [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>]. As the models used in the most popular R packages, edgeR [<xref ref-type="bibr" rid="CR5">5</xref>] and DESeq2 [<xref ref-type="bibr" rid="CR6">6</xref>], are not appropriate in these scenarios [<xref ref-type="bibr" rid="CR7">7</xref>], several new approaches have been proposed. In general, these methods either (1) model the RNA-Seq counts directly using generalized linear mixed models (GLMMs) [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>], or (2) transform the counts into continuous measures that can then be analyzed using linear mixed models (LMMs) assuming a normal distribution [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. The former approach has the benefit of modeling the RNA-Seq data directly, but model convergence and type 1 error rate control can be problematic at the smaller samples sizes common in RNA-Seq studies, depending on the GLMM estimation approach [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. The alternative of using transformed counts is appealing since LMMs have been extensively studied and are generally faster to fit. However, there are some drawbacks to this strategy as theoretical results show that it is not possible to stabilize variance via <italic>any</italic> transformation when the counts are too small [<xref ref-type="bibr" rid="CR14">14</xref>], and thus the prospect that a mean-variance relationship persists in the transformed data can violate modeling assumptions in the downstream analyses. Moreover, the additional step of transforming the digital counts into a continuous measure has the potential to obscure relationships present in the original count data (e.g. higher power for MCMSeq compared to using linear mixed models on transformed data in [<xref ref-type="bibr" rid="CR8">8</xref>] and more accurate estimates of heritability using GLMMs than with transformed data in [<xref ref-type="bibr" rid="CR15">15</xref>]).</p>
    <p id="Par14">In Vestal et al. [<xref ref-type="bibr" rid="CR8">8</xref>], we proposed the MCMSeq methodology to model correlated RNA-Seq data using a Bayesian hierarchical GLMM. Of the methods compared, MCMSeq best maintained nominal false discovery rates (FDRs) while providing strong sensitivity or statistical power. In addition, LMMs fit to variance stabilizing transformed (VST) data were the only other approach that controlled FDRs at their nominal level. While the sensitivity of this alternative was lower than MCMSeq, LMMs are substantially faster to fit and offer increased modeling flexibility compared to the current version of the mcmseq R package through the use of multiple random effects and correlation structures for residual errors. Consequently, we have developed the lmerSeq R package to fit gene-specific LMMs to transformed RNA-Seq data and easily generate results tables for either single regression coefficients or linear combinations of regression coefficients (contrasts). As an example that illustrates how the choices of transformation, model structure, and testing procedure can drastically alter inference, we compare the results from the VST-lmerSeq pipeline to two similar methods that rely on the VOOM transform: DREAM from the VariancePartion package and rmRNAseq from the eponymous package [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Model</title>
      <p id="Par15">Like other transformation based approaches, lmerSeq uses a linear mixed model framework to analyze normalized counts. Let <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}}_{gi} = \{Y_{gi1},\ldots , Y_{gin_{i}}\}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gi</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq1.gif"/></alternatives></inline-formula> be a vector of transformed expression values for gene <italic>g</italic> from subject <italic>i</italic> at observations 1 to <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{i}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq2.gif"/></alternatives></inline-formula>. Transformed expression is modeled using a LMM framework, so that <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}}_{gi} = {\varvec{X}}_{i}{\varvec{\beta }}_{{\varvec{g}}} + {\varvec{Z}}_{i}{\varvec{b}}_{{\varvec{gi}}} + {\varvec{\epsilon }}_{gi}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gi</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">gi</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gi</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq3.gif"/></alternatives></inline-formula>. Here, <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta }}_{{\varvec{g}}}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq4.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p \times 1$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq5.gif"/></alternatives></inline-formula> vector of fixed effect regression coefficients for gene <italic>g</italic>, <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}_{i}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq6.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{i} \times p$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq7.gif"/></alternatives></inline-formula> matrix of fixed effects covariates for subject <italic>i</italic>, <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{b}}_{gi}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gi</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq8.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q \times 1$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>q</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq9.gif"/></alternatives></inline-formula> vector of random effects for gene <italic>g</italic> and subject <italic>i</italic>, <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Z}}_{i}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq10.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{i} \times q$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq11.gif"/></alternatives></inline-formula> matrix of random effect covariates for subject <italic>i</italic>, and <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\epsilon }}_{gi}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gi</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq12.gif"/></alternatives></inline-formula> is a a <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{i} \times 1$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq13.gif"/></alternatives></inline-formula> vector of normally distributed residual error terms with mean 0 and covariance <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _{g}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq14.gif"/></alternatives></inline-formula>.</p>
      <p id="Par16">This model can account for correlation between samples in two ways, through the use of random effects (i.e. using <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Z}}_{i}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{b}}_{gi}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gi</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq16.gif"/></alternatives></inline-formula>) or through the covariance structure for the error terms, <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _g$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq17.gif"/></alternatives></inline-formula>. DREAM utilizes random effects, while rmRNAseq models the residual correlation directly by assuming a continuous autoregressive framework (CAR) for <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _{g}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq18.gif"/></alternatives></inline-formula> without the inclusion of random effects. Both of rmRNAseq and DREAM use the VOOM transformation, which estimates a mean-variance relationship for log-transformed counts in conjunction with a precision weight for each observation. lmerSeq allows either random effects or modeling of <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _g$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq19.gif"/></alternatives></inline-formula> directly using a variety of covariance structures. While the lmerSeq functions are general enough to handle any data transformation (and weights), in the results presented below we utilized the VST available from the DESeq2 package to remove the relationship between the mean and variance, producing data that are approximately log<sub>2</sub> scaled [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    </sec>
    <sec id="Sec4">
      <title>lmerSeq R package</title>
      <p id="Par17">The lmerSeq package is written entirely in R and interfaces with the lme4, lmerTest, and nlme packages to fit the gene-specific LMMs [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref>]. lmerSeq users can fit models including multiple random effects, implement several of the correlation structures available in the nlme R package, perform a variety of tests, including constructing contrasts and simultaneous tests of multiple regression coefficients, and utilize multiple methods for calculating denominator degrees of freedom for F- and t-tests. Specifically, there are two model fitting functions, one that interfaces with lmerTest R package to fit linear mixed models with random effects and another that interfaces with the nlme R package to fit models with non-independent error covariance structures. In the former, any combination of random effects that are supported by lme4 can be used (e.g. random intercept, random slope, nested and/or crossed random effects, etc.), while in the latter support for compound symmetric and unstructured residual covariance structures is available. Parallel computing is supported on Mac and Linux operating systems via forking through the mclapply function from the Parallel R package. For both versions of the model fitting functions we have implemented summary functions that return results in a similar format to other RNA-Seq analysis packages like edgeR and DESeq2. These summaries can be made for individual regression coefficients, simple linear contrasts (i.e. one dimensional contrasts with t-tests), or simultaneous tests of multiple regression coefficients or linear contrasts with F-tests. The lmerTest package offers both Satterthwaite and Kenward-Rogers methods for calculating degrees of freedom for test statistics, both of which are supported in lmerSeq models with random effects. We have also implemented the Satterthwaite method for use with the two correlation structures supported from the nlme package. In combination, the fit and summary functions also allow the users to run various model diagnostics. The summary function identifies genes that had singular fits (e.g. the random intercept variance was estimated to be 0), and an option allows the user to exclude these genes from the results tables. The list returned by the fitting function stores the complete fit objects for each individual gene, and this allows the user access to a myriad of diagnostic options available from various other R packages, including testing the residuals for heteroskedasticity and/or normality. Finally, the package contains a detailed vignette with several examples using simulated data.</p>
    </sec>
    <sec id="Sec5">
      <title>Simulation study</title>
      <p id="Par18">To compare error rate control and sensitivity, we conducted a comprehensive simulation study considering 2 basic study designs: (1) a 2 group (e.g. treatment and control) design with paired observations (baseline and follow up) for each subject; and (2) a 2 group design with repeated measurements at 4 time points for each subject. In both cases, we simulated RNA-Seq counts from a negative binomial GLMM as follows:<disp-formula id="Equ1"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_{gij}\sim &amp; {} {\mathcal{N}\mathcal{B}}(\mu _{gij}, \alpha _{g}) \\ \log (\mu _{gij})= &amp; {} \beta _{g0} + \beta _{g1} I_{T_{i}} + \beta _{g2}t_{ij} + \beta _{g3}I_{T_{i}} t_{ij} + {\varvec{Z}}_{ij}{\varvec{b}}_{gi} \\ {\varvec{b}}_{gi}\sim &amp; {} {\mathcal {N}}(0, \Sigma _{gb}) \end{aligned}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">gij</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mi mathvariant="script">B</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gi</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gi</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gb</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_5019_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{gij}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">gij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq21.gif"/></alternatives></inline-formula> is the observed counts of gene <italic>g</italic> for subject <italic>i</italic> at observation <italic>j</italic>, <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{T_{i}}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq22.gif"/></alternatives></inline-formula> is a treatment group indicator for subject <italic>i</italic> that equals 1 if the subject is in the treatment group and 0 else, <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{ij}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq23.gif"/></alternatives></inline-formula> is the observation time (0 for baseline and 1 for the single follow up in simulation scenario 1 and 1–3 for the 3 follow up time points in scenario 2). For each of the sample sizes evaluated (N = 3, 5, 10, or 20 per group), 10 datasets with approximately 15k genes each were simulated using triplets of baseline expression (<inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{g0}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq24.gif"/></alternatives></inline-formula>), random intercept variance (<inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _{gb}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gb</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq25.gif"/></alternatives></inline-formula>), and dispersion (<inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _{g}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>α</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq26.gif"/></alternatives></inline-formula>) estimated from multiple human RNA-Seq datasets with repeated measures [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR20">20</xref>].</p>
      <p id="Par19">In Simulation Scenario 1, a random intercept was used to create correlation between the repeated measures, while Scenario 2 utilized both a random intercept and slope, with the standard deviation of the random slope set to 30% of the random intercept standard deviation, resulting in a more complex correlation structure. <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{g1}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq27.gif"/></alternatives></inline-formula> and <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{g2}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq28.gif"/></alternatives></inline-formula> were set to 0. In each dataset, we simulated differential expression for 20% of the genes by setting <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{g3} \ne 0$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq29.gif"/></alternatives></inline-formula> as follows: for Scenario 1, we drew <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{g3}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq30.gif"/></alternatives></inline-formula> values from a gamma distribution with a mode of log(2) and a standard deviation of 0.5 that were then randomly assigned to be positive or negative; in Simulation Scenario 2, we randomly assigned <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{g3}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq31.gif"/></alternatives></inline-formula> to either 0.375 or − 0.375. This created a change in expression over time for subjects in the treatment group for 20% of genes.</p>
      <p id="Par20">Simulated data for both scenarios were modeled using DREAM, lmerSeq using random effects, lmerSeq using covariance structures, and rmRNAseq. In Scenario 1, all models were fit with the same fixed effects (group, time and a group-by-time interaction). Both DREAM and lmerSeq (RI) were fit using a random intercept, while lmerSeq (CS) utilized a compound symmetric residual correlation structure instead of random effects. Even though rmRNAseq only allows a CAR structure, with only two observations separated by a single unit of time this is equivalent to a compound symmetric structure. Therefore, all of the methods were fit with with a correctly specified model in Scenario 1.</p>
      <p id="Par21">In Scenario 2, we fit a variety of models using different combinations of fixed and random effects to compare the methods’ performance under the correct model specification, misspecified random effects or covariance structures, and different fixed effects modeling strategies. We considered two fixed effects modeling strategies: one using a continuous time predictor and its interaction with the binary group variable, and another using categorical time and its interaction with group. While both models are correctly specified, the first model assumes linear changes in expression over time. The second approach does not make assumptions about the pattern of change over time, but uses additional degrees of freedom due to the inclusion of multiple time point indicator variables and their associated group interaction terms in the regression model. For rmRNAseq, only the CAR correlation structure is available, though this model is supposed to be robust to misspecification since an unstructured covariance matrix is used for some portions of the model fitting and testing algorithm [<xref ref-type="bibr" rid="CR11">11</xref>]. With DREAM and lmerSeq, we considered models including only a random intercept and models including both a random intercept and random slope. For lmerSeq, we also fit models using categorical time fixed effects and an unstructured covariance matrix as a flexible alternative to including random effects.</p>
      <p id="Par22">We evaluated type 1 error rates, power (sensitivity) and False Discovery Rates (FDRs) for three statistical tests: a between-subject contrast (difference between groups at the last follow-up visit), a within-subject contrast (change over time in the treatment group), and an interaction test (difference in change over time between the two groups). Inference for DREAM and lmerSeq was based on t-tests using Satterthwaite degrees of freedom. Adjusted <italic>p</italic> values were obtained using the Benjamini–Hochberg method, and these were used for calculating observed FDRs and sensitivities at various thresholds [<xref ref-type="bibr" rid="CR21">21</xref>]. rmRNAseq calculates <italic>p</italic> values based on a bootstrap approach (we used 100 iterations as suggested in the package vignette) after calculating moderated F-statistics, and then q-values for FDR control based on the methods of [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. However, we applied the Benjamini–Hochberg method to the raw <italic>p</italic> values returned by rmRNAseq to ensure that any differences observed between this method and the others could not be attributed to using an alternative strategy for multiple comparisons adjustments.</p>
    </sec>
    <sec id="Sec6">
      <title>Case study</title>
      <p id="Par23">To assess the performance of these analysis methods in a realistic setting, we analyzed a publicly available dataset (GEO Dataset: GSE131411) including RNA-Seq of whole blood from 11 cardiogenic shock patients at three time points: (1) within 16 h of intensive care unit admission, (2) 48 h after admission, and (3) 7 days after admission or at discharge. This study has been fully described in Braga et al. [<xref ref-type="bibr" rid="CR4">4</xref>]. We used lmerSeq, DREAM, and rmRNAseq to compare gene expression between the three time points. We limited our analysis to 13,123 genes with at least 1 count per million reads in 11 of the 33 samples. For lmerSeq and DREAM, a random intercept was used to account for correlation between repeated measures, and categorical time was the only fixed effect included in the models. All other aspects of the analysis were performed as described for Simulation Scenario 1 using the default settings for each method. Raw <italic>p</italic> values were adjusted using the Benjamini–Hochberg method to control the FDR.</p>
      <p id="Par24">To further understand the statistical testing properties of these methods in a more realistic setting, we also utilized this data to perform simulations using a permutation method. This allowed for simulated datasets that could be generated with characteristics of real RNA-Seq data without relying on distributional assumptions for the underlying count data. In addition, these data have an unknown correlation structure between repeated measurements on the same subject. To create a simulated dataset, ten subjects were randomly selected for inclusion. For five of the subjects, the labels were switched for the baseline and 1 week follow up time points, so there would be no expected differential expression between these two time points. Then, for 2600 randomly selected genes, differential expression was created by multiplying the counts at the 1 week follow up by either 2 (50%) or 0.5 (other 50%). Ten simulated datasets were created and analyzed as described above for the formal analysis of the original data, and FDR and power were calculated across the 10 simulations and averaged for each method.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results</title>
    <sec id="Sec8">
      <title>Run times</title>
      <p id="Par25">Table <xref rid="Tab1" ref-type="table">1</xref> has the average run times for the correctly specified version of each method at each sample size in Simulation Scenario 2. These times include all of the steps needed to go from the raw RNA-Seq counts to the transformed values used for analysis, and all the way through generating the final summary tables. Where possible, parallelization was utilized for each method with 4 cores being allocated for computations. In all scenarios, lmerSeq was the fastest method. The increased computation time for DREAM was largely due to the time needed to calculate the precision weights for their modified VOOM transformation which also requires the fitting of LMMs for each gene; the VST used for lmerSeq generally only took a few seconds. The rmRNAseq runtimes were orders of magnitude longer than either lmerSeq or DREAM due to the reliance on re-sampling for calculating <italic>p</italic> values with the smallest datasets taking over 7 h to analyze compared to about 6 and 10 min for lmerSeq and DREAM respectively.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Runtimes in minutes at all sample sizes for the correctly specified version of each method in Simulation 2</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">N per group</th><th align="left">lmerSeq</th><th align="left">DREAM</th><th align="left">rmRNAseq</th></tr></thead><tbody><tr><td align="left">3</td><td align="left">5.58</td><td align="left">10.72</td><td align="left">426.14</td></tr><tr><td align="left">5</td><td align="left">5.60</td><td align="left">11.03</td><td align="left">455.76</td></tr><tr><td align="left">10</td><td align="left">5.68</td><td align="left">11.30</td><td align="left">602.53</td></tr><tr><td align="left">20</td><td align="left">6.08</td><td align="left">11.50</td><td align="left">751.97</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec9">
      <title>Error rates and sensitivity</title>
      <p id="Par26">For Simulation Scenario 1 with two repeated measures per subject, the relationship between FDR control and sensitivity at the 0.05 FDR level is presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref> (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S1–S2 for the 0.01 and 0.10 FDR levels). In this scenario, DREAM, lmerSeq and rmRNAseq models are all correctly specified. DREAM has slightly inflated FDRs at <inline-formula id="IEq34"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=3$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq34.gif"/></alternatives></inline-formula>, with FDR inflation becoming substantially worse with increasing sample size. In contrast, rmRNAseq is highly conservative at almost all sample sizes and is typically the least sensitive method. lmerSeq is always slightly below the nominal FDR with values converging to the expected FDR as sample size increases. Moreover, lmerSeq is almost uniformly more powerful than rmRNAseq and often achieves higher power than DREAM, despite the fact that DREAM has inflated FDRs. The two versions of lmerSeq, which are modeling the same covariance structure in slightly different ways, offer nearly identical results with minor inconsistencies likely due to differences in numerical estimation methods in the nlme and lme4 R packages.<fig id="Fig1"><label>Fig. 1</label><caption><p>Scatter plot of sensitivity by log<inline-formula id="IEq32"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_2$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow/><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq32.gif"/></alternatives></inline-formula> of the relative false discovery rate (FDR) for each type of test at each sample size at the 0.05 level in Simulation 1. The dashed vertical line represents the nominal rate, while the dotted vertical line represents the expected FDR. <italic>RI</italic> random intercept, <italic>CS</italic> compound symmetric covariance matrix</p></caption><graphic xlink:href="12859_2022_5019_Fig1_HTML" id="MO2"/></fig></p>
      <p id="Par27">The distribution of the <italic>p</italic> values from all of the “null” genes for each of the three tests are displayed for the <inline-formula id="IEq35"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=5$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq35.gif"/></alternatives></inline-formula> simulations in Fig. <xref rid="Fig2" ref-type="fig">2</xref> (other sample size are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S3–S5). Under the null hypothesis, well calibrated <italic>p</italic> values for these features should follow a uniform distribution; however, DREAM exhibits an overabundance of <italic>p</italic> values close to zero, corresponding to the inflated error rates. Again, this problem becomes worse with increasing sample size. For rmRNAseq, we see the opposite behavior, with fewer small <italic>p</italic> values than expected, corresponding to the overly conservative observed error rates and lower sensitivity than the other methods. Conversely, the distributions for both versions of lmerSeq are nearly uniform by <inline-formula id="IEq36"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=5$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq36.gif"/></alternatives></inline-formula>.<fig id="Fig2"><label>Fig. 2</label><caption><p>Histograms of the <italic>p</italic> values for the null features across all datasets in Simulation 1 with <inline-formula id="IEq33"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=5$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq33.gif"/></alternatives></inline-formula> subjects per group. <italic>RI</italic> random intercept, <italic>CS</italic> compound symmetric covariance matrix</p></caption><graphic xlink:href="12859_2022_5019_Fig2_HTML" id="MO3"/></fig></p>
      <p id="Par28">In the second simulation scenario with four repeated measures per subject and both a random intercept and slope, we are able to consider the impact of misspecification of the random effect or correlation structure, as well as different fixed effects modeling strategies. First we consider models where time is modeled as a continuous variable. In models with correctly specified random effects structure (Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S6–S8), including both a random intercept and slope, performance was similar to Simulation Scenario 1: lmerSeq approached the expected FDR with increasing sample size, while DREAM showed greater FDR inflation with increasing sample size. In models with a misspecified random effects structure (including a random intercept only), FDR is increased relative to the models with correctly specified random effects for both lmerSeq and DREAM, consistent with previous findings that random effects misspecification can result in increased numbers of false positives (Fig. <xref rid="Fig4" ref-type="fig">4</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S6–S8) [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref>]. rmRNAseq, which uses a CAR covariance structure, remains overly conservative with noticeably lower sensitivity in most scenarios, although FDR inflation is seen for between-subject and interaction tests at the smallest sample size (<inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=3$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq37.gif"/></alternatives></inline-formula> per group).<fig id="Fig3"><label>Fig. 3</label><caption><p>Scatter plot of sensitivity by log<inline-formula id="IEq40"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_2$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mrow/><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq40.gif"/></alternatives></inline-formula> of the relative false discovery rate (FDR) for each type of test at each sample size at the 0.05 level for the models with correct (or as close as possible given method constraints) specification of both the fixed and random effects in Simulation 2. The dashed vertical line represents the nominal rate, while the dotted vertical line represents the expected FDR. <italic>Cont</italic> continuous time, <italic>RI</italic> random intercept, <italic>RS</italic> random slope, <italic>CAR</italic> continuous auto regressive</p></caption><graphic xlink:href="12859_2022_5019_Fig3_HTML" id="MO4"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Scatter plot of sensitivity by log<inline-formula id="IEq41"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_2$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mrow/><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq41.gif"/></alternatives></inline-formula> of the relative false discovery rate (FDR) for each type of test at each sample size at the 0.05 level for the models with some misspecification of fixed and/or random effects in Simulation 2. The dashed vertical line represents the nominal rate, while the dotted vertical line represents the expected FDR. <italic>Cont</italic> continuous time, <italic>Cat</italic> categorical time, <italic>RI</italic> random intercept, <italic>RS</italic> random slope, <italic>UN</italic> unstructured covariance matrix, <italic>CAR</italic> continuous auto regressive covariance matrix</p></caption><graphic xlink:href="12859_2022_5019_Fig4_HTML" id="MO5"/></fig></p>
      <p id="Par29">Next we considered models coding time as a categorical factor, represented by three indicator variables, which allows gene expression to change flexibly over time (Fig. <xref rid="Fig4" ref-type="fig">4</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S6–S8). This approach is likely to be used in practice as the assumption of linear changes in gene expression over time often may not be reasonable. rmRNAseq’s FDRs remain very conservative for all tests, resulting in reduced power to detect associations. For DREAM and lmerSeq using just a random intercept, FDRs are inflated relative to a model with correctly specified random effects structure for between and interaction tests for DREAM and for all three tests for lmerSeq. For DREAM, FDRs were similar to continuous time models with a random intercept only for interaction tests, higher for between subject tests, and lower for within subject tests. For lmerSeq, FDRs were similar or smaller compared to the continuous time models with a random intercept only. For lmerSeq, we also considered a completely flexible model using categorical time and an unstructured covariance matrix. This model has several more parameters to estimate compared to a model using continuous time and a random intercept and slope (4 additional regression coefficients + 8 additional covariance parameters). For small sample sizes (<inline-formula id="IEq38"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=3$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq38.gif"/></alternatives></inline-formula>), FDRs are above their nominal levels, likely due to over-fitting of the data; however, as sample size increases, FDR converges towards the nominal rate. This suggests that if there are sufficient numbers of subjects, this flexible approach may help safeguard against false positives due to model misspecification.</p>
      <p id="Par30">The <italic>p</italic> value histograms for the truly “null” features in Simulation Scenario 2 are presented for <inline-formula id="IEq39"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=10$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq39.gif"/></alternatives></inline-formula> in Fig. <xref rid="Fig5" ref-type="fig">5</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9 with other sample sizes presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S10–S12. As in Simulation Scenario 1, lmerSeq with the proper specification of fixed and random effects has nearly uniform distributions for each contrast. DREAM and rmRNAseq have significant right and left skew to their respective distributions, corresponding to the observed error rate control with DREAM having inflated FDRs and rmRNAseq being conservative. Since there was no correlation between the counts for any two genes in the simulated data, all of the tests within a given contrast are independent. Consequently, the divergences from uniformity in the <italic>p</italic> value histograms for both DREAM and rmRNAseq suggest that the assumed distributions for the test statistics are incorrect, and thus the resulting <italic>p</italic> values are not reliable [<xref ref-type="bibr" rid="CR27">27</xref>].<fig id="Fig5"><label>Fig. 5</label><caption><p>Histograms of the <italic>p</italic> values for the null features across all datasets in Simulation 2 for the models with the most correct specification of fixed and random effects at <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=10$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq42.gif"/></alternatives></inline-formula> subjects per group. For both DREAM and lmerSeq the fixed and random effects structures were able to exactly match the simulated data, while rmRNAseq could only match the correct fixed effects since it only offers CAR for modeling correlation between observations. <italic>Cont</italic> continuous time, <italic>RI</italic> random intercept, <italic>RS</italic> random slope, <italic>CAR</italic> continuous auto regressive</p></caption><graphic xlink:href="12859_2022_5019_Fig5_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>Case study</title>
      <p id="Par31">Table <xref rid="Tab2" ref-type="table">2</xref> shows a comparison the results of the analyses from each method. An advantage of lmerSeq is that it automatically reports and excludes singularities from tables of results and full model fits are returned, so a variety of existing R packages can be used to assess model fit. In this analysis, a small percentage of the lmerSeq model fits were singular (1.5%) and were excluded from the results. Since DREAM does not do any such reporting and exclusion of genes with singular fits, we refit all of the models using lmerSeq with weights to analyze the VOOM transformed data and found that almost 100 singular fits were also included in the DREAM results. To evaluate whether modeling assumptions were met, we used Levene’s method to test for equality of variance between time points and a Kolmogorov-Smirnov test for normality of scaled residuals. For lmerSeq, 1.6% of genes had unadjusted Levine test <italic>p</italic> values less than 0.05, compared to 1.1% for DREAM; after taking a multiple comparisons adjustment, none of the genes showed significant heteroskedasticity in the residuals for either method. Less than 0.2% of models had Kolmogorov–Smirnov test <italic>p</italic> values less than 0.05; after adjusting for multiple comparisons none of the models showed significant deviations from normality. None of the preceding diagnostics are possible with rmRNAseq.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Summary of model diagnostics and differential expression for each method when applied to the real RNA-Seq data from the case study</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">lmerSeq</th><th align="left">DREAM</th><th align="left">rmRNAseq</th></tr></thead><tbody><tr><td align="left">Singular fits</td><td align="left">200 (1.5%)</td><td align="left">96 (0.7%)*</td><td align="left">Not available</td></tr><tr><td align="left">Levene’s test for heteroskedsticity</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"> <italic>p</italic> vaule <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.05$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq43.gif"/></alternatives></inline-formula></td><td align="left">206 (1.6%)</td><td align="left">149 (1.1%)</td><td align="left">Not available</td></tr><tr><td align="left"> BH adjusted <italic>p</italic> value <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.05$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq44.gif"/></alternatives></inline-formula></td><td align="left">0</td><td align="left">0</td><td align="left">Not available</td></tr><tr><td align="left">Kolmogorov–Smirnov test for normality</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"> <italic>p</italic> value <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.05$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq45.gif"/></alternatives></inline-formula></td><td align="left">24 (0.2%)</td><td align="left">17 (0.1%)</td><td align="left">Not available</td></tr><tr><td align="left"> BH adjusted <italic>p</italic> value <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.05$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq46.gif"/></alternatives></inline-formula></td><td align="left">0</td><td align="left">0</td><td align="left">Not available</td></tr><tr><td align="left">Number of DEGs</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"> 48 h versus baseline</td><td align="left">1</td><td align="left">0</td><td align="left">0</td></tr><tr><td align="left"> 1 week versus baseline</td><td align="left">1452</td><td align="left">1828</td><td align="left">142</td></tr><tr><td align="left"> 1 week versus 48 h</td><td align="left">362</td><td align="left">476</td><td align="left">182</td></tr></tbody></table><table-wrap-foot><p><italic>BH</italic> Benjamini–Hochberg, <italic>DEGs</italic> differentially expressed genes</p><p>*Models had to be refit with lmerSeq using weights since DREAM does not report or exclude singular fits</p></table-wrap-foot></table-wrap></p>
      <p id="Par32">In terms of the number of differentially expressed genes (DEGs), results were largely consistent with what would be expected based on our simulation studies. For brevity, we will focus on the differences in expression between baseline and the 1 week follow up, which had the largest number of DEGs. rmRNAseq found relatively few DEGs compared to the other two methods, aligning with the overly conservative behavior noted in our simulation study, while DREAM, which had inflated false discovery rates, found the largest number of DEGs. We performed functional enrichment analysis on the up and down regulated genes from lmerSeq using enrichR and the BioPlanet 2019 database [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. Genes upregulated at 1 week compared to baseline were enriched for pathways related to cell cycle and the complement cascade, while down regulated genes were enriched for pathways related to innate immunity and inflammation.</p>
      <p id="Par33">Results for the permutation-based simulation study using the real RNA-Seq data are presented in Table <xref rid="Tab3" ref-type="table">3</xref> when using a 5% FDR threshold to identify differential expression. Similar to our other simulation studies, DREAM had inflated FDRs (more than double the nominal rate), while lmerSeq maintained the nominal 5% FDR while also having higher power than DREAM. rmRNAseq had a slightly conservative FDR and lower power than the other methods in this simulation.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Summary of the observed false discovery rates (FDR) and power from the permutation based simulations using the real RNA-Seq data from the case study</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left">FDR</th><th align="left">Power</th></tr></thead><tbody><tr><td align="left">lmerSeq</td><td align="left">0.051</td><td align="left">0.912</td></tr><tr><td align="left">DREAM</td><td align="left">0.114</td><td align="left">0.900</td></tr><tr><td align="left">rmRNAseq</td><td align="left">0.036</td><td align="left">0.883</td></tr></tbody></table><table-wrap-foot><p>Values presented are the means taken across the 10 simulated datasets when using a nominal FDR of 0.05 to identify differential expression</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Conclusions</title>
    <p id="Par34">Accounting for repeated measures in RNA-Seq studies by transforming the digital counts and then fitting normal LMMs is an appealing analysis strategy due to the well-established theoretical work surrounding LMMs and their computational efficiency compared to GLMMs. However, the selection of the transformation, modeling strategy, and the type of statistical test used can drastically alter the results. Both DREAM and rmRNAseq utilize the VOOM transformation, but fit LMMs in different ways and use different strategies to compute test statistics and <italic>p</italic> values. This leads to divergent behavior in our simulation studies, with DREAM exhibiting substantial FDR inflation and rmRNAseq being overly conservative. Though rmRNAseq did show improvement going from <inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=10$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq47.gif"/></alternatives></inline-formula> to <inline-formula id="IEq48"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=20$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5019_Article_IEq48.gif"/></alternatives></inline-formula> in some scenarios, both methods tended to perform worse in terms of FDR control with increasing sample size, which is concerning. Since DREAM and lmerSeq are capable of fitting similar LMMs and we fit many of the same model structures with both methods, it appears that the driving force behind the differential behavior between lmerSeq and DREAM is the choice of transformation, with lmerSeq utilizing DESeq2’s VST and DREAM using their own modification of VOOM. Interestingly, the VST has also shown superior performance compared to VOOM when estimating heritability for sequencing data, with those methods also being based on linear mixed model fits [<xref ref-type="bibr" rid="CR15">15</xref>]. Regardless of the causes for the differences in behavior between the methods, we found lmerSeq had the best control of FDRs (i.e. closest to nominal and expected levels), generally had the highest sensitivity, and had the shortest run times. This was evident over multiple simulation scenarios with some being based on common distributional assumptions used in RNA-Seq analysis, and others based solely on real RNA-Seq data from a study with repeated measures where no additional assumptions about distributions or covariance structures were made. Moreover, our case study results also align with the general behavior observed in the simulations studies. The lmerSeq R package offers more flexibility than either DREAM or rmRNAseq in terms of allowing for multiple random effects and a variety of correlation structures, which can help guard against false positives due to model misspecification. Additionally, lmerSeq allows for greater scrutiny of modeling assumptions by identifying singular fits and gives the user the ability to test for heteroskedasticity, normality, or any other diagnostics available for nlme or lme4 objects. Ultimately, the totality of our results suggest that using lmerSeq in conjunction with the VST is currently the most complete and reliable source of inference for analyzing transformed bulk RNA-Seq data from studies that require the analyst to account for correlation between observations.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec12">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_5019_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Supplementary figures</bold> S1–S12.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CAR</term>
        <def>
          <p id="Par4">Continuous autoregressive</p>
        </def>
      </def-item>
      <def-item>
        <term>CS</term>
        <def>
          <p id="Par5">Compound symmetric</p>
        </def>
      </def-item>
      <def-item>
        <term>DEGs</term>
        <def>
          <p id="Par6">Differentially expressed genes</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p id="Par7">False discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>GLMM</term>
        <def>
          <p id="Par8">Generalized linear mixed model</p>
        </def>
      </def-item>
      <def-item>
        <term>LMM</term>
        <def>
          <p id="Par9">Linear mixed model</p>
        </def>
      </def-item>
      <def-item>
        <term>RI</term>
        <def>
          <p id="Par10">Random ntercept</p>
        </def>
      </def-item>
      <def-item>
        <term>RNA-Seq</term>
        <def>
          <p id="Par11">RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>VST</term>
        <def>
          <p id="Par12">Variance stabilizing transformation</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1186/s12859-022-05019-9.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>None.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>BEV, EW, and CMM contributed significantly to the development of the model, the simulations, the software, the R package, and the writing of the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>CMM and EW were funded by a Webb-Waring Early Career Investigator Award from the Boettcher Foundation, which was awarded to CMM to develop and test statistical methods for longitudinal RNA-sequencing data. The Boettcher Foundation did not play a role in the study design, collection, analysis or interpretation of the data.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Simulated datasets and the code used to produce the results presented in this paper are available at https://github.com/stop-pre16/lmerSeq-paper-data-and-code</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par35">Not applicable</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par36">Not applicable</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par37">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hammarström</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rønnestad</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Ellefsen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ahmad</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Increased biological relevance of transcriptome analyses in human skeletal muscle using a model-specific pipeline</article-title>
        <source>BMC Bioinform</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>32</lpage>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leach</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Gibbings</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Tewari</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Atif</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Vestal</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Danhorn</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Janssen</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Wager</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Jakubzick</surname>
            <given-names>CV</given-names>
          </name>
        </person-group>
        <article-title>Human and mouse transcriptome profiling identifies cross-species homology in pulmonary and lymph node mononuclear phagocytes</article-title>
        <source>Cell Rep</source>
        <year>2020</year>
        <volume>33</volume>
        <issue>5</issue>
        <fpage>108337</fpage>
        <?supplied-pmid 33147458?>
        <pub-id pub-id-type="pmid">33147458</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Singhania</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Verma</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tran</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lecine</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Leissner</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Berry</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Wilkinson</surname>
            <given-names>RJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A modular transcriptional signature identifies phenotypic heterogeneity of human tuberculosis infection</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="pmid">29317637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Braga</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Barcella</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Herpain</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aletti</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kistler</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Bollen Pinto</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bendjelid</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Barlassina</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A longitudinal study highlights shared aspects of the transcriptomic response to cardiogenic and septic shock</article-title>
        <source>Crit Care</source>
        <year>2019</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="pmid">30606235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR: a bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <?supplied-pmid 19910308?>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>1</fpage>
        <lpage>21</lpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cui</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>What if we ignore the random effects when analyzing RNA-seq data in a multifactor experiment</article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2016</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>87</fpage>
        <lpage>105</lpage>
        <?supplied-pmid 26926865?>
        <pub-id pub-id-type="pmid">26926865</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vestal</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Wynn</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Saba</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fingerlin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kechris</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Mcmseq: Bayesian hierarchical modeling of clustered and repeated measures RNA sequencing experiments</article-title>
        <source>BMC Bioinform</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>20</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bian</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Pairedfb: a full hierarchical Bayesian model for paired RNA-seq data with heterogeneous treatment effects</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>5</issue>
        <fpage>787</fpage>
        <lpage>797</lpage>
        <?supplied-pmid 30753300?>
        <pub-id pub-id-type="pmid">30753300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van de Wiel</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Neerincx</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Buffart</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Sie</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Verheul</surname>
            <given-names>HM</given-names>
          </name>
        </person-group>
        <article-title>Shrinkbayes: a versatile r-package for analysis of count-based sequencing data in complex study designs</article-title>
        <source>BMC Bioinform</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>7</lpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nettleton</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>rmrnaseq: differential expression analysis for repeated-measures RNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>16</issue>
        <fpage>4432</fpage>
        <lpage>4439</lpage>
        <?supplied-pmid 32449749?>
        <pub-id pub-id-type="pmid">32449749</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoffman</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Roussos</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Dream: powerful differential expression analysis for repeated measures designs</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>37</volume>
        <fpage>192</fpage>
        <lpage>201</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wynn</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Vestal</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Fingerlin</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>A comparison of methods for multiple degree of freedom testing in repeated measures RNA-sequencing experiments</article-title>
        <source>BMC Med Res Methodol</source>
        <year>2022</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="pmid">34991473</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warton</surname>
            <given-names>DI</given-names>
          </name>
        </person-group>
        <article-title>Why you cannot transform your way out of trouble for small counts</article-title>
        <source>Biometrics</source>
        <year>2018</year>
        <volume>74</volume>
        <issue>1</issue>
        <fpage>362</fpage>
        <lpage>368</lpage>
        <?supplied-pmid 28504821?>
        <pub-id pub-id-type="pmid">28504821</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rudra</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Vestal</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Russell</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Odell</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dowell</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Radcliffe</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Saba</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Kechris</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Model based heritability scores for high-throughput sequencing data</article-title>
        <source>BMC Bioinform</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>voom: Precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>1</fpage>
        <lpage>17</lpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bates</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sarkar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Matrix</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>The lme4 package</article-title>
        <source>R Package Vers</source>
        <year>2007</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>74</fpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuznetsova</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brockhoff</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Christensen</surname>
            <given-names>RHB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Package ‘lmertest’</article-title>
        <source>R Package Vers</source>
        <year>2015</year>
        <volume>2</volume>
        <fpage>734</fpage>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Pinheiro J, Bates D, DebRoy S, Sarkar D, R Core Team. Nlme: linear and nonlinear mixed effects models. R package version 3.1-143. 2019. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=nlme">https://CRAN.R-project.org/package=nlme</ext-link></mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenberg</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Depla</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Freije</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Gaucher</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mazouz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Boisvert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bédard</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bruneau</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rice</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Shoukry</surname>
            <given-names>NH</given-names>
          </name>
        </person-group>
        <article-title>Longitudinal transcriptomic characterization of the immune response to acute hepatitis C virus infection in patients with spontaneous viral clearance</article-title>
        <source>PLoS Pathog</source>
        <year>2018</year>
        <volume>14</volume>
        <issue>9</issue>
        <fpage>1007290</fpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc Ser B (Methodol)</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>A direct approach to false discovery rates</article-title>
        <source>J R Stat Soc Ser B (Stat Methodol)</source>
        <year>2002</year>
        <volume>64</volume>
        <issue>3</issue>
        <fpage>479</fpage>
        <lpage>498</lpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nettleton</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Caldo</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Wise</surname>
            <given-names>RP</given-names>
          </name>
        </person-group>
        <article-title>Estimating the number of true null hypotheses from a histogram of p values</article-title>
        <source>J Agric Biol Environ Stat</source>
        <year>2006</year>
        <volume>11</volume>
        <issue>3</issue>
        <fpage>337</fpage>
        <lpage>356</lpage>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barr</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Levy</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Scheepers</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tily</surname>
            <given-names>HJ</given-names>
          </name>
        </person-group>
        <article-title>Random effects structure for confirmatory hypothesis testing: keep it maximal</article-title>
        <source>J Mem Lang</source>
        <year>2013</year>
        <volume>68</volume>
        <issue>3</issue>
        <fpage>255</fpage>
        <lpage>278</lpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LeBeau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>YA</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>WC</given-names>
          </name>
        </person-group>
        <article-title>Model misspecification and assumption violations with the linear mixed model: a meta-analysis</article-title>
        <source>SAGE Open</source>
        <year>2018</year>
        <volume>8</volume>
        <issue>4</issue>
        <fpage>2158244018820380</fpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matuschek</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kliegl</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vasishth</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Baayen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Balancing type I error and power in linear mixed models</article-title>
        <source>J Mem Lang</source>
        <year>2017</year>
        <volume>94</volume>
        <fpage>305</fpage>
        <lpage>315</lpage>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Gadbury</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Xiang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Allison</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Illustrations on using the distribution of a p-value in high dimensional data analyses</article-title>
        <source>Adv Appl Stat Sci</source>
        <year>2010</year>
        <volume>1</volume>
        <issue>2</issue>
        <fpage>191</fpage>
        <?supplied-pmid 26719631?>
        <pub-id pub-id-type="pmid">26719631</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuleshov</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Rouillard</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Fernandez</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>Duan</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Koplev</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jenkins</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Jagodnik</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Lachmann</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Enrichr: a comprehensive gene set enrichment analysis web server 2016 update</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>W1</issue>
        <fpage>90</fpage>
        <lpage>97</lpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Grishagin</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Greene</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Obenauer</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Ngan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>D-T</given-names>
          </name>
          <name>
            <surname>Guha</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jadhav</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The NCATS bioplanet–an integrated platform for exploring the universe of cellular signaling pathways for toxicology, systems biology, and chemical genomics</article-title>
        <source>Front Pharmacol</source>
        <year>2019</year>
        <volume>445</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
