<?properties open_access?>
<?subarticle pgen.1008766.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Genet</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosgen</journal-id>
    <journal-title-group>
      <journal-title>PLoS Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-7390</issn>
    <issn pub-type="epub">1553-7404</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7224575</article-id>
    <article-id pub-id-type="pmid">32365090</article-id>
    <article-id pub-id-type="publisher-id">PGENETICS-D-19-01153</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1008766</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genome-Wide Association Studies</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genome-Wide Association Studies</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Human Genetics</subject>
            <subj-group>
              <subject>Genome-Wide Association Studies</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Molecular Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability Theory</subject>
            <subj-group>
              <subject>Random Variables</subject>
              <subj-group>
                <subject>Covariance</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Mathematical Models</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Heredity</subject>
            <subj-group>
              <subject>Genetic Mapping</subject>
              <subj-group>
                <subject>Variant Genotypes</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genetic Loci</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Simultaneous SNP selection and adjustment for population structure in high dimensional prediction models</article-title>
      <alt-title alt-title-type="running-head">Simultaneous SNP selection and adjustment for population structure in high dimensional prediction models</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8956-2509</contrib-id>
        <name>
          <surname>Bhatnagar</surname>
          <given-names>Sahir R.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Yi</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5664-5698</contrib-id>
        <name>
          <surname>Lu</surname>
          <given-names>Tianyuan</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2640-536X</contrib-id>
        <name>
          <surname>Schurr</surname>
          <given-names>Erwin</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff006">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Loredo-Osti</surname>
          <given-names>JC</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff007">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0887-0572</contrib-id>
        <name>
          <surname>Forest</surname>
          <given-names>Marie</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <xref ref-type="aff" rid="aff008">
          <sup>8</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9911-079X</contrib-id>
        <name>
          <surname>Oualkacha</surname>
          <given-names>Karim</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff009">
          <sup>9</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2427-5696</contrib-id>
        <name>
          <surname>Greenwood</surname>
          <given-names>Celia M. T.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
        <xref ref-type="aff" rid="aff010">
          <sup>10</sup>
        </xref>
        <xref ref-type="aff" rid="aff011">
          <sup>11</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Epidemiology, Biostatistics and Occupational Health, McGill University, Montréal, Québec, Canada</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Diagnostic Radiology, McGill University, Montréal, Québec, Canada</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Mathematics and Statistics, McGill University, Montréal, Québec, Canada</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Quantitative Life Sciences, McGill University, Montréal, Québec, Canada</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Lady Davis Institute, Jewish General Hospital, Montréal, Québec, Canada</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Department of Medicine, McGill University, Montréal, Québec, Canada</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>Department of Mathematics and Statistics, Memorial University, St. John’s, Newfoundland and Labrador, Canada</addr-line>
    </aff>
    <aff id="aff008">
      <label>8</label>
      <addr-line>École de Technologie Supérieure, Montréal, Québec, Canada</addr-line>
    </aff>
    <aff id="aff009">
      <label>9</label>
      <addr-line>Département de Mathématiques, Université du Québec à Montréal, Montréal, Québec, Canada</addr-line>
    </aff>
    <aff id="aff010">
      <label>10</label>
      <addr-line>Gerald Bronfman Department of Oncology, McGill University, Montréal, Québec, Canada</addr-line>
    </aff>
    <aff id="aff011">
      <label>11</label>
      <addr-line>Department of Human Genetics, McGill University, Montréal, Québec, Canada</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cordell</surname>
          <given-names>Heather J</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Newcastle University, UNITED KINGDOM</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>sahir.bhatnagar@mcgill.ca</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>5</issue>
    <elocation-id>e1008766</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>7</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>4</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Bhatnagar et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Bhatnagar et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pgen.1008766.pdf"/>
    <abstract>
      <p>Complex traits are known to be influenced by a combination of environmental factors and rare and common genetic variants. However, detection of such multivariate associations can be compromised by low statistical power and confounding by population structure. Linear mixed effects models (LMM) can account for correlations due to relatedness but have not been applicable in high-dimensional (HD) settings where the number of fixed effect predictors greatly exceeds the number of samples. False positives or false negatives can result from two-stage approaches, where the residuals estimated from a null model adjusted for the subjects’ relationship structure are subsequently used as the response in a standard penalized regression model. To overcome these challenges, we develop a general penalized LMM with a single random effect called <monospace>ggmix</monospace> for simultaneous SNP selection and adjustment for population structure in high dimensional prediction models. We develop a blockwise coordinate descent algorithm with automatic tuning parameter selection which is highly scalable, computationally efficient and has theoretical guarantees of convergence. Through simulations and three real data examples, we show that <monospace>ggmix</monospace> leads to more parsimonious models compared to the two-stage approach or principal component adjustment with better prediction accuracy. Our method performs well even in the presence of highly correlated markers, and when the causal SNPs are included in the kinship matrix. <monospace>ggmix</monospace> can be used to construct polygenic risk scores and select instrumental variables in Mendelian randomization studies. Our algorithms are available in an R package available on CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=ggmix">https://cran.r-project.org/package=ggmix</ext-link>).</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>This work addresses a recurring challenge in the analysis and interpretation of genetic association studies: which genetic variants can best predict and are independently associated with a given phenotype in the presence of population structure? Not controlling confounding due to geographic population structure, family and/or cryptic relatedness can lead to spurious associations. Much of the existing research has therefore focused on modeling the association between a phenotype and a single genetic variant in a linear mixed model with a random effect. However, this univariate approach may miss true associations due to the stringent significance thresholds required to reduce the number of false positives and also ignores the correlations between markers. We propose an alternative method for fitting high-dimensional multivariable models, which selects SNPs that are independently associated with the phenotype while also accounting for population structure. We provide an efficient implementation of our algorithm and show through simulation studies and real data examples that our method outperforms existing methods in terms of prediction accuracy and controlling the false discovery rate.</p>
    </abstract>
    <funding-group>
      <funding-statement>SRB and CMTG were supported by the Ludmer Centre for Neuroinformatics and Mental Health and the Canadian Institutes for Health Research PJT 148620. CMTG was also partially supported by NSERC RGPIN-2019-04482. This research was enabled in part by support provided by Calcul Québec (<ext-link ext-link-type="uri" xlink:href="https://www.calculquebec.ca">www.calculquebec.ca</ext-link>) and Compute Canada (<ext-link ext-link-type="uri" xlink:href="https://www.computecanada.ca">www.computecanada.ca</ext-link>). YY was partially supported by NSERC RGPIN-2016-05174 and FRQ-NT NC-205972. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="3"/>
      <page-count count="25"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2020-05-14</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Mouse crosses data are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/sahirbhatnagar/ggmix/blob/master/manuscript/data/mice.RData">https://github.com/sahirbhatnagar/ggmix/blob/master/manuscript/data/mice.RData</ext-link>. Simulated data are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/sahirbhatnagar/ggmix/tree/master/simulation">https://github.com/sahirbhatnagar/ggmix/tree/master/simulation</ext-link>. GAW20 and UK Biobank data are available via application directly to Genetic Analysis Workshop (<ext-link ext-link-type="uri" xlink:href="https://www.gaworkshop.org/data-sets">https://www.gaworkshop.org/data-sets</ext-link>) and UK Biobank (<ext-link ext-link-type="uri" xlink:href="https://www.ukbiobank.ac.uk/using-the-resource/">https://www.ukbiobank.ac.uk/using-the-resource/</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Mouse crosses data are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/sahirbhatnagar/ggmix/blob/master/manuscript/data/mice.RData">https://github.com/sahirbhatnagar/ggmix/blob/master/manuscript/data/mice.RData</ext-link>. Simulated data are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/sahirbhatnagar/ggmix/tree/master/simulation">https://github.com/sahirbhatnagar/ggmix/tree/master/simulation</ext-link>. GAW20 and UK Biobank data are available via application directly to Genetic Analysis Workshop (<ext-link ext-link-type="uri" xlink:href="https://www.gaworkshop.org/data-sets">https://www.gaworkshop.org/data-sets</ext-link>) and UK Biobank (<ext-link ext-link-type="uri" xlink:href="https://www.ukbiobank.ac.uk/using-the-resource/">https://www.ukbiobank.ac.uk/using-the-resource/</ext-link>).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Genome-wide association studies (GWAS) have become the standard method for analyzing genetic datasets owing to their success in identifying thousands of genetic variants associated with complex diseases (<ext-link ext-link-type="uri" xlink:href="https://www.genome.gov/gwastudies/">https://www.genome.gov/gwastudies/</ext-link>). Despite these impressive findings, the discovered markers have only been able to explain a small proportion of the phenotypic variance; this is known as the missing heritability problem [<xref rid="pgen.1008766.ref001" ref-type="bibr">1</xref>]. One plausible reason is that there are many causal variants that each explain a small amount of variation with small effect sizes [<xref rid="pgen.1008766.ref002" ref-type="bibr">2</xref>]. Methods such as GWAS, which test each variant or single nucleotide polymorphism (SNP) independently, may miss these true associations due to the stringent significance thresholds required to reduce the number of false positives [<xref rid="pgen.1008766.ref001" ref-type="bibr">1</xref>]. Another major issue to overcome is that of confounding due to geographic population structure, family and/or cryptic relatedness which can lead to spurious associations [<xref rid="pgen.1008766.ref003" ref-type="bibr">3</xref>]. For example, there may be subpopulations within a study that differ with respect to their genotype frequencies at a particular locus due to geographical location or their ancestry. This heterogeneity in genotype frequency can cause correlations with other loci and consequently mimic the signal of association even though there is no biological association [<xref rid="pgen.1008766.ref004" ref-type="bibr">4</xref>, <xref rid="pgen.1008766.ref005" ref-type="bibr">5</xref>]. Studies that separate their sample by ethnicity to address this confounding suffer from a loss in statistical power due to the drop in sample size.</p>
    <p>To address the first problem, multivariable regression methods have been proposed which simultaneously fit many SNPs in a single model [<xref rid="pgen.1008766.ref006" ref-type="bibr">6</xref>, <xref rid="pgen.1008766.ref007" ref-type="bibr">7</xref>]. Indeed, the power to detect an association for a given SNP may be increased when other causal SNPs have been accounted for. Conversely, a stronger signal from a causal SNP may weaken false signals when modeled jointly [<xref rid="pgen.1008766.ref006" ref-type="bibr">6</xref>].</p>
    <p>Solutions for confounding by population structure have also received significant attention in the literature [<xref rid="pgen.1008766.ref008" ref-type="bibr">8</xref>–<xref rid="pgen.1008766.ref011" ref-type="bibr">11</xref>]. There are two main approaches to account for the relatedness between subjects: 1) the principal component (PC) adjustment method and 2) the linear mixed model (LMM). The PC adjustment method includes the top PCs of genome-wide SNP genotypes as additional covariates in the model [<xref rid="pgen.1008766.ref012" ref-type="bibr">12</xref>]. The LMM uses an estimated covariance matrix from the individuals’ genotypes and includes this information in the form of a random effect [<xref rid="pgen.1008766.ref003" ref-type="bibr">3</xref>].</p>
    <p>While these problems have been addressed in isolation, there has been relatively little progress towards addressing them jointly at a large scale. Region-based tests of association have been developed where a linear combination of <italic>p</italic> variants is regressed on the response variable in a mixed model framework [<xref rid="pgen.1008766.ref013" ref-type="bibr">13</xref>]. In case-control data, a stepwise logistic-regression procedure was used to evaluate the relative importance of variants within a small genetic region [<xref rid="pgen.1008766.ref014" ref-type="bibr">14</xref>]. These methods however are not applicable in the high-dimensional setting, i.e., when the number of variables <italic>p</italic> is much larger than the sample size <italic>n</italic>, as is often the case in genetic studies where millions of variants are measured on thousands of individuals.</p>
    <p>There has been recent interest in using penalized linear mixed models, which place a constraint on the magnitude of the effect sizes while controlling for confounding factors such as population structure. For example, the LMM-lasso [<xref rid="pgen.1008766.ref015" ref-type="bibr">15</xref>] places a Laplace prior on all main effects while the adaptive mixed lasso [<xref rid="pgen.1008766.ref016" ref-type="bibr">16</xref>] uses the <italic>L</italic><sub>1</sub> penalty [<xref rid="pgen.1008766.ref017" ref-type="bibr">17</xref>] with adaptively chosen weights [<xref rid="pgen.1008766.ref018" ref-type="bibr">18</xref>] to allow for differential shrinkage amongst the variables in the model. Another method applied a combination of both the lasso and group lasso penalties in order to select variants within a gene most associated with the response [<xref rid="pgen.1008766.ref019" ref-type="bibr">19</xref>]. However, methods such as the LMM-lasso are normally performed in two steps. First, the variance components are estimated once from a LMM with a single random effect. These LMMs normally use the estimated covariance matrix from the individuals’ genotypes to account for the relatedness but assumes no SNP main effects (i.e. a null model). The residuals from this null model with a single random effect can be treated as independent observations because the relatedness has been effectively removed from the original response. In the second step, these residuals are used as the response in any high-dimensional model that assumes uncorrelated errors. This approach has both computational and practical advantages since existing penalized regression software such as <monospace>glmnet</monospace> [<xref rid="pgen.1008766.ref020" ref-type="bibr">20</xref>] and <monospace>gglasso</monospace> [<xref rid="pgen.1008766.ref021" ref-type="bibr">21</xref>], which assume independent observations, can be applied directly to the residuals. However, recent work has shown that there can be a loss in power if a causal variant is included in the calculation of the covariance matrix as its effect will have been removed in the first step [<xref rid="pgen.1008766.ref013" ref-type="bibr">13</xref>, <xref rid="pgen.1008766.ref022" ref-type="bibr">22</xref>].</p>
    <p>In this paper we develop a general penalized LMM framework called <monospace>ggmix</monospace> that simultaneously selects variables and estimates their effects, accounting for between-individual correlations. We develop a blockwise coordinate descent algorithm with automatic tuning parameter selection which is highly scalable, computationally efficient and has theoretical guarantees of convergence. Our method can handle several sparsity inducing penalties such as the lasso [<xref rid="pgen.1008766.ref017" ref-type="bibr">17</xref>] and elastic net [<xref rid="pgen.1008766.ref023" ref-type="bibr">23</xref>]. Through simulations and three real data examples, we show that <monospace>ggmix</monospace> leads to more parsimonious models compared to the two-stage approach or principal component adjustment with better prediction accuracy. Our method performs well even in the presence of highly correlated markers, and when the causal SNPs are included in the kinship matrix.</p>
    <p>All of our algorithms are implemented in the <monospace>ggmix</monospace> R package hosted on CRAN with extensive documentation (<ext-link ext-link-type="uri" xlink:href="https://sahirbhatnagar.com/ggmix">https://sahirbhatnagar.com/ggmix</ext-link>). We provide a brief demonstration of the <monospace>ggmix</monospace> package in <xref ref-type="supplementary-material" rid="pgen.1008766.s005">S2 Text</xref>.</p>
    <p>The rest of the paper is organized as follows. In Results, we compare the performance of our proposed approach and demonstrate the scenarios where it can be advantageous to use over existing methods through simulation studies and three real data analyses. This is followed by a discussion of our results, some limitations and future directions in Discussion. Materials and methods describes the <monospace>ggmix</monospace> model, the optimization procedure and the algorithm used to fit it.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <p>In this section we demonstrate the performance of <monospace>ggmix</monospace> in a simulation study and three real data applications.</p>
    <sec id="sec003">
      <title>Simulation study</title>
      <p>We evaluated the performance of <monospace>ggmix</monospace> in a variety of simulated scenarios. For each simulation scenario we compared <monospace>ggmix</monospace> to the <monospace>lasso</monospace> and the <monospace>twostep</monospace> method. For the <monospace>lasso</monospace>, we included the top 10 principal components from the simulated genotypes used to calculate the kinship matrix as unpenalized predictors in the design matrix. For the <monospace>twostep</monospace> method, we first fitted an intercept only model with a single random effect using the average information restricted maximum likelihood (AIREML) algorithm [<xref rid="pgen.1008766.ref024" ref-type="bibr">24</xref>] as implemented in the <monospace>gaston</monospace> R package [<xref rid="pgen.1008766.ref025" ref-type="bibr">25</xref>]. The residuals from this model were then used as the response in a regular <monospace>lasso</monospace> model. Note that in the <monospace>twostep</monospace> method, we removed the kinship effect in the first step and therefore did not need to make any further adjustments when fitting the penalized model. We fitted the <monospace>lasso</monospace> using the default settings and <monospace>standardize = FALSE</monospace> in the <monospace>glmnet</monospace> package [<xref rid="pgen.1008766.ref020" ref-type="bibr">20</xref>], with 10-fold cross-validation (CV) to select the optimal tuning parameter. For other parameters in our simulation study, we defined the following quantities:
<list list-type="bullet"><list-item><p><italic>n</italic>: sample size</p></list-item><list-item><p><italic>c</italic>: percentage of causal SNPs</p></list-item><list-item><p><italic><bold>β</bold></italic>: true effect size vector of length <italic>p</italic></p></list-item><list-item><p><italic>S</italic><sub>0</sub> = {<italic>j</italic>; (<italic>β</italic>)<sub><italic>j</italic></sub> ≠ 0} the index of the true active set with cardinality |<italic>S</italic><sub>0</sub>| = <italic>c</italic> × <italic>p</italic></p></list-item><list-item><p><italic>causal</italic>: the list of causal SNP indices</p></list-item><list-item><p><italic>kinship</italic>: the list of SNP indices for the kinship matrix</p></list-item><list-item><p><bold>X</bold>: <italic>n</italic> × <italic>p</italic> matrix of SNPs that were included as covariates in the model</p></list-item></list></p>
      <p>We simulated data from the model
<disp-formula id="pgen.1008766.e001"><alternatives><graphic xlink:href="pgen.1008766.e001.jpg" id="pgen.1008766.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo>=</mml:mo><mml:mtext mathvariant="bold">X</mml:mtext><mml:mo mathvariant="bold-italic">β</mml:mo><mml:mo>+</mml:mo><mml:mtext mathvariant="bold">P</mml:mtext><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ε</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1008766.e002"><alternatives><graphic xlink:href="pgen.1008766.e002.jpg" id="pgen.1008766.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:mtext mathvariant="bold">P</mml:mtext><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo mathvariant="bold">Φ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the polygenic effect and <inline-formula id="pgen.1008766.e003"><alternatives><graphic xlink:href="pgen.1008766.e003.jpg" id="pgen.1008766.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mtext mathvariant="bold">I</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the error term. Here, <bold>Φ</bold><sub><italic>n</italic>×<italic>n</italic></sub> is the covariance matrix based on the <italic>kinship</italic> SNPs from <italic>n</italic> individuals, <bold>I</bold><sub><italic>n</italic>×<italic>n</italic></sub> is the identity matrix and parameters <italic>σ</italic><sup>2</sup> and <italic>η</italic> ∈ [0, 1] determine how the variance is divided between <bold>P</bold> and <italic><bold>ε</bold></italic>. The values of the parameters that we used were as follows: narrow sense heritability <italic>η</italic> = {0.1, 0.3}, number of covariates <italic>p</italic> = 5, 000, number of <italic>kinship</italic> SNPs <italic>k</italic> = 10, 000, percentage of <italic>causal</italic> SNPs <italic>c</italic> = {0%, 1%} and <italic>σ</italic><sup>2</sup> = 1. In addition to these parameters, we also varied the amount of overlap between the <italic>causal</italic> list and the <italic>kinship</italic> list. We considered two main scenarios:
<list list-type="order"><list-item><p>None of the <italic>causal</italic> SNPs are included in <italic>kinship</italic> set.</p></list-item><list-item><p>All of the <italic>causal</italic> SNPs are included in the <italic>kinship</italic> set.</p></list-item></list></p>
      <p>Both kinship matrices were meant to contrast the model behavior when the causal SNPs are included in both the main effects and random effects (referred to as proximal contamination [<xref rid="pgen.1008766.ref008" ref-type="bibr">8</xref>]) versus when the causal SNPs are only included in the main effects. These scenarios are motivated by the current standard of practice in GWAS where the candidate marker is excluded from the calculation of the kinship matrix [<xref rid="pgen.1008766.ref008" ref-type="bibr">8</xref>]. This approach becomes much more difficult to apply in large-scale multivariable models where there is likely to be overlap between the variables in the design matrix and kinship matrix. We simulated random genotypes from the BN-PSD admixture model with 1D geography and 10 subpopulations using the <monospace>bnpsd</monospace> package [<xref rid="pgen.1008766.ref026" ref-type="bibr">26</xref>, <xref rid="pgen.1008766.ref027" ref-type="bibr">27</xref>]. In <xref ref-type="fig" rid="pgen.1008766.g001">Fig 1</xref>, we plot the estimated kinship matrix from a single simulated dataset in the form of a heatmap where a darker color indicates a closer genetic relationship.</p>
      <fig id="pgen.1008766.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1008766.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Empirical kinship matrix.</title>
          <p>Example of an empirical kinship matrix used in simulation studies. This scenario models a 1D geography with extensive admixture.</p>
        </caption>
        <graphic xlink:href="pgen.1008766.g001"/>
      </fig>
      <p>In <xref ref-type="fig" rid="pgen.1008766.g002">Fig 2</xref> we plot the first two principal component scores calculated from the simulated genotypes used to calculate the kinship matrix in <xref ref-type="fig" rid="pgen.1008766.g001">Fig 1</xref>, and color each point by subpopulation membership. We can see that the PCs can identify the subpopulations which is why including them as additional covariates in a regression model has been considered a reasonable approach to control for confounding.</p>
      <fig id="pgen.1008766.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1008766.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>First two principal components.</title>
          <p>First two principal component scores of the genotype data used to estimate the kinship matrix where each color represents one of the 10 simulated subpopulations.</p>
        </caption>
        <graphic xlink:href="pgen.1008766.g002"/>
      </fig>
      <p>Using this set-up, we randomly partitioned 1000 simulated observations into 80% for training and 20% for testing. The training set was used to fit the model and select the optimal tuning parameter only, and the resulting model was evaluated on the test set. Let <inline-formula id="pgen.1008766.e004"><alternatives><graphic xlink:href="pgen.1008766.e004.jpg" id="pgen.1008766.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> be the estimated value of the optimal regularization parameter, <inline-formula id="pgen.1008766.e005"><alternatives><graphic xlink:href="pgen.1008766.e005.jpg" id="pgen.1008766.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>^</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula> the estimate of <italic><bold>β</bold></italic> at regularization parameter <inline-formula id="pgen.1008766.e006"><alternatives><graphic xlink:href="pgen.1008766.e006.jpg" id="pgen.1008766.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, and <inline-formula id="pgen.1008766.e007"><alternatives><graphic xlink:href="pgen.1008766.e007.jpg" id="pgen.1008766.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>^</mml:mo></mml:mover></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>^</mml:mo></mml:mover></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> the index of the set of non-zero estimated coefficients. To compare the methods in the context of true positive rate (TPR), we selected the largest tuning parameter that would result in a false positive rate (FPR) closest to 5%, but not more. Note that in practice, this approach to selecting the tuning parameter is generally not possible since we do not know the underlying true model in advance. For real data, we suggest an information criterion approach described in <xref ref-type="supplementary-material" rid="pgen.1008766.s004">S1 Text</xref> or a sample splitting approach such as the one we used for the UK Biobank analysis. We also compared the model size (<inline-formula id="pgen.1008766.e008"><alternatives><graphic xlink:href="pgen.1008766.e008.jpg" id="pgen.1008766.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>^</mml:mo></mml:mover></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>), test set prediction error based on the refitted unpenalized estimates for each selected model, the estimation error (<inline-formula id="pgen.1008766.e009"><alternatives><graphic xlink:href="pgen.1008766.e009.jpg" id="pgen.1008766.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>), and the variance components (<italic>η</italic>, <italic>σ</italic><sup>2</sup>) for the polygenic random effect and error term.</p>
      <p>The results are summarized in <xref rid="pgen.1008766.t001" ref-type="table">Table 1</xref>. We see that <monospace>ggmix</monospace> outperformed the <monospace>twostep</monospace> in terms of TPR, and was comparable to the <monospace>lasso</monospace>. This was the case, regardless of true heritability and whether the causal SNPs were included in the calculation of the kinship matrix. For the <monospace>twostep</monospace> however, the TPR at a FPR of 5%, drops, on average, from 0.84 (when causal SNPs are not in the kinship) to 0.76 (when causal SNPs are in the kinship). Across all simulation scenarios, <monospace>ggmix</monospace> had the smallest estimation error, and smallest root mean squared prediction error (RMSE) on the test set while also producing the most parsimonious models. Both the <monospace>lasso</monospace> and <monospace>twostep</monospace> selected more false positives, even in the null model scenario. Both the <monospace>twostep</monospace> and <monospace>ggmix</monospace> overestimated the heritability though <monospace>ggmix</monospace> was closer to the true value. When none of the causal SNPs were in the kinship, both methods tended to overestimate the truth when <italic>η</italic> = 10% and underestimate when <italic>η</italic> = 30%. Across all simulation scenarios <monospace>ggmix</monospace> was able to (on average) correctly estimate the error variance. The <monospace>lasso</monospace> tended to overestimate <italic>σ</italic><sup>2</sup> in the null model while the <monospace>twostep</monospace> overestimated <italic>σ</italic><sup>2</sup> when none of the causal SNPs were in the kinship matrix.</p>
      <table-wrap id="pgen.1008766.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1008766.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Simulation study results.</title>
          <p>Mean (standard deviation) from 200 simulations stratified by the number of causal SNPs (null, 1%), the overlap between causal SNPs and kinship matrix (no overlap, all causal SNPs in kinship), and true heritability (10%, 30%). For all simulations, sample size is <italic>n</italic> = 1000, the number of covariates is <italic>p</italic> = 5000, and the number of SNPs used to estimate the kinship matrix is <italic>k</italic> = 10000. TPR at FPR = 5% is the true positive rate at a fixed false positive rate of 5%. Model Size (<inline-formula id="pgen.1008766.e010"><alternatives><graphic id="pgen.1008766.e010g" xlink:href="pgen.1008766.e010"/><mml:math id="M10"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>^</mml:mo></mml:mover></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>) is the number of selected variables in the training set using the high-dimensional BIC for <monospace>ggmix</monospace> and 10-fold cross validation for <monospace>lasso</monospace> and <monospace>twostep</monospace>. RMSE is the root mean squared error on the test set. Estimation error is the squared distance between the estimated and true effect sizes. Error variance (<italic>σ</italic><sup>2</sup>) for <monospace>twostep</monospace> is estimated from an intercept only LMM with a single random effect and is modeled explicitly in <monospace>ggmix</monospace>. For the <monospace>lasso</monospace> we use <inline-formula id="pgen.1008766.e011"><alternatives><graphic id="pgen.1008766.e011g" xlink:href="pgen.1008766.e011"/><mml:math id="M11"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>^</mml:mo></mml:mover></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>‖</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mo>λ</mml:mo><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> [<xref rid="pgen.1008766.ref028" ref-type="bibr">28</xref>] as an estimator for <italic>σ</italic><sup>2</sup>. Heritability (<italic>η</italic>) for <monospace>twostep</monospace> is estimated as <inline-formula id="pgen.1008766.e012"><alternatives><graphic id="pgen.1008766.e012g" xlink:href="pgen.1008766.e012"/><mml:math id="M12"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> from an intercept only LMM with a single random effect where <inline-formula id="pgen.1008766.e013"><alternatives><graphic id="pgen.1008766.e013g" xlink:href="pgen.1008766.e013"/><mml:math id="M13"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pgen.1008766.e014"><alternatives><graphic id="pgen.1008766.e014g" xlink:href="pgen.1008766.e014"/><mml:math id="M14"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> are the variance components for the random effect and error term, respectively. <italic>η</italic> is explictly modeled in <monospace>ggmix</monospace>. There is no positive way to calculate <italic>η</italic> for the <monospace>lasso</monospace> since we are using a PC adjustment.</p>
        </caption>
        <alternatives>
          <graphic id="pgen.1008766.t001g" xlink:href="pgen.1008766.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1"/>
                <th align="center" rowspan="2" colspan="1"/>
                <th align="center" colspan="4" rowspan="1">Null model</th>
                <th align="center" colspan="4" rowspan="1">1% Causal SNPs</th>
              </tr>
              <tr>
                <th align="center" colspan="2" rowspan="1">No overlap</th>
                <th align="center" colspan="2" rowspan="1">All causal SNPs in kinship</th>
                <th align="center" colspan="2" rowspan="1">No overlap</th>
                <th align="center" colspan="2" rowspan="1">All causal SNPs in kinship</th>
              </tr>
              <tr>
                <th align="left" rowspan="1" colspan="1">Metric</th>
                <th align="left" rowspan="1" colspan="1">Method</th>
                <th align="center" rowspan="1" colspan="1">10%</th>
                <th align="center" rowspan="1" colspan="1">30%</th>
                <th align="center" rowspan="1" colspan="1">10%</th>
                <th align="center" rowspan="1" colspan="1">30%</th>
                <th align="center" rowspan="1" colspan="1">10%</th>
                <th align="center" rowspan="1" colspan="1">30%</th>
                <th align="center" rowspan="1" colspan="1">10%</th>
                <th align="center" rowspan="1" colspan="1">30%</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="3" colspan="1">
                  <bold>TPR at FPR</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">twostep</td>
                <td align="center" rowspan="1" colspan="1">0.00 (0.00)</td>
                <td align="center" rowspan="1" colspan="1">0.00 (0.00)</td>
                <td align="center" rowspan="1" colspan="1">0.00 (0.00)</td>
                <td align="center" rowspan="1" colspan="1">0.00 (0.00)</td>
                <td align="center" rowspan="1" colspan="1">0.84 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">0.84 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">0.76 (0.09)</td>
                <td align="center" rowspan="1" colspan="1">0.77 (0.08)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">lasso</td>
                <td align="center" rowspan="1" colspan="1">0.00 (0.00)</td>
                <td align="center" rowspan="1" colspan="1">0.00 (0.00)</td>
                <td align="center" rowspan="1" colspan="1">0.00 (0.00)</td>
                <td align="center" rowspan="1" colspan="1">0.00 (0.00)</td>
                <td align="center" rowspan="1" colspan="1">0.86 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">0.85 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">0.86 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">0.86 (0.05)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ggmix</td>
                <td align="center" rowspan="1" colspan="1">0.00 (0.00)</td>
                <td align="center" rowspan="1" colspan="1">0.00 (0.00)</td>
                <td align="center" rowspan="1" colspan="1">0.00 (0.00)</td>
                <td align="center" rowspan="1" colspan="1">0.00 (0.00)</td>
                <td align="center" rowspan="1" colspan="1">0.86 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">0.86 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">0.85 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">0.86 (0.05)</td>
              </tr>
              <tr>
                <td align="left" rowspan="3" colspan="1">
                  <bold>Model Size</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">twostep</td>
                <td align="center" rowspan="1" colspan="1">0 (0, 5)</td>
                <td align="center" rowspan="1" colspan="1">0 (0, 2)</td>
                <td align="center" rowspan="1" colspan="1">0 (0, 5)</td>
                <td align="center" rowspan="1" colspan="1">0 (0, 2)</td>
                <td align="center" rowspan="1" colspan="1">328 (289, 388)</td>
                <td align="center" rowspan="1" colspan="1">332 (287, 385)</td>
                <td align="center" rowspan="1" colspan="1">284 (250, 329)</td>
                <td align="center" rowspan="1" colspan="1">284 (253, 319)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">lasso</td>
                <td align="center" rowspan="1" colspan="1">0 (0, 6)</td>
                <td align="center" rowspan="1" colspan="1">0 (0, 5)</td>
                <td align="center" rowspan="1" colspan="1">0 (0, 6)</td>
                <td align="center" rowspan="1" colspan="1">0 (0, 5)</td>
                <td align="center" rowspan="1" colspan="1">278 (246, 317)</td>
                <td align="center" rowspan="1" colspan="1">276 (245, 314)</td>
                <td align="center" rowspan="1" colspan="1">279 (252, 321)</td>
                <td align="center" rowspan="1" colspan="1">285 (244, 319)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ggmix</td>
                <td align="center" rowspan="1" colspan="1">0 (0, 0)</td>
                <td align="center" rowspan="1" colspan="1">0 (0, 0)</td>
                <td align="center" rowspan="1" colspan="1">0 (0, 0)</td>
                <td align="center" rowspan="1" colspan="1">0 (0, 0)</td>
                <td align="center" rowspan="1" colspan="1">43 (39, 49)</td>
                <td align="center" rowspan="1" colspan="1">43 (39, 48)</td>
                <td align="center" rowspan="1" colspan="1">44 (38, 49)</td>
                <td align="center" rowspan="1" colspan="1">43 (38, 48)</td>
              </tr>
              <tr>
                <td align="left" rowspan="3" colspan="1">
                  <bold>RMSE</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">twostep</td>
                <td align="center" rowspan="1" colspan="1">1.02 (0.07)</td>
                <td align="center" rowspan="1" colspan="1">1.02 (0.06)</td>
                <td align="center" rowspan="1" colspan="1">1.02 (0.07)</td>
                <td align="center" rowspan="1" colspan="1">1.02 (0.06)</td>
                <td align="center" rowspan="1" colspan="1">1.42 (0.10)</td>
                <td align="center" rowspan="1" colspan="1">1.41 (0.10)</td>
                <td align="center" rowspan="1" colspan="1">1.44 (0.33)</td>
                <td align="center" rowspan="1" colspan="1">1.40 (0.22)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">lasso</td>
                <td align="center" rowspan="1" colspan="1">1.02 (0.06)</td>
                <td align="center" rowspan="1" colspan="1">1.02 (0.06)</td>
                <td align="center" rowspan="1" colspan="1">1.02 (0.06)</td>
                <td align="center" rowspan="1" colspan="1">1.02 (0.06)</td>
                <td align="center" rowspan="1" colspan="1">1.39 (0.09)</td>
                <td align="center" rowspan="1" colspan="1">1.38 (0.09)</td>
                <td align="center" rowspan="1" colspan="1">1.40 (0.08)</td>
                <td align="center" rowspan="1" colspan="1">1.38 (0.08)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ggmix</td>
                <td align="center" rowspan="1" colspan="1">1.00 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">1.00 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">1.00 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">1.00 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">1.22 (0.10)</td>
                <td align="center" rowspan="1" colspan="1">1.20 (0.10)</td>
                <td align="center" rowspan="1" colspan="1">1.23 (0.11)</td>
                <td align="center" rowspan="1" colspan="1">1.23 (0.12)</td>
              </tr>
              <tr>
                <td align="left" rowspan="3" colspan="1">
                  <bold>Estimation Error</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">twostep</td>
                <td align="center" rowspan="1" colspan="1">0.12 (0.22)</td>
                <td align="center" rowspan="1" colspan="1">0.09 (0.19)</td>
                <td align="center" rowspan="1" colspan="1">0.12 (0.22)</td>
                <td align="center" rowspan="1" colspan="1">0.09 (0.19)</td>
                <td align="center" rowspan="1" colspan="1">2.97 (0.60)</td>
                <td align="center" rowspan="1" colspan="1">2.92 (0.60)</td>
                <td align="center" rowspan="1" colspan="1">3.60 (5.41)</td>
                <td align="center" rowspan="1" colspan="1">3.21 (3.46)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">lasso</td>
                <td align="center" rowspan="1" colspan="1">0.13 (0.21)</td>
                <td align="center" rowspan="1" colspan="1">0.12 (0.22)</td>
                <td align="center" rowspan="1" colspan="1">0.13 (0.21)</td>
                <td align="center" rowspan="1" colspan="1">0.12 (0.22)</td>
                <td align="center" rowspan="1" colspan="1">2.76 (0.46)</td>
                <td align="center" rowspan="1" colspan="1">2.69 (0.47)</td>
                <td align="center" rowspan="1" colspan="1">2.82 (0.48)</td>
                <td align="center" rowspan="1" colspan="1">2.75 (0.48)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ggmix</td>
                <td align="center" rowspan="1" colspan="1">0.00 (0.01)</td>
                <td align="center" rowspan="1" colspan="1">0.01 (0.02)</td>
                <td align="center" rowspan="1" colspan="1">0.00 (0.01)</td>
                <td align="center" rowspan="1" colspan="1">0.01 (0.02)</td>
                <td align="center" rowspan="1" colspan="1">2.11 (1.28)</td>
                <td align="center" rowspan="1" colspan="1">2.04 (1.22)</td>
                <td align="center" rowspan="1" colspan="1">2.21 (1.24)</td>
                <td align="center" rowspan="1" colspan="1">2.28 (1.34)</td>
              </tr>
              <tr>
                <td align="left" rowspan="3" colspan="1">
                  <bold>Error Variance</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">twostep</td>
                <td align="center" rowspan="1" colspan="1">0.87 (0.11)</td>
                <td align="center" rowspan="1" colspan="1">0.69 (0.15)</td>
                <td align="center" rowspan="1" colspan="1">0.87 (0.11)</td>
                <td align="center" rowspan="1" colspan="1">0.69 (0.15)</td>
                <td align="center" rowspan="1" colspan="1">14.23 (3.53)</td>
                <td align="center" rowspan="1" colspan="1">14.13 (3.52)</td>
                <td align="center" rowspan="1" colspan="1">1.42 (1.71)</td>
                <td align="center" rowspan="1" colspan="1">1.28 (1.66)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">lasso</td>
                <td align="center" rowspan="1" colspan="1">0.98 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">0.96 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">0.98 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">0.96 (0.05)</td>
                <td align="center" rowspan="1" colspan="1">1.04 (0.13)</td>
                <td align="center" rowspan="1" colspan="1">1.02 (0.13)</td>
                <td align="center" rowspan="1" colspan="1">1.03 (0.14)</td>
                <td align="center" rowspan="1" colspan="1">1.01 (0.14)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ggmix</td>
                <td align="center" rowspan="1" colspan="1">0.85 (0.18)</td>
                <td align="center" rowspan="1" colspan="1">0.64 (0.20)</td>
                <td align="center" rowspan="1" colspan="1">0.85 (0.18)</td>
                <td align="center" rowspan="1" colspan="1">0.64 (0.20)</td>
                <td align="center" rowspan="1" colspan="1">2.00 (0.49)</td>
                <td align="center" rowspan="1" colspan="1">1.86 (0.51)</td>
                <td align="center" rowspan="1" colspan="1">1.06 (0.46)</td>
                <td align="center" rowspan="1" colspan="1">0.83 (0.45)</td>
              </tr>
              <tr>
                <td align="left" rowspan="3" colspan="1">
                  <bold>Heritability</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">twostep</td>
                <td align="center" rowspan="1" colspan="1">0.13 (0.11)</td>
                <td align="center" rowspan="1" colspan="1">0.31 (0.15)</td>
                <td align="center" rowspan="1" colspan="1">0.13 (0.11)</td>
                <td align="center" rowspan="1" colspan="1">0.31 (0.15)</td>
                <td align="center" rowspan="1" colspan="1">0.26 (0.14)</td>
                <td align="center" rowspan="1" colspan="1">0.26 (0.14)</td>
                <td align="center" rowspan="1" colspan="1">0.92 (0.08)</td>
                <td align="center" rowspan="1" colspan="1">0.93 (0.08)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">lasso</td>
                <td align="center" rowspan="1" colspan="1">–</td>
                <td align="center" rowspan="1" colspan="1">–</td>
                <td align="center" rowspan="1" colspan="1">–</td>
                <td align="center" rowspan="1" colspan="1">–</td>
                <td align="center" rowspan="1" colspan="1">–</td>
                <td align="center" rowspan="1" colspan="1">–</td>
                <td align="center" rowspan="1" colspan="1">–</td>
                <td align="center" rowspan="1" colspan="1">–</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ggmix</td>
                <td align="center" rowspan="1" colspan="1">0.15 (0.18)</td>
                <td align="center" rowspan="1" colspan="1">0.37 (0.21)</td>
                <td align="center" rowspan="1" colspan="1">0.15 (0.18)</td>
                <td align="center" rowspan="1" colspan="1">0.37 (0.21)</td>
                <td align="center" rowspan="1" colspan="1">0.18 (0.16)</td>
                <td align="center" rowspan="1" colspan="1">0.23 (0.17)</td>
                <td align="center" rowspan="1" colspan="1">0.59 (0.20)</td>
                <td align="center" rowspan="1" colspan="1">0.68 (0.19)</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p>Note: median (inter-quartile range) is given for model size.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Overall, we observed that variable selection results and RMSE for <monospace>ggmix</monospace> were similar regardless of whether the causal SNPs were in the kinship matrix or not. This result is encouraging since in practice the kinship matrix is constructed from a random sample of SNPs across the genome, some of which are likely to be causal, particularly in polygenic traits.</p>
      <p>In particular, our simulation results show that the principal component adjustment method may not be the best approach to control for confounding by population structure, particularly when variable selection is of interest.</p>
    </sec>
    <sec id="sec004">
      <title>Real data applications</title>
      <p>Three datasets with different features were used to illustrate the potential advantages of <monospace>ggmix</monospace> over existing approaches such as PC adjustment in a <monospace>lasso</monospace> regression. In the first two datasets, family structure induced low levels of correlation and sparsity in signals. In the last, a dataset involving mouse crosses, correlations were extremely strong and could confound signals.</p>
      <sec id="sec005">
        <title>UK Biobank</title>
        <p>With more than 500,000 participants, the UK Biobank is one of the largest genotyped health care registries in the world. Among these participants, 147,731 have been inferred to be related to at least one individual in this cohort [<xref rid="pgen.1008766.ref029" ref-type="bibr">29</xref>]. Such a widespread genetic relatedness may confound association studies and bias trait predictions if not properly accounted for. Among these related individuals, 18,150 have a documented familial relationship (parent-offspring, full siblings, second degree or third degree) that was previously inferred in [<xref rid="pgen.1008766.ref030" ref-type="bibr">30</xref>]. We attempted to derive a polygenic risk score for height among these individuals. As suggested by a reviewer, the goal of this analysis was to see how the different methods performed for a highly polygenic trait in a set of related individuals. We compared the <monospace>ggmix</monospace>-derived polygenic risk score to those derived by the <monospace>twostep</monospace> and <monospace>lasso</monospace> methods.</p>
        <p>We first estimated the pairwise kinship coefficient among the 18,150 reportedly related individuals based on 784,256 genotyped SNPs using KING [<xref rid="pgen.1008766.ref031" ref-type="bibr">31</xref>]. We grouped related individuals with a kinship coefficient &gt; 0.044 [<xref rid="pgen.1008766.ref031" ref-type="bibr">31</xref>] into 8,300 pedigrees. We then randomly split the dataset into a training set, a model selection set and a test set of roughly equal sample size, ensuring all individuals in the same pedigree were assigned into the same set. We inverse normalized the standing height after adjusting for age, sex, genotyping array, and assessment center following Yengo et al. [<xref rid="pgen.1008766.ref032" ref-type="bibr">32</xref>].</p>
        <p>To reduce computational complexity, we selected 10,000 SNPs with the largest effect sizes associated with height from a recent large meta-analysis [<xref rid="pgen.1008766.ref032" ref-type="bibr">32</xref>]. Among these 10,000 SNPs, 1,233 were genotyped and used for estimating the kinship whereas the other 8,767 SNPs were imputed based on the Haplotype Reference Consortium reference panel [<xref rid="pgen.1008766.ref033" ref-type="bibr">33</xref>]. The distribution of the 10,000 SNPs by chromosome and whether or not the SNP was imputed is shown in <xref ref-type="supplementary-material" rid="pgen.1008766.s001">S1 Fig</xref>. We see that every chromosome contributed SNPs to the model with 15% coming from chromosome 6. The markers we used are theoretically independent since Yengo et al. performed a COJO analysis which should have tuned down signals due to linkage disequilibrium [<xref rid="pgen.1008766.ref032" ref-type="bibr">32</xref>]. We used <monospace>ggmix</monospace>, <monospace>twostep</monospace> and <monospace>lasso</monospace> to select SNPs most predictive of the inverse normalized height on the training set, and chose the λ with the lowest prediction RMSE on the model selection set for each method. We then examined the performance of each derived polygenic risk score on the test set. Similar to simulation study, we adjusted for the top 10 genetic PCs as unpenalized predictors when fitting the <monospace>lasso</monospace> models, and supplied the kinship matrix based on 784,256 genotyped SNPs to <monospace>ggmix</monospace> and <monospace>twostep</monospace>.</p>
        <p>We found that with a kinship matrix estimated using all genotyped SNPs, <monospace>ggmix</monospace> had the possibility to achieve a lower RMSE on the model selection set compared to the <monospace>twostep</monospace> and <monospace>lasso</monospace> methods (<xref ref-type="fig" rid="pgen.1008766.g003">Fig 3A</xref>). An optimized <monospace>ggmix</monospace>-derived polygenic risk score that utilized the least number of SNPs was also able to better predict the trait with lower RMSE on the test set (<xref ref-type="fig" rid="pgen.1008766.g003">Fig 3B</xref>).</p>
        <fig id="pgen.1008766.g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pgen.1008766.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>Model selection and testing in the UK Biobank.</title>
            <p>(<bold>a</bold>) Root-mean-square error of three methods on the model selection set with respect to a grid search of penalty factor used on the training set. (<bold>b</bold>) Performance of four methods on the test set with penalty factor optimized on the model selection set. The x-axis has a logarithmic scale. The BSLMM method optimized coefficients of each SNP through an MCMC process on the training set and was directly evaluated on the test set.</p>
          </caption>
          <graphic xlink:href="pgen.1008766.g003"/>
        </fig>
        <p>We additionally applied a Bayesian Sparse Linear Mixed Model (<monospace>BSLMM</monospace>) [<xref rid="pgen.1008766.ref034" ref-type="bibr">34</xref>] implemented in the GEMMA package [<xref rid="pgen.1008766.ref035" ref-type="bibr">35</xref>] to derive a polygenic risk score on the training set. A posterior probability of inclusion of each SNP was provided and prediction was based on all SNPs with a positive posterior probability. We found that although the <monospace>BSLMM</monospace>-based polygenic risk score leveraged the most SNPs, it did not achieve a comparable prediction accuracy as the other three methods (<xref ref-type="fig" rid="pgen.1008766.g003">Fig 3B</xref>). Likely due to the small effect sizes of these SNPs, only 94, 35 and 1 SNPs had a posterior inclusion probability above 0.05, 0.10 and 0.50, respectively. The model would have further reduced prediction accuracy if the prediction was based only on these SNPs.</p>
      </sec>
      <sec id="sec006">
        <title>GAW20</title>
        <p>In the most recent Genetic Analysis Workship 20 (GAW20), the causal modeling group investigated causal relationships between DNA methylation (exposure) within some genes and the change in high-density lipoproteins ΔHDL (outcome) using Mendelian Randomization (MR) [<xref rid="pgen.1008766.ref036" ref-type="bibr">36</xref>]. Penalized regression methods were used to select SNPs strongly associated with the exposure in order to be used as an instrumental variable (IV) [<xref rid="pgen.1008766.ref037" ref-type="bibr">37</xref>, <xref rid="pgen.1008766.ref038" ref-type="bibr">38</xref>]. However, since GAW20 data consisted of families, <monospace>twostep</monospace> methods were used which could have resulted in a large number of false positives or false negatives. <monospace>ggmix</monospace> now provides an alternative approach that could be used for selecting the IV while accounting for the family structure of the data.</p>
        <p>We applied <monospace>ggmix</monospace> to all 200 GAW20 simulation datasets, each of 679 observations, and compared its performance to the <monospace>twostep</monospace> and <monospace>lasso</monospace> methods. Using a Factored Spectrally Transformed Linear Mixed Model (FaST-LMM) [<xref rid="pgen.1008766.ref039" ref-type="bibr">39</xref>] adjusted for age and sex, we validated the effect of rs9661059 on blood lipid trait to be significant (genome-wide <italic>p</italic> = 6.29 × 10<sup>−9</sup>). Though several other SNPs were also associated with the phenotype, these associations were probably mediated by CpG-SNP interaction pairs and did not reach statistical significance. Therefore, to avoid ambiguity, we only focused on chromosome 1 containing 51,104 SNPs, including rs9661059. Given that population admixture in the GAW20 data was likely, we estimated the population kinship using REAP [<xref rid="pgen.1008766.ref040" ref-type="bibr">40</xref>] after decomposing population compositions using ADMIXTURE [<xref rid="pgen.1008766.ref041" ref-type="bibr">41</xref>]. We used 100,276 LD-pruned whole-genome genotyped SNPs for estimating the kinship. Among these, 8100 were included as covariates in our models based on chromosome 1. The causal SNP was also among the 100,276 SNPs. All methods were fit according to the same settings described in our simulation study, and adjusting for age and sex. We calculated the median (inter-quartile range) number of active variables, and RMSE (standard deviation) based on five-fold CV on each simulated dataset.</p>
        <p>On each simulated replicate, we calibrated the methods so that they could be easily compared by fixing the true positive rate to 1 and then minimizing the false positive rate. Hence, the selected SNP, rs9661059, was likely to be the true positive for each method, and non-causal SNPs were excluded to the greatest extent. All three methods precisely chose the correct predictor without any false positives in more than half of the replicates, as the causal signal was strong. However, when some false positives were selected (i.e. when the number of active variables &gt; 1), <monospace>ggmix</monospace> performed comparably to <monospace>twostep</monospace>, while the <monospace>lasso</monospace> was inclined to select more false positives as suggested by the larger third quartile number of active variables (<xref rid="pgen.1008766.t002" ref-type="table">Table 2</xref>). We also observed that <monospace>ggmix</monospace> outperformed the <monospace>twostep</monospace> method with lower CV RMSE using the same number of SNPs. Meanwhile, it achieved roughly the same prediction accuracy as <monospace>lasso</monospace> but with fewer non-causal SNPs (<xref rid="pgen.1008766.t002" ref-type="table">Table 2</xref>). It is also worth mentioning that there was very little correlation between the causal SNP and SNPs within a 1Mb-window around it (see <xref ref-type="supplementary-material" rid="pgen.1008766.s002">S2 Fig</xref>), making it an ideal scenario for the <monospace>lasso</monospace> and related methods.</p>
        <table-wrap id="pgen.1008766.t002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pgen.1008766.t002</object-id>
          <label>Table 2</label>
          <caption>
            <title>GAW20 simulation study results.</title>
            <p>Summary of model performance based on 200 GAW20 simulations for the <monospace>twostep</monospace>, <monospace>lasso</monospace>, <monospace>ggmix</monospace> and <monospace>BSLMM</monospace> model with different posterior inclusion probability (PIP) thresholds. Five-fold cross-validation root-mean-square error (RMSE) was reported for each simulation replicate. Prediction performance was not reported for <monospace>BSLMM</monospace> with PIP greater than 0.05, 0.10 and 0.50 because some of the replications contained no active SNPs.</p>
          </caption>
          <alternatives>
            <graphic id="pgen.1008766.t002g" xlink:href="pgen.1008766.t002"/>
            <table frame="box" rules="all" border="0">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left" rowspan="1" colspan="1">Method</th>
                  <th align="center" rowspan="1" colspan="1">Model Size</th>
                  <th align="center" rowspan="1" colspan="1">RMSE (SD)</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <monospace>twostep</monospace>
                  </td>
                  <td align="center" rowspan="1" colspan="1">1 (1–11)</td>
                  <td align="center" rowspan="1" colspan="1">0.3604 (0.0242)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <monospace>lasso</monospace>
                  </td>
                  <td align="center" rowspan="1" colspan="1">1 (1–15)</td>
                  <td align="center" rowspan="1" colspan="1">0.3105 (0.0199)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <monospace>ggmix</monospace>
                  </td>
                  <td align="center" rowspan="1" colspan="1">1 (1–12)</td>
                  <td align="center" rowspan="1" colspan="1">0.3146 (0.0210)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <monospace>BSLMM (PIP &gt; 0)</monospace>
                  </td>
                  <td align="center" rowspan="1" colspan="1">40,737 (39,901–41,539)</td>
                  <td align="center" rowspan="1" colspan="1">0.2503 (0.0099)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <monospace>BSLMM (PIP &gt; 0.05)</monospace>
                  </td>
                  <td align="center" rowspan="1" colspan="1">2 (1–4)</td>
                  <td align="center" rowspan="1" colspan="1">-</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <monospace>BSLMM (PIP &gt; 0.10)</monospace>
                  </td>
                  <td align="center" rowspan="1" colspan="1">0 (0–1)</td>
                  <td align="center" rowspan="1" colspan="1">-</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <monospace>BSLMM (PIP &gt; 0.50)</monospace>
                  </td>
                  <td align="center" rowspan="1" colspan="1">0 (0–0)</td>
                  <td align="center" rowspan="1" colspan="1">-</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="t002fn001">
              <p>Note: median (inter-quartile range) is given for model size.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>We also applied the <monospace>BSLMM</monospace> method by performing five-fold CV on each of the 200 simulated replicates. We found that while <monospace>BSLMM</monospace> achieved a lower CV RMSE compared to the other methods (<xref rid="pgen.1008766.t002" ref-type="table">Table 2</xref>), this higher prediction accuracy relied on approximately 80% of the 51,104 SNPs with a positive posterior inclusion probability. This may suggest overfitting in this dataset. We additionally tried imposing a stricter posterior inclusion probability threshold (0.05, 0.10 and 0.50) in order to improve feature selection. These thresholds however, resulted in overly sparse models as most SNPs had a low posterior probability. It is also noteworthy that we did not adjust for age and sex in the <monospace>BSLMM</monospace> model, as the current implementation of the method in the GEMMA package does not allow adjustment for covariates.</p>
      </sec>
      <sec id="sec007">
        <title>Mouse crosses and sensitivity to mycobacterial infection</title>
        <p>Mouse inbred strains of genetically identical individuals are extensively used in research. Crosses of different inbred strains are useful for various studies of heritability focusing on either observable phenotypes or molecular mechanisms, and in particular, recombinant congenic strains have been an extremely useful resource for many years [<xref rid="pgen.1008766.ref042" ref-type="bibr">42</xref>]. However, ignoring complex genetic relationships in association studies can lead to inflated false positives in genetic association studies when different inbred strains and their crosses are investigated [<xref rid="pgen.1008766.ref043" ref-type="bibr">43</xref>–<xref rid="pgen.1008766.ref045" ref-type="bibr">45</xref>]. Therefore, a previous study developed and implemented a mixed model to find loci associated with mouse sensitivity to mycobacterial infection [<xref rid="pgen.1008766.ref046" ref-type="bibr">46</xref>]. The random effects in the model captured complex correlations between the recombinant congenic mouse strains based on the proportion of the DNA shared identical by descent. Through a series of mixed model fits at each marker, new loci that impact growth of mycobacteria on chromosome 1 and chromosome 11 were identified.</p>
        <p>Here we show that <monospace>ggmix</monospace> can identify these loci, as well as potentially others, in a single analysis. We reanalyzed the growth permissiveness in the spleen, as measured by colony forming units (CFUs), 6 weeks after infection from <italic>Mycobacterium</italic>
<italic>bovis</italic> Bacille Calmette-Guerin (BCG) Russia strain as reported in [<xref rid="pgen.1008766.ref046" ref-type="bibr">46</xref>].</p>
        <p>By taking the consensus between the “main model” and the “conditional model” of the original study, we regarded markers D1Mit435 on chromosome 1 and D11Mit119 on chromosome 11 as two true positive loci. We directly estimated the kinship between mice using genotypes at 625 microsatellite markers. The estimated kinship was entered directly into <monospace>ggmix</monospace> and <monospace>twostep</monospace>. For the <monospace>lasso</monospace>, we calculated and included the first 10 principal components of the estimated kinship. To evaluate the robustness of different models, we bootstrapped the 189-sample dataset and repeated the analysis 200 times. We then conceived a two-fold criteria to evaluate performance of each model. We first examined whether a model could pick up both true positive loci using some λ. If the model failed to pick up both loci simultaneously with any λ, we counted as modeling failure on the corresponding boostrap replicate; otherwise, we counted as modeling success and recorded which other loci were picked up given the largest λ. Consequently, similar to the strategy used in the GAW20 analysis, we optimized the models by tuning the penalty factor such that these two true positive loci were picked up, while the number of other active loci was minimized. Significant markers were defined as those captured in at least half of the successful bootstrap replicates (<xref ref-type="fig" rid="pgen.1008766.g004">Fig 4</xref>).</p>
        <fig id="pgen.1008766.g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pgen.1008766.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>Comparison of model performance on the mouse cross data.</title>
            <p>Pie charts depict model robustness where grey areas denote bootstrap replicates on which the corresponding model is unable to capture both true positives using any penalty factor, whereas colored areas denote successful replicates. Chromosome-based signals record in how many successful replicates the corresponding loci are picked up by the corresponding optimized model. Red dashed lines delineate significance thresholds.</p>
          </caption>
          <graphic xlink:href="pgen.1008766.g004"/>
        </fig>
        <p>We demonstrated that <monospace>ggmix</monospace> recognized the true associations more robustly than <monospace>twostep</monospace> and <monospace>lasso</monospace>. In almost all (99%) bootstrap replicates, <monospace>ggmix</monospace> was able to capture both true positives, while the <monospace>twostep</monospace> failed in 19% of the replicates and the <monospace>lasso</monospace> failed in 56% of the replicates by missing at least one of the two true positives (<xref ref-type="fig" rid="pgen.1008766.g004">Fig 4</xref>). The robustness of <monospace>ggmix</monospace> is particularly noteworthy due to the strong correlations between all microsatellite markers in this dataset (see <xref ref-type="supplementary-material" rid="pgen.1008766.s003">S3 Fig</xref>). These strong correlations with the causal markers, partially explain the poor performance of the <monospace>lasso</monospace> as it suffers from unstable selections in the presence of correlated variables (e.g. [<xref rid="pgen.1008766.ref047" ref-type="bibr">47</xref>]).</p>
        <p>We also identified several other loci that might also be associated with susceptibility to mycobacterial infection (<xref rid="pgen.1008766.t003" ref-type="table">Table 3</xref>). Among these new potentially-associated markers, D2Mit156 was found to play a role in control of parasite numbers of <italic>Leishmania</italic>
<italic>tropica</italic> in lymph nodes [<xref rid="pgen.1008766.ref048" ref-type="bibr">48</xref>]. An earlier study identified a parent-of-origin effect at D17Mit221 on CD4M levels [<xref rid="pgen.1008766.ref049" ref-type="bibr">49</xref>]. This effect was more visible in crosses than in parental strains. In addition, D14Mit131, selected only by <monospace>ggmix</monospace>, was found to have a 9% loss of heterozygosity in hybrids of two inbred mouse strains [<xref rid="pgen.1008766.ref050" ref-type="bibr">50</xref>], indicating the potential presence of putative suppressor genes pertaining to immune surveillance and tumor progression [<xref rid="pgen.1008766.ref051" ref-type="bibr">51</xref>]. This result might also suggest association with anti-bacterial responses yet to be discovered.</p>
        <table-wrap id="pgen.1008766.t003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pgen.1008766.t003</object-id>
          <label>Table 3</label>
          <caption>
            <title>Mouse crosses and sensitivity to mycobacterial infection.</title>
            <p>Additional loci significantly associated with mouse susceptibility to mycobacterial infection, after excluding two true positives. Loci needed to be identified in at least 50% of the successful bootstrap replicates that captured both true positive loci.</p>
          </caption>
          <alternatives>
            <graphic id="pgen.1008766.t003g" xlink:href="pgen.1008766.t003"/>
            <table frame="box" rules="all" border="0">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left" rowspan="1" colspan="1">Method</th>
                  <th align="center" rowspan="1" colspan="1">Marker</th>
                  <th align="center" rowspan="1" colspan="1">Position in cM</th>
                  <th align="center" rowspan="1" colspan="1">Position in bp</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <monospace>twostep</monospace>
                  </td>
                  <td align="center" rowspan="1" colspan="1">N/A</td>
                  <td align="center" rowspan="1" colspan="1">N/A</td>
                  <td align="center" rowspan="1" colspan="1">N/A</td>
                </tr>
                <tr>
                  <td align="left" rowspan="2" colspan="1">
                    <monospace>lasso</monospace>
                  </td>
                  <td align="center" rowspan="1" colspan="1">D2Mit156</td>
                  <td align="center" rowspan="1" colspan="1">Chr2:31.66</td>
                  <td align="center" rowspan="1" colspan="1">Chr2:57081653-57081799</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">D14Mit155</td>
                  <td align="center" rowspan="1" colspan="1">Chr14:31.52</td>
                  <td align="center" rowspan="1" colspan="1">Chr14:59828398-59828596</td>
                </tr>
                <tr>
                  <td align="left" rowspan="3" colspan="1">
                    <monospace>ggmix</monospace>
                  </td>
                  <td align="center" rowspan="1" colspan="1">D2Mit156</td>
                  <td align="center" rowspan="1" colspan="1">Chr2:31.66</td>
                  <td align="center" rowspan="1" colspan="1">Chr2:57081653-57081799</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">D14Mit131</td>
                  <td align="center" rowspan="1" colspan="1">Chr14:63.59</td>
                  <td align="center" rowspan="1" colspan="1">Chr14:120006565-120006669</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">D17Mit221</td>
                  <td align="center" rowspan="1" colspan="1">Chr17:59.77</td>
                  <td align="center" rowspan="1" colspan="1">Chr17:90087704-90087842</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="t003fn001">
              <p>Note: median (inter-quartile range) is given for model size.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec008">
    <title>Discussion</title>
    <p>We have developed a general penalized LMM framework called <monospace>ggmix</monospace> which simultaneously selects SNPs and adjusts for population structure in high dimensional prediction models. We compared our method to the <monospace>twostage</monospace> procedure, where in the first stage, the dependence between observations is adjusted for in a LMM with a single random effect and no covariates (i.e. null model). The residuals from this null model can then be used in any model for independent observations because the relatedness has been effectively removed from the original response. We also compared our method to the <monospace>lasso</monospace> and <monospace>BSLMM</monospace> which are closely related to <monospace>ggmix</monospace> since they also jointly model the relatedness and SNPs in a single step. The key differences are that the <monospace>lasso</monospace> uses a principal component adjustment and <monospace>BSLMM</monospace> is a Bayesian method focused on phenotype prediction.</p>
    <p>Through an extensive simulation study and three real data analyses that mimic many experimental designs in genetics, we show that the current approaches of PC adjustment and two-stage procedures are not necessarily sufficient to control for confounding by population structure leading to a high number of false positives. Our simulation results show that <monospace>ggmix</monospace> outperforms existing methods in terms of sparsity and prediction error even when the causal variants are included in the kinship matrix (<xref rid="pgen.1008766.t001" ref-type="table">Table 1</xref>). Many methods for single-SNP analyses avoid this proximal contamination [<xref rid="pgen.1008766.ref008" ref-type="bibr">8</xref>] by using a leave-one-chromosome-out scheme [<xref rid="pgen.1008766.ref052" ref-type="bibr">52</xref>], i.e., construct the kinship matrix using all chromosomes except the one on which the marker being tested is located. However, this approach is not possible if we want to model many SNPs (across many chromosomes) jointly to create, for example, a polygenic risk score. For the purposes of variable selection, we would also want to model all chromosomes together since the power to detect an association for a given SNP may be increased when other causal SNPs have been accounted for. Conversely, a stronger signal from a causal SNP may weaken false signals when modeled jointly [<xref rid="pgen.1008766.ref006" ref-type="bibr">6</xref>], particularly when the markers are highly correlated as in the mouse crosses example.</p>
    <p>In the UK Biobank, we found that with a kinship matrix estimated using all genotyped SNPs, <monospace>ggmix</monospace> had achieved a lower RMSE on the model selection set compared to the <monospace>twostep</monospace> and <monospace>lasso</monospace> methods. Furthermore, an optimized <monospace>ggmix</monospace>-derived polygenic risk score that utilized the least number of SNPs was also able to better predict the trait with lower RMSE on the test set. In the GAW20 example, we showed that while all methods were able to select the strongest causal SNP, <monospace>ggmix</monospace> did so with the least amount of false positives while also maintaining good predictive ability. In the mouse crosses example, we showed that <monospace>ggmix</monospace> is robust to perturbations in the data using a bootstrap analysis. Indeed, <monospace>ggmix</monospace> was able to consistently select the true positives across bootstrap replicates, while <monospace>twostep</monospace> failed in 19% of the replicates and <monospace>lasso</monospace> failed in 56% of the replicates by missing of at least one of the two true positives. Our re-analysis of the data also lead to some potentially new findings, not found by existing methods, that may warrant further study. This particular example had many markers that were strongly correlated with each other (see <xref ref-type="supplementary-material" rid="pgen.1008766.s003">S3 Fig</xref>). Nevertheless, we observed that the two true positive loci were the most often selected while none of the nearby markers were picked up in more than 50% of the 200 bootstrap replicates. This shows that our method does recognize the true positives in the presence of highly correlated markers. Nevertheless, we think the issue of variable selection for correlated SNPs warrants further study. The recently proposed Precision Lasso [<xref rid="pgen.1008766.ref047" ref-type="bibr">47</xref>] seeks to address this problem in the high-dimensional fixed effects model.</p>
    <p>We emphasize here that previously developed methods such as the LMM-lasso [<xref rid="pgen.1008766.ref015" ref-type="bibr">15</xref>] use a two-stage fitting procedure without any convergence details. From a practical point of view, there is currently no implementation that provides a principled way of determining the sequence of tuning parameters to fit, nor a procedure that automatically selects the optimal value of the tuning parameter. To our knowledge, we are the first to develop a coordinate gradient descent (CGD) algorithm in the specific context of fitting a penalized LMM for population structure correction with theoretical guarantees of convergence. Furthermore, we develop a principled method for automatic tuning parameter selection and provide an easy-to-use software implementation in order to promote wider uptake of these more complex methods by applied practitioners.</p>
    <p>Although we derive a CGD algorithm for the <italic>ℓ</italic><sub>1</sub> penalty, our approach can also be easily extended to other penalties such as the elastic net and group lasso with the same guarantees of convergence. A limitation of <monospace>ggmix</monospace> is that it first requires computing the covariance matrix with a computation time of <inline-formula id="pgen.1008766.e015"><alternatives><graphic xlink:href="pgen.1008766.e015.jpg" id="pgen.1008766.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> followed by a spectral decomposition of this matrix in <inline-formula id="pgen.1008766.e016"><alternatives><graphic xlink:href="pgen.1008766.e016.jpg" id="pgen.1008766.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> time where <italic>k</italic> is the number of SNP genotypes used to construct the covariance matrix. This computation becomes prohibitive for large cohorts such as the UK Biobank [<xref rid="pgen.1008766.ref053" ref-type="bibr">53</xref>] which have collected genetic information on half a million individuals. When the matrix of genotypes used to construct the covariance matrix is low rank, there are additional computational speedups that can be implemented. While this has been developed for the univariate case [<xref rid="pgen.1008766.ref008" ref-type="bibr">8</xref>], to our knowledge, this has not been explored in the multivariable case. We are currently developing a low rank version of the penalized LMM developed here, which reduces the time complexity from <inline-formula id="pgen.1008766.e017"><alternatives><graphic xlink:href="pgen.1008766.e017.jpg" id="pgen.1008766.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> to <inline-formula id="pgen.1008766.e018"><alternatives><graphic xlink:href="pgen.1008766.e018.jpg" id="pgen.1008766.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. There is also the issue of how our model scales with an increasing number of covariates (<italic>p</italic>). Due to the coordinate-wise optimization procedure, we expect this to be less of an issue, but still prohibitive for <italic>p</italic> &gt; 1 × 10<sup>5</sup>. The <monospace>biglasso</monospace> package [<xref rid="pgen.1008766.ref054" ref-type="bibr">54</xref>] uses memory mapping strategies for large <italic>p</italic>, and this is something we are exploring for <monospace>ggmix</monospace>.</p>
    <p>As was brought up by a reviewer, the simulations and real data analyses presented here contained many more markers used to estimate the kinship than the sample size (<italic>n</italic>/<italic>k</italic> ≤ 0.1). In the single locus association test, Yang el al. [<xref rid="pgen.1008766.ref022" ref-type="bibr">22</xref>] found that proximal contamination was an issue when <italic>n</italic>/<italic>k</italic> ≈ 1. We believe further theoretical study is needed to see if these results can be generalized to the multivariable models being fit here. Once the computational limitations of sample size mentioned above have been addressed, these theoretical results can be supported by simulation studies.</p>
    <p>There are other applications in which our method could be used as well. For example, there has been a renewed interest in polygenic risk scores (PRS) which aim to predict complex diseases from genotypes. <monospace>ggmix</monospace> could be used to build a PRS with the distinct advantage of modeling SNPs jointly, allowing for main effects as well as interactions to be accounted for. Based on our results, <monospace>ggmix</monospace> has the potential to produce more robust and parsimonious models than the <monospace>lasso</monospace> with better predictive accuracy.</p>
    <p>Our method is also suitable for fine mapping SNP association signals in genomic regions, where the goal is to pinpoint individual variants most likely to impact the undelying biological mechanisms of disease [<xref rid="pgen.1008766.ref055" ref-type="bibr">55</xref>].</p>
  </sec>
  <sec sec-type="materials|methods" id="sec009">
    <title>Materials and methods</title>
    <sec id="sec010">
      <title>Model set-up</title>
      <p>Let <italic>i</italic> = 1, …, <italic>N</italic> be a grouping index, <italic>j</italic> = 1, …, <italic>n</italic><sub><italic>i</italic></sub> the observation index within a group and <inline-formula id="pgen.1008766.e019"><alternatives><graphic xlink:href="pgen.1008766.e019.jpg" id="pgen.1008766.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> the total number of observations. For each group let <inline-formula id="pgen.1008766.e020"><alternatives><graphic xlink:href="pgen.1008766.e020.jpg" id="pgen.1008766.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> be the observed vector of responses or phenotypes, <bold>X</bold><sub><italic>i</italic></sub> an <italic>n</italic><sub><italic>i</italic></sub> × (<italic>p</italic> + 1) design matrix (with the column of 1s for the intercept), <inline-formula id="pgen.1008766.e021"><alternatives><graphic xlink:href="pgen.1008766.e021.jpg" id="pgen.1008766.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> a group-specific random effect vector of length <italic>n</italic><sub><italic>i</italic></sub> and <inline-formula id="pgen.1008766.e022"><alternatives><graphic xlink:href="pgen.1008766.e022.jpg" id="pgen.1008766.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> the individual error terms. Denote the stacked vectors <inline-formula id="pgen.1008766.e023"><alternatives><graphic xlink:href="pgen.1008766.e023.jpg" id="pgen.1008766.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1008766.e024"><alternatives><graphic xlink:href="pgen.1008766.e024.jpg" id="pgen.1008766.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1008766.e025"><alternatives><graphic xlink:href="pgen.1008766.e025.jpg" id="pgen.1008766.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:mrow><mml:mi>ε</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, and the stacked matrix <inline-formula id="pgen.1008766.e026"><alternatives><graphic xlink:href="pgen.1008766.e026.jpg" id="pgen.1008766.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Furthermore, let <inline-formula id="pgen.1008766.e027"><alternatives><graphic xlink:href="pgen.1008766.e027.jpg" id="pgen.1008766.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> be a vector of fixed effects regression coefficients corresponding to <bold>X</bold>. We consider the following linear mixed model with a single random effect [<xref rid="pgen.1008766.ref056" ref-type="bibr">56</xref>]:
<disp-formula id="pgen.1008766.e028"><alternatives><graphic xlink:href="pgen.1008766.e028.jpg" id="pgen.1008766.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>+</mml:mo><mml:mi>ε</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where the random effect <italic><bold>b</bold></italic> and the error variance <italic>ε</italic> are assigned the distributions
<disp-formula id="pgen.1008766.e029"><alternatives><graphic xlink:href="pgen.1008766.e029.jpg" id="pgen.1008766.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo mathvariant="bold">Φ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="2em"/><mml:mi>ε</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="bold">I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Here, <inline-formula id="pgen.1008766.e030"><alternatives><graphic xlink:href="pgen.1008766.e030.jpg" id="pgen.1008766.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:msub><mml:mo mathvariant="bold">Φ</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is a known positive semi-definite and symmetric covariance or kinship matrix calculated from SNPs sampled across the genome, <inline-formula id="pgen.1008766.e031"><alternatives><graphic xlink:href="pgen.1008766.e031.jpg" id="pgen.1008766.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:msub><mml:mi mathvariant="bold">I</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the identity matrix and parameters <italic>σ</italic><sup>2</sup> and <italic>η</italic> ∈ [0, 1] determine how the variance is divided between <italic><bold>b</bold></italic> and <italic>ε</italic>. Note that <italic>η</italic> is also the narrow-sense heritability (<italic>h</italic><sup>2</sup>), defined as the proportion of phenotypic variance attributable to the additive genetic factors [<xref rid="pgen.1008766.ref001" ref-type="bibr">1</xref>]. The joint density of <bold>Y</bold> is therefore multivariate normal:
<disp-formula id="pgen.1008766.e033"><alternatives><graphic xlink:href="pgen.1008766.e033.jpg" id="pgen.1008766.e033g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo mathvariant="bold">Φ</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="bold">I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <p>The LMM-Lasso method [<xref rid="pgen.1008766.ref015" ref-type="bibr">15</xref>] considers an alternative but equivalent parameterization given by:
<disp-formula id="pgen.1008766.e034"><alternatives><graphic xlink:href="pgen.1008766.e034.jpg" id="pgen.1008766.e034g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Φ</mml:mo><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi mathvariant="bold">I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <inline-formula id="pgen.1008766.e035"><alternatives><graphic xlink:href="pgen.1008766.e035.jpg" id="pgen.1008766.e035g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M35"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1008766.e036"><alternatives><graphic xlink:href="pgen.1008766.e036.jpg" id="pgen.1008766.e036g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M36"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> is the genetic variance and <inline-formula id="pgen.1008766.e037"><alternatives><graphic xlink:href="pgen.1008766.e037.jpg" id="pgen.1008766.e037g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M37"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> is the residual variance. We instead consider the parameterization in <xref ref-type="disp-formula" rid="pgen.1008766.e033">Eq 1</xref> since maximization is easier over the compact set <italic>η</italic> ∈ [0, 1] than over the unbounded interval <italic>δ</italic> ∈ [0, ∞) [<xref rid="pgen.1008766.ref056" ref-type="bibr">56</xref>]. We define the complete parameter vector as <bold>Θ</bold> ≔ (<bold><italic>β</italic></bold>, <italic>η</italic>, <italic>σ</italic><sup>2</sup>). The negative log-likelihood for <xref ref-type="disp-formula" rid="pgen.1008766.e033">Eq 1</xref> is given by
<disp-formula id="pgen.1008766.e038"><alternatives><graphic xlink:href="pgen.1008766.e038.jpg" id="pgen.1008766.e038g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M38"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>−</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∝</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mo>(</mml:mo><mml:mtext>det</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold">V</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi mathvariant="bold">V</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
where <bold>V</bold> = <italic>η</italic>
<bold>Φ</bold> + (1 − <italic>η</italic>)<bold>I</bold> and det(<bold>V</bold>) is the determinant of <bold>V</bold>.</p>
      <p>Let <bold>Φ</bold> = <bold>UDU</bold><sup><italic>T</italic></sup> be the eigen (spectral) decomposition of the kinship matrix <bold>Φ</bold>, where <inline-formula id="pgen.1008766.e039"><alternatives><graphic xlink:href="pgen.1008766.e039.jpg" id="pgen.1008766.e039g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M39"><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is an orthonormal matrix of eigenvectors (i.e. <bold>UU</bold><sup><italic>T</italic></sup> = <bold>I</bold>) and <inline-formula id="pgen.1008766.e040"><alternatives><graphic xlink:href="pgen.1008766.e040.jpg" id="pgen.1008766.e040g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M40"><mml:msub><mml:mi mathvariant="bold">D</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is a diagonal matrix of eigenvalues Λ<sub><italic>i</italic></sub>. <bold>V</bold> can then be further simplified [<xref rid="pgen.1008766.ref056" ref-type="bibr">56</xref>]
<disp-formula id="pgen.1008766.e041"><alternatives><graphic xlink:href="pgen.1008766.e041.jpg" id="pgen.1008766.e041g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mi mathvariant="bold">V</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:mo mathvariant="bold">Φ</mml:mo><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">D</mml:mi><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">I</mml:mi><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mi>η</mml:mi><mml:mi mathvariant="bold">D</mml:mi><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="bold">I</mml:mi><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mo>(</mml:mo><mml:mi>η</mml:mi><mml:mi mathvariant="bold">D</mml:mi><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>)</mml:mo><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mover accent="true"><mml:mi mathvariant="bold">D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
where
<disp-formula id="pgen.1008766.e042"><alternatives><graphic xlink:href="pgen.1008766.e042.jpg" id="pgen.1008766.e042g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M42"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mover accent="true"><mml:mi mathvariant="bold">D</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:mi mathvariant="bold">D</mml:mi><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mo>Λ</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd><mml:msub><mml:mo>Λ</mml:mo><mml:mn>2</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd><mml:msub><mml:mo>Λ</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
<disp-formula id="pgen.1008766.e043"><alternatives><graphic xlink:href="pgen.1008766.e043.jpg" id="pgen.1008766.e043g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mtext>diag</mml:mtext><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
Since <xref ref-type="disp-formula" rid="pgen.1008766.e042">Eq 5</xref> is a diagonal matrix, its inverse is also a diagonal matrix:
<disp-formula id="pgen.1008766.e044"><alternatives><graphic xlink:href="pgen.1008766.e044.jpg" id="pgen.1008766.e044g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M44"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>=</mml:mo><mml:mtext>diag</mml:mtext><mml:mo>{</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula></p>
      <p>From Eqs <xref ref-type="disp-formula" rid="pgen.1008766.e041">4</xref> and <xref ref-type="disp-formula" rid="pgen.1008766.e043">6</xref>, log(det(<bold>V</bold>)) simplifies to
<disp-formula id="pgen.1008766.e045"><alternatives><graphic xlink:href="pgen.1008766.e045.jpg" id="pgen.1008766.e045g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M45"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo>(</mml:mo><mml:mtext>det</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold">V</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mo>(</mml:mo><mml:mtext>det</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext>det</mml:mtext><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mtext>det</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mo>{</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
since det(<bold>U</bold>) = 1. It also follows from <xref ref-type="disp-formula" rid="pgen.1008766.e041">Eq 4</xref> that
<disp-formula id="pgen.1008766.e046"><alternatives><graphic xlink:href="pgen.1008766.e046.jpg" id="pgen.1008766.e046g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M46"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mi mathvariant="bold">V</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mover accent="true"><mml:mi mathvariant="bold">D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula>
since for an orthonormal matrix <bold>U</bold><sup>−1</sup> = <bold>U</bold><sup><italic>T</italic></sup>. Substituting Eqs <xref ref-type="disp-formula" rid="pgen.1008766.e044">7</xref>, <xref ref-type="disp-formula" rid="pgen.1008766.e045">8</xref> and <xref ref-type="disp-formula" rid="pgen.1008766.e046">9</xref> into <xref ref-type="disp-formula" rid="pgen.1008766.e038">Eq 3</xref> the negative log-likelihood becomes
<disp-formula id="pgen.1008766.e047"><alternatives><graphic xlink:href="pgen.1008766.e047.jpg" id="pgen.1008766.e047g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>−</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∝</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula>
where <inline-formula id="pgen.1008766.e048"><alternatives><graphic xlink:href="pgen.1008766.e048.jpg" id="pgen.1008766.e048g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M48"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1008766.e049"><alternatives><graphic xlink:href="pgen.1008766.e049.jpg" id="pgen.1008766.e049g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M49"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">X</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1008766.e050"><alternatives><graphic xlink:href="pgen.1008766.e050.jpg" id="pgen.1008766.e050g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M50"><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> denotes the <italic>i</italic><sup>th</sup> element of <inline-formula id="pgen.1008766.e051"><alternatives><graphic xlink:href="pgen.1008766.e051.jpg" id="pgen.1008766.e051g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M51"><mml:mover accent="true"><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1008766.e052"><alternatives><graphic xlink:href="pgen.1008766.e052.jpg" id="pgen.1008766.e052g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M52"><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the <italic>i</italic>, <italic>j</italic><sup>th</sup> entry of <inline-formula id="pgen.1008766.e053"><alternatives><graphic xlink:href="pgen.1008766.e053.jpg" id="pgen.1008766.e053g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M53"><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <bold>1</bold> is a column vector of <italic>N</italic><sub><italic>T</italic></sub> ones.</p>
    </sec>
    <sec id="sec011">
      <title>Penalized maximum likelihood estimator</title>
      <p>We define the <italic>p</italic> + 3 length vector of parameters <bold>Θ</bold> ≔ (Θ<sub>0</sub>, Θ<sub>1</sub>, …, Θ<sub><italic>p</italic>+1</sub>, Θ<sub><italic>p</italic>+2</sub>, Θ<sub><italic>p</italic>+3</sub>) = (<italic><bold>β</bold></italic>, <italic>η</italic>, <italic>σ</italic><sup>2</sup>) where <inline-formula id="pgen.1008766.e054"><alternatives><graphic xlink:href="pgen.1008766.e054.jpg" id="pgen.1008766.e054g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M54"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. In what follows, <italic>p</italic> + 2 and <italic>p</italic> + 3 are the indices in <bold>Θ</bold> for <italic>η</italic> and <italic>σ</italic><sup>2</sup>, respectively. In light of our goals to select variables associated with the response in high-dimensional data, we propose to place a constraint on the magnitude of the regression coefficients. This can be achieved by adding a penalty term to the likelihood function <xref ref-type="disp-formula" rid="pgen.1008766.e047">Eq 10</xref>. The penalty term is a necessary constraint because in our applications, the sample size is much smaller than the number of predictors. We define the following objective function:
<disp-formula id="pgen.1008766.e055"><alternatives><graphic xlink:href="pgen.1008766.e055.jpg" id="pgen.1008766.e055g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M55"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>λ</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>f</italic>(<bold>Θ</bold>) ≔ −<italic>ℓ</italic>(<bold>Θ</bold>) is defined in <xref ref-type="disp-formula" rid="pgen.1008766.e047">Eq 10</xref>, <italic>P</italic><sub><italic>j</italic></sub>(⋅) is a penalty term on the fixed regression coefficients <italic>β</italic><sub>1</sub>, …, <italic>β</italic><sub><italic>p</italic>+1</sub> (we do not penalize the intercept) controlled by the nonnegative regularization parameter λ, and <italic>v</italic><sub><italic>j</italic></sub> is the penalty factor for <italic>j</italic>th covariate. These penalty factors serve as a way of allowing parameters to be penalized differently. Note that we do not penalize <italic>η</italic> or <italic>σ</italic><sup>2</sup>. An estimate of the regression parameters <inline-formula id="pgen.1008766.e056"><alternatives><graphic xlink:href="pgen.1008766.e056.jpg" id="pgen.1008766.e056g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M56"><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>^</mml:mo></mml:mover><mml:mo>λ</mml:mo></mml:msub></mml:math></alternatives></inline-formula> is obtained by
<disp-formula id="pgen.1008766.e057"><alternatives><graphic xlink:href="pgen.1008766.e057.jpg" id="pgen.1008766.e057g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M57"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>^</mml:mo></mml:mover><mml:mo>λ</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mspace width="2pt"/><mml:mtext>min</mml:mtext></mml:mrow><mml:mo mathvariant="bold">Θ</mml:mo></mml:munder><mml:mspace width="2pt"/><mml:msub><mml:mi>Q</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(11)</label></disp-formula>
This is the general set-up for our model. In the next Section we provide more specific details on how we solve <xref ref-type="disp-formula" rid="pgen.1008766.e057">Eq 11</xref>. We note here that the main difference between the proposed model, and the <monospace>lmmlasso</monospace> [<xref rid="pgen.1008766.ref057" ref-type="bibr">57</xref>], is that we rotate the response vector <italic>Y</italic> and the design matrix <italic><bold>X</bold></italic> by the eigen vectors of the kinship matrix. This results in a diagonal covariance matrix making our method orders of magnitude faster and usable for high-dimensional genetic data. A secondary difference is that we are limiting ourselves to a single unpenalized random effect.</p>
    </sec>
    <sec id="sec012">
      <title>Computational algorithm</title>
      <p>We use a general purpose block coordinate gradient descent algorithm (CGD) [<xref rid="pgen.1008766.ref058" ref-type="bibr">58</xref>] to solve <xref ref-type="disp-formula" rid="pgen.1008766.e057">Eq 11</xref>. At each iteration, we cycle through the coordinates and minimize the objective function with respect to one coordinate only. For continuously differentiable <italic>f</italic>(⋅) and convex and block-separable <italic>P</italic>(⋅) (i.e. <italic>P</italic>(<italic><bold>β</bold></italic>) = ∑<sub><italic>i</italic></sub>
<italic>P</italic><sub><italic>i</italic></sub>(<italic>β</italic><sub><italic>i</italic></sub>)), Tseng and Yun [<xref rid="pgen.1008766.ref058" ref-type="bibr">58</xref>] show that the solution generated by the CGD method is a stationary point of <italic>Q</italic><sub>λ</sub>(⋅) if the coordinates are updated in a Gauss-Seidel manner i.e. <italic>Q</italic><sub>λ</sub>(⋅) is minimized with respect to one parameter while holding all others fixed. The CGD algorithm has been successfully applied in fixed effects models (e.g. [<xref rid="pgen.1008766.ref020" ref-type="bibr">20</xref>, <xref rid="pgen.1008766.ref059" ref-type="bibr">59</xref>]) and linear mixed models with an <italic>ℓ</italic><sub>1</sub> penalty [<xref rid="pgen.1008766.ref057" ref-type="bibr">57</xref>]. In the next section we provide some brief details about Algorithm 1. A more thorough treatment of the algorithm is given in <xref ref-type="supplementary-material" rid="pgen.1008766.s004">S1 Text</xref>.</p>
      <p><bold>Algorithm 1</bold>: Block Coordinate Gradient Descent</p>
      <p specific-use="line">Set the iteration counter <italic>k</italic> ← 0, initial values for the parameter vector <bold>Θ</bold><sup>(0)</sup> and convergence threshold <italic>ϵ</italic>;</p>
      <p specific-use="line"><bold>for</bold> λ ∈ {λ<sub><italic>max</italic></sub>, …, λ<sub><italic>min</italic></sub>} <bold>do</bold></p>
      <p specific-use="line"> <bold>repeat</bold></p>
      <p specific-use="line">
        <disp-formula id="pgen.1008766.e058">
          <alternatives>
            <graphic xlink:href="pgen.1008766.e058.jpg" id="pgen.1008766.e058g" mimetype="image" position="anchor" orientation="portrait"/>
            <mml:math id="M58">
              <mml:mtable displaystyle="true">
                <mml:mtr>
                  <mml:mtd>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">β</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>k</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mrow>
                      <mml:mo>←</mml:mo>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mtext>arg</mml:mtext>
                          <mml:mspace width="4pt"/>
                          <mml:mtext>min</mml:mtext>
                        </mml:mrow>
                        <mml:mi mathvariant="bold-italic">β</mml:mi>
                      </mml:munder>
                      <mml:mspace width="4pt"/>
                      <mml:msub>
                        <mml:mi>Q</mml:mi>
                        <mml:mo>λ</mml:mo>
                      </mml:msub>
                      <mml:mo>(</mml:mo>
                      <mml:mi mathvariant="bold-italic">β</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:msup>
                        <mml:mi>η</mml:mi>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mi>k</mml:mi>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>,</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mi>σ</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mspace width="0.166667em"/>
                          <mml:mspace width="0.166667em"/>
                          <mml:mo>(</mml:mo>
                          <mml:mi>k</mml:mi>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msup>
                      <mml:mi>η</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>k</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mrow>
                      <mml:mo>←</mml:mo>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mtext>arg</mml:mtext>
                          <mml:mspace width="4pt"/>
                          <mml:mtext>min</mml:mtext>
                        </mml:mrow>
                        <mml:mi>η</mml:mi>
                      </mml:munder>
                      <mml:mspace width="4pt"/>
                      <mml:msub>
                        <mml:mi>Q</mml:mi>
                        <mml:mo>λ</mml:mo>
                      </mml:msub>
                      <mml:mo>(</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">β</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mi>k</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>,</mml:mo>
                      <mml:mi>η</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mi>σ</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mspace width="0.166667em"/>
                          <mml:mspace width="0.166667em"/>
                          <mml:mo>(</mml:mo>
                          <mml:mi>k</mml:mi>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msup>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mi>σ</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mspace width="0.166667em"/>
                        <mml:mspace width="0.166667em"/>
                        <mml:mo>(</mml:mo>
                        <mml:mi>k</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mrow>
                      <mml:mo>←</mml:mo>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mtext>arg</mml:mtext>
                          <mml:mspace width="4pt"/>
                          <mml:mtext>min</mml:mtext>
                        </mml:mrow>
                        <mml:msup>
                          <mml:mi>σ</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:munder>
                      <mml:mspace width="4pt"/>
                      <mml:msub>
                        <mml:mi>Q</mml:mi>
                        <mml:mo>λ</mml:mo>
                      </mml:msub>
                      <mml:mo>(</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">β</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mi>k</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>,</mml:mo>
                      <mml:msup>
                        <mml:mi>η</mml:mi>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mi>k</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>,</mml:mo>
                      <mml:msup>
                        <mml:mi>σ</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p specific-use="line">  <italic>k</italic> ← <italic>k</italic> + 1</p>
      <p specific-use="line"> <bold>until</bold>
<italic>convergence criterion is satisfied</italic>: ‖<bold>Θ</bold><sup>(<italic>k</italic>+1)</sup> − <bold>Θ</bold><sup>(<italic>k</italic>)</sup>‖<sub>2</sub> &lt; <italic>ϵ</italic>;</p>
      <p specific-use="line">end</p>
      <sec id="sec013">
        <title>Updates for the <italic>β</italic> parameter</title>
        <p>Recall that the part of the objective function that depends on <italic><bold>β</bold></italic> has the form
<disp-formula id="pgen.1008766.e059"><alternatives><graphic xlink:href="pgen.1008766.e059.jpg" id="pgen.1008766.e059g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M59"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mo>λ</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where
<disp-formula id="pgen.1008766.e060"><alternatives><graphic xlink:href="pgen.1008766.e060.jpg" id="pgen.1008766.e060g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M60"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≔</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
        <p>Conditional on <italic>η</italic><sup>(<italic>k</italic>)</sup> and <italic>σ</italic><sup>2</sup><sup>(<italic>k</italic>)</sup>, it can be shown that the solution for <italic>β</italic><sub><italic>j</italic></sub>, <italic>j</italic> = 1, …, <italic>p</italic> is given by
<disp-formula id="pgen.1008766.e061"><alternatives><graphic xlink:href="pgen.1008766.e061.jpg" id="pgen.1008766.e061g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M61"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>←</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mo>(</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>ℓ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1008766.e062"><alternatives><graphic xlink:href="pgen.1008766.e062.jpg" id="pgen.1008766.e062g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M62"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the soft-thresholding operator
<disp-formula id="pgen.1008766.e063"><alternatives><graphic xlink:href="pgen.1008766.e063.jpg" id="pgen.1008766.e063g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M63"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>sign</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>λ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
sign(<italic>x</italic>) is the signum function
<disp-formula id="pgen.1008766.e064"><alternatives><graphic xlink:href="pgen.1008766.e064.jpg" id="pgen.1008766.e064g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M64"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>sign</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and (<italic>x</italic>)<sub>+</sub> = max(<italic>x</italic>, 0). We provide the full derivation in <xref ref-type="supplementary-material" rid="pgen.1008766.s004">S1 Text</xref>.</p>
      </sec>
      <sec id="sec014">
        <title>Updates for the <italic>η</italic> paramter</title>
        <p>Given <italic><bold>β</bold></italic><sup>(<italic>k</italic>+1)</sup> and <italic>σ</italic><sup>2</sup><sup>(<italic>k</italic>)</sup>, solving for <italic>η</italic><sup>(<italic>k</italic>+1)</sup> becomes a univariate optimization problem:
<disp-formula id="pgen.1008766.e065"><alternatives><graphic xlink:href="pgen.1008766.e065.jpg" id="pgen.1008766.e065g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M65"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>←</mml:mo><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mspace width="4pt"/><mml:mtext>min</mml:mtext></mml:mrow><mml:mi>η</mml:mi></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
We use a bound constrained optimization algorithm [<xref rid="pgen.1008766.ref060" ref-type="bibr">60</xref>] implemented in the <monospace>optim</monospace> function in <monospace>R</monospace> and set the lower and upper bounds to be 0.01 and 0.99, respectively.</p>
      </sec>
      <sec id="sec015">
        <title>Updates for the <italic>σ</italic><sup>2</sup> parameter</title>
        <p>Conditional on <italic><bold>β</bold></italic><sup>(<italic>k</italic>+1)</sup> and <italic>η</italic><sup>(<italic>k</italic>+1)</sup>, <italic>σ</italic><sup>2</sup><sup>(<italic>k</italic>+1)</sup> can be solved for using the following equation:
<disp-formula id="pgen.1008766.e066"><alternatives><graphic xlink:href="pgen.1008766.e066.jpg" id="pgen.1008766.e066g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M66"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>←</mml:mo><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mspace width="4pt"/><mml:mtext>min</mml:mtext></mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:munder><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(12)</label></disp-formula></p>
        <p>There exists an analytic solution for <xref ref-type="disp-formula" rid="pgen.1008766.e066">Eq 12</xref> given by:
<disp-formula id="pgen.1008766.e067"><alternatives><graphic xlink:href="pgen.1008766.e067.jpg" id="pgen.1008766.e067g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M67"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>←</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mi>β</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
      </sec>
      <sec id="sec016">
        <title>Regularization path</title>
        <p>In this section we describe how to determine the sequence of tuning parameters λ at which to fit the model. Recall that our objective function has the form
<disp-formula id="pgen.1008766.e068"><alternatives><graphic xlink:href="pgen.1008766.e068.jpg" id="pgen.1008766.e068g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M68"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mo>λ</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(13)</label></disp-formula>
The Karush-Kuhn-Tucker (KKT) optimality conditions for <xref ref-type="disp-formula" rid="pgen.1008766.e068">Eq 13</xref> are given by:
<disp-formula id="pgen.1008766.e069"><alternatives><graphic xlink:href="pgen.1008766.e069.jpg" id="pgen.1008766.e069g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M69"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>Q</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mn mathvariant="bold">0</mml:mn><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>Q</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>η</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mi>Q</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mi>Q</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(14)</label></disp-formula></p>
        <p>The equations in <xref ref-type="disp-formula" rid="pgen.1008766.e069">Eq 14</xref> are equivalent to
<disp-formula id="pgen.1008766.e070"><alternatives><graphic xlink:href="pgen.1008766.e070.jpg" id="pgen.1008766.e070g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M70"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>λ</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtext>sign</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>[</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo/><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mtext>for</mml:mtext><mml:mspace width="2em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mfrac><mml:mrow><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(15)</label></disp-formula>
where <italic>w</italic><sub><italic>i</italic></sub> is given by Eq, <inline-formula id="pgen.1008766.e071"><alternatives><graphic xlink:href="pgen.1008766.e071.jpg" id="pgen.1008766.e071g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M71"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is <inline-formula id="pgen.1008766.e072"><alternatives><graphic xlink:href="pgen.1008766.e072.jpg" id="pgen.1008766.e072g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M72"><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup></mml:math></alternatives></inline-formula> with the first column removed, <inline-formula id="pgen.1008766.e073"><alternatives><graphic xlink:href="pgen.1008766.e073.jpg" id="pgen.1008766.e073g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M73"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the first column of <inline-formula id="pgen.1008766.e074"><alternatives><graphic xlink:href="pgen.1008766.e074.jpg" id="pgen.1008766.e074g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M74"><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup></mml:math></alternatives></inline-formula>, and <inline-formula id="pgen.1008766.e075"><alternatives><graphic xlink:href="pgen.1008766.e075.jpg" id="pgen.1008766.e075g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M75"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is the subgradient function of the <italic>ℓ</italic><sub>1</sub> norm evaluated at <inline-formula id="pgen.1008766.e076"><alternatives><graphic xlink:href="pgen.1008766.e076.jpg" id="pgen.1008766.e076g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M76"><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Therefore <inline-formula id="pgen.1008766.e077"><alternatives><graphic xlink:href="pgen.1008766.e077.jpg" id="pgen.1008766.e077g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M77"><mml:mover accent="true"><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is a solution in <xref ref-type="disp-formula" rid="pgen.1008766.e057">Eq 11</xref> if and only if <inline-formula id="pgen.1008766.e078"><alternatives><graphic xlink:href="pgen.1008766.e078.jpg" id="pgen.1008766.e078g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M78"><mml:mover accent="true"><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> satisfies <xref ref-type="disp-formula" rid="pgen.1008766.e070">Eq 15</xref> for some <italic>γ</italic>. We can determine a decreasing sequence of tuning parameters by starting at a maximal value for λ = λ<sub><italic>max</italic></sub> for which <inline-formula id="pgen.1008766.e079"><alternatives><graphic xlink:href="pgen.1008766.e079.jpg" id="pgen.1008766.e079g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M79"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> for <italic>j</italic> = 1, …, <italic>p</italic>. In this case, the KKT conditions in <xref ref-type="disp-formula" rid="pgen.1008766.e070">Eq 15</xref> are equivalent to
<disp-formula id="pgen.1008766.e080"><alternatives><graphic xlink:href="pgen.1008766.e080.jpg" id="pgen.1008766.e080g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M80"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mo>λ</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mfrac><mml:mrow><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(16)</label></disp-formula>
We can solve the KKT system of equations in <xref ref-type="disp-formula" rid="pgen.1008766.e080">Eq 16</xref> (with a numerical solution for <italic>η</italic>) in order to have an explicit form of the stationary point <inline-formula id="pgen.1008766.e081"><alternatives><graphic xlink:href="pgen.1008766.e081.jpg" id="pgen.1008766.e081g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M81"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mn mathvariant="bold">0</mml:mn><mml:mi>p</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Once we have <inline-formula id="pgen.1008766.e082"><alternatives><graphic xlink:href="pgen.1008766.e082.jpg" id="pgen.1008766.e082g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M82"><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:math></alternatives></inline-formula>, we can solve for the smallest value of λ such that the entire vector (<inline-formula id="pgen.1008766.e083"><alternatives><graphic xlink:href="pgen.1008766.e083.jpg" id="pgen.1008766.e083g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M83"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>) is 0:
<disp-formula id="pgen.1008766.e084"><alternatives><graphic xlink:href="pgen.1008766.e084.jpg" id="pgen.1008766.e084g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M84"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>λ</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mtext>max</mml:mtext><mml:mi>j</mml:mi></mml:munder><mml:mo>{</mml:mo><mml:mo>|</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mover accent="true"><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Following Friedman et al. [<xref rid="pgen.1008766.ref020" ref-type="bibr">20</xref>], we choose <italic>τ</italic>λ<sub><italic>max</italic></sub> to be the smallest value of tuning parameters λ<sub><italic>min</italic></sub>, and construct a sequence of <italic>K</italic> values decreasing from λ<sub><italic>max</italic></sub> to λ<sub><italic>min</italic></sub> on the log scale. The defaults are set to <italic>K</italic> = 100, <italic>τ</italic> = 0.01 if <italic>n</italic> &lt; <italic>p</italic> and <italic>τ</italic> = 0.001 if <italic>n</italic> ≥ <italic>p</italic>.</p>
      </sec>
      <sec id="sec017">
        <title>Warm starts</title>
        <p>The way in which we have derived the sequence of tuning parameters using the KKT conditions, allows us to implement warm starts. That is, the solution <inline-formula id="pgen.1008766.e085"><alternatives><graphic xlink:href="pgen.1008766.e085.jpg" id="pgen.1008766.e085g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M85"><mml:mover accent="true"><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> for λ<sub><italic>k</italic></sub> is used as the initial value Θ<sup>(0)</sup> for λ<sub><italic>k</italic>+1</sub>. This strategy leads to computational speedups and has been implemented in the <monospace>ggmix</monospace> R package.</p>
      </sec>
      <sec id="sec018">
        <title>Prediction of the random effects</title>
        <p>We use an empirical Bayes approach (e.g. [<xref rid="pgen.1008766.ref061" ref-type="bibr">61</xref>]) to predict the random effects <italic><bold>b</bold></italic>. Let the maximum a posteriori (MAP) estimate be defined as
<disp-formula id="pgen.1008766.e086"><alternatives><graphic xlink:href="pgen.1008766.e086.jpg" id="pgen.1008766.e086g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M86"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mo form="prefix">arg max</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi></mml:munder><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(17)</label></disp-formula>
where, by using Bayes rule, <italic>f</italic>(<italic><bold>b</bold></italic>|<bold>Y</bold>, <italic><bold>β</bold></italic>, <italic>η</italic>, <italic>σ</italic><sup>2</sup>) can be expressed as
<disp-formula id="pgen.1008766.e087"><alternatives><graphic xlink:href="pgen.1008766.e087.jpg" id="pgen.1008766.e087g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M87"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>|</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>∝</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>|</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>∝</mml:mo><mml:mtext>exp</mml:mtext><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>η</mml:mi><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo mathvariant="bold">Φ</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>[</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>η</mml:mi></mml:mfrac><mml:msup><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo mathvariant="bold">Φ</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>]</mml:mo><mml:mo>}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(18)</label></disp-formula>
Solving for <xref ref-type="disp-formula" rid="pgen.1008766.e086">Eq 17</xref> is equivalent to minimizing the exponent in <xref ref-type="disp-formula" rid="pgen.1008766.e087">Eq 18</xref>:
<disp-formula id="pgen.1008766.e088"><alternatives><graphic xlink:href="pgen.1008766.e088.jpg" id="pgen.1008766.e088g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M88"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mspace width="4pt"/><mml:mtext>min</mml:mtext></mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:munder><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>η</mml:mi></mml:mfrac><mml:msup><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo mathvariant="bold">Φ</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(19)</label></disp-formula>
Taking the derivative of <xref ref-type="disp-formula" rid="pgen.1008766.e088">Eq 19</xref> with respect to <italic><bold>b</bold></italic> and setting it to 0 we get:
<disp-formula id="pgen.1008766.e089"><alternatives><graphic xlink:href="pgen.1008766.e089.jpg" id="pgen.1008766.e089g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M89"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mi>η</mml:mi></mml:mfrac><mml:msup><mml:mrow><mml:mo mathvariant="bold">Φ</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>η</mml:mi></mml:mfrac><mml:msup><mml:mrow><mml:mo mathvariant="bold">Φ</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">I</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>η</mml:mi></mml:mfrac><mml:msup><mml:mrow><mml:mo mathvariant="bold">Φ</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">I</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mfrac><mml:msup><mml:mrow><mml:mo mathvariant="bold">Φ</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">I</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mfrac><mml:mi mathvariant="bold">U</mml:mi><mml:msup><mml:mi mathvariant="bold">D</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1008766.e090"><alternatives><graphic xlink:href="pgen.1008766.e090.jpg" id="pgen.1008766.e090g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M90"><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are the estimates obtained from Algorithm 1.</p>
      </sec>
      <sec id="sec019">
        <title>Phenotype prediction</title>
        <p>Here we describe the method used for predicting the unobserved phenotype <bold>Y</bold><sup>⋆</sup> in a set of individuals with predictor set <bold>X</bold><sup>⋆</sup> that were not used in the model training e.g. a testing set. Let <italic>q</italic> denote the number of observations in the testing set and <italic>N</italic> − <italic>q</italic> the number of observations in the training set. We assume that a <monospace>ggmix</monospace> model has been fit on a set of training individuals with observed phenotype <bold>Y</bold> and predictor set <bold>X</bold>. We further assume that <bold>Y</bold> and <bold>Y</bold><sup>⋆</sup> are jointly multivariate Normal:
<disp-formula id="pgen.1008766.e091"><alternatives><graphic xlink:href="pgen.1008766.e091.jpg" id="pgen.1008766.e091g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M91"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mrow/><mml:mi mathvariant="bold">Y</mml:mi><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>⋆</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mrow><mml:msub><mml:mtext>1</mml:mtext><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mrow><mml:msub><mml:mtext>2</mml:mtext><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>×</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></alternatives></disp-formula></p>
        <p>Then, from standard multivariate Normal theory, the conditional distribution <bold>Y</bold><sup>⋆</sup>|<bold>Y</bold>, <italic>η</italic>, <italic>σ</italic><sup>2</sup>, <italic>β</italic>, <bold>X</bold>, <bold>X</bold><sup>⋆</sup> is <inline-formula id="pgen.1008766.e092"><alternatives><graphic xlink:href="pgen.1008766.e092.jpg" id="pgen.1008766.e092g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M92"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>⋆</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo mathvariant="bold">Σ</mml:mo></mml:mrow><mml:mo>⋆</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> where
<disp-formula id="pgen.1008766.e093"><alternatives><graphic xlink:href="pgen.1008766.e093.jpg" id="pgen.1008766.e093g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M93"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mo>⋆</mml:mo></mml:msup></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mn>12</mml:mn></mml:msub><mml:msubsup><mml:mo mathvariant="bold">Σ</mml:mo><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:mo mathvariant="bold">Σ</mml:mo></mml:mrow><mml:mo>⋆</mml:mo></mml:msup></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mn>11</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mn>12</mml:mn></mml:msub><mml:msubsup><mml:mo mathvariant="bold">Σ</mml:mo><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mn>21</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
        <p>The phenotype prediction is thus given by:
<disp-formula id="pgen.1008766.e094"><alternatives><graphic xlink:href="pgen.1008766.e094.jpg" id="pgen.1008766.e094g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M94"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>⋆</mml:mo></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mn>12</mml:mn></mml:msub><mml:msup><mml:mi mathvariant="bold">V</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mn>12</mml:mn></mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mn>12</mml:mn></mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mi>η</mml:mi><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mo mathvariant="bold">Φ</mml:mo></mml:mrow><mml:mo>⋆</mml:mo></mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:msup><mml:mrow><mml:mo mathvariant="bold">Φ</mml:mo></mml:mrow><mml:mo>⋆</mml:mo></mml:msup><mml:mi mathvariant="bold">U</mml:mi><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <bold>Φ</bold><sup>⋆</sup> is the <italic>q</italic> × (<italic>N</italic> − <italic>q</italic>) covariance matrix between the testing and training individuals.</p>
      </sec>
      <sec id="sec020">
        <title>Choice of the optimal tuning parameter</title>
        <p>In order to choose the optimal value of the tuning parameter λ, we use the generalized information criterion [<xref rid="pgen.1008766.ref062" ref-type="bibr">62</xref>] (GIC):
<disp-formula id="pgen.1008766.e095"><alternatives><graphic xlink:href="pgen.1008766.e095.jpg" id="pgen.1008766.e095g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M95"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi><mml:mi>I</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>ℓ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>λ</mml:mo></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pgen.1008766.e096"><alternatives><graphic xlink:href="pgen.1008766.e096.jpg" id="pgen.1008766.e096g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M96"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>λ</mml:mo></mml:msub></mml:math></alternatives></inline-formula> is the number of non-zero elements in <inline-formula id="pgen.1008766.e032"><alternatives><graphic xlink:href="pgen.1008766.e032.jpg" id="pgen.1008766.e032g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M32"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>λ</mml:mo></mml:msub></mml:math></alternatives></inline-formula> [<xref rid="pgen.1008766.ref063" ref-type="bibr">63</xref>] plus two (representing the variance parameters <italic>η</italic> and <italic>σ</italic><sup>2</sup>). Several authors have used this criterion for variable selection in mixed models with <italic>a</italic><sub><italic>n</italic></sub> = log <italic>N</italic><sub><italic>T</italic></sub> [<xref rid="pgen.1008766.ref057" ref-type="bibr">57</xref>, <xref rid="pgen.1008766.ref064" ref-type="bibr">64</xref>], which corresponds to the BIC. We instead choose the high-dimensional BIC [<xref rid="pgen.1008766.ref065" ref-type="bibr">65</xref>] given by <italic>a</italic><sub><italic>n</italic></sub> = log(log(<italic>N</italic><sub><italic>T</italic></sub>)) * log(<italic>p</italic>). This is the default choice in our <monospace>ggmix</monospace> R package, though the interface is flexible to allow the user to select their choice of <italic>a</italic><sub><italic>n</italic></sub>.</p>
      </sec>
    </sec>
    <sec id="sec021">
      <title>Software availability</title>
      <p>The <monospace>ggmix</monospace> method is written in an R package, which is freely available on CRAN at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=ggmix">https://cran.r-project.org/package=ggmix</ext-link>. The complete documentation for this package is available at <ext-link ext-link-type="uri" xlink:href="https://sahirbhatnagar.com/ggmix/">https://sahirbhatnagar.com/ggmix/</ext-link>. Scripts for running the analyses and reproducing the tables and figures reported in the manuscript are available in an <monospace>RMarkdown</monospace> document at <ext-link ext-link-type="uri" xlink:href="https://github.com/sahirbhatnagar/ggmix/blob/master/manuscript/bin/tables-figures.Rmd">https://github.com/sahirbhatnagar/ggmix/blob/master/manuscript/bin/tables-figures.Rmd</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec022">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pgen.1008766.s001">
      <label>S1 Fig</label>
      <caption>
        <title>Distribution of SNPs used in UK Biobank analysis.</title>
        <p>Distribution of SNPs used in UK Biobank analysis by chromosome and whether or not the SNP was imputed.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1008766.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1008766.s002">
      <label>S2 Fig</label>
      <caption>
        <title>LD structure among the markers in the GAW20 dataset.</title>
        <p>We illustrate the LD structure among the markers in the GAW20 dataset. We show the pairwise <italic>r</italic><sup>2</sup> for 655 SNPs within a 1Mb-window around the causal SNP rs9661059 (indicated) that we focused on. The dotplot above the heatmap denotes <italic>r</italic><sup>2</sup> between each SNP and the causal SNP. It is clear that although strong correlation does exist between some SNPs, none of these nearby SNPs is correlated with the causal SNP. The only dot denoting an <italic>r</italic><sup>2</sup> = 1 represents the causal SNP itself.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1008766.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1008766.s003">
      <label>S3 Fig</label>
      <caption>
        <title>LD structure among the markers in the mouse dataset.</title>
        <p>We illustrate the LD structure among the markers in the mouse dataset. Shown is the pairwise <italic>r</italic><sup>2</sup> for all microsatellite markers. It is clear that many markers are considerably strongly correlated with each other, as we expected.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pgen.1008766.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1008766.s004">
      <label>S1 Text</label>
      <caption>
        <title>Block coordinate gradient descent algorithm.</title>
        <p>We provide a full derivation of the algorithm used to solve the <monospace>ggmix</monospace> objective function.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1008766.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1008766.s005">
      <label>S2 Text</label>
      <caption>
        <title><monospace>ggmix</monospace> Package Showcase.</title>
        <p>We introduce the freely available and open source <monospace>ggmix</monospace> package in <monospace>R</monospace> available on CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=ggmix">https://cran.r-project.org/package=ggmix</ext-link>).</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1008766.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>Part of this research has been conducted using the UK Biobank Resource under project number 27449. We appreciate the generosity of UK Biobank volunteers. MF was at the Lady Davis Institute when she undertook this research. We appreciate advice on an earlier version of the manuscript provided by Dr. Simon Gravel, Dr. David Fardo and Dr. Abbas Khalili.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pgen.1008766.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Manolio</surname><given-names>TA</given-names></name>, <name><surname>Collins</surname><given-names>FS</given-names></name>, <name><surname>Cox</surname><given-names>NJ</given-names></name>, <name><surname>Goldstein</surname><given-names>DB</given-names></name>, <name><surname>Hindorff</surname><given-names>LA</given-names></name>, <name><surname>Hunter</surname><given-names>DJ</given-names></name>, <etal>et al</etal><article-title>Finding the missing heritability of complex diseases</article-title>. <source>Nature</source>. <year>2009</year>;<volume>461</volume>(<issue>7265</issue>):<fpage>747</fpage><pub-id pub-id-type="doi">10.1038/nature08494</pub-id><?supplied-pmid 19812666?><pub-id pub-id-type="pmid">19812666</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>J</given-names></name>, <name><surname>Benyamin</surname><given-names>B</given-names></name>, <name><surname>McEvoy</surname><given-names>BP</given-names></name>, <name><surname>Gordon</surname><given-names>S</given-names></name>, <name><surname>Henders</surname><given-names>AK</given-names></name>, <name><surname>Nyholt</surname><given-names>DR</given-names></name>, <etal>et al</etal><article-title>Common SNPs explain a large proportion of the heritability for human height</article-title>. <source>Nature genetics</source>. <year>2010</year>;<volume>42</volume>(<issue>7</issue>):<fpage>565</fpage><pub-id pub-id-type="doi">10.1038/ng.608</pub-id><?supplied-pmid 20562875?><pub-id pub-id-type="pmid">20562875</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Astle</surname><given-names>W</given-names></name>, <name><surname>Balding</surname><given-names>DJ</given-names></name>, <etal>et al</etal><article-title>Population structure and cryptic relatedness in genetic association studies</article-title>. <source>Statistical Science</source>. <year>2009</year>;<volume>24</volume>(<issue>4</issue>):<fpage>451</fpage>–<lpage>471</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Song</surname><given-names>M</given-names></name>, <name><surname>Hao</surname><given-names>W</given-names></name>, <name><surname>Storey</surname><given-names>JD</given-names></name>. <article-title>Testing for genetic associations in arbitrarily structured populations</article-title>. <source>Nature genetics</source>. <year>2015</year>;<volume>47</volume>(<issue>5</issue>):<fpage>550</fpage>–<lpage>554</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3244</pub-id><?supplied-pmid 25822090?><pub-id pub-id-type="pmid">25822090</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Marchini</surname><given-names>J</given-names></name>, <name><surname>Cardon</surname><given-names>LR</given-names></name>, <name><surname>Phillips</surname><given-names>MS</given-names></name>, <name><surname>Donnelly</surname><given-names>P</given-names></name>. <article-title>The effects of human population structure on large genetic association studies</article-title>. <source>Nature genetics</source>. <year>2004</year>;<volume>36</volume>(<issue>5</issue>):<fpage>512</fpage><pub-id pub-id-type="doi">10.1038/ng1337</pub-id><?supplied-pmid 15052271?><pub-id pub-id-type="pmid">15052271</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Hoggart</surname><given-names>CJ</given-names></name>, <name><surname>Whittaker</surname><given-names>JC</given-names></name>, <name><surname>De Iorio</surname><given-names>M</given-names></name>, <name><surname>Balding</surname><given-names>DJ</given-names></name>. <article-title>Simultaneous analysis of all SNPs in genome-wide and re-sequencing association studies</article-title>. <source>PLoS genetics</source>. <year>2008</year>;<volume>4</volume>(<issue>7</issue>):<fpage>e1000130</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1000130</pub-id><?supplied-pmid 18654633?><pub-id pub-id-type="pmid">18654633</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Das</surname><given-names>K</given-names></name>, <name><surname>Fu</surname><given-names>G</given-names></name>, <name><surname>Li</surname><given-names>R</given-names></name>, <name><surname>Wu</surname><given-names>R</given-names></name>. <article-title>The Bayesian lasso for genome-wide association studies</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>27</volume>(<issue>4</issue>):<fpage>516</fpage>–<lpage>523</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq688</pub-id><?supplied-pmid 21156729?><pub-id pub-id-type="pmid">21156729</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Lippert</surname><given-names>C</given-names></name>, <name><surname>Listgarten</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Kadie</surname><given-names>CM</given-names></name>, <name><surname>Davidson</surname><given-names>RI</given-names></name>, <name><surname>Heckerman</surname><given-names>D</given-names></name>. <article-title>FaST linear mixed models for genome-wide association studies</article-title>. <source>Nature methods</source>. <year>2011</year>;<volume>8</volume>(<issue>10</issue>):<fpage>833</fpage>–<lpage>835</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1681</pub-id><?supplied-pmid 21892150?><pub-id pub-id-type="pmid">21892150</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Kang</surname><given-names>HM</given-names></name>, <name><surname>Sul</surname><given-names>JH</given-names></name>, <name><surname>Zaitlen</surname><given-names>NA</given-names></name>, <name><surname>Kong</surname><given-names>Sy</given-names></name>, <name><surname>Freimer</surname><given-names>NB</given-names></name>, <name><surname>Sabatti</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>Variance component model to account for sample structure in genome-wide association studies</article-title>. <source>Nature genetics</source>. <year>2010</year>;<volume>42</volume>(<issue>4</issue>):<fpage>348</fpage><pub-id pub-id-type="doi">10.1038/ng.548</pub-id><?supplied-pmid 20208533?><pub-id pub-id-type="pmid">20208533</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Yu</surname><given-names>J</given-names></name>, <name><surname>Pressoir</surname><given-names>G</given-names></name>, <name><surname>Briggs</surname><given-names>WH</given-names></name>, <name><surname>Bi</surname><given-names>IV</given-names></name>, <name><surname>Yamasaki</surname><given-names>M</given-names></name>, <name><surname>Doebley</surname><given-names>JF</given-names></name>, <etal>et al</etal><article-title>A unified mixed-model method for association mapping that accounts for multiple levels of relatedness</article-title>. <source>Nature genetics</source>. <year>2006</year>;<volume>38</volume>(<issue>2</issue>):<fpage>203</fpage><pub-id pub-id-type="doi">10.1038/ng1702</pub-id><?supplied-pmid 16380716?><pub-id pub-id-type="pmid">16380716</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Eu-Ahsunthornwattana</surname><given-names>J</given-names></name>, <name><surname>Miller</surname><given-names>EN</given-names></name>, <name><surname>Fakiola</surname><given-names>M</given-names></name>, <name><surname>Jeronimo</surname><given-names>SM</given-names></name>, <name><surname>Blackwell</surname><given-names>JM</given-names></name>, <name><surname>Cordell</surname><given-names>HJ</given-names></name>, <etal>et al</etal><article-title>Comparison of methods to account for relatedness in genome-wide association studies with family-based data</article-title>. <source>PLoS Genet</source>. <year>2014</year>;<volume>10</volume>(<issue>7</issue>):<fpage>e1004445</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1004445</pub-id><?supplied-pmid 25033443?><pub-id pub-id-type="pmid">25033443</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Price</surname><given-names>AL</given-names></name>, <name><surname>Patterson</surname><given-names>NJ</given-names></name>, <name><surname>Plenge</surname><given-names>RM</given-names></name>, <name><surname>Weinblatt</surname><given-names>ME</given-names></name>, <name><surname>Shadick</surname><given-names>NA</given-names></name>, <name><surname>Reich</surname><given-names>D</given-names></name>. <article-title>Principal components analysis corrects for stratification in genome-wide association studies</article-title>. <source>Nature genetics</source>. <year>2006</year>;<volume>38</volume>(<issue>8</issue>):<fpage>904</fpage><pub-id pub-id-type="doi">10.1038/ng1847</pub-id><?supplied-pmid 16862161?><pub-id pub-id-type="pmid">16862161</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Oualkacha</surname><given-names>K</given-names></name>, <name><surname>Dastani</surname><given-names>Z</given-names></name>, <name><surname>Li</surname><given-names>R</given-names></name>, <name><surname>Cingolani</surname><given-names>PE</given-names></name>, <name><surname>Spector</surname><given-names>TD</given-names></name>, <name><surname>Hammond</surname><given-names>CJ</given-names></name>, <etal>et al</etal><article-title>Adjusted sequence kernel association test for rare variants controlling for cryptic and family relatedness</article-title>. <source>Genetic epidemiology</source>. <year>2013</year>;<volume>37</volume>(<issue>4</issue>):<fpage>366</fpage>–<lpage>376</lpage>. <pub-id pub-id-type="doi">10.1002/gepi.21725</pub-id><?supplied-pmid 23529756?><pub-id pub-id-type="pmid">23529756</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Cordell</surname><given-names>HJ</given-names></name>, <name><surname>Clayton</surname><given-names>DG</given-names></name>. <article-title>A unified stepwise regression procedure for evaluating the relative effects of polymorphisms within a gene using case/control or family data: application to HLA in type 1 diabetes</article-title>. <source>The American Journal of Human Genetics</source>. <year>2002</year>;<volume>70</volume>(<issue>1</issue>):<fpage>124</fpage>–<lpage>141</lpage>. <pub-id pub-id-type="doi">10.1086/338007</pub-id><?supplied-pmid 11719900?><pub-id pub-id-type="pmid">11719900</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Rakitsch</surname><given-names>B</given-names></name>, <name><surname>Lippert</surname><given-names>C</given-names></name>, <name><surname>Stegle</surname><given-names>O</given-names></name>, <name><surname>Borgwardt</surname><given-names>K</given-names></name>. <article-title>A Lasso multi-marker mixed model for association mapping with population structure correction</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>2</issue>):<fpage>206</fpage>–<lpage>214</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts669</pub-id><?supplied-pmid 23175758?><pub-id pub-id-type="pmid">23175758</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>D</given-names></name>, <name><surname>Eskridge</surname><given-names>KM</given-names></name>, <name><surname>Crossa</surname><given-names>J</given-names></name>. <article-title>Identifying QTLs and epistasis in structured plant populations using adaptive mixed LASSO</article-title>. <source>Journal of agricultural, biological, and environmental statistics</source>. <year>2011</year>;<volume>16</volume>(<issue>2</issue>):<fpage>170</fpage>–<lpage>184</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Tibshirani</surname><given-names>R</given-names></name>. <article-title>Regression shrinkage and selection via the lasso</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source>. <year>1996</year>; p. <fpage>267</fpage>–<lpage>288</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Zou</surname><given-names>H</given-names></name>. <article-title>The adaptive lasso and its oracle properties</article-title>. <source>Journal of the American statistical association</source>. <year>2006</year>;<volume>101</volume>(<issue>476</issue>):<fpage>1418</fpage>–<lpage>1429</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref019">
      <label>19</label>
      <mixed-citation publication-type="other">Ding X, Su S, Nandakumar K, Wang X, Fardo DW. A 2-step penalized regression method for family-based next-generation sequencing association studies. In: BMC proceedings. vol. 8. BioMed Central; 2014. p. S25.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>. <article-title>Regularization paths for generalized linear models via coordinate descent</article-title>. <source>Journal of statistical software</source>. <year>2010</year>;<volume>33</volume>(<issue>1</issue>):<fpage>1</fpage><?supplied-pmid 20808728?><pub-id pub-id-type="pmid">20808728</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>Y</given-names></name>, <name><surname>Zou</surname><given-names>H</given-names></name>. <article-title>A fast unified algorithm for solving group-lasso penalize learning problems</article-title>. <source>Statistics and Computing</source>. <year>2015</year>;<volume>25</volume>(<issue>6</issue>):<fpage>1129</fpage>–<lpage>1141</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>J</given-names></name>, <name><surname>Zaitlen</surname><given-names>NA</given-names></name>, <name><surname>Goddard</surname><given-names>ME</given-names></name>, <name><surname>Visscher</surname><given-names>PM</given-names></name>, <name><surname>Price</surname><given-names>AL</given-names></name>. <article-title>Advantages and pitfalls in the application of mixed-model association methods</article-title>. <source>Nature genetics</source>. <year>2014</year>;<volume>46</volume>(<issue>2</issue>):<fpage>100</fpage><pub-id pub-id-type="doi">10.1038/ng.2876</pub-id><?supplied-pmid 24473328?><pub-id pub-id-type="pmid">24473328</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Zou</surname><given-names>H</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>. <article-title>Regularization and variable selection via the elastic net</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2005</year>;<volume>67</volume>(<issue>2</issue>):<fpage>301</fpage>–<lpage>320</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Gilmour</surname><given-names>AR</given-names></name>, <name><surname>Thompson</surname><given-names>R</given-names></name>, <name><surname>Cullis</surname><given-names>BR</given-names></name>. <article-title>Average information REML: an efficient algorithm for variance parameter estimation in linear mixed models</article-title>. <source>Biometrics</source>. <year>1995</year>; p. <fpage>1440</fpage>–<lpage>1450</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">Dandine-Roulland C. gaston: Genetic Data Handling (QC, GRM, LD, PCA) and Linear Mixed Models; 2018. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=gaston">https://CRAN.R-project.org/package=gaston</ext-link>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref026">
      <label>26</label>
      <mixed-citation publication-type="other">Ochoa A, Storey JD. FST and kinship for arbitrary population structures I: Generalized definitions. bioRxiv. 2016.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref027">
      <label>27</label>
      <mixed-citation publication-type="other">Ochoa A, Storey JD. FST and kinship for arbitrary population structures II: Method of moments estimators. bioRxiv. 2016.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Reid</surname><given-names>S</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>, <name><surname>Friedman</surname><given-names>J</given-names></name>. <article-title>A study of error variance estimation in lasso regression</article-title>. <source>Statistica Sinica</source>. <year>2016</year>; p. <fpage>35</fpage>–<lpage>67</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Bycroft</surname><given-names>C</given-names></name>, <name><surname>Freeman</surname><given-names>C</given-names></name>, <name><surname>Petkova</surname><given-names>D</given-names></name>, <name><surname>Band</surname><given-names>G</given-names></name>, <name><surname>Elliott</surname><given-names>LT</given-names></name>, <name><surname>Sharp</surname><given-names>K</given-names></name>, <etal>et al</etal><article-title>The UK Biobank resource with deep phenotyping and genomic data</article-title>. <source>Nature</source>. <year>2018</year>;<volume>562</volume>(<issue>7726</issue>):<fpage>203</fpage><pub-id pub-id-type="doi">10.1038/s41586-018-0579-z</pub-id><?supplied-pmid 30305743?><pub-id pub-id-type="pmid">30305743</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Biobank</surname><given-names>U</given-names></name>. <article-title>Genotyping and quality control of UK Biobank, a large-scale, extensively phenotyped prospective resource</article-title>. <source>Available at biobank ctsu ox ac uk/crystal/docs/genotyping_qc pdf Accessed April</source>. <year>2015</year>;<volume>1</volume>:<fpage>2016</fpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Manichaikul</surname><given-names>A</given-names></name>, <name><surname>Mychaleckyj</surname><given-names>JC</given-names></name>, <name><surname>Rich</surname><given-names>SS</given-names></name>, <name><surname>Daly</surname><given-names>K</given-names></name>, <name><surname>Sale</surname><given-names>M</given-names></name>, <name><surname>Chen</surname><given-names>WM</given-names></name>. <article-title>Robust relationship inference in genome-wide association studies</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>22</issue>):<fpage>2867</fpage>–<lpage>2873</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq559</pub-id><?supplied-pmid 20926424?><pub-id pub-id-type="pmid">20926424</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Yengo</surname><given-names>L</given-names></name>, <name><surname>Sidorenko</surname><given-names>J</given-names></name>, <name><surname>Kemper</surname><given-names>KE</given-names></name>, <name><surname>Zheng</surname><given-names>Z</given-names></name>, <name><surname>Wood</surname><given-names>AR</given-names></name>, <name><surname>Weedon</surname><given-names>MN</given-names></name>, <etal>et al</etal><article-title>Meta-analysis of genome-wide association studies for height and body mass index in 700000 individuals of European ancestry</article-title>. <source>Human molecular genetics</source>. <year>2018</year>;<volume>27</volume>(<issue>20</issue>):<fpage>3641</fpage>–<lpage>3649</lpage>. <pub-id pub-id-type="doi">10.1093/hmg/ddy271</pub-id><?supplied-pmid 30124842?><pub-id pub-id-type="pmid">30124842</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>McCarthy</surname><given-names>S</given-names></name>, <name><surname>Das</surname><given-names>S</given-names></name>, <name><surname>Kretzschmar</surname><given-names>W</given-names></name>, <name><surname>Delaneau</surname><given-names>O</given-names></name>, <name><surname>Wood</surname><given-names>AR</given-names></name>, <name><surname>Teumer</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>A reference panel of 64,976 haplotypes for genotype imputation</article-title>. <source>Nature genetics</source>. <year>2016</year>;<volume>48</volume>(<issue>10</issue>):<fpage>1279</fpage><pub-id pub-id-type="doi">10.1038/ng.3643</pub-id><?supplied-pmid 27548312?><pub-id pub-id-type="pmid">27548312</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>X</given-names></name>, <name><surname>Carbonetto</surname><given-names>P</given-names></name>, <name><surname>Stephens</surname><given-names>M</given-names></name>. <article-title>Polygenic modeling with Bayesian sparse linear mixed models</article-title>. <source>PLoS genetics</source>. <year>2013</year>;<volume>9</volume>(<issue>2</issue>):<fpage>e1003264</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1003264</pub-id><?supplied-pmid 23408905?><pub-id pub-id-type="pmid">23408905</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>X</given-names></name>, <name><surname>Stephens</surname><given-names>M</given-names></name>. <article-title>Genome-wide efficient mixed-model analysis for association studies</article-title>. <source>Nature genetics</source>. <year>2012</year>;<volume>44</volume>(<issue>7</issue>):<fpage>821</fpage><pub-id pub-id-type="doi">10.1038/ng.2310</pub-id><?supplied-pmid 22706312?><pub-id pub-id-type="pmid">22706312</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Davey Smith</surname><given-names>G</given-names></name>, <name><surname>Ebrahim</surname><given-names>S</given-names></name>. <article-title>‘Mendelian randomization’: can genetic epidemiology contribute to understanding environmental determinants of disease?</article-title><source>International journal of epidemiology</source>. <year>2003</year>;<volume>32</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">12689998</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref037">
      <label>37</label>
      <mixed-citation publication-type="other">Cherlin S, Howey RA, Cordell HJ. Using penalized regression to predict phenotype from SNP data. In: BMC proceedings. vol. 12. BioMed Central; 2018. p. 38.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref038">
      <label>38</label>
      <mixed-citation publication-type="other">Zhou W, Lo SH. Analysis of genotype by methylation interactions through sparsity-inducing regularized regression. In: BMC proceedings. vol. 12. BioMed Central; 2018. p. 40.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref039">
      <label>39</label>
      <mixed-citation publication-type="other">Howey RA, Cordell HJ. Application of Bayesian networks to GAW20 genetic and blood lipid data. In: BMC proceedings. vol. 12. BioMed Central; 2018. p. 19.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Thornton</surname><given-names>T</given-names></name>, <name><surname>Tang</surname><given-names>H</given-names></name>, <name><surname>Hoffmann</surname><given-names>TJ</given-names></name>, <name><surname>Ochs-Balcom</surname><given-names>HM</given-names></name>, <name><surname>Caan</surname><given-names>BJ</given-names></name>, <name><surname>Risch</surname><given-names>N</given-names></name>. <article-title>Estimating kinship in admixed populations</article-title>. <source>The American Journal of Human Genetics</source>. <year>2012</year>;<volume>91</volume>(<issue>1</issue>):<fpage>122</fpage>–<lpage>138</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2012.05.024</pub-id><?supplied-pmid 22748210?><pub-id pub-id-type="pmid">22748210</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Alexander</surname><given-names>DH</given-names></name>, <name><surname>Novembre</surname><given-names>J</given-names></name>, <name><surname>Lange</surname><given-names>K</given-names></name>. <article-title>Fast model-based estimation of ancestry in unrelated individuals</article-title>. <source>Genome research</source>. <year>2009</year>;<volume>19</volume>(<issue>9</issue>):<fpage>1655</fpage>–<lpage>1664</lpage>. <pub-id pub-id-type="doi">10.1101/gr.094052.109</pub-id><?supplied-pmid 19648217?><pub-id pub-id-type="pmid">19648217</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Fortin</surname><given-names>A</given-names></name>, <name><surname>Diez</surname><given-names>E</given-names></name>, <name><surname>Rochefort</surname><given-names>D</given-names></name>, <name><surname>Laroche</surname><given-names>L</given-names></name>, <name><surname>Malo</surname><given-names>D</given-names></name>, <name><surname>Rouleau</surname><given-names>GA</given-names></name>, <etal>et al</etal><article-title>Recombinant congenic strains derived from A/J and C57BL/6J: a tool for genetic dissection of complex traits</article-title>. <source>Genomics</source>. <year>2001</year>;<volume>74</volume>(<issue>1</issue>):<fpage>21</fpage>–<lpage>35</lpage>. <pub-id pub-id-type="doi">10.1006/geno.2001.6528</pub-id><?supplied-pmid 11374899?><pub-id pub-id-type="pmid">11374899</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Bennett</surname><given-names>BJ</given-names></name>, <name><surname>Farber</surname><given-names>CR</given-names></name>, <name><surname>Orozco</surname><given-names>L</given-names></name>, <name><surname>Kang</surname><given-names>HM</given-names></name>, <name><surname>Ghazalpour</surname><given-names>A</given-names></name>, <name><surname>Siemers</surname><given-names>N</given-names></name>, <etal>et al</etal><article-title>A high-resolution association mapping panel for the dissection of complex traits in mice</article-title>. <source>Genome research</source>. <year>2010</year>;<volume>20</volume>(<issue>2</issue>):<fpage>281</fpage>–<lpage>290</lpage>. <pub-id pub-id-type="doi">10.1101/gr.099234.109</pub-id><?supplied-pmid 20054062?><pub-id pub-id-type="pmid">20054062</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Flint</surname><given-names>J</given-names></name>, <name><surname>Eskin</surname><given-names>E</given-names></name>. <article-title>Genome-wide association studies in mice</article-title>. <source>Nature Reviews Genetics</source>. <year>2012</year>;<volume>13</volume>(<issue>11</issue>):<fpage>807</fpage><pub-id pub-id-type="doi">10.1038/nrg3335</pub-id><?supplied-pmid 23044826?><pub-id pub-id-type="pmid">23044826</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Cheng</surname><given-names>R</given-names></name>, <name><surname>Lim</surname><given-names>JE</given-names></name>, <name><surname>Samocha</surname><given-names>KE</given-names></name>, <name><surname>Sokoloff</surname><given-names>G</given-names></name>, <name><surname>Abney</surname><given-names>M</given-names></name>, <name><surname>Skol</surname><given-names>AD</given-names></name>, <etal>et al</etal><article-title>Genome-wide association studies and the problem of relatedness among advanced intercross lines and other highly recombinant populations</article-title>. <source>Genetics</source>. <year>2010</year>;<volume>185</volume>(<issue>3</issue>):<fpage>1033</fpage>–<lpage>1044</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.110.116863</pub-id><?supplied-pmid 20439773?><pub-id pub-id-type="pmid">20439773</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Di Pietrantonio</surname><given-names>T</given-names></name>, <name><surname>Hernandez</surname><given-names>C</given-names></name>, <name><surname>Girard</surname><given-names>M</given-names></name>, <name><surname>Verville</surname><given-names>A</given-names></name>, <name><surname>Orlova</surname><given-names>M</given-names></name>, <name><surname>Belley</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Strain-specific differences in the genetic control of two closely related mycobacteria</article-title>. <source>PLoS pathogens</source>. <year>2010</year>;<volume>6</volume>(<issue>10</issue>):<fpage>e1001169</fpage><pub-id pub-id-type="doi">10.1371/journal.ppat.1001169</pub-id><?supplied-pmid 21060820?><pub-id pub-id-type="pmid">21060820</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>H</given-names></name>, <name><surname>Lengerich</surname><given-names>BJ</given-names></name>, <name><surname>Aragam</surname><given-names>B</given-names></name>, <name><surname>Xing</surname><given-names>EP</given-names></name>. <article-title>Precision Lasso: accounting for correlations and linear dependencies in high-dimensional genomic data</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>35</volume>(<issue>7</issue>):<fpage>1181</fpage>–<lpage>1187</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Sohrabi</surname><given-names>Y</given-names></name>, <name><surname>Havelková</surname><given-names>H</given-names></name>, <name><surname>Kobets</surname><given-names>T</given-names></name>, <name><surname>Šíma</surname><given-names>M</given-names></name>, <name><surname>Volkova</surname><given-names>V</given-names></name>, <name><surname>Grekov</surname><given-names>I</given-names></name>, <etal>et al</etal><article-title>Mapping the Genes for Susceptibility and Response to Leishmania tropica in Mouse</article-title>. <source>PLoS neglected tropical diseases</source>. <year>2013</year>;<volume>7</volume>(<issue>7</issue>):<fpage>e2282</fpage><pub-id pub-id-type="doi">10.1371/journal.pntd.0002282</pub-id><?supplied-pmid 23875032?><pub-id pub-id-type="pmid">23875032</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Jackson</surname><given-names>AU</given-names></name>, <name><surname>Fornés</surname><given-names>A</given-names></name>, <name><surname>Galecki</surname><given-names>A</given-names></name>, <name><surname>Miller</surname><given-names>RA</given-names></name>, <name><surname>Burke</surname><given-names>DT</given-names></name>. <article-title>Multiple-trait quantitative trait loci analysis using a large mouse sibship</article-title>. <source>Genetics</source>. <year>1999</year>;<volume>151</volume>(<issue>2</issue>):<fpage>785</fpage>–<lpage>795</lpage>. <?supplied-pmid 9927469?><pub-id pub-id-type="pmid">9927469</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Stern</surname><given-names>MC</given-names></name>, <name><surname>Benavides</surname><given-names>F</given-names></name>, <name><surname>Klingelberger</surname><given-names>EA</given-names></name>, <name><surname>Conti</surname><given-names>CJ</given-names></name>. <article-title>Allelotype analysis of chemically induced squamous cell carcinomas in F1 hybrids of two inbred mouse strains with different susceptibility to tumor progression</article-title>. <source>Carcinogenesis</source>. <year>2000</year>;<volume>21</volume>(<issue>7</issue>):<fpage>1297</fpage>–<lpage>1301</lpage>.<pub-id pub-id-type="pmid">10874006</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Lasko</surname><given-names>D</given-names></name>, <name><surname>Cavenee</surname><given-names>W</given-names></name>, <name><surname>Nordenskjöld</surname><given-names>M</given-names></name>. <article-title>Loss of constitutional heterozygosity in human cancer</article-title>. <source>Annual review of genetics</source>. <year>1991</year>;<volume>25</volume>(<issue>1</issue>):<fpage>281</fpage>–<lpage>314</lpage>. <pub-id pub-id-type="doi">10.1146/annurev.ge.25.120191.001433</pub-id><?supplied-pmid 1687498?><pub-id pub-id-type="pmid">1687498</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Loh</surname><given-names>PR</given-names></name>, <name><surname>Tucker</surname><given-names>G</given-names></name>, <name><surname>Bulik-Sullivan</surname><given-names>BK</given-names></name>, <name><surname>Vilhjalmsson</surname><given-names>BJ</given-names></name>, <name><surname>Finucane</surname><given-names>HK</given-names></name>, <name><surname>Salem</surname><given-names>RM</given-names></name>, <etal>et al</etal><article-title>Efficient Bayesian mixed-model analysis increases association power in large cohorts</article-title>. <source>Nature genetics</source>. <year>2015</year>;<volume>47</volume>(<issue>3</issue>):<fpage>284</fpage><pub-id pub-id-type="doi">10.1038/ng.3190</pub-id><?supplied-pmid 25642633?><pub-id pub-id-type="pmid">25642633</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Allen</surname><given-names>N</given-names></name>, <name><surname>Sudlow</surname><given-names>C</given-names></name>, <name><surname>Downey</surname><given-names>P</given-names></name>, <name><surname>Peakman</surname><given-names>T</given-names></name>, <name><surname>Danesh</surname><given-names>J</given-names></name>, <name><surname>Elliott</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>UK Biobank: Current status and what it means for epidemiology</article-title>. <source>Health Policy and Technology</source>. <year>2012</year>;<volume>1</volume>(<issue>3</issue>):<fpage>123</fpage>–<lpage>126</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref054">
      <label>54</label>
      <mixed-citation publication-type="other">Zeng Y, Breheny P. The biglasso package: a memory-and computation-efficient solver for lasso model fitting with big data in R. arXiv preprint arXiv:170105936. 2017.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Spain</surname><given-names>SL</given-names></name>, <name><surname>Barrett</surname><given-names>JC</given-names></name>. <article-title>Strategies for fine-mapping complex traits</article-title>. <source>Human molecular genetics</source>. <year>2015</year>;<volume>24</volume>(<issue>R1</issue>):<fpage>R111</fpage>–<lpage>R119</lpage>. <pub-id pub-id-type="doi">10.1093/hmg/ddv260</pub-id><?supplied-pmid 26157023?><pub-id pub-id-type="pmid">26157023</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Pirinen</surname><given-names>M</given-names></name>, <name><surname>Donnelly</surname><given-names>P</given-names></name>, <name><surname>Spencer</surname><given-names>CC</given-names></name>, <etal>et al</etal><article-title>Efficient computation with a linear mixed model on large-scale data sets with applications to genetic studies</article-title>. <source>The Annals of Applied Statistics</source>. <year>2013</year>;<volume>7</volume>(<issue>1</issue>):<fpage>369</fpage>–<lpage>390</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Schelldorfer</surname><given-names>J</given-names></name>, <name><surname>Bühlmann</surname><given-names>P</given-names></name>, <name><surname>DE</surname><given-names>G</given-names></name>, <name><surname>VAN</surname><given-names>S</given-names></name>. <article-title>Estimation for High-Dimensional Linear Mixed-Effects Models Using L1-Penalization</article-title>. <source>Scandinavian Journal of Statistics</source>. <year>2011</year>;<volume>38</volume>(<issue>2</issue>):<fpage>197</fpage>–<lpage>214</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Tseng</surname><given-names>P</given-names></name>, <name><surname>Yun</surname><given-names>S</given-names></name>. <article-title>A coordinate gradient descent method for nonsmooth separable minimization</article-title>. <source>Mathematical Programming</source>. <year>2009</year>;<volume>117</volume>(<issue>1</issue>):<fpage>387</fpage>–<lpage>423</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Meier</surname><given-names>L</given-names></name>, <name><surname>Van De Geer</surname><given-names>S</given-names></name>, <name><surname>Bühlmann</surname><given-names>P</given-names></name>. <article-title>The group lasso for logistic regression</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2008</year>;<volume>70</volume>(<issue>1</issue>):<fpage>53</fpage>–<lpage>71</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Byrd</surname><given-names>RH</given-names></name>, <name><surname>Lu</surname><given-names>P</given-names></name>, <name><surname>Nocedal</surname><given-names>J</given-names></name>, <name><surname>Zhu</surname><given-names>C</given-names></name>. <article-title>A limited memory algorithm for bound constrained optimization</article-title>. <source>SIAM Journal on Scientific Computing</source>. <year>1995</year>;<volume>16</volume>(<issue>5</issue>):<fpage>1190</fpage>–<lpage>1208</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref061">
      <label>61</label>
      <mixed-citation publication-type="book"><name><surname>Wakefield</surname><given-names>J</given-names></name>. <source>Bayesian and frequentist regression methods</source>. <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2013</year>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Nishii</surname><given-names>R</given-names></name>. <article-title>Asymptotic properties of criteria for selection of variables in multiple regression</article-title>. <source>The Annals of Statistics</source>. <year>1984</year>; p. <fpage>758</fpage>–<lpage>765</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Zou</surname><given-names>H</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>On the “degrees of freedom” of the lasso</article-title>. <source>The Annals of Statistics</source>. <year>2007</year>;<volume>35</volume>(<issue>5</issue>):<fpage>2173</fpage>–<lpage>2192</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Bondell</surname><given-names>HD</given-names></name>, <name><surname>Krishna</surname><given-names>A</given-names></name>, <name><surname>Ghosh</surname><given-names>SK</given-names></name>. <article-title>Joint Variable Selection for Fixed and Random Effects in Linear Mixed-Effects Models</article-title>. <source>Biometrics</source>. <year>2010</year>;<volume>66</volume>(<issue>4</issue>):<fpage>1069</fpage>–<lpage>1077</lpage>. <pub-id pub-id-type="doi">10.1111/j.1541-0420.2010.01391.x</pub-id><?supplied-pmid 20163404?><pub-id pub-id-type="pmid">20163404</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008766.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Fan</surname><given-names>Y</given-names></name>, <name><surname>Tang</surname><given-names>CY</given-names></name>. <article-title>Tuning parameter selection in high dimensional penalized likelihood</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2013</year>;<volume>75</volume>(<issue>3</issue>):<fpage>531</fpage>–<lpage>552</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pgen.1008766.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1008766.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cordell</surname>
          <given-names>Heather J</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Williams</surname>
          <given-names>Scott M.</given-names>
        </name>
        <role>Section Editor: Natural Variation</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Cordell, Williams</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Cordell, Williams</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pgen.1008766" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">8 Sep 2019</named-content>
    </p>
    <p>Dear Dr Bhatnagar,</p>
    <p>Thank you very much for submitting your Research Article entitled 'Simultaneous SNP selection and adjustment for population structure in high dimensional prediction models' to PLOS Genetics. Your manuscript was fully evaluated at the editorial level and by independent peer reviewers. The reviewers appreciated the attention to an important problem, but raised some substantial concerns about the current manuscript. Based on the reviews, we will not be able to accept this version of the manuscript, but we would be willing to review again a much-revised version. We cannot, of course, promise publication at that time.</p>
    <p>Should you decide to revise the manuscript for further consideration here, your revisions should address the specific points made by each reviewer. We will also require a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript.</p>
    <p>If you decide to revise the manuscript for further consideration at PLOS Genetics, please aim to resubmit within the next 60 days, unless it will take extra time to address the concerns of the reviewers, in which case we would appreciate an expected resubmission date by email to <email>plosgenetics@plos.org</email>.</p>
    <p>If present, accompanying reviewer attachments are included with this email; please notify the journal office if any appear to be missing. They will also be available for download from the link below. You can use this link to log into the system when you are ready to submit a revised version, having first consulted our <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosgenetics/s/submit-now#loc-submission-checklist">Submission Checklist</ext-link>.</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see our <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosgenetics/s/submission-guidelines#loc-materials-and-methods">guidelines</ext-link>.</p>
    <p>Please be aware that our <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosgenetics/s/data-availability">data availability policy</ext-link> requires that all numerical data underlying graphs or summary statistics are included with the submission, and you will need to provide this upon resubmission if not already present. In addition, we do not permit the inclusion of phrases such as "data not shown" or "unpublished results" in manuscripts. All points should be backed up by data provided with the submission.</p>
    <p>While revising your submission, please upload your figure files to the <ext-link ext-link-type="uri" xlink:href="http://pace.apexcovantage.com/">Preflight Analysis and Conversion Engine</ext-link> (PACE) digital diagnostic tool.  PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>PLOS has incorporated <ext-link ext-link-type="uri" xlink:href="http://www.crossref.org/crosscheck.html">Similarity Check</ext-link>, powered by iThenticate, into its journal-wide submission system in order to screen submitted content for originality before publication. Each PLOS journal undertakes screening on a proportion of submitted articles. You will be contacted if needed following the screening process.</p>
    <p>To resubmit, use the link below and 'Revise Submission' in the 'Submissions Needing Revision' folder.</p>
    <p>[LINK]</p>
    <p>We are sorry that we cannot be more positive about your manuscript at this stage. Please do not hesitate to contact us if you have any concerns or questions.</p>
    <p>Yours sincerely,</p>
    <p>Heather J Cordell</p>
    <p>Associate Editor</p>
    <p>PLOS Genetics</p>
    <p>Scott Williams</p>
    <p>Section Editor: Natural Variation</p>
    <p>PLOS Genetics</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors demonstrate a method for genome-wide association that combines mixed-model based control of population structure or genetic relatedness with multi-variate regressions. The idea is to increase power for GWAS applications by including multiple markers at once while accounting for structure. Previous tools for this application are somewhat limited, so this method aims to provide a more comprehensive and computationally efficient tools. They include a well-structured R package to implement their method.</p>
    <p>This is an important topic, and their software is much faster and easier to use than existing tools. However I have several comments on their presentation, particularly the comparisons with existing methods and some limitations of the simulations:</p>
    <p>Major issues:</p>
    <p>1. I think that the novelty of the method is not made clear in the paper. The model itself appears virtually identical to that of the glmmlasso R package (Schelldorfer et al 2011) except limited to one random effect – the objective function appears identical, and those authors also derived a block coordinate gradient descent algorithm, though I don’t know if they are identical. The addition here seems mostly in terms of computational efficiency and flexibility (combinations of L1 and L2 penalties vs just L1 for Schellendorfer). Using the SVD to rotate and diagonalize the LMM so that the random effect covariance matrix is diagonal is a very useful addition and makes the software very fast, but this is not really emphasized in the methods. Also, the BSLMM model (Zhou et al 2013 Plos Genetics) is also effectively a variable selection LMM, though it’s Bayesian instead of frequentist and requires MCMC so is slower. But it’s performance could be compared to ggmix and the two-step LASSO presented in this paper.</p>
    <p>2. While this method is much faster than glmmlasso (and presumably BSLMM), how does it scale to large numbers of markers? Typical genomics datasets today contain &gt;1e5-1e6 markers. The datasets used here seem to contain 10K-50K. There is some discussion about limitations of scaling to large N, but not large p.</p>
    <p>3. The first set of simulations include population structure and admixture. But all 10K markers are simulated in linkage equilibrium. This is an ideal situation for LASSO. But in real data, nearby markers will be partially correlated. How well does this method select the correct marker when there are other correlated markers? What does it do when the true causal variant is not in the data, but imperfectly correlated markers are (the typical GWAS setting)? Does it tend to select the nearest marker, or does it select a set of nearby markers? I can’t tell in the GAW20 and mouse datasets the extent of the LD among markers and whether this is addressed there. Also, the simulation result that including the causal markers in the kinship matrix has little impact is encouraging. But the Yang et al 2014 paper, which discusses the impact of including causal markers in the estimated kinship matrix, suggests that this is only likely when N/M is large (ie as many or more individuals as markers). In the simulations presented here, N/M is &lt;0.1, which is probably small enough that proximal contamination is not an issue. If N/M were ~1, then the impact might be greater. Note: M is the effective number of markers after accounting for LD among markers.</p>
    <p>Minor issues</p>
    <p>• 97: Wang et al 2011 does not treat the variance components as fixed, but iteratively estimates them along with beta.</p>
    <p>• 142: How much of the total variance is accounted for by causal SNPs vs the background in the simulations?</p>
    <p>• 355: X_1,…,X_N should each be transposed</p>
    <p>• Fig 5: I don’t think that the red line is a p-value threshold. Maybe “significance threshold”? How can this be &lt;100 if there were 200 bootstraps and significance required &gt;50% inclusion?</p>
    <p>• I believe Eq (30) is wrong. The term V^{-1} shouldn’t be present in the likelihood if b is included.</p>
    <p>Reviewer #2: I have a few comments and suggestions:</p>
    <p>Page 2, Line 33: It this true: better sensitivity and specificity? What are you using to define sensitivity?</p>
    <p>Page 7, line 143-163. I found the definitions of the different X matrices confusing. I think you can simplify to indexes: eg: causal for list of causal snp indexes, kinship for list of snp index in the kinship matrix, etc. I’d also refer the the snps as covariates and not label them as fixed, and state when the causal set is in the kinship set.</p>
    <p>Page 7, line 159: Did you try a larger number of SNPs? In GWAS the number is much larger and PRS methods use much more than 50 independent SNPs for estimation.</p>
    <p>Page 10, line 183: if I understand your sparsity estimate correctly, with a causal rate of 1%, setting all B to zero would give a value of 99%?</p>
    <p>Page 11, 188: I am curious why you only reported the ‘optimal’ value of the penalty parameter. Is your method outperforming in terms of sparsity because it just does a better job of selecting a sparse model? Your false positive rate is lower but the true positive rate is much lower. If one is searching for the set of true causal variants, they are usually willing to take the tradeoff of better sensitivity for weeding through the false positives. I would prefer to see curves of FP versus TP rates with the values at the optimal tuning parameter marked. In practice I found AIC/BIC somewhat conservative compared to CV or controlling for error rate via phenotype permutation.</p>
    <p>Page 11, Line 196: I am sorry if I missed this somewhere, but how was the model tuned for the lasso and twostep in the training data? Did ggmix use the GIC in the materials and methods?</p>
    <p>Page 14, Line 243 typo- methods</p>
    <p>Page 12: Figure 3. This data might be better summarized in a table that could include the additional data in the supplementary files.</p>
    <p>The math is a bit beyond my abilities, but I have previously read a paper that suggests maximizing the log likelihood, −12[ln|V|+(Y−βX)TV−1(Y−BX)] subject to the L1/L2 norm penalty to control for relatedness in penalized regression methods for genetic data (where V is the variance covariance matrix). Is this essentially what you are doing?</p>
    <p>It would have been interesting to use the set of related individuals in the UK Biobank on a few traits where PRS works well.</p>
    <p>Reviewer #3: The authors present a penalized multi-variate regression model, ggmix, that jointly models multiple genotypes in mixed-model setup that incorporates the kinship or the genetic relationship matrix (GRM). It is an important problem in statistical genetics and I appreciate that the authors developed a comprehensive algorithm that simultaneously incorporates population structure and variable selection problem. The methods are well described and the paper was easy to follow, but I have some concerns in the experiments and evaluation metric. Overall, I think the paper presents an important problem, but the results are not convincing.</p>
    <p>First, in simulation results, the ‘correct sparsity’ measure is basically ‘accuracy’ measure in binary classification problem of whether the regression coefficients are zero or non-zero. This ‘accuracy’ measure is often misleading when class distribution is imbalanced. For example, if 99% of coefficients are zero, you can get 99% accuracy by just classifying everything to be zero, which is clearly not a good model. I suggest adapting different measure, such as MCC. I can see that twostep and LASSO both maintains FPR at 0.05, which is why ‘correct sparsity’ is around 0.95. At the same time, we can see that LASSO and twostep achieve higher TPR. Also from a slightly different point of view, in Figure 3(D), comparing TPR at different points on FPR is not a fair comparison. To compare different methods in the context of TPR and FPR, either AUC or TPR at the same rate of FPR should be considered.</p>
    <p>Intro is slightly misleading, especially in lines 107-109, because I first thought that ggmix takes out causal (i.e. selected) variables out of the relationship matrix, then I later realized that loss of power due to causal SNPs included in the GRM still happens in ggmix, but you aim to minimize the loss by joint modeling – but it is not clear why this would be the case. Is there any theoretical or simulation-based evidence that joint modeling achieves higher power in such a case?</p>
    <p>In the mouse data, the model parameters were optimized so that the two loci are picked up, and then the evaluation metric is based on whether these two loci are picked up, which is circular.</p>
    <p>In discussion, it was mentioned that leave-one-chromosome-out approach is possible, but has not been tried. What would be the compelling reason to model all chromosomes together in the proposed problem, especially when the model is still additive and trans-interaction term is not directly modeled?</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Genetics</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosgenetics/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosgenetics/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
  </body>
</sub-article>
<sub-article id="pgen.1008766.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1008766.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pgen.1008766" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">10 Dec 2019</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pgen.1008766.s006">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response_to_reviewers.pdf</named-content></p>
      </caption>
      <media xlink:href="pgen.1008766.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pgen.1008766.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1008766.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cordell</surname>
          <given-names>Heather J</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Williams</surname>
          <given-names>Scott M.</given-names>
        </name>
        <role>Section Editor: Natural Variation</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Cordell, Williams</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Cordell, Williams</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pgen.1008766" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">11 Feb 2020</named-content>
    </p>
    <p>* Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out. *</p>
    <p>Dear Dr Bhatnagar,</p>
    <p>Thank you very much for submitting your Research Article entitled 'Simultaneous SNP selection and adjustment for population structure in high dimensional prediction models' to PLOS Genetics. Your manuscript was fully evaluated at the editorial level and by independent peer reviewers. The reviewers appreciated the attention to an important topic but identified some aspects of the manuscript that should be improved.</p>
    <p>We therefore ask you to modify the manuscript according to the review recommendations before we can consider your manuscript for acceptance. Your revisions should address the specific points made by each reviewer.</p>
    <p>In addition we ask that you:</p>
    <p>1) Provide a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript.</p>
    <p>2) Upload a Striking Image with a corresponding caption to accompany your manuscript if one is available (either a new image or an existing one from within your manuscript). If this image is judged to be suitable, it may be featured on our website. Images should ideally be high resolution, eye-catching, single panel square images. For examples, please browse our <ext-link ext-link-type="uri" xlink:href="http://www.plosgenetics.org/article/browse/volume">archive</ext-link>. If your image is from someone other than yourself, please ensure that the artist has read and agreed to the terms and conditions of the Creative Commons Attribution License. Note: we cannot publish copyrighted images.</p>
    <p>We hope to receive your revised manuscript within the next 30 days. If you anticipate any delay in its return, we would ask you to let us know the expected resubmission date by email to <email>plosgenetics@plos.org</email>.</p>
    <p>If present, accompanying reviewer attachments should be included with this email; please notify the journal office if any appear to be missing. They will also be available for download from the link below. You can use this link to log into the system when you are ready to submit a revised version, having first consulted our <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosgenetics/s/submit-now#loc-submission-checklist">Submission Checklist</ext-link>.</p>
    <p>While revising your submission, please upload your figure files to the <ext-link ext-link-type="uri" xlink:href="http://pace.apexcovantage.com/">Preflight Analysis and Conversion Engine</ext-link> (PACE) digital diagnostic tool. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>Please be aware that our <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosgenetics/s/data-availability">data availability policy</ext-link> requires that all numerical data underlying graphs or summary statistics are included with the submission, and you will need to provide this upon resubmission if not already present. In addition, we do not permit the inclusion of phrases such as "data not shown" or "unpublished results" in manuscripts. All points should be backed up by data provided with the submission.</p>
    <p>PLOS has incorporated <ext-link ext-link-type="uri" xlink:href="http://www.crossref.org/crosscheck.html">Similarity Check</ext-link>, powered by iThenticate, into its journal-wide submission system in order to screen submitted content for originality before publication. Each PLOS journal undertakes screening on a proportion of submitted articles. You will be contacted if needed following the screening process.</p>
    <p>To resubmit, you will need to go to the link below and 'Revise Submission' in the 'Submissions Needing Revision' folder.</p>
    <p>[LINK]</p>
    <p>Please let us know if you have any questions while making these revisions.</p>
    <p>Yours sincerely,</p>
    <p>Heather J Cordell</p>
    <p>Associate Editor</p>
    <p>PLOS Genetics</p>
    <p>Scott Williams</p>
    <p>Section Editor: Natural Variation</p>
    <p>PLOS Genetics</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have significantly revised their manuscript. I think that the inclusions of BSLMM in the comparisons is useful. However, I have a couple additional concerns.</p>
    <p>1. Are you sure you’re extracting the model fit from BSLMM correctly? The specifics of use are not described in the methods. It’s a Bayesian model, so gives a probability of inclusion of each SNP. From the prefix.param.txt file, you should use the gamma column to report the number of SNPs that cross a posterior inclusion probability threshold. If you count how many betas are != 0, that will likely be large. But this is not an accurate estimate of the number of markers included in the model. You can also get the posterior on the number of SNPs included from the prefix.gamma.txt file. If you’re counting SNPs that are included, what posterior probability threshold are you using for inclusion? If you’re reporting the % of SNPs included, are you reporting the posterior mean?</p>
    <p>2. Also, the authors didn’t apply BSLMM to several of the analyses. There is a write.plink function in the snpStats package that could be used to write GEMMA-compatible input files from R. Also, the PhenotypeSimulator package seems to have a writeStandardOutput function that can write bimbam or Gemma output. Especially if the extraction of estimates of needs to be revised and in fact works more similarly to the other methods, then I would recommend applying it to all analyses (Biobank may be too large).</p>
    <p>3. I am still a bit confused about when tuning parameters were set based on TPR / FPR and when based on GIC or CV or other direct methods. In real data, it’s generally not possible to set based on TPR/FPR, but I think most of your comparisons now are done that way. I understand that the goal is to show that your model can work well, and so comparing to the truth is useful. But I think more clarity is needed about when you’re demonstrating the true performance of the model vs when you’re demonstrating how the model would actually be run by a practitioner who did not know any true positive effects going in.</p>
    <p>4. 412-414. Is this statement true? Schelldorfer et al 2011 used what they called a "Block Coordinate Gradient Descent method" for their penalized LMM</p>
    <p>5. 501: I think that this is underselling your method. The main difference is that your method is orders of magnitude faster than lmmlasso, so it’s actually usable. A secondary difference is that it is limited to only one random effect.</p>
    <p>6. 288: how do you get a p-value from ggmix?</p>
    <p>Reviewer #3: The authors addressed most of my major concerns in this revision. I have one more comment:</p>
    <p>The authors first state they could not run BSLMM on simulated data and mouse data because of data format issues. Converting genotypes to PLINK format should be straightforward and should not be an issue. I understand for simulating large amount of data, it might be practically difficult, but I cannot understand why mouse microsatellite data cannot be converted to PLINK format. I do not think you need additional experiments with BSLMM but please remove the statement that converting the data to PLINK format is not possible.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Genetics</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosgenetics/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosgenetics/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #3: No</p>
  </body>
</sub-article>
<sub-article id="pgen.1008766.r004" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1008766.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pgen.1008766" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">9 Mar 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pgen.1008766.s007">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">ggmix_response_to_reviewers.pdf</named-content></p>
      </caption>
      <media xlink:href="pgen.1008766.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pgen.1008766.r005" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1008766.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cordell</surname>
          <given-names>Heather J</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Williams</surname>
          <given-names>Scott M.</given-names>
        </name>
        <role>Section Editor: Natural Variation</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Cordell, Williams</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Cordell, Williams</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj005" ext-link-type="doi" xlink:href="10.1371/journal.pgen.1008766" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">8 Apr 2020</named-content>
    </p>
    <p>Dear Dr Bhatnagar,</p>
    <p>We are pleased to inform you that your manuscript entitled "Simultaneous SNP selection and adjustment for population structure in high dimensional prediction models" has been editorially accepted for publication in PLOS Genetics. Congratulations!</p>
    <p>Before your submission can be formally accepted and sent to production you will need to complete our formatting changes, which you will receive in a follow up email. Please be aware that it may take several days for you to receive this email; during this time no action is required by you. Please note: the accept date on your published article will reflect the date of this provisional accept, but your manuscript will not be scheduled for publication until the required changes have been made.</p>
    <p>Once your paper is formally accepted, an uncorrected proof of your manuscript will be published online ahead of the final version, unless you’ve already opted out via the online submission form. If, for any reason, you do not want an earlier version of your manuscript published online or are unsure if you have already indicated as such, please let the journal staff know immediately at <email>plosgenetics@plos.org</email>.</p>
    <p>In the meantime, please log into Editorial Manager at <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pgenetics/">https://www.editorialmanager.com/pgenetics/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information to ensure an efficient production and billing process. Note that PLOS requires an ORCID iD for all corresponding authors. Therefore, please ensure that you have an ORCID iD and that it is validated in Editorial Manager. To do this, go to ‘Update my Information’ (in the upper left-hand corner of the main menu), and click on the Fetch/Validate link next to the ORCID field.  This will take you to the ORCID site and allow you to create a new iD or authenticate a pre-existing iD in Editorial Manager.</p>
    <p>If you have a press-related query, or would like to know about one way to make your underlying data available (as you will be aware, this is required for publication), please see the end of this email. If your institution or institutions have a press office, please notify them about your upcoming article at this point, to enable them to help maximise its impact. Inform journal staff as soon as possible if you are preparing a press release for your article and need a publication date.</p>
    <p>Thank you again for supporting open-access publishing; we are looking forward to publishing your work in PLOS Genetics!</p>
    <p>Yours sincerely,</p>
    <p>Heather J Cordell</p>
    <p>Associate Editor</p>
    <p>PLOS Genetics</p>
    <p>Scott Williams</p>
    <p>Section Editor: Natural Variation</p>
    <p>PLOS Genetics</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="http://www.plosgenetics.org">www.plosgenetics.org</ext-link>
    </p>
    <p>Twitter: @PLOSGenetics</p>
    <p>----------------------------------------------------</p>
    <p>Comments from the reviewers (if applicable):</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: I am satisfied with the changes made by the authors</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Genetics</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosgenetics/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosgenetics/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>----------------------------------------------------</p>
    <p>
      <bold>Data Deposition</bold>
    </p>
    <p>If you have submitted a Research Article or Front Matter that has associated data that are not suitable for deposition in a subject-specific public repository (such as GenBank or ArrayExpress), one way to make that data available is to deposit it in the <ext-link ext-link-type="uri" xlink:href="http://www.datadryad.org">Dryad Digital Repository</ext-link>. As you may recall, we ask all authors to agree to make data available; this is one way to achieve that. A full list of recommended repositories can be found on our <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosgenetics/s/data-availability#loc-recommended-repositories">website</ext-link>.</p>
    <p>The following link will take you to the Dryad record for your article, so you won't have to re‐enter its bibliographic information, and can upload your files directly: </p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="http://datadryad.org/submit?journalID=pgenetics&amp;manu=PGENETICS-D-19-01153R2">http://datadryad.org/submit?journalID=pgenetics&amp;manu=PGENETICS-D-19-01153R2</ext-link>
    </p>
    <p>More information about depositing data in Dryad is available at <ext-link ext-link-type="uri" xlink:href="http://www.datadryad.org/depositing">http://www.datadryad.org/depositing</ext-link>. If you experience any difficulties in submitting your data, please contact <email>help@datadryad.org</email> for support.</p>
    <p>Additionally, please be aware that our <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosgenetics/s/data-availability">data availability policy</ext-link> requires that all numerical data underlying display items are included with the submission, and you will need to provide this before we can formally accept your manuscript, if not already present.</p>
    <p>----------------------------------------------------</p>
    <p>
      <bold>Press Queries</bold>
    </p>
    <p>If you or your institution will be preparing press materials for this manuscript, or if you need to know your paper's publication date for media purposes, please inform the journal staff as soon as possible so that your submission can be scheduled accordingly. Your manuscript will remain under a strict press embargo until the publication date and time. This means an early version of your manuscript will not be published ahead of your final version. PLOS Genetics may also choose to issue a press release for your article. If there's anything the journal should know or you'd like more information, please get in touch via <email>plosgenetics@plos.org</email>.</p>
  </body>
</sub-article>
<sub-article id="pgen.1008766.r006" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1008766.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cordell</surname>
          <given-names>Heather J</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Williams</surname>
          <given-names>Scott M.</given-names>
        </name>
        <role>Section Editor: Natural Variation</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Cordell, Williams</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Cordell, Williams</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj006" ext-link-type="doi" xlink:href="10.1371/journal.pgen.1008766" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">24 Apr 2020</named-content>
    </p>
    <p>PGENETICS-D-19-01153R2 </p>
    <p>Simultaneous SNP selection and adjustment for population structure in high dimensional prediction models </p>
    <p>Dear Dr Bhatnagar, </p>
    <p>We are pleased to inform you that your manuscript entitled "Simultaneous SNP selection and adjustment for population structure in high dimensional prediction models" has been formally accepted for publication in PLOS Genetics! Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out or your manuscript is a front-matter piece, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Genetics and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Matt Lyles</p>
    <p>PLOS Genetics</p>
    <p>On behalf of:</p>
    <p>The PLOS Genetics Team</p>
    <p>Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom</p>
    <p><email>plosgenetics@plos.org</email> | +44 (0) 1223-442823</p>
    <p><ext-link ext-link-type="uri" xlink:href="http://plosgenetics.org">plosgenetics.org</ext-link> | Twitter: @PLOSGenetics</p>
  </body>
</sub-article>
