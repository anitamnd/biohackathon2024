<?properties open_access?>
<?subarticle pcbi.1007847.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7213742</article-id>
    <article-id pub-id-type="pmid">32348298</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007847</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-01338</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Metabolism</subject>
            <subj-group>
              <subject>Metabolites</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Network Analysis</subject>
          <subj-group>
            <subject>Metabolic Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Artificial Intelligence</subject>
          <subj-group>
            <subject>Machine Learning</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Molecular Biology Assays and Analysis Techniques</subject>
              <subj-group>
                <subject>Combined Bisulfite Restriction Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Molecular Biology Assays and Analysis Techniques</subject>
            <subj-group>
              <subject>Combined Bisulfite Restriction Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Bacteria</subject>
            <subj-group>
              <subject>Staphylococcus</subject>
              <subj-group>
                <subject>Staphylococcus Aureus</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Medical Microbiology</subject>
            <subj-group>
              <subject>Microbial Pathogens</subject>
              <subj-group>
                <subject>Bacterial Pathogens</subject>
                <subj-group>
                  <subject>Staphylococcus</subject>
                  <subj-group>
                    <subject>Staphylococcus Aureus</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Pathology and Laboratory Medicine</subject>
          <subj-group>
            <subject>Pathogens</subject>
            <subj-group>
              <subject>Microbial Pathogens</subject>
              <subj-group>
                <subject>Bacterial Pathogens</subject>
                <subj-group>
                  <subject>Staphylococcus</subject>
                  <subj-group>
                    <subject>Staphylococcus Aureus</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biophysics</subject>
          <subj-group>
            <subject>Biophysical Simulations</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Biophysics</subject>
            <subj-group>
              <subject>Biophysical Simulations</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Biophysical Simulations</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Medusa: Software to build and analyze ensembles of genome-scale metabolic network reconstructions</article-title>
      <alt-title alt-title-type="running-head">Medusa: Software to build and analyze ensembles of genome-scale metabolic models</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1571-0801</contrib-id>
        <name>
          <surname>Medlock</surname>
          <given-names>Gregory L.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="currentaff001">
          <sup>¤</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8940-4970</contrib-id>
        <name>
          <surname>Moutinho</surname>
          <given-names>Thomas J.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2769-5805</contrib-id>
        <name>
          <surname>Papin</surname>
          <given-names>Jason A.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Biomedical Engineering, University of Virginia, Charlottesville, Virginia, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Medicine, Division of Infectious Diseases and International Health, University of Virginia, Charlottesville, VA, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Biochemistry and Molecular Genetics, University of Virginia, Charlottesville, Virginia, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Berry</surname>
          <given-names>Hugues</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Inria, FRANCE</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="current-aff" id="currentaff001">
        <label>¤</label>
        <p>Current address: Division of Gastroenterology, Hepatology, and Nutrition, Department of Pediatrics, University of Virginia, Charlottesville, Virginia, United States of America</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>glm5uh@virginia.edu</email> (GLM); <email>papin@virginia.edu</email> (JAP)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>4</issue>
    <elocation-id>e1007847</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>8</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>4</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Medlock et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Medlock et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1007847.pdf"/>
    <abstract>
      <p>Uncertainty in the structure and parameters of networks is ubiquitous across computational biology. In constraint-based reconstruction and analysis of metabolic networks, this uncertainty is present both during the reconstruction of networks and in simulations performed with them. Here, we present Medusa, a Python package for the generation and analysis of ensembles of genome-scale metabolic network reconstructions. Medusa builds on the COBRApy package for constraint-based reconstruction and analysis by compressing a set of models into a compact ensemble object, providing functions for the generation of ensembles using experimental data, and extending constraint-based analyses to ensemble scale. We demonstrate how Medusa can be used to generate ensembles and perform ensemble simulations, and how machine learning can be used in conjunction with Medusa to guide the curation of genome-scale metabolic network reconstructions. Medusa is available under the permissive MIT license from the Python Packaging Index (<ext-link ext-link-type="uri" xlink:href="https://pypi.org/">https://pypi.org</ext-link>) and from github (<ext-link ext-link-type="uri" xlink:href="https://github.com/opencobra/Medusa">https://github.com/opencobra/Medusa</ext-link>), and comprehensive documentation is available at <ext-link ext-link-type="uri" xlink:href="https://medusa.readthedocs.io/en/latest/">https://medusa.readthedocs.io/en/latest</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000092</institution-id>
            <institution>U.S. National Library of Medicine</institution>
          </institution-wrap>
        </funding-source>
        <award-id>T32LM012416</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1571-0801</contrib-id>
          <name>
            <surname>Medlock</surname>
            <given-names>Gregory L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM108501</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2769-5805</contrib-id>
          <name>
            <surname>Papin</surname>
            <given-names>Jason A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100006990</institution-id>
            <institution>Thomas F. and Kate Miller Jeffress Memorial Trust</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2769-5805</contrib-id>
          <name>
            <surname>Papin</surname>
            <given-names>Jason A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000865</institution-id>
            <institution>Bill and Melinda Gates Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>OPP1211869</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1571-0801</contrib-id>
          <name>
            <surname>Medlock</surname>
            <given-names>Gregory L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100006955</institution-id>
            <institution>Office of Extramural Research, National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01AT010253</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2769-5805</contrib-id>
          <name>
            <surname>Papin</surname>
            <given-names>Jason A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>We acknowledge funding from the National Institutes of Health R01GM108501, R01AT010253, and T32LM012416 to J.P. We also acknowledge funding from the Thomas F. and Kate Miller Jeffress Memorial Trust to J.P., a Wagner predoctoral fellowship to G.L.M., and a Grand Challenges Exploration Phase I grant (OPP1211869) from the Bill &amp; Melinda Gates Foundation to G.L.M. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="0"/>
      <page-count count="11"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2020-05-11</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The data underlying the results presented in the study are available from <ext-link ext-link-type="uri" xlink:href="https://github.com/opencobra/medusa">https://github.com/opencobra/medusa</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The data underlying the results presented in the study are available from <ext-link ext-link-type="uri" xlink:href="https://github.com/opencobra/medusa">https://github.com/opencobra/medusa</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Software paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Hypothesis-driven computational models of biological systems are being increasingly applied to guide experimentation [<xref rid="pcbi.1007847.ref001" ref-type="bibr">1</xref>]. In hypothesis-driven modeling, in contrast to data-driven modeling [<xref rid="pcbi.1007847.ref002" ref-type="bibr">2</xref>], hypothesized biological parts, functions, and interactions are mathematically formalized to allow <italic>in silico</italic> experimentation. These models take many forms, ranging in complexity from a single linear equation relating two quantities to systems of nonlinear differential equations describing dynamic systems.</p>
    <p>Across all hypothesis-driven modeling frameworks, the choice of model scope and parameter values may strongly influence simulation results. For some types of hypothesis-driven models in biology, approaches from other fields have been applied to quantify the influence of parameter values on simulation outcomes, such as sensitivity analysis of dynamical models [<xref rid="pcbi.1007847.ref003" ref-type="bibr">3</xref>]. For network-based models of biological systems such as metabolic or signaling networks, the presence or absence of a network component may be uncertain due to lack of characterization or uncertainty in data itself. Traditional sensitivity analysis methods have recently been reformulated for these systems to analyze sensitivity to topological variation, but these methods have not seen wide adoption [<xref rid="pcbi.1007847.ref004" ref-type="bibr">4</xref>]. While uncertainty in network structure poses analytical difficulties, it also presents an actionable framework to accelerate biological discovery. Alternative network structures can guide experimental design, allowing comparison of simulation results for alternative networks to experimental data to identify the network structure most consistent with biological behavior (i.e. model selection) [<xref rid="pcbi.1007847.ref005" ref-type="bibr">5</xref>]. This uncertainty can also be used to prioritize experiments that will maximally improve confidence in the simulations performed with a model (i.e. uncertainty reduction) [<xref rid="pcbi.1007847.ref006" ref-type="bibr">6</xref>].</p>
    <p>In studies of metabolism, genome-scale metabolic network reconstructions (GENREs) have emerged as a useful formalism for hypothesis-driven modeling [<xref rid="pcbi.1007847.ref007" ref-type="bibr">7</xref>]. In conjunction with biological objective functions, such as maximization of growth rate, GENREs can be used to construct genome-scale metabolic models (GEMs). In addition to topological uncertainty (e.g., presence/absence of reactions in a network), simulations with GEMs generally yield many alternative solutions. Even the simplest simulations that can be performed with GEMs exhibit this behavior. This is the case for flux balance analysis (FBA), in which a pseudo-steady state is assumed, and flux values are found for all reactions in a GEM such that an objective function is optimized [<xref rid="pcbi.1007847.ref008" ref-type="bibr">8</xref>]. While a single global maximum value for the objective is guaranteed to be found, flux through every other component of the network is only constrained within a solution space, not to a single value. As a result, even though performing FBA yields a single value for the flux through reactions in a network, there are an infinite number of feasible flux values within the range determined by the solution space for some reactions. Techniques such as flux variability analysis and flux sampling have been developed to explore the space of alternative solutions in this scenario [<xref rid="pcbi.1007847.ref009" ref-type="bibr">9</xref>,<xref rid="pcbi.1007847.ref010" ref-type="bibr">10</xref>].</p>
    <p>A myriad of additional algorithms have been developed for the analysis of GEMs for strain engineering, contextualization of experimental data, and building cell- and tissue-type specific GEMs [<xref rid="pcbi.1007847.ref011" ref-type="bibr">11</xref>–<xref rid="pcbi.1007847.ref013" ref-type="bibr">13</xref>]. In addition to optimization problems that can be solved using linear programming such as FBA, problems have been formulated to take advantage of mixed integer linear programming (MILP; see [<xref rid="pcbi.1007847.ref014" ref-type="bibr">14</xref>] for a review of optimization problems in systems biology). MILP employs binary state variables during optimization to solve problems that involve discrete activation or inactivation of variables. MILP problems are particularly well-suited to network-based models, since they allow switch-like behavior that can include or exclude network components (e.g., shutting reactions off/on). MILP has been used widely for gap-filling of GEMs, a process in which constraints or objectives are set to recapitulate a known phenotype by adding biochemical functions from a universal set of reactions [<xref rid="pcbi.1007847.ref015" ref-type="bibr">15</xref>]. In MILP problems used for gap-filling, the objective function is generally minimization of the number of modifications to a GEM that must be made to satisfy the constraints imposed (e.g., metabolite uptake or secretion, production of biomass). One consequence of this formulation is that alternative solutions, which contain unique sets of reactions which need to be altered in the network or added, are common for large networks that have a large space of potential solutions to draw from (e.g., a large universal set of reactions). These alternative optima in MILP problems are increasingly being considered and leveraged to understand redundancy in solutions and whether or not portions of a solution may be spurious [<xref rid="pcbi.1007847.ref016" ref-type="bibr">16</xref>–<xref rid="pcbi.1007847.ref018" ref-type="bibr">18</xref>].</p>
    <p>It has been shown that the order in which separate instances of gap-filling are applied to the same network (e.g., gap-filling for growth on individual carbon sources iteratively) strongly influences which reactions are included in the resulting network [<xref rid="pcbi.1007847.ref019" ref-type="bibr">19</xref>]. In this same study, the alternative solutions generated during this process were used to improve gene essentiality predictions using EnsembleFBA, a technique in which sets of alternative GEMs are used to perform FBA to determine gene essentiality. Using the entire ensemble, performance can be tuned by varying the voting threshold required to make a specific prediction. This is analogous to the threshold-based voting procedure used to construct receiver operating characteristic curves for ensemble-based machine learning models such as random forest [<xref rid="pcbi.1007847.ref020" ref-type="bibr">20</xref>]. This approach is likely to be highly beneficial for studies of organisms for which little biochemical data are available, which typically have many gaps in their GENRE and thus have many highly-variable alternative gap-filling solutions. Although a nascent approach for studying GENREs, we have built on these observations, and ensemble generation and analysis have been applied in several cases [<xref rid="pcbi.1007847.ref006" ref-type="bibr">6</xref>,<xref rid="pcbi.1007847.ref019" ref-type="bibr">19</xref>,<xref rid="pcbi.1007847.ref021" ref-type="bibr">21</xref>,<xref rid="pcbi.1007847.ref022" ref-type="bibr">22</xref>].</p>
    <p>Here, we present Medusa, a Python package for the generation and analysis of ensembles of GENREs. Medusa provides a framework for compactly representing ensembles of GENREs, avoiding the redundancy of storing many separate models while still being flexible enough to represent variation in any component within a GENRE. Medusa manages ensemble storage and indexing during simulation, allowing users to interact with an entire ensemble in the same way they would interact with an individual GENRE using any constraint-based reconstruction and analysis (COBRA) method. Furthermore, by standardizing the representation of ensembles and their interface with existing COBRA methods, Medusa enables the application of supervised and unsupervised machine learning to gain insight into the influence of varying components within an ensemble of GENREs on the predictions they make. The architecture and functionality of Medusa were designed to make ensemble analyses as accessible and usable as COBRA methods applied to single networks.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Design and implementation</title>
    <sec id="sec003">
      <title>Architecture overview and dependencies</title>
      <p>Medusa is built on top of COBRApy, a Python-based package in which many COBRA methods are implemented [<xref rid="pcbi.1007847.ref023" ref-type="bibr">23</xref>]. Although a dependency-free approach in which ensemble simulation methods are implemented from the ground up could be more efficient, we chose to extend COBRApy to greatly decrease the size and complexity of the codebase and to reduce the domain-specific knowledge required to use Medusa and understand the source code (i.e. decrease the effort for existing COBRApy users and contributors to use Medusa). As such, the architecture of Medusa closely mimics COBRApy <bold><xref ref-type="fig" rid="pcbi.1007847.g001">Fig 1</xref></bold>.</p>
      <fig id="pcbi.1007847.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007847.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Architecture of ensembles and simulation output in Medusa.</title>
          <p><bold>A)</bold> Ensemble functionality is implemented in Medusa through the Ensemble class. The Ensemble class exposes three attributes to the user: features, members, and base_model. Both features and members are container-like objects similar to genes, reactions, and metabolites in COBRApy. Within each container, Medusa objects of class feature and member are stored. The base_model attribute points to a COBRApy model. This base_model contains all of the features present in any member of the ensemble, and is manipulated when generating an ensemble or performing simulations. <bold>B)</bold> Description and shape of simulation results for common COBRA methods as implemented in Medusa. Each simulation method returns a distribution-equivalent to the single-model simulation result.</p>
        </caption>
        <graphic xlink:href="pcbi.1007847.g001"/>
      </fig>
      <p>At the time of this writing, GENREs are represented within COBRApy using a Model class. The Model class manages the interface between COBRApy and numerical solvers through optlang, a Python package for formulating and solving optimization problems that extends the symbolic mathematics package SymPy [<xref rid="pcbi.1007847.ref024" ref-type="bibr">24</xref>,<xref rid="pcbi.1007847.ref025" ref-type="bibr">25</xref>]. GENREs are represented by a Model using additional classes with biological analogs (Metabolite, Reaction, and Gene). Objects belonging to each of these classes are stored within container-like objects (metabolites, reactions, and genes, respectively) that are each an attribute of a Model. Each Metabolite, Reaction, and Gene has attributes which might affect simulations performed using the Model, such as the lower and upper bounds of flux through each Reaction or the gene-protein-reaction relationship for each Reaction, which link them to specific Genes.</p>
      <p>In Medusa, ensemble functionality is introduced using three new classes. The first, Feature, describes a GENRE component which has a parameter that varies across an ensemble (e.g., a reaction that is reversible in some ensemble members but irreversible in others). The second, Member, describes individual GENREs within an ensemble and their state for each Feature. The third is the Ensemble class, which references every Feature and Member associated with an ensemble of GENREs, as well as a COBRApy Model, referred to as the “base model”. This base model holds all COBRApy objects that might be associated with any Member in the Ensemble. Within an Ensemble, each Feature references the component within the base model (Metabolite, Reaction, or Gene) for which it encodes alternative parameter values, as well as the attribute within that component that is modified (e.g., the upper bound of flux through a reaction). When a simulation is to be performed using a particular GENRE within an Ensemble, Medusa changes the state of the base model to represent the proper state for the corresponding Member for every Feature. Thus, the Ensemble can represent any number of variants in GENRE structure throughout an ensemble (e.g., reaction presence/absence, reversibility, alternative gene-protein-reaction relationships) and can be used to apply any methods implemented in COBRApy. Furthermore, this implementation has a memory footprint only slightly larger than a single COBRApy Model, and facilitates queuing of simulations for parallel processing.</p>
      <p>Medusa is developed partially with test-driven development. Unit tests are implemented using the pytest package (<ext-link ext-link-type="uri" xlink:href="https://docs.pytest.org/en/latest">https://docs.pytest.org/en/latest</ext-link>) and are run automatically with each modification to the Medusa github repository via continuous integration with TravisCI (Travis CI, GMBH, Berlin, Germany). Support is provided for Python version 3.4 and later. Tests are run in TravisCI using Python 3.6, with plans to include Python 3.7 and 3.8. No support is provided for Python 2.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec004">
    <title>Results</title>
    <sec id="sec005">
      <title>Performing ensemble simulations</title>
      <p>Currently, users can perform FBA, flux variability analysis (FVA), single gene deletions, and single reaction deletions using an ensemble in Medusa. In each case, the simulations are performed with a single function, which returns a collection of results, where each entry corresponds to the simulation results for a single ensemble member. Users have the option of performing simulations using the entire ensemble, a specific set of Members, or a random fraction of Members. For the currently implemented analyses, the collection of results are returned as a DataFrame from the pandas Python package, where each column corresponds to the entry normally populating the results for a single network (e.g., a reaction ID for FBA/FVA, a gene ID for single gene deletions), and each row corresponds to an ensemble Member (except for FVA, where two columns are required for each ensemble member to describe the minimum and maximum fluxes). See <bold><xref ref-type="fig" rid="pcbi.1007847.g002">Fig 2</xref></bold> for a schematic describing how the shape of data describing simulation results changes for each simulation method.</p>
      <fig id="pcbi.1007847.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007847.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Usage and benchmarking of Medusa.</title>
          <p><bold>A) Comparison of ensemble flux balance analysis (FBA) simulations across different conditions</bold>. <bold>A)</bold> Ensemble FBA performed on glucose or mannose minimal media using an ensemble of 1000 GEMs for <italic>Staphylococcus aureus</italic>. This ensemble was generated in [<xref rid="pcbi.1007847.ref006" ref-type="bibr">6</xref>] by iteratively gap-filling a draft reconstruction to enable biomass production in single-carbon source growth conditions supported with experimental data. Mean for the distribution for either condition shown by vertical line of same color. Predicted flux through biomass is higher on mannose than glucose (Wilcoxon signed-rank test, <italic>p</italic> &lt; 1E-5). <bold>B)</bold> Benchmarking of Ensemble FBA. Simulations were performed with the same <italic>S</italic>. <italic>aureus</italic> ensemble of 1000 members as in panel A. <bold>C)</bold> Benchmarking of ensemble generation time with iterative gapfilling (process shown in <xref ref-type="fig" rid="pcbi.1007847.g003">Fig 3</xref>). <bold>D</bold> Comparison of Ensemble FBA simulations before and after curation using a machine learning-guided approach. Ensemble FBA was performed on complete medium (uptake of -1000 mmol/g*DW*hr allowed for all metabolites) using an ensemble of 1000 GEMs for <italic>S</italic>. <italic>aureus</italic>. Mean for the distributions before and after curation shown by vertical line of same color in the last panel in the workflow. Ensemble and machine-learning guided curation identified N-Formimino-L-glutamate iminohydrolase as a driver of variation in simulated flux through biomass. Based on a literature search, this reaction was inactivated in all ensemble members and ensemble FBA was performed again, resulting in the shift in the distribution shown. See documentation for full narrative-style example: <ext-link ext-link-type="uri" xlink:href="https://medusa.readthedocs.io/en/latest/machine_learning.html">https://medusa.readthedocs.io/en/latest/machine_learning.html</ext-link>.</p>
        </caption>
        <graphic xlink:href="pcbi.1007847.g002"/>
      </fig>
      <p>Because the Ensemble object implemented in Medusa maintains a COBRApy Model object, users can also perform any custom simulation they would like by 1) manipulating the COBRApy Model to be suitable for their simulations (e.g., set custom constraints or objectives), 2) setting the state of the model to represent an ensemble member using Medusa functionality, 3) performing their simulation, then 4) iterating through any other ensemble members they would like and performing steps 2–3.</p>
    </sec>
    <sec id="sec006">
      <title>Comparing ensemble simulations</title>
      <p>When performing simulations with an ensemble rather than a single model, results shift from single values to distributions. While this explicitly accounts for uncertainty, it also requires that statistical approaches are applied to interpret differences in distributions. In the simplest case, performing ensemble FBA to predict the growth rate on each of two different media conditions for a single bacterial species generates two distributions of predicted growth rates <bold><xref ref-type="fig" rid="pcbi.1007847.g003">Fig 3A</xref></bold>. A paired univariate test (e.g., t-test or a non-parametric equivalent) can be used to determine whether the predicted growth rate is equal in these two conditions. This example is demonstrated in the Medusa documentation at <ext-link ext-link-type="uri" xlink:href="https://medusa.readthedocs.io/en/latest/stats_compare.html">https://medusa.readthedocs.io/en/latest/stats_compare.html</ext-link>.</p>
      <fig id="pcbi.1007847.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007847.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Iterative gap-filling strategy used to generate ensembles implemented in Medusa.</title>
          <p><bold>A)</bold> Given a list of conditions in which an organism satisfied some objective (e.g., secretion of a specific metabolite, growth) and a draft GENRE for the organism, gap-filling is performed sequentially on each condition. After each gap-fill step on a single condition, reactions in the gap-fill solution are added to the GENRE before starting gap-filling on the next condition. In this schematic, all conditions are used, but Medusa also allows users to randomly subsample a fraction of conditions to generate more variation in the resulting gap-filled GENREs. Here, gap-filling is performed to enable growth in the presence of each individual metabolite (indicated by a green arrow for a single condition during each gap-fill step). <bold>B)</bold> Medusa iteratively performs gap-filling as shown in panel <bold>A</bold>, then shuffles the order of conditions to introduce variation in the gap-fill solution. After a user-defined number of cycles through the process shown in panel <bold>A</bold>, Medusa generates an ensemble containing all unique GENREs that resulted from gap-filling.</p>
        </caption>
        <graphic xlink:href="pcbi.1007847.g003"/>
      </fig>
    </sec>
    <sec id="sec007">
      <title>Coupling ensemble modeling with machine learning</title>
      <p>The availability of ensemble generation and simulation methods in Medusa provides ample opportunity to apply machine learning to leverage variation in ensembles. One application area that we have developed focuses on guiding the curation of genome-scale metabolic network reconstructions by attributing simulation uncertainty to network components in the ensemble, then prioritizing curation of these components based on how much they contribute to simulation uncertainty [<xref rid="pcbi.1007847.ref006" ref-type="bibr">6</xref>]. This approach can be broken down into four steps: 1) ensemble generation, 2) ensemble simulations, 3) unsupervised learning to summarize simulation uncertainty, and 4) supervised learning to associate uncertainty in network structure with uncertainty in simulations. In addition to our published work utilizing Medusa for this purpose, we provide an example in the Medusa documentation that applies this method to a single ensemble FBA simulation: <ext-link ext-link-type="uri" xlink:href="https://medusa.readthedocs.io/en/latest/machine_learning.html">https://medusa.readthedocs.io/en/latest/machine_learning.html</ext-link>.</p>
      <p>In this example, a previously generated ensemble is loaded into Medusa, media conditions are set to allow uptake of any metabolites with transporters in the ensemble, and ensemble FBA is performed. Then, a random forest regressor is used to predict the simulated values for flux through biomass (e.g., the values generated with ensemble FBA) for each ensemble member using the Medusa states (i.e., binary reaction presence/absence) for the same ensemble member as input. Examining the most predictive feature in the random forest regressor, we perform a literature search and find that the feature is likely not present for the bacterial species under study (i.e. the species does not have the ability to catalyze the reaction described by the feature). Based on this examination, we disable the feature (which is a reaction in this case), perform ensemble FBA again, and find that this curation step has reduced the average predicted flux through biomass <bold><xref ref-type="fig" rid="pcbi.1007847.g003">Fig 3B</xref></bold>. Although we use this approach to guide curation, we also envision the same process having great utility for attributing simulation uncertainty more generically, such as with simulations performed using an ensemble generated using ‘omics integration methods [<xref rid="pcbi.1007847.ref011" ref-type="bibr">11</xref>].</p>
    </sec>
    <sec id="sec008">
      <title>Generating ensembles</title>
      <p>The simplest way to generate an ensemble in Medusa is to load a collection of models from files or a collection of COBRApy Model objects. This can be performed by specifying a batch of files that Medusa loads iteratively to construct an ensemble or by loading all the models into memory as COBRApy Models and passing them to an ensemble constructor function. Access to both of these methods for constructing an ensemble gives users flexibility to use other software that generates multiple GENREs and to construct their own ensembles from COBRApy Models that are only ever present in memory (i.e., never written to disk). There are also performance tradeoffs between each method; constructing an ensemble from a batch of files allows the user to specify a batch size for the number of models loaded into memory during each iteration. Increasing the batch size increases memory usage but generally decreases the time required to construct an ensemble. Similarly, constructing an ensemble from a collection of COBRApy Models already loaded into memory has high memory usage but low runtime.</p>
      <p>Ensembles can also be generated in Medusa by performing gap-filling on an individual GENRE. Medusa implements a previously-developed algorithm for gap-filling GENREs using growth phenotyping data [<xref rid="pcbi.1007847.ref006" ref-type="bibr">6</xref>,<xref rid="pcbi.1007847.ref019" ref-type="bibr">19</xref>]. The algorithm takes a GENRE with an objective function (i.e., a COBRApy Model), a universal reaction database (stored as a COBRApy Model) and a dataset of binary growth/no-growth calls on defined media conditions as input. The objective function is then set as a constraint with bounds such that any feasible flux distribution must enable activity within the bounds (e.g. at least some amount of flux through biomass production or a demand reaction). All reactions from the universal reaction database are added to the GENRE being gap-filled, and a new objective function is set to minimize the sum of fluxes through reactions in the reaction database. The problem is solved to identify reactions taking part in this minimal flux activity. To generate a single gap-filled ensemble member, the draft GENRE is iteratively gap-filled on each positive growth media condition. This process is repeated to produce the number of desired ensemble members. Variation in model structure is introduced by randomizing the order in which media conditions are used for gap-filling. We previously found that ensemble members generated with this iterative strategy are equivalent to gap-filled models generated by finding a single gap-filling solution to all growth conditions simultaneously (i.e., with a single optimization step), yet this iterative process is multiple orders of magnitude faster than the global solution [<xref rid="pcbi.1007847.ref019" ref-type="bibr">19</xref>]. See <bold><xref ref-type="fig" rid="pcbi.1007847.g003">Fig 3A and 3B</xref></bold> for a schematic summarizing this approach.</p>
      <p>This gap-filling process is implemented in Medusa through a single function, and a full example of preparing a model and all data necessary for this process are provided in the Medusa documentation at <ext-link ext-link-type="uri" xlink:href="https://medusa.readthedocs.io/en/latest/creating_ensemble.html">https://medusa.readthedocs.io/en/latest/creating_ensemble.html</ext-link>. Although Medusa implements the previously published version of this approach, it also allows users to randomly subsample a fraction of conditions to generate more variation in the resulting gap-filled GENREs. We benchmarked construction of ensembles using the standard Medusa iterative gap-filling approach, a <italic>Staphylococcus aureus</italic> draft metabolic network reconstruction generated via ModelSEED [<xref rid="pcbi.1007847.ref026" ref-type="bibr">26</xref>], and the modelSEED universal biochemistry using a 2019 Apple Macbook Pro (2.4GHz Intel Core i5-8279U, 16GB RAM). Ensembles with 5, 25, or 100 members, gap-filled on 10 randomized positive growth media conditions, took an average of 1.8, 5.3, and 18.6 minutes to generate in 10 independent trials (<bold><xref ref-type="fig" rid="pcbi.1007847.g002">Fig 2C</xref></bold>). A substantial portion of this time (~60 seconds) is spent copying the universal model; time spent after this copy step scales linearly with the size of the ensemble being generated.</p>
    </sec>
    <sec id="sec009">
      <title>Benchmarking Medusa</title>
      <p>The structure of a Medusa Ensemble was designed to help users simplify their code when dealing with an ensemble of models, decrease memory and disk storage demands, and decrease processing time when possible. The Medusa documentation provides thorough benchmarking examples for multiprocessing using Medusa, constructing an ensemble, and memory and disk utilization. These benchmarking notebooks demonstrate the memory savings when using a Medusa Ensemble rather than individual models (~50MB with Medusa vs. ~16GB for individual models representing an ensemble with 1000 members) and the disk space savings in the same scenario (~6MB for a Medusa Ensemble vs. 1GB for 1000 individual models). Medusa reduces memory and storage demands by over two orders of magnitude in these cases. Improvements in runtime for performing FBA in Medusa, rather than using individual models, are more modest but improve further when using more than one processor. <bold><xref ref-type="fig" rid="pcbi.1007847.g002">Fig 2B</xref></bold> shows the decrease in optimization runtime in Medusa as the number of processors is increased, and the diminishing returns associated with a larger number of processors. Memory, storage, and runtime benchmarking were performed using the same hardware as the iterative gapfilling benchmarking in <bold><xref ref-type="fig" rid="pcbi.1007847.g002">Fig 2C</xref></bold>. All benchmarking is available in narrative-style notebooks in the Medusa documentation.</p>
    </sec>
  </sec>
  <sec id="sec010">
    <title>Availability and future directions</title>
    <p>Stable releases of Medusa are available through the Python package index (PyPI, <ext-link ext-link-type="uri" xlink:href="https://pypi.org/">https://pypi.org</ext-link>) as well as github (<ext-link ext-link-type="uri" xlink:href="https://github.com/opencobra/Medusa">https://github.com/opencobra/Medusa</ext-link>). Documentation is available through Readthedocs at <ext-link ext-link-type="uri" xlink:href="https://medusa.readthedocs.io/">https://medusa.readthedocs.io</ext-link>. Current development efforts are focused on parallelization and integrating Medusa with other Python-based tools in the COBRA community.</p>
    <p>Currently, the only high-level function available to users of Medusa to share ensembles generates a serialized version of the Ensemble object using the pickle package (the standard Python library package for serializing objects). Alternatively, users can save the base_model for any Ensemble as a Systems Biology Markup Language (SBML, [<xref rid="pcbi.1007847.ref027" ref-type="bibr">27</xref>]) file using COBRApy, then choose the formatting option of their liking to save Feature and Member information for the Ensemble. In SBML, there is not currently a standardized way to represent ensembles as required in Medusa. We plan on extending the Flux Balance Constraints package, an extension to SBML intended for constraint-based models, to enable standardized sharing of Medusa ensembles. Until then, we recommend users include both an SBML file for the base_model of each Ensemble and the serialized pickle at time of publication.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Dennis McDuffie and Jean-Luc Maigrot for feedback on the usability of Medusa and members of the Papin lab for feedback on documentation.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1007847.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Kitano</surname><given-names>H</given-names></name>. <article-title>Systems biology: a brief overview</article-title>. <source>Science</source>. <year>2002</year>;<volume>295</volume>: <fpage>1662</fpage>–<lpage>1664</lpage>. <pub-id pub-id-type="doi">10.1126/science.1069492</pub-id><?supplied-pmid 11872829?><pub-id pub-id-type="pmid">11872829</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Janes</surname><given-names>KA</given-names></name>, <name><surname>Yaffe</surname><given-names>MB</given-names></name>. <article-title>Data-driven modelling of signal-transduction networks</article-title>. <source>Nat Rev Mol Cell Biol</source>. <year>2006</year>;<volume>7</volume>: <fpage>820</fpage>–<lpage>828</lpage>. <pub-id pub-id-type="doi">10.1038/nrm2041</pub-id><?supplied-pmid 17057752?><pub-id pub-id-type="pmid">17057752</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Marino</surname><given-names>S</given-names></name>, <name><surname>Hogue</surname><given-names>IB</given-names></name>, <name><surname>Ray</surname><given-names>CJ</given-names></name>, <name><surname>Kirschner</surname><given-names>DE</given-names></name>. <article-title>A methodology for performing global uncertainty and sensitivity analysis in systems biology</article-title>. <source>J Theor Biol</source>. <year>2008</year>;<volume>254</volume>: <fpage>178</fpage>–<lpage>196</lpage>. <pub-id pub-id-type="doi">10.1016/j.jtbi.2008.04.011</pub-id><?supplied-pmid 18572196?><pub-id pub-id-type="pmid">18572196</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Babtie</surname><given-names>AC</given-names></name>, <name><surname>Kirk</surname><given-names>P</given-names></name>, <name><surname>Stumpf</surname><given-names>MPH</given-names></name>. <article-title>Topological sensitivity analysis for systems biology</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2014</year>;<volume>111</volume>: <fpage>18507</fpage>–<lpage>18512</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1414026112</pub-id><?supplied-pmid 25512544?><pub-id pub-id-type="pmid">25512544</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Silk</surname><given-names>D</given-names></name>, <name><surname>Kirk</surname><given-names>PDW</given-names></name>, <name><surname>Barnes</surname><given-names>CP</given-names></name>, <name><surname>Toni</surname><given-names>T</given-names></name>, <name><surname>Stumpf</surname><given-names>MPH</given-names></name>. <article-title>Model selection in systems biology depends on experimental design</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>: <fpage>e1003650</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003650</pub-id><?supplied-pmid 24922483?><pub-id pub-id-type="pmid">24922483</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Medlock</surname><given-names>GL</given-names></name>, <name><surname>Papin</surname><given-names>JA</given-names></name>. <article-title>Guiding the Refinement of Biochemical Knowledgebases with Ensembles of Metabolic Networks and Machine Learning</article-title>. <source>Cell Syst</source>. <year>2020</year>;<volume>10</volume>: <fpage>109</fpage>–<lpage>119.e3</lpage>. <pub-id pub-id-type="doi">10.1016/j.cels.2019.11.006</pub-id><?supplied-pmid 31926940?><pub-id pub-id-type="pmid">31926940</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Oberhardt</surname><given-names>MA</given-names></name>, <name><surname>Palsson</surname><given-names>BØ</given-names></name>, <name><surname>Papin</surname><given-names>JA</given-names></name>. <article-title>Applications of genome‐scale metabolic reconstructions</article-title>. <source>Mol Syst Biol</source>. <year>2009</year>;<volume>5</volume>: <fpage>320</fpage><pub-id pub-id-type="doi">10.1038/msb.2009.77</pub-id><?supplied-pmid 19888215?><pub-id pub-id-type="pmid">19888215</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Orth</surname><given-names>JD</given-names></name>, <name><surname>Thiele</surname><given-names>I</given-names></name>, <name><surname>Palsson</surname><given-names>BØ</given-names></name>. <article-title>What is flux balance analysis?</article-title><source>Nat Biotechnol</source>. <year>2010</year>;<volume>28</volume>: <fpage>245</fpage><pub-id pub-id-type="doi">10.1038/nbt.1614</pub-id><?supplied-pmid 20212490?><pub-id pub-id-type="pmid">20212490</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Mahadevan</surname><given-names>R</given-names></name>, <name><surname>Schilling</surname><given-names>CH</given-names></name>. <article-title>The effects of alternate optimal solutions in constraint-based genome-scale metabolic models</article-title>. <source>Metab Eng</source>. <year>2003</year>;<volume>5</volume>: <fpage>264</fpage>–<lpage>276</lpage>. <pub-id pub-id-type="doi">10.1016/j.ymben.2003.09.002</pub-id><?supplied-pmid 14642354?><pub-id pub-id-type="pmid">14642354</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Schellenberger</surname><given-names>J</given-names></name>, <name><surname>Palsson</surname><given-names>BØ</given-names></name>. <article-title>Use of randomized sampling for analysis of metabolic networks</article-title>. <source>J Biol Chem</source>. <year>2009</year>;<volume>284</volume>: <fpage>5457</fpage>–<lpage>5461</lpage>. <pub-id pub-id-type="doi">10.1074/jbc.R800048200</pub-id><?supplied-pmid 18940807?><pub-id pub-id-type="pmid">18940807</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Blazier</surname><given-names>AS</given-names></name>, <name><surname>Papin</surname><given-names>JA</given-names></name>. <article-title>Integration of expression data in genome-scale metabolic network reconstructions</article-title>. <source>Front Physiol</source>. <year>2012</year>;<volume>3</volume>: <fpage>299</fpage><pub-id pub-id-type="doi">10.3389/fphys.2012.00299</pub-id><?supplied-pmid 22934050?><pub-id pub-id-type="pmid">22934050</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Machado</surname><given-names>D</given-names></name>, <name><surname>Herrgård</surname><given-names>M</given-names></name>. <article-title>Systematic evaluation of methods for integration of transcriptomic data into constraint-based models of metabolism</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>: <fpage>e1003580</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003580</pub-id><?supplied-pmid 24762745?><pub-id pub-id-type="pmid">24762745</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>L</given-names></name>, <name><surname>Dash</surname><given-names>S</given-names></name>, <name><surname>Ng</surname><given-names>CY</given-names></name>, <name><surname>Maranas</surname><given-names>CD</given-names></name>. <article-title>A review of computational tools for design and reconstruction of metabolic pathways</article-title>. <source>Synth Syst Biotechnol</source>. <year>2017</year>;<volume>2</volume>: <fpage>243</fpage>–<lpage>252</lpage>. <pub-id pub-id-type="doi">10.1016/j.synbio.2017.11.002</pub-id><?supplied-pmid 29552648?><pub-id pub-id-type="pmid">29552648</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Banga</surname><given-names>JR</given-names></name>. <article-title>Optimization in computational systems biology</article-title>. <source>BMC Syst Biol</source>. <year>2008</year>;<volume>2</volume>: <fpage>47</fpage><pub-id pub-id-type="doi">10.1186/1752-0509-2-47</pub-id><?supplied-pmid 18507829?><pub-id pub-id-type="pmid">18507829</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Reed</surname><given-names>JL</given-names></name>, <name><surname>Patel</surname><given-names>TR</given-names></name>, <name><surname>Chen</surname><given-names>KH</given-names></name>, <name><surname>Joyce</surname><given-names>AR</given-names></name>, <name><surname>Applebee</surname><given-names>MK</given-names></name>, <name><surname>Herring</surname><given-names>CD</given-names></name>, <etal>et al</etal><article-title>Systems approach to refining genome annotation</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2006</year>;<volume>103</volume>: <fpage>17480</fpage>–<lpage>17484</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Karp</surname><given-names>PD</given-names></name>, <name><surname>Weaver</surname><given-names>D</given-names></name>, <name><surname>Latendresse</surname><given-names>M</given-names></name>. <article-title>How accurate is automated gap filling of metabolic models?</article-title><source>BMC Syst Biol</source>. <year>2018</year>;<volume>12</volume>: <fpage>73</fpage><pub-id pub-id-type="doi">10.1186/s12918-018-0593-7</pub-id><?supplied-pmid 29914471?><pub-id pub-id-type="pmid">29914471</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Robaina-Estévez</surname><given-names>S</given-names></name>, <name><surname>Nikoloski</surname><given-names>Z</given-names></name>. <article-title>On the effects of alternative optima in context-specific metabolic model predictions</article-title>. <source>PLoS Comput Biol</source>. <year>2017</year>;<volume>13</volume>: <fpage>e1005568</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005568</pub-id><?supplied-pmid 28557990?><pub-id pub-id-type="pmid">28557990</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Rossell</surname><given-names>S</given-names></name>, <name><surname>Huynen</surname><given-names>MA</given-names></name>, <name><surname>Notebaart</surname><given-names>RA</given-names></name>. <article-title>Inferring metabolic states in uncharacterized environments using gene-expression measurements</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>: <fpage>e1002988</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002988</pub-id><?supplied-pmid 23555222?><pub-id pub-id-type="pmid">23555222</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Biggs</surname><given-names>MB</given-names></name>, <name><surname>Papin</surname><given-names>JA</given-names></name>. <article-title>Managing uncertainty in metabolic network structure and improving predictions using EnsembleFBA</article-title>. <source>PLoS Comput Biol</source>. <year>2017</year>;<volume>13</volume>: <fpage>e1005413</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005413</pub-id><?supplied-pmid 28263984?><pub-id pub-id-type="pmid">28263984</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Breiman</surname><given-names>L</given-names></name>. <article-title>Random Forests</article-title>. <source>Mach Learn</source>. <year>2001</year>;<volume>45</volume>: <fpage>5</fpage>–<lpage>32</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Medlock</surname><given-names>GL</given-names></name>, <name><surname>Carey</surname><given-names>MA</given-names></name>, <name><surname>McDuffie</surname><given-names>DG</given-names></name>, <name><surname>Mundy</surname><given-names>MB</given-names></name>, <name><surname>Giallourou</surname><given-names>N</given-names></name>, <name><surname>Swann</surname><given-names>JR</given-names></name>, <etal>et al</etal><article-title>Inferring Metabolic Mechanisms of Interaction within a Defined Gut Microbiota</article-title>. <source>Cell Syst</source>. <year>2018</year>;<volume>7</volume>: <fpage>245</fpage>–<lpage>257.e7</lpage>. <pub-id pub-id-type="doi">10.1016/j.cels.2018.08.003</pub-id><?supplied-pmid 30195437?><pub-id pub-id-type="pmid">30195437</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Machado</surname><given-names>D</given-names></name>, <name><surname>Andrejev</surname><given-names>S</given-names></name>, <name><surname>Tramontano</surname><given-names>M</given-names></name>, <name><surname>Patil</surname><given-names>KR</given-names></name>. <article-title>Fast automated reconstruction of genome-scale metabolic models for microbial species and communities</article-title>. <source>Nucleic Acids Res</source>. <year>2018</year>;<volume>46</volume>: <fpage>7542</fpage>–<lpage>7553</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gky537</pub-id><?supplied-pmid 30192979?><pub-id pub-id-type="pmid">30192979</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Ebrahim</surname><given-names>A</given-names></name>, <name><surname>Lerman</surname><given-names>JA</given-names></name>, <name><surname>Palsson</surname><given-names>BO</given-names></name>, <name><surname>Hyduke</surname><given-names>DR</given-names></name>. <article-title>COBRApy: COnstraints-Based Reconstruction and Analysis for Python</article-title>. <source>BMC Syst Biol</source>. <year>2013</year>;<volume>7</volume>: <fpage>74</fpage><pub-id pub-id-type="doi">10.1186/1752-0509-7-74</pub-id><?supplied-pmid 23927696?><pub-id pub-id-type="pmid">23927696</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Jensen</surname><given-names>K</given-names></name>, <name><surname>Cardoso</surname><given-names>J</given-names></name>. <article-title>Optlang: An algebraic modeling language for mathematical optimization</article-title>. <source>Journal of Open Source Software</source>. <year>2016</year> Available: <ext-link ext-link-type="uri" xlink:href="http://www.forskningsdatabasen.dk/en/catalog/2350686580">http://www.forskningsdatabasen.dk/en/catalog/2350686580</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Meurer</surname><given-names>A</given-names></name>, <name><surname>Smith</surname><given-names>CP</given-names></name>, <name><surname>Paprocki</surname><given-names>M</given-names></name>, <name><surname>Čertík</surname><given-names>O</given-names></name>, <name><surname>Kirpichev</surname><given-names>SB</given-names></name>, <name><surname>Rocklin</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>SymPy: symbolic computing in Python</article-title>. <source>PeerJ Comput Sci</source>. <year>2017</year>;<volume>3</volume>: <fpage>e103</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Devoid</surname><given-names>S</given-names></name>, <name><surname>Overbeek</surname><given-names>R</given-names></name>, <name><surname>DeJongh</surname><given-names>M</given-names></name>, <name><surname>Vonstein</surname><given-names>V</given-names></name>, <name><surname>Best</surname><given-names>AA</given-names></name>, <name><surname>Henry</surname><given-names>C</given-names></name>. <article-title>Automated genome annotation and metabolic model reconstruction in the SEED and Model SEED</article-title>. <source>Methods Mol Biol</source>. <year>2013</year>;<volume>985</volume>: <fpage>17</fpage>–<lpage>45</lpage>. <pub-id pub-id-type="doi">10.1007/978-1-62703-299-5_2</pub-id><?supplied-pmid 23417797?><pub-id pub-id-type="pmid">23417797</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007847.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Hucka</surname><given-names>M</given-names></name>, <name><surname>Finney</surname><given-names>A</given-names></name>, <name><surname>Sauro</surname><given-names>HM</given-names></name>, <name><surname>Bolouri</surname><given-names>H</given-names></name>, <name><surname>Doyle</surname><given-names>JC</given-names></name>, <name><surname>Kitano</surname><given-names>H</given-names></name>, <etal>et al</etal><article-title>The systems biology markup language (SBML): a medium for representation and exchange of biochemical network models</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume>: <fpage>524</fpage>–<lpage>531</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btg015</pub-id><?supplied-pmid 12611808?><pub-id pub-id-type="pmid">12611808</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pcbi.1007847.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007847.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lauffenburger</surname>
          <given-names>Douglas A</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Berry</surname>
          <given-names>Hugues</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Lauffenburger, Berry</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Lauffenburger, Berry</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007847" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">22 Oct 2019</named-content>
    </p>
    <p>Dear Jason,</p>
    <p>Thank you very much for submitting your manuscript, 'Medusa: software to build and analyze ensembles of genome-scale metabolic network reconstructions', to PLOS Computational Biology. As with all papers submitted to the journal, yours was fully evaluated by the PLOS Computational Biology editorial team, and in this case, by independent peer reviewers. The reviewers appreciated the attention to an important topic but identified some aspects of the manuscript that should be improved.</p>
    <p>We would therefore like to ask you to modify the manuscript according to the review recommendations before we can consider your manuscript for acceptance. Your revisions should address all the specific points made by each reviewer and we encourage you to respond to particular issues. In particular, please be sure to address the points about quantification of the performances and gains of MEDUSA.</p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.raised.</p>
    <p>In addition, when you are ready to resubmit, please be prepared to provide the following:</p>
    <p>(1) A detailed list of your responses to the review comments and the changes you have made in the manuscript. We require a file of this nature before your manuscript is passed back to the editors.</p>
    <p>(2) A copy of your manuscript with the changes highlighted (encouraged). We encourage authors, if possible to show clearly where changes have been made to their manuscript e.g. by highlighting text.</p>
    <p>(3) A striking still image to accompany your article (optional). If the image is judged to be suitable by the editors, it may be featured on our website and might be chosen as the issue image for that month. These square, high-quality images should be accompanied by a short caption. Please note as well that there should be no copyright restrictions on the use of the image, so that it can be published under the Open-Access license and be subject only to appropriate attribution.</p>
    <p>Before you resubmit your manuscript, please consult our Submission Checklist to ensure your manuscript is formatted correctly for PLOS Computational Biology: <ext-link ext-link-type="uri" xlink:href="http://www.ploscompbiol.org/static/checklist.action">http://www.ploscompbiol.org/static/checklist.action</ext-link>. Some key points to remember are:</p>
    <p>- Figures uploaded separately as TIFF or EPS files (if you wish, your figures may remain in your main manuscript file in addition).</p>
    <p>- Supporting Information uploaded as separate files, titled 'Dataset', 'Figure', 'Table', 'Text', 'Protocol', 'Audio', or 'Video'.</p>
    <p>- Funding information in the 'Financial Disclosure' box in the online system.</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com">https://pacev2.apexcovantage.com</ext-link>  PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>We hope to receive your revised manuscript within the next 30 days. If you anticipate any delay in its return, we ask that you let us know the expected resubmission date by email at <email>ploscompbiol@plos.org</email>.</p>
    <p>If you have any questions or concerns while you make these revisions, please let us know.</p>
    <p>Sincerely,</p>
    <p>Hugues Berry</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Douglas Lauffenburger</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: This software paper describes the Medusa tool, a software to build and analyse ensembles of genome-scale metabolic network reconstructions. The main interest of Medusa is to enable the simultaneous run and comparison of analyses over families of metabolic network, such as FBA, FVA and gene essentiality. To that goal, a family of metabolic networks is represented in CobraPy Python package using a so-called Ensemble class, which references both a CobrayPy Model (describing the base model) and Features and Members to describes the specificities of the family of metabolic networks. This smart representation allow comparing ensemble of simulations and running pipelines which alternate analyses of families of metabolic networks, then selection of sub-families, followed by novel analysis. An example of such a pipeline is a curation procedure based on the prioritizing of components which contribute the most to simulation uncertainty. Another example is the automatic generation of a family of gap-filled metabolic models according to different media conditions allowing the user to see the impact of the order of the selected media conditions over the gapfilling procedure.</p>
    <p>As stated by the author, this representation of families of metabolic networks which relevant classes in CobraPy is a very smart solution to run multiple analyses and workflows and study the variability of metabolic networks while avoiding to store the multiple networks generated along the pipelines. This is particularly useful for automatic analyses involving the generation of multiple models.</p>
    <p>However, the paper is lacking some elements to ensure that the Medusa package can be used by the community. They correspond to the four main limitations below that needs to be clarified.</p>
    <p>(1) There is no information about the gains enabled by Medusa. What is the maximum number of metabolic networks that an Ensemble can describe ? What is the gain of storage space enabled by the ENSEMBLE representation with respect to a usual representation with individual models ? What are the gains of performance for FBA, FVA, and gene essentiality computations with respect to simulations with individual models ?</p>
    <p>(2) Few details are given about the generation of ENSEMBLE. How can an ENSEMBLE be generated from a family of SBML files generated with other tools ? Does the package enable this ? In addition, the author suggest to store share ENSEMBLES by using a SBML file for the base_model and then to serialize the ENSEMBLE. What is the gain if this is the recommended solution ?</p>
    <p>(3) Figure 4 is quite misleading. What is the advantage of generating Ensembles of gapfilled GENREs by shuffling the different growth conditions ? May the author show FBA and FVA simulations evidencing that the study of the Ensemble generates gains in the study of the considered metabolic network ?</p>
    <p>(4) In the introduction, the authors advocate that ENSEMBLEs are useful to handle alternative solutions generated by simulations, including infinite number of feasible flux values within the range determined by a FBA solution space. I do not understand how MEDUSA is able to handle this issue ? Is this possible to generate an ENSEMBLE modeling all such GENREs with alternative feasible fluxes and then to study them with MEDUSA ? How can this be done ? If this is not the case, I would rather suggest to remove the paragraph in the introduction to avoid confusion.</p>
    <p>Reviewer #2: The work presented here represents a useful tool for the community. However, there are some points in the manuscript that require clarification.</p>
    <p>• In the example provided in the “Coupling ensemble modeling with machine learning,” it is not clear what data the random forest is trained on. Where it says that the “… random forest regressor is used to predict the simulated values …,” are the authors actually training the random forest on those simulations and then going in to the decision trees to determine the most predictive features? If so, this should be clarified. If not, then the information needs to be added.</p>
    <p>• Some sense of the simulation “wall time” would be helpful for various size models/ensembles. Of course, it will also be necessary to provide information regarding hardware used in order for the wall time to have any significance.</p>
    <p>• One assumes that Medusa is based on Python 3, and it will become obvious once an individual uses the package. However, it would still be worthwhile to mention the version of Python against which this package is built against.</p>
    <p>Reviewer #3: In this paper, the authors describe and demonstrate Medusa, a (Python) tool for the analysis of ensemble of metabolic networks. While constraint-based modelling methods have gained immense popularity over the last two decades, they are still beset with a key problem of "degeneracy" in solutions. Furthermore, there exists uncertainty in network structure, in terms of the topology, and many gap-filling algorithms exist to fill gaps (identify missing reactions) in metabolic networks. Building on COBRAPy, Medusa can perform ensembleFBA, to address these and other important issues. Medusa also lends itself to applying machine learning tools for improving curation, and the documentation lists an example of this too.</p>
    <p>I found the paper to be very well-written and crisp. It gives a very clear overview of the use of Medusa, and the underlying methods.</p>
    <p>Minor Revisions:</p>
    <p>1. It would be nice to describe an example of how parallelisation affords advantages, and also a brief discussion of how it scales. It would be advantageous to the users to be well aware of the parallel features of Medusa, which will enable them to work with larger numbers of simulations (or larger networks).</p>
    <p>2. While Figure 3 is very good and explanative, I would find it interesting to look at a scatterplot of difference in biomass growth rates vs. similarity of the reaction networks in the ensemble. That is, for every pair of networks in the ensemble, plot a point corresponding to (d(network1, network2), v_bio1-vbio2). Is there a clear correlation? What would the outliers, if any, mean? For distance, a Jaccard distance could be used.</p>
    <p>3. An example (both in the manuscript) and documentation, as to how ensemble performance can be studied by plotting ROC curves in Medusa could be described.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
  </body>
</sub-article>
<sub-article id="pcbi.1007847.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007847.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007847" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">27 Jan 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1007847.s001">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">medusa_reviews.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1007847.s001.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1007847.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007847.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lauffenburger</surname>
          <given-names>Douglas A</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Berry</surname>
          <given-names>Hugues</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Lauffenburger, Berry</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Lauffenburger, Berry</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007847" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">17 Mar 2020</named-content>
    </p>
    <p>Dear Jason,</p>
    <p>Thank you very much for submitting your manuscript "Medusa: software to build and analyze ensembles of genome-scale metabolic network reconstructions" for consideration at PLOS Computational Biology. Based on the reviews, we are very likely to ultimately accept this manuscript for publication; however, toward that end we ask that you consider a minor revision of the manuscript to address the final recommendation made by reviewer #1 (about the citation of Biggs &amp; Papin, PLOS Comp Bio 2017, see below).</p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. </p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Hugues Berry</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Douglas Lauffenburger</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have addressed most of my comments. However, they decided to not directly address my comment on the former figure 4 (now figure 3) about the underlying motivations for the choice of the gap-filling method implemented in medusa to generate ensembl. Although I understand their position, I would suggest as a last minor revision to clearly refer to the paper Biggs &amp; Papin, PLOS Comp Bio 2017 when they introduce Figure 3 (paragraph that starts with "Ensembles can also be generated in Medusa by performing gap-filling on an individual GENRE..." to include a summary of the detailed motivation that they provided in the response to reviewed.</p>
    <p>Reviewer #2: The authors have addressed all of my concerns.</p>
    <p>Reviewer #3: All my comments have been addressed satisfactorily, more or less. I am happy to recommend the publication of the manuscript.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/" xlink:type="simple">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email xlink:type="simple">figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link ext-link-type="uri" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, PLOS recommends that you deposit laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see <underline><ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plospathogens/s/submission-guidelines" xlink:type="simple">http://journals.plos.org/ploscompbiol/s/submission-guidelines#loc-materials-and-methods</ext-link></underline></p>
  </body>
</sub-article>
<sub-article id="pcbi.1007847.r004" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007847.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007847" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">17 Mar 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1007847.s002">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">medusa_reviews.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1007847.s002.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1007847.r005" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007847.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lauffenburger</surname>
          <given-names>Douglas A</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Berry</surname>
          <given-names>Hugues</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Lauffenburger, Berry</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Lauffenburger, Berry</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj005" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007847" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">3 Apr 2020</named-content>
    </p>
    <p>Dear Jason,</p>
    <p>We are pleased to inform you that your manuscript 'Medusa: software to build and analyze ensembles of genome-scale metabolic network reconstructions' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Hugues Berry</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Douglas Lauffenburger</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
  </body>
</sub-article>
<sub-article id="pcbi.1007847.r006" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007847.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lauffenburger</surname>
          <given-names>Douglas A</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Berry</surname>
          <given-names>Hugues</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Lauffenburger, Berry</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Lauffenburger, Berry</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj006" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007847" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">21 Apr 2020</named-content>
    </p>
    <p>PCOMPBIOL-D-19-01338R2 </p>
    <p>Medusa: software to build and analyze ensembles of genome-scale metabolic network reconstructions</p>
    <p>Dear Dr Papin,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Laura Mallard</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link ext-link-type="uri" xlink:href="http://ploscompbiol.org">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
