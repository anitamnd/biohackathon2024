<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4287953</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu641</article-id>
    <article-id pub-id-type="publisher-id">btu641</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Sigma: Strain-level inference of genomes from metagenomic analysis for biosurveillance</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ahn</surname>
          <given-names>Tae-Hyuk</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chai</surname>
          <given-names>Juanjuan</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pan</surname>
          <given-names>Chongle</given-names>
        </name>
        <xref ref-type="corresp" rid="btu641-COR1">*</xref>
      </contrib>
      <aff>Computer Science and Mathematics Division, Oak Ridge National Laboratory, Oak Ridge, TN, 37831, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu641-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: Michael Brudno</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>1</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>9</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>9</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>2</issue>
    <fpage>170</fpage>
    <lpage>177</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>6</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>1</day>
        <month>9</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>9</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Metagenomic sequencing of clinical samples provides a promising technique for direct pathogen detection and characterization in biosurveillance. Taxonomic analysis at the strain level can be used to resolve serotypes of a pathogen in biosurveillance. Sigma was developed for strain-level identification and quantification of pathogens using their reference genomes based on metagenomic analysis.</p>
      <p><bold>Results:</bold> Sigma provides not only accurate strain-level inferences, but also three unique capabilities: (i) Sigma quantifies the statistical uncertainty of its inferences, which includes hypothesis testing of identified genomes and confidence interval estimation of their relative abundances; (ii) Sigma enables strain variant calling by assigning metagenomic reads to their most likely reference genomes; and (iii) Sigma supports parallel computing for fast analysis of large datasets. The algorithm performance was evaluated using simulated mock communities and fecal samples with spike-in pathogen strains.</p>
      <p><bold>Availability and Implementation:</bold> Sigma was implemented in C++ with source codes and binaries freely available at <ext-link ext-link-type="uri" xlink:href="http://sigma.omicsbio.org">http://sigma.omicsbio.org</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>panc@ornl.gov</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu641/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>It is a public health and national security imperative to prepare for a broad range of biological threats, including infectious diseases and food-borne illnesses (<xref rid="btu641-B4" ref-type="bibr">Fox, 2012</xref>). Biosurveillance will provide early detection of disease outbreaks and rapid characterization of pathogens. Conventional methods for biosurveillance include laboratory culture, immunoassays, and genotyping (<xref rid="btu641-B25" ref-type="bibr">Wagner <italic>et al.</italic>, 2006</xref>). Metagenomic sequencing, developed in environmental microbiology, is a promising new method for biosurveillance. For example, fecal samples of suspected patients in food-borne disease outbreaks can be sequenced directly to identify responsible pathogens, bypassing the steps of strain isolation and culturing for pathogen identification. In the 2011 German Shiga toxin-producing <italic>E.</italic><italic>coli</italic> (STEC) O104:H4 outbreak, the pathogen was identified by the standard epidemiology procedure of isolation, culturing, and genotyping (<xref rid="btu641-B22" ref-type="bibr">Rubino <italic>et al.</italic>, 2011</xref>). Multiple isolate cultures of this pathogen from different patients were subsequently sequenced, which generated whole genome sequences for pathophysiology analysis. In the future, metagenomics could be used to sequence fecal samples of patients in the early stage of such an outbreak, potentially allowing more rapid and unambiguous identification of the pathogen.</p>
    <p>It is a computational challenge to achieve sensitive and specific identification of pathogens in a complex metagenome background. Many algorithms have been developed to infer the taxonomic composition of a microbial community using metagenomic sequencing data. The algorithms generally used the following three approaches. (i) The <italic>k</italic>-mer statistics approach compares <italic>k</italic>-mer frequency profiles of metagenomic reads with those of organisms representing a wide range of clades. This approach is used by Naïve Bayes Classifier (<xref rid="btu641-B21" ref-type="bibr">Rosen <italic>et al.</italic>, 2008</xref>), PhymmBL (<xref rid="btu641-B2" ref-type="bibr">Brady and Salzberg, 2011</xref>), and PhyloPythiaS (<xref rid="btu641-B18" ref-type="bibr">Patil <italic>et al.</italic>, 2011</xref>). (ii) In the marker gene approach, metagenomic reads are aligned with a set of preselected clade-specific marker genes, and taxonomic classification is inferred from phylogenetic distances to these marker genes. This approach is used by MetaPhlAn (<xref rid="btu641-B23" ref-type="bibr">Segata <italic>et al.</italic>, 2012</xref>) and AMPHORA2 (<xref rid="btu641-B26" ref-type="bibr">Wu and Scott, 2012</xref>). Both of the two approaches can produce high-quality classification results at the species level or above without using a significant amount of computation. However, these two approaches may not be adequate for taxonomic classification at the strain level. Genome identification for metagenomic biosurveillance needs to resolve different strains (or serotypes) of the same species. For example, pathogenic <italic>E.</italic><italic>coli</italic> strains need to be unambiguously differentiated from coexisting non-pathogenic <italic>E.</italic><italic>coli</italic> strains in the metagenome.</p>
    <p>Alternatively, (iii) the read mapping approach infers the taxonomic composition of a community by searching metagenomic reads against a database of reference genomes. This approach is used by MEGAN (<xref rid="btu641-B7" ref-type="bibr">Huson <italic>et al.</italic>, 2007</xref>), Sort-ITEMS (<xref rid="btu641-B15" ref-type="bibr">Monzoorul Haque <italic>et al.</italic>, 2009</xref>), MetaPhyler (<xref rid="btu641-B12" ref-type="bibr">Liu <italic>et al.</italic>, 2011</xref>), Grammy (<xref rid="btu641-B27" ref-type="bibr">Xia <italic>et al.</italic>, 2011</xref>), GASiC (<xref rid="btu641-B11" ref-type="bibr">Lindner and Renard, 2013</xref>), and Pathoscope (<xref rid="btu641-B5" ref-type="bibr">Francis <italic>et al.</italic>, 2013</xref>). This approach can provide accurate high-resolution taxonomic classification for clades well represented by reference genomes. It is suitable for metagenomic biosurveillance of known pathogens, which generally have reference genomes available for a variety of strains. However, it is difficult for this approach to detect novel pathogens. When a new strain is present in a sample, its closely related strains in a reference genome database need to be identified and their sequence variations be determined.</p>
    <p>Here, we present the Sigma algorithm (strain-level inference of genomes from metagenomic analysis) for metagenomic biosurveillance. A novel probabilistic model was developed to identify and quantify genomes using the read mapping approach. Our benchmarks showed that Sigma provided more accurate strain-level and species-level classification than an established read mapping algorithm—MEGAN, a representative marker gene algorithm—MetaPhlAn, and a recent pathogen detection algorithm—Pathoscope. Sigma was scaled from desktops to supercomputers to achieve a short turnaround time for large metagenomic datasets. This allows a prompt response of a metagenomic biosurveillance network to disease outbreaks using supercomputers.</p>
    <p>The existing taxonomic analysis algorithms generally do not provide statistical confidence assessment of their results. It is difficult to make a biosurveillance decision based on the inference of an algorithm on a pathogen’s presence without knowing the uncertainty on such inferences or to use the estimated relative abundance of a genome without knowing the confidence intervals of such estimates. After the identification and quantification of genomes, Sigma can rigorously evaluate the statistical confidence of its findings. Hypothesis testing based on the likelihood ratio test was used to calculate <italic>P</italic>-values for the detection of relevant genomes. Bootstrapping was used to estimate the confidence intervals of the relative abundances of identified genomes.</p>
    <p>When an outbreak spreads or a pathogen re-emerges, it is important to determine the sequence variations between the genomes of this pathogen in the field-collected samples and its reference genomes in the database. This allows accurate reconstruction of the transmission sources of the outbreak and the evolutionary history of the pathogen. Thus, biosurveillance further requires information on the single-nucleotide polymorphisms (SNPs) of a detected pathogen to distinguish different variant populations. Identification of variants is straightforward for isolate genome sequencing by mapping all reads to a reference genome. However, in metagenome sequencing, one cannot simply map all metagenomic reads to a reference genome, because some of the aligned reads may originate from different microorganisms, which could introduce false variations. Sigma solves this problem by assigning each read to its most likely originating genome based on the Sigma probabilistic model, which allows subsequent variant calling by variants calling software such as SAMTools (<xref rid="btu641-B10" ref-type="bibr">Li <italic>et al.</italic>, 2009</xref>).</p>
  </sec>
  <sec id="SEC2">
    <title>2 ALGORITHM AND IMPLEMENTATION</title>
    <sec id="SEC2.1">
      <title>2.1 General description of the Sigma algorithm</title>
      <p><xref ref-type="fig" rid="btu641-F1">Figure 1</xref> shows an overview of the Sigma algorithm. Sigma starts with mapping all reads in a metagenomic dataset onto a user-defined database of reference genomes. A parallelization wrapper is provided as an option for users to speedup the read alignment using computer clusters. A read can be aligned to many genomes with up to a given number of mismatches.
<fig id="btu641-F1" position="float"><label>Fig. 1.</label><caption><p>Conceptual overview of the Sigma algorithm. The inputs are metagenomic reads and user-defined reference genomes (top panel). The alignment of reads to genomes is used to define a probabilistic model of metagenomic sequencing (middle panel). Genomes are detected with hypothesis testing, quantified with confidence interval estimation, and scanned for sequence variations (bottom panel). </p></caption><graphic xlink:href="btu641f1p"/></fig></p>
      <p>The foundation of all statistical inferences in Sigma is a simple probabilistic model for sampling reads with mismatches from genomes at unknown abundances. The Sigma probabilistic model permits maximum likelihood estimation (MLE) of the relative abundances of all genomes measured by the percentages of reads sampled from these genomes. Importantly, we proved the convexity of the objective function of the MLE so that Sigma can guarantee to attain a global optimum solution using interior point non-linear programming (NLP) provided in the Ipopt library (<xref rid="btu641-B24" ref-type="bibr">Wachter and Biegler, 2006</xref>).</p>
      <p>The Sigma probabilistic model further provides the statistical framework for hypothesis testing and confidence interval estimation. Sigma calculates the <italic>P</italic>-value for identification of a genome using a likelihood ratio test of the null hypothesis that this genome is not present in the sample. To account for the quantification uncertainty from the stochastic sampling process of metagenomic sequencing, bootstrapping is used to estimate confidence intervals of relative abundances of identified genomes. As both bootstrapping and likelihood ratio tests entail solving the non-trivial NLP optimization problem for many times, the NLP solver of Sigma is multithreaded and parallelized to computer clusters.</p>
      <p>Finally, given the MLE of genome relative abundances, Sigma can calculate the probabilities of sampling a read from its mapped genomes, which allows assigning metagenomic reads to their most likely originating genomes for variant calling. For a selected genome, Sigma provides the alignment of its assigned reads on the genome sequence as the input for variant calling with SAMtools. Sigma filters the variant calling output to identify high-confidence sequence variations.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Mathematical framework of Sigma</title>
      <p>The Sigma probabilistic model is used to represent the stochastic process of sampling reads from genomes during metagenomic sequencing. Let <inline-formula><mml:math id="MM1"><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> be the probability of sampling a random read from the reference genome <inline-formula><mml:math id="MM2"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Considering only reads sampled from reference genomes in the database, we have:
<disp-formula><mml:math id="MM3"><mml:mrow><mml:msub><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mo>∀</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext>Pr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1.</mml:mn></mml:mrow></mml:math></disp-formula>
<inline-formula><mml:math id="MM4"><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is determined by the relative abundance, size, and sequencing bias of the genome <inline-formula><mml:math id="MM5"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Sigma estimates <inline-formula><mml:math id="MM6"><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from the alignment results using MLE. Consider a read, <inline-formula><mml:math id="MM7"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, mapped onto <inline-formula><mml:math id="MM8"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="MM9"><mml:mi>z</mml:mi></mml:math></inline-formula> base-pairs of mismatches. A uniform probability of <inline-formula><mml:math id="MM10"><mml:mi>σ</mml:mi></mml:math></inline-formula> (default: 5%) is assumed for any mismatch between a read and a genome, which can stem from genome variability and sequencing errors. Given that a read <inline-formula><mml:math id="MM11"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is sampled from <inline-formula><mml:math id="MM12"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the probability of obtaining <inline-formula><mml:math id="MM13"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="MM14"><mml:mi>z</mml:mi></mml:math></inline-formula> mismatches and <inline-formula><mml:math id="MM15"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> matches in the alignment is:
<disp-formula id="btu641-M1"><label>(1)</label><mml:math id="MM16"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mi>z</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msup><mml:mo>;</mml:mo><mml:mi>z</mml:mi><mml:mo>≤</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> Pr</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>;</mml:mo><mml:mi>z</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where <inline-formula><mml:math id="MM17"><mml:mi>l</mml:mi></mml:math></inline-formula> is the length of <inline-formula><mml:math id="MM18"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> in base pairs (bp) and <inline-formula><mml:math id="MM19"><mml:mi>U</mml:mi></mml:math></inline-formula> is the maximum number of mismatches allowed in the read alignment. Sigma calculates <inline-formula><mml:math id="MM20"><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> between each read and each genome based on their alignment, or lack thereof, and populates a constant matrix, <inline-formula><mml:math id="MM21"><mml:mi mathvariant="bold-italic">Q</mml:mi></mml:math></inline-formula>
<disp-formula><mml:math id="MM22"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>
</mml:mo><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Then, the probability of sampling <inline-formula><mml:math id="MM23"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> from <inline-formula><mml:math id="MM24"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is simply:
<disp-formula><mml:math id="MM25"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:malignmark/><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
Because a read may originate from any one of the reference genomes, the probability of generating <inline-formula><mml:math id="MM26"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is:
<disp-formula><mml:math id="MM27"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mo>∀</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mtext>Pr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>
</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
      <p>MLE finds the estimate of <inline-formula><mml:math id="MM28"><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> by maximizing the probability of all reads, which is the joint probability of all reads:
<disp-formula><mml:math id="MM29"><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM30"><mml:mrow><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM31"><mml:mrow><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mo>∀</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM32"><mml:mrow><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mo>∀</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
After log-transformation and linear scaling of <inline-formula><mml:math id="MM33"><mml:mi mathvariant="bold-italic">Q</mml:mi></mml:math></inline-formula> for the convenience of precise numeric calculation, we formulate an optimization problem:
<disp-formula id="btu641-M2"><label>(2)</label><inline-graphic xlink:href="btu641M2.jpg"/></disp-formula>
where <inline-formula><mml:math id="MM35"><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>
</mml:mo><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="MM36"><mml:mi>m</mml:mi></mml:math></inline-formula> genomes. This optimization problem is solved using a NLP method (<xref rid="btu641-B16" ref-type="bibr">Nocedal and Wright, 2006</xref>). Sigma uses the primal-dual interior point NLP method implemented in the Ipopt library (<xref rid="btu641-B24" ref-type="bibr">Wachter and Biegler, 2006</xref>). The interior point method guarantees global optimum solutions for convex objective functions. The convexity of Sigma’s objective function is proved in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu641/-/DC1">Supplementary Proposition 1</ext-link>. Therefore, Sigma can guarantee the maximum likelihood estimates of <inline-formula><mml:math id="MM37"><mml:mi mathvariant="bold-italic">G</mml:mi></mml:math></inline-formula>. Only aligned reads were considered in the estimation of <inline-formula><mml:math id="MM38"><mml:mi mathvariant="bold-italic">G</mml:mi></mml:math></inline-formula>. A relative abundance of a genome can be calculated by
<disp-formula id="btu641-M3"><label>(3)</label><mml:math id="MM39"><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM40"><mml:mi>θ</mml:mi></mml:math></inline-formula> is the proportion of aligned reads out of all sequenced reads.</p>
      <p>Sigma calculates the percentile bootstrap confidence intervals for <inline-formula><mml:math id="MM41"><mml:mi mathvariant="bold-italic">G</mml:mi></mml:math></inline-formula>. All reads are randomly sampled with replacement to generate a bootstrap resample dataset with the same number of reads as the original dataset. A total of <italic>B</italic> resamples (default: 1000) are generated and Sigma calculates MLEs from the bootstrap resamples: <inline-formula><mml:math id="MM42"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>
</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>B</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="MM43"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Let <inline-formula><mml:math id="MM44"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> be the quantile function for all bootstrap estimates of <inline-formula><mml:math id="MM45"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, i.e. <inline-formula><mml:math id="MM46"><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> The <inline-formula><mml:math id="MM47"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> confidence interval of <inline-formula><mml:math id="MM48"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is calculated as:
<disp-formula><mml:math id="MM49"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>
</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
      <p>The bootstrap confidence interval estimation measures the uncertainty caused by the stochastic sampling process of metagenomic sequencing. The confidence interval of <inline-formula><mml:math id="MM50"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is converted to the confidence interval of its relative abundance, <inline-formula><mml:math id="MM51"><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, using <xref ref-type="disp-formula" rid="btu641-M3">Equation (3)</xref>.</p>
      <p>Reference genomes with relative abundances above a certain threshold (default: 0.01%) can be considered to be identified in the metagenome sample. Sigma performs hypothesis testing on the null hypothesis that <inline-formula><mml:math id="MM52"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is not present:
<disp-formula><mml:math id="MM53"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mo>
</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>
</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM54"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mo>
</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>
</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
The likelihood ratio test is used for the hypothesis testing:
<disp-formula><mml:math id="MM55"><mml:mrow><mml:mi>Λ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
The likelihood ratio compares the maximum likelihood of the data under the null hypothesis versus that under the alternative hypothesis. The likelihood ratio is small if the data strongly supports alternative hypothesis. The likelihood ratio test calculates a <italic>P</italic>-value by assuming a <italic>χ</italic><sup>2</sup> distribution with one degree of freedom for the statistic, <inline-formula><mml:math id="MM56"><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Λ</mml:mi></mml:mrow></mml:math></inline-formula>. The statistical significance of an identified genome is determined not only by its <inline-formula><mml:math id="MM57"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, but also by the distinctness of the genome in the database.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Alignment of sequencing reads to reference genomes</title>
      <p>The inputs for Sigma are a reference genome database and metagenomic sequencing reads. Sigma can scale up to large databases with tens of thousands of reference genomes. Sigma uses a hierarchical structure for the reference genome database as set up by RefSeq (<xref rid="btu641-B19" ref-type="bibr">Pruitt <italic>et al.</italic>, 2012</xref>): a root directory containing many sub-directories of FASTA files. Each sub-directory corresponds to a genome and the directory names are used by Sigma as the genome names because they are unique identifiers. A genome may have multiple FASTA files in its sub-directory. Genomes can be added or removed from the reference genome database by simply adding or removing their sub-directories in the root directory. The root directory is specified in the configuration file of Sigma.</p>
      <p>Sigma uses a third-party short-read alignment algorithm to align all metagenomic reads onto every reference genome. By default, Bowtie 2 (<xref rid="btu641-B9" ref-type="bibr">Langmead and Salzberg, 2012</xref>) is used, but users can change to any other short-read alignment algorithm that uses FASTQ/FASTA formats for read input and SAM/BAM formats for alignment output. Users may specify the maximum number of mismatches per read and the range of the inter-mate distance for the read alignment in the Sigma configuration file. The default maximum number of mismatches per read was three for 100-bp reads to balance between the alignment stringency and the computing time of read alignment.</p>
      <p>Sigma provides a C++ hybrid parallelization wrapper to scale up the read alignment from multi-core workstations to distributed-memory supercomputers. Computation on a workstation is distributed to multiple processes, each containing 8–24 threads, across CPU cores with shared memory. The Message-Passing Interface (MPI) library is used to distribute the computation across nodes in distributed-memory systems from small clusters to supercomputers. Dynamic load balancing is performed at both the multi-process level and the MPI level to maximize throughput and minimize wall-clock computing time.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Implementation of MLE, bootstrapping, likelihood ratio tests, and variant calling.</title>
      <p>Sigma parses the alignment results and generates the <italic>Q</italic> matrix. The relative abundances of genomes are estimated from the <italic>Q</italic> matrix using MLE. Sigma solves the NLP problem for MLE using the Ipopt library (<xref rid="btu641-B24" ref-type="bibr">Wachter and Biegler, 2006</xref>). Most of the computing time for NLP is spent in the objective function evaluation step, which involves non-trivial linear algebra calculation on the large <italic>Q</italic> matrix. To speedup the calculation, we parallelized the objective functional evaluation step using multi-threading with the Open Multi-Processing (OpenMP) library (<xref rid="btu641-B17" ref-type="bibr">Pacheco, 2011</xref>).</p>
      <p>To perform bootstrapping, Sigma generates a bootstrap <italic>Q</italic> matrix by randomly taking rows from the original <italic>Q</italic> matrix with replacement. Sigma then performs MLE using the bootstrap <italic>Q</italic> matrix. This process is repeated many times to generate a set of bootstrap estimates, which are used to calculate a percentile confidence interval and relative standard deviation (RSD). Sigma distributes the parallel processing of bootstrap samples on a cluster using MPI/OpenMP. Users can set the number of bootstrapping iterations in the Sigma configuration file.</p>
      <p>Sigma performs likelihood ratio tests on user-selected genomes. The log-likelihood of the null hypothesis (i.e. a selected target genome is absent) is calculated using a <italic>Q</italic> matrix that does not contain the target genome. The log-likelihood of the alternative hypothesis (i.e. the target genome is present) is the same as calculated from the original <italic>Q</italic> matrix. The log-likelihood of the null hypothesis should be smaller than that of the alternative hypothesis, because the target genome has been estimated to have a non-zero relative abundance. Sigma can perform likelihood ratio tests for many target genomes in parallel on a cluster using MPI/OpenMP.</p>
      <p>Sigma assigns metagenomic reads to their most likely reference genomes for variant calling. For each aligned read, the probability of each read from each genome is calculated by:
<disp-formula><mml:math id="MM58"><mml:mrow><mml:mi>Pr</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mi>Pr</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>
</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Each read is then assigned to the genome with the highest probability. Sigma generates a BAM alignment file for a selected reference genome using only its assigned reads. SAMtools is then used to identify sequence variants from the BAM file and report results in a variant call format (VCF) file. Finally, the VCF file is processed by Sigma to extract high-confidence sequence variants based on SAMtool’s variant-calling quality score (default: &gt;20) and sequence variant frequency (default: &gt;25%).</p>
      <p>All modules of Sigma were implemented in C++. The results are presented in two types of formats: a HTML format for result visualization and a text format for further data analysis.</p>
    </sec>
  </sec>
  <sec>
    <title>3 SYSTEM AND METHODS</title>
    <p>MetaSim (<xref rid="btu641-B20" ref-type="bibr">Richter <italic>et al.</italic>, 2008</xref>) was used to simulate 100-bp Illumina sequencing reads with an empirical error model. The Illumina error model provided by MetaSim for 80-bp reads was extended to simulate 100-bp reads. The simulated reads contained 0.88 errors per read on average. The preprocessed metagenomic sequencing dataset of a fecal sample from a healthy subject was downloaded from <ext-link ext-link-type="ftp" xlink:href="ftp://public-ftp.hmpdacc.org/Illumina/stool/SRS011529.tar.bz2">ftp://public-ftp.hmpdacc.org/Illumina/stool/SRS011529.tar.bz2</ext-link>. The Illumina sequencing dataset of the <italic>E.</italic><italic>coli</italic> O104:H4 strain 280 (UK Health Protection Agency’s materials identifier H112160280) was downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/ngscomparison/NGS-Benchtop-Comparison">https://github.com/ngscomparison/NGS-Benchtop-Comparison</ext-link>.</p>
    <p>MEGAN (<xref rid="btu641-B7" ref-type="bibr">Huson <italic>et al.</italic>, 2007</xref>; version 4.70) was downloaded from <ext-link ext-link-type="uri" xlink:href="http://ab.inf.uni-tuebingen.de/software/megan/">http://ab.inf.uni-tuebingen.de/software/megan/</ext-link>. Metagenomic datasets were aligned to their corresponding reference genome databases using megablast in BLAST (version 2.2.26) with parameters (–m 7 –v 100 –b 100). MEGAN was run using the default parameters for lowest common ancestor (LCA) except the “Min Support” parameter. The “Min Support” parameter is a threshold for the minimum number of reads that must be assigned to a taxon. It was set to 0.01%, the same as in Sigma.</p>
    <p>MetaPhlAn (<xref rid="btu641-B23" ref-type="bibr">Segata <italic>et al.</italic>, 2012</xref>; version 1.7.7) was downloaded from <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/nsegata/metaphlan/">https://bitbucket.org/nsegata/metaphlan/</ext-link>. The alignment was performed using Bowtie 2 with options specified by MetaPhlAn. Default parameters were used for the MetaPhlAn classification analysis.</p>
    <p>Pathoscope (<xref rid="btu641-B5" ref-type="bibr">Francis <italic>et al.</italic>, 2013</xref>; version 1.0.1) was downloaded from <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/pathoscope/">http://sourceforge.net/projects/pathoscope/</ext-link>. BLAST was used for read alignment with suggested parameters (–m 8 –v 100 –b 100) by Pathoscope. Pathoscope was run with the default parameters and the results were reported with the 0.01% relative abundance cutoff (–s 0.01).</p>
    <p>All benchmarking was performed on a 64-core computer system with 256 GB shared memory. The scalability of Sigma was also tested on an open-science supercomputer, Titan, at Oak Ridge Leadership Computing Facility.</p>
  </sec>
  <sec>
    <title>4 RESULTS</title>
    <sec id="SEC4.1">
      <title>4.1 Comparison of genome identification and quantification performance</title>
      <p>Sigma was compared with three existing taxonomic classification algorithms: MEGAN (<xref rid="btu641-B7" ref-type="bibr">Huson <italic>et al.</italic>, 2007</xref>), Pathoscope (<xref rid="btu641-B5" ref-type="bibr">Francis <italic>et al.</italic>, 2013</xref>), and MetaPhlAn (<xref rid="btu641-B23" ref-type="bibr">Segata <italic>et al.</italic>, 2012</xref>). A 5-genome synthetic community was constructed using MetaSim (<xref rid="btu641-B20" ref-type="bibr">Richter <italic>et al.</italic>, 2008</xref>) to test the taxonomic resolution of their classification (<xref ref-type="table" rid="btu641-T1">Table 1</xref> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu641/-/DC1">Supplementary Figure 1</ext-link>). Reads simulated from a target genome, <italic>Escherichia coli</italic> O157:H7 Sakai, were mixed with reads from genomes of the same serotype (<italic>E.</italic><italic>coli</italic> O157:H7 TW14359), the same species (<italic>E.</italic><italic>coli</italic> K12), the same genus (<italic>E.</italic><italic>fergusonii</italic>), and the same family (<italic>Salmonella enterica</italic> serovar Paratyphi A strain ATCC 9150). The average nucleotide identity (ANI; <xref rid="btu641-B6" ref-type="bibr">Goris <italic>et al.</italic>, 2007</xref>) of the target genome (<italic>E.</italic><italic>coli</italic> O157:H7 Sakai) was 99.95% to <italic>E.</italic><italic>coli</italic> O157:H7 TW14359, 98.35% to <italic>E.</italic><italic>coli</italic> K12, 92.88% to the <italic>E.</italic><italic>fergusonii</italic> genome, and 84.47% to the <italic>S.</italic><italic>enterica</italic> genome.
<table-wrap id="btu641-T1" position="float"><label>Table 1.</label><caption><p>Comparison of Sigma, Pathoscope, MetaPhlAn, and MEGAN in strain-level identification and quantification using a 5-genome synthetic community. (RA%: relative abundance in percentage)</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th colspan="2" align="center" rowspan="1">Simulation Input<hr/></th><th colspan="2" align="center" rowspan="1">Sigma<hr/></th><th colspan="2" align="center" rowspan="1">Pathoscope<hr/></th><th colspan="2" align="center" rowspan="1">MEGAN<hr/></th><th colspan="2" align="center" rowspan="1">MetaPhlAn<hr/></th></tr><tr><th rowspan="1" colspan="1">Strains</th><th rowspan="1" colspan="1">RA(%)</th><th rowspan="1" colspan="1">Strains</th><th rowspan="1" colspan="1">RA(%)</th><th rowspan="1" colspan="1">Strains</th><th rowspan="1" colspan="1">RA(%)</th><th rowspan="1" colspan="1">Strains/Species</th><th rowspan="1" colspan="1">RA(%)</th><th rowspan="1" colspan="1">Species</th><th rowspan="1" colspan="1">RA(%)</th></tr></thead><tbody align="left"><tr><td rowspan="3" colspan="1"><list list-type="simple"><list-item><p>S.enterica</p></list-item><list-item><p>serovar Paratyphi A</p></list-item><list-item><p>strain ATCC 9150</p></list-item></list></td><td rowspan="3" colspan="1">60</td><td rowspan="3" colspan="1"><list list-type="simple"><list-item><p>S.enterica</p></list-item><list-item><p>serovar Paratyphi A</p></list-item><list-item><p>strain ATCC 9150</p></list-item></list></td><td rowspan="3" colspan="1">59.85</td><td rowspan="3" colspan="1"><list list-type="simple"><list-item><p>S.enterica</p></list-item><list-item><p>serovar Paratyphi A</p></list-item><list-item><p>strain ATCC 9150</p></list-item></list></td><td rowspan="3" colspan="1">60.11</td><td rowspan="1" colspan="1"><italic>S.enterica</italic> serovar Paratyphi A</td><td rowspan="1" colspan="1">1.58</td><td rowspan="3" colspan="1"><italic>S.enterica</italic></td><td rowspan="3" colspan="1">31.05</td></tr><tr><td rowspan="1" colspan="1"><italic>S.enterica</italic> subsp. enterica</td><td rowspan="1" colspan="1">45.49</td></tr><tr><td rowspan="1" colspan="1"><italic>S.enterica</italic> others</td><td rowspan="1" colspan="1">7.78</td></tr><tr><td colspan="10" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1"><list list-type="simple"><list-item><p>E.fergusonii</p></list-item><list-item><p>ATCC 35469</p></list-item></list></td><td rowspan="1" colspan="1">27</td><td rowspan="1" colspan="1"><list list-type="simple"><list-item><p>E.fergusonii</p></list-item><list-item><p>ATCC 35469</p></list-item></list></td><td rowspan="1" colspan="1">26.94</td><td rowspan="1" colspan="1"><list list-type="simple"><list-item><p>E.fergusonii</p></list-item><list-item><p>ATCC 35469</p></list-item></list></td><td rowspan="1" colspan="1">27.37</td><td rowspan="1" colspan="1"><list list-type="simple"><list-item><p>E.fergusonii</p></list-item><list-item><p>ATCC 35469</p></list-item></list></td><td rowspan="1" colspan="1">17.49</td><td rowspan="1" colspan="1"><italic>E.fergusonii</italic></td><td rowspan="1" colspan="1">28.84</td></tr><tr><td colspan="10" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1"><list list-type="simple"><list-item><p>E.coli</p></list-item><list-item><p>K12 substr MG1655</p></list-item></list></td><td rowspan="1" colspan="1">9</td><td rowspan="1" colspan="1"><list list-type="simple"><list-item><p>E.coli</p></list-item><list-item><p>K12 substr MG1655</p></list-item></list></td><td rowspan="1" colspan="1">8.91</td><td rowspan="1" colspan="1"><list list-type="simple"><list-item><p>E.coli</p></list-item><list-item><p>K12 substr MG1655</p></list-item></list></td><td rowspan="1" colspan="1">9.64</td><td rowspan="1" colspan="1"><list list-type="simple"><list-item><p>E.coli</p></list-item><list-item><p>K-12</p></list-item></list></td><td rowspan="1" colspan="1">0.02</td><td rowspan="5" colspan="1"><italic>E.coli</italic></td><td rowspan="1" colspan="1">13.36</td></tr><tr><td colspan="10" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1"><list list-type="simple"><list-item><p>E.coli</p></list-item><list-item><p>O157:H7 TW14359</p></list-item></list></td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1"><list list-type="simple"><list-item><p>E.coli</p></list-item><list-item><p>O157:H7 TW14359</p></list-item></list></td><td rowspan="1" colspan="1">3.11</td><td rowspan="1" colspan="1"><list list-type="simple"><list-item><p>E.coli</p></list-item><list-item><p>O157:H7 TW14359</p></list-item></list></td><td rowspan="1" colspan="1">2.6</td><td rowspan="1" colspan="1"><italic>E.coli</italic> others</td><td rowspan="1" colspan="1">2.19</td></tr><tr><td colspan="10" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1"><list list-type="simple"><list-item><p>E.coli</p></list-item><list-item><p>O157:H7 Sakai</p></list-item></list></td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1"><list list-type="simple"><list-item><p>E.coli</p></list-item><list-item><p>O157:H7 Sakai</p></list-item></list></td><td rowspan="1" colspan="1">0.94</td><td rowspan="1" colspan="1"><list list-type="simple"><list-item><p>E.coli</p></list-item><list-item><p>O157:H7 Sakai</p></list-item></list></td><td rowspan="1" colspan="1">0.018</td><td rowspan="1" colspan="1"><italic>E.coli</italic> O157:H7</td><td rowspan="1" colspan="1">0.02</td></tr><tr><td colspan="10" rowspan="1"><hr/></td></tr><tr><td colspan="6" rowspan="1"/><td rowspan="1" colspan="1"><italic>Enterobacteriacease</italic> others</td><td rowspan="1" colspan="1">25.26</td><td rowspan="1" colspan="1"><italic>Salmonella</italic> others</td><td rowspan="1" colspan="1">26.76</td></tr></tbody></table></table-wrap></p>
      <p>A total of 20 million simulated reads were aligned to all 2266 RefSeq genomes (retrieved in May 2013). The reads from the three <italic>E.</italic><italic>coli</italic> strains were mapped to 58 other <italic>E.</italic><italic>coli</italic> strains in the database (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu641/-/DC1">Supplementary Figure 1a</ext-link>), which challenged the four algorithms’ ability to identify the target <italic>E.</italic><italic>coli</italic> O157:H7 Sakai genome and quantify its relative abundance. The relative abundance of the target genome was estimated at 0.94% by Sigma and 0.018% by Pathoscope (<xref ref-type="table" rid="btu641-T1">Table 1</xref> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu641/-/DC1">Supplementary Figure 1b</ext-link>). The target genome was aggregated with other genomes to the serotype level (<italic>E.</italic><italic>coli</italic> O157:H7 at 0.02%) by MEGAN and to the species level (<italic>E.</italic><italic>coli</italic> at 13.36%) by MetaPhlAn. Thus, Sigma provided the most accurate quantification for the target <italic>E.</italic><italic>coli</italic> genome. However, all algorithms performed relatively well for other genomes at the species level.</p>
      <p>Sigma was then compared with the other three algorithms using a more complex synthetic community composed of 100 diverse bacterial and archaeal genomes with relative abundances ranging from 0.41% to 1.59%. The synthetic community covered 35 classes, including 22 genomes from Gammaproteobacteria, 9 from Clostridia, 7 from Betaproteobacteria, and 7 from Bacilli. There were seven <italic>E.</italic><italic>coli</italic> strains, two <italic>S.</italic><italic>enterica</italic> strains, two <italic>Methanococcus maripaludis</italic> strains, and two <italic>Shewanella baltica</italic> strains. 100 million reads were simulated by MetaSim and the RefSeq database was provided to Sigma, Pathoscope, and MEGAN for read alignment. <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu641/-/DC1">Supplementary Figure 2</ext-link> shows the expected relative abundances of all included genomes and the quantification results from the four algorithms. Sigma correctly identified all 100 genomes and accurately quantified their relative abundances within 0.95–1.05 of their expected relative abundances. For the other algorithms, <xref ref-type="table" rid="btu641-T2">Table 2</xref> shows the numbers of false-positive and false-negative identifications and the numbers of accurate and inaccurate abundance estimations for the correctly identified genomes. Pathoscope was unable to accurately resolve many closely related genomes, such as between the Gammaproteobacteria genomes. MEGAN incorrectly assigned many reads to taxa at higher taxonomic ranks. MetaPhlAn also made many errors at the species level. Overall, this test indicated the superior accuracy of Sigma quantification at the strain and species levels in a complex synthetic community.
<table-wrap id="btu641-T2" position="float"><label>Table 2.</label><caption><p>Summary statistics of the identification and quantification results of a 100-genome synthetic community</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="center" colspan="2" rowspan="1"/><th rowspan="1" colspan="1">Sigma</th><th rowspan="1" colspan="1">Patho scope</th><th rowspan="1" colspan="1">MEGAN</th><th rowspan="1" colspan="1">Meta PhlAn<xref ref-type="table-fn" rid="btu641-TF1"><sup>a</sup></xref></th></tr></thead><tbody align="left"><tr><td colspan="2" align="center" rowspan="1">Expected Genomes/Species</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">91</td></tr><tr><td rowspan="2" colspan="1">True Positive</td><td rowspan="1" colspan="1">Accurate RA<xref ref-type="table-fn" rid="btu641-TF1"><sup>b</sup></xref></td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">73</td><td rowspan="1" colspan="1">23</td><td rowspan="1" colspan="1">6</td></tr><tr><td rowspan="1" colspan="1">Inaccurate RA<xref ref-type="table-fn" rid="btu641-TF1"><sup>b</sup></xref></td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">25</td><td rowspan="1" colspan="1">67</td><td rowspan="1" colspan="1">71</td></tr><tr><td colspan="2" align="center" rowspan="1">False Positive</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">18</td></tr><tr><td colspan="2" align="center" rowspan="1">False Negative</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">14</td></tr></tbody></table><table-wrap-foot><fn id="btu641-TF1"><p><sup>a</sup>MetaPhlAn performed species-level analysis. Statistics in this column are numbers of species.</p><p><sup>b</sup>True positive identifications may have either accurate RA estimations within 0.95 to 1.05 of their expected RAs or inaccurate RA estimations outside this range.</p></fn></table-wrap-foot></table-wrap></p>
      <p>Biosurveillance requires short turnaround time in data analysis for quick response to outbreaks. The wall-clock analysis time and peak memory usage of the four algorithms were compared based on the 5-genome synthetic community benchmarks on a workstation with 64 CPU cores and 256 GB memory (<xref ref-type="table" rid="btu641-T3">Table 3</xref>). The entire analysis of MetaPhlAn was completed within 10 min using 1 GB memory. Conversely, MEGAN, Pathoscope, and Sigma all required computing-intensive read alignment using BLAST or Bowtie. The abundance estimation by NLP in Sigma was significantly faster and used less memory than the estimation by expectation-maximization (EM) in Pathoscope and by LCA in MEGAN (<xref ref-type="table" rid="btu641-T3">Table 3</xref>). To further speedup the alignment step for large metagenomic datasets, Sigma provides a hybrid parallelization wrapper with dynamic load balancing, which scaled nearly linearly up to 10 000 cores on the supercomputer, Titan. This enabled Sigma to complete the alignment step in only 10 min using 10 000 cores.
<table-wrap id="btu641-T3" position="float"><label>Table 3.</label><caption><p>Comparison of analysis time and peak memory usage</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="2" colspan="1"/><th rowspan="1" colspan="1">Alignment</th><th colspan="2" align="center" rowspan="1">Abundance Estimation<hr/></th><th align="center" rowspan="1" colspan="1">Total</th></tr><tr><th rowspan="1" colspan="1">Wall-Clock Time (hr)</th><th rowspan="1" colspan="1">Wall-Clock Time (hr)</th><th rowspan="1" colspan="1">Memory (GB)</th><th rowspan="1" colspan="1">Wall-Clock Time (hr)</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Sigma</td><td rowspan="1" colspan="1">18</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">62</td><td rowspan="1" colspan="1">19</td></tr><tr><td rowspan="1" colspan="1">Pathoscope</td><td rowspan="1" colspan="1">70</td><td rowspan="1" colspan="1">13</td><td rowspan="1" colspan="1">118</td><td rowspan="1" colspan="1">83</td></tr><tr><td rowspan="1" colspan="1">MEGAN</td><td rowspan="1" colspan="1">70</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">93</td><td rowspan="1" colspan="1">82</td></tr><tr><td rowspan="1" colspan="1">MetaPhlAn</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">0.2</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">0.2</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="SEC4.2">
      <title>4.2 Statistical confidence assessment by Sigma.</title>
      <p>The unique capability of Sigma for statistical confidence assessment was tested using a fecal metagenome dataset (SRS011529) generated by the Human Microbiome Project (HMP; <xref rid="btu641-B8" ref-type="bibr">Huttenhower <italic>et al.</italic>, 2012</xref>; <xref rid="btu641-B14" ref-type="bibr">Methé <italic>et al.</italic>, 2012</xref>). To determine the taxonomic composition of the fecal sample, ∼125 million Illumina reads in this dataset was mapped to 24 994 reference genomes from GenBank (retrieved in July 2014). Sigma identified 135 genomes, including many Bacteroidales genomes such as <italic>Prevotella copri, </italic><italic>P.</italic><italic>stercorea, Bacteroides vulgatus, and </italic><italic>B.</italic><italic>xylanisolvens</italic> (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu641/-/DC1">Supplementary Figure 3</ext-link>). This test also demonstrated the scalability of Sigma to large reference databases.</p>
      <p>No <italic>Salmonella</italic> genome was found in this fecal sample. To test detection of <italic>Salmonella</italic> poisoning, varying amounts of reads simulated from a <italic>S.</italic><italic>enterica</italic> genome (serovar Paratyphi A strain ATCC 9150) were spiked into the fecal dataset at the relative abundances of 1%, 0.1%, 0.01%, 0.001%, and 0.0001%, which corresponded to genome coverage depths ranging from 27× to 0.0027×. The spike-in fecal metagenomes were aligned with the RefSeq database. There were 26 other genomes from different <italic>S.</italic><italic>enterica</italic> strains in the RefSeq database, which served as decoys for testing the statistical uncertainty of strain identification.</p>
      <p>Likelihood ratio tests were performed on all <italic>S.</italic><italic>enterica</italic> strains in RefSeq in each spike-in dataset (<xref ref-type="fig" rid="btu641-F2">Figure 2</xref>a). The correct <italic>S.</italic><italic>enterica</italic> strain, and only this strain, was identified with a <italic>P</italic>-value less than 0.01 from 1% down to 0.001% spike-in datasets. As expected, the likelihood ratio of this strain’s identification decreased with its relative abundance. The correct <italic>S.</italic><italic>enterica</italic> strain was not identified in the 0.0001% (0.0027×) spike-in dataset. More importantly, using a <italic>P</italic>-value cutoff of 0.01, there was no false-positive identification of other <italic>S.</italic><italic>enterica</italic> strains in all spike-in datasets (<xref ref-type="fig" rid="btu641-F2">Figure 2</xref>a). We then quantified the spike-in <italic>S.</italic><italic>enterica</italic> strain with bootstrap confidence interval estimation (<xref ref-type="fig" rid="btu641-F2">Figure 2</xref>b). This strain was quantified at accurate abundances in the 1%–0.001% spike-in datasets, but not in the 0.0001% dataset. The bootstrap confidence intervals were very tight in all except the 0.0001% dataset. The quantification precisions in the five datasets were also measured with RSD of bootstrap estimates. The RSD increased with decreasing amounts of spike-in reads from 1% to 0.0001% (<xref ref-type="fig" rid="btu641-F2">Figure 2</xref>b).
<fig id="btu641-F2" position="float"><label>Fig. 2.</label><caption><p>Identification of a <italic>Salmonella</italic> enterica strain at a serial dilution of relative abundances in a human fecal microbiota background. (<bold>a</bold>) Likelihood ratios of all aligned <italic>Salmonella enterica</italic> strains. Only the correct strain (highlighted in red outline) has statistically significant identification with &lt;0.01 <italic>p</italic>-value down to the 0.001% dataset. (b) Estimated and expected relative abundances (RA) of the spike-in <italic>Salmonella enterica</italic> strain. Point estimates (red dots) were bracketed by 95% confidence intervals (blue error bars) with small relative standard deviations (RSD) down to 0.001% (0.027X coverage depth). </p></caption><graphic xlink:href="btu641f2p"/></fig></p>
      <p>To test Sigma’s performance on smaller metagenomic datasets, we repeated the <italic>Salmonella</italic> spike-in experiments using a 10% sub-sample (∼12.5 million reads) and a 1% sub-sample (∼1.25 million reads) of the fecal dataset. <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu641/-/DC1">Supplementary Figure 4</ext-link> shows that the target <italic>S.</italic><italic>enterica</italic> strain was identified correctly and quantified accurately from all samples with at least 0.027× coverage depth of the target genome, which corresponded to 0.01% spike-in for the 10% sub-sample and 0.1% spike-in for the 1% subsample. Therefore, the detection limit of Sigma was determined by the minimum coverage of a target genome and deeper metagenomic sequencing provided more sensitive detection.</p>
    </sec>
    <sec id="SEC4.3">
      <title>4.3 Identification of nearest genomes and detection of strain variations</title>
      <p>When a sampled strain is not present in the reference genome database, Sigma can identify its closest relative and detect SNPs between the sampled strain in the metagenome and the identified strain in the database. This capability was tested by searching the above <italic>S.</italic><italic>enterica</italic> 1%-spike-in dataset against four different reference genome databases, which represented the spike-in genome as a known strain (Ref1), a novel strain (Ref2), a novel species (Ref3), and a novel genus (Ref4; <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu641/-/DC1">Supplementary Table 1</ext-link>). When the full RefSeq database (Ref1) was used, Sigma correctly identified and accurately quantified the spike-in strain (serovar Paratyphi A strain ATCC 9150) at 0.988%. Furthermore, Sigma did not find any SNP between the sampled strain and the identified reference strain with 100% genome coverage. This indicated that the identified strain was exactly the same as the sampled strain in the metagenome.</p>
      <p>The Ref2 database was constructed by removing the spike-in genome from the RefSeq database. The Ref2 database allowed Sigma to identify a closely related strain of the same serovar, <italic>S.</italic><italic>enterica</italic> serovar Paratyphi A strain AKU 12601 (ANI: 99.98%), and quantified its relative abundance at 0.986%. 190 high-confidence SNPs were found on the identified genome of strain AKU 12601 using Ref2, which were verified using the original genome of strain ATCC 9150. 99.95% of the identified genome was covered. The covered region divergence (CRD), defined as the percentage of high-confidence SNPs out of the covered regions of the identified genome, was 0.0042%. The sequence divergence showed a high genome-wide similarity between the identified reference genome and the actually sampled genome.</p>
      <p>The Ref3 database was then constructed by removing all <italic>S.</italic><italic>enterica</italic> species genomes from the RefSeq database. Sigma identified a genome of the same genus, <italic>S.</italic><italic>bongori</italic> NCTC 12419 (ANI: 90.50%), at a relative abundance of 0.031%. The relative abundances and <italic>P</italic>-values calculated by Sigma were based on the covered regions of the identified genomes. Only 11.46% of the identified <italic>S.</italic><italic>bongori</italic> genome was covered and 3750 high-confidence SNPs were found on the covered regions with a CRD of 0.734%. This indicated that only a small portion of the identified genomes was related to the sampled genomes in the metagenome.</p>
      <p>Finally, the Ref4 database was constructed by removing all <italic>Salmonella</italic> genus genomes from the RefSeq database. Sigma did not identify any genome that was not a background genome in the fecal sample.</p>
    </sec>
    <sec id="SEC4.4">
      <title>4.4 Demonstration of Sigma for biosurveillance of the 2011 German <italic>E.</italic><italic>coli</italic> outbreak</title>
      <p>A hypothetical biosurveillance scenario was constructed based on the 2011 German STEC O104:H4 outbreak (<xref rid="btu641-B22" ref-type="bibr">Rubino <italic>et al.</italic>, 2011</xref>). The STEC O104:H4 strain 280 (UK Health Protection Agency’s materials identifier H112160280) was isolated from this outbreak and sequenced by Illumina shotgun sequencing (<xref rid="btu641-B13" ref-type="bibr">Loman <italic>et al.</italic>, 2012</xref>). We spiked 1.7 million reads from this isolate into ∼125 million reads of the fecal metagenomic dataset, which simulated the existence of STEC O104:H4 strain 280 in a fecal sample at a relative abundance of 1.37%. The RefSeq database contained a reference genome, STEC O104:H4 strain 2011C-3493, isolated from a contracted U.S. citizen after travel to Germany during the outbreak (<xref rid="btu641-B1" ref-type="bibr">Ahmed <italic>et al.</italic>, 2012</xref>). O104:H4 2011C-3493 was closely related to two other O104:H4 genomes in the RefSeq database, 2009EL-2050 and 2009EL-2071, which were isolated from 2009 bloody diarrhea cases in the Republic of Georgia.</p>
      <p>After searching the spike-in metagenomic dataset against the RefSeq database, Sigma identified O104:H4 2011C-3493 at 1.14%, O104:H4 2009EL 2050 at 0.18%, and O104:H4 2009EL 2071 at 0.05%. No other genomes were identified from the addition of O104:H4 strain 280. This provided evidence for the presence of the STEC O104:H4 strain, which was very closely related to O104:H4 2011C-3493, and further to its two immediate phylogenetic neighbors. Sigma detected 211 high-confidence SNPs on the O104:H4 2011C-3493 genome from the metagenomic dataset. 99.96% of the O104:H4 2011C-3493 genome was covered with 0.004% CRD.</p>
    </sec>
  </sec>
  <sec>
    <title>5 DISCUSSION</title>
    <p>A number of taxonomic classification algorithms have been developed for metagenomic data with different advantages. For example, the LCA algorithm used by MEGAN can provide classification at a higher taxonomic rank for a novel microorganism without a reference genome from a closely related strain or species in the database. The marker gene approach used by MetaPhlAn only requires a small amount of computing resources for large metagenomic datasets. The general-purpose taxonomic classification algorithms (<xref rid="btu641-B2" ref-type="bibr">Brady and Salzberg, 2011</xref>; <xref rid="btu641-B3" ref-type="bibr">Diaz <italic>et al.</italic>, 2009</xref>; <xref rid="btu641-B12" ref-type="bibr">Liu <italic>et al.</italic>, 2011</xref>; <xref rid="btu641-B15" ref-type="bibr">Monzoorul Haque <italic>et al.</italic>, 2009</xref>; <xref rid="btu641-B18" ref-type="bibr">Patil <italic>et al.</italic>, 2011</xref>; <xref rid="btu641-B27" ref-type="bibr">Xia <italic>et al.</italic>, 2011</xref>) typically provide comprehensive phylogenetic coverage and identifications at proper taxonomic ranks for complex microbial communities, which is important for many microbial ecology studies.</p>
    <p>Conversely, Pathoscope and Sigma both are designed for detecting pathogens in metagenomic samples. However, Pathoscope did not provide accurate resolution of different strains in a sample, which is required for biosurveillance to distinguish pathogenic strains from non-pathogenic strains and to pinpoint the serotype of a pathogen from a complex metagenome background. This is probably because the EM algorithm used by Pathoscope can only provide a local optimum solution for genome abundance estimation. The local optimum solution may deviate significantly from the global optimum solution for metagenomes that are complicated by multiple different strains. However, the NLP algorithm used by Sigma mathematically guarantee a global optimum solution for genome abundance estimation, due to the convexity of the objective function for the MLE.</p>
    <p>Furthermore, Sigma provides three unique capabilities needed for metagenomic biosurveillance. First, Sigma can evaluate the statistical confidence of genome identification and quantification with hypothesis testing and confidence interval estimation. The uncertainty quantification will support more informed decision making in biosurveillance. Second, Sigma can determine the divergence of the actual genomes in the sample from the reference genomes in the database by variant calling. By assigning metagenomic reads to their most likely originating genomes, Sigma makes the metagenomic SNP analysis amenable to the existing variant calling algorithms designed for isolate genomes. Strain variations can be used to track the divergence of a pathogen during its spread. Finally, Sigma users can optionally use high-performance computing to achieve fast analysis with short turnaround time. The computation is scalable to very large metagenomic datasets.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_31_2_170__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btu641_Sigma_Supplementary.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btu641_Sigma_SupplementaryProposition.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors would like to thank Richard Stouder, Loren Hauser, and Robert Cottingham for their support and assistance. This work was supported by Laboratory Directed Research and Development (LDRD) funding from <funding-source>Oak Ridge National Laboratory</funding-source>. The contribution of J.C. was sponsored by the <funding-source>Office of Advanced Scientific Computing Research</funding-source>. This research used resources of the Oak Ridge Leadership Computing Facility at the Oak Ridge National Laboratory, which is supported by the <funding-source>Office of Science of the U.S. Department of Energy</funding-source> under Contract No. <award-id>DE-AC05-00OR22725</award-id>.</p>
    <p><italic>Conflict of interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu641-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ahmed</surname>
            <given-names>SA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic comparison of <italic>Escherichia coli</italic> O104:H4 isolates from 2009 and 2011 reveals plasmid, and prophage heterogeneity, including shiga toxin encoding phage stx2</article-title>
        <source>PLoS One</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>e48228</fpage>
        <pub-id pub-id-type="pmid">23133618</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brady</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>PhymmBL expanded: confidence scores, custom databases, parallelization and more</article-title>
        <source>Nat. Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>367</fpage>
        <pub-id pub-id-type="pmid">21527926</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diaz</surname>
            <given-names>NN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TACOA: taxonomic classification of environmental genomic fragments using a kernelized nearest neighbor approach</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>56</fpage>
        <pub-id pub-id-type="pmid">19210774</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fox</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Biosurveillance plan unveiled</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2012</year>
        <volume>30</volume>
        <fpage>1014</fpage>
      </element-citation>
    </ref>
    <ref id="btu641-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Francis</surname>
            <given-names>OE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pathoscope: species identification and strain attribution with unassembled sequencing data</article-title>
        <source>Genome Res.</source>
        <year>2013</year>
        <volume>23</volume>
        <fpage>1721</fpage>
        <lpage>1729</lpage>
        <pub-id pub-id-type="pmid">23843222</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goris</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA-DNA hybridization values and their relationship to whole-genome sequence similarities</article-title>
        <source>Int. J. Syst. Evol. Microbiol.</source>
        <year>2007</year>
        <volume>57</volume>
        <fpage>81</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="pmid">17220447</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MEGAN analysis of metagenomic data</article-title>
        <source>Genome Res.</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>377</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="pmid">17255551</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huttenhower</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure, function and diversity of the healthy human microbiome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>486</volume>
        <fpage>207</fpage>
        <lpage>214</lpage>
        <pub-id pub-id-type="pmid">22699609</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with Bowtie 2</article-title>
        <source>Nat. Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lindner</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Renard</surname>
            <given-names>BY</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic abundance estimation and diagnostic testing on species level</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>e10</fpage>
        <pub-id pub-id-type="pmid">22941661</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate and fast estimation of taxonomic profiles from metagenomic shotgun sequences</article-title>
        <source>BMC Genomics</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>Suppl 2</issue>
        <fpage>S4</fpage>
        <pub-id pub-id-type="pmid">21989143</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Performance comparison of benchtop high-throughput sequencing platforms</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2012</year>
        <volume>30</volume>
        <fpage>434</fpage>
        <lpage>439</lpage>
        <pub-id pub-id-type="pmid">22522955</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Methé</surname>
            <given-names>BA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A framework for human microbiome research</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>486</volume>
        <fpage>215</fpage>
        <lpage>221</lpage>
        <pub-id pub-id-type="pmid">22699610</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Monzoorul Haque</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SOrt-ITEMS: Sequence orthology based approach for improved taxonomic estimation of metagenomic sequences</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1722</fpage>
        <lpage>1730</lpage>
        <pub-id pub-id-type="pmid">19439565</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B16">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Nocedal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <source>Numerical Optimization</source>
        <year>2006</year>
        <publisher-loc>New York, Springer</publisher-loc>
        <publisher-name>Springer series in operations research</publisher-name>
      </element-citation>
    </ref>
    <ref id="btu641-B17">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pacheco</surname>
            <given-names>PS</given-names>
          </name>
        </person-group>
        <source>An Introduction to Parallel Programming</source>
        <year>2011</year>
        <publisher-loc>Amsterdam</publisher-loc>
        <publisher-name>Morgan Kaufmann</publisher-name>
      </element-citation>
    </ref>
    <ref id="btu641-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patil</surname>
            <given-names>KR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Taxonomic metagenome sequence assignment with structured output models</article-title>
        <source>Nat. Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>191</fpage>
        <lpage>192</lpage>
        <pub-id pub-id-type="pmid">21358620</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NCBI Reference Sequences (RefSeq): current status, new features and genome annotation policy</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>D130</fpage>
        <lpage>D135</lpage>
        <pub-id pub-id-type="pmid">22121212</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richter</surname>
            <given-names>DC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MetaSim: a sequencing simulator for genomics and metagenomics</article-title>
        <source>PLoS one</source>
        <year>2008</year>
        <volume>3</volume>
        <fpage>e3373</fpage>
        <pub-id pub-id-type="pmid">18841204</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosen</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenome fragment classification using N-mer frequency profiles</article-title>
        <source>Adv. Bioinf.</source>
        <year>2008</year>
        <volume>2008</volume>
        <fpage>205969</fpage>
      </element-citation>
    </ref>
    <ref id="btu641-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rubino</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cappuccinelli</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kelvin</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title><italic>Escherichia coli</italic> (STEC) serotype O104 outbreak causing haemolytic syndrome (HUS) in Germany and France</article-title>
        <source>J. Infect. Dev. Ctries.</source>
        <year>2011</year>
        <volume>5</volume>
        <fpage>437</fpage>
        <lpage>440</lpage>
        <pub-id pub-id-type="pmid">21727641</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenomic microbial community profiling using unique clade-specific marker genes</article-title>
        <source>Nat. Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>811</fpage>
        <lpage>814</lpage>
        <pub-id pub-id-type="pmid">22688413</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wachter</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Biegler</surname>
            <given-names>LT</given-names>
          </name>
        </person-group>
        <article-title>On the implementation of an interior-point filter line-search algorithm for large-scale nonlinear programming</article-title>
        <source>Math. Program.</source>
        <year>2006</year>
        <volume>106</volume>
        <fpage>25</fpage>
        <lpage>57</lpage>
      </element-citation>
    </ref>
    <ref id="btu641-B25">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Aryel</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <source>Handbook of biosurveillance</source>
        <year>2006</year>
        <publisher-loc>Amsterdam</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="btu641-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Phylogenomic analysis of bacterial and archaeal sequences with AMPHORA2</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1033</fpage>
        <lpage>1034</lpage>
        <pub-id pub-id-type="pmid">22332237</pub-id>
      </element-citation>
    </ref>
    <ref id="btu641-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>LC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate genome relative abundance estimation based on shotgun metagenomic reads</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e27992</fpage>
        <pub-id pub-id-type="pmid">22162995</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
