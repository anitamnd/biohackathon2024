<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ</journal-id>
    <journal-id journal-id-type="pmc">PeerJ</journal-id>
    <journal-id journal-id-type="publisher-id">PeerJ</journal-id>
    <journal-title-group>
      <journal-title>PeerJ</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2167-8359</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4179614</article-id>
    <article-id pub-id-type="publisher-id">576</article-id>
    <article-id pub-id-type="doi">10.7717/peerj.576</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Statistics</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Error estimates for the analysis of differential expression from RNA-seq count data</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author" corresp="yes">
        <name>
          <surname>Burden</surname>
          <given-names>Conrad J.</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1">1</xref>
        <email>conrad.burden@anu.edu.au</email>
      </contrib>
      <contrib id="author-2" contrib-type="author">
        <name>
          <surname>Qureshi</surname>
          <given-names>Sumaira E.</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1">1</xref>
      </contrib>
      <contrib id="author-3" contrib-type="author">
        <name>
          <surname>Wilson</surname>
          <given-names>Susan R.</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1">1</xref>
        <xref ref-type="aff" rid="aff-2">2</xref>
      </contrib>
      <aff id="aff-1"><label>1</label><institution>Mathematical Sciences Institute, Australian National University</institution>, <addr-line>Canberra</addr-line>, <country>Australia</country></aff>
      <aff id="aff-2"><label>2</label><institution>School of Mathematics and Statistics, University of New South Wales</institution>, <addr-line>Sydney</addr-line>, <country>Australia</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib id="editor-1" contrib-type="editor">
        <name>
          <surname>Nakai</surname>
          <given-names>Kenta</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2014-09-23">
      <day>23</day>
      <month>9</month>
      <year iso-8601-date="2014">2014</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <volume>2</volume>
    <elocation-id>e576</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2014-05-22">
        <day>22</day>
        <month>5</month>
        <year iso-8601-date="2014">2014</year>
      </date>
      <date date-type="accepted" iso-8601-date="2014-08-25">
        <day>25</day>
        <month>8</month>
        <year iso-8601-date="2014">2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Burden et al.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Burden et al.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/576"/>
    <abstract>
      <p><bold>Background.</bold> A number of algorithms exist for analysing RNA-sequencing data to infer profiles of differential gene expression. Problems inherent in building algorithms around statistical models of over dispersed count data are formidable and frequently lead to non-uniform <italic>p</italic>-value distributions for null-hypothesis data and to inaccurate estimates of false discovery rates (FDRs). This can lead to an inaccurate measure of significance and loss of power to detect differential expression.</p>
      <p><bold>Results.</bold> We use synthetic and real biological data to assess the ability of several available R packages to accurately estimate FDRs. The packages surveyed are based on statistical models of overdispersed Poisson data and include edgeR, DESeq, DESeq2, PoissonSeq and QuasiSeq. Also tested is an add-on package to edgeR and DESeq which we introduce called Polyfit. Polyfit aims to address the problem of a non-uniform null <italic>p</italic>-value distribution for two-class datasets by adapting the Storey–Tibshirani procedure.</p>
      <p><bold>Conclusions.</bold> We find the best performing package in the sense that it achieves a low FDR which is accurately estimated over the full range of <italic>p</italic>-values, albeit with a very slow run time, is the QLSpline implementation of QuasiSeq. This finding holds provided the number of biological replicates in each condition is at least 4. The next best performing packages are edgeR and DESeq2. When the number of biological replicates is sufficiently high, and within a range accessible to multiplexed experimental designs, the Polyfit extension improves the performance DESeq (for approximately 6 or more replicates per condition), making its performance comparable with that of edgeR and DESeq2 in our tests with synthetic data.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>RNA-seq</kwd>
      <kwd>Differential expression analysis</kwd>
      <kwd>False discovery rates</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>Australian Research Council Discovery Grants</funding-source>
        <award-id>DP1094699 </award-id>
        <award-id>DP120101422</award-id>
      </award-group>
      <award-group id="fund-2">
        <funding-source>National Health and Medical Research Council</funding-source>
        <award-id>NHMRC525453</award-id>
      </award-group>
      <funding-statement>This project is supported by Australian Research Council Discovery Grants DP1094699 and DP120101422 and National Health and Medical Research Council Grant NHMRC525453. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>High throughput sequencing technologies have largely replaced microarrays as the preferred technology for a number of areas of molecular biology, including gene expression profiling and the detection and quantification of differential gene expression under varying conditions. Transcriptome-wide expression profiling is accomplished via the technique of RNA-sequencing (RNA-seq) in which RNA transcripts sampled from a biological source are fragmented to convenient lengths, reverse transcribed to cDNA, amplified, sequenced and the reads identified by mapping to a reference genome. A concise summary of the RNA-seq procedure is given in the introductory material to <xref rid="ref-10" ref-type="bibr">Li et al. (2012)</xref>.</p>
    <p>Superficially, RNA-seq data gives the impression of needing little in the way of interpretation: Read counts are a sample of the population of cDNA fragments present and should, in principle, be a direct quantitative measure of the prevalence of the observed sequence in the original biological source. In practice however, there are many sources of both systematic and statistical variability present in the data and further complications related to mapping reads to the reference genome, annotation, and normalisation. Accordingly, a number of software packages have been developed specifically for the purpose of analysing tables of read counts from biological replicate sequencing runs under two or more conditions with the specific purpose of detecting which genes are differentially expressed (DE) and quantifying the degree of differential expression via <italic>p</italic>-values and estimated false discovery rates (FDRs). An extensive comparison of the performance of eleven such packages has recently been published by <xref rid="ref-25" ref-type="bibr">Soneson &amp; Delorenzi (2013)</xref>.</p>
    <p>Herein we follow the common convention of using the word ‘gene’ as shorthand for any member of the complete list of expressed sequence tags or transcript isoforms of interest in the transcriptome, and, in common with the packages studied by Soneson and Delorenzi, take as a starting point a table of integer valued read counts after mapping to the transcriptome. When detecting differential expression between two conditions, the list of genes is assumed to partition into a fraction 0 ≤ <italic>π</italic><sub>0</sub> ≤ 1 satisfying the null hypothesis of no differential expression and a fraction 1−<italic>π</italic><sub>0</sub> of alternate-hypothesis genes which are DE. The analysis is an application of multiple hypothesis testing and <italic>π</italic><sub>0</sub> is <italic>a priori</italic> unknown.</p>
    <p>The count data arising from high throughput sequencing technology is well represented as over-dispersed Poisson data, as the Poisson shot noise inherent in sampling a relatively small number of reads from a large number of molecules in solution is compounded with biological variability and with variability due to sample preparation. Over-dispersed Poisson data is typically modelled as power-of-Poisson, implying a mean–variance relationship Var(<italic>Y</italic><sup><italic>θ</italic></sup>) = <italic>E</italic>(<italic>Y</italic><sup><italic>θ</italic></sup>), or negative binomial (NB), implying a mean–variance relationship Var(<italic>Y</italic>) = <italic>E</italic>(<italic>Y</italic>) + <italic>ϕE</italic>(<italic>Y</italic>)<sup>2</sup>. Choosing an appropriate mean–variance function is critical to achieving accurate FDRs, as this function controls the influence of high-count outliers. Two of the most sophisticated and widely used packages for detecting differential expression from RNA-seq data, namely edgeR (<xref rid="ref-19" ref-type="bibr">Robinson, McCarthy &amp; Smyth, 2010</xref>) and DESeq (<xref rid="ref-1" ref-type="bibr">Anders &amp; Huber, 2010</xref>), model the over-dispersed Poisson count data using a negative binomial model (<xref rid="ref-21" ref-type="bibr">Robinson &amp; Smyth, 2007</xref>; <xref rid="ref-22" ref-type="bibr">Robinson &amp; Smyth, 2008</xref>). The read counts for the biological replicates for each gene in each condition are fitted to a NB distribution via an algorithm that involves borrowing information from count data for the complete set of genes. A transcript abundance for each gene is then inferred from the gene’s NB mean, in combination with a normalisation obtained by matching the distribution of read counts over a subset of genes which are likely not to be DE. The null hypothesis corresponding to no differential expression is that the transcript abundance is the same in both conditions. Both packages provide <italic>p</italic>-values from which estimates of FDRs are extracted using the Benjamini–Hochberg algorithm (<xref rid="ref-2" ref-type="bibr">Benjamini &amp; Hochberg, 1995</xref>). For concise summaries of differences between the algorithms behind edgeR and DESeq, which are mainly related to the estimation of NB parameters from the raw data see <xref rid="ref-23" ref-type="bibr">Robles et al. (2012)</xref> and the supplementary material to <xref rid="ref-25" ref-type="bibr">Soneson &amp; Delorenzi (2013)</xref>. An updated version of DESeq, called DESeq2 (<xref rid="ref-11" ref-type="bibr">Love, Anders &amp; Huber, 2013</xref>) has also appeared, which employs an empirical-Bayes-style shrinkage estimation of over-dispersion similar to that used by edgeR.</p>
    <p>Two recent additions to the suite of available packages for analysing RNA-seq data are PoissonSeq (<xref rid="ref-10" ref-type="bibr">Li et al., 2012</xref>) and QuasiSeq (<xref rid="ref-12" ref-type="bibr">Lund et al., 2012</xref>). Both these packages post-date the survey of <xref rid="ref-25" ref-type="bibr">Soneson &amp; Delorenzi (2013)</xref>. The PoissonSeq algorithm begins by power-transforming over-dispersed count data to (non-integer valued) quasi-Poisson data. Normalisation is achieved by iteratively determining a subset of genes satisfying a null-hypothesis Poisson model. This subset is typically chosen to be half the total number of genes and is interpreted as falling within the fraction <italic>π</italic><sub>0</sub> of non-DE genes. An unsigned score statistic, which has a <italic>χ</italic><sup>2</sup>-distribution under the null hypothesis for the Poisson log-linear model described in Section 3 of <xref rid="ref-10" ref-type="bibr">Li et al. (2012)</xref>, is used to detect differential expression. The FDR is estimated using a novel modified plug-in estimate in which the permutation distribution of the score statistic is calculated only from genes which are likely to be null. Using evidence of experiments with synthetic NB data, <xref rid="ref-10" ref-type="bibr">Li et al. (2012)</xref> claim that their method achieves considerably improved estimates of the FDR compared with edgeR.</p>
    <p>The QuasiSeq package combines a quasi-likelihood approach to estimating over-dispersion (<xref rid="ref-28" ref-type="bibr">Tjur, 1998</xref>) with <xref rid="ref-24" ref-type="bibr">Smyth</xref>’s (<xref rid="ref-24" ref-type="bibr">2004</xref>) approach of sharing information across genes. The QuasiSeq package is implemented as three alternate algorithms, namely QL, QLShrink and QLSpline, which differ in the way in which dispersion information is shared across genes. Of these QLSpline is reported to have the best performance (<xref rid="ref-12" ref-type="bibr">Lund et al., 2012</xref>), and therefore will be the implementation of QuasiSeq used throughout the remainder of this paper.</p>
    <p>The current paper introduces an extension to the packages edgeR and DESeq which we call Polyfit. The aim of Polyfit is to improve edgeR and DESeq’s calculations of <italic>p</italic>-values and estimates of the FDR by replacing the Benjamini–Hochberg procedure with an adapted version of a procedure for multiple hypothesis testing proposed by <xref rid="ref-27" ref-type="bibr">Storey &amp; Tibshirani (2003)</xref>.</p>
    <p>Our principle purpose is to perform a comparative analysis of the seven packages PoissonSeq, the QLSpline implementation of QuasiSeq, edgeR, DESeq, DESeq2, and our extended versions Polyfit-edgeR and Polyfit-DESeq using both synthetic and real biological data. A secondary aim is to explain details of the Polyfit extension and the issues it addresses. The “Materials and Methods” contains a detailed description of the Polyfit algorithm and our procedure for generating synthetic data. Subsections within the “Results and Discussion” present the results of comparing the performance of the six packages with synthetic and real biological data respectively. A summary of results, including advice on the appropriateness of the packages under differing situations, is given in the “Conclusions”. Throughout the paper we use the default settings, including normalisations, of edgeR, DESeq, DESeq2, PoissonSeq and QLSpline (see Methods for details).</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and Methods</title>
    <sec>
      <title>Outline of the Polyfit procedure</title>
      <p>The software packages edgeR (<xref rid="ref-19" ref-type="bibr">Robinson, McCarthy &amp; Smyth, 2010</xref>) and DESeq (<xref rid="ref-1" ref-type="bibr">Anders &amp; Huber, 2010</xref>) for detecting and quantifying differential expression from RNA-seq data are based on NB models of over-dispersed count data. These packages are state-of-the-art, but nevertheless are subject to shortcomings resulting from the computational complexity of estimating the parameters of the assumed NB distribution for each gene. To illustrate this, <xref ref-type="fig" rid="fig-1">Fig. 1A</xref> shows histograms of nominal <italic>p</italic>-values obtained from the DESeq algorithm for simulated data of <italic>n</italic> = 4 replicates of data for each of two conditions for 46,446 genes created with a range of means and over-dispersions typical of that found in the human transcriptome (<xref rid="ref-23" ref-type="bibr">Robles et al., 2012</xref>). In these data, the mean expression of 15% of the second-condition genes have been up- or down-regulated by at least a factor of 2 relative to the first-condition data. For the purposes of the current illustration, and as part of the implementation of our method, we have made changes to the original DESeq and edgeR algorithms in order to smooth out an artefact spike at <italic>p</italic> = 1 resulting from estimating <italic>p</italic>-values from a discrete distribution; further details are given below. We observe that even with this spike redistributed the <italic>p</italic>-value histogram for the 85% of genes which are unregulated (shaded) is far from uniform. The effect is more pronounced for DESeq than for edgeR. Uniformity is a fundamental property required of <italic>p</italic>-values for continuous data satisfying the null hypothesis (<xref rid="ref-27" ref-type="bibr">Storey &amp; Tibshirani, 2003</xref>), and hence using the false positive rate to control for differential expression with these calculated <italic>p</italic>-values would lead to an overly conservative measure of significance and hence loss of power to detect differential expression.</p>
      <fig id="fig-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.576/fig-1</object-id>
        <label>Figure 1</label>
        <caption>
          <title>The Polyfit procedure.</title>
          <p>(A) Histogram of the nominal <italic>p</italic>-values calculated by DESeq for synthetic data RNA-seq with 15% genes up- or down-regulated. The shaded histogram superimposed is the 85% of transcripts which are unregulated. (B) Schematic representation of the Storey–Tibshirani procedure for correcting for multiple hypothesis testing, assuming correctly calculated <italic>p</italic>-values. (C) Schematic representation of the Storey–Tibshirani procedure adapted to RNA-seq data. By ‘nominal <italic>p</italic>-values’ we mean <italic>p</italic>-values as calculated by a computer package relying on a NB model using estimated parameters, such as DESeq or edgeR. (TP, true positives; FP, false positives; FN, false negatives; TN, true negatives at a specified significance point <italic>α</italic>.)</p>
        </caption>
        <graphic xlink:href="peerj-02-576-g001"/>
      </fig>
      <p>DESeq and edgeR correct for multiple hypothesis testing via the Benjamini–Hochberg procedure (<xref rid="ref-2" ref-type="bibr">Benjamini &amp; Hochberg, 1995</xref>). For each gene an ‘adjusted <italic>p</italic>-value’ (also known as <italic>q</italic>-value) is calculated to enable the expected false discovery rate (FDR) (i.e., the proportion of positives returned which are false positives) to be used to control for differential expression. The <italic>q</italic>-value of an individual hypothesis test is the minimum FDR at which the test may be called significant. Herein we propose an alternate method for estimating <italic>p</italic>-values and <italic>q</italic>-values by adapting the graphical procedure for multiple hypothesis testing due to <xref rid="ref-27" ref-type="bibr">Storey &amp; Tibshirani (2003)</xref>. In this procedure the proportion of cases satisfying the null hypothesis is estimated from the behaviour of the <italic>p</italic>-value histogram as <italic>p</italic> → 1, enabling estimates of <italic>q</italic>-values to be obtained graphically at any <italic>p</italic>-value <italic>α</italic> as the ratio FP/(TP + FP) (see <xref ref-type="fig" rid="fig-1">Fig. 1B</xref>). The procedure implicitly assumes <italic>p</italic>-values are calculated accurately and have a uniform distribution under the null hypothesis.</p>
      <p>Our proposed adaptation of the Storey–Tibshirani procedure to RNA-seq data method shares features in common with the empirical null method of Efron and its variants (<xref rid="ref-6" ref-type="bibr">Efron, 2004</xref>; <xref rid="ref-8" ref-type="bibr">Jin &amp; Cai, 2007</xref>). The method is illustrated in <xref ref-type="fig" rid="fig-1">Fig. 1C</xref> and described in detail below. Briefly, a suitable functional form is fitted to the right hand part of the nominal <italic>p</italic>-value histogram supplied by the existing software and extrapolated to the complete interval [0, 1]. The area under the extrapolated curve is assumed to approximate the histogram of nominal <italic>p</italic>-values for the non-DE genes. Corrected <italic>p</italic>-values and <italic>q</italic>-values are then estimated at each nominal <italic>p</italic>-value (labelled <italic>α</italic> in <xref ref-type="fig" rid="fig-1">Fig. 1C</xref>) from the formulae <disp-formula id="eqn-1"><alternatives><graphic xlink:href="peerj-02-576-e001.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \displaystyle \text{corrected }p\text{-value}=\frac{\text{FP}}{\text{FP}+\text{TN}},\qquad \text{corrected }q\text{-value}=\frac{\text{FP}}{\text{FP}+\text{TP}}.&amp;&amp;\displaystyle \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-1"><mml:mstyle displaystyle="true"><mml:mtext>corrected </mml:mtext><mml:mi>p</mml:mi><mml:mtext>-value</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mrow><mml:mtext>FP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>TN</mml:mtext></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="2em" class="qquad"/><mml:mtext>corrected </mml:mtext><mml:mi>q</mml:mi><mml:mtext>-value</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mrow><mml:mtext>FP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>TP</mml:mtext></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula> The method provides an estimate of the proportion <italic>π</italic><sub>0</sub> of genes satisfying the null hypothesis of no differential expression as the shaded area divided by the total number of genes, and hence also an estimate of the fraction 1−<italic>π</italic><sub>0</sub> of DE genes. Herein we refer to our adapted Storey–Tibshirani procedure as ‘Polyfit’ (for polynomial fit).</p>
      <p>The ‘Polyfit’ method described in detail below consists of two steps; removing an artefact ‘flagpole’ in the <italic>p</italic>-value histogram at <italic>p</italic> = 1, and adapting the Storey–Tibshirani procedure to a non-uniform nominal <italic>p</italic>-values histogram.</p>
    </sec>
    <sec>
      <title>Removal of the ‘flagpole’ at <italic>p</italic> = 1</title>
      <p>Typical <italic>p</italic>-value histograms produced by DESeq and edgeR in a case where there is no differential expression and a case with 15% differential expression between two conditions A and B with <italic>n<sub>A</sub></italic> = <italic>n<sub>B</sub></italic> = 4 replicates are shown by the red histograms in <xref ref-type="fig" rid="fig-2">Fig. 2</xref>. These particular examples are for synthetic data generated according to the NB model assumed by DESeq or edgeR. We have observed that qualitatively similar histograms are frequently obtained from real biological data: there is invariably a spike at 1 on top of a distribution which, in the case of no differential expression is rarely close to uniform and is generally skewed towards the right hand end (particularly for DESeq, see also Fig. S20A of <xref rid="ref-25" ref-type="bibr">Soneson &amp; Delorenzi (2013)</xref>). The spike at 1 is an artefact of calculating <italic>p</italic>-values from a discrete distribution. For our purposes it is convenient to redistribute the spike by approximating the discrete distribution with a continuous distribution.</p>
      <fig id="fig-2" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.576/fig-2</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Nominal <italic>p</italic>-value histograms generated by DESeq (A and C) and edgeR (B and D) from synthetic data with no DE genes (A and B) and 15% differentially expressed genes (C and D).</title>
          <p>Histograms are shown in red before the redistribution of the ‘flagpole’ at <italic>p</italic> = 1 and in blue after.</p>
        </caption>
        <graphic xlink:href="peerj-02-576-g002"/>
      </fig>
      <p>For any given gene, <italic>p</italic>-values are calculated in DESeq and edgeR from a statistic which is a discrete random variable, namely the total number of counts observed in all replicates of condition A conditional on the total number of counts observed in all replicates of both conditions. If the observed total number of counts in conditions A and B for a given gene are <italic>k<sub>A</sub></italic> and <italic>k<sub>B</sub></italic> respectively, and the null hypothesis probability of making this observation is <italic>π</italic>(<italic>k<sub>A</sub></italic>, <italic>k<sub>B</sub></italic>), then the two-sided <italic>p</italic>-value is calculated as a sum of probabilities over ways of apportioning the counts which have lower probability than that observed: <disp-formula id="eqn-2"><label>(1)</label><alternatives><graphic xlink:href="peerj-02-576-e002.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} p=\frac{\displaystyle \sum _{{a+b=k_{A}+{k}_{B}\atop \pi (a,b)\leq \pi ({k}_{A},{k}_{B})}}\pi (a,b)}{\displaystyle \sum _{a+b=k_{A}+{k}_{B}}\pi (a,b)}. \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-2"><mml:mstyle displaystyle="true"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mfrac linethickness="0"><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>π</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced><mml:mo>≤</mml:mo><mml:mi>π</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:munder><mml:mi>π</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>π</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula> If the observed counts happen to hit the mode of the discrete conditional distribution this formula will return a <italic>p</italic>-value of 1. This is the cause of the spike observed at the right hand end of the red histogram in <xref ref-type="fig" rid="fig-2">Fig. 2</xref>. This effect is most noticeable for genes with low count numbers. We note in passing that we have also occasionally observed other, much smaller, spikes occurring at rational values in the <italic>p</italic>-value histogram arising for similar reasons.</p>
      <p>By using a method similar to that employed by <xref rid="ref-13" ref-type="bibr">Marioni et al. (2008)</xref>, the spikes can be redistributed by replacing the discrete distribution with a ‘squared off’ continuous distribution as follows. Suppose the mass and probability functions of a discrete random variable <italic>K</italic>∈{0, 1, …, <italic>k</italic><sub>max</sub>} under a given null hypothesis are <disp-formula id="eqn-3"><label>(2)</label><alternatives><graphic xlink:href="peerj-02-576-e003.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \displaystyle \text{}\mathrm{Prob}\text{\hspace{0.167em}}(K=k)={P}_{K}(k),\qquad \text{}\mathrm{Prob}\text{\hspace{0.167em}}(K\leq k)=\sum _{a\leq k}{P}_{K}(a)={F}_{K}(k).&amp;&amp;\displaystyle \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-3"><mml:mstyle displaystyle="true"><mml:mtext/><mml:mi mathvariant="normal">Prob</mml:mi><mml:mtext> </mml:mtext><mml:mfenced separators="" open="(" close=")"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>k</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="2em" class="qquad"/><mml:mtext/><mml:mi mathvariant="normal">Prob</mml:mi><mml:mtext> </mml:mtext><mml:mfenced separators="" open="(" close=")"><mml:mi>K</mml:mi><mml:mo>≤</mml:mo><mml:mi>k</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>≤</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>a</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>k</mml:mi></mml:mfenced><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula> In the current case, <italic>k</italic><sub>max</sub> = <italic>k<sub>A</sub></italic> + <italic>k<sub>B</sub></italic> and <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i001.jpg"/><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${P}_{K}(k)=\pi (k,{k}_{\max }-k)/\sum _{a+b=k_{A}+{k}_{B}}\pi (a,b)$\end{document}</tex-math><mml:math id="mml-ieqn-68"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>k</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>max</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mfenced><mml:mo>/</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>π</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:math></alternatives></inline-formula>. For an observed value <italic>k</italic> of <italic>K</italic>, a <italic>p</italic>-value defined as <disp-formula id="eqn-4"><label>(3)</label><alternatives><graphic xlink:href="peerj-02-576-e004.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \displaystyle p=2\min \left({F}_{K}(k-1)+U{P}_{K}(k),1-{F}_{K}(k-1)-U{P}_{K}(k)\right),&amp;&amp;\displaystyle \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-4"><mml:mstyle displaystyle="true"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>min</mml:mo><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>+</mml:mo><mml:mi>U</mml:mi><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>k</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>−</mml:mo><mml:mi>U</mml:mi><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>k</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula> where <italic>U</italic> is a random number with a uniform distribution on the interval [0, 1], will have a uniform distribution under the null hypothesis.</p>
      <p>Note that our definition of two-sided <italic>p</italic>-value has one other difference from that used in DESeq and edgeR, in that <xref ref-type="disp-formula" rid="eqn-2">Eq. (1)</xref> is a sum of probabilities less than or equal to the probability of the observation, whereas <xref ref-type="disp-formula" rid="eqn-4">Eq. (3)</xref> is twice the one-sided <italic>p</italic>-value. There is no universal agreement on how to define two-sided <italic>p</italic>-values for asymmetric distributions, and both approaches are common in the literature (see <xref rid="ref-5" ref-type="bibr">Dunne, Pawitan &amp; Doody (1996)</xref> and references therein). Inasmuch as the developers of DESeq and edgeR have sensibly made a convenient ad hoc decision for their purposes, <xref ref-type="disp-formula" rid="eqn-4">Eq. (3)</xref> is an ad hoc decision convenient to the purpose of providing a smooth nominal <italic>p</italic>-value distribution to enable us to proceed to the adapted Storey–Tibshirani procedure described below.</p>
      <p>The blue histograms in <xref ref-type="fig" rid="fig-2">Fig. 2</xref> have been produced using DESeq and edgeR software with <xref ref-type="disp-formula" rid="eqn-2">Eq. (1)</xref> replaced by <xref ref-type="disp-formula" rid="eqn-4">Eq. (3)</xref>. The spike at 1 and some of the irregularity in the shape of the histogram has been removed, though the underlying skew towards the right remains. The remaining skewing is caused by the need to estimate the parameters of the NB distribution from the data: if the parameters estimated by DESeq for each gene are replaced by the true values used to generate the synthetic data of <xref ref-type="fig" rid="fig-2">Fig. 2</xref> for instance, the resulting histogram is very close to uniform (result not shown). In itself, the removal of the spike is mainly cosmetic at this point as the shape of the left hand part of the histogram, which is important for detecting significantly DE genes, remains virtually unaltered. Furthermore, the inclusion of the random number <italic>U</italic> in the algorithm will cause <italic>p</italic>-values to vary slightly each time the program is run, particularly for low-count genes. It is probably for these minor reasons that no such technique has been implemented in either DESeq or edgeR. However, implementation is necessary for the following step in the Polyfit procedure.</p>
    </sec>
    <sec>
      <title>Corrected <italic>p</italic>-values and <italic>q</italic>-values: adapting the Storey–Tibshirani procedure</title>
      <p>The principle behind adapting the Storey–Tibshirani procedure (<xref rid="ref-27" ref-type="bibr">Storey &amp; Tibshirani, 2003</xref>) to RNA-seq data is illustrated in <xref ref-type="fig" rid="fig-1">Fig. 1C</xref>. The major challenge is to estimate the histogram of nominal <italic>p</italic>-values arising from non-DE genes (the shaded area) given only the histogram of nominal <italic>p</italic>-values for all genes (the upper curve). This is accomplished by postulating a suitable functional form which is fitted to the right hand part of the histogram over an interval <italic>p</italic> &gt; <italic>λ</italic> for an optimised value of <italic>λ</italic>. The algorithm is implemented in an R function <monospace>levelPValues()</monospace> provided in <xref ref-type="supplementary-material" rid="supp-2">File S2</xref>. This function takes as its argument an array of DESeq or edgeR <italic>p</italic>-values with the spike at 1 redistributed as described above, and generates as output an estimate of the fraction <italic>π</italic><sub>0</sub> of genes not DE, an array of corrected <italic>p</italic>-values and an array of corrected <italic>q</italic>-values. The function also provides a set of plots, an example of which is illustrated in <xref ref-type="fig" rid="fig-3">Fig. 3</xref> for synthetic data with 3 replicates in each of two conditions in which 15% of genes are DE in the second condition and <italic>p</italic>-values are generated from our replacement DESeq function <monospace>pfNbinomTest()</monospace>.</p>
      <fig id="fig-3" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.576/fig-3</object-id>
        <label>Figure 3</label>
        <caption>
          <p>(A) Estimates of the fraction <italic>π</italic><sub>0</sub> of genes not DE obtained by fitting a quadratic function to the original input (without the flagpole) <italic>p</italic>-value histogram over the interval [<italic>λ</italic>, 1]. (B) Density plot of obtained estimates <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i002.jpg"/><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat {\pi }}_{0}$\end{document}</tex-math><mml:math id="mml-ieqn-95"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. The optimal <italic>λ</italic><sub>opt</sub> (red dot in (A)) is obtained by choosing the <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i003.jpg"/><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat {\pi }}_{0}(\lambda )$\end{document}</tex-math><mml:math id="mml-ieqn-97"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>λ</mml:mi></mml:mfenced></mml:math></alternatives></inline-formula> closest to the mode of the <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i004.jpg"/><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat {\pi }}_{0}$\end{document}</tex-math><mml:math id="mml-ieqn-98"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> density. The mode is also indicated by the dotted line in (A). The original and corrected <italic>p</italic>-value histograms are shown in (C) and (D), together with optimally fitted quadratic in (C) and its image after correction in (D). The red part of the quadratic is the interval [<italic>λ</italic><sub>opt</sub>, 1] in (C) and its image in (D). This example is generated from synthetic data for which the true value of <italic>π</italic><sub>0</sub> is 0.85.</p>
        </caption>
        <graphic xlink:href="peerj-02-576-g003"/>
      </fig>
      <p>The algorithm is summarised as follows:</p>
      <list list-type="simple" id="list-1">
        <list-item>
          <label>1.</label>
          <p>For a range of values of <italic>λ</italic> from 0 to 1 in steps of 0.01 a 3-parameter quadratic function <italic>f</italic><sub><italic>λ</italic></sub> is fitted to the <italic>p</italic>-value histogram over the interval [<italic>λ</italic>, 1]. The fit is performed by using the R function <monospace>nlm()</monospace> to minimise the sum of squared residuals. An estimate of <italic>π</italic><sub>0</sub> is obtained at each <italic>λ</italic> from the formula <disp-formula id="eqn-5"><alternatives><graphic xlink:href="peerj-02-576-e005.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \displaystyle {\hat {\pi }}_{0}(\lambda )=\frac{\int \nolimits \nolimits _{0}^{1}{f}_{\lambda }(x)d x}{\text{total number of }p\text{-values}}.&amp;&amp;\displaystyle \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-5"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>λ</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>x</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>total number of </mml:mtext><mml:mi>p</mml:mi><mml:mtext>-values</mml:mtext></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula> Note that as <italic>λ</italic> increases past the left-hand peak of the original <italic>p</italic>-value histogram, which is dominated by DE genes, the fit initially stabilises and is then overcome by noise as <italic>λ</italic> → 1 (see <xref ref-type="fig" rid="fig-3">Fig. 3A</xref>).</p>
        </list-item>
        <list-item>
          <label>2.</label>
          <p>A smoothed density plot <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i005.jpg"/><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$d({\hat {\pi }}_{o})$\end{document}</tex-math><mml:math id="mml-ieqn-112"><mml:mi>d</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:math></alternatives></inline-formula> of the histogram of the <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i006.jpg"/><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat {\pi }}_{0}(\lambda )$\end{document}</tex-math><mml:math id="mml-ieqn-113"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>λ</mml:mi></mml:mfenced></mml:math></alternatives></inline-formula> values from step 1 is produced using the kernel density estimator R function <monospace>density()</monospace> with default settings (see <xref ref-type="fig" rid="fig-3">Fig. 3B</xref>). An optimal value <italic>λ</italic><sub>opt</sub> is chosen as <disp-formula id="eqn-6"><alternatives><graphic xlink:href="peerj-02-576-e006.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \displaystyle {\lambda }_{\mathrm{opt}}=\text{arg}\hspace{0.167em} \displaystyle \max _{\lambda }\hspace{0.167em} d({\hat {\pi }}_{0}(\lambda )).&amp;&amp;\displaystyle \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-6"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">opt</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>arg</mml:mtext><mml:mi> </mml:mi><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:munder><mml:mi> </mml:mi><mml:mi>d</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>λ</mml:mi></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula> In practice, because <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i007.jpg"/><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat {\pi }}_{0}(\lambda )$\end{document}</tex-math><mml:math id="mml-ieqn-116"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>λ</mml:mi></mml:mfenced></mml:math></alternatives></inline-formula> is evaluated at a finite set of <italic>λ</italic> values, the value corresponding to the <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i008.jpg"/><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat {\pi }}_{0}(\lambda )$\end{document}</tex-math><mml:math id="mml-ieqn-118"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>λ</mml:mi></mml:mfenced></mml:math></alternatives></inline-formula> closest to the mode argmax(<italic>d</italic>) of this density plot is used. The quadratic <italic>f</italic><sub><italic>λ</italic><sub>opt</sub></sub> fitted over the range [<italic>λ</italic><sub>opt</sub>, 1] is shown in <xref ref-type="fig" rid="fig-3">Fig. 3C</xref>.</p>
        </list-item>
        <list-item>
          <label>3.</label>
          <p>Corrected <italic>p</italic>-values are calculated for each of the original <italic>p</italic>-values <italic>p</italic> via the formula <disp-formula id="eqn-7"><alternatives><graphic xlink:href="peerj-02-576-e007.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \displaystyle {p}_{\mathrm{corr}}=\frac{\int \nolimits \nolimits _{0}^{p}{f}_{{\lambda }_{\mathrm{opt}}}(x)d x}{\int \nolimits \nolimits _{0}^{1}{f}_{{\lambda }_{\mathrm{opt}}}(x)d x},&amp;&amp;\displaystyle \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-7"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">corr</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">opt</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>x</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">opt</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>x</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula> and corrected <italic>q</italic>-values are obtained from the formula <disp-formula id="eqn-8"><alternatives><graphic xlink:href="peerj-02-576-e008.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \displaystyle {q}_{\mathrm{corr}}=\frac{\int \nolimits \nolimits _{0}^{p}{f}_{{\lambda }_{\mathrm{opt}}}(x)d x}{\text{Total number of }p\text{-values }\lt p\text{}}.&amp;&amp;\displaystyle \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-8"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">corr</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">opt</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced separators="" open="(" close=")"><mml:mi>x</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>Total number of </mml:mtext><mml:mi>p</mml:mi><mml:mtext>-values </mml:mtext><mml:mo>&lt;</mml:mo><mml:mi>p</mml:mi><mml:mtext/></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula> For completeness, the function <monospace>levelPValues()</monospace> also provides a set of <italic>q</italic>-values calculated from <italic>p</italic><sub>corr</sub> via the Benjamini–Hochberg procedure via the R function <monospace>p.adjust()</monospace>. A histogram of corrected <italic>p</italic>-values is shown in <xref ref-type="fig" rid="fig-3">Fig. 3D</xref>.</p>
        </list-item>
      </list>
      <p>There is nothing in principle to guarantee that the estimate <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i009.jpg"/><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat {\pi }}_{0}$\end{document}</tex-math><mml:math id="mml-ieqn-131"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> produced by this algorithm will lie in the range [0, 1]. In our investigations with both synthetic and real data we have never observed a case of <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i010.jpg"/><tex-math id="M18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat {\pi }}_{0}$\end{document}</tex-math><mml:math id="mml-ieqn-133"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> lying outside the range [0, 1.01], as the (smoothed) <italic>p</italic>-value histograms produced by DESeq and edgeR invariably resemble the examples in <xref ref-type="fig" rid="fig-2">Fig. 2</xref> with, even in the absence of DE genes, a spike a the left hand end. Should a value outside [0, 1] be observed, we recommend running <monospace>levelPValues()</monospace> with the option <monospace>plot=TRUE</monospace>. The nature of the problem will then be apparent from the plot generated analogous to <xref ref-type="fig" rid="fig-3">Fig. 3C</xref>.</p>
      <p>Note that the flagpole removal step is not appropriate for QuasiSeq, PoissonSeq or DESeq2. Each of these three packages uses a test statistic which is assumed to have continuous distributions under the null hypothesis, so the flagpole problem does not arise: QuasiSeq uses a quasi-likelihood ratio test statistic with a null <italic>F</italic>-distribution (See <xref rid="ref-12" ref-type="bibr">Lund et al. (2012)</xref>, Eq. (2) et seq.); PoissonSeq uses a score statistic which closely follows a null chi-squared distribution (See <xref rid="ref-10" ref-type="bibr">Li et al. (2012)</xref>, Eq. (3.9)); and examination of the function <monospace>nbinomWaldTest()</monospace> within the DESeq2 software (<xref rid="ref-11" ref-type="bibr">Love, Anders &amp; Huber, 2013</xref>) reveals use of a Wald statistic which has a null normal distribution. Furthermore, the second component of Polyfit, namely the adapted Storey–Tibshirani procedure, is not necessary for QuasiSeq or PoissonSeq as neither suffers from a <italic>p</italic>-value histogram which rises towards the right hand end. Histograms of <italic>p</italic>-values in the case of no DE are shown in <xref ref-type="supplementary-material" rid="supp-1">Figs. S23</xref> and <xref ref-type="supplementary-material" rid="supp-1">S24</xref> for the various packages. We find in general that if Polyfit is applied to the output of QuasiSeq or PoissonSeq there is no appreciable difference to the resulting <italic>p</italic>-values or, in the case of synthetic data, to plots of the FDR.</p>
    </sec>
    <sec>
      <title>Variants of the Polyfit procedure</title>
      <p>We have also tried using cubic and 3- and 4-parameter rational fitting functions, and find that a quadratic to be the most effective fitting function for determining a stable and convincing fit over a range of <italic>λ</italic>.</p>
      <p>As an alternative to the ‘flagpole removal’ step we have also tried constructing the function <italic>f</italic><sub><italic>λ</italic></sub> by fitting over an interval [<italic>λ</italic>, 0.9] in Step 1 above to avoid the flagpole, and then estimating <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i011.jpg"/><tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat {\pi }}_{0}$\end{document}</tex-math><mml:math id="mml-ieqn-144"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> as above from the fitted quadratic extrapolated over the interval [0, 1]. The results on synthetic data differed in that the estimated FDR was slightly elevated relative to the standard Polyfit procedure (see <xref ref-type="supplementary-material" rid="supp-1">Fig. S27</xref>). We chose not to use this method because of the ad hoc nature of the <italic>λ</italic> cutoff at 0.9.</p>
    </sec>
    <sec>
      <title>Construction of synthetic data</title>
      <p>The synthetic datasets detailed in the “Results and Discussion” were created using the method set out by <xref rid="ref-25" ref-type="bibr">Soneson &amp; Delorenzi (2013)</xref> and <xref rid="ref-23" ref-type="bibr">Robles et al. (2012)</xref>. Briefly, our synthetic data is based on a NB model of read counts assumed by <xref rid="ref-21" ref-type="bibr">Robinson &amp; Smyth (2007)</xref> and used in edgeR (<xref rid="ref-19" ref-type="bibr">Robinson, McCarthy &amp; Smyth, 2010</xref>) and DESeq <xref rid="ref-1" ref-type="bibr">Anders &amp; Huber (2010)</xref>. Each dataset consists of data for two conditions: a ‘control’ set of read counts <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i012.jpg"/><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${K}_{i j}^{\mathrm{contr}}$\end{document}</tex-math><mml:math id="mml-ieqn-147"><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">contr</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and a ‘treatment’ set of read counts <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i013.jpg"/><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${K}_{i j}^{\mathrm{treat}}$\end{document}</tex-math><mml:math id="mml-ieqn-148"><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">treat</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, for <italic>i</italic> = 1, …, <italic>t</italic> genes sequenced from <italic>j</italic> = 1, …, <italic>n</italic> replicate cDNA libraries.</p>
      <p>For each gene, we begin by providing a pair of NB parameters, the mean <italic>μ<sub>i</sub></italic> and over-dispersion <italic>ϕ<sub>i</sub></italic> estimated using maximum likelihood from a subset of the Pickrell dataset (<xref rid="ref-16" ref-type="bibr">Pickrell et al., 2010</xref>) of sequenced cDNA libraries generated from mRNA from 69 lymphoblastoid cell lines derived from Nigerian individuals as part of the International HapMap Project (see <xref rid="ref-23" ref-type="bibr">Robles et al. (2012)</xref> for details). The raw reads were mapped onto the human transcriptome (hg18, USCS) using the KANGA aligner (<xref rid="ref-26" ref-type="bibr">Stephen et al., 2012</xref>), and the transcriptome culled to a list of <italic>t</italic> = 46,446 transcripts (‘genes’ in the above terminology) with an average of at least one count per replicate to reduce the number of zero-count genes. For <xref ref-type="supplementary-material" rid="supp-1">Figs. S21</xref> and <xref ref-type="supplementary-material" rid="supp-1">S22</xref> the same maximum-likelihood calculation was followed to estimate NB parameters from the 10 C57BL/6J biological replicates of the Bottomly dataset (<xref rid="ref-3" ref-type="bibr">Bottomly et al., 2011</xref>) consisting of adult mouse-brain RNA-seq reads mapped using the Bowtie aligner (<xref rid="ref-9" ref-type="bibr">Langmead et al., 2009</xref>).</p>
      <p>The control read counts <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i014.jpg"/><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${K}_{i j}^{\mathrm{contr}}$\end{document}</tex-math><mml:math id="mml-ieqn-154"><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">contr</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> were created as independently distributed NB random variables with parameters Λ<sub><italic>j</italic></sub><italic>μ<sub>i</sub></italic> and <italic>ϕ<sub>i</sub></italic>. Variability in library size among samples is accounted for by a random scaling factor Λ<sub><italic>j</italic></sub>, which, following <xref rid="ref-12" ref-type="bibr">Lund et al. (2012)</xref>, is simulated with a log-normal distribution: log<sub>2</sub>Λ<sub><italic>j</italic></sub> ∼ <italic>N</italic>(0, 1). The geometric mean of the total read counts across replicates was <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i015.jpg"/><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\approx }\sum _{i}{\mu }_{i}=1.0\times 1{0}^{7}$\end{document}</tex-math><mml:math id="mml-ieqn-159"><mml:mo>≈</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. Although variability in library size can have a significant effect on method performance (<xref rid="ref-12" ref-type="bibr">Lund et al., 2012</xref>), correlation between genes under simulation schemes like ours does not (<xref rid="ref-10" ref-type="bibr">Li et al., 2012</xref>). To create the treatment data the set of genes is first divided into a non-regulated subset, an up-regulated subset and a down-regulated subset. A regulating factor <italic>θ<sub>i</sub></italic>, <italic>i</italic> = 1, …, <italic>t</italic>, which is equal to 1 (non-regulated), &gt;1 (up-regulated) or &lt;1 (down-regulated) is then chosen from a suitable distribution. In the current work the regulated genes (1, 5, 10 or 15% of the total) were chosen randomly from the complete set of genes and split into up-regulated and down-regulated subsets of equal size. The regulating factor <italic>θ<sub>i</sub></italic> was chosen to be 2 + <italic>X<sub>i</sub></italic> for the up-regulated genes and (2+<italic>X<sub>i</sub></italic>)<sup>−1</sup> for the down-regulated genes where each <italic>X<sub>i</sub></italic> is an independent exponential random variable with mean 1. A treatment read count <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i016.jpg"/><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${K}_{i j}^{\mathrm{treat}}$\end{document}</tex-math><mml:math id="mml-ieqn-166"><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">treat</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is then generated independently for each isoform in each replicate from a NB distribution with mean <italic>θ<sub>i</sub></italic>Λ<sub><italic>j</italic></sub><italic>μ<sub>i</sub></italic>, unchanged dispersion <italic>ϕ<sub>i</sub></italic>, and a second independently chosen set of the library scaling factors Λ<sub><italic>j</italic></sub>.</p>
      <p>The method construction of synthetic data for <xref ref-type="fig" rid="fig-6">Fig. 6</xref> was identical except that for both control and treatment Poisson-inverse-gamma (PIG) data with the appropriate mean and overdispersion was generated in place of NB data.</p>
    </sec>
    <sec>
      <title>Software</title>
      <p>Our implementation of <italic>p</italic>-value and <italic>q</italic>-value calculations using the proposed method in the statistical package R (<xref rid="ref-17" ref-type="bibr">R Development Core Team, 2013</xref>) is provided in <xref ref-type="supplementary-material" rid="supp-2">File S2</xref>, and is currently being developed as a Bioconductor package called <monospace>Polyfit</monospace>, which can be downloaded from <uri xlink:href="https://github.com/cjb105/Polyfit">https://github.com/cjb105/Polyfit</uri>. In order to accomplish the ‘flagpole’ redistribution our implementation of the DESeq and edgeR algorithms differs from the original source code in that our function <monospace>pfNbinomTest()</monospace> replaces the <monospace>nbinomTest()</monospace> in DESeq and <monospace>pfExactTest()</monospace> replaces <monospace>exactTest()</monospace> in edgeR. The algorithm for calculating <italic>p</italic>-values and <italic>q</italic>-values from a redistributed nominal <italic>p</italic>-value histogram is implemented as the function <monospace>levelPValues()</monospace>.</p>
      <p>In the results described below the original nominal <italic>p</italic>-values are calculated from DESeq (<xref rid="ref-1" ref-type="bibr">Anders &amp; Huber, 2010</xref>) v1.14.0 with default settings including median of count ratio normalisation, and edgeR (<xref rid="ref-19" ref-type="bibr">Robinson, McCarthy &amp; Smyth, 2010</xref>) v3.4.0 with default settings and using TMM normalisation (<xref rid="ref-20" ref-type="bibr">Robinson &amp; Oshlack, 2010</xref>). The dispersion parameter in edgeR calculations is estimated using the ‘classic’ (as opposed to ‘glm’) routines (<xref rid="ref-18" ref-type="bibr">Robinson et al., 2013</xref>). The version of DESeq2 used is v1.2.5. The version of PoissonSeq (<xref rid="ref-10" ref-type="bibr">Li et al., 2012</xref>) used is v1.1.2. We have observed that this version of PoissonSeq has a potential problem in that the function <monospace>PS.Main()</monospace>, which returns <italic>p</italic>-values and <italic>q</italic>-values, has the undesirable feature that it resets the seed of the random number generator to the same value in subsequent calls. This may cause problems, for instance, if generating synthetic data and then calling <monospace>PS.Main()</monospace> repeatedly within a loop. The version of QuasiSeq (implemented as QLSpline) (<xref rid="ref-12" ref-type="bibr">Lund et al., 2012</xref>) used is v1.0-2. The default normalisations used in the four packages are all based on matching the distribution of read counts over a subset of genes which are likely not to be DE. Such methods have been demonstrated (<xref rid="ref-4" ref-type="bibr">Dillies et al., 2013</xref>) to be superior to normalisations which do not take into account the compositional nature of the data such as Total Count normalisation or Reads Per Kilobase per Million mapped reads (<xref rid="ref-14" ref-type="bibr">Mortazavi et al., 2008</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>Results and Discussion</title>
    <sec>
      <title>Synthetic data results</title>
      <p>We have tested the performance of seven R packages designed for detecting DE from RNA-seq data using synthetic datasets constructed as described in the “Materials and Methods”. Each synthetic dataset consists of NB distributed counts simulating <italic>n</italic> replicates of data in each of two conditions in which a specified percentage of genes are DE by at least a factor of 2.</p>
      <p><xref ref-type="fig" rid="fig-4">Figure 4</xref> shows estimates of the percentage of DE genes for the cases <italic>n</italic> = 2 and 4. The PoissonSeq estimate is obtained from the <italic>q</italic>-value, or estimated FDR corresponding to all genes being called DE. We observe that all methods underestimate the percentage of DE genes when this percentage is sufficiently large and, excepting QLSpline, overestimate the percentage DE when only few genes are differentially expressed. In general QLSpline and Polyfit-edgeR have the best performance, though the Polyfit methods show greater variation between samples, and QLSpline shows very high variation for <italic>n</italic> = 2 replicates. Note that the original packages DESeq and edgeR on which Polyfit is built do not give direct estimates of the percentage of DE genes.</p>
      <fig id="fig-4" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.576/fig-4</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Estimated percentage <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-576-i017.jpg"/><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$100(1-{\hat {\pi }}_{0})$\end{document}</tex-math><mml:math id="mml-ieqn-182"><mml:mn>100</mml:mn><mml:mfenced separators="" open="(" close=")"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfenced></mml:math></alternatives></inline-formula> of DE genes for synthetic data representing (A) <italic>n</italic> = 2 replicates and (B) <italic>n</italic> = 4 replicates of NB data for two different conditions with a specified percentage of genes differentially expressed by at least a factor of 2 in the second condition.</title>
          <p>Polyfit-DESeq and Polyfit-edgeR are labelled with the extension _ PF. Error bars are 90% confidence intervals and points are medians estimated from 100 independently generated datasets. To facilitate simulation of 100 datasets at each data point without undue computational cost, QLSpline was implemented with the option “Model = Poisson”.</p>
        </caption>
        <graphic xlink:href="peerj-02-576-g004"/>
      </fig>
      <p><xref ref-type="fig" rid="fig-5">Figures 5A</xref>, <xref ref-type="fig" rid="fig-5">5C</xref> and <xref ref-type="fig" rid="fig-5">5E</xref> show true and estimated FDRs (i.e., <italic>q</italic>-values) calculated from synthetic data over the complete range of <italic>p</italic>-values and a range of degrees of differential expression for <italic>n</italic> = 4 replicates of data for two different conditions for each of the seven methods: PoissonSeq (<xref rid="ref-10" ref-type="bibr">Li et al., 2012</xref>), DESeq and DESeq2 (<xref rid="ref-1" ref-type="bibr">Anders &amp; Huber, 2010</xref>), edgeR (<xref rid="ref-19" ref-type="bibr">Robinson, McCarthy &amp; Smyth, 2010</xref>), QLSpline with the option “Model = NegBin” (<xref rid="ref-12" ref-type="bibr">Lund et al., 2012</xref>) and our proposed variants Polyfit-DESeq and Polyfit-edgeR (labelled with the extension _ PF). By ‘true FDR’ we mean the quantity FP/(FP + TP) calculated from the known false postives and true positives out to a total number FP + TP of genes called as being differentially expressed by each package. This will change from package to package because the <italic>p</italic>-values are ordered differently. The true FDR curves do not differ noticeably on the scale of the plots between DESeq and Polyfit-DESeq or between edgeR and Polyfit-edgeR. By ‘estimated FDR’ we mean the reported “<italic>p</italic><sub>adj</sub>” value.</p>
      <p>The plots confirm the findings of <xref rid="ref-10" ref-type="bibr">Li et al. (2012)</xref> that PoissonSeq substantially corrects an overestimation of the true FDR by the Benjamini–Hochberg procedure used by edgeR, DESeq and DESeq2 as the significance point is raised to include a large number of genes called as being DE. The plots also show that this shortcoming of packages using Benjamini–Hochberg is rectified by the adapted Storey–Tibshirani procedure which brings Polyfit-edgeR and Polyfit-DESeq into close agreement with PoissonSeq and with the true FDR curves. QLSpline, which uses a method similar to Storey–Tibshirani due to <xref rid="ref-15" ref-type="bibr">Nettleton et al. (2006)</xref>, is also in close agreement with the true FDR over the entire range of the plot.</p>
      <fig id="fig-5" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.576/fig-5</object-id>
        <label>Figure 5</label>
        <caption>
          <title>True (solid curves) and estimated (broken curves) FDRs for <italic>n</italic> = 4 replicates of synthetic negative binomial data in each of two conditions with 5, 10 and 15% genes DE in the second conditon.</title>
          <p>Plots (B), (D) and (F) are expanded views of the plots (A), (C) and (E) respectively covering a subset of genes up to a significance point roughly corresponding to the number of DE genes.</p>
        </caption>
        <graphic xlink:href="peerj-02-576-g005"/>
      </fig>
      <p><xref ref-type="supplementary-material" rid="supp-1">Figures S1</xref>–<xref ref-type="supplementary-material" rid="supp-1">S20</xref> show analogous plots for synthetic datasets created with 1, 5, 10 and 15% of genes DE for <italic>n</italic> = 2, 3, 4, 6 and 10 replicates of data in each of two conditions. For each set of parameter values three independently generated datasets are shown to give an indication of the variation inherent in these simulations. In general we find that provided at least 5% of genes are DE, the Polyfit addition to edgeR and DESeq brings the FDR curves into closer agreement with PoissonSeq and QLSpline and with the true FDR over most of the range of the left-hand plots (A), (C) and (E) of <xref ref-type="fig" rid="fig-5">Figs. 5</xref> and <xref ref-type="fig" rid="fig-6">6</xref> and <xref ref-type="supplementary-material" rid="supp-1">Figs. S6</xref>–<xref ref-type="supplementary-material" rid="supp-1">S20</xref>. The agreement between the estimated and true FDRs improves with the number of simulated biological replicates.</p>
      <p>An issue not examined in the left-hand plots described above or in the simulations of <xref rid="ref-10" ref-type="bibr">Li et al. (2012)</xref> is the relative performance of different packages and methods for the subset of genes called as being most significant. Each of the right-hand plots (B), (D) and (F) of <xref ref-type="fig" rid="fig-5">Fig. 5</xref> and of <xref ref-type="supplementary-material" rid="supp-1">Figs. S1</xref>–<xref ref-type="supplementary-material" rid="supp-1">S20</xref> is an expanded portion of the neighbouring left hand plot covering the portion of the FDR curves up to a significance point roughly corresponding to the number of DE genes in each simulation: out of a total of ∼46,446 genes, this corresponds to ∼460, ∼2,300, ∼4,600 and ∼7,000 genes for 1, 5, 10 and 15% DE respectively.</p>
      <p>Immediately noticeable from these plots are two disadvantages of PoissonSeq, namely that for the genes called as being most significantly DE, the true FDR is consistently higher than for the remaining six methods, and that the true FDR is under-reported by PoissonSeq. This is observed to occur in every case plotted in the right-hand plots (B), (D) and (F) of <xref ref-type="fig" rid="fig-5">Fig. 5</xref> and of <xref ref-type="supplementary-material" rid="supp-1">Figs. S1</xref>–<xref ref-type="supplementary-material" rid="supp-1">S20</xref> for at least half the range plotted. By contrast, for <italic>n</italic> = 10 replicates, the remaining six methods show an almost zero FDR over half the range plotted irrespective of the percentage of genes DE.</p>
      <p>An important point to note is that the choice of NB distribution to construct simulated data may favour packages based on NB models, namely DESeq, DESeq2 and edgeR, over packages not based on NB models, namely PoissonSeq. Accordingly we show in <xref ref-type="fig" rid="fig-6">Fig. 6</xref> analogous simulations using Poisson-inverse-Gaussian (PIG) data, which is one of the class of Poisson-Tweedie distributions often used to simulate overdispersed integer-count data. There is evidence from RNA-seq data with very large numbers of replicates that the PIG distribution may be at least as good a fit as NB for many of the genes within the transcriptome (<xref rid="ref-7" ref-type="bibr">Esnaola et al., 2013</xref>). This distribution is closer to Poisson and should therefore not discriminate as much against the package PoissonSeq as the NB distribution. However, <xref ref-type="fig" rid="fig-6">Fig. 6</xref> indicates that the relative performance of the packages tested with synthetic PIG data is essentially the same as with NB data.</p>
      <fig id="fig-6" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.576/fig-6</object-id>
        <label>Figure 6</label>
        <caption>
          <title>The same as <xref ref-type="fig" rid="fig-5">Fig. 5</xref>, except that the synthetic data is generated from a Poisson-inverse-Gaussian distribution.</title>
        </caption>
        <graphic xlink:href="peerj-02-576-g006"/>
      </fig>
      <p>Considering the right-hand plots (B), (D) and (F) of <xref ref-type="fig" rid="fig-5">Figs. 5</xref>, <xref ref-type="fig" rid="fig-6">6</xref> and of <xref ref-type="supplementary-material" rid="supp-1">Figs. S1</xref>–<xref ref-type="supplementary-material" rid="supp-1">S20</xref> in particular, it is clear that the best performing method is QLSpline, for which the estimated FDR closely tracks the true FDR over the whole range of <italic>p</italic>-values in all cases where the number of replicates is at least 4. Similarly good results are also observed for <italic>n</italic> = 3 replicates when the percentage of DE genes is &gt;10%. For <italic>n</italic> = 2 replicates QLSpline overestimates the true FDR, whereas all other methods generally have a tendency to underestimate the true FDR.</p>
      <p>The ability of edgeR, DESeq and their Polyfit extensions to estimate the FDR for the genes called as being most significantly DE varies according to the level of differential expression in the synthetic data and the number of simulated biological replicates. Observations from the FDR plots of our simulations out to a significance point corresponding to half the number of truly DE genes are summarised in <xref ref-type="fig" rid="fig-7">Fig. 7</xref>. At low levels of differential expression (≲ 5% DE) or small numbers of simulated biological replicates (<italic>n</italic> ≲ 4) all four methods considered in <xref ref-type="fig" rid="fig-7">Fig. 7</xref> under-report the true FDR out to the significance point considered in this table. This observation is consistent with the findings reported in Fig. 5B of <xref rid="ref-25" ref-type="bibr">Soneson &amp; Delorenzi (2013)</xref>. The Polyfit addition to edgeR and DESeq tends to lower the estimated FDR, thus exacerbating this problem.</p>
      <fig id="fig-7" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.576/fig-7</object-id>
        <label>Figure 7</label>
        <caption>
          <title>Summary of performance of the packages edgeR, DESeq and their Polyfit extensions in estimating the FDR for genes out to a significance point corresponding to half the number of truly DE genes.</title>
          <p>(See plots (B), (D) and (F) in <xref ref-type="fig" rid="fig-5">Fig. 5</xref> and analogous plots in <xref ref-type="supplementary-material" rid="supp-1">Figs. S1</xref>–<xref ref-type="supplementary-material" rid="supp-1">S20</xref>). Experiments were done with <italic>n</italic> = 2, 4, 6 and 10 simulated replicates of synthetic data in which 1, 5, 10 and 15% of genes are DE.</p>
        </caption>
        <graphic xlink:href="peerj-02-576-g007"/>
      </fig>
      <p>For higher levels of differential expression Polyfit proves to be successful for DESeq, but not edgeR. If the level of DE is ≳ 10% and <italic>n</italic> ≳ 4 simulated biological replicates, DESeq over-reports the FDR over almost the whole range of genes. Polyfit attempts to correct this over-reporting, giving an accurate estimate of the true FDR for <italic>n</italic> ≳ 6 replicates. However, in the case of edgeR, Polyfit often overcorrects, leading to a more severe underestimate of the true FDR for those genes called significantly DE; see <xref ref-type="fig" rid="fig-7">Fig. 7</xref>. The problem is less severe for higher numbers of replicates (<italic>n</italic> ≳ 10), for which there is very little difference between edgeR and Polyfit-edgeR</p>
      <p>Polyfit’s over-correction arises because the quadratic fit is unable to capture the small spike at the left-hand end of the histogram of non-DE genes which is visible in shaded portion of <xref ref-type="fig" rid="fig-1">Fig. 1A</xref>, and which has been observed to occur generally in histograms of non-DE genes for both DESeq and edgeR (<xref rid="ref-23" ref-type="bibr">Robles et al., 2012</xref>). This problem is particularly acute for extremely low levels of differential expression, in which case the quadratic extrapolation means that almost the entire signal of reported differential expression comes from the spurious left-hand spike (see <xref ref-type="fig" rid="fig-2">Figs. 2A</xref>, <xref ref-type="fig" rid="fig-2">2B</xref>), thus limiting the effectiveness of the method in this limit. In general, the performance of DESeq2 is very similar to that of edgeR, which is not surprising given that both packages use similar methods to estimate parameters of the NB distribution for each gene.</p>
      <p>In order to check whether our findings are specific to the overdispersion profile of the Pickrel dataset, we have also analysed synthetic datasets generated with mean and overdispersion parameters estimated from the 10 C57BL/6J biological replicates of the Bottomly dataset (<xref rid="ref-3" ref-type="bibr">Bottomly et al., 2011</xref>) described in the Biological data results section below. <xref ref-type="supplementary-material" rid="supp-1">Figures S21</xref> and <xref ref-type="supplementary-material" rid="supp-1">S22</xref> show plots of FDRs for <italic>n</italic> = 4 and 10 simulated biological replicates respectively with 5, 10 and 15% DE genes. We observe behaviour consistent with that of the Pickrell data, namely that in the right-hand plots which show the genes which are called as being most significantly DE, (i) PoissonSeq produces higher number of false discoveries than the other packages, (ii) QLSpline generally provides the most accurate estimate of the FDR, and (iii) the Polyfit extension does not improve edgeR, which has a tendency to under-report the FDR but it does generally improve DESeq which has a tendency to over-report the FDR.</p>
      <p>In <xref ref-type="table" rid="table-1">Table 1</xref> we list the relative CPU time used by each package for the <italic>n</italic> = 4, 10% synthetic dataset in <xref ref-type="fig" rid="fig-5">Fig. 5</xref>, using DESeq as a reference. A similar behaviour is observed for the other synthetic datasets analysed. We see that good performance of QLSpline in terms of its ability to estimate FPRs accurately is counterbalanced by a poor performance in terms of CPU time. Note also that the extra overheads imposed by the Polyfit extensions are minor.</p>
      <table-wrap id="table-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.576/table-1</object-id>
        <label>Table 1</label>
        <caption>
          <title>Relative CPU times for each package to process the <italic>n</italic> = 4, 10% synthetic dataset in <xref ref-type="fig" rid="fig-5">Fig. 5</xref>.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-02-576-g009"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Package</th>
                <th rowspan="1" colspan="1">CPU time</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">PoissonSeq</td>
                <td rowspan="1" colspan="1">0.38</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">QLSpline</td>
                <td rowspan="1" colspan="1">16.45</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">edgeR</td>
                <td rowspan="1" colspan="1">0.28</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Polyfit-edgeR</td>
                <td rowspan="1" colspan="1">0.32</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">DESeq</td>
                <td rowspan="1" colspan="1">1.00</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Polyfit-DESeq</td>
                <td rowspan="1" colspan="1">1.07</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">DESeq2</td>
                <td rowspan="1" colspan="1">0.82</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>In summary, none of the packages considered was able to accurately estimate the true FDR for <italic>n</italic> = 2 vs. 2 simulated replicates over the range of most significantly called genes up to a portion of the total number of genes equal to the percentage DE. For <italic>n</italic> &gt; 4 vs. 4 replicates, the overall best performing method (ignoring CPU time) is QLSpline, which for these synthetically generated data accurately estimates the true FDR irrespective of the true percentage of DE genes or the significance point chosen. The next best performing packages are DESeq2, edgeR and the Polyfit extension of DESeq. The Polyfit extension to DESeq will improve the estimate of the true FDR over the complete range of significance points provided the number of replicates and percentage of differentially expressed genes is sufficiently high (≳ 6). We find that edgeR and DESeq2 generally outperform DESeq over the parameter range considered and that the Polyfit extension is effective in correcting an overestimation of the FDR when applied to DESeq, but not edgeR.</p>
    </sec>
    <sec>
      <title>Biological data results</title>
      <p>Two biological RNA-seq datasets were considered. The first, which we will refer to as the ‘fly data’, originates from experiments by Wilczynski, Liu, Delhomme and Furlong who made their data available to <xref rid="ref-1" ref-type="bibr">Anders &amp; Huber (2010)</xref> ahead of publication for evaluating DESeq, who include it in the supplementary material to their paper. The data consists of <italic>n</italic> = 2 biological replicates of ‘control’ fly-embryo RNA and 2 replicates of ‘treatment’ RNA in which one gene was engineered to be over-expressed. For our analysis the original dataset of 17,605 genes was culled to remove genes with an average across all replicates in both conditions of one count or less, leaving 13,258 genes. The second dataset, which we refer to as the ‘Bottomly data’, consists of RNA-seq data from 21 adult mouse brains: 10 biological replicates the C57BL/6J strain and 11 of the DBA/2J strain (<xref rid="ref-3" ref-type="bibr">Bottomly et al., 2011</xref>). This dataset is available from <uri xlink:href="http://bowtie-bio.sourceforge.net/recount/">http://bowtie-bio.sourceforge.net/recount/</uri>. We culled the full set of 36,536 genes to remove genes with an average across all replicates in both conditions of one count or less, leaving 11,123 genes. For both sets of data plots of estimated FDRs against the number of genes called as being DE for each of the seven methods are given in <xref ref-type="fig" rid="fig-8">Fig. 8</xref>.</p>
      <fig id="fig-8" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.576/fig-8</object-id>
        <label>Figure 8</label>
        <caption>
          <title>Estimated FDRs for (A) the fly data consisting of <italic>n</italic> = 2 vs. 2 biological replicates of fly-embryo RNA and a total of 13,258 genes, and (B) the Bottomly data consisting of <italic>n</italic> = 10 vs. 11 biological replicates of mouse RNA and a total of 11,123 genes.</title>
          <p>The right hand plots are expanded views of the first few thousand called genes.</p>
        </caption>
        <graphic xlink:href="peerj-02-576-g008"/>
      </fig>
      <p>Under the assumption that a fraction <italic>π</italic><sub>0</sub> of genes satisfy the null hypothesis of no differential expression, PoissonSeq, QLSpline, Polyfit-edgeR and Polyfit-DESeq provide estimates of the fraction 1−<italic>π</italic><sub>0</sub> of DE genes, summarised in <xref ref-type="table" rid="table-2">Table 2</xref>.</p>
      <p>We consider first the fly dataset. Consistent with the observations of <xref rid="ref-12" ref-type="bibr">Lund et al. (2012)</xref>, the fraction of genes reported as DE varies considerably across methods for this dataset. <xref ref-type="fig" rid="fig-4">Figure 4</xref> suggests that for <italic>n</italic> = 2 replicates the reported fractions are underestimates of the true fraction of DE genes, and that QLSpline’s estimates of <italic>π</italic><sub>0</sub> are highly variable. With this in mind we compare the fly data FDR curves in <xref ref-type="fig" rid="fig-8">Fig. 8A</xref> with the results for <italic>n</italic> = 2 synthetic data with 15% DE genes, <xref ref-type="supplementary-material" rid="supp-1">Fig. S16</xref>. Certain similarities are apparent between the real and synthetic data. In both cases one observes that the edgeR and DESeq curves are higher than their Polyfit counterparts, and that the estimated PoissonSeq and QLSpline FDRs rise sharply compared with the other methods for the first few hundreds called genes. The true FDR curves in <xref ref-type="supplementary-material" rid="supp-1">Fig. S16</xref> indicate that the FDRs are likely to be overestimated by QLSpline and underestimated by the remaining five methods for the first few hundred most significant genes called DE in the fly data. In particular, the almost zero FDRs reported by DESeq2 and edgeR, DESeq and their Polyfit extensions for the first hundred genes are likely to be overly optimistic estimates.</p>
      <table-wrap id="table-2" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.576/table-2</object-id>
        <label>Table 2</label>
        <caption>
          <title>Estimates of the fraction 1−<italic>π</italic><sub>0</sub> of all genes which are DE for the fly and Bottomly datasets.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-02-576-g010"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th rowspan="1" colspan="1">Fly</th>
                <th rowspan="1" colspan="1">Bottomly</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">PoissonSeq</td>
                <td rowspan="1" colspan="1">0.153</td>
                <td rowspan="1" colspan="1">0.322</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">QLSpline</td>
                <td rowspan="1" colspan="1">0.281</td>
                <td rowspan="1" colspan="1">0.323</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Polyfit-edgeR</td>
                <td rowspan="1" colspan="1">0.144</td>
                <td rowspan="1" colspan="1">0.237</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Polyfit-DESeq</td>
                <td rowspan="1" colspan="1">0.116</td>
                <td rowspan="1" colspan="1">0.104</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Similarly we compare the FDR curves in <xref ref-type="fig" rid="fig-8">Fig. 8B</xref> for the Bottomly data with the results for <italic>n</italic> = 10 synthetic data with 15% DE genes, namely <xref ref-type="supplementary-material" rid="supp-1">Figs. S20</xref> and <xref ref-type="supplementary-material" rid="supp-1">S22</xref>. Once again we observe consistency with the synthetic data results in that the Polyfit addition has reduced the estimate of the FDR, and that PoissonSeq estimates a higher FDR than the other methods for the first few hundred called genes. However, for the real data the Polyfit procedure has not pulled the right hand end of the FDR curves into close agreement, and consequently there is a broad range of estimates of the fraction of DE genes. This discrepancy with the synthetic data may result from a shortcoming of the idealised synthetic data construction which divides the genes into an absolutely non-DE fraction <italic>π</italic><sub>0</sub> and a remaining fraction 1−<italic>π</italic><sub>0</sub> which are DE by at least a factor of 2. In reality all genes may be DE to some extent, with a degree of differentiation ranging continuously from near-zero for the majority of genes to considerably non-zero for a small minority of genes. Under these conditions the histogram of <italic>p</italic>-values does not necessarily split unambiguously into DE and non-DE components. Note also, that for the first 200 called genes, all methods except PoissonSeq report a FDR of almost zero. The evidence in <xref ref-type="supplementary-material" rid="supp-1">Figs. S20</xref> and <xref ref-type="supplementary-material" rid="supp-1">S22</xref> from the synthetic data is that this may indeed be an accurate representation of the true FDR.</p>
      <p><xref ref-type="supplementary-material" rid="supp-1">Figures S25</xref> and <xref ref-type="supplementary-material" rid="supp-1">S26</xref> show Venn diagrams of the genes which are called DE by QLSpline, Polyfit-edgeR and Polyfit-DESeq up to cutoffs of 100 and 500 most significantly called genes for each of the two datasets. In each case the degree of overlap is reasonably good, with approximately 75% of genes called by any one package common to all three methods.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>We have surveyed the effectiveness of a number of software packages designed for two-class detection of differential expression from RNA-seq data via the use of synthetically generated datasets similarly to <xref rid="ref-25" ref-type="bibr">Soneson &amp; Delorenzi (2013)</xref>. The packages, edgeR (<xref rid="ref-19" ref-type="bibr">Robinson, McCarthy &amp; Smyth, 2010</xref>), DESeq (<xref rid="ref-1" ref-type="bibr">Anders &amp; Huber, 2010</xref>), DESeq2 (<xref rid="ref-11" ref-type="bibr">Love, Anders &amp; Huber, 2013</xref>), PoissonSeq (<xref rid="ref-10" ref-type="bibr">Li et al., 2012</xref>) and the QLSpline implementation of QuasiSeq (<xref rid="ref-12" ref-type="bibr">Lund et al., 2012</xref>) are all based on statistical models of over-dispersed Poisson data, which, in the case of edgeR and DESeq is expicitly modelled as NB data. Our survey uses synthetic NB data with a range of parameters estimated from the Pickrell dataset (<xref rid="ref-16" ref-type="bibr">Pickrell et al., 2010</xref>) to assess the FDR achieved and the ability of each method to accurately estimate the FDR.</p>
    <p>To avoid clutter on the graphs we did not include the other methods given in <xref rid="ref-25" ref-type="bibr">Soneson &amp; Delorenzi (2013)</xref>, namely NBPSeq, TSPM, baySeq, EBSeq, NOISeq, SAMSeq, ShrinkSeq, voom (+ limma) and vst(+ limma) as the comparisons of these approaches with edgeR and DESeq are adequately covered there. We note that <xref rid="ref-25" ref-type="bibr">Soneson &amp; Delorenzi (2013)</xref> report that good FDR control was achieved by vst(+ limma). This is a hybrid method constructed by combining the variance-stabilising transformation provided by DESeq with a linear fit to the resulting nomalised counts using limma. Unfortunately the code given in the Supplementary material to <xref rid="ref-25" ref-type="bibr">Soneson &amp; Delorenzi (2013)</xref> to perform these combined tasks does not function if DESeq2 is loaded as the R function <monospace>getVarianceStabilizedData()</monospace> has been overwritten with a more recent version which is incompatible with DESeq. Furthermore, we have found in test simulations that DESeq2 has a similar performance to vst(+ limma), but without the complication of being a hybrid of distinct packages.</p>
    <p>We have also introduced an add-on to the NB-based packages edgeR and DESeq for two-class detection of differential expression called Polyfit which achieves two of the advantages associated with the recently introduced packages PoissonSeq and QuasiSeq. Firstly, assuming that the transcriptome partitions unambiguously into a fraction <italic>π</italic><sub>0</sub> of non-DE genes and a fraction 1−<italic>π</italic><sub>0</sub> of DE genes, Polyfit gives an estimate of <italic>π</italic><sub>0</sub> (that is an empirical extension of the Storey–Tibshirani algorithm (<xref rid="ref-27" ref-type="bibr">Storey &amp; Tibshirani, 2003</xref>)) which performs at least as well as PoissonSeq and comparably with QLSpline in experiments with synthetic data (see <xref ref-type="fig" rid="fig-4">Fig. 4</xref>). Secondly, by adapting the Storey–Tibshirani algorithm Polyfit gives a more accurate estimate of the FDR than the Benjamini–Hochberg procedure used by edgeR and DESeq over the central and right-hand sections of the <italic>p</italic>-value spectrum (see the left-hand plots (A), (C) and (E) in <xref ref-type="fig" rid="fig-5">Figs. 5</xref> and <xref ref-type="supplementary-material" rid="supp-1">S1</xref>–<xref ref-type="supplementary-material" rid="supp-1">S20</xref>).</p>
    <p>Of more immediate interest to practising biologists is the software’s performance for the genes called as being most significant, that is, the few hundred or so genes with the lowest <italic>p</italic>-values (see the right-hand plots (B), (D) and (F) in <xref ref-type="fig" rid="fig-5">Figs. 5</xref> and <xref ref-type="supplementary-material" rid="supp-1">S1</xref>–<xref ref-type="supplementary-material" rid="supp-1">S20</xref>, which are an expanded view of the left hand plots). Our experiments with synthetic NB data indicate that for these genes the best performing method of those tested is QLSpline, both in the sense that the achieved FDR is among the lowest, and that provided at least 4 replicates are used in each condition the <italic>q</italic>-values quoted accurately reflect the true FDR over the whole range of <italic>p</italic>-values. The performance of QLSpline is less consistent for <italic>n</italic> = 3, but still better than the other methods. The worst performing method is PoissonSeq, which, for the most significantly called genes, consistently achieves high but under-reported FDRs. As a general rule we would not recommend experimental designs with <italic>n</italic> ≤ 2 replicates in each condition as none of the methods tested is able to estimate the FDR consistently or accurately.</p>
    <p>The performance of edgeR and DESeq lies somewhere between these extremes of QLSpline and PoissonSeq. The performance of DESeq2 is very similar to edgeR, probably due to the fact that both packages use similar methods to estimate parameters of the model NB distribution. For the most significantly called genes, the true FDR of edgeR and DESeq is comparable with that of QLSpline, and very low compared with PoissonSeq. Because the Polyfit extension shifts the reported <italic>p</italic>-value but makes very little difference to the order of the <italic>p</italic>-values, except for a few genes with very low counts, it leaves the true FDR virtually unchanged.</p>
    <p>The main intention of developing Polyfit was to improve the calculation of <italic>p</italic>-values and <italic>q</italic>-values (the estimate of the FDR) reported by DESeq and edgeR. As explained in the “Materials and Methods”, Polyfit achieves a close-to-uniform distribution of <italic>p</italic>-values for the non-DE genes. Polyfit’s ability to estimate the FDR for the genes called as being most significantly DE is summarised in <xref ref-type="fig" rid="fig-7">Fig. 7</xref>. In their original forms, for low numbers of simulated biological replicates in each condition edgeR and DESeq underestimate the true FDR for the genes called as being most significantly DE. The Polyfit extension tends to lower the estimated FDR thus exacerbating this problem. On the other hand, for higher numbers of simulated biological replicates DESeq overestimates the true FDR and the Polyfit extension can give a more accurate estimate of the FDR if sufficiently many biological replicates are used. Our numerical simulations indicate that with 15% of genes truly DE, Polyfit will give an improved and acceptably accurate estimate of the true FDR for DESeq with <italic>n</italic> ≳ 6 replicates in each condition. Although this exceeds the number of replicates used in many current RNA-seq experiments, we note that the cost of sequencing is continually decreasing. Furthermore, simulations with synthetic data by <xref rid="ref-23" ref-type="bibr">Robles et al. (2012)</xref> demonstrate that sacrificing sequencing depth to process more replicates by multiplexing leads to considerable gains in the power to detect DE. Unfortunately, for the reasons detailed in the “Synthetic Data Results” the Polyfit procedure fails to improve the edgeR estimate of the FDR over the range of genes called as being most significant.</p>
    <p>We have also applied all six methods to two real biological datasets, the ‘fly data’ reported in <xref rid="ref-1" ref-type="bibr">Anders &amp; Huber (2010)</xref> with <italic>n</italic> = 2 replicates in each condition and the ‘Bottomly’ mouse-brain data (<xref rid="ref-3" ref-type="bibr">Bottomly et al., 2011</xref>) with <italic>n</italic> = 10 and 11 replicates respectively in the two conditions. The relative differences in reported FDRs between the various methods is observed to follow qualitatively similar behaviour for real biological data as for the synthetic data (see <xref ref-type="fig" rid="fig-8">Fig. 8</xref>), and the overlap between the first few hundred genes called as being significant between QLSpline, Polyfit edgeR Polyfit DESeq is approximately 75% (see <xref ref-type="supplementary-material" rid="supp-1">Figs. S21</xref> and <xref ref-type="supplementary-material" rid="supp-1">S22</xref>).</p>
    <p>Based on the above simulations, if CPU time is not an issue (see <xref ref-type="table" rid="table-1">Table 1</xref>), we would in the first instance recommend the QLSpline implementation of QuasiSeq with an experimental design having no less than <italic>n</italic> = 4 replicates in each condition. However, in the interests of confirming experimental analysis with more than one package, and given the cost benefits of multiplexing, we would further recommend also using edgeR, DESeq2, or the Polyfit extension to DESeq with at least 6 biological replicates in each condition. <def-list id="dl1"><title>Abbreviations</title><def-item><term>DE</term><def><p>differentially expressed</p></def></def-item><def-item><term>FDR</term><def><p>false discovery rate</p></def></def-item><def-item><term>NB</term><def><p>negative binomial</p></def></def-item><def-item><term>PIG</term><def><p>Poisson-inverse-Gaussian</p></def></def-item><def-item><term>RNA-seq</term><def><p>RNA-sequencing</p></def></def-item></def-list></p>
  </sec>
  <sec sec-type="supplementary-material" id="supplemental-information">
    <title>Supplemental Information</title>
    <supplementary-material content-type="local-data" id="supp-1">
      <object-id pub-id-type="doi">10.7717/peerj.576/supp-1</object-id>
      <label>File S1</label>
      <caption>
        <title>Supplementary figures S1–S27</title>
      </caption>
      <media xlink:href="peerj-02-576-s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="supp-2">
      <object-id pub-id-type="doi">10.7717/peerj.576/supp-2</object-id>
      <label>File S2</label>
      <caption>
        <title>R code for the Polyfit software, together with, as an example, the code used for generating <xref ref-type="fig" rid="fig-5">Fig. 5</xref>, together with a data file of mean and overdispersons used for generating the various synthetic data sets used in this paper</title>
      </caption>
      <media xlink:href="peerj-02-576-s002.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn id="conflict-1" fn-type="con">
        <p>The authors declare there are no competing interests.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn id="contribution-1" fn-type="con">
        <p><xref ref-type="contrib" rid="author-1">Conrad J. Burden</xref> conceived and designed the experiments, analyzed the data, contributed analysis tools, wrote the paper, prepared figures and tables, reviewed drafts of the paper.</p>
      </fn>
      <fn id="contribution-2" fn-type="con">
        <p><xref ref-type="contrib" rid="author-2">Sumaira E. Qureshi</xref> analyzed the data, prepared figures and tables, reviewed drafts of the paper.</p>
      </fn>
      <fn id="contribution-3" fn-type="con">
        <p><xref ref-type="contrib" rid="author-3">Susan R. Wilson</xref> conceived and designed the experiments, reviewed drafts of the paper.</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Anders &amp; Huber (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biology</source>
        <issue>10</issue>
        <year>2010</year>
        <volume>11</volume>
        <elocation-id>e576</elocation-id>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Benjamini &amp; Hochberg (1995)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>Proceedings of the Royal Statistical Society Series B</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Bottomly et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bottomly</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>NAR</given-names>
          </name>
          <name>
            <surname>Hunter</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Darakjian</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kawane</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Buck</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Searles</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Mooney</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McWeeney</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Hitzemann</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Evaluating gene expression in C57BL/6J and DBA/2J mouse striatum using RNA-seq and microarrays</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <elocation-id>e576</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0017820</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Dillies et al. (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dillies</surname>
            <given-names>M-A</given-names>
          </name>
          <name>
            <surname>Rau</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aubert</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hennequet-Antier</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jeanmougin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Servant</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Keime</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Marot</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Castel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Estelle</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Guernec</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jagla</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Jouneau</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Laloë</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Le Gall</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schaëffer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Le Crom</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Guedj</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jaffrézic</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive evaluation of normalization methods for illumina high-throughput RNA sequencing data analysis</article-title>
        <source>Briefings in Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>671</fpage>
        <lpage>683</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbs046</pub-id>
        <pub-id pub-id-type="pmid">22988256</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Dunne, Pawitan &amp; Doody (1996)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dunne</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pawitan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Doody</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Two-sided <italic>P</italic>-values from discrete asymmetric distributions based on uniformly most powerful unbiased tests</article-title>
        <source>The Statistician</source>
        <issue>4</issue>
        <year>1996</year>
        <volume>45</volume>
        <fpage>397</fpage>
        <lpage>405</lpage>
        <pub-id pub-id-type="doi">10.2307/2988542</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Efron (2004)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Large-scale simultaneous hypothesis testing: the choice of a null hypothesis</article-title>
        <source>Journal of the American Statistical Association</source>
        <issue>465</issue>
        <year>2004</year>
        <volume>99</volume>
        <fpage>96</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1198/016214504000000089</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>Esnaola et al. (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Esnaola</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Puig</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Castelo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>A flexible count data model to fit the wide diversity of expression profiles arising from extensively replicated RNA-seq experiments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>254</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-254</pub-id>
        <pub-id pub-id-type="pmid">23965047</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>Jin &amp; Cai (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Estimating the null and the proportion of nonnull effects in large-scale multiple comparisons</article-title>
        <source>Journal of the American Statistical Association</source>
        <year>2007</year>
        <volume>102</volume>
        <fpage>495</fpage>
        <lpage>506</lpage>
        <pub-id pub-id-type="doi">10.1198/016214507000000167</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>Langmead et al. (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short dna sequences to the human genome</article-title>
        <source>Genome Biology</source>
        <issue>3</issue>
        <year>2009</year>
        <volume>10</volume>
        <elocation-id>e576</elocation-id>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Li et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Witten</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Johnstone</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Normalization, testing, and false discovery rate estimation for RNA-sequencing data</article-title>
        <source>Biostatistics</source>
        <issue>3</issue>
        <year>2012</year>
        <volume>13</volume>
        <fpage>523</fpage>
        <lpage>538</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxr031</pub-id>
        <pub-id pub-id-type="pmid">22003245</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Love, Anders &amp; Huber (2013)</label>
      <element-citation publication-type="other">
        <person-group>
          <name>
            <surname>Love</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <year>2013</year>
        <comment>Differential analysis of count data—the DESeq2 package. <italic>Available at <uri xlink:href="http://www.bioconductor.org/packages/2.13/bioc/vignettes/deseq2/inst/doc/des.pdf">http://www.bioconductor.org/packages/2.13/bioc/vignettes/deseq2/inst/doc/des.pdf</uri></italic></comment>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Lund et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lund</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nettleton</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Detecting differential expression in RNA- sequence data using quasi-likelihood with shrunken dispersion estimates</article-title>
        <source>Statistical Applications in Genetics and Molecular Biology</source>
        <issue>5</issue>
        <year>2012</year>
        <volume>11</volume>
        <comment>Article 8</comment>
        <pub-id pub-id-type="doi">10.1515/1544-6115.1826</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Marioni et al. (2008)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mane</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gilad</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RNA-seq: an assessment of technical reproducability and comparison with gene expression arrays</article-title>
        <source>Genome Research</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1509</fpage>
        <lpage>1517</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.079558.108</pub-id>
        <pub-id pub-id-type="pmid">18550803</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>Mortazavi et al. (2008)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>McCue</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schaeffer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Mapping and quantifying mammilian transcriptomes by RNA-seq</article-title>
        <source>Nature Methods</source>
        <issue>7</issue>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1226</pub-id>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>Nettleton et al. (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nettleton</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Caldo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wose</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Estimating the number of true null hypotheses from a histogram of values</article-title>
        <source>Journal of Agricultural, Biological and Environmental Statistics</source>
        <issue>3</issue>
        <year>2006</year>
        <volume>11</volume>
        <fpage>337</fpage>
        <lpage>356</lpage>
        <pub-id pub-id-type="doi">10.1198/108571106X129135</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-16">
      <label>Pickrell et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pickrell</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Pai</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Degner</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Engelhardt</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Nkadori</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Veyrieras</surname>
            <given-names>J-B</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gilad</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>Understanding mechanisms underlying human gene expression variation with RNA sequencing</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>464</volume>
        <fpage>768</fpage>
        <lpage>772</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08872</pub-id>
        <pub-id pub-id-type="pmid">20220758</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-17">
      <label>R Development Core Team (2013)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>
            <institution>R Development Core Team</institution>
          </collab>
        </person-group>
        <source>R: a language and environment for statistical computing, v3.0.2</source>
        <year>2013</year>
        <publisher-loc>Vienna</publisher-loc>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
      </element-citation>
    </ref>
    <ref id="ref-18">
      <label>Robinson et al. (2013)</label>
      <element-citation publication-type="other">
        <person-group>
          <name>
            <surname>Robinson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>2013</year>
        <comment>edgeR: differential expression analysis of digital expression data user’s guide. <italic>Available at <uri xlink:href="http://www.bioconductor.org/packages/release/bioc/vignettes/edger/inst/doc/edgerusersguide.pdf">http://www.bioconductor.org/packages/release/bioc/vignettes/edger/inst/doc/edgerusersguide.pdf</uri></italic></comment>
      </element-citation>
    </ref>
    <ref id="ref-19">
      <label>Robinson, McCarthy &amp; Smyth (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-20">
      <label>Robinson &amp; Oshlack (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>
        <source>Genome Biology</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-3-r25</pub-id>
        <pub-id pub-id-type="pmid">20196867</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-21">
      <label>Robinson &amp; Smyth (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Moderated statistical tests for assessing differences in tag abundance</article-title>
        <source>Bioinformatics</source>
        <issue>21</issue>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2881</fpage>
        <lpage>2887</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm453</pub-id>
        <pub-id pub-id-type="pmid">17881408</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-22">
      <label>Robinson &amp; Smyth (2008)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Small-sample estimation of negative binomial dispersion, with applications to SAGE data</article-title>
        <source>Biostatistics</source>
        <issue>2</issue>
        <year>2008</year>
        <volume>9</volume>
        <fpage>321</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxm030</pub-id>
        <pub-id pub-id-type="pmid">17728317</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-23">
      <label>Robles et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robles</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Qureshi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stephen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Burden</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Efficient experimental design and analysis strategies for the detection of differential expression using rna-sequencing</article-title>
        <source>BMC Genomics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>484</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-13-484</pub-id>
        <pub-id pub-id-type="pmid">22985019</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-24">
      <label>Smyth (2004)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Linear models and empirical bayes methods for assessing differential expression in microarray experiments</article-title>
        <source>Statistical Applications in Genetics and Molecular Biology</source>
        <year>2004</year>
        <volume>3</volume>
        <comment>Article 3</comment>
        <pub-id pub-id-type="doi">10.2202/1544-6115.1027</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-25">
      <label>Soneson &amp; Delorenzi (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Delorenzi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A comparison of methods for differential expression analysis of RNA-seq data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>91</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-91</pub-id>
        <pub-id pub-id-type="pmid">23497356</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-26">
      <label>Stephen et al. (2012)</label>
      <element-citation publication-type="other">
        <person-group>
          <name>
            <surname>Stephen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cullerne</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Spriggs</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Helliwell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lovell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2012</year>
        <comment>Biokanga: a suite of high performance bioinformatics applications. <italic>Available at <uri xlink:href="http://code.google.com/p/biokanga/">http://code.google.com/p/biokanga/</uri></italic></comment>
      </element-citation>
    </ref>
    <ref id="ref-27">
      <label>Storey &amp; Tibshirani (2003)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Statistical significance for genomewide studies</article-title>
        <source>Proceedings of the National Academy of Sciences of the United States of America</source>
        <issue>16</issue>
        <year>2003</year>
        <volume>100</volume>
        <fpage>9440</fpage>
        <lpage>9445</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1530509100</pub-id>
        <pub-id pub-id-type="pmid">12883005</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-28">
      <label>Tjur (1998)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tjur</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Nonlinear regression, quasi likelihood, and overdispersion in generalised linear models</article-title>
        <source>American Statistician</source>
        <year>1998</year>
        <volume>52</volume>
        <fpage>222</fpage>
        <lpage>227</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
