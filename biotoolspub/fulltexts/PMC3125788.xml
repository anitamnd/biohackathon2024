<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3125788</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkr403</article-id>
    <article-id pub-id-type="publisher-id">gkr403</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ARISTO: ontological classification of small molecules by electron ionization-mass spectrometry</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Askenazi</surname>
          <given-names>Manor</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Linial</surname>
          <given-names>Michal</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Sudarsky Center for Computational Biology, Department of Biological Chemistry, Hebrew University of Jerusalem, Israel and <sup>2</sup>Blais Proteomics Center, Dana-Farber Cancer Institute, Boston, MA, USA</aff>
    <author-notes>
      <corresp id="COR1">*To whom correspondence should be addressed. Tel: <phone>+972 2 6585425</phone>; Fax: <fax>+972 2 6586448</fax>; Email: <email>manoras@cs.huji.ac.il</email></corresp>
    </author-notes>
    <!--For NAR both ppub and collection dates generated for PMC processing 1/27/05 beck-->
    <pub-date pub-type="collection">
      <day>1</day>
      <month>7</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>7</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>5</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>5</month>
      <year>2011</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>39</volume>
    <issue>Web Server issue</issue>
    <issue-title>Web Server issue</issue-title>
    <fpage>W505</fpage>
    <lpage>W510</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>2</month>
        <year>2011</year>
      </date>
      <date date-type="rev-recd">
        <day>2</day>
        <month>5</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>5</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2011. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">http://creativecommons.org/licenses/by-nc/3.0</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Gas chromatography–mass spectrometry (GC–MS) acquisitions routinely yield hundreds to thousands of Electron Ionization (EI) mass spectra. The chemical identification of these spectra typically involves a search protocol that seeks an exact match to a reference spectrum. Reference spectra are found in comprehensive libraries of small molecule EI spectra curated by commercial and public entities. We developed ARISTO (Automatic Reduction of Ion Spectra To Ontology), a webtool, which provides information regarding the general chemical nature of the compound underlying an input EI mass spectrum. Importantly, ARISTO can provide such annotation without necessitating an exact match to a specific compound. ARISTO provides assignments to a subset of the ChEBI (Chemical Entities of Biological Interest) dictionary, an ontology, which aims to cover biologically relevant small molecules. Our system takes as input a mass spectrum represented as a series of mass and intensity pairs; the system returns a graphical representation of the supported ontology as well as a detailed table of suggested annotations along with their associated statistical evidence. ARISTO is accessible at this URL: <ext-link ext-link-type="uri" xlink:href="http://www.ionspectra.org/aristo">http://www.ionspectra.org/aristo</ext-link>. The system is free, open to all and does not require registration of any sort.</p>
    </abstract>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>INTRODUCTION</title>
    <p>In a typical Gas chromatography–mass spectrometry (GC–MS) study, analytical chemists will usually submit their Electron Ionization (EI) mass spectra to a software system, which attempts to identify each spectrum by matching it exactly to a reference spectrum from a well curated library (<xref ref-type="bibr" rid="B1">1</xref>). These libraries are generated by systematically running pure compounds under standard conditions to generate high-quality reference spectra. One of the largest libraries to date is the NIST 08 EI library (<xref ref-type="bibr" rid="B2">2</xref>) which contains spectra for 191 436 compounds (in its main library).</p>
    <p>While the coverage of the NIST library ensures that for many of the common small molecules an exact match can be provided, if an exact match is not found, the researcher is left with two choices: (i) inspection of the nearest, imperfect hits and (ii) <italic>de novo</italic> elucidation of the compound structure, typically with the help of specialized software. Several software systems attempt to provide such <italic>de novo</italic> assignments including AMDIS (<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>) and Mass Frontier™ (ThermoFisher Scientific, Waltham, MA, USA). These software solutions ultimately rely on a chemical substructure identification (<xref ref-type="bibr" rid="B5">5</xref>) as a key component of their solution strategy.</p>
    <p>In contrast, ARISTO does not explicitly incorporate substructure matching. Instead, it attempts to match spectra directly to averaged spectra corresponding to a formal standardized set of annotations (ChEBI, described below), without seeking an explicit substructure match with the query spectrum. ARISTO leverages the development in the chemical informatics community of a formal ontology which aims to cover Chemical Entities of Biological Interest—namely the ChEBI (<xref ref-type="bibr" rid="B6">6</xref>) dictionary. ARISTO was derived by matching 3000 spectra from the NIST 08 EI library to their respective ChEBI entries.</p>
    <p>The combination of these two resources is used to derive a directed acyclic graph (DAG) of ∼400 canonical annotation spectra corresponding to broad (&gt;10 member compounds) ChEBI concepts. For each ChEBI concept (e.g. CHEBI:46686 or azaalkane), the corresponding EI spectra are averaged to generate a canonical annotation spectrum. A user provided query spectrum can then be scored against each of these averaged annotation spectra. From this score a probability of correctness is derived by comparing each score to a previously stored, comprehensive leave-one-out study which allows the system to estimate the precision of each prediction by linear interpolation against an empirical precision-recall plot (accessible in the results table). The scores are represented both graphically and in tabular form. The table contains links allowing the user to inspect the query spectrum aligned with the associated annotation spectrum (in a so-called mirror plot) as well as precision-recall plots and receiver operating characteristic (ROC) curves for the training data. The table also contains the description of each ChEBI concept as well as a link to the associated entry on the ChEBI website. The ontology supported by ARISTO is expected to expand in parallel to growth in the ChEBI annotation scheme.</p>
    <p>We propose ARISTO as a potential complementary approach in cases where exact spectral matches are unavailable and furthermore, in cases where approximate matches fail to support any obvious conserved substructure. A description of the implementation will be provided herein, along with example analyses and future directions.</p>
  </sec>
  <sec>
    <title>RATIONALE AND IMPLEMENTATION</title>
    <p>ARISTO is built on ChEBI, which is a relatively recent ontology of chemical entities with relevance to biological research. Though many other resources exist, which address the space of small-molecules, we focused on ChEBI exclusively due to its commitment to a comprehensive and fully hierarchical ontology. Broadly speaking ChEBI can be understood as a hierarchical tree of nodes (actually a DAG), each with a ChEBI ID (e.g. CHEBI:38728) and name (e.g. monocrotophos) as well as descriptions, synonyms, cross-references to other databases and detailed chemical structures where appropriate. The lower levels of the hierarchy, the ‘leaves’ of the DAG, typically correspond to specific compounds whereas internal nodes mostly correspond to increasingly general concepts in chemistry, culminating in ‘chemical entity’ at the root of the tree (e.g. CHEBI:24431). As is the case with the well-known gene ontology (GO) annotation scheme (<xref ref-type="bibr" rid="B7">7</xref>), most edges in ChEBI correspond to ‘is a’ edges, though chemistry specific relations such as ‘is enantiomer of’ and ‘has parent hydride’ are also supported.</p>
    <p>While ChEBI has experienced phenomenal growth in recent years, it remains committed to a definitive and thorough annotation of all its entries. In support of this goal, ChEBI uses a ‘rated’ annotation scheme similar to the one in use by UniProt. Whereas UniProt distinguishes its manually curated (Swiss-Prot) entries, ChEBI highlights the fully curated subset of its database (so called, 3 star entries). ARISTO relies only on these, highest rated entries, and consequently, its growth is projected to be limited primarily by the rate of ChEBI’s manual annotation efforts (in addition to limiting ARISTO’s growth rate, ChEBI also limits ARISTO to essentially un-derivatized molecules since derivatized forms are not often explicitly represented in chemical ontologies). Furthermore, to ensure robustness, we have opted to focus exclusively on the subset of ChEBI made entirely of ‘is a’ edges and internal nodes for which we could find at least 10 compounds with EI-spectra.</p>
    <p>All the spectra used as a foundation for the ARISTO system were extracted from the NIST 08 EI library, which contains 191 436 reference spectra in its main library. With each spectrum there is a structure provided as well as a compound name along with common synonyms and external accession numbers. While the compound nomenclature does not consistently correspond to any canonical nomenclature, the structure would be, in principle, sufficient to derive an InChiKey (<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>) identifier to match with the one systematically provided by the ChEBI ontology.</p>
    <p>The matching of EI spectra to broad annotations and chemical identifiers is challenging and prone to severe inconsistency. To overcome such pitfalls, the following matching-guidelines were considered: (i) The chemical structures provided by the NIST library do not contain stereochemistry and therefore are only guaranteed to yield the first 14 characters of the InChiKey correctly for any given compound. Recall that the first 14 letters of any InChiKey e.g. WHWZLSFABNNENI-OAHLLOKOSA-N for S-epinastine (CHEBI:51036) versus WHWZLSFABNNENI-HNNXBMFYSA-N for R-epinastine (CHEBI:51035), are produced by hashing the connectivity layer in the original InChi (and are therefore equivalent for these two compounds). (ii) While enantiomers almost always produce identical mass-spectra, the remaining characters of the InChiKey do provide information on isotopic composition, which can impact the spectrum. Ultimately, in order to minimize the chance of an incorrect match, especially in a first version of the system, the mapping between NIST and ChEBI was achieved not by InChiKey, but rather by CAS number. CAS was used as a cross-referenced accession that unifies many of the NIST and ChEBI entries. The resulting basis-set of annotated spectra available to the ARISTO system was therefore reduced from a potential ∼200 000 spectra in the NIST 08 EI library, through a maximum of ∼26 000 ChEBI entries to a CAS-supported matching of 3000 ChEBI-annotated EI spectra. In future versions of the system, we will attempt a more extensive matching in order to support a broader ontology. This will be achieved by matching on the first 14 characters of the InChiKey (‘connectivity hashing’).</p>
    <p>Having matched spectra to ChEBI concepts we applied an extremely simple ‘learning’ technique; we averaged the spectra per concept. This approach was selected for two main reasons: averaging replicate spectra constitutes a valid step in most library curation pipelines, so in a sense ARISTO is simply treating spectra from different compounds as replicates of the higher-level concept being represented. Second, spectral averaging simplifies the process of cross-validation since there is no need to ‘retrain’ when removing a spectrum from the training set. A simple weighted subtraction simulates the elimination of the spectrum from the input.</p>
    <p>Given a query spectrum and the averaged training data, ARISTO can generate a score for each concept by applying a simple dot-product to the query and the representative average spectrum for the concept. In order to translate scores into probabilities, we conducted a complete leave-one-out cross-validation study from which we generated ROC curves and precision-recall curves per concept. ARISTO reports the area under the curve (AUC) of the ROC curves to help users filter out concepts, which cannot be effectively recognized by our simple dot-product against-average-spectrum strategy. Based on numerous tests (data not shown), the users are encourage to ignore entries with AUC &lt; 0.8. ARISTO also reports the precision-recall curve, which it uses to translate scores to probabilities on a per concept basis. While it is evident that more complex learning schemes are likely to yield better coverage in terms of the ChEBI concept-space, we were able to find ‘learnable’ concepts even with this very basic strategy (<xref ref-type="fig" rid="F1">Figure 1</xref>). Indeed, these concepts correspond to classes of compounds which can be identified visually by experienced researchers that are trained in the elucidation of structure from mass-spectrometry data (such compound classes include, e.g. long-chain fatty acids, steroids, etc.).
<fig id="F1" position="float"><label>Figure 1.</label><caption><p>Learning higher level ChEBI concepts by a naive process of spectral averaging. The ‘learnable’ ChEBI concepts (AUC&gt;0.8) include long-chain fatty acid and steroid which are considered to be ‘easily recognizable’ by mass spectrometry experts while other broad categories such as natural product are relatively unexpected. Note that with increasing compound coverage some of the broader categories (<italic>N</italic>&gt;500) may decrease in their AUC while categories that currently lack adequate spectral support (<italic>N</italic> &lt; 10) are likely to cross the threshold of learnability.</p></caption><graphic xlink:href="gkr403f1"/></fig></p>
  </sec>
  <sec sec-type="cases">
    <title>TEST CASE ANALYSES</title>
    <p>The system is extremely easy to use in that it requires only one element of input, namely, a nominal mass spectrum specified as a series of mass and intensity pairs, optionally separated by new lines. The user pastes the spectrum into the provided input text box and activates the ‘Ontologize’ button. Candidate spectra will most likely be generated by tools such as SpectConnect (<xref ref-type="bibr" rid="B10">10</xref>) which can indentify reproducibly detected spectra that, while resisting identification, seem to be instrumental in discriminating e.g. biological conditions of interest. In <xref ref-type="fig" rid="F2">Figure 2</xref>A, the input field contains a spectrum from a lauric acid derivative (available as example 5 in the Examples tab). Note that the example spectra are all members of a randomly selected test set comprised of 32 spectra removed prior to the learning phase and made available in the Batch Mode tab of the ARISTO website (see description below).
<fig id="F2" position="float"><label>Figure 2.</label><caption><p>Screenshots from ARISTO’s web interface. (<bold>A</bold>) The user loads a mass spectrum corresponding to an unknown compound—in this example the structure is known (CHEBI:49519) and corresponds to example spectrum #5 in the Examples section of the website. The resulting report produced by ChEBI shows: (<bold>B</bold>) a DAG representing the estimated precision and AUC for each concept represented as the color and size of each concept-node along with its location within the supported ontology (an induced subgraph is highlighted in blue which links all ChEBI annotations passing ARISTO’s default filter back to the DAG’s root node) and (<bold>C</bold>) a tabular report showing the estimated precision of each prediction, the correctness of the call (marked as True/False and available only for the example input provided by the website) along with image-links to more supporting information. The first image-link yields a mirror plot (<bold>D</bold>) showing the match between the average annotation-spectrum (top in blue) for a given annotation, in this case straight-chain saturated fatty acid (CHEBI:39418), and the query spectrum (bottom in red). See text for more details.</p></caption><graphic xlink:href="gkr403f2"/></fig></p>
    <p>The system returns a complete assessment of whether the spectrum matches one of 388 chemical concepts. The results are provided in both graphical form (<xref ref-type="fig" rid="F2">Figure 2</xref>B) and tabular form (<xref ref-type="fig" rid="F2">Figure 2</xref>C). The directed acyclic graph represents the subset of the ChEBI ontology currently supported by ARISTO, where each node corresponds to a ChEBI concept color-coded by the probability that it is a valid annotation for the query spectrum (ranging from <italic>P</italic> = 0.0 in red to <italic>P</italic> = 1.0 in green). Edges in the DAG correspond to ‘is-a’ relationships. The size of each node is proportional to its AUC in the comprehensive leave-one-out analysis mentioned previously. Hovering over the node produces a tooltip specifying the node name and clicking on the node brings the user to the relevant ChEBI webpage. The tabular results contain sortable columns for the dot-product scores, the ChEBI node name, the number of compound spectra used to generate the representative average spectrum for the node, the AUC for the concept, as well as the estimated precision of the assignment. In addition, there is a link per annotation which produces a mirror plot (<xref ref-type="fig" rid="F2">Figure 2</xref>D) allowing the visual comparison of the average annotation spectrum (top in blue) with the query spectrum (bottom in red) as well as links to plots showing the data collected during the leave-one-out analysis with an additional red data point corresponding to the score produced for the query spectrum. When a user submits a spectrum from the examples provided by the website itself, an additional column is appended to the table showing the correctness of the call (according to release 73 of the ChEBI ontology made in October 2010). By default, the table is filtered to include only annotations with an AUC &gt; 0.8 and they are sorted according to their estimated precision (‘Est. Precision’ column), which is the preferred figure of merit by which to investigate ARISTO’s output. This is because the significance of the raw dot-product score (‘score’ column) is dependent, among other factors, on the size of the category (‘N’ column). The AUC and precision-recall plots are particularly useful in this regard, since they allow the user to see the empirical basis for the translation from raw score to estimated precision. The user can see every element used in the learning phase and effectively compare the dot-score of the query spectrum to all the data points collected during the leave-one-out learning phase (the query data point is colored red).</p>
    <p>In the example illustrated in <xref ref-type="fig" rid="F2">Figure 2</xref> (corresponding to example #5 in the examples page of the ARISTO website) we can see that straight-chain saturated fatty acid (CHEBI:39418) corresponds to the node with the strongest absolute score and is one of the four nodes showing maximal estimated precision (in the full, unfiltered table). However, two of these four predictions correspond to extremely broad and uninformative categories that also have relatively weak AUCs (they are in fact not visible in the default, filtered version of the results table). The entry for CHEBI:39418 is based on 19 compounds (<italic>N</italic> = 19) and an extremely high AUC. Consequently, CHEBI:39418 is selected as the more specific and well discriminated category. By clicking on the image links in the AUC column and estimated precision columns, the user can inspect the precision-recall and ROC curves for CHEBI:39418 and confirm that a score of 0.898 corresponds to a high-confidence identification. CHEBI:39418 is indeed a useful characterization of the input compound which would benefit an experimentalist interested in the chemical nature of the compound. It is noteworthy that this association is provided despite the fact that, strictly speaking, according to ChEBI, our input compound (CHEBI:49519) cannot be linked to the CHEBI:39418 category exclusively through a series of ‘is-a’ links (hence the False entry in the ‘Correct?’ column), rather it is necessary to go through a ‘has-functional-parent’ link to lauric acid (CHEBI:30805). While future versions of ARISTO may leverage these additional link-types explicitly, it is heartening that a version of ARISTO trained only on the ‘is-a’ subset of ChEBI can recover such relationships.</p>
    <p>Example #6 (not shown in <xref ref-type="fig" rid="F2">Figure 2</xref> but available in the examples page) corresponds to a compound from the MassBank (<xref ref-type="bibr" rid="B11">11</xref>) site: 3alpha,6alpha-Dihydroxy-5alpha-cholan-24-oic acid Methyl ester which is not incorporated into the ChEBI ontology (and hence was never introduced into ARISTO) and is derived (<xref ref-type="bibr" rid="B12">12</xref>) from hyodeoxycholic acid (CHEBI:52023); when submitted to ARISTO this spectrum is correctly annotated as a 3-hydroxy steroid (CHEBI:36834). Note that the tabular report for this spectrum does not contain a ‘Correct?’ column since this compound has not yet been annotated by ChEBI. It is nevertheless characterizable by ARISTO.</p>
    <p>Example #7 corresponds to Apoatropine (as in Example #6, this compound is not currently represented in ChEBI). The spectrum originates from the analysis of Datura inoxia seed extracts conducted by the Interdepartmental Equipment Unit of the Faculty of Agriculture, Food and Environment. This noisy GC–MS spectrum proved impossible to characterize using NIST’s MS-Search program and the NIST08 library: the correct structure was #36 on the list of suggested structures and only 1 of the top 10 identifications even contained a Nitrogen atom. In contrast, ARISTO correctly and confidently (estimated precision = 1.0) characterized the spectrum as containing an azabicycloalkane (CHEBI:38295).</p>
    <p>A final test case is provided in the Batch Mode tab of the system where the user can upload a set of 32-spectra specifically excluded from the learning phase of the algorithm. The user can use this data set to get a sense of the system’s coverage (for what percent of typical input spectra will the system issue a prediction) and whether or not the estimated precision is correct. Under the default filtering (which allows predictions with a minimal estimated precision of 0.5, i.e. with an expected failure rate of 50%) the system returns 33 predictions for 13 of the compounds (or 40% of the input data). Of these predictions 17 were correct corresponding to 51% of the predictions as expected under the default filtering. A stricter filtering at 0.75 yields 15 predictions of which 12 are correct, corresponding again to a well-calibrated 80% of the responses. However, the coverage has now dropped to only 6 compounds or ∼19% of the input data (in fact, the user may recognize some of these compounds as examples 1–5 in the Examples tab). The coverage of the system is expected to increase as it grows beyond the initial basis-set of 3000 spectra. Despite the relatively low coverage, it is again heartening to see that the system makes correct predictions for every compound except for CHEBI:49519 where, as described previously, the predictions are indeed meaningful and the annotation in the ‘Correct?’ column is set to False essentially due to the fact that ARISTO currently considers only ‘is-a’ links in the ChEBI dictionary.</p>
  </sec>
  <sec sec-type="conclusions">
    <title>CONCLUSIONS AND FUTURE DIRECTION</title>
    <p>ARISTO represents an existence proof for the idea of direct chemical characterization of mass spectra without explicit substructure matching. We expect ARISTO to be used primarily by experimentalists and to support the growing field of chemical informatics. ARISTO aims to close the gap between the enormous scale of small molecule spectral libraries and the nascent, relatively poor coverage of chemical ontologies associated with the small molecule concept space. The EI spectra are used as connectors between these spaces with the hope to circumvent the need for substructure identification. Recall that often the identity of a substructure is a poor indicator for the biological activity of the small molecule or its biological relevance.</p>
    <p>Clearly, there is much room for improvements. As described earlier, the spectral basis set of the system can in principle be increased quite dramatically by shifting from a CAS number-based matching between the NIST EI library and the ChEBI ontology to a looser matching based on the connectivity layer of the InChiKey. Such a mapping is bound to generate false matches, however it is likely that, while the mismatched pairs will be chemically distinct (e.g. they may be enantiomers), with respect to their EI fragmentation they are likely to be legitimately considered as equivalent. Using this alternative mapping, we expect to cover most of the ChEBI ontology and more importantly, we can automatically track its growth.</p>
    <p>In addition to improvements in coverage of chemical space, there is room for increased complexity in the algorithms used to classify spectra. The current version of ARISTO aims specifically to test the lower bound of algorithmic complexity, which is why it is based on a simple dot-product against each average class spectrum. More sophisticated machine learning algorithms are likely to increase the set of learnable concepts (e.g. algorithms that intelligently leverage the many TMS-derivatives present in the GC-MS centric NIST 08 EI library).</p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p><funding-source>Binational Science Foundation</funding-source> (BSF) (<award-id>2007-219</award-id>); <funding-source>Prospects consortium</funding-source> [EU FRVII]. Funding for open access charge: Prospects consortium (EU FRVII).</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors thank members of the Linial Lab for helpful discussions; Dr Steve Stein, Dr Anzor Mikaia and Dr Edward White for their advice and for providing a text-formatted version of the NIST 08 EI library; Dr Julius Ben-Ari for invaluable feedback and the spectrum corresponding to Apoatropine; Zina Muzikansky for her support during the preparation of this manuscript.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ausloos</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Clifton</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Lias</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Mikaya</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Tchekhovskoi</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Sparkman</surname>
            <given-names>OD</given-names>
          </name>
          <name>
            <surname>Zaikin</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The critical evaluation of a comprehensive mass spectral library</article-title>
        <source>J. Am. Soc. Mass Spectrom.</source>
        <year>1999</year>
        <volume>10</volume>
        <fpage>287</fpage>
        <lpage>299</lpage>
        <pub-id pub-id-type="pmid">10197350</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stein</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Optimization and testing of mass spectral library search algorithms for compound identification</article-title>
        <source>J. Am. Soc. Mass Spectrom.</source>
        <year>1994</year>
        <volume>5</volume>
        <fpage>859</fpage>
        <lpage>866</lpage>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stein</surname>
            <given-names>SE</given-names>
          </name>
        </person-group>
        <article-title>An integrated method for spectrum extraction and compound identification from gas chromatography/mass spectrometry data</article-title>
        <source>J. Am. Soc. Mass Spectrom.</source>
        <year>1999</year>
        <volume>10</volume>
        <fpage>770</fpage>
        <lpage>781</lpage>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stein</surname>
            <given-names>SE</given-names>
          </name>
        </person-group>
        <article-title>Chemical substructure identification by mass spectral library searching</article-title>
        <source>J. Am. Soc. Mass Spectrom.</source>
        <year>1995</year>
        <volume>6</volume>
        <fpage>644</fpage>
        <lpage>655</lpage>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gan</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J-h</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Y-z</given-names>
          </name>
        </person-group>
        <article-title>Library search of mass spectra with a new matching algorithm based on substructure similarity</article-title>
        <source>Anal. Sci.</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>635</fpage>
        <lpage>638</lpage>
        <pub-id pub-id-type="pmid">11708145</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Matos</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Alcantara</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ennis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hastings</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Haug</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Spiteri</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Steinbeck</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Chemical entities of biological interest: an update</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>38</volume>
        <fpage>D249</fpage>
        <lpage>D254</lpage>
        <pub-id pub-id-type="pmid">19854951</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ashburner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ball</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cherry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Dolinski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dwight</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Eppig</surname>
            <given-names>JT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene ontology: tool for the unification of biology. The Gene Ontology Consortium</article-title>
        <source>Nature Genetics</source>
        <year>2000</year>
        <volume>25</volume>
        <fpage>25</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="pmid">10802651</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heller</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McNaught</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The status of the InChI project and the InChI trust</article-title>
        <source>J. Cheminf.</source>
        <year>2010</year>
        <volume>2</volume>
        <fpage>P2</fpage>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kidd</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Changing the face of scientific publishing</article-title>
        <source>Integrative Biology</source>
        <year>2009</year>
        <volume>1</volume>
        <fpage>293</fpage>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Styczynski</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Moxley</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Tong</surname>
            <given-names>LV</given-names>
          </name>
          <name>
            <surname>Walther</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Stephanopoulos</surname>
            <given-names>GN</given-names>
          </name>
        </person-group>
        <article-title>systematic identification of conserved metabolites in GC/MS data for metabolomics and biomarker discovery</article-title>
        <source>Anal. Chem.</source>
        <year>2007</year>
        <volume>79</volume>
        <fpage>966</fpage>
        <lpage>973</lpage>
        <pub-id pub-id-type="pmid">17263323</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horai</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Arita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kanaya</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nihei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ikeda</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Suwa</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ojima</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aoshima</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MassBank: a public repository for sharing mass spectral data for life sciences</article-title>
        <source>J. Mass Spectrom.</source>
        <year>2010</year>
        <volume>45</volume>
        <fpage>703</fpage>
        <lpage>714</lpage>
        <pub-id pub-id-type="pmid">20623627</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iida</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tamaru</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>FC</given-names>
          </name>
          <name>
            <surname>Niwa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Goto</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nambara</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Potential bile acid metabolites. 20. A new synthetic route to stereoisomeric 3,6-dihydroxy- and 6-hydroxy-5 alpha-cholanoic acids</article-title>
        <source>Steroids</source>
        <year>1993</year>
        <volume>58</volume>
        <fpage>362</fpage>
        <lpage>369</lpage>
        <pub-id pub-id-type="pmid">8212086</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
