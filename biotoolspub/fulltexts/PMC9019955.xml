<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9019955</article-id>
    <article-id pub-id-type="publisher-id">2659</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-022-02659-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>One Cell At a Time (OCAT): a unified framework to integrate and analyze single-cell RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Chloe X.</given-names>
        </name>
        <address>
          <email>xueqi.wang@mail.mcgill.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Lin</given-names>
        </name>
        <address>
          <email>linzhang@utstat.toronto.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Bo</given-names>
        </name>
        <address>
          <email>bowang@vectorinstitute.ai</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.231844.8</institution-id><institution-id institution-id-type="ISNI">0000 0004 0474 0428</institution-id><institution>University Health Network, </institution></institution-wrap>Toronto, Canada </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.17063.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2157 2938</institution-id><institution>Department of Statistical Sciences, </institution><institution>University of Toronto, </institution></institution-wrap>Toronto, Canada </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.17063.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2157 2938</institution-id><institution>Department of Laboratory Medicine and Pathobiology, Temerty Faculty of Medicine, </institution><institution>University of Toronto, </institution></institution-wrap>Toronto, Canada </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.17063.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2157 2938</institution-id><institution>Department of Computer Science, </institution><institution>University of Toronto, </institution></institution-wrap>Toronto, Canada </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.494618.6</institution-id><institution>Vector Institute, </institution></institution-wrap>Toronto, Canada </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>102</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>10</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>3</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Integrative analysis of large-scale single-cell RNA sequencing (scRNA-seq) datasets can aggregate complementary biological information from different datasets. However, most existing methods fail to efficiently integrate multiple large-scale scRNA-seq datasets. We propose OCAT, One Cell At a Time, a machine learning method that sparsely encodes single-cell gene expression to integrate data from multiple sources without highly variable gene selection or explicit batch effect correction. We demonstrate that OCAT efficiently integrates multiple scRNA-seq datasets and achieves the state-of-the-art performance in cell type clustering, especially in challenging scenarios of non-overlapping cell types. In addition, OCAT can efficaciously facilitate a variety of downstream analyses.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at (10.1186/s13059-022-02659-1).</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Integration</kwd>
      <kwd>Single-cell RNA-seq</kwd>
      <kwd>Differential gene expression</kwd>
      <kwd>Trajectory inference</kwd>
      <kwd>Pseudotime inference</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000038</institution-id>
            <institution>Natural Sciences and Engineering Research Council of Canada</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RGPIN-2020-06189 and DGECR-2020-00294</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The rapid advancement of transcriptome sequencing technologies in single cells (scRNA-seq) has witnessed the exponential growth in the number of large-scale scRNA-seq datasets. Integration of multiple scRNA-seq datasets from different studies has the great potential to facilitate the identification of both common and rare cell types. Batch effect correction is one of the biggest challenges when integrating multiple scRNA-seq datasets. Batch effect is the perturbation in measured gene expressions, often introduced by factors such as library preparation, sequencing technologies, and sample origins (donors). Batch effect is therefore likely to confound with true biological signals, resulting in the misclassification of cells by experiment rather than by their true biological identities. Batch effect removal has thus become a common practice prior to data integration, which introduces additional computational challenges. Most existing batch effect removal procedures assume that the biological effect is orthogonal to the batch effect, which is unlikely to be true in real life. Moreover, as the scale of the datasets increases, integrating multiple large-scale scRNA-seq datasets can introduce heavy, or sometimes unbearable, computational and memory storage burden.</p>
    <p>Most of the existing scRNA-seq integration methods require explicit batch removal steps. One of the most commonly used approaches is mutual nearest neighbors (MNNs) [<xref ref-type="bibr" rid="CR1">1</xref>], which employs paired cells (or MNNs) to project the data onto a shared subspace. However, this approach requires large runtime memory and long computation time to search for MNNs in the high dimensional space of gene expressions. Though some derivatives of the MNN method [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>] have attempted to improve memory efficiency by performing dimension reduction in the gene expression space, memory usage is still demanding when the number of single cells is large. Another common approach, Seurat [<xref ref-type="bibr" rid="CR4">4</xref>], projects scRNA-seq data to a canonical correlation analysis (CCA) subspace and computes MNNs in the CCA subspace to correct batch effect. On the other hand, Harmony [<xref ref-type="bibr" rid="CR5">5</xref>] iteratively removes batch effects after projecting scRNA-seq data to a principal component analysis (PCA) subspace. Harmony can also consume large memory when the number of cells is large. To meet these challenges in scRNA-seq integration, we hereby propose OCAT (One Cell At a Time), a fast and memory-efficient machine learning-based method that does not require explicit batch effect removal in integrating multiple scRNA-seq datasets. OCAT utilizes sparse encoding to integrate multiple heterogeneous scRNA-seq datasets, achieving state-of-the-art or comparable performance compared to existing methods.</p>
    <p>OCAT offers three major advantages over existing methods. First, OCAT identifies hypothetical “ghost” cells of each dataset and constructs a sparse bipartite graph between each cell and the “ghost” cells, generating a sparsified encoding of each cell optimized for computational efficiency (<italic>O</italic>(<italic>N</italic>)). Secondly, by connecting each individual cell to the “ghost” cell set from all datasets, OCAT manages to capture the global similarity structure between single cells and thus does not require any explicit batch effect correction. Thirdly, the OCAT sparse graph encoding can be effectively transformed into cell feature representations that readily tackle a wide range of downstream analysis tasks, providing a unified solution to common single-cell problems such as differential gene expression analysis, trajectory inference, pseudotime inference, and cell type inference.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>The OCAT framework overview</title>
      <p>OCAT integrates multiple large-scale scRNA-seq datasets using sparse encoding as the latent representations of the single-cell gene expressions. Given multiple scRNA-seq gene expression matrices as input, OCAT first identifies hypothetical “ghost” cells, centers of small cell neighborhoods, from each dataset. OCAT here only uses the <italic>K</italic>-means clustering algorithm to identify the feature representations of the “ghost” cells, but no cluster labels are assigned to the cells. OCAT next constructs a bipartite graph between all single cells and the “ghost” cell set using similarities as edge weights. OCAT further amplifies the strong connections and trims down the weak edges, by only retaining the edges connecting to the <italic>s</italic> most similar “ghost” cells for each single cell. We employ the local anchor embedding (LAE) algorithm [<xref ref-type="bibr" rid="CR6">6</xref>] to further optimize the edge weights from each single cell to the remaining <italic>s</italic> most similar “ghost” cells, such that the resulting sparsified weights can most effectively reconstruct the transcriptomic features of the single cell. OCAT lastly captures the global cell-to-cell similarities through message passing between the “ghost” cells, which maps the sparsified weights of all single cells to the same global latent space. These transformed weights are then treated as the sparse encoding of each single cell.</p>
      <p>As the number of the most similar “ghost” cells <italic>s</italic> is much smaller than the number of genes, the OCAT latent representation is very sparse. We show that this sparse encoding can effectively facilitate downstream analyses, such as cell type clustering, differential gene expression analysis, trajectory and pseudotime inference, as well as cell type inference. Figure <xref rid="Fig1" ref-type="fig">1</xref> outlines the workflow of the OCAT integration procedures and its various downstream analysis functionalities.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic workflow of OCAT. When integrating multiple scRNA-seq datasets, OCAT first identifies “ghost” cells, centers of small cell neighborhoods, in each dataset. OCAT next constructs a bipartite graph connecting each cell to its most similar “ghost” cells. The edge weights connecting each cell’s closest “ghost” cells are treated as its OCAT sparse encoding. The OCAT sparse encoding can effectively correct the batch effect and facilitate various downstream analysis tasks, such as cell clustering, differential gene expression analysis, trajectory inference, and cell type inference</p></caption><graphic xlink:href="13059_2022_2659_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Sparse encoding of single-cell transcriptomics effectively corrects batch effect and integrates multiple scRNA-seq datasets</title>
      <p>When integrating multiple heterogeneous scRNA-seq datasets, most existing integration methods require iterations of explicit batch effect correction steps between every pair of datasets. Another common assumption in scRNA-seq data integration is that cell types are shared across all datasets, which is rarely true in real life. Such requirements and assumptions pose major challenges in the performance as well as computational efficiency to most existing integration methods. OCAT captures the global cell-to-cell similarity across datasets by connecting each single cell to the “ghost” cell set. OCAT thus does not require any explicit batch effect correction step and proves to be robust in identifying non-overlapping cell types unique to some datasets. The sparsified encoding also greatly accelerates the computational speed and reduces considerable amount of the memory usage when integrating multiple large-scale datasets.</p>
      <p>One common assumption of existing integration methods is that any cell type present in one dataset must also be present in all the other datasets. We hereby demonstrate that if some non-overlapping cell types exist, methods that require such assumption can misclassify these cell types and confound biological effects with batch effects. The human dendritic dataset [<xref ref-type="bibr" rid="CR7">7</xref>] consists of human blood dendritic cell (DC), namely, CD1C DC, CD141 DC, plasmacytoid DC (pDC), and double-negative cells. Tran et al. [<xref ref-type="bibr" rid="CR8">8</xref>] further processed and manually split the data into two batches: batch 1 contains 96 pDC, 96 double-negative, and 96 CD141 cells, while batch 2 has 96 pDC, 96 double-negative, and 96 CD1C cells. CD141 cells are only present in batch 1, while CD1C cells are only present in batch 2. The visualization of cell type clustering in Fig. <xref rid="Fig2" ref-type="fig">2</xref>B shows that Seurat v3 [<xref ref-type="bibr" rid="CR4">4</xref>], Harmony [<xref ref-type="bibr" rid="CR5">5</xref>], and Scanorama [<xref ref-type="bibr" rid="CR2">2</xref>] all falsely group CD141 and CD1C together. On the other hand, OCAT manages to distinguish CD141 and CD1C as two separate cell clusters. This verifies that the OCAT sparse encoding successfully recovers global cell-to-cell similarity across batches and captures true cell type identities by constructing the single cell to “ghost” cell bipartite graph. The cell type clustering metrics also reflect the same result, where OCAT has NMI<sub>cell type</sub>=0.7718, higher than all the other benchmarked methods (see Table <xref rid="Tab1" ref-type="table">1</xref> for a detailed comparison).
<fig id="Fig2"><label>Fig. 2</label><caption><p>Integrating multiple scRNA-seq datasets with OCAT. <bold>A</bold> UMAP projection of five integrated human pancreatic scRNA-seq datasets from heterogeneous sequencing platforms by OCAT, Seurat v3, Harmony, and Scanorama. The top panel is colored by the annotated cell types, and the bottom panel is colored by the dataset. <bold>B</bold> UMAP projection of two integrated human dendritic datasets with non-overlapping cell types by OCAT, Seurat v3, Harmony, and Scanorama. The top panel is colored by the annotated cell types, and the bottom panel is colored by the dataset. <bold>C</bold> UMAP projection of two integrated PBMC scRNA-seq datasets by OCAT (see Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S1 for a full comparison with Seurat v3, Harmony, and Scanorama). <bold>D</bold> Memory usage and runtime of OCAT, Seurat v3, Harmony, and Scanorama on five scRNA-seq integration tasks</p></caption><graphic xlink:href="13059_2022_2659_Fig2_HTML" id="MO2"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Cell type clustering and batch correction performance on integrating multiple scRNA-seq datasets. The clustering performance is measured by the normalized mutual information (NMI), where NMI<sub>cluster</sub>=1 implies correct clustering by cell type annotations. (1−NMI<sub>batch</sub>)=1 implies no batch effect present after integration. Hyperparameter <italic>m</italic> is the number of “ghost” cells, and <italic>d</italic> is the dimension of the reduced gene expression matrix. The bolded entries are the best performance metrics for each scenario. See the “<xref rid="Sec12" ref-type="sec">Methods</xref>” section for details on NMI<sub>cluster</sub> and NMI<sub>batch</sub> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1 for additional evaluation metrics</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left"><italic>n</italic><sub>cells</sub></th><th align="left"><italic>n</italic><sub>genes</sub></th><th align="left"><italic>m</italic></th><th align="left"><italic>d</italic></th><th align="left">Metric</th><th align="left">OCAT</th><th align="left">Seurat</th><th align="left">Harmony</th><th align="left">Scanorama</th></tr></thead><tbody><tr><td align="left">Human dendritic</td><td align="left">576</td><td align="left">16,594</td><td align="left">20</td><td align="left">80</td><td align="left">NMI<sub>cluster</sub></td><td align="left"><bold>0.7718</bold></td><td align="left">0.7375</td><td align="left">0.7653</td><td align="left">0.7212</td></tr><tr><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">1- NMI<sub>batch</sub></td><td align="left">0.9999</td><td align="left">0.9999</td><td align="left"><bold>1.0000</bold></td><td align="left">0.9999</td></tr><tr><td align="left">Mouse atlas</td><td align="left">6,954</td><td align="left">5,558</td><td align="left">45</td><td align="left">70</td><td align="left">NMI<sub>cluster</sub></td><td align="left"><bold>0.8006</bold></td><td align="left">0.6981</td><td align="left">0.7625</td><td align="left">0.6960</td></tr><tr><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">1- NMI<sub>batch</sub></td><td align="left"><bold>0.9999</bold></td><td align="left">0.9970</td><td align="left">0.9959</td><td align="left">0.9905</td></tr><tr><td align="left">Human pancreas</td><td align="left">14,767</td><td align="left">15,558</td><td align="left">65</td><td align="left">60</td><td align="left">NMI<sub>cluster</sub></td><td align="left"><bold>0.7949</bold></td><td align="left">0.7947</td><td align="left">0.7302</td><td align="left">0.7249</td></tr><tr><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">1- NMI<sub>batch</sub></td><td align="left">0.9650</td><td align="left"><bold>0.9762</bold></td><td align="left">0.9600</td><td align="left">0.9538</td></tr><tr><td align="left">PBMC</td><td align="left">15,476</td><td align="left">33,694</td><td align="left">40</td><td align="left">120</td><td align="left">NMI<sub>cluster</sub></td><td align="left">0.7424</td><td align="left"><bold>0.7932</bold></td><td align="left">0.7851</td><td align="left">0.7141</td></tr><tr><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">1- NMI<sub>batch</sub></td><td align="left">0.9934</td><td align="left">0.9943</td><td align="left"><bold>0.9944</bold></td><td align="left">0.9939</td></tr><tr><td align="left">Mouse hematopoietic</td><td align="left">4,649</td><td align="left">3,467</td><td align="left">30</td><td align="left">70</td><td align="left">NMI<sub>cluster</sub></td><td align="left">0.5019</td><td align="left">0.4606</td><td align="left">0.4111</td><td align="left"><bold>0.5160</bold></td></tr><tr><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">1- NMI<sub>batch</sub></td><td align="left">0.9648</td><td align="left">0.9673</td><td align="left"><bold>0.9734</bold></td><td align="left">0.9674</td></tr></tbody></table></table-wrap></p>
      <p>We then demonstrate the performance and efficiency of OCAT on integrating more than two large-scale heterogeneous scRNA-seq datasets. The pancreatic dataset consists of five human pancreatic scRNA-seq datasets sequenced with four different technologies (inDrop [<xref ref-type="bibr" rid="CR9">9</xref>], CEL-Seq2 [<xref ref-type="bibr" rid="CR10">10</xref>], Smart-Seq2 [<xref ref-type="bibr" rid="CR11">11</xref>], SMARTer [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]). Datasets generated by different sequencing platforms and technologies have inherent technical differences [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>], posing greater challenge to the integration task as the distributions of gene expressions vary significantly across the five datasets. Another challenge lies in the computational cost and memory consumption of integrating five datasets, caused by the iterative batch correction process for large number of cells with high dimensional gene expressions. Nevertheless, OCAT outperforms the other methods in correctly identifying the cell types without any highly variable gene selection or batch effect correction steps. Following the data pre-processing procedures outlined in Tran et al. [<xref ref-type="bibr" rid="CR8">8</xref>], we integrate the five pancreatic datasets using OCAT, and benchmark with Seurat v3, Harmony, and Scanorama. The UMAP projection in Fig. <xref rid="Fig2" ref-type="fig">2</xref>A demonstrates that OCAT outperforms the other methods in correctly clustering the single cells (NMI<sub>cell type</sub>=0.7949), while achieving comparable batch correction performance (1−NMI<sub>batch</sub>=0.9650) (see Table <xref rid="Tab1" ref-type="table">1</xref> for details). We show in Fig. <xref rid="Fig2" ref-type="fig">2</xref>D that OCAT is more computationally and memory efficient than the other benchmarked methods. Notably, OCAT takes less than half of the runtime of Seurat v3 and Scanorama. Though Harmony runs slightly faster than OCAT, it consumes four times more memory than OCAT. Seurat v3 and Scanorama both require more than 8 times memory of OCAT.</p>
      <p>We also validate the performance of OCAT on integrating mouse cell atlas [<xref ref-type="bibr" rid="CR16">16</xref>], human peripheral blood mononuclear cell (PBMC) [<xref ref-type="bibr" rid="CR13">13</xref>] and mouse hematopoietic stem and progenitor cell [<xref ref-type="bibr" rid="CR17">17</xref>] datasets. OCAT achieves state-of-the-art or comparable performance with the other benchmarked methods (see Table <xref rid="Tab1" ref-type="table">1</xref>, Fig. <xref rid="Fig2" ref-type="fig">2</xref>C, and Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S1-3 for details). Notably, when integrating the two PBMC datasets with a total of 15,476 cells and 33,694 genes, OCAT is twice faster than Seurat v3 and three times faster than Scanorama. In addition, Harmony and Seurat v3 consume more than 29 times of OCAT’s memory usage, while Scanorama consumes more than 24 times of OCAT’s memory usage (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D).</p>
    </sec>
    <sec id="Sec5">
      <title>OCAT unifies various downstream biological inferences</title>
      <p>We demonstrate in this section that the OCAT sparse encoding can effectively facilitate various downstream analyses with important biological implications, such as cell type inference, differential gene expression analysis, and trajectory inference and pseudotime inference.</p>
      <sec id="Sec6">
        <title>Sparse encoding of individual scRNA-seq dataset</title>
        <p>We first demonstrate that the OCAT sparse encoding framework can also be used to extract the latent representations of single cells in individual scRNA-seq datasets. For an individual scRNA-seq dataset, OCAT first identifies the “ghost” cells in the dataset, and constructs a bipartite graph that connects each single cell to the “ghost” cells. We demonstrate that OCAT efficiently embeds individual scRNA-seq datasets, with four large-scale datasets: Romanov [<xref ref-type="bibr" rid="CR18">18</xref>], Zeisel [<xref ref-type="bibr" rid="CR19">19</xref>], Retina [<xref ref-type="bibr" rid="CR20">20</xref>], and PBMC 68k [<xref ref-type="bibr" rid="CR21">21</xref>]. We show in Table <xref rid="Tab2" ref-type="table">2</xref> that OCAT consistently outperforms scVI [<xref ref-type="bibr" rid="CR22">22</xref>], Seurat v3 [<xref ref-type="bibr" rid="CR4">4</xref>], and SIMLR [<xref ref-type="bibr" rid="CR23">23</xref>] in cell type clustering (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>A for the UMAP visualizations based on the OCAT sparse encoding).
<fig id="Fig3"><label>Fig. 3</label><caption><p>OCAT on individual scRNA-seq datasets. <bold>A</bold> UMAP projection of the OCAT sparsified embeddings for Romanov, Zeisel, Retina, PBMC 68k datasets, colored by the annotated cell types. <bold>B</bold> Differential gene expression analysis with OCAT on the Zeisel dataset. <bold>C</bold> OCAT trajectory inference and pseudotime inference on the HSMM dataset. <bold>D</bold> OCAT cell type inference performance on individual datasets Romanov, Zeisel, Retina, and PBMC, evaluated by three classification metrics, precision, recall, and F1</p></caption><graphic xlink:href="13059_2022_2659_Fig3_HTML" id="MO3"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption><p>Clustering performance of OCAT on four individual scRNA-seq datasets: Romanov, Zeisel, Retina and PBMC 68k, benchmarked with scVI, Seurat v3 and SIMLR. The clustering performance is measured by the Normalized Mutual Information (NMI), where NMI=1 implies correctly clustering all the cells with the same cell types while NMI=0 indicates random guessing. The bolded entries are the best performance metrics for each scenario. See Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S5 for additional evaluation metrics</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left"><italic>n</italic><sub>cells</sub></th><th align="left"><italic>n</italic><sub>genes</sub></th><th align="left"><italic>m</italic></th><th align="left"><italic>d</italic></th><th align="left">OCAT</th><th align="left">scVI</th><th align="left">Seurat</th><th align="left">SIMLR</th></tr></thead><tbody><tr><td align="left">Romanov</td><td align="left">2,881</td><td align="left">24,341</td><td align="left">20</td><td align="left">30</td><td align="left"><bold>0.6443</bold></td><td align="left">0.5436</td><td align="left">0.6343</td><td align="left">0.4234</td></tr><tr><td align="left">Zeisel</td><td align="left">3,005</td><td align="left">19,972</td><td align="left">50</td><td align="left">30</td><td align="left"><bold>0.7884</bold></td><td align="left">0.7126</td><td align="left">0.6724</td><td align="left">0.7373</td></tr><tr><td align="left">Retina</td><td align="left">19,829</td><td align="left">13,166</td><td align="left">60</td><td align="left">60</td><td align="left"><bold>0.8742</bold></td><td align="left">0.7572</td><td align="left">0.7865</td><td align="left">0.6337</td></tr><tr><td align="left">PBMC 68k</td><td align="left">68,579</td><td align="left">1000</td><td align="left">40</td><td align="left">40</td><td align="left"><bold>0.5750</bold></td><td align="left">0.4638</td><td align="left">0.4899</td><td align="left">0.5344</td></tr></tbody></table></table-wrap></p>
      </sec>
      <sec id="Sec7">
        <title>Cell type inference</title>
        <p>OCAT supports immediate and accurate cell type inference of incoming data, without repeating feature extraction procedures by combining the incoming data with the existing database. We denote the existing scRNA-seq datasets as the “reference” dataset, and the incoming unlabeled data as the “inference” dataset. For the reference dataset, OCAT first identifies a set of “ghost” cells and extracts the sparse features to train a support vector machine (SVM) [<xref ref-type="bibr" rid="CR24">24</xref>] with the annotated cell types. For the inference cells, OCAT computes their sparse encoding using the pre-identified reference “ghost” cell set and transfers cell type labels to the incoming inference cells using the pre-trained SVM.</p>
        <p>We first demonstrate OCAT’s cell type inference performance on four individual scRNA-seq datasets, Romanov [<xref ref-type="bibr" rid="CR18">18</xref>], Zeisel [<xref ref-type="bibr" rid="CR19">19</xref>], Retina [<xref ref-type="bibr" rid="CR20">20</xref>], and PBMC 68k [<xref ref-type="bibr" rid="CR21">21</xref>]. Each dataset is randomly split into 90% reference set and 10% inference set. The OCAT-extracted features of the inference cells based on the reference “ghost” cells yield high accuracy in cell type assignment (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>D and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S5 for details). We then demonstrate that OCAT can infer cell types in a more challenging scenario across two heterogeneous scRNA-seq datasets. With two PMBC scRNA-seq datasets [<xref ref-type="bibr" rid="CR3">3</xref>], we split each dataset into 90% reference set and 10% inference set. OCAT assigns cell types to the 10% inference set from dataset 2 based on the 90% reference set from dataset 1, and vice versa, achieving an F1 score of 0.8907 and 0.7719, respectively. We also conduct cell type inference experiments on two mouse atlas datasets [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] and two human dendritic datasets [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>], both achieving high accuracy in cell type assignment (see Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S5 for details).</p>
        <p>We further explore the efficacy of OCAT when using multiple datasets as integrated reference. We integrate three Pancreas datasets, Baron [<xref ref-type="bibr" rid="CR9">9</xref>], Muraro [<xref ref-type="bibr" rid="CR10">10</xref>], and Segerstolpe [<xref ref-type="bibr" rid="CR11">11</xref>], to obtain the combined OCAT features from 12,818 pancreatic cells as the reference set. We validate OCAT’s cell type inference performance on the first inference set Xin [<xref ref-type="bibr" rid="CR13">13</xref>] with 1,492 cells, which yields a highly competitive F1 score of 0.9847. We then examine a more challenging inference set [<xref ref-type="bibr" rid="CR12">12</xref>], as the inference cell distribution is known to deviate from the reference set. We highlight that OCAT effectively mitigates the distribution differences and achieves an F1 score of 0.8932 (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S9 for details).</p>
        <p>OCAT’s cell type inference functionality serves as an adaptive toolkit for biologists to leverage their existing reference datasets and annotate cell types of new incoming data. OCAT consistently demonstrates competitive cell type annotation performance despite the batch or technology differences between the reference and inference sets, which shows that it effectively mitigates batch effects. Moreover, OCAT’s integrative reference building functionality powered by the online learning algorithm allows the biologists to iteratively build their in-house cell atlases, as well as to connect with other available large-scale cell atlases in a fast and memory efficient way.</p>
      </sec>
      <sec id="Sec8">
        <title>Differential gene expression analysis</title>
        <p>Differential gene expression analysis is one of the most common approaches to facilitate cell type annotations. OCAT effectively selects the marker genes for each cell group based on the raw gene expression data. We demonstrate the efficacy of OCAT in differential gene expression analysis using the Zeisel dataset [<xref ref-type="bibr" rid="CR19">19</xref>] that classifies 9 cell types in the mouse somatosensory cortex and hippocampal CA1 region. Figure <xref rid="Fig3" ref-type="fig">3</xref>B plots the top 3 marker genes for each cell type. OCAT manages to replicate the marker gene findings reported by Zeisel et al. [<xref ref-type="bibr" rid="CR19">19</xref>], for example, <italic>Gad1</italic> and <italic>Gad2</italic> genes for interneuron cells and <italic>Acta2</italic> gene for mural cells. We further compare the top selected differential genes by OCAT with those identified by Seurat v3 [<xref ref-type="bibr" rid="CR4">4</xref>] and show that the top selected genes are highly consistent between the two methods. For example, for the CA1 cell population, OCAT identifies <italic>Crym, Cpne6, Neurod6, Gria1</italic>, and <italic>Wipf3</italic> as the top five differential genes, and four of them are also in the top five differential genes selected by Seurat v3. We further show that the top feature genes identified by OCAT and Seurat v3 are also highly consistent for the other cell populations (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S6 and Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S6 for details).</p>
        <p>In the demonstration with the Zeisel dataset, we use the annotated cell type labels to show OCAT’s accuracy to identify the most differentially expressed genes and thus facilitate cell type annotation. We show in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S9-11 that the OCAT predicted labels can also effectively identify the top 20 most differentially expressed genes and are robust to hyperparameter selection (see the “<xref rid="Sec36" ref-type="sec">Hyperparameter sensitivity analysis in downstream tasks</xref>” section for details). Unlike the traditional differential gene expression analysis methods, OCAT does not impose any distributional assumptions on the expressions of genes and does not require gene selection or screening [<xref ref-type="bibr" rid="CR26">26</xref>]. We demonstrate that OCAT’s differential gene analysis achieves comparative performance as existing methods, while being fast and memory-efficient with fewer assumptions.</p>
      </sec>
      <sec id="Sec9">
        <title>Trajectory and pseudotime inference</title>
        <p>OCAT is able to reconstruct the developmental trajectory and pseudotime of cells based on their transcriptomic profiles. In most cell populations, there exists a gradient of differentiation underlying the process of cell renewal, from progenitor cells to the terminally differentiated cell types. Based on the similarities in gene expressions, trajectory and pseudotime analyses infer the differentiation status of the cell types as well as individual cells. Trajectory inference first maps out the developmental lineages from the least differentiated to most differentiated cell types. Pseudotime analysis then orders the individual cells along the predicted lineages and assigns each cell a pseudotime, indicating its time stamp in the process of differentiation.</p>
        <p>OCAT extracts a reduced “ghost” neighborhood graph between cell types by aggregating cell-to-cell similarities in each cluster. OCAT then infers the lineages by constructing the minimal spanning tree [<xref ref-type="bibr" rid="CR27">27</xref>] over the aggregated “ghost” neighborhood graph that connects all the cell types. The least differentiated cell type is considered as the root cluster, which determines the unique directionality of the inferred lineages (see the “<xref rid="Sec12" ref-type="sec">Methods</xref>” section for details). Lastly, to compute the pseudotime of each cell, OCAT appoints the least differentiated cell in each “ghost” neighborhood as the root cell. Traversing down the lineages, OCAT uses the root cell as the point of reference in each local neighborhood to assign pseudotime to individual cells.</p>
        <p>We validate the performance of OCAT trajectory and pseudotime inference using the human skeletal muscle myoblast (HSMM) dataset [<xref ref-type="bibr" rid="CR28">28</xref>]. The HSMM dataset contains time-series scRNA-seq data outlining the early stages of myogenesis. The 271 myoblast cells were collected at 0, 24, 48, and 72 hours of differentiation, with gold standard annotations based on known gene markers [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. OCAT infers the differentiation trajectory from myoblast to intermediate cells, followed by three separate branches into myotubes, fibroblasts, and undifferentiated cells. Fibroblasts and undifferentiated cells represent the two cell groups that exit the differentiation cycle prior to myotube formation. The inferred trajectory is consistent with the known biology of myotube formation as well as the original findings in Tran and Bader [<xref ref-type="bibr" rid="CR29">29</xref>]. The pseudotime assigned by OCAT is highly correlated with the collection time stamps, with a Pearson correlation of 0.8743 by annotated cell type group. Additionally, following the procedures in Saelens et al. [<xref ref-type="bibr" rid="CR30">30</xref>], we compare OCAT with Slingshot [<xref ref-type="bibr" rid="CR31">31</xref>], PAGA Tree [<xref ref-type="bibr" rid="CR32">32</xref>], and Monocle ICA [<xref ref-type="bibr" rid="CR33">33</xref>] on trajectory and pseudotime inference with 28 gold standard real datasets using the dynverse R package [<xref ref-type="bibr" rid="CR30">30</xref>]. OCAT is competitive in accurately assigning cell positions along the lineages as well as assisting downstream tasks of identifying important genes specific to the trajectory (see the “<xref rid="Sec12" ref-type="sec">Methods</xref>” section, Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S7 and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S7 for details).</p>
        <p>OCAT’s trajectory and pseudotime inference functionalities allow biologists to infer developmental lineages and pseudotime based on transcriptomic similarity. These inferred developmental lineages outline the potential relationships between the cell clusters and thus facilitate the discovery of intermediate cell types and states that are critical in cell differentiation [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>].</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="discussion">
    <title>Discussion</title>
    <p>In this work, we present OCAT, a unified machine learning framework for analyzing large-scale scRNA-seq datasets, which synergizes a wide range of downstream tasks crucial to biological discoveries. OCAT utilizes sparse encoding as the latent representation of single cell transcriptomics to amplify the true biological signals. Through the hypothetical “ghost” cells, the OCAT sparse encoding can capture the global cell-to-cell similarity across multiple heterogeneous datasets. We demonstrated that, without any batch effect correction, the sparse encoding of OCAT effectively separates the true biological differences among the cells from batch effects, achieving state-of-the-art performance with existing methods in cell type identification.</p>
    <p>Unlike most existing methods, OCAT does not rely on highly variable gene selection to discriminate biological cell groups, which preserves the identities of non-overlapping cell types unique to some datasets. Furthermore, OCAT successfully leverages the high demand for computational resources in integrating large-scale scRNA-seq datasets. Most existing integration methods cluster single cells by computing global cell-to-cell adjacency matrix, which requires storing a <italic>N</italic>×<italic>N</italic> matrix and thus consumes large memory. On the other hand, OCAT uses the sparsified edge weights between each cell to the “ghost” cell set as its embedding. Because the number of “ghost” cells is way fewer than the number of genes, OCAT can scale up to integrate multiple scRNA-seq datasets with large number of cells and large number of genes, in a computational and memory efficient way.</p>
    <p>OCAT identifies the hypothetical “ghost” cells, centers of small cell neighborhoods, using the <italic>K</italic>-means clustering algorithm. The goal here is not to assign cell type labels but to identify the “ghost” cells and obtain their feature representations, which are subsequently used to construct the bipartite graphs. After obtaining the sparse embedding of each cell, OCAT performs clustering algorithm to predict cell clusters. By default, OCAT uses the <italic>K</italic>-means clustering algorithm here, but this can be replaced by any clustering algorithms, such as Louvain and Leiden clustering algorithms.</p>
    <p>The OCAT framework requires that the genes are aligned and shared across all the datasets, which is a common assumption for most existing integration methods. If some genes are missing for all cells in one dataset, OCAT cannot utilize these missing genes in its integration. However, with the advance of scRNA-seq technology, most signature genes are unlikely to be missing, which indicates that using the common genes shared across all the datasets should be sufficient to characterize the gene expressions of cells. If the reads of some cells are missing at random in one dataset, OCAT can easily adapt existing imputation methods (for example, <italic>k</italic>-nearest neighbor imputation) to “fill in” the missing values. If some major genes are systematically missing in one dataset (batch) but not in others, imputation may not work because imputation may be perfectly confounded with batch effect, which is a common limitation to existing integration methods.</p>
    <p>OCAT effectively facilitates a variety of downstream analyses with important biological implications. For example, OCAT is readily applicable to analyzing individual scRNA-seq dataset, outperforming existing methods in cell type clustering. Moreover, OCAT can undertake challenging tasks such as differential gene expression analysis, trajectory inference, pseudotime inference, and cell type inference. For the trajectory inference analysis, OCAT assumes that cellular state of the same cell type cluster is similar. OCAT also assumes that only one root cluster (the least differentiated cluster) exists and produces more accurate prediction if the root cluster is known. For the pseudotime inference, we assume that the pseudotime values are similar along the trajectories. However, it has been pointed out that pseudotime sometimes may not necessarily reflect the true biological differentiation process.</p>
  </sec>
  <sec id="Sec11" sec-type="conclusion">
    <title>Conclusions</title>
    <p>With its sparse encoding of scRNA-seq data, OCAT provides a fast and memory-efficient framework for analyzing and integrating large-scale scRNA-seq data. OCAT utilizes ghost cells to inform global cell-to-cell similarity, which effectively integrates data from multiple heterogeneous sources without highly variable gene selection or explicit batch effect correction. The OCAT package also offers a variety of built-in downstream analysis functionalities, such as differential gene selection, trajectory and pseudotime inferences, and cell type inference. With additional biological priors, OCAT has the great potential to better facilitate downstream analyses and extend to tackle more complex tasks such as cell-to-cell communication network inference, which we will explore as future work. OCAT is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/bowang-lab/OCAT">https://github.com/bowang-lab/OCAT</ext-link>[<xref ref-type="bibr" rid="CR34">34</xref>].</p>
  </sec>
  <sec id="Sec12">
    <title>Methods</title>
    <sec id="Sec13">
      <title>The OCAT framework</title>
      <p>OCAT endorses sparse encoding of the latent representations of the single-cell transcriptomics. Given multiple single-cell gene expression matrices as input, OCAT first identifies “ghost” cells from each dataset and connects each cell with all the ghost cells through a sparsified bipartite graph where the weights of the edges are treated as the encoding. OCAT then uses this sparse encoding to find the similarities between cells and to facilitate downstream analyses such as cell clustering, trajectory inference, cell type inference, and differential gene analysis. In the next sections, we outline the OCAT algorithms when integrating <italic>H</italic> heterogeneous scRNA-seq datasets, each consisting of <italic>N</italic><sub>1</sub>,<italic>N</italic><sub>2</sub>,…,<italic>N</italic><sub><italic>H</italic></sub> cells and <italic>M</italic> common genes. Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S8 summarizes the notations.</p>
    </sec>
    <sec id="Sec14">
      <title>Data pre-processing</title>
      <p>For the <italic>h</italic>th user-input raw gene expression matrix <italic>R</italic><sub><italic>h</italic></sub>, OCAT first log-transforms each entry <italic>r</italic><sub><italic>ij</italic></sub> to: 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  r'_{ij} = \text{log}_{10} (r_{ij}+1), \text{for}\ i=1, \ldots, N_{h}\ \text{and}\ j=1, \ldots, M,  $$ \end{document}</tex-math><mml:math id="M2"><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>log</mml:mtext></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>and normalizes <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r^{\prime }_{ij}$\end{document}</tex-math><mml:math id="M4"><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq1.gif"/></alternatives></inline-formula> by: 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ x_{ij} = \frac{r'_{ij}}{\sqrt{\sum_{i=1}^{N_{h}} r'_{ij}}}.  $$ \end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The normalized gene expression vector for the <italic>i</italic>th single cell is <bold><italic>x</italic></bold><sub><italic>i</italic></sub>=(<italic>x</italic><sub><italic>i</italic>1</sub>,<italic>x</italic><sub><italic>i</italic>2</sub>,…,<italic>x</italic><sub><italic>iM</italic></sub>)<sup><italic>T</italic></sup>, and the normalized gene expression matrix for the <italic>h</italic>th dataset is <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{h} = \{\boldsymbol {x}_{i}\}_{i=1}^{N_{h}}$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq2.gif"/></alternatives></inline-formula>. We denote the normalized gene expression matrix for all <italic>H</italic> datasets as <italic>X</italic>.</p>
    </sec>
    <sec id="Sec15">
      <title>Dimension reduction of gene expression matrix</title>
      <p>To efficiently encode the scRNA-seq datasets, OCAT further reduces the dimension of the normalized gene expression matrix <italic>X</italic> to <italic>X</italic><sup>′</sup>. OCAT adopts the online fast similarity matching (FSM) algorithm [<xref ref-type="bibr" rid="CR35">35</xref>] that projects each <bold><italic>x</italic></bold><sub><italic>i</italic></sub> from <italic>M</italic>-dimensional to <italic>d</italic>-dimensional such that: 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \underset{\boldsymbol{x}'_{i} \in \mathbb{R}^{d}}{\text{min}} \sum_{k=1}^{N} \sum_{i=1}^{N} (\boldsymbol{x}_{k}^{T} \boldsymbol{x}_{k} - {\boldsymbol{x}'_{i}}^{T} \boldsymbol{x}'_{i})^{2},  $$ \end{document}</tex-math><mml:math id="M10"><mml:munder><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <bold><italic>x</italic></bold><italic>i</italic>′ is the low-dimensional representation of cell <italic>i</italic> and <inline-formula id="IEq3"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N = \sum _{h=1}^{H} N_{h}$\end{document}</tex-math><mml:math id="M12"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq3.gif"/></alternatives></inline-formula> is the total number of cells across all datasets. We denote <inline-formula id="IEq4"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X = \{\boldsymbol {x}'_{i}\}_{i=1}^{N}$\end{document}</tex-math><mml:math id="M14"><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq4.gif"/></alternatives></inline-formula> as the low-dimensional representation for cells from all <italic>H</italic> datasets and <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{h}' = \{\boldsymbol {x}'_{i}\}_{i=1}^{N_{h}}$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq5.gif"/></alternatives></inline-formula> as the low-dimensional representation of the <italic>h</italic>th scRNA-seq dataset.</p>
      <p>Though a vast collection of methods is available for dimension reduction, online FSM is much more efficient with a complexity of <italic>O</italic>(<italic>N</italic><italic>M</italic><italic>d</italic>) than the traditional principal component analysis (PCA) whose complexity is <italic>O</italic>(<italic>M</italic><sup>2</sup><italic>N</italic>+<italic>M</italic><sup>3</sup>). When the number of genes, <italic>M</italic>, is large (ususally &gt;20,000), online FSM is substantially faster than PCA. We recommend online FSM as the default option in the OCAT package but also offer PCA as an alternative option for the users.</p>
    </sec>
    <sec id="Sec16">
      <title>Identifying the “ghost” cells</title>
      <p>OCAT introduces ghost cells to characterize the global similarity between single cells. Ghost cells are imaginary cells that are <italic>K</italic>-means cluster centers of <italic>X</italic><sup>′</sup>, and they are not necessarily single cells from the input scRNA-seq datasets. For the <italic>h</italic>th dataset, OCAT identifies <italic>m</italic><sub><italic>h</italic></sub> ghost cells (<italic>m</italic><sub><italic>h</italic></sub><italic>K</italic>-means centers of <inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X^{\prime }_{h}$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq6.gif"/></alternatives></inline-formula>) each with <italic>d</italic>-dimensional features <bold><italic>u</italic></bold><sub><italic>k</italic></sub>, for <italic>k</italic>=1,2,…,<italic>m</italic><sub><italic>h</italic></sub>. Let <inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$U_{h} = \{\boldsymbol {u}_{k}\}_{k=1}^{m_{h}}$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq7.gif"/></alternatives></inline-formula> be the representations of the ghost cells from the <italic>h</italic>th dataset. Then, the feature representations for all the ghost cells from <italic>H</italic> datasets are <inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$U = \left (U_{1}^{T}, U_{2}^{T}, \ldots, U_{H}^{T} \right)^{T}$\end{document}</tex-math><mml:math id="M22"><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq8.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec17">
      <title>Constructing sparsified bipartite graph</title>
      <p>OCAT then constructs the bipartite graph that connects single cell one at a time, to all the ghost cells. The optimized edge weights to the nearest ghost cells are collectively treated as the sparsified representations of the cells. For the <italic>i</italic>th single cell (from any dataset), OCAT identifies its <italic>s</italic><sub><italic>h</italic></sub> closest ghost cells in the <italic>h</italic>th ghost cell set using cosine similarity, and denotes their indices as 〈<italic>i</italic><italic>h</italic>〉. OCAT then optimizes the edge weights <bold><italic>z</italic></bold><sub>〈<italic>i</italic><italic>h</italic>〉</sub> using local anchor embedding (LAE) [<xref ref-type="bibr" rid="CR6">6</xref>] by: 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \underset{\boldsymbol{z}_{\langle ih \rangle} \in \mathbb{R}^{s_{h}} }{\text{min}} \: \: \: \: \frac{1}{2} || \boldsymbol{x}'_{i} - U_{\langle ih \rangle} \boldsymbol{z}_{\langle ih \rangle} ||^{2}, \: \: \text{such that} \: \boldsymbol{1}^{T} \boldsymbol{z}_{\langle ih \rangle} = 1\ \text{and}\ \boldsymbol{z}_{\langle ih \rangle} \geq 0,  $$ \end{document}</tex-math><mml:math id="M24"><mml:munder><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mtext mathvariant="italic">ih</mml:mtext><mml:mo>〉</mml:mo></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mspace width="2.22144pt"/><mml:mspace width="2.22144pt"/><mml:mspace width="2.22144pt"/><mml:mspace width="2.22144pt"/><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mtext mathvariant="italic">ih</mml:mtext><mml:mo>〉</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mtext mathvariant="italic">ih</mml:mtext><mml:mo>〉</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="2.22144pt"/><mml:mspace width="2.22144pt"/><mml:mtext>such that</mml:mtext><mml:mspace width="2.22144pt"/><mml:msup><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mn>1</mml:mn></mml:mstyle></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mtext mathvariant="italic">ih</mml:mtext><mml:mo>〉</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mtext mathvariant="italic">ih</mml:mtext><mml:mo>〉</mml:mo></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <bold><italic>x</italic></bold><italic>i</italic>′ is the <italic>d</italic>-dimensional representation of cell <italic>i</italic>, and <italic>U</italic><sub>〈<italic>i</italic><italic>h</italic>〉</sub> is the <italic>d</italic>-dimensional representation of its <italic>s</italic><sub><italic>h</italic></sub> closest ghost cells.</p>
      <p>Similarly, we can obtain the optimized weights for cell <italic>i</italic> from all the ghost cell sets, denoted as <italic>Z</italic><sub><italic>i</italic>,〈<italic>i</italic>〉</sub>=(<bold><italic>z</italic></bold><sub>〈<italic>i</italic>1〉</sub>,<bold><italic>z</italic></bold><sub>〈<italic>i</italic>2〉</sub>,…,<bold><italic>z</italic></bold><sub>〈<italic>i</italic><italic>H</italic>〉</sub>)<sup><italic>T</italic></sup>. If a ghost cell is not one of the sh closest ghost cells to cell i, then the edge weight is reduced to 0, denoted as <inline-formula id="IEq9"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Z_{i, \overline {\langle i \rangle }} = \boldsymbol {0}$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mover accent="false"><mml:mrow><mml:mo>〈</mml:mo><mml:mi>i</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mn>0</mml:mn></mml:mstyle></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq9.gif"/></alternatives></inline-formula>. The collection of all the sparsified edge weights is <inline-formula id="IEq10"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Z = \{\boldsymbol {z}_{i}\}_{i=1}^{N} \in \mathbb {R}^{N \times m}$\end{document}</tex-math><mml:math id="M28"><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq10.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq11"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N = \sum _{h=1}^{H} N_{h}$\end{document}</tex-math><mml:math id="M30"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq11.gif"/></alternatives></inline-formula> is the total number of single cells, and <inline-formula id="IEq12"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$m = \sum _{h=1}^{H} m_{h}$\end{document}</tex-math><mml:math id="M32"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq12.gif"/></alternatives></inline-formula> is the total number of ghost cells.</p>
    </sec>
    <sec id="Sec18">
      <title>Message passing between single cells</title>
      <p>OCAT further applies message passing algorithms [<xref ref-type="bibr" rid="CR36">36</xref>] that connect the ghost cells among themselves. Based on the optimized edge weights <italic>Z</italic>, OCAT computes the ghost cell-to-ghost cell similarity <italic>Z</italic><sup>ghost</sup> by: 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ Z^{\text{ghost}} = Z^{T} Z,  $$ \end{document}</tex-math><mml:math id="M34"><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext>ghost</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>Z</mml:mi><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>and normalizes <italic>Z</italic><sup>ghost</sup> by: 
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ Z^{G} = D^{-\frac12} Z^{\text{ghost}} D^{-\frac12},  $$ \end{document}</tex-math><mml:math id="M36"><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext>ghost</mml:mtext></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>D</italic> is a diagonal matrix with: 
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ D_{kk} = \sum_{i=1}^{m} Z^{\text{ghost}}_{ik}, \text{for}\ k = 1, \ldots, m.  $$ \end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">kk</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow><mml:mrow><mml:mtext>ghost</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m.</mml:mi></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>With the normalized ghost cell-to-ghost cell similarity <italic>Z</italic><sup><italic>G</italic></sup>, OCAT next obtains the refined sparse edge weights for each cell: 
<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ Z^{W} = Z Z^{G}.  $$ \end{document}</tex-math><mml:math id="M40"><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>W</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>For the edge weights of single cell <italic>i</italic>, <inline-formula id="IEq13"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {z}_{i}^{W}$\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>W</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq13.gif"/></alternatives></inline-formula>, we normalize it by: 
<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \boldsymbol{z}_{i}^{\text{norm}} = \frac{\boldsymbol{z}_{i}^{W}}{\sqrt{\boldsymbol{z}_{i}^{W} \cdot \boldsymbol{z}_{i}^{W}}},  $$ \end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>norm</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>W</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>W</mml:mi></mml:mrow></mml:msubsup><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>W</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>and <inline-formula id="IEq14"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {z}_{i}^{\text {norm}}$\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>norm</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq14.gif"/></alternatives></inline-formula> is the final sparse representation of cell <italic>i</italic>. We denote the final OCAT sparse embedding for all cells as: 
<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ Z^{\text{norm}} = \{\boldsymbol{z}_{1}^{\text{norm}}, \boldsymbol{z}_{2}^{\text{norm}}, \ldots, \boldsymbol{z}_{N}^{\text{norm}} \},  $$ \end{document}</tex-math><mml:math id="M48"><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext>norm</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>norm</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext>norm</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>norm</mml:mtext></mml:mrow></mml:msubsup><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <inline-formula id="IEq15"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N= \sum _{h=1}^{H} N_{h}$\end{document}</tex-math><mml:math id="M50"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$m = \sum _{h=1}^{H} m_{h}$\end{document}</tex-math><mml:math id="M52"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq16.gif"/></alternatives></inline-formula>.</p>
      <p>For individual datasets, OCAT follows similar procedures as described above by setting <italic>H</italic>=1.</p>
    </sec>
    <sec id="Sec19">
      <title>Differential gene expression analysis</title>
      <p>OCAT offers the functionality to find the differential genes for each cell type clusters. Denote the normalized gene expression matrix as <italic>X</italic>={<italic>x</italic><sub><italic>ij</italic></sub>}, where <italic>i</italic>=1,…,<italic>N</italic> and <italic>j</italic>=1,…,<italic>M</italic>. For cell type cluster <italic>C</italic>, we compares the gene expression of cell type cluster <italic>C</italic> with all the other types, and we rank the top differentially expressed genes by the magnitude of: 
<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ T_{j}^{C} = \frac{\left(\frac{1}{n_{C}} \sum \limits_{i \in C} x_{ij} - \frac{1}{N - n_{C}} \sum \limits_{i \not \in C} x_{ij} \right)^{2}}{\frac{1}{N} \sum \limits_{i=1}^{N} (x_{ij} - \bar{x}_{j})^{2} },  $$ \end{document}</tex-math><mml:math id="M54"><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∉</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <inline-formula id="IEq17"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {x}_{j} = \sum _{i=1}^{N} x_{ij}/N $\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq17.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec20">
      <title>Cell type inference</title>
      <p>OCAT supports immediate cell type inference of incoming data based on existing databases, without re-computing the latent representations by combining the new incoming (“inference”) dataset and the existing (“reference”) dataset. Given an incoming inference set, OCAT first projects the normalized gene expression <italic>X</italic><sub>infer</sub> to the same <italic>d</italic>-dimensional subspace as the reference set, obtaining the reduced cell representation <inline-formula id="IEq18"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X^{\prime }_{\text {infer}}$\end{document}</tex-math><mml:math id="M58"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext>infer</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq18.gif"/></alternatives></inline-formula>. OCAT then constructs a bipartite graph that connects these new inference cells to the ghost cells identified in the reference set following (<xref rid="Equ4" ref-type="">4</xref>) and obtains the edge weights, <italic>Z</italic><sub>infer</sub>, for the inference cells. The edge weights then go through the same message-passing procedures as the reference cells, resulting in <inline-formula id="IEq19"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Z^{W}_{\text {infer}}$\end{document}</tex-math><mml:math id="M60"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext>infer</mml:mtext></mml:mrow><mml:mrow><mml:mi>W</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq19.gif"/></alternatives></inline-formula>, the sparse representation of the new inference cells mapped to the same global subspace as the reference cells.</p>
      <p>To assign cell type labels to the inference cells, OCAT trains a support vector machine (SVM) [<xref ref-type="bibr" rid="CR24">24</xref>] based on the sparse representations of the reference cells, <inline-formula id="IEq20"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Z^{W}_{\text {refer}}$\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext>refer</mml:mtext></mml:mrow><mml:mrow><mml:mi>W</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq20.gif"/></alternatives></inline-formula>, and the cell type labels for the reference cells. Based on the estimated coefficients from SVM, OCAT infers the cell type labels of the new incoming cells using <inline-formula id="IEq21"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Z^{W}_{\text {infer}}$\end{document}</tex-math><mml:math id="M64"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext>infer</mml:mtext></mml:mrow><mml:mrow><mml:mi>W</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq21.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec21">
      <title>Trajectory inference</title>
      <p>Trajectory inference aims to computationally reconstruct the developmental trajectory of cells based on gene expressions. It outlines the temporal transition from the least differentiated to the most differentiated cell types. OCAT infers the developmental lineages by connecting the similarity graph between cell types with a minimum spanning tree [<xref ref-type="bibr" rid="CR27">27</xref>].</p>
      <p>Suppose we have an <italic>N</italic>×<italic>m</italic> dimensional gene expression embedding for the cells, for example, the sparse embedding by OCAT, <italic>Z</italic><sup>norm</sup>. The cells are clustered into <italic>c</italic> cell types based on the embedding. OCAT computes the similarity score between cell type <italic>p</italic> and cell type <italic>q</italic>, <italic>A</italic><sub><italic>p</italic>,<italic>q</italic></sub>, by averaging the pair-wise cell-to-cell cosine similarities between cell types <italic>p</italic> and <italic>q</italic>. 
<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ A_{p,q} = \sum\limits_{u=1}^{n_{p}} \sum\limits_{v=1}^{n_{q}} a_{u, v}/n_{p} n_{q}, \hspace{0.15cm} \text{where}\ a_{u, v} = \frac{\boldsymbol{z}^{p}_{u} \boldsymbol{z}^{q}_{v} }{\Vert \boldsymbol{z}^{p}_{u} \Vert \Vert \boldsymbol{z}^{q}_{v} \Vert },  $$ \end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="4.26773pt"/><mml:mtext>where</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∥</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mo>∥</mml:mo><mml:mo>∥</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup><mml:mo>∥</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p>
      <p><inline-formula id="IEq22"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {z}^{p}_{u}$\end{document}</tex-math><mml:math id="M68"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq22.gif"/></alternatives></inline-formula> is the embedding vector for the <italic>u</italic>th cell in cell type <italic>p</italic>, <inline-formula id="IEq23"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {z}^{q}_{v}$\end{document}</tex-math><mml:math id="M70"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq23.gif"/></alternatives></inline-formula> is the embedding vector for the <italic>v</italic>th cell in cell type <italic>q</italic>, and <italic>n</italic><sub><italic>p</italic></sub> and <italic>n</italic><sub><italic>q</italic></sub> are the number of cells in cell type <italic>p</italic> and <italic>q</italic>, respectively. ∥·∥ denotes the l2-norm.</p>
      <p>Let <inline-formula id="IEq24"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$A = \{A_{p,q}\} \in \mathbb {R}^{c \times c}$\end{document}</tex-math><mml:math id="M72"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq24.gif"/></alternatives></inline-formula> denote the matrix of pair-wise similarity scores between <italic>c</italic> cell types. OCAT constructs an undirected graph <italic>G</italic><sup><italic>C</italic></sup> from <italic>A</italic>, where each node represents a unique cell type, and the edge weight between two nodes (two cell types) is their similarity score. OCAT then obtains the minimum spanning tree <italic>T</italic> that connects all the nodes while minimizing the total sum of edge weights in the tree <italic>T</italic>. OCAT lastly adds directionality to the tree by taking the least differentiated cell type, namely, the root cell type, as the starting point of differentiation. Once the root cell type is determined, we obtain a unique directionality within the tree <italic>T</italic>.</p>
    </sec>
    <sec id="Sec22">
      <title>Pseudotime inference</title>
      <p>Pseudotime analysis assigns each cell a time stamp along the lineages: less differentiated cells have earlier time stamps; more differentiated cells have later time stamps. Pseudotime provides more granularity to individual cells than the lineage ordering of cell types. OCAT defines a root cell in the root cluster, <bold><italic>r</italic></bold><sub>1</sub>, to serve as a reference to quantify differentiation. Biologically, <bold><italic>r</italic></bold><sub>1</sub> represents the most primitive in the entire differentiation trajectory. OCAT identifies <bold><italic>r</italic></bold><sub>1</sub> computationally by locating the cell whose spatial distances with other cells have the best accordance with the lineage ordering of cell types identified. OCAT then infers the extent to which a particular cell differentiates using its distance to the most primitive <bold><italic>r</italic></bold><sub>1</sub>, where less differentiated cells are closer to <bold><italic>r</italic></bold><sub>1</sub>, and vice versa.</p>
      <p>To calculate the distance of the <italic>u</italic>th cell of type <italic>p</italic> to the first cell <bold><italic>r</italic></bold><sub>1</sub>, OCAT considers both the position of cluster <italic>p</italic> along the cell type lineages and the position of cell <italic>u</italic> in cluster <italic>p</italic>. We then define a root cell in every non-root cluster to serve as landmarks to connect the cell types along the lineages, denoted as <inline-formula id="IEq25"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {r}_{2}, \ldots, \boldsymbol {r}_{c} \in \mathbb {R}^{m}$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq25.gif"/></alternatives></inline-formula>. In a non-root cluster <italic>p</italic>, the cell with the closest average Euclidean distance with all cells in the previous cluster <italic>p</italic>−1 on the same lineage is assigned to be the root cell, <bold><italic>r</italic></bold><sub><italic>p</italic></sub>. OCAT defines a distance <italic>D</italic><sub><italic>i</italic></sub> for each cell in the dataset, where <inline-formula id="IEq26"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$D \in \mathbb {R}^{N}$\end{document}</tex-math><mml:math id="M76"><mml:mi>D</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq26.gif"/></alternatives></inline-formula>. The distance for the <italic>u</italic>th cell in cluster <italic>p</italic> is defined as the sum of Euclidean distance between <inline-formula id="IEq27"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {z}^{p}_{u}$\end{document}</tex-math><mml:math id="M78"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq27.gif"/></alternatives></inline-formula> and the current root cell cluster <bold><italic>r</italic></bold><sub><italic>p</italic></sub>, and the length of cell type lineages up to cluster <italic>p</italic>: 
<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ D_{i} = \text{dis}(\boldsymbol{z}^{p}_{u}, \boldsymbol{r}_{1}) = \sqrt{\Vert \boldsymbol{z}^{p}_{u} - \boldsymbol{r}_{p} \Vert^{2}} + \sum_{l=2}^{p} \sqrt{\Vert \boldsymbol{r}_{l} - \boldsymbol{r}_{l-1} \Vert^{2}}.  $$ \end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>dis</mml:mtext><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>∥</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt><mml:mo>+</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:msqrt><mml:mrow><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>OCAT uses the normalized distance <italic>D</italic><sub>norm</sub> as the pseudotime measure: 
<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ D_{\text{norm}} = \frac{D - \min(D)}{\max(D) - \min(D)}.  $$ \end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>norm</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mo>min</mml:mo><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>max</mml:mo><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mo>min</mml:mo><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec23">
      <title>Evaluation metrics</title>
      <sec id="Sec24">
        <title>Cosine similarity</title>
        <p>We use cosine similarity as the similarity measure to identify the <italic>s</italic> closest “ghost” cells in constructing the sparse bipartite graph. The cosine similarity between single cell <italic>i</italic> and “ghost” cell <italic>j</italic> is defined as: 
<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \theta_{ij} = \frac{{\boldsymbol{x}'_{i}}^{T} \boldsymbol{u}_{j}}{\sqrt{{\boldsymbol{x}'_{i}}^{T} \boldsymbol{x}'_{i} \boldsymbol{u}_{j}^{T} \boldsymbol{u}_{j}}},  $$ \end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <bold><italic>x</italic></bold><italic>i</italic>′ is the feature of the <italic>i</italic>th single cell, and <bold><italic>u</italic></bold><sub><italic>j</italic></sub> is the feature of the <italic>j</italic>th “ghost” cell.</p>
      </sec>
      <sec id="Sec25">
        <title>Clustering evaluation metrics</title>
        <p>To assess the cell type clustering performance of the OCAT features, we compute the normalized mutual information (NMI) score of the predicted cell types and the annotated cell type labels (“ground truth”). The NMI score measures the overlap between the predicted cell type labels and true cell type labels normalized by entropy. We define entropy as: 
<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  H(X) = -\sum \limits_{i=1}^{|X|}\frac{|X_{i}|}{N}\log \frac{|X_{i}|}{N},  $$ \end{document}</tex-math><mml:math id="M86"><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where |<italic>X</italic>| is the total number of categories, |<italic>X</italic><sub><italic>i</italic></sub>| is the number of observations fall into category <italic>i</italic>, and <italic>N</italic> is the total number of observations.</p>
        <p>The NMI score of cell type clustering is defined as: 
<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  {}\text{NMI}_{\text{cluster}}(U,V) = \frac{2\text{MI}(U,V)}{H(U) + H(V)}, \: \: \text{where}\ \text{MI}(U,V) =\sum_{i=1}^{|U|} \sum_{j=1}^{|V|} \frac{|U_{i}\cap V_{j}|}{N} \log \frac{N|U_{i} \cap V_{j}|}{|U_{i}||V_{j}|},  $$ \end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mrow><mml:mtext>NMI</mml:mtext></mml:mrow><mml:mrow><mml:mtext>cluster</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mtext>MI</mml:mtext><mml:mo>(</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>U</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="2.22144pt"/><mml:mspace width="2.22144pt"/><mml:mtext>where</mml:mtext><mml:mspace width="1em"/><mml:mtext>MI</mml:mtext><mml:mo>(</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>U</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula></p>
        <p><italic>U</italic> is the set of predicted cell types, <italic>V</italic> is the set of annotated cell types (“ground truth”), <italic>N</italic> is the total number of cells, and <italic>H</italic>(·) is the entropy defined in (<xref rid="Equ16" ref-type="">16</xref>). The value of NMI<sub>cluster</sub> ranges from 0 to 1, where NMI<sub>cluster</sub>=1 indicates perfect clustering of single cells by the annotated cell types, and NMI<sub>cluster</sub>=0 indicates random guessing. In this work, we adopt the normalized_mutual_info_score function in the scikit-learn Python package [<xref ref-type="bibr" rid="CR37">37</xref>] to compute the NMI scores.</p>
      </sec>
      <sec id="Sec26">
        <title>Batch effect correction evaluation metric</title>
        <p>OCAT does not impose explicit batch correction steps, but we demonstrate that OCAT is robust to batch effect by capturing the global similarities between single cells. To assess the batch effect correction performance of OCAT, we adopt a modified NMI metric as in (<xref rid="Equ17" ref-type="">17</xref>), and define NMI<sub>batch</sub> as: 
<disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{NMI}_{\text{batch}}(I,J) = \frac{2\text{MI}(I,J)}{H(I) + H(J)},  $$ \end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mrow><mml:mtext>NMI</mml:mtext></mml:mrow><mml:mrow><mml:mtext>batch</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mtext>MI</mml:mtext><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>J</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <italic>I</italic> is the predicted batch labels, <italic>J</italic> is the true batch origin of each single cell, and MI is defined as in (<xref rid="Equ17" ref-type="">17</xref>). NMI<sub>batch</sub>=0 indicates that the predicted labels are not confounded with the batch label, and NMI<sub>batch</sub>=1 indicates that the predicted labels are perfectly confounded with the batch labels. We report (1−NMI<sub>batch</sub>) such that a higher (1−NMI<sub>batch</sub>) value indicates better batch effect removal performance.</p>
      </sec>
      <sec id="Sec27">
        <title>Other variations of clustering performance evaluation metrics</title>
        <p>Besides the NMI score, we also assess the cell type clustering and batch effect correction performance using the adjusted mutual information (AMI) scores. The AMI score is defined as: 
<disp-formula id="Equ19"><label>19</label><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{AMI}(U, V) = \frac{\text{MI}(U, V) - E(\text{MI}(U, V))}{\text{mean}(H(U), H(V)) - E(\text{MI}(U, V))},  $$ \end{document}</tex-math><mml:math id="M92"><mml:mtext>AMI</mml:mtext><mml:mo>(</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>MI</mml:mtext><mml:mo>(</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mtext>MI</mml:mtext><mml:mo>(</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mtext>mean</mml:mtext><mml:mo>(</mml:mo><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>U</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mtext>MI</mml:mtext><mml:mo>(</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <italic>U</italic> is the predicted label, <italic>V</italic> is the ground truth label, <italic>E</italic>(·) is the expectation, <italic>H</italic> is the entropy defined in (<xref rid="Equ16" ref-type="">16</xref>), and MI is defined as in (<xref rid="Equ17" ref-type="">17</xref>). We compute the AMI scores using the adjusted_mutual_info_score function in the scikit-learn Python package [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
        <p>The Rand index (RI) is a measure of the percentage of correct decisions based on the true-positive (<italic>tp</italic>), false-positive (<italic>fp</italic>), true-negative (<italic>tn</italic>), and false-negative (<italic>fn</italic>) counts. The RI is defined as: 
<disp-formula id="Equ20"><label>20</label><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  \text{RI} = \frac{tp + tn}{tp + fp + fn + tn}.  $$ \end{document}</tex-math><mml:math id="M94"><mml:mtext>RI</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">tp</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">tn</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">tp</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">fp</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">fn</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">tn</mml:mtext></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Here, we also adopt the adjusted Rand index (ARI) to assess the cell type clustering and batch effect correction. The ARI is defined as: 
<disp-formula id="Equ21"><label>21</label><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{ARI} = \frac{\text{RI} - E(\text{RI})}{\max(\text{RI}) - E(\text{RI})},  $$ \end{document}</tex-math><mml:math id="M96"><mml:mtext>ARI</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>RI</mml:mtext><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mtext>RI</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>max</mml:mo><mml:mo>(</mml:mo><mml:mtext>RI</mml:mtext><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mtext>RI</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where RI is the Rand index defined in (<xref rid="Equ20" ref-type="">20</xref>), and <italic>E</italic>(·) is the expectation. We compute the ARI scores using the adjusted_rand_score function in the scikit-learn Python package [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
        <p>We report the AMI<sub>cluster</sub>,1−AMI<sub>batch</sub>,ARI<sub>cluster</sub>, and 1−ARI<sub>batch</sub> metrics for all benchmarking integration datasets in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1. We also report the AMI and ARI scores for clustering individual datasets in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S2.</p>
      </sec>
      <sec id="Sec28">
        <title>Evaluation metric of trajectory and pseudotime inference</title>
        <p>We benchmark OCAT with Slingshot [<xref ref-type="bibr" rid="CR31">31</xref>], PAGA Tree [<xref ref-type="bibr" rid="CR32">32</xref>], and Monocle ICA [<xref ref-type="bibr" rid="CR33">33</xref>] on trajectory and pseudotime inference performance. We adopted the benchmarking procedure in dynverse [<xref ref-type="bibr" rid="CR30">30</xref>]. Dynverse defines five categories (i.e., features, cell positions, neighborhood, topology, branch assignment) with 16 metrics to evaluate the performance of trajectory and pseudotime inference (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S7 for the details of these metrics).</p>
        <p>For the HSMM dataset, we also assessed the accuracy of OCAT pseudotime inference by reporting the Pearson correlation between the OCAT predicted pseudotime with the real time stamp labels by cell type cluster. The Pearson correlation <italic>r</italic> is defined as: 
<disp-formula id="Equ22"><label>22</label><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ r = \frac{\sum_{i=1}^{k}(u_{i} - \bar{u})(v_{i} - \bar{v})}{\sqrt{\sum_{i=1}^{k}(u_{i} - \bar{u})^{2} \sum_{i=1}^{k} (v_{i} - \bar{v})^{2}}},  $$ \end{document}</tex-math><mml:math id="M98"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>ū</mml:mi><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>ū</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <italic>u</italic><sub><italic>i</italic></sub> is the average inferred pseudotime of cells in cluster <italic>i</italic>, and <italic>v</italic><sub><italic>i</italic></sub> is the average real time stamp of cells in cluster <italic>i</italic>, with <italic>i</italic>∈{1,2,…,<italic>k</italic>} clusters. <inline-formula id="IEq28"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {u}$\end{document}</tex-math><mml:math id="M100"><mml:mi>ū</mml:mi></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq28.gif"/></alternatives></inline-formula> is the average predicted pseudotime, and <inline-formula id="IEq29"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {v}$\end{document}</tex-math><mml:math id="M102"><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2022_2659_Article_IEq29.gif"/></alternatives></inline-formula> is the average real time stamp. We used the pearsonr function in the scipy.stats Python package [<xref ref-type="bibr" rid="CR37">37</xref>] to calculate the Pearson correlation score <italic>r</italic>.</p>
      </sec>
      <sec id="Sec29">
        <title>Cell type inference evaluation metrics</title>
        <p>To assess the performance of cell type assignment in cell type inference, we used the <italic>precision</italic>, <italic>recall</italic>, and <italic>f</italic>1 scores implemented in Python in the scikit-learn package [<xref ref-type="bibr" rid="CR37">37</xref>]. We calculated the average of <italic>precision</italic>, <italic>recall</italic>, and <italic>f</italic>1 across all classes, weighted by the number of samples in each class (see details in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S5). The <italic>precision</italic>, <italic>recall</italic>, and <italic>f</italic>1 scores for each class are calculated from true positives (<italic>tp</italic>), false positives (<italic>fp</italic>), true negatives (<italic>tn</italic>), and false negatives (<italic>fn</italic>) in that particular class. 
<disp-formula id="Equ23"><label>23</label><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{precision} = \frac{tp}{tp+fp}, \hspace{0.3cm} \text{recall} = \frac{tp}{tp + fn} \hspace{0.2cm} \text{and} \hspace{0.15cm} f1 = \frac{2 \times \text{precision}\times \text{recall}}{\mathrm{precision+recall}}.  $$ \end{document}</tex-math><mml:math id="M104"><mml:mtext>precision</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">tp</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">tp</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">fp</mml:mtext></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="8.5359pt"/><mml:mtext>recall</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">tp</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">tp</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">fn</mml:mtext></mml:mrow></mml:mfrac><mml:mspace width="5.69046pt"/><mml:mtext>and</mml:mtext><mml:mspace width="4.26773pt"/><mml:mi>f</mml:mi><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mtext>precision</mml:mtext><mml:mo>×</mml:mo><mml:mtext>recall</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="normal">precision</mml:mi><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">recall</mml:mtext></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2022_2659_Article_Equ23.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
    </sec>
    <sec id="Sec30">
      <title>Datasets</title>
      <sec id="Sec31">
        <title>Integration datasets</title>
        <p>We evaluated OCAT’s integration performance on five multi-source scRNA-seq datasets from Tran et al. [<xref ref-type="bibr" rid="CR8">8</xref>]. Each dataset contains two or more batches of scRNA-seq data from different experiments or sequencing technologies for similar cell classes, presenting five different scenarios for batch correction. 
<list list-type="bullet"><list-item><p><bold>Human dendritic dataset</bold>: The human dendritic dataset contains two batches of scRNA-seq data sequenced using Smart-Seq2, with four cell populations identified, namely CD1C DC, CD141 DC, plasmacytoid DC, and double-negative cells [<xref ref-type="bibr" rid="CR7">7</xref>]. Tran et al. [<xref ref-type="bibr" rid="CR8">8</xref>] further removed cell type CD1C DC from batch 1 and cell type CD141 DC from batch 2, to create non-overlapping cell types among the batches. The resulting batch 1 contains 288 cells with three annotated cell types CD141 DC, double-negative, and plasmacytoid DC; batch 2 also contains 288 cells with three annotated cell types CD1C DC, double-negative, and plasmacytoid DC. The two batches share two common cell types plasmacytoid DC and double-negatives, with one unshared cell type respectively (CD141 DC and CD1C DC). This dataset presents a common scenario of batch effect with the presence of non-overlapping cell types.</p></list-item><list-item><p><bold>Mouse atlas dataset</bold>: The mouse atlas dataset contains two batches of scRNA-seq generated independently by Han et al. [<xref ref-type="bibr" rid="CR16">16</xref>] using Microwell-Seq and the Tabula Muris Consortium [<xref ref-type="bibr" rid="CR38">38</xref>] with 10x Genomics and Smart-Seq2 protocols. The 11 cell types with the highest cell numbers in both batches were retained. The resulting first batch contains the read counts of 4,239 cells, and the second batch contains 2,715 cells, with 15,006 common genes. This dataset captures the batch effect resulting from different sequencing technologies.</p><p>The mouse atlas dataset contains the following 11 annotated cell types: T-cell, stromal, endothelial, macrophage, monocyte, epithelial, B-cell, neutrophil, dendritic, smooth-muscle, and NK. All cell types present in both batches.</p></list-item><list-item><p><bold>Human pancreas dataset</bold>: The human pancreas dataset consists of data from five different sources [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR13">13</xref>] of human pancreatic cells. Tran et al. [<xref ref-type="bibr" rid="CR8">8</xref>] further processed the dataset by removing cells with ambiguous annotations, and the resulting batches contain a total of 14,767 cells with 15 different cell types. This dataset captures the batch effect across multiple sequencing technologies.</p><p>In the resulting five batches, Baron et al. [<xref ref-type="bibr" rid="CR9">9</xref>] contains 8,569 cells of 13 annotated cell types (acinar, beta, delta, stellate, ductal, alpha, epsilon, gamma, endothelial, macrophage, Schwann, mast, T cell); Muraro et al. [<xref ref-type="bibr" rid="CR10">10</xref>] contains 2,122 cells of 9 annotated cell types (alpha, ductal, endothelial, delta, acinar, beta, gamma, mesenchymal, epsilon); Segerstolpe et al. [<xref ref-type="bibr" rid="CR11">11</xref>] contains 2,127 cells of 11 annotated cell types (delta, alpha, gamma, ductal, acinar, beta, MHC, stellate, endothelial, epsilon, mast); Wang et al. [<xref ref-type="bibr" rid="CR12">12</xref>] contains 457 cells of 7 annotated cell types (alpha, ductal, delta, beta, gamma, acinar, mesenchymal); and Xin et al. [<xref ref-type="bibr" rid="CR13">13</xref>] contains 1,492 cells of 4 annotated cell types (beta, alpha, delta, gamma).</p></list-item><list-item><p><bold>PBMC dataset</bold>: The PBMC dataset contains two batches of PBMC data from healthy donors generated by 3’ and 5’ 10x Genomics protocols. A total of 8,098 cells from the 3’ batch and 7,378 cells from the 5’ batch were selected and annotated by Polanski et al. [<xref ref-type="bibr" rid="CR3">3</xref>] with <italic>k</italic>-nearest neighbor clustering based on canonical markers. This dataset presents the challenge of integrating data with biological differences caused by sequencing protocols.</p><p>The PBMC dataset contains 9 annotated cell types: CD4 T cell, CD8 T cell, monocyte CD14, B cell, NK cell, monocyte FCGR3A, plasmacytoid dendritic cell, megakaryocyte, and hematopoietic stem cell. All cell types exist in both batches.</p></list-item><list-item><p><bold>Mouse hematopoietic dataset</bold>: The mouse hematopoietic dataset contains two batches of mouse hematopoietic stem and progenitor cells, generated by Nestorowa et al. [<xref ref-type="bibr" rid="CR17">17</xref>] with SMART-seq2 protocol and by Paul et al. [<xref ref-type="bibr" rid="CR39">39</xref>] with MARS-seq protocol, respectively. Tran et al. [<xref ref-type="bibr" rid="CR8">8</xref>] further extracted 2,729 well-annotated cells from the MARS-seq dataset. The resulting SMART-seq2 data contains 1,920 cells, and the MARS-seq data contains 2,729 cells, with 3,467 genes common genes retained.</p><p>The MARS-seq batch contains 3 annotated cell types: GMP, MEP, and CMP. The SMART-seq2 batch contains 7 annotated cell types: MPP, MEP, CMP, LTHSC, LMPP, Unsorted, and GMP. This dataset therefore captures the batch effect from not only different sequencing technologies but also non-overlapping cell types.</p></list-item></list></p>
      </sec>
      <sec id="Sec32">
        <title>Individual datasets</title>
        <p>
          <list list-type="bullet">
            <list-item>
              <p><bold>The Romanov dataset</bold> [<xref ref-type="bibr" rid="CR18">18</xref>] contains the RNA-seq data from 2,881 single cells with 24,341 genes in mouse hypothalamus obtained using Illumina HiSeq platform. Seven cell type clusters were identified by divisive biclustering method and annotated based on lineage-specific protogene markers.</p>
              <p>The Romanov dataset contains 7 annotated cell types: oligos, neurons, ependymal, astrocytes, endothelial, vsm, and microglia.</p>
            </list-item>
            <list-item>
              <p><bold>The Zeisel dataset</bold> [<xref ref-type="bibr" rid="CR19">19</xref>] contains the 3’-end counts of the unique molecular identifiers (UMI) assays from 3,005 single cells with 4,412 genes in the mouse somatosensory cortex and hippocampal CA1 region.</p>
              <p>The Zeisel dataset contains 9 annotated cell types: S1 and CA1 pyramidal neurons, interneurons, oligodendrocytes, astrocytes, microglia, vascular endothelial cells, mural cells, and ependymal cells.</p>
            </list-item>
            <list-item>
              <p><bold>The mouse retina dataset</bold> [<xref ref-type="bibr" rid="CR20">20</xref>] contains 19,829 single cells with 13,166 genes extracted from the Macoskco dataset (originally 44,808 cells), containing UMI (3’-end) counts obtained by Drop-seq.</p>
              <p>The mouse retina dataset contains 15 annotated cell types: BC1A, BC1B, BC2, BC3A, BC3B, BC4, BC5A, BC5B, BC5C, BC5D, BC6, BC7, BC8_9, MG, and RBC.</p>
            </list-item>
            <list-item>
              <p><bold>The PBMC 68k dataset</bold> [<xref ref-type="bibr" rid="CR21">21</xref>] contains the UMI (3’-end) counts from 68,579 peripheral blood mononuclear cells (PBMCs) with 1,000 genes profiled using the 10x Genomics GemCode platform.</p>
              <p>The PBMC 68k dataset contains 11 annotated cell types: CD14+ monocyte, CD19+ B, CD34+, CD4+ T Helper2, CD4+/CD25 T Reg, CD4+/CD45RA+/CD25-naive T, CD4+/CD45RO+ memory, CD56+ NK, CD8+ cytotoxic T, CD8+/CD45RA+ naive cytotoxic, and dendritic.</p>
            </list-item>
            <list-item>
              <p><bold>The human skeletal muscle myoblast (HSMM) dataset</bold> [<xref ref-type="bibr" rid="CR29">29</xref>] contains time-series RNA-seq data of 271 cells collected at 0, 24, 48, and 72 hours since human myoblast culture in the differentiation media. Five cell groups were annotated using GSVA based on known gene markers: myoblasts, intermediates, myotubes, fibroblasts, and undifferentiated.</p>
            </list-item>
          </list>
        </p>
      </sec>
    </sec>
    <sec id="Sec33">
      <title>Hyperparameter selection and sensitivity analysis</title>
      <p>The sparse encoding workflow of OCAT involves the specification of three hyperparameters: <italic>d</italic> as the projection dimension from the gene feature space by online FSM in the pre-processing step, <italic>m</italic> as the number of “ghost” cells each single cell connects to in the bipartite graph, and <italic>s</italic> as the closest “ghost” cells to construct the sparsified encoding of each cell. Here, we define <italic>p</italic>=<italic>s</italic>/<italic>m</italic> as the percentage of closet “ghost” cells chosen to embed the gene expression of each single cell. The number of closest “ghost” cells is computed as <italic>s</italic>=⌈<italic>p</italic><italic>m</italic>⌉.</p>
      <p>Here, we performed a set of sensitivity analyses to assess the impact of hyperparameter values on the OCAT sparse encoding in integrating multiple scRNA-seq data as well as clustering individual scRNA-seq data. We demonstrate that the OCAT sparse encoding is robust to various combinations of hyperparameters by comparing the cell type clustering performance.</p>
      <sec id="Sec34">
        <title>Hyperparameter sensitivity analysis in integrating multiple datasets</title>
        <p>We used the mouse atlas dataset as an example to demonstrate the robustness of OCAT embedding in integrating multiple datasets. We reported the NMI of cell type clustering using OCAT embeddings with <italic>m</italic><sub>1</sub>=<italic>m</italic><sub>2</sub>=45,<italic>d</italic>=70 and <italic>p</italic>=0.3 in Table <xref rid="Tab1" ref-type="table">1</xref>, where <italic>m</italic><sub>1</sub> and <italic>m</italic><sub>2</sub> are the number of “ghost” cells selected for batch 1 and batch 2, respectively. We first set <italic>m</italic><sub>1</sub>=<italic>m</italic><sub>2</sub>=<italic>m</italic> and assessed the sensitivity of <italic>d</italic>, <italic>m</italic>, and <italic>p</italic> on the cell type clustering performance by taking the following hyperparameter values: <italic>d</italic>∈{40,50,60,70,80,90,100,110,120},<italic>m</italic>∈{20,25,30,35,40,45,50,55,60}, and <italic>p</italic>∈{0.1,0.3,0.5,0.7}. Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S4A plots the NMI<sub>cell type</sub> of each hyperparameter combination. The NMI values range from 0.7286 to 0.8007 with a median of 0.7809 and a standard deviation of 0.0144, which implies that the OCAT encoding is robust to the specification variations of <italic>d</italic>, <italic>m</italic>, and <italic>p</italic> in integrating multiple datasets.</p>
        <p>We then assessed how the values of <italic>m</italic><sub>1</sub> and <italic>m</italic><sub>2</sub> impact the OCAT sparse encoding and subsequent clustering performance. We allow <italic>m</italic><sub>1</sub> and <italic>m</italic><sub>2</sub> to be different, taking values <italic>m</italic><sub>1</sub>,<italic>m</italic><sub>2</sub>∈{20,25,30,35,40,45,50,55,60}, while fixing <italic>d</italic>=70 and <italic>p</italic>=0.3. Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S4C plots the NMI<sub>cell type</sub> of each hyperparameter combination with a heatmap. The NMI values range from 0.7378 to 0.8007 with median 0.7812 and standard deviation 0.0162, which implies that the OCAT encoding is robust to the specification of the number of “ghost” cells in each batch.</p>
      </sec>
      <sec id="Sec35">
        <title>Hyperparameter sensitivity analysis in single datasets</title>
        <p>We next assessed the sensitivity of <italic>d</italic>, <italic>m</italic>, and <italic>p</italic> on clustering performance using the Zeisel dataset as an example. We reported the NMI of cell type clustering using OCAT embeddings with <italic>m</italic>=50,<italic>d</italic>=30, and <italic>p</italic>=0.3 in Table <xref rid="Tab2" ref-type="table">2</xref>. Here, we assessed the sensitivity by taking the following hyperparameter values <italic>d</italic>∈{20,30,40,50,60,70,80,90,100},<italic>m</italic>∈{30,35,40,45,50,55,60,65,70}, and <italic>p</italic>∈{0.1,0.3,0.5,0.7}. Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S4B plots the cell type clustering NMI metrics of each hyperparameter combination. Under each combination, the variation of the NMI metrics is minimal, where the NMI values range from 0.6572 to 0.7987 with a median of 0.7591 and a standard deviation of 0.0152. This demonstrates that the OCAT sparse encoding is robust to hyperparameter specifications in cell type clustering with single datasets.</p>
      </sec>
      <sec id="Sec36">
        <title>Hyperparameter sensitivity analysis in downstream tasks</title>
        <p>We further examined the impact of hyperparameter choices on downstream tasks, such as differential gene expression analysis. We used the Zeisel dataset to demonstrate the robustness of OCAT to the choices of <italic>d</italic>, <italic>m</italic>, and <italic>p</italic> in identifying the most differentially expressed genes. In the differential gene expression analysis carried out in this work, we reported the top differentially expressed genes in the Zeisel dataset using OCAT embedding with hyperparameters <italic>d</italic>=30,<italic>m</italic>=50, and <italic>p</italic>=0.3. Here, we assessed the sensitivity by taking the following hyperparameter values <italic>d</italic>∈{20,30,40,50,60,70,80,90,100},<italic>m</italic>∈{30,40,50,60,70}, and <italic>p</italic>∈{0.1,0.3,0.5,0.7}. We compared the top 20 genes selected in each parameter setting with the ones selected in the original analysis with <italic>d</italic>=30,<italic>m</italic>=50, and <italic>p</italic>=0.3. We showed that the top 20 selected genes are highly consistent across all parameter settings. We illustrated the number of overlapped genes in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S8, S9, and S10 for three sample cell types: CA1 pyramidal, S1 pyramidal, and interneurons.</p>
      </sec>
      <sec id="Sec37">
        <title>Hyperparameter recommendations</title>
        <p>OCAT has three hyperparameters, <italic>d</italic> (the dimension of the reduced gene expression matrix), <italic>m</italic> (the number of ghost cells), and <italic>s</italic> (the number of most similar ghost cells). We also reparameterize <italic>s</italic>=<italic>p</italic>∗<italic>m</italic>, where <italic>p</italic> represents the percentage of ghost cells selected to construct the sparsified embeddings. Users can fine-tune either <italic>p</italic> or <italic>s</italic> to adjust the sparsity of the OCAT embedding.</p>
        <p>The choice of <italic>d</italic> should be based on the number of genes. In general, we recommend <italic>d</italic> to be around 1/100 times the number of genes, and the value of <italic>d</italic> should range from 30 to 150. The choice of <italic>m</italic> should be based on the number of cells in each dataset as well as the number of cell type clusters. We recommend <italic>m</italic> to be around 1/100 times the number of cells, and the value of <italic>m</italic> should range from 20 to 100. Another consideration when choosing <italic>m</italic> is the number of cell type clusters. We suggest increasing the value of <italic>m</italic> if the users desire more subclusters. For example, for a dataset with 5,000 cells, we suggest <italic>m</italic>=50. However, if the users would like to see more than 30 subclusters, <italic>m</italic> should increase to 60 or 70. The choice of <italic>p</italic> is based on the desired sparsity for the OCAT encoding. We have shown in the “<xref rid="Sec33" ref-type="sec">Hyperparameter selection and sensitivity analysis</xref>” section that OCAT is robust to the choice of <italic>p</italic>. We recommend <italic>p</italic> is set to 0.3 (the default value) so that the OCAT embedding is sparse and computationally efficient.</p>
        <p>We have shown in the “<xref rid="Sec33" ref-type="sec">Hyperparameter selection and sensitivity analysis</xref>” section that the OCAT is robust to the choice of hyperparameter values in both clustering and downstream analysis. This general recommendation provides a guideline for users to navigate their exploratory analysis. For advanced users who wish to identify their desirable hyperparameter settings, OCAT offers a hyperparameter tuning functionality that examines multiple combinations of hyperparameter values and returns suitable evaluation metrics for advanced users (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Notes 2.1 for details).</p>
      </sec>
    </sec>
    <sec id="Sec38">
      <title>Differential gene expression analysis and comparison</title>
      <p>OCAT effectively identifies the differential genes for cell type annotation. We demonstrate the performance of OCAT differential gene expression analysis using the Zeisel dataset [<xref ref-type="bibr" rid="CR19">19</xref>]. We summarize the top 5 OCAT selected differential genes in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S6 and show that OCAT manages to replicate the marker genes reported by Zeisel et al. [<xref ref-type="bibr" rid="CR19">19</xref>], for example, <italic>Gad1</italic> and <italic>Gad2</italic> genes for interneuron cells and <italic>Acta2</italic> gene for mural cells.</p>
      <p>We further compare the top differentially expressed genes for each cell type identified by OCAT and Seurat and report the number of top differentially expressed genes selected by both methods. Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S6 summarizes the top 5 differential genes identified by both OCAT and Seurat, and the identified genes are highly consistent for most cell types. We also compare the top <italic>k</italic> differential genes identified by the two methods, and plot the number of overlapped genes (≤<italic>k</italic>) against <italic>k</italic>, the number of top differentially expressed genes, in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S6. The closer a dot to the diagonal line, the more overlap between the top differentially expressed genes selected by both methods. The plotted line for each cell type is close to the dotted diagonal line, which suggests that the top differentially expressed genes selected by OCAT and Seurat are highly consistent.</p>
    </sec>
    <sec id="Sec39">
      <title>Benchmarking specifics</title>
      <sec id="Sec40">
        <title>Integrating multiple datasets</title>
        <p>We benchmark the cell type clustering performance and batch correction performance of OCAT against Seurat v3 [<xref ref-type="bibr" rid="CR4">4</xref>], Scanorama [<xref ref-type="bibr" rid="CR2">2</xref>], and Harmony [<xref ref-type="bibr" rid="CR5">5</xref>]. We followed the recommended settings and workflows of all the methods, with the specific parameters as follows. For Seurat v3, we followed the default settings, with no cells or genes screened out and selected 2000 most variable genes. We chose the top 50 principal components as the Seurat embeddings for the cells. To benchmark against Harmony, we adopted the Seurat object pre-processed as in the Seurat v3 benchmarking process, but extracted the top 50 features as the Harmony features using the RunHarmony function. For Scanorama, we added a manual step to normalize the raw scRNA-seq count matrix, and ran its recommended pipeline. We subsequently performed <italic>k</italic>-means clustering on the embeddings using the KMeans function and computed the NMI, AMI, and ARI for batch correction and cell type clustering metrics using the adjusted_rand_score, adjusted_mutual_info_score, normalized_mutual_info_score functions from the sklearn python package.</p>
      </sec>
      <sec id="Sec41">
        <title>Individual scRNA-seq datasets</title>
        <p>We benchmarked the cell type clustering performance of OCAT with Seurat v3 [<xref ref-type="bibr" rid="CR4">4</xref>], scVI [<xref ref-type="bibr" rid="CR22">22</xref>], and SIMLR [<xref ref-type="bibr" rid="CR23">23</xref>]. For Seurat v3, we followed the default settings, with no cells screened out in the gene by cell count matrix. We chose the top 50 principal components as the Seurat features of the single cells. We adopt the Seurat default FindClusters function to cluster the cells. When benchmarking with scVI (version 0.6.5), we followed the default settings, and down-sampled 500 most variable genes out of all the genes available. We set the maximum number of epochs as 400, and used 90% of the dataset as the training set. We lastly used <italic>k</italic>-means to predict the clusters of the cells. We also benchmarked OCAT with SIMLR. SIMLR takes the same raw cell by gene matrix as OCAT. We adopted the SIMLR_Large_Scale function for all datasets. For the Zeisel dataset, we transformed the gene expression matrix <italic>X</italic> to log(<italic>X</italic>+1), and set the SIMLR tuning parameter <italic>k</italic>=50 and assessed the number of principal components <italic>k</italic><italic>k</italic>=150. For the PBMC dataset, we used the raw cell by gene matrix and adopted the default SIMLR settings <italic>k</italic>=10 and <italic>k</italic><italic>k</italic>=100. For the retina dataset, we used the raw cell by gene matrix and set the tuning parameter <italic>k</italic>=30 and <italic>k</italic><italic>k</italic>=300. For the Romanov dataset, we used the raw cell by gene matrix and set the tuning parameter <italic>k</italic>=25 and <italic>k</italic><italic>k</italic>=400. We performed <italic>k</italic>-means clustering on the embeddings using the KMeans function and computed the NMI, AMI, and ARI for cell type clustering metrics using the adjusted_rand_score, adjusted_mutual_info_score, normalized_mutual_info_score functions from the sklearn python package.</p>
      </sec>
      <sec id="Sec42">
        <title>Benchmarking OCAT trajectory and pseudotime inference</title>
        <p>We benchmarked OCAT’s trajectory and pseudotime inference performance with Slingshot [<xref ref-type="bibr" rid="CR31">31</xref>], PAGA Tree [<xref ref-type="bibr" rid="CR32">32</xref>], and Monocle ICA [<xref ref-type="bibr" rid="CR33">33</xref>] using the dynverse R package on 28 gold standard real datasets [<xref ref-type="bibr" rid="CR30">30</xref>]. The input datasets consist of expression matrices from a wide range of dynamic processes and sequencing technologies. The gold standard annotations on trajectory topologies were obtained from biological evidence besides the expression matrices, including four different trajectory types (i.e., linear, tree, multifurcation, bifurcation). We evaluated the trajectory and pseudotime assignment by each method using five aggregated metrics (features, cell positions, neighborhood, topology, branch assignment) derived from 16 dynverse metrics (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S7 for details on metric aggregation and interpretation).</p>
        <p>In OCAT’s benchmarking workflow, for each dataset, we first extracted the OCAT sparse encodings of the single cells, with hyperparameters <italic>d</italic> by package default and <italic>m</italic> selected based on the number of single cells. We subsequently inferred cluster labels by <italic>k</italic>-means clustering on the sparse encodings and then ran OCAT trajectory analysis to estimate the cell lineages. For pseudotime analysis, we used the root cluster inferred by OCAT in the previous trajectory step as input. For Slingshot [<xref ref-type="bibr" rid="CR31">31</xref>], PAGA Tree [<xref ref-type="bibr" rid="CR32">32</xref>], and Monocle ICA [<xref ref-type="bibr" rid="CR33">33</xref>], we used the benchmarking pipeline provided by Saelens et al. [<xref ref-type="bibr" rid="CR30">30</xref>] with dynverse-specified hyperparameters, which computes the lineages and pseudotime of the single cells in the reduced feature space for each dataset in a similar fashion.</p>
      </sec>
    </sec>
    <sec id="Sec43">
      <title>Runtime and memory usage</title>
      <p>We benchmarked the runtime and memory usage of OCAT against Seurat v3 [<xref ref-type="bibr" rid="CR4">4</xref>], Harmony [<xref ref-type="bibr" rid="CR5">5</xref>], and Scanorama [<xref ref-type="bibr" rid="CR2">2</xref>]. We timed the function call that performs data integration using the time.time() function in Python. We monitored the memory usage with HTOP and recorded the maximum memory usage occurred during the execution of each integration pipeline on a desktop workstation (Intel(R) Xeon(R) CPU @ 3.60 GHz processor).</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec44">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2022_2659_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Supplementary notes on the online Fast Similarity Matching (FSM) and Local Anchor Embedding (LAE) algorithms used in OCAT.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2022_2659_MOESM2_ESM.xls">
            <caption>
              <p><bold>Additional file 2</bold> Supplementary Tables S1-S9.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2022_2659_MOESM3_ESM.pdf">
            <caption>
              <p><bold>Additional file 3</bold> Supplementary Figures S1-S10.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2022_2659_MOESM4_ESM.docx">
            <caption>
              <p><bold>Additional file 4</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Chloe X. Wang and Lin Zhang contributed equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Dr. Mehran Karimzadeh, Hassaan Maan, Zeinab Navidi, Ronald Xie, and Anh Do for their helpful comments on the manuscript.</p>
    <sec id="d32e5946">
      <title>Peer review information</title>
      <p>Wenjing She was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="d32e5951">
      <title>Review history</title>
      <p>The review history is available as Additional file <xref rid="MOESM4" ref-type="media">4</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>CXW and LZ contributed equally to this work. CXW and LZ developed the method, analyzed the data, plotted the figures, generated the tables, and wrote the manuscript. BW conceptualized and supervised the study. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research is supported by the Natural Sciences and Engineering Research Council of Canada (NSERC, RGPIN-2020-06189 and DGECR-2020-00294) and the Canadian Institutes of Health Research (CIHR, MOP-310732) to BW. BW is a Canadian Institute for Advanced Research (CIFAR) Artificial Intelligence (AI) chair.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All data can be freely downloaded and are described in the “<xref rid="Sec12" ref-type="sec">Methods</xref>” section. The human dendritic dataset consists of human blood dendritic cells scRNA-seq data from GEO accession GSE80171 [<xref ref-type="bibr" rid="CR7">7</xref>]. The dataset is further split into two batches by Tran et al. [<xref ref-type="bibr" rid="CR8">8</xref>]. The mouse atlas datasets are from GEO under accession GSE108097 [<xref ref-type="bibr" rid="CR16">16</xref>] and GSE109774 [<xref ref-type="bibr" rid="CR38">38</xref>]. The human pancreas datasets are retrieved from GEO accession numbers GSE85241 [<xref ref-type="bibr" rid="CR9">9</xref>], E-MTAB-5061 [<xref ref-type="bibr" rid="CR10">10</xref>], GSE84133 [<xref ref-type="bibr" rid="CR11">11</xref>], GSE83139 [<xref ref-type="bibr" rid="CR12">12</xref>], and GSE81608 [<xref ref-type="bibr" rid="CR13">13</xref>]. The PBMC dataset is available from Short Read Archive under accession number SRP073767 [<xref ref-type="bibr" rid="CR21">21</xref>]. The mouse hematopoietic dataset was retrieved from GEO GSE81682 [<xref ref-type="bibr" rid="CR17">17</xref>] and GSE72857 [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
    <p>The Romanov dataset can be retrieved from GEO GSE74672 [<xref ref-type="bibr" rid="CR18">18</xref>]. The Zeisel dataset can be retrieved from GEO GSE60361 [<xref ref-type="bibr" rid="CR19">19</xref>]. The mouse retina dataset can be retrieved from GEO GSE81905 [<xref ref-type="bibr" rid="CR20">20</xref>]. The PBMC 68k dataset can be retrieved from the Short Read Archive under accession number SRP073767 [<xref ref-type="bibr" rid="CR21">21</xref>]. The human skeletal muscle myoblast dataset can be retrieved from GEO, accession number GSE52529 [<xref ref-type="bibr" rid="CR28">28</xref>].</p>
    <p>The OCAT python package and code used to analyze the data is deposited in Zenodo (doi: 10.5281/zenodo.6270539) [<xref ref-type="bibr" rid="CR40">40</xref>] and is freely available with vignettes on the GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/bowang-lab/OCAT">https://github.com/bowang-lab/OCAT</ext-link> under a GPLv3 license [<xref ref-type="bibr" rid="CR34">34</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haghverdi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lun</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Batch effects in single-cell rna-sequencing data are corrected by matching mutual nearest neighbors</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>5</issue>
        <fpage>421</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4091</pub-id>
        <pub-id pub-id-type="pmid">29608177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hie</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bryson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Efficient integration of heterogeneous single-cell transcriptomes using scanorama</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>6</issue>
        <fpage>685</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0113-3</pub-id>
        <pub-id pub-id-type="pmid">31061482</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Polański</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Miao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J-E</given-names>
          </name>
        </person-group>
        <article-title>Bbknn: fast batch alignment of single cell transcriptomes</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>3</issue>
        <fpage>964</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="pmid">31400197</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck III</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <issue>7</issue>
        <fpage>1888</fpage>
        <lpage>902</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korsunsky</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Millard</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Slowikowski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Baglaenko</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Loh</surname>
            <given-names>P-r</given-names>
          </name>
          <name>
            <surname>Raychaudhuri</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fast, sensitive and accurate integration of single-cell data with Harmony</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>12</issue>
        <fpage>1289</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0619-0</pub-id>
        <pub-id pub-id-type="pmid">31740819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>S-F</given-names>
          </name>
        </person-group>
        <article-title>Large graph construction for scalable semi-supervised learning</article-title>
        <source>ICML</source>
        <year>2010</year>
        <publisher-loc>Haifa</publisher-loc>
        <publisher-name>Omnipress</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Villani</surname>
            <given-names>A-C</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Reynolds</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sarkizova</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fletcher</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Griesbeck</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lazo</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell rna-seq reveals new types of human blood dendritic cells, monocytes, and progenitors</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>356</volume>
        <issue>6335</issue>
        <fpage>eaah4573</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aah4573</pub-id>
        <pub-id pub-id-type="pmid">28428369</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tran</surname>
            <given-names>HTN</given-names>
          </name>
          <name>
            <surname>Ang</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Chevrier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>NYS</given-names>
          </name>
          <name>
            <surname>Goh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A benchmark of batch-effect correction methods for single-cell rna sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1850-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wolock</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Faust</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Gaujoux</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vetere</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Shen-Orr</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter-and intra-cell population structure</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>346</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id>
        <pub-id pub-id-type="pmid">27667365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muraro</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Dharmadhikari</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Grün</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Groen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dielen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jansen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>van Gurp</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Engelse</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Carlotti</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>de Koning</surname>
            <given-names>EJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptome atlas of the human pancreas</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>385</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.09.002</pub-id>
        <pub-id pub-id-type="pmid">27693023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>Å.</given-names>
          </name>
          <name>
            <surname>Palasantza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eliasson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>E-M</given-names>
          </name>
          <name>
            <surname>Andréasson</surname>
            <given-names>A-C</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sabirsh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Clausen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bjursell</surname>
            <given-names>MK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>
        <source>Cell Metab</source>
        <year>2016</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.020</pub-id>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>YJ</given-names>
          </name>
          <name>
            <surname>Schug</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Won</surname>
            <given-names>K-J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Naji</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Avrahami</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Golson</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Kaestner</surname>
            <given-names>KH</given-names>
          </name>
        </person-group>
        <article-title>Single-cell transcriptomics of the human endocrine pancreas</article-title>
        <source>Diabetes</source>
        <year>2016</year>
        <volume>65</volume>
        <issue>10</issue>
        <fpage>3028</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.2337/db16-0405</pub-id>
        <pub-id pub-id-type="pmid">27364731</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Okamoto</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Adler</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Yancopoulos</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gromada</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>RNA sequencing of single human islet cells reveals type 2 diabetes genes</article-title>
        <source>Cell Metab</source>
        <year>2016</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>608</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.018</pub-id>
        <pub-id pub-id-type="pmid">27667665</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hicks</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Townes</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Teng</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Missing data and technical variability in single-cell RNA-sequencing experiments</article-title>
        <source>Biostatistics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>4</issue>
        <fpage>562</fpage>
        <lpage>78</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxx053</pub-id>
        <pub-id pub-id-type="pmid">29121214</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tung</surname>
            <given-names>P-Y</given-names>
          </name>
          <name>
            <surname>Blischak</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Hsiao</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Knowles</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Burnett</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Gilad</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Batch effects and the effective design of single-cell gene expression studies</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-016-0028-x</pub-id>
        <pub-id pub-id-type="pmid">28127051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fei</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Saadatpour</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping the mouse cell atlas by microwell-seq</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>172</volume>
        <issue>5</issue>
        <fpage>1091</fpage>
        <lpage>107</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.02.001</pub-id>
        <pub-id pub-id-type="pmid">29474909</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nestorowa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hamey</surname>
            <given-names>FK</given-names>
          </name>
          <name>
            <surname>Pijuan Sala</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Diamanti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Shepherd</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Laurenti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>NK</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Göttgens</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A single-cell resolution map of mouse hematopoietic stem and progenitor cell differentiation</article-title>
        <source>Blood J Am Soc Hematol</source>
        <year>2016</year>
        <volume>128</volume>
        <issue>8</issue>
        <fpage>20</fpage>
        <lpage>31</lpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Romanov</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bakker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Girach</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hellysaz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tomer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Alpar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mulder</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Clotman</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Keimpema</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular interrogation of hypothalamic organization reveals distinct dopamine neuronal subtypes</article-title>
        <source>Nat Neurosci</source>
        <year>2017</year>
        <volume>20</volume>
        <issue>2</issue>
        <fpage>176</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.4462</pub-id>
        <pub-id pub-id-type="pmid">27991900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Muñoz-Manchado</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Codeluppi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lönnerberg</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Juréus</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marques</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Munguba</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Betsholtz</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell rna-seq</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>347</volume>
        <issue>6226</issue>
        <fpage>1138</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id>
        <pub-id pub-id-type="pmid">25700174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lapan</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Whitney</surname>
            <given-names>IE</given-names>
          </name>
          <name>
            <surname>Tran</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Kowalczyk</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Adiconis</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Levin</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>166</volume>
        <issue>5</issue>
        <fpage>1308</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.07.054</pub-id>
        <pub-id pub-id-type="pmid">27565351</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>GX</given-names>
          </name>
          <name>
            <surname>Terry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Belgrader</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ryvkin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bent</surname>
            <given-names>ZW</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ziraldo</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>McDermott</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-016-0009-6</pub-id>
        <pub-id pub-id-type="pmid">28232747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Regier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Deep generative modeling for single-cell transcriptomics</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>1053</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0229-2</pub-id>
        <pub-id pub-id-type="pmid">30504886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pierson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ramazzotti</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Visualization and analysis of single-cell rna-seq data by kernel-based similarity learning</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>414</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4207</pub-id>
        <pub-id pub-id-type="pmid">28263960</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>What is a support vector machine?</article-title>
        <source>Nat Biotechnol</source>
        <year>2006</year>
        <volume>24</volume>
        <issue>12</issue>
        <fpage>1565</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1206-1565</pub-id>
        <pub-id pub-id-type="pmid">17160063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consortium</surname>
            <given-names>TM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics of 20 mouse organs creates a tabula muris</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>562</volume>
        <issue>7727</issue>
        <fpage>367</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0590-4</pub-id>
        <pub-id pub-id-type="pmid">30283141</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rapaport</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Khanin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pirun</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Krek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zumbo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Socci</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Betel</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive evaluation of differential gene expression analysis methods for RNA-seq data</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>9</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-9-r95</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kruskal</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>On the shortest spanning subtree of a graph and the traveling salesman problem</article-title>
        <source>Proc Am Math Soc</source>
        <year>1956</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>48</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1090/S0002-9939-1956-0078686-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cacchiarelli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Grimsby</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pokharel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Morse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lennon</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Livak</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <issue>4</issue>
        <fpage>381</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id>
        <pub-id pub-id-type="pmid">24658644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tran</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Bader</surname>
            <given-names>GD</given-names>
          </name>
        </person-group>
        <article-title>Tempora: Cell trajectory inference using time-series single-cell RNA sequencing data</article-title>
        <source>PLoS Comput Biol</source>
        <year>2020</year>
        <volume>16</volume>
        <issue>9</issue>
        <fpage>1008205</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008205</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saelens</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cannoodt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Todorov</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A comparison of single-cell trajectory inference methods</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>5</issue>
        <fpage>547</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0071-9</pub-id>
        <pub-id pub-id-type="pmid">30936559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Street</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fletcher</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ngai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Purdom</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Slingshot: cell lineage and pseudotime inference for single-cell transcriptomics</article-title>
        <source>BMC Genomics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1186/s12864-018-4772-0</pub-id>
        <pub-id pub-id-type="pmid">29291715</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Hamey</surname>
            <given-names>FK</given-names>
          </name>
          <name>
            <surname>Plass</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Solana</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dahlin</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Göttgens</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Rajewsky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Paga: graph abstraction reconciles clustering with trajectory inference through a topology preserving map of single cells</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1663-x</pub-id>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Mao</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chawla</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>10</issue>
        <fpage>979</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4402</pub-id>
        <pub-id pub-id-type="pmid">28825705</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <mixed-citation publication-type="other">Wang C, Zhang L, Wang B. OCAT: A unified framework to integrate and analyze single-cell RNA-seq data. GitHub. 2021. <ext-link ext-link-type="uri" xlink:href="https://github.com/bowang-lab/OCAT">https://github.com/bowang-lab/OCAT</ext-link>. Accessed 07 Oct 2021.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Giovannucci</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Minden</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pehlevan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chklovskii</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Efficient principal subspace projection of streaming data through fast similarity matching</article-title>
        <source>2018 IEEE International Conference on Big Data (Big Data)</source>
        <year>2018</year>
        <publisher-loc>Seattle</publisher-loc>
        <publisher-name>IEEE</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pearl</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Probabilistic reasoning in intelligent systems: networks of plausible inference</source>
        <year>1988</year>
        <publisher-loc>San Francisco</publisher-loc>
        <publisher-name>Morgan kaufmann</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Buitinck</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Louppe</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Blondel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mueller</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grisel</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Niculae</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Prettenhofer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gramfort</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grobler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Layton</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>VanderPlas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Joly</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Holt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>API design for machine learning software: experiences from the scikit-learn project</article-title>
        <source>ECML PKDD Workshop: languages for data mining and machine learning</source>
        <year>2013</year>
        <publisher-loc>Prague</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schaum</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Karkanias</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Neff</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>May</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Wyss-Coray</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Darmanis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Batson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Botvinnik</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>MB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics of 20 mouse organs creates a tabula muris: the Tabula Muris Consortium</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>562</volume>
        <issue>7727</issue>
        <fpage>367</fpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0590-4</pub-id>
        <pub-id pub-id-type="pmid">30283141</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paul</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Giladi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jaitin</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Kenigsberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Keren-Shaul</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Winter</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lara-Astiaso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gury</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weiner</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptional heterogeneity and lineage commitment in myeloid progenitors</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>163</volume>
        <issue>7</issue>
        <fpage>1663</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.11.013</pub-id>
        <pub-id pub-id-type="pmid">26627738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <mixed-citation publication-type="other">Wang C, Zhang L, Wang B. OCAT: a unified framework to integrate and analyze single-cell RNA-seq data. Zenodo. 2022. 10.5281/zenodo.6270540.</mixed-citation>
    </ref>
  </ref-list>
</back>
