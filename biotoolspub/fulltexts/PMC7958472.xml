<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7958472</article-id>
    <article-id pub-id-type="publisher-id">3970</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-03970-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>stochprofML: stochastic profiling using maximum likelihood estimation in R</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Amrhein</surname>
          <given-names>Lisa</given-names>
        </name>
        <address>
          <email>lisa.amrhein@helmholtz-muenchen.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3565-8315</contrib-id>
        <name>
          <surname>Fuchs</surname>
          <given-names>Christiane</given-names>
        </name>
        <address>
          <email>christiane.fuchs@uni-bielefeld.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.4567.0</institution-id><institution-id institution-id-type="ISNI">0000 0004 0483 2525</institution-id><institution>Institute of Computational Biology, </institution><institution>Helmholtz Zentrum München, </institution></institution-wrap>Ingolstädter Landstrasse 1, 85764 Neuherberg, Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.6936.a</institution-id><institution-id institution-id-type="ISNI">0000000123222966</institution-id><institution>Department of Mathematics, </institution><institution>Technical University Munich, </institution></institution-wrap>Boltzmannstrasse 3, 85748 Garching, Germany </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.7491.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 0944 9128</institution-id><institution>Faculty of Business Administration and Economics, </institution><institution>Bielefeld University, </institution></institution-wrap>Universitätsstrasse 25, 33615 Bielefeld, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>123</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Tissues are often heterogeneous in their single-cell molecular expression, and this can govern the regulation of cell fate. For the understanding of development and disease, it is important to quantify heterogeneity in a given tissue.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present the R package stochprofML which uses the maximum likelihood principle to parameterize heterogeneity from the cumulative expression of small random pools of cells. We evaluate the algorithm’s performance in simulation studies and present further application opportunities.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">Stochastic profiling outweighs the necessary demixing of mixed samples with a saving in experimental cost and effort and less measurement error. It offers possibilities for parameterizing heterogeneity, estimating underlying pool compositions and detecting differences between cell populations between samples.</p>
      </sec>
      <sec>
        <title>Supplementary information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-021-03970-7.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>StochprofML</kwd>
      <kwd>Stochastic profiling</kwd>
      <kwd>Gene expression</kwd>
      <kwd>Cell-to-cell heterogeneity</kwd>
      <kwd>Mixture models</kwd>
      <kwd>Deconvolution</kwd>
      <kwd>Maximum likelihood estimation</kwd>
      <kwd>R</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>SFB 1243</award-id>
        <principal-award-recipient>
          <name>
            <surname>Fuchs</surname>
            <given-names>Christiane</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002347</institution-id>
            <institution>Bundesministerium für Bildung und Forschung</institution>
          </institution-wrap>
        </funding-source>
        <award-id>01DH17024</award-id>
        <principal-award-recipient>
          <name>
            <surname>Fuchs</surname>
            <given-names>Christiane</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Helmholtz Initiating and Networking Funds</institution>
        </funding-source>
        <award-id>Pilot Project Uncertainty Quantification</award-id>
        <principal-award-recipient>
          <name>
            <surname>Fuchs</surname>
            <given-names>Christiane</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000009</institution-id>
            <institution>Foundation for the National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U01-CA215794</award-id>
        <principal-award-recipient>
          <name>
            <surname>Fuchs</surname>
            <given-names>Christiane</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Universität Bielefeld (3146)</institution>
        </funding-source>
      </award-group>
      <open-access>
        <p>Open Access funding enabled and organized by Projekt DEAL.</p>
      </open-access>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par14">Tissues are built of cells which contain their genetic information on DNA strings, so-called <italic>genes</italic>. These genes can lead to the generation of <italic>messenger RNA (mRNA)</italic> which transports the genetic information and induces the production of <italic>proteins</italic>. Such mRNA molecules and proteins are modes of expression by which a cell reflects the presence, kind and activity of its genes. In this paper, we consider such <italic>gene expression</italic> in terms of quantities of mRNA molecules.</p>
    <p id="Par15">Gene expression is stochastic. It can differ significantly between, e.g., types of cells or tissues, and between individuals. In that case, one refers to <italic>differential gene expression</italic>. In particular, cells can be differentially expressed between healthy and sick tissue samples from the same origin. Moreover, cells can differ even within a small tissue sample, e.g. within a tumour that consists of several mutated cell populations. Mathematically, we regard two populations to be different if their mRNA counts follow different probability distributions. If there is more than one population in a tissue, we call it heterogeneous. The expression of such tissues can be described by mixture models. Detecting and parameterizing heterogeneities is of utmost importance for understanding development and disease.</p>
    <p id="Par16">The amount of mRNA molecules of a gene in a tissue sample can be assessed by various techniques such as microarray measurements [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>] or sequencing [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. Bulk measurements are suitable for analyses like mean comparisons but make it difficult to describe in-bulk heterogeneity. To infer partial information about cell populations, bulk deconvolution methods like CIBERSORT [<xref ref-type="bibr" rid="CR5">5</xref>] require the availability of so-called signature matrices. Measurements of single cells yield the highest possible resolution. They are best suited for identification and description of heterogeneity in large and error-free datasets. In practice, however, single-cell data often comes along with high cost, effort and technical noise [<xref ref-type="bibr" rid="CR6">6</xref>]. Heterogeneity can still be revealed given sufficient sample size and additional information such as the expression of cell cycle genes [e.g. <xref ref-type="bibr" rid="CR7">7</xref>]. In our work, we consider the case of comparatively small samples without further prior knowledge. Instead of considering single-cell data, we analyze the cumulative gene expression of small pools of randomly selected cells [<xref ref-type="bibr" rid="CR8">8</xref>]. The pool size should be large enough to substantially reduce measurement error and cost, and at the same time small enough such that heterogeneity is still identifiable. The analysis of such small cell pools could add additional information that is lost in single-cell measurements due to the stress in which the cells find themselves once they are separated from their tissue.</p>
    <p id="Par17">Such new kind of data requires new analysis tools. We thus developed the algorithm stochprofML to infer single-cell regulatory states from small pools of cells [<xref ref-type="bibr" rid="CR9">9</xref>]. In contrast to previously existing deconvolution methods, which were not tailored to small cell pools, it neither requires a priori knowledge about the mixing weights such as the csSAM [<xref ref-type="bibr" rid="CR10">10</xref>] or DSection [<xref ref-type="bibr" rid="CR11">11</xref>] algorithms nor about expression profiles which is required when using for example the qproq [<xref ref-type="bibr" rid="CR12">12</xref>] or lsfit [<xref ref-type="bibr" rid="CR13">13</xref>] tools. Only the CAM method [<xref ref-type="bibr" rid="CR14">14</xref>] performs unsupervised deconvolution for clusters of genes, however with the aim to find marker genes. Several of these methods are implemented in the R package CellMix [<xref ref-type="bibr" rid="CR15">15</xref>], but for the above reasons, they are not directly comparable. In [<xref ref-type="bibr" rid="CR9">9</xref>], we still demonstrated on synthetic data how stochastic profiling led to more accurate estimates than competing approaches.</p>
    <p id="Par18">Recently, tools were developed with the aim to deconvolute bulk measurements using the available huge datasets of single-cell data or purified bulk samples such as AutoGeneS [<xref ref-type="bibr" rid="CR16">16</xref>], dtangle [<xref ref-type="bibr" rid="CR17">17</xref>] or CPM [<xref ref-type="bibr" rid="CR18">18</xref>]. However, deconvolution without any basis such as purified expression datasets of subpopulations or other prior knowledge is much harder. Here we present the stochastic profiling algorithm that blindly deconvolves the joint measurements purely by applying a combinatorial mixture model.</p>
    <p id="Par19">In [<xref ref-type="bibr" rid="CR9">9</xref>], we applied stochprofML to measurements from human breast epithelial cells and revealed the functional relevance of the heterogeneous expression of a particular gene. Fluorescence in situ hybridization confirmed that the computationally identified population fractions corresponded to experimentally detected transcriptional populations. In a second study, we applied the algorithm to clonal tumor spheroids of colorectal cancer [<xref ref-type="bibr" rid="CR19">19</xref>]. There, a single tumor cell was cultured, and after several rounds of replication, each resulting spheroid was imaged and sequenced. However, pool sizes differed between tissue samples as each spheroid contained a different number of cells ranging from less than ten to nearly 200 cells. Therefore, we extended stochprofML to be able to handle pools of different sizes.</p>
    <p id="Par20">In this work, we present such modeling extensions alongside numerical and computational detail. We explore the performance of the algorithm in simulation studies for various settings, especially in the realistic case of uncertainty about the pool size. To expand the range of applications, we propose a test for significant differences between the estimated populations and inference of original pool compositions.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par21">The stochprofML algorithm aims at maximum likelihood estimation of the corresponding model parameters. Hence, we derive the likelihood functions of the parameters and show details of the estimation and its implementation. The new elements of the most recent version of the algorithm are introduced along the line. Note that we will use a combinatorial mixture since this we aim for a blind convolution model that does not need any prior input information on the contained subpopulations or their fractions.</p>
    <sec id="Sec3">
      <title>Notation</title>
      <p id="Par22">Suppose there are <italic>k</italic> (tissue) samples, indexed by <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \{ 1,\ldots ,k\}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq1.gif"/></alternatives></inline-formula>. From each tissue sample <italic>i</italic>, we collect a pool of a known number of cells. The cells are either indexed by <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j \in \{ 1,\ldots ,n\}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq2.gif"/></alternatives></inline-formula> if the cell pool size is the same in all measurements, or, as possible in the latest implementation, by <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j_i \in \{ 1,\ldots ,n_i\}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq3.gif"/></alternatives></inline-formula> in case cell pool sizes vary between measurements. In the latter, more general case, the cell numbers are variable over the <italic>k</italic> cell pools and summarized by <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{n} = (n_1,\ldots , n_k )$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq4.gif"/></alternatives></inline-formula>. From each sample, the gene expression of <italic>m</italic> genes is measured, indexed by <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g \in \{ 1,\ldots ,m\}$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq5.gif"/></alternatives></inline-formula>. We assume that each cell stems from one out of <italic>T</italic> cell populations, indexed by <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h \in \{ 1,\ldots ,T\}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>h</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq6.gif"/></alternatives></inline-formula>. If <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T&gt;1$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>T</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq7.gif"/></alternatives></inline-formula> in the set of all cells of interest, the tissue is called heterogeneous. The notation is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Biologically, the different cell populations correspond to different regulatory states or—especially in the context of cancer—to different (sub-)clones. For example, there might be two populations within a considered tissue: one occupying a basal regulatory state, where the expression of genes is at a low level, and one from a second regulatory state, where genes are expressed at a higher level.<fig id="Fig1"><label>Fig. 1</label><caption><p>Experimental design of pooling cells into samples, measuring the pooled gene expression across several genes for which identical population structures are assumed. The table illustrates the index notation of (tissue) samples, single cells, populations and genes as well as observed and latent measurements</p></caption><graphic xlink:href="12859_2021_3970_Fig1_HTML" id="MO42"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Single-cell models of heterogeneous gene expression</title>
      <p id="Par23">As described above, there are various technologies to measure gene expression. Microarrays (as considered in previous applications of stochastic profiling, see [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]) measure relative gene expression, which is appropriately described in terms of continuous probability distributions. Sequencing experiments produce discrete molecule counts. However, if these numbers are large, or if preprocessing blurs the discrete character of the data, one often describes such sequencing output by continuous probability distributions as well. Conditioned on the cell population, stochprofML provides two continuous choices for the single-cell distribution of the expression of one gene:</p>
      <sec id="Sec5">
        <title>Lognormal distribution</title>
        <p id="Par24">The two parameters defining a univariate lognormal distribution <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{L}}{\mathcal{N}}(\mu ,\sigma ^2)$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq8.gif"/></alternatives></inline-formula> are called log-mean <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu \in {\mathbb{R}}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq9.gif"/></alternatives></inline-formula> and log-standard deviation <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma &gt;0$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq10.gif"/></alternatives></inline-formula>. These are the mean and the standard deviation of the normally distributed random variable <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log (X)$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq11.gif"/></alternatives></inline-formula>, the natural logarithm of <italic>X</italic>. The probability density function (PDF) of <italic>X</italic> is given by<disp-formula id="Equ8"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_\text{LN}(x|\mu , \sigma ^2) = \frac{1}{\sqrt{2\pi }\sigma x}\,\exp \left( -\frac{(\log x-\mu )^2}{2\sigma ^2}\right) \quad \text{for }x&gt;0. \end{aligned}$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>LN</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt><mml:mi>σ</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="0.166667em"/><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mfenced><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>A random variable <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X\sim {\mathcal{L}}{\mathcal{N}}(\mu ,\sigma ^2)$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq12.gif"/></alternatives></inline-formula> has expectation and variance<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text{E}(X)= \exp \left( \mu +\frac{\sigma ^2}{2}\right) \qquad \text{and}\qquad \text{Var}(X)=\exp \left( 2\mu +\sigma ^2\right) \left( \exp \left( \sigma ^2\right) -1\right). \end{aligned}$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>E</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mspace width="2em"/><mml:mtext>and</mml:mtext><mml:mspace width="2em"/><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mn>2</mml:mn><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfenced><mml:mfenced close=")" open="("><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec6">
        <title>Exponential distribution</title>
        <p id="Par25">An exponential distribution <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{E}}\! {\mathcal{X}}\! {\mathcal{P}}(\lambda )$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi mathvariant="script">E</mml:mi><mml:mspace width="-0.166667em"/><mml:mi mathvariant="script">X</mml:mi><mml:mspace width="-0.166667em"/><mml:mi mathvariant="script">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq13.gif"/></alternatives></inline-formula> is defined by the rate parameter <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda &gt;0$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq14.gif"/></alternatives></inline-formula>. The PDF is given by<disp-formula id="Equ9"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_{E\! X\! P}(x| \lambda ) = \lambda \exp \left( -\lambda x \right) \quad \text{for }x \ge 0. \end{aligned}$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mspace width="-0.166667em"/><mml:mi>X</mml:mi><mml:mspace width="-0.166667em"/><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:mfenced><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>x</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>A random variable <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X\sim {\mathcal{E}}\! {\mathcal{X}}\! {\mathcal{P}}(\lambda )$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mspace width="-0.166667em"/><mml:mi mathvariant="script">X</mml:mi><mml:mspace width="-0.166667em"/><mml:mi mathvariant="script">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq15.gif"/></alternatives></inline-formula> has expectation and variance<disp-formula id="Equ10"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text{E}(X)= \frac{1}{\lambda }\qquad \text{and}\quad \text{Var}(X)= \frac{1}{\lambda ^2}. \end{aligned}$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>E</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>λ</mml:mi></mml:mfrac><mml:mspace width="2em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>In general, the lognormal distribution is an appropriate description of continuous gene expression [<xref ref-type="bibr" rid="CR20">20</xref>]. With its two parameters, it is more flexible than the exponential distribution. However, the lognormal distribution cannot model zero gene expression as often present in real-world applications. In case of zeros in the data, it could be modified by adding small values such as 0.0001, or one uses the exponential distribution to model this kind of expression. This distribution is an obvious choice to model zero and very low expression as its support includes zero, and with only one distribution parameter it avoids unnecessary model complexity. Furthermore, we will show later that the exponential distribution can be convoluted in closed form.</p>
        <p id="Par26">In case of <italic>T</italic> cell populations, we describe the expression of one gene by a stochastic mixture model. Let <inline-formula id="IEq16"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( p_1, \ldots , p_T\right)$$\end{document}</tex-math><mml:math id="M40"><mml:mfenced close=")" open="("><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq16.gif"/></alternatives></inline-formula> with <inline-formula id="IEq17"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_1+\cdots +p_T=1$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq17.gif"/></alternatives></inline-formula> denote the fractions of populations in the overall set of cells. stochprofML offers the following three mixture models:</p>
      </sec>
      <sec id="Sec7">
        <title>Lognormal–lognormal (LN–LN)</title>
        <p id="Par27">Each population <italic>h</italic> is represented by a lognormal distribution with population-specific parameter <inline-formula id="IEq18"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _h$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>μ</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq18.gif"/></alternatives></inline-formula> (different for each population <italic>h</italic>) and identical <inline-formula id="IEq19"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M46"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq19.gif"/></alternatives></inline-formula> for all <italic>T</italic> populations. The single-cell expression <italic>X</italic> that originates from such a mixture of populations then follows<disp-formula id="Equ11"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} X \sim {\left\{ \begin{array}{ll} {\mathcal{L}}{\mathcal{N}}(\mu _1,\sigma ^2) &amp;{} \text{with probability } p_1\\ \vdots &amp;{}\\ {\mathcal{L}}{\mathcal{N}}(\mu _h,\sigma ^2) &amp;{} \text{with probability } p_h\\ \vdots &amp;{}\\ {\mathcal{L}}{\mathcal{N}}(\mu _T,\sigma ^2) &amp;{} \text{with probability } \left( 1-\sum _{h=1}^{T-1} p_h\right) . \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M48" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∼</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>with probability</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>with probability</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>with probability</mml:mtext><mml:mspace width="0.333333em"/><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec8">
        <title>Relaxed lognormal–lognormal (rLN–LN)</title>
        <p id="Par28">This model is similar to the LN–LN model, but each population <italic>h</italic> is represented by a lognormal distribution with a different parameter set (<inline-formula id="IEq20"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _h$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>μ</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq20.gif"/></alternatives></inline-formula>, <inline-formula id="IEq21"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _h$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>σ</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq21.gif"/></alternatives></inline-formula>). The single-cell expression <italic>X</italic> follows<disp-formula id="Equ12"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} X \sim {\left\{ \begin{array}{ll} {\mathcal{L}}{\mathcal{N}}(\mu _1,\sigma _1^2) &amp;{} \text{with probability } p_1\\ \vdots &amp;{}\\ {\mathcal{L}}{\mathcal{N}}(\mu _h,\sigma _h^2)&amp;{} \text{with probability } p_h\\ \vdots &amp;{}\\ {\mathcal{L}}{\mathcal{N}}(\mu _T,\sigma _T^2) &amp;{} \text{with probability } \left( 1-\sum _{h=1}^{T-1} p_h\right) . \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∼</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>with probability</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>with probability</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>with probability</mml:mtext><mml:mspace width="0.333333em"/><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec9">
        <title>Exponential–lognormal (EXP–LN)</title>
        <p id="Par29">Here, one population is represented by an exponential distribution with parameter <inline-formula id="IEq22"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M56"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq22.gif"/></alternatives></inline-formula>, and all remaining <inline-formula id="IEq23"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T-1$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq23.gif"/></alternatives></inline-formula> populations are modeled by lognormal distributions analogously to LN–LN, i.e. with population-specific parameters <inline-formula id="IEq24"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _h$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>μ</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq24.gif"/></alternatives></inline-formula> and identical <inline-formula id="IEq25"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M62"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq25.gif"/></alternatives></inline-formula>. The single-cell expression <italic>X</italic> then follows<disp-formula id="Equ13"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} X \sim {\left\{ \begin{array}{ll} {\mathcal{L}}{\mathcal{N}}(\mu _1,\sigma ^2)&amp;{} \text{with probability } p_{1}\\ \vdots &amp;{}\\ {\mathcal{L}}{\mathcal{N}}(\mu _h,\sigma ^2)&amp;{} \text{with probability } p_{h}\\ \vdots &amp;{}\\ {\mathcal{L}}{\mathcal{N}}(\mu _{T-1},\sigma ^2) &amp;{} \text{with probability } p_{T-1} \\ {\mathcal{E}}\! {\mathcal{X}}\! {\mathcal{P}}(\lambda ) &amp;{} \text{with probability } \left( 1-\sum _{h=1}^{T-1} p_h\right) .\\ \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M64" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∼</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>with probability</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>with probability</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>with probability</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">E</mml:mi><mml:mspace width="-0.166667em"/><mml:mi mathvariant="script">X</mml:mi><mml:mspace width="-0.166667em"/><mml:mi mathvariant="script">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>with probability</mml:mtext><mml:mspace width="0.333333em"/><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>The LN–LN model is a special case of the rLN–LN model. It assumes identical <inline-formula id="IEq26"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M66"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq26.gif"/></alternatives></inline-formula> across all populations. Biologically, this assumption is motivated by the fact that, for the lognormal distribution, identical <inline-formula id="IEq27"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M68"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq27.gif"/></alternatives></inline-formula> lead to identical coefficient of variation<disp-formula id="Equ14"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text{CV}(X) = \frac{\sqrt{\text{Var}(X)}}{\text{E}(X)}= \sqrt{\exp (\sigma ^2)-1} \end{aligned}$$\end{document}</tex-math><mml:math id="M70" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>CV</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msqrt><mml:mrow><mml:mtext>Var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt><mml:mrow><mml:mtext>E</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>even for different values of <inline-formula id="IEq28"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu$$\end{document}</tex-math><mml:math id="M72"><mml:mi>μ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq28.gif"/></alternatives></inline-formula>. In other words, the linear relationship between the mean expression and the standard deviation is maintained across cell populations in the LN–LN model. The appropriateness of the different mixture models can be discussed both biologically and in terms of statistical model choice.</p>
        <p id="Par30">Within one set of genes under consideration, we assume that the same type of model (LN–LN, rLN–LN, EXP–LN) is appropriate for all genes. The parameter values, however, may differ. In case of <italic>T</italic> cell populations, we describe the single-cell gene expression <inline-formula id="IEq29"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X^{(g)}$$\end{document}</tex-math><mml:math id="M74"><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq29.gif"/></alternatives></inline-formula> for gene <italic>g</italic> by a mixture distribution with PDF<disp-formula id="Equ15"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{}&amp;f_\text{T-pop}\left( x^{(g)} | \right. \, \left. \varvec{\theta }^{(g)}, \varvec{p}\right) \\&amp;\quad =p_1 f_1\left( x^{(g)}|\theta _1^{(g)}\right) + \cdots + p_h f_h\left( x^{(g)}|\theta _h^{(g)}\right) +\cdots + \left( 1-\sum _{h=1}^{T-1} p_h\right) f_T\left( x^{(g)}|\theta _T^{(g)}\right) , \end{aligned}$$\end{document}</tex-math><mml:math id="M76" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>T-pop</mml:mtext></mml:msub><mml:mfenced open="("><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mfenced><mml:mspace width="0.166667em"/><mml:mfenced close=")"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mfenced><mml:msub><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq30"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_h$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mi>f</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq30.gif"/></alternatives></inline-formula> with <inline-formula id="IEq31"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h\in \{1,\ldots , T\}$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi>h</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq31.gif"/></alternatives></inline-formula> represents the PDF of population <italic>h</italic> that can be either lognormal or exponential, and <inline-formula id="IEq32"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\theta }^{(g)}=\{\theta _1^{(g)},\ldots ,\theta _T^{(g)}\}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq32.gif"/></alternatives></inline-formula> are the (not necessarily disjoint) distribution parameters of the <italic>T</italic> populations for gene <italic>g</italic>.</p>
      </sec>
      <sec id="Sec10">
        <title>Example: Mixture of two populations—Part 1</title>
        <p id="Par31">We exemplify the two-population case. Here, the PDF of the mixture distribution for gene <italic>g</italic> reads<disp-formula id="Equ16"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_\text{2-pop} (x^{(g)} |\varvec{\theta }^{(g)})= p f_1 (x^{(g)} |\theta _1^{(g)})+(1-p)f_2 (x^{(g)} |\theta _2^{(g)}), \end{aligned}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>2-pop</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>where <italic>p</italic> is the probability of the first population. The univariate distributions <inline-formula id="IEq33"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_1^{(g)}$$\end{document}</tex-math><mml:math id="M86"><mml:msubsup><mml:mi>f</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_2^{(g)}$$\end{document}</tex-math><mml:math id="M88"><mml:msubsup><mml:mi>f</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq34.gif"/></alternatives></inline-formula> depend on the chosen model:</p>
        <p><bold>LN–LN:</bold><inline-formula id="IEq35"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_1 (x^{(g)} |\theta _1^{(g)}) = f_\text{LN}(x^{(g)} | \mu _1^{(g)}, \sigma ^2)$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext>LN</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq35.gif"/></alternatives></inline-formula> and <inline-formula id="IEq36"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_2(x^{(g)} |\theta _2^{(g)}) = f_\text{LN}(x^{(g)} | \mu _2^{(g)}, \sigma ^2)$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext>LN</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq36.gif"/></alternatives></inline-formula>, i.e. there are four unknown parameters: <inline-formula id="IEq37"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p, \mu _1^{(g)}, \mu _2^{(g)}$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq37.gif"/></alternatives></inline-formula> and <inline-formula id="IEq38"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^2$$\end{document}</tex-math><mml:math id="M96"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq38.gif"/></alternatives></inline-formula>.</p>
        <p id="Par32"><bold>rLN–LN:</bold><inline-formula id="IEq39"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_1 (x^{(g)} |\theta _1^{(g)}) = f_\text{LN}(x^{(g)} | \mu _1^{(g)}, {\sigma _1}^2)$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext>LN</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq39.gif"/></alternatives></inline-formula> and <inline-formula id="IEq40"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_2(x^{(g)} |\theta _2^{(g)}) = f_\text{LN}(x^{(g)} | \mu _2^{(g)}, {\sigma _2}^2)$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext>LN</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq40.gif"/></alternatives></inline-formula> i.e. there are five unknown parameters: <inline-formula id="IEq41"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p, \mu _1^{(g)}, \mu _2^{(g)}, {\sigma _1}^2$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq41.gif"/></alternatives></inline-formula> and <inline-formula id="IEq42"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma _2}^2$$\end{document}</tex-math><mml:math id="M104"><mml:msup><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq42.gif"/></alternatives></inline-formula>.</p>
        <p id="Par33"><bold>EXP–LN:</bold><inline-formula id="IEq43"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_1(x^{(g)} |\theta _1^{(g)}) = f_\text{LN}(x^{(g)} | \mu ^{(g)}, {\sigma }^2)$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext>LN</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq43.gif"/></alternatives></inline-formula> and <inline-formula id="IEq44"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_2(x^{(g)} |\theta _2^{(g)}) = f_\text{EXP}(x^{(g)} | \lambda ^{(g)})$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext>EXP</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq44.gif"/></alternatives></inline-formula>. i.e. there are four unknown parameters: <inline-formula id="IEq45"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p, \mu ^{(g)}$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq45.gif"/></alternatives></inline-formula>, <inline-formula id="IEq46"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^2$$\end{document}</tex-math><mml:math id="M112"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq46.gif"/></alternatives></inline-formula> and <inline-formula id="IEq47"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda ^{(g)}$$\end{document}</tex-math><mml:math id="M114"><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq47.gif"/></alternatives></inline-formula>. Note that although each lognormal population has its individual <inline-formula id="IEq48"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M116"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq48.gif"/></alternatives></inline-formula>, these <inline-formula id="IEq49"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M118"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq49.gif"/></alternatives></inline-formula>-values remain identical across genes in all models.</p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>Small-pool models of heterogeneous gene expression</title>
      <p id="Par34">stochprofML is tailored to analyze gene expression measurements of small pools of cells, beyond the analysis of standard single-cell gene expression data. In other words, the single-cell gene expression <inline-formula id="IEq50"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{ij_i}^{(g)}$$\end{document}</tex-math><mml:math id="M120"><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq50.gif"/></alternatives></inline-formula> described above is assumed latent. Instead, we consider observations<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Y_i^{(g)} = \sum _{j_i=1}^{n_i} X_{ij_i}^{(g)} \end{aligned}$$\end{document}</tex-math><mml:math id="M122" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munderover><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>for <inline-formula id="IEq51"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=1,\ldots ,k$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq51.gif"/></alternatives></inline-formula>, which represent the overall gene expression of the <italic>i</italic>th cell pool for gene <italic>g</italic>. In the first version of stochprofML, pools had to be of equal size <italic>n</italic>, i.e. for each measurement <inline-formula id="IEq52"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{i}^{(g)}$$\end{document}</tex-math><mml:math id="M126"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq52.gif"/></alternatives></inline-formula> one had to extract the same number of cells from each tissue sample. This was a restrictive assumption from the experimental point of view. The recent extension of stochprofML allows each cell pool <italic>i</italic> to contain a different number <inline-formula id="IEq53"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq53.gif"/></alternatives></inline-formula> of cells (see also Figs. <xref rid="Fig1" ref-type="fig">1</xref> and <xref rid="Fig2" ref-type="fig">2</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>Stochastic Profiling can be performed either on measurements of <bold>a</bold> homogeneous pool size of <inline-formula id="IEq260"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M130"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq260.gif"/></alternatives></inline-formula> cells or of <bold>b</bold> different pool sizes given by the cell number vector <inline-formula id="IEq261"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{n}{}$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq261.gif"/></alternatives></inline-formula>. In both cases, the stochprofML algorithm estimates the parameters for the specified number of populations from pooled data, leading to inferred single-cell distributions for each population. Additional File <xref rid="MOESM2" ref-type="media">2</xref> describes how this density is visualized here</p></caption><graphic xlink:href="12859_2021_3970_Fig2_HTML" id="MO43"/></fig></p>
      <p id="Par35">The algorithm aims to estimate the single-cell population parameters despite the fact that measurements are available only in convoluted form. To that end, we derive the likelihood function of the parameters in the convolution model (<xref rid="Equ2" ref-type="">2</xref>), where we assume the gene expression of the single cells to be independent within a tissue sample. For better readability, we suppress for now the superscript (<italic>g</italic>) and introduce it again later.</p>
      <p id="Par36">The derivation of the distribution of <inline-formula id="IEq54"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_i$$\end{document}</tex-math><mml:math id="M134"><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq54.gif"/></alternatives></inline-formula> is described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The corresponding PDF <inline-formula id="IEq55"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{n_i}(y_i|\varvec{\theta },\varvec{p})$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq55.gif"/></alternatives></inline-formula> of an observation <inline-formula id="IEq56"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_i$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq56.gif"/></alternatives></inline-formula> which represents the overall gene expression from sample <italic>i</italic> (consisting of <inline-formula id="IEq57"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq57.gif"/></alternatives></inline-formula> cells) is given by<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{}&amp;f_{n_i} \left( y_i| \! \right. \, \left. \varvec{\theta }, \varvec{p}\right) = \nonumber \\&amp;\quad \sum _{\ell _1=0}^{n_i}\sum _{\ell _2=0}^{{n_i}-\ell _1} \cdots \sum _{\ell _{T-1}=0}^{{n_i}-\sum _{h=1}^{T-2} \ell _h} {{n_i} \atopwithdelims (){\ell _1,\ell _2,\ldots ,\ell _T}}p_1^{\ell _1}p_2^{\ell _2}\cdots p_T^{\ell _T} f_{ ( \ell _1,\ell _2,\ldots ,\ell _T)}\left( y_i|\varvec{\theta } \right) , \end{aligned}$$\end{document}</tex-math><mml:math id="M142" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mfenced open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mspace width="-0.166667em"/></mml:mrow></mml:mfenced><mml:mspace width="0.166667em"/><mml:mfenced close=")"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:munderover><mml:mo>⋯</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:msubsup><mml:mi>p</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msubsup><mml:mi>p</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq58"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _T = n_i-\sum _{h = 1}^{T-1} \ell _h$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq58.gif"/></alternatives></inline-formula> and <inline-formula id="IEq59"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_T = 1-\sum _{h = 1}^{T-1} p_h$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq59.gif"/></alternatives></inline-formula>. Here, <inline-formula id="IEq60"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{(\ell _1,\ell _2,\ldots ,\ell _T)}$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq60.gif"/></alternatives></inline-formula> describes the PDF of a pool of <inline-formula id="IEq61"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i$$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq61.gif"/></alternatives></inline-formula> cells with <italic>known</italic> composition of the single populations, i.e. it is known that there are <inline-formula id="IEq62"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _1$$\end{document}</tex-math><mml:math id="M152"><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq62.gif"/></alternatives></inline-formula> cells from population 1, <inline-formula id="IEq63"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _2$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq63.gif"/></alternatives></inline-formula> cells from population 2 etc. <inline-formula id="IEq64"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n_i \atopwithdelims (){\ell _1,\ell _2,\ldots ,\ell _T} } p_1^{\ell _1}p_2^{\ell _2}\cdots p_T^{\ell _T}$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:msubsup><mml:mi>p</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msubsup><mml:mi>p</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq64.gif"/></alternatives></inline-formula> represents the multinomial probability of obtaining exactly this composition <inline-formula id="IEq65"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\ell _1,\ldots ,\ell _T)$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq65.gif"/></alternatives></inline-formula> using the multinomial coefficient <inline-formula id="IEq66"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n_i \atopwithdelims (){\ell _1,\ell _2,\ldots ,\ell _T} }=n_i!/(\ell _1! \ldots \ell _T!)$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>!</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>!</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>!</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq66.gif"/></alternatives></inline-formula>. Equation (<xref rid="Equ3" ref-type="">3</xref>) sums up over all possible compositions <inline-formula id="IEq67"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\ell _1,\ldots ,\ell _T)$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq67.gif"/></alternatives></inline-formula> with <inline-formula id="IEq68"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _1,\ldots ,\ell _T\in {\mathbb{N}}_0$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="double-struck">N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq68.gif"/></alternatives></inline-formula> and <inline-formula id="IEq69"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _1+\cdots +\ell _T=n_i$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq69.gif"/></alternatives></inline-formula>. Taken together, <inline-formula id="IEq70"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{n_i}(y_i|\varvec{\theta }, \varvec{p})$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq70.gif"/></alternatives></inline-formula> determines the PDF of <inline-formula id="IEq71"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_i$$\end{document}</tex-math><mml:math id="M170"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq71.gif"/></alternatives></inline-formula> with respect to each possible combination of <inline-formula id="IEq72"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i$$\end{document}</tex-math><mml:math id="M172"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq72.gif"/></alternatives></inline-formula> cells of <italic>T</italic> populations.</p>
      <p id="Par37">Thus, the calculation of <inline-formula id="IEq73"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{n_i}(y_i|\varvec{\theta }, \varvec{p})$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq73.gif"/></alternatives></inline-formula> requires knowledge of <inline-formula id="IEq74"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{(\ell _1,\ell _2,\ldots ,\ell _T)}(y_i|\varvec{\theta })$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq74.gif"/></alternatives></inline-formula> . The derivation of this PDF depends on the choice of the single-cell model (LN–LN, rLN–LN, or EXP–LN) that was made for <inline-formula id="IEq75"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{ij_i}$$\end{document}</tex-math><mml:math id="M178"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq75.gif"/></alternatives></inline-formula> .</p>
      <sec id="Sec12">
        <title>LN–LN</title>
        <p id="Par38"><disp-formula id="Equ17"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_{(\ell _1,\ldots ,\ell _h,\ldots ,\ell _T)}(y_i|\varvec{\theta }) = f^\text{LN-LN}_{(\ell _1,\ldots ,\ell _h,\ldots ,\ell _T)} (y_i|\mu _1,\ldots ,\mu _h,\ldots , \mu _T,\sigma ^2) \end{aligned}$$\end{document}</tex-math><mml:math id="M180" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>LN-LN</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>is the density of a sum <inline-formula id="IEq76"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_i=X_{i1}+\cdots +X_{in_i}$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq76.gif"/></alternatives></inline-formula> of <inline-formula id="IEq77"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n_i}$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq77.gif"/></alternatives></inline-formula> independent random variables with<disp-formula id="Equ18"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} X_{ij_i} \sim {\left\{ \begin{array}{ll} {\mathcal{L}}{\mathcal{N}}(\mu _1,\sigma ^2) &amp;{} \text{if } 1\le j_i\le J_1\\ \vdots &amp;{}\\ {\mathcal{L}}{\mathcal{N}}(\mu _h,\sigma ^2) &amp;{} \text{if } J_{h-1}&lt; j_i\le J_h\\ \vdots &amp;{}\\ {\mathcal{L}}{\mathcal{N}}(\mu _T,\sigma ^2) &amp;{} \text{if } J_{T-1}&lt; j_i\le J_T=n_i, \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M186" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>with <inline-formula id="IEq78"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_1 = \ell _1,\ldots , J_h = \ell _1+\ell _2 + \cdots + \ell _h, \ldots , J_T = \ell _1 + \ell _2 + \cdots + \ell _T = n_i$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq78.gif"/></alternatives></inline-formula>. <inline-formula id="IEq79"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_i$$\end{document}</tex-math><mml:math id="M190"><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq79.gif"/></alternatives></inline-formula> is the convolution of random variables <inline-formula id="IEq80"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{i1},\ldots ,X_{in_i}$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq80.gif"/></alternatives></inline-formula>, which is here the convolution of <italic>T</italic> sub-convolutions: a convolution of <inline-formula id="IEq81"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _1$$\end{document}</tex-math><mml:math id="M194"><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq81.gif"/></alternatives></inline-formula> times <inline-formula id="IEq82"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{L}}{\mathcal{N}}(\mu _1,\sigma ^2)$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq82.gif"/></alternatives></inline-formula>, plus a convolution of <inline-formula id="IEq83"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _2$$\end{document}</tex-math><mml:math id="M198"><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq83.gif"/></alternatives></inline-formula> times <inline-formula id="IEq84"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{L}}{\mathcal{N}}(\mu _2,\sigma ^2)$$\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq84.gif"/></alternatives></inline-formula>, and so on, up to a convolution of <inline-formula id="IEq85"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _T$$\end{document}</tex-math><mml:math id="M202"><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq85.gif"/></alternatives></inline-formula> times <inline-formula id="IEq86"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{L}}{\mathcal{N}}(\mu _T,\sigma ^2)$$\end{document}</tex-math><mml:math id="M204"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq86.gif"/></alternatives></inline-formula>.</p>
        <p id="Par39">There is no analytically explicit form for the convolution of lognormal random variables. Hence, <inline-formula id="IEq87"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f^\text{LN-LN}_{(\ell _1,\ldots ,\ell _h,\ldots ,\ell _T)}$$\end{document}</tex-math><mml:math id="M206"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>LN-LN</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq87.gif"/></alternatives></inline-formula> is approximated using the method by [<xref ref-type="bibr" rid="CR21">21</xref>]. That is, the distribution of the sum <inline-formula id="IEq88"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_1+\cdots +A_m$$\end{document}</tex-math><mml:math id="M208"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq88.gif"/></alternatives></inline-formula> of independent random variables</p>
        <p id="Par40"><inline-formula id="IEq89"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_i\sim {\mathcal{L}}{\mathcal{N}}(\mu _{A_i},\sigma _{A_i}^2)$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq89.gif"/></alternatives></inline-formula> is approximated by the distribution of a random variable <inline-formula id="IEq90"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B\sim {\mathcal{L}}{\mathcal{N}}(\mu _B,\sigma _B^2)$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:mi>B</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq90.gif"/></alternatives></inline-formula> such that<disp-formula id="Equ19"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text{E}(B)=\text{E}(A_1+\cdots +A_m) \quad \text{and}\quad \text{Var}(B)=\text{Var}(A_1+\cdots +A_m). \end{aligned}$$\end{document}</tex-math><mml:math id="M214" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>E</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>E</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula>According to Eq. (<xref rid="Equ1" ref-type="">1</xref>), that means that <inline-formula id="IEq91"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _B$$\end{document}</tex-math><mml:math id="M216"><mml:msub><mml:mi>μ</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq91.gif"/></alternatives></inline-formula> and <inline-formula id="IEq92"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _B$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mi>σ</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq92.gif"/></alternatives></inline-formula> are chosen such that the following equations are fulfilled:<disp-formula id="Equ20"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \exp \left( \mu _B+\frac{\sigma _B^2}{2}\right) = \exp \left( \mu _{A_1}+\frac{\sigma _{A_1}^2}{2}\right) + \cdots + \exp \left( \mu _{A_m}+\frac{\sigma _{A_m}^2}{2}\right) =:\Gamma \end{aligned}$$\end{document}</tex-math><mml:math id="M220" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>μ</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mo>:</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula>and<disp-formula id="Equ21"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{}&amp;\exp \!\left( 2\mu _B+\sigma _B^2\right) \! \left( \exp \left( \sigma _B^2\right) \!-\!1\right) = \\&amp;\quad \exp \left( 2\mu _{A_1}+\sigma _{A_1}^2\right) \!\left( \exp \left( \sigma _{A_1}^2\right) \!-\!1\right) + \cdots + \exp \left( 2\mu _{A_m}+\sigma _{A_m}^2\right) \!\left( \exp \left( \sigma _{A_m}^2\right) -1\right) =:\Delta . \end{aligned}$$\end{document}</tex-math><mml:math id="M222" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>exp</mml:mo><mml:mspace width="-0.166667em"/><mml:mfenced close=")" open="("><mml:mn>2</mml:mn><mml:msub><mml:mi>μ</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced><mml:mspace width="-0.166667em"/><mml:mfenced close=")" open="("><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced><mml:mspace width="-0.166667em"/><mml:mo>-</mml:mo><mml:mspace width="-0.166667em"/><mml:mn>1</mml:mn></mml:mfenced><mml:mo>=</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mn>2</mml:mn><mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced><mml:mspace width="-0.166667em"/><mml:mfenced close=")" open="("><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced><mml:mspace width="-0.166667em"/><mml:mo>-</mml:mo><mml:mspace width="-0.166667em"/><mml:mn>1</mml:mn></mml:mfenced><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mn>2</mml:mn><mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced><mml:mspace width="-0.166667em"/><mml:mfenced close=")" open="("><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mo>:</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula>That is achieved by choosing<disp-formula id="Equ22"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mu _B = \log (\Gamma )-\frac{1}{2} \sigma _B^2 \quad \text{and}\quad \sigma _B^2 = \log \left( \frac{\Delta }{\Gamma ^2}+1\right) . \end{aligned}$$\end{document}</tex-math><mml:math id="M224" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi mathvariant="normal">Γ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula>This approximation is implemented in the function d.sum.of.lognormals(). The overall PDF is computed through d.sum.of.mixtures.LNLN().</p>
      </sec>
      <sec id="Sec101">
        <title>rLN–LN</title>
        <p id="Par42"><disp-formula id="Equ23"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_{(\ell _1,\ldots ,\ell _h,\ldots ,\ell _T)}(y_i|\varvec{\theta }) = f^\text{rLN-LN}_{(\ell _1,\ldots ,\ell _h,\ldots ,\ell _T)}(y_i|\mu _1,\ldots ,\mu _h,\ldots , \mu _T,\sigma _1^2,\ldots ,\sigma _h^2,\ldots ,\sigma _T^2) \end{aligned}$$\end{document}</tex-math><mml:math id="M226" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>rLN-LN</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ23.gif" position="anchor"/></alternatives></disp-formula>is the PDF of a sum <inline-formula id="IEq93"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_i=X_{i1}+\cdots +X_{in_i}$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq93.gif"/></alternatives></inline-formula> of <inline-formula id="IEq94"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n_i}$$\end{document}</tex-math><mml:math id="M230"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq94.gif"/></alternatives></inline-formula> independent random variables with<disp-formula id="Equ24"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} X_{ij_i} \sim {\left\{ \begin{array}{ll} {\mathcal{L}}{\mathcal{N}}(\mu _1,\sigma _1^2) &amp;{} \text{if } 1\le j_i\le J_1\\ \vdots &amp;{}\\ {\mathcal{L}}{\mathcal{N}}(\mu _h,\sigma _h^2) &amp;{} \text{if } J_{h-1}&lt; j_i\le J_h\\ \vdots &amp;{}\\ {\mathcal{L}}{\mathcal{N}}(\mu _T,\sigma _T^2) &amp;{} \text{if } J_{T-1}&lt; j_i\le J_T=n_i, \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M232" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ24.gif" position="anchor"/></alternatives></disp-formula>with <inline-formula id="IEq95"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_1 = \ell _1,\ldots , J_h = \ell _1+\ell _2 + \cdots + \ell _h, \ldots , J_T = \ell _1 + \cdots + \ell _T = n_i$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq95.gif"/></alternatives></inline-formula>. Again, <inline-formula id="IEq96"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f^\text{rLN-LN}_{(\ell _1,\ldots ,\ell _h,\ldots ,\ell _T)}$$\end{document}</tex-math><mml:math id="M236"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>rLN-LN</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq96.gif"/></alternatives></inline-formula> is approximated using the method by [<xref ref-type="bibr" rid="CR21">21</xref>], analogously to the LN–LN model. It is implemented in d.sum.of.mixtures.rLNLN().</p>
      </sec>
      <sec id="Sec102">
        <title>EXP–LN</title>
        <p id="Par43"><disp-formula id="Equ25"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_{(\ell _1,\ell _2,\ldots ,\ell _T)}(y_i|\varvec{\theta }) =f^\text{EXP-LN}_{(\ell _1,\ell _2,\ldots ,\ell _T)}(y_i|\lambda ,\mu _1,\ldots , \mu _{T-1},\sigma ^2) \end{aligned}$$\end{document}</tex-math><mml:math id="M238" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>EXP-LN</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ25.gif" position="anchor"/></alternatives></disp-formula>is the density of a sum <inline-formula id="IEq97"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_i=X_{i1}+\cdots +X_{in_i}$$\end{document}</tex-math><mml:math id="M240"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq97.gif"/></alternatives></inline-formula> of <inline-formula id="IEq98"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i$$\end{document}</tex-math><mml:math id="M242"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq98.gif"/></alternatives></inline-formula> independent random variables with<disp-formula id="Equ26"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} X_{ij_i} \sim {\left\{ \begin{array}{ll} {\mathcal{L}}{\mathcal{N}}(\mu _1,\sigma ^2) &amp;{} \text{if } 1\le j_i\le J_1\\ \vdots &amp;{}\\ {\mathcal{L}}{\mathcal{N}}(\mu _h,\sigma ^2) &amp;{} \text{if } J_{h-1}&lt; j_i\le J_h\\ \vdots &amp;{}\\ {\mathcal{L}}{\mathcal{N}}(\mu _{T-1},\sigma ^2) &amp;{} \text{if } J_{T-2}&lt; j_i\le J_{T-1}\\ {\mathcal{E}}\! {\mathcal{X}}\! {\mathcal{P}}(\lambda ) &amp;{} \text{if } J_{T-1}&lt; j_i\le J_T=n_i, \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M244" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">E</mml:mi><mml:mspace width="-0.166667em"/><mml:mi mathvariant="script">X</mml:mi><mml:mspace width="-0.166667em"/><mml:mi mathvariant="script">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ26.gif" position="anchor"/></alternatives></disp-formula>with <inline-formula id="IEq99"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_1 = \ell _1,\ldots , J_h = \ell _1+\ell _2 + \cdots + \ell _h, \ldots , J_T = \ell _1 + \cdots + \ell _T = n_i$$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq99.gif"/></alternatives></inline-formula>. The sum of independent exponentially distributed random variables with equal intensity parameter follows an Erlang distribution [<xref ref-type="bibr" rid="CR22">22</xref>], which is a gamma distribution with integer-valued shape parameter that represents the number of exponentially distributed summands. Thus, the PDF for the EXP–LN mixture model is the convolution of one Erlang (or gamma) distribution (namely the sum of all exponentially distributed summands) and one lognormal distribution [namely the sum of all lognormally distributed summands, again using the approximation method by <xref ref-type="bibr" rid="CR21">21</xref>]. The PDF for this convolution is not known in analytically explicit form but expressed in terms of an integral that is solved numerically through the function lognormal.exp.convolution(). Its computation thus takes substantially longer in terms of run time than for LN–LN. The overall PDF of the EXP–LN model is implemented in d.sum.of.mixtures.EXPLN().</p>
      </sec>
      <sec id="Sec13">
        <title>Example: Mixture of two populations—Part 2</title>
        <p id="Par44">In this example of the two-population model, let each observation consist of the same number of <inline-formula id="IEq100"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=10$$\end{document}</tex-math><mml:math id="M248"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq100.gif"/></alternatives></inline-formula> cells. Then <inline-formula id="IEq101"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_i$$\end{document}</tex-math><mml:math id="M250"><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq101.gif"/></alternatives></inline-formula> is a 10-fold convolution, and the PDF (<xref rid="Equ3" ref-type="">3</xref>) simplifies to<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_{10}\left( y_i|\varvec{\theta },\varvec{p} \right) =\sum _{\ell =0}^{10} {10 \atopwithdelims ()\ell } p^\ell (1-p)^{10-\ell } f_{(\ell ,10-\ell )}\left( y_i | \varvec{\theta } \right) , \end{aligned}$$\end{document}</tex-math><mml:math id="M252" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>10</mml:mn></mml:munderover><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:mn>10</mml:mn><mml:mi>ℓ</mml:mi></mml:mfrac></mml:mfenced><mml:msup><mml:mi>p</mml:mi><mml:mi>ℓ</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>10</mml:mn><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq102"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{(\ell ,10-\ell )}$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq102.gif"/></alternatives></inline-formula> is the PDF of the sum <inline-formula id="IEq103"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_i$$\end{document}</tex-math><mml:math id="M256"><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq103.gif"/></alternatives></inline-formula> of ten independent random variables, that is</p>
        <p id="Par45"><inline-formula id="IEq104"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_i=X_{i1}+\cdots +X_{i 10}$$\end{document}</tex-math><mml:math id="M258"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq104.gif"/></alternatives></inline-formula>. This PDF depends on the particular chosen model:</p>
      </sec>
      <sec id="Sec14">
        <title>LN–LN</title>
        <p id="Par46"><disp-formula id="Equ27"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_{(\ell ,10-\ell )}(y_i|\varvec{\theta })=f^\text{LN-LN}_{(\ell ,10-\ell )} (y_i|\mu _1,\mu _2,\sigma ^2) \end{aligned}$$\end{document}</tex-math><mml:math id="M260" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>LN-LN</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ27.gif" position="anchor"/></alternatives></disp-formula>is the PDF of a sum <inline-formula id="IEq105"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_i=X_{i1}+\cdots +X_{i 10}$$\end{document}</tex-math><mml:math id="M262"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq105.gif"/></alternatives></inline-formula> of ten independent random variables with<disp-formula id="Equ28"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} X_{ij} \sim {\left\{ \begin{array}{ll} {\mathcal{L}}{\mathcal{N}}(\mu _1,\sigma ^2) &amp;{} \text{if } 1\le j \le \ell \\ {\mathcal{L}}{\mathcal{N}}(\mu _2,\sigma ^2) &amp;{} \text{if } \ell &lt; j\le 10. \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M264" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>ℓ</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mn>10</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ28.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec15">
        <title>rLN–LN</title>
        <p id="Par47"><disp-formula id="Equ29"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_{(\ell ,10-\ell )}(y_i|\varvec{\theta })=f^\text{rLN-LN}_{(\ell ,10-\ell )} (y_i|\mu _1,\mu _2,\sigma _1^2, \sigma _2^2) \end{aligned}$$\end{document}</tex-math><mml:math id="M266" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>rLN-LN</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ29.gif" position="anchor"/></alternatives></disp-formula>is the PDF of a sum <inline-formula id="IEq106"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_i=X_{i1}+\cdots +X_{i 10}$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq106.gif"/></alternatives></inline-formula> of ten independent random variables with<disp-formula id="Equ30"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} X_{ij} \sim {\left\{ \begin{array}{ll} {\mathcal{L}}{\mathcal{N}}(\mu _1,\sigma _1^2) &amp;{} \text{if } 1\le j \le \ell \\ {\mathcal{L}}{\mathcal{N}}(\mu _2,\sigma _2^2) &amp;{} \text{if } \ell &lt; j\le 10. \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M270" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>ℓ</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mn>10</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ30.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec16">
        <title>EXP–LN</title>
        <p id="Par48"><disp-formula id="Equ31"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_{(\ell ,10-\ell )}(y_i|\varvec{\theta })= f^\text{EXP-LN}_{(\ell ,10-\ell )}(y_i|\lambda ,\mu ,\sigma ^2) \end{aligned}$$\end{document}</tex-math><mml:math id="M272" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>-</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>EXP-LN</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ31.gif" position="anchor"/></alternatives></disp-formula>is the PDF of a sum <inline-formula id="IEq107"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_i=X_{i1}+\cdots +X_{i 10}$$\end{document}</tex-math><mml:math id="M274"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq107.gif"/></alternatives></inline-formula> of ten independent random variables with<disp-formula id="Equ32"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} X_{ij} \sim {\left\{ \begin{array}{ll} {\mathcal{L}}{\mathcal{N}}(\mu ,\sigma ^2) &amp;{} \text{if } 1\le j \le \ell \\ {\mathcal{E}}\! {\mathcal{X}}\! {\mathcal{P}}(\lambda ) &amp;{} \text{if } \ell &lt; j\le 10.\\ \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M276" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">E</mml:mi><mml:mspace width="-0.166667em"/><mml:mi mathvariant="script">X</mml:mi><mml:mspace width="-0.166667em"/><mml:mi mathvariant="script">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>ℓ</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mn>10</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ32.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
    </sec>
    <sec id="Sec17">
      <title>Likelihood function</title>
      <p id="Par49">Overall, after re-introducing the superscript (<italic>g</italic>) for measurements of genes <inline-formula id="IEq108"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g=1,\ldots ,m$$\end{document}</tex-math><mml:math id="M278"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq108.gif"/></alternatives></inline-formula>, we obtain the PDF<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{}&amp;f_{n_i}\left( y_i^{(g)}| \right. \left. \varvec{\theta }^{(g)}, \varvec{p}\right) = \nonumber \\&amp;\quad \sum _{\ell _1=0}^{n_i}\sum _{\ell _2=0}^{{n_i}-\ell _1}\cdots \sum _{\ell _{T-1}=0}^{{n_i}-\sum _{h=1}^{T-2} \ell _h} {{n_i} \atopwithdelims (){\ell _1,\ell _2,\ldots ,\ell _T}}p_1^{\ell _1}p_2^{\ell _2}\cdots p_T^{\ell _T} f_{ ( \ell _1,\ell _2,\ldots ,\ell _T)}\left( y_i^{(g)}|\varvec{\theta }^{(g)} \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M280" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mfenced open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mfenced><mml:mfenced close=")"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:munderover><mml:mo>⋯</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:msubsup><mml:mi>p</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msubsup><mml:mi>p</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>with model-specific choice of <inline-formula id="IEq109"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{ ( \ell _1,\ell _2,\ldots ,\ell _T)}$$\end{document}</tex-math><mml:math id="M282"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq109.gif"/></alternatives></inline-formula>. While <inline-formula id="IEq110"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{n}=(n_1,\ldots ,n_k)$$\end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq110.gif"/></alternatives></inline-formula> is considered known, we aim to infer the unknown model parameters <inline-formula id="IEq111"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\theta }=\{\varvec{\theta }^{(1)}, \ldots ,\varvec{\theta }^{(m)},\varvec{p}\}$$\end{document}</tex-math><mml:math id="M286"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq111.gif"/></alternatives></inline-formula> by maximum likelihood estimation. Assuming independent observations <inline-formula id="IEq112"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{y}}=\{y_i^{(g)}|i=1,\ldots ,k;g=1,\ldots ,m\}$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>;</mml:mo><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq112.gif"/></alternatives></inline-formula> of <inline-formula id="IEq113"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_i^{(g)}$$\end{document}</tex-math><mml:math id="M290"><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq113.gif"/></alternatives></inline-formula> for <italic>m</italic> genes and <italic>k</italic> tissue samples, where sample <italic>i</italic> contains <inline-formula id="IEq114"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i$$\end{document}</tex-math><mml:math id="M292"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq114.gif"/></alternatives></inline-formula> cells, the likelihood function is given by<disp-formula id="Equ33"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L(\varvec{\theta }|\varvec{y}) = \prod _{g=1}^m\prod _{i=1}^k f_{n_i}\left( y_i^{(g)}| \varvec{\theta }^{(g)}, \varvec{p}\right) . \end{aligned}$$\end{document}</tex-math><mml:math id="M294" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ33.gif" position="anchor"/></alternatives></disp-formula>Consequently, the log-likelihood function of the model parameters reads<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \ell (\varvec{\theta }|\varvec{y}) = \sum _{g=1}^m \sum _{i=1}^k \log \left[ f_{n_i} \left( y_i^{(g)}|\varvec{\theta }^{(g)}, \varvec{p}\right) \right] . \end{aligned}$$\end{document}</tex-math><mml:math id="M296" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mo>log</mml:mo><mml:mfenced close="]" open="["><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <sec id="Sec18">
        <title>Example: Mixture of two populations—Part 3</title>
        <p id="Par50">Returning to the two-population example with 10-cell pools, the log-likelihood for <inline-formula id="IEq115"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=100$$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq115.gif"/></alternatives></inline-formula> tissue samples and <inline-formula id="IEq116"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m=5$$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq116.gif"/></alternatives></inline-formula> genes is given by<disp-formula id="Equ34"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \ell (\varvec{\theta }|\varvec{y}) = \sum _{g=1}^5 \sum _{i=1}^{100} \log \left[ f_{10}\left( y_i^{(g)}|\varvec{\theta }^{(g)},\varvec{p} \right) \right] , \end{aligned}$$\end{document}</tex-math><mml:math id="M302" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>100</mml:mn></mml:munderover><mml:mo>log</mml:mo><mml:mfenced close="]" open="["><mml:msub><mml:mi>f</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ34.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq117"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{10}\left( y_i^{(g)}|\varvec{\theta }^{(g)},\varvec{p} \right)$$\end{document}</tex-math><mml:math id="M304"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq117.gif"/></alternatives></inline-formula> is given by Eq. (<xref rid="Equ4" ref-type="">4</xref>).</p>
      </sec>
    </sec>
    <sec id="Sec19">
      <title>Maximum likelihood estimation</title>
      <p id="Par51">The stochprofML algorithm aims to infer the unknown model parameters using maximum likelihood estimation. As input, we expect an <inline-formula id="IEq118"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m\times k$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq118.gif"/></alternatives></inline-formula> data matrix of pooled gene expression, known cell numbers <inline-formula id="IEq119"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{n}$$\end{document}</tex-math><mml:math id="M308"><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq119.gif"/></alternatives></inline-formula>, the assumed number of populations <italic>T</italic> and the choice of single-cell distribution (LN–LN, rLN–LN, EXP–LN). Based on this input, the algorithm aims to find parameter values of <inline-formula id="IEq120"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\theta }=\{\varvec{\theta }^{(1)},\ldots ,\varvec{\theta }^{(m)},\varvec{p}\}$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq120.gif"/></alternatives></inline-formula> that maximize <inline-formula id="IEq121"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell (\varvec{\theta }|\varvec{y})$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq121.gif"/></alternatives></inline-formula> as given by Eq. (<xref rid="Equ6" ref-type="">6</xref>). This section describes practical aspects of the optimization procedure.</p>
      <sec id="Sec20">
        <title>Example: Mixture of two populations—Part 4</title>
        <p id="Par52">Several challenges occur during parameter estimation. We explain these on the two-population LN–LN example: First, we aim to ensure parameter identifiability. This is achieved for the two-population LN–LN model by constraining the parameters to fulfil either <inline-formula id="IEq122"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.5$$\end{document}</tex-math><mml:math id="M314"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq122.gif"/></alternatives></inline-formula> or <inline-formula id="IEq123"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1 &gt; \mu _2$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq123.gif"/></alternatives></inline-formula>. Otherwise, the two combinations <inline-formula id="IEq124"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(p,{\varvec{\mu }}_1,{\varvec{\mu }}_2,\sigma )$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq124.gif"/></alternatives></inline-formula> and <inline-formula id="IEq125"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(1-p,{\varvec{\mu }}_2,{\varvec{\mu }}_1,\sigma )$$\end{document}</tex-math><mml:math id="M320"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq125.gif"/></alternatives></inline-formula> would yield identical values of the likelihood function and could cause computational problems. For our implementation, we preferred the second possibility, i.e. <inline-formula id="IEq126"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1 &gt; \mu _2$$\end{document}</tex-math><mml:math id="M322"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq126.gif"/></alternatives></inline-formula>. The alternative, i.e. requiring <inline-formula id="IEq127"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.5$$\end{document}</tex-math><mml:math id="M324"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq127.gif"/></alternatives></inline-formula>, led to switchings between <inline-formula id="IEq128"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1$$\end{document}</tex-math><mml:math id="M326"><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq128.gif"/></alternatives></inline-formula> and <inline-formula id="IEq129"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _2$$\end{document}</tex-math><mml:math id="M328"><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq129.gif"/></alternatives></inline-formula> in case of <inline-formula id="IEq130"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p \approx 0.5$$\end{document}</tex-math><mml:math id="M330"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≈</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq130.gif"/></alternatives></inline-formula>. As a second measure, we implement unconstrained rather than constrained optimization: Instead of estimating <inline-formula id="IEq131"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(p,{\varvec{\mu }}_1,{\varvec{\mu }}_2,\sigma )$$\end{document}</tex-math><mml:math id="M332"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq131.gif"/></alternatives></inline-formula> under the constraints <inline-formula id="IEq132"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\in [0,1]$$\end{document}</tex-math><mml:math id="M334"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq132.gif"/></alternatives></inline-formula>, <inline-formula id="IEq133"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1 &gt; \mu _2$$\end{document}</tex-math><mml:math id="M336"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq133.gif"/></alternatives></inline-formula> and <inline-formula id="IEq134"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma &gt;0$$\end{document}</tex-math><mml:math id="M338"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq134.gif"/></alternatives></inline-formula>, the parameters are transformed to <inline-formula id="IEq135"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\text{logit}(p),{\varvec{\mu }}_1,{\varvec{\mu }}_2,\log (\sigma ))$$\end{document}</tex-math><mml:math id="M340"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>logit</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq135.gif"/></alternatives></inline-formula>, and an unconstrained optimization method is used. This is substantially faster.</p>
        <p id="Par53">The aforementioned transformations are likewise employed for all other models (rLN–LN and EXP–LN) and population numbers. In particular, <inline-formula id="IEq136"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M342"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq136.gif"/></alternatives></inline-formula> and <inline-formula id="IEq137"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M344"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq137.gif"/></alternatives></inline-formula> are log-transformed, and the lognormal populations are ordered according to the log-means <inline-formula id="IEq138"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _h^{(1)}$$\end{document}</tex-math><mml:math id="M346"><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq138.gif"/></alternatives></inline-formula> of the first gene in the gene list. The population probabilities are transformed to <inline-formula id="IEq139"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{R}}$$\end{document}</tex-math><mml:math id="M348"><mml:mi mathvariant="double-struck">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq139.gif"/></alternatives></inline-formula> such that they still sum up to one after back-transformation. For details, see Additional file <xref rid="MOESM3" ref-type="media">3</xref>.</p>
        <p id="Par54">The log-likelihood function is multimodal. Thus, a single application of some gradient-based optimization method does not suffice to find a global maximum. Instead, two approaches are combined which are alternately executed: First, a grid search is performed, where the log-likelihood function is computed at many randomly drawn parameter values. In the second step, the (computationally more costly) Nelder-Mead algorithm [<xref ref-type="bibr" rid="CR23">23</xref>] is repeatedly executed at few points. This way, high likelihood regions can be identified with low computational cost. A next grid search again explores the regions around the obtained local maxima, followed by another Nelder-Mead optimization. Here, the starting values are randomly drawn from the high-likelihood regions found before. This combination of grid search and local optimization is carried out three times. The whole procedure is repeated five times by default, with the aim to find an overall optimal parameter combination, but this number can be changed using the loops parameter of the function stochprof.loop(). If until.convergence is set to TRUE, the loops will be exited as soon as the obtained improvement in the likelihood during the last round is less than <inline-formula id="IEq140"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5\times 10^{-5}$$\end{document}</tex-math><mml:math id="M350"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq140.gif"/></alternatives></inline-formula>.</p>
        <p id="Par55">If a dataset contains gene expressions for <italic>m</italic> genes, and if we assume <italic>T</italic> populations, there are at minimum <inline-formula id="IEq141"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T(m+1)$$\end{document}</tex-math><mml:math id="M352"><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq141.gif"/></alternatives></inline-formula> parameters which one seeks to estimate depending on the model framework. This is computationally difficult, because the number of modes of the log-likelihood function increases with the number of parameters. The performance of the numerical optimization crucially depends on the quality of the starting values, and a large number of restarts is required. When analyzing a large gene cluster, it is advantageous to start by considering small clusters and use the derived estimates as initial guesses for larger clusters. This is implemented in the function stochprof.loop() (parameter subgroups and demonstrated in analyze.toycluster()).</p>
        <p id="Par56">Approximate marginal 95% confidence intervals for the parameter estimates are obtained as follows: We numerically compute the Hessian matrix of the negative log-likelihood function on the unrestricted parameter space and evaluate it at the (transformed) maximum likelihood estimator. Denote by <inline-formula id="IEq142"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_i$$\end{document}</tex-math><mml:math id="M354"><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq142.gif"/></alternatives></inline-formula> the <italic>i</italic>th diagonal element of the inverse of this matrix. Then the confidence bounds for the <italic>i</italic>th transformed parameter <inline-formula id="IEq143"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _i$$\end{document}</tex-math><mml:math id="M356"><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq143.gif"/></alternatives></inline-formula> are<disp-formula id="Equ35"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \hat{\theta }_i \pm 1.96\sqrt{d_i}. \end{aligned}$$\end{document}</tex-math><mml:math id="M358" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>±</mml:mo><mml:mn>1.96</mml:mn><mml:msqrt><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ35.gif" position="anchor"/></alternatives></disp-formula>We obtain respective marginal confidence intervals for the original true parameters by back-transformation of the above bounds. This approximation is especially appropriate in the two-population example for the parameters <italic>p</italic> and <inline-formula id="IEq144"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M360"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq144.gif"/></alternatives></inline-formula> when conditioning on <inline-formula id="IEq145"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\mu }}_1$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq145.gif"/></alternatives></inline-formula> and <inline-formula id="IEq146"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\mu }}_2$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq146.gif"/></alternatives></inline-formula>. In this case, in practice, the profile likelihood is seemingly unimodal.</p>
        <p id="Par57">Run times for maximum likelihood estimation differ substantially between two- and three-population models, and also between LN–LN, rLN–LN and EXP–LN. The latter is due to the integral convolution of an exponential and an Erlang distribution in EXP–LN as described above. Table <xref rid="Tab1" ref-type="table">1</xref> displays run times using the R function microbenchmark() on simulated data.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Run times for maximum likelihood estimation for LN–LN, rLN–LN and EXP–LN models with <italic>T</italic> = 2 and <italic>T</italic> = 3 populations</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><italic>T</italic></th><th align="left">LN–LN</th><th align="left">rLN–LN</th><th align="left">EXP–LN</th></tr></thead><tbody><tr><td align="left">2</td><td align="left">13.00 (12.55–18.99)</td><td align="left">27.06 (17.04–34.76)</td><td align="left">16,762.22 (10,764.77–21,576.25)</td></tr><tr><td align="left">3</td><td align="left">96.76 (47.07–130.92)</td><td align="left">162.59 (86.84–346.98)</td><td align="left">148,785.38 (100,248.84–184,789.46)</td></tr></tbody></table><table-wrap-foot><p>The study was performed on simulated data using the R function microbenchmark(). Reported numbers are run times in seconds across five repetitions: median (min - max)</p></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="Sec21">
        <title>Example: Mixture of three populations</title>
        <p id="Par58">Figure <xref rid="Fig3" ref-type="fig">3</xref> shows estimation results for an LN–LN model with three populations, based on synthetic 10-cell data. (Synthetic data generation is described later in this text.) 1000 10-cell datasets each with <inline-formula id="IEq149"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k = 1000$$\end{document}</tex-math><mml:math id="M366"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq149.gif"/></alternatives></inline-formula> observations were generated using underlying population parameters <inline-formula id="IEq150"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_1=0.1$$\end{document}</tex-math><mml:math id="M368"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq150.gif"/></alternatives></inline-formula>, <inline-formula id="IEq151"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_2=0.4$$\end{document}</tex-math><mml:math id="M370"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq151.gif"/></alternatives></inline-formula>, <inline-formula id="IEq152"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1=1.5$$\end{document}</tex-math><mml:math id="M372"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq152.gif"/></alternatives></inline-formula>, <inline-formula id="IEq153"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _2=-0.4$$\end{document}</tex-math><mml:math id="M374"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq153.gif"/></alternatives></inline-formula>, <inline-formula id="IEq154"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _3=-2.5$$\end{document}</tex-math><mml:math id="M376"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>2.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq154.gif"/></alternatives></inline-formula> and <inline-formula id="IEq155"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =0.2$$\end{document}</tex-math><mml:math id="M378"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq155.gif"/></alternatives></inline-formula>.<fig id="Fig3"><label>Fig. 3</label><caption><p>Parameter estimates for the LN–LN model on 1000 simulated 10-cell datasets. The true underlying population parameters are <inline-formula id="IEq262"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_1=0.1,\,p_2=0.4,\,\mu _1=1.5,\,\mu _2=-0.4,\,\mu _3=-2.5\,\text{and}\,\,\sigma =0.2$$\end{document}</tex-math><mml:math id="M380"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>0.4</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>μ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>2.5</mml:mn><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq262.gif"/></alternatives></inline-formula>, as indicated by the orange dashed lines</p></caption><graphic xlink:href="12859_2021_3970_Fig3_HTML" id="MO44"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec22">
      <title>Model choice</title>
      <p id="Par59">By increasing the number <italic>T</italic> of populations, we can describe the observed data more precisely, but this comes at the cost of potential overfitting. For example, a three-population LN–LN model may lead to a larger likelihood at the maximum likelihood estimator than a two-population LN–LN model on the same dataset. However, the difference may be small, and the additional third population may not lead to a gain of knowledge. For example, the estimated population probability <inline-formula id="IEq156"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{p}_3$$\end{document}</tex-math><mml:math id="M382"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq156.gif"/></alternatives></inline-formula> may be tiny, or the log-means of the second and third population, <inline-formula id="IEq157"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\mu }}_{2}$$\end{document}</tex-math><mml:math id="M384"><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq157.gif"/></alternatives></inline-formula> and <inline-formula id="IEq158"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\mu }}_{3}$$\end{document}</tex-math><mml:math id="M386"><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq158.gif"/></alternatives></inline-formula> might hardly be distinguishable from each other.</p>
      <p id="Par60">To objectively find a trade-off between necessary complexity and sufficient interpretability, we employ the Bayesian information criterion [BIC, <xref ref-type="bibr" rid="CR24">24</xref>]:<disp-formula id="Equ36"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text{BIC}(\hat{{\varvec{\theta }}})=-2\ell (\hat{{\varvec{\theta }}})+ {\log {k}} \dim (\hat{{\varvec{\theta }}}), \end{aligned}$$\end{document}</tex-math><mml:math id="M388" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>BIC</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>ℓ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>log</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>dim</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ36.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq159"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{{\varvec{\theta }}}$$\end{document}</tex-math><mml:math id="M390"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq159.gif"/></alternatives></inline-formula> is the maximum likelihood estimate of the respective model, <inline-formula id="IEq160"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dim (\hat{{\varvec{\theta }}})$$\end{document}</tex-math><mml:math id="M392"><mml:mrow><mml:mo>dim</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq160.gif"/></alternatives></inline-formula> the number of parameters and <italic>k</italic> the size of the dataset. From the statistics perspective, the model with smallest BIC is considered most appropriate among all considered models.</p>
      <p id="Par61">In practice, it is required to estimate all models of interest separately with the stochprofML algorithm, e.g. the LN–LN model with one, two and three populations, and/or the respective rLN–LN and EXP–LN models. The BIC values are returned by the function stochprof.loop().</p>
    </sec>
  </sec>
  <sec id="Sec23">
    <title>Results and discussion</title>
    <p id="Par62">This section illustrates the usage of the stochprofML package for simulation and parameter estimation. Afterwards we demonstrate the performance of the estimation depending on pool sizes, true parameter values and in case of uncertainty about pool sizes. We investigate what we can learn from the parameter estimates about the heterogeneous populations and about sample compositions. These investigations shed light on the algorithm’s performance from a statistical point of view and complement the experimental validation we performed in [<xref ref-type="bibr" rid="CR9">9</xref>]. All scripts used in these studies can be found in our open GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/fuchslab/Stochastic_Profiling_in_R">https://github.com/fuchslab/Stochastic_Profiling_in_R</ext-link>.</p>
    <sec id="Sec24">
      <title>Usage of stochprofML</title>
      <p id="Par63">There are two ways to use the stochprofML package: (1) Two interactive functions stochasticProfilingData() and stochasticProfilingML() provide low-level access to synthetic data generation and maximum likelihood parameter estimation without requiring advanced programming knowledge. They guide the user through entering the relevant input parameters: Working as question-answer functions, they ask for prompting the data (or file name), the number of cells per sample, the number of genes etc. An example of the use of the interactive functions can be found in Additional file <xref rid="MOESM5" ref-type="media">5</xref>. (2) The direct usage of the package’s R functions allows more flexibility and is illustrated in the following.</p>
      <sec id="Sec25">
        <title>Synthetic data generation</title>
        <p id="Par64">We first generate a dataset of <inline-formula id="IEq161"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=1000$$\end{document}</tex-math><mml:math id="M394"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq161.gif"/></alternatives></inline-formula> sample observations, where each sample consists of <inline-formula id="IEq162"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=10$$\end{document}</tex-math><mml:math id="M396"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq162.gif"/></alternatives></inline-formula> cells. We choose a single-cell model with two populations, both of lognormal type, i.e. we use the LN–LN model. Let us assume that the overall population of interest is a mixture of <inline-formula id="IEq163"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$62\%$$\end{document}</tex-math><mml:math id="M398"><mml:mrow><mml:mn>62</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq163.gif"/></alternatives></inline-formula> of population 1 and <inline-formula id="IEq164"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$38\%$$\end{document}</tex-math><mml:math id="M400"><mml:mrow><mml:mn>38</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq164.gif"/></alternatives></inline-formula> of population 2, i.e. <inline-formula id="IEq165"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_1=0.62$$\end{document}</tex-math><mml:math id="M402"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.62</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq165.gif"/></alternatives></inline-formula>. As population parameters we choose <inline-formula id="IEq166"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1 = 0.47$$\end{document}</tex-math><mml:math id="M404"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.47</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq166.gif"/></alternatives></inline-formula>, <inline-formula id="IEq167"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _2 = -0.87$$\end{document}</tex-math><mml:math id="M406"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>0.87</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq167.gif"/></alternatives></inline-formula> and <inline-formula id="IEq168"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =0.03$$\end{document}</tex-math><mml:math id="M408"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq168.gif"/></alternatives></inline-formula>. Synthetic gene expression data for one gene is generated as follows: <graphic position="anchor" xlink:href="12859_2021_3970_Figa_HTML" id="MO36"/></p>
        <p id="Par65">Figure <xref rid="Fig4" ref-type="fig">4</xref> shows a histogram of the simulated data as well as the theoretical PDF of the 10-cell mixture. The following code produces this figure: <graphic position="anchor" xlink:href="12859_2021_3970_Figb_HTML" id="MO37"/><fig id="Fig4"><label>Fig. 4</label><caption><p>Histogram of 1000 synthetic 10-cell observations, together with theoretical PDF. We assumed a two-population LN–LN model with parameters <inline-formula id="IEq263"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p=0.62,\,\mu _1=0.47,\,\mu _2=-0.87\,\text{and}\,\,\sigma =0.03$$\end{document}</tex-math><mml:math id="M410"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.62</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.47</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>0.87</mml:mn><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq263.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="12859_2021_3970_Fig4_HTML" id="MO45"/></fig></p>
      </sec>
      <sec id="Sec26">
        <title>Parameter estimation</title>
        <p id="Par66">Next, we show how the parameters used above can be back-inferred from the generated dataset using maximum likelihood estimation. <graphic position="anchor" xlink:href="12859_2021_3970_Figc_HTML" id="MO38"/></p>
        <p id="Par67">When the fitting is done, pressing &lt;enter&gt; causes R to show plots of the estimation process, see Fig. <xref rid="Fig5" ref-type="fig">5</xref>, and displays the results in the following form. <graphic position="anchor" xlink:href="12859_2021_3970_Figd_HTML" id="MO39"/> Hence, the marginal confidence intervals cover the true parameter values.<fig id="Fig5"><label>Fig. 5</label><caption><p>Graphical output of the parameter estimation procedure for <inline-formula id="IEq264"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p,\,\mu _1,\,\mu _2\,\text{and}\,\sigma$$\end{document}</tex-math><mml:math id="M412"><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>σ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq264.gif"/></alternatives></inline-formula> as described in Section Parameter estimation. Each point in the plots corresponds to one combination of values for <inline-formula id="IEq2640"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p,\,\mu _1,\,\mu _2\,\text{and}\,\,\sigma$$\end{document}</tex-math><mml:math id="M414"><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi>σ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq2640.gif"/></alternatives></inline-formula>. Each plot depicts the functional relationship between one parameter (e.g. <inline-formula id="IEq265"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M416"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq265.gif"/></alternatives></inline-formula> in the upper left panel) and the log-likelihood function, whilst the remaining three parameters are integrated out</p></caption><graphic xlink:href="12859_2021_3970_Fig5_HTML" id="MO46"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec27">
      <title>Simulation study on optimal pool size</title>
      <p id="Par68">Stochastic profiling, i.e. the analysis of small-pool gene expression measurements, is a compromise between the analysis of single cells and the consideration of large bulks: Single-cell information is most immediate, but a fixed number <italic>k</italic> of samples will only cover <italic>k</italic> cells. In pools of cells, on the other hand, information is convoluted, but <italic>k</italic> pools of size <italic>n</italic> cover <italic>n</italic> times as much material. An obvious question is the optimal pool size <italic>n</italic>. The answer is not available in analytically closed form. We hence study this question empirically.</p>
      <p id="Par69">For this simulation study, first, we generate synthetic data for different pool sizes with identical parameter values and settings. Then, we re-infer the model parameters using the stochprofML algorithm. This is repeated 1000 times for each choice of pool size, enabling us to study the algorithm’s performance by simple summary statistics of the replicates.</p>
      <p id="Par70">The fixed settings are as follows: We use the two-population LN–LN model to generate data for one gene with <inline-formula id="IEq169"><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_1 = 0.2$$\end{document}</tex-math><mml:math id="M418"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq169.gif"/></alternatives></inline-formula>, <inline-formula id="IEq170"><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1 = 2$$\end{document}</tex-math><mml:math id="M420"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq170.gif"/></alternatives></inline-formula>, <inline-formula id="IEq171"><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _2 = 0$$\end{document}</tex-math><mml:math id="M422"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq171.gif"/></alternatives></inline-formula> and <inline-formula id="IEq172"><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma = 0.2$$\end{document}</tex-math><mml:math id="M424"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq172.gif"/></alternatives></inline-formula>. For each pool size we simulate <inline-formula id="IEq173"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=50$$\end{document}</tex-math><mml:math id="M426"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq173.gif"/></alternatives></inline-formula> observations. The pool sizes are chosen in nine different ways: In seven cases, pool sizes are identical for each sample, namely <inline-formula id="IEq174"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\in \{1,2,5,10,15,20,50\}$$\end{document}</tex-math><mml:math id="M428"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>15</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq174.gif"/></alternatives></inline-formula>. In two additional cases, pool sizes are mixed, i.e. each of the <italic>k</italic> samples within one dataset represents a pool of different size <inline-formula id="IEq175"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i\in \{1,2,5,10\}$$\end{document}</tex-math><mml:math id="M430"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq175.gif"/></alternatives></inline-formula> or <inline-formula id="IEq176"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i\in \{10,15,20,50\}$$\end{document}</tex-math><mml:math id="M432"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>15</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq176.gif"/></alternatives></inline-formula>. Figure <xref rid="Fig6" ref-type="fig">6</xref> summarizes the point estimates of the 1000 datasets for each of the nine pool size settings. It seems that (for this particular choice of model parameter values) parameter estimation works reliably for pool sizes up to ten cells, with smaller variance from single-cells to 5-cells. This applies also for the mixture of pool sizes for the small cell numbers. For cell numbers larger than ten, the range of estimated values becomes considerably larger, but without obvious bias, which also applies to the mixture of the larger pool sizes. Additional file <xref rid="MOESM6" ref-type="media">6</xref> shows repetitions of this study for different choices of population parameters. The results there confirm the observations made here.<fig id="Fig6"><label>Fig. 6</label><caption><p>Violin plots of parameter estimates for two-population LN–LN model on 9000 simulated datasets, i.e. on 1000 datasets for each pool size composition. Left: Results for single-cell, 2-cell, 5-cell, 10-cell pool and their mixture. Right: Results for larger pool sizes, namely 10-, 15-, 20-, 50-cell pools and their mixture. Turquoise: Results for 10-cell pools; these are repeated across the left and right panels. The true parameters are marked in orange</p></caption><graphic xlink:href="12859_2021_3970_Fig6_HTML" id="MO47"/></fig></p>
      <p id="Par71">Figure <xref rid="Fig6" ref-type="fig">6</xref> suggests <inline-formula id="IEq177"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=5$$\end{document}</tex-math><mml:math id="M434"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq177.gif"/></alternatives></inline-formula> or varying small pool sizes as ideal choices since its estimates show smaller variance than the other pool sizes. This simulation study, however, has been performed in an idealized <italic>in silico</italic> setting: We did not include any measurement noise. In practice, however, it is well known that single-cells suffer more from such noise than samples with many cells. The ideal choice of pool size may hence be larger in practice.</p>
    </sec>
    <sec id="Sec28">
      <title>Simulation study on impact of parameter values</title>
      <p id="Par72">The underlying data-generating model obviously influences the ability of the maximum likelihood estimator to re-infer the true parameter values: Values of <inline-formula id="IEq178"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_1$$\end{document}</tex-math><mml:math id="M436"><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq178.gif"/></alternatives></inline-formula> close to 0.5, small differences between <inline-formula id="IEq179"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1$$\end{document}</tex-math><mml:math id="M438"><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq179.gif"/></alternatives></inline-formula> and <inline-formula id="IEq180"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _2$$\end{document}</tex-math><mml:math id="M440"><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq180.gif"/></alternatives></inline-formula> and large <inline-formula id="IEq181"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M442"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq181.gif"/></alternatives></inline-formula> blur the data and complicate parameter inference in practice. In the simulation study of this section, we investigate the sensitivity of parameter inference and which scenarios could be realistically identified.</p>
      <p id="Par73">We use the same datasets as in the previous simulation study: The parameter choices from before are considered as the standard and compared to those from Additional file <xref rid="MOESM6" ref-type="media">6</xref>. In detail, <inline-formula id="IEq182"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_1$$\end{document}</tex-math><mml:math id="M444"><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq182.gif"/></alternatives></inline-formula> is reduced from 0.2 to 0.1 in one setting and increased to 0.4 in the next. <inline-formula id="IEq183"><alternatives><tex-math id="M445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _2$$\end{document}</tex-math><mml:math id="M446"><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq183.gif"/></alternatives></inline-formula> is increased from 0 to 1, and <inline-formula id="IEq184"><alternatives><tex-math id="M447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M448"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq184.gif"/></alternatives></inline-formula> increases from 0.2 to 0.5. <inline-formula id="IEq185"><alternatives><tex-math id="M449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1$$\end{document}</tex-math><mml:math id="M450"><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq185.gif"/></alternatives></inline-formula> is kept fixed to 2 in all settings. As before, we consider 1000 data sets for every parameter setting and compare the resulting estimates to the true values. This was done for all pool sizes considered before, but here we only comment on the results of the 10-cell pools and refer to Additional file <xref rid="MOESM6" ref-type="media">6</xref> for all other pool size settings.</p>
      <p id="Par74">Figure <xref rid="Fig7" ref-type="fig">7</xref> shows the results of the study. In each row of the plot, we compare the estimates of the datasets that were simulated with the standard parameters to the estimates of the datasets that were simulated with one of the parameters changed. Even if only one parameter is changed all parameters are estimated. Each violin accumulates the estimates of 1000 datasets. For easier comparison, each of the twelve tiles shows the standard setting as turquoise violin, which means those are repeated in each row.<fig id="Fig7"><label>Fig. 7</label><caption><p>Violin plots of parameter estimates for two-population LN–LN model for varying parameters <inline-formula id="IEq266"><alternatives><tex-math id="M451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p,\,\mu _2\,\text{and}\,\,\sigma$$\end{document}</tex-math><mml:math id="M452"><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi>σ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq266.gif"/></alternatives></inline-formula>. Five parameter sets (see Additional file <xref rid="MOESM6" ref-type="media">6</xref>) were used to simulate 1000 datasets from each of which they were back-inferred. Violin plots for the standard setting <inline-formula id="IEq267"><alternatives><tex-math id="M453">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p=0.2,\,\mu _1 = 2,\,\mu _2 = 0\,\text{and}\,\sigma = 0.2$$\end{document}</tex-math><mml:math id="M454"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq267.gif"/></alternatives></inline-formula> are coloured turquoise. The true parameters used to simulate the data are marked in orange</p></caption><graphic xlink:href="12859_2021_3970_Fig7_HTML" id="MO48"/></fig></p>
      <p id="Par75">When changing the parameter values, they can still be derived without obvious additional bias, but accuracy decreases for increasing <italic>p</italic>, decreasing <inline-formula id="IEq186"><alternatives><tex-math id="M455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _2-\mu _1$$\end{document}</tex-math><mml:math id="M456"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq186.gif"/></alternatives></inline-formula> and increasing <inline-formula id="IEq187"><alternatives><tex-math id="M457">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M458"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq187.gif"/></alternatives></inline-formula> (with few exceptions). Results for other pool sizes (see Additional file <xref rid="MOESM6" ref-type="media">6</xref>) show that these observations can be confirmed with some additions: Larger pool sizes infer parameters more accurately if <italic>p</italic> is smaller. In an increased first population setting (<inline-formula id="IEq188"><alternatives><tex-math id="M459">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p = 40\%$$\end{document}</tex-math><mml:math id="M460"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>40</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq188.gif"/></alternatives></inline-formula>), <inline-formula id="IEq189"><alternatives><tex-math id="M461">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1$$\end{document}</tex-math><mml:math id="M462"><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq189.gif"/></alternatives></inline-formula> can be better inferred if the data set consists of smaller pools. For larger pools, the estimation of <inline-formula id="IEq190"><alternatives><tex-math id="M463">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1$$\end{document}</tex-math><mml:math id="M464"><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq190.gif"/></alternatives></inline-formula> and <inline-formula id="IEq191"><alternatives><tex-math id="M465">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _2$$\end{document}</tex-math><mml:math id="M466"><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq191.gif"/></alternatives></inline-formula> works comparably well after increasing <inline-formula id="IEq192"><alternatives><tex-math id="M467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _2$$\end{document}</tex-math><mml:math id="M468"><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq192.gif"/></alternatives></inline-formula>. In general, the estimation of <inline-formula id="IEq193"><alternatives><tex-math id="M469">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M470"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq193.gif"/></alternatives></inline-formula> is the most difficult one: As shown in Eq. (<xref rid="Equ1" ref-type="">1</xref>), the mean (and variance) of the lognormal distribution is determined by both the parameters <inline-formula id="IEq194"><alternatives><tex-math id="M471">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1$$\end{document}</tex-math><mml:math id="M472"><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq194.gif"/></alternatives></inline-formula> and <inline-formula id="IEq195"><alternatives><tex-math id="M473">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _2$$\end{document}</tex-math><mml:math id="M474"><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq195.gif"/></alternatives></inline-formula> and by <inline-formula id="IEq196"><alternatives><tex-math id="M475">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M476"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq196.gif"/></alternatives></inline-formula>. Estimates of <inline-formula id="IEq197"><alternatives><tex-math id="M477">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M478"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq197.gif"/></alternatives></inline-formula> will be negatively correlated with estimates <inline-formula id="IEq198"><alternatives><tex-math id="M479">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\mu }}_1$$\end{document}</tex-math><mml:math id="M480"><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq198.gif"/></alternatives></inline-formula> and <inline-formula id="IEq199"><alternatives><tex-math id="M481">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\mu }}_2$$\end{document}</tex-math><mml:math id="M482"><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq199.gif"/></alternatives></inline-formula> if the mean is determined correctly. Indeed, in pools of 15 cells with increased <inline-formula id="IEq200"><alternatives><tex-math id="M483">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M484"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq200.gif"/></alternatives></inline-formula>, we see that <inline-formula id="IEq201"><alternatives><tex-math id="M485">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1$$\end{document}</tex-math><mml:math id="M486"><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq201.gif"/></alternatives></inline-formula> is slightly overestimated. Therefore, to keep the mean <inline-formula id="IEq202"><alternatives><tex-math id="M487">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M488"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq202.gif"/></alternatives></inline-formula> is underestimated. This worsens in larger pools.</p>
    </sec>
    <sec id="Sec29">
      <title>Simulation study on the uncertainty of pool sizes</title>
      <p id="Par76">One key assumption of the stochprofML algorithm is that the exact number of cells in each cell pool is known. In [<xref ref-type="bibr" rid="CR8">8</xref>], accordingly, ten cells were randomly taken from each sample by experimental design. However, different experimental protocols may not reveal the exact cell number: In [<xref ref-type="bibr" rid="CR19">19</xref>], for example, tissue samples were taken as whole cancer spheroids. Here, the cell numbers were experimentally unknown but estimated using light sheet microscopy and 3D image analysis. Since the stochprofML algorithm requires the pool sizes as input parameter, some estimate has to be passed to it. It is intuitively obvious that the better the prior knowledge about the cell pool sizes, the better the final model parameter estimate. In this simulation study, we investigate the consequences of misspecification.</p>
      <p id="Par77">In a first simulation study, we reuse from before the 1000 synthetic 10-cell datasets. Each of these contains 50 10-cell samples, simulated with underlying model parameters <inline-formula id="IEq203"><alternatives><tex-math id="M489">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p = 0.2$$\end{document}</tex-math><mml:math id="M490"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq203.gif"/></alternatives></inline-formula>, <inline-formula id="IEq204"><alternatives><tex-math id="M491">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1 = 2$$\end{document}</tex-math><mml:math id="M492"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq204.gif"/></alternatives></inline-formula>, <inline-formula id="IEq205"><alternatives><tex-math id="M493">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _2 = 0$$\end{document}</tex-math><mml:math id="M494"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq205.gif"/></alternatives></inline-formula> and <inline-formula id="IEq206"><alternatives><tex-math id="M495">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma = 0.2$$\end{document}</tex-math><mml:math id="M496"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq206.gif"/></alternatives></inline-formula>. As before, we re-infer the population parameters using the stochprofML algorithm. This time, however, we use varying pool sizes from 5 to 15 as input parameters of the algorithm. This is a misspecification except for the true value 10. The resulting parameter estimates (empirical median and 2.5%-/97.5%-quantiles across the 1000 datasets) are depicted in Fig. <xref rid="Fig8" ref-type="fig">8</xref>. Estimates are optimal or at least among the best in terms of empirical bias and variance when using the correct pool size. With increasing assumed cell number, the estimates of <italic>p</italic> decrease, i.e. the fraction of cells from the higher expressed population is assumed to be smaller. This is a reasonable consequence of overestimating <italic>n</italic>, because in this case the surplus cells are assigned to the second population with lower (or even close-to-zero) expression. Consequently, at the same time the estimates of <inline-formula id="IEq207"><alternatives><tex-math id="M497">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _2$$\end{document}</tex-math><mml:math id="M498"><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq207.gif"/></alternatives></inline-formula> decrease to be even smaller. In a second simulation study, we use the two settings with mixed cell pool sizes as introduced above. One setting embraces cell pools with rather small cell numbers (single-, 2-, 5- and 10-cell samples), the other one pools with larger cell numbers (10-, 15-, 20- and 50-cell samples). For each of the two scenarios, we generate one dataset with 50 samples. We denote the true 50-dimensional pool size vectors by <inline-formula id="IEq208"><alternatives><tex-math id="M499">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{ n}_\text{small}$$\end{document}</tex-math><mml:math id="M500"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mtext>small</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq208.gif"/></alternatives></inline-formula> and <inline-formula id="IEq209"><alternatives><tex-math id="M501">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{ n}_\text{large}$$\end{document}</tex-math><mml:math id="M502"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mtext>large</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq209.gif"/></alternatives></inline-formula> and employ these vectors for re-estimating the model parameters <italic>p</italic>, <inline-formula id="IEq210"><alternatives><tex-math id="M503">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1$$\end{document}</tex-math><mml:math id="M504"><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq210.gif"/></alternatives></inline-formula>, <inline-formula id="IEq211"><alternatives><tex-math id="M505">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _2$$\end{document}</tex-math><mml:math id="M506"><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq211.gif"/></alternatives></inline-formula> and <inline-formula id="IEq212"><alternatives><tex-math id="M507">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M508"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq212.gif"/></alternatives></inline-formula>. Then, we estimate the parameters again for the same two datasets for 1000 times, but this time using perturbed pool size vectors as input to the algorithm, introducing artificial misspecification. These 50-dimensional pool size vectors are generated as follows: For each component, we draw a Poisson-distributed random variable with intensity parameter equal to the respective component of the true vectors <inline-formula id="IEq213"><alternatives><tex-math id="M509">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{ n}_\text{small}$$\end{document}</tex-math><mml:math id="M510"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mtext>small</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq213.gif"/></alternatives></inline-formula> or <inline-formula id="IEq214"><alternatives><tex-math id="M511">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{ n}_\text{large}$$\end{document}</tex-math><mml:math id="M512"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mtext>large</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq214.gif"/></alternatives></inline-formula>. Zeros are set to one, the minimum pool size. Figure <xref rid="Fig9" ref-type="fig">9</xref> shows these <inline-formula id="IEq215"><alternatives><tex-math id="M513">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2\times 1000$$\end{document}</tex-math><mml:math id="M514"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq215.gif"/></alternatives></inline-formula> parameter estimates as compared to the true parameter values and those for which the true size vectors <inline-formula id="IEq216"><alternatives><tex-math id="M515">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{ n}_\text{small}$$\end{document}</tex-math><mml:math id="M516"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mtext>small</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq216.gif"/></alternatives></inline-formula> and <inline-formula id="IEq217"><alternatives><tex-math id="M517">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{ n}_\text{large}$$\end{document}</tex-math><mml:math id="M518"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mtext>large</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq217.gif"/></alternatives></inline-formula> were used as input. The violins of the estimates for the smaller cell pools (based on <inline-formula id="IEq218"><alternatives><tex-math id="M519">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{n}_\text{small}$$\end{document}</tex-math><mml:math id="M520"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mtext>small</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq218.gif"/></alternatives></inline-formula>) indicate that the estimates of <italic>p</italic> and <inline-formula id="IEq219"><alternatives><tex-math id="M521">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _1$$\end{document}</tex-math><mml:math id="M522"><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq219.gif"/></alternatives></inline-formula> are fairly accurate, but the estimates of <inline-formula id="IEq220"><alternatives><tex-math id="M523">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _2$$\end{document}</tex-math><mml:math id="M524"><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq220.gif"/></alternatives></inline-formula> have large variance, and <inline-formula id="IEq221"><alternatives><tex-math id="M525">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M526"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq221.gif"/></alternatives></inline-formula> is overestimated in all 1000 runs. This is plausible as population 1 (the one with higher log-mean gene expression) is only present on average in 20% of the cells; even when misspecifying the pool sizes, the cells of population 1 are still detectable since this is the population responsible for most gene expression. Consequently, all remaining cells are assigned to population 2, which has lower or even almost no expression. If the pool size is assumed too low, this second population will be estimated to have on average a higher expression; if it is assumed too large, the second population will be estimated to have a lower expression. This leads to a broader distribution and thus an overestimation of <inline-formula id="IEq222"><alternatives><tex-math id="M527">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M528"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq222.gif"/></alternatives></inline-formula>.<fig id="Fig8"><label>Fig. 8</label><caption><p>Parameter estimates for (partly) misspecified pool sizes across 1000 synthetic datasets: The true pool size is 10 in every dataset. The stochprofML algorithm, however, uses values from 5 to 15 as input parameter. Bars cover the range between the empirical 2.5%- and 97.5%-quantiles. The dots mark the empirical median, the orange line the true parameter values used for simulation</p></caption><graphic xlink:href="12859_2021_3970_Fig8_HTML" id="MO49"/></fig><fig id="Fig9"><label>Fig. 9</label><caption><p>Parameter inference under misspecification of the cell pool size: parameters are estimated for two datasets, one generated based on a pool size vector <inline-formula id="IEq269"><alternatives><tex-math id="M529">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{n}_\text{small}{}$$\end{document}</tex-math><mml:math id="M530"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mtext>small</mml:mtext></mml:msub><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq269.gif"/></alternatives></inline-formula> with values between 1 and 10 (left violin in each panel); the other one based on a vector <inline-formula id="IEq270"><alternatives><tex-math id="M531">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{n}_\text{large}{}$$\end{document}</tex-math><mml:math id="M532"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mtext>large</mml:mtext></mml:msub><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq270.gif"/></alternatives></inline-formula> with values between 10 and 50 (right violin in each panel). From left to right: Estimates of <inline-formula id="IEq2701"><alternatives><tex-math id="M533">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p,\,\mu _1,\,\mu _2\,\text{and}\,\,\sigma$$\end{document}</tex-math><mml:math id="M534"><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi>σ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq2701.gif"/></alternatives></inline-formula>. The violins depict estimates across 1000 estimation runs, where each relies on a randomly sampled misspecified pool size vector as described in the main text. Orange: True parameters values. Light blue: Estimates without misspecification of the pool size vector</p></caption><graphic xlink:href="12859_2021_3970_Fig9_HTML" id="MO50"/></fig></p>
      <p id="Par78">The results for the larger cell pools (based on <inline-formula id="IEq223"><alternatives><tex-math id="M535">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{n}_\text{large}$$\end{document}</tex-math><mml:math id="M536"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mtext>large</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq223.gif"/></alternatives></inline-formula>) show a similar pattern. In this case, however, the impact of misspecification is less visible, as also confirmed by additional simulations in Additional file <xref rid="MOESM6" ref-type="media">6</xref>. For large cell pools, the averaging effect across cells is strong anyway and in that sense more robust. In the study here, due to variability of parameter estimates, the <inline-formula id="IEq224"><alternatives><tex-math id="M537">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M538"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq224.gif"/></alternatives></inline-formula> parameter is often even better estimated when using a misspecified pool size vector than when using the true one. It might also be appropriate to repeat the parameter estimation, as shown here, with similar pool size vectors to get more robust estimates.</p>
      <p id="Par79">Taken together, stochprofML can be used even if exact pool sizes are unknown. In that case, the numbers should be approximated as well as possible.</p>
    </sec>
    <sec id="Sec30">
      <title>Interpretation of estimated heterogeneity</title>
      <p id="Par80">The stochprofML algorithm estimates the assumed parameterized single-cell distributions underlying the samples and, as described before, selects the most appropriate number of cell populations using the BIC. Assume we have performed this estimation for samples from two different groups, cases and controls. One may in practice then want to know whether the inferred single-cell populations are substantially different between the two groups, e.g. in case the estimated log-means <inline-formula id="IEq225"><alternatives><tex-math id="M539">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\mu }}_\text{cases}$$\end{document}</tex-math><mml:math id="M540"><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>cases</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq225.gif"/></alternatives></inline-formula> and <inline-formula id="IEq226"><alternatives><tex-math id="M541">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\mu }}_\text{controls}$$\end{document}</tex-math><mml:math id="M542"><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>controls</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq226.gif"/></alternatives></inline-formula> are close to each other. A related question is whether the difference is biologically relevant.</p>
      <p id="Par81">We hence seek a method that can judge statistical significance and potentially reject the null hypothesis that two single-cell populations are the same; and at the same time allow the interpretation of similarity. Direct application of Kolmogorov-Smirnov or likelihood-ratio tests to the observed data is impossible here since the single-cell data is unobserved: We only measure the overall gene expression of pools of cells. Calculation of the Kullback-Leibler divergence of the two distributions would be possible; however, it is not target-oriented for our application where we seek an interpretable measure of similarity rather than a comparison between more than two population densities.</p>
      <p id="Par82">For our purposes, we use a simple intuitive measure of similarity—the overlap of two PDFs, that is the intersection of the areas under both PDF curves:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M543">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text{OVL}(f,g)=\int _{-\infty }^\infty \min \{f(x),g(x)\}dx \end{aligned}$$\end{document}</tex-math><mml:math id="M544" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>OVL</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3970_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>for two continuous one-dimensional PDFs <italic>f</italic> and <italic>g</italic> [see also <xref ref-type="bibr" rid="CR25">25</xref>]. The overlap lies between zero and one, with zero indicating maximum dissimilarity and one implying (almost sure) equality. In our case, we are particularly interested in the overlap of two lognormal PDFs: <graphic position="anchor" xlink:href="12859_2021_3970_Fige_HTML" id="MO41"/></p>
      <p id="Par83">Figure <xref rid="Fig10" ref-type="fig">10</xref> shows examples of such overlaps. Here, the overlap ranges from 12% for two quite different distributions to 86% for two seemingly similar distributions. The question is where to draw a cutoff, that is, at what point we decide to label two distributions as different. Current literature considers two cases: Either the parametric case [e.g. <xref ref-type="bibr" rid="CR26">26</xref>], where both distributions are given by their distribution families and parameter values; or the nonparametric case [e.g. <xref ref-type="bibr" rid="CR25">25</xref>], where observations (but no theoretical distributions) are available for the two populations. Our application builds a third case: On the one hand, we want to compare two parametric distributions, but the model parameters are just given as estimates based on (potentially small) datasets, thus they are uncertain; on the other hand, we do not directly observe the single-cell gene expression but just the pooled one. To address this issue, we suggest to again take into account the original data that led to the estimated parametric PDFs. As an example, assume that we consider two sets of pooled gene expression, one for a group of cases and one for a group of controls. In both groups, pooled gene expression is available as 10-cell measurements, but the two groups differ in sample size. Let’s say the cases contain 50 samples and the controls 100. We assume the LN–LN model with two populations and estimate the mixture and population parameters using the stochprofML algorithm separately for each group, leading to estimates <inline-formula id="IEq227"><alternatives><tex-math id="M545">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{p}_\text{cases},\,\hat{\mu }_{1,\text{cases}},\,\hat{\mu }_{2,\text{cases}},\,\hat{\sigma }_\text{cases}{} \,\text{and}\,\hat{p}_\text{controls},\,\hat{\mu }_{1,\text{controls}},\,\hat{\mu }_{2,\text{controls}},\,\hat{\sigma }_\text{controls}{}$$\end{document}</tex-math><mml:math id="M546"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>cases</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>cases</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mtext>cases</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>cases</mml:mtext></mml:msub><mml:mrow/><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>controls</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>controls</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mtext>controls</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>controls</mml:mtext></mml:msub><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq227.gif"/></alternatives></inline-formula>. We now aim to assess whether the first populations in both groups have identical characteristics, i.e. whether <inline-formula id="IEq228"><alternatives><tex-math id="M547">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{L}}{\mathcal{N}}(\hat{\mu }_{1,\text{cases}},\hat{\sigma }^2_\text{cases})\,\text{and}\,\,{\mathcal{L}}{\mathcal{N}}(\hat{\mu }_{1,\text{controls}},\hat{\sigma }^2_\text{controls})$$\end{document}</tex-math><mml:math id="M548"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>cases</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>cases</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>controls</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>controls</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq228.gif"/></alternatives></inline-formula> are estimates of the same distribution.<fig id="Fig10"><label>Fig. 10</label><caption><p>Four examples of overlapping PDFs, together with the overlap area as defined in Eq. (<xref rid="Equ7" ref-type="">7</xref>).  Slightly different parameters result in very small overlap area such as 12% in <bold>a</bold> or 39% in <bold>b</bold>. An overlap area of 69% in <bold>c</bold> still shows two very different distributions. Overlaps larger than 86% as in <bold>d</bold> come with similar distributions</p></caption><graphic xlink:href="12859_2021_3970_Fig10_HTML" id="MO51"/></fig></p>
      <p id="Par84">Figure <xref rid="Fig10" ref-type="fig">10</xref> displays the single-cell PDFs of the first population and their overlaps for various values of the estimates. For example, in Fig. <xref rid="Fig10" ref-type="fig">10</xref>d, the orange curve shows the single-cell PDF of population 1 inferred from the cases, yielding <inline-formula id="IEq229"><alternatives><tex-math id="M549">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{L}}{\mathcal{N}}(\hat{\mu }_{1,\text{cases}}=2.10,\hat{\sigma }^2_\text{cases}=0.19^2)$$\end{document}</tex-math><mml:math id="M550"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>cases</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.10</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>cases</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>19</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq229.gif"/></alternatives></inline-formula>, and the blue one shows the inferred single-cell PDF of population 1 from the controls, <inline-formula id="IEq230"><alternatives><tex-math id="M551">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{L}}{\mathcal{N}}(\hat{\mu }_{1,\text{controls}}=2.03,\hat{\sigma }^2_\text{controls}=0.20^2)$$\end{document}</tex-math><mml:math id="M552"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>controls</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.03</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>controls</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>20</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq230.gif"/></alternatives></inline-formula>. The overlap of these two inferred PDFs equals 86%.</p>
      <p id="Par85">We now aim to test the null hypothesis that the underlying populations</p>
      <p id="Par86"><inline-formula id="IEq231"><alternatives><tex-math id="M553">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{L}}{\mathcal{N}}({\mu }_{1,\text{cases}},{\sigma }^2_\text{cases})\,\text{and}\,\,{\mathcal{L}}{\mathcal{N}}({\mu }_{1,\text{controls}},{\sigma }^2_\text{controls})$$\end{document}</tex-math><mml:math id="M554"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>cases</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mtext>cases</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>controls</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mtext>controls</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq231.gif"/></alternatives></inline-formula> are the same versus the experimental hypothesis that they are different. We perform a sampling-based test: Taking into account the inferred population probabilities <inline-formula id="IEq232"><alternatives><tex-math id="M555">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{p}_\text{cases}{} \,\text{and}\,\hat{p}_\text{controls}$$\end{document}</tex-math><mml:math id="M556"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>cases</mml:mtext></mml:msub><mml:mrow/><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>controls</mml:mtext></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq232.gif"/></alternatives></inline-formula> and the number of samples and cells in the data, we can estimate the number of cells which the estimates <inline-formula id="IEq2320"><alternatives><tex-math id="M557">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\varvec{\theta }}_\text{cases}\, \text{and}\,\hat{\varvec{\theta }}_\text{controls}$$\end{document}</tex-math><mml:math id="M558"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>cases</mml:mtext></mml:msub><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>controls</mml:mtext></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq2320.gif"/></alternatives></inline-formula> relied on. The larger this cell number, the less expected uncertainty about the estimated population distributions <inline-formula id="IEq2321"><alternatives><tex-math id="M559">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{L}}{\mathcal{N}}(\hat{\mu }_{1,\text{cases}},\hat{\sigma }^2_\text{cases})\,\text{and}\,\,{\mathcal{L}}{\mathcal{N}}(\hat{\mu }_{1,\text{controls}},\hat{\sigma }^2_\text{controls})$$\end{document}</tex-math><mml:math id="M560"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>cases</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>cases</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>controls</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>controls</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq2321.gif"/></alternatives></inline-formula> (neglecting the impact of pool sizes). In our example, let <inline-formula id="IEq2322"><alternatives><tex-math id="M561">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{p}_\text{cases}=12\%$$\end{document}</tex-math><mml:math id="M562"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>cases</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>12</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq2322.gif"/></alternatives></inline-formula>. Then, approximately 12% of the 500 cells from the cases group (<inline-formula id="IEq233"><alternatives><tex-math id="M563">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$50 \times$$\end{document}</tex-math><mml:math id="M564"><mml:mrow><mml:mn>50</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq233.gif"/></alternatives></inline-formula> 10-cell samples) belonged to population 1, that is 60 cells. For <inline-formula id="IEq234"><alternatives><tex-math id="M565">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{p}_\text{controls}=20\%$$\end{document}</tex-math><mml:math id="M566"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>controls</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq234.gif"/></alternatives></inline-formula>, 200 cells were expected to be from the first population (that is 20% of 1000 cells, coming from the 100 <inline-formula id="IEq235"><alternatives><tex-math id="M567">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M568"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq235.gif"/></alternatives></inline-formula> 10-cell measurements for the controls). In our procedure, we compare parameter estimates that are based on the respective numbers of single cells, i.e. 60 cells for cases and 200 cells for controls. We perform the following steps:<list list-type="bullet"><list-item><p id="Par87">Calculate <inline-formula id="IEq236"><alternatives><tex-math id="M569">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{OVL}_{\text{original}},$$\end{document}</tex-math><mml:math id="M570"><mml:mrow><mml:msub><mml:mtext>OVL</mml:mtext><mml:mtext>original</mml:mtext></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq236.gif"/></alternatives></inline-formula> the overlap of the PDFs of <inline-formula id="IEq2360"><alternatives><tex-math id="M571">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{N}}(\hat{\mu }_{1,\text{cases}}=2.10,\hat{\sigma }^2_\text{cases}=0.19^2)\,\text{and}\,{\mathcal{L}}{\mathcal{N}}(\hat{\mu }_{1,\text{controls}}=2.03,\hat{\sigma }_\text{controls}^2=0.20^2)$$\end{document}</tex-math><mml:math id="M572"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>cases</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.10</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>cases</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>19</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>controls</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.03</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>controls</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>20</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq2360.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par88">Under the null hypothesis, the two distributions are identical. We approximate the parameters of this identical distribution as <inline-formula id="IEq237"><alternatives><tex-math id="M573">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\mu }_{1,\text{mean}}= (\hat{\mu }_{1,\text{cases}}+\hat{\mu }_{1,\text{controls}})/2\,\text{and}\,\tilde{\sigma }_\text{mean}= (\hat{\sigma }_\text{cases}+\hat{\sigma }_\text{controls})/2$$\end{document}</tex-math><mml:math id="M574"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>mean</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>cases</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>controls</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mtext>mean</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>cases</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>controls</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq237.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par89">Repeat <inline-formula id="IEq238"><alternatives><tex-math id="M575">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N = 1000$$\end{document}</tex-math><mml:math id="M576"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq238.gif"/></alternatives></inline-formula> times:<list list-type="bullet"><list-item><p id="Par90">Draw dataset <italic>A</italic> of size 60 from <inline-formula id="IEq239"><alternatives><tex-math id="M577">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{L}}{\mathcal{N}}(\tilde{\mu }_{1,\text{mean}},\tilde{\sigma }_\text{mean}^2)$$\end{document}</tex-math><mml:math id="M578"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>mean</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mtext>mean</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq239.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par91">Draw dataset <italic>B</italic> of size 200 from <inline-formula id="IEq240"><alternatives><tex-math id="M579">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{L}}{\mathcal{N}}(\tilde{\mu }_{1,\text{mean}},\tilde{\sigma }_\text{mean}^2)$$\end{document}</tex-math><mml:math id="M580"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>mean</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mtext>mean</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq240.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par92">Estimate the log-mean and log-sd for these two datasets using the method of maximum likelihood, yielding <inline-formula id="IEq241"><alternatives><tex-math id="M581">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\mu }_A,\,\hat{\sigma }_A,\,\hat{\mu }_B\,\text{and}\,\hat{\sigma }_B$$\end{document}</tex-math><mml:math id="M582"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>B</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq241.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par93">Calculate <inline-formula id="IEq242"><alternatives><tex-math id="M583">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{OVL}\left( f_{{\mathcal{L}}{\mathcal{N}}(\hat{\mu }_A,\hat{\sigma }_A^2)},f_{{\mathcal{L}}{\mathcal{N}}(\hat{\mu }_B,\hat{\sigma }_B^2)}\right)$$\end{document}</tex-math><mml:math id="M584"><mml:mrow><mml:mtext>OVL</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq242.gif"/></alternatives></inline-formula>.</p></list-item></list></p></list-item><list-item><p id="Par94">Sort the <inline-formula id="IEq243"><alternatives><tex-math id="M585">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M586"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq243.gif"/></alternatives></inline-formula> overlap values and select the empirical 5% quantile <inline-formula id="IEq244"><alternatives><tex-math id="M587">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{OVL}_{0.05}{}$$\end{document}</tex-math><mml:math id="M588"><mml:mrow><mml:msub><mml:mtext>OVL</mml:mtext><mml:mrow><mml:mn>0.05</mml:mn></mml:mrow></mml:msub><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq244.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par95">Compare the overlap from the original data to this quantile:<list list-type="bullet"><list-item><p id="Par96">If <inline-formula id="IEq245"><alternatives><tex-math id="M589">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{OVL}_{original}\le \text{OVL}_{0.05}{}$$\end{document}</tex-math><mml:math id="M590"><mml:mrow><mml:msub><mml:mtext>OVL</mml:mtext><mml:mrow><mml:mi mathvariant="italic">original</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mtext>OVL</mml:mtext><mml:mrow><mml:mn>0.05</mml:mn></mml:mrow></mml:msub><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq245.gif"/></alternatives></inline-formula>, the null hypothesis that both populations are the same can be rejected.</p></list-item><list-item><p id="Par97">If <inline-formula id="IEq246"><alternatives><tex-math id="M591">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{OVL}_{original}&gt;\text{OVL}_{0.05}{}$$\end{document}</tex-math><mml:math id="M592"><mml:mrow><mml:msub><mml:mtext>OVL</mml:mtext><mml:mrow><mml:mi mathvariant="italic">original</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mtext>OVL</mml:mtext><mml:mrow><mml:mn>0.05</mml:mn></mml:mrow></mml:msub><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq246.gif"/></alternatives></inline-formula>, the null hypothesis cannot be rejected.</p></list-item></list></p></list-item></list>This procedure is related to the idea of parametric bootstrap and the bootstrap percentile method with the difference that our original data is on the <inline-formula id="IEq247"><alternatives><tex-math id="M593">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M594"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq247.gif"/></alternatives></inline-formula>-cell level and the parametrically simulated data is on the single-cell level. Note that under the null hypothesis the two population distributions are identical, but in practice this will hardly ever be the case for the estimated population parameters. Taking the average of estimated log-means and log-standard deviations in the second bullet point above is one way of approximating the null distribution.</p>
      <p id="Par98">The left panel of Fig. <xref rid="Fig11" ref-type="fig">11</xref> shows one outcome of the above-described procedure (i.e. the stochastic, sampling-based algorithm was run once) with the above-specified values of the parameter estimates. Here, <inline-formula id="IEq248"><alternatives><tex-math id="M595">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{OVL}_{original}{}$$\end{document}</tex-math><mml:math id="M596"><mml:mrow><mml:msub><mml:mtext>OVL</mml:mtext><mml:mrow><mml:mi mathvariant="italic">original</mml:mi></mml:mrow></mml:msub><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq248.gif"/></alternatives></inline-formula> lies in the critical range such that we reject the null hypothesis that the gene expression of the populations in question stem from the same lognormal distribution. We thus assume a difference here. The right panel of Fig. <xref rid="Fig11" ref-type="fig">11</xref> demonstrates the importance of taking into account the number of cells which the original estimates were based on: Here, we show one outcome of the above described steps, but this time we assume that for the control group there were only 30 10-cell samples (i.e. 300 cells in total). With the same population fraction as before (<inline-formula id="IEq249"><alternatives><tex-math id="M597">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{p}_\text{controls}=20\%),$$\end{document}</tex-math><mml:math id="M598"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>controls</mml:mtext></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq249.gif"/></alternatives></inline-formula> the datasets <italic>B</italic> now contain only 60 cells. Here, the value <inline-formula id="IEq2480"><alternatives><tex-math id="M599">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{OVL}_{original}{}$$\end{document}</tex-math><mml:math id="M600"><mml:mrow><mml:msub><mml:mtext>OVL</mml:mtext><mml:mrow><mml:mi mathvariant="italic">original</mml:mi></mml:mrow></mml:msub><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq2480.gif"/></alternatives></inline-formula> does not fall into the critical range, and therefore we would not reject the null hypothesis that the two populations of interest are the same.<fig id="Fig11"><label>Fig. 11</label><caption><p>Variability of the overlap between the PDFs of the two distributions described in Fig. <xref rid="Fig10" ref-type="fig">10</xref>d. The panels show histograms of <inline-formula id="IEq271"><alternatives><tex-math id="M601">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=1000$$\end{document}</tex-math><mml:math id="M602"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq271.gif"/></alternatives></inline-formula> simulated overlap values which are simulated as described in the main text. Left: We assume that the estimates of the orange distribution relied on 60 single cells and the blue distribution on 200 single cells. Right: For both distributions, parameters are assumed to be estimated on 60 single cells. The 86% overlap of the original PDFs from Fig. <xref rid="Fig10" ref-type="fig">10</xref>d, i.e. <inline-formula id="IEq272"><alternatives><tex-math id="M603">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{L}}{\mathcal{N}}({\hat{\mu }}_{1,cases}=2.10,{\hat{\sigma }}^2_{cases}=0.19^2)\,\text{and}\,{\mathcal{L}}{\mathcal{N}}({\hat{\mu }}_{1,controls}=2.03,{\hat{\sigma }}_{controls}^2=0.20^2)$$\end{document}</tex-math><mml:math id="M604"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.10</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="italic">cases</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>19</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.03</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">controls</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>20</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq272.gif"/></alternatives></inline-formula>, is marked in turquoise. The light grey bars of the histogram indicate values below the empirical 5%-quantile. If the original overlap falls into this range, we reject the null hypothesis that both distributions identical</p></caption><graphic xlink:href="12859_2021_3970_Fig11_HTML" id="MO52"/></fig></p>
      <p id="Par99">When testing for heterogeneity for several genes simultaneously, multiple testing issues should be taken into account. However, genes will not in general be independent from each other.</p>
    </sec>
    <sec id="Sec31">
      <title>Prediction of sample compositions</title>
      <p id="Par100">The stochprofML algorithm estimates the parameters of the mixture model, i.e.—in case of at least two populations—the probability for each cell within a pool to fall into the specific populations. It does <italic>not</italic> reveal the individual pool compositions. In some applications, however, exactly this information is of particular interest. Here, we present how one can infer likely population compositions of a particular cell pool. This is done in a two-step approach via conditional prediction: First, one estimates the model parameters from the observed pooled gene expression, i.e. one obtains an estimate <inline-formula id="IEq250"><alternatives><tex-math id="M605">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\varvec{\theta }} \,\text{of}\,{\varvec{\theta }}.$$\end{document}</tex-math><mml:math id="M606"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mspace width="0.166667em"/><mml:mtext>of</mml:mtext><mml:mspace width="0.166667em"/><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq250.gif"/></alternatives></inline-formula> Then, one assumes that <inline-formula id="IEq2501"><alternatives><tex-math id="M607">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\theta }{} \text{ equals}\,\hat{\varvec{\theta }}{}$$\end{document}</tex-math><mml:math id="M608"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow/><mml:mspace width="0.333333em"/><mml:mtext>equals</mml:mtext><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq2501.gif"/></alternatives></inline-formula> and derives the most probable population composition via maximizing the conditional probability of a specific composition given the pooled gene expression (for calculations, see Additional file <xref rid="MOESM4" ref-type="media">4</xref>). We evaluate this procedure via a simulation study. As before, we simulate data using the stochprofML package. In particular, we use the LN–LN model with two populations with parameters <inline-formula id="IEq251"><alternatives><tex-math id="M609">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{p}=(0.2,0.8),\,\varvec{\mu }=(2,0)\,\text{and}\,\sigma =0.2$$\end{document}</tex-math><mml:math id="M610"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:mn>0.8</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq251.gif"/></alternatives></inline-formula> . Each simulated measurement shall contain the pooled expression of <italic>n</italic> = 5 cells, and we sample k = 100 such measurements. We store the original true cell pool compositions from the data simulation step in order to later compare the composition predictions to the ground truth. Having generated the synthetic data, we apply stochprofML to estimate the model parameters <inline-formula id="IEq2511"><alternatives><tex-math id="M611">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{p},\,\varvec{\mu } \,\text{and}\,\sigma$$\end{document}</tex-math><mml:math id="M612"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>σ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq2511.gif"/></alternatives></inline-formula>. Figure <xref rid="Fig12" ref-type="fig">12</xref> shows a histogram of one simulated data set along with the PDF of the true population mixture and the PDF of the estimated population mixture (that is the LN–LN model with parameters <inline-formula id="IEq252"><alternatives><tex-math id="M613">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\hat{p}}=(0.14, 0.86),\,\varvec{\hat{\mu }}=( 2.04, 0)\,\text{and}\,\hat{\sigma }= 0.20$$\end{document}</tex-math><mml:math id="M614"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.14</mml:mn><mml:mo>,</mml:mo><mml:mn>0.86</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2.04</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq252.gif"/></alternatives></inline-formula>).<fig id="Fig12"><label>Fig. 12</label><caption><p>Histogram of simulated data underlying the prediction of cell pool compositions in Fig. <xref rid="Fig13" ref-type="fig">13</xref>a: 100 synthetic 5-cell measurements arising from the LN–LN model with two populations with parameters <inline-formula id="IEq273"><alternatives><tex-math id="M615">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{p}=(0.2,0.8),\,\varvec{\mu }=(2,0)\,\text{and}\,\,\sigma =0.2$$\end{document}</tex-math><mml:math id="M616"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:mn>0.8</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq273.gif"/></alternatives></inline-formula>. The PDF with true model parameters is shown in orange, the PDF with estimated parameters <inline-formula id="IEq2730"><alternatives><tex-math id="M617">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\hat{p}}=(0.14, 0.86),\,\varvec{\hat{\mu }}=( 2.04, 0)\,\text{and}\,\hat{\sigma }= 0.20$$\end{document}</tex-math><mml:math id="M618"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.14</mml:mn><mml:mo>,</mml:mo><mml:mn>0.86</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2.04</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq2730.gif"/></alternatives></inline-formula> in blue</p></caption><graphic xlink:href="12859_2021_3970_Fig12_HTML" id="MO53"/></fig></p>
      <p id="Par101">Next, we calculate the conditional probability mass function (PMF; see Additional file <xref rid="MOESM4" ref-type="media">4</xref> for details) for each possible population composition conditioned on the particular pooled gene expression measurement. Figure <xref rid="Fig13" ref-type="fig">13</xref>a and Table <xref rid="Tab2" ref-type="table">2</xref> show results for the first six (out of 100) pooled measurements.<fig id="Fig13"><label>Fig. 13</label><caption><p>Estimation of cell pool compositions in the two-population LN–LN model: conditional probabilities of numbers of cells from the first population in the first six measurements of the synthetic datasets described in the main text and in Fig. <xref rid="Fig12" ref-type="fig">12</xref>, given the respective pooled gene expression measurement. Blue bars show the conditional probabilities using estimated model parameters, and orange bars show those when using the true parameters. True cell numbers from the first population are marked with a black box around the bars. Results for <bold>a</bold> simulated 5-cell data and, <bold>b</bold> 10-cell data</p></caption><graphic xlink:href="12859_2021_3970_Fig13_HTML" id="MO54"/></fig></p>
      <p id="Par102">In particular, Fig. <xref rid="Fig13" ref-type="fig">13</xref>a displays the conditional PMF of all possible compositions (i.e. <italic>k</italic> times population and 5-<italic>k</italic> times population 2 for <inline-formula id="IEq253"><alternatives><tex-math id="M619">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\in \{0,1,\ldots ,5\}).$$\end{document}</tex-math><mml:math id="M620"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq253.gif"/></alternatives></inline-formula> Blue bars stand for these probabilities when <inline-formula id="IEq2530"><alternatives><tex-math id="M621">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\varvec{\theta }}$$\end{document}</tex-math><mml:math id="M622"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq2530.gif"/></alternatives></inline-formula> is used as model parameter value. Orange stands for the hypothetical case where the true value <inline-formula id="IEq2531"><alternatives><tex-math id="M623">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\theta }{}$$\end{document}</tex-math><mml:math id="M624"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq2531.gif"/></alternatives></inline-formula> is known and used. These two scenarios are in good agreement with each other.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Estimates of numbers of cells from the first population in the simulated 5-cell data described in Figs. <xref rid="Fig12" ref-type="fig">12</xref> and <xref rid="Fig13" ref-type="fig">13</xref>a and in the main text</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2" colspan="2">Estimator for # of cells in pop. 1</th><th align="left" colspan="6">Measurement index</th><th align="left" rowspan="2"># of hits</th></tr><tr><th align="left">1</th><th align="left">2</th><th align="left">3</th><th align="left">4</th><th align="left">5</th><th align="left">6</th></tr></thead><tbody><tr><td align="left" rowspan="2">Estimated parameters</td><td align="left">Mean</td><td align="left">0.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">2.14</td><td align="left">1.01</td><td align="left">98</td></tr><tr><td align="left">MLE (CI)</td><td align="left">0 (0,0)</td><td align="left">1 (1,1)</td><td align="left">1 (1,1)</td><td align="left">1 (1,1)</td><td align="left">2 (2,3)</td><td align="left">1 (1,1)</td><td align="left">98 (100)</td></tr><tr><td align="left" rowspan="2">True parameters</td><td align="left">Mean</td><td align="left">0.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">2.39</td><td align="left">1.02</td><td align="left">97</td></tr><tr><td align="left">MLE (CI)</td><td align="left">0 (0,0)</td><td align="left">1 (1,1)</td><td align="left">1 (1,1)</td><td align="left">1 (1,1)</td><td align="left">2 (2,3)</td><td align="left">1 (1,1)</td><td align="left">97 (100)</td></tr><tr><td align="left" colspan="2">True # of cells from population 1</td><td align="left">0</td><td align="left">1</td><td align="left">1</td><td align="left">1</td><td align="left">2</td><td align="left">1</td><td align="left"/></tr></tbody></table><table-wrap-foot><p><italic>Columns:</italic> Estimation results for the first six measurements from the datasets and (last column) summary across all 100 samples. <italic>Rows:</italic> Estimation of cell numbers are based on conditional probabilities that use either the estimated model parameters (rows 1 and 2, corresponding to blue bars in Fig. <xref rid="Fig13" ref-type="fig">13</xref>a) or the true values (rows 3 and 4, orange bars). Within each of these two choices one can consider the mean number of cells from population 1 as determined by the conditional probabilities (rows 1 and 3) or the maximum likelihood estimator (MLE) that maximizes the conditional probabilities (rows 2 and 4, first value) including a 95% confidence interval that covers at least 95% of the conditional probability mass (rows 2 and 4, in parentheses). The last row shows the true pool composition. The last column shows for each estimator how many of the 100 cell numbers were inferred correctly (defined as follows: rounded mean is exact match; MLE is exact match; confidence interval (CI) includes correct number)</p></table-wrap-foot></table-wrap></p>
      <p id="Par103">We regard the most likely sample composition to be the one that maximizes the conditional PMF (maximum likelihood principle). The true composition (ground truth) is marked with a black box around the blue and orange bars. We observe in Fig. <xref rid="Fig13" ref-type="fig">13</xref>a that the composition is in all six cases inferred correctly and mostly unambiguously. Only for the fifth measurement, there is visible probability mass on a composition other than the true one. In fact, it is the only pool (out of the six considered ones) with two cells from the first population. Alternatively to the maximum likelihood estimator, one can also regard the expected composition—the empirical weighted mean of numbers of cells in the first population—or confidence intervals for this number. The respective estimates for the first six measurements of the dataset are shown in Table <xref rid="Tab2" ref-type="table">2</xref>. The results are consistent with the interpretation of Fig. <xref rid="Fig13" ref-type="fig">13</xref>a. Certainly, the precision of the prediction depends on the employed pool sizes, the underlying true model parameters and how reliably these were inferred during the first step. We showed above that larger cell pools lead to less precise parameter inference. Hence, we repeat the prediction of sample compositions on another dataset, this time based on <inline-formula id="IEq254"><alternatives><tex-math id="M625">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10$$\end{document}</tex-math><mml:math id="M626"><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq254.gif"/></alternatives></inline-formula>-cell pools. All other parameters remain unchanged. The resulting conditional probabilities are depicted in Fig. <xref rid="Fig13" ref-type="fig">13</xref>b. Since <inline-formula id="IEq255"><alternatives><tex-math id="M627">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p=0.2$$\end{document}</tex-math><mml:math id="M628"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq255.gif"/></alternatives></inline-formula>, one expects on average two cells to be from the first population in each 10-cell pool. As in the previous <inline-formula id="IEq256"><alternatives><tex-math id="M629">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5$$\end{document}</tex-math><mml:math id="M630"><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq256.gif"/></alternatives></inline-formula>-cell case, most predictions show a clear pattern. However, probability masses are spread more widely. Measurements 3 and 4 exemplify that almost identical gene expression measurements (<inline-formula id="IEq257"><alternatives><tex-math id="M631">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y=19.69\,\text{and}\,y=19.79$$\end{document}</tex-math><mml:math id="M632"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>19.69</mml:mn><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>19.79</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq257.gif"/></alternatives></inline-formula>) can arise from different underlying pool compositions (two times population 1 in measurement 3 vs. three times population 1 in measurement 4). For more similar population parameters, the estimation will get worse, which will then propagate to the well composition prediction. In such cases, to predict the pool compositions, one may use additional parallel measurements of other genes that might separate the population better by their different expression profiles while the pool composition stays the same across genes.</p>
    </sec>
  </sec>
  <sec id="Sec32">
    <title>Conclusion</title>
    <p id="Par104">With the stochprofML package, we provide an environment to profile gene expression measurements obtained from small pools of cells. Experimentalists may choose this approach if single-cell measurements are impossible in their lab (e.g. for bacteria), if the drop-out rate is high in single-cell libraries, if budget or time are limited, or if one prefers to avoid the stress which is put on the cells during separation. The latest implementation even allows to combine information from different pool sizes, in particular, to simultaneously analyze single-cell and and <inline-formula id="IEq258"><alternatives><tex-math id="M633">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M634"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq258.gif"/></alternatives></inline-formula>-cell data.</p>
    <p id="Par105">We demonstrated the usage and performance of the stochprofML algorithm in various examples and simulation studies. These have been performed in an idealized <italic>in silico</italic> environment. This should be kept in mind when incorporating the results into experimental planning and analysis. Subsequent interpretation of heterogeneity will be informative if based on a good model estimate. The assumption of independent expression across genes within the same tissue sample is a simplification of nature that leads to less complex parameter estimation. Previous experimental validation [<xref ref-type="bibr" rid="CR9">9</xref>] provided evidence that transcriptional heterogeneity can be parameterized through stochastic profiling even for non-ideal settings such as small sample sizes or in the presence of gene-gene correlation. If populations are similar or diffuse, they may not be identified as distinct populations through stochprofML. The same, however, applies to other statistical methods and also to the analysis of single-cell data. For the latter, noise is expected to be more pronounced than in <inline-formula id="IEq259"><alternatives><tex-math id="M635">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M636"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3970_Article_IEq259.gif"/></alternatives></inline-formula>-cell pools, which again motivates the use of our method.</p>
    <p>The optimal pool size with respect to bias and variance of the corresponding parameter estimators will depend on unknown properties such as numbers of populations and their characteristics, and also on the relationship between the pool size and the amount of technical measurement noise. The latter aspect has been excluded from the studies here but further supports the application of stochastic profiling.</p>
  </sec>
  <sec id="Sec33">
    <title>Availability of data and requirements</title>
    <p id="Par106"><bold>Project name:</bold> stochprofML.</p>
    <p id="Par107"><bold>Project home page:</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/fuchslab/stochprofML">https://github.com/fuchslab/stochprofML</ext-link>.</p>
    <p id="Par108"><bold>Operating system(s):</bold> Platform independent.</p>
    <p id="Par109"><bold>License:</bold> GNU GPL.</p>
    <p id="Par110"><bold>Programming language:</bold> R.</p>
    <p id="Par111"><bold>Other requirements:</bold> None; We used R version 3.5.3 [<xref ref-type="bibr" rid="CR27">27</xref>]. In addition to our stochprofML version 2.0.3 [<xref ref-type="bibr" rid="CR28">28</xref>], we attached the following R packages: MASS version 7.3-51.1 [<xref ref-type="bibr" rid="CR29">29</xref>], numDeriv version 2016.8-1.1 [<xref ref-type="bibr" rid="CR30">30</xref>], EnvStats version 2.3.1 [<xref ref-type="bibr" rid="CR31">31</xref>], vioplot version 0.3.4. [<xref ref-type="bibr" rid="CR32">32</xref>], zoo version 1.8-7 [<xref ref-type="bibr" rid="CR33">33</xref>], sm version 2.2-5.6 [<xref ref-type="bibr" rid="CR34">34</xref>], cowplot version 1.0.0 [<xref ref-type="bibr" rid="CR35">35</xref>], ggplot2 version 3.2.1 [<xref ref-type="bibr" rid="CR36">36</xref>], knitr version 1.27 [<xref ref-type="bibr" rid="CR37">37</xref>], microbenchmark version 1.4-7 [<xref ref-type="bibr" rid="CR38">38</xref>], and RcolorBrewer version 1.1-2 [<xref ref-type="bibr" rid="CR39">39</xref>]. All calculations were performed on a 64-bit x86_64-redhat-linux-gnu platform running under Fedora 28.</p>
    <p id="Par112"><bold>Any restrictions to use by non-academics</bold>: GPL license, open source.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec34">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_3970_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: PDF of n-cell measurements of T cell populations</bold>. Derivation of the PDF shown in Eq. (<xref rid="Equ3" ref-type="">3</xref>) in Section Small-pool models of heterogeneous gene expression.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2021_3970_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2: PDF of pooled gene expression for mixed pool size vectors</bold>. Derivation of the PDF of samples that contain different cell numbers.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2021_3970_MOESM3_ESM.pdf">
            <caption>
              <p><bold>Additional file 3: Transformation of population probabilities</bold>. Details about the transformation of the population probabilities during parameter optimization.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2021_3970_MOESM4_ESM.pdf">
            <caption>
              <p><bold>Additional file 4: Derivation of sample composition probabilities</bold>. Derivation of the conditional probability of a cell composition given the measured gene expression needed in Section Prediction of sample compositions.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2021_3970_MOESM5_ESM.pdf">
            <caption>
              <p><bold>Additional file 5: Interactive Functions</bold>. Examples how the interactive usage of stochprofML works.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2021_3970_MOESM6_ESM.pdf">
            <caption>
              <p><bold>Additional file 6: Details on Simulation Studies</bold>. More information and further details on the Simulation study on optimal pool size, on the Simulation study on impact of parameter values and on the Simulation study on the uncertainty of pool sizes.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>mRNA</term>
        <def>
          <p id="Par4">Messenger ribonucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>LN–LN model</term>
        <def>
          <p id="Par5">Lognormal–lognormal model</p>
        </def>
      </def-item>
      <def-item>
        <term>rLN–LN model</term>
        <def>
          <p id="Par6">Relaxed lognormal–lognormal model</p>
        </def>
      </def-item>
      <def-item>
        <term>EXP–LN model</term>
        <def>
          <p id="Par7">Exponential–lognormal model</p>
        </def>
      </def-item>
      <def-item>
        <term>PDF</term>
        <def>
          <p id="Par8">Probability density function</p>
        </def>
      </def-item>
      <def-item>
        <term>BIC</term>
        <def>
          <p id="Par9">Bayesian information criterion</p>
        </def>
      </def-item>
      <def-item>
        <term>OVL</term>
        <def>
          <p id="Par10">Overlap</p>
        </def>
      </def-item>
      <def-item>
        <term>PMF</term>
        <def>
          <p id="Par11">Probability mass function</p>
        </def>
      </def-item>
      <def-item>
        <term>MLE</term>
        <def>
          <p id="Par12">Maximum likelihood estimator</p>
        </def>
      </def-item>
      <def-item>
        <term>CI</term>
        <def>
          <p id="Par13">Confidence interval</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Susanne Amrhein and Xiaoling Zhang for code contributions to the simulation studies and Mercè Garí for feedback.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>The work was designed and the methods developed by LA and CF. CF implemented the first version of the software, LA developed the second version and performed the simulation studies. LA and CF wrote the paper. All authors have read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Open Access funding enabled and organized by Projekt DEAL. Our research was supported by the German Research Foundation within the SFB 1243, Subproject A17 (funding of LA’s position), by the Helmholtz Initiative and Networking Fund, Pilot Project Uncertainty Quantification (funding of LA’s position), by the German Federal Ministry of Education and Research under Grant Number 01DH17024 (funding of research visits for scientific exchange), and by the National Institutes of Health under Grant Number U01-CA215794 (funding of research visit for scientific exchange). The funders had no role in study design, experiments, manuscript writing and decisions concerning submission.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All scripts used in this study can be found in our open GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/fuchslab/Stochastic_Profiling_in_R">https://github.com/fuchslab/Stochastic_Profiling_in_R</ext-link>.</p>
  </notes>
  <notes id="FPar3">
    <title>Ethics approval and consent to participate</title>
    <p id="Par113">Not applicable.</p>
  </notes>
  <notes id="FPar4">
    <title>Consent for publication</title>
    <p id="Par114">Not applicable.</p>
  </notes>
  <notes id="FPar5" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par115">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurimoto</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>An improved single-cell cDNA amplification method for efficient high-density oligonucleotide microarray analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <volume>34</volume>
        <issue>5</issue>
        <fpage>e42</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkl050</pub-id>
        <pub-id pub-id-type="pmid">16547197</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tietjen</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Rihel</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Koentges</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zakhary</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Dulac</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Single-cell transcriptional analysis of neuronal progenitors</article-title>
        <source>Neuron.</source>
        <year>2003</year>
        <volume>38</volume>
        <issue>2</issue>
        <fpage>161</fpage>
        <lpage>175</lpage>
        <pub-id pub-id-type="doi">10.1016/S0896-6273(03)00229-0</pub-id>
        <pub-id pub-id-type="pmid">12718852</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Entering the era of single-cell transcriptomics in biology and medicine</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>22</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2764</pub-id>
        <pub-id pub-id-type="pmid">24524133</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ziegenhain</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vieth</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Parekh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reinius</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Guillaumet-Adkins</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Smets</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative analysis of single-cell RNA sequencing methods</article-title>
        <source>Mol Cell</source>
        <year>2017</year>
        <volume>65</volume>
        <issue>4</issue>
        <fpage>631</fpage>
        <lpage>643.e4</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2017.01.023</pub-id>
        <pub-id pub-id-type="pmid">28212749</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>453</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3337</pub-id>
        <pub-id pub-id-type="pmid">25822800</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grün</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kester</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Validation of noise models for single-cell transcriptomics</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>6</issue>
        <fpage>637</fpage>
        <lpage>640</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2930</pub-id>
        <pub-id pub-id-type="pmid">24747814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Natarajan</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Casale</surname>
            <given-names>FP</given-names>
          </name>
          <name>
            <surname>Proserpio</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Scialdone</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>2</issue>
        <fpage>155</fpage>
        <lpage>160</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3102</pub-id>
        <pub-id pub-id-type="pmid">25599176</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Janes</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Holmberg</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Cabral</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Brugge</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Identifying single-cell molecular programs by stochastic profiling</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>4</issue>
        <fpage>311</fpage>
        <lpage>317</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1442</pub-id>
        <pub-id pub-id-type="pmid">20228812</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bajikar</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Fuchs</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Roller</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Janes</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>5</issue>
        <fpage>E626</fpage>
        <lpage>E635</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1311647111</pub-id>
        <pub-id pub-id-type="pmid">24449900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen-Orr</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Khatri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bodian</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Staedtler</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>NM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell type-specific gene expression differences in complex tissues</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>4</issue>
        <fpage>287</fpage>
        <lpage>289</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1439</pub-id>
        <pub-id pub-id-type="pmid">20208531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Erkkilä</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lehmusvaara</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ruusuvuori</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Visakorpi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Shmulevich</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic analysis of gene expression measurements from heterogeneous tissues</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>20</issue>
        <fpage>2571</fpage>
        <lpage>2577</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq406</pub-id>
        <pub-id pub-id-type="pmid">20631160</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gong</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kohane</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Brinkmann</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Staedtler</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Letzkus</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimal deconvolution of transcriptional profiling data using quadratic programming with application to complex clinical blood samples</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>11</issue>
        <fpage>e27156</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0027156</pub-id>
        <pub-id pub-id-type="pmid">22110609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abbas</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Wolslegel</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Seshasayee</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Modrusan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>HF</given-names>
          </name>
        </person-group>
        <article-title>Deconvolution of Blood Microarray Data Identifies Cellular Activation Patterns in Systemic Lupus Erythematosus</article-title>
        <source>PLoS ONE.</source>
        <year>2009</year>
        <volume>4</volume>
        <issue>7</issue>
        <fpage>e6098</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0006098</pub-id>
        <pub-id pub-id-type="pmid">19568420</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mathematical modelling of transcriptional heterogeneity identifies novel markers and subpopulations in complex tissues</article-title>
        <source>Sci Rep</source>
        <year>2016</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>18909</fpage>
        <pub-id pub-id-type="doi">10.1038/srep18909</pub-id>
        <pub-id pub-id-type="pmid">26739359</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaujoux</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Seoighe</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Cell Mix: a comprehensive toolbox for gene expression deconvolution</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>17</issue>
        <fpage>2211</fpage>
        <lpage>2212</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt351</pub-id>
        <pub-id pub-id-type="pmid">23825367</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Aliee H, Theis F. AutoGeneS: automatic gene selection using multi-objective optimization for RNA-seq deconvolution. bioRxiv. 2020; Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/early/2020/02/23/2020.02.21.940650">https://www.biorxiv.org/content/early/2020/02/23/2020.02.21.940650</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hunt</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Freytag</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bahlo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gagnon-Bartsch</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>dtangle: accurate and robust cell type deconvolution</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>35</volume>
        <issue>12</issue>
        <fpage>2093</fpage>
        <lpage>2099</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty926</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frishberg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Peshes-Yaloz</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Cohn</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Rosentul</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Steuerman</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Valadarsky</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Cell composition analysis of bulk genomics using single-cell data</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>327</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0355-5</pub-id>
        <?supplied-pmid 30886410?>
        <pub-id pub-id-type="pmid">30886410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tirier</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Preusser</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Amrhein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Steiger</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pheno-seq: linking visual features and gene expression in 3D cell culture systems</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>2045</fpage>
        <lpage>2322</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-48771-4</pub-id>
        <pub-id pub-id-type="pmid">30765737</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bengtsson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Gene expression profiling in single cells from the pancreatic islets of Langerhans reveals lognormal distribution of mRNA levels</article-title>
        <source>Genome Res</source>
        <year>2005</year>
        <volume>15</volume>
        <issue>10</issue>
        <fpage>1388</fpage>
        <lpage>1392</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.3820805</pub-id>
        <pub-id pub-id-type="pmid">16204192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fenton</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>The sum of log-normal probability distributions in scatter transmission systems</article-title>
        <source>IEEE Trans Commun</source>
        <year>1960</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>57</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1109/TCOM.1960.1097606</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Feldman</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Valdez-Flores</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <source>Applied probability and stochastic processes</source>
        <year>2010</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nelder</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Mead</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A simplex method for function minimization</article-title>
        <source>Comput J</source>
        <year>1965</year>
        <volume>7</volume>
        <issue>4</issue>
        <fpage>308</fpage>
        <lpage>313</lpage>
        <pub-id pub-id-type="doi">10.1093/comjnl/7.4.308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwarz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Estimating the dimension of a model</article-title>
        <source>Ann Stat.</source>
        <year>1978</year>
        <volume>6</volume>
        <issue>2</issue>
        <fpage>461</fpage>
        <lpage>464</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1176344136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pastore</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Calcagnì</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Measuring distribution similarities between samples: a distribution-free overlapping index</article-title>
        <source>Front Psychol</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1089</fpage>
        <pub-id pub-id-type="doi">10.3389/fpsyg.2019.01089</pub-id>
        <pub-id pub-id-type="pmid">31231264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Inman</surname>
            <given-names>HF</given-names>
          </name>
          <name>
            <surname>Bradley</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>The overlapping coefficient as a measure of agreement between probability distributions and point estimation of the overlap of two normal densities</article-title>
        <source>Commun Stat Theory Methods</source>
        <year>1989</year>
        <volume>18</volume>
        <issue>10</issue>
        <fpage>3851</fpage>
        <lpage>3874</lpage>
        <pub-id pub-id-type="doi">10.1080/03610928908830127</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">R Core Team. R: A Language and Environment for Statistical Computing. Vienna, Austria; 2019. <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/">https://www.R-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Amrhein L, Fuchs C. stochprofML: stochastic profiling using maximum likelihood estimation; 2020. R package version 2.0.3. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=stochprofML">https://CRAN.R-project.org/package=stochprofML</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Venables</surname>
            <given-names>WN</given-names>
          </name>
          <name>
            <surname>Ripley</surname>
            <given-names>BD</given-names>
          </name>
        </person-group>
        <source>Modern applied statistics with S</source>
        <year>2002</year>
        <edition>4</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Gilbert P, Varadhan R. numDeriv: accurate numerical derivatives; 2019. R package version 2016.8-1.1. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=numDeriv">https://CRAN.R-project.org/package=numDeriv</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Millard</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <source>EnvStats: an R package for environmental statistics</source>
        <year>2013</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Adler D, Kelly ST. vioplot: Violin Plot; 2019. R package version 0.3.4. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/TomKellyGenetics/vioplot">https://github.com/TomKellyGenetics/vioplot</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeileis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grothendieck</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Zoo: S3 infrastructure for regular and irregular time series</article-title>
        <source>J Stat Softw</source>
        <year>2005</year>
        <volume>14</volume>
        <issue>6</issue>
        <fpage>1</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v014.i06</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Bowman AW, Azzalini A. R package sm: nonparametric smoothing methods (version 2.2-5.6). University of Glasgow, UK and Università di Padova, Italia; 2018. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.stats.gla.ac.uk/%7eadrian/sm/">http://www.stats.gla.ac.uk/~adrian/sm/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Wilke CO. cowplot: Streamlined Plot Theme and Plot Annotations for ’ggplot2’; 2019. R package version 1.0.0. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=cowplot">https://CRAN.R-project.org/package=cowplot</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>Ggplot2: elegant graphics for data analysis</source>
        <year>2016</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Stodden</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Leisch</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>knitr: a comprehensive tool for reproducible research in R</article-title>
        <source>Implementing reproducible computational research</source>
        <year>2014</year>
        <publisher-loc>Boca Raton</publisher-loc>
        <publisher-name>Chapman and Hall/CRC</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Mersmann O. microbenchmark: Accurate Timing Functions; 2019. R package version 1.4-7. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=microbenchmark">https://CRAN.R-project.org/package=microbenchmark</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Neuwirth E. RColorBrewer: ColorBrewer Palettes; 2014. R package version 1.1-2. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=RColorBrewer">https://CRAN.R-project.org/package=RColorBrewer</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
