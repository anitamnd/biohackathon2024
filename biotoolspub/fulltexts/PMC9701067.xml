<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?covid-19-tdm?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9701067</article-id>
    <article-id pub-id-type="pmid">36434502</article-id>
    <article-id pub-id-type="publisher-id">5064</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-05064-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>sitePath: a visual tool to identify polymorphism clades and help find fixed and parallel mutations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ji</surname>
          <given-names>Chengyang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Han</surname>
          <given-names>Na</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cheng</surname>
          <given-names>Yexiao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shang</surname>
          <given-names>Jingzhe</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weng</surname>
          <given-names>Shenghui</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Rong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zhou</surname>
          <given-names>Hang-Yu</given-names>
        </name>
        <address>
          <email>zhy@ism.cams.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5869-651X</contrib-id>
        <name>
          <surname>Wu</surname>
          <given-names>Aiping</given-names>
        </name>
        <address>
          <email>wap@ism.cams.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.506261.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 0706 7839</institution-id><institution>Institute of Systems Medicine, </institution><institution>Chinese Academy of Medical Sciences and Peking Union Medical College, </institution></institution-wrap>Beijing, 100005 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.494590.5</institution-id><institution>Suzhou Institute of Systems Medicine, </institution></institution-wrap>Suzhou, 215123 Jiangsu China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.254147.1</institution-id><institution-id institution-id-type="ISNI">0000 0000 9776 7793</institution-id><institution>School of Life Science and Technology, </institution><institution>China Pharmaceutical University, </institution></institution-wrap>Nanjing, 211100 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>504</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Â© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Identifying polymorphism clades on phylogenetic trees could help detect punctual mutations that are associated with viral functions. With visualization tools coloring the tree, it is easy to visually find clades where most sequences have the same polymorphism state. However, with the fast accumulation of viral sequences, a computational tool to automate this process is urgently needed.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, by implementing a branch-and-bound-like search method, we developed an R package named sitePath to identify polymorphism clades automatically. Based on the identified polymorphism clades, fixed and parallel mutations could be inferred. Furthermore, sitePath also integrated visualization tools to generate figures of the calculated results. In an example with the influenza A virus H3N2 dataset, the detected fixed mutations coincide with antigenic shift mutations. The highly specificity and sensitivity of sitePath in finding fixed mutations were achieved for a range of parameters and different phylogenetic tree inference software.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The result suggests that sitePath can identify polymorphism clades per site. The clustering of sequences on a phylogenetic tree can be used to infer fixed and parallel mutations. High-quality figures of the calculated results could also be generated by sitePath.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-05064-4.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Phylogenetics</kwd>
      <kwd>Sequence analysis</kwd>
      <kwd>Visualization</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National key research and development program</institution>
        </funding-source>
        <award-id>2021YFC230130</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wu</surname>
            <given-names>Aiping</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>CAMS Innovation Fund for Medical Sciences</institution>
        </funding-source>
        <award-id>2021-I2M-1-061</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wu</surname>
            <given-names>Aiping</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>92169106</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wu</surname>
            <given-names>Aiping</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>special research fund for central universities, Peking Union Medical College</institution>
        </funding-source>
        <award-id>2021-PT180-001</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wu</surname>
            <given-names>Aiping</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>China postdoctoral science foundation grants</institution>
        </funding-source>
        <award-id>2019M660548</award-id>
        <award-id>2020T130007ZX</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Suzhou science and technology development plan</institution>
        </funding-source>
        <award-id>szs2020311</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wu</surname>
            <given-names>Aiping</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Youthful Teacher Project of Peking Union Medical College</institution>
        </funding-source>
        <award-id>3332019114</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004608</institution-id>
            <institution>Natural Science Foundation of Jiangsu Province</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BK20220278</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>Â© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Identifying polymorphism clades on phylogenetic tree could help detect punctual mutations that are associated with viral function. In viral evolution, fixed mutation, which quickly dominates the viral population since its initial introduction, is accompanied by the formation of polymorphism clades and is usually associated with the shift of key functions [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. While parallel mutation, which refers to the mutation occurring independently in different polymorphism clades, has a high probability of being the result of natural selection under selective pressure [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par5">With visualization tools coloring the tree branches according to a selected site, it is easy to visually find clades where most sequences have the same polymorphism state. However, with the increasing viral sequences in public database, a tool to automate this process is needed. A reasonable algorithm aimed at resolving a given phylogenetic tree into polymorphism clades should consider both the site polymorphism and the tree topology, which is not included in current methods [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par6">In this study, we developed an R package named sitePath to resolve tree trunks and identify polymorphism clades per site automatically. Using aligned sequences and an estimated tree as input, sitePath resolves tree trunks by clustering sequences with the same polymorphism state and implements a branch-and-bound-like search method to identify polymorphism clades per site through entropy minimization. The function of Inferring fixed mutation, parallel mutation and visualizing the calculated results are all integrated into the R package.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Identification of phylogenetic tree trunks</title>
      <p id="Par7">To resolve tree trunks, sitePath assumes that most descendant sequences of each terminal node have the same polymorphism state. The Treemmer algorithm [<xref ref-type="bibr" rid="CR6">6</xref>] collapses tree tips and guarantees that the collapsed tree tips are within a monophyletic group. Here, the terminating condition for the Treemmer algorithm is changed to tree tips having the same polymorphism state. However, it is difficult to retrieve a monophyletic group when a few sequences in the group have different polymorphism states than the dominant one (Fig.Â <xref rid="Fig1" ref-type="fig">1</xref>A). The modified Treemmer algorithm would identify a few smaller groups instead of a single monophyletic group. To address this issue, another method similar to CD-HIT [<xref ref-type="bibr" rid="CR7">7</xref>] is implemented in an attempt to merge the smaller groups. The rule is that the average similarity of the group after merging is no lower than a threshold. The groups of sequences to be merged depend on which site being evaluated. It is therefore impossible to define a universal threshold for all sites. Instead, a universal rule for generating the threshold value is set as the median similarity of the sequences. Furthermore, a polymorphism state has to exist in enough sequences to be valid for defining clades and tree trunk terminals. Thus, the group with the number of sequences less than the predefined <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{\mathrm{min}}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq1.gif"/></alternatives></inline-formula> (the minimum number of sequences to define a valid polymorphism clade) will be treated as outlier and dropped. The tree trunks are found by linking the tree root and the ancestral node of all resulting groups. Only the longest tree trunks are retained if there are overlaps (Fig.Â <xref rid="Fig1" ref-type="fig">1</xref>A).<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematics and demonstration of sitePath. <bold>A</bold> All sequences but one on the upper side are in a monophyletic group with the purple polymorphism, which is also true for the sequences with the green polymorphism; the ancestral nodes of purple and red overlap on tree trunks so only red is retained, which is also the case for the gold and green polymorphisms. <bold>B</bold> For site <inline-formula id="IEq30"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X$$\end{document}</tex-math><mml:math id="M4"><mml:mi>X</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq30.gif"/></alternatives></inline-formula>, the initial entropy <inline-formula id="IEq31"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{0}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq31.gif"/></alternatives></inline-formula> is calculated by clading all sequences as <inline-formula id="IEq32"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{{C}_{1}\right\}$$\end{document}</tex-math><mml:math id="M8"><mml:mfenced close="}" open="{"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq32.gif"/></alternatives></inline-formula>; the minimum entropy <inline-formula id="IEq33"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{min}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq33.gif"/></alternatives></inline-formula> is achieved here when the clade set <inline-formula id="IEq34"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{{C}_{1}, {C}_{2}, {C}_{3}, {C}_{4}\right\}$$\end{document}</tex-math><mml:math id="M12"><mml:mfenced close="}" open="{"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq34.gif"/></alternatives></inline-formula> is found. The tree is colored according to the polymorphism state of site <inline-formula id="IEq35"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X$$\end{document}</tex-math><mml:math id="M14"><mml:mi>X</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq35.gif"/></alternatives></inline-formula> before clading and the dominant polymorphism state after clading. <bold>C</bold> An example of the resulting clades and mutation detection of the ZIKA virus dataset for site 139 of the polyprotein</p></caption><graphic xlink:href="12859_2022_5064_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par8">The phylogenetic pathways are derived from tree trunks. A phylogenetic pathway can be a combination of tree trunks to describe the ancestral and descendant relationships of clades. A clade closer to the tree root is defined to be ancestral to its neighbor clade. The default <inline-formula id="IEq2"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{\mathrm{min}}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq2.gif"/></alternatives></inline-formula> value depends on the total number of sequences in the input dataset. In sitePath, the default <inline-formula id="IEq3"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{\mathrm{min}}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq3.gif"/></alternatives></inline-formula> is defined as the number of pathways remains the same for a few consecutive <inline-formula id="IEq4"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{\mathrm{min}}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq4.gif"/></alternatives></inline-formula> values. For an input file containing all the available sequences of a virus or a proportional subsampled dataset of it, the default <inline-formula id="IEq5"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{\mathrm{min}}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq5.gif"/></alternatives></inline-formula> is recommended. While for a partial dataset of a virus, sitePath provides a method to help find the best <inline-formula id="IEq6"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{\mathrm{min} }$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq6.gif"/></alternatives></inline-formula> (Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>A).<fig id="Fig2"><label>Fig. 2</label><caption><p>Default <inline-formula id="IEq36"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{\mathrm{min}}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq36.gif"/></alternatives></inline-formula> value and recognition of fixed and parallel mutations. <bold>A</bold> Visualization of phylogenetic pathways using five different <inline-formula id="IEq37"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{\mathrm{min}}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq37.gif"/></alternatives></inline-formula>. <bold>B</bold> Fixed and non-fixed mutations were identified along a phylogenetic pathway. <bold>C</bold> The parallel mutation was recognized by comparing mutations between pairs of pathways</p></caption><graphic xlink:href="12859_2022_5064_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Branch-and-bound search for polymorphism clades</title>
      <p id="Par9">A branch-and-bound like search method is implemented to minimize the entropy of the polymorphism state across clades. The search is independently performed per site per tree trunk and the site will be referred as site <inline-formula id="IEq7"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X$$\end{document}</tex-math><mml:math id="M30"><mml:mi>X</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq7.gif"/></alternatives></inline-formula> in this section. The goal is to search for tree trunk nodes delimiting the sequences into such clade set <inline-formula id="IEq8"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{{C}_{1}, {C}_{2}, \dots , {C}_{M}\right\}$$\end{document}</tex-math><mml:math id="M32"><mml:mfenced close="}" open="{"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>â¯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq8.gif"/></alternatives></inline-formula> that the total entropy <inline-formula id="IEq9"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H=-\sum_{\mathrm{m}=1}^{M}\sum_{n}\mathrm{Pr}\left({S}_{m}^{n}\right)\times \mathrm{log}\left(\mathrm{Pr}\left({S}_{m}^{n}\right)\right)$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msubsup><mml:mo>â</mml:mo><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:msub><mml:mo>â</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mi mathvariant="normal">Pr</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mfenced><mml:mo>Ã</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">Pr</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mfenced></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq9.gif"/></alternatives></inline-formula> is minimized (Fig.Â <xref rid="Fig1" ref-type="fig">1</xref>B). Assume in clade <inline-formula id="IEq10"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{m}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq10.gif"/></alternatives></inline-formula> there are <inline-formula id="IEq11"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\left({C}_{m}\right)$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq11.gif"/></alternatives></inline-formula> sequences in total and <inline-formula id="IEq12"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\left({S}_{m}^{n}\right)$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq12.gif"/></alternatives></inline-formula> sequences with polymorphism state <inline-formula id="IEq13"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M42"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq13.gif"/></alternatives></inline-formula> for site <inline-formula id="IEq14"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X$$\end{document}</tex-math><mml:math id="M44"><mml:mi>X</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq14.gif"/></alternatives></inline-formula>. Then the probability of drawing polymorphism state <inline-formula id="IEq15"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M46"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq15.gif"/></alternatives></inline-formula> in <inline-formula id="IEq16"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{m}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq16.gif"/></alternatives></inline-formula> is <inline-formula id="IEq17"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Pr\left({S}_{m}^{n}\right)=N\left({S}_{m}^{n}\right)/N\left({C}_{m}\right)$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq17.gif"/></alternatives></inline-formula>. The search starts with initial entropy <inline-formula id="IEq18"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{0}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq18.gif"/></alternatives></inline-formula> by treating all sequences on the tree trunk as a single clade delimited by the tree root and the terminal node. Then, the search branches to explore new clade sets through iterations to find the goal clade set with the minimum entropy <inline-formula id="IEq19"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{\mathrm{min}}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>H</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq19.gif"/></alternatives></inline-formula>.</p>
      <p id="Par10">A breadth-first searching strategy is used, meaning that all possible clade sets branched from the previous clade set are evaluated when proceeding with the search. All <inline-formula id="IEq20"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N({C}_{m})$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq20.gif"/></alternatives></inline-formula> of a newly branched clade set is constrained to be greater than the predefined <inline-formula id="IEq21"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{\mathrm{min}}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq21.gif"/></alternatives></inline-formula> otherwise it will become inactive in later iterations. For each iteration, all the newly branched and other active clade sets are compared to find the temporary best solution with the lowest <inline-formula id="IEq22"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H$$\end{document}</tex-math><mml:math id="M60"><mml:mi>H</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq22.gif"/></alternatives></inline-formula> value. This is because <inline-formula id="IEq23"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H$$\end{document}</tex-math><mml:math id="M62"><mml:mi>H</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq23.gif"/></alternatives></inline-formula> is not monotonically decreasing in the search towards the goal clade set. The search is terminated when the temporary best solution stays the best after a few iterations. It is set as the total number of nodes of the tree trunk by default and can be folded by user to elongate the search.</p>
    </sec>
    <sec id="Sec5">
      <title>Fixed and parallel mutation</title>
      <p id="Par11">The result can be further used to find fixed and parallel mutations in phylogenetic pathways (Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>). Fixed mutation was found by comparing the dominant polymorphism state between adjacent clades (Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>B), while parallel mutation was found when a variant was observed on multiple tree trunks (Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>C). The performance (Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>) of detecting fixed mutations is tested on an influenza A H3N2 antigenic drifting dataset [<xref ref-type="bibr" rid="CR1">1</xref>]. For visualization, sitePath provides functions based on the R package ggtree [<xref ref-type="bibr" rid="CR8">8</xref>]. As an example, a ZIKA virus dataset (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for NCBI Accessions) is included in sitePath package. The result of its site 139 of the polyprotein, which was reported to be associated with enhanced virulence [<xref ref-type="bibr" rid="CR2">2</xref>], is shown in Fig.Â <xref rid="Fig1" ref-type="fig">1</xref>C. Moreover, sitePath was used on SARS-CoV-2 to find fixed and parallel mutations, which were found to be potentially adaptive for the virus [<xref ref-type="bibr" rid="CR9">9</xref>].<fig id="Fig3"><label>Fig. 3</label><caption><p>Performance evaluation of sitePath. <bold>A</bold> Recognition of fixed mutations in influenza A H3N2 with sitePath. Mutations are shown for all 43 antigenic cluster-determining sites [<xref ref-type="bibr" rid="CR1">1</xref>] in red and an additional 30 fixed sites detected by sitePath are colored in blue. <bold>B</bold>, <bold>C</bold> Changes in specificity, sensitivity and MCC against <inline-formula id="IEq38"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{\mathrm{min}}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq38.gif"/></alternatives></inline-formula> (<bold>B</bold>) and different phylogenetic tree-estimating software (<bold>C</bold>)</p></caption><graphic xlink:href="12859_2022_5064_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Computation time complexity</title>
      <p id="Par12">Tree trunk and clade identification approximately share the same algorithm time complexity of <inline-formula id="IEq24"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O\left(SL/{N}_{\mathrm{min}}\right)$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="("><mml:mi>S</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq24.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq25"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M68"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq25.gif"/></alternatives></inline-formula> is the total number of sequences and <inline-formula id="IEq26"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M70"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq26.gif"/></alternatives></inline-formula> is the length of the sequence alignment. To save time, the sites that are completely conserved or have too many ambiguous characters or gaps are ignored.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results</title>
    <sec id="Sec8">
      <title>Performance of sitePath finding fixed mutations</title>
      <p id="Par13">We tested sitePath on an influenza A H3N2 dataset with fixed mutations, which matches the antigenic shift of the virus [<xref ref-type="bibr" rid="CR1">1</xref>]. In this dataset, 43 fixed mutations were identified as antigenic-determined sites based on experimental work. All 43 fixed mutations in Smith et al.âs work were detected by sitePath. An extra set of 30 previously unreported fixed mutations was found (Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>A). Note that these 30 additional mutations occurred in inter- or intra-antigenic clusters, which may explain why these mutations were not listed in Smith et al.âs report.</p>
      <p id="Par14">The robustness of sitePath against the sole parameter <inline-formula id="IEq27"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{\mathrm{min}}$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq27.gif"/></alternatives></inline-formula> was also tested using Smith et al.âs dataset. Specificity, sensitivity and MCC (Matthews Correlation Coefficient) are relatively high for smaller <inline-formula id="IEq28"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{\mathrm{min}}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq28.gif"/></alternatives></inline-formula> values (Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>B). Sensitivity and MCC decrease with higher <inline-formula id="IEq29"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{\mathrm{min}}$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">min</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5064_Article_IEq29.gif"/></alternatives></inline-formula> values because the thresholds were too strict for sitePath to identify smaller clades. The impact of different tree-estimating software, including IQ-TREE [<xref ref-type="bibr" rid="CR10">10</xref>], FastTree [<xref ref-type="bibr" rid="CR11">11</xref>], and RaxML [<xref ref-type="bibr" rid="CR12">12</xref>] was also tested. They were all set to use the GTR substitution model with the GAMMA model of rate heterogeneity for MLE (Maximum Likelihood Estimation) method. Sensitivity, specificity and MCC were stable, reaching 0.95, 1 and 0.95 respectively for all three software (Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>C). However, we also noticed that sensitivity and MCC decreased to 0.8 for MEGAX [<xref ref-type="bibr" rid="CR13">13</xref>]. The models for other software were not available for the MLE method of MEGAX, and the JTT substitution model was used instead. The tree topology inferred by MEGAX partly disagrees with the antigenic cluster. A few fixed mutations were not dominant in the clade because of the topology disagreement, hence missed by sitePath as true positive. The source code for the performance test can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/wuaipinglab/sitePath_assessment">https://github.com/wuaipinglab/sitePath_assessment</ext-link>.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par15">To summarize, sitePath is a tool that attempts to cluster adjacent sequences on the phylogenetic tree using polymorphism per site per tree trunk. The branch-and-bound-like search method is used to minimize the polymorphism state across the clusters. The clustering result can be used to detect mutations with fixation or parallel patterns on the phylogenetic tree and all the results can be visualized accordingly.</p>
    <p id="Par16">The application of sitePath in viral sequences has been fully tested. In theory, sitePath could also be used in data sets with complex genomes such as prokaryotic and eukaryotic sequences. The computational consumption of dealing with complex sequences could also benefit from the neglect of conserved sites. However, considering the large size and more complex functional complexity of prokaryotic and eukaryotic sequences, it is better to apply sitePath in specific gene segments rather than the whole genomes.</p>
  </sec>
  <sec id="Sec10">
    <title>Availability and requirements</title>
    <p id="Par17">Project name: sitePath</p>
    <p id="Par18">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/wuaipinglab/sitePath">https://github.com/wuaipinglab/sitePath</ext-link></p>
    <p id="Par19">Operating systems: Cross-platform</p>
    <p id="Par20">Programming language: R, C++</p>
    <p id="Par21">License: MIT License</p>
    <p id="Par22">Any restrictions to use by non-academics: License needed</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec11">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_5064_MOESM1_ESM.csv">
            <caption>
              <p><bold>Additional file 1</bold>: NCBI Accession for the ZIKA virus dataset.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>CJ designed the work and created the software used in the work and drafted the manuscript. NH and RY collected the raw sequence data. NH and YC analyzed and prepared the data for the software. JS and SW helped interpret the data and result. H-YZ and AW conceptualized and designed the work and revised the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the National Key Research and Development Program [2021YFC230130]; the CAMS Innovation Fund for Medical Sciences [2021-I2M-1-061]; the National Natural Science Foundation of China [92169106]; the special research fund for central universities, Peking Union Medical College [2021-PT180-001]; China postdoctoral science foundation grants [2019M660548, 2020T130007ZX]; the Suzhou Science and Technology Development Plan [szs2020311]; the Youthful Teacher Project of Peking Union Medical College [3332019114]; and the Natural Science Foundation of Jiangsu Province [BK20220278]. No funding body played any roles in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The sequences for ZIKA virus is publicly available at NCBI protein database (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/protein/">https://www.ncbi.nlm.nih.gov/protein/</ext-link>) and the accession numbers can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The dataset used for the performance test is available from Smith et al.âs [<xref ref-type="bibr" rid="CR1">1</xref>] study.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par23">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par24">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par25">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Lapedes</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>de Jong</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Bestebroer</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Rimmelzwaan</surname>
            <given-names>GF</given-names>
          </name>
          <name>
            <surname>Osterhaus</surname>
            <given-names>AD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping the antigenic and genetic evolution of influenza virus</article-title>
        <source>Science</source>
        <year>2004</year>
        <volume>305</volume>
        <issue>5682</issue>
        <fpage>371</fpage>
        <lpage>376</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1097211</pub-id>
        <?supplied-pmid 15218094?>
        <pub-id pub-id-type="pmid">15218094</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>XY</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>ZY</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>XL</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>JY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single mutation in the prM protein of Zika virus contributes to fetal microcephaly</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>358</volume>
        <issue>6365</issue>
        <fpage>933</fpage>
        <lpage>936</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aam7120</pub-id>
        <?supplied-pmid 28971967?>
        <pub-id pub-id-type="pmid">28971967</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Dorp</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Acman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Richard</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Ford</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Ormond</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Emergence of genomic diversity and recurrent mutations in SARS-CoV-2</article-title>
        <source>Infect Genet Evol</source>
        <year>2020</year>
        <volume>83</volume>
        <fpage>104351</fpage>
        <pub-id pub-id-type="doi">10.1016/j.meegid.2020.104351</pub-id>
        <?supplied-pmid 32387564?>
        <pub-id pub-id-type="pmid">32387564</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ragonnet-Cronin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hodcroft</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hue</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fearnhill</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Delpech</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated analysis of phylogenetic clusters</article-title>
        <source>BMC Bioinform</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>317</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>AX</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Scholer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Maurer-Stroh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Russell</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic clustering by linear integer programming (PhyCLIP)</article-title>
        <source>Mol Biol Evol</source>
        <year>2019</year>
        <volume>36</volume>
        <issue>7</issue>
        <fpage>1580</fpage>
        <lpage>1595</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msz053</pub-id>
        <?supplied-pmid 30854550?>
        <pub-id pub-id-type="pmid">30854550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Menardo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Loiseau</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Brites</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Coscolla</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gygli</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Rutaihwa</surname>
            <given-names>LK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Treemmer: a tool to reduce large phylogenetic datasets with minimal loss of diversity</article-title>
        <source>BMC Bioinform</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>164</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2164-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Godzik</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <issue>13</issue>
        <fpage>1658</fpage>
        <lpage>1659</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id>
        <?supplied-pmid 16731699?>
        <pub-id pub-id-type="pmid">16731699</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Guan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>TT-Y</given-names>
          </name>
        </person-group>
        <article-title>ggtree: an r package for visualization and annotation of phylogenetic trees with their covariates and other associated data</article-title>
        <source>Methods Ecol Evol</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>28</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1111/2041-210X.12628</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>YX</given-names>
          </name>
          <name>
            <surname>Shang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detecting potentially adaptive mutations from the parallel and fixed patterns in SARS-CoV-2 evolution</article-title>
        <source>Viruses</source>
        <year>2022</year>
        <volume>14</volume>
        <issue>5</issue>
        <fpage>1087</fpage>
        <pub-id pub-id-type="doi">10.3390/v14051087</pub-id>
        <?supplied-pmid 35632828?>
        <pub-id pub-id-type="pmid">35632828</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>L-T</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Von Haeseler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
        </person-group>
        <article-title>IQ-TREE: a fast and effective stochastic algorithm for estimating maximum-likelihood phylogenies</article-title>
        <source>Mol Biol Evol</source>
        <year>2015</year>
        <volume>32</volume>
        <issue>1</issue>
        <fpage>268</fpage>
        <lpage>274</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msu300</pub-id>
        <?supplied-pmid 25371430?>
        <pub-id pub-id-type="pmid">25371430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Dehal</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>FastTree: computing large minimum evolution trees with profiles instead of a distance matrix</article-title>
        <source>Mol Biol Evol</source>
        <year>2009</year>
        <volume>26</volume>
        <issue>7</issue>
        <fpage>1641</fpage>
        <lpage>1650</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp077</pub-id>
        <?supplied-pmid 19377059?>
        <pub-id pub-id-type="pmid">19377059</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <issue>21</issue>
        <fpage>2688</fpage>
        <lpage>2690</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl446</pub-id>
        <?supplied-pmid 16928733?>
        <pub-id pub-id-type="pmid">16928733</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stecher</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Knyaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tamura</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>MEGA X: molecular evolutionary genetics analysis across computing platforms</article-title>
        <source>Mol Biol Evol</source>
        <year>2018</year>
        <volume>35</volume>
        <issue>6</issue>
        <fpage>1547</fpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msy096</pub-id>
        <?supplied-pmid 29722887?>
        <pub-id pub-id-type="pmid">29722887</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
