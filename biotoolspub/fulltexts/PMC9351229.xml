<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9351229</article-id>
    <article-id pub-id-type="publisher-id">4863</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04863-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>ImputAccur:</italic> fast and user-friendly calculation of genotype-imputation accuracy-measures</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Thormann</surname>
          <given-names>Kolja A.</given-names>
        </name>
        <address>
          <email>koljaalexander.thormann@uni-goettingen.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tozzi</surname>
          <given-names>Viola</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Starke</surname>
          <given-names>Paula</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bickeböller</surname>
          <given-names>Heike</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Baum</surname>
          <given-names>Marcus</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7848-1332</contrib-id>
        <name>
          <surname>Rosenberger</surname>
          <given-names>Albert</given-names>
        </name>
        <address>
          <email>arosenb@gwdg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.7450.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2364 4210</institution-id><institution>Institute of Computer Science, </institution><institution>Georg-August-University Göttingen, </institution></institution-wrap>37077 Göttingen, Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.411984.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 0482 5331</institution-id><institution>Department of Genetic Epidemiology, </institution><institution>University Medical Center Göttingen, </institution></institution-wrap>37079 Göttingen, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>4</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>316</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>7</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1"><italic>ImputAccur</italic> is a software tool to measure genotype-imputation accuracy. Imputation of untyped markers is a standard approach in genome-wide association studies to close the gap between directly genotyped and other known DNA variants. However, high accuracy for imputed genotypes is fundamental. Several accuracy measures have been proposed, but unfortunately, they are implemented on different platforms, which is impractical.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">With <italic>ImputAccur,</italic> the accuracy measures <italic>info, Iam-hiQ</italic> and <italic>r</italic><sup><italic>2</italic></sup><italic>-based</italic> indices can be derived from standard output files of imputation software. Sample/probe and marker filtering is possible. This allows e.g. accurate marker filtering ahead of data analysis.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The source code (Python version 3.9.4), a standalone executive file, and example data for <italic>ImputAccur</italic> are freely available at <ext-link ext-link-type="uri" xlink:href="https://gitlab.gwdg.de/kolja.thormann1/imputationquality.git">https://gitlab.gwdg.de/kolja.thormann1/imputationquality.git</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-04863-z.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Imputation</kwd>
      <kwd>Accuracy</kwd>
      <kwd>GWAS</kwd>
      <kwd>Marker selection</kwd>
      <kwd>SNP</kwd>
      <kwd>Quality control</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Institutes of Health (7U19CA203654-02/ 397 114564-5111078 Integrative Analysis of Lung Cancer Etiology and Risk).</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Georg-August-Universität Göttingen (1018)</institution>
        </funding-source>
      </award-group>
      <open-access>
        <p>Open Access funding enabled and organized by Projekt DEAL.</p>
      </open-access>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par9">Commercial single nucleotide polymorphism (SNP) microarrays are used to genotype DNA samples for genome-wide association studies (GWAS). Usually, between 300,000 and 4 million variants are genotyped. Imputation methods have been developed to close the gap between genotyped and existing DNA variants [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. Most methods estimate a posteriori genotype probabilities <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{g,i,m}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4863_Article_IEq1.gif"/></alternatives></inline-formula> (one of three possible genotypes <italic>g</italic>) for each untyped SNP/variant/marker <italic>m</italic> and each individual <italic>i</italic> in the sample of interest. The resulting increased variant density improves the genomic coverage and may raise the power to detect associations with a trait [<xref ref-type="bibr" rid="CR4">4</xref>]. Quality control of the imputation is essential, e.g. to exclude poorly imputed variants from statistical analysis. Several quality indices have been developed and are routinely applied in studies [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. These comprise <italic>inter alia</italic> MACH’s <italic>r</italic><sup>2</sup>, BEAGLES’s <italic>r</italic><sup>2</sup>, IMPUTE2’s <italic>info</italic> or the recently proposed <italic>Iam hiQ,</italic> including a regional classification across markers [<xref ref-type="bibr" rid="CR6">6</xref>]. Unfortunately, these accuracy measurements are implemented on different platforms. With <italic>ImputAccur,</italic> the comfortable use of all these indices is possible.</p>
    <p id="Par10">Furthermore, <italic>ImputAccur</italic> classifies markers to be located in a “cold”, “tepid”, “hot”, or “very hot” region, the last indicating massively inaccurate imputation, as outlined by Rosenberger et al. [<xref ref-type="bibr" rid="CR6">6</xref>] Details and equations of these accuracy indices and the classification are summarized in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The validity of the calculations was tested by comparison with output files from IMPUTE2 (for info) and with known results of carefully selected sample data (all indices).</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par11"><italic>ImputAccur</italic> requires the user to provide marker information (leading information) along with the estimated a-posteriori genotype probabilities (dosages) as an input file, which is a plain text file (or zipped). These are standard files generated by imputation software. Each row contains information on one marker. The second and third columns should contain [<xref ref-type="bibr" rid="CR2">2</xref>] a unique marker name and [<xref ref-type="bibr" rid="CR3">3</xref>] its physical position (e.g. on the chromosome). Probabilities for the genotypes 0, 1, and 2 of each sample/individual can be contained in 3 (summing to 1) or 2 (amended to 1) columns. Missing or inaccurate imputations are indicated by negative values. Hence, the number (no.) of rows in the input file equals the no. of genomic markers; the no. of columns equals the no. of leading columns + 2/3 times the no. of samples/individuals.</p>
    <p id="Par12">Basic settings for program control (e.g. name and path of the input file) and/or the structure of the input files (e.g. number of leading columns, 2/3 genotype probabilities) can be defined in an additional parameter file (params.txt). There is also the option to specify files containing either markers (matching to marker names) or samples/individuals (numbers matching to column order in the input-file) to be excluded from the calculation. One can also provide names for the leading columns; however, the second and third column will always be named “SNP” and “position”.</p>
    <sec id="Sec3">
      <title>Launching the application</title>
      <p id="Par13">To invoke the Python code of <italic>ImputAccur,</italic> the user may use the following command syntax:<disp-formula id="Equa"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{runfile}}\left( {\text{`}}\left[ {{\text{NAME}}\;{\text{OF}}\;{\text{PROGRAM}}} \right].{\text{py}}{\text{'}},\;{\text{args}} = {\text{`}}{\text{ - f}}\;{\text{params}}.{\text{txt}}{\text{'}} \right).$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mtext>runfile</mml:mtext><mml:mfenced close=")" open="("><mml:mtext>`</mml:mtext><mml:mfenced close="]" open="["><mml:mrow><mml:mtext>NAME</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>OF</mml:mtext><mml:mspace width="0.277778em"/><mml:mtext>PROGRAM</mml:mtext></mml:mrow></mml:mfenced><mml:mo>.</mml:mo><mml:mtext>py</mml:mtext><mml:mtext>'</mml:mtext><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mtext>args</mml:mtext><mml:mo>=</mml:mo><mml:mtext>`</mml:mtext><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>- f</mml:mtext></mml:mrow><mml:mspace width="0.277778em"/><mml:mtext>params</mml:mtext><mml:mo>.</mml:mo><mml:mtext>txt</mml:mtext><mml:mtext>'</mml:mtext></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2022_4863_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par14">Alternatively, one can run <italic>ImputAccur</italic> as an executable file (<italic>ImputAccur.exe</italic>) or without the parameter file (e.g. on a Windows operating system). The program will then ask for the parameters to be entered interactively. For use on Ubuntu, the program can be started via the terminal by navigating to the folder containing the program and parameter file and entering “python [NAME OF PROGRAM].py -f params.txt”. Alternatively, it can be started using only the command “python [NAME OF PROGRAM].py” in the corresponding folder. The program will then ask for the parameters one at a time as well.</p>
    </sec>
    <sec id="Sec4">
      <title>Runtime/performance</title>
      <p id="Par15"><italic>ImputAccur</italic> needed less than 0.8 s per marker to calculate the accuracy indices based on dosages of 10,000 probes/individuals. This was carried out on the High Performance Computing (HPC) clusterof the University of Göttingen/GWDG (<ext-link ext-link-type="uri" xlink:href="https://www.gwdg.de/hpc">https://www.gwdg.de/hpc</ext-link>). The calculation took less than 0.08 s for 1000 probes, less than 0.008 s for 100 probes, and so on.</p>
      <p id="Par16">We assessed the performance of <italic>ImputAccur</italic> on Scientific Linux and on Ubuntu 18.04.6 with Python 3.9.4, 3.7.3, and 3.6.13., as well as on Windows 10 Pro Build 21H2.</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results/example</title>
    <p id="Par17">Assume your input-file (see example <italic>test1</italic> in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>) contains information of 7 SNPs in three leading columns and 3 genotype probabilities each of 5 samples/individuals. Hence, the file has 7 rows and 3 + 3 × 5 = 18 columns. Because the SNPs rs00001, rs00003, and rs00004 are quality control markers, these are listed in the file <italic>exclude_SNP.txt</italic>. Because individuals 1 and 2 are external controls, these are listed in <italic>exclude_PROBE.txt</italic>.</p>
    <p id="Par18">This is the input file (<italic>test1.imputed</italic>):<table-wrap id="Taba"><table frame="hsides" rules="groups"><tbody><tr><td align="left">1 rs00001 913 1 0 0 1 0 0 1 0 0 1 0 0 1 0 0</td></tr><tr><td align="left">2 rs00002 402 0.01 0.99 0 0.01 0.99 0 0.01 0.99 0 0.01 0.99 0 0.01 0.99 0</td></tr><tr><td align="left">3 rs00003 644 0.333 0.334 0.333 0.333 0.334 0.333 0.333 0.334 0.333 0.333 0.334 0.333 0.333 0.334 0.333</td></tr><tr><td align="left">4 rs00004 222 0.25 0.5 0.25 0.25 0.5 0.25 0.25 0.5 0.25 0.25 0.5 0.25 0.25 0.5 0.25</td></tr><tr><td align="left">5 rs00005 221 0.47 0.18 0.35 0.89 0.02 0.09 0.03 0.96 0.01 0.94 0 0.06 0.62 0.34 0.04</td></tr><tr><td align="left">6 rs00006 955 0.975 0.002 0.023 0.52 0.154 0.326 0.309 0.21 0.481 0.48 0.509 0.011 0.969 0.004 0.027</td></tr><tr><td align="left">7 rs00007 518 0.63 0.14 0.23 0.86 0.09 0.05 0.35 0.24 0.41 0.01 0.23 0.76 0.76 0.05 0.19</td></tr></tbody></table></table-wrap></p>
    <p id="Par19">For this, one needs to set the following program parameters in <italic>params.txt</italic> or during the execution:<table-wrap id="Tabb"><table frame="hsides" rules="groups"><tbody><tr><td align="left">-i</td><td align="left">test1.imputed</td><td align="left">[path to and name of input-file]</td></tr><tr><td align="left">-l</td><td align="left">3</td><td align="left">[number of leading columns]</td></tr><tr><td align="left">-c</td><td align="left">0</td><td align="left">[third genotype probability needs to be calculated—TRUE (1) or FALSE (0)]</td></tr><tr><td align="left">-p</td><td align="left">excluded_PROBE.txt</td><td align="left">[path to and name of sample exclusion file]</td></tr><tr><td align="left">-m</td><td align="left">excluded_SNP.txt</td><td align="left">[path to and name of SNP exclusion file]</td></tr><tr><td align="left">-n</td><td align="left">SNP_no,SSSS,PPPPPP</td><td align="left">[names for leading columns]</td></tr></tbody></table></table-wrap></p>
    <p id="Par20">This is the output (<italic>test1.accuracy</italic>):<table-wrap id="Tabc"><table frame="hsides" rules="groups"><thead><tr><th align="left">SNP_no</th><th align="left">SNP</th><th align="left">Position</th><th align="left">N</th><th align="left">MAF (%)</th><th align="left">Iam<sub>chance</sub></th><th align="left">Iam<sub>HWE</sub></th><th align="left">hiQ</th><th align="left">Accuracy</th><th align="left">Info</th><th align="left"><inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{r}}_{{{\text{MACH}}}}^{2}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mtext>r</mml:mtext><mml:mrow><mml:mtext>MACH</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4863_Article_IEq2.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{r}}_{{{\text{Beagle}}}}^{2}$$\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mtext>r</mml:mtext><mml:mrow><mml:mtext>Beagle</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4863_Article_IEq3.gif"/></alternatives></inline-formula></th></tr></thead><tbody><tr><td align="left">5</td><td align="left">rs00005</td><td char="." align="char">221</td><td char="." align="char">5</td><td char="." align="char">26.0</td><td char="." align="char">0.546</td><td char="." align="char">0.448</td><td char="." align="char">0.739</td><td align="left">HOT</td><td char="." align="char">0.099</td><td char="." align="char">0.319</td><td align="left">0.113</td></tr><tr><td align="left">2</td><td align="left">rs00002</td><td char="." align="char">402</td><td char="." align="char">5</td><td char="." align="char">49.5</td><td char="." align="char">0.97</td><td char="." align="char">0.968</td><td char="." align="char">0.929</td><td align="left">TEPID</td><td char="." align="char">0.98</td><td char="." align="char">0.0</td><td align="left"> − 9</td></tr><tr><td align="left">7</td><td align="left">rs00007</td><td char="." align="char">518</td><td char="." align="char">5</td><td char="." align="char">40.3</td><td char="." align="char">0.344</td><td char="." align="char">0.289</td><td char="." align="char">0.72</td><td align="left">HOT</td><td char="." align="char"> − 0.057</td><td char="." align="char">0.631</td><td align="left">0.294</td></tr><tr><td align="left">6</td><td align="left">rs00006</td><td char="." align="char">955</td><td char="." align="char">5</td><td char="." align="char">26.1</td><td char="." align="char">0.446</td><td char="." align="char">0.326</td><td char="." align="char">0.963</td><td align="left">HOT</td><td char="." align="char"> − 0.056</td><td char="." align="char">0.488</td><td align="left">0.179</td></tr></tbody></table></table-wrap></p>
    <sec id="Sec6">
      <title>Output interpretation (for marker rs00005)</title>
      <p id="Par21">A-posteriori genotype probabilities of N = 5 individuals were contained in the input file for SNP rs00005 (fifth in the input file) at position 221 on the considered chromosome. A frequency (MAF) of 26% for the minor allele can be derived from these dosages. According to the accuracy indices <italic>Iam</italic><sub><italic>chance</italic></sub> (0.546) and <italic>Iam</italic><sub><italic>HWE</italic></sub> (0.448) it is reasonable to assume that about half of the information contained in dosages comes from the true (but unknown) genotypes of the individuals in the sample, the other half comes from the population used as a reference for genotype imputation. The values are borderline near the recommended threshold of 0.47 [<xref ref-type="bibr" rid="CR6">6</xref>]. The difference between <italic>Iam</italic><sub><italic>chance</italic></sub> and <italic>Iam</italic><sub><italic>HWE</italic></sub> is the “anchor point” used, which is either purely populations-related dosages (Hardy–Weinberg Equilibrium HWE, taking MAF into account) or pure chance (1/3 probability for each of the three possible genotypes of a SNP). <italic>Iam</italic><sub><italic>chance</italic></sub> and <italic>Iam</italic><sub><italic>HWE</italic></sub><italic> usually have comparable</italic> values [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
      <p id="Par22">A value of 0.099 for info indicates that only 10% of the statistical information on the minor population allele frequency (MAF), given “known” genotypes, remained after the genotypes had been imputed for rs00005 [<xref ref-type="bibr" rid="CR3">3</xref>]. For the measure <italic>info,</italic> threshold values such as 0.8 or 0.3 have been proposed, but without sound justification [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>].</p>
      <p id="Par23"><italic>A</italic> value of 0.739 for hiQ indicates insufficient <italic>heterogeneity of dosages across all</italic> samples/individuals, as it is lower than the recommended threshold of 0.97 [<xref ref-type="bibr" rid="CR6">6</xref>]. The imputation seems to have resulted in dosages too similar to be used for statistical inference testing.</p>
      <p id="Par24">Since <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{r}}_{{{\text{MACH}}}}^{2}$$\end{document}</tex-math><mml:math id="M10"><mml:msubsup><mml:mtext>r</mml:mtext><mml:mrow><mml:mtext>MACH</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4863_Article_IEq4.gif"/></alternatives></inline-formula> has a value of 0.319, one can conclude that the power of an allelic test, in the case of a binary trait, based on the imputed genotypes of rs00005 is approximately <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sqrt {0.319} = 0.56$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msqrt><mml:mrow><mml:mn>0.319</mml:mn></mml:mrow></mml:msqrt><mml:mo>=</mml:mo><mml:mn>0.56</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4863_Article_IEq5.gif"/></alternatives></inline-formula> times that of the same test if all genotypes were present. The same applies for <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{r}}_{{{\text{Beagle}}}}^{2}$$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mtext>r</mml:mtext><mml:mrow><mml:mtext>Beagle</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4863_Article_IEq6.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
      <p id="Par25">Overall, all indices identify rs00005 as a marker with poor imputation. The “accuracy” is rated as “hot”, indicating that rs00005 is also located in a genomic region enriched with markers of poor imputation.</p>
      <p id="Par26">In addition, Fig. <xref rid="Fig1" ref-type="fig">1</xref> illustrates the regional accuracy of all indices, including the classification from “cold” to “very hot”. The telomere region of 0 to 17.5 kb of chromosome 9 is plotted. One can easily see that the imputation is not accurate near the ends of each sister chromatid. One can also see the differences between the accuracy indices, especially for rare markers (low MAF—small dots), and realize how critical the choice of appropriate thresholds can be (including the classification implemented in <italic>ImputAccur</italic>). The example data used are described elsewhere [<xref ref-type="bibr" rid="CR6">6</xref>].<fig id="Fig1"><label>Fig. 1</label><caption><p>Example of real-data genotype-imputation accuracy-measures for the telomere region on chromosome 9. Top left: hiQ, top right: info, centre left: Iam<sub>chance</sub>, centre right: Iam<sub>HWE</sub>, bottom left: <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{r}}_{{{\text{Beagle}}}}^{2}$$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mtext>r</mml:mtext><mml:mrow><mml:mtext>Beagle</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4863_Article_IEq7.gif"/></alternatives></inline-formula>, bottom right: <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{r}}_{{{\text{MACH}}}}^{2}$$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mtext>r</mml:mtext><mml:mrow><mml:mtext>MACH</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4863_Article_IEq8.gif"/></alternatives></inline-formula>; each dot represents one imputed marker; the marker size is according to minor allele frequency (MAF); threshold values are freely selectable; vertical lines: centre of region classified as: “cold”, “tepid”, “hot”, or “very hot” (the definition is given in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p></caption><graphic xlink:href="12859_2022_4863_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Conclusion</title>
    <p id="Par27"><italic>ImputAccur</italic> is an easy-to-use software to determine multiple measures of accuracy for imputed genotypes and independent on the imputation platform used. This allows greater flexibility in post-imputation variant filtering. Because it also delivers regional classification, poorly imputed chromosome segments may be identified.</p>
  </sec>
  <sec id="Sec8">
    <title>Availability and requirements</title>
    <p id="Par28">
      <list list-type="bullet">
        <list-item>
          <p id="Par29">Project name: <italic>ImputAccur</italic></p>
        </list-item>
        <list-item>
          <p id="Par30">Project home page: <ext-link ext-link-type="uri" xlink:href="https://gitlab.gwdg.de/kolja.thormann1/imputationquality.git">https://gitlab.gwdg.de/kolja.thormann1/imputationquality.git</ext-link></p>
        </list-item>
        <list-item>
          <p id="Par31">Operating system(s): Platform independent</p>
        </list-item>
        <list-item>
          <p id="Par32">Programming language: Python version 3.9.4</p>
        </list-item>
        <list-item>
          <p id="Par33">Other requirements: none</p>
        </list-item>
        <list-item>
          <p id="Par34">License: The GitHub Terms of Service/2-Clause BSD License</p>
        </list-item>
        <list-item>
          <p id="Par35">Any restrictions to use by non-academics: none</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec9">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_4863_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Equations for calculating the accuracy measures and the scheme for classifying genomic regions.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>GWAS</term>
        <def>
          <p id="Par4">Genome-wide association studies</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par5">Single nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>MAF</term>
        <def>
          <p id="Par6">Minor allele frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>Dosages</term>
        <def>
          <p id="Par7">Estimated a-posteriori genotype probabilities</p>
        </def>
      </def-item>
      <def-item>
        <term>HWE</term>
        <def>
          <p id="Par8">Hardy–Weinberg equilibrium</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Idea and formulation of research goal: TV and RA; Implementation and testing of the computer code: TK, TV, SP and RA; Writing—Review and Editing: TK, TV, SP, RA, BH and BM; Funding acquisition: BH. All authors made significant contributions to the project, and read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Open Access funding enabled and organized by Projekt DEAL. This work was partially supported by the National Institutes of Health (7U19CA203654-02/ 397 114564-5111078 Integrative Analysis of Lung Cancer Etiology and Risk). The funding body played no role in the software design, data collection and analysis, interpretation of the results, or writing of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The source code (Python version 3.9.4), a standalone executive file, and a user manual of <italic>ImputAccur</italic> are freely available at <ext-link ext-link-type="uri" xlink:href="https://gitlab.gwdg.de/kolja.thormann1/imputationquality.git">https://gitlab.gwdg.de/kolja.thormann1/imputationquality.git</ext-link>. Example data are available in the same repository. The example data presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref> are available from ILCCO/INTEGRAL but restrictions apply to the availability of these data, which were used under license for the current study, and so are not publicly available. Data are however available from the authors upon reasonable request and with permission of ILCCO/INTEGRAL.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par36">The example data presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref> are from the International Lung Cancer Consortium (ILCCO)/Integrative Analysis of Lung Cancer Etiology and Risk (INTEGRAL)). All consortium research received approval from the Dartmouth Committee for Protection of Human Subjects on 7/30/2014 with id STUDY00023602. Informed consent was obtained from all participants or, if participants are under 18, from a parent and/or legal guardian. All experimental protocols and other methods used comply with institutional, national, or international guidelines.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par37">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par38">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hickey</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Cleveland</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Maltecca</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gorjanc</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gredler</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kranis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Genotype imputation to increase sample size in pedigreed populations</article-title>
        <source>Methods Mol Biol</source>
        <year>2013</year>
        <volume>1019</volume>
        <fpage>395</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-62703-447-0_17</pub-id>
        <pub-id pub-id-type="pmid">23756901</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Das</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>BL</given-names>
          </name>
        </person-group>
        <article-title>Genotype imputation from large reference panels</article-title>
        <source>Annu Rev Genom Hum Genet</source>
        <year>2018</year>
        <volume>31</volume>
        <issue>19</issue>
        <fpage>73</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-genom-083117-021602</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marchini</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Howie</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Genotype imputation for genome-wide association studies</article-title>
        <source>Nat Rev Genet</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>7</issue>
        <fpage>499</fpage>
        <lpage>511</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2796</pub-id>
        <pub-id pub-id-type="pmid">20517342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Winkler</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Day</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Croteau-Chonka</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Wood</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Locke</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Magi</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Quality control and conduct of genome-wide association meta-analyses</article-title>
        <source>Nat Protoc</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>5</issue>
        <fpage>1192</fpage>
        <lpage>1212</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2014.071</pub-id>
        <pub-id pub-id-type="pmid">24762786</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A unified approach to genotype imputation and haplotype-phase inference for large data sets of trios and unrelated individuals</article-title>
        <source>Am J Hum Genet</source>
        <year>2009</year>
        <volume>84</volume>
        <issue>2</issue>
        <fpage>210</fpage>
        <lpage>223</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2009.01.005</pub-id>
        <pub-id pub-id-type="pmid">19200528</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenberger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tozzi</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bickeböller</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hung</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Christiani</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Caporaso</surname>
            <given-names>NE</given-names>
          </name>
        </person-group>
        <article-title>Iam hiQ—a novel pair of accuracy indices for imputed genotypes</article-title>
        <source>BMC Bioinform</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>50</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-022-04568-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mitt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kals</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Parn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Palotie</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Improved imputation accuracy of rare and low-frequency variants using population-specific high-coverage WGS-based imputation reference panel</article-title>
        <source>Eur J Hum Genet</source>
        <year>2017</year>
        <volume>25</volume>
        <issue>7</issue>
        <fpage>869</fpage>
        <lpage>876</lpage>
        <pub-id pub-id-type="doi">10.1038/ejhg.2017.51</pub-id>
        <pub-id pub-id-type="pmid">28401899</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krithika</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Valladares-Salgado</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Peralta</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Escobedo-de LaPena</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kumate-Rodriguez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cruz</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of the imputation performance of the program IMPUTE in an admixed sample from Mexico City using several model designs</article-title>
        <source>BMC Med Genom</source>
        <year>2012</year>
        <volume>5</volume>
        <fpage>12</fpage>
        <pub-id pub-id-type="doi">10.1186/1755-8794-5-12</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
