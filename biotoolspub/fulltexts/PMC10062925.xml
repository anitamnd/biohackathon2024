<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1010946.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10062925</article-id>
    <article-id pub-id-type="pmid">36940213</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-22-01380</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010946</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Cell biology</subject>
          <subj-group>
            <subject>Chromosome biology</subject>
            <subj-group>
              <subject>Chromatin</subject>
              <subj-group>
                <subject>Chromatin modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Epigenetics</subject>
            <subj-group>
              <subject>Chromatin</subject>
              <subj-group>
                <subject>Chromatin modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>Chromatin</subject>
              <subj-group>
                <subject>Chromatin modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>DNA</subject>
            <subj-group>
              <subject>DNA modification</subject>
              <subj-group>
                <subject>DNA methylation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>DNA</subject>
              <subj-group>
                <subject>DNA modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Epigenetics</subject>
            <subj-group>
              <subject>DNA modification</subject>
              <subj-group>
                <subject>DNA methylation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>DNA modification</subject>
              <subj-group>
                <subject>DNA methylation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Chemistry</subject>
          <subj-group>
            <subject>Chemical Reactions</subject>
            <subj-group>
              <subject>Methylation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Basic Cancer Research</subject>
            <subj-group>
              <subject>Cancer Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genomic Medicine</subject>
              <subj-group>
                <subject>Cancer Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Epigenetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Thermodynamics</subject>
            <subj-group>
              <subject>Entropy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Metheor: Ultrafast DNA methylation heterogeneity calculation from bisulfite read alignments</article-title>
      <alt-title alt-title-type="running-head">Ultrafast DNA methylation heterogeneity calculation from bisulfite read alignments</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2163-5489</contrib-id>
        <name>
          <surname>Lee</surname>
          <given-names>Dohoon</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4357-1850</contrib-id>
        <name>
          <surname>Koo</surname>
          <given-names>Bonil</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Jeewon</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5385-9546</contrib-id>
        <name>
          <surname>Kim</surname>
          <given-names>Sun</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
        <xref rid="currentaff001" ref-type="author-notes">
          <sup>¤</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Bioinformatics Institute, Seoul National University, Seoul, Republic of Korea</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>BK21 FOUR Intelligence Computing, Seoul National University, Seoul, Republic of Korea</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Interdisciplinary Program in Bioinformatics, Seoul National University, Seoul, Republic of Korea</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Interdisciplinary Program in Artificial Intelligence, Seoul National University, Seoul, Republic of Korea</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Department of Computer Science and Engineering, Seoul National University, Seoul, Republic of Korea</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>MOGAM Institute for Biomedical Research, Yong-in, Republic of Korea</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>., CANADA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="current-aff" id="currentaff001">
        <p>¤ Current address: Department of Computer Science and Engineering, Seoul National University, Seoul, Republic of Korea</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>sunkim.bioinfo@snu.ac.kr</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <volume>19</volume>
    <issue>3</issue>
    <elocation-id>e1010946</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>2</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 Lee et al</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Lee et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1010946.pdf"/>
    <abstract>
      <p>Phased DNA methylation states within bisulfite sequencing reads are valuable source of information that can be used to estimate epigenetic diversity across cells as well as epigenomic instability in individual cells. Various measures capturing the heterogeneity of DNA methylation states have been proposed for a decade. However, in routine analyses on DNA methylation, this heterogeneity is often ignored by computing average methylation levels at CpG sites, even though such information exists in bisulfite sequencing data in the form of phased methylation states, or methylation patterns. In this study, to facilitate the application of the DNA methylation heterogeneity measures in downstream epigenomic analyses, we present a Rust-based, extremely fast and lightweight bioinformatics toolkit called Metheor. As the analysis of DNA methylation heterogeneity requires the examination of pairs or groups of CpGs throughout the genome, existing softwares suffer from high computational burden, which almost make a large-scale DNA methylation heterogeneity studies intractable for researchers with limited resources. In this study, we benchmark the performance of Metheor against existing code implementations for DNA methylation heterogeneity measures in three different scenarios of simulated bisulfite sequencing datasets. Metheor was shown to dramatically reduce the execution time up to 300-fold and memory footprint up to 60-fold, while producing identical results with the original implementation, thereby facilitating a large-scale study of DNA methylation heterogeneity profiles. To demonstrate the utility of the low computational burden of Metheor, we show that the methylation heterogeneity profiles of 928 cancer cell lines can be computed with standard computing resources. With those profiles, we reveal the association between DNA methylation heterogeneity and various omics features. Source code for Metheor is at <ext-link xlink:href="https://github.com/dohlee/metheor" ext-link-type="uri">https://github.com/dohlee/metheor</ext-link> and is freely available under the GPL-3.0 license.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>DNA methylation is the most extensively studied epigenetic modifications that plays a pivotal role in key biological processes. The advance of next-generation sequencing technology combined with bisulfite treatment of DNA, namely bisulfite sequencing, allowed fine-grained characterization of DNA methylation states at basepair-resolution, and it facilitated researchers elucidate the significance of DNA methylation at various genomic contexts. To date, most of the routine DNA methylation analyses only deal with per-CpG methylation levels. That is, they compute the proportion of CpGs in methylated state for each CpG throughout the genome. However, bisulfite sequencing data harbor information beyond individual CpG methylation states: methylation states co-occurring in a single sequencing read. This information is important because such ‘phased’ methylation states can inform us about the epigenetic diversity of cell populations as well as the local regulation states of the epigenome. We collectively refer to those information as DNA methylation heterogeneity. In this study, we present a Rust-based software named Metheor for ultrafast and accurate calculation of DNA methylation heterogeneity from bisulfite sequencing data. We show that Metheor reduces execution time and memory footprint up to 300-fold and 60-fold, respectively, compared to existing implementations, and analyze DNA methylation heterogeneity profiles of 928 cancer cell lines.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>National Research Foundation (KR)</institution>
        </funding-source>
        <award-id>NRF-2019M3E5D307337511</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5385-9546</contrib-id>
          <name>
            <surname>Kim</surname>
            <given-names>Sun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>National Research Foundation (KR)</institution>
        </funding-source>
        <award-id>NRF-2022M3E5F3085677</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5385-9546</contrib-id>
          <name>
            <surname>Kim</surname>
            <given-names>Sun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP)</institution>
        </funding-source>
        <award-id>NO.2021-0-01343</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5385-9546</contrib-id>
          <name>
            <surname>Kim</surname>
            <given-names>Sun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This research was supported by the Bio &amp; Medical Technology Development Program of the National Research Foundation (NRF) funded by the Ministry of Science &amp; ICT(NRF-2019M3E5D307337511 and NRF-2022M3E5F3085677) (to S.K.) and Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) [NO.2021-0-01343, Artificial Intelligence Graduate School Program (Seoul National University)] (to S.K.). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="1"/>
      <page-count count="14"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2023-03-30</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Metheor is freely available for any users under the GPL-3.0 license. The source code can be anonymously downloaded at the GitHub repository (<ext-link xlink:href="https://github.com/dohlee/metheor" ext-link-type="uri">https://github.com/dohlee/metheor</ext-link>), and the executable is distributed through conda package manager to facilitate the public use of the software (<ext-link xlink:href="https://anaconda.org/dohlee/metheor" ext-link-type="uri">https://anaconda.org/dohlee/metheor</ext-link>). We also provide the codes for the simulation of WGBS reads at the dedicated GitHub repository (<ext-link xlink:href="https://github.com/jwyang21/simulate_WGBS" ext-link-type="uri">https://github.com/jwyang21/simulate_WGBS</ext-link>). Finally, to facilitate such future studies on the DNA methylation heterogeneity in cancers, we made the DNA methylation heterogeneity profiles of 928 CCLE cell lines computed by Metheor publicly available through Figshare (<ext-link xlink:href="https://doi.org/10.6084/m9.figshare.21100717.v1" ext-link-type="uri">https://doi.org/10.6084/m9.figshare.21100717.v1</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Metheor is freely available for any users under the GPL-3.0 license. The source code can be anonymously downloaded at the GitHub repository (<ext-link xlink:href="https://github.com/dohlee/metheor" ext-link-type="uri">https://github.com/dohlee/metheor</ext-link>), and the executable is distributed through conda package manager to facilitate the public use of the software (<ext-link xlink:href="https://anaconda.org/dohlee/metheor" ext-link-type="uri">https://anaconda.org/dohlee/metheor</ext-link>). We also provide the codes for the simulation of WGBS reads at the dedicated GitHub repository (<ext-link xlink:href="https://github.com/jwyang21/simulate_WGBS" ext-link-type="uri">https://github.com/jwyang21/simulate_WGBS</ext-link>). Finally, to facilitate such future studies on the DNA methylation heterogeneity in cancers, we made the DNA methylation heterogeneity profiles of 928 CCLE cell lines computed by Metheor publicly available through Figshare (<ext-link xlink:href="https://doi.org/10.6084/m9.figshare.21100717.v1" ext-link-type="uri">https://doi.org/10.6084/m9.figshare.21100717.v1</ext-link>).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Unlike genomes, changes in epigenomes are dynamic and reversible. This plasticity has been increasingly highlighted over a recent decade, since the spatiotemporal dynamics of epigenetic modification are shown to form the basis of diverse cellular processes such as cell differentiation and senescence. The variability of epigenomes is the key mechanism that cells acquire diverse and precise functions throughout the whole body of an individual to sustain the life of an organism. Furthermore, the dysregulation of the epigenetic variability has shown great biological implication for various cancer types, as it increases the adaptive potential of a cancer cell population against treatments [<xref rid="pcbi.1010946.ref001" ref-type="bibr">1</xref>].</p>
    <p>Among the diverse manifestations of epigenetic variabilities, cell-to-cell variability of DNA methylation states is one of the most actively investigated research topics. To measure the diversity of bulk cell population in terms of DNA methylation, it is necessary to identify the epigenetic configurations of individual cells. Single-cell bisulfite sequencing can directly resolve this challenge, but its cost makes it hardly applicable to a large-scale study. An effective alternative is to extract DNA methylation states co-occurring in a single sequencing read, and consider each pattern as a pseudo-barcode that identifies each cell. By measuring the diversity of DNA methylation patterns aligned at each genomic region, we can obtain a partial estimate of the true epigenetic diversity across cell population.</p>
    <p>Despite many proof-of-concept experiments underscoring the utility of those DNA methylation heterogeneity measures in physiopathological conditions, a highly efficient toolkit for quantifying the extent of the heterogeneity is still lacking. To facilitate a large-scale functional study of DNA methylation heterogeneity based on bisulfite sequencing data, we developed a fast and lightweight software called <italic toggle="yes">Metheor</italic>. In this study, we present the functionality of Metheor and benchmark its performance against existing code implementations for DNA methylation heterogeneity measures. Also, to demonstrate the utility of Metheor in large-scale studies, we provide DNA methylation heterogeneity analyses of 928 cancer cell lines from Cancer Cell Line Encyclopedia (CCLE), which reveal novel association between the extent of epigenetic heterogeneity and other omics features. We believe this software will serve as a convenient toolkit helping researchers fully utilize the phasing information of DNA methylation states that have not been investigated actively so far.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Design and implementation</title>
    <sec id="sec003">
      <title>Functionality and implementation</title>
      <p>Given a bisulfite read alignment file, Metheor can efficiently compute all of the six DNA methylation heterogeneity measures proposed to date [<xref rid="pcbi.1010946.ref002" ref-type="bibr">2</xref>–<xref rid="pcbi.1010946.ref006" ref-type="bibr">6</xref>] (<xref rid="pcbi.1010946.g001" ref-type="fig">Fig 1A and 1B</xref> and <xref rid="pcbi.1010946.s002" ref-type="supplementary-material">S1</xref>–<xref rid="pcbi.1010946.s005" ref-type="supplementary-material">S4</xref> Figs). In short, epipolymorphism and methylation entropy quantify the diversity of DNA methylation patterns, or epialleles, in a given cell population. Fraction of discordant read pairs (FDRP) and quantitative FDRP (qFDRP) measure the epiallelic diversity at CpG resolution. On the other hand, proportion of discordant reads (PDR) measures the extent of local homogeneity of DNA methylation through computing the proportion of bisulfite sequencing reads having two different DNA methylation states at the same time. Methylation haplotype load (MHL) similarly captures the local homogeneity of DNA methylation status by quantifying how well a methylation haplotype (i.e., a stretch of consecutively methylated CpGs) is conserved throughout the cell population. For the detailed description for each of the measures and the algorithms to compute them, please refer to the <xref rid="pcbi.1010946.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
      <fig position="float" id="pcbi.1010946.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010946.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overview of Metheor.</title>
          <p>(A) The input for Metheor is bisulfite read alignment tagged with Bismark methylation call strings. Using each of the seven subcommands shown, Metheor computes the corresponding DNA methylation heterogeneity measure. If reads were aligned with a tool other than Bismark, Metheor can still add tag for methylation call string with <monospace>metheor tag</monospace> subcommand to make alignment file compatible for Metheor run. (B) Schematic diagram for DNA methylation heterogeneity measures and benchmark settings in this study. [<xref rid="pcbi.1010946.ref005" ref-type="bibr">5</xref>] denote the Perl script provided by the authors along with the article proposing the utility of MHL. (C, D) Schematic diagram illustrating (C) read-centric algorithm and (D) CpG-centric algorithm for the computation of DNA methylation heterogeneity. The advantages (plus symbol) and disadvantages (minus symbol) are shown below the diagrams. (E) Distribution of the average number of CpGs per sequencing read for the RRBS data from 928 CCLE cell lines. (F) Genomewide average levels of proportion of discordant reads (PDR) and local pairwise methylation discordance (LPMD) against varying read lengths. (G) Schematic illustration for the definition of local pairwise methylation discordance (LPMD) and examples. The proportion of reads having different DNA methylation states for a pair of CpGs (red arrows) are computed.</p>
        </caption>
        <graphic xlink:href="pcbi.1010946.g001" position="float"/>
      </fig>
      <p>The main algorithmic advantage of Metheor is that it is a “one-sweep” algorithm that iterates through the entire sequencing reads only once (<xref rid="pcbi.1010946.g001" ref-type="fig">Fig 1C</xref>). On the other hand, a benchmark counterpart R package, WSHPackage [<xref rid="pcbi.1010946.ref006" ref-type="bibr">6</xref>], iterates through a set of CpGs specified by a user and fetches the reads covering each CpG using indexed alignment file (<xref rid="pcbi.1010946.g001" ref-type="fig">Fig 1D</xref>). As the most time-consuming operation in this setting is fetching sequencing reads from alignments, we can estimate the time complexity of the methods using the total number of sequencing read accesses. For Metheor, the estimation is trivial; it requires <italic toggle="yes">n</italic> sequencing read accesses in total, where <italic toggle="yes">n</italic> is the number of aligned reads. For WSHPackage, the number of sequencing read accesses is λ × <italic toggle="yes">n</italic>, where λ is the average number of CpGs within a single sequencing read. Therefore, the performance advantage of Metheor compared to WSH will be determined by the coefficient λ. Importantly, the empirical distribution of CpGs throughout the genome is uneven and known to form CpG-dense regions including CpG-islands. Reduced representation bisulfite sequencing (RRBS) predominantly targets those CpG-dense regions, so the coefficient λ for RRBS experiment is generally greater than 1 (<xref rid="pcbi.1010946.g001" ref-type="fig">Fig 1E</xref>). This is why the read-centric algorithm used in Metheor empirically runs faster than CpG-centric ones.</p>
      <p>Note that when a user wants to compute DNA methylation heterogeneity levels for only a subset of CpGs rather than the whole set of CpGs, it may be disadvantageous for Metheor since it iterates all the aligned reads while CpG-centric approaches uses alignment index to access only to CpGs specified by users. However, we observed that Metheor still ran faster than WSHPackage for PDR, FDRP and qFDRP calculation even when only a subset of CpGs are considered (3∼4-fold speedups when 5% of CpGs are considered; <xref rid="pcbi.1010946.s006" ref-type="supplementary-material">S5 Fig</xref>), underscoring the efficiency of the implementation of Metheor.</p>
      <p>Metheor also supports alignments generated not only by Bismark, but also other widely used methylation-aware aligners, by providing a subcommand to attach a tag denoting the methylation states of cytosines to each aligned read (<xref rid="pcbi.1010946.g001" ref-type="fig">Fig 1A</xref>). This warrants the wide applicability of Metheor at the downstream of various bisulfite read processing pipelines. Metheor is implemented in Rust language and distributed via the conda package manager.</p>
    </sec>
    <sec id="sec004">
      <title>Definition of local pairwise methylation discordance (LPMD)</title>
      <p>To ameliorate the read length bias of PDR, we propose a new measure called local pairwise methylation discordance (LPMD) in this study (<xref rid="pcbi.1010946.g001" ref-type="fig">Fig 1G</xref>). LPMD considers the discrepancy of methylation states between a pair of CpGs placed at a fixed distance from each other instead of the read-wise classification of DNA methylation discordance in PDR. As in the computation of PDR, the concordance of DNA methylation states are only examined for pairs of CpG methylation states that are present on the same sequencing read. Therefore, LPMD allows a consistent comparison between any sequencing experiments regardless of read length, as long as the same range of CpG pair distance is considered. Throughout this study, we computed the LPMD values using CpG pairs that are 2bp to 16bp away from each other regarding the length of CCLE RRBS reads (29nt). We note that the trend of LPMD values are robust to the choice of the genomic distance window between CpG pairs (<xref rid="pcbi.1010946.s007" ref-type="supplementary-material">S6 Fig</xref>), so in general 2∼16bp window is a reasonable choice.</p>
    </sec>
    <sec id="sec005">
      <title>Simulation of sequencing data with different read lengths</title>
      <p>In the computation of PDR, a read is classified as discordant if it contains at least one CpG pair with different methylation states. Therefore, it is conceivable that the levels of PDR will increase as the length of sequencing read gets longer because the mere chance of observing a discordant CpG pair increases as more CpGs are considered. This is not desirable since it hampers the comparison of the metric between the sequencing experiments of different read lengths, which is often unavoidable for large-scale collaborative studies or meta-analyses. To examine the read length bias of PDR and LPMD, we simulated sequencing data with different read lengths by manipulating publicly available RRBS data from Ewing sarcoma tumor sample. The raw 50bp-sequencing reads were downloaded under SRA run accession SRR5222549, and aligned to hg38 reference genome using Bismark v0.23.1. For each aligned read, the methylation call string generated by Bismark was trimmed from 3’-end to mimic reads of shorter length. Read alignment files with 25bp, 30bp, 35bp, 45bp and 50bp reads were separately generated and genomewide average PDR values were computed. As expected, we observed the clear read length bias for PDR, scaling linearly to increasing read lengths (<xref rid="pcbi.1010946.g001" ref-type="fig">Fig 1F</xref>).</p>
    </sec>
    <sec id="sec006">
      <title>Performance benchmark</title>
      <p>We compared the performance of our method with existing methods (methclone [<xref rid="pcbi.1010946.ref007" ref-type="bibr">7</xref>], WSHPackage [<xref rid="pcbi.1010946.ref006" ref-type="bibr">6</xref>] and perl scripts from [<xref rid="pcbi.1010946.ref005" ref-type="bibr">5</xref>]) for the six existing measures. Three different types of simulated sequencing datasets with varying numbers of reads were used (<xref rid="pcbi.1010946.s001" ref-type="supplementary-material">S1 Text</xref>). In brief, we generated two RRBS datasets (by simulation and real-world data subsampling) and pseudo-whole genome bisulfite sequencing experiments reproducing the methylation erosion scenario as proposed in [<xref rid="pcbi.1010946.ref006" ref-type="bibr">6</xref>]. All the benchmark experiments were done on a server with Intel(R) Xeon(R) E7–4850 2.10 GHz CPU and 512GB of RAM.</p>
    </sec>
    <sec id="sec007">
      <title>Demonstration of the validity of results</title>
      <p>To verify that Metheor produces methylation heterogeneity levels accurately, we compared CpG-wise and CpG quartet-wise methylation heterogeneity levels produced by Metheor to those produced by reference implementations. For experiment, we used the results from simulated RRBS data with 20M reads. Note that PDR, MHL, FDRP and qFDRP levels were computed for each individual CpG, and PM and ME were computed for each CpG quartet.</p>
    </sec>
    <sec id="sec008">
      <title>Computation of DNA methylation heterogeneity profiles of CCLE cell lines</title>
      <p>We downloaded raw RRBS sequencing reads for 928 CCLE cell lines under SRA study accession SRP186687. RRBS reads were preprocessed using Trim Galore! v0.6.7 with <monospace>--rrbs</monospace> option and aligned to hg38 reference genome using Bismark v0.23.1. Given the read alignments, genomewide and region-specific DNA methylation heterogeneity profiles were obtained using Metheor v0.1.2 with default parameters. Of note, genomic contexts of interest included CpG islands, CpG shores, CpG shelves, DNA methylation canyons, long and short interspersed nuclear elements (LINEs and SINEs, respectively), long terminal repeats (LTRs), exons, introns, gene bodies and promoters of protein coding genes. Annotations for CpG islands and transposable elements are downloaded from UCSC table browser. CpG shores were defined as 2kbp regions flanking CpG islands on their both side, but regions overlapping with any CpG islands were excluded. Similarly, CpG shelves were defined as 2kbp regions flanking the stretches of CpG islands and shores. GENCODE v38 gene annotations were used to define exons, introns, gene bodies and promoters, where promoters were defined as 2kbp regions centered at TSS for each protein coding gene. Annotations for DNA methylation canyons were downloaded from the supplementary material of [<xref rid="pcbi.1010946.ref008" ref-type="bibr">8</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec009">
    <title>Results</title>
    <sec id="sec010">
      <title>Execution time and memory usage benchmarks</title>
      <p>We observed significant speedups (up to 300-fold depending on measure and data size) for the computation of all DNA methylation heterogeneity measures (<xref rid="pcbi.1010946.g002" ref-type="fig">Fig 2A and 2B</xref> and <xref rid="pcbi.1010946.s008" ref-type="supplementary-material">S7 Fig</xref>). It is worth noting that the total running time of Metheor and WSHPackage were both linearly proportional to the number of sequencing reads in the input data. Especially, we could achieve extreme speedup for FDRP and qFDRP calculation using reservoir sampling-based approach (<xref rid="pcbi.1010946.s001" ref-type="supplementary-material">S1 Text</xref>). Since the utility of FDRP and qFDRP has been limited by the slow computation [<xref rid="pcbi.1010946.ref006" ref-type="bibr">6</xref>], we expect that Metheor will facilitate the use of those measures in further experimental setups. We also observed significant reduction in memory footprints (<xref rid="pcbi.1010946.g002" ref-type="fig">Fig 2C and 2D</xref> and <xref rid="pcbi.1010946.s008" ref-type="supplementary-material">S7 Fig</xref>).</p>
      <fig position="float" id="pcbi.1010946.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010946.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Performance benchmark and validity of the results.</title>
          <p>Benchmarking the running time of Metheor using (A) simulated RRBS dataset and (B) Ewing sarcoma RRBS dataset. Values below the name of each of the measures denote the amount of speedup (in fold) in Metheor compared to its benchmark counterpart. Benchmarking the memory usage of Metheor using (C) simulated RRBS dataset and (D) Ewing sarcoma RRBS dataset. Values below the name of each of the measures denote the amount of memory usage reduction (in fold) in Metheor compared to its benchmark counterpart. All the benchmark experiments were repeated for three times, except for MHL. Lines denote the average wall time and shades represent the 95% confidence interval. The wall time for MHL computation was measured for only once. (E) Validity of the results. CpG-wise (PDR, MHL, FDRP and qFDRP) and CpG quartet-wise (PM and ME) methylation heterogeneity levels were compared between Metheor and the corresponding reference implementations. Pearson’s correlation coefficient and corresponding p-values are shown for FDRP and qFDRP.</p>
        </caption>
        <graphic xlink:href="pcbi.1010946.g002" position="float"/>
      </fig>
      <p>WSHPackage allows PDR, FDRP and qFDRP to be calculated using multiple threads. To examine whether it can achieve performance comparable to Metheor when multiple threads are used, we particularly focused on the three measures, PDR, FDRP and qFDRP, for which WSHPackage allows the computation to be multithreaded. The running time for the computation of the three measures was measured using 20M simulated RRBS reads, with three replicates using each of 4, 8, 16 and 32 threads for WSHPackage. Surprisingly, we found that Metheor, only with a single thread, showed remarkable performance improvement (13.7∼175.8-fold faster) even compared to WSHPackage using 32 threads (<xref rid="pcbi.1010946.t001" ref-type="table">Table 1</xref>).</p>
      <table-wrap position="float" id="pcbi.1010946.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010946.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Performance comparison with WSHPackage using multiple threads for 20M RRBS-simulated reads.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1010946.t001" id="pcbi.1010946.t001g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Tool</th>
                <th align="right" rowspan="1" colspan="1"># threads</th>
                <th align="right" rowspan="1" colspan="1">PDR (fold)</th>
                <th align="right" rowspan="1" colspan="1">FDRP (fold)</th>
                <th align="right" rowspan="1" colspan="1">qFDRP (fold)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Metheor</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>1</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>0.87 (1)</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>2.96 (1)</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>3.72 (1)</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="4" colspan="1">WSHPackage</td>
                <td align="right" rowspan="1" colspan="1">4</td>
                <td align="right" rowspan="1" colspan="1">34.03 (38.92)</td>
                <td align="right" rowspan="1" colspan="1">1813.86 (612.65)</td>
                <td align="right" rowspan="1" colspan="1">1832.19 (492.70)</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">8</td>
                <td align="right" rowspan="1" colspan="1">19.57 (22.38)</td>
                <td align="right" rowspan="1" colspan="1">1072.79 (362.35)</td>
                <td align="right" rowspan="1" colspan="1">1097.32 (295.09)</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">16</td>
                <td align="right" rowspan="1" colspan="1">11.21 (12.82)</td>
                <td align="right" rowspan="1" colspan="1">652.74 (220.47)</td>
                <td align="right" rowspan="1" colspan="1">671.59 (180.60)</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">32</td>
                <td align="right" rowspan="1" colspan="1">11.94 (13.66)</td>
                <td align="right" rowspan="1" colspan="1">520.58 (175.83)</td>
                <td align="right" rowspan="1" colspan="1">527.40 (141.83)</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p>Values denote the wall time in minutes to compute each measure. Fold speedups in corresponding run of Metheor are shown in parentheses.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="sec011">
      <title>Validity of the result</title>
      <p>We verified that the DNA methylation heterogeneity levels computed by Metheor are consistent with the results from the reference implementations at both individual CpG or epiallele level (<xref rid="pcbi.1010946.g002" ref-type="fig">Fig 2E</xref>). Specifically, we observed exactly identical results for PDR, MHL, PM and ME levels. For FDRP and qFDRP, values from Metheor and WSHPackage were not exactly the same because these measures depend on random sampling of sequencing reads and it is not possible to reproduce the random sampling process of the reference implementation. Nevertheless, they showed extremely high and significant correlation with each other, supporting that Metheor successfully implements procedures to compute FDRP and qFDRP in desired ways. Altogether, these results ensure the reliability of the results from Metheor throughout all the measures it supports. Of note, Metheor uses 0-based half-open inteval system that comply with standard BED format. All the comparisons for the validation were done after translating the coordinates of the outputs appropriately.</p>
    </sec>
    <sec id="sec012">
      <title>Exploratory analysis on the DNA methylation heterogeneity profiles of 928 CCLE cell lines</title>
      <sec id="sec013">
        <title>Metheor allows the large-scale characterization of DNA methylation heterogeneity profiles in standard computing resources</title>
        <p>To demonstrate the utility of Metheor for a large-scale DNA methylation heterogeneity studies, we applied Metheor to compute the genomewide and context-specific DNA methylation heterogeneity profiles (PDR, ME, PM, FDRP, qFDRP, MHL and LPMD) using RRBS data for 928 cancer cell lines from CCLE. Of note, we restricted our processing pipeline to use at most 32 cores, each of which being assigned to single-threaded Metheor run, to show that Metheor can be run in standard computing resources that are available to a majority of the researchers, especially including experimental biologists.</p>
        <p>The computation of PDR, ME, PM and MHL for each cell line took 99.75, 144.52, 97.54 and 182.15 seconds on average, respectively, and the whole pipeline for 928 cell lines did not take more than one and an half hour. Since the running time estimation of four-threaded WSHPackage run for PDR yields about 5 days according to <xref rid="pcbi.1010946.t001" ref-type="table">Table 1</xref>, it shows the significant reduction of the computational burden of Metheor. Of note, the computation of LPMD took 397.55 seconds on average for each cell line. Furthermore, the computation of FDRP and qFDRP took 410.36 and 410.19 seconds on average, respectively, making the whole pipeline finish in about 3.3 hours. As the four-threaded WSHPackage runs for FDRP and qFDRP are expected to take 338 and 271 days in this setting, respectively, the use of high-performance computing cluster would have been almost necessary to compute these measures. Altogether, these results directly show the wide applicability of Metheor for large-scale DNA methylation heterogeneity studies.</p>
        <p>In the following sections, we provide some exploratory analyses on the biological significance of the DNA methylation heterogeneity profiles of 928 cancer cell lines characterized by Metheor.</p>
      </sec>
      <sec id="sec014">
        <title>Characteristics of the local DNA methylation disorder captured by LPMD across 928 cancer cell lines</title>
        <p>We first analyzed the genomewide average levels of LPMD across the 928 cancer cell lines according to their tissues of origin (<xref rid="pcbi.1010946.g003" ref-type="fig">Fig 3A</xref>) and disease types (<xref rid="pcbi.1010946.g003" ref-type="fig">Fig 3B</xref>). Overall, we could not observe consistent trends shared between genomewide methylation levels (i.e., average methylation level across all CpGs throughout the genome) and genomewide LPMD levels across tissues and diseases. This implies that the observed DNA methylation heterogeneity levels are not a mere consequence of stochastic DNA methylation, but at least there exist some tissue-specific regulatory mechanism that constrains the local homogeneity of DNA methylation states.</p>
        <fig position="float" id="pcbi.1010946.g003">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010946.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>Characteristics of LPMD across 928 cancer cell lines.</title>
            <p>(A) Genomewide average methylation levels and LPMD levels grouped by tissue types. Black vertical lines denote groupwise average levels of methylation and LPMD levels. Black horizontal bars on the right side denote the standard deviation of corresponding values. (B) Genomewide average methylation levels and LPMD levels grouped by disease types. Disease types from haematopoietic and lymphoid tissues are highlighted in red. (C, D) Correlation between mRNA expression and (C) genomewide average LPMD or (D) genomewide average methylation level. Genes are ranked according to the p-values of the corresponding correlation coefficients. P-values were adjusted using Benjamini-Hochberg procedure. (E, F) Correlation between DNMT3A expression and (E) genomewide average LPMD or (F) genomewide average methylation level. (G, H) Trends of fixed-distance average LPMD values. Shades denote 95% confidence interval. In (H), Cell lines were divided into two groups based on the median DNMT3A expression. (I) Difference of fixed-distance average LPMD values between DNMT3A<sup><italic toggle="yes">High</italic></sup> and DNMT3A<sup><italic toggle="yes">Low</italic></sup> groups.</p>
          </caption>
          <graphic xlink:href="pcbi.1010946.g003" position="float"/>
        </fig>
        <p>The genomewide methylation and LPMD levels were highly variable within the group of cell lines derived from haematopoietic and lymphoid tissues (<xref rid="pcbi.1010946.g003" ref-type="fig">Fig 3A</xref>), reflecting the heterogeneous disease composition (<xref rid="pcbi.1010946.g003" ref-type="fig">Fig 3B</xref>). Notably, malignancies derived from B cells showed highest genomewide LPMD, but they did not show consistent levels of global DNA methylation. The increased local disorder of DNA methylation states in B cell-derived malignancies is emphasized when the acute lymphoblastic B cell leukaemia and acute lymphoblastic T cell leukaemia are compared. This is particularly interesting since the importance of DNA methylation heterogeneity has been already highlighted in multiple myelomas [<xref rid="pcbi.1010946.ref009" ref-type="bibr">9</xref>] and diffuse large B cell lymphoma [<xref rid="pcbi.1010946.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1010946.ref011" ref-type="bibr">11</xref>].</p>
        <p>To reveal potential epigenetic regulators of the genomewide level of the local disorder of DNA methylation, we narrowed down our focus to a set of genes associated with GO term ‘DNA methylation’ (GO:0006306). Among the 59 genes associated with the term, we examined 56 genes whose mRNA expression levels were available. For each gene, the correlation between its mRNA expression level and genomewide LPMD or DNA methylation level were computed across the cancer cell lines, and we observed moderate negative correlation between <italic toggle="yes">DNMT3A</italic> expression and LPMD levels (<xref rid="pcbi.1010946.g003" ref-type="fig">Fig 3C and 3D</xref>). Interestingly, the correlation between DNMT3A expression and global DNA methylation level was not prominently stronger than the other genes (<xref rid="pcbi.1010946.g003" ref-type="fig">Fig 3E and 3F</xref>). As a measure of the local disorder of DNA methylation, an advantage of LPMD compared to PDR is that it explicitly takes the distance between a pair of CpGs into account. We asked whether the probability of observing discordance of DNA methylation states increases with increasing distance between a pair of CpGs (<xref rid="pcbi.1010946.g003" ref-type="fig">Fig 3G</xref>). In other words, we examined the local homogeneity of individual DNA methylation states in a quantitative manner. As a result, we verified that the discordance of DNA methylation states were positively correlated with the distance between CpGs. We confirmed that there were sufficient number of CpG pairs for the computation of LPMD (<xref rid="pcbi.1010946.s009" ref-type="supplementary-material">S8 Fig</xref>). Intriguingly, when the cell lines were divided into two groups based on their <italic toggle="yes">DNMT3A</italic> mRNA expression levels, we observed significant differences of LPMD levels between the two groups (<xref rid="pcbi.1010946.g003" ref-type="fig">Fig 3H</xref>, Two-tailed independent t-test p &lt; 0.001 for all individual distances), and the absolute difference increased along the distance (<xref rid="pcbi.1010946.g003" ref-type="fig">Fig 3I</xref>). We leave the elucidation of the exact biological mechanism underlying the association between the <italic toggle="yes">DNMT3A</italic> expression and the local disorder of DNA methylation as a future work, nevertheless we hypothesize that the processive <italic toggle="yes">de novo</italic> DNA methylation by DNMT3A dependent on the oligomeric state of the protein [<xref rid="pcbi.1010946.ref012" ref-type="bibr">12</xref>] may play a critical role in this phenomenon. Specifically, homotetrameric DNMT3A shows processive <italic toggle="yes">de novo</italic> methylation, where the methylation is added to consecutive CpGs. On the other hand, homodimeric DNMT3A shows distributive catalysis, where the enzyme complex frequently dissociates from the DNA. As the oligomeric state of homomer complex is known to heavily dependent on monomer concentration [<xref rid="pcbi.1010946.ref013" ref-type="bibr">13</xref>], we speculate that the increase of DNMT3A gene expression will make intracellular DNMT3A oligomeric state biased toward homotetramers, thus increasing the local homogeneity of DNA methylation states.</p>
      </sec>
      <sec id="sec015">
        <title>Homogeneity of DNA methylation patterns across cell population is associated with the stemness of cancer cells</title>
        <p>Having analyzed the intracellular DNA methylation disorders using LPMD, we then tried to systematically identify genes whose expression levels are associated with the global extent of intercellular DNA methylation heterogeneity using methylation entropy. To this end, for every gene, we computed the correlation between its expression and the average methylation entropy levels at the promoters of all protein coding genes (<xref rid="pcbi.1010946.g004" ref-type="fig">Fig 4A</xref>). Interestingly, we observed that the genes whose expressions were negatively correlated with global promoter methylation entropy exhibited considerable enrichment for biological processes including extracellular matrix organization, cell migration, cell differentiation and epithelial to mesenchymal transition (<xref rid="pcbi.1010946.g004" ref-type="fig">Fig 4B</xref>) and it was true for the other DNA methylation heterogeneity measures including LPMD, PDR, epipolymorphism, FDRP and MHL (<xref rid="pcbi.1010946.s010" ref-type="supplementary-material">S9 Fig</xref> (A)). These terms collectively imply that the homogeneity of DNA methylation patterns is associated with the increased metastatic potential as well as increased stemness of cancer cells. As expected, cancer cell lines derived from metastatic origins displayed lower promoter methylation entropy levels (<xref rid="pcbi.1010946.g004" ref-type="fig">Fig 4C</xref>, p = 0.0478) and other DNA methylation heterogeneity levels (<xref rid="pcbi.1010946.s010" ref-type="supplementary-material">S9 Fig</xref> (B)). <xref rid="pcbi.1010946.g004" ref-type="fig">Fig 4D</xref> shows weak, but significant negative correlation for the two representative genes within canonical Wnt signaling (<italic toggle="yes">WNT</italic>7<italic toggle="yes">A</italic> and <italic toggle="yes">CTNND</italic>2). Furthermore, the activity of Wnt signaling pathway, inferred by bioinformatic method called subsystem activation score [<xref rid="pcbi.1010946.ref014" ref-type="bibr">14</xref>], also showed negative correlation with global levels of promoter methylation entropy (<xref rid="pcbi.1010946.g004" ref-type="fig">Fig 4E</xref>) and other DNA methylation heterogeneity levels (<xref rid="pcbi.1010946.s010" ref-type="supplementary-material">S9 Fig</xref> (C)). These results are noticeable in that stem cells in normal physiological condition show remarkable homogeneity of DNA methylation patterns [<xref rid="pcbi.1010946.ref004" ref-type="bibr">4</xref>]. Although the causal relationship between the observed DNA methylation heterogeneity in a cancer cell population and stem-like reprogramming remains to be studied, our results suggest the potential of the cancer cell population-level DNA methylation homogeneity as a new prognostic marker.</p>
        <fig position="float" id="pcbi.1010946.g004">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010946.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>Association between methylation entropy and cancer stemness.</title>
            <p>(A) Genes were ranked by the Pearson’s correlation between their expression and average methylation entropy levels across promoters. Red dots represent 3,680 genes having statistically significant correlations (Benjamini-Hochberg adjusted p-value &lt; 0.05), and the results of functional enrichment analysis using those genes are shown in (B). (C) The distribution of promoter methylation entropy levels in primary and metastatic cancer cell lines. (D) The association between promoter methylation entropy levels and two genes representative of Wnt signaling pathway (<italic toggle="yes">WNT7A</italic> and <italic toggle="yes">CTNND2</italic>). (E) The association between promoter methylation entropy levels and the activity of Wnt signaling pathway. *two-tailed independent t-test p &lt; 0.05; In D-E, Pearson’s correlation coefficients and associated p-values are shown. In D, p-values were adjusted using Benjamini-Hochberg procedure.</p>
          </caption>
          <graphic xlink:href="pcbi.1010946.g004" position="float"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec id="sec016">
    <title>Availability and future directions</title>
    <p>The DNA methylation heterogeneity profiles generated by Metheor can be utilized to discover novel biomarkers when combined with functional genomic analyses. For example, the heterogeneity, or diversity, of DNA methylation patterns within a cancer cell population can serve as a predictive biomarker for certain anticancer drugs. Especially, through a preliminary analysis we found that PDRs at the promoters of tumor suppressor genes (TSGs) are significantly lower than that of oncogenes and the rest of the genes (<xref rid="pcbi.1010946.s011" ref-type="supplementary-material">S10 Fig</xref>), suggesting the different role of epigenetic regulation of TSGs and oncogenes in the context of cancer evolution. Moreover, the local heterogeneity of DNA methylation states may sensitize cancer cells to the perturbation of certain genes. That is, the configuration of local DNA methylation states may reflect the genetic dependency of cancer cells. Meanwhile, our exploratory analysis of DNA methylation heterogeneity reveals a link between the extent of the DNA methylation heterogeneity and the overall stemness of cancer cell population. Although the causal explanation between the homogeneity of DNA methylation and the stemness of cancer cells remains unclear, we can devise an orthogonal method for the computation of the stemness index [<xref rid="pcbi.1010946.ref015" ref-type="bibr">15</xref>] of a tumor, which has already been shown its prognostic potential in various cancer types. Finally, to facilitate such future studies on the DNA methylation heterogeneity in cancers, we made the DNA methylation heterogeneity profiles of 928 CCLE cell lines computed by Metheor publicly available through Figshare (<ext-link xlink:href="https://doi.org/10.6084/m9.figshare.21100717.v1" ext-link-type="uri">https://doi.org/10.6084/m9.figshare.21100717.v1</ext-link>).</p>
    <p>Metheor is freely available for any users under the GPL-3.0 license. The source code can be anonymously downloaded at the GitHub repository (<ext-link xlink:href="https://github.com/dohlee/metheor" ext-link-type="uri">https://github.com/dohlee/metheor</ext-link>), and the executable is distributed through conda package manager to facilitate the public use of the software (<ext-link xlink:href="https://anaconda.org/dohlee/metheor" ext-link-type="uri">https://anaconda.org/dohlee/metheor</ext-link>). We also provide the codes for the simulation of WGBS reads at the dedicated GitHub repository (<ext-link xlink:href="https://github.com/jwyang21/simulate_WGBS" ext-link-type="uri">https://github.com/jwyang21/simulate_WGBS</ext-link>).</p>
  </sec>
  <sec id="sec017" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1010946.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>Details of the algorithms used in Metheor implementation and simulated data preparation used for benchmark.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010946.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010946.s002" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>Schematic illustration of proportion of discorant reads (PDR).</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010946.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010946.s003" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>Schematic illustration of local pairwise methylation discordance (LPMD).</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010946.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010946.s004" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>Schematic illustration of methylation haplotype load (MHL).</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010946.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010946.s005" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <title>Schematic illustration of epipolymorphism and methylation entropy.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010946.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010946.s006" position="float" content-type="local-data">
      <label>S5 Fig</label>
      <caption>
        <title>Benchmarking the running time of Metheor against WSHPackage when only a subset of CpGs are considered.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010946.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010946.s007" position="float" content-type="local-data">
      <label>S6 Fig</label>
      <caption>
        <title>Robustness of LPMD against the choice of genomic distance window.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010946.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010946.s008" position="float" content-type="local-data">
      <label>S7 Fig</label>
      <caption>
        <title>Benchmarking the running time and memory usage of Metheor using simulated pseudo-WGBS dataset.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010946.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010946.s009" position="float" content-type="local-data">
      <label>S8 Fig</label>
      <caption>
        <title>Distribution of the number of CpG pairs at fixed distances in 928 CCLE cell lines.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010946.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010946.s010" position="float" content-type="local-data">
      <label>S9 Fig</label>
      <caption>
        <title>Association between stemness of cancer cells and other DNA methylation heterogeneity measures.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010946.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010946.s011" position="float" content-type="local-data">
      <label>S10 Fig</label>
      <caption>
        <title>Promoter PDRs of tumor suppressors and oncogenes.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010946.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1010946.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Mazor</surname><given-names>T</given-names></name>, <name><surname>Pankov</surname><given-names>A</given-names></name>, <name><surname>Song</surname><given-names>J</given-names></name>, <name><surname>Costello</surname><given-names>JF</given-names></name>. <article-title>Intratumoral heterogeneity of the epigenome</article-title>. <source>Cancer cell</source>. <year>2016</year>;<volume>29</volume>(<issue>4</issue>):<fpage>440</fpage>–<lpage>451</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.ccell.2016.03.009</pub-id><?supplied-pmid 27070699?><pub-id pub-id-type="pmid">27070699</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010946.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Xie</surname><given-names>H</given-names></name>, <name><surname>Wang</surname><given-names>M</given-names></name>, <name><surname>De Andrade</surname><given-names>A</given-names></name>, <name><surname>Bonaldo</surname><given-names>M</given-names></name>, <name><surname>Galat</surname><given-names>V</given-names></name>, <name><surname>Arndt</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Genome-wide quantitative assessment of variation in DNA methylation patterns</article-title>. <source>Nucleic acids research</source>. <year>2011</year>;<volume>39</volume>(<issue>10</issue>):<fpage>4099</fpage>–<lpage>4108</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkr017</pub-id><?supplied-pmid 21278160?><pub-id pub-id-type="pmid">21278160</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010946.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Landau</surname><given-names>DA</given-names></name>, <name><surname>Clement</surname><given-names>K</given-names></name>, <name><surname>Ziller</surname><given-names>MJ</given-names></name>, <name><surname>Boyle</surname><given-names>P</given-names></name>, <name><surname>Fan</surname><given-names>J</given-names></name>, <name><surname>Gu</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Locally disordered methylation forms the basis of intratumor methylome variation in chronic lymphocytic leukemia</article-title>. <source>Cancer cell</source>. <year>2014</year>;<volume>26</volume>(<issue>6</issue>):<fpage>813</fpage>–<lpage>825</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.ccell.2014.10.012</pub-id><?supplied-pmid 25490447?><pub-id pub-id-type="pmid">25490447</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010946.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Landan</surname><given-names>G</given-names></name>, <name><surname>Cohen</surname><given-names>NM</given-names></name>, <name><surname>Mukamel</surname><given-names>Z</given-names></name>, <name><surname>Bar</surname><given-names>A</given-names></name>, <name><surname>Molchadsky</surname><given-names>A</given-names></name>, <name><surname>Brosh</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Epigenetic polymorphism and the stochastic formation of differentially methylated regions in normal and cancerous tissues</article-title>. <source>Nature genetics</source>. <year>2012</year>;<volume>44</volume>(<issue>11</issue>):<fpage>1207</fpage>–<lpage>1214</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ng.2442</pub-id><?supplied-pmid 23064413?><pub-id pub-id-type="pmid">23064413</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010946.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>S</given-names></name>, <name><surname>Diep</surname><given-names>D</given-names></name>, <name><surname>Plongthongkum</surname><given-names>N</given-names></name>, <name><surname>Fung</surname><given-names>H-L</given-names></name>, <name><surname>Zhang</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Identification of methylation haplotype blocks aids in deconvolution of heterogeneous tissue samples and tumor tissue-of-origin mapping from plasma DNA</article-title>. <source>Nature genetics</source>. <year>2017</year>;<volume>49</volume>(<issue>4</issue>):<fpage>635</fpage>–<lpage>642</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ng.3805</pub-id><?supplied-pmid 28263317?><pub-id pub-id-type="pmid">28263317</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010946.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Scherer</surname><given-names>M</given-names></name>, <name><surname>Nebel</surname><given-names>A</given-names></name>, <name><surname>Franke</surname><given-names>A</given-names></name>, <name><surname>Walter</surname><given-names>J</given-names></name>, <name><surname>Lengauer</surname><given-names>T</given-names></name>, <name><surname>Bock</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Quantitative comparison of within-sample heterogeneity scores for DNA methylation data</article-title>. <source>Nucleic acids research</source>. <year>2020</year>;<volume>48</volume>(<issue>8</issue>):<fpage>e46</fpage>–<lpage>e46</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkaa120</pub-id><?supplied-pmid 32103242?><pub-id pub-id-type="pmid">32103242</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010946.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>S</given-names></name>, <name><surname>Garrett-Bakelman</surname><given-names>F</given-names></name>, <name><surname>Perl</surname><given-names>AE</given-names></name>, <name><surname>Luger</surname><given-names>SM</given-names></name>, <name><surname>Zhang</surname><given-names>C</given-names></name>, <name><surname>To</surname><given-names>BL</given-names></name>, <etal>et al</etal>. <article-title>Dynamic evolution of clonal epialleles revealed by methclone</article-title>. <source>Genome biology</source>. <year>2014</year>;<volume>15</volume>(<issue>9</issue>):<fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-014-0472-5</pub-id><?supplied-pmid 25260792?><pub-id pub-id-type="pmid">25260792</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010946.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Su</surname><given-names>J</given-names></name>, <name><surname>Huang</surname><given-names>YH</given-names></name>, <name><surname>Cui</surname><given-names>X</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Lei</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Homeobox oncogene activation by pan-cancer DNA hypermethylation</article-title>. <source>Genome biology</source>. <year>2018</year>;<volume>19</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-018-1492-3</pub-id><?supplied-pmid 30097071?><pub-id pub-id-type="pmid">29301551</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010946.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Derrien</surname><given-names>J</given-names></name>, <name><surname>Guérin-Charbonnel</surname><given-names>C</given-names></name>, <name><surname>Gaborit</surname><given-names>V</given-names></name>, <name><surname>Campion</surname><given-names>L</given-names></name>, <name><surname>Devic</surname><given-names>M</given-names></name>, <name><surname>Douillard</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>The DNA methylation landscape of multiple myeloma shows extensive inter-and intrapatient heterogeneity that fuels transcriptomic variability</article-title>. <source>Genome medicine</source>. <year>2021</year>;<volume>13</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13073-021-00938-3</pub-id><?supplied-pmid 34372935?><pub-id pub-id-type="pmid">33397400</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010946.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Pan</surname><given-names>H</given-names></name>, <name><surname>Jiang</surname><given-names>Y</given-names></name>, <name><surname>Boi</surname><given-names>M</given-names></name>, <name><surname>Tabbò</surname><given-names>F</given-names></name>, <name><surname>Redmond</surname><given-names>D</given-names></name>, <name><surname>Nie</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Epigenomic evolution in diffuse large B-cell lymphomas</article-title>. <source>Nature communications</source>. <year>2015</year>;<volume>6</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ncomms7921</pub-id><?supplied-pmid 25891015?><pub-id pub-id-type="pmid">25891015</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010946.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Bakhshi</surname><given-names>TJ</given-names></name>, <name><surname>Georgel</surname><given-names>PT</given-names></name>. <article-title>Genetic and epigenetic determinants of diffuse large B-cell lymphoma</article-title>. <source>Blood cancer journal</source>. <year>2020</year>;<volume>10</volume>(<issue>12</issue>):<fpage>1</fpage>–<lpage>23</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41408-020-00389-w</pub-id><?supplied-pmid 33277464?><pub-id pub-id-type="pmid">31915364</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010946.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Holz-Schietinger</surname><given-names>C</given-names></name>, <name><surname>Matje</surname><given-names>DM</given-names></name>, <name><surname>Harrison</surname><given-names>MF</given-names></name>, <name><surname>Reich</surname><given-names>NO</given-names></name>. <article-title>Oligomerization of DNMT3A controls the mechanism of de novo DNA methylation</article-title>. <source>Journal of Biological Chemistry</source>. <year>2011</year>;<volume>286</volume>(<issue>48</issue>):<fpage>41479</fpage>–<lpage>41488</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1074/jbc.M111.284687</pub-id><?supplied-pmid 21979949?><pub-id pub-id-type="pmid">21979949</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010946.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Bergendahl LT and Marsh</surname><given-names>JA</given-names></name>, <article-title>Functional determinants of protein assembly into homomeric complexes</article-title>. <source>Scientific reports</source>. <year>2017</year>;<volume>7</volume>(<issue>1</issue>):<fpage>4932</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41598-017-05084-8</pub-id><?supplied-pmid 28694495?><pub-id pub-id-type="pmid">28694495</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010946.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Lim</surname><given-names>S</given-names></name>, <name><surname>Park</surname><given-names>Y</given-names></name>, <name><surname>Hur</surname><given-names>B</given-names></name>, <name><surname>Kim</surname><given-names>M</given-names></name>, <name><surname>Han</surname><given-names>W</given-names></name>, <name><surname>Kim</surname><given-names>S</given-names></name>. <article-title>Protein interaction network (pin)-based breast cancer subsystem identification and activation measurement for prognostic modeling</article-title>. <source>Methods</source>. <year>2016</year>;<volume>110</volume>:<fpage>81</fpage>–<lpage>89</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.ymeth.2016.06.015</pub-id><?supplied-pmid 27329435?><pub-id pub-id-type="pmid">27329435</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010946.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Malta</surname><given-names>TM</given-names></name>, <name><surname>Sokolov</surname><given-names>A</given-names></name>, <name><surname>Gentles</surname><given-names>AJ</given-names></name>, <name><surname>Burzykowski</surname><given-names>T</given-names></name>, <name><surname>Poisson</surname><given-names>L</given-names></name>, <name><surname>Weinstein</surname><given-names>JN</given-names></name>, <etal>et al</etal>. <article-title>Machine learning identifies stemness features associated with oncogenic dedifferentiation</article-title>. <source>Cell</source>. <year>2018</year>;<volume>173</volume>(<issue>2</issue>):<fpage>338</fpage>–<lpage>354</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2018.03.034</pub-id><?supplied-pmid 29625051?><pub-id pub-id-type="pmid">29625051</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1010946.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010946.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bekiranov</surname>
          <given-names>Stefan</given-names>
        </name>
        <role>Guest Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Ioshikhes, Bekiranov</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Ioshikhes, Bekiranov</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010946" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">4 Dec 2022</named-content>
    </p>
    <p>Dear Pf. Kim,</p>
    <p>Thank you very much for submitting your manuscript "Metheor: Ultrafast DNA methylation heterogeneity calculation from bisulfite read alignments" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Stefan Bekiranov</p>
    <p>Guest Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Lucy Houghton</p>
    <p>Staff</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: Comments are uploaded as an attachment.</p>
    <p>Reviewer #2: The manuscript by Lee, et. al developed a fast and lightweight tool for DNA methylation heterogeneity calculation, which made large-scale DNA methylation heterogeneity studies easily feasible for everyone. To illustrate this, the authors have implemented their method on 928 cancer cell lines and revealed potential factors associated with DNA methylation heterogeneity.</p>
    <p>Major comments:</p>
    <p>1. Cancer cells usually have global low DNA methylation and local high DNA methylation, especially on cancer repressors. Can the authors illustrate the relationships between cancer repressors and DNA methylation heterogeneity?</p>
    <p>2. Can the authors get similar results based on the 928 cancer cell lines if they use different DNA methylation heterogeneity measures?</p>
    <p>Minor comments:</p>
    <p>The authors should make the figures clearer.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: <bold>Yes: </bold>Heng-Chang Chen</p>
    <p>Reviewer #2: <bold>Yes: </bold>XIAOLONG CUI</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <supplementary-material id="pcbi.1010946.s012" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">[reviewer comments]-PLOS Computational Biology.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1010946.s012.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1010946.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010946.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010946" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">2 Feb 2023</named-content>
    </p>
    <supplementary-material id="pcbi.1010946.s013" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response_to_reviewers.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1010946.s013.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1010946.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010946.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bekiranov</surname>
          <given-names>Stefan</given-names>
        </name>
        <role>Guest Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Ioshikhes, Bekiranov</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Ioshikhes, Bekiranov</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010946" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">13 Feb 2023</named-content>
    </p>
    <p>Dear Pf. Kim,</p>
    <p>We are pleased to inform you that your manuscript 'Metheor: Ultrafast DNA methylation heterogeneity calculation from bisulfite read alignments' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Stefan Bekiranov</p>
    <p>Guest Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Lucy Houghton</p>
    <p>Staff</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: I have reviewed the resubmission of this revised version of the manuscript. The manuscript has been greatly improved and I appreciate the authors’ efforts to address the concerns that I have raised in the original submission.</p>
    <p>This revised version of the manuscript is well-written and clearly explains the background of Metheor, including the theoretical rationale, and algorithms used in this method. Essentially, the authors have strengthened the impact of Metheor on the study of cancer biology and cancer evolution. I do not have any further comments on this manuscript.</p>
    <p>Reviewer #2: The authors have addressed all my concerns. The manuscript can be accepted for publication.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: <bold>Yes: </bold>Heng-Chang Chen</p>
    <p>Reviewer #2: <bold>Yes: </bold>Xiao-Long Cui</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1010946.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010946.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bekiranov</surname>
          <given-names>Stefan</given-names>
        </name>
        <role>Guest Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Ioshikhes, Bekiranov</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Ioshikhes, Bekiranov</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010946" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">15 Mar 2023</named-content>
    </p>
    <p>PCOMPBIOL-D-22-01380R1 </p>
    <p>Metheor: Ultrafast DNA methylation heterogeneity calculation from bisulfite read alignments</p>
    <p>Dear Dr Kim,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Timea Kemeri-Szekernyes</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
