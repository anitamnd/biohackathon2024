<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">nargab</journal-id>
    <journal-title-group>
      <journal-title>NAR Genomics and Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2631-9268</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10993291</article-id>
    <article-id pub-id-type="pmid">38584872</article-id>
    <article-id pub-id-type="doi">10.1093/nargab/lqae030</article-id>
    <article-id pub-id-type="publisher-id">lqae030</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00030</subject>
        <subject>AcademicSubjects/SCI00980</subject>
        <subject>AcademicSubjects/SCI01060</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Pipelines and Workflows for Biological Data Analysis</subject>
      </subj-group>
      <subj-group subj-group-type="category-oup-series">
        <subject>Editor's Choice</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VIBES: a workflow for annotating and visualizing viral sequences integrated into bacterial genomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8328-7339</contrib-id>
        <name>
          <surname>Copeland</surname>
          <given-names>Conner J</given-names>
        </name>
        <aff><institution>Division of Biological Sciences, University of Montana</institution>, Missoula, MT, 59812, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6055-7706</contrib-id>
        <name>
          <surname>Roddy</surname>
          <given-names>Jack W</given-names>
        </name>
        <aff><institution>R. Ken Coit College of Pharmacy, University of Arizona</institution>, Tucson, AZ, 85721, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schmidt</surname>
          <given-names>Amelia K</given-names>
        </name>
        <aff><institution>Division of Biological Sciences, University of Montana</institution>, Missoula, MT, 59812, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7123-3037</contrib-id>
        <name>
          <surname>Secor</surname>
          <given-names>Patrick R</given-names>
        </name>
        <aff><institution>Division of Biological Sciences, University of Montana</institution>, Missoula, MT, 59812, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2004-1785</contrib-id>
        <name>
          <surname>Wheeler</surname>
          <given-names>Travis J</given-names>
        </name>
        <!--twheeler@arizona.edu-->
        <aff><institution>R. Ken Coit College of Pharmacy, University of Arizona</institution>, Tucson, AZ, 85721, <country country="US">USA</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +1 520 621 6449; Email: <email>twheeler@arizona.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-04-04">
      <day>04</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <volume>6</volume>
    <issue>2</issue>
    <elocation-id>lqae030</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>5</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press on behalf of NAR Genomics and Bioinformatics.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="lqae030.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Bacteriophages are viruses that infect bacteria. Many bacteriophages integrate their genomes into the bacterial chromosome and become prophages. Prophages may substantially burden or benefit host bacteria fitness, acting in some cases as parasites and in others as mutualists. Some prophages have been demonstrated to increase host virulence. The increasing ease of bacterial genome sequencing provides an opportunity to deeply explore prophage prevalence and insertion sites. Here we present VIBES (Viral Integrations in Bacterial genomES), a workflow intended to automate prophage annotation in complete bacterial genome sequences. VIBES provides additional context to prophage annotations by annotating bacterial genes and viral proteins in user-provided bacterial and viral genomes. The VIBES pipeline is implemented as a Nextflow-driven workflow, providing a simple, unified interface for execution on local, cluster and cloud computing environments. For each step of the pipeline, a container including all necessary software dependencies is provided. VIBES produces results in simple tab-separated format and generates intuitive and interactive visualizations for data exploration. Despite VIBES’s primary emphasis on prophage annotation, its generic alignment-based design allows it to be deployed as a general-purpose sequence similarity search manager. We demonstrate the utility of the VIBES prophage annotation workflow by searching for 178 Pf phage genomes across 1072 <italic toggle="yes">Pseudomonas</italic> spp. genomes.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of General Medical Sciences</institution>
            <institution-id institution-id-type="DOI">10.13039/100000057</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM132600</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Office of Biological and Environmental Research</institution>
            <institution-id institution-id-type="DOI">10.13039/100006206</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>DE-SC0021216</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
            <institution-id institution-id-type="DOI">10.13039/100000060</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01AI138981</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>Introduction</title>
    <p>Bacteriophages (phages), viruses that infect bacteria, are as ubiquitous as their hosts. They are found everywhere that we find populations of bacteria, from forest soils and the oceans to hydrothermal springs and the human gut. Phages pose a significant threat to bacteria: in marine ecosystems, up to one-third of bacteria are killed by phages every day (<xref rid="B1" ref-type="bibr">1</xref>). The strong pressure exerted by the threat of phage infection has led bacteria to evolve antiphage defense systems. Restriction–modification systems (<xref rid="B2" ref-type="bibr">2</xref>) and CRISPR–Cas systems (<xref rid="B3" ref-type="bibr">3</xref>) rely on sensing and degrading invading nucleic acids and are among the most widespread antiphage systems; however, numerous additional antiphage defense systems utilizing diverse mechanisms have recently been discovered (<xref rid="B4" ref-type="bibr">4</xref>). Likewise, phages have evolved to become adept manipulators of host metabolism, allowing them to evade host defenses or improve conditions for viral replication (<xref rid="B5" ref-type="bibr">5</xref>).</p>
    <p>Phages can be purely parasitic (lytic) and replicate at the expense of their bacterial hosts. However, in addition to lytic replication, temperate phages can alternatively undergo lysogenic replication in which the phage genome typically integrates into the host chromosome as a prophage. Temperate phages are common: approximately half of sequenced bacterial genomes contain at least one prophage (<xref rid="B6" ref-type="bibr">6</xref>). Prophages are replicated each time the host cell divides. Consequentially, prophages benefit from thriving hosts, which can incentivize the development of mutualistic phage–host relationships. Many prophages encode factors that benefit their hosts (<xref rid="B7" ref-type="bibr">7</xref>). For example, some phages carry genes that promote resistance to infection from competing viruses (<xref rid="B8" ref-type="bibr">8</xref>), while other phages encode virulence factors, aiding host pathogenicity (<xref rid="B9" ref-type="bibr">9</xref>).</p>
    <p>Many bacterial species are lysogenized by filamentous phages in the Inoviridae family (<xref rid="B10" ref-type="bibr">10</xref>). The opportunistic pathogen <italic toggle="yes">Pseudomonas aeruginosa</italic> is frequently lysogenized by an inovirus called Pf (<xref rid="B11" ref-type="bibr">11–13</xref>). Pf prophages maintain lysogeny by repressing transcription of their excisionase (<xref rid="B14" ref-type="bibr">14</xref>). In response to oxidative stress (<xref rid="B15" ref-type="bibr">15</xref>), nutrient limitation (<xref rid="B16" ref-type="bibr">16</xref>) or other factors (<xref rid="B17" ref-type="bibr">17</xref>), the Pf prophage excises from the chromosome and Pf virion replication is initiated. Pf virion replication plays a role in biofilm development by lysing cells in the center of a colony, releasing DNA that adds to biofilm structural integrity (<xref rid="B18" ref-type="bibr">18</xref>). Pf virions themselves also act as structural components in <italic toggle="yes">P. aeruginosa</italic> biofilms, protecting bacteria from desiccation and antibiotics (<xref rid="B19" ref-type="bibr">19</xref>,<xref rid="B20" ref-type="bibr">20</xref>). Indeed, the presence of Pf virions in the airways of cystic fibrosis patients is associated with antibiotic resistance (<xref rid="B21" ref-type="bibr">21</xref>). Additionally, Pf virions are immunomodulatory and induce maladaptive antiviral immune responses that promote infection initiation (<xref rid="B22" ref-type="bibr">22</xref>) and interfere with wound healing by inhibiting keratinocyte migration (<xref rid="B23" ref-type="bibr">23</xref>).</p>
    <p>The important and varied roles of prophages in bacterial communities—parasites, mutualists and sometimes pathogenicity aides—motivate the development of high-quality software methods that identify and classify their integrations into bacterial genomes. Generally, phage sequence annotation tools are designed to annotate either prophage in whole bacterial genome sequence or phage genome fragments in metagenomic datasets. Most recent approaches focus on annotation in a metagenomic context, as metagenomic datasets have proven to be rich sources of previously unknown viral sequences (<xref rid="B10" ref-type="bibr">10</xref>,<xref rid="B24" ref-type="bibr">24</xref>). Viral annotation, particularly in metagenomic contexts, requires tools to strike a balance between sensitivity and speed. High sensitivity is necessary to overcome high mutation rates in viral proteins combined with an increased risk of sequencing error stemming from the low abundance of viral sequences in most metagenomic datasets. Meanwhile, reasonable labeling speed is required when annotating large datasets. As a result of these constraints, viral annotation software has generally converged on a few techniques for identifying viral sequences: sequence similarity search against large databases of viral genomes (<xref rid="B25" ref-type="bibr">25–27</xref>), machine learning approaches based on statistical features such as <italic toggle="yes">k</italic>-mer frequencies, with a recent emphasis on neural networks (<xref rid="B28" ref-type="bibr">28–30</xref>), or some combination of both approaches (<xref rid="B31" ref-type="bibr">31–35</xref>). Viral annotation tools with a focus on prophage annotation in whole genome sequence [DBSCAN-SWA (<xref rid="B26" ref-type="bibr">26</xref>), PHASTEST (<xref rid="B36" ref-type="bibr">36</xref>), Prophage Hunter (<xref rid="B33" ref-type="bibr">33</xref>)] typically include visual summaries that increase the legibility of their output. Both DBSCAN-SWA and Prophage Hunter are available as stand-alone software that can be run by researchers seeking to conduct large-scale analysis in a cluster or cloud computing environment, but require installation of prerequisite software and manual creation of job submission scripts to run in high-performance computing (HPC) environments. This significantly increases the minimum computational skillset necessary to conduct large-scale analysis of prophage integrated into complete bacterial genome sequences. PHASTEST somewhat alleviates this by offering a containerized version of their approach, reducing the need to install prerequisites. However, managing widescale execution of containerized PHASTEST instances in an HPC environment through job submission scripts or other customized approaches is still left to end users.</p>
    <p>Here, we introduce and describe VIBES (Viral Integrations in Bacterial genomES), an automated command line workflow for annotation of bacterial genomes that emphasizes identification of prophage integrations. VIBES supplements standard bacterial gene labeling with in-depth analysis of prophage integrations, producing machine- and human-readable text output files coupled with interactive HTML visualizations that facilitate further analysis of output data. VIBES is designed to</p>
    <list list-type="bullet">
      <list-item>
        <p>annotate prophages with high sensitivity;</p>
      </list-item>
      <list-item>
        <p>annotate bacterial genes on input genomes, using Prokka (<xref rid="B37" ref-type="bibr">37</xref>);</p>
      </list-item>
      <list-item>
        <p>annotate viral genes within input viral genomes, using the PHROGs database (<xref rid="B38" ref-type="bibr">38</xref>);</p>
      </list-item>
      <list-item>
        <p>accept a potentially large number of bacterial genomes and candidate phage genomes as input;</p>
      </list-item>
      <list-item>
        <p>substantially reduce prerequisite installation and automatically manage distribution of workload to cluster/cloud/local resources; and</p>
      </list-item>
      <list-item>
        <p>create interactive HTML visuals that display the above, as well as display which regions that map to user input prophages are most prevalent among all input bacterial genomes.</p>
      </list-item>
    </list>
    <p>To the best of our knowledge, VIBES is the first prophage annotation software approach that includes output visualizations designed to facilitate investigation of patterns of prophage integration and shared prophage–host homology across entire target bacterial genome datasets. VIBES is also the first prophage annotation approach that is engineered to enable efficient, massively parallelized prophage search and genome annotation by end users on a wide variety of hardware and computing environments. VIBES also has the capacity to serve as manager of massively parallelized sequence similarity searches, even if the queries and targets of those searches are not prophages and bacteria, respectively.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>Materials and methods</title>
    <sec id="SEC2-1">
      <title>Implementation</title>
      <p>VIBES is an automated prophage search workflow that uses containerized components coordinated by the Nextflow workflow management software (<xref rid="B39" ref-type="bibr">39</xref>) to produce output tab-separated value (TSV) annotation tables accompanied by interactive HTML files that summarize matches to prophage sequences. To annotate prophage integrations, VIBES is provided with an input FASTA file containing all prophage sequences to seek and a collection of bacterial genomes in FASTA format to annotate with prophages; it performs search using the software <italic toggle="yes">nhmmer</italic> (<xref rid="B40" ref-type="bibr">40</xref>). To annotate bacterial protein-coding genes, ribosomal RNA and transfer RNA, VIBES uses Prokka (<xref rid="B37" ref-type="bibr">37</xref>). To annotate query prophage protein-coding genes, VIBES uses the BATH protein-coding DNA annotation software (<xref rid="B41" ref-type="bibr">41</xref>) and the PHROGs v4 prokaryotic viral protein database (<xref rid="B38" ref-type="bibr">38</xref>) by default. The user can optionally substitute their own viral protein database. Figure <xref rid="F1" ref-type="fig">1</xref> provides a visual representation of the three independent annotation workflows, run in parallel and managed by VIBES, that produce bacterial gene annotations, viral sequence integrations and viral gene annotations. Table <xref rid="tbl1" ref-type="table">1</xref> lists the tools and databases managed by the VIBES Docker container.</p>
      <table-wrap position="float" id="tbl1">
        <label>Table 1.</label>
        <caption>
          <p>Dependencies managed by VIBES Docker container</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Tool</th>
              <th rowspan="1" colspan="1">Purpose</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">BATH (<xref rid="B41" ref-type="bibr">41</xref>)</td>
              <td rowspan="1" colspan="1">Annotation of protein-coding DNA on query prophage</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic toggle="yes">nhmmer</italic> (<xref rid="B40" ref-type="bibr">40</xref>)</td>
              <td rowspan="1" colspan="1">DNA-to-DNA identification of prophages on bacterial genomes</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Prokka (<xref rid="B37" ref-type="bibr">37</xref>)</td>
              <td rowspan="1" colspan="1">Bacterial genome annotation</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>VIBES workflow schematic. It displays how input data move through the VIBES annotation workflow. Bacterial gene annotation processes are shown in yellow (left track), prophage annotation processes are shown in green (center track), viral gene annotation processes are shown in blue (right track) and visualization processes are shown in red (bottom square). The annotation processes are independent of each other. Stacked icons indicate processes parallelized automatically by Nextflow.</p>
        </caption>
        <graphic xlink:href="lqae030fig1" position="float"/>
      </fig>
      <p>Before running VIBES, the user must install a software container system such as Docker (<xref rid="B42" ref-type="bibr">42</xref>) or Singularity/Apptainer (<xref rid="B43" ref-type="bibr">43</xref>) (usually the latter on HPC systems, where VIBES is likely to be utilized). These container systems enable the development and release of portable and reproducible software environments with fine-grained control over configuration and dependency conflicts while also retaining high performance. The user must also install the workflow management software Nextflow. Nextflow manages downloading and running containers, submits jobs to compute cluster job scheduling software (i.e. SLURM) or cloud computing architectures (i.e. AWS Batch), caches and checkpoints in-progress jobs in case of a crash, provides interpretable workflow status updates, runs on a wide variety of operating systems and hardware configurations, and can run VIBES locally as needed. After a user configures the workflow to run on their system and launches it, Nextflow requires no further user interaction to identify task dependencies, automatically maximizing parallelism by running as many tasks with satisfied dependencies as available resources allow.</p>
      <p>The VIBES release consists of a Nextflow workflow script, several helper scripts written in Python and Perl, JavaScript and HTML files that produce the visualizations, and a Docker image that manages the internal configuration and dependency map of multiple tools. VIBES software and workflow can be found at <ext-link xlink:href="https://github.com/TravisWheelerLab/VIBES" ext-link-type="uri">https://github.com/TravisWheelerLab/VIBES</ext-link>.</p>
    </sec>
    <sec id="SEC2-2">
      <title>VIBES components</title>
      <sec id="SEC2-2-1">
        <title>Prophage search component</title>
        <p>The primary component of the VIBES workflow is its prophage search. This component searches for user-provided query prophage sequences within bacterial genomes to identify prophage integrations. Identification of prophage within bacterial genomes is performed using a DNA sequence annotation tool, <italic toggle="yes">nhmmer</italic> (<xref rid="B40" ref-type="bibr">40</xref>), with default settings. User queries are supplied to <italic toggle="yes">nhmmer</italic> via either a multi-FASTA file containing single sequences or a Stockholm-formatted file containing multiple sequence alignments. When provided with multiple sequence alignment queries, VIBES automatically generates query profiles. Though <italic toggle="yes">nhmmer</italic> is slower than <italic toggle="yes">blastn</italic> (<xref rid="B44" ref-type="bibr">44</xref>), <italic toggle="yes">nhmmer</italic>’s improved sensitivity in the face of high sequence divergence and neutral mutation (<xref rid="B40" ref-type="bibr">40</xref>) is useful in the context of prophages, which can mutate at rates comparable to single-stranded RNA viruses during lytic replication (<xref rid="B45" ref-type="bibr">45</xref>) and may show substantial divergence from query sequences. In general, any matches to a query prophage that fail to meet an <italic toggle="yes">E</italic>-value threshold (1e−5 by default) are discarded. Multiple matches to a single target sequence are adjudicated using a method borrowed from the <italic toggle="yes">dfamscan</italic> adjudication script used in Dfam (<xref rid="B46" ref-type="bibr">46</xref>): when multiple hits are detected with overlap &gt;75%, the highest-scoring match is retained.</p>
        <p>Sequence annotation tools such as <italic toggle="yes">nhmmer</italic> frequently produce fragmented alignments when presented with sequences highly diverged from the query sequences, particularly when a match contains a large inserted or deleted element relative to its nearest query. As a result, single prophage integrations may be reported as several fragments that lie close to each other on a bacterial genome in <italic toggle="yes">nhmmer</italic> output. To address these potentially fragmented integrations, VIBES includes a post-processing step that examines every match detected on a single bacterial genome, looking for consecutive matches that satisfy all of the following potential fragments must match to the same query phage sequence (Figure <xref rid="F2" ref-type="fig">2A</xref>), occur in the same order on the bacterial genome as on the query (Figure <xref rid="F2" ref-type="fig">2B</xref>), be close to each other on the bacterial genome (Figure <xref rid="F2" ref-type="fig">2Ca</xref>) and overlap minimally on the query phage (Figure <xref rid="F2" ref-type="fig">2Cb</xref>). Gaps between two matches on the query prophage sequence are not penalized, as they may represent large deletions.</p>
        <fig position="float" id="F2">
          <label>Figure 2.</label>
          <caption>
            <p>All conditions that must be met for consecutive matches to be joined (assigned the same integration ID and displayed as one integration in visual output). (<bold>A</bold>) Joined candidates must be assigned to the same query phage. (<bold>B</bold>) Joined candidates must occur in the same order on both the query phage and target bacterial genomes. (<bold>Ca</bold>) Given a query phage genome of length <italic toggle="yes">n</italic>, a match that ends at position <italic toggle="yes">i</italic> on the bacterial genome and a consecutive match that begins at position <italic toggle="yes">j</italic>, two matches are considered near enough for fragment joining if |<italic toggle="yes">i</italic> − <italic toggle="yes">j</italic>| ≤ <italic toggle="yes">n</italic> × <italic toggle="yes">k</italic>, where <italic toggle="yes">k</italic> is a fragment gap threshold value set to 0.25 by default. (<bold>Cb</bold>) Given a fragment whose match to the query viral genome ends at position <italic toggle="yes">s</italic> and a consecutive fragment whose match to the query viral genome begins at position <italic toggle="yes">t</italic>, the fragments are joined only when |<italic toggle="yes">t</italic> − <italic toggle="yes">s</italic>| ≤ <italic toggle="yes">θ</italic>, where <italic toggle="yes">θ</italic> is a constant set to 50 by default. Large gaps between matches on the query prophages are not penalized, as they may represent large deletions.</p>
          </caption>
          <graphic xlink:href="lqae030fig2" position="float"/>
        </fig>
      </sec>
      <sec id="SEC2-2-2">
        <title>Gene annotation of both viral and bacterial genomes</title>
        <p>VIBES provides supplementary context to identification and investigation of prophage integration sites by identifying protein-coding genes in both full bacterial genomes and query prophage sequences. Each bacterial genome is annotated using the annotation tool Prokka (<xref rid="B37" ref-type="bibr">37</xref>) via StaPH-B’s Docker image (<xref rid="B47" ref-type="bibr">47</xref>), supporting gene annotation without requiring users to download or set up sequence databases. Like the prophage search component, each bacterial genome is annotated independently of other genomes, allowing Nextflow to fan out as many parallel Prokka annotation tasks as resources permit.</p>
        <p>VIBES also produces gene annotations for the user-provided prophage sequences with its viral protein-coding gene annotation component. This component uses a translated search tool, BATH (<xref rid="B41" ref-type="bibr">41</xref>), to search a viral protein database against prophage DNA sequences. Translated search tools like BATH do not penalize neutral mutations that change DNA sequences without modifying the encoded protein sequence, making them especially well suited to annotating sequences with high mutation rates, such as viral genomes. BATH’s translated search is also robust to frameshift-inducing insertions or deletions, which can confound other translated search tools. By default, VIBES uses the PHROGs v4 viral gene database (<xref rid="B38" ref-type="bibr">38</xref>) reformatted as a BATH-compatible HMM database, but users can substitute other amino acid sequence or HMM databases as desired.</p>
        <p>Although VIBES was developed with annotating prophage integrations in mind, it is primarily a framework for managing and parallelizing runs of <italic toggle="yes">nhmmer</italic>, Prokka and BATH with some prophage-annotation-specific features (the default PHROGs database is phage-specific and the VIBES-SODA visualization suite assumes query sequences are prophage). In particular, the prophage search component simply searches for matches to a query database (prophages by design) in a set of target genomes (bacteria by design) and can easily be repurposed by providing the workflow with a non-phage query sequence file and a set of non-prokaryotic genomes. Likewise, the Prokka bacterial gene annotation and BATH translated amino annotation components can be used to orchestrate massively parallel protein-coding sequence annotation, even on datasets where prophage integrations are not of interest.</p>
      </sec>
      <sec id="SEC2-2-3">
        <title>Interactive visual generation</title>
        <p>To facilitate further analysis and improve human readability of results, VIBES produces dynamic annotation visualizations in HTML files that can be opened in a web browser. These visuals depict prophage annotations, bacterial gene annotations and viral gene annotations. After all other workflow tasks are complete, VIBES generates a collection of HTML files, each of which contains a dynamic visualization built with the SODA sequence annotation visualization library (<xref rid="B48" ref-type="bibr">48</xref>). The visualizations provide an interactive representation of VIBES output, including prophage annotations, bacterial gene annotations and viral gene annotations. An output HTML file is generated for each input bacterial genome, each of which contains interactive annotation visualizations for its associated genome. The HTML files may be opened locally in a web browser, or they may be hosted on a web server. The generated interactive visualizations are described in the ‘Results’ section.</p>
      </sec>
    </sec>
    <sec id="SEC2-3">
      <title>Pf prophage search</title>
      <p>To demonstrate the utility of VIBES as a prophage identification tool, we searched 1072 <italic toggle="yes">Pseudomonas</italic> spp. isolate genomes for integrations of 178 Pf phage variants. <italic toggle="yes">Pseudomonas</italic> spp. genomes were acquired from the <italic toggle="yes">Pseudomonas</italic> Genome Database (v21.1) (<xref rid="B49" ref-type="bibr">49</xref>). Some records in the database were renamed to resolve characters that conflict with standard Bash commands, while three records contained no sequence information. Two of the three empty records were populated with data from GenBank, while the third was determined to be redundant and deleted (see Supplementary Data for details on modifications to data acquired from the <italic toggle="yes">Pseudomonas</italic> Genome Database). Phage sequence coordinates for 179 partial or complete Pf prophages were obtained from a study examining Pf prophage lineages (<xref rid="B12" ref-type="bibr">12</xref>). One hundred twenty-six <italic toggle="yes">P. aeruginosa</italic> genomes were downloaded using accession IDs provided in the study and the relevant sequences were extracted and assigned identifiers (see Supplementary Data for details). One phage sequence, labeled vs015, contained a substantial insertion that extended the length of the sequence to &gt;70 kb. Such a long query sequence requires a prohibitive amount of memory to search for, so vs015 was removed from our prophage database, leaving a total of 178 Pf phage query sequences derived from 126 <italic toggle="yes">P. aeruginosa</italic> genomes.</p>
      <p>Unless otherwise stated, analysis was conducted on the University of Arizona’s Puma HPC cluster on nodes that each contain 94 AMD EPYC 7642 cores and 512 GB of RAM.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Availability of data and scripts</title>
      <p>Supplementary materials documenting scripts and commands used are available at <ext-link xlink:href="https://github.com/TravisWheelerLab/VIBES-paper" ext-link-type="uri">https://github.com/TravisWheelerLab/VIBES-paper</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>Results</title>
    <sec id="SEC3-1">
      <title>Overview of VIBES output features</title>
      <sec id="SEC3-1-1">
        <title>Detected Pf prophages in bacterial genomes</title>
        <p>For each input bacterial genome, VIBES produces a TSV file describing each detected potential prophage sequence in the genome. The TSV fields include matching phage name, match <italic toggle="yes">E</italic>-value, score, match start and end positions on both query (phage) and target (bacterial) sequences, match strand, a match integration ID (see the ‘Prophage search component’ section) and a full-length field populated with True (full length) or False (partial). By default, a match is called full length if it is at least 70% the length of the best-matching prophage sequence, though this parameter can be modified by the user.</p>
      </sec>
      <sec id="SEC3-1-2">
        <title>Bacterial and viral gene annotations</title>
        <p>Annotations of genes within bacterial genomes are generated by Prokka with its default annotation databases and settings. For each bacterial genome, full Prokka output is saved and optionally compressed into a zipped tar archive. Annotations of genes within prophage genomes are output in their own TSV format files with fields identical to those produced for prophage annotations except the match ID field, which is excluded for phage gene annotations.</p>
      </sec>
      <sec id="SEC3-1-3">
        <title>Interactive HTML visual output</title>
        <p>After each workflow process has completed, VIBES produces the SODA-based HTML visualization files. The interactive representations of the workflow’s output allow users to investigate annotations in a bacterial genome and potential prophages with the following components.</p>
        <sec id="SEC3-1-3-1">
          <title>Bacterial chromosome plots (Figure <xref rid="F3" ref-type="fig">3B</xref>)</title>
          <p>The visualizations include both circular and linear representations of the bacterial chromosome. Both representations of the chromosome are marked with detected viral integrations (yellow, two outer circles) and bacterial genes (blue, two inner circles) to assist in analysis of integrations and phage landing sites. Hovering over a blue bacterial gene marker displays the name of the gene, while hovering over a yellow phage integration marker displays the name of the prophage. Users can select a viral integration to inspect it more closely (see the ‘Position occurrence plot’ section). Users can zoom in on the chromosome and click and drag to pan across the genome, making gene or integration annotations larger and easier to interact with; simultaneously, the currently visible portion of the genome is highlighted in gray across the chromosome along top of the page. The circular genome can be changed to a linear representation, and vice versa, by clicking the linear button below the interactive chromosome.</p>
          <fig position="float" id="F3">
            <label>Figure 3.</label>
            <caption>
              <p>Example VIBES interactive annotation visualization page, displaying a bacterial replicon with gene and prophage annotations, where the selected integration falls on the closest-matching viral genome, and viral gene annotations. (<bold>A</bold>) The full interactive visualization page. (<bold>B</bold>) The bacterial replicon plot includes two modes to represent a selected bacterial replicon: linear and circular, both marked with integration and gene annotations. (<bold>C</bold>) The position occurrence plot displays information about a selected integration, related integrations and prophage gene annotations. (<bold>D</bold>) The query phage gene annotation table contains detailed information about gene annotations on the closest-matching user-provided phage genome.</p>
            </caption>
            <graphic xlink:href="lqae030fig3" position="float"/>
          </fig>
        </sec>
        <sec id="SEC3-1-3-2">
          <title>Position occurrence plot (Figure <xref rid="F3" ref-type="fig">3C</xref>)</title>
          <p>To assist users in investigating patterns of phage integration, a position-specific occurrence plot is displayed for a selected integration. The selected integration may be changed by clicking on a corresponding glyph in the genome annotation chart or via the drop-down input at the top of the plot. The <italic toggle="yes">x</italic>-axis of the plot corresponds to each position (nucleotide) in a query phage sequence, while the <italic toggle="yes">y</italic>-axis displays a count at each position summing every occurrence of that position in every integration in the dataset, emphasizing regions of a phage sequence that most often integrate into host genomes. The blue shaded region along the <italic toggle="yes">x</italic>-axis displays the extent of the currently selected integration on the query sequence it matched to. Yellow bars over the <italic toggle="yes">x</italic>-axis show where any other integrations matching to the same query phage on the selected bacterial genome matched to the query, indicating regions of the phage integrated repeatedly into the same genome. The yellow bars indicating where other integrations of the same phage fall on the viral genome can be hidden by clicking the hide-related button located under the position occurrence plot. Under the <italic toggle="yes">x</italic>-axis, red bars display where viral gene annotations fall on the phage genome. Hovering over a viral gene annotation bar shows the name of the gene, while clicking on it highlights its row on the query phage gene annotation table.</p>
        </sec>
        <sec id="SEC3-1-3-3">
          <title>Query phage gene annotation table (Figure <xref rid="F3" ref-type="fig">3D</xref>)</title>
          <p>At the bottom of the visualization is a table of viral protein-coding gene annotations on query phage sequence most closely matching the currently selected integration. The phage gene annotation table contains a row for each annotated gene displaying the gene name, start and end positions on the query phage genome, annotation <italic toggle="yes">e</italic>-value, start and end positions relative to the reference gene amino acid sequence, and an alignment figure that visually depicts the extent of the match on the query phage sequence (blue line) compared to the reference amino acid sequence (red line).</p>
        </sec>
      </sec>
    </sec>
    <sec id="SEC3-2">
      <title>Comparison to other prophage annotation tools</title>
      <p>To assess performance of the workflow on known prophages, we ran VIBES against two reference <italic toggle="yes">P. aeruginosa</italic> genomes, PAO1 and UCBPP-PA14, which contain Pf4 (<xref rid="B50" ref-type="bibr">50</xref>) and Pf5 (<xref rid="B51" ref-type="bibr">51</xref>), respectively (Table <xref rid="tbl2" ref-type="table">2</xref>). Both genome sequences were obtained from the <italic toggle="yes">Pseudomonas</italic> Genome Database (<xref rid="B49" ref-type="bibr">49</xref>). Pf4 and Pf5 prophages were extracted from their hosts and provided to VIBES as queries. To assess the performance of VIBES relative to other prophage annotation tools, we submitted the genome sequences of PAO1 and UCBPP-PA14 to DBSCAN-SWA and PHASTEST through their web servers. We also ran geNomad (<xref rid="B35" ref-type="bibr">35</xref>) via its Docker container on the same HPC system VIBES was run on. All these tools use <italic toggle="yes">de novo</italic> annotation databases to annotate prophage sequences, and so are not directly comparable to VIBES, which depends on the user-provided query library. In this test, VIBES was given the perfect query sequence for each bacterial genome, so the evaluation is primarily useful to understand runtime; in general, VIBES will be as sensitive as the tool it uses to perform sequence alignment (<italic toggle="yes">nhmmer</italic>). We attempted to also submit both genomes to Prophage Hunter, but its web server is no longer available and issues encountered during local installation prevented its assessment.</p>
      <table-wrap position="float" id="tbl2">
        <label>Table 2.</label>
        <caption>
          <p>Summary tool runtime and results on PAO1 and UCBPP-PA14</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Tool</th>
              <th rowspan="1" colspan="1">PAO1 runtime (s)</th>
              <th rowspan="1" colspan="1">PA14 runtime (s)</th>
              <th rowspan="1" colspan="1">PAO1 prophage</th>
              <th rowspan="1" colspan="1">UCBPP-PA14 prophage</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">DBSCAN-SWA</td>
              <td rowspan="1" colspan="1">387</td>
              <td rowspan="1" colspan="1">414</td>
              <td rowspan="1" colspan="1">None</td>
              <td rowspan="1" colspan="1">None</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">geNomad</td>
              <td rowspan="1" colspan="1">266</td>
              <td rowspan="1" colspan="1">269</td>
              <td rowspan="1" colspan="1">1 caudovirus, 1 inovirus</td>
              <td rowspan="1" colspan="1">1 inovirus, 1 caudovirus</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PHASTEST</td>
              <td rowspan="1" colspan="1">536</td>
              <td rowspan="1" colspan="1">552</td>
              <td rowspan="1" colspan="1">1 intact YMC11, 1 intact Pf1</td>
              <td rowspan="1" colspan="1">1 incomplete YMC11, 1 intact Pf1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">VIBES</td>
              <td rowspan="1" colspan="1">880 (both)</td>
              <td rowspan="1" colspan="1">880 (both)</td>
              <td rowspan="1" colspan="1">1 full (Pf4)</td>
              <td rowspan="1" colspan="1">1 full (Pf5)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="T2TFN1">
            <p>VIBES was supplied with Pf4 and Pf5 as prophage queries.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>VIBES was run on default settings and set to filter out results &lt;1 kb. VIBES ran its searches in parallel, completing both in 880 s. As expected, VIBES recovers a full-length (13.6kb) Pf4 integration in PAO1 spanning from PA0714 to PA0729.1 (<xref rid="B50" ref-type="bibr">50</xref>) and a full-length Pf5 (10.9kb) integration in UCBPP-PA14 spanning from PA14_48870 to PA14_49040 (<xref rid="B51" ref-type="bibr">51</xref>). Notably, VIBES did not identify any other sequences in PAO1 or PA14 that matched to Pf4 or Pf5 and were long enough to pass a 1-kb filter. PHASTEST recovered one Pf1 integration, which it ranked intact, in a 15.8-kb window centered on the location of Pf4 in PAO1 and one Pf1 integration, ranked intact, in a 18.2-kb window centered on Pf5 in UCBPP-PA14. In PAO1, geNomad identified one inovirus spanning from PA0716.1 (<italic toggle="yes">pf4r</italic>) to PA0728.1 (<italic toggle="yes">pfiA</italic>) with a length of 9 kb, while in UCBPP-PA14 geNomad identified one inovirus with a length of 11 kb spanning from PA14_48850 to PA14_49010. DBSCAN-SWA did not detect prophages in either genome, but this could occur if its <italic toggle="yes">de novo</italic> annotation database does not contain queries homologous to Pf4 or Pf5.</p>
    </sec>
    <sec id="SEC3-3">
      <title>Application to <italic toggle="yes">Pseudomonas</italic> dataset</title>
      <p>To explore the utility of the VIBES workflow for identifying (possibly fragmented) phage integrations within bacterial isolates, we applied the workflow to a dataset composed of 1072 publicly available <italic toggle="yes">Pseudomonas</italic> spp. genomes obtained from the <italic toggle="yes">Pseudomonas</italic> Genome Database (v21.1) (<xref rid="B49" ref-type="bibr">49</xref>) and 178 Pf phage variants published in a study on Pf phage lineages (<xref rid="B12" ref-type="bibr">12</xref>). Nextflow reported that the prophage detection component of the workflow consumed 13 526.3 CPU hours across 2099 tasks in its prophage search component, 398.8 CPU hours across 1072 tasks in its bacterial gene annotation component and 49.7 CPU hours across 539 tasks in its viral gene annotation component, totaling 13 974.8 CPU hours consumed across a total of 3710 tasks (more details on resource usage can be found in Table <xref rid="tbl3" ref-type="table">3</xref>).</p>
      <table-wrap position="float" id="tbl3">
        <label>Table 3.</label>
        <caption>
          <p>Resource usage</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Component</th>
              <th rowspan="1" colspan="1">Total CPU hours</th>
              <th rowspan="1" colspan="1">Tasks run</th>
              <th rowspan="1" colspan="1">Most expensive process</th>
              <th rowspan="1" colspan="1">CPUs allocated</th>
              <th rowspan="1" colspan="1">Mean RAM</th>
              <th rowspan="1" colspan="1">Mean runtime (min)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Prophage search</td>
              <td align="center" rowspan="1" colspan="1">13 526.3</td>
              <td rowspan="1" colspan="1">2099</td>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">nhmmer</italic>
              </td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">36.8 GB</td>
              <td align="center" rowspan="1" colspan="1">412.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Bacterial gene annotation</td>
              <td align="center" rowspan="1" colspan="1">398.8</td>
              <td rowspan="1" colspan="1">1072</td>
              <td rowspan="1" colspan="1">Prokka</td>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">901.2 MB</td>
              <td align="center" rowspan="1" colspan="1">3.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Viral protein annotation</td>
              <td align="center" rowspan="1" colspan="1">49.7</td>
              <td rowspan="1" colspan="1">539</td>
              <td rowspan="1" colspan="1">BATH</td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">403.5 MB</td>
              <td align="center" rowspan="1" colspan="1">8.6</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="T3TFN1">
            <p>CPUs allocated, mean RAM and mean runtime all display values for the most expensive process in each component, as the computational cost of other elements was negligible. GB stands for gigabyte and MB stands for megabyte.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>In our input dataset of 1072 target <italic toggle="yes">Pseudomonas</italic> spp. genomes and 178 query Pf phage variants, VIBES reported 517 full-length Pf phage integrations and 51 386 partial hits. Of the 51 903 hits identified, 1398 were made up of two or more joined fragments. The vast majority of reported hits were &lt;1500 nucleotides in length. To reduce the incidence of short, ambiguous hits (which may have been matches to homologous bacterial genes or to regions of bacterial genome erroneously included on the terminal ends of prophage queries), we discarded any hit that mapped to a query prophage region containing &lt;2 genes annotated by the pipeline’s viral protein-coding gene component. The per-match gene count filter reduced the number of partial hits from 51 386 to 13 850 likely integrations with a mean and median length of 5095 and 2404 nucleotides, respectively (Figure <xref rid="F4" ref-type="fig">4</xref>). A histogram of gene counts per likely integration is available in Figure <xref rid="F5" ref-type="fig">5</xref>.</p>
      <fig position="float" id="F4">
        <label>Figure 4.</label>
        <caption>
          <p>Integration length bin plot. Counts of likely integrations binned by length, where joined integrations were summed together. The <italic toggle="yes">y</italic>-axis uses a log scale due to the large number of short integrations identified.</p>
        </caption>
        <graphic xlink:href="lqae030fig4" position="float"/>
      </fig>
      <fig position="float" id="F5">
        <label>Figure 5.</label>
        <caption>
          <p>Distribution of genes per match. Each bar represents how many matches (among the 51 903 total initially reported by the pipeline) mapped to a region on the query prophage annotated with the number of genes labeled on the <italic toggle="yes">x</italic>-axis. Thirteen thousand eight hundred fifty matches mapped to regions annotated with at least two viral protein-coding genes.</p>
        </caption>
        <graphic xlink:href="lqae030fig5" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>Discussion</title>
    <p>Here, we have introduced a new software package that conveniently manages the workflow of annotating an arbitrarily large number of bacterial genomes, with special emphasis on identification of prophages. The VIBES workflow produces output annotation TSVs that are easy to load into a spreadsheet viewer or parse programmatically, along with helpful interactive HTML visualizations that facilitate analysis of identified prophages, their landing sites and protein-coding genes on query phage sequences. VIBES also provides a basic framework for the management of general-purpose, large-scale annotation projects.</p>
    <sec id="SEC4-1">
      <title>Recommended usage</title>
      <p>VIBES is best suited to conduct large-scale analysis of relatively well-characterized prophages in cluster or cloud computing environments where parallelization of search processes yields the largest gains, and where the impact of its convenience features (prerequisite management with Docker/Singularity and job orchestration and automated job management via Nextflow) is most pronounced. We recommend that users source query prophage sequences from manually curated databases when possible, to avoid odd phage–bacteria boundary effects that can occur during <italic toggle="yes">de novo</italic> annotation. If users instead use predicted prophage regions as queries, we recommend that they use a higher minimum hit length threshold and make use of a script available in the VIBES repository, which filters out matches that do not contain an adjustable number of viral genes. VIBES is also well suited to large-scale analyses of homologous sequences shared between prophages and host genomes, given the high sensitivity of <italic toggle="yes">nhmmer</italic> search to distant homology (<xref rid="B40" ref-type="bibr">40</xref>) relative to other sequence similarity search software.</p>
      <p>VIBES may also be useful as a secondary step in <italic toggle="yes">de novo</italic> prophage annotation. Other tools, such as PHASTEST (<xref rid="B36" ref-type="bibr">36</xref>), are well suited to identifying unknown prophage integrations, but provide relatively coarse annotations. Once integrations have been coarsely identified and users have a notion of what prophage sequences to supply as queries, VIBES is relatively well suited to more precisely determine prophage strain and integration boundaries if prophage regions are provided as target sequences.</p>
    </sec>
    <sec id="SEC4-2">
      <title>Alternative use of the VIBES workflow</title>
      <p>To a large degree, VIBES is a workflow that coordinates sequence similarity search and bacterial genome annotation when supplied with target and query sequences. The only VIBES components that are specific to annotation of prophage in bacterial genomes are Prokka (<xref rid="B37" ref-type="bibr">37</xref>) annotation (which requires bacterial sequence input) and visualization generation (which assumes that targets are bacterial genomes and queries are prophages). The core input to VIBES is simply target sequences (in FASTA format) and queries (in either multi-FASTA for a set of sequences or Stockholm for a set of alignments). As a result, users are essentially free to use VIBES to conduct searches against nucleotide sequences as they see fit, so long as they specify query sequence type (DNA, RNA or amino) and disable incompatible workflow components through the VIBES configuration file.</p>
    </sec>
    <sec id="SEC4-3">
      <title>Future extensions</title>
      <p>Here, we briefly discuss some limitations of the VIBES workflow that could be addressed by future extensions of the workflow. These limitations are discussed in more detail in the VIBES documentation, available at <ext-link xlink:href="https://github.com/TravisWheelerLab/VIBES" ext-link-type="uri">https://github.com/TravisWheelerLab/VIBES</ext-link>.</p>
      <sec id="SEC4-3-1">
        <title><italic toggle="yes">Att</italic> site annotation</title>
        <p>A common signal of phage integration is the presence of attachment (<italic toggle="yes">att</italic>) sites, two copies of which—<italic toggle="yes">attP</italic> and <italic toggle="yes">attB</italic>, carried on the phage genome and bacterial genome, respectively—flank integrated prophages. These leave a distinctive signal of flanking direct repeats, but this signal is not detected or annotated in the initial VIBES release. As <italic toggle="yes">att</italic> sites are of interest to prophage researchers and are annotated by some prophage annotation tools (<xref rid="B26" ref-type="bibr">26</xref>,<xref rid="B52" ref-type="bibr">52</xref>), extending the VIBES feature set to include <italic toggle="yes">att</italic> site annotation is a high priority for future extensions of the workflow.</p>
      </sec>
      <sec id="SEC4-3-2">
        <title>Further prophage verification</title>
        <p>A major limitation of the VIBES workflow is its limited means of verifying that query prophage sequence represents a complete or partial prophage sequence, rather than a homologous non-phage region of the host genome. Currently, VIBES employs relatively simple methods of analyzing ambiguous sequences via its interactive visual output, its complete/partial classification and its per-match gene count filtering. While this may be desirable in some analyses, such as investigations of homologous regions shared by prophages and their hosts, addressing this limitation is a high priority for future iterations of the workflow.</p>
      </sec>
      <sec id="SEC4-3-3">
        <title><italic toggle="yes">De novo</italic> annotation support</title>
        <p>The default VIBES workflow does little to support <italic toggle="yes">de novo</italic> annotation of phage sequences, in which bacterial genomes are scanned for a broad range of reference prophages. Currently, to conduct such an analysis with VIBES, users would have to identify or construct a file containing a diverse set of known temperate phage genomes or multiple sequence alignments of related phage genomes. <italic toggle="yes">De novo</italic> annotation is further hampered by the lack of further analysis of potential prophages identified by VIBES, discussed above, which makes it more difficult to discern prophage regions from homologous bacterial sequences, especially when given a diverse set of temperate phage queries.</p>
      </sec>
      <sec id="SEC4-3-4">
        <title>Support for other search tools</title>
        <p>Though the <italic toggle="yes">nhmmer</italic> search algorithm is more sensitive to distant homology than other search algorithms (<xref rid="B40" ref-type="bibr">40</xref>), it is relatively computationally expensive. Indeed, viral sequence annotation tools that use HMMER search algorithms have been demonstrated to be among the slowest annotation techniques (<xref rid="B53" ref-type="bibr">53</xref>). This limitation can be addressed through the addition of a broader choice of sequence similarity search tools with less expected sensitivity and resource usage, such as LAST (<xref rid="B54" ref-type="bibr">54</xref>) or <italic toggle="yes">blastn</italic> (<xref rid="B44" ref-type="bibr">44</xref>).</p>
      </sec>
    </sec>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>Acknowledgements</title>
    <p>We are grateful to George Lesica for his early guidance in building Nextflow workflows. We also thank Elizabeth Burgener, Julie Portois and Paul Bollyky for sharing their data and analysis for use in evaluating VIBES during development. We also gratefully acknowledge the computational resources and expert administration provided by the University of Montana’s Griz Shared Computing Cluster (GSCC) and HPC resources supported by the University of Arizona TRIF (Technology and Research Initiative Fund), UITS (University Information Technology Services) and RII (Office of Research, Innovation and Impact), and maintained by the University of Arizona Research Technologies Department.</p>
    <p><italic toggle="yes">Author contributions</italic>: C.J.C. developed the workflow software and performed all experiments. J.W.R. developed the visualization software component. P.R.S. and A.K.S. guided phage-specific analysis requirements and data acquisition. T.J.W. designed the software and guided all research efforts. C.J.C and T.J.W. wrote the paper. All authors edited and approved the final manuscript.</p>
  </ack>
  <sec sec-type="data-availability" id="SEC5">
    <title>Data availability</title>
    <p>Supplementary materials documenting scripts and commands used are available at <ext-link xlink:href="https://github.com/TravisWheelerLab/VIBES-paper" ext-link-type="uri">https://github.com/TravisWheelerLab/VIBES-paper</ext-link>, <ext-link xlink:href="https://zenodo.org/doi/10.5281/zenodo.10826544" ext-link-type="uri">https://zenodo.org/doi/10.5281/zenodo.10826544</ext-link> (VIBES software) and <ext-link xlink:href="https://zenodo.org/doi/10.5281/zenodo.10826552" ext-link-type="uri">https://zenodo.org/doi/10.5281/zenodo.10826552</ext-link> (scripts/notes for article figures/tables).</p>
  </sec>
  <sec id="SEC7">
    <title>Funding</title>
    <p>National Institute of General Medical Sciences [R01GM132600 to C.J.C., J.W.R. and T.J.W.]; Department of Energy’s Office of Biological and Environmental Research [DE-SC0021216 to C.J.C., J.W.R. and T.J.W.]; National Institute of Allergy and Infectious Diseases [R01AI138981 to P.R.S. and A.K.S.].</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. The authors declare no conflicts of interest.</p>
  </sec>
  <ref-list id="REF1">
    <title>References</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Suttle</surname>  <given-names>C.A.</given-names></string-name></person-group>  <article-title>Marine viruses—major players in the global ecosystem</article-title>. <source>Nat. Rev. Microbiol.</source>  <year>2007</year>; <volume>5</volume>:<fpage>801</fpage>–<lpage>812</lpage>.<pub-id pub-id-type="pmid">17853907</pub-id>
</mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tock</surname>  <given-names>M.R.</given-names></string-name>, <string-name><surname>Dryden</surname>  <given-names>D.T.F.</given-names></string-name></person-group>  <article-title>The biology of restriction and anti-restriction</article-title>. <source>Curr. Opin. Microbiol.</source>  <year>2005</year>; <volume>8</volume>:<fpage>466</fpage>–<lpage>472</lpage>.<pub-id pub-id-type="pmid">15979932</pub-id>
</mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hille</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Richter</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Wong</surname>  <given-names>S.P.</given-names></string-name>, <string-name><surname>Bratovič</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Ressel</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Charpentier</surname>  <given-names>E.</given-names></string-name></person-group>  <article-title>The biology of CRISPR–Cas: backward and forward</article-title>. <source>Cell</source>. <year>2018</year>; <volume>172</volume>:<fpage>1239</fpage>–<lpage>1259</lpage>.<pub-id pub-id-type="pmid">29522745</pub-id>
</mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Georjon</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Bernheim</surname>  <given-names>A.</given-names></string-name></person-group>  <article-title>The highly diverse antiphage defence systems of bacteria</article-title>. <source>Nat. Rev. Microbiol.</source>  <year>2023</year>; <volume>21</volume>:<fpage>686</fpage>–<lpage>700</lpage>.<pub-id pub-id-type="pmid">37460672</pub-id>
</mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Warwick-Dugdale</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Buchholz</surname>  <given-names>H.H.</given-names></string-name>, <string-name><surname>Allen</surname>  <given-names>M.J.</given-names></string-name>, <string-name><surname>Temperton</surname>  <given-names>B.</given-names></string-name></person-group>  <article-title>Host-hijacking and planktonic piracy: how phages command the microbial high seas</article-title>. <source>Virol. J.</source>  <year>2019</year>; <volume>16</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">30709355</pub-id>
</mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Howard-Varona</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Hargreaves</surname>  <given-names>K.R.</given-names></string-name>, <string-name><surname>Abedon</surname>  <given-names>S.T.</given-names></string-name>, <string-name><surname>Sullivan</surname>  <given-names>M.B.</given-names></string-name></person-group>  <article-title>Lysogeny in nature: mechanisms, impact and ecology of temperate phages</article-title>. <source>ISME J.</source>  <year>2017</year>; <volume>11</volume>:<fpage>1511</fpage>–<lpage>1520</lpage>.<pub-id pub-id-type="pmid">28291233</pub-id>
</mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brüssow</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Canchaya</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Hardt</surname>  <given-names>W.-D.</given-names></string-name></person-group>  <article-title>Phages and the evolution of bacterial pathogens: from genomic rearrangements to lysogenic conversion</article-title>. <source>Microbiol. Mol. Biol. Rev.</source>  <year>2004</year>; <volume>68</volume>:<fpage>560</fpage>–<lpage>602</lpage>.<pub-id pub-id-type="pmid">15353570</pub-id>
</mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bondy-Denomy</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Qian</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Westra</surname>  <given-names>E.R.</given-names></string-name>, <string-name><surname>Buckling</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Guttman</surname>  <given-names>D.S.</given-names></string-name>, <string-name><surname>Davidson</surname>  <given-names>A.R.</given-names></string-name>, <string-name><surname>Maxwell</surname>  <given-names>K.L.</given-names></string-name></person-group>  <article-title>Prophages mediate defense against phage infection through diverse mechanisms</article-title>. <source>ISME J.</source>  <year>2016</year>; <volume>10</volume>:<fpage>2854</fpage>–<lpage>2866</lpage>.<pub-id pub-id-type="pmid">27258950</pub-id>
</mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wagner</surname>  <given-names>P.L.</given-names></string-name>, <string-name><surname>Waldor</surname>  <given-names>M.K.</given-names></string-name></person-group>  <article-title>Bacteriophage control of bacterial virulence</article-title>. <source>Infect. Immun.</source>  <year>2002</year>; <volume>70</volume>:<fpage>3985</fpage>–<lpage>3993</lpage>.<pub-id pub-id-type="pmid">12117903</pub-id>
</mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roux</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Krupovic</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Daly</surname>  <given-names>R.A.</given-names></string-name>, <string-name><surname>Borges</surname>  <given-names>A.L.</given-names></string-name>, <string-name><surname>Nayfach</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Schulz</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Sharrar</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Matheus Carnevali</surname>  <given-names>P.B.</given-names></string-name>, <string-name><surname>Cheng</surname>  <given-names>J.-F.</given-names></string-name>, <string-name><surname>Ivanova</surname>  <given-names>N.N.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Cryptic inoviruses revealed as pervasive in bacteria and archaea across Earth’s biomes</article-title>. <source>Nat. Microbiol.</source>  <year>2019</year>; <volume>4</volume>:<fpage>1895</fpage>–<lpage>1906</lpage>.<pub-id pub-id-type="pmid">31332386</pub-id>
</mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Secor</surname>  <given-names>P.R.</given-names></string-name>, <string-name><surname>Burgener</surname>  <given-names>E.B.</given-names></string-name>, <string-name><surname>Kinnersley</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Jennings</surname>  <given-names>L.K.</given-names></string-name>, <string-name><surname>Roman-Cruz</surname>  <given-names>V.</given-names></string-name>, <string-name><surname>Popescu</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Van Belleghem</surname>  <given-names>J.D.</given-names></string-name>, <string-name><surname>Haddock</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Copeland</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Michaels</surname>  <given-names>L.A.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Pf bacteriophage and their impact on <italic toggle="yes">Pseudomonas</italic> virulence, mammalian immunity, and chronic infections</article-title>. <source>Front. Immunol.</source>  <year>2020</year>; <volume>11</volume>:<fpage>244</fpage>.<pub-id pub-id-type="pmid">32153575</pub-id>
</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fiedoruk</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Zakrzewska</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Daniluk</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Piktel</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Chmielewska</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Bucki</surname>  <given-names>R.</given-names></string-name></person-group>  <article-title>Two lineages of <italic toggle="yes">Pseudomonas aeruginosa</italic> filamentous phages: structural uniformity over integration preferences</article-title>. <source>Genome Biol. Evol.</source>  <year>2020</year>; <volume>12</volume>:<fpage>1765</fpage>–<lpage>1781</lpage>.<pub-id pub-id-type="pmid">32658245</pub-id>
</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Knezevic</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Voet</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Lavigne</surname>  <given-names>R.</given-names></string-name></person-group>  <article-title>Prevalence of Pf1-like (pro)phage genetic elements among <italic toggle="yes">Pseudomonas aeruginosa</italic> isolates</article-title>. <source>Virology</source>. <year>2015</year>; <volume>483</volume>:<fpage>64</fpage>–<lpage>71</lpage>.<pub-id pub-id-type="pmid">25965796</pub-id>
</mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Tang</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Zeng</surname>  <given-names>Z.</given-names></string-name>, <string-name><surname>Guo</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>X.</given-names></string-name></person-group>  <article-title>Excisionase in Pf filamentous prophage controls lysis–lysogeny decision-making in <italic toggle="yes">Pseudomonas aeruginosa</italic></article-title>. <source>Mol. Microbiol.</source>  <year>2019</year>; <volume>111</volume>:<fpage>495</fpage>–<lpage>513</lpage>.<pub-id pub-id-type="pmid">30475408</pub-id>
</mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wei</surname>  <given-names>Q.</given-names></string-name>, <string-name><surname>Minh</surname>  <given-names>P.N.L.</given-names></string-name>, <string-name><surname>Dötsch</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Hildebrand</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Panmanee</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Elfarash</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Schulz</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Plaisance</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Charlier</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Hassett</surname>  <given-names>D.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Global regulation of gene expression by OxyR in an important human opportunistic pathogen</article-title>. <source>Nucleic Acids Res.</source>  <year>2012</year>; <volume>40</volume>:<fpage>4320</fpage>–<lpage>4333</lpage>.<pub-id pub-id-type="pmid">22275523</pub-id>
</mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Song</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Sheng</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Zhu</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Kim</surname>  <given-names>J.-S.</given-names></string-name>, <string-name><surname>Wood</surname>  <given-names>T.K.</given-names></string-name></person-group>  <article-title>Substrate binding protein DppA1 of ABC transporter DppBCDF increases biofilm formation in <italic toggle="yes">Pseudomonas aeruginosa</italic> by inhibiting Pf5 prophage lysis</article-title>. <source>Front. Microbiol.</source>  <year>2018</year>; <volume>9</volume>:<fpage>30</fpage>.<pub-id pub-id-type="pmid">29416528</pub-id>
</mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Castang</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Dove</surname>  <given-names>S.L.</given-names></string-name></person-group>  <article-title>Basis for the essentiality of H-NS family members in <italic toggle="yes">Pseudomonas aeruginosa</italic></article-title>. <source>J. Bacteriol.</source>  <year>2012</year>; <volume>194</volume>:<fpage>5101</fpage>–<lpage>5109</lpage>.<pub-id pub-id-type="pmid">22821971</pub-id>
</mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rice</surname>  <given-names>S.A.</given-names></string-name>, <string-name><surname>Tan</surname>  <given-names>C.H.</given-names></string-name>, <string-name><surname>Mikkelsen</surname>  <given-names>P.J.</given-names></string-name>, <string-name><surname>Kung</surname>  <given-names>V.</given-names></string-name>, <string-name><surname>Woo</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Tay</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Hauser</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>McDougald</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Webb</surname>  <given-names>J.S.</given-names></string-name>, <string-name><surname>Kjelleberg</surname>  <given-names>S.</given-names></string-name></person-group>  <article-title>The biofilm life cycle and virulence of <italic toggle="yes">Pseudomonas aeruginosa</italic> are dependent on a filamentous prophage</article-title>. <source>ISME J.</source>  <year>2009</year>; <volume>3</volume>:<fpage>271</fpage>–<lpage>282</lpage>.<pub-id pub-id-type="pmid">19005496</pub-id>
</mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarafder</surname>  <given-names>A.K.</given-names></string-name>, <string-name><surname>von Kügelgen</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Mellul</surname>  <given-names>A.J.</given-names></string-name>, <string-name><surname>Schulze</surname>  <given-names>U.</given-names></string-name>, <string-name><surname>Aarts</surname>  <given-names>D.G.A.L.</given-names></string-name>, <string-name><surname>Bharat</surname>  <given-names>T.A.M.</given-names></string-name></person-group>  <article-title>Phage liquid crystalline droplets form occlusive sheaths that encapsulate and protect infectious rod-shaped bacteria</article-title>. <source>Proc. Natl Acad. Sci. U.S.A.</source>  <year>2020</year>; <volume>117</volume>:<fpage>4724</fpage>–<lpage>4731</lpage>.<pub-id pub-id-type="pmid">32071243</pub-id>
</mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Secor</surname>  <given-names>P.R.</given-names></string-name>, <string-name><surname>Sweere</surname>  <given-names>J.M.</given-names></string-name>, <string-name><surname>Michaels</surname>  <given-names>L.A.</given-names></string-name>, <string-name><surname>Malkovskiy</surname>  <given-names>A.V.</given-names></string-name>, <string-name><surname>Lazzareschi</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Katznelson</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Rajadas</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Birnbaum</surname>  <given-names>M.E.</given-names></string-name>, <string-name><surname>Arrigoni</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Braun</surname>  <given-names>K.R.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Filamentous bacteriophage promote biofilm assembly and function</article-title>. <source>Cell Host Microbe</source>. <year>2015</year>; <volume>18</volume>:<fpage>549</fpage>–<lpage>559</lpage>.<pub-id pub-id-type="pmid">26567508</pub-id>
</mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burgener</surname>  <given-names>E.B.</given-names></string-name>, <string-name><surname>Sweere</surname>  <given-names>J.M.</given-names></string-name>, <string-name><surname>Bach</surname>  <given-names>M.S.</given-names></string-name>, <string-name><surname>Secor</surname>  <given-names>P.R.</given-names></string-name>, <string-name><surname>Haddock</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Jennings</surname>  <given-names>L.K.</given-names></string-name>, <string-name><surname>Marvig</surname>  <given-names>R.L.</given-names></string-name>, <string-name><surname>Johansen</surname>  <given-names>H.K.</given-names></string-name>, <string-name><surname>Rossi</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Cao</surname>  <given-names>X.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Filamentous bacteriophages are associated with chronic <italic toggle="yes">Pseudomonas</italic> lung infections and antibiotic resistance in cystic fibrosis</article-title>. <source>Sci. Transl. Med.</source>  <year>2019</year>; <volume>11</volume>:<fpage>eaau9748</fpage>.<pub-id pub-id-type="pmid">30996083</pub-id>
</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sweere</surname>  <given-names>J.M.</given-names></string-name>, <string-name><surname>Van Belleghem</surname>  <given-names>J.D.</given-names></string-name>, <string-name><surname>Ishak</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Bach</surname>  <given-names>M.S.</given-names></string-name>, <string-name><surname>Popescu</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Sunkari</surname>  <given-names>V.</given-names></string-name>, <string-name><surname>Kaber</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Manasherob</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Suh</surname>  <given-names>G.A.</given-names></string-name>, <string-name><surname>Cao</surname>  <given-names>X.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Bacteriophage trigger antiviral immunity and prevent clearance of bacterial infection</article-title>. <source>Science</source>. <year>2019</year>; <volume>363</volume>:<fpage>eaat9691</fpage>.<pub-id pub-id-type="pmid">30923196</pub-id>
</mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bach</surname>  <given-names>M.S.</given-names></string-name>, <string-name><surname>de Vries</surname>  <given-names>C.R.</given-names></string-name>, <string-name><surname>Khosravi</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Sweere</surname>  <given-names>J.M.</given-names></string-name>, <string-name><surname>Popescu</surname>  <given-names>M.C.</given-names></string-name>, <string-name><surname>Chen</surname>  <given-names>Q.</given-names></string-name>, <string-name><surname>Demirdjian</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Hargil</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Van Belleghem</surname>  <given-names>J.D.</given-names></string-name>, <string-name><surname>Kaber</surname>  <given-names>G.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Filamentous bacteriophage delays healing of <italic toggle="yes">Pseudomonas</italic>-infected wounds</article-title>. <source>Cell Rep. Med.</source>  <year>2022</year>; <volume>3</volume>:<fpage>100656</fpage>.<pub-id pub-id-type="pmid">35732145</pub-id>
</mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paez-Espino</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Eloe-Fadrosh</surname>  <given-names>E.A.</given-names></string-name>, <string-name><surname>Pavlopoulos</surname>  <given-names>G.A.</given-names></string-name>, <string-name><surname>Thomas</surname>  <given-names>A.D.</given-names></string-name>, <string-name><surname>Huntemann</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Mikhailova</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Rubin</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Ivanova</surname>  <given-names>N.N.</given-names></string-name>, <string-name><surname>Kyrpides</surname>  <given-names>N.C.</given-names></string-name></person-group>  <article-title>Uncovering Earth’s virome</article-title>. <source>Nature</source>. <year>2016</year>; <volume>536</volume>:<fpage>425</fpage>–<lpage>430</lpage>.<pub-id pub-id-type="pmid">27533034</pub-id>
</mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arndt</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Grant</surname>  <given-names>J.R.</given-names></string-name>, <string-name><surname>Marcu</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Sajed</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Pon</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Liang</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Wishart</surname>  <given-names>D.S.</given-names></string-name></person-group>  <article-title>PHASTER: a better, faster version of the PHAST phage search tool</article-title>. <source>Nucleic Acids Res.</source>  <year>2016</year>; <volume>44</volume>:<fpage>W16</fpage>–<lpage>W21</lpage>.<pub-id pub-id-type="pmid">27141966</pub-id>
</mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gan</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Si</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Yang</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Chen</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Ren</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Wu</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>F.</given-names></string-name></person-group>  <article-title>DBSCAN-SWA: an integrated tool for rapid prophage detection and annotation</article-title>. <source>Front. Genet.</source>  <year>2022</year>; <volume>13</volume>:<fpage>885048</fpage>.<pub-id pub-id-type="pmid">35518360</pub-id>
</mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roux</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Enault</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Hurwitz</surname>  <given-names>B.L.</given-names></string-name>, <string-name><surname>Sullivan</surname>  <given-names>M.B.</given-names></string-name></person-group>  <article-title>VirSorter: mining viral signal from microbial genomic data</article-title>. <source>PeerJ</source>. <year>2015</year>; <volume>3</volume>:<fpage>e985</fpage>.<pub-id pub-id-type="pmid">26038737</pub-id>
</mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Ahlgren</surname>  <given-names>N.A.</given-names></string-name>, <string-name><surname>Lu</surname>  <given-names>Y.Y.</given-names></string-name>, <string-name><surname>Fuhrman</surname>  <given-names>J.A.</given-names></string-name>, <string-name><surname>Sun</surname>  <given-names>F.</given-names></string-name></person-group>  <article-title>VirFinder: a novel <italic toggle="yes">k</italic>-mer based tool for identifying viral sequences from assembled metagenomic data</article-title>. <source>Microbiome</source>. <year>2017</year>; <volume>5</volume>:<fpage>69</fpage>.<pub-id pub-id-type="pmid">28683828</pub-id>
</mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Song</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Deng</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Ahlgren</surname>  <given-names>N.A.</given-names></string-name>, <string-name><surname>Fuhrman</surname>  <given-names>J.A.</given-names></string-name>, <string-name><surname>Li</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Xie</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Poplin</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Sun</surname>  <given-names>F.</given-names></string-name></person-group>  <article-title>Identifying viruses from metagenomic data using deep learning</article-title>. <source>Quant. Biol.</source>  <year>2020</year>; <volume>8</volume>:<fpage>64</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">34084563</pub-id>
</mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miao</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Hou</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>Y.</given-names></string-name></person-group>  <article-title>Virtifier: a deep learning-based identifier for viral sequences from metagenomes</article-title>. <source>Bioinformatics</source>. <year>2022</year>; <volume>38</volume>:<fpage>1216</fpage>–<lpage>1222</lpage>.<pub-id pub-id-type="pmid">34908121</pub-id>
</mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Bolduc</surname>  <given-names>B.</given-names></string-name>, <string-name><surname>Zayed</surname>  <given-names>A.A.</given-names></string-name>, <string-name><surname>Varsani</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Dominguez-Huerta</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Delmont</surname>  <given-names>T.O.</given-names></string-name>, <string-name><surname>Pratama</surname>  <given-names>A.A.</given-names></string-name>, <string-name><surname>Gazitúa</surname>  <given-names>M.C.</given-names></string-name>, <string-name><surname>Vik</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Sullivan</surname>  <given-names>M.B.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>VirSorter2: a multi-classifier, expert-guided approach to detect diverse DNA and RNA viruses</article-title>. <source>Microbiome</source>. <year>2021</year>; <volume>9</volume>:<fpage>37</fpage>.<pub-id pub-id-type="pmid">33522966</pub-id>
</mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kieft</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>Z.</given-names></string-name>, <string-name><surname>Anantharaman</surname>  <given-names>K.</given-names></string-name></person-group>  <article-title>VIBRANT: automated recovery, annotation and curation of microbial viruses, and evaluation of viral community function from genomic sequences</article-title>. <source>Microbiome</source>. <year>2020</year>; <volume>8</volume>:<fpage>90</fpage>.<pub-id pub-id-type="pmid">32522236</pub-id>
</mixed-citation>
    </ref>
    <ref id="B33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Sun</surname>  <given-names>H.-X.</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Cheng</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Peng</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Deng</surname>  <given-names>Z.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Hu</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>W.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Prophage Hunter: an integrative hunting tool for active prophages</article-title>. <source>Nucleic Acids Res.</source>  <year>2019</year>; <volume>47</volume>:<fpage>W74</fpage>–<lpage>W80</lpage>.<pub-id pub-id-type="pmid">31114893</pub-id>
</mixed-citation>
    </ref>
    <ref id="B34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amgarten</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Braga</surname>  <given-names>L.P.P.</given-names></string-name>, <string-name><surname>da Silva</surname>  <given-names>A.M.</given-names></string-name>, <string-name><surname>Setubal</surname>  <given-names>J.C.</given-names></string-name></person-group>  <article-title>MARVEL, a tool for prediction of bacteriophage sequences in metagenomic bins</article-title>. <source>Front. Genet.</source>  <year>2018</year>; <volume>9</volume>:<fpage>304</fpage>.<pub-id pub-id-type="pmid">30131825</pub-id>
</mixed-citation>
    </ref>
    <ref id="B35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Camargo</surname>  <given-names>A.P.</given-names></string-name>, <string-name><surname>Roux</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Schulz</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Babinski</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Xu</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Hu</surname>  <given-names>B.</given-names></string-name>, <string-name><surname>Chain</surname>  <given-names>P.S.G.</given-names></string-name>, <string-name><surname>Nayfach</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Kyrpides</surname>  <given-names>N.C.</given-names></string-name></person-group>  <article-title>Identification of mobile genetic elements with geNomad</article-title>. <source>Nat. Biotechnol.</source>  <year>2023</year>; <pub-id pub-id-type="doi">10.1038/s41587-023-01953-y</pub-id>.</mixed-citation>
    </ref>
    <ref id="B36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wishart</surname>  <given-names>D.S.</given-names></string-name>, <string-name><surname>Han</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Saha</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Oler</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Peters</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Grant</surname>  <given-names>J.R.</given-names></string-name>, <string-name><surname>Stothard</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Gautam</surname>  <given-names>V.</given-names></string-name></person-group>  <article-title>PHASTEST: faster than PHASTER, better than PHAST</article-title>. <source>Nucleic Acids Res.</source>  <year>2023</year>; <volume>51</volume>:<fpage>W443</fpage>–<lpage>W450</lpage>.<pub-id pub-id-type="pmid">37194694</pub-id>
</mixed-citation>
    </ref>
    <ref id="B37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Seemann</surname>  <given-names>T.</given-names></string-name></person-group>  <article-title>Prokka: rapid prokaryotic genome annotation</article-title>. <source>Bioinformatics</source>. <year>2014</year>; <volume>30</volume>:<fpage>2068</fpage>–<lpage>2069</lpage>.<pub-id pub-id-type="pmid">24642063</pub-id>
</mixed-citation>
    </ref>
    <ref id="B38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Terzian</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Olo Ndela</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Galiez</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Lossouarn</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Pérez Bucio</surname>  <given-names>R.E.</given-names></string-name>, <string-name><surname>Mom</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Toussaint</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Petit</surname>  <given-names>M.-A.</given-names></string-name>, <string-name><surname>Enault</surname>  <given-names>F.</given-names></string-name></person-group>  <article-title>PHROG: families of prokaryotic virus proteins clustered using remote homology</article-title>. <source>NAR Genom. Bioinform.</source>  <year>2021</year>; <volume>3</volume>:<fpage>lqab067</fpage>.<pub-id pub-id-type="pmid">34377978</pub-id>
</mixed-citation>
    </ref>
    <ref id="B39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Di Tommaso</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Chatzou</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Floden</surname>  <given-names>E.W.</given-names></string-name>, <string-name><surname>Barja</surname>  <given-names>P.P.</given-names></string-name>, <string-name><surname>Palumbo</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Notredame</surname>  <given-names>C.</given-names></string-name></person-group>  <article-title>Nextflow enables reproducible computational workflows</article-title>. <source>Nat. Biotechnol.</source>  <year>2017</year>; <volume>35</volume>:<fpage>316</fpage>–<lpage>319</lpage>.<pub-id pub-id-type="pmid">28398311</pub-id>
</mixed-citation>
    </ref>
    <ref id="B40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wheeler</surname>  <given-names>T.J.</given-names></string-name>, <string-name><surname>Eddy</surname>  <given-names>S.R.</given-names></string-name></person-group>  <article-title>nhmmer: DNA homology search with profile HMMs</article-title>. <source>Bioinformatics</source>. <year>2013</year>; <volume>29</volume>:<fpage>2487</fpage>–<lpage>2489</lpage>.<pub-id pub-id-type="pmid">23842809</pub-id>
</mixed-citation>
    </ref>
    <ref id="B41">
      <label>41.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Krause</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Shands</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Wheeler</surname>  <given-names>T.J.</given-names></string-name></person-group>  <article-title>Sensitive and error-tolerant annotation of protein-coding DNA with BATH</article-title>. <year>2024</year>; <comment>bioRxiv doi:</comment><comment>01 January 2024, preprint: not peer reviewed</comment><pub-id pub-id-type="doi">10.1101/2023.12.31.573773</pub-id>.</mixed-citation>
    </ref>
    <ref id="B42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Merkel</surname>  <given-names>D.</given-names></string-name></person-group>  <article-title>Docker: lightweight Linux containers for consistent development and deployment</article-title>. <source>Linux J.</source>  <year>2014</year>; <volume>2014</volume>:<fpage>2</fpage>.</mixed-citation>
    </ref>
    <ref id="B43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kurtzer</surname>  <given-names>G.M.</given-names></string-name>, <string-name><surname>Sochat</surname>  <given-names>V.</given-names></string-name>, <string-name><surname>Bauer</surname>  <given-names>M.W.</given-names></string-name></person-group>  <article-title>Singularity: scientific containers for mobility of compute</article-title>. <source>PLoS One</source>. <year>2017</year>; <volume>12</volume>:<fpage>e0177459</fpage>.<pub-id pub-id-type="pmid">28494014</pub-id>
</mixed-citation>
    </ref>
    <ref id="B44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Camacho</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Coulouris</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Avagyan</surname>  <given-names>V.</given-names></string-name>, <string-name><surname>Ma</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Papadopoulos</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Bealer</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Madden</surname>  <given-names>T.L.</given-names></string-name></person-group>  <article-title>BLAST+: architecture and applications</article-title>. <source>BMC Bioinformatics</source>. <year>2009</year>; <volume>10</volume>:<fpage>421</fpage>.<pub-id pub-id-type="pmid">20003500</pub-id>
</mixed-citation>
    </ref>
    <ref id="B45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McElroy</surname>  <given-names>K.E.</given-names></string-name>, <string-name><surname>Hui</surname>  <given-names>J.G.K.</given-names></string-name>, <string-name><surname>Woo</surname>  <given-names>J.K.K.</given-names></string-name>, <string-name><surname>Luk</surname>  <given-names>A.W.S.</given-names></string-name>, <string-name><surname>Webb</surname>  <given-names>J.S.</given-names></string-name>, <string-name><surname>Kjelleberg</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Rice</surname>  <given-names>S.A.</given-names></string-name>, <string-name><surname>Thomas</surname>  <given-names>T.</given-names></string-name></person-group>  <article-title>Strain-specific parallel evolution drives short-term diversification during <italic toggle="yes">Pseudomonas aeruginosa</italic> biofilm formation</article-title>. <source>Proc. Natl Acad. Sci. U.S.A.</source>  <year>2014</year>; <volume>111</volume>:<fpage>E1419</fpage>–<lpage>E1427</lpage>.<pub-id pub-id-type="pmid">24706926</pub-id>
</mixed-citation>
    </ref>
    <ref id="B46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wheeler</surname>  <given-names>T.J.</given-names></string-name>, <string-name><surname>Clements</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Eddy</surname>  <given-names>S.R.</given-names></string-name>, <string-name><surname>Hubley</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Jones</surname>  <given-names>T.A.</given-names></string-name>, <string-name><surname>Jurka</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Smit</surname>  <given-names>A.F.A.</given-names></string-name>, <string-name><surname>Finn</surname>  <given-names>R.D.</given-names></string-name></person-group>  <article-title>Dfam: a database of repetitive DNA based on profile hidden Markov models</article-title>. <source>Nucleic Acids Res.</source>  <year>2012</year>; <volume>41</volume>:<fpage>D70</fpage>–<lpage>D82</lpage>.<pub-id pub-id-type="pmid">23203985</pub-id>
</mixed-citation>
    </ref>
    <ref id="B47">
      <label>47.</label>
      <mixed-citation publication-type="other"><collab>State Public Health Bioinformatics Community</collab>  <article-title>Prokka Docker image</article-title>. <year>2023</year>; <uri xlink:href="https://hub.docker.com/r/staphb/prokka/dockerfile">https://hub.docker.com/r/staphb/prokka/dockerfile</uri>.</mixed-citation>
    </ref>
    <ref id="B48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roddy</surname>  <given-names>J.W.</given-names></string-name>, <string-name><surname>Lesica</surname>  <given-names>G.T.</given-names></string-name>, <string-name><surname>Wheeler</surname>  <given-names>T.J.</given-names></string-name></person-group>  <article-title>SODA: a TypeScript/JavaScript library for visualizing biological sequence annotation</article-title>. <source>NAR Genom. Bioinform.</source>  <year>2022</year>; <volume>4</volume>:<fpage>lqac077</fpage>.<pub-id pub-id-type="pmid">36212708</pub-id>
</mixed-citation>
    </ref>
    <ref id="B49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Winsor</surname>  <given-names>G.L.</given-names></string-name>, <string-name><surname>Griffiths</surname>  <given-names>E.J.</given-names></string-name>, <string-name><surname>Lo</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Dhillon</surname>  <given-names>B.K.</given-names></string-name>, <string-name><surname>Shay</surname>  <given-names>J.A.</given-names></string-name>, <string-name><surname>Brinkman</surname>  <given-names>F.S.L.</given-names></string-name></person-group>  <article-title>Enhanced annotations and features for comparing thousands of <italic toggle="yes">Pseudomonas</italic> genomes in the <italic toggle="yes">Pseudomonas</italic> Genome Database</article-title>. <source>Nucleic Acids Res.</source>  <year>2016</year>; <volume>44</volume>:<fpage>D646</fpage>–<lpage>D653</lpage>.<pub-id pub-id-type="pmid">26578582</pub-id>
</mixed-citation>
    </ref>
    <ref id="B50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Webb</surname>  <given-names>J.S.</given-names></string-name>, <string-name><surname>Lau</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Kjelleberg</surname>  <given-names>S.</given-names></string-name></person-group>  <article-title>Bacteriophage and phenotypic variation in <italic toggle="yes">Pseudomonas aeruginosa</italic> biofilm development</article-title>. <source>J. Bacteriol.</source>  <year>2004</year>; <volume>186</volume>:<fpage>8066</fpage>–<lpage>8073</lpage>.<pub-id pub-id-type="pmid">15547279</pub-id>
</mixed-citation>
    </ref>
    <ref id="B51">
      <label>51.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mooij</surname>  <given-names>M.J.</given-names></string-name>, <string-name><surname>Drenkard</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Llamas</surname>  <given-names>M.A.</given-names></string-name>, <string-name><surname>Vandenbroucke-Grauls</surname>  <given-names>C.M.J.E.</given-names></string-name>, <string-name><surname>Savelkoul</surname>  <given-names>P.H.M.</given-names></string-name>, <string-name><surname>Ausubel</surname>  <given-names>F.M.</given-names></string-name>, <string-name><surname>Bitter</surname>  <given-names>W.</given-names></string-name></person-group>  <article-title>Characterization of the integrated filamentous phage Pf5 and its involvement in small-colony formation</article-title>. <source>Microbiology</source>. <year>2007</year>; <volume>153</volume>:<fpage>1790</fpage>–<lpage>1798</lpage>.<pub-id pub-id-type="pmid">17526836</pub-id>
</mixed-citation>
    </ref>
    <ref id="B52">
      <label>52.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Sun</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Guo</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>X.</given-names></string-name></person-group>  <article-title>Prophage Tracer: precisely tracing prophages in prokaryotic genomes using overlapping split-read alignment</article-title>. <source>Nucleic Acids Res.</source>  <year>2021</year>; <volume>49</volume>:<fpage>e128</fpage>.<pub-id pub-id-type="pmid">34551431</pub-id>
</mixed-citation>
    </ref>
    <ref id="B53">
      <label>53.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roach</surname>  <given-names>M.J.</given-names></string-name>, <string-name><surname>McNair</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Michalczyk</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Giles</surname>  <given-names>S.K.</given-names></string-name>, <string-name><surname>Inglis</surname>  <given-names>L.K.</given-names></string-name>, <string-name><surname>Pargin</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Barylski</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Roux</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Decewicz</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Edwards</surname>  <given-names>R.A.</given-names></string-name></person-group>  <article-title>Philympics 2021: prophage predictions perplex programs</article-title>. <source>F1000Research</source>. <year>2022</year>; <volume>10</volume>:<fpage>758</fpage>.</mixed-citation>
    </ref>
    <ref id="B54">
      <label>54.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiełbasa</surname>  <given-names>S.M.</given-names></string-name>, <string-name><surname>Wan</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Sato</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Horton</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Frith</surname>  <given-names>M.C.</given-names></string-name></person-group>  <article-title>Adaptive seeds tame genomic sequence comparison</article-title>. <source>Genome Res.</source>  <year>2011</year>; <volume>21</volume>:<fpage>487</fpage>–<lpage>493</lpage>.<pub-id pub-id-type="pmid">21209072</pub-id>
</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">nargab</journal-id>
    <journal-title-group>
      <journal-title>NAR Genomics and Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2631-9268</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10993291</article-id>
    <article-id pub-id-type="pmid">38584872</article-id>
    <article-id pub-id-type="doi">10.1093/nargab/lqae030</article-id>
    <article-id pub-id-type="publisher-id">lqae030</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00030</subject>
        <subject>AcademicSubjects/SCI00980</subject>
        <subject>AcademicSubjects/SCI01060</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Pipelines and Workflows for Biological Data Analysis</subject>
      </subj-group>
      <subj-group subj-group-type="category-oup-series">
        <subject>Editor's Choice</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VIBES: a workflow for annotating and visualizing viral sequences integrated into bacterial genomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8328-7339</contrib-id>
        <name>
          <surname>Copeland</surname>
          <given-names>Conner J</given-names>
        </name>
        <aff><institution>Division of Biological Sciences, University of Montana</institution>, Missoula, MT, 59812, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6055-7706</contrib-id>
        <name>
          <surname>Roddy</surname>
          <given-names>Jack W</given-names>
        </name>
        <aff><institution>R. Ken Coit College of Pharmacy, University of Arizona</institution>, Tucson, AZ, 85721, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schmidt</surname>
          <given-names>Amelia K</given-names>
        </name>
        <aff><institution>Division of Biological Sciences, University of Montana</institution>, Missoula, MT, 59812, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7123-3037</contrib-id>
        <name>
          <surname>Secor</surname>
          <given-names>Patrick R</given-names>
        </name>
        <aff><institution>Division of Biological Sciences, University of Montana</institution>, Missoula, MT, 59812, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2004-1785</contrib-id>
        <name>
          <surname>Wheeler</surname>
          <given-names>Travis J</given-names>
        </name>
        <!--twheeler@arizona.edu-->
        <aff><institution>R. Ken Coit College of Pharmacy, University of Arizona</institution>, Tucson, AZ, 85721, <country country="US">USA</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +1 520 621 6449; Email: <email>twheeler@arizona.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-04-04">
      <day>04</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <volume>6</volume>
    <issue>2</issue>
    <elocation-id>lqae030</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>5</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press on behalf of NAR Genomics and Bioinformatics.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="lqae030.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Bacteriophages are viruses that infect bacteria. Many bacteriophages integrate their genomes into the bacterial chromosome and become prophages. Prophages may substantially burden or benefit host bacteria fitness, acting in some cases as parasites and in others as mutualists. Some prophages have been demonstrated to increase host virulence. The increasing ease of bacterial genome sequencing provides an opportunity to deeply explore prophage prevalence and insertion sites. Here we present VIBES (Viral Integrations in Bacterial genomES), a workflow intended to automate prophage annotation in complete bacterial genome sequences. VIBES provides additional context to prophage annotations by annotating bacterial genes and viral proteins in user-provided bacterial and viral genomes. The VIBES pipeline is implemented as a Nextflow-driven workflow, providing a simple, unified interface for execution on local, cluster and cloud computing environments. For each step of the pipeline, a container including all necessary software dependencies is provided. VIBES produces results in simple tab-separated format and generates intuitive and interactive visualizations for data exploration. Despite VIBES’s primary emphasis on prophage annotation, its generic alignment-based design allows it to be deployed as a general-purpose sequence similarity search manager. We demonstrate the utility of the VIBES prophage annotation workflow by searching for 178 Pf phage genomes across 1072 <italic toggle="yes">Pseudomonas</italic> spp. genomes.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of General Medical Sciences</institution>
            <institution-id institution-id-type="DOI">10.13039/100000057</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM132600</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Office of Biological and Environmental Research</institution>
            <institution-id institution-id-type="DOI">10.13039/100006206</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>DE-SC0021216</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
            <institution-id institution-id-type="DOI">10.13039/100000060</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01AI138981</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>Introduction</title>
    <p>Bacteriophages (phages), viruses that infect bacteria, are as ubiquitous as their hosts. They are found everywhere that we find populations of bacteria, from forest soils and the oceans to hydrothermal springs and the human gut. Phages pose a significant threat to bacteria: in marine ecosystems, up to one-third of bacteria are killed by phages every day (<xref rid="B1" ref-type="bibr">1</xref>). The strong pressure exerted by the threat of phage infection has led bacteria to evolve antiphage defense systems. Restriction–modification systems (<xref rid="B2" ref-type="bibr">2</xref>) and CRISPR–Cas systems (<xref rid="B3" ref-type="bibr">3</xref>) rely on sensing and degrading invading nucleic acids and are among the most widespread antiphage systems; however, numerous additional antiphage defense systems utilizing diverse mechanisms have recently been discovered (<xref rid="B4" ref-type="bibr">4</xref>). Likewise, phages have evolved to become adept manipulators of host metabolism, allowing them to evade host defenses or improve conditions for viral replication (<xref rid="B5" ref-type="bibr">5</xref>).</p>
    <p>Phages can be purely parasitic (lytic) and replicate at the expense of their bacterial hosts. However, in addition to lytic replication, temperate phages can alternatively undergo lysogenic replication in which the phage genome typically integrates into the host chromosome as a prophage. Temperate phages are common: approximately half of sequenced bacterial genomes contain at least one prophage (<xref rid="B6" ref-type="bibr">6</xref>). Prophages are replicated each time the host cell divides. Consequentially, prophages benefit from thriving hosts, which can incentivize the development of mutualistic phage–host relationships. Many prophages encode factors that benefit their hosts (<xref rid="B7" ref-type="bibr">7</xref>). For example, some phages carry genes that promote resistance to infection from competing viruses (<xref rid="B8" ref-type="bibr">8</xref>), while other phages encode virulence factors, aiding host pathogenicity (<xref rid="B9" ref-type="bibr">9</xref>).</p>
    <p>Many bacterial species are lysogenized by filamentous phages in the Inoviridae family (<xref rid="B10" ref-type="bibr">10</xref>). The opportunistic pathogen <italic toggle="yes">Pseudomonas aeruginosa</italic> is frequently lysogenized by an inovirus called Pf (<xref rid="B11" ref-type="bibr">11–13</xref>). Pf prophages maintain lysogeny by repressing transcription of their excisionase (<xref rid="B14" ref-type="bibr">14</xref>). In response to oxidative stress (<xref rid="B15" ref-type="bibr">15</xref>), nutrient limitation (<xref rid="B16" ref-type="bibr">16</xref>) or other factors (<xref rid="B17" ref-type="bibr">17</xref>), the Pf prophage excises from the chromosome and Pf virion replication is initiated. Pf virion replication plays a role in biofilm development by lysing cells in the center of a colony, releasing DNA that adds to biofilm structural integrity (<xref rid="B18" ref-type="bibr">18</xref>). Pf virions themselves also act as structural components in <italic toggle="yes">P. aeruginosa</italic> biofilms, protecting bacteria from desiccation and antibiotics (<xref rid="B19" ref-type="bibr">19</xref>,<xref rid="B20" ref-type="bibr">20</xref>). Indeed, the presence of Pf virions in the airways of cystic fibrosis patients is associated with antibiotic resistance (<xref rid="B21" ref-type="bibr">21</xref>). Additionally, Pf virions are immunomodulatory and induce maladaptive antiviral immune responses that promote infection initiation (<xref rid="B22" ref-type="bibr">22</xref>) and interfere with wound healing by inhibiting keratinocyte migration (<xref rid="B23" ref-type="bibr">23</xref>).</p>
    <p>The important and varied roles of prophages in bacterial communities—parasites, mutualists and sometimes pathogenicity aides—motivate the development of high-quality software methods that identify and classify their integrations into bacterial genomes. Generally, phage sequence annotation tools are designed to annotate either prophage in whole bacterial genome sequence or phage genome fragments in metagenomic datasets. Most recent approaches focus on annotation in a metagenomic context, as metagenomic datasets have proven to be rich sources of previously unknown viral sequences (<xref rid="B10" ref-type="bibr">10</xref>,<xref rid="B24" ref-type="bibr">24</xref>). Viral annotation, particularly in metagenomic contexts, requires tools to strike a balance between sensitivity and speed. High sensitivity is necessary to overcome high mutation rates in viral proteins combined with an increased risk of sequencing error stemming from the low abundance of viral sequences in most metagenomic datasets. Meanwhile, reasonable labeling speed is required when annotating large datasets. As a result of these constraints, viral annotation software has generally converged on a few techniques for identifying viral sequences: sequence similarity search against large databases of viral genomes (<xref rid="B25" ref-type="bibr">25–27</xref>), machine learning approaches based on statistical features such as <italic toggle="yes">k</italic>-mer frequencies, with a recent emphasis on neural networks (<xref rid="B28" ref-type="bibr">28–30</xref>), or some combination of both approaches (<xref rid="B31" ref-type="bibr">31–35</xref>). Viral annotation tools with a focus on prophage annotation in whole genome sequence [DBSCAN-SWA (<xref rid="B26" ref-type="bibr">26</xref>), PHASTEST (<xref rid="B36" ref-type="bibr">36</xref>), Prophage Hunter (<xref rid="B33" ref-type="bibr">33</xref>)] typically include visual summaries that increase the legibility of their output. Both DBSCAN-SWA and Prophage Hunter are available as stand-alone software that can be run by researchers seeking to conduct large-scale analysis in a cluster or cloud computing environment, but require installation of prerequisite software and manual creation of job submission scripts to run in high-performance computing (HPC) environments. This significantly increases the minimum computational skillset necessary to conduct large-scale analysis of prophage integrated into complete bacterial genome sequences. PHASTEST somewhat alleviates this by offering a containerized version of their approach, reducing the need to install prerequisites. However, managing widescale execution of containerized PHASTEST instances in an HPC environment through job submission scripts or other customized approaches is still left to end users.</p>
    <p>Here, we introduce and describe VIBES (Viral Integrations in Bacterial genomES), an automated command line workflow for annotation of bacterial genomes that emphasizes identification of prophage integrations. VIBES supplements standard bacterial gene labeling with in-depth analysis of prophage integrations, producing machine- and human-readable text output files coupled with interactive HTML visualizations that facilitate further analysis of output data. VIBES is designed to</p>
    <list list-type="bullet">
      <list-item>
        <p>annotate prophages with high sensitivity;</p>
      </list-item>
      <list-item>
        <p>annotate bacterial genes on input genomes, using Prokka (<xref rid="B37" ref-type="bibr">37</xref>);</p>
      </list-item>
      <list-item>
        <p>annotate viral genes within input viral genomes, using the PHROGs database (<xref rid="B38" ref-type="bibr">38</xref>);</p>
      </list-item>
      <list-item>
        <p>accept a potentially large number of bacterial genomes and candidate phage genomes as input;</p>
      </list-item>
      <list-item>
        <p>substantially reduce prerequisite installation and automatically manage distribution of workload to cluster/cloud/local resources; and</p>
      </list-item>
      <list-item>
        <p>create interactive HTML visuals that display the above, as well as display which regions that map to user input prophages are most prevalent among all input bacterial genomes.</p>
      </list-item>
    </list>
    <p>To the best of our knowledge, VIBES is the first prophage annotation software approach that includes output visualizations designed to facilitate investigation of patterns of prophage integration and shared prophage–host homology across entire target bacterial genome datasets. VIBES is also the first prophage annotation approach that is engineered to enable efficient, massively parallelized prophage search and genome annotation by end users on a wide variety of hardware and computing environments. VIBES also has the capacity to serve as manager of massively parallelized sequence similarity searches, even if the queries and targets of those searches are not prophages and bacteria, respectively.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>Materials and methods</title>
    <sec id="SEC2-1">
      <title>Implementation</title>
      <p>VIBES is an automated prophage search workflow that uses containerized components coordinated by the Nextflow workflow management software (<xref rid="B39" ref-type="bibr">39</xref>) to produce output tab-separated value (TSV) annotation tables accompanied by interactive HTML files that summarize matches to prophage sequences. To annotate prophage integrations, VIBES is provided with an input FASTA file containing all prophage sequences to seek and a collection of bacterial genomes in FASTA format to annotate with prophages; it performs search using the software <italic toggle="yes">nhmmer</italic> (<xref rid="B40" ref-type="bibr">40</xref>). To annotate bacterial protein-coding genes, ribosomal RNA and transfer RNA, VIBES uses Prokka (<xref rid="B37" ref-type="bibr">37</xref>). To annotate query prophage protein-coding genes, VIBES uses the BATH protein-coding DNA annotation software (<xref rid="B41" ref-type="bibr">41</xref>) and the PHROGs v4 prokaryotic viral protein database (<xref rid="B38" ref-type="bibr">38</xref>) by default. The user can optionally substitute their own viral protein database. Figure <xref rid="F1" ref-type="fig">1</xref> provides a visual representation of the three independent annotation workflows, run in parallel and managed by VIBES, that produce bacterial gene annotations, viral sequence integrations and viral gene annotations. Table <xref rid="tbl1" ref-type="table">1</xref> lists the tools and databases managed by the VIBES Docker container.</p>
      <table-wrap position="float" id="tbl1">
        <label>Table 1.</label>
        <caption>
          <p>Dependencies managed by VIBES Docker container</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Tool</th>
              <th rowspan="1" colspan="1">Purpose</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">BATH (<xref rid="B41" ref-type="bibr">41</xref>)</td>
              <td rowspan="1" colspan="1">Annotation of protein-coding DNA on query prophage</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic toggle="yes">nhmmer</italic> (<xref rid="B40" ref-type="bibr">40</xref>)</td>
              <td rowspan="1" colspan="1">DNA-to-DNA identification of prophages on bacterial genomes</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Prokka (<xref rid="B37" ref-type="bibr">37</xref>)</td>
              <td rowspan="1" colspan="1">Bacterial genome annotation</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>VIBES workflow schematic. It displays how input data move through the VIBES annotation workflow. Bacterial gene annotation processes are shown in yellow (left track), prophage annotation processes are shown in green (center track), viral gene annotation processes are shown in blue (right track) and visualization processes are shown in red (bottom square). The annotation processes are independent of each other. Stacked icons indicate processes parallelized automatically by Nextflow.</p>
        </caption>
        <graphic xlink:href="lqae030fig1" position="float"/>
      </fig>
      <p>Before running VIBES, the user must install a software container system such as Docker (<xref rid="B42" ref-type="bibr">42</xref>) or Singularity/Apptainer (<xref rid="B43" ref-type="bibr">43</xref>) (usually the latter on HPC systems, where VIBES is likely to be utilized). These container systems enable the development and release of portable and reproducible software environments with fine-grained control over configuration and dependency conflicts while also retaining high performance. The user must also install the workflow management software Nextflow. Nextflow manages downloading and running containers, submits jobs to compute cluster job scheduling software (i.e. SLURM) or cloud computing architectures (i.e. AWS Batch), caches and checkpoints in-progress jobs in case of a crash, provides interpretable workflow status updates, runs on a wide variety of operating systems and hardware configurations, and can run VIBES locally as needed. After a user configures the workflow to run on their system and launches it, Nextflow requires no further user interaction to identify task dependencies, automatically maximizing parallelism by running as many tasks with satisfied dependencies as available resources allow.</p>
      <p>The VIBES release consists of a Nextflow workflow script, several helper scripts written in Python and Perl, JavaScript and HTML files that produce the visualizations, and a Docker image that manages the internal configuration and dependency map of multiple tools. VIBES software and workflow can be found at <ext-link xlink:href="https://github.com/TravisWheelerLab/VIBES" ext-link-type="uri">https://github.com/TravisWheelerLab/VIBES</ext-link>.</p>
    </sec>
    <sec id="SEC2-2">
      <title>VIBES components</title>
      <sec id="SEC2-2-1">
        <title>Prophage search component</title>
        <p>The primary component of the VIBES workflow is its prophage search. This component searches for user-provided query prophage sequences within bacterial genomes to identify prophage integrations. Identification of prophage within bacterial genomes is performed using a DNA sequence annotation tool, <italic toggle="yes">nhmmer</italic> (<xref rid="B40" ref-type="bibr">40</xref>), with default settings. User queries are supplied to <italic toggle="yes">nhmmer</italic> via either a multi-FASTA file containing single sequences or a Stockholm-formatted file containing multiple sequence alignments. When provided with multiple sequence alignment queries, VIBES automatically generates query profiles. Though <italic toggle="yes">nhmmer</italic> is slower than <italic toggle="yes">blastn</italic> (<xref rid="B44" ref-type="bibr">44</xref>), <italic toggle="yes">nhmmer</italic>’s improved sensitivity in the face of high sequence divergence and neutral mutation (<xref rid="B40" ref-type="bibr">40</xref>) is useful in the context of prophages, which can mutate at rates comparable to single-stranded RNA viruses during lytic replication (<xref rid="B45" ref-type="bibr">45</xref>) and may show substantial divergence from query sequences. In general, any matches to a query prophage that fail to meet an <italic toggle="yes">E</italic>-value threshold (1e−5 by default) are discarded. Multiple matches to a single target sequence are adjudicated using a method borrowed from the <italic toggle="yes">dfamscan</italic> adjudication script used in Dfam (<xref rid="B46" ref-type="bibr">46</xref>): when multiple hits are detected with overlap &gt;75%, the highest-scoring match is retained.</p>
        <p>Sequence annotation tools such as <italic toggle="yes">nhmmer</italic> frequently produce fragmented alignments when presented with sequences highly diverged from the query sequences, particularly when a match contains a large inserted or deleted element relative to its nearest query. As a result, single prophage integrations may be reported as several fragments that lie close to each other on a bacterial genome in <italic toggle="yes">nhmmer</italic> output. To address these potentially fragmented integrations, VIBES includes a post-processing step that examines every match detected on a single bacterial genome, looking for consecutive matches that satisfy all of the following potential fragments must match to the same query phage sequence (Figure <xref rid="F2" ref-type="fig">2A</xref>), occur in the same order on the bacterial genome as on the query (Figure <xref rid="F2" ref-type="fig">2B</xref>), be close to each other on the bacterial genome (Figure <xref rid="F2" ref-type="fig">2Ca</xref>) and overlap minimally on the query phage (Figure <xref rid="F2" ref-type="fig">2Cb</xref>). Gaps between two matches on the query prophage sequence are not penalized, as they may represent large deletions.</p>
        <fig position="float" id="F2">
          <label>Figure 2.</label>
          <caption>
            <p>All conditions that must be met for consecutive matches to be joined (assigned the same integration ID and displayed as one integration in visual output). (<bold>A</bold>) Joined candidates must be assigned to the same query phage. (<bold>B</bold>) Joined candidates must occur in the same order on both the query phage and target bacterial genomes. (<bold>Ca</bold>) Given a query phage genome of length <italic toggle="yes">n</italic>, a match that ends at position <italic toggle="yes">i</italic> on the bacterial genome and a consecutive match that begins at position <italic toggle="yes">j</italic>, two matches are considered near enough for fragment joining if |<italic toggle="yes">i</italic> − <italic toggle="yes">j</italic>| ≤ <italic toggle="yes">n</italic> × <italic toggle="yes">k</italic>, where <italic toggle="yes">k</italic> is a fragment gap threshold value set to 0.25 by default. (<bold>Cb</bold>) Given a fragment whose match to the query viral genome ends at position <italic toggle="yes">s</italic> and a consecutive fragment whose match to the query viral genome begins at position <italic toggle="yes">t</italic>, the fragments are joined only when |<italic toggle="yes">t</italic> − <italic toggle="yes">s</italic>| ≤ <italic toggle="yes">θ</italic>, where <italic toggle="yes">θ</italic> is a constant set to 50 by default. Large gaps between matches on the query prophages are not penalized, as they may represent large deletions.</p>
          </caption>
          <graphic xlink:href="lqae030fig2" position="float"/>
        </fig>
      </sec>
      <sec id="SEC2-2-2">
        <title>Gene annotation of both viral and bacterial genomes</title>
        <p>VIBES provides supplementary context to identification and investigation of prophage integration sites by identifying protein-coding genes in both full bacterial genomes and query prophage sequences. Each bacterial genome is annotated using the annotation tool Prokka (<xref rid="B37" ref-type="bibr">37</xref>) via StaPH-B’s Docker image (<xref rid="B47" ref-type="bibr">47</xref>), supporting gene annotation without requiring users to download or set up sequence databases. Like the prophage search component, each bacterial genome is annotated independently of other genomes, allowing Nextflow to fan out as many parallel Prokka annotation tasks as resources permit.</p>
        <p>VIBES also produces gene annotations for the user-provided prophage sequences with its viral protein-coding gene annotation component. This component uses a translated search tool, BATH (<xref rid="B41" ref-type="bibr">41</xref>), to search a viral protein database against prophage DNA sequences. Translated search tools like BATH do not penalize neutral mutations that change DNA sequences without modifying the encoded protein sequence, making them especially well suited to annotating sequences with high mutation rates, such as viral genomes. BATH’s translated search is also robust to frameshift-inducing insertions or deletions, which can confound other translated search tools. By default, VIBES uses the PHROGs v4 viral gene database (<xref rid="B38" ref-type="bibr">38</xref>) reformatted as a BATH-compatible HMM database, but users can substitute other amino acid sequence or HMM databases as desired.</p>
        <p>Although VIBES was developed with annotating prophage integrations in mind, it is primarily a framework for managing and parallelizing runs of <italic toggle="yes">nhmmer</italic>, Prokka and BATH with some prophage-annotation-specific features (the default PHROGs database is phage-specific and the VIBES-SODA visualization suite assumes query sequences are prophage). In particular, the prophage search component simply searches for matches to a query database (prophages by design) in a set of target genomes (bacteria by design) and can easily be repurposed by providing the workflow with a non-phage query sequence file and a set of non-prokaryotic genomes. Likewise, the Prokka bacterial gene annotation and BATH translated amino annotation components can be used to orchestrate massively parallel protein-coding sequence annotation, even on datasets where prophage integrations are not of interest.</p>
      </sec>
      <sec id="SEC2-2-3">
        <title>Interactive visual generation</title>
        <p>To facilitate further analysis and improve human readability of results, VIBES produces dynamic annotation visualizations in HTML files that can be opened in a web browser. These visuals depict prophage annotations, bacterial gene annotations and viral gene annotations. After all other workflow tasks are complete, VIBES generates a collection of HTML files, each of which contains a dynamic visualization built with the SODA sequence annotation visualization library (<xref rid="B48" ref-type="bibr">48</xref>). The visualizations provide an interactive representation of VIBES output, including prophage annotations, bacterial gene annotations and viral gene annotations. An output HTML file is generated for each input bacterial genome, each of which contains interactive annotation visualizations for its associated genome. The HTML files may be opened locally in a web browser, or they may be hosted on a web server. The generated interactive visualizations are described in the ‘Results’ section.</p>
      </sec>
    </sec>
    <sec id="SEC2-3">
      <title>Pf prophage search</title>
      <p>To demonstrate the utility of VIBES as a prophage identification tool, we searched 1072 <italic toggle="yes">Pseudomonas</italic> spp. isolate genomes for integrations of 178 Pf phage variants. <italic toggle="yes">Pseudomonas</italic> spp. genomes were acquired from the <italic toggle="yes">Pseudomonas</italic> Genome Database (v21.1) (<xref rid="B49" ref-type="bibr">49</xref>). Some records in the database were renamed to resolve characters that conflict with standard Bash commands, while three records contained no sequence information. Two of the three empty records were populated with data from GenBank, while the third was determined to be redundant and deleted (see Supplementary Data for details on modifications to data acquired from the <italic toggle="yes">Pseudomonas</italic> Genome Database). Phage sequence coordinates for 179 partial or complete Pf prophages were obtained from a study examining Pf prophage lineages (<xref rid="B12" ref-type="bibr">12</xref>). One hundred twenty-six <italic toggle="yes">P. aeruginosa</italic> genomes were downloaded using accession IDs provided in the study and the relevant sequences were extracted and assigned identifiers (see Supplementary Data for details). One phage sequence, labeled vs015, contained a substantial insertion that extended the length of the sequence to &gt;70 kb. Such a long query sequence requires a prohibitive amount of memory to search for, so vs015 was removed from our prophage database, leaving a total of 178 Pf phage query sequences derived from 126 <italic toggle="yes">P. aeruginosa</italic> genomes.</p>
      <p>Unless otherwise stated, analysis was conducted on the University of Arizona’s Puma HPC cluster on nodes that each contain 94 AMD EPYC 7642 cores and 512 GB of RAM.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Availability of data and scripts</title>
      <p>Supplementary materials documenting scripts and commands used are available at <ext-link xlink:href="https://github.com/TravisWheelerLab/VIBES-paper" ext-link-type="uri">https://github.com/TravisWheelerLab/VIBES-paper</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>Results</title>
    <sec id="SEC3-1">
      <title>Overview of VIBES output features</title>
      <sec id="SEC3-1-1">
        <title>Detected Pf prophages in bacterial genomes</title>
        <p>For each input bacterial genome, VIBES produces a TSV file describing each detected potential prophage sequence in the genome. The TSV fields include matching phage name, match <italic toggle="yes">E</italic>-value, score, match start and end positions on both query (phage) and target (bacterial) sequences, match strand, a match integration ID (see the ‘Prophage search component’ section) and a full-length field populated with True (full length) or False (partial). By default, a match is called full length if it is at least 70% the length of the best-matching prophage sequence, though this parameter can be modified by the user.</p>
      </sec>
      <sec id="SEC3-1-2">
        <title>Bacterial and viral gene annotations</title>
        <p>Annotations of genes within bacterial genomes are generated by Prokka with its default annotation databases and settings. For each bacterial genome, full Prokka output is saved and optionally compressed into a zipped tar archive. Annotations of genes within prophage genomes are output in their own TSV format files with fields identical to those produced for prophage annotations except the match ID field, which is excluded for phage gene annotations.</p>
      </sec>
      <sec id="SEC3-1-3">
        <title>Interactive HTML visual output</title>
        <p>After each workflow process has completed, VIBES produces the SODA-based HTML visualization files. The interactive representations of the workflow’s output allow users to investigate annotations in a bacterial genome and potential prophages with the following components.</p>
        <sec id="SEC3-1-3-1">
          <title>Bacterial chromosome plots (Figure <xref rid="F3" ref-type="fig">3B</xref>)</title>
          <p>The visualizations include both circular and linear representations of the bacterial chromosome. Both representations of the chromosome are marked with detected viral integrations (yellow, two outer circles) and bacterial genes (blue, two inner circles) to assist in analysis of integrations and phage landing sites. Hovering over a blue bacterial gene marker displays the name of the gene, while hovering over a yellow phage integration marker displays the name of the prophage. Users can select a viral integration to inspect it more closely (see the ‘Position occurrence plot’ section). Users can zoom in on the chromosome and click and drag to pan across the genome, making gene or integration annotations larger and easier to interact with; simultaneously, the currently visible portion of the genome is highlighted in gray across the chromosome along top of the page. The circular genome can be changed to a linear representation, and vice versa, by clicking the linear button below the interactive chromosome.</p>
          <fig position="float" id="F3">
            <label>Figure 3.</label>
            <caption>
              <p>Example VIBES interactive annotation visualization page, displaying a bacterial replicon with gene and prophage annotations, where the selected integration falls on the closest-matching viral genome, and viral gene annotations. (<bold>A</bold>) The full interactive visualization page. (<bold>B</bold>) The bacterial replicon plot includes two modes to represent a selected bacterial replicon: linear and circular, both marked with integration and gene annotations. (<bold>C</bold>) The position occurrence plot displays information about a selected integration, related integrations and prophage gene annotations. (<bold>D</bold>) The query phage gene annotation table contains detailed information about gene annotations on the closest-matching user-provided phage genome.</p>
            </caption>
            <graphic xlink:href="lqae030fig3" position="float"/>
          </fig>
        </sec>
        <sec id="SEC3-1-3-2">
          <title>Position occurrence plot (Figure <xref rid="F3" ref-type="fig">3C</xref>)</title>
          <p>To assist users in investigating patterns of phage integration, a position-specific occurrence plot is displayed for a selected integration. The selected integration may be changed by clicking on a corresponding glyph in the genome annotation chart or via the drop-down input at the top of the plot. The <italic toggle="yes">x</italic>-axis of the plot corresponds to each position (nucleotide) in a query phage sequence, while the <italic toggle="yes">y</italic>-axis displays a count at each position summing every occurrence of that position in every integration in the dataset, emphasizing regions of a phage sequence that most often integrate into host genomes. The blue shaded region along the <italic toggle="yes">x</italic>-axis displays the extent of the currently selected integration on the query sequence it matched to. Yellow bars over the <italic toggle="yes">x</italic>-axis show where any other integrations matching to the same query phage on the selected bacterial genome matched to the query, indicating regions of the phage integrated repeatedly into the same genome. The yellow bars indicating where other integrations of the same phage fall on the viral genome can be hidden by clicking the hide-related button located under the position occurrence plot. Under the <italic toggle="yes">x</italic>-axis, red bars display where viral gene annotations fall on the phage genome. Hovering over a viral gene annotation bar shows the name of the gene, while clicking on it highlights its row on the query phage gene annotation table.</p>
        </sec>
        <sec id="SEC3-1-3-3">
          <title>Query phage gene annotation table (Figure <xref rid="F3" ref-type="fig">3D</xref>)</title>
          <p>At the bottom of the visualization is a table of viral protein-coding gene annotations on query phage sequence most closely matching the currently selected integration. The phage gene annotation table contains a row for each annotated gene displaying the gene name, start and end positions on the query phage genome, annotation <italic toggle="yes">e</italic>-value, start and end positions relative to the reference gene amino acid sequence, and an alignment figure that visually depicts the extent of the match on the query phage sequence (blue line) compared to the reference amino acid sequence (red line).</p>
        </sec>
      </sec>
    </sec>
    <sec id="SEC3-2">
      <title>Comparison to other prophage annotation tools</title>
      <p>To assess performance of the workflow on known prophages, we ran VIBES against two reference <italic toggle="yes">P. aeruginosa</italic> genomes, PAO1 and UCBPP-PA14, which contain Pf4 (<xref rid="B50" ref-type="bibr">50</xref>) and Pf5 (<xref rid="B51" ref-type="bibr">51</xref>), respectively (Table <xref rid="tbl2" ref-type="table">2</xref>). Both genome sequences were obtained from the <italic toggle="yes">Pseudomonas</italic> Genome Database (<xref rid="B49" ref-type="bibr">49</xref>). Pf4 and Pf5 prophages were extracted from their hosts and provided to VIBES as queries. To assess the performance of VIBES relative to other prophage annotation tools, we submitted the genome sequences of PAO1 and UCBPP-PA14 to DBSCAN-SWA and PHASTEST through their web servers. We also ran geNomad (<xref rid="B35" ref-type="bibr">35</xref>) via its Docker container on the same HPC system VIBES was run on. All these tools use <italic toggle="yes">de novo</italic> annotation databases to annotate prophage sequences, and so are not directly comparable to VIBES, which depends on the user-provided query library. In this test, VIBES was given the perfect query sequence for each bacterial genome, so the evaluation is primarily useful to understand runtime; in general, VIBES will be as sensitive as the tool it uses to perform sequence alignment (<italic toggle="yes">nhmmer</italic>). We attempted to also submit both genomes to Prophage Hunter, but its web server is no longer available and issues encountered during local installation prevented its assessment.</p>
      <table-wrap position="float" id="tbl2">
        <label>Table 2.</label>
        <caption>
          <p>Summary tool runtime and results on PAO1 and UCBPP-PA14</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Tool</th>
              <th rowspan="1" colspan="1">PAO1 runtime (s)</th>
              <th rowspan="1" colspan="1">PA14 runtime (s)</th>
              <th rowspan="1" colspan="1">PAO1 prophage</th>
              <th rowspan="1" colspan="1">UCBPP-PA14 prophage</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">DBSCAN-SWA</td>
              <td rowspan="1" colspan="1">387</td>
              <td rowspan="1" colspan="1">414</td>
              <td rowspan="1" colspan="1">None</td>
              <td rowspan="1" colspan="1">None</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">geNomad</td>
              <td rowspan="1" colspan="1">266</td>
              <td rowspan="1" colspan="1">269</td>
              <td rowspan="1" colspan="1">1 caudovirus, 1 inovirus</td>
              <td rowspan="1" colspan="1">1 inovirus, 1 caudovirus</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PHASTEST</td>
              <td rowspan="1" colspan="1">536</td>
              <td rowspan="1" colspan="1">552</td>
              <td rowspan="1" colspan="1">1 intact YMC11, 1 intact Pf1</td>
              <td rowspan="1" colspan="1">1 incomplete YMC11, 1 intact Pf1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">VIBES</td>
              <td rowspan="1" colspan="1">880 (both)</td>
              <td rowspan="1" colspan="1">880 (both)</td>
              <td rowspan="1" colspan="1">1 full (Pf4)</td>
              <td rowspan="1" colspan="1">1 full (Pf5)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="T2TFN1">
            <p>VIBES was supplied with Pf4 and Pf5 as prophage queries.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>VIBES was run on default settings and set to filter out results &lt;1 kb. VIBES ran its searches in parallel, completing both in 880 s. As expected, VIBES recovers a full-length (13.6kb) Pf4 integration in PAO1 spanning from PA0714 to PA0729.1 (<xref rid="B50" ref-type="bibr">50</xref>) and a full-length Pf5 (10.9kb) integration in UCBPP-PA14 spanning from PA14_48870 to PA14_49040 (<xref rid="B51" ref-type="bibr">51</xref>). Notably, VIBES did not identify any other sequences in PAO1 or PA14 that matched to Pf4 or Pf5 and were long enough to pass a 1-kb filter. PHASTEST recovered one Pf1 integration, which it ranked intact, in a 15.8-kb window centered on the location of Pf4 in PAO1 and one Pf1 integration, ranked intact, in a 18.2-kb window centered on Pf5 in UCBPP-PA14. In PAO1, geNomad identified one inovirus spanning from PA0716.1 (<italic toggle="yes">pf4r</italic>) to PA0728.1 (<italic toggle="yes">pfiA</italic>) with a length of 9 kb, while in UCBPP-PA14 geNomad identified one inovirus with a length of 11 kb spanning from PA14_48850 to PA14_49010. DBSCAN-SWA did not detect prophages in either genome, but this could occur if its <italic toggle="yes">de novo</italic> annotation database does not contain queries homologous to Pf4 or Pf5.</p>
    </sec>
    <sec id="SEC3-3">
      <title>Application to <italic toggle="yes">Pseudomonas</italic> dataset</title>
      <p>To explore the utility of the VIBES workflow for identifying (possibly fragmented) phage integrations within bacterial isolates, we applied the workflow to a dataset composed of 1072 publicly available <italic toggle="yes">Pseudomonas</italic> spp. genomes obtained from the <italic toggle="yes">Pseudomonas</italic> Genome Database (v21.1) (<xref rid="B49" ref-type="bibr">49</xref>) and 178 Pf phage variants published in a study on Pf phage lineages (<xref rid="B12" ref-type="bibr">12</xref>). Nextflow reported that the prophage detection component of the workflow consumed 13 526.3 CPU hours across 2099 tasks in its prophage search component, 398.8 CPU hours across 1072 tasks in its bacterial gene annotation component and 49.7 CPU hours across 539 tasks in its viral gene annotation component, totaling 13 974.8 CPU hours consumed across a total of 3710 tasks (more details on resource usage can be found in Table <xref rid="tbl3" ref-type="table">3</xref>).</p>
      <table-wrap position="float" id="tbl3">
        <label>Table 3.</label>
        <caption>
          <p>Resource usage</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Component</th>
              <th rowspan="1" colspan="1">Total CPU hours</th>
              <th rowspan="1" colspan="1">Tasks run</th>
              <th rowspan="1" colspan="1">Most expensive process</th>
              <th rowspan="1" colspan="1">CPUs allocated</th>
              <th rowspan="1" colspan="1">Mean RAM</th>
              <th rowspan="1" colspan="1">Mean runtime (min)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Prophage search</td>
              <td align="center" rowspan="1" colspan="1">13 526.3</td>
              <td rowspan="1" colspan="1">2099</td>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">nhmmer</italic>
              </td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">36.8 GB</td>
              <td align="center" rowspan="1" colspan="1">412.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Bacterial gene annotation</td>
              <td align="center" rowspan="1" colspan="1">398.8</td>
              <td rowspan="1" colspan="1">1072</td>
              <td rowspan="1" colspan="1">Prokka</td>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">901.2 MB</td>
              <td align="center" rowspan="1" colspan="1">3.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Viral protein annotation</td>
              <td align="center" rowspan="1" colspan="1">49.7</td>
              <td rowspan="1" colspan="1">539</td>
              <td rowspan="1" colspan="1">BATH</td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">403.5 MB</td>
              <td align="center" rowspan="1" colspan="1">8.6</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="T3TFN1">
            <p>CPUs allocated, mean RAM and mean runtime all display values for the most expensive process in each component, as the computational cost of other elements was negligible. GB stands for gigabyte and MB stands for megabyte.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>In our input dataset of 1072 target <italic toggle="yes">Pseudomonas</italic> spp. genomes and 178 query Pf phage variants, VIBES reported 517 full-length Pf phage integrations and 51 386 partial hits. Of the 51 903 hits identified, 1398 were made up of two or more joined fragments. The vast majority of reported hits were &lt;1500 nucleotides in length. To reduce the incidence of short, ambiguous hits (which may have been matches to homologous bacterial genes or to regions of bacterial genome erroneously included on the terminal ends of prophage queries), we discarded any hit that mapped to a query prophage region containing &lt;2 genes annotated by the pipeline’s viral protein-coding gene component. The per-match gene count filter reduced the number of partial hits from 51 386 to 13 850 likely integrations with a mean and median length of 5095 and 2404 nucleotides, respectively (Figure <xref rid="F4" ref-type="fig">4</xref>). A histogram of gene counts per likely integration is available in Figure <xref rid="F5" ref-type="fig">5</xref>.</p>
      <fig position="float" id="F4">
        <label>Figure 4.</label>
        <caption>
          <p>Integration length bin plot. Counts of likely integrations binned by length, where joined integrations were summed together. The <italic toggle="yes">y</italic>-axis uses a log scale due to the large number of short integrations identified.</p>
        </caption>
        <graphic xlink:href="lqae030fig4" position="float"/>
      </fig>
      <fig position="float" id="F5">
        <label>Figure 5.</label>
        <caption>
          <p>Distribution of genes per match. Each bar represents how many matches (among the 51 903 total initially reported by the pipeline) mapped to a region on the query prophage annotated with the number of genes labeled on the <italic toggle="yes">x</italic>-axis. Thirteen thousand eight hundred fifty matches mapped to regions annotated with at least two viral protein-coding genes.</p>
        </caption>
        <graphic xlink:href="lqae030fig5" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>Discussion</title>
    <p>Here, we have introduced a new software package that conveniently manages the workflow of annotating an arbitrarily large number of bacterial genomes, with special emphasis on identification of prophages. The VIBES workflow produces output annotation TSVs that are easy to load into a spreadsheet viewer or parse programmatically, along with helpful interactive HTML visualizations that facilitate analysis of identified prophages, their landing sites and protein-coding genes on query phage sequences. VIBES also provides a basic framework for the management of general-purpose, large-scale annotation projects.</p>
    <sec id="SEC4-1">
      <title>Recommended usage</title>
      <p>VIBES is best suited to conduct large-scale analysis of relatively well-characterized prophages in cluster or cloud computing environments where parallelization of search processes yields the largest gains, and where the impact of its convenience features (prerequisite management with Docker/Singularity and job orchestration and automated job management via Nextflow) is most pronounced. We recommend that users source query prophage sequences from manually curated databases when possible, to avoid odd phage–bacteria boundary effects that can occur during <italic toggle="yes">de novo</italic> annotation. If users instead use predicted prophage regions as queries, we recommend that they use a higher minimum hit length threshold and make use of a script available in the VIBES repository, which filters out matches that do not contain an adjustable number of viral genes. VIBES is also well suited to large-scale analyses of homologous sequences shared between prophages and host genomes, given the high sensitivity of <italic toggle="yes">nhmmer</italic> search to distant homology (<xref rid="B40" ref-type="bibr">40</xref>) relative to other sequence similarity search software.</p>
      <p>VIBES may also be useful as a secondary step in <italic toggle="yes">de novo</italic> prophage annotation. Other tools, such as PHASTEST (<xref rid="B36" ref-type="bibr">36</xref>), are well suited to identifying unknown prophage integrations, but provide relatively coarse annotations. Once integrations have been coarsely identified and users have a notion of what prophage sequences to supply as queries, VIBES is relatively well suited to more precisely determine prophage strain and integration boundaries if prophage regions are provided as target sequences.</p>
    </sec>
    <sec id="SEC4-2">
      <title>Alternative use of the VIBES workflow</title>
      <p>To a large degree, VIBES is a workflow that coordinates sequence similarity search and bacterial genome annotation when supplied with target and query sequences. The only VIBES components that are specific to annotation of prophage in bacterial genomes are Prokka (<xref rid="B37" ref-type="bibr">37</xref>) annotation (which requires bacterial sequence input) and visualization generation (which assumes that targets are bacterial genomes and queries are prophages). The core input to VIBES is simply target sequences (in FASTA format) and queries (in either multi-FASTA for a set of sequences or Stockholm for a set of alignments). As a result, users are essentially free to use VIBES to conduct searches against nucleotide sequences as they see fit, so long as they specify query sequence type (DNA, RNA or amino) and disable incompatible workflow components through the VIBES configuration file.</p>
    </sec>
    <sec id="SEC4-3">
      <title>Future extensions</title>
      <p>Here, we briefly discuss some limitations of the VIBES workflow that could be addressed by future extensions of the workflow. These limitations are discussed in more detail in the VIBES documentation, available at <ext-link xlink:href="https://github.com/TravisWheelerLab/VIBES" ext-link-type="uri">https://github.com/TravisWheelerLab/VIBES</ext-link>.</p>
      <sec id="SEC4-3-1">
        <title><italic toggle="yes">Att</italic> site annotation</title>
        <p>A common signal of phage integration is the presence of attachment (<italic toggle="yes">att</italic>) sites, two copies of which—<italic toggle="yes">attP</italic> and <italic toggle="yes">attB</italic>, carried on the phage genome and bacterial genome, respectively—flank integrated prophages. These leave a distinctive signal of flanking direct repeats, but this signal is not detected or annotated in the initial VIBES release. As <italic toggle="yes">att</italic> sites are of interest to prophage researchers and are annotated by some prophage annotation tools (<xref rid="B26" ref-type="bibr">26</xref>,<xref rid="B52" ref-type="bibr">52</xref>), extending the VIBES feature set to include <italic toggle="yes">att</italic> site annotation is a high priority for future extensions of the workflow.</p>
      </sec>
      <sec id="SEC4-3-2">
        <title>Further prophage verification</title>
        <p>A major limitation of the VIBES workflow is its limited means of verifying that query prophage sequence represents a complete or partial prophage sequence, rather than a homologous non-phage region of the host genome. Currently, VIBES employs relatively simple methods of analyzing ambiguous sequences via its interactive visual output, its complete/partial classification and its per-match gene count filtering. While this may be desirable in some analyses, such as investigations of homologous regions shared by prophages and their hosts, addressing this limitation is a high priority for future iterations of the workflow.</p>
      </sec>
      <sec id="SEC4-3-3">
        <title><italic toggle="yes">De novo</italic> annotation support</title>
        <p>The default VIBES workflow does little to support <italic toggle="yes">de novo</italic> annotation of phage sequences, in which bacterial genomes are scanned for a broad range of reference prophages. Currently, to conduct such an analysis with VIBES, users would have to identify or construct a file containing a diverse set of known temperate phage genomes or multiple sequence alignments of related phage genomes. <italic toggle="yes">De novo</italic> annotation is further hampered by the lack of further analysis of potential prophages identified by VIBES, discussed above, which makes it more difficult to discern prophage regions from homologous bacterial sequences, especially when given a diverse set of temperate phage queries.</p>
      </sec>
      <sec id="SEC4-3-4">
        <title>Support for other search tools</title>
        <p>Though the <italic toggle="yes">nhmmer</italic> search algorithm is more sensitive to distant homology than other search algorithms (<xref rid="B40" ref-type="bibr">40</xref>), it is relatively computationally expensive. Indeed, viral sequence annotation tools that use HMMER search algorithms have been demonstrated to be among the slowest annotation techniques (<xref rid="B53" ref-type="bibr">53</xref>). This limitation can be addressed through the addition of a broader choice of sequence similarity search tools with less expected sensitivity and resource usage, such as LAST (<xref rid="B54" ref-type="bibr">54</xref>) or <italic toggle="yes">blastn</italic> (<xref rid="B44" ref-type="bibr">44</xref>).</p>
      </sec>
    </sec>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>Acknowledgements</title>
    <p>We are grateful to George Lesica for his early guidance in building Nextflow workflows. We also thank Elizabeth Burgener, Julie Portois and Paul Bollyky for sharing their data and analysis for use in evaluating VIBES during development. We also gratefully acknowledge the computational resources and expert administration provided by the University of Montana’s Griz Shared Computing Cluster (GSCC) and HPC resources supported by the University of Arizona TRIF (Technology and Research Initiative Fund), UITS (University Information Technology Services) and RII (Office of Research, Innovation and Impact), and maintained by the University of Arizona Research Technologies Department.</p>
    <p><italic toggle="yes">Author contributions</italic>: C.J.C. developed the workflow software and performed all experiments. J.W.R. developed the visualization software component. P.R.S. and A.K.S. guided phage-specific analysis requirements and data acquisition. T.J.W. designed the software and guided all research efforts. C.J.C and T.J.W. wrote the paper. All authors edited and approved the final manuscript.</p>
  </ack>
  <sec sec-type="data-availability" id="SEC5">
    <title>Data availability</title>
    <p>Supplementary materials documenting scripts and commands used are available at <ext-link xlink:href="https://github.com/TravisWheelerLab/VIBES-paper" ext-link-type="uri">https://github.com/TravisWheelerLab/VIBES-paper</ext-link>, <ext-link xlink:href="https://zenodo.org/doi/10.5281/zenodo.10826544" ext-link-type="uri">https://zenodo.org/doi/10.5281/zenodo.10826544</ext-link> (VIBES software) and <ext-link xlink:href="https://zenodo.org/doi/10.5281/zenodo.10826552" ext-link-type="uri">https://zenodo.org/doi/10.5281/zenodo.10826552</ext-link> (scripts/notes for article figures/tables).</p>
  </sec>
  <sec id="SEC7">
    <title>Funding</title>
    <p>National Institute of General Medical Sciences [R01GM132600 to C.J.C., J.W.R. and T.J.W.]; Department of Energy’s Office of Biological and Environmental Research [DE-SC0021216 to C.J.C., J.W.R. and T.J.W.]; National Institute of Allergy and Infectious Diseases [R01AI138981 to P.R.S. and A.K.S.].</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. The authors declare no conflicts of interest.</p>
  </sec>
  <ref-list id="REF1">
    <title>References</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Suttle</surname>  <given-names>C.A.</given-names></string-name></person-group>  <article-title>Marine viruses—major players in the global ecosystem</article-title>. <source>Nat. Rev. Microbiol.</source>  <year>2007</year>; <volume>5</volume>:<fpage>801</fpage>–<lpage>812</lpage>.<pub-id pub-id-type="pmid">17853907</pub-id>
</mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tock</surname>  <given-names>M.R.</given-names></string-name>, <string-name><surname>Dryden</surname>  <given-names>D.T.F.</given-names></string-name></person-group>  <article-title>The biology of restriction and anti-restriction</article-title>. <source>Curr. Opin. Microbiol.</source>  <year>2005</year>; <volume>8</volume>:<fpage>466</fpage>–<lpage>472</lpage>.<pub-id pub-id-type="pmid">15979932</pub-id>
</mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hille</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Richter</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Wong</surname>  <given-names>S.P.</given-names></string-name>, <string-name><surname>Bratovič</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Ressel</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Charpentier</surname>  <given-names>E.</given-names></string-name></person-group>  <article-title>The biology of CRISPR–Cas: backward and forward</article-title>. <source>Cell</source>. <year>2018</year>; <volume>172</volume>:<fpage>1239</fpage>–<lpage>1259</lpage>.<pub-id pub-id-type="pmid">29522745</pub-id>
</mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Georjon</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Bernheim</surname>  <given-names>A.</given-names></string-name></person-group>  <article-title>The highly diverse antiphage defence systems of bacteria</article-title>. <source>Nat. Rev. Microbiol.</source>  <year>2023</year>; <volume>21</volume>:<fpage>686</fpage>–<lpage>700</lpage>.<pub-id pub-id-type="pmid">37460672</pub-id>
</mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Warwick-Dugdale</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Buchholz</surname>  <given-names>H.H.</given-names></string-name>, <string-name><surname>Allen</surname>  <given-names>M.J.</given-names></string-name>, <string-name><surname>Temperton</surname>  <given-names>B.</given-names></string-name></person-group>  <article-title>Host-hijacking and planktonic piracy: how phages command the microbial high seas</article-title>. <source>Virol. J.</source>  <year>2019</year>; <volume>16</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">30709355</pub-id>
</mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Howard-Varona</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Hargreaves</surname>  <given-names>K.R.</given-names></string-name>, <string-name><surname>Abedon</surname>  <given-names>S.T.</given-names></string-name>, <string-name><surname>Sullivan</surname>  <given-names>M.B.</given-names></string-name></person-group>  <article-title>Lysogeny in nature: mechanisms, impact and ecology of temperate phages</article-title>. <source>ISME J.</source>  <year>2017</year>; <volume>11</volume>:<fpage>1511</fpage>–<lpage>1520</lpage>.<pub-id pub-id-type="pmid">28291233</pub-id>
</mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brüssow</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Canchaya</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Hardt</surname>  <given-names>W.-D.</given-names></string-name></person-group>  <article-title>Phages and the evolution of bacterial pathogens: from genomic rearrangements to lysogenic conversion</article-title>. <source>Microbiol. Mol. Biol. Rev.</source>  <year>2004</year>; <volume>68</volume>:<fpage>560</fpage>–<lpage>602</lpage>.<pub-id pub-id-type="pmid">15353570</pub-id>
</mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bondy-Denomy</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Qian</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Westra</surname>  <given-names>E.R.</given-names></string-name>, <string-name><surname>Buckling</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Guttman</surname>  <given-names>D.S.</given-names></string-name>, <string-name><surname>Davidson</surname>  <given-names>A.R.</given-names></string-name>, <string-name><surname>Maxwell</surname>  <given-names>K.L.</given-names></string-name></person-group>  <article-title>Prophages mediate defense against phage infection through diverse mechanisms</article-title>. <source>ISME J.</source>  <year>2016</year>; <volume>10</volume>:<fpage>2854</fpage>–<lpage>2866</lpage>.<pub-id pub-id-type="pmid">27258950</pub-id>
</mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wagner</surname>  <given-names>P.L.</given-names></string-name>, <string-name><surname>Waldor</surname>  <given-names>M.K.</given-names></string-name></person-group>  <article-title>Bacteriophage control of bacterial virulence</article-title>. <source>Infect. Immun.</source>  <year>2002</year>; <volume>70</volume>:<fpage>3985</fpage>–<lpage>3993</lpage>.<pub-id pub-id-type="pmid">12117903</pub-id>
</mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roux</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Krupovic</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Daly</surname>  <given-names>R.A.</given-names></string-name>, <string-name><surname>Borges</surname>  <given-names>A.L.</given-names></string-name>, <string-name><surname>Nayfach</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Schulz</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Sharrar</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Matheus Carnevali</surname>  <given-names>P.B.</given-names></string-name>, <string-name><surname>Cheng</surname>  <given-names>J.-F.</given-names></string-name>, <string-name><surname>Ivanova</surname>  <given-names>N.N.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Cryptic inoviruses revealed as pervasive in bacteria and archaea across Earth’s biomes</article-title>. <source>Nat. Microbiol.</source>  <year>2019</year>; <volume>4</volume>:<fpage>1895</fpage>–<lpage>1906</lpage>.<pub-id pub-id-type="pmid">31332386</pub-id>
</mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Secor</surname>  <given-names>P.R.</given-names></string-name>, <string-name><surname>Burgener</surname>  <given-names>E.B.</given-names></string-name>, <string-name><surname>Kinnersley</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Jennings</surname>  <given-names>L.K.</given-names></string-name>, <string-name><surname>Roman-Cruz</surname>  <given-names>V.</given-names></string-name>, <string-name><surname>Popescu</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Van Belleghem</surname>  <given-names>J.D.</given-names></string-name>, <string-name><surname>Haddock</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Copeland</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Michaels</surname>  <given-names>L.A.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Pf bacteriophage and their impact on <italic toggle="yes">Pseudomonas</italic> virulence, mammalian immunity, and chronic infections</article-title>. <source>Front. Immunol.</source>  <year>2020</year>; <volume>11</volume>:<fpage>244</fpage>.<pub-id pub-id-type="pmid">32153575</pub-id>
</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fiedoruk</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Zakrzewska</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Daniluk</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Piktel</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Chmielewska</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Bucki</surname>  <given-names>R.</given-names></string-name></person-group>  <article-title>Two lineages of <italic toggle="yes">Pseudomonas aeruginosa</italic> filamentous phages: structural uniformity over integration preferences</article-title>. <source>Genome Biol. Evol.</source>  <year>2020</year>; <volume>12</volume>:<fpage>1765</fpage>–<lpage>1781</lpage>.<pub-id pub-id-type="pmid">32658245</pub-id>
</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Knezevic</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Voet</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Lavigne</surname>  <given-names>R.</given-names></string-name></person-group>  <article-title>Prevalence of Pf1-like (pro)phage genetic elements among <italic toggle="yes">Pseudomonas aeruginosa</italic> isolates</article-title>. <source>Virology</source>. <year>2015</year>; <volume>483</volume>:<fpage>64</fpage>–<lpage>71</lpage>.<pub-id pub-id-type="pmid">25965796</pub-id>
</mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Tang</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Zeng</surname>  <given-names>Z.</given-names></string-name>, <string-name><surname>Guo</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>X.</given-names></string-name></person-group>  <article-title>Excisionase in Pf filamentous prophage controls lysis–lysogeny decision-making in <italic toggle="yes">Pseudomonas aeruginosa</italic></article-title>. <source>Mol. Microbiol.</source>  <year>2019</year>; <volume>111</volume>:<fpage>495</fpage>–<lpage>513</lpage>.<pub-id pub-id-type="pmid">30475408</pub-id>
</mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wei</surname>  <given-names>Q.</given-names></string-name>, <string-name><surname>Minh</surname>  <given-names>P.N.L.</given-names></string-name>, <string-name><surname>Dötsch</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Hildebrand</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Panmanee</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Elfarash</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Schulz</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Plaisance</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Charlier</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Hassett</surname>  <given-names>D.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Global regulation of gene expression by OxyR in an important human opportunistic pathogen</article-title>. <source>Nucleic Acids Res.</source>  <year>2012</year>; <volume>40</volume>:<fpage>4320</fpage>–<lpage>4333</lpage>.<pub-id pub-id-type="pmid">22275523</pub-id>
</mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Song</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Sheng</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Zhu</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Kim</surname>  <given-names>J.-S.</given-names></string-name>, <string-name><surname>Wood</surname>  <given-names>T.K.</given-names></string-name></person-group>  <article-title>Substrate binding protein DppA1 of ABC transporter DppBCDF increases biofilm formation in <italic toggle="yes">Pseudomonas aeruginosa</italic> by inhibiting Pf5 prophage lysis</article-title>. <source>Front. Microbiol.</source>  <year>2018</year>; <volume>9</volume>:<fpage>30</fpage>.<pub-id pub-id-type="pmid">29416528</pub-id>
</mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Castang</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Dove</surname>  <given-names>S.L.</given-names></string-name></person-group>  <article-title>Basis for the essentiality of H-NS family members in <italic toggle="yes">Pseudomonas aeruginosa</italic></article-title>. <source>J. Bacteriol.</source>  <year>2012</year>; <volume>194</volume>:<fpage>5101</fpage>–<lpage>5109</lpage>.<pub-id pub-id-type="pmid">22821971</pub-id>
</mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rice</surname>  <given-names>S.A.</given-names></string-name>, <string-name><surname>Tan</surname>  <given-names>C.H.</given-names></string-name>, <string-name><surname>Mikkelsen</surname>  <given-names>P.J.</given-names></string-name>, <string-name><surname>Kung</surname>  <given-names>V.</given-names></string-name>, <string-name><surname>Woo</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Tay</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Hauser</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>McDougald</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Webb</surname>  <given-names>J.S.</given-names></string-name>, <string-name><surname>Kjelleberg</surname>  <given-names>S.</given-names></string-name></person-group>  <article-title>The biofilm life cycle and virulence of <italic toggle="yes">Pseudomonas aeruginosa</italic> are dependent on a filamentous prophage</article-title>. <source>ISME J.</source>  <year>2009</year>; <volume>3</volume>:<fpage>271</fpage>–<lpage>282</lpage>.<pub-id pub-id-type="pmid">19005496</pub-id>
</mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarafder</surname>  <given-names>A.K.</given-names></string-name>, <string-name><surname>von Kügelgen</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Mellul</surname>  <given-names>A.J.</given-names></string-name>, <string-name><surname>Schulze</surname>  <given-names>U.</given-names></string-name>, <string-name><surname>Aarts</surname>  <given-names>D.G.A.L.</given-names></string-name>, <string-name><surname>Bharat</surname>  <given-names>T.A.M.</given-names></string-name></person-group>  <article-title>Phage liquid crystalline droplets form occlusive sheaths that encapsulate and protect infectious rod-shaped bacteria</article-title>. <source>Proc. Natl Acad. Sci. U.S.A.</source>  <year>2020</year>; <volume>117</volume>:<fpage>4724</fpage>–<lpage>4731</lpage>.<pub-id pub-id-type="pmid">32071243</pub-id>
</mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Secor</surname>  <given-names>P.R.</given-names></string-name>, <string-name><surname>Sweere</surname>  <given-names>J.M.</given-names></string-name>, <string-name><surname>Michaels</surname>  <given-names>L.A.</given-names></string-name>, <string-name><surname>Malkovskiy</surname>  <given-names>A.V.</given-names></string-name>, <string-name><surname>Lazzareschi</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Katznelson</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Rajadas</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Birnbaum</surname>  <given-names>M.E.</given-names></string-name>, <string-name><surname>Arrigoni</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Braun</surname>  <given-names>K.R.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Filamentous bacteriophage promote biofilm assembly and function</article-title>. <source>Cell Host Microbe</source>. <year>2015</year>; <volume>18</volume>:<fpage>549</fpage>–<lpage>559</lpage>.<pub-id pub-id-type="pmid">26567508</pub-id>
</mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burgener</surname>  <given-names>E.B.</given-names></string-name>, <string-name><surname>Sweere</surname>  <given-names>J.M.</given-names></string-name>, <string-name><surname>Bach</surname>  <given-names>M.S.</given-names></string-name>, <string-name><surname>Secor</surname>  <given-names>P.R.</given-names></string-name>, <string-name><surname>Haddock</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Jennings</surname>  <given-names>L.K.</given-names></string-name>, <string-name><surname>Marvig</surname>  <given-names>R.L.</given-names></string-name>, <string-name><surname>Johansen</surname>  <given-names>H.K.</given-names></string-name>, <string-name><surname>Rossi</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Cao</surname>  <given-names>X.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Filamentous bacteriophages are associated with chronic <italic toggle="yes">Pseudomonas</italic> lung infections and antibiotic resistance in cystic fibrosis</article-title>. <source>Sci. Transl. Med.</source>  <year>2019</year>; <volume>11</volume>:<fpage>eaau9748</fpage>.<pub-id pub-id-type="pmid">30996083</pub-id>
</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sweere</surname>  <given-names>J.M.</given-names></string-name>, <string-name><surname>Van Belleghem</surname>  <given-names>J.D.</given-names></string-name>, <string-name><surname>Ishak</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Bach</surname>  <given-names>M.S.</given-names></string-name>, <string-name><surname>Popescu</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Sunkari</surname>  <given-names>V.</given-names></string-name>, <string-name><surname>Kaber</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Manasherob</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Suh</surname>  <given-names>G.A.</given-names></string-name>, <string-name><surname>Cao</surname>  <given-names>X.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Bacteriophage trigger antiviral immunity and prevent clearance of bacterial infection</article-title>. <source>Science</source>. <year>2019</year>; <volume>363</volume>:<fpage>eaat9691</fpage>.<pub-id pub-id-type="pmid">30923196</pub-id>
</mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bach</surname>  <given-names>M.S.</given-names></string-name>, <string-name><surname>de Vries</surname>  <given-names>C.R.</given-names></string-name>, <string-name><surname>Khosravi</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Sweere</surname>  <given-names>J.M.</given-names></string-name>, <string-name><surname>Popescu</surname>  <given-names>M.C.</given-names></string-name>, <string-name><surname>Chen</surname>  <given-names>Q.</given-names></string-name>, <string-name><surname>Demirdjian</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Hargil</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Van Belleghem</surname>  <given-names>J.D.</given-names></string-name>, <string-name><surname>Kaber</surname>  <given-names>G.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Filamentous bacteriophage delays healing of <italic toggle="yes">Pseudomonas</italic>-infected wounds</article-title>. <source>Cell Rep. Med.</source>  <year>2022</year>; <volume>3</volume>:<fpage>100656</fpage>.<pub-id pub-id-type="pmid">35732145</pub-id>
</mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paez-Espino</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Eloe-Fadrosh</surname>  <given-names>E.A.</given-names></string-name>, <string-name><surname>Pavlopoulos</surname>  <given-names>G.A.</given-names></string-name>, <string-name><surname>Thomas</surname>  <given-names>A.D.</given-names></string-name>, <string-name><surname>Huntemann</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Mikhailova</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Rubin</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Ivanova</surname>  <given-names>N.N.</given-names></string-name>, <string-name><surname>Kyrpides</surname>  <given-names>N.C.</given-names></string-name></person-group>  <article-title>Uncovering Earth’s virome</article-title>. <source>Nature</source>. <year>2016</year>; <volume>536</volume>:<fpage>425</fpage>–<lpage>430</lpage>.<pub-id pub-id-type="pmid">27533034</pub-id>
</mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arndt</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Grant</surname>  <given-names>J.R.</given-names></string-name>, <string-name><surname>Marcu</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Sajed</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Pon</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Liang</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Wishart</surname>  <given-names>D.S.</given-names></string-name></person-group>  <article-title>PHASTER: a better, faster version of the PHAST phage search tool</article-title>. <source>Nucleic Acids Res.</source>  <year>2016</year>; <volume>44</volume>:<fpage>W16</fpage>–<lpage>W21</lpage>.<pub-id pub-id-type="pmid">27141966</pub-id>
</mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gan</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Si</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Yang</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Chen</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Ren</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Wu</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>F.</given-names></string-name></person-group>  <article-title>DBSCAN-SWA: an integrated tool for rapid prophage detection and annotation</article-title>. <source>Front. Genet.</source>  <year>2022</year>; <volume>13</volume>:<fpage>885048</fpage>.<pub-id pub-id-type="pmid">35518360</pub-id>
</mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roux</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Enault</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Hurwitz</surname>  <given-names>B.L.</given-names></string-name>, <string-name><surname>Sullivan</surname>  <given-names>M.B.</given-names></string-name></person-group>  <article-title>VirSorter: mining viral signal from microbial genomic data</article-title>. <source>PeerJ</source>. <year>2015</year>; <volume>3</volume>:<fpage>e985</fpage>.<pub-id pub-id-type="pmid">26038737</pub-id>
</mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Ahlgren</surname>  <given-names>N.A.</given-names></string-name>, <string-name><surname>Lu</surname>  <given-names>Y.Y.</given-names></string-name>, <string-name><surname>Fuhrman</surname>  <given-names>J.A.</given-names></string-name>, <string-name><surname>Sun</surname>  <given-names>F.</given-names></string-name></person-group>  <article-title>VirFinder: a novel <italic toggle="yes">k</italic>-mer based tool for identifying viral sequences from assembled metagenomic data</article-title>. <source>Microbiome</source>. <year>2017</year>; <volume>5</volume>:<fpage>69</fpage>.<pub-id pub-id-type="pmid">28683828</pub-id>
</mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Song</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Deng</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Ahlgren</surname>  <given-names>N.A.</given-names></string-name>, <string-name><surname>Fuhrman</surname>  <given-names>J.A.</given-names></string-name>, <string-name><surname>Li</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Xie</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Poplin</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Sun</surname>  <given-names>F.</given-names></string-name></person-group>  <article-title>Identifying viruses from metagenomic data using deep learning</article-title>. <source>Quant. Biol.</source>  <year>2020</year>; <volume>8</volume>:<fpage>64</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">34084563</pub-id>
</mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miao</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Hou</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>Y.</given-names></string-name></person-group>  <article-title>Virtifier: a deep learning-based identifier for viral sequences from metagenomes</article-title>. <source>Bioinformatics</source>. <year>2022</year>; <volume>38</volume>:<fpage>1216</fpage>–<lpage>1222</lpage>.<pub-id pub-id-type="pmid">34908121</pub-id>
</mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Bolduc</surname>  <given-names>B.</given-names></string-name>, <string-name><surname>Zayed</surname>  <given-names>A.A.</given-names></string-name>, <string-name><surname>Varsani</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Dominguez-Huerta</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Delmont</surname>  <given-names>T.O.</given-names></string-name>, <string-name><surname>Pratama</surname>  <given-names>A.A.</given-names></string-name>, <string-name><surname>Gazitúa</surname>  <given-names>M.C.</given-names></string-name>, <string-name><surname>Vik</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Sullivan</surname>  <given-names>M.B.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>VirSorter2: a multi-classifier, expert-guided approach to detect diverse DNA and RNA viruses</article-title>. <source>Microbiome</source>. <year>2021</year>; <volume>9</volume>:<fpage>37</fpage>.<pub-id pub-id-type="pmid">33522966</pub-id>
</mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kieft</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>Z.</given-names></string-name>, <string-name><surname>Anantharaman</surname>  <given-names>K.</given-names></string-name></person-group>  <article-title>VIBRANT: automated recovery, annotation and curation of microbial viruses, and evaluation of viral community function from genomic sequences</article-title>. <source>Microbiome</source>. <year>2020</year>; <volume>8</volume>:<fpage>90</fpage>.<pub-id pub-id-type="pmid">32522236</pub-id>
</mixed-citation>
    </ref>
    <ref id="B33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Sun</surname>  <given-names>H.-X.</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Cheng</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Peng</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Deng</surname>  <given-names>Z.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Hu</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>W.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Prophage Hunter: an integrative hunting tool for active prophages</article-title>. <source>Nucleic Acids Res.</source>  <year>2019</year>; <volume>47</volume>:<fpage>W74</fpage>–<lpage>W80</lpage>.<pub-id pub-id-type="pmid">31114893</pub-id>
</mixed-citation>
    </ref>
    <ref id="B34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amgarten</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Braga</surname>  <given-names>L.P.P.</given-names></string-name>, <string-name><surname>da Silva</surname>  <given-names>A.M.</given-names></string-name>, <string-name><surname>Setubal</surname>  <given-names>J.C.</given-names></string-name></person-group>  <article-title>MARVEL, a tool for prediction of bacteriophage sequences in metagenomic bins</article-title>. <source>Front. Genet.</source>  <year>2018</year>; <volume>9</volume>:<fpage>304</fpage>.<pub-id pub-id-type="pmid">30131825</pub-id>
</mixed-citation>
    </ref>
    <ref id="B35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Camargo</surname>  <given-names>A.P.</given-names></string-name>, <string-name><surname>Roux</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Schulz</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Babinski</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Xu</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Hu</surname>  <given-names>B.</given-names></string-name>, <string-name><surname>Chain</surname>  <given-names>P.S.G.</given-names></string-name>, <string-name><surname>Nayfach</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Kyrpides</surname>  <given-names>N.C.</given-names></string-name></person-group>  <article-title>Identification of mobile genetic elements with geNomad</article-title>. <source>Nat. Biotechnol.</source>  <year>2023</year>; <pub-id pub-id-type="doi">10.1038/s41587-023-01953-y</pub-id>.</mixed-citation>
    </ref>
    <ref id="B36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wishart</surname>  <given-names>D.S.</given-names></string-name>, <string-name><surname>Han</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Saha</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Oler</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Peters</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Grant</surname>  <given-names>J.R.</given-names></string-name>, <string-name><surname>Stothard</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Gautam</surname>  <given-names>V.</given-names></string-name></person-group>  <article-title>PHASTEST: faster than PHASTER, better than PHAST</article-title>. <source>Nucleic Acids Res.</source>  <year>2023</year>; <volume>51</volume>:<fpage>W443</fpage>–<lpage>W450</lpage>.<pub-id pub-id-type="pmid">37194694</pub-id>
</mixed-citation>
    </ref>
    <ref id="B37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Seemann</surname>  <given-names>T.</given-names></string-name></person-group>  <article-title>Prokka: rapid prokaryotic genome annotation</article-title>. <source>Bioinformatics</source>. <year>2014</year>; <volume>30</volume>:<fpage>2068</fpage>–<lpage>2069</lpage>.<pub-id pub-id-type="pmid">24642063</pub-id>
</mixed-citation>
    </ref>
    <ref id="B38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Terzian</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Olo Ndela</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Galiez</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Lossouarn</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Pérez Bucio</surname>  <given-names>R.E.</given-names></string-name>, <string-name><surname>Mom</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Toussaint</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Petit</surname>  <given-names>M.-A.</given-names></string-name>, <string-name><surname>Enault</surname>  <given-names>F.</given-names></string-name></person-group>  <article-title>PHROG: families of prokaryotic virus proteins clustered using remote homology</article-title>. <source>NAR Genom. Bioinform.</source>  <year>2021</year>; <volume>3</volume>:<fpage>lqab067</fpage>.<pub-id pub-id-type="pmid">34377978</pub-id>
</mixed-citation>
    </ref>
    <ref id="B39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Di Tommaso</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Chatzou</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Floden</surname>  <given-names>E.W.</given-names></string-name>, <string-name><surname>Barja</surname>  <given-names>P.P.</given-names></string-name>, <string-name><surname>Palumbo</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Notredame</surname>  <given-names>C.</given-names></string-name></person-group>  <article-title>Nextflow enables reproducible computational workflows</article-title>. <source>Nat. Biotechnol.</source>  <year>2017</year>; <volume>35</volume>:<fpage>316</fpage>–<lpage>319</lpage>.<pub-id pub-id-type="pmid">28398311</pub-id>
</mixed-citation>
    </ref>
    <ref id="B40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wheeler</surname>  <given-names>T.J.</given-names></string-name>, <string-name><surname>Eddy</surname>  <given-names>S.R.</given-names></string-name></person-group>  <article-title>nhmmer: DNA homology search with profile HMMs</article-title>. <source>Bioinformatics</source>. <year>2013</year>; <volume>29</volume>:<fpage>2487</fpage>–<lpage>2489</lpage>.<pub-id pub-id-type="pmid">23842809</pub-id>
</mixed-citation>
    </ref>
    <ref id="B41">
      <label>41.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Krause</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Shands</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Wheeler</surname>  <given-names>T.J.</given-names></string-name></person-group>  <article-title>Sensitive and error-tolerant annotation of protein-coding DNA with BATH</article-title>. <year>2024</year>; <comment>bioRxiv doi:</comment><comment>01 January 2024, preprint: not peer reviewed</comment><pub-id pub-id-type="doi">10.1101/2023.12.31.573773</pub-id>.</mixed-citation>
    </ref>
    <ref id="B42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Merkel</surname>  <given-names>D.</given-names></string-name></person-group>  <article-title>Docker: lightweight Linux containers for consistent development and deployment</article-title>. <source>Linux J.</source>  <year>2014</year>; <volume>2014</volume>:<fpage>2</fpage>.</mixed-citation>
    </ref>
    <ref id="B43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kurtzer</surname>  <given-names>G.M.</given-names></string-name>, <string-name><surname>Sochat</surname>  <given-names>V.</given-names></string-name>, <string-name><surname>Bauer</surname>  <given-names>M.W.</given-names></string-name></person-group>  <article-title>Singularity: scientific containers for mobility of compute</article-title>. <source>PLoS One</source>. <year>2017</year>; <volume>12</volume>:<fpage>e0177459</fpage>.<pub-id pub-id-type="pmid">28494014</pub-id>
</mixed-citation>
    </ref>
    <ref id="B44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Camacho</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Coulouris</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Avagyan</surname>  <given-names>V.</given-names></string-name>, <string-name><surname>Ma</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Papadopoulos</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Bealer</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Madden</surname>  <given-names>T.L.</given-names></string-name></person-group>  <article-title>BLAST+: architecture and applications</article-title>. <source>BMC Bioinformatics</source>. <year>2009</year>; <volume>10</volume>:<fpage>421</fpage>.<pub-id pub-id-type="pmid">20003500</pub-id>
</mixed-citation>
    </ref>
    <ref id="B45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McElroy</surname>  <given-names>K.E.</given-names></string-name>, <string-name><surname>Hui</surname>  <given-names>J.G.K.</given-names></string-name>, <string-name><surname>Woo</surname>  <given-names>J.K.K.</given-names></string-name>, <string-name><surname>Luk</surname>  <given-names>A.W.S.</given-names></string-name>, <string-name><surname>Webb</surname>  <given-names>J.S.</given-names></string-name>, <string-name><surname>Kjelleberg</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Rice</surname>  <given-names>S.A.</given-names></string-name>, <string-name><surname>Thomas</surname>  <given-names>T.</given-names></string-name></person-group>  <article-title>Strain-specific parallel evolution drives short-term diversification during <italic toggle="yes">Pseudomonas aeruginosa</italic> biofilm formation</article-title>. <source>Proc. Natl Acad. Sci. U.S.A.</source>  <year>2014</year>; <volume>111</volume>:<fpage>E1419</fpage>–<lpage>E1427</lpage>.<pub-id pub-id-type="pmid">24706926</pub-id>
</mixed-citation>
    </ref>
    <ref id="B46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wheeler</surname>  <given-names>T.J.</given-names></string-name>, <string-name><surname>Clements</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Eddy</surname>  <given-names>S.R.</given-names></string-name>, <string-name><surname>Hubley</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Jones</surname>  <given-names>T.A.</given-names></string-name>, <string-name><surname>Jurka</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Smit</surname>  <given-names>A.F.A.</given-names></string-name>, <string-name><surname>Finn</surname>  <given-names>R.D.</given-names></string-name></person-group>  <article-title>Dfam: a database of repetitive DNA based on profile hidden Markov models</article-title>. <source>Nucleic Acids Res.</source>  <year>2012</year>; <volume>41</volume>:<fpage>D70</fpage>–<lpage>D82</lpage>.<pub-id pub-id-type="pmid">23203985</pub-id>
</mixed-citation>
    </ref>
    <ref id="B47">
      <label>47.</label>
      <mixed-citation publication-type="other"><collab>State Public Health Bioinformatics Community</collab>  <article-title>Prokka Docker image</article-title>. <year>2023</year>; <uri xlink:href="https://hub.docker.com/r/staphb/prokka/dockerfile">https://hub.docker.com/r/staphb/prokka/dockerfile</uri>.</mixed-citation>
    </ref>
    <ref id="B48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roddy</surname>  <given-names>J.W.</given-names></string-name>, <string-name><surname>Lesica</surname>  <given-names>G.T.</given-names></string-name>, <string-name><surname>Wheeler</surname>  <given-names>T.J.</given-names></string-name></person-group>  <article-title>SODA: a TypeScript/JavaScript library for visualizing biological sequence annotation</article-title>. <source>NAR Genom. Bioinform.</source>  <year>2022</year>; <volume>4</volume>:<fpage>lqac077</fpage>.<pub-id pub-id-type="pmid">36212708</pub-id>
</mixed-citation>
    </ref>
    <ref id="B49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Winsor</surname>  <given-names>G.L.</given-names></string-name>, <string-name><surname>Griffiths</surname>  <given-names>E.J.</given-names></string-name>, <string-name><surname>Lo</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Dhillon</surname>  <given-names>B.K.</given-names></string-name>, <string-name><surname>Shay</surname>  <given-names>J.A.</given-names></string-name>, <string-name><surname>Brinkman</surname>  <given-names>F.S.L.</given-names></string-name></person-group>  <article-title>Enhanced annotations and features for comparing thousands of <italic toggle="yes">Pseudomonas</italic> genomes in the <italic toggle="yes">Pseudomonas</italic> Genome Database</article-title>. <source>Nucleic Acids Res.</source>  <year>2016</year>; <volume>44</volume>:<fpage>D646</fpage>–<lpage>D653</lpage>.<pub-id pub-id-type="pmid">26578582</pub-id>
</mixed-citation>
    </ref>
    <ref id="B50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Webb</surname>  <given-names>J.S.</given-names></string-name>, <string-name><surname>Lau</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Kjelleberg</surname>  <given-names>S.</given-names></string-name></person-group>  <article-title>Bacteriophage and phenotypic variation in <italic toggle="yes">Pseudomonas aeruginosa</italic> biofilm development</article-title>. <source>J. Bacteriol.</source>  <year>2004</year>; <volume>186</volume>:<fpage>8066</fpage>–<lpage>8073</lpage>.<pub-id pub-id-type="pmid">15547279</pub-id>
</mixed-citation>
    </ref>
    <ref id="B51">
      <label>51.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mooij</surname>  <given-names>M.J.</given-names></string-name>, <string-name><surname>Drenkard</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Llamas</surname>  <given-names>M.A.</given-names></string-name>, <string-name><surname>Vandenbroucke-Grauls</surname>  <given-names>C.M.J.E.</given-names></string-name>, <string-name><surname>Savelkoul</surname>  <given-names>P.H.M.</given-names></string-name>, <string-name><surname>Ausubel</surname>  <given-names>F.M.</given-names></string-name>, <string-name><surname>Bitter</surname>  <given-names>W.</given-names></string-name></person-group>  <article-title>Characterization of the integrated filamentous phage Pf5 and its involvement in small-colony formation</article-title>. <source>Microbiology</source>. <year>2007</year>; <volume>153</volume>:<fpage>1790</fpage>–<lpage>1798</lpage>.<pub-id pub-id-type="pmid">17526836</pub-id>
</mixed-citation>
    </ref>
    <ref id="B52">
      <label>52.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Sun</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Guo</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>X.</given-names></string-name></person-group>  <article-title>Prophage Tracer: precisely tracing prophages in prokaryotic genomes using overlapping split-read alignment</article-title>. <source>Nucleic Acids Res.</source>  <year>2021</year>; <volume>49</volume>:<fpage>e128</fpage>.<pub-id pub-id-type="pmid">34551431</pub-id>
</mixed-citation>
    </ref>
    <ref id="B53">
      <label>53.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roach</surname>  <given-names>M.J.</given-names></string-name>, <string-name><surname>McNair</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Michalczyk</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Giles</surname>  <given-names>S.K.</given-names></string-name>, <string-name><surname>Inglis</surname>  <given-names>L.K.</given-names></string-name>, <string-name><surname>Pargin</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Barylski</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Roux</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Decewicz</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Edwards</surname>  <given-names>R.A.</given-names></string-name></person-group>  <article-title>Philympics 2021: prophage predictions perplex programs</article-title>. <source>F1000Research</source>. <year>2022</year>; <volume>10</volume>:<fpage>758</fpage>.</mixed-citation>
    </ref>
    <ref id="B54">
      <label>54.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiełbasa</surname>  <given-names>S.M.</given-names></string-name>, <string-name><surname>Wan</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Sato</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Horton</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Frith</surname>  <given-names>M.C.</given-names></string-name></person-group>  <article-title>Adaptive seeds tame genomic sequence comparison</article-title>. <source>Genome Res.</source>  <year>2011</year>; <volume>21</volume>:<fpage>487</fpage>–<lpage>493</lpage>.<pub-id pub-id-type="pmid">21209072</pub-id>
</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">nargab</journal-id>
    <journal-title-group>
      <journal-title>NAR Genomics and Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2631-9268</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10993291</article-id>
    <article-id pub-id-type="pmid">38584872</article-id>
    <article-id pub-id-type="doi">10.1093/nargab/lqae030</article-id>
    <article-id pub-id-type="publisher-id">lqae030</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00030</subject>
        <subject>AcademicSubjects/SCI00980</subject>
        <subject>AcademicSubjects/SCI01060</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Pipelines and Workflows for Biological Data Analysis</subject>
      </subj-group>
      <subj-group subj-group-type="category-oup-series">
        <subject>Editor's Choice</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VIBES: a workflow for annotating and visualizing viral sequences integrated into bacterial genomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8328-7339</contrib-id>
        <name>
          <surname>Copeland</surname>
          <given-names>Conner J</given-names>
        </name>
        <aff><institution>Division of Biological Sciences, University of Montana</institution>, Missoula, MT, 59812, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6055-7706</contrib-id>
        <name>
          <surname>Roddy</surname>
          <given-names>Jack W</given-names>
        </name>
        <aff><institution>R. Ken Coit College of Pharmacy, University of Arizona</institution>, Tucson, AZ, 85721, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schmidt</surname>
          <given-names>Amelia K</given-names>
        </name>
        <aff><institution>Division of Biological Sciences, University of Montana</institution>, Missoula, MT, 59812, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7123-3037</contrib-id>
        <name>
          <surname>Secor</surname>
          <given-names>Patrick R</given-names>
        </name>
        <aff><institution>Division of Biological Sciences, University of Montana</institution>, Missoula, MT, 59812, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2004-1785</contrib-id>
        <name>
          <surname>Wheeler</surname>
          <given-names>Travis J</given-names>
        </name>
        <!--twheeler@arizona.edu-->
        <aff><institution>R. Ken Coit College of Pharmacy, University of Arizona</institution>, Tucson, AZ, 85721, <country country="US">USA</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +1 520 621 6449; Email: <email>twheeler@arizona.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-04-04">
      <day>04</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <volume>6</volume>
    <issue>2</issue>
    <elocation-id>lqae030</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>5</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press on behalf of NAR Genomics and Bioinformatics.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="lqae030.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Bacteriophages are viruses that infect bacteria. Many bacteriophages integrate their genomes into the bacterial chromosome and become prophages. Prophages may substantially burden or benefit host bacteria fitness, acting in some cases as parasites and in others as mutualists. Some prophages have been demonstrated to increase host virulence. The increasing ease of bacterial genome sequencing provides an opportunity to deeply explore prophage prevalence and insertion sites. Here we present VIBES (Viral Integrations in Bacterial genomES), a workflow intended to automate prophage annotation in complete bacterial genome sequences. VIBES provides additional context to prophage annotations by annotating bacterial genes and viral proteins in user-provided bacterial and viral genomes. The VIBES pipeline is implemented as a Nextflow-driven workflow, providing a simple, unified interface for execution on local, cluster and cloud computing environments. For each step of the pipeline, a container including all necessary software dependencies is provided. VIBES produces results in simple tab-separated format and generates intuitive and interactive visualizations for data exploration. Despite VIBES’s primary emphasis on prophage annotation, its generic alignment-based design allows it to be deployed as a general-purpose sequence similarity search manager. We demonstrate the utility of the VIBES prophage annotation workflow by searching for 178 Pf phage genomes across 1072 <italic toggle="yes">Pseudomonas</italic> spp. genomes.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of General Medical Sciences</institution>
            <institution-id institution-id-type="DOI">10.13039/100000057</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM132600</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Office of Biological and Environmental Research</institution>
            <institution-id institution-id-type="DOI">10.13039/100006206</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>DE-SC0021216</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
            <institution-id institution-id-type="DOI">10.13039/100000060</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01AI138981</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>Introduction</title>
    <p>Bacteriophages (phages), viruses that infect bacteria, are as ubiquitous as their hosts. They are found everywhere that we find populations of bacteria, from forest soils and the oceans to hydrothermal springs and the human gut. Phages pose a significant threat to bacteria: in marine ecosystems, up to one-third of bacteria are killed by phages every day (<xref rid="B1" ref-type="bibr">1</xref>). The strong pressure exerted by the threat of phage infection has led bacteria to evolve antiphage defense systems. Restriction–modification systems (<xref rid="B2" ref-type="bibr">2</xref>) and CRISPR–Cas systems (<xref rid="B3" ref-type="bibr">3</xref>) rely on sensing and degrading invading nucleic acids and are among the most widespread antiphage systems; however, numerous additional antiphage defense systems utilizing diverse mechanisms have recently been discovered (<xref rid="B4" ref-type="bibr">4</xref>). Likewise, phages have evolved to become adept manipulators of host metabolism, allowing them to evade host defenses or improve conditions for viral replication (<xref rid="B5" ref-type="bibr">5</xref>).</p>
    <p>Phages can be purely parasitic (lytic) and replicate at the expense of their bacterial hosts. However, in addition to lytic replication, temperate phages can alternatively undergo lysogenic replication in which the phage genome typically integrates into the host chromosome as a prophage. Temperate phages are common: approximately half of sequenced bacterial genomes contain at least one prophage (<xref rid="B6" ref-type="bibr">6</xref>). Prophages are replicated each time the host cell divides. Consequentially, prophages benefit from thriving hosts, which can incentivize the development of mutualistic phage–host relationships. Many prophages encode factors that benefit their hosts (<xref rid="B7" ref-type="bibr">7</xref>). For example, some phages carry genes that promote resistance to infection from competing viruses (<xref rid="B8" ref-type="bibr">8</xref>), while other phages encode virulence factors, aiding host pathogenicity (<xref rid="B9" ref-type="bibr">9</xref>).</p>
    <p>Many bacterial species are lysogenized by filamentous phages in the Inoviridae family (<xref rid="B10" ref-type="bibr">10</xref>). The opportunistic pathogen <italic toggle="yes">Pseudomonas aeruginosa</italic> is frequently lysogenized by an inovirus called Pf (<xref rid="B11" ref-type="bibr">11–13</xref>). Pf prophages maintain lysogeny by repressing transcription of their excisionase (<xref rid="B14" ref-type="bibr">14</xref>). In response to oxidative stress (<xref rid="B15" ref-type="bibr">15</xref>), nutrient limitation (<xref rid="B16" ref-type="bibr">16</xref>) or other factors (<xref rid="B17" ref-type="bibr">17</xref>), the Pf prophage excises from the chromosome and Pf virion replication is initiated. Pf virion replication plays a role in biofilm development by lysing cells in the center of a colony, releasing DNA that adds to biofilm structural integrity (<xref rid="B18" ref-type="bibr">18</xref>). Pf virions themselves also act as structural components in <italic toggle="yes">P. aeruginosa</italic> biofilms, protecting bacteria from desiccation and antibiotics (<xref rid="B19" ref-type="bibr">19</xref>,<xref rid="B20" ref-type="bibr">20</xref>). Indeed, the presence of Pf virions in the airways of cystic fibrosis patients is associated with antibiotic resistance (<xref rid="B21" ref-type="bibr">21</xref>). Additionally, Pf virions are immunomodulatory and induce maladaptive antiviral immune responses that promote infection initiation (<xref rid="B22" ref-type="bibr">22</xref>) and interfere with wound healing by inhibiting keratinocyte migration (<xref rid="B23" ref-type="bibr">23</xref>).</p>
    <p>The important and varied roles of prophages in bacterial communities—parasites, mutualists and sometimes pathogenicity aides—motivate the development of high-quality software methods that identify and classify their integrations into bacterial genomes. Generally, phage sequence annotation tools are designed to annotate either prophage in whole bacterial genome sequence or phage genome fragments in metagenomic datasets. Most recent approaches focus on annotation in a metagenomic context, as metagenomic datasets have proven to be rich sources of previously unknown viral sequences (<xref rid="B10" ref-type="bibr">10</xref>,<xref rid="B24" ref-type="bibr">24</xref>). Viral annotation, particularly in metagenomic contexts, requires tools to strike a balance between sensitivity and speed. High sensitivity is necessary to overcome high mutation rates in viral proteins combined with an increased risk of sequencing error stemming from the low abundance of viral sequences in most metagenomic datasets. Meanwhile, reasonable labeling speed is required when annotating large datasets. As a result of these constraints, viral annotation software has generally converged on a few techniques for identifying viral sequences: sequence similarity search against large databases of viral genomes (<xref rid="B25" ref-type="bibr">25–27</xref>), machine learning approaches based on statistical features such as <italic toggle="yes">k</italic>-mer frequencies, with a recent emphasis on neural networks (<xref rid="B28" ref-type="bibr">28–30</xref>), or some combination of both approaches (<xref rid="B31" ref-type="bibr">31–35</xref>). Viral annotation tools with a focus on prophage annotation in whole genome sequence [DBSCAN-SWA (<xref rid="B26" ref-type="bibr">26</xref>), PHASTEST (<xref rid="B36" ref-type="bibr">36</xref>), Prophage Hunter (<xref rid="B33" ref-type="bibr">33</xref>)] typically include visual summaries that increase the legibility of their output. Both DBSCAN-SWA and Prophage Hunter are available as stand-alone software that can be run by researchers seeking to conduct large-scale analysis in a cluster or cloud computing environment, but require installation of prerequisite software and manual creation of job submission scripts to run in high-performance computing (HPC) environments. This significantly increases the minimum computational skillset necessary to conduct large-scale analysis of prophage integrated into complete bacterial genome sequences. PHASTEST somewhat alleviates this by offering a containerized version of their approach, reducing the need to install prerequisites. However, managing widescale execution of containerized PHASTEST instances in an HPC environment through job submission scripts or other customized approaches is still left to end users.</p>
    <p>Here, we introduce and describe VIBES (Viral Integrations in Bacterial genomES), an automated command line workflow for annotation of bacterial genomes that emphasizes identification of prophage integrations. VIBES supplements standard bacterial gene labeling with in-depth analysis of prophage integrations, producing machine- and human-readable text output files coupled with interactive HTML visualizations that facilitate further analysis of output data. VIBES is designed to</p>
    <list list-type="bullet">
      <list-item>
        <p>annotate prophages with high sensitivity;</p>
      </list-item>
      <list-item>
        <p>annotate bacterial genes on input genomes, using Prokka (<xref rid="B37" ref-type="bibr">37</xref>);</p>
      </list-item>
      <list-item>
        <p>annotate viral genes within input viral genomes, using the PHROGs database (<xref rid="B38" ref-type="bibr">38</xref>);</p>
      </list-item>
      <list-item>
        <p>accept a potentially large number of bacterial genomes and candidate phage genomes as input;</p>
      </list-item>
      <list-item>
        <p>substantially reduce prerequisite installation and automatically manage distribution of workload to cluster/cloud/local resources; and</p>
      </list-item>
      <list-item>
        <p>create interactive HTML visuals that display the above, as well as display which regions that map to user input prophages are most prevalent among all input bacterial genomes.</p>
      </list-item>
    </list>
    <p>To the best of our knowledge, VIBES is the first prophage annotation software approach that includes output visualizations designed to facilitate investigation of patterns of prophage integration and shared prophage–host homology across entire target bacterial genome datasets. VIBES is also the first prophage annotation approach that is engineered to enable efficient, massively parallelized prophage search and genome annotation by end users on a wide variety of hardware and computing environments. VIBES also has the capacity to serve as manager of massively parallelized sequence similarity searches, even if the queries and targets of those searches are not prophages and bacteria, respectively.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>Materials and methods</title>
    <sec id="SEC2-1">
      <title>Implementation</title>
      <p>VIBES is an automated prophage search workflow that uses containerized components coordinated by the Nextflow workflow management software (<xref rid="B39" ref-type="bibr">39</xref>) to produce output tab-separated value (TSV) annotation tables accompanied by interactive HTML files that summarize matches to prophage sequences. To annotate prophage integrations, VIBES is provided with an input FASTA file containing all prophage sequences to seek and a collection of bacterial genomes in FASTA format to annotate with prophages; it performs search using the software <italic toggle="yes">nhmmer</italic> (<xref rid="B40" ref-type="bibr">40</xref>). To annotate bacterial protein-coding genes, ribosomal RNA and transfer RNA, VIBES uses Prokka (<xref rid="B37" ref-type="bibr">37</xref>). To annotate query prophage protein-coding genes, VIBES uses the BATH protein-coding DNA annotation software (<xref rid="B41" ref-type="bibr">41</xref>) and the PHROGs v4 prokaryotic viral protein database (<xref rid="B38" ref-type="bibr">38</xref>) by default. The user can optionally substitute their own viral protein database. Figure <xref rid="F1" ref-type="fig">1</xref> provides a visual representation of the three independent annotation workflows, run in parallel and managed by VIBES, that produce bacterial gene annotations, viral sequence integrations and viral gene annotations. Table <xref rid="tbl1" ref-type="table">1</xref> lists the tools and databases managed by the VIBES Docker container.</p>
      <table-wrap position="float" id="tbl1">
        <label>Table 1.</label>
        <caption>
          <p>Dependencies managed by VIBES Docker container</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Tool</th>
              <th rowspan="1" colspan="1">Purpose</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">BATH (<xref rid="B41" ref-type="bibr">41</xref>)</td>
              <td rowspan="1" colspan="1">Annotation of protein-coding DNA on query prophage</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic toggle="yes">nhmmer</italic> (<xref rid="B40" ref-type="bibr">40</xref>)</td>
              <td rowspan="1" colspan="1">DNA-to-DNA identification of prophages on bacterial genomes</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Prokka (<xref rid="B37" ref-type="bibr">37</xref>)</td>
              <td rowspan="1" colspan="1">Bacterial genome annotation</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>VIBES workflow schematic. It displays how input data move through the VIBES annotation workflow. Bacterial gene annotation processes are shown in yellow (left track), prophage annotation processes are shown in green (center track), viral gene annotation processes are shown in blue (right track) and visualization processes are shown in red (bottom square). The annotation processes are independent of each other. Stacked icons indicate processes parallelized automatically by Nextflow.</p>
        </caption>
        <graphic xlink:href="lqae030fig1" position="float"/>
      </fig>
      <p>Before running VIBES, the user must install a software container system such as Docker (<xref rid="B42" ref-type="bibr">42</xref>) or Singularity/Apptainer (<xref rid="B43" ref-type="bibr">43</xref>) (usually the latter on HPC systems, where VIBES is likely to be utilized). These container systems enable the development and release of portable and reproducible software environments with fine-grained control over configuration and dependency conflicts while also retaining high performance. The user must also install the workflow management software Nextflow. Nextflow manages downloading and running containers, submits jobs to compute cluster job scheduling software (i.e. SLURM) or cloud computing architectures (i.e. AWS Batch), caches and checkpoints in-progress jobs in case of a crash, provides interpretable workflow status updates, runs on a wide variety of operating systems and hardware configurations, and can run VIBES locally as needed. After a user configures the workflow to run on their system and launches it, Nextflow requires no further user interaction to identify task dependencies, automatically maximizing parallelism by running as many tasks with satisfied dependencies as available resources allow.</p>
      <p>The VIBES release consists of a Nextflow workflow script, several helper scripts written in Python and Perl, JavaScript and HTML files that produce the visualizations, and a Docker image that manages the internal configuration and dependency map of multiple tools. VIBES software and workflow can be found at <ext-link xlink:href="https://github.com/TravisWheelerLab/VIBES" ext-link-type="uri">https://github.com/TravisWheelerLab/VIBES</ext-link>.</p>
    </sec>
    <sec id="SEC2-2">
      <title>VIBES components</title>
      <sec id="SEC2-2-1">
        <title>Prophage search component</title>
        <p>The primary component of the VIBES workflow is its prophage search. This component searches for user-provided query prophage sequences within bacterial genomes to identify prophage integrations. Identification of prophage within bacterial genomes is performed using a DNA sequence annotation tool, <italic toggle="yes">nhmmer</italic> (<xref rid="B40" ref-type="bibr">40</xref>), with default settings. User queries are supplied to <italic toggle="yes">nhmmer</italic> via either a multi-FASTA file containing single sequences or a Stockholm-formatted file containing multiple sequence alignments. When provided with multiple sequence alignment queries, VIBES automatically generates query profiles. Though <italic toggle="yes">nhmmer</italic> is slower than <italic toggle="yes">blastn</italic> (<xref rid="B44" ref-type="bibr">44</xref>), <italic toggle="yes">nhmmer</italic>’s improved sensitivity in the face of high sequence divergence and neutral mutation (<xref rid="B40" ref-type="bibr">40</xref>) is useful in the context of prophages, which can mutate at rates comparable to single-stranded RNA viruses during lytic replication (<xref rid="B45" ref-type="bibr">45</xref>) and may show substantial divergence from query sequences. In general, any matches to a query prophage that fail to meet an <italic toggle="yes">E</italic>-value threshold (1e−5 by default) are discarded. Multiple matches to a single target sequence are adjudicated using a method borrowed from the <italic toggle="yes">dfamscan</italic> adjudication script used in Dfam (<xref rid="B46" ref-type="bibr">46</xref>): when multiple hits are detected with overlap &gt;75%, the highest-scoring match is retained.</p>
        <p>Sequence annotation tools such as <italic toggle="yes">nhmmer</italic> frequently produce fragmented alignments when presented with sequences highly diverged from the query sequences, particularly when a match contains a large inserted or deleted element relative to its nearest query. As a result, single prophage integrations may be reported as several fragments that lie close to each other on a bacterial genome in <italic toggle="yes">nhmmer</italic> output. To address these potentially fragmented integrations, VIBES includes a post-processing step that examines every match detected on a single bacterial genome, looking for consecutive matches that satisfy all of the following potential fragments must match to the same query phage sequence (Figure <xref rid="F2" ref-type="fig">2A</xref>), occur in the same order on the bacterial genome as on the query (Figure <xref rid="F2" ref-type="fig">2B</xref>), be close to each other on the bacterial genome (Figure <xref rid="F2" ref-type="fig">2Ca</xref>) and overlap minimally on the query phage (Figure <xref rid="F2" ref-type="fig">2Cb</xref>). Gaps between two matches on the query prophage sequence are not penalized, as they may represent large deletions.</p>
        <fig position="float" id="F2">
          <label>Figure 2.</label>
          <caption>
            <p>All conditions that must be met for consecutive matches to be joined (assigned the same integration ID and displayed as one integration in visual output). (<bold>A</bold>) Joined candidates must be assigned to the same query phage. (<bold>B</bold>) Joined candidates must occur in the same order on both the query phage and target bacterial genomes. (<bold>Ca</bold>) Given a query phage genome of length <italic toggle="yes">n</italic>, a match that ends at position <italic toggle="yes">i</italic> on the bacterial genome and a consecutive match that begins at position <italic toggle="yes">j</italic>, two matches are considered near enough for fragment joining if |<italic toggle="yes">i</italic> − <italic toggle="yes">j</italic>| ≤ <italic toggle="yes">n</italic> × <italic toggle="yes">k</italic>, where <italic toggle="yes">k</italic> is a fragment gap threshold value set to 0.25 by default. (<bold>Cb</bold>) Given a fragment whose match to the query viral genome ends at position <italic toggle="yes">s</italic> and a consecutive fragment whose match to the query viral genome begins at position <italic toggle="yes">t</italic>, the fragments are joined only when |<italic toggle="yes">t</italic> − <italic toggle="yes">s</italic>| ≤ <italic toggle="yes">θ</italic>, where <italic toggle="yes">θ</italic> is a constant set to 50 by default. Large gaps between matches on the query prophages are not penalized, as they may represent large deletions.</p>
          </caption>
          <graphic xlink:href="lqae030fig2" position="float"/>
        </fig>
      </sec>
      <sec id="SEC2-2-2">
        <title>Gene annotation of both viral and bacterial genomes</title>
        <p>VIBES provides supplementary context to identification and investigation of prophage integration sites by identifying protein-coding genes in both full bacterial genomes and query prophage sequences. Each bacterial genome is annotated using the annotation tool Prokka (<xref rid="B37" ref-type="bibr">37</xref>) via StaPH-B’s Docker image (<xref rid="B47" ref-type="bibr">47</xref>), supporting gene annotation without requiring users to download or set up sequence databases. Like the prophage search component, each bacterial genome is annotated independently of other genomes, allowing Nextflow to fan out as many parallel Prokka annotation tasks as resources permit.</p>
        <p>VIBES also produces gene annotations for the user-provided prophage sequences with its viral protein-coding gene annotation component. This component uses a translated search tool, BATH (<xref rid="B41" ref-type="bibr">41</xref>), to search a viral protein database against prophage DNA sequences. Translated search tools like BATH do not penalize neutral mutations that change DNA sequences without modifying the encoded protein sequence, making them especially well suited to annotating sequences with high mutation rates, such as viral genomes. BATH’s translated search is also robust to frameshift-inducing insertions or deletions, which can confound other translated search tools. By default, VIBES uses the PHROGs v4 viral gene database (<xref rid="B38" ref-type="bibr">38</xref>) reformatted as a BATH-compatible HMM database, but users can substitute other amino acid sequence or HMM databases as desired.</p>
        <p>Although VIBES was developed with annotating prophage integrations in mind, it is primarily a framework for managing and parallelizing runs of <italic toggle="yes">nhmmer</italic>, Prokka and BATH with some prophage-annotation-specific features (the default PHROGs database is phage-specific and the VIBES-SODA visualization suite assumes query sequences are prophage). In particular, the prophage search component simply searches for matches to a query database (prophages by design) in a set of target genomes (bacteria by design) and can easily be repurposed by providing the workflow with a non-phage query sequence file and a set of non-prokaryotic genomes. Likewise, the Prokka bacterial gene annotation and BATH translated amino annotation components can be used to orchestrate massively parallel protein-coding sequence annotation, even on datasets where prophage integrations are not of interest.</p>
      </sec>
      <sec id="SEC2-2-3">
        <title>Interactive visual generation</title>
        <p>To facilitate further analysis and improve human readability of results, VIBES produces dynamic annotation visualizations in HTML files that can be opened in a web browser. These visuals depict prophage annotations, bacterial gene annotations and viral gene annotations. After all other workflow tasks are complete, VIBES generates a collection of HTML files, each of which contains a dynamic visualization built with the SODA sequence annotation visualization library (<xref rid="B48" ref-type="bibr">48</xref>). The visualizations provide an interactive representation of VIBES output, including prophage annotations, bacterial gene annotations and viral gene annotations. An output HTML file is generated for each input bacterial genome, each of which contains interactive annotation visualizations for its associated genome. The HTML files may be opened locally in a web browser, or they may be hosted on a web server. The generated interactive visualizations are described in the ‘Results’ section.</p>
      </sec>
    </sec>
    <sec id="SEC2-3">
      <title>Pf prophage search</title>
      <p>To demonstrate the utility of VIBES as a prophage identification tool, we searched 1072 <italic toggle="yes">Pseudomonas</italic> spp. isolate genomes for integrations of 178 Pf phage variants. <italic toggle="yes">Pseudomonas</italic> spp. genomes were acquired from the <italic toggle="yes">Pseudomonas</italic> Genome Database (v21.1) (<xref rid="B49" ref-type="bibr">49</xref>). Some records in the database were renamed to resolve characters that conflict with standard Bash commands, while three records contained no sequence information. Two of the three empty records were populated with data from GenBank, while the third was determined to be redundant and deleted (see Supplementary Data for details on modifications to data acquired from the <italic toggle="yes">Pseudomonas</italic> Genome Database). Phage sequence coordinates for 179 partial or complete Pf prophages were obtained from a study examining Pf prophage lineages (<xref rid="B12" ref-type="bibr">12</xref>). One hundred twenty-six <italic toggle="yes">P. aeruginosa</italic> genomes were downloaded using accession IDs provided in the study and the relevant sequences were extracted and assigned identifiers (see Supplementary Data for details). One phage sequence, labeled vs015, contained a substantial insertion that extended the length of the sequence to &gt;70 kb. Such a long query sequence requires a prohibitive amount of memory to search for, so vs015 was removed from our prophage database, leaving a total of 178 Pf phage query sequences derived from 126 <italic toggle="yes">P. aeruginosa</italic> genomes.</p>
      <p>Unless otherwise stated, analysis was conducted on the University of Arizona’s Puma HPC cluster on nodes that each contain 94 AMD EPYC 7642 cores and 512 GB of RAM.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Availability of data and scripts</title>
      <p>Supplementary materials documenting scripts and commands used are available at <ext-link xlink:href="https://github.com/TravisWheelerLab/VIBES-paper" ext-link-type="uri">https://github.com/TravisWheelerLab/VIBES-paper</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>Results</title>
    <sec id="SEC3-1">
      <title>Overview of VIBES output features</title>
      <sec id="SEC3-1-1">
        <title>Detected Pf prophages in bacterial genomes</title>
        <p>For each input bacterial genome, VIBES produces a TSV file describing each detected potential prophage sequence in the genome. The TSV fields include matching phage name, match <italic toggle="yes">E</italic>-value, score, match start and end positions on both query (phage) and target (bacterial) sequences, match strand, a match integration ID (see the ‘Prophage search component’ section) and a full-length field populated with True (full length) or False (partial). By default, a match is called full length if it is at least 70% the length of the best-matching prophage sequence, though this parameter can be modified by the user.</p>
      </sec>
      <sec id="SEC3-1-2">
        <title>Bacterial and viral gene annotations</title>
        <p>Annotations of genes within bacterial genomes are generated by Prokka with its default annotation databases and settings. For each bacterial genome, full Prokka output is saved and optionally compressed into a zipped tar archive. Annotations of genes within prophage genomes are output in their own TSV format files with fields identical to those produced for prophage annotations except the match ID field, which is excluded for phage gene annotations.</p>
      </sec>
      <sec id="SEC3-1-3">
        <title>Interactive HTML visual output</title>
        <p>After each workflow process has completed, VIBES produces the SODA-based HTML visualization files. The interactive representations of the workflow’s output allow users to investigate annotations in a bacterial genome and potential prophages with the following components.</p>
        <sec id="SEC3-1-3-1">
          <title>Bacterial chromosome plots (Figure <xref rid="F3" ref-type="fig">3B</xref>)</title>
          <p>The visualizations include both circular and linear representations of the bacterial chromosome. Both representations of the chromosome are marked with detected viral integrations (yellow, two outer circles) and bacterial genes (blue, two inner circles) to assist in analysis of integrations and phage landing sites. Hovering over a blue bacterial gene marker displays the name of the gene, while hovering over a yellow phage integration marker displays the name of the prophage. Users can select a viral integration to inspect it more closely (see the ‘Position occurrence plot’ section). Users can zoom in on the chromosome and click and drag to pan across the genome, making gene or integration annotations larger and easier to interact with; simultaneously, the currently visible portion of the genome is highlighted in gray across the chromosome along top of the page. The circular genome can be changed to a linear representation, and vice versa, by clicking the linear button below the interactive chromosome.</p>
          <fig position="float" id="F3">
            <label>Figure 3.</label>
            <caption>
              <p>Example VIBES interactive annotation visualization page, displaying a bacterial replicon with gene and prophage annotations, where the selected integration falls on the closest-matching viral genome, and viral gene annotations. (<bold>A</bold>) The full interactive visualization page. (<bold>B</bold>) The bacterial replicon plot includes two modes to represent a selected bacterial replicon: linear and circular, both marked with integration and gene annotations. (<bold>C</bold>) The position occurrence plot displays information about a selected integration, related integrations and prophage gene annotations. (<bold>D</bold>) The query phage gene annotation table contains detailed information about gene annotations on the closest-matching user-provided phage genome.</p>
            </caption>
            <graphic xlink:href="lqae030fig3" position="float"/>
          </fig>
        </sec>
        <sec id="SEC3-1-3-2">
          <title>Position occurrence plot (Figure <xref rid="F3" ref-type="fig">3C</xref>)</title>
          <p>To assist users in investigating patterns of phage integration, a position-specific occurrence plot is displayed for a selected integration. The selected integration may be changed by clicking on a corresponding glyph in the genome annotation chart or via the drop-down input at the top of the plot. The <italic toggle="yes">x</italic>-axis of the plot corresponds to each position (nucleotide) in a query phage sequence, while the <italic toggle="yes">y</italic>-axis displays a count at each position summing every occurrence of that position in every integration in the dataset, emphasizing regions of a phage sequence that most often integrate into host genomes. The blue shaded region along the <italic toggle="yes">x</italic>-axis displays the extent of the currently selected integration on the query sequence it matched to. Yellow bars over the <italic toggle="yes">x</italic>-axis show where any other integrations matching to the same query phage on the selected bacterial genome matched to the query, indicating regions of the phage integrated repeatedly into the same genome. The yellow bars indicating where other integrations of the same phage fall on the viral genome can be hidden by clicking the hide-related button located under the position occurrence plot. Under the <italic toggle="yes">x</italic>-axis, red bars display where viral gene annotations fall on the phage genome. Hovering over a viral gene annotation bar shows the name of the gene, while clicking on it highlights its row on the query phage gene annotation table.</p>
        </sec>
        <sec id="SEC3-1-3-3">
          <title>Query phage gene annotation table (Figure <xref rid="F3" ref-type="fig">3D</xref>)</title>
          <p>At the bottom of the visualization is a table of viral protein-coding gene annotations on query phage sequence most closely matching the currently selected integration. The phage gene annotation table contains a row for each annotated gene displaying the gene name, start and end positions on the query phage genome, annotation <italic toggle="yes">e</italic>-value, start and end positions relative to the reference gene amino acid sequence, and an alignment figure that visually depicts the extent of the match on the query phage sequence (blue line) compared to the reference amino acid sequence (red line).</p>
        </sec>
      </sec>
    </sec>
    <sec id="SEC3-2">
      <title>Comparison to other prophage annotation tools</title>
      <p>To assess performance of the workflow on known prophages, we ran VIBES against two reference <italic toggle="yes">P. aeruginosa</italic> genomes, PAO1 and UCBPP-PA14, which contain Pf4 (<xref rid="B50" ref-type="bibr">50</xref>) and Pf5 (<xref rid="B51" ref-type="bibr">51</xref>), respectively (Table <xref rid="tbl2" ref-type="table">2</xref>). Both genome sequences were obtained from the <italic toggle="yes">Pseudomonas</italic> Genome Database (<xref rid="B49" ref-type="bibr">49</xref>). Pf4 and Pf5 prophages were extracted from their hosts and provided to VIBES as queries. To assess the performance of VIBES relative to other prophage annotation tools, we submitted the genome sequences of PAO1 and UCBPP-PA14 to DBSCAN-SWA and PHASTEST through their web servers. We also ran geNomad (<xref rid="B35" ref-type="bibr">35</xref>) via its Docker container on the same HPC system VIBES was run on. All these tools use <italic toggle="yes">de novo</italic> annotation databases to annotate prophage sequences, and so are not directly comparable to VIBES, which depends on the user-provided query library. In this test, VIBES was given the perfect query sequence for each bacterial genome, so the evaluation is primarily useful to understand runtime; in general, VIBES will be as sensitive as the tool it uses to perform sequence alignment (<italic toggle="yes">nhmmer</italic>). We attempted to also submit both genomes to Prophage Hunter, but its web server is no longer available and issues encountered during local installation prevented its assessment.</p>
      <table-wrap position="float" id="tbl2">
        <label>Table 2.</label>
        <caption>
          <p>Summary tool runtime and results on PAO1 and UCBPP-PA14</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Tool</th>
              <th rowspan="1" colspan="1">PAO1 runtime (s)</th>
              <th rowspan="1" colspan="1">PA14 runtime (s)</th>
              <th rowspan="1" colspan="1">PAO1 prophage</th>
              <th rowspan="1" colspan="1">UCBPP-PA14 prophage</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">DBSCAN-SWA</td>
              <td rowspan="1" colspan="1">387</td>
              <td rowspan="1" colspan="1">414</td>
              <td rowspan="1" colspan="1">None</td>
              <td rowspan="1" colspan="1">None</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">geNomad</td>
              <td rowspan="1" colspan="1">266</td>
              <td rowspan="1" colspan="1">269</td>
              <td rowspan="1" colspan="1">1 caudovirus, 1 inovirus</td>
              <td rowspan="1" colspan="1">1 inovirus, 1 caudovirus</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PHASTEST</td>
              <td rowspan="1" colspan="1">536</td>
              <td rowspan="1" colspan="1">552</td>
              <td rowspan="1" colspan="1">1 intact YMC11, 1 intact Pf1</td>
              <td rowspan="1" colspan="1">1 incomplete YMC11, 1 intact Pf1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">VIBES</td>
              <td rowspan="1" colspan="1">880 (both)</td>
              <td rowspan="1" colspan="1">880 (both)</td>
              <td rowspan="1" colspan="1">1 full (Pf4)</td>
              <td rowspan="1" colspan="1">1 full (Pf5)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="T2TFN1">
            <p>VIBES was supplied with Pf4 and Pf5 as prophage queries.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>VIBES was run on default settings and set to filter out results &lt;1 kb. VIBES ran its searches in parallel, completing both in 880 s. As expected, VIBES recovers a full-length (13.6kb) Pf4 integration in PAO1 spanning from PA0714 to PA0729.1 (<xref rid="B50" ref-type="bibr">50</xref>) and a full-length Pf5 (10.9kb) integration in UCBPP-PA14 spanning from PA14_48870 to PA14_49040 (<xref rid="B51" ref-type="bibr">51</xref>). Notably, VIBES did not identify any other sequences in PAO1 or PA14 that matched to Pf4 or Pf5 and were long enough to pass a 1-kb filter. PHASTEST recovered one Pf1 integration, which it ranked intact, in a 15.8-kb window centered on the location of Pf4 in PAO1 and one Pf1 integration, ranked intact, in a 18.2-kb window centered on Pf5 in UCBPP-PA14. In PAO1, geNomad identified one inovirus spanning from PA0716.1 (<italic toggle="yes">pf4r</italic>) to PA0728.1 (<italic toggle="yes">pfiA</italic>) with a length of 9 kb, while in UCBPP-PA14 geNomad identified one inovirus with a length of 11 kb spanning from PA14_48850 to PA14_49010. DBSCAN-SWA did not detect prophages in either genome, but this could occur if its <italic toggle="yes">de novo</italic> annotation database does not contain queries homologous to Pf4 or Pf5.</p>
    </sec>
    <sec id="SEC3-3">
      <title>Application to <italic toggle="yes">Pseudomonas</italic> dataset</title>
      <p>To explore the utility of the VIBES workflow for identifying (possibly fragmented) phage integrations within bacterial isolates, we applied the workflow to a dataset composed of 1072 publicly available <italic toggle="yes">Pseudomonas</italic> spp. genomes obtained from the <italic toggle="yes">Pseudomonas</italic> Genome Database (v21.1) (<xref rid="B49" ref-type="bibr">49</xref>) and 178 Pf phage variants published in a study on Pf phage lineages (<xref rid="B12" ref-type="bibr">12</xref>). Nextflow reported that the prophage detection component of the workflow consumed 13 526.3 CPU hours across 2099 tasks in its prophage search component, 398.8 CPU hours across 1072 tasks in its bacterial gene annotation component and 49.7 CPU hours across 539 tasks in its viral gene annotation component, totaling 13 974.8 CPU hours consumed across a total of 3710 tasks (more details on resource usage can be found in Table <xref rid="tbl3" ref-type="table">3</xref>).</p>
      <table-wrap position="float" id="tbl3">
        <label>Table 3.</label>
        <caption>
          <p>Resource usage</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Component</th>
              <th rowspan="1" colspan="1">Total CPU hours</th>
              <th rowspan="1" colspan="1">Tasks run</th>
              <th rowspan="1" colspan="1">Most expensive process</th>
              <th rowspan="1" colspan="1">CPUs allocated</th>
              <th rowspan="1" colspan="1">Mean RAM</th>
              <th rowspan="1" colspan="1">Mean runtime (min)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Prophage search</td>
              <td align="center" rowspan="1" colspan="1">13 526.3</td>
              <td rowspan="1" colspan="1">2099</td>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">nhmmer</italic>
              </td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">36.8 GB</td>
              <td align="center" rowspan="1" colspan="1">412.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Bacterial gene annotation</td>
              <td align="center" rowspan="1" colspan="1">398.8</td>
              <td rowspan="1" colspan="1">1072</td>
              <td rowspan="1" colspan="1">Prokka</td>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">901.2 MB</td>
              <td align="center" rowspan="1" colspan="1">3.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Viral protein annotation</td>
              <td align="center" rowspan="1" colspan="1">49.7</td>
              <td rowspan="1" colspan="1">539</td>
              <td rowspan="1" colspan="1">BATH</td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">403.5 MB</td>
              <td align="center" rowspan="1" colspan="1">8.6</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="T3TFN1">
            <p>CPUs allocated, mean RAM and mean runtime all display values for the most expensive process in each component, as the computational cost of other elements was negligible. GB stands for gigabyte and MB stands for megabyte.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>In our input dataset of 1072 target <italic toggle="yes">Pseudomonas</italic> spp. genomes and 178 query Pf phage variants, VIBES reported 517 full-length Pf phage integrations and 51 386 partial hits. Of the 51 903 hits identified, 1398 were made up of two or more joined fragments. The vast majority of reported hits were &lt;1500 nucleotides in length. To reduce the incidence of short, ambiguous hits (which may have been matches to homologous bacterial genes or to regions of bacterial genome erroneously included on the terminal ends of prophage queries), we discarded any hit that mapped to a query prophage region containing &lt;2 genes annotated by the pipeline’s viral protein-coding gene component. The per-match gene count filter reduced the number of partial hits from 51 386 to 13 850 likely integrations with a mean and median length of 5095 and 2404 nucleotides, respectively (Figure <xref rid="F4" ref-type="fig">4</xref>). A histogram of gene counts per likely integration is available in Figure <xref rid="F5" ref-type="fig">5</xref>.</p>
      <fig position="float" id="F4">
        <label>Figure 4.</label>
        <caption>
          <p>Integration length bin plot. Counts of likely integrations binned by length, where joined integrations were summed together. The <italic toggle="yes">y</italic>-axis uses a log scale due to the large number of short integrations identified.</p>
        </caption>
        <graphic xlink:href="lqae030fig4" position="float"/>
      </fig>
      <fig position="float" id="F5">
        <label>Figure 5.</label>
        <caption>
          <p>Distribution of genes per match. Each bar represents how many matches (among the 51 903 total initially reported by the pipeline) mapped to a region on the query prophage annotated with the number of genes labeled on the <italic toggle="yes">x</italic>-axis. Thirteen thousand eight hundred fifty matches mapped to regions annotated with at least two viral protein-coding genes.</p>
        </caption>
        <graphic xlink:href="lqae030fig5" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>Discussion</title>
    <p>Here, we have introduced a new software package that conveniently manages the workflow of annotating an arbitrarily large number of bacterial genomes, with special emphasis on identification of prophages. The VIBES workflow produces output annotation TSVs that are easy to load into a spreadsheet viewer or parse programmatically, along with helpful interactive HTML visualizations that facilitate analysis of identified prophages, their landing sites and protein-coding genes on query phage sequences. VIBES also provides a basic framework for the management of general-purpose, large-scale annotation projects.</p>
    <sec id="SEC4-1">
      <title>Recommended usage</title>
      <p>VIBES is best suited to conduct large-scale analysis of relatively well-characterized prophages in cluster or cloud computing environments where parallelization of search processes yields the largest gains, and where the impact of its convenience features (prerequisite management with Docker/Singularity and job orchestration and automated job management via Nextflow) is most pronounced. We recommend that users source query prophage sequences from manually curated databases when possible, to avoid odd phage–bacteria boundary effects that can occur during <italic toggle="yes">de novo</italic> annotation. If users instead use predicted prophage regions as queries, we recommend that they use a higher minimum hit length threshold and make use of a script available in the VIBES repository, which filters out matches that do not contain an adjustable number of viral genes. VIBES is also well suited to large-scale analyses of homologous sequences shared between prophages and host genomes, given the high sensitivity of <italic toggle="yes">nhmmer</italic> search to distant homology (<xref rid="B40" ref-type="bibr">40</xref>) relative to other sequence similarity search software.</p>
      <p>VIBES may also be useful as a secondary step in <italic toggle="yes">de novo</italic> prophage annotation. Other tools, such as PHASTEST (<xref rid="B36" ref-type="bibr">36</xref>), are well suited to identifying unknown prophage integrations, but provide relatively coarse annotations. Once integrations have been coarsely identified and users have a notion of what prophage sequences to supply as queries, VIBES is relatively well suited to more precisely determine prophage strain and integration boundaries if prophage regions are provided as target sequences.</p>
    </sec>
    <sec id="SEC4-2">
      <title>Alternative use of the VIBES workflow</title>
      <p>To a large degree, VIBES is a workflow that coordinates sequence similarity search and bacterial genome annotation when supplied with target and query sequences. The only VIBES components that are specific to annotation of prophage in bacterial genomes are Prokka (<xref rid="B37" ref-type="bibr">37</xref>) annotation (which requires bacterial sequence input) and visualization generation (which assumes that targets are bacterial genomes and queries are prophages). The core input to VIBES is simply target sequences (in FASTA format) and queries (in either multi-FASTA for a set of sequences or Stockholm for a set of alignments). As a result, users are essentially free to use VIBES to conduct searches against nucleotide sequences as they see fit, so long as they specify query sequence type (DNA, RNA or amino) and disable incompatible workflow components through the VIBES configuration file.</p>
    </sec>
    <sec id="SEC4-3">
      <title>Future extensions</title>
      <p>Here, we briefly discuss some limitations of the VIBES workflow that could be addressed by future extensions of the workflow. These limitations are discussed in more detail in the VIBES documentation, available at <ext-link xlink:href="https://github.com/TravisWheelerLab/VIBES" ext-link-type="uri">https://github.com/TravisWheelerLab/VIBES</ext-link>.</p>
      <sec id="SEC4-3-1">
        <title><italic toggle="yes">Att</italic> site annotation</title>
        <p>A common signal of phage integration is the presence of attachment (<italic toggle="yes">att</italic>) sites, two copies of which—<italic toggle="yes">attP</italic> and <italic toggle="yes">attB</italic>, carried on the phage genome and bacterial genome, respectively—flank integrated prophages. These leave a distinctive signal of flanking direct repeats, but this signal is not detected or annotated in the initial VIBES release. As <italic toggle="yes">att</italic> sites are of interest to prophage researchers and are annotated by some prophage annotation tools (<xref rid="B26" ref-type="bibr">26</xref>,<xref rid="B52" ref-type="bibr">52</xref>), extending the VIBES feature set to include <italic toggle="yes">att</italic> site annotation is a high priority for future extensions of the workflow.</p>
      </sec>
      <sec id="SEC4-3-2">
        <title>Further prophage verification</title>
        <p>A major limitation of the VIBES workflow is its limited means of verifying that query prophage sequence represents a complete or partial prophage sequence, rather than a homologous non-phage region of the host genome. Currently, VIBES employs relatively simple methods of analyzing ambiguous sequences via its interactive visual output, its complete/partial classification and its per-match gene count filtering. While this may be desirable in some analyses, such as investigations of homologous regions shared by prophages and their hosts, addressing this limitation is a high priority for future iterations of the workflow.</p>
      </sec>
      <sec id="SEC4-3-3">
        <title><italic toggle="yes">De novo</italic> annotation support</title>
        <p>The default VIBES workflow does little to support <italic toggle="yes">de novo</italic> annotation of phage sequences, in which bacterial genomes are scanned for a broad range of reference prophages. Currently, to conduct such an analysis with VIBES, users would have to identify or construct a file containing a diverse set of known temperate phage genomes or multiple sequence alignments of related phage genomes. <italic toggle="yes">De novo</italic> annotation is further hampered by the lack of further analysis of potential prophages identified by VIBES, discussed above, which makes it more difficult to discern prophage regions from homologous bacterial sequences, especially when given a diverse set of temperate phage queries.</p>
      </sec>
      <sec id="SEC4-3-4">
        <title>Support for other search tools</title>
        <p>Though the <italic toggle="yes">nhmmer</italic> search algorithm is more sensitive to distant homology than other search algorithms (<xref rid="B40" ref-type="bibr">40</xref>), it is relatively computationally expensive. Indeed, viral sequence annotation tools that use HMMER search algorithms have been demonstrated to be among the slowest annotation techniques (<xref rid="B53" ref-type="bibr">53</xref>). This limitation can be addressed through the addition of a broader choice of sequence similarity search tools with less expected sensitivity and resource usage, such as LAST (<xref rid="B54" ref-type="bibr">54</xref>) or <italic toggle="yes">blastn</italic> (<xref rid="B44" ref-type="bibr">44</xref>).</p>
      </sec>
    </sec>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>Acknowledgements</title>
    <p>We are grateful to George Lesica for his early guidance in building Nextflow workflows. We also thank Elizabeth Burgener, Julie Portois and Paul Bollyky for sharing their data and analysis for use in evaluating VIBES during development. We also gratefully acknowledge the computational resources and expert administration provided by the University of Montana’s Griz Shared Computing Cluster (GSCC) and HPC resources supported by the University of Arizona TRIF (Technology and Research Initiative Fund), UITS (University Information Technology Services) and RII (Office of Research, Innovation and Impact), and maintained by the University of Arizona Research Technologies Department.</p>
    <p><italic toggle="yes">Author contributions</italic>: C.J.C. developed the workflow software and performed all experiments. J.W.R. developed the visualization software component. P.R.S. and A.K.S. guided phage-specific analysis requirements and data acquisition. T.J.W. designed the software and guided all research efforts. C.J.C and T.J.W. wrote the paper. All authors edited and approved the final manuscript.</p>
  </ack>
  <sec sec-type="data-availability" id="SEC5">
    <title>Data availability</title>
    <p>Supplementary materials documenting scripts and commands used are available at <ext-link xlink:href="https://github.com/TravisWheelerLab/VIBES-paper" ext-link-type="uri">https://github.com/TravisWheelerLab/VIBES-paper</ext-link>, <ext-link xlink:href="https://zenodo.org/doi/10.5281/zenodo.10826544" ext-link-type="uri">https://zenodo.org/doi/10.5281/zenodo.10826544</ext-link> (VIBES software) and <ext-link xlink:href="https://zenodo.org/doi/10.5281/zenodo.10826552" ext-link-type="uri">https://zenodo.org/doi/10.5281/zenodo.10826552</ext-link> (scripts/notes for article figures/tables).</p>
  </sec>
  <sec id="SEC7">
    <title>Funding</title>
    <p>National Institute of General Medical Sciences [R01GM132600 to C.J.C., J.W.R. and T.J.W.]; Department of Energy’s Office of Biological and Environmental Research [DE-SC0021216 to C.J.C., J.W.R. and T.J.W.]; National Institute of Allergy and Infectious Diseases [R01AI138981 to P.R.S. and A.K.S.].</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. The authors declare no conflicts of interest.</p>
  </sec>
  <ref-list id="REF1">
    <title>References</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Suttle</surname>  <given-names>C.A.</given-names></string-name></person-group>  <article-title>Marine viruses—major players in the global ecosystem</article-title>. <source>Nat. Rev. Microbiol.</source>  <year>2007</year>; <volume>5</volume>:<fpage>801</fpage>–<lpage>812</lpage>.<pub-id pub-id-type="pmid">17853907</pub-id>
</mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tock</surname>  <given-names>M.R.</given-names></string-name>, <string-name><surname>Dryden</surname>  <given-names>D.T.F.</given-names></string-name></person-group>  <article-title>The biology of restriction and anti-restriction</article-title>. <source>Curr. Opin. Microbiol.</source>  <year>2005</year>; <volume>8</volume>:<fpage>466</fpage>–<lpage>472</lpage>.<pub-id pub-id-type="pmid">15979932</pub-id>
</mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hille</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Richter</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Wong</surname>  <given-names>S.P.</given-names></string-name>, <string-name><surname>Bratovič</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Ressel</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Charpentier</surname>  <given-names>E.</given-names></string-name></person-group>  <article-title>The biology of CRISPR–Cas: backward and forward</article-title>. <source>Cell</source>. <year>2018</year>; <volume>172</volume>:<fpage>1239</fpage>–<lpage>1259</lpage>.<pub-id pub-id-type="pmid">29522745</pub-id>
</mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Georjon</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Bernheim</surname>  <given-names>A.</given-names></string-name></person-group>  <article-title>The highly diverse antiphage defence systems of bacteria</article-title>. <source>Nat. Rev. Microbiol.</source>  <year>2023</year>; <volume>21</volume>:<fpage>686</fpage>–<lpage>700</lpage>.<pub-id pub-id-type="pmid">37460672</pub-id>
</mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Warwick-Dugdale</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Buchholz</surname>  <given-names>H.H.</given-names></string-name>, <string-name><surname>Allen</surname>  <given-names>M.J.</given-names></string-name>, <string-name><surname>Temperton</surname>  <given-names>B.</given-names></string-name></person-group>  <article-title>Host-hijacking and planktonic piracy: how phages command the microbial high seas</article-title>. <source>Virol. J.</source>  <year>2019</year>; <volume>16</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">30709355</pub-id>
</mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Howard-Varona</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Hargreaves</surname>  <given-names>K.R.</given-names></string-name>, <string-name><surname>Abedon</surname>  <given-names>S.T.</given-names></string-name>, <string-name><surname>Sullivan</surname>  <given-names>M.B.</given-names></string-name></person-group>  <article-title>Lysogeny in nature: mechanisms, impact and ecology of temperate phages</article-title>. <source>ISME J.</source>  <year>2017</year>; <volume>11</volume>:<fpage>1511</fpage>–<lpage>1520</lpage>.<pub-id pub-id-type="pmid">28291233</pub-id>
</mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brüssow</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Canchaya</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Hardt</surname>  <given-names>W.-D.</given-names></string-name></person-group>  <article-title>Phages and the evolution of bacterial pathogens: from genomic rearrangements to lysogenic conversion</article-title>. <source>Microbiol. Mol. Biol. Rev.</source>  <year>2004</year>; <volume>68</volume>:<fpage>560</fpage>–<lpage>602</lpage>.<pub-id pub-id-type="pmid">15353570</pub-id>
</mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bondy-Denomy</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Qian</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Westra</surname>  <given-names>E.R.</given-names></string-name>, <string-name><surname>Buckling</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Guttman</surname>  <given-names>D.S.</given-names></string-name>, <string-name><surname>Davidson</surname>  <given-names>A.R.</given-names></string-name>, <string-name><surname>Maxwell</surname>  <given-names>K.L.</given-names></string-name></person-group>  <article-title>Prophages mediate defense against phage infection through diverse mechanisms</article-title>. <source>ISME J.</source>  <year>2016</year>; <volume>10</volume>:<fpage>2854</fpage>–<lpage>2866</lpage>.<pub-id pub-id-type="pmid">27258950</pub-id>
</mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wagner</surname>  <given-names>P.L.</given-names></string-name>, <string-name><surname>Waldor</surname>  <given-names>M.K.</given-names></string-name></person-group>  <article-title>Bacteriophage control of bacterial virulence</article-title>. <source>Infect. Immun.</source>  <year>2002</year>; <volume>70</volume>:<fpage>3985</fpage>–<lpage>3993</lpage>.<pub-id pub-id-type="pmid">12117903</pub-id>
</mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roux</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Krupovic</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Daly</surname>  <given-names>R.A.</given-names></string-name>, <string-name><surname>Borges</surname>  <given-names>A.L.</given-names></string-name>, <string-name><surname>Nayfach</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Schulz</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Sharrar</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Matheus Carnevali</surname>  <given-names>P.B.</given-names></string-name>, <string-name><surname>Cheng</surname>  <given-names>J.-F.</given-names></string-name>, <string-name><surname>Ivanova</surname>  <given-names>N.N.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Cryptic inoviruses revealed as pervasive in bacteria and archaea across Earth’s biomes</article-title>. <source>Nat. Microbiol.</source>  <year>2019</year>; <volume>4</volume>:<fpage>1895</fpage>–<lpage>1906</lpage>.<pub-id pub-id-type="pmid">31332386</pub-id>
</mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Secor</surname>  <given-names>P.R.</given-names></string-name>, <string-name><surname>Burgener</surname>  <given-names>E.B.</given-names></string-name>, <string-name><surname>Kinnersley</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Jennings</surname>  <given-names>L.K.</given-names></string-name>, <string-name><surname>Roman-Cruz</surname>  <given-names>V.</given-names></string-name>, <string-name><surname>Popescu</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Van Belleghem</surname>  <given-names>J.D.</given-names></string-name>, <string-name><surname>Haddock</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Copeland</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Michaels</surname>  <given-names>L.A.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Pf bacteriophage and their impact on <italic toggle="yes">Pseudomonas</italic> virulence, mammalian immunity, and chronic infections</article-title>. <source>Front. Immunol.</source>  <year>2020</year>; <volume>11</volume>:<fpage>244</fpage>.<pub-id pub-id-type="pmid">32153575</pub-id>
</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fiedoruk</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Zakrzewska</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Daniluk</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Piktel</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Chmielewska</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Bucki</surname>  <given-names>R.</given-names></string-name></person-group>  <article-title>Two lineages of <italic toggle="yes">Pseudomonas aeruginosa</italic> filamentous phages: structural uniformity over integration preferences</article-title>. <source>Genome Biol. Evol.</source>  <year>2020</year>; <volume>12</volume>:<fpage>1765</fpage>–<lpage>1781</lpage>.<pub-id pub-id-type="pmid">32658245</pub-id>
</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Knezevic</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Voet</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Lavigne</surname>  <given-names>R.</given-names></string-name></person-group>  <article-title>Prevalence of Pf1-like (pro)phage genetic elements among <italic toggle="yes">Pseudomonas aeruginosa</italic> isolates</article-title>. <source>Virology</source>. <year>2015</year>; <volume>483</volume>:<fpage>64</fpage>–<lpage>71</lpage>.<pub-id pub-id-type="pmid">25965796</pub-id>
</mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Tang</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Zeng</surname>  <given-names>Z.</given-names></string-name>, <string-name><surname>Guo</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>X.</given-names></string-name></person-group>  <article-title>Excisionase in Pf filamentous prophage controls lysis–lysogeny decision-making in <italic toggle="yes">Pseudomonas aeruginosa</italic></article-title>. <source>Mol. Microbiol.</source>  <year>2019</year>; <volume>111</volume>:<fpage>495</fpage>–<lpage>513</lpage>.<pub-id pub-id-type="pmid">30475408</pub-id>
</mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wei</surname>  <given-names>Q.</given-names></string-name>, <string-name><surname>Minh</surname>  <given-names>P.N.L.</given-names></string-name>, <string-name><surname>Dötsch</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Hildebrand</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Panmanee</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Elfarash</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Schulz</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Plaisance</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Charlier</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Hassett</surname>  <given-names>D.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Global regulation of gene expression by OxyR in an important human opportunistic pathogen</article-title>. <source>Nucleic Acids Res.</source>  <year>2012</year>; <volume>40</volume>:<fpage>4320</fpage>–<lpage>4333</lpage>.<pub-id pub-id-type="pmid">22275523</pub-id>
</mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Song</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Sheng</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Zhu</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Kim</surname>  <given-names>J.-S.</given-names></string-name>, <string-name><surname>Wood</surname>  <given-names>T.K.</given-names></string-name></person-group>  <article-title>Substrate binding protein DppA1 of ABC transporter DppBCDF increases biofilm formation in <italic toggle="yes">Pseudomonas aeruginosa</italic> by inhibiting Pf5 prophage lysis</article-title>. <source>Front. Microbiol.</source>  <year>2018</year>; <volume>9</volume>:<fpage>30</fpage>.<pub-id pub-id-type="pmid">29416528</pub-id>
</mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Castang</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Dove</surname>  <given-names>S.L.</given-names></string-name></person-group>  <article-title>Basis for the essentiality of H-NS family members in <italic toggle="yes">Pseudomonas aeruginosa</italic></article-title>. <source>J. Bacteriol.</source>  <year>2012</year>; <volume>194</volume>:<fpage>5101</fpage>–<lpage>5109</lpage>.<pub-id pub-id-type="pmid">22821971</pub-id>
</mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rice</surname>  <given-names>S.A.</given-names></string-name>, <string-name><surname>Tan</surname>  <given-names>C.H.</given-names></string-name>, <string-name><surname>Mikkelsen</surname>  <given-names>P.J.</given-names></string-name>, <string-name><surname>Kung</surname>  <given-names>V.</given-names></string-name>, <string-name><surname>Woo</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Tay</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Hauser</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>McDougald</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Webb</surname>  <given-names>J.S.</given-names></string-name>, <string-name><surname>Kjelleberg</surname>  <given-names>S.</given-names></string-name></person-group>  <article-title>The biofilm life cycle and virulence of <italic toggle="yes">Pseudomonas aeruginosa</italic> are dependent on a filamentous prophage</article-title>. <source>ISME J.</source>  <year>2009</year>; <volume>3</volume>:<fpage>271</fpage>–<lpage>282</lpage>.<pub-id pub-id-type="pmid">19005496</pub-id>
</mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarafder</surname>  <given-names>A.K.</given-names></string-name>, <string-name><surname>von Kügelgen</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Mellul</surname>  <given-names>A.J.</given-names></string-name>, <string-name><surname>Schulze</surname>  <given-names>U.</given-names></string-name>, <string-name><surname>Aarts</surname>  <given-names>D.G.A.L.</given-names></string-name>, <string-name><surname>Bharat</surname>  <given-names>T.A.M.</given-names></string-name></person-group>  <article-title>Phage liquid crystalline droplets form occlusive sheaths that encapsulate and protect infectious rod-shaped bacteria</article-title>. <source>Proc. Natl Acad. Sci. U.S.A.</source>  <year>2020</year>; <volume>117</volume>:<fpage>4724</fpage>–<lpage>4731</lpage>.<pub-id pub-id-type="pmid">32071243</pub-id>
</mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Secor</surname>  <given-names>P.R.</given-names></string-name>, <string-name><surname>Sweere</surname>  <given-names>J.M.</given-names></string-name>, <string-name><surname>Michaels</surname>  <given-names>L.A.</given-names></string-name>, <string-name><surname>Malkovskiy</surname>  <given-names>A.V.</given-names></string-name>, <string-name><surname>Lazzareschi</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Katznelson</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Rajadas</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Birnbaum</surname>  <given-names>M.E.</given-names></string-name>, <string-name><surname>Arrigoni</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Braun</surname>  <given-names>K.R.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Filamentous bacteriophage promote biofilm assembly and function</article-title>. <source>Cell Host Microbe</source>. <year>2015</year>; <volume>18</volume>:<fpage>549</fpage>–<lpage>559</lpage>.<pub-id pub-id-type="pmid">26567508</pub-id>
</mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burgener</surname>  <given-names>E.B.</given-names></string-name>, <string-name><surname>Sweere</surname>  <given-names>J.M.</given-names></string-name>, <string-name><surname>Bach</surname>  <given-names>M.S.</given-names></string-name>, <string-name><surname>Secor</surname>  <given-names>P.R.</given-names></string-name>, <string-name><surname>Haddock</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Jennings</surname>  <given-names>L.K.</given-names></string-name>, <string-name><surname>Marvig</surname>  <given-names>R.L.</given-names></string-name>, <string-name><surname>Johansen</surname>  <given-names>H.K.</given-names></string-name>, <string-name><surname>Rossi</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Cao</surname>  <given-names>X.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Filamentous bacteriophages are associated with chronic <italic toggle="yes">Pseudomonas</italic> lung infections and antibiotic resistance in cystic fibrosis</article-title>. <source>Sci. Transl. Med.</source>  <year>2019</year>; <volume>11</volume>:<fpage>eaau9748</fpage>.<pub-id pub-id-type="pmid">30996083</pub-id>
</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sweere</surname>  <given-names>J.M.</given-names></string-name>, <string-name><surname>Van Belleghem</surname>  <given-names>J.D.</given-names></string-name>, <string-name><surname>Ishak</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Bach</surname>  <given-names>M.S.</given-names></string-name>, <string-name><surname>Popescu</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Sunkari</surname>  <given-names>V.</given-names></string-name>, <string-name><surname>Kaber</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Manasherob</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Suh</surname>  <given-names>G.A.</given-names></string-name>, <string-name><surname>Cao</surname>  <given-names>X.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Bacteriophage trigger antiviral immunity and prevent clearance of bacterial infection</article-title>. <source>Science</source>. <year>2019</year>; <volume>363</volume>:<fpage>eaat9691</fpage>.<pub-id pub-id-type="pmid">30923196</pub-id>
</mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bach</surname>  <given-names>M.S.</given-names></string-name>, <string-name><surname>de Vries</surname>  <given-names>C.R.</given-names></string-name>, <string-name><surname>Khosravi</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Sweere</surname>  <given-names>J.M.</given-names></string-name>, <string-name><surname>Popescu</surname>  <given-names>M.C.</given-names></string-name>, <string-name><surname>Chen</surname>  <given-names>Q.</given-names></string-name>, <string-name><surname>Demirdjian</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Hargil</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Van Belleghem</surname>  <given-names>J.D.</given-names></string-name>, <string-name><surname>Kaber</surname>  <given-names>G.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Filamentous bacteriophage delays healing of <italic toggle="yes">Pseudomonas</italic>-infected wounds</article-title>. <source>Cell Rep. Med.</source>  <year>2022</year>; <volume>3</volume>:<fpage>100656</fpage>.<pub-id pub-id-type="pmid">35732145</pub-id>
</mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paez-Espino</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Eloe-Fadrosh</surname>  <given-names>E.A.</given-names></string-name>, <string-name><surname>Pavlopoulos</surname>  <given-names>G.A.</given-names></string-name>, <string-name><surname>Thomas</surname>  <given-names>A.D.</given-names></string-name>, <string-name><surname>Huntemann</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Mikhailova</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Rubin</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Ivanova</surname>  <given-names>N.N.</given-names></string-name>, <string-name><surname>Kyrpides</surname>  <given-names>N.C.</given-names></string-name></person-group>  <article-title>Uncovering Earth’s virome</article-title>. <source>Nature</source>. <year>2016</year>; <volume>536</volume>:<fpage>425</fpage>–<lpage>430</lpage>.<pub-id pub-id-type="pmid">27533034</pub-id>
</mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arndt</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Grant</surname>  <given-names>J.R.</given-names></string-name>, <string-name><surname>Marcu</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Sajed</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Pon</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Liang</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Wishart</surname>  <given-names>D.S.</given-names></string-name></person-group>  <article-title>PHASTER: a better, faster version of the PHAST phage search tool</article-title>. <source>Nucleic Acids Res.</source>  <year>2016</year>; <volume>44</volume>:<fpage>W16</fpage>–<lpage>W21</lpage>.<pub-id pub-id-type="pmid">27141966</pub-id>
</mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gan</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Si</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Yang</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Chen</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Ren</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Wu</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>F.</given-names></string-name></person-group>  <article-title>DBSCAN-SWA: an integrated tool for rapid prophage detection and annotation</article-title>. <source>Front. Genet.</source>  <year>2022</year>; <volume>13</volume>:<fpage>885048</fpage>.<pub-id pub-id-type="pmid">35518360</pub-id>
</mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roux</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Enault</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Hurwitz</surname>  <given-names>B.L.</given-names></string-name>, <string-name><surname>Sullivan</surname>  <given-names>M.B.</given-names></string-name></person-group>  <article-title>VirSorter: mining viral signal from microbial genomic data</article-title>. <source>PeerJ</source>. <year>2015</year>; <volume>3</volume>:<fpage>e985</fpage>.<pub-id pub-id-type="pmid">26038737</pub-id>
</mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Ahlgren</surname>  <given-names>N.A.</given-names></string-name>, <string-name><surname>Lu</surname>  <given-names>Y.Y.</given-names></string-name>, <string-name><surname>Fuhrman</surname>  <given-names>J.A.</given-names></string-name>, <string-name><surname>Sun</surname>  <given-names>F.</given-names></string-name></person-group>  <article-title>VirFinder: a novel <italic toggle="yes">k</italic>-mer based tool for identifying viral sequences from assembled metagenomic data</article-title>. <source>Microbiome</source>. <year>2017</year>; <volume>5</volume>:<fpage>69</fpage>.<pub-id pub-id-type="pmid">28683828</pub-id>
</mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Song</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Deng</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Ahlgren</surname>  <given-names>N.A.</given-names></string-name>, <string-name><surname>Fuhrman</surname>  <given-names>J.A.</given-names></string-name>, <string-name><surname>Li</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Xie</surname>  <given-names>X.</given-names></string-name>, <string-name><surname>Poplin</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Sun</surname>  <given-names>F.</given-names></string-name></person-group>  <article-title>Identifying viruses from metagenomic data using deep learning</article-title>. <source>Quant. Biol.</source>  <year>2020</year>; <volume>8</volume>:<fpage>64</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">34084563</pub-id>
</mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miao</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Hou</surname>  <given-names>T.</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>Y.</given-names></string-name></person-group>  <article-title>Virtifier: a deep learning-based identifier for viral sequences from metagenomes</article-title>. <source>Bioinformatics</source>. <year>2022</year>; <volume>38</volume>:<fpage>1216</fpage>–<lpage>1222</lpage>.<pub-id pub-id-type="pmid">34908121</pub-id>
</mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Bolduc</surname>  <given-names>B.</given-names></string-name>, <string-name><surname>Zayed</surname>  <given-names>A.A.</given-names></string-name>, <string-name><surname>Varsani</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Dominguez-Huerta</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Delmont</surname>  <given-names>T.O.</given-names></string-name>, <string-name><surname>Pratama</surname>  <given-names>A.A.</given-names></string-name>, <string-name><surname>Gazitúa</surname>  <given-names>M.C.</given-names></string-name>, <string-name><surname>Vik</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Sullivan</surname>  <given-names>M.B.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>VirSorter2: a multi-classifier, expert-guided approach to detect diverse DNA and RNA viruses</article-title>. <source>Microbiome</source>. <year>2021</year>; <volume>9</volume>:<fpage>37</fpage>.<pub-id pub-id-type="pmid">33522966</pub-id>
</mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kieft</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>Z.</given-names></string-name>, <string-name><surname>Anantharaman</surname>  <given-names>K.</given-names></string-name></person-group>  <article-title>VIBRANT: automated recovery, annotation and curation of microbial viruses, and evaluation of viral community function from genomic sequences</article-title>. <source>Microbiome</source>. <year>2020</year>; <volume>8</volume>:<fpage>90</fpage>.<pub-id pub-id-type="pmid">32522236</pub-id>
</mixed-citation>
    </ref>
    <ref id="B33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Sun</surname>  <given-names>H.-X.</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Cheng</surname>  <given-names>L.</given-names></string-name>, <string-name><surname>Peng</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Deng</surname>  <given-names>Z.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Hu</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>W.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Prophage Hunter: an integrative hunting tool for active prophages</article-title>. <source>Nucleic Acids Res.</source>  <year>2019</year>; <volume>47</volume>:<fpage>W74</fpage>–<lpage>W80</lpage>.<pub-id pub-id-type="pmid">31114893</pub-id>
</mixed-citation>
    </ref>
    <ref id="B34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amgarten</surname>  <given-names>D.</given-names></string-name>, <string-name><surname>Braga</surname>  <given-names>L.P.P.</given-names></string-name>, <string-name><surname>da Silva</surname>  <given-names>A.M.</given-names></string-name>, <string-name><surname>Setubal</surname>  <given-names>J.C.</given-names></string-name></person-group>  <article-title>MARVEL, a tool for prediction of bacteriophage sequences in metagenomic bins</article-title>. <source>Front. Genet.</source>  <year>2018</year>; <volume>9</volume>:<fpage>304</fpage>.<pub-id pub-id-type="pmid">30131825</pub-id>
</mixed-citation>
    </ref>
    <ref id="B35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Camargo</surname>  <given-names>A.P.</given-names></string-name>, <string-name><surname>Roux</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Schulz</surname>  <given-names>F.</given-names></string-name>, <string-name><surname>Babinski</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Xu</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Hu</surname>  <given-names>B.</given-names></string-name>, <string-name><surname>Chain</surname>  <given-names>P.S.G.</given-names></string-name>, <string-name><surname>Nayfach</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Kyrpides</surname>  <given-names>N.C.</given-names></string-name></person-group>  <article-title>Identification of mobile genetic elements with geNomad</article-title>. <source>Nat. Biotechnol.</source>  <year>2023</year>; <pub-id pub-id-type="doi">10.1038/s41587-023-01953-y</pub-id>.</mixed-citation>
    </ref>
    <ref id="B36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wishart</surname>  <given-names>D.S.</given-names></string-name>, <string-name><surname>Han</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Saha</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Oler</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Peters</surname>  <given-names>H.</given-names></string-name>, <string-name><surname>Grant</surname>  <given-names>J.R.</given-names></string-name>, <string-name><surname>Stothard</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Gautam</surname>  <given-names>V.</given-names></string-name></person-group>  <article-title>PHASTEST: faster than PHASTER, better than PHAST</article-title>. <source>Nucleic Acids Res.</source>  <year>2023</year>; <volume>51</volume>:<fpage>W443</fpage>–<lpage>W450</lpage>.<pub-id pub-id-type="pmid">37194694</pub-id>
</mixed-citation>
    </ref>
    <ref id="B37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Seemann</surname>  <given-names>T.</given-names></string-name></person-group>  <article-title>Prokka: rapid prokaryotic genome annotation</article-title>. <source>Bioinformatics</source>. <year>2014</year>; <volume>30</volume>:<fpage>2068</fpage>–<lpage>2069</lpage>.<pub-id pub-id-type="pmid">24642063</pub-id>
</mixed-citation>
    </ref>
    <ref id="B38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Terzian</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Olo Ndela</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Galiez</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Lossouarn</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Pérez Bucio</surname>  <given-names>R.E.</given-names></string-name>, <string-name><surname>Mom</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Toussaint</surname>  <given-names>A.</given-names></string-name>, <string-name><surname>Petit</surname>  <given-names>M.-A.</given-names></string-name>, <string-name><surname>Enault</surname>  <given-names>F.</given-names></string-name></person-group>  <article-title>PHROG: families of prokaryotic virus proteins clustered using remote homology</article-title>. <source>NAR Genom. Bioinform.</source>  <year>2021</year>; <volume>3</volume>:<fpage>lqab067</fpage>.<pub-id pub-id-type="pmid">34377978</pub-id>
</mixed-citation>
    </ref>
    <ref id="B39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Di Tommaso</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Chatzou</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Floden</surname>  <given-names>E.W.</given-names></string-name>, <string-name><surname>Barja</surname>  <given-names>P.P.</given-names></string-name>, <string-name><surname>Palumbo</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Notredame</surname>  <given-names>C.</given-names></string-name></person-group>  <article-title>Nextflow enables reproducible computational workflows</article-title>. <source>Nat. Biotechnol.</source>  <year>2017</year>; <volume>35</volume>:<fpage>316</fpage>–<lpage>319</lpage>.<pub-id pub-id-type="pmid">28398311</pub-id>
</mixed-citation>
    </ref>
    <ref id="B40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wheeler</surname>  <given-names>T.J.</given-names></string-name>, <string-name><surname>Eddy</surname>  <given-names>S.R.</given-names></string-name></person-group>  <article-title>nhmmer: DNA homology search with profile HMMs</article-title>. <source>Bioinformatics</source>. <year>2013</year>; <volume>29</volume>:<fpage>2487</fpage>–<lpage>2489</lpage>.<pub-id pub-id-type="pmid">23842809</pub-id>
</mixed-citation>
    </ref>
    <ref id="B41">
      <label>41.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Krause</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Shands</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Wheeler</surname>  <given-names>T.J.</given-names></string-name></person-group>  <article-title>Sensitive and error-tolerant annotation of protein-coding DNA with BATH</article-title>. <year>2024</year>; <comment>bioRxiv doi:</comment><comment>01 January 2024, preprint: not peer reviewed</comment><pub-id pub-id-type="doi">10.1101/2023.12.31.573773</pub-id>.</mixed-citation>
    </ref>
    <ref id="B42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Merkel</surname>  <given-names>D.</given-names></string-name></person-group>  <article-title>Docker: lightweight Linux containers for consistent development and deployment</article-title>. <source>Linux J.</source>  <year>2014</year>; <volume>2014</volume>:<fpage>2</fpage>.</mixed-citation>
    </ref>
    <ref id="B43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kurtzer</surname>  <given-names>G.M.</given-names></string-name>, <string-name><surname>Sochat</surname>  <given-names>V.</given-names></string-name>, <string-name><surname>Bauer</surname>  <given-names>M.W.</given-names></string-name></person-group>  <article-title>Singularity: scientific containers for mobility of compute</article-title>. <source>PLoS One</source>. <year>2017</year>; <volume>12</volume>:<fpage>e0177459</fpage>.<pub-id pub-id-type="pmid">28494014</pub-id>
</mixed-citation>
    </ref>
    <ref id="B44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Camacho</surname>  <given-names>C.</given-names></string-name>, <string-name><surname>Coulouris</surname>  <given-names>G.</given-names></string-name>, <string-name><surname>Avagyan</surname>  <given-names>V.</given-names></string-name>, <string-name><surname>Ma</surname>  <given-names>N.</given-names></string-name>, <string-name><surname>Papadopoulos</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Bealer</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Madden</surname>  <given-names>T.L.</given-names></string-name></person-group>  <article-title>BLAST+: architecture and applications</article-title>. <source>BMC Bioinformatics</source>. <year>2009</year>; <volume>10</volume>:<fpage>421</fpage>.<pub-id pub-id-type="pmid">20003500</pub-id>
</mixed-citation>
    </ref>
    <ref id="B45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McElroy</surname>  <given-names>K.E.</given-names></string-name>, <string-name><surname>Hui</surname>  <given-names>J.G.K.</given-names></string-name>, <string-name><surname>Woo</surname>  <given-names>J.K.K.</given-names></string-name>, <string-name><surname>Luk</surname>  <given-names>A.W.S.</given-names></string-name>, <string-name><surname>Webb</surname>  <given-names>J.S.</given-names></string-name>, <string-name><surname>Kjelleberg</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Rice</surname>  <given-names>S.A.</given-names></string-name>, <string-name><surname>Thomas</surname>  <given-names>T.</given-names></string-name></person-group>  <article-title>Strain-specific parallel evolution drives short-term diversification during <italic toggle="yes">Pseudomonas aeruginosa</italic> biofilm formation</article-title>. <source>Proc. Natl Acad. Sci. U.S.A.</source>  <year>2014</year>; <volume>111</volume>:<fpage>E1419</fpage>–<lpage>E1427</lpage>.<pub-id pub-id-type="pmid">24706926</pub-id>
</mixed-citation>
    </ref>
    <ref id="B46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wheeler</surname>  <given-names>T.J.</given-names></string-name>, <string-name><surname>Clements</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Eddy</surname>  <given-names>S.R.</given-names></string-name>, <string-name><surname>Hubley</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Jones</surname>  <given-names>T.A.</given-names></string-name>, <string-name><surname>Jurka</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Smit</surname>  <given-names>A.F.A.</given-names></string-name>, <string-name><surname>Finn</surname>  <given-names>R.D.</given-names></string-name></person-group>  <article-title>Dfam: a database of repetitive DNA based on profile hidden Markov models</article-title>. <source>Nucleic Acids Res.</source>  <year>2012</year>; <volume>41</volume>:<fpage>D70</fpage>–<lpage>D82</lpage>.<pub-id pub-id-type="pmid">23203985</pub-id>
</mixed-citation>
    </ref>
    <ref id="B47">
      <label>47.</label>
      <mixed-citation publication-type="other"><collab>State Public Health Bioinformatics Community</collab>  <article-title>Prokka Docker image</article-title>. <year>2023</year>; <uri xlink:href="https://hub.docker.com/r/staphb/prokka/dockerfile">https://hub.docker.com/r/staphb/prokka/dockerfile</uri>.</mixed-citation>
    </ref>
    <ref id="B48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roddy</surname>  <given-names>J.W.</given-names></string-name>, <string-name><surname>Lesica</surname>  <given-names>G.T.</given-names></string-name>, <string-name><surname>Wheeler</surname>  <given-names>T.J.</given-names></string-name></person-group>  <article-title>SODA: a TypeScript/JavaScript library for visualizing biological sequence annotation</article-title>. <source>NAR Genom. Bioinform.</source>  <year>2022</year>; <volume>4</volume>:<fpage>lqac077</fpage>.<pub-id pub-id-type="pmid">36212708</pub-id>
</mixed-citation>
    </ref>
    <ref id="B49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Winsor</surname>  <given-names>G.L.</given-names></string-name>, <string-name><surname>Griffiths</surname>  <given-names>E.J.</given-names></string-name>, <string-name><surname>Lo</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Dhillon</surname>  <given-names>B.K.</given-names></string-name>, <string-name><surname>Shay</surname>  <given-names>J.A.</given-names></string-name>, <string-name><surname>Brinkman</surname>  <given-names>F.S.L.</given-names></string-name></person-group>  <article-title>Enhanced annotations and features for comparing thousands of <italic toggle="yes">Pseudomonas</italic> genomes in the <italic toggle="yes">Pseudomonas</italic> Genome Database</article-title>. <source>Nucleic Acids Res.</source>  <year>2016</year>; <volume>44</volume>:<fpage>D646</fpage>–<lpage>D653</lpage>.<pub-id pub-id-type="pmid">26578582</pub-id>
</mixed-citation>
    </ref>
    <ref id="B50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Webb</surname>  <given-names>J.S.</given-names></string-name>, <string-name><surname>Lau</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Kjelleberg</surname>  <given-names>S.</given-names></string-name></person-group>  <article-title>Bacteriophage and phenotypic variation in <italic toggle="yes">Pseudomonas aeruginosa</italic> biofilm development</article-title>. <source>J. Bacteriol.</source>  <year>2004</year>; <volume>186</volume>:<fpage>8066</fpage>–<lpage>8073</lpage>.<pub-id pub-id-type="pmid">15547279</pub-id>
</mixed-citation>
    </ref>
    <ref id="B51">
      <label>51.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mooij</surname>  <given-names>M.J.</given-names></string-name>, <string-name><surname>Drenkard</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Llamas</surname>  <given-names>M.A.</given-names></string-name>, <string-name><surname>Vandenbroucke-Grauls</surname>  <given-names>C.M.J.E.</given-names></string-name>, <string-name><surname>Savelkoul</surname>  <given-names>P.H.M.</given-names></string-name>, <string-name><surname>Ausubel</surname>  <given-names>F.M.</given-names></string-name>, <string-name><surname>Bitter</surname>  <given-names>W.</given-names></string-name></person-group>  <article-title>Characterization of the integrated filamentous phage Pf5 and its involvement in small-colony formation</article-title>. <source>Microbiology</source>. <year>2007</year>; <volume>153</volume>:<fpage>1790</fpage>–<lpage>1798</lpage>.<pub-id pub-id-type="pmid">17526836</pub-id>
</mixed-citation>
    </ref>
    <ref id="B52">
      <label>52.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>W.</given-names></string-name>, <string-name><surname>Sun</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Guo</surname>  <given-names>Y.</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>X.</given-names></string-name></person-group>  <article-title>Prophage Tracer: precisely tracing prophages in prokaryotic genomes using overlapping split-read alignment</article-title>. <source>Nucleic Acids Res.</source>  <year>2021</year>; <volume>49</volume>:<fpage>e128</fpage>.<pub-id pub-id-type="pmid">34551431</pub-id>
</mixed-citation>
    </ref>
    <ref id="B53">
      <label>53.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roach</surname>  <given-names>M.J.</given-names></string-name>, <string-name><surname>McNair</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Michalczyk</surname>  <given-names>M.</given-names></string-name>, <string-name><surname>Giles</surname>  <given-names>S.K.</given-names></string-name>, <string-name><surname>Inglis</surname>  <given-names>L.K.</given-names></string-name>, <string-name><surname>Pargin</surname>  <given-names>E.</given-names></string-name>, <string-name><surname>Barylski</surname>  <given-names>J.</given-names></string-name>, <string-name><surname>Roux</surname>  <given-names>S.</given-names></string-name>, <string-name><surname>Decewicz</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Edwards</surname>  <given-names>R.A.</given-names></string-name></person-group>  <article-title>Philympics 2021: prophage predictions perplex programs</article-title>. <source>F1000Research</source>. <year>2022</year>; <volume>10</volume>:<fpage>758</fpage>.</mixed-citation>
    </ref>
    <ref id="B54">
      <label>54.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiełbasa</surname>  <given-names>S.M.</given-names></string-name>, <string-name><surname>Wan</surname>  <given-names>R.</given-names></string-name>, <string-name><surname>Sato</surname>  <given-names>K.</given-names></string-name>, <string-name><surname>Horton</surname>  <given-names>P.</given-names></string-name>, <string-name><surname>Frith</surname>  <given-names>M.C.</given-names></string-name></person-group>  <article-title>Adaptive seeds tame genomic sequence comparison</article-title>. <source>Genome Res.</source>  <year>2011</year>; <volume>21</volume>:<fpage>487</fpage>–<lpage>493</lpage>.<pub-id pub-id-type="pmid">21209072</pub-id>
</mixed-citation>
    </ref>
  </ref-list>
</back>
