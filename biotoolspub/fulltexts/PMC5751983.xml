<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5751983</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0189616</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-17-27883</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Particle Physics</subject>
            <subj-group>
              <subject>Composite Particles</subject>
              <subj-group>
                <subject>Atoms</subject>
                <subj-group>
                  <subject>Isotopes</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic Acids</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Particle Physics</subject>
            <subj-group>
              <subject>Composite Particles</subject>
              <subj-group>
                <subject>Atoms</subject>
                <subj-group>
                  <subject>Isotopes</subject>
                  <subj-group>
                    <subject>Stable Isotopes</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Materials Science</subject>
          <subj-group>
            <subject>Material Properties</subject>
            <subj-group>
              <subject>Density</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Materials Science</subject>
          <subj-group>
            <subject>Materials Physics</subject>
            <subj-group>
              <subject>Density</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Materials Physics</subject>
            <subj-group>
              <subject>Density</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Research Design</subject>
          <subj-group>
            <subject>Experimental Design</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Metabolism</subject>
            <subj-group>
              <subject>Metabolic Processes</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>DNA</subject>
            <subj-group>
              <subject>DNA replication</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>DNA</subject>
              <subj-group>
                <subject>DNA replication</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>High Throughput Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>High Throughput Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HTSSIP: An R package for analysis of high throughput sequencing data from nucleic acid stable isotope probing (SIP) experiments</article-title>
      <alt-title alt-title-type="running-head">HTSSIP for analysis of HTS-SIP data</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Youngblut</surname>
          <given-names>Nicholas D.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="author-notes" rid="currentaff001">
          <sup>¤</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Barnett</surname>
          <given-names>Samuel E.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Buckley</surname>
          <given-names>Daniel H.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>School of Integrative Plant Science, Cornell University, Ithaca, New York, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Pan</surname>
          <given-names>Chongle</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Oak Ridge National Laboratory, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="current-aff" id="currentaff001">
        <label>¤</label>
        <p>Current address: Department of Microbiome Science, Max Planck Institute for Developmental Biology, Tübingen, Germany</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>nyoungblut@tuebingen.mpg.de</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>1</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>13</volume>
    <issue>1</issue>
    <elocation-id>e0189616</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>7</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>11</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2018 Youngblut et al</copyright-statement>
      <copyright-year>2018</copyright-year>
      <copyright-holder>Youngblut et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0189616.pdf"/>
    <abstract>
      <p>Combining high throughput sequencing with stable isotope probing (HTS-SIP) is a powerful method for mapping <italic>in situ</italic> metabolic processes to thousands of microbial taxa. However, accurately mapping metabolic processes to taxa is complex and challenging. Multiple HTS-SIP data analysis methods have been developed, including high-resolution stable isotope probing (HR-SIP), multi-window high-resolution stable isotope probing (MW-HR-SIP), quantitative stable isotope probing (qSIP), and ΔBD. Currently, there is no publicly available software designed specifically for analyzing HTS-SIP data. To address this shortfall, we have developed the <italic>HTSSIP</italic> R package, an open-source, cross-platform toolset for conducting HTS-SIP analyses in a straightforward and easily reproducible manner. The <italic>HTSSIP</italic> package, along with full documentation and examples, is available from CRAN at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/HTSSIP/index.html">https://cran.r-project.org/web/packages/HTSSIP/index.html</ext-link> and Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/buckleylab/HTSSIP">https://github.com/buckleylab/HTSSIP</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000015</institution-id>
            <institution>U.S. Department of Energy</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DE-SC0004486</award-id>
        <principal-award-recipient>Daniel H Buckley</principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000015</institution-id>
            <institution>U.S. Department of Energy</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DE-SC0010558</award-id>
        <principal-award-recipient>Daniel H Buckley</principal-award-recipient>
      </award-group>
      <funding-statement>This work is supported by the Department of Energy Office of Science, Office of Biological &amp; Environmental Research Genomic Science Program (<ext-link ext-link-type="uri" xlink:href="http://genomicscience.energy.gov/">http://genomicscience.energy.gov/</ext-link>) under award numbers DE-SC0004486 and DE-SC0010558, with Dr. Daniel Buckley being the recipient of both awards. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="0"/>
      <page-count count="8"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are available within the R package that this paper describes. The R package (plus the associated data) is publicly available at two locations: CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/HTSSIP/index.html">https://cran.r-project.org/web/packages/HTSSIP/index.html</ext-link>) and GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/buckleylab/HTSSIP">https://github.com/buckleylab/HTSSIP</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are available within the R package that this paper describes. The R package (plus the associated data) is publicly available at two locations: CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/HTSSIP/index.html">https://cran.r-project.org/web/packages/HTSSIP/index.html</ext-link>) and GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/buckleylab/HTSSIP">https://github.com/buckleylab/HTSSIP</ext-link>).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Stable isotope probing of nucleic acids (DNA- and RNA-SIP) is a powerful method for mapping <italic>in situ</italic> metabolic processes, such as nitrogen and carbon cycling, to microbial taxa. Historically, the sensitivity of nucleic acid SIP has been limited by the low throughput of DNA sequencing and the low taxonomic resolution of DNA fingerprinting techniques [<xref rid="pone.0189616.ref001" ref-type="bibr">1</xref>,<xref rid="pone.0189616.ref002" ref-type="bibr">2</xref>]. Recently, DNA- and RNA-SIP have been combined with high throughput sequencing of PCR amplicons (HTS-SIP), which allows researchers to map <italic>in situ</italic> metabolic processes to thousands of taxa resolved at a fine taxonomic resolution [<xref rid="pone.0189616.ref003" ref-type="bibr">3</xref>–<xref rid="pone.0189616.ref005" ref-type="bibr">5</xref>].</p>
    <p>While HTS-SIP is proving to be a very useful method for exploring <italic>in situ</italic> metabolic processes in complex microbial communities, the accurate analysis of HTS-SIP datasets is complex [<xref rid="pone.0189616.ref006" ref-type="bibr">6</xref>,<xref rid="pone.0189616.ref007" ref-type="bibr">7</xref>]. Multiple strategies have been developed for analyzing HTS-SIP data, including high-resolution stable isotope probing (HR-SIP) [<xref rid="pone.0189616.ref005" ref-type="bibr">5</xref>], multi-window high-resolution stable isotope probing (MW-HR-SIP) [<xref rid="pone.0189616.ref007" ref-type="bibr">7</xref>], quantitative stable isotope probing (qSIP) [<xref rid="pone.0189616.ref003" ref-type="bibr">3</xref>], and ΔBD (delta Buoyant Density) [<xref rid="pone.0189616.ref005" ref-type="bibr">5</xref>]. Prior to the development of these HTS-SIP analysis methods, DNA- and RNA-SIP experiments that utilized Sanger or high throughput sequencing were usually analyzed with standard statistical processes (<italic>e</italic>.<italic>g</italic>. t-tests), which have low sensitivity and/or high false positive rates when applied to sequence data [<xref rid="pone.0189616.ref007" ref-type="bibr">7</xref>,<xref rid="pone.0189616.ref008" ref-type="bibr">8</xref>]. The goals of HTS-SIP analysis methods differ, with HR-SIP and MW-HR-SIP designed to accurately identify taxa that have incorporated isotopically labeled substrate (<italic>i</italic>.<italic>e</italic>. ‘incorporators’), while the main goal of qSIP and ΔBD is to quantify the amount of isotopic enrichment for each taxon (<italic>i</italic>.<italic>e</italic>. atom % excess). While all methods use amplicon sequences (<italic>e</italic>.<italic>g</italic>. 16S rRNA or fungal ITS sequences) from multiple fractions of each isopycnic gradient, HR-SIP, MW-HR-SIP, and ΔBD solely use sequence data while qSIP additionally requires qPCR derived estimations of gene copy number from each gradient fraction. Recently, Youngblut and Buckley developed a HTS-SIP simulation model and showed that MW-HR-SIP is more accurate for identifying incorporators than HR-SIP and qSIP, while qSIP is generally more precise than ΔBD for quantifying isotopic enrichment [<xref rid="pone.0189616.ref007" ref-type="bibr">7</xref>].</p>
    <p>Currently, there are no publicly available software tools specifically designed for HTS-SIP analysis, which forces researchers to either recreate the analysis methods described in existing HTS-SIP studies or develop ad-hoc analysis methods. Both of these options decrease the ease of use and reproducibility of HTS-SIP analyses. To address this deficiency, we developed the <italic>HTSSIP</italic> R package, which includes the following features that aid in HTS-SIP analyses:</p>
    <list list-type="bullet">
      <list-item>
        <p>Functions for conducting HR-SIP, MW-HR-SIP, qSIP, and ΔBD to analyze data from DNA-SIP and RNA-SIP experiments, plus functions for conducting historically used statistical methods (<italic>e</italic>.<italic>g</italic>. t-tests comparing taxon abundance in “heavy” fractions).</p>
      </list-item>
      <list-item>
        <p>Functions for performing HTS-SIP dataset simulation, as described [<xref rid="pone.0189616.ref007" ref-type="bibr">7</xref>]</p>
      </list-item>
      <list-item>
        <p>Functions for exploratory analysis of simulated HTS-SIP data, useful for predicting how different experimental designs can alter experimental outcomes</p>
      </list-item>
      <list-item>
        <p>Functions for exploratory analysis of real HTS-SIP data, useful for conducting post-hoc analyses</p>
      </list-item>
      <list-item>
        <p>Ability to run analyses with parallel processing</p>
      </list-item>
      <list-item>
        <p>Extensive documentation and tutorials (see the <italic>HTSSIP</italic> package vignettes)</p>
      </list-item>
    </list>
  </sec>
  <sec id="sec002">
    <title>Package description</title>
    <sec id="sec003">
      <title>Input data</title>
      <p>Dataset input is handled by the <italic>Phyloseq</italic> R package, a feature-rich package for general microbiome data analysis that can be used to import many common microbiome data formats [<xref rid="pone.0189616.ref009" ref-type="bibr">9</xref>]. <italic>HTSSIP</italic> includes convenience functions to easily and flexibly designate the experimental design of the SIP experiment for downstream HTS-SIP analyses (<xref ref-type="fig" rid="pone.0189616.g001">Fig 1</xref>).</p>
      <fig id="pone.0189616.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0189616.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title><italic>A diagram depicting the possible HTS-SIP analyses available in the</italic> HTSSIP <italic>R package</italic>.</title>
          <p>The R functions to conduct each workflow step are italicized, and the figure references refer to example data produced by these workflow steps.</p>
        </caption>
        <graphic xlink:href="pone.0189616.g001"/>
      </fig>
    </sec>
    <sec id="sec004">
      <title>HTS-SIP dataset exploratory analyses</title>
      <p>A common first step in analyzing nucleic acid SIP data is to quantify the total nucleic acid concentration or gene copy number (estimated by qPCR) across density gradients in order to determine the buoyant density (BD) “shift” of nucleic acids in isotopically labeled treatments versus unlabeled controls [<xref rid="pone.0189616.ref010" ref-type="bibr">10</xref>,<xref rid="pone.0189616.ref011" ref-type="bibr">11</xref>]. The general expectation is that a “shift” of nucleic acid BD from “light” towards “heavy” densities is indicative of isotope incorporation. However, in a well designed SIP experiment, the ratio of added to endogenous substrate should be small, and this can produce an imperceptible BD shift [<xref rid="pone.0189616.ref004" ref-type="bibr">4</xref>]. In addition, an extensive shift may indicate excessive cross-feeding [<xref rid="pone.0189616.ref012" ref-type="bibr">12</xref>]. HTS-SIP methods can detect taxa that have incorporated low levels of isotope, or occur at frequencies that are so low that they do not cause a shift in the overall BD of community nucleic acids [<xref rid="pone.0189616.ref005" ref-type="bibr">5</xref>]. As a result, analysis of the BD distribution of total nucleic acids within density gradients is of little utility in assessing the results of nucleic acid SIP experiments performed on complex communities.</p>
      <p>As a simpler alternative, which leverages the power of high-throughput sequencing techniques, BD “shifts” can be inferred solely from sequence data [<xref rid="pone.0189616.ref004" ref-type="bibr">4</xref>,<xref rid="pone.0189616.ref005" ref-type="bibr">5</xref>]. Given that incorporators will be more abundant in “heavy” gradient fractions of the labeled treatment versus the unlabeled control, a BD shift can be inferred by assessing the beta-diversity between treatment and control gradient fractions. This approach is more sensitive for detecting community-level isotope incorporation than the approach of quantifying total nucleic acid concentration across the density gradient [<xref rid="pone.0189616.ref007" ref-type="bibr">7</xref>]. The <italic>HTSSIP</italic> R package implements two methods for using beta-diversity to assess isotope incorporation at the community-level: an ordination approach and an approach that expresses beta-diversity between corresponding treatment and control fractions as a function of their BD (<xref ref-type="fig" rid="pone.0189616.g001">Fig 1</xref>).</p>
      <p>The ordination approach simply involves pairwise calculations of a beta-diversity metric between all gradient fractions from isotopically labeled treatments and corresponding unlabeled controls, followed by visualizing the distance matrix with either principal coordinates analysis (PCoA) or non-metric multidimensional scaling (NMDS). An increase in beta-diversity between corresponding gradient fractions of labeled samples and controls is expected if isotope incorporation causes a change in the BD of OTUs (<xref ref-type="fig" rid="pone.0189616.g002">Fig 2A &amp; 2B</xref>).</p>
      <fig id="pone.0189616.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0189616.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title><italic>Examples of analyses available in the</italic> HTSSIP <italic>R package for visualizing results from HTS-SIP experiments</italic>.</title>
          <p>These figures were generated using data from an HTS-SIP experiment that consisted of 3 treatments where only the isotopic label was varied: an unlabled control (12C-Con), <sup>13</sup>C-xylose (13C-Xyl), and <sup>13</sup>C-cellulose (13C-Cel) [<xref rid="pone.0189616.ref007" ref-type="bibr">7</xref>]. DNA was extraced from each treatment 3 and 14 days after substrate addition, subjected to CsCl fractionation, and 16S rRNA sequencing was performed on ~24 fractions per CsCl gradient. Analyzing beta-diversity between gradient fractions can reveal changes in the buoyant density (BD) distribution of DNA in <sup>13</sup>C-labeled treatments versus the unlabeled control. Panel A is a non-metric multidimensional scaling (NMDS) ordination comparing beta-diversity (weighted Unifrac) between gradient fractions from two unlabeled replicates, which indicates that sequence composition varies greatly with BD but not between experimental replicates. Panel B is an NMDS ordination similar to Panel A, but each facet contains a <sup>13</sup>C treatment and the corresponding unlabeled control. Large relative distance between “heavy” control and labeled gradient fractions indicates a change in community composition caused by shift in DNA BD that resulted from <sup>13</sup>C isotope incorporation. The NMDS stress values ranged from 0.06 to 0.07. Panels C and D depict the same data as in Panels A and B, respectively, but only depict beta-diversity among gradient fractions that correspond in BD between labeled treatment and unlabeled control fractions. In this visualization, increases in beta-diversity indicate a change in community composition caused by a shift in DNA BD resulting from <sup>13</sup>C isotope incorporation. The line ranges represent 95% confidence intervals (CI) calculated by permuting OTU abundances and recalculating beta-diversity (100 bootstrap replicates), and actual beta-diversity values are represented by colored circles. "BD shift windows" (blue circles) indicate regions defined by ≥3 consecutive fractions with beta-diversities greater than expected by chance (<italic>i</italic>.<italic>e</italic>. exceeding the CI).</p>
        </caption>
        <graphic xlink:href="pone.0189616.g002"/>
      </fig>
      <p>While the ordination approach provides a useful overview of community-wide isotope incorporation, the extent of incorporation is difficult to compare among multiple treatments (<italic>e</italic>.<italic>g</italic>. <sup>13</sup>C-cellulose versus <sup>13</sup>C-xylose). The second approach implemented in the <italic>HTSSIP</italic> package visualizes DNA BD shifts by calculating pairwise beta-diversity of corresponding gradient fractions between treatment and control gradients (or control versus control to assess technical variation among replicates). To deal with partially overlapping gradient fractions between gradients, the weighted mean beta-diversity is calculated from all treatment gradient fractions that overlap each control gradient fraction, with weights defined as the percent overlap in the BD range of each fraction (<xref ref-type="fig" rid="pone.0189616.g002">Fig 2C &amp; 2D</xref>). A permutation test is used to identify BD ranges of high beta-diversity resulting from BD shifts (“BD shift windows”). The permutation test involves constructing bootstrap confidence intervals (CI) of beta-diversity by permuting OTU abundances among control fractions to generate a null model “treatment” that is compared against the actual control fractions. This null model represents the baseline beta-diversity expected if the treatment was just a randomly shuffled version of the control. A note in interpreting these data is that isotope incorporation will cause DNA to shift out of “light” gradient fractions and into “heavy” gradient fractions. Hence, in the presence of isotope incorporation, high beta-diversity can be observed in both “heavy” and “light” gradient fractions. Alternatively, in the absence of isotope incorporation, beta-diversity will remain low across all gradient fractions.</p>
    </sec>
    <sec id="sec005">
      <title>Identifying incorporators</title>
      <p>HR-SIP, MW-HR-SIP, and qSIP can all be used to identify incorporators. To illustrate the application of HR-SIP, MW-HR-SIP, and qSIP in the <italic>HTSSIP</italic> R package, we simulated a simplified HTS-SIP dataset consisting of 10 OTUs (<xref ref-type="fig" rid="pone.0189616.g003">Fig 3A</xref>). Our purpose here is merely to illustrate functions of the <italic>HTSSIP</italic> R package; comprehensive assessment of the accuracy of these techniques (and historically used DNA- and RNA-SIP analysis methods) is available elsewhere [<xref rid="pone.0189616.ref007" ref-type="bibr">7</xref>]. Briefly, HR-SIP identifies incorporators by utilizing DESeq2 to identify OTUs that have high differential relative abundance in “heavy” fractions of labeled treatment versus unlabeled control [<xref rid="pone.0189616.ref008" ref-type="bibr">8</xref>]. MW-HR-SIP takes the same relative abundance based approach as HR-SIP but uses multiple overlapping “heavy” BD windows (while correcting for multiple hypotheses). In contrast, qSIP uses qPCR data to transform OTU relative abundance distributions into pseudo-absolute abundance distributions (<xref ref-type="fig" rid="pone.0189616.g003">Fig 3A</xref>), and then BD shifts are determined from these transformed distributions by calculating the difference in center of mass for each OTU in treatment versus control gradients. Atom fraction excess can thus be calculated for specific isotopes (<italic>e</italic>.<italic>g</italic>. <sup>13</sup>C or <sup>15</sup>N) based on the calculations described in the work of Hungate and colleagues [<xref rid="pone.0189616.ref003" ref-type="bibr">3</xref>]. In order to identify incorporators, a permutation test is used to construct bootstrap confidence intervals of atom fraction excess. The <italic>HTSSIP</italic> package also provides functions for conducting historically used DNA- and RNA-SIP analysis methods (<italic>e</italic>.<italic>g</italic>. using t-tests to compare OTU abundances between “heavy” control versus treatment fractions). We refer to these methods collectively as “heavy-SIP”, which have been extensively compared to HR-SIP methods in other work [<xref rid="pone.0189616.ref007" ref-type="bibr">7</xref>]. Sensitivity in identifying incorporators can depend on the methods used (<xref ref-type="fig" rid="pone.0189616.g003">Fig 3B</xref>), and although we only provide a simple comparison of methods here, the senstivity and specifity of these results reflect those of Youngblut and Buckley [<xref rid="pone.0189616.ref007" ref-type="bibr">7</xref>]. SIP experiments can be simulated using the SIPSim toolset [<xref rid="pone.0189616.ref007" ref-type="bibr">7</xref>], and these data analyzed using the <italic>HTS-SIP</italic> R package. Such <italic>in silico</italic> evaluation is valuable for predicting possible experimental outcomes and the expected analytical accuracy of SIP experiments based on details of experimental design prior to conducting experiments.</p>
      <fig id="pone.0189616.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0189616.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title><italic>Examples of using the</italic> HTSSIP <italic>R package for data processing</italic>, <italic>data exploration</italic>, <italic>incorporator identification</italic>, <italic>and quantification of BD shifts</italic>.</title>
          <p>The SIPSim toolset was used to simulate a simple HTSSIP dataset consisting of two treatments: a <sup>13</sup>C-treatment (“13C-Treat”) and a <sup>12</sup>C-control (“12C-Con”). Each treatment has 3 replicates, with each consisting of 24 gradient fractions [<xref rid="pone.0189616.ref007" ref-type="bibr">7</xref>]. Half of the ten OTUs (OTU 1, 3, 4, 7, and 8) were randomly assigned an atom excess <sup>13</sup>C between 30 and 100%. [<xref rid="pone.0189616.ref003" ref-type="bibr">3</xref>]. Panel A depicts the raw abundances (“Counts”), fractional relative abundance (“Rel. Abund.”), and relative abundances transformed by simulated qPCR data (“Rel. Abund. qPCR-trans.”). For clarity, only 1 of the 3 experimental replicates is shown. Panel B shows those OTUs identified as “incorporators” (incorporated <sup>13</sup>C into genomic DNA) by HR-SIP, MW-HR-SIP, qSIP, or by using a “heavy-SIP” approach (the Mann Whitney U test). Panel C shows the BD shift of each OTU as determined by ΔBD or qSIP. The dashed line signifies a BD shift (Z) of 0.0 g ml<sup>-1</sup>, and the red bars show the true theoretical BD shift resulting from <sup>13</sup>C isotope incorporation.</p>
        </caption>
        <graphic xlink:href="pone.0189616.g003"/>
      </fig>
      <p>The <italic>HTSSIP</italic> package implements HR-SIP based on the code provided in the work of Pepe-Ranney and colleagues [<xref rid="pone.0189616.ref005" ref-type="bibr">5</xref>]. MW-HR-SIP is implemented in <italic>HTSSIP</italic> based on the R code provided in the SIPSim HTS-SIP dataset simulation toolset [<xref rid="pone.0189616.ref007" ref-type="bibr">7</xref>]. The <italic>HTSSIP</italic> implementation of qSIP is based on the method’s description in the work of Hungate and colleagues [<xref rid="pone.0189616.ref003" ref-type="bibr">3</xref>]. Implementations of each method include the option for parallel processing of each algorithm. Parallelization is implemented through the <italic>plyr</italic> R package [<xref rid="pone.0189616.ref013" ref-type="bibr">13</xref>], which allows for various parallel backends to be used such as <italic>doSNOW</italic> and <italic>doParallel</italic>.</p>
    </sec>
    <sec id="sec006">
      <title>Quantifying isotopic enrichment</title>
      <p>Unlike HR-SIP and MW-HR-SIP, the main goal of qSIP and ΔBD is to quantify isotopic enrichment. To illustrate the use of the <italic>HTSSIP</italic> package for conducting qSIP and ΔBD, we applied both analyses to the simplified HTS-SIP dataset described above (<xref ref-type="fig" rid="pone.0189616.g003">Fig 3C</xref>). ΔBD is implemented in <italic>HTSSIP</italic> as described in the work of Pepe-Ranney and colleagues [<xref rid="pone.0189616.ref005" ref-type="bibr">5</xref>]. As shown in Youngblut and Buckley [<xref rid="pone.0189616.ref007" ref-type="bibr">7</xref>], qSIP and ΔBD can produce substantially different estimates of isotope incorporation.</p>
    </sec>
    <sec id="sec007">
      <title>Simulating datasets</title>
      <p>The <italic>HTSSIP</italic> package provides functions to simulate simple HTS-SIP datasets for use in software testing, analysis pipeline development, and gaining familiarity with software and data formats. However, the SIPSim toolset is recommended for evaluating possible SIP experimental designs and for testing the accuracy of HTS-SIP analyses, because the simulation framework for SIPSim is based on the physics of isopycnic centrifugation, unlike the simulations possible with <italic>HTSSIP</italic> [<xref rid="pone.0189616.ref007" ref-type="bibr">7</xref>]. <italic>HTSSIP</italic> utilizes <italic>coenocliner</italic>, an R package designed for simulating taxon abundance across environmental gradients, to simulate taxon abundance distributions across buoyant density gradient fractions [<xref rid="pone.0189616.ref013" ref-type="bibr">13</xref>].</p>
    </sec>
  </sec>
  <sec id="sec008">
    <title>Future work</title>
    <p>Future development of the <italic>HTSSIP</italic> package will include i) functions for mapping incorporator status to phylogenies and visualizing the results ii) direct integration with the SIPSim toolset for rapid HTS-SIP experimental design and assessment of accuracy iii) functions analyzing shotgun metagenome data derived from SIP experiments.</p>
  </sec>
  <sec sec-type="conclusions" id="sec009">
    <title>Conclusions</title>
    <p>Given the power of HTS-SIP for mapping <italic>in situ</italic> metabolism to taxonomic identity, adoption of the technique by researchers will greatly help to resolve connections between microbial ecology and taxonomy. Currently, HTS-SIP data analysis is complex, with few existing computational tools to aid researchers. The R package <italic>HTSSIP</italic> provides a single, standardized analysis pipeline that facilitates reproducible analyses on HTS-SIP datasets and direct cross-study comparisons. Moreover, <italic>HTSSIP</italic> can be combined with the SIPSim toolset to simulate and evaluate possible DNA-SIP experimental designs.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0189616.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Whiteley</surname><given-names>AS</given-names></name>, <name><surname>Thomson</surname><given-names>B</given-names></name>, <name><surname>Lueders</surname><given-names>T</given-names></name>, <name><surname>Manefield</surname><given-names>M</given-names></name>. <article-title>RNA stable-isotope probing</article-title>. <source>Nat Protoc</source>. <year>2007</year>;<volume>2</volume>: <fpage>838</fpage>–<lpage>844</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nprot.2007.115">10.1038/nprot.2007.115</ext-link></comment><?supplied-pmid 17446884?><pub-id pub-id-type="pmid">17446884</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189616.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Uhlík</surname><given-names>O</given-names></name>, <name><surname>Jecná</surname><given-names>K</given-names></name>, <name><surname>Leigh</surname><given-names>MB</given-names></name>, <name><surname>Macková</surname><given-names>M</given-names></name>, <name><surname>Macek</surname><given-names>T</given-names></name>. <article-title>DNA-based stable isotope probing: a link between community structure and function</article-title>. <source>Sci Total Environ</source>. <year>2009</year>;<volume>407</volume>: <fpage>3611</fpage>–<lpage>3619</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.scitotenv.2008.05.012">10.1016/j.scitotenv.2008.05.012</ext-link></comment><?supplied-pmid 18573518?><pub-id pub-id-type="pmid">18573518</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189616.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Hungate</surname><given-names>BA</given-names></name>, <name><surname>Mau</surname><given-names>RL</given-names></name>, <name><surname>Schwartz</surname><given-names>E</given-names></name>, <name><surname>Caporaso</surname><given-names>JG</given-names></name>, <name><surname>Dijkstra</surname><given-names>P</given-names></name>, <name><surname>van Gestel</surname><given-names>N</given-names></name>, <etal>et al</etal><article-title>Quantitative microbial ecology through stable isotope probing</article-title>. <source>Appl Environ Microbiol</source>. <year>2015</year>;<volume>81</volume>: <fpage>7570</fpage>–<lpage>7581</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/AEM.02280-15">10.1128/AEM.02280-15</ext-link></comment><?supplied-pmid 26296731?><pub-id pub-id-type="pmid">26296731</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189616.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Pepe-Ranney</surname><given-names>C</given-names></name>, <name><surname>Koechli</surname><given-names>C</given-names></name>, <name><surname>Potrafka</surname><given-names>R</given-names></name>, <name><surname>Andam</surname><given-names>C</given-names></name>, <name><surname>Eggleston</surname><given-names>E</given-names></name>, <name><surname>Garcia-Pichel</surname><given-names>F</given-names></name>, <etal>et al</etal><article-title>Non-cyanobacterial diazotrophs mediate dinitrogen fixation in biological soil crusts during early crust formation</article-title>. <source>ISME J</source>. <year>2016</year>;<volume>10</volume>: <fpage>287</fpage>–<lpage>298</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ismej.2015.106">10.1038/ismej.2015.106</ext-link></comment><?supplied-pmid 26114889?><pub-id pub-id-type="pmid">26114889</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189616.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Pepe-Ranney</surname><given-names>C</given-names></name>, <name><surname>Campbell</surname><given-names>AN</given-names></name>, <name><surname>Koechli</surname><given-names>CN</given-names></name>, <name><surname>Berthrong</surname><given-names>S</given-names></name>, <name><surname>Buckley</surname><given-names>DH</given-names></name>. <article-title>Unearthing the ecology of soil microorganisms using a high resolution DNA-SIP approach to explore cellulose and xylose metabolism in soil</article-title>. <source>Front Microbiol</source>. <year>2016</year>;<volume>7</volume>: <fpage>703</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fmicb.2016.00703">10.3389/fmicb.2016.00703</ext-link></comment><?supplied-pmid 27242725?><pub-id pub-id-type="pmid">27242725</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189616.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Youngblut</surname><given-names>ND</given-names></name>, <name><surname>Buckley</surname><given-names>DH</given-names></name>. <article-title>Intra-genomic variation in G + C content and its implications for DNA stable isotope probing</article-title>. <source>Environ Microbiol Rep</source>. <year>2014</year>;<volume>6</volume>: <fpage>767</fpage>–<lpage>775</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/1758-2229.12201">10.1111/1758-2229.12201</ext-link></comment><?supplied-pmid 25139123?><pub-id pub-id-type="pmid">25139123</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189616.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Youngblut</surname><given-names>ND</given-names></name>, <name><surname>Buckley</surname><given-names>DH</given-names></name>. <article-title>Evaluating the accuracy of DNA stable isotope probing</article-title>. <source>bioRxiv</source>. <year>2017</year> p. <fpage>138719</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/138719">10.1101/138719</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0189616.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Love</surname><given-names>MI</given-names></name>, <name><surname>Huber</surname><given-names>W</given-names></name>, <name><surname>Anders</surname><given-names>S</given-names></name>. <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source>. <year>2014</year>;<volume>15</volume>: <fpage>550</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13059-014-0550-8">10.1186/s13059-014-0550-8</ext-link></comment><?supplied-pmid 25516281?><pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189616.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>McMurdie</surname><given-names>PJ</given-names></name>, <name><surname>Holmes</surname><given-names>S</given-names></name>. <article-title>phyloseq: An R package for reproducible interactive analysis and graphics of microbiome census data</article-title>. <source>PLoS ONE</source>. <year>2013</year> p. <fpage>e61217</fpage> Available: <ext-link ext-link-type="uri" xlink:href="http://dx.plos.org/10.1371/journal.pone.0061217">http://dx.plos.org/10.1371/journal.pone.0061217</ext-link>
<?supplied-pmid 23630581?><pub-id pub-id-type="pmid">23630581</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189616.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Lueders</surname><given-names>T</given-names></name>, <name><surname>Kindler</surname><given-names>R</given-names></name>, <name><surname>Miltner</surname><given-names>A</given-names></name>, <name><surname>Friedrich</surname><given-names>MW</given-names></name>, <name><surname>Kaestner</surname><given-names>M</given-names></name>. <article-title>Identification of bacterial micropredators distinctively active in a soil microbial food web</article-title>. <source>Appl Environ Microbiol</source>. <year>2006</year>;<volume>72</volume>: <fpage>5342</fpage>–<lpage>5348</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/AEM.00400-06">10.1128/AEM.00400-06</ext-link></comment><?supplied-pmid 16885285?><pub-id pub-id-type="pmid">16885285</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189616.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>El Zahar Haichar</surname><given-names>F</given-names></name>, <name><surname>Achouak</surname><given-names>W</given-names></name>, <name><surname>Christen</surname><given-names>R</given-names></name>, <name><surname>Heulin</surname><given-names>T</given-names></name>, <name><surname>Marol</surname><given-names>C</given-names></name>, <name><surname>Marais</surname><given-names>M-F</given-names></name>, <etal>et al</etal><article-title>Identification of cellulolytic bacteria in soil by stable isotope probing</article-title>. <source>Environ Microbiol</source>. <year>2007</year>;<volume>9</volume>: <fpage>625</fpage>–<lpage>634</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1462-2920.2006.01182.x">10.1111/j.1462-2920.2006.01182.x</ext-link></comment><?supplied-pmid 17298363?><pub-id pub-id-type="pmid">17298363</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189616.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>DeRito</surname><given-names>CM</given-names></name>, <name><surname>Pumphrey</surname><given-names>GM</given-names></name>, <name><surname>Madsen</surname><given-names>EL</given-names></name>. <article-title>Use of field-based stable isotope probing to identify adapted populations and track carbon flow through a phenol-degrading soil microbial community</article-title>. <source>Appl Environ Microbiol</source>. <year>2005</year>;<volume>71</volume>: <fpage>7858</fpage>–<lpage>7865</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/AEM.71.12.7858-7865.2005">10.1128/AEM.71.12.7858-7865.2005</ext-link></comment><?supplied-pmid 16332760?><pub-id pub-id-type="pmid">16332760</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0189616.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Wickham</surname><given-names>H</given-names></name>. <article-title>The split-apply-combine strategy for data analysis</article-title>. <source>Journal of Statistical Software, Articles</source>. <year>2011</year>;<volume>40</volume>: <fpage>1</fpage>–<lpage>29</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
