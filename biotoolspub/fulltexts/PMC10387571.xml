<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_ISCI107227 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEgr7 jpg ?>
<?FILEgr8 jpg ?>
<?FILEfx1 jpg ?>
<?FILEmmc1 pdf ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">iScience</journal-id>
    <journal-id journal-id-type="iso-abbrev">iScience</journal-id>
    <journal-title-group>
      <journal-title>iScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2589-0042</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10387571</article-id>
    <article-id pub-id-type="pii">S2589-0042(23)01304-4</article-id>
    <article-id pub-id-type="doi">10.1016/j.isci.2023.107227</article-id>
    <article-id pub-id-type="publisher-id">107227</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Federated generalized linear mixed models for collaborative genome-wide association studies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au1">
        <name>
          <surname>Li</surname>
          <given-names>Wentao</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au2">
        <name>
          <surname>Chen</surname>
          <given-names>Han</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au3">
        <name>
          <surname>Jiang</surname>
          <given-names>Xiaoqian</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au4">
        <name>
          <surname>Harmanci</surname>
          <given-names>Arif</given-names>
        </name>
        <email>arif.o.harmanci@uth.tmc.edu</email>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="fn1" ref-type="fn">3</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
      <aff id="aff1"><label>1</label>School of Biomedical Informatics, University of Texas Health Science Center, Houston, TX 77030, USA</aff>
      <aff id="aff2"><label>2</label>School of Public Health, University of Texas Health Science Center, Houston, TX 77030, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>∗</label>Corresponding author <email>arif.o.harmanci@uth.tmc.edu</email></corresp>
      <fn id="fn1">
        <label>3</label>
        <p id="ntpara0010">Lead contact</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <day>18</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>26</volume>
    <issue>8</issue>
    <elocation-id>107227</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 The Authors</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0010">
      <title>Summary</title>
      <p>Federated association testing is a powerful approach to conduct large-scale association studies where sites share intermediate statistics through a central server. There are, however, several standing challenges. Confounding factors like population stratification should be carefully modeled across sites. In addition, it is crucial to consider disease etiology using flexible models to prevent biases. Privacy protections for participants pose another significant challenge. Here, we propose distributed Mixed Effects Genome-wide Association study (<italic>dMEGA</italic>), a method that enables federated generalized linear mixed model-based association testing across multiple sites without explicitly sharing genotype and phenotype data. <italic>dMEGA</italic> employs a reference projection to correct for population-stratification and utilizes efficient local-gradient updates among sites, incorporating both fixed and random effects. The accuracy and efficiency of <italic>dMEGA</italic> are demonstrated through simulated and real datasets. <italic>dMEGA</italic> is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Li-Wentao/dMEGA" id="intref0010">https://github.com/Li-Wentao/dMEGA</ext-link>.</p>
    </abstract>
    <abstract abstract-type="graphical" id="abs0015">
      <title>Graphical abstract</title>
      <fig id="undfig1" position="anchor">
        <graphic xlink:href="fx1"/>
      </fig>
    </abstract>
    <abstract abstract-type="author-highlights" id="abs0020">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="ulist0010">
          <list-item id="u0010">
            <label>•</label>
            <p id="p0010">We developed a federated learning method for genome-wide association studies</p>
          </list-item>
          <list-item id="u0015">
            <label>•</label>
            <p id="p0015">We use a reference projection method that can be effective for correcting confounders</p>
          </list-item>
          <list-item id="u0020">
            <label>•</label>
            <p id="p0020">We tackled the data heterogeneity problem with a federated mixed-effect model</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="teaser" id="abs0025">
      <p>Health sciences; Clinical genetics; Human genetics; Genomics</p>
    </abstract>
    <kwd-group id="kwrds0010">
      <title>Subject areas</title>
      <kwd>Health sciences</kwd>
      <kwd>Clinical genetics</kwd>
      <kwd>Human genetics</kwd>
      <kwd>Genomics</kwd>
    </kwd-group>
  </article-meta>
  <notes>
    <p id="misc9010">Published: June 28, 2023</p>
  </notes>
</front>
<body>
  <sec id="sec1">
    <title>Introduction</title>
    <p id="p0045">Genome-wide association studies (GWASs) are standard methods for discovering genetic variants that explain the genetic component of phenotypic variance. As the sequencing costs are decreasing, there is great incentive to perform large-scale association studies to increase the power of the studies.<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref><sup>,</sup><xref rid="bib2" ref-type="bibr"><sup>2</sup></xref> Currently, population-scale joint genotyping and phenotyping efforts such as AllofUs and UK Biobank generate very large resources that provide great opportunities for extensive analysis of genotype-phenotype relationships.<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref><sup>,</sup><xref rid="bib4" ref-type="bibr"><sup>4</sup></xref><sup>,</sup><xref rid="bib5" ref-type="bibr"><sup>5</sup></xref> In addition, there are other efforts that aim at focusing on certain phenotypes such as TOPMed,<xref rid="bib6" ref-type="bibr"><sup>6</sup></xref> ADSP,<xref rid="bib7" ref-type="bibr"><sup>7</sup></xref> TCGA,<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref> and GTEx.<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref></p>
    <p id="p0050">There are a number of standing challenges around performing large scale GWAS in existing datasets. Association tests are confounded by numerous factors such as population stratification, which can be especially important in multi-ancestral studies and in admixed populations.<xref rid="bib10" ref-type="bibr"><sup>10</sup></xref> Most of the multi-ancestral studies are performed as meta-analyses<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref><sup>,</sup><xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> and may make it more challenging to correct biases compared to a pooled individual-level data analysis among sites in a collaborative GWAS setting.<xref rid="bib13" ref-type="bibr"><sup>13</sup></xref><sup>,</sup><xref rid="bib14" ref-type="bibr"><sup>14</sup></xref> Furthermore, binary and continuous traits should be modeled using appropriate models to avoid biases in the significance of the genetic effect. It has been shown previously that binary traits are more appropriately analyzed using generalized linear models (GLM) compared to linear models because generalized models can naturally represent the categorical/binary nature of case/control study designs.<xref rid="bib15" ref-type="bibr"><sup>15</sup></xref><sup>,</sup><xref rid="bib16" ref-type="bibr"><sup>16</sup></xref> In addition, there can be complex relationships among samples (such as cryptic relatedness), which makes it necessary to account for random polygenic effects that may otherwise bias association signals. Furthermore, increasing sample sizes requires extensive collaboration among large institutions, but data sharing (among institutions) may be restricted under diverse regulations such as HIPAA<xref rid="bib17" ref-type="bibr"><sup>17</sup></xref> and GDPR.<xref rid="bib18" ref-type="bibr"><sup>18</sup></xref> Consequently, a rising concern for performing large-scale collaborative association studies is the consideration of privacy and related ethical concerns of unauthorized re-identification of the study participants and their relatives in publicly available genealogy services, stigmatization of individuals and groups as a results of phenotype and disease risk predictions, group-level sensitive information prediction (such as inbreeding in Havasupai Tribe), and marginalization of these historically isolated groups<xref rid="bib19" ref-type="bibr"><sup>19</sup></xref><sup>,</sup><xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> (Supplementary Information).</p>
    <p id="p0055">Although there are increased incentives around sharing data and making discoveries, regulations are enacted on legislative level for stricter protection of personal genetic data from open sharing. This creates a major hurdle for international collaborations. The most basic data protection is performed by lengthy data transfer agreements that authorize users’ access to data repositories (e.g., dbGAP<xref rid="bib21" ref-type="bibr"><sup>21</sup></xref> and European EGA<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref>). The agreements only establish accountability and do not meaningfully protect data, because data are still stored and analyzed in plaintext. On technical domain, differential privacy,<xref rid="bib23" ref-type="bibr"><sup>23</sup></xref> homomorphic encryption (HE),<xref rid="bib24" ref-type="bibr"><sup>24</sup></xref> and secure multiparty computation<xref rid="bib25" ref-type="bibr"><sup>25</sup></xref> enable provably privacy-aware data analysis. Differentially private methods<xref rid="bib26" ref-type="bibr"><sup>26</sup></xref><sup>,</sup><xref rid="bib27" ref-type="bibr"><sup>27</sup></xref> are based on noisy data release mechanisms and substantially degrade genetic data utility. HE<xref rid="bib28" ref-type="bibr"><sup>28</sup></xref><sup>,</sup><xref rid="bib29" ref-type="bibr"><sup>29</sup></xref><sup>,</sup><xref rid="bib30" ref-type="bibr"><sup>30</sup></xref><sup>,</sup><xref rid="bib31" ref-type="bibr"><sup>31</sup></xref>-based approaches enable analysis of encrypted data without decrypting it. Although HE-based methods have made orders of magnitude improvement in terms of performance in the last decade, they still require large computational resources. Similarly, secure multiparty computation (SMC) methods<xref rid="bib32" ref-type="bibr"><sup>32</sup></xref> rely on the separation of data among multiple entities such that it cannot be recovered by any of the non-colluding entities. SMC-based methods have high data transfer requirements and may not be practically feasible.</p>
    <p id="p0060">Federated association testing (rooted from Federated Learning approaches<xref rid="bib33" ref-type="bibr"><sup>33</sup></xref><sup>,</sup><xref rid="bib34" ref-type="bibr"><sup>34</sup></xref>) among different sites present a viable solution for increasing sample sizes while underlying genotype and phenotype data are not explicitly shared. In federated association testing methods, the association testing is reformulated as an iterative algorithm. At each iteration, each collaborating site computes intermediary statistics using local genotype and phenotype data and the statistics from other sites. Next, the intermediary statistics are shared among the sites with a central server that is aggregated and re-shared to all sites. Federated testing is advantageous from a privacy perspective because the genotype and phenotype data never leave local sites. This way, all sites make use of the pooled individual-level data that would be otherwise isolated in distributed repositories across institutions.</p>
    <p id="p0065">Here, we present <italic>dMEGA</italic> (distributed Mixed Effects Genome-wide Association study), a federated generalized linear mixed model that enables federated genetic association testing among collaborating sites. First, each site utilizes a reference projection-based approach, wherein the genotype data at the site is projected on an existing public genotype panel (e.g., The 1000 Genomes Project) and population-based covariates are computed based on the projected coordinates. Usage of projection is advantageous because it decreases computational requirements by circumventing computation of principal component analysis (PCA) among the sites and minimally impacts accuracy. In addition, the computation of population-level covariates does not require data to be pooled and does not incur privacy risks. Next, <italic>dMEGA</italic> performs federated association testing using the fixed (such as population covariates) and random effects. In this step, the sites locally calculate intermediate statistics that are sent to a central server, which aggregates the statistics from all sites and shares them with all sites. After a number of iterations, the algorithm converges and final results are calculated. We demonstrate the accuracy and efficiency of <italic>dMEGA</italic> using simulated and real datasets.</p>
  </sec>
  <sec id="sec2">
    <title>Results</title>
    <sec id="sec2.1">
      <title>Overview of <italic>dMEGA</italic></title>
      <p id="p0070"><xref rid="fig1" ref-type="fig">Figure 1</xref> shows the steps of federated association testing workflow. First, the sites project their genotype data on the principal components (PCs) computed from a reference panel. The reference panel dataset represents a comprehensive population-based information pool. The projected coordinates are used as population-based covariates (fixed effect). Next, each site computes the local testing statistics (gradients, effect sizes, Hessian matrices) and send them to the Central Server (CS). At each site, the likelihood is approximated by Laplace approximation and gradients are calculated using the local data and the current parameters (Methods). The Central Server collects intermediate model statistics during the federated learning process, aggregates the site-specific parameters to compute the global model parameters, and sends the parameters to the sites for the next iteration. The individual-level data (genotypes, phenotypes, and covariates) is not shared with other sites or the central server in the inference.<fig id="fig1"><label>Figure 1</label><caption><p>Illustration of federated association testing workflow for two sites named Site-1 and Site-2</p><p>Each site holds genotype, phenotype, and covariate datasets. Each site first downloads the reference panel principal components (PCs) and projects the genotypes to generate the population-based covariates (Step 1). Next, the initial parameters are downloaded from the central server (CS) (Step 2). Using the local genotype, phenotype, and merged covariate data, each site updates the local parameters (Step 3) and sends them to CS (Step 4). After receiving the local parameters from both sites, CS aggregates the parameters and sends the updates parameters to all sites. Steps 2, 3, and 4 are performed until the model converges. Step 1 is performed only once at the before iterations.</p></caption><graphic xlink:href="gr1"/></fig></p>
    </sec>
    <sec id="sec2.2">
      <title>Experimental setting and accuracy metrics</title>
      <p id="p0075">We separated the experimental tests into two parts. We first use simulated data and real dataset to present the utility of the projection-based population covariate calculation to be used in GWAS. We explore different scenarios to highlight the importance of reference panel selection.</p>
      <p id="p0080">We next move to usage of the projected covariates in the <italic>dMEGA</italic>’s GWAS using a real-world dataset obtained from dbGAP (Data Availability). We explore two settings of covariate selection and compare the results from <italic>dMEGA</italic> with results from a centralized GWAS study using lme4 that is calculated using the covariates obtained from the dbGAP dataset. To decrease computational requirements, we ran plink2 to estimate association of the variants with the binary phenotype (using the dbGAP reported covariates) and we focused on the 10,000 variants that were the most significantly associated with the phenotype.</p>
      <p id="p0085">Performance Metrics. We evaluate the results by comparing (1) the p value concordance between the centralized and federated estimates, (2) the concordance of effect sizes estimated from the centralized and federated estimates, (3) the concordance of the ranking of the most significant SNPs identified by centralized and federated calculations, (4) time requirements of federated algorithm, (5) comparison of the top variants (with changing p value cutoffs) and qualitatively evaluate the results using Manhattan plots, and (6) qualitative comparison of the scatterplots using the first two PCs calculated by the projection-based approach and the full-PCA for simulated case studies and the dbGAP reported covariates for the real dataset.</p>
    </sec>
    <sec id="sec2.3">
      <title>Projection-based population stratification</title>
      <p id="p0090">We first tested whether <italic>dMEGA</italic>’s the projection-based population stratification can be used for performing population structure correction in the context of a simple linear model. The justification of a projection-based approach is to make use of the genetic diversity represented within the reference panel and identify the variation of the study participants along the PCs of this panel. Assuming that the reference panel is representative of this genetic diversity, the covariates from the projection should be useful to correct for the population stratification in the linear GWAS model. It should be noted that the covariates represent nuisance parameters, i.e., their exact values are not of essential importance as long as they correct for the population stratification effects within the study cohort<xref rid="bib35" ref-type="bibr"><sup>35</sup></xref><sup>,</sup><xref rid="bib36" ref-type="bibr"><sup>36</sup></xref><sup>,</sup><xref rid="bib37" ref-type="bibr"><sup>37</sup></xref> (Supplementary Information). This approach enables a large decrease in computation cost by circumventing the need for a full PCA of the genotype data pooled from all sites<xref rid="bib28" ref-type="bibr"><sup>28</sup></xref><sup>,</sup><xref rid="bib32" ref-type="bibr"><sup>32</sup></xref><sup>,</sup><xref rid="bib38" ref-type="bibr"><sup>38</sup></xref><sup>,</sup><xref rid="bib39" ref-type="bibr"><sup>39</sup></xref> and relying on much simpler computation of projections in population-based covariate computation that is used for population-stratification.</p>
      <p id="p0095">We first simulated 100 GWAS studies where 20 variants with allele frequency below 0.1 were randomly selected as causal with effect on phenotype. We also assigned population and gender-specific biases on the phenotype to introduce population and gender-specific effect. For each simulated study, we simulated genotypes for 3,000 individuals with a corresponding quantitative phenotype that is computed regarding genotypes and covariates. We finally ran plink2 in three configurations to perform GWAS with and without population stratification: (1) We ran plink2 with its default PCA to generate population-based covariates. (2) We ran plink2 with covariates generated by projection-based covariate computation using top 6 PCs. (3) We ran plink2 without population stratification as a control to ensure that population stratification is indeed necessary in GWAS. As a first test scenario, we used CEU, MXL, YRI populations from the 1000 Genomes Project for simulating genotypes and used the same populations as reference to compute the projection-based population covariates, i.e., the projection and simulation ancestries are exactly matched. Overall, p values and effect sizes from GWAS with projection-based population correction match fairly well to default PCA-based population stratification in plink2 (<xref rid="fig2" ref-type="fig">Figures 2</xref>, <xref rid="mmc1" ref-type="supplementary-material">S1</xref>A, and S1B). In comparison, the GWAS without population correction gives fairly discordant and biased results (<xref rid="mmc1" ref-type="supplementary-material">Figures S1</xref>C and S1D). We next used the GIH, CHB, PEL populations as the reference panel populations to test for mismatches in the simulated and reference populations. We observed that similar results held where projection-based population correction yields good concordance with plink2’s default PCA-based population correction (<xref rid="mmc1" ref-type="supplementary-material">Figures S1</xref>E and S1F). GWAS p values and effect sizes without population correction yields fairly discordant results when compared to default correction (<xref rid="mmc1" ref-type="supplementary-material">Figures S1</xref>G and S1H). We also observed that top variants detected from projection-based correction matches accurately to default correction (<xref rid="mmc1" ref-type="supplementary-material">Figures S1</xref>A and S1B). Overall, these results show that projection-based population stratification can be effective for correction of population-specific biases to a large extent. Most importantly, this approach can be implemented efficiently in a secure domain with much better overall performance compared to a full PCA-based population correction. We utilize projection-based population stratification to estimate the population covariates in the GWAS analysis.<fig id="fig2"><label>Figure 2</label><caption><p>Comparison of most significant variant concordance between projection-based population stratification and PCA-based stratification among 100 simulated GWAS</p><p>(A) The comparison of significant variant concordance for matching population panels. X axis shows the number of top variants. Y axis shows the concordance fraction. Blue boxplots depict the concordance between projection-based stratification and PCA-based stratification. Red boxplots show the concordance between GWAS with no population stratification and GWAS with PCA-based stratification.</p><p>(B) Concordance of most significant variants when projection is performed with a mismatching set of reference populations.</p></caption><graphic xlink:href="gr2"/></fig></p>
      <p id="p0100">We next tested the impact of mismatch between reference populations used in projection analysis and the study cohort. We first focused on the simulated case study and generated a study cohort consisting CEU, MXL, and YRI samples. We next performed projections where reference was constrained as single populations. When we used a homogeneous European population (TSI), we observed that the projected coordinates did not reflect the genetic ancestry of the study participants. In addition, we observed fairly low concordance between the top associated variants obtained from a full-scale PCA of the study sample (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>A). Of interest, when we use a single admixed population (GIH), we observed better separation of the study subjects albeit with low variant concordance (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>B). When we used another admixed population (PUR), the separation was slightly improved (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>C). When we used a reference population that contained mixture of the European, African, and American samples, we observed a fine separation among the study subjects and much higher concordance between the associated variants (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>D). Overall, these results show that projection-based approach must be carefully applied to ensure that the reference population includes a representative genetic diversity that can encompass that of the study participants.</p>
      <p id="p0105">We next studied our real study sample that is obtained from the dbGAP, for which we did not have <italic>a-priori</italic> knowledge about the ancestry. For this case, we performed projection using EUR, AMR, and AFR super-populations from the 1000 Genomes Project. Overall, the projection using single super-populations did not reveal the full complexity of the genetic ancestry of the study subjects. For example, EUR reference (<xref rid="mmc1" ref-type="supplementary-material">Figure S3</xref>A) did not appropriately separate the subjects and AMR (<xref rid="mmc1" ref-type="supplementary-material">Figure S3</xref>B) and AFR provided marginal separation of the subjects (<xref rid="mmc1" ref-type="supplementary-material">Figure S3</xref>C). When we use the whole 1000 Genomes populations (<xref rid="mmc1" ref-type="supplementary-material">Figure S3</xref>D), we observed a much better concordance to the principal components that are reported by the dbGAP (<xref rid="mmc1" ref-type="supplementary-material">Figures S3</xref>D and S3E). Particularly, the subjects tended to separate along the Europe-Asian-African Triangle from the two methods. It should again be noted that we do not require the covariates to match exactly because the PCs are treated as nuisance variables in the GWAS analysis, i.e., it is only necessary to capture the population structure. These results again denote that care must be taken to ensure that the reference panel is inclusive of the genetic ancestry of the study cohort.</p>
    </sec>
    <sec id="sec2.4">
      <title>Accuracy comparison with centralized association tests</title>
      <p id="p0110">First, we compared the accuracy of <italic>dMEGA</italic> in collaborative setting by comparing the association results with the centralized model as computed by lme4.<xref rid="bib40" ref-type="bibr"><sup>40</sup></xref> We used the genotypes and phenotypes data from the database of genotypes and phenotypes (dbGaP) with accession number phg000049 that comprises 3,007 individuals (1,266 case, 1,279 controls, 462 unknown). This dataset also contains the four covariates that are to be used for population stratification of the study subjects in downstream analyses. We ran <italic>dMEGA</italic> after partitioning data into three sites based on the k-means algorithm on the genotypes data and used the projection-based covariates for population stratification. The sites were treated as the additive random intercept effect, and this can be more efficient than treating them as fixed-effects when the number of sites is exploding. This assertion is justified since each term needs to be included at each site as a separate fixed effect term and may cause convergence or numerical stability problems. In the comparisons, we focused on the top 10,000 SNPs that were reported by plink<xref rid="bib41" ref-type="bibr"><sup>41</sup></xref> version 2 as most significantly associated with the disease status. This variant selection is done to decrease computational requirements. We ensured that the top 10,000 SNPs include the variants that have the highest association with the phenotype (AD-status) and contains large number of variants with no significant association, i.e., it is a representative set of variants for comparing the methods. We also evaluated the utility of projection-based population stratification and correction by estimating the population-based covariates using the 2,504 individuals in the 1000 Genomes Project (Methods).</p>
      <p id="p0115">We first compared the top SNPs at different significance levels using two stratification approaches to evaluate their effect, which are shown in <xref rid="tbl1" ref-type="table">Table 1</xref> using projections on top 4 and 6 components as covariates in population stratification. The choice of 4 projected covariates is for comparing the results when the number of projected covariates matches the dbGAP reported covariates. We also tested usage of 6 projected covariates to demonstrate that projection may require larger number of covariates to capture the genetic diversity in the study cohort. Overall, both methods exhibit high concordance with the centralized model (lme4).<table-wrap position="float" id="tbl1"><label>Table 1</label><caption><p>Performance of predicting significant SNPs under various significant level α</p></caption><table frame="hsides" rules="groups"><thead><tr><th>α</th><th>precision</th><th>recall</th><th>F1-score</th><th>Significant SNPs</th></tr></thead><tbody><tr><td colspan="5"><bold>Comparison 1: <italic>dMEGA</italic> on projected 4 PCs versus ‘lme4’ on 4 dbGAP Reported PCs</bold></td></tr><tr><td colspan="5"><hr/></td></tr><tr><td><inline-formula><mml:math id="M1" altimg="si10.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>0.580645</td><td>0.818182</td><td>0.679245</td><td>22</td></tr><tr><td><inline-formula><mml:math id="M2" altimg="si11.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>0.875</td><td>0.875</td><td>0.875</td><td>8</td></tr><tr><td><inline-formula><mml:math id="M3" altimg="si12.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>1</td><td>1</td><td>1</td><td>6</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td colspan="5"><bold>Comparison 2: <italic>dMEGA</italic> on projected 6 PCs versus ‘lme4’ on dbGAP Reported 4 PCs</bold></td></tr><tr><td colspan="5"><hr/></td></tr><tr><td><inline-formula><mml:math id="M4" altimg="si10.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>0.68</td><td>1</td><td>0.81</td><td>19</td></tr><tr><td><inline-formula><mml:math id="M5" altimg="si11.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>1</td><td>0.88</td><td>0.93</td><td>8</td></tr><tr><td><inline-formula><mml:math id="M6" altimg="si12.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>1</td><td>1</td><td>1</td><td>6</td></tr></tbody></table></table-wrap></p>
      <p id="p0120">We next pooled all of the SNPs and plotted the assigned p values, which is shown in <xref rid="fig3" ref-type="fig">Figure 3</xref>. Consistent with previous result, we observed that using 6 components exhibit a higher concordance of significance levels (Spearman correlation <inline-formula><mml:math id="M7" altimg="si1.gif"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math></inline-formula> for 6-components vs. 0.97 for 4-components.) (<xref rid="tbl2" ref-type="table">Table 2</xref>)<fig id="fig3"><label>Figure 3</label><caption><p>Scatterplots of p values from two comparisons</p><p>(A) Scatterplot of p values from comparison 1.</p><p>(B) Scatterplot of p values from comparison 2. The lme4 baseline models experimented with 4PCs dbGAP reported covariates.</p></caption><graphic xlink:href="gr3"/></fig><table-wrap position="float" id="tbl2"><label>Table 2</label><caption><p>Correlation statistics in two comparisons</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Comparison 1</th><th>Comparison 2</th></tr></thead><tbody><tr><td>Spearman correlation</td><td>0.9734</td><td>0.9909</td></tr><tr><td>Pearson correlation</td><td>0.9509</td><td>0.9845</td></tr></tbody></table></table-wrap></p>
      <p id="p0125">We next compared the ranks assigned to most significant SNPs by the two approaches when they are compared to the centralized model (<xref rid="fig4" ref-type="fig">Figures 4</xref> and <xref rid="mmc1" ref-type="supplementary-material">S4–S6</xref>). This is an important comparison to make sure that the most significant SNPs (from the original set of 10,000 variants), which would be functionally validated by the collaborating sites. Overall, there is fairly high concordance in the top SNPs and their rankings. Qualitatively, we observed ranking consistency to the centralized model is higher for population correction using 6-component projection compared to 4-component projections. <xref rid="tbl3" ref-type="table">Table 3</xref> We finally visually evaluated the genome-wide distribution of the SNP significance, assigned by the 2 projection approaches and the centralized model <xref rid="fig5" ref-type="fig">Figures 5</xref>, <xref rid="fig6" ref-type="fig">6</xref>, and <xref rid="fig7" ref-type="fig">7</xref>. As expected, all methods find the most significant associations on chromosome 19 with high concordance, which is known to be associated with AD.<fig id="fig4"><label>Figure 4</label><caption><p>SNP ranking concordance between lme4 and dMEGA</p><p>(A) Paired boxplot of comparison 1.</p><p>(B) Paired boxplot of comparison 2. The lme4 baseline models experimented with 4PCs dbGAP reported covariates.</p></caption><graphic xlink:href="gr4"/></fig><table-wrap position="float" id="tbl3"><label>Table 3</label><caption><p>20 Selected SNPs with high significance</p></caption><table frame="hsides" rules="groups"><thead><tr><th>SNP</th><th>CHR</th><th>dMEGA projected 6PCs</th><th>dMEGA projected 4PCs</th><th>lme4 dbGAP Reported 4PCs</th></tr></thead><tbody><tr><td>rs2075650</td><td>19</td><td>3.48E-42</td><td>9.14E-42</td><td>9.64E-42</td></tr><tr><td>rs405509</td><td>19</td><td>2.30E-14</td><td>3.22E-14</td><td>2.36E-14</td></tr><tr><td>rs8106922</td><td>19</td><td>3.24E-13</td><td>3.65E-13</td><td>3.37E-13</td></tr><tr><td>rs6859</td><td>19</td><td>6.93E-14</td><td>2.89E-13</td><td>3.37E-13</td></tr><tr><td>rs157580</td><td>19</td><td>1.57E-11</td><td>3.58E-11</td><td>2.13E-11</td></tr><tr><td>rs10402271</td><td>19</td><td>1.03E-08</td><td>1.35E-08</td><td>7.70E-09</td></tr><tr><td>rs4796606</td><td>17</td><td>1.39E-07</td><td>3.07E-07</td><td>1.69E-07</td></tr><tr><td>rs439401</td><td>19</td><td>1.02E-06</td><td>1.60E-06</td><td>8.50E-07</td></tr><tr><td>rs4954152</td><td>2</td><td>1.43E-06</td><td>3.95E-07</td><td>2.21E-06</td></tr><tr><td>rs2507880</td><td>11</td><td>2.45E-06</td><td>2.51E-06</td><td>2.96E-06</td></tr><tr><td>rs2939753</td><td>11</td><td>5.38E-06</td><td>2.30E-06</td><td>6.19E-06</td></tr><tr><td>rs11649731</td><td>17</td><td>7.32E-06</td><td>4.55E-06</td><td>6.47E-06</td></tr><tr><td>rs2924943</td><td>2</td><td>4.59E-06</td><td>1.09E-06</td><td>7.84E-06</td></tr><tr><td>rs7592667</td><td>2</td><td>7.55E-06</td><td>2.38E-05</td><td>8.10E-06</td></tr><tr><td>rs1526528</td><td>7</td><td>6.34E-06</td><td>1.05E-05</td><td>8.54E-06</td></tr><tr><td>rs1798296</td><td>12</td><td>7.03E-06</td><td>5.74E-06</td><td>9.01E-06</td></tr><tr><td>rs1471263</td><td>4</td><td>3.47E-06</td><td>2.20E-06</td><td>9.18E-06</td></tr><tr><td>rs6078239</td><td>20</td><td>8.82E-06</td><td>9.74E-06</td><td>9.26E-06</td></tr><tr><td>rs12320530</td><td>12</td><td>1.29E-05</td><td>1.97E-05</td><td>9.54E-06</td></tr><tr><td>rs7222487</td><td>17</td><td>7.52E-06</td><td>4.82E-06</td><td>9.63E-06</td></tr></tbody></table></table-wrap><fig id="fig5"><label>Figure 5</label><caption><p>Association significance of SNPs scored by <italic>dMEGA</italic> with projected datasets on 4 PCs</p><p>Manhattan plot shows the chromosomes on x axis and <inline-formula><mml:math id="M8" altimg="si9.gif"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>0</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> on the y axis. Each dot corresponds to an SNP.</p></caption><graphic xlink:href="gr5"/></fig><fig id="fig6"><label>Figure 6</label><caption><p>Association significance of SNPs scored by <italic>dMEGA</italic> with projected datasets on 6 PCs</p><p>Manhattan plot shows the chromosomes on x axis and <inline-formula><mml:math id="M9" altimg="si9.gif"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>0</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> on the y axis. Each dot corresponds to an SNP.</p></caption><graphic xlink:href="gr6"/></fig><fig id="fig7"><label>Figure 7</label><caption><p>Association significance of SNPs scored by lme4 with 4 dbGAP reported PCs</p><p>Manhattan plot shows the chromosomes on x axis and <inline-formula><mml:math id="M10" altimg="si9.gif"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>0</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> on the y axis. Each dot corresponds to an SNP.</p></caption><graphic xlink:href="gr7"/></fig></p>
    </sec>
    <sec id="sec2.5">
      <title>Comparison with cGLMM</title>
      <p id="p0130">We next compared dMEGA with cGLMM<xref rid="bib42" ref-type="bibr"><sup>42</sup></xref> algorithm from the open source GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/huthvincent/cGLMM" id="intref0025">https://github.com/huthvincent/cGLMM</ext-link>, and used the provided synthetic data, which comprised of 150 SNPs for 3000 samples also obtained from the same GitHub repository. cGLMM utilizes an MCMC-based optimization for estimating the effect sizes for the covariates in the dataset in the federated GLMM setting. We simulated federated learning conditions by loading the data into two separate clients, each having sample sizes of 1498 and 1502, respectively, while maintaining a central server that managed the communication and aggregation of the intermediate statistics. We ran the cGLMM algorithm 20 times and observed that we could only reproduce the results for 7 runs (<xref rid="mmc1" ref-type="supplementary-material">Table S1</xref>), which we attributed to numerical issues arising from either (1) parameter initialization or (2) Hessian matrix calculations (Personal communication with authors). On further investigation, we found that the intermediate Hessian matrix converged to a matrix of all zeros, which prevented the algorithm from updating beta (Equation 8 in Zhu et al. cGLMM paper).</p>
      <p id="p0135">To test the robustness of dMEGA, we randomly selected 10 SNPs from the 10,000 variant set and ran dMEGA 20 times independently on each SNP and estimated robustness of the statistics. Overall, dMEGA successfully completed all runs on all of the 10 SNPs. In addition, the standard deviation of p value estimated for each SNP among the independent runs is much smaller than the mean of the p value, indicating robust estimate of the p value. We observed a similar robustness for the estimated effect sizes (<xref rid="mmc1" ref-type="supplementary-material">Table S2</xref>).</p>
      <p id="p0140">We also observed important conceptual differences in cGLMM’s design and reported statistics. In particular, cGLMM algorithm aims to fit a single model for a given set of variants or covariates, providing only the effect size for each variant, without a statistical significance (i.e., p values for each covariate) of the effect sizes. This may pose a major limitation for application to GWAS because it is necessary to evaluate significance of the tested variants so as to filter out variants with no association. Thus, we believe cGLMM may not be directly applicable in GWAS settings.</p>
      <p id="p0145">Conversely, dMEGA fits a model for each variant individually and reports both the effect size and statistical significance for each predicted effect size. In summary, our comparisons indicate that the cGLMM algorithm and dMEGA differ in their conceptual design and practical applicability.</p>
    </sec>
    <sec id="sec2.6">
      <title>Timing, memory, and data transfer</title>
      <p id="p0150">Our experiment was done in a computation environment of 96 threads (24 Cores) Intel(R) Xeon(R) Platinum 8168 CPU @ 2.70 GHz, 1.5 TB memory, Ubuntu 16.04.7 LTS, Python 3.10.4. In the tests, 1 thread was used for estimating the runtime. We observed a small difference between running 6PCs and 4PCs in <italic>dMEGA</italic>. Federated computation for each SNP took 20 s and 200 MB memory on average to complete. The total communication cost of 4 PCs and 6 PCs federated model are 80 kB and 125 kB on average. This cost includes, for each iteration, each site transmit 88 Bytes of random effect coefficient, 144 Bytes of computational intermediates, and 72 Bytes of fixed effects coefficients (<xref rid="tbl4" ref-type="table">Table 4</xref>). Overall, these results indicate low network transfer requirements for <italic>dMEGA</italic>’s framework (<xref rid="fig8" ref-type="fig">Figure 8</xref>). The algorithm can benefit from software optimizations by parallelization of the calculations by multithreading.<table-wrap position="float" id="tbl4"><label>Table 4</label><caption><p>Communication summary</p></caption><table frame="hsides" rules="groups"><thead><tr><th><inline-formula><mml:math id="M11" altimg="si13.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="M12" altimg="si14.gif"><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula></th><th><inline-formula><mml:math id="M13" altimg="si14.gif"><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="M14" altimg="si13.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></th></tr></thead><tbody><tr><td>Number of PCs <italic>p</italic>: <bold>scalar</bold></td><td>Current working SNP’s name <italic>S</italic>: <bold>character</bold></td></tr><tr><td>A list of SNPs’ name <italic>S</italic>: <bold>list</bold></td><td>Global gradient <italic>l</italic>: <inline-formula><mml:math id="M15" altimg="si15.gif"><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><bold>vector</bold></td></tr><tr><td>Sample size <inline-formula><mml:math id="M16" altimg="si16.gif"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: <bold>scalar</bold></td><td>Global Hessian <italic>H</italic>: <inline-formula><mml:math id="M17" altimg="si17.gif"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula><bold>matrix</bold></td></tr><tr><td>Local gradient <inline-formula><mml:math id="M18" altimg="si18.gif"><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>: <inline-formula><mml:math id="M19" altimg="si15.gif"><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><bold>vector</bold></td><td>Global parameter θ: <inline-formula><mml:math id="M20" altimg="si15.gif"><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><bold>vector</bold></td></tr><tr><td>Local Hessian <inline-formula><mml:math id="M21" altimg="si19.gif"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: <inline-formula><mml:math id="M22" altimg="si17.gif"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula><bold>matrix</bold></td><td>Inference statistics: <inline-formula><mml:math id="M23" altimg="si15.gif"><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><bold>vector</bold></td></tr><tr><td>Local mixed effect <inline-formula><mml:math id="M24" altimg="si20.gif"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: <bold>scalar</bold></td><td/></tr><tr><td>Local Standard Error <inline-formula><mml:math id="M25" altimg="si21.gif"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: <inline-formula><mml:math id="M26" altimg="si15.gif"><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><bold>vector</bold></td><td/></tr></tbody></table></table-wrap><fig id="fig8"><label>Figure 8</label><caption><p>Diagram of federated GLMM inference in <italic>dMEGA</italic></p></caption><graphic xlink:href="gr8"/></fig></p>
      <p id="p0155">As we are aware that dMEGA requires significant computational resources for large-scale studies involving millions of variants (e.g., estimation for 10,000 SNPs takes 200,000 s on a single thread), we recommend that its application be focused on specific scenarios. For instance, it can be useful in small-scale validation studies or targeted association testing, where sites may focus on small regions deemed significant at each site separately and validate using new samples collaboratively. Alternatively, sites may wish to collaborate on samples genotyped using targeted technologies like exome sequencing and targeted gene panels. These approaches can provide valuable insights into the genetic basis of complex traits while mitigating the computational burden.</p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Discussion</title>
    <p id="p0160">We presented <italic>dMEGA</italic> for federated generalized linear mixed modeling. <italic>dMEGA</italic> is readily applicable to collaborations where data sharing at the summary statistic level can be deployed. Unlike previous methods that rely on a computationally intensive federated PCA for performing population stratification and correction, <italic>dMEGA</italic> makes use of projection on existing reference panels and to correct for population biases. As the size and diversity of existing panels increase, we foresee that projection-based bias correction can prove more accurate. The projection has very small computational requirements and can be performed at each site before federated analysis.</p>
    <p id="p0165">Another similar method distributed Penalized Quasi-Likelihood (dPQL)<xref rid="bib43" ref-type="bibr"><sup>43</sup></xref> used penalized quasi-likelihood to approximate the objective function of GLMM. dPQL simplifies the maximization of the log likelihood function of GLMM to fitting a linear mixed model. However, dPQL has inherited drawbacks. For example, dPQL depends strongly on the estimated variance components,<xref rid="bib44" ref-type="bibr"><sup>44</sup></xref> but the inference of variance parameters in dPQL may be biased<xref rid="bib45" ref-type="bibr"><sup>45</sup></xref> because of its linearity assumption. <italic>dMEGA</italic> approximates the marginal distributions, and it provides more robust estimation since <italic>dMEGA</italic> considers the marginal predicted ratios associated with each local site, not just identifying samples with particularly high predicted ratios.<xref rid="bib44" ref-type="bibr"><sup>44</sup></xref> Another method that was recently proposed by Zhu et al.,<xref rid="bib42" ref-type="bibr"><sup>42</sup></xref> which utilizes Expectation Maximization by integrating Metropolis-Hastings algorithm with Newton-Raphson as the maximization steps for performing generalized linear mixed model in a collaborative fashion. Although this method is expected to provide matching results with a centralized algorithm, EM requires large sample sizes for robust parameter estimation and may likely get stuck in local optima in the parameter estimation. Our comparison results demonstrate some possible source of stability issues, e.g., convergence to a zero Hessian matrix. More importantly, cGLMM is designed to estimate only the covariate effect sizes and does not provide statistical significance for the effect sizes. This is an important consideration for application in GWAS since significance of the variants are central to filtering them out in these studies. We therefore believe dMEGA and cGLMM differ in conceptual and practical terms and in their application domains.</p>
    <p id="p0170">As the current implementation stands, <italic>dMEGA</italic> can be used for correcting for site-specific random risk factors (such as environmental factors). In addition, we formulated an approach that can be implemented into <italic>dMEGA</italic> to include site-level correlations among the random effects. This approach can be integrated into <italic>dMEGA</italic>’s federated implementation and be used to model more complex random risk effects among sites (e.g., sites close to each other geographically). A related work is lme4qtl,<xref rid="bib46" ref-type="bibr"><sup>46</sup></xref> which can incorporate individual-level random effects using a covariance matrix, e.g., kinship matrix. In its current implementation <italic>dMEGA</italic> is not able to handle the individual-level covarying random effects. We leave this as a future extension of the <italic>dMEGA</italic>’s federated GWAS framework.</p>
    <sec id="sec3.1">
      <title>Limitations of the study</title>
      <p id="p0175"><italic>dMEGA</italic> has several limitations that warrant further research. While our federated testing approach has small network traffic requirements, each local site is required to handle high computational load. This is a general challenge among federated learning methods. Considering that the gene association tests may involve millions of variants along with large number of phenotypes, the center server aggregation layer can be outsourced to cloud whereby, while the data are kept locally. Another limitation of <italic>dMEGA</italic> is selection of the reference panels that are used in projection step. As our results indicate, a reference panel that is not reflective of the genetic diversity of the study participants may inadvertently bias the results. Projection-based analysis has been employed previously in ancestry estimation<xref rid="bib37" ref-type="bibr"><sup>37</sup></xref> and kinship estimation methods<xref rid="bib47" ref-type="bibr"><sup>47</sup></xref> and the main justification for using the projection approaches is to decrease the computational requirements of a full federated PCA that entails large computational load on the sites. The future work in this arena include tuning the projected covariates to match the genetic ancestry of the study participants. For example, the sites can iteratively update the projected covariates to increase the genotypic variance explained by the covariates. We also propose the usage of "worldwide panel PCs<xref rid="bib37" ref-type="bibr"><sup>37</sup></xref>" that encompass the genetic diversity of a large set of populations. It is worth noting that the projection requires the principal components and not the individual level genotype data. Thus, it does not directly increase the individual-level privacy risks. In turn, the worldwide panel PCs can be released even from restricted panels such as TOPMed.</p>
      <p id="p0180">From privacy perspective, <italic>dMEGA</italic> shares only summary statistics between the central server and the sites. In that regard, it is necessary that the central server is a trusted entity (such as NIH) and that all sites are expected to execute <italic>dMEGA</italic> in an honest manner. As summary statistics may leak information, honest-but-curious entities can perform re-identification attacks. This is, however, a general concern in federated learning frameworks and not specific to <italic>dMEGA</italic>. Our approach does not pose a direct risk to the reference panel because projection requires only the principal components. Thus, restricted reference panels from underrepresented populations can be utilized in these computations. It is still worth noting that the principal components are types of summary statistics and can leak information that may be used to re-identify participation using previously described attacks.<xref rid="bib48" ref-type="bibr"><sup>48</sup></xref> Furthermore, the intermediate statistics (<inline-formula><mml:math id="M27" altimg="si2.gif"><mml:mrow><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>) are also vulnerable to certain attacks on federated learning systems such as variants of gradient inversion attacks.<xref rid="bib49" ref-type="bibr"><sup>49</sup></xref> Thus, it is important to protect these model information during the federated learning process. Different approaches can be used to protect these summary statistics such as multi-key homomorphic encryption<xref rid="bib50" ref-type="bibr"><sup>50</sup></xref> (MKHE), or Differential Privacy (DP). The usage of these formalisms requires further research into efficient re-formulations for MKHE and balancing the Gaussian or Laplace noise level for DP for ensuring utility.</p>
      <p id="p0185">To increase the confidentiality of <italic>dMEGA</italic>, we can utilize noise addition to hide local intermediate information, denoted as <inline-formula><mml:math id="M28" altimg="si3.gif"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (i.e. local sample size, local gradient, local Hessian, local mixed effects, and local standard error), during communication. This idea has been developed in the HyFed<xref rid="bib51" ref-type="bibr"><sup>51</sup></xref> framework, which introduces a server called <italic>Compensator</italic> to collect the local noise <inline-formula><mml:math id="M29" altimg="si4.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> values from each client and send the aggregated noise, i.e., <inline-formula><mml:math id="M30" altimg="si5.gif"><mml:mrow><mml:mi>N</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, to the CS. In this process, each client generates local noise <inline-formula><mml:math id="M31" altimg="si4.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> from a Gaussian distribution with zero mean and a variance of <inline-formula><mml:math id="M32" altimg="si6.gif"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. Then, each client will mask the intermediate statistics <inline-formula><mml:math id="M33" altimg="si3.gif"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> using the noise <inline-formula><mml:math id="M34" altimg="si4.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, to generate <inline-formula><mml:math id="M35" altimg="si7.gif"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and send the noisy statistic to CS. Simultaneously, each site sends the noise levels to the <italic>Compensator</italic>. When all clients finish their communication, CS unmasks the global information of interest <inline-formula><mml:math id="M36" altimg="si8.gif"><mml:mrow><mml:mi>I</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> via deducting the aggregated noise <italic>N</italic> provided by <italic>Compensator</italic>.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <title>STAR★Methods</title>
    <sec id="sec4.1">
      <title>Key resources table</title>
      <p id="p0190">
        <table-wrap position="float" id="undtbl1">
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th>REAGENT or RESOURCE</th>
                <th>SOURCE</th>
                <th>IDENTIFIER</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="3">
                  <bold>Deposited data</bold>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td>Late Onset Alzheimer’s Disease Cohort Dataset</td>
                <td>Database of Genotypes and Phenotypes (dbGaP)</td>
                <td>phs000168</td>
              </tr>
              <tr>
                <td>The 1000 Genomes Project Genotype and Metadata</td>
                <td>1000 Genomes Project</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://www.internationalgenome.org/data/" id="intref0030">https://www.internationalgenome.org/data/</ext-link>
                </td>
              </tr>
              <tr>
                <td>R</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/bin/windows/base/" id="intref0035">https://cran.r-project.org/bin/windows/base/</ext-link>
                </td>
                <td>R</td>
              </tr>
              <tr>
                <td>dMEGA</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/Li-Wentao/dMEGA" id="intref0040">https://github.com/Li-Wentao/dMEGA</ext-link>
                </td>
                <td>dMEGA</td>
              </tr>
              <tr>
                <td>Plink2</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://www.cog-genomics.org/plink/2.0" id="intref0045">https://www.cog-genomics.org/plink/2.0</ext-link>
                </td>
                <td>Plink2</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </p>
    </sec>
    <sec id="sec4.2">
      <title>Resource availability</title>
      <sec id="sec4.2.1">
        <title>Lead contact</title>
        <p id="p0195">Further information and requests for resources and reagents should be directed to and will be fulfilled by the lead contact, Arif Harmanci (<ext-link ext-link-type="uri" xlink:href="mailto:Arif.O.Harmanci@uth.tmc.edu" id="intref0050">Arif.O.Harmanci@uth.tmc.edu</ext-link>).</p>
      </sec>
      <sec id="sec4.2.2">
        <title>Materials availability</title>
        <p id="p0200">This study did not generate new unique reagents.</p>
      </sec>
    </sec>
    <sec id="sec4.3">
      <title>Method details</title>
      <p id="p0205">The goal of <italic>dMEGA</italic> is to detect significant SNPs that are associated with specific diseases or phenotypes in a federated manner. In our assumption, genotype and phenotype data are stored cohort-wise throughout several entities (e.g., research institutions or hospitals). Each entity is presumed to be prohibited from sending original data. By constructing a logistic regression model with mixed effects, data holders will update the global model with local information bias considered. Notice that the communication process does not put data at risk due to <italic>dMEGA</italic> will only ask data holders for model information, such as gradients.</p>
      <sec id="sec4.3.1">
        <title>Projection-based calculation of population covariates</title>
        <p id="p0210"><italic>dMEGA</italic> first centers the genotype matrix for each individual and projects the samples on a reference panel that is shared among the sites. In the context of privacy-aware analysis, this is a reasonable assumption because the sites can make use of numerous publicly available panels. For <italic>dMEGA</italic>, we use The 1000 Genomes Project panel that comprises 26 diverse sets of populations that are geographically sampled over the world.</p>
        <p id="p0215">The reference panel is first processed at the central server. This is done by performing principal component analysis (PCA) on the reference panel by decomposition of the genotype covariance matrix, i.e., <inline-formula><mml:math id="M37" altimg="si22.gif"><mml:mrow><mml:mi>P</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">·</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mi mathvariant="normal">Π</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">·</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">·</mml:mo><mml:msup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="M38" altimg="si23.gif"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes the full set of principal components of reference panel genotype matrix <inline-formula><mml:math id="M39" altimg="si24.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for <italic>N</italic> genetic variants and <italic>S</italic> samples in the reference panel, where <inline-formula><mml:math id="M40" altimg="si25.gif"><mml:mrow><mml:mi>S</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>2,504</mml:mn></mml:mrow></mml:math></inline-formula> for The 1000 Genomes Project population data. We use κ top principal components (columns) of this matrix in our projection step.</p>
        <p id="p0220">After the reference panel is processed by the central server, the principal components are sent to collaborating sites. It should be noted that the reference panel is processed once at the central site at the beginning of the computations. The central server does not share the reference panel genotypes directly with the sites. The components do not represent direct risk to the reference panel individuals. This is advantageous for utilizing the restricted population panels, such as the ToPMED panel.<xref rid="bib6" ref-type="bibr"><sup>6</sup></xref><disp-formula id="fd1"><label>(Equation 1)</label><mml:math id="M41" altimg="si26.gif"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mo linebreak="goodbreak">·</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M42" altimg="si27.gif"><mml:mrow><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> denotes the centered genotype matrix.<disp-formula id="fd2"><label>(Equation 2)</label><mml:math id="M43" altimg="si28.gif"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo linebreak="goodbreak">&lt;</mml:mo><mml:mi>κ</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M44" altimg="si29.gif"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes the <inline-formula><mml:math id="M45" altimg="si30.gif"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> covariate for <inline-formula><mml:math id="M46" altimg="si31.gif"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> individual.</p>
      </sec>
      <sec id="sec4.3.2">
        <title>Projection-based covariate computation with the 1000 genomes sample</title>
        <p id="p0225">In our experiments, we used The 1000 Genomes Project’s phase 3 genotypes as the reference panel available at . We used the bi-allelic SNPs and subsampled the variants to utilize 77,531 variants. We generated the top 4 and 6 principal components for the 3,007 individuals in the genotype dataset.</p>
      </sec>
      <sec id="sec4.3.3">
        <title>Federated association test</title>
        <p id="p0230">We introduce a federated association test algorithm based on Generalized Linear Mixed Model. Assume that there will be <italic>k</italic> institutions that hold genotype and phenotype data, and that each institution’s database consists of <inline-formula><mml:math id="M47" altimg="si16.gif"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> subjects (<xref rid="fig8" ref-type="fig">Figure 8</xref>). Let the total number of patients be denoted by <inline-formula><mml:math id="M48" altimg="si32.gif"><mml:mrow><mml:mi>n</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Here, we consider site-wise mixed-effects, denoting <inline-formula><mml:math id="M49" altimg="si20.gif"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> as the mixed-effect of institution <italic>i</italic>, as well as shared fixed-effects θ. Notice that the fixed-effects parameter space is split into two parts, <inline-formula><mml:math id="M50" altimg="si33.gif"><mml:mrow><mml:mi>θ</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>γ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Denote β is of <inline-formula><mml:math id="M51" altimg="si34.gif"><mml:mrow><mml:mi>N</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> dimension parameter for covariates and γ is 1 dimension for genotype. The genotype dataset at institution <italic>i</italic> denoted as <inline-formula><mml:math id="M52" altimg="si35.gif"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (Matrix of <inline-formula><mml:math id="M53" altimg="si34.gif"><mml:mrow><mml:mi>N</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> covariates and 1 genotype on <inline-formula><mml:math id="M54" altimg="si36.gif"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> individuals), and phenotypes denoted as <inline-formula><mml:math id="M55" altimg="si37.gif"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (vector of length <inline-formula><mml:math id="M56" altimg="si36.gif"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>). Thus, the mixed model of each site can be represented as<disp-formula id="ufd1"><mml:math id="M57" altimg="si38.gif"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo linebreak="badbreak">=</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>θ</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="ufd2"><mml:math id="M58" altimg="si39.gif"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="goodbreak">∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M59" altimg="si40.gif"><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo linebreak="badbreak">·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the inverse of the link function (i.e., a logit function for logistic regression/binary traits) that defines the relationship between the linear combination of the predictors (genotypes, covariates, and random effects) to the mean of the phenotype. Here, we focus on the random intercept effect at site <italic>i</italic>, <inline-formula><mml:math id="M60" altimg="si20.gif"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, which follows a normal distribution with mean 0 and variance σ. In this scenario, <inline-formula><mml:math id="M61" altimg="si20.gif"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is constant for individuals on the same site. Across the sites, <inline-formula><mml:math id="M62" altimg="si20.gif"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is normally distributed across sites.</p>
        <p id="p0235">For a binary trait (i.e. case/control study), the conditional probability distribution of the phenotype given the variant genotypes and covariates can be written as<disp-formula id="ufd3"><mml:math id="M63" altimg="si41.gif"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn><mml:mo>∣</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:munder><mml:mo>∫</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munder><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>θ</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>φ</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where φ denotes the probability density function for normal distribution with mean 0 and hyper-parameter variance σ. Thus, the likelihood function of the joint distribution can be formulated as<disp-formula id="ufd4"><mml:math id="M64" altimg="si42.gif"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p id="p0240">The optimization of the likelihood function is a non-tractable problem because the integral over the random effects does not have a closed form representation. To solve the intractable problem, we utilize Laplace approximation for the likelihood function:<disp-formula id="ufd5"><mml:math id="M65" altimg="si43.gif"><mml:mrow><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>log</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo linebreak="newline">≜</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo linebreak="newline">≈</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>″</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="badbreak">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo linebreak="newline">≜</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M66" altimg="si44.gif"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>σ</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula>. And for computational convenience, we take log-likelihood as our objective function, that is<disp-formula id="ufd6"><mml:math id="M67" altimg="si45.gif"><mml:mrow><mml:mi>l</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">≜</mml:mo><mml:mi>log</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:mi>log</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">≜</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p id="p0245">Hence, the goal is to optimize the approximated objective function above. Compared to the centralized (all data pooled in one repository) inference, the optimization in federated learning settings is based on iterations of (1) Calculation of the intermediate statistics computed using each institution’s local data and (2) aggregation of the statistics by a central server (CS). We describe the steps in more detail below:</p>
        <p id="p0250"><bold>Initialization</bold>. The federated learning will start with a central server <inline-formula><mml:math id="M68" altimg="si14.gif"><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> that connects to <italic>k</italic> distributed local data repositories. Initial modeling information requests will send to each participant <inline-formula><mml:math id="M69" altimg="si13.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.<list list-type="simple" id="ulist0015"><list-item id="u0040"><label>•</label><p id="p0255">Number of PCs</p></list-item><list-item id="u0045"><label>•</label><p id="p0260">A list of SNPs’ name <italic>S</italic></p></list-item><list-item id="u0050"><label>•</label><p id="p0265">A list of sample size across participants <italic>N</italic></p></list-item></list></p>
        <p id="p0270"><bold>Step 1</bold>. <inline-formula><mml:math id="M70" altimg="si14.gif"><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> will initiate model parameters <inline-formula><mml:math id="M71" altimg="si46.gif"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for each distributed model with SNP in list <italic>S</italic>. And each local repository <inline-formula><mml:math id="M72" altimg="si13.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> computes model’s intermediates and send back to CS<list list-type="simple" id="ulist0020"><list-item id="u0055"><label>•</label><p id="p0275">Local gradients on fixed effects '<inline-formula><mml:math id="M73" altimg="si47.gif"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item id="u0060"><label>•</label><p id="p0280">Local Hessian matrix on fixed effects Hi</p></list-item><list-item id="u0065"><label>•</label><p id="p0285">Local site-wise mixed effect coefficient <inline-formula><mml:math id="M74" altimg="si20.gif"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></p></list-item></list></p>
        <p id="p0290"><bold>Step 2</bold>. <inline-formula><mml:math id="M75" altimg="si14.gif"><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> updates model’s parameter <inline-formula><mml:math id="M76" altimg="si48.gif"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with aggregated information from global gradients <inline-formula><mml:math id="M77" altimg="si49.gif"><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, global hessian <inline-formula><mml:math id="M78" altimg="si50.gif"><mml:mrow><mml:mi>H</mml:mi><mml:mi>μ</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and previous fixed-effects <inline-formula><mml:math id="M79" altimg="si51.gif"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The update is done by Newton’s method <inline-formula><mml:math id="M80" altimg="si52.gif"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:msup><mml:mi>l</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">/</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></inline-formula>. Then send <inline-formula><mml:math id="M81" altimg="si48.gif"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to each <inline-formula><mml:math id="M82" altimg="si13.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
        <p id="p0295"><bold>Step 3</bold>. Each <inline-formula><mml:math id="M83" altimg="si13.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> will follow Step 2 until model is converged with criteria <inline-formula><mml:math id="M84" altimg="si53.gif"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M85" altimg="si54.gif"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> below threshold <inline-formula><mml:math id="M86" altimg="si11.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
        <p id="p0300"><bold>Step 4</bold>. The <inline-formula><mml:math id="M87" altimg="si14.gif"><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> will compute the local standard errors <inline-formula><mml:math id="M88" altimg="si55.gif"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mo>⊤</mml:mo></mml:msubsup><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> from <inline-formula><mml:math id="M89" altimg="si13.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, then return inference statistics (e.g. Z score, P-values). Where <inline-formula><mml:math id="M90" altimg="si56.gif"><mml:mrow><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>⊤</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
        <p id="p0305">All the information in communication is summarized in table below</p>
      </sec>
      <sec id="sec4.3.4">
        <title>Dependent site-wise relationship in dMEGA</title>
        <p id="p0310">Furthermore, we can generalize this problem with the site-level variance-covariance matrix. Here, we don’t assume the dependency among federated sites and denote a site covariance matrix <inline-formula><mml:math id="M91" altimg="si57.gif"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:math></inline-formula>. Notice that <inline-formula><mml:math id="M92" altimg="si57.gif"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:math></inline-formula> is a <inline-formula><mml:math id="M93" altimg="si58.gif"><mml:mrow><mml:mi>k</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> matrix under our scenario. We assume the site variance-covariance matrix <inline-formula><mml:math id="M94" altimg="si57.gif"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:math></inline-formula> is known. And τ is the cross-site hyperparameter to be estimated.</p>
        <p id="p0315">Hence the distribution of the random effect is a multivariate normal distribution and it is shown as<disp-formula id="ufd7"><mml:math id="M95" altimg="si59.gif"><mml:mrow><mml:mi>μ</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>⊤</mml:mo></mml:msup><mml:mo linebreak="goodbreak">∼</mml:mo><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where μ is the vector of random effects of each federated site, and τ is the hyperparameter that is to be estimated. Now, the objective function of the dependent sites is<disp-formula id="ufd8"><mml:math id="M96" altimg="si60.gif"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∣</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      </sec>
    </sec>
    <sec id="sec4.4">
      <title>Quantification and statistical analysis</title>
      <p id="p0320">p-values reported in the results are estimated with respect to the aforementioned generalized linear mixed models. P-value cutoffs are selected as described in the reported tables and results.</p>
      <sec id="sec4.4.1">
        <title>Data sources and experimental setup</title>
        <p id="p0325">We used genotype-phenotype data obtained from database of Genotypes and Phenotypes (dbGaP) with accession number phs000168 for our experiments available for General Research Use (GRU). This dataset contains <inline-formula><mml:math id="M97" altimg="si61.gif"><mml:mrow><mml:mn>575,003</mml:mn></mml:mrow></mml:math></inline-formula> variants genotyped by Illumina Human610-Quad version 1 platform over <inline-formula><mml:math id="M98" altimg="si62.gif"><mml:mrow><mml:mn>3,007</mml:mn></mml:mrow></mml:math></inline-formula> individuals. Raw data is processed and formatted with plink2.<xref rid="bib41" ref-type="bibr"><sup>41</sup></xref> The alternate alleles reported by the array platform were re-coded using in-house scripts to ensure that they were concordant with The 1000 Genomes Project. Any variant for which we could not resolve by strand were excluded. We next used plink2’s "–glm" option to calculate the baseline association signals. We next filtered the SNPs and identified the SNPs with top <inline-formula><mml:math id="M99" altimg="si63.gif"><mml:mrow><mml:mn>10,000</mml:mn></mml:mrow></mml:math></inline-formula> variants with the strongest association signal to the phenotype.</p>
        <p id="p0330">The reference panel is obtained from the 1000 Genomes Project FTP portal at <ext-link ext-link-type="uri" xlink:href="ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/" id="intref0055">ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/</ext-link>. We processed 1000 Genomes dataset by first excluding the SNPs with minor allele frequency (MAF) smaller than <inline-formula><mml:math id="M100" altimg="si64.gif"><mml:mrow><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>. We next overlapped the variants with the re-coded array variants, which yielded <inline-formula><mml:math id="M101" altimg="si65.gif"><mml:mrow><mml:mn>155,076</mml:mn></mml:mrow></mml:math></inline-formula> common variants. To decrease computational requirements, we focused on variants on the 22 autosomal chromosomes and further sub-sampled the remaining variants to generate the final <inline-formula><mml:math id="M102" altimg="si66.gif"><mml:mrow><mml:mn>77,315</mml:mn></mml:mrow></mml:math></inline-formula> variants. These variants were used to generate the principal components and population-based covariates in the projection step.</p>
        <p id="p0335">To evaluate <italic>dMEGA</italic>, we compared it with a baseline method using the linear mixed model implemented in R package ‘lme4’.<xref rid="bib52" ref-type="bibr"><sup>52</sup></xref> Our experiments were designed as table below:</p>
        <p id="p0340">We will focus on two comparisons (beow table):<table-wrap position="float" id="undtbl5"><caption><p>Experiments</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Distributed</th><th>Pooled</th></tr></thead><tbody><tr><td>Projected</td><td><italic>dMEGA</italic><sup>∗†</sup></td><td>R(lme4)<sup>†</sup></td></tr><tr><td>dbGAP Covariates</td><td>–</td><td>R(lme4)<sup>∗</sup></td></tr></tbody></table></table-wrap><list list-type="simple" id="olist0015"><list-item id="o0010"><label>1.</label><p id="p0345">(Denoted in †) <italic>dMEGA</italic> in projected and distributed data and baseline in projected and pooled data.</p></list-item></list></p>
        <p id="p0350">While the datasets are the same (projected), this comparison aims to show the performance of <italic>dMEGA</italic> in distributed datasets.<list list-type="simple" id="olist0020"><list-item id="o0015"><label>2.</label><p id="p0355">(Denoted in <inline-formula><mml:math id="M103" altimg="si67.gif"><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:math></inline-formula>) <italic>dMEGA</italic> using projected covariates and distributed data and baseline in dbGAP provided covariates and pooled data.</p></list-item></list></p>
        <p id="p0360">The datasets are of different between <italic>dMEGA</italic> method (using projected covariates) and baseline method (using dbGAP covariates). This comparison will show the capability of projection combining with federated learning.</p>
      </sec>
    </sec>
  </sec>
</body>
<back>
  <ref-list id="cebib0010">
    <title>References</title>
    <ref id="bib1">
      <label>1</label>
      <element-citation publication-type="journal" id="sref1">
        <person-group person-group-type="author">
          <name>
            <surname>Christensen</surname>
            <given-names>K.D.</given-names>
          </name>
          <name>
            <surname>Dukhovny</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Siebert</surname>
            <given-names>U.</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>R.C.</given-names>
          </name>
        </person-group>
        <article-title>Assessing the costs and cost-effectiveness of genomic sequencing</article-title>
        <source>J. Personalized Med.</source>
        <volume>5</volume>
        <year>2015</year>
        <fpage>470</fpage>
        <lpage>486</lpage>
      </element-citation>
    </ref>
    <ref id="bib2">
      <label>2</label>
      <element-citation publication-type="journal" id="sref2">
        <person-group person-group-type="author">
          <name>
            <surname>Sboner</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Mu</surname>
            <given-names>X.J.</given-names>
          </name>
          <name>
            <surname>Greenbaum</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Auerbach</surname>
            <given-names>R.K.</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M.B.</given-names>
          </name>
        </person-group>
        <article-title>The real cost of sequencing: higher than you think</article-title>
        <source>Genome Biol.</source>
        <volume>12</volume>
        <year>2011</year>
        <fpage>125</fpage>
        <pub-id pub-id-type="pmid">21867570</pub-id>
      </element-citation>
    </ref>
    <ref id="bib3">
      <label>3</label>
      <element-citation publication-type="journal" id="sref3">
        <person-group person-group-type="author">
          <collab>All of Us Research Program Investigators</collab>
          <name>
            <surname>Denny</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Rutter</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Goldstein</surname>
            <given-names>D.B.</given-names>
          </name>
          <name>
            <surname>Philippakis</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Smoller</surname>
            <given-names>J.W.</given-names>
          </name>
          <name>
            <surname>Jenkins</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Dishman</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>The “all of us” research program</article-title>
        <source>N. Engl. J. Med.</source>
        <volume>381</volume>
        <year>2019</year>
        <fpage>668</fpage>
        <lpage>676</lpage>
        <pub-id pub-id-type="pmid">31412182</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <label>4</label>
      <element-citation publication-type="journal" id="sref4">
        <person-group person-group-type="author">
          <name>
            <surname>Palsson</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Rabinow</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Iceland: the case of a national human genome project</article-title>
        <source>Anthropol. Today</source>
        <volume>15</volume>
        <year>1999</year>
        <fpage>14</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="pmid">15199942</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <label>5</label>
      <element-citation publication-type="journal" id="sref5">
        <person-group person-group-type="author">
          <name>
            <surname>Sudlow</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Gallacher</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Beral</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Burton</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Danesh</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Downey</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Elliott</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Landray</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>UK biobank: an open access resource for identifying the causes of a wide range of complex diseases of middle and old age</article-title>
        <source>PLoS Med.</source>
        <volume>12</volume>
        <year>2015</year>
        <object-id pub-id-type="publisher-id">e1001779</object-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <label>6</label>
      <element-citation publication-type="journal" id="sref6">
        <person-group person-group-type="author">
          <name>
            <surname>Taliun</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>D.N.</given-names>
          </name>
          <name>
            <surname>Kessler</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Szpiech</surname>
            <given-names>Z.A.</given-names>
          </name>
          <name>
            <surname>Torres</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Taliun</surname>
            <given-names>S.A.G.</given-names>
          </name>
          <name>
            <surname>Corvelo</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Gogarten</surname>
            <given-names>S.M.</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>H.M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sequencing of 53,831 diverse genomes from the NHLBI TOPMed program</article-title>
        <source>Nature</source>
        <volume>590</volume>
        <year>2021</year>
        <fpage>290</fpage>
        <lpage>299</lpage>
        <pub-id pub-id-type="pmid">33568819</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <label>7</label>
      <element-citation publication-type="journal" id="sref7">
        <person-group person-group-type="author">
          <name>
            <surname>Crane</surname>
            <given-names>P.K.</given-names>
          </name>
          <name>
            <surname>Foroud</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Montine</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>E.B.</given-names>
          </name>
        </person-group>
        <article-title>Alzheimer’s disease sequencing project discovery and replication criteria for cases and controls: Data from a community-based prospective cohort study with autopsy follow-up</article-title>
        <source>Alzheimers Dement.</source>
        <volume>13</volume>
        <year>2017</year>
        <fpage>1410</fpage>
        <lpage>1413</lpage>
        <pub-id pub-id-type="pmid">29055816</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <label>8</label>
      <element-citation publication-type="journal" id="sref8">
        <person-group person-group-type="author">
          <name>
            <surname>Tomczak</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Czerwińska</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Wiznerowicz</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>The cancer genome atlas (TCGA): an immeasurable source of knowledge</article-title>
        <source>Contemp. Oncol.</source>
        <volume>19</volume>
        <year>2015</year>
        <fpage>A68</fpage>
        <lpage>A77</lpage>
      </element-citation>
    </ref>
    <ref id="bib9">
      <label>9</label>
      <element-citation publication-type="journal" id="sref9">
        <person-group person-group-type="author">
          <collab>GTEx Consortium</collab>
        </person-group>
        <article-title>The Genotype-Tissue expression (GTEx) project</article-title>
        <source>Nat. Genet.</source>
        <volume>45</volume>
        <year>2013</year>
        <fpage>580</fpage>
        <lpage>585</lpage>
        <pub-id pub-id-type="pmid">23715323</pub-id>
      </element-citation>
    </ref>
    <ref id="bib10">
      <label>10</label>
      <element-citation publication-type="journal" id="sref10">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>A.L.</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N.J.</given-names>
          </name>
          <name>
            <surname>Plenge</surname>
            <given-names>R.M.</given-names>
          </name>
          <name>
            <surname>Weinblatt</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Shadick</surname>
            <given-names>N.A.</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Principal components analysis corrects for stratification in genome-wide association studies</article-title>
        <source>Nat. Genet.</source>
        <volume>38</volume>
        <year>2006</year>
        <fpage>904</fpage>
        <lpage>909</lpage>
        <pub-id pub-id-type="pmid">16862161</pub-id>
      </element-citation>
    </ref>
    <ref id="bib11">
      <label>11</label>
      <element-citation publication-type="journal" id="sref11">
        <person-group person-group-type="author">
          <name>
            <surname>Malik</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Chauhan</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Traylor</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Sargurupremraj</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Okada</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Mishra</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Rutten-Jacobs</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Giese</surname>
            <given-names>A.-K.</given-names>
          </name>
          <name>
            <surname>van der Laan</surname>
            <given-names>S.W.</given-names>
          </name>
          <name>
            <surname>Gretarsdottir</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiancestry genome-wide association study of 520,000 subjects identifies 32 loci associated with stroke and stroke subtypes</article-title>
        <source>Nat. Genet.</source>
        <volume>50</volume>
        <year>2018</year>
        <fpage>524</fpage>
        <lpage>537</lpage>
        <pub-id pub-id-type="pmid">29531354</pub-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <label>12</label>
      <element-citation publication-type="journal" id="sref12">
        <person-group person-group-type="author">
          <name>
            <surname>de Vries</surname>
            <given-names>P.S.</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>A.R.</given-names>
          </name>
          <name>
            <surname>Sung</surname>
            <given-names>Y.J.</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>T.W.</given-names>
          </name>
          <name>
            <surname>Ntalla</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Schwander</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Kraja</surname>
            <given-names>A.T.</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Franceschini</surname>
            <given-names>N.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiancestry genome-wide association study of lipid levels incorporating gene-alcohol interactions</article-title>
        <source>Am. J. Epidemiol.</source>
        <volume>188</volume>
        <year>2019</year>
        <fpage>1033</fpage>
        <lpage>1054</lpage>
        <pub-id pub-id-type="pmid">30698716</pub-id>
      </element-citation>
    </ref>
    <ref id="bib13">
      <label>13</label>
      <element-citation publication-type="journal" id="sref13">
        <person-group person-group-type="author">
          <name>
            <surname>Panagiotou</surname>
            <given-names>O.A.</given-names>
          </name>
          <name>
            <surname>Willer</surname>
            <given-names>C.J.</given-names>
          </name>
          <name>
            <surname>Hirschhorn</surname>
            <given-names>J.N.</given-names>
          </name>
          <name>
            <surname>Ioannidis</surname>
            <given-names>J.P.A.</given-names>
          </name>
        </person-group>
        <article-title>The power of meta-analysis in genome-wide association studies</article-title>
        <source>Annu. Rev. Genom. Hum. Genet.</source>
        <volume>14</volume>
        <year>2013</year>
        <fpage>441</fpage>
        <lpage>465</lpage>
      </element-citation>
    </ref>
    <ref id="bib14">
      <label>14</label>
      <element-citation publication-type="journal" id="sref14">
        <person-group person-group-type="author">
          <name>
            <surname>Sung</surname>
            <given-names>Y.J.</given-names>
          </name>
          <name>
            <surname>Schwander</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Arnett</surname>
            <given-names>D.K.</given-names>
          </name>
          <name>
            <surname>Kardia</surname>
            <given-names>S.L.R.</given-names>
          </name>
          <name>
            <surname>Rankinen</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Bouchard</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Boerwinkle</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>S.C.</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>D.C.</given-names>
          </name>
        </person-group>
        <article-title>An empirical comparison of meta-analysis and mega-analysis of individual participant data for identifying gene-environment interactions</article-title>
        <source>Genet. Epidemiol.</source>
        <volume>38</volume>
        <year>2014</year>
        <fpage>369</fpage>
        <lpage>378</lpage>
        <pub-id pub-id-type="pmid">24719363</pub-id>
      </element-citation>
    </ref>
    <ref id="bib15">
      <label>15</label>
      <element-citation publication-type="journal" id="sref15">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Conomos</surname>
            <given-names>M.P.</given-names>
          </name>
          <name>
            <surname>Stilp</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Sofer</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Szpiro</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Brehm</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Celedón</surname>
            <given-names>J.C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Control for population structure and relatedness for binary traits in genetic association studies via logistic mixed models</article-title>
        <source>Am. J. Hum. Genet.</source>
        <volume>98</volume>
        <year>2016</year>
        <fpage>653</fpage>
        <lpage>666</lpage>
        <pub-id pub-id-type="pmid">27018471</pub-id>
      </element-citation>
    </ref>
    <ref id="bib16">
      <label>16</label>
      <element-citation publication-type="journal" id="sref16">
        <person-group person-group-type="author">
          <name>
            <surname>Prentice</surname>
            <given-names>R.L.</given-names>
          </name>
          <name>
            <surname>Pyke</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Logistic disease incidence models and case-control studies</article-title>
        <source>Biometrika</source>
        <volume>66</volume>
        <year>1979</year>
        <fpage>403</fpage>
        <lpage>411</lpage>
      </element-citation>
    </ref>
    <ref id="bib17">
      <label>17</label>
      <element-citation publication-type="journal" id="sref17">
        <person-group person-group-type="author">
          <name>
            <surname>Moore</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Frye</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Review of HIPAA, part 1: History, protected health information, and privacy and security rules</article-title>
        <source>J. Nucl. Med. Technol.</source>
        <volume>47</volume>
        <year>2019</year>
        <fpage>269</fpage>
        <lpage>272</lpage>
        <pub-id pub-id-type="pmid">31182664</pub-id>
      </element-citation>
    </ref>
    <ref id="bib18">
      <label>18</label>
      <element-citation publication-type="journal" id="sref18">
        <person-group person-group-type="author">
          <name>
            <surname>Cornock</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>General data protection regulation (GDPR) and implications for research</article-title>
        <source>Maturitas</source>
        <volume>111</volume>
        <year>2018</year>
        <fpage>A1</fpage>
        <lpage>A2</lpage>
        <pub-id pub-id-type="pmid">29395455</pub-id>
      </element-citation>
    </ref>
    <ref id="bib19">
      <label>19</label>
      <element-citation publication-type="journal" id="sref19">
        <person-group person-group-type="author">
          <name>
            <surname>Bonomi</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Ohno-Machado</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Privacy challenges and research opportunities for genomic data sharing</article-title>
        <source>Nat. Genet.</source>
        <volume>52</volume>
        <year>2020</year>
        <fpage>646</fpage>
        <lpage>654</lpage>
        <pub-id pub-id-type="pmid">32601475</pub-id>
      </element-citation>
    </ref>
    <ref id="bib20">
      <label>20</label>
      <element-citation publication-type="journal" id="sref20">
        <person-group person-group-type="author">
          <name>
            <surname>Wan</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Hazel</surname>
            <given-names>J.W.</given-names>
          </name>
          <name>
            <surname>Clayton</surname>
            <given-names>E.W.</given-names>
          </name>
          <name>
            <surname>Vorobeychik</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Kantarcioglu</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Malin</surname>
            <given-names>B.A.</given-names>
          </name>
        </person-group>
        <article-title>Sociotechnical safeguards for genomic data privacy</article-title>
        <source>Nat. Rev. Genet.</source>
        <volume>23</volume>
        <year>2022</year>
        <fpage>429</fpage>
        <lpage>445</lpage>
        <pub-id pub-id-type="pmid">35246669</pub-id>
      </element-citation>
    </ref>
    <ref id="bib21">
      <label>21</label>
      <element-citation publication-type="journal" id="sref21">
        <person-group person-group-type="author">
          <name>
            <surname>Tryka</surname>
            <given-names>K.A.</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Sturcke</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z.Y.</given-names>
          </name>
          <name>
            <surname>Ziyabari</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Popova</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Sharopova</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Kimura</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Feolo</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>NCBI’s database of genotypes and phenotypes: dbGaP</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>42</volume>
        <year>2014</year>
        <fpage>D975</fpage>
        <lpage>D979</lpage>
        <pub-id pub-id-type="pmid">24297256</pub-id>
      </element-citation>
    </ref>
    <ref id="bib22">
      <label>22</label>
      <element-citation publication-type="journal" id="sref22">
        <person-group person-group-type="author">
          <name>
            <surname>Freeberg</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Fromont</surname>
            <given-names>L.A.</given-names>
          </name>
          <name>
            <surname>D’Altri</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Romero</surname>
            <given-names>A.F.</given-names>
          </name>
          <name>
            <surname>Ciges</surname>
            <given-names>J.I.</given-names>
          </name>
          <name>
            <surname>Jene</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kerry</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Moldes</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Ariosa</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Bahena</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The european genome-phenome archive in 2021</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>50</volume>
        <year>2022</year>
        <fpage>D980</fpage>
        <lpage>D987</lpage>
        <pub-id pub-id-type="pmid">34791407</pub-id>
      </element-citation>
    </ref>
    <ref id="bib23">
      <label>23</label>
      <element-citation publication-type="book" id="sref23">
        <person-group person-group-type="author">
          <name>
            <surname>Dwork</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <part-title>Differential privacy</part-title>
        <person-group person-group-type="editor">
          <name>
            <surname>Bugliesi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Preneel</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Sassone</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Wegener</surname>
            <given-names>I.</given-names>
          </name>
        </person-group>
        <source>Automata, Languages and Programming</source>
        <year>2006</year>
        <publisher-name>Springer Berlin Heidelberg</publisher-name>
        <fpage>1</fpage>
        <lpage>12</lpage>
      </element-citation>
    </ref>
    <ref id="bib24">
      <label>24</label>
      <element-citation publication-type="book" id="sref24">
        <person-group person-group-type="author">
          <name>
            <surname>Gentry</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <part-title>Fully homomorphic encryption using ideal lattices</part-title>
        <source>Proceedings of the Forty-First Annual ACM Symposium on Theory of Computing</source>
        <year>2009</year>
        <publisher-name>Association for Computing Machinery</publisher-name>
        <fpage>169</fpage>
        <lpage>178</lpage>
      </element-citation>
    </ref>
    <ref id="bib25">
      <label>25</label>
      <element-citation publication-type="journal" id="sref25">
        <person-group person-group-type="author">
          <name>
            <surname>Lindell</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Secure multiparty computation</article-title>
        <source>Commun. ACM</source>
        <volume>64</volume>
        <year>2020</year>
        <fpage>86</fpage>
        <lpage>96</lpage>
      </element-citation>
    </ref>
    <ref id="bib26">
      <label>26</label>
      <element-citation publication-type="journal" id="sref26">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Shmatikov</surname>
            <given-names>V.</given-names>
          </name>
        </person-group>
        <article-title>Privacy-preserving data exploration in genome-wide association studies</article-title>
        <source>KDD</source>
        <volume>2013</volume>
        <year>2013</year>
        <fpage>1079</fpage>
        <lpage>1087</lpage>
        <pub-id pub-id-type="pmid">26691928</pub-id>
      </element-citation>
    </ref>
    <ref id="bib27">
      <label>27</label>
      <element-citation publication-type="journal" id="sref27">
        <person-group person-group-type="author">
          <name>
            <surname>Uhlerop</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Slavković</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Fienberg</surname>
            <given-names>S.E.</given-names>
          </name>
        </person-group>
        <article-title>Privacy-preserving data sharing for genome-wide association studies</article-title>
        <source>J. Priv. Confid.</source>
        <volume>5</volume>
        <year>2013</year>
        <fpage>137</fpage>
        <lpage>166</lpage>
        <pub-id pub-id-type="pmid">26525346</pub-id>
      </element-citation>
    </ref>
    <ref id="bib28">
      <label>28</label>
      <element-citation publication-type="journal" id="sref28">
        <person-group person-group-type="author">
          <name>
            <surname>Blatt</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Gusev</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Polyakov</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Goldwasser</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Secure large-scale genome-wide association studies using homomorphic encryption</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <volume>117</volume>
        <year>2020</year>
        <fpage>11608</fpage>
        <lpage>11613</lpage>
        <pub-id pub-id-type="pmid">32398369</pub-id>
      </element-citation>
    </ref>
    <ref id="bib29">
      <label>29</label>
      <element-citation publication-type="journal" id="sref29">
        <person-group person-group-type="author">
          <name>
            <surname>Froelicher</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Troncoso-Pastoriza</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Raisaro</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Cuendet</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Sousa</surname>
            <given-names>J.S.</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Fellay</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Hubaux</surname>
            <given-names>J.-P.</given-names>
          </name>
        </person-group>
        <article-title>Truly privacy-preserving federated analytics for precision medicine with multiparty homomorphic encryption</article-title>
        <source>Nat. Commun.</source>
        <volume>12</volume>
        <year>2021</year>
        <fpage>5910</fpage>
        <pub-id pub-id-type="pmid">34635645</pub-id>
      </element-citation>
    </ref>
    <ref id="bib30">
      <label>30</label>
      <element-citation publication-type="journal" id="sref30">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Harmanci</surname>
            <given-names>A.O.</given-names>
          </name>
          <name>
            <surname>Bossuat</surname>
            <given-names>J.-P.</given-names>
          </name>
          <name>
            <surname>Carpov</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Cheon</surname>
            <given-names>J.H.</given-names>
          </name>
          <name>
            <surname>Chillotti</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Froelicher</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Gama</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Georgieva</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrafast homomorphic encryption models enable secure outsourcing of genotype imputation</article-title>
        <source>Cell Syst.</source>
        <volume>12</volume>
        <year>2021</year>
        <fpage>1108</fpage>
        <lpage>1120.e4</lpage>
        <pub-id pub-id-type="pmid">34464590</pub-id>
      </element-citation>
    </ref>
    <ref id="bib31">
      <label>31</label>
      <element-citation publication-type="journal" id="sref31">
        <person-group person-group-type="author">
          <name>
            <surname>Sim</surname>
            <given-names>J.J.</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>F.M.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Meng Tan</surname>
            <given-names>B.H.</given-names>
          </name>
          <name>
            <surname>Mi Aung</surname>
            <given-names>K.M.</given-names>
          </name>
        </person-group>
        <article-title>Achieving GWAS with homomorphic encryption</article-title>
        <source>BMC Med. Genom.</source>
        <volume>13</volume>
        <year>2020</year>
        <fpage>90</fpage>
      </element-citation>
    </ref>
    <ref id="bib32">
      <label>32</label>
      <element-citation publication-type="journal" id="sref32">
        <person-group person-group-type="author">
          <name>
            <surname>Cho</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Secure genome-wide association analysis using multiparty computation</article-title>
        <source>Nat. Biotechnol.</source>
        <volume>36</volume>
        <year>2018</year>
        <fpage>547</fpage>
        <lpage>551</lpage>
        <pub-id pub-id-type="pmid">29734293</pub-id>
      </element-citation>
    </ref>
    <ref id="bib33">
      <label>33</label>
      <element-citation publication-type="journal" id="sref33">
        <person-group person-group-type="author">
          <name>
            <surname>Brisimi</surname>
            <given-names>T.S.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Mela</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Olshevsky</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Paschalidis</surname>
            <given-names>I.C.</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>Federated learning of predictive models from federated electronic health records</article-title>
        <source>Int. J. Med. Inf.</source>
        <volume>112</volume>
        <year>2018</year>
        <fpage>59</fpage>
        <lpage>67</lpage>
      </element-citation>
    </ref>
    <ref id="bib34">
      <label>34</label>
      <element-citation publication-type="journal" id="sref34">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Glicksberg</surname>
            <given-names>B.S.</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Bian</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>Federated learning for healthcare informatics</article-title>
        <source>J. Healthc. Inform. Res.</source>
        <volume>5</volume>
        <year>2021</year>
        <fpage>1</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="pmid">33204939</pub-id>
      </element-citation>
    </ref>
    <ref id="bib35">
      <label>35</label>
      <element-citation publication-type="journal" id="sref35">
        <person-group person-group-type="author">
          <name>
            <surname>Padakanti</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Tiong</surname>
            <given-names>K.-L.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y.-B.</given-names>
          </name>
          <name>
            <surname>Yeang</surname>
            <given-names>C.-H.</given-names>
          </name>
        </person-group>
        <article-title>Genotypes of informative loci from 1000 genomes data allude evolution and mixing of human populations</article-title>
        <source>Sci. Rep.</source>
        <volume>11</volume>
        <year>2021</year>
        <fpage>17741</fpage>
        <lpage>17818</lpage>
        <pub-id pub-id-type="pmid">34493766</pub-id>
      </element-citation>
    </ref>
    <ref id="bib36">
      <label>36</label>
      <element-citation publication-type="journal" id="sref36">
        <person-group person-group-type="author">
          <name>
            <surname>Taliun</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Chothani</surname>
            <given-names>S.P.</given-names>
          </name>
          <name>
            <surname>Schönherr</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Forer</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Boehnke</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G.R.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Laser server: ancestry tracing with genotypes or sequence reads</article-title>
        <source>Bioinformatics</source>
        <volume>33</volume>
        <year>2017</year>
        <fpage>2056</fpage>
        <lpage>2058</lpage>
        <pub-id pub-id-type="pmid">28200055</pub-id>
      </element-citation>
    </ref>
    <ref id="bib37">
      <label>37</label>
      <element-citation publication-type="journal" id="sref37">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Zhan</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G.R.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>Improved ancestry estimation for both genotyping and sequencing data using projection procrustes analysis and genotype imputation</article-title>
        <source>Am. J. Hum. Genet.</source>
        <volume>96</volume>
        <year>2015</year>
        <fpage>926</fpage>
        <lpage>937</lpage>
        <pub-id pub-id-type="pmid">26027497</pub-id>
      </element-citation>
    </ref>
    <ref id="bib38">
      <label>38</label>
      <element-citation publication-type="journal" id="sref38">
        <person-group person-group-type="author">
          <name>
            <surname>Kockan</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Dokmai</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Karpov</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Kulekci</surname>
            <given-names>M.O.</given-names>
          </name>
          <name>
            <surname>Woodruff</surname>
            <given-names>D.P.</given-names>
          </name>
          <name>
            <surname>Sahinalp</surname>
            <given-names>S.C.</given-names>
          </name>
        </person-group>
        <article-title>Sketching algorithms for genomic data analysis and querying in a secure enclave</article-title>
        <source>Nat. Methods</source>
        <volume>17</volume>
        <year>2020</year>
        <fpage>295</fpage>
        <lpage>301</lpage>
        <pub-id pub-id-type="pmid">32132732</pub-id>
      </element-citation>
    </ref>
    <ref id="bib39">
      <label>39</label>
      <element-citation publication-type="journal" id="sref39">
        <person-group person-group-type="author">
          <name>
            <surname>Sadat</surname>
            <given-names>M.N.</given-names>
          </name>
          <name>
            <surname>Al Aziz</surname>
            <given-names>M.M.</given-names>
          </name>
          <name>
            <surname>Mohammed</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>SAFETY: Secure gwas in federated environment through a hybrid solution</article-title>
        <source>IEEE ACM Trans. Comput. Biol. Bioinf</source>
        <volume>16</volume>
        <year>2019</year>
        <fpage>93</fpage>
        <lpage>102</lpage>
      </element-citation>
    </ref>
    <ref id="bib40">
      <label>40</label>
      <element-citation publication-type="journal" id="sref40">
        <person-group person-group-type="author">
          <name>
            <surname>Bates</surname>
            <given-names>D.W.</given-names>
          </name>
          <name>
            <surname>Mächler</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bolker</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Fitting linear mixed-effects models using lme4</article-title>
        <source>BMJ Qual. Saf.</source>
        <volume>24</volume>
        <year>2015</year>
        <fpage>1</fpage>
        <lpage>3</lpage>
      </element-citation>
    </ref>
    <ref id="bib41">
      <label>41</label>
      <element-citation publication-type="journal" id="sref41">
        <person-group person-group-type="author">
          <name>
            <surname>Purcell</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Neale</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Todd-Brown</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>M.A.R.</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Maller</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Sklar</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>de Bakker</surname>
            <given-names>P.I.W.</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Sham</surname>
            <given-names>P.C.</given-names>
          </name>
        </person-group>
        <article-title>PLINK: a tool set for whole-genome association and population-based linkage analyses</article-title>
        <source>Am. J. Hum. Genet.</source>
        <volume>81</volume>
        <year>2007</year>
        <fpage>559</fpage>
        <lpage>575</lpage>
        <pub-id pub-id-type="pmid">17701901</pub-id>
      </element-citation>
    </ref>
    <ref id="bib42">
      <label>42</label>
      <element-citation publication-type="journal" id="sref42">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Privacy-preserving construction of generalized linear mixed model for biomedical computation</article-title>
        <source>Bioinformatics</source>
        <volume>36</volume>
        <year>2020</year>
        <fpage>i128</fpage>
        <lpage>i135</lpage>
        <pub-id pub-id-type="pmid">32657380</pub-id>
      </element-citation>
    </ref>
    <ref id="bib43">
      <label>43</label>
      <element-citation publication-type="journal" id="sref43">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Islam</surname>
            <given-names>M.N.</given-names>
          </name>
          <name>
            <surname>Sheils</surname>
            <given-names>N.E.</given-names>
          </name>
          <name>
            <surname>Buresh</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Schuemie</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Doshi</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Werner</surname>
            <given-names>R.M.</given-names>
          </name>
          <name>
            <surname>Asch</surname>
            <given-names>D.A.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>dPQL: a lossless distributed algorithm for generalized linear mixed model with application to privacy-preserving hospital profiling</article-title>
        <source>J. Am. Med. Inf. Assoc.</source>
        <volume>29</volume>
        <year>2022</year>
        <fpage>1366</fpage>
        <lpage>1371</lpage>
      </element-citation>
    </ref>
    <ref id="bib44">
      <label>44</label>
      <element-citation publication-type="journal" id="sref44">
        <person-group person-group-type="author">
          <name>
            <surname>Breslow</surname>
            <given-names>N.E.</given-names>
          </name>
          <name>
            <surname>Clayton</surname>
            <given-names>D.G.</given-names>
          </name>
        </person-group>
        <article-title>Approximate inference in generalized linear mixed models</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <volume>88</volume>
        <year>1993</year>
        <fpage>9</fpage>
        <lpage>25</lpage>
      </element-citation>
    </ref>
    <ref id="bib45">
      <label>45</label>
      <element-citation publication-type="journal" id="sref45">
        <person-group person-group-type="author">
          <name>
            <surname>Ju</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>L.-L.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Laplace approximation, penalized quasi-likelihood, and adaptive gauss–hermite quadrature for generalized linear mixed models: towards meta-analysis of binary outcome with sparse data</article-title>
        <source>BMC Med. Res. Methodol.</source>
        <volume>20</volume>
        <year>2020</year>
        <fpage>152</fpage>
        <lpage>211</lpage>
        <pub-id pub-id-type="pmid">32539721</pub-id>
      </element-citation>
    </ref>
    <ref id="bib46">
      <label>46</label>
      <element-citation publication-type="journal" id="sref46">
        <person-group person-group-type="author">
          <name>
            <surname>Ziyatdinov</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Vázquez-Santiago</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Brunel</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Martinez-Perez</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Aschard</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Soria</surname>
            <given-names>J.M.</given-names>
          </name>
        </person-group>
        <article-title>lme4qtl: linear mixed models with flexible covariance structure for genetic studies of related individuals</article-title>
        <source>BMC Bioinf.</source>
        <volume>19</volume>
        <year>2018</year>
        <fpage>1</fpage>
        <lpage>5</lpage>
      </element-citation>
    </ref>
    <ref id="bib47">
      <label>47</label>
      <element-citation publication-type="journal" id="sref47">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Harmanci</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Privacy-aware estimation of relatedness in admixed populations</article-title>
        <source>Briefings Bioinf.</source>
        <volume>23</volume>
        <year>2022</year>
        <object-id pub-id-type="publisher-id">bbac473</object-id>
      </element-citation>
    </ref>
    <ref id="bib48">
      <label>48</label>
      <element-citation publication-type="journal" id="sref48">
        <person-group person-group-type="author">
          <name>
            <surname>Homer</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Szelinger</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Redman</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Duggan</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Tembe</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Muehling</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Pearson</surname>
            <given-names>J.V.</given-names>
          </name>
          <name>
            <surname>Stephan</surname>
            <given-names>D.A.</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>S.F.</given-names>
          </name>
          <name>
            <surname>Craig</surname>
            <given-names>D.W.</given-names>
          </name>
        </person-group>
        <article-title>Resolving individuals contributing trace amounts of DNA to highly complex mixtures using high-density SNP genotyping microarrays</article-title>
        <source>PLoS Genet.</source>
        <volume>4</volume>
        <year>2008</year>
        <object-id pub-id-type="publisher-id">e1000167</object-id>
      </element-citation>
    </ref>
    <ref id="bib49">
      <label>49</label>
      <element-citation publication-type="journal" id="sref49">
        <person-group person-group-type="author">
          <name>
            <surname>Hatamizadeh</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Molchanov</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Myronenko</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Dogra</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Flores</surname>
            <given-names>M.G.</given-names>
          </name>
          <name>
            <surname>Kautz</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>H.R.</given-names>
          </name>
        </person-group>
        <article-title>Do gradient inversion attacks make federated learning unsafe?</article-title>
        <source>IEEE Trans. Med. Imag.</source>
        <year>2023</year>
        <fpage>1</fpage>
      </element-citation>
    </ref>
    <ref id="bib50">
      <label>50</label>
      <element-citation publication-type="book" id="sref50">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <part-title>Efficient multi-key homomorphic encryption with packed ciphertexts with application to oblivious neural network inference</part-title>
        <source>Proceedings of the 2019 ACM SIGSAC Conference on Computer and Communications Security</source>
        <year>2019</year>
        <publisher-name>Association for Computing Machinery</publisher-name>
        <fpage>395</fpage>
        <lpage>412</lpage>
      </element-citation>
    </ref>
    <ref id="bib51">
      <label>51</label>
      <element-citation publication-type="journal" id="sref51">
        <person-group person-group-type="author">
          <name>
            <surname>Nasirigerdeh</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Torkzadehmahani</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Matschinske</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Baumbach</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Rueckert</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Kaissis</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Hyfed: A hybrid federated framework for privacy-preserving machine learning</article-title>
        <comment>Preprint at</comment>
        <source>arXiv</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.48550/arXiv.2105.10545</pub-id>
      </element-citation>
    </ref>
    <ref id="bib52">
      <label>52</label>
      <element-citation publication-type="journal" id="sref52">
        <person-group person-group-type="author">
          <name>
            <surname>Bates</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Mächler</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bolker</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Fitting linear mixed-effects models using lme4</article-title>
        <comment>Preprint at</comment>
        <source>arXiv</source>
        <year>2014</year>
        <pub-id pub-id-type="doi">10.48550/arXiv.1406.5823</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="appsec2" sec-type="supplementary-material">
    <title>Supplemental information</title>
    <p id="p0385">
      <supplementary-material content-type="local-data" id="mmc1">
        <caption>
          <title>Document S1. Figures S1–S6 and Tables S1 and S2</title>
        </caption>
        <media xlink:href="mmc1.pdf"/>
      </supplementary-material>
    </p>
  </sec>
  <sec sec-type="data-availability" id="da0010">
    <title>Data and code availability</title>
    <p id="p0025">
      <list list-type="simple" id="olist0010">
        <list-item id="u0025">
          <p id="p0030">All original code has been deposited to github and is publicly available as of the date of publication. Accession link is listed in the <xref rid="sec4.1" ref-type="sec">key resources table</xref>.</p>
        </list-item>
        <list-item id="u0030">
          <label>•</label>
          <p id="p0035">The reference panel is obtained from the 1000 Genomes Project FTP portal at <ext-link ext-link-type="uri" xlink:href="ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/" id="intref0015">ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/</ext-link>.</p>
        </list-item>
        <list-item id="u0035">
          <label>•</label>
          <p id="p0040"><italic>dMEGA</italic> is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Li-Wentao/dMEGA" id="intref0020">https://github.com/Li-Wentao/dMEGA</ext-link>.</p>
        </list-item>
      </list>
    </p>
  </sec>
  <ack id="ack0010">
    <title>Acknowledgments</title>
    <p id="p0365">A.H. was supported by the startup funds from <funding-source id="gs1">University of Texas Health Science Center</funding-source>. X.J. is <funding-source id="gs2"><institution-wrap><institution-id institution-id-type="doi">10.13039/100004917</institution-id><institution>CPRIT</institution></institution-wrap></funding-source> Scholar in <funding-source id="gs3">Cancer Research</funding-source> (RR180012), and he was supported in part by <funding-source id="gs4">Christopher Sarofim Family Professorship</funding-source>, UT Stars award, <funding-source id="gs5"><institution-wrap><institution-id institution-id-type="doi">10.13039/100012615</institution-id><institution>UTHealth</institution></institution-wrap></funding-source> startup, the <funding-source id="gs6"><institution-wrap><institution-id institution-id-type="doi">10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source> (<funding-source id="gs7"><institution-wrap><institution-id institution-id-type="doi">10.13039/100000002</institution-id><institution>NIH</institution></institution-wrap></funding-source>) under award number R01AG066749 and U01TR002062.</p>
    <sec id="sec5">
      <title>Author contributions</title>
      <p id="p0370">A.H., X.J., and H.C. conceived the study. X.J., A.H., and W.L. formulated projection-based covariate calculation and federated association testing framework. W.L. and A.H. wrote the first draft of the manuscript. All authors wrote and approved the final manuscript.</p>
    </sec>
    <sec sec-type="COI-statement" id="sec6">
      <title>Declaration of interests</title>
      <p id="p0375">The authors declare no competing interests.</p>
    </sec>
  </ack>
  <fn-group>
    <fn id="appsec1" fn-type="supplementary-material">
      <p id="p0380">Supplemental information can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.isci.2023.107227" id="intref0060">https://doi.org/10.1016/j.isci.2023.107227</ext-link>.</p>
    </fn>
  </fn-group>
</back>
<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_ISCI107227 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEgr7 jpg ?>
<?FILEgr8 jpg ?>
<?FILEfx1 jpg ?>
<?FILEmmc1 pdf ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">iScience</journal-id>
    <journal-id journal-id-type="iso-abbrev">iScience</journal-id>
    <journal-title-group>
      <journal-title>iScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2589-0042</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10387571</article-id>
    <article-id pub-id-type="pii">S2589-0042(23)01304-4</article-id>
    <article-id pub-id-type="doi">10.1016/j.isci.2023.107227</article-id>
    <article-id pub-id-type="publisher-id">107227</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Federated generalized linear mixed models for collaborative genome-wide association studies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au1">
        <name>
          <surname>Li</surname>
          <given-names>Wentao</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au2">
        <name>
          <surname>Chen</surname>
          <given-names>Han</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au3">
        <name>
          <surname>Jiang</surname>
          <given-names>Xiaoqian</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au4">
        <name>
          <surname>Harmanci</surname>
          <given-names>Arif</given-names>
        </name>
        <email>arif.o.harmanci@uth.tmc.edu</email>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="fn1" ref-type="fn">3</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
      <aff id="aff1"><label>1</label>School of Biomedical Informatics, University of Texas Health Science Center, Houston, TX 77030, USA</aff>
      <aff id="aff2"><label>2</label>School of Public Health, University of Texas Health Science Center, Houston, TX 77030, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>∗</label>Corresponding author <email>arif.o.harmanci@uth.tmc.edu</email></corresp>
      <fn id="fn1">
        <label>3</label>
        <p id="ntpara0010">Lead contact</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <day>18</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>26</volume>
    <issue>8</issue>
    <elocation-id>107227</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 The Authors</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0010">
      <title>Summary</title>
      <p>Federated association testing is a powerful approach to conduct large-scale association studies where sites share intermediate statistics through a central server. There are, however, several standing challenges. Confounding factors like population stratification should be carefully modeled across sites. In addition, it is crucial to consider disease etiology using flexible models to prevent biases. Privacy protections for participants pose another significant challenge. Here, we propose distributed Mixed Effects Genome-wide Association study (<italic>dMEGA</italic>), a method that enables federated generalized linear mixed model-based association testing across multiple sites without explicitly sharing genotype and phenotype data. <italic>dMEGA</italic> employs a reference projection to correct for population-stratification and utilizes efficient local-gradient updates among sites, incorporating both fixed and random effects. The accuracy and efficiency of <italic>dMEGA</italic> are demonstrated through simulated and real datasets. <italic>dMEGA</italic> is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Li-Wentao/dMEGA" id="intref0010">https://github.com/Li-Wentao/dMEGA</ext-link>.</p>
    </abstract>
    <abstract abstract-type="graphical" id="abs0015">
      <title>Graphical abstract</title>
      <fig id="undfig1" position="anchor">
        <graphic xlink:href="fx1"/>
      </fig>
    </abstract>
    <abstract abstract-type="author-highlights" id="abs0020">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="ulist0010">
          <list-item id="u0010">
            <label>•</label>
            <p id="p0010">We developed a federated learning method for genome-wide association studies</p>
          </list-item>
          <list-item id="u0015">
            <label>•</label>
            <p id="p0015">We use a reference projection method that can be effective for correcting confounders</p>
          </list-item>
          <list-item id="u0020">
            <label>•</label>
            <p id="p0020">We tackled the data heterogeneity problem with a federated mixed-effect model</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="teaser" id="abs0025">
      <p>Health sciences; Clinical genetics; Human genetics; Genomics</p>
    </abstract>
    <kwd-group id="kwrds0010">
      <title>Subject areas</title>
      <kwd>Health sciences</kwd>
      <kwd>Clinical genetics</kwd>
      <kwd>Human genetics</kwd>
      <kwd>Genomics</kwd>
    </kwd-group>
  </article-meta>
  <notes>
    <p id="misc9010">Published: June 28, 2023</p>
  </notes>
</front>
<body>
  <sec id="sec1">
    <title>Introduction</title>
    <p id="p0045">Genome-wide association studies (GWASs) are standard methods for discovering genetic variants that explain the genetic component of phenotypic variance. As the sequencing costs are decreasing, there is great incentive to perform large-scale association studies to increase the power of the studies.<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref><sup>,</sup><xref rid="bib2" ref-type="bibr"><sup>2</sup></xref> Currently, population-scale joint genotyping and phenotyping efforts such as AllofUs and UK Biobank generate very large resources that provide great opportunities for extensive analysis of genotype-phenotype relationships.<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref><sup>,</sup><xref rid="bib4" ref-type="bibr"><sup>4</sup></xref><sup>,</sup><xref rid="bib5" ref-type="bibr"><sup>5</sup></xref> In addition, there are other efforts that aim at focusing on certain phenotypes such as TOPMed,<xref rid="bib6" ref-type="bibr"><sup>6</sup></xref> ADSP,<xref rid="bib7" ref-type="bibr"><sup>7</sup></xref> TCGA,<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref> and GTEx.<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref></p>
    <p id="p0050">There are a number of standing challenges around performing large scale GWAS in existing datasets. Association tests are confounded by numerous factors such as population stratification, which can be especially important in multi-ancestral studies and in admixed populations.<xref rid="bib10" ref-type="bibr"><sup>10</sup></xref> Most of the multi-ancestral studies are performed as meta-analyses<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref><sup>,</sup><xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> and may make it more challenging to correct biases compared to a pooled individual-level data analysis among sites in a collaborative GWAS setting.<xref rid="bib13" ref-type="bibr"><sup>13</sup></xref><sup>,</sup><xref rid="bib14" ref-type="bibr"><sup>14</sup></xref> Furthermore, binary and continuous traits should be modeled using appropriate models to avoid biases in the significance of the genetic effect. It has been shown previously that binary traits are more appropriately analyzed using generalized linear models (GLM) compared to linear models because generalized models can naturally represent the categorical/binary nature of case/control study designs.<xref rid="bib15" ref-type="bibr"><sup>15</sup></xref><sup>,</sup><xref rid="bib16" ref-type="bibr"><sup>16</sup></xref> In addition, there can be complex relationships among samples (such as cryptic relatedness), which makes it necessary to account for random polygenic effects that may otherwise bias association signals. Furthermore, increasing sample sizes requires extensive collaboration among large institutions, but data sharing (among institutions) may be restricted under diverse regulations such as HIPAA<xref rid="bib17" ref-type="bibr"><sup>17</sup></xref> and GDPR.<xref rid="bib18" ref-type="bibr"><sup>18</sup></xref> Consequently, a rising concern for performing large-scale collaborative association studies is the consideration of privacy and related ethical concerns of unauthorized re-identification of the study participants and their relatives in publicly available genealogy services, stigmatization of individuals and groups as a results of phenotype and disease risk predictions, group-level sensitive information prediction (such as inbreeding in Havasupai Tribe), and marginalization of these historically isolated groups<xref rid="bib19" ref-type="bibr"><sup>19</sup></xref><sup>,</sup><xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> (Supplementary Information).</p>
    <p id="p0055">Although there are increased incentives around sharing data and making discoveries, regulations are enacted on legislative level for stricter protection of personal genetic data from open sharing. This creates a major hurdle for international collaborations. The most basic data protection is performed by lengthy data transfer agreements that authorize users’ access to data repositories (e.g., dbGAP<xref rid="bib21" ref-type="bibr"><sup>21</sup></xref> and European EGA<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref>). The agreements only establish accountability and do not meaningfully protect data, because data are still stored and analyzed in plaintext. On technical domain, differential privacy,<xref rid="bib23" ref-type="bibr"><sup>23</sup></xref> homomorphic encryption (HE),<xref rid="bib24" ref-type="bibr"><sup>24</sup></xref> and secure multiparty computation<xref rid="bib25" ref-type="bibr"><sup>25</sup></xref> enable provably privacy-aware data analysis. Differentially private methods<xref rid="bib26" ref-type="bibr"><sup>26</sup></xref><sup>,</sup><xref rid="bib27" ref-type="bibr"><sup>27</sup></xref> are based on noisy data release mechanisms and substantially degrade genetic data utility. HE<xref rid="bib28" ref-type="bibr"><sup>28</sup></xref><sup>,</sup><xref rid="bib29" ref-type="bibr"><sup>29</sup></xref><sup>,</sup><xref rid="bib30" ref-type="bibr"><sup>30</sup></xref><sup>,</sup><xref rid="bib31" ref-type="bibr"><sup>31</sup></xref>-based approaches enable analysis of encrypted data without decrypting it. Although HE-based methods have made orders of magnitude improvement in terms of performance in the last decade, they still require large computational resources. Similarly, secure multiparty computation (SMC) methods<xref rid="bib32" ref-type="bibr"><sup>32</sup></xref> rely on the separation of data among multiple entities such that it cannot be recovered by any of the non-colluding entities. SMC-based methods have high data transfer requirements and may not be practically feasible.</p>
    <p id="p0060">Federated association testing (rooted from Federated Learning approaches<xref rid="bib33" ref-type="bibr"><sup>33</sup></xref><sup>,</sup><xref rid="bib34" ref-type="bibr"><sup>34</sup></xref>) among different sites present a viable solution for increasing sample sizes while underlying genotype and phenotype data are not explicitly shared. In federated association testing methods, the association testing is reformulated as an iterative algorithm. At each iteration, each collaborating site computes intermediary statistics using local genotype and phenotype data and the statistics from other sites. Next, the intermediary statistics are shared among the sites with a central server that is aggregated and re-shared to all sites. Federated testing is advantageous from a privacy perspective because the genotype and phenotype data never leave local sites. This way, all sites make use of the pooled individual-level data that would be otherwise isolated in distributed repositories across institutions.</p>
    <p id="p0065">Here, we present <italic>dMEGA</italic> (distributed Mixed Effects Genome-wide Association study), a federated generalized linear mixed model that enables federated genetic association testing among collaborating sites. First, each site utilizes a reference projection-based approach, wherein the genotype data at the site is projected on an existing public genotype panel (e.g., The 1000 Genomes Project) and population-based covariates are computed based on the projected coordinates. Usage of projection is advantageous because it decreases computational requirements by circumventing computation of principal component analysis (PCA) among the sites and minimally impacts accuracy. In addition, the computation of population-level covariates does not require data to be pooled and does not incur privacy risks. Next, <italic>dMEGA</italic> performs federated association testing using the fixed (such as population covariates) and random effects. In this step, the sites locally calculate intermediate statistics that are sent to a central server, which aggregates the statistics from all sites and shares them with all sites. After a number of iterations, the algorithm converges and final results are calculated. We demonstrate the accuracy and efficiency of <italic>dMEGA</italic> using simulated and real datasets.</p>
  </sec>
  <sec id="sec2">
    <title>Results</title>
    <sec id="sec2.1">
      <title>Overview of <italic>dMEGA</italic></title>
      <p id="p0070"><xref rid="fig1" ref-type="fig">Figure 1</xref> shows the steps of federated association testing workflow. First, the sites project their genotype data on the principal components (PCs) computed from a reference panel. The reference panel dataset represents a comprehensive population-based information pool. The projected coordinates are used as population-based covariates (fixed effect). Next, each site computes the local testing statistics (gradients, effect sizes, Hessian matrices) and send them to the Central Server (CS). At each site, the likelihood is approximated by Laplace approximation and gradients are calculated using the local data and the current parameters (Methods). The Central Server collects intermediate model statistics during the federated learning process, aggregates the site-specific parameters to compute the global model parameters, and sends the parameters to the sites for the next iteration. The individual-level data (genotypes, phenotypes, and covariates) is not shared with other sites or the central server in the inference.<fig id="fig1"><label>Figure 1</label><caption><p>Illustration of federated association testing workflow for two sites named Site-1 and Site-2</p><p>Each site holds genotype, phenotype, and covariate datasets. Each site first downloads the reference panel principal components (PCs) and projects the genotypes to generate the population-based covariates (Step 1). Next, the initial parameters are downloaded from the central server (CS) (Step 2). Using the local genotype, phenotype, and merged covariate data, each site updates the local parameters (Step 3) and sends them to CS (Step 4). After receiving the local parameters from both sites, CS aggregates the parameters and sends the updates parameters to all sites. Steps 2, 3, and 4 are performed until the model converges. Step 1 is performed only once at the before iterations.</p></caption><graphic xlink:href="gr1"/></fig></p>
    </sec>
    <sec id="sec2.2">
      <title>Experimental setting and accuracy metrics</title>
      <p id="p0075">We separated the experimental tests into two parts. We first use simulated data and real dataset to present the utility of the projection-based population covariate calculation to be used in GWAS. We explore different scenarios to highlight the importance of reference panel selection.</p>
      <p id="p0080">We next move to usage of the projected covariates in the <italic>dMEGA</italic>’s GWAS using a real-world dataset obtained from dbGAP (Data Availability). We explore two settings of covariate selection and compare the results from <italic>dMEGA</italic> with results from a centralized GWAS study using lme4 that is calculated using the covariates obtained from the dbGAP dataset. To decrease computational requirements, we ran plink2 to estimate association of the variants with the binary phenotype (using the dbGAP reported covariates) and we focused on the 10,000 variants that were the most significantly associated with the phenotype.</p>
      <p id="p0085">Performance Metrics. We evaluate the results by comparing (1) the p value concordance between the centralized and federated estimates, (2) the concordance of effect sizes estimated from the centralized and federated estimates, (3) the concordance of the ranking of the most significant SNPs identified by centralized and federated calculations, (4) time requirements of federated algorithm, (5) comparison of the top variants (with changing p value cutoffs) and qualitatively evaluate the results using Manhattan plots, and (6) qualitative comparison of the scatterplots using the first two PCs calculated by the projection-based approach and the full-PCA for simulated case studies and the dbGAP reported covariates for the real dataset.</p>
    </sec>
    <sec id="sec2.3">
      <title>Projection-based population stratification</title>
      <p id="p0090">We first tested whether <italic>dMEGA</italic>’s the projection-based population stratification can be used for performing population structure correction in the context of a simple linear model. The justification of a projection-based approach is to make use of the genetic diversity represented within the reference panel and identify the variation of the study participants along the PCs of this panel. Assuming that the reference panel is representative of this genetic diversity, the covariates from the projection should be useful to correct for the population stratification in the linear GWAS model. It should be noted that the covariates represent nuisance parameters, i.e., their exact values are not of essential importance as long as they correct for the population stratification effects within the study cohort<xref rid="bib35" ref-type="bibr"><sup>35</sup></xref><sup>,</sup><xref rid="bib36" ref-type="bibr"><sup>36</sup></xref><sup>,</sup><xref rid="bib37" ref-type="bibr"><sup>37</sup></xref> (Supplementary Information). This approach enables a large decrease in computation cost by circumventing the need for a full PCA of the genotype data pooled from all sites<xref rid="bib28" ref-type="bibr"><sup>28</sup></xref><sup>,</sup><xref rid="bib32" ref-type="bibr"><sup>32</sup></xref><sup>,</sup><xref rid="bib38" ref-type="bibr"><sup>38</sup></xref><sup>,</sup><xref rid="bib39" ref-type="bibr"><sup>39</sup></xref> and relying on much simpler computation of projections in population-based covariate computation that is used for population-stratification.</p>
      <p id="p0095">We first simulated 100 GWAS studies where 20 variants with allele frequency below 0.1 were randomly selected as causal with effect on phenotype. We also assigned population and gender-specific biases on the phenotype to introduce population and gender-specific effect. For each simulated study, we simulated genotypes for 3,000 individuals with a corresponding quantitative phenotype that is computed regarding genotypes and covariates. We finally ran plink2 in three configurations to perform GWAS with and without population stratification: (1) We ran plink2 with its default PCA to generate population-based covariates. (2) We ran plink2 with covariates generated by projection-based covariate computation using top 6 PCs. (3) We ran plink2 without population stratification as a control to ensure that population stratification is indeed necessary in GWAS. As a first test scenario, we used CEU, MXL, YRI populations from the 1000 Genomes Project for simulating genotypes and used the same populations as reference to compute the projection-based population covariates, i.e., the projection and simulation ancestries are exactly matched. Overall, p values and effect sizes from GWAS with projection-based population correction match fairly well to default PCA-based population stratification in plink2 (<xref rid="fig2" ref-type="fig">Figures 2</xref>, <xref rid="mmc1" ref-type="supplementary-material">S1</xref>A, and S1B). In comparison, the GWAS without population correction gives fairly discordant and biased results (<xref rid="mmc1" ref-type="supplementary-material">Figures S1</xref>C and S1D). We next used the GIH, CHB, PEL populations as the reference panel populations to test for mismatches in the simulated and reference populations. We observed that similar results held where projection-based population correction yields good concordance with plink2’s default PCA-based population correction (<xref rid="mmc1" ref-type="supplementary-material">Figures S1</xref>E and S1F). GWAS p values and effect sizes without population correction yields fairly discordant results when compared to default correction (<xref rid="mmc1" ref-type="supplementary-material">Figures S1</xref>G and S1H). We also observed that top variants detected from projection-based correction matches accurately to default correction (<xref rid="mmc1" ref-type="supplementary-material">Figures S1</xref>A and S1B). Overall, these results show that projection-based population stratification can be effective for correction of population-specific biases to a large extent. Most importantly, this approach can be implemented efficiently in a secure domain with much better overall performance compared to a full PCA-based population correction. We utilize projection-based population stratification to estimate the population covariates in the GWAS analysis.<fig id="fig2"><label>Figure 2</label><caption><p>Comparison of most significant variant concordance between projection-based population stratification and PCA-based stratification among 100 simulated GWAS</p><p>(A) The comparison of significant variant concordance for matching population panels. X axis shows the number of top variants. Y axis shows the concordance fraction. Blue boxplots depict the concordance between projection-based stratification and PCA-based stratification. Red boxplots show the concordance between GWAS with no population stratification and GWAS with PCA-based stratification.</p><p>(B) Concordance of most significant variants when projection is performed with a mismatching set of reference populations.</p></caption><graphic xlink:href="gr2"/></fig></p>
      <p id="p0100">We next tested the impact of mismatch between reference populations used in projection analysis and the study cohort. We first focused on the simulated case study and generated a study cohort consisting CEU, MXL, and YRI samples. We next performed projections where reference was constrained as single populations. When we used a homogeneous European population (TSI), we observed that the projected coordinates did not reflect the genetic ancestry of the study participants. In addition, we observed fairly low concordance between the top associated variants obtained from a full-scale PCA of the study sample (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>A). Of interest, when we use a single admixed population (GIH), we observed better separation of the study subjects albeit with low variant concordance (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>B). When we used another admixed population (PUR), the separation was slightly improved (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>C). When we used a reference population that contained mixture of the European, African, and American samples, we observed a fine separation among the study subjects and much higher concordance between the associated variants (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>D). Overall, these results show that projection-based approach must be carefully applied to ensure that the reference population includes a representative genetic diversity that can encompass that of the study participants.</p>
      <p id="p0105">We next studied our real study sample that is obtained from the dbGAP, for which we did not have <italic>a-priori</italic> knowledge about the ancestry. For this case, we performed projection using EUR, AMR, and AFR super-populations from the 1000 Genomes Project. Overall, the projection using single super-populations did not reveal the full complexity of the genetic ancestry of the study subjects. For example, EUR reference (<xref rid="mmc1" ref-type="supplementary-material">Figure S3</xref>A) did not appropriately separate the subjects and AMR (<xref rid="mmc1" ref-type="supplementary-material">Figure S3</xref>B) and AFR provided marginal separation of the subjects (<xref rid="mmc1" ref-type="supplementary-material">Figure S3</xref>C). When we use the whole 1000 Genomes populations (<xref rid="mmc1" ref-type="supplementary-material">Figure S3</xref>D), we observed a much better concordance to the principal components that are reported by the dbGAP (<xref rid="mmc1" ref-type="supplementary-material">Figures S3</xref>D and S3E). Particularly, the subjects tended to separate along the Europe-Asian-African Triangle from the two methods. It should again be noted that we do not require the covariates to match exactly because the PCs are treated as nuisance variables in the GWAS analysis, i.e., it is only necessary to capture the population structure. These results again denote that care must be taken to ensure that the reference panel is inclusive of the genetic ancestry of the study cohort.</p>
    </sec>
    <sec id="sec2.4">
      <title>Accuracy comparison with centralized association tests</title>
      <p id="p0110">First, we compared the accuracy of <italic>dMEGA</italic> in collaborative setting by comparing the association results with the centralized model as computed by lme4.<xref rid="bib40" ref-type="bibr"><sup>40</sup></xref> We used the genotypes and phenotypes data from the database of genotypes and phenotypes (dbGaP) with accession number phg000049 that comprises 3,007 individuals (1,266 case, 1,279 controls, 462 unknown). This dataset also contains the four covariates that are to be used for population stratification of the study subjects in downstream analyses. We ran <italic>dMEGA</italic> after partitioning data into three sites based on the k-means algorithm on the genotypes data and used the projection-based covariates for population stratification. The sites were treated as the additive random intercept effect, and this can be more efficient than treating them as fixed-effects when the number of sites is exploding. This assertion is justified since each term needs to be included at each site as a separate fixed effect term and may cause convergence or numerical stability problems. In the comparisons, we focused on the top 10,000 SNPs that were reported by plink<xref rid="bib41" ref-type="bibr"><sup>41</sup></xref> version 2 as most significantly associated with the disease status. This variant selection is done to decrease computational requirements. We ensured that the top 10,000 SNPs include the variants that have the highest association with the phenotype (AD-status) and contains large number of variants with no significant association, i.e., it is a representative set of variants for comparing the methods. We also evaluated the utility of projection-based population stratification and correction by estimating the population-based covariates using the 2,504 individuals in the 1000 Genomes Project (Methods).</p>
      <p id="p0115">We first compared the top SNPs at different significance levels using two stratification approaches to evaluate their effect, which are shown in <xref rid="tbl1" ref-type="table">Table 1</xref> using projections on top 4 and 6 components as covariates in population stratification. The choice of 4 projected covariates is for comparing the results when the number of projected covariates matches the dbGAP reported covariates. We also tested usage of 6 projected covariates to demonstrate that projection may require larger number of covariates to capture the genetic diversity in the study cohort. Overall, both methods exhibit high concordance with the centralized model (lme4).<table-wrap position="float" id="tbl1"><label>Table 1</label><caption><p>Performance of predicting significant SNPs under various significant level α</p></caption><table frame="hsides" rules="groups"><thead><tr><th>α</th><th>precision</th><th>recall</th><th>F1-score</th><th>Significant SNPs</th></tr></thead><tbody><tr><td colspan="5"><bold>Comparison 1: <italic>dMEGA</italic> on projected 4 PCs versus ‘lme4’ on 4 dbGAP Reported PCs</bold></td></tr><tr><td colspan="5"><hr/></td></tr><tr><td><inline-formula><mml:math id="M1" altimg="si10.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>0.580645</td><td>0.818182</td><td>0.679245</td><td>22</td></tr><tr><td><inline-formula><mml:math id="M2" altimg="si11.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>0.875</td><td>0.875</td><td>0.875</td><td>8</td></tr><tr><td><inline-formula><mml:math id="M3" altimg="si12.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>1</td><td>1</td><td>1</td><td>6</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td colspan="5"><bold>Comparison 2: <italic>dMEGA</italic> on projected 6 PCs versus ‘lme4’ on dbGAP Reported 4 PCs</bold></td></tr><tr><td colspan="5"><hr/></td></tr><tr><td><inline-formula><mml:math id="M4" altimg="si10.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>0.68</td><td>1</td><td>0.81</td><td>19</td></tr><tr><td><inline-formula><mml:math id="M5" altimg="si11.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>1</td><td>0.88</td><td>0.93</td><td>8</td></tr><tr><td><inline-formula><mml:math id="M6" altimg="si12.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>1</td><td>1</td><td>1</td><td>6</td></tr></tbody></table></table-wrap></p>
      <p id="p0120">We next pooled all of the SNPs and plotted the assigned p values, which is shown in <xref rid="fig3" ref-type="fig">Figure 3</xref>. Consistent with previous result, we observed that using 6 components exhibit a higher concordance of significance levels (Spearman correlation <inline-formula><mml:math id="M7" altimg="si1.gif"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math></inline-formula> for 6-components vs. 0.97 for 4-components.) (<xref rid="tbl2" ref-type="table">Table 2</xref>)<fig id="fig3"><label>Figure 3</label><caption><p>Scatterplots of p values from two comparisons</p><p>(A) Scatterplot of p values from comparison 1.</p><p>(B) Scatterplot of p values from comparison 2. The lme4 baseline models experimented with 4PCs dbGAP reported covariates.</p></caption><graphic xlink:href="gr3"/></fig><table-wrap position="float" id="tbl2"><label>Table 2</label><caption><p>Correlation statistics in two comparisons</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Comparison 1</th><th>Comparison 2</th></tr></thead><tbody><tr><td>Spearman correlation</td><td>0.9734</td><td>0.9909</td></tr><tr><td>Pearson correlation</td><td>0.9509</td><td>0.9845</td></tr></tbody></table></table-wrap></p>
      <p id="p0125">We next compared the ranks assigned to most significant SNPs by the two approaches when they are compared to the centralized model (<xref rid="fig4" ref-type="fig">Figures 4</xref> and <xref rid="mmc1" ref-type="supplementary-material">S4–S6</xref>). This is an important comparison to make sure that the most significant SNPs (from the original set of 10,000 variants), which would be functionally validated by the collaborating sites. Overall, there is fairly high concordance in the top SNPs and their rankings. Qualitatively, we observed ranking consistency to the centralized model is higher for population correction using 6-component projection compared to 4-component projections. <xref rid="tbl3" ref-type="table">Table 3</xref> We finally visually evaluated the genome-wide distribution of the SNP significance, assigned by the 2 projection approaches and the centralized model <xref rid="fig5" ref-type="fig">Figures 5</xref>, <xref rid="fig6" ref-type="fig">6</xref>, and <xref rid="fig7" ref-type="fig">7</xref>. As expected, all methods find the most significant associations on chromosome 19 with high concordance, which is known to be associated with AD.<fig id="fig4"><label>Figure 4</label><caption><p>SNP ranking concordance between lme4 and dMEGA</p><p>(A) Paired boxplot of comparison 1.</p><p>(B) Paired boxplot of comparison 2. The lme4 baseline models experimented with 4PCs dbGAP reported covariates.</p></caption><graphic xlink:href="gr4"/></fig><table-wrap position="float" id="tbl3"><label>Table 3</label><caption><p>20 Selected SNPs with high significance</p></caption><table frame="hsides" rules="groups"><thead><tr><th>SNP</th><th>CHR</th><th>dMEGA projected 6PCs</th><th>dMEGA projected 4PCs</th><th>lme4 dbGAP Reported 4PCs</th></tr></thead><tbody><tr><td>rs2075650</td><td>19</td><td>3.48E-42</td><td>9.14E-42</td><td>9.64E-42</td></tr><tr><td>rs405509</td><td>19</td><td>2.30E-14</td><td>3.22E-14</td><td>2.36E-14</td></tr><tr><td>rs8106922</td><td>19</td><td>3.24E-13</td><td>3.65E-13</td><td>3.37E-13</td></tr><tr><td>rs6859</td><td>19</td><td>6.93E-14</td><td>2.89E-13</td><td>3.37E-13</td></tr><tr><td>rs157580</td><td>19</td><td>1.57E-11</td><td>3.58E-11</td><td>2.13E-11</td></tr><tr><td>rs10402271</td><td>19</td><td>1.03E-08</td><td>1.35E-08</td><td>7.70E-09</td></tr><tr><td>rs4796606</td><td>17</td><td>1.39E-07</td><td>3.07E-07</td><td>1.69E-07</td></tr><tr><td>rs439401</td><td>19</td><td>1.02E-06</td><td>1.60E-06</td><td>8.50E-07</td></tr><tr><td>rs4954152</td><td>2</td><td>1.43E-06</td><td>3.95E-07</td><td>2.21E-06</td></tr><tr><td>rs2507880</td><td>11</td><td>2.45E-06</td><td>2.51E-06</td><td>2.96E-06</td></tr><tr><td>rs2939753</td><td>11</td><td>5.38E-06</td><td>2.30E-06</td><td>6.19E-06</td></tr><tr><td>rs11649731</td><td>17</td><td>7.32E-06</td><td>4.55E-06</td><td>6.47E-06</td></tr><tr><td>rs2924943</td><td>2</td><td>4.59E-06</td><td>1.09E-06</td><td>7.84E-06</td></tr><tr><td>rs7592667</td><td>2</td><td>7.55E-06</td><td>2.38E-05</td><td>8.10E-06</td></tr><tr><td>rs1526528</td><td>7</td><td>6.34E-06</td><td>1.05E-05</td><td>8.54E-06</td></tr><tr><td>rs1798296</td><td>12</td><td>7.03E-06</td><td>5.74E-06</td><td>9.01E-06</td></tr><tr><td>rs1471263</td><td>4</td><td>3.47E-06</td><td>2.20E-06</td><td>9.18E-06</td></tr><tr><td>rs6078239</td><td>20</td><td>8.82E-06</td><td>9.74E-06</td><td>9.26E-06</td></tr><tr><td>rs12320530</td><td>12</td><td>1.29E-05</td><td>1.97E-05</td><td>9.54E-06</td></tr><tr><td>rs7222487</td><td>17</td><td>7.52E-06</td><td>4.82E-06</td><td>9.63E-06</td></tr></tbody></table></table-wrap><fig id="fig5"><label>Figure 5</label><caption><p>Association significance of SNPs scored by <italic>dMEGA</italic> with projected datasets on 4 PCs</p><p>Manhattan plot shows the chromosomes on x axis and <inline-formula><mml:math id="M8" altimg="si9.gif"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>0</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> on the y axis. Each dot corresponds to an SNP.</p></caption><graphic xlink:href="gr5"/></fig><fig id="fig6"><label>Figure 6</label><caption><p>Association significance of SNPs scored by <italic>dMEGA</italic> with projected datasets on 6 PCs</p><p>Manhattan plot shows the chromosomes on x axis and <inline-formula><mml:math id="M9" altimg="si9.gif"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>0</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> on the y axis. Each dot corresponds to an SNP.</p></caption><graphic xlink:href="gr6"/></fig><fig id="fig7"><label>Figure 7</label><caption><p>Association significance of SNPs scored by lme4 with 4 dbGAP reported PCs</p><p>Manhattan plot shows the chromosomes on x axis and <inline-formula><mml:math id="M10" altimg="si9.gif"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>0</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> on the y axis. Each dot corresponds to an SNP.</p></caption><graphic xlink:href="gr7"/></fig></p>
    </sec>
    <sec id="sec2.5">
      <title>Comparison with cGLMM</title>
      <p id="p0130">We next compared dMEGA with cGLMM<xref rid="bib42" ref-type="bibr"><sup>42</sup></xref> algorithm from the open source GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/huthvincent/cGLMM" id="intref0025">https://github.com/huthvincent/cGLMM</ext-link>, and used the provided synthetic data, which comprised of 150 SNPs for 3000 samples also obtained from the same GitHub repository. cGLMM utilizes an MCMC-based optimization for estimating the effect sizes for the covariates in the dataset in the federated GLMM setting. We simulated federated learning conditions by loading the data into two separate clients, each having sample sizes of 1498 and 1502, respectively, while maintaining a central server that managed the communication and aggregation of the intermediate statistics. We ran the cGLMM algorithm 20 times and observed that we could only reproduce the results for 7 runs (<xref rid="mmc1" ref-type="supplementary-material">Table S1</xref>), which we attributed to numerical issues arising from either (1) parameter initialization or (2) Hessian matrix calculations (Personal communication with authors). On further investigation, we found that the intermediate Hessian matrix converged to a matrix of all zeros, which prevented the algorithm from updating beta (Equation 8 in Zhu et al. cGLMM paper).</p>
      <p id="p0135">To test the robustness of dMEGA, we randomly selected 10 SNPs from the 10,000 variant set and ran dMEGA 20 times independently on each SNP and estimated robustness of the statistics. Overall, dMEGA successfully completed all runs on all of the 10 SNPs. In addition, the standard deviation of p value estimated for each SNP among the independent runs is much smaller than the mean of the p value, indicating robust estimate of the p value. We observed a similar robustness for the estimated effect sizes (<xref rid="mmc1" ref-type="supplementary-material">Table S2</xref>).</p>
      <p id="p0140">We also observed important conceptual differences in cGLMM’s design and reported statistics. In particular, cGLMM algorithm aims to fit a single model for a given set of variants or covariates, providing only the effect size for each variant, without a statistical significance (i.e., p values for each covariate) of the effect sizes. This may pose a major limitation for application to GWAS because it is necessary to evaluate significance of the tested variants so as to filter out variants with no association. Thus, we believe cGLMM may not be directly applicable in GWAS settings.</p>
      <p id="p0145">Conversely, dMEGA fits a model for each variant individually and reports both the effect size and statistical significance for each predicted effect size. In summary, our comparisons indicate that the cGLMM algorithm and dMEGA differ in their conceptual design and practical applicability.</p>
    </sec>
    <sec id="sec2.6">
      <title>Timing, memory, and data transfer</title>
      <p id="p0150">Our experiment was done in a computation environment of 96 threads (24 Cores) Intel(R) Xeon(R) Platinum 8168 CPU @ 2.70 GHz, 1.5 TB memory, Ubuntu 16.04.7 LTS, Python 3.10.4. In the tests, 1 thread was used for estimating the runtime. We observed a small difference between running 6PCs and 4PCs in <italic>dMEGA</italic>. Federated computation for each SNP took 20 s and 200 MB memory on average to complete. The total communication cost of 4 PCs and 6 PCs federated model are 80 kB and 125 kB on average. This cost includes, for each iteration, each site transmit 88 Bytes of random effect coefficient, 144 Bytes of computational intermediates, and 72 Bytes of fixed effects coefficients (<xref rid="tbl4" ref-type="table">Table 4</xref>). Overall, these results indicate low network transfer requirements for <italic>dMEGA</italic>’s framework (<xref rid="fig8" ref-type="fig">Figure 8</xref>). The algorithm can benefit from software optimizations by parallelization of the calculations by multithreading.<table-wrap position="float" id="tbl4"><label>Table 4</label><caption><p>Communication summary</p></caption><table frame="hsides" rules="groups"><thead><tr><th><inline-formula><mml:math id="M11" altimg="si13.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="M12" altimg="si14.gif"><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula></th><th><inline-formula><mml:math id="M13" altimg="si14.gif"><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="M14" altimg="si13.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></th></tr></thead><tbody><tr><td>Number of PCs <italic>p</italic>: <bold>scalar</bold></td><td>Current working SNP’s name <italic>S</italic>: <bold>character</bold></td></tr><tr><td>A list of SNPs’ name <italic>S</italic>: <bold>list</bold></td><td>Global gradient <italic>l</italic>: <inline-formula><mml:math id="M15" altimg="si15.gif"><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><bold>vector</bold></td></tr><tr><td>Sample size <inline-formula><mml:math id="M16" altimg="si16.gif"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: <bold>scalar</bold></td><td>Global Hessian <italic>H</italic>: <inline-formula><mml:math id="M17" altimg="si17.gif"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula><bold>matrix</bold></td></tr><tr><td>Local gradient <inline-formula><mml:math id="M18" altimg="si18.gif"><mml:mrow><mml:msubsup><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>: <inline-formula><mml:math id="M19" altimg="si15.gif"><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><bold>vector</bold></td><td>Global parameter θ: <inline-formula><mml:math id="M20" altimg="si15.gif"><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><bold>vector</bold></td></tr><tr><td>Local Hessian <inline-formula><mml:math id="M21" altimg="si19.gif"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: <inline-formula><mml:math id="M22" altimg="si17.gif"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula><bold>matrix</bold></td><td>Inference statistics: <inline-formula><mml:math id="M23" altimg="si15.gif"><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><bold>vector</bold></td></tr><tr><td>Local mixed effect <inline-formula><mml:math id="M24" altimg="si20.gif"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: <bold>scalar</bold></td><td/></tr><tr><td>Local Standard Error <inline-formula><mml:math id="M25" altimg="si21.gif"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: <inline-formula><mml:math id="M26" altimg="si15.gif"><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><bold>vector</bold></td><td/></tr></tbody></table></table-wrap><fig id="fig8"><label>Figure 8</label><caption><p>Diagram of federated GLMM inference in <italic>dMEGA</italic></p></caption><graphic xlink:href="gr8"/></fig></p>
      <p id="p0155">As we are aware that dMEGA requires significant computational resources for large-scale studies involving millions of variants (e.g., estimation for 10,000 SNPs takes 200,000 s on a single thread), we recommend that its application be focused on specific scenarios. For instance, it can be useful in small-scale validation studies or targeted association testing, where sites may focus on small regions deemed significant at each site separately and validate using new samples collaboratively. Alternatively, sites may wish to collaborate on samples genotyped using targeted technologies like exome sequencing and targeted gene panels. These approaches can provide valuable insights into the genetic basis of complex traits while mitigating the computational burden.</p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Discussion</title>
    <p id="p0160">We presented <italic>dMEGA</italic> for federated generalized linear mixed modeling. <italic>dMEGA</italic> is readily applicable to collaborations where data sharing at the summary statistic level can be deployed. Unlike previous methods that rely on a computationally intensive federated PCA for performing population stratification and correction, <italic>dMEGA</italic> makes use of projection on existing reference panels and to correct for population biases. As the size and diversity of existing panels increase, we foresee that projection-based bias correction can prove more accurate. The projection has very small computational requirements and can be performed at each site before federated analysis.</p>
    <p id="p0165">Another similar method distributed Penalized Quasi-Likelihood (dPQL)<xref rid="bib43" ref-type="bibr"><sup>43</sup></xref> used penalized quasi-likelihood to approximate the objective function of GLMM. dPQL simplifies the maximization of the log likelihood function of GLMM to fitting a linear mixed model. However, dPQL has inherited drawbacks. For example, dPQL depends strongly on the estimated variance components,<xref rid="bib44" ref-type="bibr"><sup>44</sup></xref> but the inference of variance parameters in dPQL may be biased<xref rid="bib45" ref-type="bibr"><sup>45</sup></xref> because of its linearity assumption. <italic>dMEGA</italic> approximates the marginal distributions, and it provides more robust estimation since <italic>dMEGA</italic> considers the marginal predicted ratios associated with each local site, not just identifying samples with particularly high predicted ratios.<xref rid="bib44" ref-type="bibr"><sup>44</sup></xref> Another method that was recently proposed by Zhu et al.,<xref rid="bib42" ref-type="bibr"><sup>42</sup></xref> which utilizes Expectation Maximization by integrating Metropolis-Hastings algorithm with Newton-Raphson as the maximization steps for performing generalized linear mixed model in a collaborative fashion. Although this method is expected to provide matching results with a centralized algorithm, EM requires large sample sizes for robust parameter estimation and may likely get stuck in local optima in the parameter estimation. Our comparison results demonstrate some possible source of stability issues, e.g., convergence to a zero Hessian matrix. More importantly, cGLMM is designed to estimate only the covariate effect sizes and does not provide statistical significance for the effect sizes. This is an important consideration for application in GWAS since significance of the variants are central to filtering them out in these studies. We therefore believe dMEGA and cGLMM differ in conceptual and practical terms and in their application domains.</p>
    <p id="p0170">As the current implementation stands, <italic>dMEGA</italic> can be used for correcting for site-specific random risk factors (such as environmental factors). In addition, we formulated an approach that can be implemented into <italic>dMEGA</italic> to include site-level correlations among the random effects. This approach can be integrated into <italic>dMEGA</italic>’s federated implementation and be used to model more complex random risk effects among sites (e.g., sites close to each other geographically). A related work is lme4qtl,<xref rid="bib46" ref-type="bibr"><sup>46</sup></xref> which can incorporate individual-level random effects using a covariance matrix, e.g., kinship matrix. In its current implementation <italic>dMEGA</italic> is not able to handle the individual-level covarying random effects. We leave this as a future extension of the <italic>dMEGA</italic>’s federated GWAS framework.</p>
    <sec id="sec3.1">
      <title>Limitations of the study</title>
      <p id="p0175"><italic>dMEGA</italic> has several limitations that warrant further research. While our federated testing approach has small network traffic requirements, each local site is required to handle high computational load. This is a general challenge among federated learning methods. Considering that the gene association tests may involve millions of variants along with large number of phenotypes, the center server aggregation layer can be outsourced to cloud whereby, while the data are kept locally. Another limitation of <italic>dMEGA</italic> is selection of the reference panels that are used in projection step. As our results indicate, a reference panel that is not reflective of the genetic diversity of the study participants may inadvertently bias the results. Projection-based analysis has been employed previously in ancestry estimation<xref rid="bib37" ref-type="bibr"><sup>37</sup></xref> and kinship estimation methods<xref rid="bib47" ref-type="bibr"><sup>47</sup></xref> and the main justification for using the projection approaches is to decrease the computational requirements of a full federated PCA that entails large computational load on the sites. The future work in this arena include tuning the projected covariates to match the genetic ancestry of the study participants. For example, the sites can iteratively update the projected covariates to increase the genotypic variance explained by the covariates. We also propose the usage of "worldwide panel PCs<xref rid="bib37" ref-type="bibr"><sup>37</sup></xref>" that encompass the genetic diversity of a large set of populations. It is worth noting that the projection requires the principal components and not the individual level genotype data. Thus, it does not directly increase the individual-level privacy risks. In turn, the worldwide panel PCs can be released even from restricted panels such as TOPMed.</p>
      <p id="p0180">From privacy perspective, <italic>dMEGA</italic> shares only summary statistics between the central server and the sites. In that regard, it is necessary that the central server is a trusted entity (such as NIH) and that all sites are expected to execute <italic>dMEGA</italic> in an honest manner. As summary statistics may leak information, honest-but-curious entities can perform re-identification attacks. This is, however, a general concern in federated learning frameworks and not specific to <italic>dMEGA</italic>. Our approach does not pose a direct risk to the reference panel because projection requires only the principal components. Thus, restricted reference panels from underrepresented populations can be utilized in these computations. It is still worth noting that the principal components are types of summary statistics and can leak information that may be used to re-identify participation using previously described attacks.<xref rid="bib48" ref-type="bibr"><sup>48</sup></xref> Furthermore, the intermediate statistics (<inline-formula><mml:math id="M27" altimg="si2.gif"><mml:mrow><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>) are also vulnerable to certain attacks on federated learning systems such as variants of gradient inversion attacks.<xref rid="bib49" ref-type="bibr"><sup>49</sup></xref> Thus, it is important to protect these model information during the federated learning process. Different approaches can be used to protect these summary statistics such as multi-key homomorphic encryption<xref rid="bib50" ref-type="bibr"><sup>50</sup></xref> (MKHE), or Differential Privacy (DP). The usage of these formalisms requires further research into efficient re-formulations for MKHE and balancing the Gaussian or Laplace noise level for DP for ensuring utility.</p>
      <p id="p0185">To increase the confidentiality of <italic>dMEGA</italic>, we can utilize noise addition to hide local intermediate information, denoted as <inline-formula><mml:math id="M28" altimg="si3.gif"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (i.e. local sample size, local gradient, local Hessian, local mixed effects, and local standard error), during communication. This idea has been developed in the HyFed<xref rid="bib51" ref-type="bibr"><sup>51</sup></xref> framework, which introduces a server called <italic>Compensator</italic> to collect the local noise <inline-formula><mml:math id="M29" altimg="si4.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> values from each client and send the aggregated noise, i.e., <inline-formula><mml:math id="M30" altimg="si5.gif"><mml:mrow><mml:mi>N</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, to the CS. In this process, each client generates local noise <inline-formula><mml:math id="M31" altimg="si4.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> from a Gaussian distribution with zero mean and a variance of <inline-formula><mml:math id="M32" altimg="si6.gif"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. Then, each client will mask the intermediate statistics <inline-formula><mml:math id="M33" altimg="si3.gif"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> using the noise <inline-formula><mml:math id="M34" altimg="si4.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, to generate <inline-formula><mml:math id="M35" altimg="si7.gif"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and send the noisy statistic to CS. Simultaneously, each site sends the noise levels to the <italic>Compensator</italic>. When all clients finish their communication, CS unmasks the global information of interest <inline-formula><mml:math id="M36" altimg="si8.gif"><mml:mrow><mml:mi>I</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> via deducting the aggregated noise <italic>N</italic> provided by <italic>Compensator</italic>.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <title>STAR★Methods</title>
    <sec id="sec4.1">
      <title>Key resources table</title>
      <p id="p0190">
        <table-wrap position="float" id="undtbl1">
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th>REAGENT or RESOURCE</th>
                <th>SOURCE</th>
                <th>IDENTIFIER</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="3">
                  <bold>Deposited data</bold>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td>Late Onset Alzheimer’s Disease Cohort Dataset</td>
                <td>Database of Genotypes and Phenotypes (dbGaP)</td>
                <td>phs000168</td>
              </tr>
              <tr>
                <td>The 1000 Genomes Project Genotype and Metadata</td>
                <td>1000 Genomes Project</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://www.internationalgenome.org/data/" id="intref0030">https://www.internationalgenome.org/data/</ext-link>
                </td>
              </tr>
              <tr>
                <td>R</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/bin/windows/base/" id="intref0035">https://cran.r-project.org/bin/windows/base/</ext-link>
                </td>
                <td>R</td>
              </tr>
              <tr>
                <td>dMEGA</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/Li-Wentao/dMEGA" id="intref0040">https://github.com/Li-Wentao/dMEGA</ext-link>
                </td>
                <td>dMEGA</td>
              </tr>
              <tr>
                <td>Plink2</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://www.cog-genomics.org/plink/2.0" id="intref0045">https://www.cog-genomics.org/plink/2.0</ext-link>
                </td>
                <td>Plink2</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </p>
    </sec>
    <sec id="sec4.2">
      <title>Resource availability</title>
      <sec id="sec4.2.1">
        <title>Lead contact</title>
        <p id="p0195">Further information and requests for resources and reagents should be directed to and will be fulfilled by the lead contact, Arif Harmanci (<ext-link ext-link-type="uri" xlink:href="mailto:Arif.O.Harmanci@uth.tmc.edu" id="intref0050">Arif.O.Harmanci@uth.tmc.edu</ext-link>).</p>
      </sec>
      <sec id="sec4.2.2">
        <title>Materials availability</title>
        <p id="p0200">This study did not generate new unique reagents.</p>
      </sec>
    </sec>
    <sec id="sec4.3">
      <title>Method details</title>
      <p id="p0205">The goal of <italic>dMEGA</italic> is to detect significant SNPs that are associated with specific diseases or phenotypes in a federated manner. In our assumption, genotype and phenotype data are stored cohort-wise throughout several entities (e.g., research institutions or hospitals). Each entity is presumed to be prohibited from sending original data. By constructing a logistic regression model with mixed effects, data holders will update the global model with local information bias considered. Notice that the communication process does not put data at risk due to <italic>dMEGA</italic> will only ask data holders for model information, such as gradients.</p>
      <sec id="sec4.3.1">
        <title>Projection-based calculation of population covariates</title>
        <p id="p0210"><italic>dMEGA</italic> first centers the genotype matrix for each individual and projects the samples on a reference panel that is shared among the sites. In the context of privacy-aware analysis, this is a reasonable assumption because the sites can make use of numerous publicly available panels. For <italic>dMEGA</italic>, we use The 1000 Genomes Project panel that comprises 26 diverse sets of populations that are geographically sampled over the world.</p>
        <p id="p0215">The reference panel is first processed at the central server. This is done by performing principal component analysis (PCA) on the reference panel by decomposition of the genotype covariance matrix, i.e., <inline-formula><mml:math id="M37" altimg="si22.gif"><mml:mrow><mml:mi>P</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">·</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mi mathvariant="normal">Π</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">·</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">·</mml:mo><mml:msup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="M38" altimg="si23.gif"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes the full set of principal components of reference panel genotype matrix <inline-formula><mml:math id="M39" altimg="si24.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for <italic>N</italic> genetic variants and <italic>S</italic> samples in the reference panel, where <inline-formula><mml:math id="M40" altimg="si25.gif"><mml:mrow><mml:mi>S</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>2,504</mml:mn></mml:mrow></mml:math></inline-formula> for The 1000 Genomes Project population data. We use κ top principal components (columns) of this matrix in our projection step.</p>
        <p id="p0220">After the reference panel is processed by the central server, the principal components are sent to collaborating sites. It should be noted that the reference panel is processed once at the central site at the beginning of the computations. The central server does not share the reference panel genotypes directly with the sites. The components do not represent direct risk to the reference panel individuals. This is advantageous for utilizing the restricted population panels, such as the ToPMED panel.<xref rid="bib6" ref-type="bibr"><sup>6</sup></xref><disp-formula id="fd1"><label>(Equation 1)</label><mml:math id="M41" altimg="si26.gif"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mo linebreak="goodbreak">·</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M42" altimg="si27.gif"><mml:mrow><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> denotes the centered genotype matrix.<disp-formula id="fd2"><label>(Equation 2)</label><mml:math id="M43" altimg="si28.gif"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo linebreak="goodbreak">&lt;</mml:mo><mml:mi>κ</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M44" altimg="si29.gif"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes the <inline-formula><mml:math id="M45" altimg="si30.gif"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> covariate for <inline-formula><mml:math id="M46" altimg="si31.gif"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> individual.</p>
      </sec>
      <sec id="sec4.3.2">
        <title>Projection-based covariate computation with the 1000 genomes sample</title>
        <p id="p0225">In our experiments, we used The 1000 Genomes Project’s phase 3 genotypes as the reference panel available at . We used the bi-allelic SNPs and subsampled the variants to utilize 77,531 variants. We generated the top 4 and 6 principal components for the 3,007 individuals in the genotype dataset.</p>
      </sec>
      <sec id="sec4.3.3">
        <title>Federated association test</title>
        <p id="p0230">We introduce a federated association test algorithm based on Generalized Linear Mixed Model. Assume that there will be <italic>k</italic> institutions that hold genotype and phenotype data, and that each institution’s database consists of <inline-formula><mml:math id="M47" altimg="si16.gif"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> subjects (<xref rid="fig8" ref-type="fig">Figure 8</xref>). Let the total number of patients be denoted by <inline-formula><mml:math id="M48" altimg="si32.gif"><mml:mrow><mml:mi>n</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Here, we consider site-wise mixed-effects, denoting <inline-formula><mml:math id="M49" altimg="si20.gif"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> as the mixed-effect of institution <italic>i</italic>, as well as shared fixed-effects θ. Notice that the fixed-effects parameter space is split into two parts, <inline-formula><mml:math id="M50" altimg="si33.gif"><mml:mrow><mml:mi>θ</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>γ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Denote β is of <inline-formula><mml:math id="M51" altimg="si34.gif"><mml:mrow><mml:mi>N</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> dimension parameter for covariates and γ is 1 dimension for genotype. The genotype dataset at institution <italic>i</italic> denoted as <inline-formula><mml:math id="M52" altimg="si35.gif"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (Matrix of <inline-formula><mml:math id="M53" altimg="si34.gif"><mml:mrow><mml:mi>N</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> covariates and 1 genotype on <inline-formula><mml:math id="M54" altimg="si36.gif"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> individuals), and phenotypes denoted as <inline-formula><mml:math id="M55" altimg="si37.gif"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (vector of length <inline-formula><mml:math id="M56" altimg="si36.gif"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>). Thus, the mixed model of each site can be represented as<disp-formula id="ufd1"><mml:math id="M57" altimg="si38.gif"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo linebreak="badbreak">=</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>θ</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="ufd2"><mml:math id="M58" altimg="si39.gif"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="goodbreak">∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M59" altimg="si40.gif"><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo linebreak="badbreak">·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the inverse of the link function (i.e., a logit function for logistic regression/binary traits) that defines the relationship between the linear combination of the predictors (genotypes, covariates, and random effects) to the mean of the phenotype. Here, we focus on the random intercept effect at site <italic>i</italic>, <inline-formula><mml:math id="M60" altimg="si20.gif"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, which follows a normal distribution with mean 0 and variance σ. In this scenario, <inline-formula><mml:math id="M61" altimg="si20.gif"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is constant for individuals on the same site. Across the sites, <inline-formula><mml:math id="M62" altimg="si20.gif"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is normally distributed across sites.</p>
        <p id="p0235">For a binary trait (i.e. case/control study), the conditional probability distribution of the phenotype given the variant genotypes and covariates can be written as<disp-formula id="ufd3"><mml:math id="M63" altimg="si41.gif"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn><mml:mo>∣</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:munder><mml:mo>∫</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munder><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>θ</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>φ</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where φ denotes the probability density function for normal distribution with mean 0 and hyper-parameter variance σ. Thus, the likelihood function of the joint distribution can be formulated as<disp-formula id="ufd4"><mml:math id="M64" altimg="si42.gif"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p id="p0240">The optimization of the likelihood function is a non-tractable problem because the integral over the random effects does not have a closed form representation. To solve the intractable problem, we utilize Laplace approximation for the likelihood function:<disp-formula id="ufd5"><mml:math id="M65" altimg="si43.gif"><mml:mrow><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>log</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo linebreak="newline">≜</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo linebreak="newline">≈</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>″</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="badbreak">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo linebreak="newline">≜</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M66" altimg="si44.gif"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>σ</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula>. And for computational convenience, we take log-likelihood as our objective function, that is<disp-formula id="ufd6"><mml:math id="M67" altimg="si45.gif"><mml:mrow><mml:mi>l</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">≜</mml:mo><mml:mi>log</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:mi>log</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">≜</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p id="p0245">Hence, the goal is to optimize the approximated objective function above. Compared to the centralized (all data pooled in one repository) inference, the optimization in federated learning settings is based on iterations of (1) Calculation of the intermediate statistics computed using each institution’s local data and (2) aggregation of the statistics by a central server (CS). We describe the steps in more detail below:</p>
        <p id="p0250"><bold>Initialization</bold>. The federated learning will start with a central server <inline-formula><mml:math id="M68" altimg="si14.gif"><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> that connects to <italic>k</italic> distributed local data repositories. Initial modeling information requests will send to each participant <inline-formula><mml:math id="M69" altimg="si13.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.<list list-type="simple" id="ulist0015"><list-item id="u0040"><label>•</label><p id="p0255">Number of PCs</p></list-item><list-item id="u0045"><label>•</label><p id="p0260">A list of SNPs’ name <italic>S</italic></p></list-item><list-item id="u0050"><label>•</label><p id="p0265">A list of sample size across participants <italic>N</italic></p></list-item></list></p>
        <p id="p0270"><bold>Step 1</bold>. <inline-formula><mml:math id="M70" altimg="si14.gif"><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> will initiate model parameters <inline-formula><mml:math id="M71" altimg="si46.gif"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for each distributed model with SNP in list <italic>S</italic>. And each local repository <inline-formula><mml:math id="M72" altimg="si13.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> computes model’s intermediates and send back to CS<list list-type="simple" id="ulist0020"><list-item id="u0055"><label>•</label><p id="p0275">Local gradients on fixed effects '<inline-formula><mml:math id="M73" altimg="si47.gif"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item id="u0060"><label>•</label><p id="p0280">Local Hessian matrix on fixed effects Hi</p></list-item><list-item id="u0065"><label>•</label><p id="p0285">Local site-wise mixed effect coefficient <inline-formula><mml:math id="M74" altimg="si20.gif"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></p></list-item></list></p>
        <p id="p0290"><bold>Step 2</bold>. <inline-formula><mml:math id="M75" altimg="si14.gif"><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> updates model’s parameter <inline-formula><mml:math id="M76" altimg="si48.gif"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with aggregated information from global gradients <inline-formula><mml:math id="M77" altimg="si49.gif"><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, global hessian <inline-formula><mml:math id="M78" altimg="si50.gif"><mml:mrow><mml:mi>H</mml:mi><mml:mi>μ</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and previous fixed-effects <inline-formula><mml:math id="M79" altimg="si51.gif"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The update is done by Newton’s method <inline-formula><mml:math id="M80" altimg="si52.gif"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:msup><mml:mi>l</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">/</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></inline-formula>. Then send <inline-formula><mml:math id="M81" altimg="si48.gif"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to each <inline-formula><mml:math id="M82" altimg="si13.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
        <p id="p0295"><bold>Step 3</bold>. Each <inline-formula><mml:math id="M83" altimg="si13.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> will follow Step 2 until model is converged with criteria <inline-formula><mml:math id="M84" altimg="si53.gif"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M85" altimg="si54.gif"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> below threshold <inline-formula><mml:math id="M86" altimg="si11.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
        <p id="p0300"><bold>Step 4</bold>. The <inline-formula><mml:math id="M87" altimg="si14.gif"><mml:mrow><mml:mi>C</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> will compute the local standard errors <inline-formula><mml:math id="M88" altimg="si55.gif"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mo>⊤</mml:mo></mml:msubsup><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> from <inline-formula><mml:math id="M89" altimg="si13.gif"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, then return inference statistics (e.g. Z score, P-values). Where <inline-formula><mml:math id="M90" altimg="si56.gif"><mml:mrow><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>⊤</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
        <p id="p0305">All the information in communication is summarized in table below</p>
      </sec>
      <sec id="sec4.3.4">
        <title>Dependent site-wise relationship in dMEGA</title>
        <p id="p0310">Furthermore, we can generalize this problem with the site-level variance-covariance matrix. Here, we don’t assume the dependency among federated sites and denote a site covariance matrix <inline-formula><mml:math id="M91" altimg="si57.gif"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:math></inline-formula>. Notice that <inline-formula><mml:math id="M92" altimg="si57.gif"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:math></inline-formula> is a <inline-formula><mml:math id="M93" altimg="si58.gif"><mml:mrow><mml:mi>k</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> matrix under our scenario. We assume the site variance-covariance matrix <inline-formula><mml:math id="M94" altimg="si57.gif"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:math></inline-formula> is known. And τ is the cross-site hyperparameter to be estimated.</p>
        <p id="p0315">Hence the distribution of the random effect is a multivariate normal distribution and it is shown as<disp-formula id="ufd7"><mml:math id="M95" altimg="si59.gif"><mml:mrow><mml:mi>μ</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>⊤</mml:mo></mml:msup><mml:mo linebreak="goodbreak">∼</mml:mo><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where μ is the vector of random effects of each federated site, and τ is the hyperparameter that is to be estimated. Now, the objective function of the dependent sites is<disp-formula id="ufd8"><mml:math id="M96" altimg="si60.gif"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∣</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      </sec>
    </sec>
    <sec id="sec4.4">
      <title>Quantification and statistical analysis</title>
      <p id="p0320">p-values reported in the results are estimated with respect to the aforementioned generalized linear mixed models. P-value cutoffs are selected as described in the reported tables and results.</p>
      <sec id="sec4.4.1">
        <title>Data sources and experimental setup</title>
        <p id="p0325">We used genotype-phenotype data obtained from database of Genotypes and Phenotypes (dbGaP) with accession number phs000168 for our experiments available for General Research Use (GRU). This dataset contains <inline-formula><mml:math id="M97" altimg="si61.gif"><mml:mrow><mml:mn>575,003</mml:mn></mml:mrow></mml:math></inline-formula> variants genotyped by Illumina Human610-Quad version 1 platform over <inline-formula><mml:math id="M98" altimg="si62.gif"><mml:mrow><mml:mn>3,007</mml:mn></mml:mrow></mml:math></inline-formula> individuals. Raw data is processed and formatted with plink2.<xref rid="bib41" ref-type="bibr"><sup>41</sup></xref> The alternate alleles reported by the array platform were re-coded using in-house scripts to ensure that they were concordant with The 1000 Genomes Project. Any variant for which we could not resolve by strand were excluded. We next used plink2’s "–glm" option to calculate the baseline association signals. We next filtered the SNPs and identified the SNPs with top <inline-formula><mml:math id="M99" altimg="si63.gif"><mml:mrow><mml:mn>10,000</mml:mn></mml:mrow></mml:math></inline-formula> variants with the strongest association signal to the phenotype.</p>
        <p id="p0330">The reference panel is obtained from the 1000 Genomes Project FTP portal at <ext-link ext-link-type="uri" xlink:href="ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/" id="intref0055">ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/</ext-link>. We processed 1000 Genomes dataset by first excluding the SNPs with minor allele frequency (MAF) smaller than <inline-formula><mml:math id="M100" altimg="si64.gif"><mml:mrow><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>. We next overlapped the variants with the re-coded array variants, which yielded <inline-formula><mml:math id="M101" altimg="si65.gif"><mml:mrow><mml:mn>155,076</mml:mn></mml:mrow></mml:math></inline-formula> common variants. To decrease computational requirements, we focused on variants on the 22 autosomal chromosomes and further sub-sampled the remaining variants to generate the final <inline-formula><mml:math id="M102" altimg="si66.gif"><mml:mrow><mml:mn>77,315</mml:mn></mml:mrow></mml:math></inline-formula> variants. These variants were used to generate the principal components and population-based covariates in the projection step.</p>
        <p id="p0335">To evaluate <italic>dMEGA</italic>, we compared it with a baseline method using the linear mixed model implemented in R package ‘lme4’.<xref rid="bib52" ref-type="bibr"><sup>52</sup></xref> Our experiments were designed as table below:</p>
        <p id="p0340">We will focus on two comparisons (beow table):<table-wrap position="float" id="undtbl5"><caption><p>Experiments</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Distributed</th><th>Pooled</th></tr></thead><tbody><tr><td>Projected</td><td><italic>dMEGA</italic><sup>∗†</sup></td><td>R(lme4)<sup>†</sup></td></tr><tr><td>dbGAP Covariates</td><td>–</td><td>R(lme4)<sup>∗</sup></td></tr></tbody></table></table-wrap><list list-type="simple" id="olist0015"><list-item id="o0010"><label>1.</label><p id="p0345">(Denoted in †) <italic>dMEGA</italic> in projected and distributed data and baseline in projected and pooled data.</p></list-item></list></p>
        <p id="p0350">While the datasets are the same (projected), this comparison aims to show the performance of <italic>dMEGA</italic> in distributed datasets.<list list-type="simple" id="olist0020"><list-item id="o0015"><label>2.</label><p id="p0355">(Denoted in <inline-formula><mml:math id="M103" altimg="si67.gif"><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:math></inline-formula>) <italic>dMEGA</italic> using projected covariates and distributed data and baseline in dbGAP provided covariates and pooled data.</p></list-item></list></p>
        <p id="p0360">The datasets are of different between <italic>dMEGA</italic> method (using projected covariates) and baseline method (using dbGAP covariates). This comparison will show the capability of projection combining with federated learning.</p>
      </sec>
    </sec>
  </sec>
</body>
<back>
  <ref-list id="cebib0010">
    <title>References</title>
    <ref id="bib1">
      <label>1</label>
      <element-citation publication-type="journal" id="sref1">
        <person-group person-group-type="author">
          <name>
            <surname>Christensen</surname>
            <given-names>K.D.</given-names>
          </name>
          <name>
            <surname>Dukhovny</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Siebert</surname>
            <given-names>U.</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>R.C.</given-names>
          </name>
        </person-group>
        <article-title>Assessing the costs and cost-effectiveness of genomic sequencing</article-title>
        <source>J. Personalized Med.</source>
        <volume>5</volume>
        <year>2015</year>
        <fpage>470</fpage>
        <lpage>486</lpage>
      </element-citation>
    </ref>
    <ref id="bib2">
      <label>2</label>
      <element-citation publication-type="journal" id="sref2">
        <person-group person-group-type="author">
          <name>
            <surname>Sboner</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Mu</surname>
            <given-names>X.J.</given-names>
          </name>
          <name>
            <surname>Greenbaum</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Auerbach</surname>
            <given-names>R.K.</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M.B.</given-names>
          </name>
        </person-group>
        <article-title>The real cost of sequencing: higher than you think</article-title>
        <source>Genome Biol.</source>
        <volume>12</volume>
        <year>2011</year>
        <fpage>125</fpage>
        <pub-id pub-id-type="pmid">21867570</pub-id>
      </element-citation>
    </ref>
    <ref id="bib3">
      <label>3</label>
      <element-citation publication-type="journal" id="sref3">
        <person-group person-group-type="author">
          <collab>All of Us Research Program Investigators</collab>
          <name>
            <surname>Denny</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Rutter</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Goldstein</surname>
            <given-names>D.B.</given-names>
          </name>
          <name>
            <surname>Philippakis</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Smoller</surname>
            <given-names>J.W.</given-names>
          </name>
          <name>
            <surname>Jenkins</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Dishman</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>The “all of us” research program</article-title>
        <source>N. Engl. J. Med.</source>
        <volume>381</volume>
        <year>2019</year>
        <fpage>668</fpage>
        <lpage>676</lpage>
        <pub-id pub-id-type="pmid">31412182</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <label>4</label>
      <element-citation publication-type="journal" id="sref4">
        <person-group person-group-type="author">
          <name>
            <surname>Palsson</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Rabinow</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Iceland: the case of a national human genome project</article-title>
        <source>Anthropol. Today</source>
        <volume>15</volume>
        <year>1999</year>
        <fpage>14</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="pmid">15199942</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <label>5</label>
      <element-citation publication-type="journal" id="sref5">
        <person-group person-group-type="author">
          <name>
            <surname>Sudlow</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Gallacher</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Beral</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Burton</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Danesh</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Downey</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Elliott</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Landray</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>UK biobank: an open access resource for identifying the causes of a wide range of complex diseases of middle and old age</article-title>
        <source>PLoS Med.</source>
        <volume>12</volume>
        <year>2015</year>
        <object-id pub-id-type="publisher-id">e1001779</object-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <label>6</label>
      <element-citation publication-type="journal" id="sref6">
        <person-group person-group-type="author">
          <name>
            <surname>Taliun</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>D.N.</given-names>
          </name>
          <name>
            <surname>Kessler</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Szpiech</surname>
            <given-names>Z.A.</given-names>
          </name>
          <name>
            <surname>Torres</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Taliun</surname>
            <given-names>S.A.G.</given-names>
          </name>
          <name>
            <surname>Corvelo</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Gogarten</surname>
            <given-names>S.M.</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>H.M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sequencing of 53,831 diverse genomes from the NHLBI TOPMed program</article-title>
        <source>Nature</source>
        <volume>590</volume>
        <year>2021</year>
        <fpage>290</fpage>
        <lpage>299</lpage>
        <pub-id pub-id-type="pmid">33568819</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <label>7</label>
      <element-citation publication-type="journal" id="sref7">
        <person-group person-group-type="author">
          <name>
            <surname>Crane</surname>
            <given-names>P.K.</given-names>
          </name>
          <name>
            <surname>Foroud</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Montine</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>E.B.</given-names>
          </name>
        </person-group>
        <article-title>Alzheimer’s disease sequencing project discovery and replication criteria for cases and controls: Data from a community-based prospective cohort study with autopsy follow-up</article-title>
        <source>Alzheimers Dement.</source>
        <volume>13</volume>
        <year>2017</year>
        <fpage>1410</fpage>
        <lpage>1413</lpage>
        <pub-id pub-id-type="pmid">29055816</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <label>8</label>
      <element-citation publication-type="journal" id="sref8">
        <person-group person-group-type="author">
          <name>
            <surname>Tomczak</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Czerwińska</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Wiznerowicz</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>The cancer genome atlas (TCGA): an immeasurable source of knowledge</article-title>
        <source>Contemp. Oncol.</source>
        <volume>19</volume>
        <year>2015</year>
        <fpage>A68</fpage>
        <lpage>A77</lpage>
      </element-citation>
    </ref>
    <ref id="bib9">
      <label>9</label>
      <element-citation publication-type="journal" id="sref9">
        <person-group person-group-type="author">
          <collab>GTEx Consortium</collab>
        </person-group>
        <article-title>The Genotype-Tissue expression (GTEx) project</article-title>
        <source>Nat. Genet.</source>
        <volume>45</volume>
        <year>2013</year>
        <fpage>580</fpage>
        <lpage>585</lpage>
        <pub-id pub-id-type="pmid">23715323</pub-id>
      </element-citation>
    </ref>
    <ref id="bib10">
      <label>10</label>
      <element-citation publication-type="journal" id="sref10">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>A.L.</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N.J.</given-names>
          </name>
          <name>
            <surname>Plenge</surname>
            <given-names>R.M.</given-names>
          </name>
          <name>
            <surname>Weinblatt</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Shadick</surname>
            <given-names>N.A.</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Principal components analysis corrects for stratification in genome-wide association studies</article-title>
        <source>Nat. Genet.</source>
        <volume>38</volume>
        <year>2006</year>
        <fpage>904</fpage>
        <lpage>909</lpage>
        <pub-id pub-id-type="pmid">16862161</pub-id>
      </element-citation>
    </ref>
    <ref id="bib11">
      <label>11</label>
      <element-citation publication-type="journal" id="sref11">
        <person-group person-group-type="author">
          <name>
            <surname>Malik</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Chauhan</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Traylor</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Sargurupremraj</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Okada</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Mishra</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Rutten-Jacobs</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Giese</surname>
            <given-names>A.-K.</given-names>
          </name>
          <name>
            <surname>van der Laan</surname>
            <given-names>S.W.</given-names>
          </name>
          <name>
            <surname>Gretarsdottir</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiancestry genome-wide association study of 520,000 subjects identifies 32 loci associated with stroke and stroke subtypes</article-title>
        <source>Nat. Genet.</source>
        <volume>50</volume>
        <year>2018</year>
        <fpage>524</fpage>
        <lpage>537</lpage>
        <pub-id pub-id-type="pmid">29531354</pub-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <label>12</label>
      <element-citation publication-type="journal" id="sref12">
        <person-group person-group-type="author">
          <name>
            <surname>de Vries</surname>
            <given-names>P.S.</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>A.R.</given-names>
          </name>
          <name>
            <surname>Sung</surname>
            <given-names>Y.J.</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>T.W.</given-names>
          </name>
          <name>
            <surname>Ntalla</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Schwander</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Kraja</surname>
            <given-names>A.T.</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Franceschini</surname>
            <given-names>N.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiancestry genome-wide association study of lipid levels incorporating gene-alcohol interactions</article-title>
        <source>Am. J. Epidemiol.</source>
        <volume>188</volume>
        <year>2019</year>
        <fpage>1033</fpage>
        <lpage>1054</lpage>
        <pub-id pub-id-type="pmid">30698716</pub-id>
      </element-citation>
    </ref>
    <ref id="bib13">
      <label>13</label>
      <element-citation publication-type="journal" id="sref13">
        <person-group person-group-type="author">
          <name>
            <surname>Panagiotou</surname>
            <given-names>O.A.</given-names>
          </name>
          <name>
            <surname>Willer</surname>
            <given-names>C.J.</given-names>
          </name>
          <name>
            <surname>Hirschhorn</surname>
            <given-names>J.N.</given-names>
          </name>
          <name>
            <surname>Ioannidis</surname>
            <given-names>J.P.A.</given-names>
          </name>
        </person-group>
        <article-title>The power of meta-analysis in genome-wide association studies</article-title>
        <source>Annu. Rev. Genom. Hum. Genet.</source>
        <volume>14</volume>
        <year>2013</year>
        <fpage>441</fpage>
        <lpage>465</lpage>
      </element-citation>
    </ref>
    <ref id="bib14">
      <label>14</label>
      <element-citation publication-type="journal" id="sref14">
        <person-group person-group-type="author">
          <name>
            <surname>Sung</surname>
            <given-names>Y.J.</given-names>
          </name>
          <name>
            <surname>Schwander</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Arnett</surname>
            <given-names>D.K.</given-names>
          </name>
          <name>
            <surname>Kardia</surname>
            <given-names>S.L.R.</given-names>
          </name>
          <name>
            <surname>Rankinen</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Bouchard</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Boerwinkle</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>S.C.</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>D.C.</given-names>
          </name>
        </person-group>
        <article-title>An empirical comparison of meta-analysis and mega-analysis of individual participant data for identifying gene-environment interactions</article-title>
        <source>Genet. Epidemiol.</source>
        <volume>38</volume>
        <year>2014</year>
        <fpage>369</fpage>
        <lpage>378</lpage>
        <pub-id pub-id-type="pmid">24719363</pub-id>
      </element-citation>
    </ref>
    <ref id="bib15">
      <label>15</label>
      <element-citation publication-type="journal" id="sref15">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Conomos</surname>
            <given-names>M.P.</given-names>
          </name>
          <name>
            <surname>Stilp</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Sofer</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Szpiro</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Brehm</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Celedón</surname>
            <given-names>J.C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Control for population structure and relatedness for binary traits in genetic association studies via logistic mixed models</article-title>
        <source>Am. J. Hum. Genet.</source>
        <volume>98</volume>
        <year>2016</year>
        <fpage>653</fpage>
        <lpage>666</lpage>
        <pub-id pub-id-type="pmid">27018471</pub-id>
      </element-citation>
    </ref>
    <ref id="bib16">
      <label>16</label>
      <element-citation publication-type="journal" id="sref16">
        <person-group person-group-type="author">
          <name>
            <surname>Prentice</surname>
            <given-names>R.L.</given-names>
          </name>
          <name>
            <surname>Pyke</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Logistic disease incidence models and case-control studies</article-title>
        <source>Biometrika</source>
        <volume>66</volume>
        <year>1979</year>
        <fpage>403</fpage>
        <lpage>411</lpage>
      </element-citation>
    </ref>
    <ref id="bib17">
      <label>17</label>
      <element-citation publication-type="journal" id="sref17">
        <person-group person-group-type="author">
          <name>
            <surname>Moore</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Frye</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Review of HIPAA, part 1: History, protected health information, and privacy and security rules</article-title>
        <source>J. Nucl. Med. Technol.</source>
        <volume>47</volume>
        <year>2019</year>
        <fpage>269</fpage>
        <lpage>272</lpage>
        <pub-id pub-id-type="pmid">31182664</pub-id>
      </element-citation>
    </ref>
    <ref id="bib18">
      <label>18</label>
      <element-citation publication-type="journal" id="sref18">
        <person-group person-group-type="author">
          <name>
            <surname>Cornock</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>General data protection regulation (GDPR) and implications for research</article-title>
        <source>Maturitas</source>
        <volume>111</volume>
        <year>2018</year>
        <fpage>A1</fpage>
        <lpage>A2</lpage>
        <pub-id pub-id-type="pmid">29395455</pub-id>
      </element-citation>
    </ref>
    <ref id="bib19">
      <label>19</label>
      <element-citation publication-type="journal" id="sref19">
        <person-group person-group-type="author">
          <name>
            <surname>Bonomi</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Ohno-Machado</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Privacy challenges and research opportunities for genomic data sharing</article-title>
        <source>Nat. Genet.</source>
        <volume>52</volume>
        <year>2020</year>
        <fpage>646</fpage>
        <lpage>654</lpage>
        <pub-id pub-id-type="pmid">32601475</pub-id>
      </element-citation>
    </ref>
    <ref id="bib20">
      <label>20</label>
      <element-citation publication-type="journal" id="sref20">
        <person-group person-group-type="author">
          <name>
            <surname>Wan</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Hazel</surname>
            <given-names>J.W.</given-names>
          </name>
          <name>
            <surname>Clayton</surname>
            <given-names>E.W.</given-names>
          </name>
          <name>
            <surname>Vorobeychik</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Kantarcioglu</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Malin</surname>
            <given-names>B.A.</given-names>
          </name>
        </person-group>
        <article-title>Sociotechnical safeguards for genomic data privacy</article-title>
        <source>Nat. Rev. Genet.</source>
        <volume>23</volume>
        <year>2022</year>
        <fpage>429</fpage>
        <lpage>445</lpage>
        <pub-id pub-id-type="pmid">35246669</pub-id>
      </element-citation>
    </ref>
    <ref id="bib21">
      <label>21</label>
      <element-citation publication-type="journal" id="sref21">
        <person-group person-group-type="author">
          <name>
            <surname>Tryka</surname>
            <given-names>K.A.</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Sturcke</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z.Y.</given-names>
          </name>
          <name>
            <surname>Ziyabari</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Popova</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Sharopova</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Kimura</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Feolo</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>NCBI’s database of genotypes and phenotypes: dbGaP</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>42</volume>
        <year>2014</year>
        <fpage>D975</fpage>
        <lpage>D979</lpage>
        <pub-id pub-id-type="pmid">24297256</pub-id>
      </element-citation>
    </ref>
    <ref id="bib22">
      <label>22</label>
      <element-citation publication-type="journal" id="sref22">
        <person-group person-group-type="author">
          <name>
            <surname>Freeberg</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Fromont</surname>
            <given-names>L.A.</given-names>
          </name>
          <name>
            <surname>D’Altri</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Romero</surname>
            <given-names>A.F.</given-names>
          </name>
          <name>
            <surname>Ciges</surname>
            <given-names>J.I.</given-names>
          </name>
          <name>
            <surname>Jene</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kerry</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Moldes</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Ariosa</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Bahena</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The european genome-phenome archive in 2021</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>50</volume>
        <year>2022</year>
        <fpage>D980</fpage>
        <lpage>D987</lpage>
        <pub-id pub-id-type="pmid">34791407</pub-id>
      </element-citation>
    </ref>
    <ref id="bib23">
      <label>23</label>
      <element-citation publication-type="book" id="sref23">
        <person-group person-group-type="author">
          <name>
            <surname>Dwork</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <part-title>Differential privacy</part-title>
        <person-group person-group-type="editor">
          <name>
            <surname>Bugliesi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Preneel</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Sassone</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Wegener</surname>
            <given-names>I.</given-names>
          </name>
        </person-group>
        <source>Automata, Languages and Programming</source>
        <year>2006</year>
        <publisher-name>Springer Berlin Heidelberg</publisher-name>
        <fpage>1</fpage>
        <lpage>12</lpage>
      </element-citation>
    </ref>
    <ref id="bib24">
      <label>24</label>
      <element-citation publication-type="book" id="sref24">
        <person-group person-group-type="author">
          <name>
            <surname>Gentry</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <part-title>Fully homomorphic encryption using ideal lattices</part-title>
        <source>Proceedings of the Forty-First Annual ACM Symposium on Theory of Computing</source>
        <year>2009</year>
        <publisher-name>Association for Computing Machinery</publisher-name>
        <fpage>169</fpage>
        <lpage>178</lpage>
      </element-citation>
    </ref>
    <ref id="bib25">
      <label>25</label>
      <element-citation publication-type="journal" id="sref25">
        <person-group person-group-type="author">
          <name>
            <surname>Lindell</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Secure multiparty computation</article-title>
        <source>Commun. ACM</source>
        <volume>64</volume>
        <year>2020</year>
        <fpage>86</fpage>
        <lpage>96</lpage>
      </element-citation>
    </ref>
    <ref id="bib26">
      <label>26</label>
      <element-citation publication-type="journal" id="sref26">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Shmatikov</surname>
            <given-names>V.</given-names>
          </name>
        </person-group>
        <article-title>Privacy-preserving data exploration in genome-wide association studies</article-title>
        <source>KDD</source>
        <volume>2013</volume>
        <year>2013</year>
        <fpage>1079</fpage>
        <lpage>1087</lpage>
        <pub-id pub-id-type="pmid">26691928</pub-id>
      </element-citation>
    </ref>
    <ref id="bib27">
      <label>27</label>
      <element-citation publication-type="journal" id="sref27">
        <person-group person-group-type="author">
          <name>
            <surname>Uhlerop</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Slavković</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Fienberg</surname>
            <given-names>S.E.</given-names>
          </name>
        </person-group>
        <article-title>Privacy-preserving data sharing for genome-wide association studies</article-title>
        <source>J. Priv. Confid.</source>
        <volume>5</volume>
        <year>2013</year>
        <fpage>137</fpage>
        <lpage>166</lpage>
        <pub-id pub-id-type="pmid">26525346</pub-id>
      </element-citation>
    </ref>
    <ref id="bib28">
      <label>28</label>
      <element-citation publication-type="journal" id="sref28">
        <person-group person-group-type="author">
          <name>
            <surname>Blatt</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Gusev</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Polyakov</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Goldwasser</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Secure large-scale genome-wide association studies using homomorphic encryption</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <volume>117</volume>
        <year>2020</year>
        <fpage>11608</fpage>
        <lpage>11613</lpage>
        <pub-id pub-id-type="pmid">32398369</pub-id>
      </element-citation>
    </ref>
    <ref id="bib29">
      <label>29</label>
      <element-citation publication-type="journal" id="sref29">
        <person-group person-group-type="author">
          <name>
            <surname>Froelicher</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Troncoso-Pastoriza</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Raisaro</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Cuendet</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Sousa</surname>
            <given-names>J.S.</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Fellay</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Hubaux</surname>
            <given-names>J.-P.</given-names>
          </name>
        </person-group>
        <article-title>Truly privacy-preserving federated analytics for precision medicine with multiparty homomorphic encryption</article-title>
        <source>Nat. Commun.</source>
        <volume>12</volume>
        <year>2021</year>
        <fpage>5910</fpage>
        <pub-id pub-id-type="pmid">34635645</pub-id>
      </element-citation>
    </ref>
    <ref id="bib30">
      <label>30</label>
      <element-citation publication-type="journal" id="sref30">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Harmanci</surname>
            <given-names>A.O.</given-names>
          </name>
          <name>
            <surname>Bossuat</surname>
            <given-names>J.-P.</given-names>
          </name>
          <name>
            <surname>Carpov</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Cheon</surname>
            <given-names>J.H.</given-names>
          </name>
          <name>
            <surname>Chillotti</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Froelicher</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Gama</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Georgieva</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrafast homomorphic encryption models enable secure outsourcing of genotype imputation</article-title>
        <source>Cell Syst.</source>
        <volume>12</volume>
        <year>2021</year>
        <fpage>1108</fpage>
        <lpage>1120.e4</lpage>
        <pub-id pub-id-type="pmid">34464590</pub-id>
      </element-citation>
    </ref>
    <ref id="bib31">
      <label>31</label>
      <element-citation publication-type="journal" id="sref31">
        <person-group person-group-type="author">
          <name>
            <surname>Sim</surname>
            <given-names>J.J.</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>F.M.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Meng Tan</surname>
            <given-names>B.H.</given-names>
          </name>
          <name>
            <surname>Mi Aung</surname>
            <given-names>K.M.</given-names>
          </name>
        </person-group>
        <article-title>Achieving GWAS with homomorphic encryption</article-title>
        <source>BMC Med. Genom.</source>
        <volume>13</volume>
        <year>2020</year>
        <fpage>90</fpage>
      </element-citation>
    </ref>
    <ref id="bib32">
      <label>32</label>
      <element-citation publication-type="journal" id="sref32">
        <person-group person-group-type="author">
          <name>
            <surname>Cho</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Secure genome-wide association analysis using multiparty computation</article-title>
        <source>Nat. Biotechnol.</source>
        <volume>36</volume>
        <year>2018</year>
        <fpage>547</fpage>
        <lpage>551</lpage>
        <pub-id pub-id-type="pmid">29734293</pub-id>
      </element-citation>
    </ref>
    <ref id="bib33">
      <label>33</label>
      <element-citation publication-type="journal" id="sref33">
        <person-group person-group-type="author">
          <name>
            <surname>Brisimi</surname>
            <given-names>T.S.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Mela</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Olshevsky</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Paschalidis</surname>
            <given-names>I.C.</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>Federated learning of predictive models from federated electronic health records</article-title>
        <source>Int. J. Med. Inf.</source>
        <volume>112</volume>
        <year>2018</year>
        <fpage>59</fpage>
        <lpage>67</lpage>
      </element-citation>
    </ref>
    <ref id="bib34">
      <label>34</label>
      <element-citation publication-type="journal" id="sref34">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Glicksberg</surname>
            <given-names>B.S.</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Bian</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>Federated learning for healthcare informatics</article-title>
        <source>J. Healthc. Inform. Res.</source>
        <volume>5</volume>
        <year>2021</year>
        <fpage>1</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="pmid">33204939</pub-id>
      </element-citation>
    </ref>
    <ref id="bib35">
      <label>35</label>
      <element-citation publication-type="journal" id="sref35">
        <person-group person-group-type="author">
          <name>
            <surname>Padakanti</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Tiong</surname>
            <given-names>K.-L.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y.-B.</given-names>
          </name>
          <name>
            <surname>Yeang</surname>
            <given-names>C.-H.</given-names>
          </name>
        </person-group>
        <article-title>Genotypes of informative loci from 1000 genomes data allude evolution and mixing of human populations</article-title>
        <source>Sci. Rep.</source>
        <volume>11</volume>
        <year>2021</year>
        <fpage>17741</fpage>
        <lpage>17818</lpage>
        <pub-id pub-id-type="pmid">34493766</pub-id>
      </element-citation>
    </ref>
    <ref id="bib36">
      <label>36</label>
      <element-citation publication-type="journal" id="sref36">
        <person-group person-group-type="author">
          <name>
            <surname>Taliun</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Chothani</surname>
            <given-names>S.P.</given-names>
          </name>
          <name>
            <surname>Schönherr</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Forer</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Boehnke</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G.R.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Laser server: ancestry tracing with genotypes or sequence reads</article-title>
        <source>Bioinformatics</source>
        <volume>33</volume>
        <year>2017</year>
        <fpage>2056</fpage>
        <lpage>2058</lpage>
        <pub-id pub-id-type="pmid">28200055</pub-id>
      </element-citation>
    </ref>
    <ref id="bib37">
      <label>37</label>
      <element-citation publication-type="journal" id="sref37">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Zhan</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G.R.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>Improved ancestry estimation for both genotyping and sequencing data using projection procrustes analysis and genotype imputation</article-title>
        <source>Am. J. Hum. Genet.</source>
        <volume>96</volume>
        <year>2015</year>
        <fpage>926</fpage>
        <lpage>937</lpage>
        <pub-id pub-id-type="pmid">26027497</pub-id>
      </element-citation>
    </ref>
    <ref id="bib38">
      <label>38</label>
      <element-citation publication-type="journal" id="sref38">
        <person-group person-group-type="author">
          <name>
            <surname>Kockan</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Dokmai</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Karpov</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Kulekci</surname>
            <given-names>M.O.</given-names>
          </name>
          <name>
            <surname>Woodruff</surname>
            <given-names>D.P.</given-names>
          </name>
          <name>
            <surname>Sahinalp</surname>
            <given-names>S.C.</given-names>
          </name>
        </person-group>
        <article-title>Sketching algorithms for genomic data analysis and querying in a secure enclave</article-title>
        <source>Nat. Methods</source>
        <volume>17</volume>
        <year>2020</year>
        <fpage>295</fpage>
        <lpage>301</lpage>
        <pub-id pub-id-type="pmid">32132732</pub-id>
      </element-citation>
    </ref>
    <ref id="bib39">
      <label>39</label>
      <element-citation publication-type="journal" id="sref39">
        <person-group person-group-type="author">
          <name>
            <surname>Sadat</surname>
            <given-names>M.N.</given-names>
          </name>
          <name>
            <surname>Al Aziz</surname>
            <given-names>M.M.</given-names>
          </name>
          <name>
            <surname>Mohammed</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>SAFETY: Secure gwas in federated environment through a hybrid solution</article-title>
        <source>IEEE ACM Trans. Comput. Biol. Bioinf</source>
        <volume>16</volume>
        <year>2019</year>
        <fpage>93</fpage>
        <lpage>102</lpage>
      </element-citation>
    </ref>
    <ref id="bib40">
      <label>40</label>
      <element-citation publication-type="journal" id="sref40">
        <person-group person-group-type="author">
          <name>
            <surname>Bates</surname>
            <given-names>D.W.</given-names>
          </name>
          <name>
            <surname>Mächler</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bolker</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Fitting linear mixed-effects models using lme4</article-title>
        <source>BMJ Qual. Saf.</source>
        <volume>24</volume>
        <year>2015</year>
        <fpage>1</fpage>
        <lpage>3</lpage>
      </element-citation>
    </ref>
    <ref id="bib41">
      <label>41</label>
      <element-citation publication-type="journal" id="sref41">
        <person-group person-group-type="author">
          <name>
            <surname>Purcell</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Neale</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Todd-Brown</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>M.A.R.</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Maller</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Sklar</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>de Bakker</surname>
            <given-names>P.I.W.</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Sham</surname>
            <given-names>P.C.</given-names>
          </name>
        </person-group>
        <article-title>PLINK: a tool set for whole-genome association and population-based linkage analyses</article-title>
        <source>Am. J. Hum. Genet.</source>
        <volume>81</volume>
        <year>2007</year>
        <fpage>559</fpage>
        <lpage>575</lpage>
        <pub-id pub-id-type="pmid">17701901</pub-id>
      </element-citation>
    </ref>
    <ref id="bib42">
      <label>42</label>
      <element-citation publication-type="journal" id="sref42">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Privacy-preserving construction of generalized linear mixed model for biomedical computation</article-title>
        <source>Bioinformatics</source>
        <volume>36</volume>
        <year>2020</year>
        <fpage>i128</fpage>
        <lpage>i135</lpage>
        <pub-id pub-id-type="pmid">32657380</pub-id>
      </element-citation>
    </ref>
    <ref id="bib43">
      <label>43</label>
      <element-citation publication-type="journal" id="sref43">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Islam</surname>
            <given-names>M.N.</given-names>
          </name>
          <name>
            <surname>Sheils</surname>
            <given-names>N.E.</given-names>
          </name>
          <name>
            <surname>Buresh</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Schuemie</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Doshi</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Werner</surname>
            <given-names>R.M.</given-names>
          </name>
          <name>
            <surname>Asch</surname>
            <given-names>D.A.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>dPQL: a lossless distributed algorithm for generalized linear mixed model with application to privacy-preserving hospital profiling</article-title>
        <source>J. Am. Med. Inf. Assoc.</source>
        <volume>29</volume>
        <year>2022</year>
        <fpage>1366</fpage>
        <lpage>1371</lpage>
      </element-citation>
    </ref>
    <ref id="bib44">
      <label>44</label>
      <element-citation publication-type="journal" id="sref44">
        <person-group person-group-type="author">
          <name>
            <surname>Breslow</surname>
            <given-names>N.E.</given-names>
          </name>
          <name>
            <surname>Clayton</surname>
            <given-names>D.G.</given-names>
          </name>
        </person-group>
        <article-title>Approximate inference in generalized linear mixed models</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <volume>88</volume>
        <year>1993</year>
        <fpage>9</fpage>
        <lpage>25</lpage>
      </element-citation>
    </ref>
    <ref id="bib45">
      <label>45</label>
      <element-citation publication-type="journal" id="sref45">
        <person-group person-group-type="author">
          <name>
            <surname>Ju</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>L.-L.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Laplace approximation, penalized quasi-likelihood, and adaptive gauss–hermite quadrature for generalized linear mixed models: towards meta-analysis of binary outcome with sparse data</article-title>
        <source>BMC Med. Res. Methodol.</source>
        <volume>20</volume>
        <year>2020</year>
        <fpage>152</fpage>
        <lpage>211</lpage>
        <pub-id pub-id-type="pmid">32539721</pub-id>
      </element-citation>
    </ref>
    <ref id="bib46">
      <label>46</label>
      <element-citation publication-type="journal" id="sref46">
        <person-group person-group-type="author">
          <name>
            <surname>Ziyatdinov</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Vázquez-Santiago</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Brunel</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Martinez-Perez</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Aschard</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Soria</surname>
            <given-names>J.M.</given-names>
          </name>
        </person-group>
        <article-title>lme4qtl: linear mixed models with flexible covariance structure for genetic studies of related individuals</article-title>
        <source>BMC Bioinf.</source>
        <volume>19</volume>
        <year>2018</year>
        <fpage>1</fpage>
        <lpage>5</lpage>
      </element-citation>
    </ref>
    <ref id="bib47">
      <label>47</label>
      <element-citation publication-type="journal" id="sref47">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Harmanci</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Privacy-aware estimation of relatedness in admixed populations</article-title>
        <source>Briefings Bioinf.</source>
        <volume>23</volume>
        <year>2022</year>
        <object-id pub-id-type="publisher-id">bbac473</object-id>
      </element-citation>
    </ref>
    <ref id="bib48">
      <label>48</label>
      <element-citation publication-type="journal" id="sref48">
        <person-group person-group-type="author">
          <name>
            <surname>Homer</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Szelinger</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Redman</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Duggan</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Tembe</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Muehling</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Pearson</surname>
            <given-names>J.V.</given-names>
          </name>
          <name>
            <surname>Stephan</surname>
            <given-names>D.A.</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>S.F.</given-names>
          </name>
          <name>
            <surname>Craig</surname>
            <given-names>D.W.</given-names>
          </name>
        </person-group>
        <article-title>Resolving individuals contributing trace amounts of DNA to highly complex mixtures using high-density SNP genotyping microarrays</article-title>
        <source>PLoS Genet.</source>
        <volume>4</volume>
        <year>2008</year>
        <object-id pub-id-type="publisher-id">e1000167</object-id>
      </element-citation>
    </ref>
    <ref id="bib49">
      <label>49</label>
      <element-citation publication-type="journal" id="sref49">
        <person-group person-group-type="author">
          <name>
            <surname>Hatamizadeh</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Molchanov</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Myronenko</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Dogra</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Flores</surname>
            <given-names>M.G.</given-names>
          </name>
          <name>
            <surname>Kautz</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>H.R.</given-names>
          </name>
        </person-group>
        <article-title>Do gradient inversion attacks make federated learning unsafe?</article-title>
        <source>IEEE Trans. Med. Imag.</source>
        <year>2023</year>
        <fpage>1</fpage>
      </element-citation>
    </ref>
    <ref id="bib50">
      <label>50</label>
      <element-citation publication-type="book" id="sref50">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <part-title>Efficient multi-key homomorphic encryption with packed ciphertexts with application to oblivious neural network inference</part-title>
        <source>Proceedings of the 2019 ACM SIGSAC Conference on Computer and Communications Security</source>
        <year>2019</year>
        <publisher-name>Association for Computing Machinery</publisher-name>
        <fpage>395</fpage>
        <lpage>412</lpage>
      </element-citation>
    </ref>
    <ref id="bib51">
      <label>51</label>
      <element-citation publication-type="journal" id="sref51">
        <person-group person-group-type="author">
          <name>
            <surname>Nasirigerdeh</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Torkzadehmahani</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Matschinske</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Baumbach</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Rueckert</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Kaissis</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Hyfed: A hybrid federated framework for privacy-preserving machine learning</article-title>
        <comment>Preprint at</comment>
        <source>arXiv</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.48550/arXiv.2105.10545</pub-id>
      </element-citation>
    </ref>
    <ref id="bib52">
      <label>52</label>
      <element-citation publication-type="journal" id="sref52">
        <person-group person-group-type="author">
          <name>
            <surname>Bates</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Mächler</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bolker</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Fitting linear mixed-effects models using lme4</article-title>
        <comment>Preprint at</comment>
        <source>arXiv</source>
        <year>2014</year>
        <pub-id pub-id-type="doi">10.48550/arXiv.1406.5823</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="appsec2" sec-type="supplementary-material">
    <title>Supplemental information</title>
    <p id="p0385">
      <supplementary-material content-type="local-data" id="mmc1">
        <caption>
          <title>Document S1. Figures S1–S6 and Tables S1 and S2</title>
        </caption>
        <media xlink:href="mmc1.pdf"/>
      </supplementary-material>
    </p>
  </sec>
  <sec sec-type="data-availability" id="da0010">
    <title>Data and code availability</title>
    <p id="p0025">
      <list list-type="simple" id="olist0010">
        <list-item id="u0025">
          <p id="p0030">All original code has been deposited to github and is publicly available as of the date of publication. Accession link is listed in the <xref rid="sec4.1" ref-type="sec">key resources table</xref>.</p>
        </list-item>
        <list-item id="u0030">
          <label>•</label>
          <p id="p0035">The reference panel is obtained from the 1000 Genomes Project FTP portal at <ext-link ext-link-type="uri" xlink:href="ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/" id="intref0015">ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/</ext-link>.</p>
        </list-item>
        <list-item id="u0035">
          <label>•</label>
          <p id="p0040"><italic>dMEGA</italic> is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Li-Wentao/dMEGA" id="intref0020">https://github.com/Li-Wentao/dMEGA</ext-link>.</p>
        </list-item>
      </list>
    </p>
  </sec>
  <ack id="ack0010">
    <title>Acknowledgments</title>
    <p id="p0365">A.H. was supported by the startup funds from <funding-source id="gs1">University of Texas Health Science Center</funding-source>. X.J. is <funding-source id="gs2"><institution-wrap><institution-id institution-id-type="doi">10.13039/100004917</institution-id><institution>CPRIT</institution></institution-wrap></funding-source> Scholar in <funding-source id="gs3">Cancer Research</funding-source> (RR180012), and he was supported in part by <funding-source id="gs4">Christopher Sarofim Family Professorship</funding-source>, UT Stars award, <funding-source id="gs5"><institution-wrap><institution-id institution-id-type="doi">10.13039/100012615</institution-id><institution>UTHealth</institution></institution-wrap></funding-source> startup, the <funding-source id="gs6"><institution-wrap><institution-id institution-id-type="doi">10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source> (<funding-source id="gs7"><institution-wrap><institution-id institution-id-type="doi">10.13039/100000002</institution-id><institution>NIH</institution></institution-wrap></funding-source>) under award number R01AG066749 and U01TR002062.</p>
    <sec id="sec5">
      <title>Author contributions</title>
      <p id="p0370">A.H., X.J., and H.C. conceived the study. X.J., A.H., and W.L. formulated projection-based covariate calculation and federated association testing framework. W.L. and A.H. wrote the first draft of the manuscript. All authors wrote and approved the final manuscript.</p>
    </sec>
    <sec sec-type="COI-statement" id="sec6">
      <title>Declaration of interests</title>
      <p id="p0375">The authors declare no competing interests.</p>
    </sec>
  </ack>
  <fn-group>
    <fn id="appsec1" fn-type="supplementary-material">
      <p id="p0380">Supplemental information can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.isci.2023.107227" id="intref0060">https://doi.org/10.1016/j.isci.2023.107227</ext-link>.</p>
    </fn>
  </fn-group>
</back>
