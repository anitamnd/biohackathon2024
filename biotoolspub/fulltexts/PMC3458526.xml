<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3458526</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gks457</article-id>
    <article-id pub-id-type="publisher-id">gks457</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Quantifying selection in high-throughput Immunoglobulin sequencing data sets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yaari</surname>
          <given-names>Gur</given-names>
        </name>
        <xref ref-type="aff" rid="gks457-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Uduman</surname>
          <given-names>Mohamed</given-names>
        </name>
        <xref ref-type="aff" rid="gks457-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kleinstein</surname>
          <given-names>Steven H.</given-names>
        </name>
        <xref ref-type="aff" rid="gks457-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gks457-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="gks457-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="gks457-AFF1"><sup>1</sup>Department of Pathology, Yale University School of Medicine, New Haven, CT 06520 and <sup>2</sup>Interdepartmental Program in Computational Biology and Bioinformatics, Yale University, New Haven, CT 06511, USA</aff>
    <author-notes>
      <corresp id="gks457-COR1">*To whom correspondence should be addressed. Tel: <phone>+1 203 785 6685</phone>; Fax: <fax>+1 203 785 6486</fax>; Email: <email>steven.kleinstein@yale.edu</email></corresp>
    </author-notes>
    <!--For NAR both ppub and collection dates generated for PMC processing 1/27/05 beck-->
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>9</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>5</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>5</month>
      <year>2012</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>40</volume>
    <issue>17</issue>
    <fpage>e134</fpage>
    <lpage>e134</lpage>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>1</month>
        <year>2012</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>3</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>4</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2012. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">http://creativecommons.org/licenses/by-nc/3.0</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>High-throughput immunoglobulin sequencing promises new insights into the somatic hypermutation and antigen-driven selection processes that underlie B-cell affinity maturation and adaptive immunity. The ability to estimate positive and negative selection from these sequence data has broad applications not only for understanding the immune response to pathogens, but is also critical to determining the role of somatic hypermutation in autoimmunity and B-cell cancers. Here, we develop a statistical framework for Bayesian estimation of Antigen-driven SELectIoN (BASELINe) based on the analysis of somatic mutation patterns. Our approach represents a fundamental advance over previous methods by shifting the problem from one of simply detecting selection to one of quantifying selection. Along with providing a more intuitive means to assess and visualize selection, our approach allows, for the first time, comparative analysis between groups of sequences derived from different germline V(D)J segments. Application of this approach to next-generation sequencing data demonstrates different selection pressures for memory cells of different isotypes. This framework can easily be adapted to analyze other types of DNA mutation patterns resulting from a mutator that displays hot/cold-spots, substitution preference or other intrinsic biases.</p>
    </abstract>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>Large-scale characterization of B-cell immunoglobulin (Ig) repertoires is now feasible in humans, as well as model systems through the applications of next-generation sequencing approaches (<xref ref-type="bibr" rid="gks457-B1 gks457-B2 gks457-B3">1–3</xref>). During the course of an immune response, B cells that initially bind antigen with low affinity through their Ig receptor are modified by cycles of somatic hypermutation (SHM) and affinity-dependent selection to produce high-affinity memory and plasma cells. This affinity maturation is a critical component of T-cell dependent adaptive immune responses, helps guard against rapidly mutating pathogens and underlies the basis for many vaccines (<xref ref-type="bibr" rid="gks457-B4">4</xref>). Characterizing this mutation and selection process can provide insights into the basic biology that underlies physiological and pathological adaptive immune responses (<xref ref-type="bibr" rid="gks457-B5">5</xref>,<xref ref-type="bibr" rid="gks457-B6">6</xref>), and may further serve as diagnostic or prognostic markers (<xref ref-type="bibr" rid="gks457-B7">7</xref>,<xref ref-type="bibr" rid="gks457-B1">1</xref>). However, analyzing selection in these large datasets, which can contain millions of sequences, presents fundamental challenges requiring the development of new techniques.</p>
    <p>Existing computational methods to detect selection work by comparing the observed frequency of replacement (i.e. non-synonymous) mutations (<inline-formula><inline-graphic xlink:href="gks457i1.jpg"/></inline-formula>) to the expected frequency <inline-formula><inline-graphic xlink:href="gks457i2.jpg"/></inline-formula> with R being the number of replacement mutations and S being the number of silent (i.e. synonymous) mutations. The expectations are calculated based on an underlying targeting model to account for SHM hot/cold-spots and nucleotide substitution bias (<xref ref-type="bibr" rid="gks457-B8">8</xref>). This is critical since these intrinsic biases alone can give the illusive appearance of selection (<xref ref-type="bibr" rid="gks457-B9">9</xref>,<xref ref-type="bibr" rid="gks457-B10">10</xref>). An increased frequency of replacements indicates positive selection, whereas decreased frequencies indicate negative selection. Since the framework region (FWR) provides the structural backbone of the receptor, while contact residues for antigen mainly reside in the complementary determining regions (CDRs), one generally expects to find negative selection in the FWRs and positive selection in the CDRs. The statistical significance is determined by a binomial test (<xref ref-type="bibr" rid="gks457-B5">5</xref>). In this setup, <italic>R</italic> + <italic>S</italic>, <italic>R</italic> and <inline-formula><inline-graphic xlink:href="gks457i3.jpg"/></inline-formula> are the number of trials (<italic>N</italic>), number of successes (<italic>x</italic>) and probability of success (<italic>p</italic>) for the binomial process, respectively. Several variations of this statistical test have been proposed using somewhat different definitions for these parameters [see (<xref ref-type="bibr" rid="gks457-B5">5</xref>,<xref ref-type="bibr" rid="gks457-B8">8</xref>,<xref ref-type="bibr" rid="gks457-B10 gks457-B11 gks457-B12">10–12</xref>) and Table 1 in (<xref ref-type="bibr" rid="gks457-B13">13</xref>)]. We previously developed the Focused-Z test to detect selection with improved specificity and allow for grouping sequences with different baseline probabilities of replacement (<inline-formula><inline-graphic xlink:href="gks457i4.jpg"/></inline-formula>) (<xref ref-type="bibr" rid="gks457-B13">13</xref>). Regardless of the particular approach, it is not possible to use the <italic>P</italic>-value from these statistical tests to compare the extent of selection between experimental groups since lower <italic>P</italic>-values are not equivalent to stronger selection strengths (see for example <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks457/DC1">Supplementary Figure S1</ext-link>). In addition, results are not easily interpretable when analyzing more than a handful of sequences. There are several reasons why selection strengths can differ. For example, positive selection will increase over time as multiple mutations with subtle effects on affinity become fixed in the population. Second, a more highly competitive environment (e.g. with limited survival niches) should produce increased selection strengths. Finally, the observed selection strength can be impacted by alterations in the balance of positive and negative selection. Here we derive a new approach for Bayesian estimation of Antigen-driven SELectIoN (BASELINe) in Ig sequecnes. BASELINe provides a more intuitive means to analyze selection by shifting the problem from one of detecting selection to one of quantifying selection. By operating in log-odds ratio space, the approach also allows, for the first time, comparative analysis between groups of sequences derived from different germline V(D)J segments. An online implementation of our method for BASELINe along with R source code, is available at: <ext-link ext-link-type="uri" xlink:href="http://clip.med.yale.edu/baseline">http://clip.med.yale.edu/baseline</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>MATERIALS AND METHODS</title>
    <p>The workflow begins with a set of Ig sequences along with their associated germlines, which can be determined using available approaches (for example: <xref ref-type="bibr" rid="gks457-B14">14</xref>,<xref ref-type="bibr" rid="gks457-B15">15</xref>). These data are then analyzed in five steps (<xref ref-type="fig" rid="gks457-F1">Figure 1</xref>), which we briefly outline below, and then further expand in subsequent sections:<list list-type="order"><list-item><p><italic>Mutation analysis</italic>: point mutations are identified in each sequence and grouped by location (CDR or FWR) and type (R or S) resulting in four categories (<italic>R</italic><sub>CDR</sub>, <italic>R</italic><sub>FWR</sub>, <italic>S</italic><sub>CDR</sub>, <italic>S</italic><sub>FWR</sub>). The expected number of mutations for each category (<inline-formula><inline-graphic xlink:href="gks457i5.jpg"/></inline-formula>,<inline-formula><inline-graphic xlink:href="gks457i6.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="gks457i7.jpg"/></inline-formula>,<inline-formula><inline-graphic xlink:href="gks457i8.jpg"/></inline-formula>) is then calculated based on an underlying targeting model as described previously (<xref ref-type="bibr" rid="gks457-B13">13</xref>).</p></list-item><list-item><p><italic>Bayesian estimation of replacement frequency (π)</italic>: a posterior probability distribution function (PDF) is calculated for π using a binomial likelihood function and a β prior. The hyperparameters for the β distribution are optimized to estimate selection strength through a numerical approach (see further <xref ref-type="fig" rid="gks457-F2">Figures 2</xref> and <xref ref-type="fig" rid="gks457-F3">3</xref>).</p></list-item><list-item><p><italic>Germline normalization</italic>: the posterior distributions for the replacement frequency (π) are not directly comparable between sequences. High values for one sequence may be low for another, as the expected frequency (<inline-formula><inline-graphic xlink:href="gks457i9.jpg"/></inline-formula>) varies depending on the germline segments (<xref ref-type="fig" rid="gks457-F1">Figure 1</xref>). For that reason, the well-known concept of log-odds ratios is applied to transform the PDF of π into <inline-formula><inline-graphic xlink:href="gks457i10.jpg"/></inline-formula>, which is referred to below as the selection strength. This normalization step allows for direct comparison between sequences with different baseline expected replacement frequencies (<inline-formula><inline-graphic xlink:href="gks457i11.jpg"/></inline-formula>).</p></list-item><list-item><p><italic>Aggregation of results from multiple sequences</italic>: a single PDF for the selection strength is obtained from a group of multiple independent sequences (e.g. collected following a defined treatment). This is accomplished through a fast numerical convolution technique we have developed for this purpose.</p></list-item><list-item><p><italic>Selection detection and comparison between groups</italic>: a numerical integration approach is used to identify differences between selection strength PDFs, allowing for the statistical detection of positive and negative selection and the comparison between two independent sequences or groups of sequences.</p></list-item></list>
<fig id="gks457-F1" position="float"><label>Figure 1.</label><caption><p>BASELINe. (<bold>a</bold>) Summary of the basic work flow. (<bold>b</bold> and <bold>d</bold>) Posterior distributions for the frequency of replacement mutations (π) for hypothetical sequences with the indicated number of replacement (x) and total mutations (N). The shaded area indicates the fraction of the distribution that exceeds the expected frequency (<inline-formula><inline-graphic xlink:href="gks457i12.jpg"/></inline-formula>). (<bold>c</bold> and <bold>e</bold>) The posterior distributions that result after transforming to the Σ-space quantifying selection strength for the same sequences in [b] and [d] respectively.</p></caption><graphic xlink:href="gks457f1"/></fig>
<fig id="gks457-F2" position="float"><label>Figure 2.</label><caption><p>Fitting the hyperparameters of the β prior. The observed and expected selection strengths are compared for different choices of the hyperparameters for the β prior for (<bold>a</bold>) <italic>N</italic> = 1 and (<bold>b</bold>) <italic>N</italic> = 10. In both cases <inline-formula><inline-graphic xlink:href="gks457i13.jpg"/></inline-formula>.</p></caption><graphic xlink:href="gks457f2"/></fig>
<fig id="gks457-F3" position="float"><label>Figure 3.</label><caption><p>The interval of optimal estimation depends on <inline-formula><inline-graphic xlink:href="gks457i14.jpg"/></inline-formula>. The hyperparameters for the Bayesian prior were estimated for each value of N (<italic>N</italic> = 10 here) at <inline-formula><inline-graphic xlink:href="gks457i15.jpg"/></inline-formula> by fitting within the shaded region (<bold>b</bold>). Although the hyperparameters remain fixed, the interval of optimal estimation (shaded) will shift for different values of <inline-formula><inline-graphic xlink:href="gks457i16.jpg"/></inline-formula> [0.25 in (<bold>a</bold>) and 0.75 in (<bold>c</bold>)].</p></caption><graphic xlink:href="gks457f3"/></fig></p>
    <sec>
      <title>Mutation analysis</title>
      <p>The first step in BASELINe involves the analysis of each sequence to: (i) identify the occurrence of point mutations, and (ii) estimate the expected number of mutations. These observed and expected numbers are calculated separately for each mutation type (R and S) and region (CDR and FWR). Mutations within the same codon are considered independently and the germline context is used to determine the mutation type. The observed numbers are used to define the number of trials (<italic>N</italic>) and the number of successes (<italic>x</italic>) in the Binomial formulation, whereas the expected numbers define the Binomial probability of success (<inline-formula><inline-graphic xlink:href="gks457i17.jpg"/></inline-formula>). The precise definition of these relationships depends on the statistical formulation being used as defined in Table 1 from (<xref ref-type="bibr" rid="gks457-B13">13</xref>) . For example, when testing for selection in the CDR using the focused test formulation (used throughout this article), we define <italic>x</italic> as the number of observed replacement mutations in the CDR (<italic>R</italic><sub>CDR</sub>), <italic>N</italic> = <italic>R</italic><sub>CDR</sub> + <italic>S</italic><sub>CDR</sub> + <italic>S</italic><sub>FWR</sub> and <inline-formula><inline-graphic xlink:href="gks457i18.jpg"/></inline-formula><inline-formula><inline-graphic xlink:href="gks457i18a.jpg"/></inline-formula>. When calculating the expectations, we use Equation (<xref ref-type="disp-formula" rid="gks457-M1">1</xref>) (<xref ref-type="bibr" rid="gks457-B13">13</xref>). We derived this formula to fully account for the effects of microsequence specificity (<xref ref-type="bibr" rid="gks457-B16">16</xref>) and also to introduce the well-characterized substitution bias of somatic hypermutation (<xref ref-type="bibr" rid="gks457-B17">17</xref>,<xref ref-type="bibr" rid="gks457-B18">18</xref>). For example, the expected number of R mutations in the CDR (<inline-formula><inline-graphic xlink:href="gks457i19.jpg"/></inline-formula>) is the sum of the product of two factors: (1) the relative probability that a point mutation will fall in the CDR, and (2) the probability that the base substitution results in an amino acid replacement:
<disp-formula id="gks457-M1"><label>(1)</label><graphic xlink:href="gks457m1"/></disp-formula>
where <italic>i</italic> is summed over all positions (excluding gaps and N's) in the region (i.e. CDR or FWR) and <italic>b</italic> over all possible nucleotides ({<italic>A</italic>, <italic>C</italic>, <italic>T</italic>, <italic>G</italic>}). In this equation <inline-formula><inline-graphic xlink:href="gks457i20.jpg"/></inline-formula> is a vector containing the nucleic content of each position in the germline sequence, <inline-formula><inline-graphic xlink:href="gks457i21.jpg"/></inline-formula> is the mutability index for position <italic>i</italic> in germline <inline-formula><inline-graphic xlink:href="gks457i22.jpg"/></inline-formula>, <italic>M</italic><sub><italic>a</italic>→<italic>b</italic></sub> is the relative rate in which nucleotide <italic>a</italic> mutates to <italic>b</italic> (while <italic>M</italic><sub><italic>a</italic>→<italic>a</italic></sub> = 0) and <inline-formula><inline-graphic xlink:href="gks457i23.jpg"/></inline-formula> is an indicator function that is 1 in cases where a mutation in position <italic>i</italic> from <italic>GL</italic>[<italic>i</italic>] to <italic>b</italic> results in a replacement mutation and 0 otherwise. As explained in (<xref ref-type="bibr" rid="gks457-B8">8</xref>), <inline-formula><inline-graphic xlink:href="gks457i24.jpg"/></inline-formula> is calculated by averaging over the relative mutabilities of the three trinucleotide motifs that include the nucleotide <italic>GL</italic>[<italic>i</italic>]. In the present implementation of BASELINe, the relative mutatbilities of each trinucleotide are taken from previous studies (<xref ref-type="bibr" rid="gks457-B16">16</xref>) which calculate these for mouse and human separately and <italic>M</italic><sub><italic>a</italic>→<italic>b</italic></sub> is taken from (<xref ref-type="bibr" rid="gks457-B17">17</xref>). It is important to note that BASELINe could take into account any mutability and substitution matrix: in the case where new studies will come up with more accurate models for somatic hypermutation targeting, the available code could be easily adapted to use them.</p>
    </sec>
    <sec>
      <title>Bayesian estimation of replacement frequency (π)</title>
      <p>Following the mutation analysis step, BASELINe utilizes the observed point mutation pattern along with Bayesian statistics to estimate the posterior distribution for the replacement frequency (<italic>P</italic>(π|<italic>x</italic>)) in each sequence, according to:
<disp-formula id="gks457-M2"><label>(2)</label><graphic xlink:href="gks457m2"/></disp-formula>
where <italic>P</italic>(<italic>x</italic>) is the marginal probability of <italic>x</italic> and can be thought of as a normalization factor. <italic>P</italic>(<italic>x</italic>|π) is a Binomial likelihood function and <italic>P</italic>(π) is a prior distribution. We chose a β prior (β(π|<italic>a</italic>, <italic>b</italic>)) as it forms a conjugate pair with the Binomial likelihood (i.e. using a β prior implies a β posterior).</p>
    </sec>
    <sec>
      <title>Germline normalization</title>
      <p>In order to allow for the comparison between sequences, we use a log-odds ratio formulation and normalize π using its expected value to arrive at an estimate of selection strength: <inline-formula><inline-graphic xlink:href="gks457i25.jpg"/></inline-formula>. Using this formula, positive (negative) values of Σ arise when the estimated replacement-to-silent frequency is higher (lower) than expected, indicating positive (negative) selection. This is why we refer to Σ as the selection strength.</p>
      <p>The PDF for Σ is derived by the following transformation:
<disp-formula id="gks457-M3"><label>(3)</label><graphic xlink:href="gks457m3"/></disp-formula>
where
<disp-formula id="gks457-M4"><label>(4)</label><graphic xlink:href="gks457m4"/></disp-formula>
and <italic>P</italic>(π(Σ)|<italic>x</italic>)<italic>d</italic>π is the β posterior PDF from Equation (<xref ref-type="disp-formula" rid="gks457-M2">2</xref>).</p>
    </sec>
    <sec>
      <title>Aggregation of results from multiple sequences</title>
      <p>While the selection strengths predicted by BASELINe perform well on average, the estimates for individual sequences can be highly variable, especially when the number of mutations is small. Experimentally, many data sets include a mix of sequences with and without detectable selection (<xref ref-type="bibr" rid="gks457-B12">12</xref>,<xref ref-type="bibr" rid="gks457-B19">19</xref>) making interpretation difficult. Therefore, we included in BASELINe a method for aggregating results from multiple sequences to provide a single result. The selection strength PDFs for any two independent sequences [<italic>P</italic><sub>1</sub>(Σ<sub>1</sub>) and <italic>P</italic><sub>2</sub>(Σ<sub>2</sub>)] can be combined using standard numerical convolution to derive the PDF for the sum (Σ<sub>1</sub> + Σ<sub>2</sub>) by the following formula:
<disp-formula id="gks457-M5"><label>(5)</label><graphic xlink:href="gks457m5"/></disp-formula></p>
      <p>Since convolution is an associative operation (the order of more than two consecutive operations does not affect the result), extending this technique to G sequences is straight forward:
<disp-formula id="gks457-M6"><label>(6)</label><graphic xlink:href="gks457m6"/></disp-formula>
This equation can be implemented directly by carrying out G sequential convolution steps from Equation (<xref ref-type="disp-formula" rid="gks457-M5">5</xref>) to arrive at a single PDF estimating the selection strength acting on the G independent sequences. Although numerical convolution is a well-studied problem with highly efficient implementations, these approaches scale poorly when the number of sequences (G) is large, such as for high-throughput sequencing data. The problem is that Σ is a continuous variable, whose PDF is sampled at a finite number of points (<italic>S</italic>), and each convolution step adds more points to the estimated PDF. The complexity of this approach is <inline-formula><inline-graphic xlink:href="gks457i26.jpg"/></inline-formula> where <italic>S</italic> is the number of sampling points in the PDFs and <italic>G</italic> is the number of sequences to combine, leading to unrealisitic computation times for many current data sets. Thus, we developed the following approach to group the posterior PDFs obtained from a large number of individual sequences:<list list-type="order"><list-item><p>First, we recognized that convolution can be carried out efficiently for groups composed of an integer power of two (2<sup><italic>n</italic></sup>) sequences. This is done by: (i) dividing the group into pairs and performing a convolution between each pair (resulting in 2<sup><italic>n</italic>−1</sup> PDFs in 2S + 1 points), (ii) sampling the resulting PDFs in S points, and then (iii) repeating these steps until a single PDF is obtained.</p></list-item><list-item><p>Any arbitrary <italic>G</italic> sequences can be divided into distinct powers of 2: <inline-formula><inline-graphic xlink:href="gks457i27.jpg"/></inline-formula>, where <italic>n</italic><sub><italic>i</italic></sub> are integers and <italic>n</italic><sub>1</sub> &lt; <italic>n</italic><sub>2</sub> &lt; .. &lt; <italic>n</italic><sub><italic>K</italic></sub>. For each group <italic>i</italic>, we calculate a single PDF using the method described in item 1 above for powers of two. These PDFs are then combined serially (<italic>i</italic> = 1 … <italic>K</italic>) using a weighted convolution, with weights that are equal to <inline-formula><inline-graphic xlink:href="gks457i28.jpg"/></inline-formula> for the <italic>i</italic>-th added group. Weighting is implemented by interpolating the next PDF to be included in the convolution at <italic>S</italic>·<italic>w</italic> points. Following the convolution, the PDF is again sampled in S points. Having <italic>w</italic> greater than 1 ensures that we do not lose information in the sampling stage.</p></list-item><list-item><p>It can still be the case that some of the weights are very large [<italic>O</italic>(<italic>G</italic>)] leading to long computation times for the convolution step. For example, if <italic>G</italic> = 1025 and <italic>S</italic> = 4000 (our default value) the approach above will produce a weight of 1024, requiring a convolution between PDFs with 4000 and 4000·1024 points. To overcome this obstacle, we do not divide <italic>G</italic> into distinct powers of 2. Rather, we divide <italic>G</italic> into as many groups of size <inline-formula><inline-graphic xlink:href="gks457i29.jpg"/></inline-formula> as possible, and up to one larger group that may not be a power of 2. Sequences in this larger group are handled as described in item 2 producing a single PDF. The remaining groups that are an integer power of 2 are first combined individually as described in item 1, and then the resulting PDFs are combined using weighted convolution as described in item 2. Finally, these two PDFs are combined using weighted convolution with the weight of the larger group adjusted appropriately for the number of sequences it contains.</p></list-item></list>
This approach decreases the complexity of sequence aggregation by more than a factor of <italic>G</italic>, greatly facilitating the analysis of large data set. The ability to efficiently aggregate results from multiple sequences dramatically increases the statistical power of BASELINe by improving the confidence of the mean estimated selection strength (<inline-formula><inline-graphic xlink:href="gks457i30.jpg"/></inline-formula>, see <xref ref-type="fig" rid="gks457-F4">Figure 4</xref>b and <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks457/DC1">Supplementary Figure S4b</ext-link>).
<fig id="gks457-F4" position="float"><label>Figure 4.</label><caption><p>Simulation-based validation of BASELINe. Ten thousand mutated sequences were generated using a sequence-based simulation starting from the IGHV3-23 germline segment. The mean estimated selection strength obtained by BASELINe was recorded for each sequence. (<bold>a</bold>) The mean of these values along with the 50 and 95% confidence intervals. (<bold>b</bold>) Tighter 95% confidence intervals are obtained by aggregating data from groups of G = 1,2,4,8 or 16 sequences.</p></caption><graphic xlink:href="gks457f4"/></fig></p>
    </sec>
    <sec>
      <title>Selection detection and comparison between groups</title>
      <p>Aggregation provides a single estimate of the selection strength PDF for a group of sequences. Similar to previous methods for detecting selection, BASELINe can use this PDF to supply a single <italic>P</italic>-value for detecting the presence of positive (or negative) selection. This is done by calculating the area under the curve of the selection strength PDF which has positive (or negative) values. However, a different method is needed for comparing two groups, since calculating two <italic>P</italic>-values for the deviations from the null hypothesis (i.e. no selection) for two different groups is not the same as calculating a <italic>P</italic>-value for the equivalence of both groups (<xref ref-type="bibr" rid="gks457-B20">20</xref>). The ability to compare these PDFs across different groups enables important biological question to be addressed. For example, we could compare selection between (i) wild-type and knockout mouse strains showing defects in germinal center formation, (ii) vaccination responses that succeed or fail to generate protective antibody titers, or (iii) autoimmune responses with matched healthy controls. To answer these questions, we compare the two posterior selection strength PDFs (<italic>P</italic><sub>1</sub> and <italic>P</italic><sub>2</sub>) using numerical integration to obtain a (one-sided) <italic>P</italic>-value. Specifically, we calculate the probability that <italic>x</italic><sub>1</sub>, which is a random variable drawn from <italic>P</italic><sub>1</sub>, is larger than <italic>x</italic><sub>2</sub> (drawn from <italic>P</italic><sub>2</sub>). The resulting <italic>P</italic>-value for testing the alternate hypothesis that the selection strength in the group producing <italic>P</italic><sub>1</sub> is larger than that for <italic>P</italic><sub>2</sub> is:
<disp-formula id="gks457-M7"><label>(7)</label><graphic xlink:href="gks457m7"/></disp-formula>
where Θ(<italic>x</italic>) is the Heaviside step function equals to 0 when <italic>x</italic> &lt; 0, 1 when <italic>x</italic> &gt; 0 and 1/2 when <italic>x</italic> = 0.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>RESULTS</title>
    <p>Quantifying selection pressure (with a Bayesian estimate of π or Σ), rather than simply detecting its presence (with a single <italic>P</italic>-value from a binomial test), opens up new possibilities for analysis. The <italic>P</italic>-values that result from previous methods do not provide knowledge about how selection is altered under different experimental conditions because lower <italic>P</italic>-values do not necessarily imply stronger selection. For example, the two hypothetical Ig sequences in <xref ref-type="fig" rid="gks457-F1">Figure 1</xref> b and c were derived from the same germline and thus have the same expected replacement frequency (<inline-formula><inline-graphic xlink:href="gks457i31.jpg"/></inline-formula> = 0.25), but the pattern of accumulated mutations is different. Even though the <italic>P</italic>-value from a binomial-based test of sequence A (plotted in red) is smaller than that for sequence B (plotted in blue), the full posterior PDF reveals stronger selection in sequence B. In this case, the replacement frequencies for these sequences can be directly compared, since the expected replacement frequency is the same for both. This is often the case for experiments using transgenic mice. However, with next-generation sequencing approaches, a mix of sequences from different germlines is often obtained so that replacement frequency estimates are not comparable, even when the overall number of mutations is equivalent. For example, the two hypothetical Ig sequences in <xref ref-type="fig" rid="gks457-F1">Figure 1</xref> d and e have the same pattern of mutations (<italic>x</italic> = 4, <italic>N</italic> = 8), but were derived from non-identical germlines and thus have different underlying expectations (<inline-formula><inline-graphic xlink:href="gks457i32.jpg"/></inline-formula>). While the PDF of the replacement frequency is the same for both sequences, comparing the selection strength, as we propose, clearly shows that the sequences are subject to different selection pressures.</p>
    <sec>
      <title>Fitting the hyperparameters of the Bayesian prior</title>
      <p>As described in ‘Materials and Methods’ section, the Bayesian estimation of replacement frequency utilizes a β prior [Equation (<xref ref-type="disp-formula" rid="gks457-M2">2</xref>)]. The beta prior has two parameters (hyperparameters) <italic>a</italic> and <italic>b</italic>, which yield a beta posterior with parameters <italic>a</italic> + <italic>x</italic> and <italic>b</italic> + <italic>N</italic> − <italic>x</italic>. In principal, many different criteria can be used to fit the hyperparameters using features of the posterior distribution. Here, we applied two constraints to estimate <italic>a</italic> and <italic>b</italic>. First, we require that <italic>a</italic> = <italic>b</italic> &lt; 1, which has been shown to give credential intervals close to the confidence intervals obtained by frequency methods (<xref ref-type="bibr" rid="gks457-B21">21</xref>). Second, we fit the hyperparameters in such a way that the mean of the posterior distribution for selection strength (<inline-formula><inline-graphic xlink:href="gks457i33.jpg"/></inline-formula>) at <inline-formula><inline-graphic xlink:href="gks457i34.jpg"/></inline-formula> will be as close as possible to the actual selection strength (<inline-formula><inline-graphic xlink:href="gks457i35.jpg"/></inline-formula>) for <inline-formula><inline-graphic xlink:href="gks457i36.jpg"/></inline-formula>. This is accomplished through a least-squares minimization procedure, in which <inline-formula><inline-graphic xlink:href="gks457i37.jpg"/></inline-formula> is a weighted average of the means of the posterior PDFs for <italic>x</italic> = 0 … <italic>N</italic>, and the weights are given by the corresponding binomial probabilities [Bin(<italic>x</italic>, <italic>N</italic>, π), where π is calculated from <inline-formula><inline-graphic xlink:href="gks457i38.jpg"/></inline-formula> using Equation (<xref ref-type="disp-formula" rid="gks457-M4">4</xref>)]. Since the hyperparameters depend on the total number of mutations (<italic>N</italic>), our fitting approach provides advantages over choosing a fixed value (<xref ref-type="fig" rid="gks457-F2">Figure 2</xref>). Fitting the hyperparameters is done separately for each value of <italic>N</italic> to obtain <italic>a</italic>(<italic>N</italic>) (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks457/DC1">Supplementary Figure S3</ext-link>). The advantage of requiring <italic>a</italic> = <italic>b</italic> is seen in <xref ref-type="fig" rid="gks457-F3">Figure 3</xref>: once the parameters are chosen (<italic>a</italic> = <italic>b</italic> = 0.686 in this case, <italic>N</italic> = 10), then changing the expected frequency of replacement mutations (<inline-formula><inline-graphic xlink:href="gks457i39.jpg"/></inline-formula>) does not alter the quality of the fit. However, the values of Σ associated with the fitted region will depend on <inline-formula><inline-graphic xlink:href="gks457i40.jpg"/></inline-formula>. If the actual <inline-formula><inline-graphic xlink:href="gks457i41.jpg"/></inline-formula> is smaller (larger) than 0.5 we will gain accuracy for positive (negative) values of Σ but underestimate negative (positive) selection pressures. Thus, our approach is conservative. Outside the region used for fitting (<inline-formula><inline-graphic xlink:href="gks457i42.jpg"/></inline-formula> for <inline-formula><inline-graphic xlink:href="gks457i43.jpg"/></inline-formula>) the proposed approach will underestimate the actual selection pressure, which means BASELINe is also conservative in the limits of large and small selection strengths.</p>
    </sec>
    <sec>
      <title>Simulation-based validation</title>
      <p>We validated BASELINe using a stochastic simulation approach. The advantage of using simulated data is that the underlying biological parameters controlling mutation and selection are all known precisely, and can be set to explore a wide range of biological conditions. We first sought to validate BASELINe using mutation data simulated by a generic binomial process. In this case, mutations are generated directly by applying the Binomial distribution to determine the number of replacement mutations (<italic>x</italic>) for a fixed number of total mutations (<italic>N</italic>). In each simulation <italic>x</italic> is drawn from a Binomial probability with parameters <italic>N</italic> and π<sub>expected</sub>, where π<sub>expected</sub> is defined by Equation (<xref ref-type="disp-formula" rid="gks457-M4">4</xref>) and <inline-formula><inline-graphic xlink:href="gks457i44.jpg"/></inline-formula>. For each <inline-formula><inline-graphic xlink:href="gks457i45.jpg"/></inline-formula>, 10 000 simulations were run and the resulting mutation pattern was used as input to BASELINe in order to estimate the selection strength PDF. By taking the mean of each PDF, we calculated the average selection strength for each <inline-formula><inline-graphic xlink:href="gks457i46.jpg"/></inline-formula> (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks457/DC1">Supplementary Figure S4a</ext-link>). The actual biological processes of somatic hypermutation and selection do not precisely conform to a binomial process. To account for these features, we further tested BASELINe using data from a sequence-based simulation (R source code is available through the BASELINe website). In this case, mutations are introduced into actual Ig sequences in a way that allows different selection strengths in CDR (Σ<sub>CDR</sub>) and FWR (Σ<sub>FWR</sub>). The simulation is initiated with a single IMGT formatted Ig V germline sequence. Mutations are introduced one-by-one along the entire length of the sequence (excluding gaps) in two steps. First, the position is chosen stochastically based on the microsequence specificity of each nucleotide to account for hot/cold-spots (<xref ref-type="bibr" rid="gks457-B16">16</xref>). Second, the particular substitution is probabilistically determined accounting for transition bias (<xref ref-type="bibr" rid="gks457-B17">17</xref>). Selection is implemented by specifying selection strengths independently for CDR (<inline-formula><inline-graphic xlink:href="gks457i47.jpg"/></inline-formula>) and FWR (<inline-formula><inline-graphic xlink:href="gks457i48.jpg"/></inline-formula>). These selection strengths are translated into R frequencies (π) for each region (CDR and FWR) according to Equation (<xref ref-type="disp-formula" rid="gks457-M4">4</xref>). For each region, we then uniformly alter the probability of all possible R mutations in order to achieve the specified R frequency. For example, Σ<sub>CDR</sub> values of − 1, 0 and 1 yield synthetic data with negative, neutral and positive selection in the CDR, respectively. To validate BASELINe, we simulated sequences with strong negative selection in the FWR (Σ<sub>FWR</sub> = −1) and varied the extent of positive selection in the CDR (Σ<sub>CDR</sub>). BASELINe was used to quantify the selection strength in the CDR. By comparing expected and observed selection strengths, one can see that the approach yields tight estimates and, as designed, is conservative at the strongest selection strengths for both positive and negative selection (<xref ref-type="fig" rid="gks457-F4">Figure 4</xref>a).</p>
    </sec>
    <sec>
      <title>Example applications</title>
      <p>To illustrate the types of insights that can be gained, we analyzed two sets of experimental data. The first data set comes from a study comparing B-cell affinity maturation in IgH transgenic mice where the heavy chain receptor is fixed to encode moderate (<italic>B</italic>1 − 8) or very low (<italic>V</italic>23) affinity antibodies when paired with an endogenous λ1 light chain. These data are described in (<xref ref-type="bibr" rid="gks457-B19">19</xref>). Briefly, sequences from each of 166 B-cell clones were collected through microdissection of splenic Germinal Centers at days 10 and 16 post-immunization with nitrophenyl. Clonality of the sequences was determined as described in (<xref ref-type="bibr" rid="gks457-B8">8</xref>). Since mutation is restricted to the λ light chain, this provides an ideal system to study antigen-driven selection where all the selection pressure rests solely on the variable domain of the λ light chain. The sequences were grouped by mouse genotype and day post-immunization. The results of applying BASELINe to the entire Ig sequence, spanning the V and J regions, clearly show positive selection in the CDR for both genotypes. Most importantly, we can now compare the selection strengths in these two mice. Looking at <xref ref-type="fig" rid="gks457-F5">Figure 5</xref>a, we do not observe significantly different selection strengths between these mice, suggesting that the selection process can operate independently of the germline receptor affinity.
<fig id="gks457-F5" position="float"><label>Figure 5.</label><caption><p>Applications of BASELINe to estimate selection strength from real data. (<bold>a</bold>) Posterior probability distributions for Ig sequences from two mice strains with moderate (B1-8) or low (V23) initial affinity for the immunizing antigen at different days post-immunization (10 and 16) (<xref ref-type="bibr" rid="gks457-B19">19</xref>). (<bold>b</bold> and <bold>c</bold>) Posterior probability distributions for different memory cell subsets (b) or the three most frequent IGHV families (c) for data in (<xref ref-type="bibr" rid="gks457-B2">2</xref>). The top half of each plot shows the estimated selection strength in the CDR, whereas the bottom part provides an estimate for FWR.</p></caption><graphic xlink:href="gks457f5"/></fig></p>
      <p>The second data set comes from a next-generation sequencing study of the Ig heavy chain repertoire from the blood of three healthy individuals. These data are described in (<xref ref-type="bibr" rid="gks457-B2">2</xref>). Briefly, five B cell types (transitional, naïve, IgM memory, IgA memory and IgG memory) were sorted from peripheral blood mononuclear cell (PBMCs) of three healthy adults. High-throughput sequencing of these cells was carried out to generate 3577 Ig heavy chain sequences after filtering for quality and picking one sequence to represent each clone (<xref ref-type="bibr" rid="gks457-B2">2</xref>). We additionally removed sequences that were identified as non-functional, or had more than 50 point mutations according to IMGT High V-Quest (<xref ref-type="bibr" rid="gks457-B14">14</xref>), resulting in a dataset containing 880 sequences from memory cells. These sequences were grouped by individual, cell type and IGHV germline segment family for analysis of the V and J regions [the D segment and surrounding N and P additions were excluded due to uncertainty in the germline assignment (<xref ref-type="bibr" rid="gks457-B15">15</xref>)]. <xref ref-type="fig" rid="gks457-F5">Figure 5</xref>b shows that all memory isotypes are subject to significant negative selection in the FWR, but the selection strength is stronger in IgM compared with IgG and IgA memory cells (although the difference is only significant for IgA, <italic>P</italic> = 0.02). Weaker negative selection for IgG and IgA could reflect a higher starting affinity for these cells (allowing them to be more tolerant of affinity-decreasing mutations), or positive selection for some mutations in the FWR region. While the latter hypothesis is supported by the observation that these isotypes show a trend towards increased selection strengths in the CDR, we did not detect statistically significant differences in the CDR selection strength PDFs for any of the memory cell isotypes. Taken together, this pattern suggests that IgM memory cells are formed earlier in the germinal center reaction. Wu <italic>et al.</italic> (<xref ref-type="bibr" rid="gks457-B2">2</xref>) were able to identify significant differences in the repertoire composition of IgM and class-switched memory cells. The ability to combine data from different germline segments allows us to extend these observations by showing that the differences in selection strength that we observe for the isotypes are driven by variation in selection strengths of each germline family, with IGHV3 contributing much of the CDR positive selection observed in IgM and IgA memory cells (Figure <xref ref-type="fig" rid="gks457-F5">5</xref>c and <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks457/DC1">Supplementary Figure S6</ext-link>).</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>DISCUSSION</title>
    <p>We have developed BASELINe, a Bayesian framework for quantifying immune selection that can be applied to large-scale B-cell Ig sequence data sets. When combined with the dramatic improvements being made in high-throughput sequencing, BASELINe opens exciting possibilities for the future analysis of B-cell repertoires. Since new data sets are likely to include orders of magnitude increases in the number of sequences, we have developed an optimized code implementing BASELINe. Benchmarking results indicate that 10 000 sequences can be analyzed in 4 min on a single 1.73 GHz processor (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks457/DC1">Supplementary Figure S8</ext-link>), which means a complete human repertoire analysis is feasible.</p>
    <p>The framework developed here is quite general, and can easily be extended. First, selection strength can be defined based on patterns other than the replacement frequency. For example, it has been suggested that selection impacts the frequency of non-conservative mutations (i.e. those that change the amino acid property) even beyond the number of replacement mutations (<xref ref-type="bibr" rid="gks457-B22">22</xref>). This could be implemented simply by changing the definition of which nucleotide exchanges constitute replacement mutations.</p>
    <p>Second, BASELINe can be adapted to other biological questions. At its core, our method quantifies the deviation from the expectation of repeated independent binomial variables, each of which has a different probability of success. This allows a wide range of problems to be addressed by re-defining replacement and silent mutations as arbitrary sets of positions/substitutions. As one such example, the framework can be used to quantify strand-bias for AID, which targets cytosines (C) for mutation. This is done by re-defining all mutations at C to be replacements and all mutations at guanine to be silent. In this formulation, positive selection indicates a coding-strand bias, whereas negative selection would indicate a non-coding-strand bias. Existing methods for testing strand-bias are limited since they do not account for the full range of hot/cold-spots and variation across germline segments (<xref ref-type="bibr" rid="gks457-B18">18</xref>,<xref ref-type="bibr" rid="gks457-B23">23</xref>,<xref ref-type="bibr" rid="gks457-B24">24</xref>).</p>
    <p>In summary, we have developed a framework for analyzing arbitrary DNA mutation patterns in the context of a mutator that displays intrinsic biases (i.e. hot/cold-spots and substitution preference). This approach was implemented for Bayesian estimation of Antigen-driven SELectIoN (BASELINe) in large-scale immunoglobulin sequence datasets, which are becoming increasingly common with the advent of next-generation sequencing. In the future, the approach may also be extended to take advantage of the information that exists in sequence abundance distributions within each clone to assess selection strength from all available sequences (<xref ref-type="bibr" rid="gks457-B25">25</xref>). Looking beyond the analysis of immune selection, the basic framework underlying BASELINe might be adapted to quantify selection acting on viral sequences. BASELINe is available at: <ext-link ext-link-type="uri" xlink:href="http://clip.med.yale.edu/baseline">http://clip.med.yale.edu/baseline</ext-link>.</p>
  </sec>
  <sec>
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks457/DC1">Supplementary Data</ext-link> are available at NAR Online: Supplementary Figures 1–8.</p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p><funding-source>National Institutes of Health</funding-source> (NIH) [<award-id>R03AI092379-01</award-id> to S.H.K.]; <funding-source>Yale University Biomedical High Performance Computing Center (NIH)</funding-source> [<award-id>RR19895</award-id>]. Funding for open access charge: <funding-source>NIH</funding-source> [<award-id>R03AI092379-01</award-id>].</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_40_17_e134__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gks457_nar-00215-met-n-2012-File008.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We would like to thank Mark Shlomchik and Debra Dunn-Walters for providing data. We also thank the Yale University Biomedical High Performance Computing Center for use of their computational resources. We would also like to thank Yoram Louzoun, Uri Hershberg and Daniel Gadala-Maria for helpful conversations.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="gks457-B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boyd</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Merker</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Maniar</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>LN</given-names>
          </name>
          <name>
            <surname>Sahaf</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Simen</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Hanczaruk</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>KD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Measurement and clinical monitoring of human lymphocyte clonality by massively parallel VDJ pyrosequencing</article-title>
        <source>Sci. Transl. Med.</source>
        <year>2009</year>
        <volume>1</volume>
        <fpage>12ra23</fpage>
      </element-citation>
    </ref>
    <ref id="gks457-B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Kipling</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Leong</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ademokun</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Dunn-Walters</surname>
            <given-names>DK</given-names>
          </name>
        </person-group>
        <article-title>High throughput immunoglobulin repertoire analysis distinguishes between human IgM memory and switched memory b cell populations</article-title>
        <source>Blood.</source>
        <year>2010</year>
        <volume>116</volume>
      </element-citation>
    </ref>
    <ref id="gks457-B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Weinstein</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Penland</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Determinism and stochasticity during maturation of the zebrafish antibody repertoire</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>2011</year>
        <volume>108</volume>
        <fpage>5348</fpage>
        <lpage>5353</lpage>
        <pub-id pub-id-type="pmid">21393572</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Longo</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Lipsky</surname>
            <given-names>PE</given-names>
          </name>
        </person-group>
        <article-title>Why do b cells mutate their immunoglobulin receptors?</article-title>
        <source>Trends Immunol.</source>
        <year>2006</year>
        <volume>27</volume>
        <fpage>374</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="pmid">16809065</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shlomchik</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Marshak-Rothstein</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wolfowicz</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Rothstein</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Weigert</surname>
            <given-names>MG</given-names>
          </name>
        </person-group>
        <article-title>The role of clonal selection and somatic mutation in autoimmunity</article-title>
        <source>Nature</source>
        <year>1987</year>
        <volume>328</volume>
        <fpage>805</fpage>
        <lpage>811</lpage>
        <pub-id pub-id-type="pmid">3498121</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lossos</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Okada</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Warnke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vose</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Greiner</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Levy</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Molecular analysis of immunoglobulin genes in diffuse large b-cell lymphomas</article-title>
        <source>Blood</source>
        <year>2000</year>
        <volume>95</volume>
      </element-citation>
    </ref>
    <ref id="gks457-B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rosenquist</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ghia</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Belessi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stamatopoulos</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Determination of IGHV gene mutational status in chronic lymphocytic leukemia: bioinformatics advances meet clinical needs</article-title>
        <source>Leukemia</source>
        <year>2007</year>
        <volume>22</volume>
        <fpage>212</fpage>
        <lpage>214</lpage>
        <pub-id pub-id-type="pmid">17914413</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hershberg</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Uduman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shlomchik</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Kleinstein</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>Improved methods for detecting selection by mutation analysis of IG V region sequences</article-title>
        <source>Int. Immunol.</source>
        <year>2008</year>
        <volume>20</volume>
        <fpage>683</fpage>
        <lpage>694</lpage>
        <pub-id pub-id-type="pmid">18397909</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dunn-Walters</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Spencer</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Strong intrinsic biases towards mutation and conservation of bases in human IgVH genes during somatic hypermutation prevent statistical analysis of antigen selection</article-title>
        <source>Immunology</source>
        <year>1998</year>
        <volume>95</volume>
        <fpage>339</fpage>
        <lpage>345</lpage>
        <pub-id pub-id-type="pmid">9824495</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bose</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sinha</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Problems in using statistical analysis of replacement and silent mutations in antibody genes for determining antigendriven affinity selection</article-title>
        <source>Immunology</source>
        <year>2005</year>
        <volume>116</volume>
        <fpage>172</fpage>
        <lpage>183</lpage>
        <pub-id pub-id-type="pmid">16162266</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Casali</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The CDR1 sequences of a major proportion of human germline IG vh genes are inherently susceptible to amino acid replacement</article-title>
        <source>Immunol. Today</source>
        <year>1994</year>
        <volume>15</volume>
        <fpage>367</fpage>
        <lpage>373</lpage>
        <pub-id pub-id-type="pmid">7916950</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lossos</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Narasimhan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Levy</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The inference of antigen selection on ig genes</article-title>
        <source>J. Immunol.</source>
        <year>2000</year>
        <volume>165</volume>
        <fpage>5122</fpage>
        <lpage>5126</lpage>
        <pub-id pub-id-type="pmid">11046043</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Uduman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yaari</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hershberg</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Stern</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Shlomchik</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Kleinstein</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>Detecting selection in immunoglobulin sequences</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>W499</fpage>
        <lpage>W504</lpage>
        <pub-id pub-id-type="pmid">21665923</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brochet</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lefranc</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Giudicelli</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>IMGT/V-QUEST: the highly customized and integrated system for IG and TR standardized V-J and V-D-J sequence analysis</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>W503</fpage>
        <lpage>W508</lpage>
        <pub-id pub-id-type="pmid">18503082</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gata</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Malming</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>KJL</given-names>
          </name>
          <name>
            <surname>Bain</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>iHMMune-align: hidden markov model-based alignment and identification of germline genes in rearranged immunoglobulin gene sequences</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>1580</fpage>
        <lpage>1587</lpage>
        <pub-id pub-id-type="pmid">17463026</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shapiro</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Ellison</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Wysocki</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Sequence-specific targeting of two bases on both DNA strands by the somatic hypermutation mechanism</article-title>
        <source>Mol. Immunol.</source>
        <year>2003</year>
        <volume>40</volume>
        <fpage>287</fpage>
        <lpage>295</lpage>
        <pub-id pub-id-type="pmid">12943801</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Creadon</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jena</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Portanova</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Kotzin</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Wysocki</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Di- and trinucleotide target preferences of somatic mutagenesis in normal and autoreactive B cells</article-title>
        <source>J. Immunol.</source>
        <year>1996</year>
        <volume>156</volume>
        <fpage>2642</fpage>
        <lpage>2652</lpage>
        <pub-id pub-id-type="pmid">8786330</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cowell</surname>
            <given-names>LG</given-names>
          </name>
          <name>
            <surname>Kepler</surname>
            <given-names>TB</given-names>
          </name>
        </person-group>
        <article-title>The nucleotide-replacement spectrum under somatic hypermutation exhibits microsequence dependence that is strand-symmetric and distinct from that under germline mutation</article-title>
        <source>J. Immunol.</source>
        <year>2000</year>
        <volume>164</volume>
        <fpage>1971</fpage>
        <lpage>1976</lpage>
        <pub-id pub-id-type="pmid">10657647</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Khalil</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Uduman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hershberg</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Louzoun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Haberman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Kleinstein</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Shlomchik</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Taking advantage: High-Affinity B cells in the germinal center have lower death rates, but similar rates of division, compared to low-affinity cells</article-title>
        <source>J. Immunol.</source>
        <year>2009</year>
        <volume>183</volume>
        <fpage>7314</fpage>
        <lpage>7325</lpage>
        <pub-id pub-id-type="pmid">19917681</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nieuwenhuis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Forstmann</surname>
            <given-names>BU</given-names>
          </name>
          <name>
            <surname>Wagenmakers</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <article-title>Erroneous analyses of interactions in neuroscience: a problem of significance</article-title>
        <source>Nat. Neurosci.</source>
        <year>2011</year>
        <volume>14</volume>
        <fpage>1105</fpage>
        <lpage>1107</lpage>
        <pub-id pub-id-type="pmid">21878926</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Agresti</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Min</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Frequentist performance of bayesian confidence intervals for comparing proportions in 2 × 2 contingency tables</article-title>
        <source>Biometrics</source>
        <year>2005</year>
        <volume>61</volume>
        <fpage>515</fpage>
        <lpage>523</lpage>
        <pub-id pub-id-type="pmid">16011699</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hershberg</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Shlomchik</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Differences in potential for amino acid change after mutation reveals distinct strategies for and light-chain variation</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>2006</year>
        <volume>103</volume>
        <fpage>15963</fpage>
        <lpage>15968</lpage>
        <pub-id pub-id-type="pmid">17038496</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>MacCarthy</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Roa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Scharff</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Shmtool: a webserver for comparative analysis of somatic hypermutation datasets</article-title>
        <source>DNA Repair.</source>
        <year>2009</year>
        <volume>8</volume>
        <fpage>137</fpage>
        <lpage>141</lpage>
        <pub-id pub-id-type="pmid">18952008</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Milstein</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Neuberger</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Staden</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Both DNA strands of antibody genes are hypermutation targets</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>1998</year>
        <volume>95</volume>
        <fpage>8791</fpage>
        <lpage>8794</lpage>
        <pub-id pub-id-type="pmid">9671757</pub-id>
      </element-citation>
    </ref>
    <ref id="gks457-B25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sella</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hirsh</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>The application of statistical physics to evolutionary biology</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>9541</fpage>
        <lpage>9546</lpage>
        <pub-id pub-id-type="pmid">15980155</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
