<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4155083</article-id>
    <article-id pub-id-type="pmid">25103980</article-id>
    <article-id pub-id-type="publisher-id">6554</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-15-268</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PhylDiag: identifying complex synteny blocks that include tandem duplications using phylogenetic gene trees</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lucas</surname>
          <given-names>Joseph MEX</given-names>
        </name>
        <address>
          <email>jlucas@ens.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Muffato</surname>
          <given-names>Matthieu</given-names>
        </name>
        <address>
          <email>muffato@ebi.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff4"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Crollius</surname>
          <given-names>Hugues Roest</given-names>
        </name>
        <address>
          <email>hrc@ens.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <aff id="Aff1"><label/>Ecole Normale Supérieure, Institut de Biologie de l’ENS, IBENS, 46 rue d’Ulm, 75005 Paris, France </aff>
      <aff id="Aff2"><label/>CNRS, UMR 8197, 75005 Paris, France </aff>
      <aff id="Aff3"><label/>Inserm, U1024, 75005 Paris, France </aff>
      <aff id="Aff4"><label/>Wellcome Trust Genome Campus, The EMBL-European Bioinformatics Institute, Düsternbrooker Weg 20, CB10 1SD Hinxton, Cambridge UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <volume>15</volume>
    <issue>1</issue>
    <elocation-id>268</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>3</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>7</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Lucas et al.; licensee BioMed Central Ltd. 2014</copyright-statement>
      <license license-type="open-access">
        <license-p>This article is published under license to BioMed Central Ltd. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Extant genomes share regions where genes have the same order and orientation, which are thought to arise from the conservation of an ancestral order of genes during evolution. Such regions of so-called conserved synteny, or synteny blocks, must be precisely identified and quantified, as a prerequisite to better understand the evolutionary history of genomes.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Here we describe PhylDiag, a software that identifies statistically significant synteny blocks in pairwise comparisons of eukaryote genomes. Compared to previous methods, PhylDiag uses gene trees to define gene homologies, thus allowing gene deletions to be considered as events that may break the synteny. PhylDiag also accounts for gene orientations, blocks of tandem duplicates and lineage specific de novo gene births. Starting from two genomes and the corresponding gene trees, PhylDiag returns synteny blocks with gaps less than or equal to the maximum gap parameter <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>. This parameter is theoretically estimated, and together with a utility to graphically display results, contributes to making PhylDiag a user friendly method. In addition, putative synteny blocks are subject to a statistical validation to verify that they are unlikely to be due to a random combination of genes.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>We benchmark several known metrics to measure 2D-distances in a matrix of homologies and we compare PhylDiag to i-ADHoRe 3.0 on real and simulated data. We show that PhylDiag correctly identifies small synteny blocks even with insertions, deletions, incorrect annotations or micro-inversions. Finally, PhylDiag allowed us to identify the most relevant distance metric for 2D-distance calculation between homologies.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/1471-2105-15-268) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Comparative genomics</kwd>
      <kwd>Synteny</kwd>
      <kwd>Synteny block</kwd>
      <kwd>Segmental homologies</kwd>
      <kwd>Homology</kwd>
      <kwd>Gene order</kwd>
      <kwd>Rearrangement</kwd>
      <kwd>Ancestral genome</kwd>
      <kwd>Gene tree</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2014</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Changes in the order of genes in a genome are caused by two categories of mutational events: genic events, which include de novo gene births, deletions, duplications, and genomic rearrangements, which include chromosome fusions and fissions, segmental translocations or segmental inversions. Synteny blocks are composed of those genes that retain an ancestral organisation despite these events, and one way to understand how genic events and genomic rearrangements affect genome evolution is to identify such synteny blocks. The extremities of synteny blocks also define the positions of breakpoints where rearrangements took place. Precisely defining synteny blocks thus allows, in turn, an accurate definition of breakpoints [<xref ref-type="bibr" rid="CR1">1</xref>], which has important implications from ancestral genome reconstruction [<xref ref-type="bibr" rid="CR2">2</xref>] to the understanding of genome mutational processes in healthy and disease states [<xref ref-type="bibr" rid="CR3">3</xref>]. In addition, it has been shown in eukaryotes that some synteny blocks may be under negative selection due to long-range functional constraints between genes and regulatory elements [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p>Several methods have been developed to identify synteny blocks from extant chromosomes comparisons. In the field of bacterial genome evolution, algorithms tend to focus on the notion of “gene team” [<xref ref-type="bibr" rid="CR6">6</xref>], which denotes a set of genes that stay in the vicinity of each other with no constraint on gene order. Such methods include TEAM [<xref ref-type="bibr" rid="CR7">7</xref>], HomologyTeams [<xref ref-type="bibr" rid="CR8">8</xref>], CCCPart [<xref ref-type="bibr" rid="CR9">9</xref>], CloseUp [<xref ref-type="bibr" rid="CR10">10</xref>] and MCMuSeC [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p>However, because gene order conservation in eukaryotes is stronger [<xref ref-type="bibr" rid="CR12">12</xref>] compared to bacteria, algorithms that infer synteny blocks in eukaryotes tend to account for this extra constraint. GRIMM-synteny [<xref ref-type="bibr" rid="CR13">13</xref>], i-ADHoRe 3.0 (often just called ADHoRe later) [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR17">17</xref>], DiagHunter [<xref ref-type="bibr" rid="CR18">18</xref>], LineUp [<xref ref-type="bibr" rid="CR19">19</xref>], FISH [<xref ref-type="bibr" rid="CR20">20</xref>], DAGchainer [<xref ref-type="bibr" rid="CR21">21</xref>], SyMAP [<xref ref-type="bibr" rid="CR22">22</xref>], ColinearScan [<xref ref-type="bibr" rid="CR23">23</xref>], Cinteny [<xref ref-type="bibr" rid="CR24">24</xref>], OrthoCluster [<xref ref-type="bibr" rid="CR25">25</xref>], Syntenator [<xref ref-type="bibr" rid="CR26">26</xref>] and Cyntenator [<xref ref-type="bibr" rid="CR27">27</xref>], MCScan [<xref ref-type="bibr" rid="CR28">28</xref>] and MCScanX [<xref ref-type="bibr" rid="CR29">29</xref>], Enredo [<xref ref-type="bibr" rid="CR30">30</xref>], and DRIMM-Synteny [<xref ref-type="bibr" rid="CR31">31</xref>] are the main algorithms developed to infer synteny blocks in eukaryotes. Many were applied to model species such as <italic>Arabidopsis thaliana</italic> and rice, among plants, and mammals such as human, mouse, dog and rat, among metazoans. These algorithms can be broadly classified according to their heuristic and features.</p>
    <p>Four distinct heuristics are used to infer synteny blocks. The first builds two-dimensional matrices filled with homologies [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. The algorithms analyse the matrices with procedures that resemble those developed in the field of image analysis.</p>
    <p>A second heuristic uses optimisation techniques and dynamic programming [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. Many of the methods that fall in this category are greedy, although with the benefit of often providing more flexibility. Indeed, the choice of the cost parameters in the objective function, allows the user to accurately account for different synteny block characteristics. A third heuristic is based on a modification of the Smith-Waterman [<xref ref-type="bibr" rid="CR32">32</xref>] approach [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] while the last type of heuristic relies on graph editing [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>].</p>
    <p>Some algorithms compare genomes by performing pairwise comparisons of genomes whereas others perform multi-genomes comparisons. Combining pairwise comparisons does not capture the additional significance of genes that are conserved in more than two regions, resulting in under-estimation of cluster significance [<xref ref-type="bibr" rid="CR33">33</xref>]. Multi-genomes comparisons are especially relevant for highly diverged synteny blocks and Whole Genome Duplication (WGD) analysis. However, multi-genomes comparisons usually require genomes to be reduced to a set of markers shared between all genomes, thus limiting the resolution of the analysis.</p>
    <p>The transcriptional orientations of genes on the chromosome are used by some algorithms and provide informations about micro-rearrangements and may contribute to making the correct choice when there are several possibilities to extend a synteny block. In addition, accounting for gene orientations increases the statistical relevance of small synteny blocks, see [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 11].</p>
    <p>Gene duplications increase the complexity of identifying synteny blocks. Duplications can be dispersed, or in tandem when the two copies are adjacent. Tandem duplications create blocks of tandem duplicates that disrupt local gene adjacencies without strictly breaking the synteny. In order to overcome blocks of tandem duplicates, algorithms may propose to collapse tandem duplicates into one occurrence by remapping their coordinates [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] or by performing ad hoc editions of the graph of adjacencies [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. WGDs complicate matters further when new genes copies have been randomly inactivated throughout the genome. Yet some algorithms identify highly diverged synteny blocks or double conserved syntenies caused by WGDs [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR19">19</xref>].</p>
    <p>Once an algorithm has returned putative synteny blocks, a statistical validation can assess their relevance given the input data. A putative synteny block is more likely to be found by chance in a comparison involving a large number of homologies than when few homologies are available. A putative synteny block is also less likely to have occurred by chance if it is composed of a large number of ordered adjacent homologies than if it is composed of a few unordered homologies separated by gaps. Statistical validation may involve either a p-value, an e-value or a score. The analytical calculation is not a simple task [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR33">33</xref>–<xref ref-type="bibr" rid="CR36">36</xref>] and there is no standard p-value yet established in the field. Simulations are often used to bypass this difficulty, although they are usually time consuming and not very realistic.</p>
    <p>To infer a synteny block, each algorithm uses parameters such as the maximum gap <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> to define the maximum allowed distance between two genes in a synteny block. The <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> parameter value can be optimised through a theoretical exploration, saving the need to test numerous different values before finding the optimal value [<xref ref-type="bibr" rid="CR23">23</xref>].</p>
    <p>Another important variable is the metric used to allow gaps between genes within a synteny block. Some algorithms use the Diagonal Pseudo Distance [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>] whereas others use the Manhattan Distance [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR24">24</xref>].</p>
    <p>Finally, a useful feature is to represent synteny blocks graphically, such as diagonals in a matrix [<xref ref-type="bibr" rid="CR18">18</xref>], circular views [<xref ref-type="bibr" rid="CR29">29</xref>] or alignments [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR29">29</xref>].</p>
    <p>Here, we are interested in reconstructing synteny blocks to capture the signals of ancestral gene order and gene orientations in eukaryotic genomes. To this end, we developed PhylDiag, a user-friendly method to identify synteny blocks between two genomes using reconstructed phylogenetic gene trees. The full evolutionary history of each ancestral gene is taken into account in the form of those phylogenetic gene trees, which include in particular gene losses, duplications, 1:1 but also 1:many and many:many homology relationships. All PhylDiag parameters can either be set automatically or be specified by the user. A p-value calculation provides a statistical basis to select significant blocks and a utility provides graphical representations of identified synteny blocks. Users may also chose among several metrics to allow gene gaps within a synteny block. PhylDiag accounts for tandem duplications and gene orientations, and is thus able to accurately identify small synteny blocks. Among algorithms that already account for gene order and gene orientations, only i-ADHoRe 3.0, FISH and Enredo also handle tandem duplications, although they do not use gene trees reconstructions. Here we compare PhylDiag to i-ADHoRe 3.0 [<xref ref-type="bibr" rid="CR14">14</xref>] (version i-ADHoRe 3.0.2a) using both real data and simulations.</p>
    <p>By introducing the concepts of “tandem blocks” and “homology packs”, PhylDiag overcomes the disruption of gene adjacencies caused by blocks of tandem duplicates. As in other existing methods, PhylDiag allows gaps between genes within synteny blocks up to a customizable maximum gap parameter, and thus bypasses small genic indels (insertions and deletions) and annotation errors. In this study, we also benchmark different metrics used to allow these gaps within a synteny block on simulated data, and show that the choice of the metric has a direct impact on performances.</p>
  </sec>
  <sec id="Sec2" sec-type="methods">
    <title>Methods</title>
    <p>After providing basic definitions, we describe the PhylDiag algorithm, which consists of four main parts. First, PhylDiag filters extant genomes. Second, PhylDiag rewrites the genomes from lists of genes to lists of tandem blocks. Third, PhylDiag extracts synteny blocks as diagonals with no gaps by considering the order and orientations of tandem blocks on the chromosomes and then merge these diagonals as long as merges do not generate gaps longer than <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>. Finally, PhylDiag computes a p-value to remove diagonals that are likely to be produced by chance rather than being a signature of an ancestral gene order. Before performing these tasks PhylDiag also calculates a recommended value for the maximum gap <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> to free the user from testing multiple values before finding the appropriate one.</p>
    <sec id="Sec3">
      <title>Basic notations and definitions</title>
      <sec id="Sec4">
        <title>Genomic conventions</title>
        <p><italic>S</italic> is a species. Given two species <italic>S</italic><sub><italic>a</italic></sub> and <italic>S</italic><sub><italic>b</italic></sub>, LCA(<italic>S</italic><sub><italic>a</italic></sub>,<italic>S</italic><sub><italic>b</italic></sub>) is the Last Common Ancestor of <italic>S</italic><sub><italic>a</italic></sub> and <italic>S</italic><sub><italic>b</italic></sub>. A species <italic>S</italic><sub><italic>a</italic></sub> has a genome <italic>G</italic><sub><italic>a</italic></sub> composed of chromosomes. <inline-formula id="IEq1"><inline-graphic xlink:href="12859_2014_6554_IEq1_HTML.gif"/></inline-formula> is a chromosome of <italic>G</italic><sub><italic>a</italic></sub> with <italic>N</italic><sub><italic>a</italic></sub> oriented genes g<sub><italic>a</italic>,<italic>k</italic></sub>. The chromosome is chosen to be ordered from g<sub><italic>a</italic>,1</sub> to g<sub><italic>a</italic>,<italic>N</italic></sub> and not the reverse, thus defining a reference orientation. The orientation of a gene is determined by the orientation of transcription into RNA, and the orientation of g<sub><italic>a</italic>,<italic>k</italic></sub>, denoted <italic>o</italic>(g<sub><italic>a</italic>,<italic>k</italic></sub>), is equal to +1 if transcription is performed in the same direction as <inline-formula id="IEq2"><inline-graphic xlink:href="12859_2014_6554_IEq2_HTML.gif"/></inline-formula> otherwise <italic>o</italic>(g<sub><italic>a</italic>,<italic>k</italic></sub>)= −1. A sub-list of <italic>c</italic><sub><italic>a</italic></sub> is often denoted <italic>c</italic><sub><italic>a</italic></sub>[<italic>i</italic><sub><italic>s</italic></sub>→ <italic>i</italic><sub><italic>e</italic></sub>] where <italic>i</italic><sub><italic>s</italic></sub> (respectively <italic>i</italic><sub><italic>e</italic></sub>) is the index of the starting (respectively ending) gene in the sub-list.</p>
      </sec>
      <sec id="Sec5">
        <title>Synteny block, intuitive definition</title>
        <p>Intuitively (a formal definition is given in ‘Synteny block, formal definition’) we define a Synteny Block (sb, plural sbs) between two species <italic>S</italic><sub><italic>a</italic></sub> and <italic>S</italic><sub><italic>b</italic></sub> as a set of neighbouring genes with gene content, gene order and gene orientations conserved during the evolution from LCA(<italic>S</italic><sub><italic>a</italic></sub>,<italic>S</italic><sub><italic>b</italic></sub>) to <italic>S</italic><sub><italic>a</italic></sub> and <italic>S</italic><sub><italic>b</italic></sub>. Two genes are neighbours if they are separated by less than a user-defined parameter <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>. During evolution we consider that a set of neighbouring genes remains a synteny block until: <list list-type="bullet"><list-item><p>− a chromosomal rearrangement creates a breakpoint within the sb and changes the order or the orientations of genes</p></list-item><list-item><p>− the gap between any two neighbouring genes, caused by gene insertions and/or gene deletions, exceeds <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> genes (see the formal definition of <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> in ‘Synteny block, formal definition’ for the choice of the type of gene insertions or gene deletions that may break the synteny)</p></list-item></list></p>
        <p>An ancestral sequence of genes remains a sb even if tandem duplications occur within the synteny block.</p>
      </sec>
      <sec id="Sec6">
        <title>Gene family and homology</title>
        <p>The evolution of a gene can be represented by a rooted binary tree called a gene tree. The root of a gene tree is the first ancestral gene, the nodes correspond to events of speciations or duplications that occurred during the evolutionary history of the descending genes, and the leaves of the gene tree correspond to extant genes originating from the first gene.</p>
        <p>Two genes are homologs if they are in the same gene tree. Two genes are orthologs if they are in the same gene tree and if their last common event is a speciation. Two genes are paralogs if they are in the same gene tree and if their last common event is a duplication. The homology relationship between two genes g<sub><italic>a</italic></sub> and g<sub><italic>b</italic></sub> is denoted <inline-formula id="IEq3"><inline-graphic xlink:href="12859_2014_6554_IEq3_HTML.gif"/></inline-formula>. A homology relation defines classes of homologs, called families. An issue in comparative genomics is to define gene families and gene trees. Sequence comparison algorithms provide measures (such as BLASTP [<xref ref-type="bibr" rid="CR37">37</xref>] scores) that make it possible to quantify the similarity between two sequences which may, in turn, be used to cluster genes that show high similarity, thus defining gene families. Gene families can then be organised in phylogenetic gene trees using a vast choice of tree reconstruction methods. Here, we use gene trees from Ensembl [<xref ref-type="bibr" rid="CR38">38</xref>], built using the TreeBest pipeline [<xref ref-type="bibr" rid="CR39">39</xref>]. Since in this study we are interested in finding synteny blocks conserved from LCA(<italic>S</italic><sub><italic>a</italic></sub>,<italic>S</italic><sub><italic>b</italic></sub>) to <italic>S</italic><sub><italic>a</italic></sub> and <italic>S</italic><sub><italic>b</italic></sub>, we pruned all gene trees to define a gene family as a set of genes that come from a unique gene of LCA(<italic>S</italic><sub><italic>a</italic></sub>,<italic>S</italic><sub><italic>b</italic></sub>). Families are defined with these genes, so that two genes are in the same family if and only if they come from the same ancestral gene of LCA(<italic>S</italic><sub><italic>a</italic></sub>,<italic>S</italic><sub><italic>b</italic></sub>). We note that, depending on the purpose of the analysis, PhylDiag offers the possibilty to prune gene trees at an ancestor that precedes LCA(<italic>S</italic><sub><italic>a</italic></sub>,<italic>S</italic><sub><italic>b</italic></sub>), so that more paralogy relationships are included in the gene family, see [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 1].</p>
        <p>Considering the species tree of Figure <xref rid="Fig1" ref-type="fig">1</xref>A and the original gene tree of Figure <xref rid="Fig1" ref-type="fig">1</xref>B, the Figure <xref rid="Fig1" ref-type="fig">1</xref>C describes how we pruned the original gene trees to define our families. Ultimately, the roots of the gene trees correspond to a unique gene of LCA(<italic>S</italic><sub><italic>a</italic></sub>,<italic>S</italic><sub><italic>b</italic></sub>).<fig id="Fig1"><label>Figure 1</label><caption><p><bold>Definition of gene families based on gene tree pruning.</bold> Figure <bold>A</bold> represents a species tree with two extant species <italic>S</italic>
<sub><italic>a</italic></sub> and <italic>S</italic>
<sub><italic>b</italic></sub>, and their last common ancestor LCA(<italic>S</italic>
<sub><italic>a</italic></sub>,<italic>S</italic>
<sub><italic>b</italic></sub>). Figure <bold>B</bold> represents a gene tree within the species tree. This gene tree is represented in simple 3D schema for better visualisation. In a gene tree, squares represent duplication events and circles represent speciation events. Figure <bold>C</bold> shows how the original gene tree of figure B is pruned in order to define families that correspond to a unique gene of LCA(<italic>S</italic>
<sub><italic>a</italic></sub>,<italic>S</italic>
<sub><italic>b</italic></sub>).</p></caption><graphic xlink:href="12859_2014_6554_Fig1_HTML" id="d30e1074"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Step 1: Filter extant genomes</title>
      <p>When comparing two species <italic>S</italic><sub><italic>a</italic></sub> and <italic>S</italic><sub><italic>b</italic></sub>, the first step of PhylDiag is to propose a filtering of extant genomes. There are two filters: <list list-type="bullet"><list-item><p>− <italic>InBothSpecies</italic> removes genes that have no homolog in the other genome. This only retains genes that previous algorithms call “anchor genes” and it is the classical way of filtering extant genomes. This filter is well suited for finding functional clusters of genes.</p></list-item><list-item><p>− <italic>InCommonAncestor</italic> removes genes that arose de novo specifically after LCA(<italic>S</italic><sub><italic>a</italic></sub>,<italic>S</italic><sub><italic>b</italic></sub>). The removed genes are those that have no ancestral gene in LCA(<italic>S</italic><sub><italic>a</italic></sub>,<italic>S</italic><sub><italic>b</italic></sub>) and they are called “lineage specific genes”. The selective removal is possible using the pre-computed phylogenetic gene trees. This step is equivalent to retaining “anchor genes”, but here, using gene trees, the procedure also keeps genes that have lost their ortholog in the other species because of a deletion since LCA(<italic>S</italic><sub><italic>a</italic></sub>,<italic>S</italic><sub><italic>b</italic></sub>). This filtering is well suited for reconstructing ancestral gene orders.</p></list-item></list></p>
      <p>Both filtering get rid of the noise introduced by lineage specific genes. PhylDiag using the <italic>InBothSpecies</italic> filter does not consider ancestral gene deletions as events that break the synteny whereas PhylDiag using the <italic>InCommonAncestor</italic> filter does consider ancestral gene deletions as events that break the synteny.</p>
      <p>It may also be advantageous in some specific cases of functional studies of synteny blocks to avoid filtering extant genomes thus considering de novo births of lineage specific genes as events that break the synteny.</p>
      <p>Depending on the desired purpose, PhylDiag offers the possibility to easily choose between no filtering at all, the <italic>InBothSpecies</italic> filter or the <italic>InCommonAncestor</italic> filter. Since in this study we are interested in reconstructing the ancestral gene order, the <italic>InCommonAncestor</italic> filter is applied and extant genomes should now be considered to only be composed of genes that have an ancestral gene in LCA(<italic>S</italic><sub><italic>a</italic></sub>,<italic>S</italic><sub><italic>b</italic></sub>).</p>
    </sec>
    <sec id="Sec8">
      <title>Step 2: Build the matrix of homology packs</title>
      <p>Extracting sbs conserved in <italic>G</italic><sub><italic>a</italic></sub> and <italic>G</italic><sub><italic>b</italic></sub> corresponds to extracting sbs for each comparison of chromosomes <italic>c</italic><sub><italic>a</italic></sub> of <italic>G</italic><sub><italic>a</italic></sub> and <italic>c</italic><sub><italic>b</italic></sub> of <italic>G</italic><sub><italic>b</italic></sub>. Indeed, genes in two different chromosomes, if they were in synteny before, have been separated by a chromosomal rearrangement and the synteny is broken anyway. Thus it is justified to limit the search to pairs of chromosomes rather than pairs of genomes.</p>
      <sec id="Sec9">
        <title>Tandem blocks, an abstraction of genes</title>
        <p>In a chromosome, under a parsimonious reasoning, homologous and adjacent genes are tandem duplicates. Here, we refer to such blocks as “tandem block”. Formally, a tandem block (tb, plural tbs) of a chromosome <italic>c</italic> is an uninterrupted sub-list of <italic>c</italic> that contains paralogous genes. For instance, if the 3 paralogous genes <italic>g</italic><sub>4</sub>,<italic>g</italic><sub>5</sub> and <italic>g</italic><sub>6</sub> are in an uninterrupted row in <italic>c</italic>, the corresponding tb is the sub-sequence <italic>c</italic>[ 4→6]=[ g<sub>4</sub>,g<sub>5</sub>,g<sub>6</sub>]. The size of a tb is equal to the number of tandem gene copies that it contains, for instance the last tb has a size 3. A gene which has no tandem duplicate is in a tb of size 1. By convention tbs are always maximum, i.e. a given tb cannot be contained within another tb. Like genes, tbs also have an orientation. However, in a tb, tandem duplicates may or may not all have the same orientation. When they all share the same orientation, the tb itself is oriented with the same orientation as the orientation of the genes thus, either <italic>o</italic>(tb)=+1 or <italic>o</italic>(tb)=−1. When tandem duplicates have different orientations, the orientation of the tb is considered to be <italic>unknown</italic>, and <inline-formula id="IEq4"><inline-graphic xlink:href="12859_2014_6554_IEq4_HTML.gif"/></inline-formula>.</p>
        <p>It is possible to rewrite chromosomes as a unique ordered list of oriented tbs. For instance <inline-formula id="IEq5"><inline-graphic xlink:href="12859_2014_6554_IEq5_HTML.gif"/></inline-formula> can be rewritten <inline-formula id="IEq6"><inline-graphic xlink:href="12859_2014_6554_IEq6_HTML.gif"/></inline-formula> where <italic>n</italic><sub><italic>a</italic></sub> is the number of tbs in <italic>c</italic><sub><italic>a</italic></sub>. <italic>n</italic><sub><italic>a</italic></sub>≤<italic>N</italic><sub><italic>a</italic></sub> and <italic>n</italic><sub><italic>a</italic></sub>=<italic>N</italic><sub><italic>a</italic></sub> if and only if there is no tandem duplicate in <italic>c</italic><sub><italic>a</italic></sub>.</p>
        <p>A tandem block tb<sub><italic>a</italic></sub> of <italic>S</italic><sub><italic>a</italic></sub> is said to be in a homology relation with a tandem block tb<sub><italic>b</italic></sub> of <italic>S</italic><sub><italic>b</italic></sub> if the genes of the two tbs are in the same family. We will also say that in this case tb<sub><italic>a</italic></sub> and tb<sub><italic>b</italic></sub> are homologs or even that tb<sub><italic>a</italic></sub> and tb<sub><italic>b</italic></sub> are homologous tandem blocks. Using the same notation as for genes, <inline-formula id="IEq7"><inline-graphic xlink:href="12859_2014_6554_IEq7_HTML.gif"/></inline-formula> means that tb<sub><italic>a</italic></sub> and tb<sub><italic>b</italic></sub> are homologs. If tb<sub><italic>a</italic></sub> and tb<sub><italic>b</italic></sub> are homologs, they share a Last Common Ancestral gene in LCA(<italic>S</italic><sub><italic>a</italic></sub>,<italic>S</italic><sub><italic>b</italic></sub>) and we note LCAg(tb<sub><italic>a</italic></sub>,tb<sub><italic>b</italic></sub>) the Last Common Ancestral gene of tb<sub><italic>a</italic></sub> and tb<sub><italic>b</italic></sub>. LCAg(tb<sub><italic>a</italic></sub>,tb<sub><italic>b</italic></sub>) is defined as soon as it is observed that <inline-formula id="IEq8"><inline-graphic xlink:href="12859_2014_6554_IEq8_HTML.gif"/></inline-formula>. Of note, two homologous tandem blocks tb<sub><italic>a</italic></sub> and tb<sub><italic>b</italic></sub> are not necessarily of the same size if deletions or tandem duplications took place specifically in the branches of <italic>S</italic><sub><italic>a</italic></sub> or <italic>S</italic><sub><italic>b</italic></sub> after LCA(<italic>S</italic><sub><italic>a</italic></sub>,<italic>S</italic><sub><italic>b</italic></sub>).</p>
      </sec>
      <sec id="Sec10">
        <title>Matrix of homologies</title>
        <p>The classic Matrix of Homologies <inline-formula id="IEq9"><inline-graphic xlink:href="12859_2014_6554_IEq9_HTML.gif"/></inline-formula> of two chromosomes <inline-formula id="IEq10"><inline-graphic xlink:href="12859_2014_6554_IEq10_HTML.gif"/></inline-formula> and <inline-formula id="IEq11"><inline-graphic xlink:href="12859_2014_6554_IEq11_HTML.gif"/></inline-formula> is defined such that:
<disp-formula id="Equa"><graphic xlink:href="12859_2014_6554_Equa_HTML.gif" position="anchor"/></disp-formula></p>
        <p>Where <italic>g</italic><sub><italic>a</italic></sub>• <italic>g</italic><sub><italic>b</italic></sub> is the “sign” of the homology of <italic>g</italic><sub><italic>a</italic></sub> and <italic>g</italic><sub><italic>b</italic></sub><disp-formula id="Equb"><graphic xlink:href="12859_2014_6554_Equb_HTML.gif" position="anchor"/></disp-formula></p>
        <p>A MH can be represented as an array of values equal to +1,−1 or 0. Non-0 values correspond to homologies.</p>
      </sec>
      <sec id="Sec11">
        <title>Homology packs, an abstraction of homologies</title>
        <p>A Homology Pack (hp, plural hps) is the set of homology relationships between the tandem duplicates of two homologous tandem blocks tb<sub><italic>a</italic></sub> (in <italic>c</italic><sub><italic>a</italic></sub>) and tb<sub><italic>b</italic></sub> (in <italic>c</italic><sub><italic>b</italic></sub>). A hp is always maximum, i.e. a hp cannot be contained within another hp. Graphically, a hp appears as a rectangle of non-0 values in a MH. Each hp has a last common ancestral gene in LCA(<italic>S</italic><sub><italic>a</italic></sub>,<italic>S</italic><sub><italic>b</italic></sub>) denoted LCAg(hp) and equal to LCAg(tb<sub><italic>a</italic></sub>,tb<sub><italic>b</italic></sub>). Tandem duplications generate vertical, horizontal, or rectangular hps in a MH, making it difficult to identify sbs as diagonals. However, the rewriting of a chromosome in a way that collapses these hps to unique values in the MH, as described above, greatly simplifies this problem. Indeed, once <italic>c</italic><sub><italic>a</italic></sub> and <italic>c</italic><sub><italic>b</italic></sub> are rewritten as ordered lists of tbs, it becomes possible to define a matrix whose non-0 values correspond to hps of the two chromosomes <italic>c</italic><sub><italic>a</italic></sub> and <italic>c</italic><sub><italic>b</italic></sub>.</p>
      </sec>
      <sec id="Sec12">
        <title>Matrix of homology packs</title>
        <p>Given that <italic>c</italic><sub><italic>a</italic></sub> is rewritten in <inline-formula id="IEq12"><inline-graphic xlink:href="12859_2014_6554_IEq12_HTML.gif"/></inline-formula> and <italic>c</italic><sub><italic>b</italic></sub> is rewritten in <inline-formula id="IEq13"><inline-graphic xlink:href="12859_2014_6554_IEq13_HTML.gif"/></inline-formula>, we introduce the Matrix of Homology Packs <inline-formula id="IEq14"><inline-graphic xlink:href="12859_2014_6554_IEq14_HTML.gif"/></inline-formula> of the two chromosomes <inline-formula id="IEq15"><inline-graphic xlink:href="12859_2014_6554_IEq15_HTML.gif"/></inline-formula> and <inline-formula id="IEq16"><inline-graphic xlink:href="12859_2014_6554_IEq16_HTML.gif"/></inline-formula> defined such that:
<disp-formula id="Equc"><graphic xlink:href="12859_2014_6554_Equc_HTML.gif" position="anchor"/></disp-formula></p>
        <p>Whith tb<sub><italic>a</italic></sub>∙tb<sub><italic>b</italic></sub> the “sign” of the hp of tb<sub><italic>a</italic></sub> and tb<sub><italic>b</italic></sub><disp-formula id="Equd"><graphic xlink:href="12859_2014_6554_Equd_HTML.gif" position="anchor"/></disp-formula></p>
        <p>In other words, the matrix construction is the same as for the MH of <italic>c</italic><sub><italic>a</italic></sub> and <italic>c</italic><sub><italic>b</italic></sub>, with tbs instead of genes and hps instead of gene homologies. The only difference is that while genes always have a known orientation, tbs can have <italic>unknown</italic> orientations that generate hps with signs equal to <inline-formula id="IEq17"><inline-graphic xlink:href="12859_2014_6554_IEq17_HTML.gif"/></inline-formula>. Similarly, the MHP can be represented as an array of values equal to <inline-formula id="IEq18"><inline-graphic xlink:href="12859_2014_6554_IEq18_HTML.gif"/></inline-formula> or 0. Non-0 values correspond to hps. The X-axis corresponds to <italic>c</italic><sub><italic>a</italic></sub> ordered from tb<sub><italic>a</italic>,1</sub> to <inline-formula id="IEq19"><inline-graphic xlink:href="12859_2014_6554_IEq19_HTML.gif"/></inline-formula> and the Y-axis corresponds to <italic>c</italic><sub><italic>b</italic></sub> ordered from tb<sub><italic>b</italic>,1</sub> to <inline-formula id="IEq20"><inline-graphic xlink:href="12859_2014_6554_IEq20_HTML.gif"/></inline-formula>. With this convention MHP[0,0] corresponds to the bottom-left corner, MHP[<italic>n</italic><sub><italic>a</italic></sub>,0] corresponds to the bottom-right corner, MHP[0,<italic>n</italic><sub><italic>b</italic></sub>] corresponds to the top-left corner and MHP[<italic>n</italic><sub><italic>a</italic></sub>,<italic>n</italic><sub><italic>b</italic></sub>] corresponds to the top right corner of the array.</p>
        <p>[Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 2] gives a graphical representation of the transition between the MH and the MHP via rewriting chromosomes with tbs.</p>
      </sec>
      <sec id="Sec13">
        <title>Distances and gaps</title>
        <p>The “gap between two tbs” on the same chromosome is the number of tbs between them.</p>
        <p>The “distance between two tbs” is equal to the gap between these two tbs <italic>plus one</italic>. Thus two adjacent tbs are at a distance one from each other.</p>
        <p>As in definition 2.1 in [<xref ref-type="bibr" rid="CR35">35</xref>], a set of tbs forms a “chain” with gaps ≤ <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> if all consecutive tbs are separated by gaps ≤ <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> tbs.</p>
        <p>Now, given a MHP, we define the “distance between two hps” as the 2D-distance between hps coordinates which depends on a distance metric. Several distance metrics can be used in PhylDiag: the Euclidean Distance (ED), the Chebyshev Distance (CD), the Manhattan Distance (MD), or the Diagonal Pseudo Distance (DPD) (Figure <xref rid="Fig2" ref-type="fig">2</xref>). Equations for each distance metric can be found in [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 3]. The CD yields the maximum of the distances on <italic>c</italic><sub><italic>a</italic></sub> and <italic>c</italic><sub><italic>b</italic></sub>, the ED yields the classical geometric distance, the DPD yields smaller distances between hps sitting close to the diagonal axis and therefore tends to provide a higher distance as the distance from the diagonal axis increases. In contrast, the MD tends to yield smaller distances between hps sitting close to the vertical and horizontal axis.<fig id="Fig2"><label>Figure 2</label><caption><p><bold>Distance metrics and frameworks used for the distance calculation.</bold> Figures <bold>A</bold>, <bold>B</bold>, <bold>C</bold> and <bold>D</bold> represent the metrics available in PhylDiag. Distance values are calculated starting from the black dot. The warmer the colour, the closer the point from the black dot. Considering that the user chose the DPD, when backslash diagonals are merged, the backslash framework of figure <bold>E</bold> is used for the distance calculation. For a slash diagonal merge, the framework of figure <bold>F</bold> is used. Frameworks would have been built in the same fashion if another metric had been chosen.</p></caption><graphic xlink:href="12859_2014_6554_Fig2_HTML" id="d30e2011"/></fig></p>
        <p>We define the “gap between two hps” as the distance between these hps <italic>minus one</italic>, thus a gap between two hps depends on the distance metric used. A gap of 0 between two hps means that there is no gap and this corresponds to a distance equal to 1. Given a maximum gap <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>, a set of hps forms a “cluster” if no gap between them is longer than <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Step 3: Extract putative synteny blocks as consistent diagonals</title>
      <p>In the following section, we define the notion of consistent diagonals in a MHP and we formally define synteny blocks. Then, we explain how synteny blocks generate consistent diagonals in MHPs, and we describe how PhylDiag extracts consistent diagonals. Because some consistent diagonals may be due to chance, we next describe how they are validated as synteny blocks after succeeding a statistical test.</p>
      <sec id="Sec15">
        <title>Diagonals</title>
        <p>In a MHP, a list of <italic>m</italic> hps [MHP[<italic>x</italic><sub><italic>k</italic></sub>,<italic>y</italic><sub><italic>k</italic></sub>]]<sub><italic>k</italic>∈[0,<italic>m</italic>−1]</sub> forms a: <list list-type="bullet"><list-item><p>− “slash” diagonal if <inline-formula id="IEq21"><inline-graphic xlink:href="12859_2014_6554_IEq21_HTML.gif"/></inline-formula>.</p></list-item><list-item><p>− “backslash” diagonal if <inline-formula id="IEq22"><inline-graphic xlink:href="12859_2014_6554_IEq22_HTML.gif"/></inline-formula>.</p></list-item></list></p>
        <p>In both cases, <italic>x</italic><sub><italic>k</italic></sub> (respectively <italic>y</italic><sub><italic>k</italic></sub>) is the index of the homologous tb on <italic>c</italic><sub><italic>a</italic></sub> (respectively <italic>c</italic><sub><italic>b</italic></sub>) corresponding to the <italic>k</italic><sup><italic>t</italic><italic>h</italic></sup> hp. In a MHP, a “slash” diagonal is thus a list of non-0 cells that goes up according to a direction from bottom-left to top-right and a “backslash” diagonal is a list of non-0 cells that goes down according to a direction from top-left to bottom-right. A “diagonal” is either a slash diagonal or a backslash diagonal. A diagonal with gaps ≤<italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> is a diagonal where all consecutive hps are separated by gaps ≤<italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>.</p>
        <p>We define a “strict” diagonal as a diagonal that has no gap between its hps. Thus, <italic>m</italic> hps form a strict slash diagonal if the list of <italic>m</italic> hps can be written [ MHP[ <italic>s</italic><sub><italic>a</italic></sub>+<italic>k</italic>,<italic>s</italic><sub><italic>b</italic></sub>+<italic>k</italic>]]<sub><italic>k</italic>∈[0,<italic>m</italic>−1]</sub>. Similarly, <italic>m</italic> hps form a strict backslash diagonal if the list of <italic>m</italic> hps can be written [ MHP[ <italic>s</italic><sub><italic>a</italic></sub>+<italic>k</italic>,<italic>s</italic><sub><italic>b</italic></sub>−<italic>k</italic>]]<sub><italic>k</italic>∈[0,<italic>m</italic>−1]</sub>. In both cases, (<italic>s</italic><sub><italic>a</italic></sub>,<italic>s</italic><sub><italic>b</italic></sub>) is the position of the first hp of the diagonal.</p>
        <p>We also define a “consistent” diagonal as a diagonal composed of hps with signs consistent with hps order: <list list-type="bullet"><list-item><p>− either a slash diagonal only composed of hps with signs equal to either +1 or
<inline-formula id="IEq23"><inline-graphic xlink:href="12859_2014_6554_IEq23_HTML.gif"/></inline-formula></p></list-item><list-item><p>− or a backslash diagonal only composed of hps with signs equal to either −1 or
<inline-formula id="IEq24"><inline-graphic xlink:href="12859_2014_6554_IEq24_HTML.gif"/></inline-formula></p></list-item></list></p>
        <p>In addition, we consider that the distance between two diagonals corresponds to the distance between their closest extremities.</p>
      </sec>
      <sec id="Sec16">
        <title>Synteny block, formal definition</title>
        <p>We formally define a “synteny block” of <italic>m</italic> tbs with gaps ≤ <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> of a comparison of two genomes <italic>G</italic><sub><italic>a</italic></sub> and <italic>G</italic><sub><italic>b</italic></sub>, as a chain of <italic>m</italic> tbs with gaps ≤ <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> that, during the evolution from LCA(<italic>S</italic><sub><italic>a</italic></sub>,<italic>S</italic><sub><italic>b</italic></sub>) to <italic>S</italic><sub><italic>a</italic></sub> and <italic>S</italic><sub><italic>b</italic></sub>, remains a chain of <italic>m</italic> tbs with gaps ≤ <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>. Within a synteny block, tbs order is conserved and tbs orientations either remain conserved or change from a known to an unknown orientation. Synteny blocks are chosen maximal, i.e. not included in another synteny block.</p>
        <p>In addition we define a “strict synteny block” as a synteny block with no gaps between tbs (<italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>=0). In [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 4], we show that a strict synteny block generates a strict and consistent diagonal in a MHP. Following the reasoning in [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 4], using the CD distance metric, it is also possible to show that a synteny block with gaps ≤ <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> generates a consistent diagonal with gaps ≤ <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>. However, using the ED, MD or the DPD distance metrics, a synteny block with gaps ≤ <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> may generate a consistent diagonal with gaps &gt;<italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>, although every consistent diagonal with gaps ≤ <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> always represents a putative synteny block with gaps ≤ <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>. It should be noted that, given the CD distance metric and a <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>, our definition of a diagonal is similar to the definition 4.1 of a “max-gap cluster” in [<xref ref-type="bibr" rid="CR35">35</xref>] with constraints on gene order and gene orientations.</p>
      </sec>
      <sec id="Sec17">
        <title>Extract strict consistent diagonals</title>
        <p>Algorithm 1 describes how PhylDiag finds strict and consistent diagonals of hps in the MHP. First, chromosomes are rewritten with tbs and the MHP is built. Then the MHP is scanned from left to right and from bottom to top. Algorithm <italic>findDiagType</italic> in [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 5], sets the diagonal type at the beginning of a strict and consistent diagonal extraction using the sign of the first hp if the sign is known or using the position of the second hp if there is a second hp.</p>
        <p>Strict and consistent diagonals are recorded as chains of ordered and oriented (whenever it is possible) ancestral genes. By convention the orientation of an ancestral gene LCAg(tb<sub><italic>a</italic></sub>,tb<sub><italic>b</italic></sub>) is chosen equal to the orientation of tb<sub><italic>a</italic></sub>. However, if the orientation of tb<sub><italic>a</italic></sub> is <italic>unknown</italic>, the orientation of LCAg(tb<sub><italic>a</italic></sub>,tb<sub><italic>b</italic></sub>) may still be inferred using the diagonal type of the current diagonal and a known orientation of tb<sub><italic>b</italic></sub>, see Equation <xref rid="Equ1" ref-type="">1</xref>.
<disp-formula id="Equ1"><label>1</label><graphic xlink:href="12859_2014_6554_Equ1_HTML.gif" position="anchor"/></disp-formula></p>
        <sec id="Sec18">
          <title>Algorithm 1 1 <bold><italic>e</italic></bold><bold><italic>x</italic></bold><bold><italic>t</italic></bold><bold><italic>r</italic></bold><bold><italic>a</italic></bold><bold><italic>c</italic></bold><bold><italic>t</italic></bold><bold><italic>S</italic></bold><bold><italic>b</italic></bold><bold><italic>s</italic></bold><bold>(</bold><bold><italic>c</italic></bold><sub><bold><italic>a</italic></bold></sub><bold>,</bold><bold><italic>c</italic></bold><sub><bold><italic>b</italic></bold></sub><bold>)</bold></title>
          <p>
            <disp-formula id="Eque">
              <graphic xlink:href="12859_2014_6554_Eque_HTML.gif" position="anchor"/>
            </disp-formula>
          </p>
        </sec>
      </sec>
      <sec id="Sec19">
        <title>Merge strict consistent diagonals</title>
        <p>Once strict diagonals have been returned, it is advantageous to merge diagonals which have the same diagonal type, as long as their extremities are in close proximity. Depending on the allowed gap size <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>, a limited number of errors of annotation and indels are thus allowed, and longer sbs are found that still reflect an ancestral arrangement of genes. It should be noted that this step possibly introduces micro-inversions within gaps of a diagonal, which will however always remain shorter than <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> tbs. As we will see, the choice of the distance metric used to merge diagonals is crucial to limit or allow such micro-inversions, see [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 14].</p>
        <p>The merging process is simple: diagonals are merged iteratively, starting by those separated by the shortest gap to those separated by the longest gap, as long as the gap remains below <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>. For a given diagonal extremity, more than one other extremity may be situated at exactly the same distance. In this case, PhyDiag chooses to fuse the diagonals that maximise the number of hps in the diagonal that results from the fusion.</p>
        <p>As described in the introduction, the DPD is used in ADHoRe and DiagHunter whereas the MD is used in GRIMM-Synteny, FISH, Cinteny and SyMAP. Although the CD and the ED have never been used to our knowledge in the context of synteny block inference we still included them in the benchmark presented in the ‘Results’ section.</p>
        <p>Figure <xref rid="Fig3" ref-type="fig">3</xref> shows an example of a merge between two strict backslash diagonals spaced by a distance 5 if the user chose the DPD, 4 if the user chose the MD and 3 if the user chose the CD or the ED.<fig id="Fig3"><label>Figure 3</label><caption><p><bold>Example of a merge between two diagonals.</bold> Two chromosomes, <italic>c</italic>
<sub><italic>a</italic></sub> of <italic>n</italic>
<sub><italic>a</italic></sub>= 11 tbs and <italic>c</italic>
<sub><italic>b</italic></sub> of <italic>n</italic>
<sub><italic>b</italic></sub>= 8 tbs, are compared. The number in each tb is its size, arrows indicate tbs orientations and if a tb is represented as a rectangle it means that it has an <italic>unknown</italic> orientation. The MHP contains <italic>n</italic>
<sub><italic>a</italic><italic>b</italic></sub>= 6 hps. During step 2, PhylDiag finds two strict backslash diagonals and 2 single hps. Each strict diagonal contains 2 hps. If <italic>g</italic>
<italic>a</italic>
<italic>p</italic>
<sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>= 4, during the diagonal merging process, diagonals separated by a distance of 2 to <italic>g</italic>
<italic>a</italic>
<italic>p</italic>
<sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>+1=5 are merged. Consider that the user chooses the DPD metric, when reaching a distance of 5, two possible fusions are theoretically possible, one between the two extremities of the strict backslash diagonals and another fusion between the single hp (coordinates [ 2,6]) and the extremity (coordinates [5,5]) of the leftmost strict diagonal. However since the sign of the single hp is not consistent with the diagonal type of the left-most diagonal, the second fusion is not performed. Around the resulting consistent diagonal (in red) three windows are drawn: <italic>W</italic>
<sub><italic>a</italic></sub> (purple) on <italic>c</italic>
<sub><italic>a</italic></sub> contains 6 tbs and <italic>W</italic>
<sub><italic>b</italic></sub> (green) on <italic>c</italic>
<sub><italic>b</italic></sub> contains 4 tbs, and at last the window <italic>W</italic>
<sub><italic>a</italic><italic>b</italic></sub> (pink) contains 6 × 4 cells and 4 hps. These windows are useful in section ‘Step 4: Statistical validation of consistent diagonals as synteny blocks’ for the p-value calculation.</p></caption><graphic xlink:href="12859_2014_6554_Fig3_HTML" id="d30e2867"/></fig></p>
        <p>Given a maximum gap <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>, users should be aware that, with reference to the formal definition of sbs given in section ‘Synteny block, formal definition’, choosing another distance metric than the CD may return non-maximum sbs in the MHP. Another reason that may lead to non-maximum sbs may come from the fusion of diagonals. As mentioned before, if during the fusion process more than one diagonal extremity is available to extend the current diagonal, PhylDiag choses the extremity of the longest diagonal. However, it may be that fusing with a shorter one ultimately would lead to a longer diagonal once the iterative fusion process is complete.</p>
        <p>In Algorithm 1, the merging process is encapsulated in the function <italic>mergeDiags</italic> that takes a list of strict and consistent diagonals and returns a list of consistent diagonals with gaps ≤ <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>.</p>
      </sec>
    </sec>
    <sec id="Sec20">
      <title>Step 4: Statistical validation of consistent diagonals as synteny blocks</title>
      <p>We compare two chromosomes, <italic>c</italic><sub><italic>a</italic></sub> and <italic>c</italic><sub><italic>b</italic></sub>. <italic>c</italic><sub><italic>a</italic></sub> has a length of <italic>n</italic><sub><italic>a</italic></sub> tbs, <italic>c</italic><sub><italic>b</italic></sub> has a length of <italic>n</italic><sub><italic>b</italic></sub> tbs and the comparison involves <italic>n</italic><sub><italic>a</italic><italic>b</italic></sub> hps. During the comparison, PhylDiag returns many consistent diagonals that correspond to putative synteny blocks, each characterized by its number of hps, its window <italic>W</italic><sub><italic>a</italic><italic>b</italic></sub> and the maximum gap <italic>g</italic> between its tbs (note that <italic>g</italic> ≠ <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>). Figure <xref rid="Fig3" ref-type="fig">3</xref> shows an example of a consistent diagonal of 4 hps contained in the window <italic>W</italic><sub><italic>a</italic><italic>b</italic></sub> with a maximum gap <italic>g</italic>=2 tbs reached on <italic>c</italic><sub><italic>a</italic></sub>. The window <italic>W</italic><sub><italic>a</italic><italic>b</italic></sub> has a size 6 × 4. The chromosomal windows <italic>W</italic><sub><italic>a</italic></sub> and <italic>W</italic><sub><italic>b</italic></sub> are the projections of <italic>W</italic><sub><italic>a</italic><italic>b</italic></sub> on each chromosome. <italic>W</italic><sub><italic>a</italic></sub> has a length of <italic>l</italic><sub><italic>a</italic></sub>= 6 tbs and <italic>W</italic><sub><italic>b</italic></sub> has a length of <italic>l</italic><sub><italic>b</italic></sub>= 4 tbs. As in previous works [<xref ref-type="bibr" rid="CR33">33</xref>–<xref ref-type="bibr" rid="CR35">35</xref>], here distances and gaps between hps are calculated with the Chebyshev Distance metric which allows the most relaxed and method-independent sb definition.</p>
      <p>A given consistent diagonal is a statistically significant signature of a sb if it cannot be obtained from a random distribution of tbs (null-hypothesis) up to a fixed probability threshold <italic>α</italic>. This is equivalent to selecting consistent diagonals that are unlikely to be the result of chance, which we wish to quantify here by a probability, a p-value.</p>
      <p>We calculate the p-value of each consistent diagonal in five steps. Considering a consistent diagonal of <italic>m</italic> hps contained in a window <italic>W</italic><sub><italic>a</italic><italic>b</italic></sub> of size <italic>l</italic><sub><italic>a</italic></sub>× <italic>l</italic><sub><italic>b</italic></sub> with a maximum gap between hps equal to <italic>g</italic>, the probability that such a consistent diagonal (or an even more improbable consistent diagonal with gaps ≤ <italic>g</italic>) arises by chance is denoted <italic>p</italic><italic>V</italic><italic>a</italic><italic>l</italic>(<italic>m</italic>,<italic>g</italic>,<italic>l</italic><sub><italic>a</italic></sub>,<italic>l</italic><sub><italic>b</italic></sub>,<italic>n</italic><sub><italic>a</italic><italic>b</italic></sub>,<italic>n</italic><sub><italic>a</italic></sub>,<italic>n</italic><sub><italic>b</italic></sub>). To compute this value we first compute <italic>p</italic><sub><italic>d</italic></sub>(<italic>k</italic>,<italic>l</italic><sub><italic>a</italic></sub>,<italic>l</italic><sub><italic>b</italic></sub>,<italic>n</italic><sub><italic>a</italic><italic>b</italic></sub>,<italic>n</italic><sub><italic>a</italic></sub>,<italic>n</italic><sub><italic>b</italic></sub>) the probability of obtaining exactly <italic>k</italic> hps in the window <italic>W</italic><sub><italic>a</italic><italic>b</italic></sub>, knowing the MHP density in terms of non-0 values. We next compute <italic>p</italic><sub><italic>g</italic>,2D</sub>(<italic>k</italic>,<italic>g</italic>,<italic>l</italic><sub><italic>a</italic></sub>,<italic>l</italic><sub><italic>b</italic></sub>), the probability that <italic>k</italic> hps in <italic>W</italic><sub><italic>a</italic><italic>b</italic></sub> are spaced with gaps ≤ <italic>g</italic>, knowing that there is at least <italic>k</italic> hps in <italic>W</italic><sub><italic>a</italic><italic>b</italic></sub>. We also calculate <italic>p</italic><sub><italic>o</italic>,<italic>o</italic></sub>(<italic>k</italic>) the probability that <italic>k</italic> hps have consistent order and signs. By summing and multiplying these probabilities in an appropriate manner we calculate <italic>p</italic><sub><italic>w</italic></sub>(<italic>m</italic>,<italic>g</italic>,<italic>l</italic><sub><italic>a</italic></sub>,<italic>l</italic><sub><italic>b</italic></sub>,<italic>n</italic><sub><italic>a</italic><italic>b</italic></sub>,<italic>n</italic><sub><italic>a</italic></sub>,<italic>n</italic><sub><italic>b</italic></sub>), the probability corresponding to a window sampling search. Finally, we use the former probability to compute the p-value <italic>p</italic><italic>V</italic><italic>a</italic><italic>l</italic>(<italic>m</italic>,<italic>g</italic>,<italic>l</italic><sub><italic>a</italic></sub>,<italic>l</italic><sub><italic>b</italic></sub>,<italic>n</italic><sub><italic>a</italic><italic>b</italic></sub>,<italic>n</italic><sub><italic>a</italic></sub>,<italic>n</italic><sub><italic>b</italic></sub>) corresponding to a whole genome comparison. The formulas of the two first probabilities are based on [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR35">35</xref>] respectively and the passage from <italic>p</italic><sub><italic>w</italic></sub> to the <italic>pVal</italic> is based on [<xref ref-type="bibr" rid="CR34">34</xref>]. Here we combine these probabilities and add a last probability, <italic>p</italic><sub><italic>o</italic>,<italic>o</italic></sub>(<italic>k</italic>), to account for tbs order and orientations.</p>
      <sec id="Sec21">
        <title>Probability accounting for the density</title>
        <p>Using the reasoning of [<xref ref-type="bibr" rid="CR33">33</xref>], in a MHP of size <italic>n</italic><sub><italic>a</italic></sub>× <italic>n</italic><sub><italic>b</italic></sub> without dispersed paralogy (see Discussion), involving <italic>n</italic><sub><italic>a</italic><italic>b</italic></sub> hps, the probability of obtaining exactly <italic>k</italic> hps in a window <italic>W</italic><sub><italic>a</italic><italic>b</italic></sub> of size <italic>l</italic><sub><italic>a</italic></sub>× <italic>l</italic><sub><italic>b</italic></sub> is:
<disp-formula id="Equ2"><label>2</label><graphic xlink:href="12859_2014_6554_Equ2_HTML.gif" position="anchor"/></disp-formula></p>
        <p>The subscript <italic>d</italic> stands for <italic>density</italic> because this probability takes into account the density of the MHP. The demonstration of this formula is in [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 6].</p>
      </sec>
      <sec id="Sec22">
        <title>Probability accounting for the maximum gap between hps</title>
        <p>Using the reasoning of [<xref ref-type="bibr" rid="CR35">35</xref>], the probability that <italic>k</italic> marked tbs (in any order) form a chain with gaps ≤ <italic>g</italic><italic>anywhere</italic> within a window composed of <italic>l</italic> tbs is:
<disp-formula id="Equ3"><label>3</label><graphic xlink:href="12859_2014_6554_Equ3_HTML.gif" position="anchor"/></disp-formula></p>
        <p>Where <italic>w</italic><sub><italic>k</italic><italic>g</italic></sub>= <italic>k</italic>+(<italic>k</italic>−1)<italic>g</italic> is the maximum length of a chain containing <italic>k</italic> tbs with a maximum gap <italic>g</italic>, and
<disp-formula id="Equ4"><label>4</label><graphic xlink:href="12859_2014_6554_Equ4_HTML.gif" position="anchor"/></disp-formula></p>
        <p>the number of ways of arranging <italic>k</italic> tbs so that they form a chain with gaps shorter or equal to <italic>g</italic> anywhere within a window of <italic>l</italic> tbs even if <italic>w</italic><sub><italic>k</italic><italic>g</italic></sub>&gt;<italic>l</italic>+1, to address edge effects.</p>
        <p>Thus, knowing that <italic>W</italic><sub><italic>a</italic><italic>b</italic></sub> contains at least <italic>k</italic> hps, the probability that <italic>W</italic><sub><italic>a</italic><italic>b</italic></sub> contains <italic>k</italic> marked hps spaced with gaps ≤ <italic>g</italic> is:
<disp-formula id="Equ5"><label>5</label><graphic xlink:href="12859_2014_6554_Equ5_HTML.gif" position="anchor"/></disp-formula></p>
      </sec>
      <sec id="Sec23">
        <title>Probability accounting for hps order and signs</title>
        <p>Then, if <italic>k</italic> hps are close enough, the probability that they form a consistent slash diagonal with gaps ≤ <italic>g</italic> is:
<disp-formula id="Equ6"><label>6</label><graphic xlink:href="12859_2014_6554_Equ6_HTML.gif" position="anchor"/></disp-formula></p>
        <p>Where <inline-formula id="IEq25"><inline-graphic xlink:href="12859_2014_6554_IEq25_HTML.gif"/></inline-formula> and <italic>P</italic>(<italic>s</italic><italic>i</italic><italic>g</italic><italic>n</italic> = <italic>s</italic>) is the probability that one hp sign equals <italic>s</italic>, this probability calculation is explained in [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 7]. <inline-formula id="IEq26"><inline-graphic xlink:href="12859_2014_6554_IEq26_HTML.gif"/></inline-formula> is the probability that <italic>k</italic> homologous tbs of chromosome <italic>c</italic><sub><italic>b</italic></sub> have the <italic>same</italic> order as the corresponding <italic>k</italic> homologous tbs of chromosome <italic>c</italic><sub><italic>a</italic></sub> and <inline-formula id="IEq27"><inline-graphic xlink:href="12859_2014_6554_IEq27_HTML.gif"/></inline-formula> is the probability that the <italic>k</italic> signs of the hps are consistent with a slash diagonal. <italic>p</italic><sub><italic>b</italic><italic>a</italic><italic>c</italic><italic>k</italic><italic>s</italic><italic>l</italic><italic>a</italic><italic>s</italic><italic>h</italic></sub>(<italic>k</italic>) is defined similarly.</p>
        <p>Thus, if <italic>k</italic> hps are close enough, the probability that they form a consistent diagonal with gaps ≤ <italic>g</italic> is:
<disp-formula id="Equ7"><label>7</label><graphic xlink:href="12859_2014_6554_Equ7_HTML.gif" position="anchor"/></disp-formula></p>
        <p>The subscript <italic>o</italic>,<italic>o</italic> stands for consistent tbs <italic>Order</italic> and tbs <italic>Orientations</italic>. The demonstration of the <italic>p</italic><sub><italic>o</italic>,<italic>o</italic></sub> formula can be found in [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 8].</p>
      </sec>
      <sec id="Sec24">
        <title>Probability for a window sampling scenario</title>
        <p>Now, in a MHP of size <italic>n</italic><sub><italic>a</italic></sub>× <italic>n</italic><sub><italic>b</italic></sub> without dispersed paralogy (see Discussion), involving <italic>n</italic><sub><italic>a</italic><italic>b</italic></sub> hps, the probability that in a window <italic>W</italic><sub><italic>a</italic><italic>b</italic></sub> of size <italic>l</italic><sub><italic>a</italic></sub>× <italic>l</italic><sub><italic>b</italic></sub> there is <italic>at least</italic> one consistent diagonal containing <italic>at least</italic><italic>m</italic> hps spaced with gaps ≤ <italic>g</italic> is:
<disp-formula id="Equ8"><label>8</label><graphic xlink:href="12859_2014_6554_Equ8_HTML.gif" position="anchor"/></disp-formula></p>
        <p>The subscript <italic>w</italic> stands for <italic>Window</italic> because this probability corresponds to a window sampling [<xref ref-type="bibr" rid="CR34">34</xref>] scenario. Only varying parameters are shown in the right-hand side of the equation in the preceding formula. This formula is explained in [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 9].</p>
      </sec>
      <sec id="Sec25">
        <title>Probability for a whole chromosome comparison</title>
        <p>Finally, since PhylDiag performs a whole chromosome comparison, it is not possible to use the probability of a window sampling method that would underestimate the probability to find a consistent diagonal by a factor of <italic>O</italic>(<italic>n</italic><sub><italic>a</italic></sub><italic>n</italic><sub><italic>b</italic></sub>). Thus, relying on the reasoning of section 4.2 of [<xref ref-type="bibr" rid="CR34">34</xref>] we adjust the former probability to compute the probability corresponding to a whole chromosome comparison.</p>
        <p>In a MHP of size <italic>n</italic><sub><italic>a</italic></sub>× <italic>n</italic><sub><italic>b</italic></sub> containing <italic>n</italic><sub><italic>a</italic><italic>b</italic></sub> hps without dispersed paralogy (see Discussion), the probability of finding <italic>at least</italic> one window <italic>W</italic><sub><italic>a</italic><italic>b</italic></sub> of size <italic>l</italic><sub><italic>a</italic></sub>× <italic>l</italic><sub><italic>b</italic></sub> containing <italic>at least</italic> a consistent diagonal of <italic>at least</italic><italic>m</italic> hps spaced by gaps ≤ <italic>g</italic> can be approximated by:
<disp-formula id="Equ9"><label>9</label><graphic xlink:href="12859_2014_6554_Equ9_HTML.gif" position="anchor"/></disp-formula></p>
        <p>where <inline-formula id="IEq28"><inline-graphic xlink:href="12859_2014_6554_IEq28_HTML.gif"/></inline-formula> is the number of windows of width <italic>l</italic><sub><italic>a</italic></sub> and height <italic>l</italic><sub><italic>b</italic></sub> in the MHP such that no window overlap with any other window. The underlying assumption of this formula is justified in [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 10] and examples of calculation are performed in [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 11].</p>
        <p>In Algorithm 1, the statistical validation is encapsulated in the function <italic>statisticalValidation</italic> that takes a list of consistent diagonals as input and returns statistically validated sbs.</p>
      </sec>
    </sec>
    <sec id="Sec26">
      <title>Estimation of a recommended maximum gap parameter</title>
      <p>All algorithms designed to identify synteny blocks use a maximum gap parameter (<italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>) to allow gaps in sbs. However, the user may find it difficult to estimate the optimal value for this parameter. In order to avoid guessing or multiple trials before finding the optimal <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> value, PhylDiag uses the dependency between the probability of finding a consistent diagonal of <italic>m</italic> hps spaced by gaps ≤ <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> and the <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> value. The complete reasoning used to calculate the recommended maximum gap parameter can be found in [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 12].</p>
    </sec>
    <sec id="Sec27">
      <title>Viewer</title>
      <p>PhylDiag includes a utility to visualise the MHP of a pairwise comparison of chromosomes with colours and surrounding black rectangles for sbs recognition. This viewer writes a vectorial image allowing an infinite zoom on details with no pixelisation. Figure <xref rid="Fig4" ref-type="fig">4</xref>A shows an example of the viewer during the comparison of the human X chromosome with the mouse X chromosome. If more information about a region of the MHP is required, a zoom can be performed by specifying the desired chromosomal regions. If these are small enough, more information is shown, such as hps signs, oriented tbs on each axis, the size of each tb and colours for homology recognition. Grey tbs represent tbs that do not have hps in the MHP, but they have hps elsewhere in the pairwise comparisons of genomes, in another pairwise comparison of chromosomes. Figure <xref rid="Fig3" ref-type="fig">3</xref> was produced with the viewer and shows such informations. The user may also visualise the MH, for example to study the genic composition of a tb.<fig id="Fig4"><label>Figure 4</label><caption><p><bold>Representations of a comparison between the human and the mouse X chromosomes, produced from the same input data by PhylDiag (A) and i-ADHoRe 3.0.2a (B).</bold> The maximum gap parameter <italic>g</italic>
<italic>a</italic>
<italic>p</italic>
<sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> is equal to 5 and the merging process used the DPD metric in both cases. In figure A each axis displays explicitly the paths to the files containing the relevant genome data, the name of the chromosome and the chromosomal window range. As in ADHoRe sbs identified by PhylDiag are surrounded by a rectangle and each sb is drawn in a specific colour. In figure B blue dots represent a confidence interval around each sb drawn in yellow. The long synteny block in the middle of the ADHoRe MHP is in two parts in the PhylDiag MHP because the two extremities are spaced by a distance higher than 5 using the DPD metric. By default ADHoRe has a special feature using extremities of diagonals during its merging process, however this feature cannot be deactivated which may lead to undesired merges.</p></caption><graphic xlink:href="12859_2014_6554_Fig4_HTML" id="d30e4070"/></fig></p>
    </sec>
    <sec id="Sec28">
      <title>Implementation</title>
      <p>The complete algorithm has been implemented in Python. Pairwise comparisons of chromosomes are performed in parallel since they are independent. In Algorithm 1, the MHP matrix is stored considering that it is a sparse matrix to reduce memory usage and the merging process is optimised. Combinations in probability formulas are computed using Pascal’s rule and dynamic programming. On a single 3,0 GHz processor with 32 Gb RAM, loading the data in memory requires 3 seconds, and the running time for the pairwise analysis of the Human and Mouse genomes requires less than 3 seconds. Without any optimisation of the memory allocations the peak of RAM consumption is 221 Mb, thus a standard personal computer can run PhylDiag.</p>
    </sec>
  </sec>
  <sec id="Sec29" sec-type="results">
    <title>Results</title>
    <p>To evaluate the performances of PhylDiag, we performed a comparative analysis with i-ADHoRe 3.0 [<xref ref-type="bibr" rid="CR14">14</xref>], a state-of-the-art algorithm used in many recent studies. To make comparisons possible however, we used a version of the program provided by the authors. Indeed, i-ADHoRe 3.0 first rewrites genomes in tbs like PhylDiag, but allows a user-defined “tandem_gap” between genes in a tb. In version 3.0, the minimal tandem_gap is 2, and it is not possible to set the tandem_gap to 0, as in PhylDiag. In the version provided (i-ADHoRe 3.0.2a) this option is enabled.</p>
    <p>When ADHoRe compares two chromosomes, it first generates “baseclusters” which correspond to PhylDiag’s sbs. ADHoRe uses the DPD metric to build baseclusters containing gaps ≤“gap_size” in the matrix of homologies. ADHoRe also uses the “prob_cutoff” parameter for the statistical filtering and a last parameter is the “q_value”, a real value between 0 and 1, indicating the minimum <italic>r</italic><sup>2</sup> (a measure for the linearity of baseclusters in the matrix of homologies) that a cluster should display.</p>
    <sec id="Sec30">
      <title>Comparison with i-ADHoRe 3.0.2a on real data</title>
      <p>In a first comparison, we provided the same input based on real genomic data to PhylDiag and ADHoRe. We used the human genome (<italic>G</italic><sub><italic>h</italic></sub>) and the mouse genome (<italic>G</italic><sub><italic>m</italic></sub>) of Ensembl v72. As explained in section ‘Gene family and homology’, families correspond to genes that are descended from a unique gene of LCA(<italic>S</italic><sub><italic>h</italic></sub>,<italic>S</italic><sub><italic>m</italic></sub>)= Euarchontoglire.</p>
      <p>PhylDiag computes a recommended <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> of 5 tbs for the human-mouse comparison. We therefore set a <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> parameter of 5 and we chose a probability threshold <italic>α</italic> = 1 × 10<sup>−3</sup> for PhylDiag. i-ADHoRe 3.0.2a was set with tandem_gap=0, gap_size=5, prob_cutoff=1×10<sup>−3</sup> and q_value=0.9 (the default value). Figure <xref rid="Fig5" ref-type="fig">5</xref> compares the distributions of synteny block lengths of ADHoRe and PhylDiag using the MD distance metric. The two distributions are not different from each other (Mann-Whitney U test: pval = 0.9791), and show that neither methods suffer from strong biases in over or under detection of synteny blocks in a given size range. Of note, PhylDiag returned 17 significant sbs of 2 hps out of 175 consistent diagonals of 2 hps. These are not shown in Figure <xref rid="Fig5" ref-type="fig">5</xref> because ADHoRe does not report sbs of size 2. PhylDiag statistically validated all consistent diagonals containing more than 2 hps as significant synteny blocks.<fig id="Fig5"><label>Figure 5</label><caption><p><bold>Synteny block lengths distribution as computed by PhylDiag (black) and ADHoRe (white).</bold> Each bin has a width of 10 units of length (hps), apart from the first bin that contains sb lengths from 3 to 10 hps. ADHoRe uses the DPD distance metric whereas PhylDiag uses the MD distance metric.</p></caption><graphic xlink:href="12859_2014_6554_Fig5_HTML" id="d30e4197"/></fig></p>
    </sec>
    <sec id="Sec31">
      <title>Comparison with i-ADHoRe 3.0.2a on simulated data</title>
      <p>Our simulator first designs an ancestral genome <italic>G</italic><sub><italic>a</italic><italic>n</italic><italic>c</italic></sub> with a user defined number of genes and chromosomes. The lengths of chromosomes in <italic>G</italic><sub><italic>a</italic><italic>n</italic><italic>c</italic></sub> are expressed in number of genes, and are determined randomly. Simulated evolution gives rise to the two extant genomes <italic>G</italic><sub><italic>a</italic></sub> and <italic>G</italic><sub><italic>b</italic></sub> of two extant species. The simulator performs genic events, which include de novo gene births, deletions, duplications (tandem and dispersed), and genomic rearrangements, which include chromosome fusions and fissions, segmental translocations or segmental inversions. The evolutionary scenario is calibrated so as to fit the known evolution of the human and the mouse genome from the Euarchontoglire genome using phylogenetic gene tree reconstructions from Ensembl Compara version 72. See [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 13] for a more detailed description of the Simulator.</p>
      <p>We performed 100 simulations of the evolution of the human and the mouse genome, and analysed them with PhylDiag and ADHoRe to identify sbs. The PhylDiag merging process was performed with the 4 different distance metrics (ED,CD,DPD and MD). For ADHoRe the DPD is the only distance metric available. As in the comparison with real data, since the simulation is calibrated to fit real evolutionnary rates, the recommended <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> found by PhylDiag is still 5. Results of PhylDiag with a <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>=5 and ADHoRe with <italic>g</italic><italic>a</italic><italic>p</italic>_<italic>s</italic><italic>i</italic><italic>z</italic><italic>e</italic>= 5 are shown in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p><bold>Results of synteny block identification with PhylDiag and i-ADHoRe3.0.2a, both using a</bold><bold><italic>gap</italic></bold><sub><bold><italic>max</italic></bold></sub><bold><italic>= 5</italic></bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Algorithm</th><th colspan="4">PhylDiag (without sbs of 2 hps)</th><th>ADHoRe</th></tr><tr><th align="left">distance</th><th>ED</th><th>CD</th><th>DPD</th><th>MD</th><th>DPD</th></tr></thead><tbody><tr><td align="left">coverage</td><td align="center">98.71%</td><td align="center">98.74%</td><td align="center">97.02%</td><td align="center">98.55%</td><td align="center">96.55%</td></tr><tr><td align="left">N50</td><td align="center">44.69</td><td align="center">46.62</td><td align="center">32.66</td><td align="center">37.33</td><td align="center">31.71</td></tr><tr><td align="center" colspan="6"><bold>Analysis without gene orientations</bold></td></tr><tr><td align="left">sensitivity</td><td align="center">94.99%</td><td align="center">95.06%</td><td align="center">92.26%</td><td align="center">94.32%</td><td align="center">91.68%</td></tr><tr><td align="left">specificity</td><td align="center">99.92%</td><td align="center">99.85%</td><td align="center">99.90%</td><td align="center">99.98%</td><td align="center">99.83%</td></tr><tr><td align="center" colspan="6"><bold>Analysis with gene orientations</bold></td></tr><tr><td align="left">sensitivity</td><td align="center">94.20%</td><td align="center">94.26%</td><td align="center">91.56%</td><td align="center">93.54%</td><td align="center">88.56%</td></tr><tr><td align="left">specificity</td><td align="center">99.08%</td><td align="center">99.01%</td><td align="center">99.13%</td><td align="center">99.15%</td><td align="center">96.43%</td></tr></tbody></table><table-wrap-foot><p>Since ADHoRe only returns sbs containing at least 3 hps, we only consider PhylDiag’s sbs containing at least 3 hps.</p></table-wrap-foot></table-wrap></p>
      <p><italic>Coverage</italic> is the fraction of the number of gene families (each family corresponds to a single ancestral gene of Euarchontoglire) contained in sbs over the total number of ancestral genes conserved in both the simulated human genome and the simulated mouse genome. <italic>N50</italic> is the length of the sb such that all sbs of greater lengths represent 50<italic>%</italic> of the ancestral genes contained in sbs. <italic>Sensitivity</italic> is the fraction of the number of correctly inferred ancestral adjacencies over the total number of ancestral genes conserved in both the simulated human genome and the simulated mouse genome. <italic>Specificity</italic> is the fraction of the number of correctly inferred ancestral adjacencies over the total number of inferred ancestral adjacencies, false inferences included.</p>
      <p>Specificity and sensitivity are calculated twice: first by ignoring gene orientations (an inferred adjacency between two genes is considered correct if both genes are adjacent in <italic>G</italic><sub><italic>a</italic><italic>n</italic><italic>c</italic></sub> even if their relative orientation is different compared to the ancestral relative orientation), and second by taking gene orientations into account (to be correct an inferred adjacency must contain genes with a relative orientation that is the same as in the <italic>G</italic><sub><italic>a</italic><italic>n</italic><italic>c</italic></sub>).</p>
      <p>Results show that PhylDiag with the DPD, and ADHoRe obtain similar results when we do not consider gene orientations during the analysis. Interestingly, simply using the ED, the CD or the MD metrics allows PhylDiag to achieve better sensitivity and specificity than ADHoRe (Mann-Whitney U test on sensitivity % and specificity % using the MD in PhylDiag and DPD in ADHoRe over 100 simulations: pval ≤ 2.2e-16 and pval ≤ 2.2e-16 respectively). In addition, as soon as gene orientations are considered in the analysis, PhylDiag improves substantially, in part because of Equation <xref rid="Equ1" ref-type="">1</xref>.</p>
    </sec>
  </sec>
  <sec id="Sec32" sec-type="discussion">
    <title>Discussion</title>
    <p>We have compared PhylDiag to i-ADHoRe 3.0, a state-of-the-art algorithm including advanced features which are not present in PhylDiag, including the possibility to identify sbs in the “twilight zone”, i.e. sbs highly diverged or separated by a WGD, where many gene deletions may have occurred. ADHoRe uses “profiles” across more than two genomes to identify poorly conserved sbs, for example due to long divergence times. These features were not exploited here because unlike ADHoRe, PhylDiag only performs pairwise comparisons of genomes since our primary interest is to identify sbs in closely related species.</p>
    <p>We explored different distance metrics to measure distances in matrices of homology, and found that the DPD used in ADHoRe, which favours fusions of diagonals along ±45° axes in the MHP (Figures <xref rid="Fig2" ref-type="fig">2</xref>D, <xref rid="Fig2" ref-type="fig">2</xref>E and <xref rid="Fig2" ref-type="fig">2</xref>F), is not optimal. This has been discussed previously [<xref ref-type="bibr" rid="CR23">23</xref>] and the simulations clearly show that exploring first laterally (i.e. vertically and horizontally), as with the MD (Figure <xref rid="Fig2" ref-type="fig">2</xref>C), improves results. Merging diagonals with the DPD distance metric allows more small inversions within sbs gaps while considering that genic/segmental indels and incorrect annotations break the synteny more easily than with the MD. Conversely, merging diagonals with the MD metric gives priority to lateral directions and this allows more small genic/segmental indels and annotation errors within sbs gaps and considers that inversions break the synteny more easily than with the DPD, see [Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 14]. Interestingly the unusual ED or CD distance metrics also show improved results over the DPD (Table <xref rid="Tab1" ref-type="table">1</xref>). It should be noted that a given distance may cover a different number of cells in the MHP depending on the metric chosen. For instance 9 cells are covered within a distance value of 3 with the MD whereas 7 cells are covered within the same distance value of 3 with the DPD (Figures <xref rid="Fig2" ref-type="fig">2</xref>C and <xref rid="Fig2" ref-type="fig">2</xref>D). Although this bias may play a role in the results, on chromosomes, gaps between tbs involved in pairs of chains corresponding to sbs are always smaller or equal to <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> independently of the metric chosen. Thus comparing metrics is fair. Finally, contrary to ADHoRe, PhylDiag can return sbs containing 2 hps if their p-value is under the p-value threshold of the user.</p>
    <p>PhylDiag includes a new statistical validation to estimate the probability that a putative sb may be due to chance. Unlike other tests, it accounts for gene orientations, thus providing increased sensitivity. It also accounts for tandem duplications but ignores the possibility that duplicate gene copies may be dispersed. Neglecting dispersed duplicates underestimates the p-values of sbs and the significance of sbs are thus overestimated. However models considering gene families exist [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR23">23</xref>] and in a future version it might be advantageous to implement the p-value proposed in [<xref ref-type="bibr" rid="CR36">36</xref>], even if the calculation is based on an unrealistic assumption that all gene families are of fixed size. Nevertheless the error in the p-value calculation in PhylDiag is likely to be small for closely related species. For instance the analysis of phylogenetic trees described here shows that only 2.4<italic>%</italic> of tbs are dispersed duplicates in the human genome (3.2<italic>%</italic> in mouse) using our family definition (section ‘Gene family and homology’).</p>
    <p>The p-value used by PhylDiag is relative to a comparison of two chromosomes, and therefore assumes that random consistent diagonals might arise based on the number of tbs and hps relevant to the two chromosomes only. In contrast, a global (i.e. genome wide) threshold <italic>α</italic> is chosen to distinguish significant sbs from non-significant sbs. This inconsistency represents an area of further development, in order to better account for heterogeneous densities of hps depending on which chromosomes are being compared.</p>
  </sec>
  <sec id="Sec33" sec-type="conclusions">
    <title>Conclusion</title>
    <p>PhylDiag is designed around a heuristic-independent formal definition of synteny blocks. Its implementation and benchmarking using real and simulated data allowed us to rank 2D-distance metrics in terms of sensitivity and specificity, and to evaluate its performance in comparison with ADHoRe. Results show that the DPD distance metric yields the poorest performances when identifying synteny blocks, both with ADHoRe and PhylDiag. In contrast, PhylDiag highlights the interesting sensitivity-specificity trade-off achieved by the MD distance metric, closely followed by the CD and the ED distance metrics. Compared to ADHoRe and other algorithms that infer synteny blocks, the definition of gene families in PhylDiag is based on gene trees. Most notably, this feature offers the opportunity to precisely group extant genes into families that descend from a unique gene in the last common ancestor of the two species being compared. Furthermore, a meticulous attention to tandem duplicates and gene orientations allow PhylDiag to reach a high resolution in the analysis of rearrangements, down to single gene inversion. Finally, the statistical validation of putative synteny blocks filters out putative false positives due to randomly convergent gene order. PhylDiag is a software for synteny block inference that benefits from extensive parameters, including <italic>g</italic><italic>a</italic><italic>p</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>, distance metric, p-value threshold, filtering of extant genomes and ancestor for the gene family definition. Their values can be set by PhylDiag (default values are based on previous benchmarks or set automatically based on the data) or set by the user. These features, together with post-processing graphical analysing tools and printed statistics (number of tandem duplicates in extant genomes, number of dispersed duplicates, number of homologies involved in the pairwise comparison) contribute to making PhylDiag a user-friendly method to find synteny blocks.</p>
  </sec>
  <sec id="Sec34">
    <title>Availability and requirements</title>
    <p><bold>Project name</bold>: PhylDiag <bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="https://github.com/DyogenIBENS/PhylDiag">https://github.com/DyogenIBENS/PhylDiag</ext-link><bold>Operating system(s)</bold>: Platform independent <bold>Programming language</bold>: Python <bold>Other requirements</bold>: Python 2.7 or higher <bold>License</bold>: GNU GPL v3 or later, and the CeCiLL v2 license in France <bold>Any restrictions to use by non-academics</bold>: No</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Electronic supplementary material</title>
    <sec id="Sec35">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="12859_2014_6554_MOESM1_ESM.pdf">
          <caption>
            <p>Additional file 1:
<bold>Supplementary Data.</bold>
(PDF 793 KB)</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>JMEXL designed the core of PhylDiag. MM designed the library framework for genome data manipulation and gene tree editing. HRC supervised the work. JMEXL and HRC wrote the manuscript. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Alexandra Louis and Pierre Vincens for their help with computer facilities and Wassim Abou-Jaoudé for his assistance with mathematical problems. We also thank Yves Van de Peer, Klaas Vandepoele and Jan Fostier, the authors of ADHoRe who provided the version i-ADHoRe 3.0.2a. This work is funded by Centre National de la Recherche Scientifique (CNRS) and grants from the Agence Nationale de la Recherche (ANR) [Ancestrome Project ANR-10-BINF-01-03, ANR Blanc-PAGE ANR-2011- BSV6-00801].</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murphy</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Larkin</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bourque</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Auvil</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Beever</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Chowdhary</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Galibert</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gatzke</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hitte</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Meyers</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Milan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pape</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Raudsepp</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rogatcheva</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Schook</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Skow</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Welge</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Womack</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>O’brien</surname>
            <given-names>SJ</given-names>
          </name>
          <collab>Everts-van der Wind A</collab>
        </person-group>
        <article-title>
          <bold>Dynamics of mammalian chromosome evolution inferred from multispecies comparative maps</bold>
        </article-title>
        <source>Science</source>
        <year>2005</year>
        <volume>309</volume>
        <issue>5734</issue>
        <fpage>613</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1111387</pub-id>
        <?supplied-pmid 16040707?>
        <pub-id pub-id-type="pmid">16040707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chauve</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tannier</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A methodological framework for the reconstruction of contiguous regions of ancestral genomes and its application to mammalian genomes</bold>
        </article-title>
        <source>PLoS Comput Biol</source>
        <year>2008</year>
        <volume>4</volume>
        <issue>11</issue>
        <fpage>1000234</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000234</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darai-Ramqvist</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sandlund</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Imreh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kost-Alimova</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Segmental duplications and evolutionary plasticity at tumor chromosome break-prone regions</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <issue>3</issue>
        <fpage>370</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.7010208</pub-id>
        <?supplied-pmid 18230801?>
        <pub-id pub-id-type="pmid">18230801</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kikuta</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Laplante</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Navratilova</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Komisarczuk</surname>
            <given-names>AZ</given-names>
          </name>
          <name>
            <surname>Engström</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Fredman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Akalin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Caccamo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sealy</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Howe</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ghislain</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pezeron</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mourrain</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ellingsen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Oates</surname>
            <given-names>A. C</given-names>
          </name>
          <name>
            <surname>Thisse</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thisse</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Foucher</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Adolf</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Geling</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lenhard</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Becker</surname>
            <given-names>TS</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Genomic regulatory blocks encompass multiple neighboring genes and maintain conserved synteny in vertebrates</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2007</year>
        <volume>17</volume>
        <issue>5</issue>
        <fpage>545</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.6086307</pub-id>
        <?supplied-pmid 17387144?>
        <pub-id pub-id-type="pmid">17387144</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irimia</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tena</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Alexis</surname>
            <given-names>M. S</given-names>
          </name>
          <name>
            <surname>Fernandez-Miñan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Maeso</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bogdanovic</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>de la Calle-Mustienes</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Gómez-Skarmeta</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>HB</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Extensive conservation of ancient microsynteny across metazoans due to cis-regulatory constraints</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>12</issue>
        <fpage>2356</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.139725.112</pub-id>
        <?supplied-pmid 22722344?>
        <pub-id pub-id-type="pmid">22722344</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bergeron</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Corteel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Raffinot</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>The algorithmic of gene teams</bold>
        </article-title>
        <source>Algorithms Bioinformatics</source>
        <year>2002</year>
        <volume>2452</volume>
        <fpage>464</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="doi">10.1007/3-540-45784-4_36</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luc</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Risler</surname>
            <given-names>J-L</given-names>
          </name>
          <name>
            <surname>Bergeron</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Raffinot</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Gene teams: a new formalization of gene clusters for comparative genomics</bold>
        </article-title>
        <source>Comput Biol Chem</source>
        <year>2003</year>
        <volume>27</volume>
        <issue>1</issue>
        <fpage>59</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1016/S1476-9271(02)00097-X</pub-id>
        <?supplied-pmid 12798040?>
        <pub-id pub-id-type="pmid">12798040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Goldwasser</surname>
            <given-names>MH</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Identifying conserved gene clusters in the presence of homology families</bold>
        </article-title>
        <source>J Comput Biology: J Comput Mol Cell Biol</source>
        <year>2005</year>
        <volume>12</volume>
        <issue>6</issue>
        <fpage>638</fpage>
        <lpage>656</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2005.12.638</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boyer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Morgat</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Labarre</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pothier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Viari</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Syntons, metabolons and interactons: an exact graph-theoretical approach for exploring neighbourhood between genomic and functional data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>23</issue>
        <fpage>4209</fpage>
        <lpage>4215</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti711</pub-id>
        <?supplied-pmid 16216829?>
        <pub-id pub-id-type="pmid">16216829</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hampson</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Gaut</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Baldi</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Statistical detection of chromosomal homology using shared-gene density alone</bold>
        </article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>8</issue>
        <fpage>1339</fpage>
        <lpage>1348</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ling</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Xin</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Detecting gene clusters under evolutionary constraint in a large number of genomes</bold>
        </article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>5</issue>
        <fpage>571</fpage>
        <lpage>577</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Suh</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Raney</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Burhans</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Blanchette</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Reconstructing contiguous regions of an ancestral genome</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2006</year>
        <volume>16</volume>
        <issue>12</issue>
        <fpage>1557</fpage>
        <lpage>1565</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.5383506</pub-id>
        <?supplied-pmid 16983148?>
        <pub-id pub-id-type="pmid">16983148</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>GRIMM genome rearrangements web server</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <issue>3</issue>
        <fpage>492</fpage>
        <lpage>493</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.3.492</pub-id>
        <?supplied-pmid 11934753?>
        <pub-id pub-id-type="pmid">11934753</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Proost</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fostier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dhoedt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Demeester</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Vandepoele</surname>
            <given-names>K</given-names>
          </name>
          <collab>De Witte D</collab>
        </person-group>
        <article-title>
          <bold>i-ADHoRe 3.0–fast and sensitive detection of genomic homology in extremely large data sets</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>2</issue>
        <fpage>11</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr955</pub-id>
        <pub-id pub-id-type="pmid">21908410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simillion</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vandepoele</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Van de Peer</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Building genomic profiles for uncovering segmental homology in the twilight zone</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2004</year>
        <volume>14</volume>
        <issue>6</issue>
        <fpage>1095</fpage>
        <lpage>1106</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.2179004</pub-id>
        <?supplied-pmid 15173115?>
        <pub-id pub-id-type="pmid">15173115</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Van de Peer</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Gregory</surname>
            <given-names>TR</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Chapter 6 - large-scale gene and ancient genome duplications</bold>
        </article-title>
        <source>The Evolution of the Genome</source>
        <year>2005</year>
        <publisher-loc>Burlington</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
        <fpage>340</fpage>
        <lpage>344</lpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vandepoele</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Simillion</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Van De Peer</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>The automatic detection of homologous regions (ADHoRe) and its application to microcolinearity between arabidopsis and rice</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <issue>11</issue>
        <fpage>1792</fpage>
        <lpage>1801</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.400202</pub-id>
        <?supplied-pmid 12421767?>
        <pub-id pub-id-type="pmid">12421767</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cannon</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Kozik</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Michelmore</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>ND</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>DiagHunter and GenoPix2D: programs for genomic comparisons, large-scale homology discovery and visualization</bold>
        </article-title>
        <source>Genome Biol</source>
        <year>2003</year>
        <volume>4</volume>
        <issue>10</issue>
        <fpage>68</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2003-4-10-r68</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hampson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gaut</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Baldi</surname>
            <given-names>P</given-names>
          </name>
          <collab>McLysaght A</collab>
        </person-group>
        <article-title>
          <bold>LineUp: statistical detection of chromosomal homology with application to plant comparative genomics</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2003</year>
        <volume>13</volume>
        <issue>5</issue>
        <fpage>999</fpage>
        <lpage>1010</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.814403</pub-id>
        <?supplied-pmid 12695327?>
        <pub-id pub-id-type="pmid">12695327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Calabrese</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Chakravarty</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vision</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Fast identification and statistical evaluation of segmental homologies in comparative maps</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <issue>suppl 1</issue>
        <fpage>74</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg1008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haas</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Wortman</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>DAGchainer: a tool for mining segmental genome duplications and synteny</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>18</issue>
        <fpage>3643</fpage>
        <lpage>3646</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth397</pub-id>
        <?supplied-pmid 15247098?>
        <pub-id pub-id-type="pmid">15247098</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soderlund</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Shoemaker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Paterson</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>SyMAP: a system for discovering and viewing syntenic regions ofFPC maps</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2006</year>
        <volume>16</volume>
        <issue>9</issue>
        <fpage>1159</fpage>
        <lpage>1168</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.5396706</pub-id>
        <?supplied-pmid 16951135?>
        <pub-id pub-id-type="pmid">16951135</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Kong</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Statistical inference of chromosomal homology based on gene colinearity and applications to arabidopsis and rice</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>447</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-447</pub-id>
        <?supplied-pmid 17038171?>
        <pub-id pub-id-type="pmid">17038171</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sinha</surname>
            <given-names>AU</given-names>
          </name>
          <name>
            <surname>Meller</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Cinteny: flexible analysis and visualization of synteny and genome rearrangements in multiple organisms</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>82</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-82</pub-id>
        <?supplied-pmid 17343765?>
        <pub-id pub-id-type="pmid">17343765</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zeng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Nesbitt</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Pei</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Vergara</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>OrthoCluster</bold>
        </article-title>
        <source>Proceedings of the 11th International Conference on Extending Database Technology Advances in Database Technology - EDBT ’08</source>
        <year>2008</year>
        <publisher-loc>New York, USA</publisher-loc>
        <publisher-name>ACM Press</publisher-name>
        <fpage>656</fpage>
        <lpage>656</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rödelsperger</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dieterich</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Syntenator: Multiple gene order alignments with a gene-specific scoring function</bold>
        </article-title>
        <source>Algorithms Mol Biol</source>
        <year>2008</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>14</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-3-14</pub-id>
        <?supplied-pmid 18990215?>
        <pub-id pub-id-type="pmid">18990215</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rödelsperger</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dieterich</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>CYNTENATOR: progressive gene order alignment of 17 vertebrate genomes</bold>
        </article-title>
        <source>PLoS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>8861</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0008861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Bowers</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Ming</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Alam</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paterson</surname>
            <given-names>AH</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Unraveling ancient hexaploidy through multiply-aligned angiosperm gene maps</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <issue>12</issue>
        <fpage>1944</fpage>
        <lpage>1954</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.080978.108</pub-id>
        <?supplied-pmid 18832442?>
        <pub-id pub-id-type="pmid">18832442</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Debarry</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Marler</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kissinger</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Paterson</surname>
            <given-names>AH</given-names>
          </name>
          <collab>Lee T-h</collab>
        </person-group>
        <article-title>
          <bold>MCScanX: a toolkit for detection and evolutionary analysis of gene synteny and collinearity</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>7</issue>
        <fpage>49</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr1293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Herrero</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Beal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fitzgerald</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Enredo and pecan: Genome-wide mammalian consistency-based multiple alignment with paralogs</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <issue>11</issue>
        <fpage>1814</fpage>
        <lpage>1828</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.076554.108</pub-id>
        <?supplied-pmid 18849524?>
        <pub-id pub-id-type="pmid">18849524</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pham</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>DRIMM-Synteny: decomposing genomes into evolutionary conserved segments</bold>
        </article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>20</issue>
        <fpage>2509</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Subsequences</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Identification of common molecular subsequences</bold>
        </article-title>
        <source>J Mol Biol</source>
        <year>1981</year>
        <volume>147</volume>
        <issue>1</issue>
        <fpage>195</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-2836(81)90087-5</pub-id>
        <?supplied-pmid 7265238?>
        <pub-id pub-id-type="pmid">7265238</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raghupathy</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hoberman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Two plus two does not equal three: statistical tests for multiple genome comparison</bold>
        </article-title>
        <source>J Bioinform Comput Biol</source>
        <year>2008</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1142/S0219720008003242</pub-id>
        <?supplied-pmid 18324742?>
        <pub-id pub-id-type="pmid">18324742</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sankoff</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Tests for gene clustering</bold>
        </article-title>
        <source>J Comput Biol: J Comput Mol Cell Biol</source>
        <year>2003</year>
        <volume>10</volume>
        <issue>3-4</issue>
        <fpage>453</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1089/10665270360688129</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoberman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sankoff</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>The statistical analysis of spatially clustered genes under the maximum gap criterion</bold>
        </article-title>
        <source>J Comput Biol: J Comput Mol Cell Biol</source>
        <year>2005</year>
        <volume>12</volume>
        <issue>8</issue>
        <fpage>1083</fpage>
        <lpage>1102</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2005.12.1083</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raghupathy</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Gene cluster statistics with gene families</bold>
        </article-title>
        <source>Mol Biol Evol</source>
        <year>2009</year>
        <volume>26</volume>
        <issue>5</issue>
        <fpage>957</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp002</pub-id>
        <?supplied-pmid 19150803?>
        <pub-id pub-id-type="pmid">19150803</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Basic local alignment search tool</bold>
        </article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <issue>3</issue>
        <fpage>403</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>
        <?supplied-pmid 2231712?>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kersey</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Christensen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Falin</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Grabmueller</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>DST</given-names>
          </name>
          <name>
            <surname>Humphrey</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kerhornou</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Khobova</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Langridge</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>McDowall</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Maheswari</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Maslen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Nuhn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ong</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Paulini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pedro</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Toneva</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Tuli</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Walts</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Youens-Clark</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Monaco</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ware</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bolser</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Howe</surname>
            <given-names>KL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>
          <bold>Ensembl Genomes 2013 scaling up access to genome-wide data</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <issue>Database issue</issue>
        <fpage>546</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt979</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vilella</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Severin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ureta-Vidal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Heng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>EnsemblCompara GeneTrees: complete, duplication-aware phylogenetic trees in vertebrates</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <issue>2</issue>
        <fpage>327</fpage>
        <lpage>335</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.073585.107</pub-id>
        <?supplied-pmid 19029536?>
        <pub-id pub-id-type="pmid">19029536</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
