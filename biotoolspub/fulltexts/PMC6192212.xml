<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6192212</article-id>
    <article-id pub-id-type="pmid">29092025</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx691</article-id>
    <article-id pub-id-type="publisher-id">btx691</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Simulating the dynamics of targeted capture sequencing with
CapSim</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cao</surname>
          <given-names>Minh Duc</given-names>
        </name>
        <xref ref-type="aff" rid="btx691-aff1">1</xref>
        <xref ref-type="author-notes" rid="btx691-FM2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ganesamoorthy</surname>
          <given-names>Devika</given-names>
        </name>
        <xref ref-type="aff" rid="btx691-aff1">1</xref>
        <xref ref-type="author-notes" rid="btx691-FM2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Chenxi</given-names>
        </name>
        <xref ref-type="aff" rid="btx691-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coin</surname>
          <given-names>Lachlan J M</given-names>
        </name>
        <xref ref-type="aff" rid="btx691-aff1">1</xref>
        <xref ref-type="aff" rid="btx691-aff2">2</xref>
        <xref ref-type="corresp" rid="btx691-cor1"/>
        <!--<email>l.coin@imb.uq.edu.au</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx691-aff1"><label>1</label>Institute for Molecular Bioscience, The University of Queensland,
Brisbane, St Lucia, Australia</aff>
    <aff id="btx691-aff2"><label>2</label>Department of Genomics of Common Disease, Imperial College London,
London, UK</aff>
    <author-notes>
      <fn id="btx691-FM2">
        <p>The authors wish it to be known that, in their opinion, Minh Duc Cao and Devika
Ganesamoorthy authors should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="btx691-cor1">To whom correspondence should be addressed. Email:
<email>l.coin@imb.uq.edu.au</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-10-28">
      <day>28</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 12 months and
						0 days and was based on the <pub-date
						pub-type="ppub"/>. -->
    <volume>34</volume>
    <issue>5</issue>
    <fpage>873</fpage>
    <lpage>874</lpage>
    <history>
      <date date-type="received">
        <day>05</day>
        <month>6</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>10</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>10</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Â© The Author 2017. Published by Oxford University Press. All rights
reserved. For Permissions, please e-mail:
journals.permissions@oup.com</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="https://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative
Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted
reuse, distribution, and reproduction in any medium, provided the original work is
properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx691.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Targeted sequencing using capture probes has become increasingly popular in clinical
applications due to its scalability and cost-effectiveness. The approach also allows for
higher sequencing coverage of the targeted regions resulting in better analysis
statistical power. However, because of the dynamics of the hybridization process, it is
difficult to evaluate the efficiency of the probe design prior to the experiments which
are time consuming and costly.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed CapSim, a software package for simulation of targeted sequencing. Given a
genome sequence and a set of probes, CapSim simulates the fragmentation, the dynamics of
probe hybridization and the sequencing of the captured fragments on Illumina and PacBio
sequencing platforms. The simulated data can be used for evaluating the performance of
the analysis pipeline, as well as the efficiency of the probe design. Parameters of the
various stages in the sequencing process can also be evaluated in order to optimize the
experiments.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>CapSim is publicly available under BSD license at <ext-link ext-link-type="uri" xlink:href="https://github.com/Devika1/capsim">https://github.com/Devika1/capsim</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are
available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Health and Medical Research
Council</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000925</named-content>
          <?release-delay 12|0?>
        </funding-source>
        <award-id>APP1052303</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>High-throughput sequencing (HTS) has tremendously revolutionized genomic studies for the
ability for cost- and time-effective characterization of the complete genetic information of
a sample. In many clinical applications, only a panel of actionable regions are the subject
for investigation (<xref rid="btx691-B1" ref-type="bibr">Bellos <italic>et al.</italic>,
2014</xref>; <xref rid="btx691-B5" ref-type="bibr">Samorodnitsky <italic>et al.</italic>,
2015</xref>). In these analyses, investigators often use a targeted capture sequencing
protocol where a pool of synthesized oligonucleotides (probes) are used to selectively
capture genomic fragments of interests using hybridization (<xref rid="btx691-B3" ref-type="bibr">Gnirke <italic>et al.</italic>, 2009</xref>) In an efficient design, only
DNA fragments from the targeted loci are sequenced. This allows for deeper sequence coverage
compared to whole genome sequencing at a much lower cost and faster time to results,
resulting in a scalable approach for use in clinical laboratories.</p>
    <p>Computational simulation has been indispensable in developing and benchmarking HTS data
analysis tools (<xref rid="btx691-B2" ref-type="bibr">Escalona <italic>et al.</italic>,
2016</xref>). Simulation data <italic>in silico</italic> are cheaper and faster to produce
than real data; they are generated under controlled conditions and can be perfectly
characterized. Furthermore, simulation also helps investigators to assess the performance of
sequencing protocols, and to optimize the design prior to performing experiments. While
numerous simulators are available for whole genome sequencing (<xref rid="btx691-B2" ref-type="bibr">Escalona <italic>et al.</italic>, 2016</xref>) and targeted exome
sequencing (<xref rid="btx691-B4" ref-type="bibr">Kim <italic>et al.</italic>, 2013</xref>),
to the best of our knowledge, there is currently no existing tool, which can simulate the
dynamics of the captured process <italic>in silico</italic>. We believe such a tool would be
useful for assessing not only the computational analysis pipeline, but also the efficiency
of a capture design.</p>
    <p>Here, we present CapSim, a software package to meet the need for simulating targeted
capture sequencing data. Given a set of probes, CapSim simulates the dynamics of probe
hybridization <italic>in silico</italic> to generate a set of fragments to be sequenced.
Unlike most existing HTS simulation tools, CapSim emulates all various stages of the
sequencing process, including fragmentation, fragment capture and sequencing. CapSim is
written in Java and is able to run natively on any computing platform, making it easily
accessible to bioinformatics community.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>The sequencing process starts with the fragmentation of the DNA, CapSim simulates this
process by iteratively sampling fragments from the genome sequence with a given length
distribution. We model the fragment length using a log-logistic distribution, which was
found to provide the best fit to the fragment size distributions from several datasets (See
<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p>
    <p>In the next step in targeted capture sequencing, the target probes bind to the fragments by
hybridization and the bound fragments are then pulled down by beads, which specifically
binds to the DNA fragments hybridized to the capture probes. CapSim simulates this process
by mapping the probes to the fragments. To be computationally efficient, CapSim first maps
the probes to the genome sequence and once a fragment is sampled from the genome, it uses a
greedy algorithm to determine the maximum number of probes that can bind to the fragment. We
model the stochastic nature of the capture process in which the probability of a fragment
being captured is proportional to the number of probes bound, and is inversely proportional
to the length of the fragment. This simulation of the dynamics of the hybridization is shown
to generate more realistic captured sequencing data than Wessim <xref rid="btx691-B4" ref-type="bibr">Kim <italic>et al.</italic> (2013)</xref>, the only existing tool for
simulating captured sequencing (see Results).</p>
    <p>The captured fragments are then subjected to <italic>in silico</italic> sequencing. For
Illumina sequencing, CapSim introduces a size distribution of fragments that form clusters
for sequencing. It uses a Log-Logistic distribution to sample from fragments simulated from
the capture step (see <xref ref-type="supplementary-material" rid="sup1">Supplementary
Material</xref>). These selected fragments are then used for sequencing simulation in
which reads are copied from the two ends of the fragments with errors introduced. For PacBio
sequencing, CapSim simulates polymerase read length from a given distribution (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). In simulating
the sequencing of a fragment, CapSim alternates copying the two strands with a PacBio error
profile, until reaching the polymerase read length.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We evaluated CapSim by comparing its simulation and real data from capture sequencing on
the same set of probes. We used Agilent SureSelect Target Enrichment kit to enrich the
targeted regions and performed capture sequencing on NA12878 sample on both Illumina and
PacBio sequencing platforms (See <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p>
    <p>Sequence coverage distribution between simulation data and real capture sequencing data
from Illumina sequencing are shown in <xref ref-type="fig" rid="btx691-F1">Figure 1</xref>
for various regions. Coverage distribution from CapSim simulation data closely resembles the
real sequencing data. Especially, <xref ref-type="fig" rid="btx691-F1">Figure 1b</xref>
shows an off-target capture (1âkb upstream of the target region) in test sample which was
detected by CapSim simulation data, however Wessim (<xref rid="btx691-B4" ref-type="bibr">Kim <italic>et al.</italic>, 2013</xref>) did not replicate the sequence coverage
distribution of real capture sequencing data and the off-target capture was not detected.
CapSim simulation detected 67% of the off-target regions from real capture data, whereas
Wessim only detected 8% of the off-target regions (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). CapSim
simulation for PacBio also closely resembles the real sequencing data (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). Wessim does
not support simulation of long read capture sequencing data. </p>
    <fig id="btx691-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>Sequence coverage distribution of Illumina sequencing data from real capture sequencing
data on test sample (first panel), capture simulation data from CapSim (second panel)
and WesSim (third panel). Position of the capture probes are shown in blue in the bottom
capture track panels. (<bold>a</bold>) and (<bold>b</bold>) are sequence coverage in
targeted regions and (<bold>c</bold>) is sequence coverage in an off-target region</p>
      </caption>
      <graphic xlink:href="btx691f1"/>
    </fig>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>In this manuscript, we have introduced CapSim a tool for simulation of targeted capture
sequencing on both Illumina and PacBio platforms. Unlike most existing HTS data simulators,
CapSim provides parameters for controlling each intermediate stages, allowing users to
evaluate the effects of the experiment design before running the experiment (details in
GitHub). Once sequencing reads are simulated using CapSim, users can align the reads to the
reference genome and assess the performance of the capture design. A customized script to
identify probes leading to off-target capture is also provided with CapSim (details in
GitHub). This will allow users to identify probes which needs to be removed from the design
to reduce the off-target capture to improve their design. We believe CapSim is applicable
for all hybridization based capture methods, however the data presented in here was
simulated with Agilent XT and more assessment needs to be performed to determine if the
simulation data could be comparable for other capture methods.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>The research is supported by funding from the National Health and Medical Research Council
(APP1052303).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx691_capsim_cao-et-al_supplementary.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btx691-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bellos</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>cnvcapseq: detecting copy number
variation in long-range targeted resequencing data</article-title>. <source>Nucleic
Acids Res</source>., <volume>42</volume>,
<fpage>e158</fpage>â<lpage>e158</lpage>.<pub-id pub-id-type="pmid">25228465</pub-id></mixed-citation>
    </ref>
    <ref id="btx691-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Escalona</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>A comparison of tools for the
simulation of genomic next-generation sequencing data</article-title>. <source>Nat. Rev.
Genet</source>., <volume>17</volume>,
<fpage>459</fpage>â<lpage>469</lpage>.<pub-id pub-id-type="pmid">27320129</pub-id></mixed-citation>
    </ref>
    <ref id="btx691-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gnirke</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Solution hybrid selection with
ultra-long oligonucleotides for massively parallel targeted sequencing</article-title>.
<source>Nat. Biotechnol</source>., <volume>27</volume>,
<fpage>182</fpage>â<lpage>189</lpage>.<pub-id pub-id-type="pmid">19182786</pub-id></mixed-citation>
    </ref>
    <ref id="btx691-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kim</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) <article-title>Wessim: a whole-exome sequencing
simulator based on in silico exome capture</article-title>.
<source>Bioinformatics</source>, <volume>29</volume>,
<fpage>1076</fpage>â<lpage>1077</lpage>.<pub-id pub-id-type="pmid">23413434</pub-id></mixed-citation>
    </ref>
    <ref id="btx691-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Samorodnitsky</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Comparison of custom capture for
targeted next-generation dna sequencing</article-title>. <source>J. Mol.
Diagn</source>., <volume>17</volume>,
<fpage>64</fpage>â<lpage>75</lpage>.<pub-id pub-id-type="pmid">25528188</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
