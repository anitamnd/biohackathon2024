<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName archivearticle.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName nlm2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Bioinform.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2673-7647</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9580871</article-id>
    <article-id pub-id-type="publisher-id">897238</article-id>
    <article-id pub-id-type="doi">10.3389/fbinf.2022.897238</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
        <subj-group>
          <subject>Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>An Image Analysis Pipeline for Quantifying the Features of Fluorescently-Labeled Biomolecular Condensates in Cells</article-title>
      <alt-title alt-title-type="left-running-head">Baggett et al.</alt-title>
      <alt-title alt-title-type="right-running-head">Punctatools: Biomolecular Condensates Analysis Pipeline</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Baggett</surname>
          <given-names>David W.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="fn1" ref-type="author-notes">
          <sup>†</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1563978/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Medyukhina</surname>
          <given-names>Anna</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="fn1" ref-type="author-notes">
          <sup>†</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1074969/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tripathi</surname>
          <given-names>Swarnendu</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="fn1" ref-type="author-notes">
          <sup>†</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1795964/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shirnekhi</surname>
          <given-names>Hazheen K.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1722837/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Huiyun</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">
          <sup>3</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1755301/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pounds</surname>
          <given-names>Stanley B.</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">
          <sup>3</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/305900/overview"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Khairy</surname>
          <given-names>Khaled</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="c001" ref-type="corresp">*</xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1058464/overview"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Kriwacki</surname>
          <given-names>Richard</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff4" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="c001" ref-type="corresp">*</xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1830437/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Department of Structural Biology</institution>, <institution>St. Jude Children’s Research Hospital</institution>, <addr-line>Memphis</addr-line>, <addr-line>TN</addr-line>, <country>United States</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Center for Bioimage Informatics</institution>, <institution>St. Jude Children’s Research Hospital</institution>, <addr-line>Memphis</addr-line>, <addr-line>TN</addr-line>, <country>United States</country></aff>
    <aff id="aff3"><sup>3</sup><institution>Department of Biostatistics</institution>, <institution>St. Jude Children’s Research Hospital</institution>, <addr-line>Memphis</addr-line>, <addr-line>TN</addr-line>, <country>United States</country></aff>
    <aff id="aff4"><sup>4</sup><institution>Integrated Biomedical Sciences Program</institution>, <institution>The University of Tennessee Science Center</institution>, <addr-line>Memphis</addr-line>, <addr-line>TN</addr-line>, <country>United States</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p><bold>Edited by:</bold><ext-link xlink:href="https://loop.frontiersin.org/people/369374/overview" ext-link-type="uri">Jan Eglinger</ext-link>, Friedrich Miescher Institute for Biomedical Research (FMI), Switzerland</p>
      </fn>
      <fn fn-type="edited-by">
        <p><bold>Reviewed by:</bold><ext-link xlink:href="https://loop.frontiersin.org/people/1445974/overview" ext-link-type="uri">Beth A. Cimini</ext-link>, Broad Institute, United States</p>
        <p>Barbara Diaz-Rohrer, Broad Institute, United States, contributed to the review of BC</p>
        <p><ext-link xlink:href="https://loop.frontiersin.org/people/1066489/overview" ext-link-type="uri">Martin Weigert</ext-link>, Swiss Federal Institute of Technology Lausanne, Switzerland</p>
      </fn>
      <corresp id="c001">*Correspondence: Khaled Khairy, <email>khaled.khairy@stjude.org</email>; Richard Kriwacki, <email>richard.kriwacki@stjude.org</email>
</corresp>
      <fn fn-type="equal" id="fn1">
        <label>
          <sup>†</sup>
        </label>
        <p>These authors have contributed equally to this work</p>
      </fn>
      <fn fn-type="other">
        <p>This article was submitted to Computational BioImaging, a section of the journal Frontiers in Bioinformatics</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>06</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>2</volume>
    <elocation-id>897238</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="publishedonline">
        <day>12</day>
        <month>5</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2022 Baggett, Medyukhina, Tripathi, Shirnekhi, Wu, Pounds, Khairy and Kriwacki.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Baggett, Medyukhina, Tripathi, Shirnekhi, Wu, Pounds, Khairy and Kriwacki</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Biomolecular condensates are cellular organelles formed through liquid-liquid phase separation (LLPS) that play critical roles in cellular functions including signaling, transcription, translation, and stress response. Importantly, condensate misregulation is associated with human diseases, including neurodegeneration and cancer among others. When condensate-forming biomolecules are fluorescently-labeled and examined with fluorescence microscopy they appear as illuminated foci, or puncta, in cells. Puncta features such as number, volume, shape, location, and concentration of biomolecular species within them are influenced by the thermodynamics of biomolecular interactions that underlie LLPS. Quantification of puncta features enables evaluation of the thermodynamic driving force for LLPS and facilitates quantitative comparisons of puncta formed under different cellular conditions or by different biomolecules. Our work on nucleoporin 98 (NUP98) fusion oncoproteins (FOs) associated with pediatric leukemia inspired us to develop an objective and reliable computational approach for such analyses. The NUP98-HOXA9 FO forms hundreds of punctate transcriptional condensates in cells, leading to hematopoietic cell transformation and leukemogenesis. To quantify the features of these puncta and derive the associated thermodynamic parameters, we developed a live-cell fluorescence microscopy image processing pipeline based on existing methodologies and open-source tools. The pipeline quantifies the numbers and volumes of puncta and fluorescence intensities of the fluorescently-labeled biomolecule(s) within them and generates reports of their features for hundreds of cells. Using a standard curve of fluorescence intensity versus protein concentration, the pipeline determines the apparent molar concentration of fluorescently-labeled biomolecules within and outside of puncta and calculates the partition coefficient (K<sub>p</sub>) and Gibbs free energy of transfer (ΔG<sub>Tr</sub>), which quantify the favorability of a labeled biomolecule partitioning into puncta. In addition, we provide a library of R functions for statistical analysis of the extracted measurements for certain experimental designs. The source code, analysis notebooks, and test data for the Punctatools pipeline are available on GitHub: <ext-link xlink:href="https://github.com/stjude/punctatools" ext-link-type="uri">https://github.com/stjude/punctatools</ext-link>. Here, we provide a protocol for applying our Punctatools pipeline to extract puncta features from fluorescence microscopy images of cells.</p>
    </abstract>
    <kwd-group>
      <kwd>fluorescence microscopy</kwd>
      <kwd>biomolecular condensate</kwd>
      <kwd>liquid-liquid phase separation</kwd>
      <kwd>image analysis</kwd>
      <kwd>puncta features</kwd>
      <kwd>open-source software</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>The biomolecular components of cells are compartmentalized within organelles and other structures, wherein they perform their biological functions. While many cellular compartments enclose their components within bilayer membranes, others lack a membrane and are referred to as membrane-less organelles or biomolecular condensates. These membrane-less compartments commonly form in cells through the process of liquid-liquid phase separation (LLPS), through which biomolecules exist within two distinct phases, a so-called “light phase” with low biomolecule concentrations and a “dense phase” wherein biomolecules are more highly concentrated (<xref rid="B7" ref-type="bibr">Flory and Krigbaum, 1951</xref>; <xref rid="B2" ref-type="bibr">Banani et al., 2017</xref>). Depending upon the relative thermodynamic favorability of homotypic versus heterotypic interactions, LLPS causes the formation of cellular biomolecular condensates highly enriched in a single species or others containing multiple components (<xref rid="B18" ref-type="bibr">Riback et al., 2020</xref>). The thermodynamic favorability and kinetics of the multivalent biomolecular interactions that drive LLPS influence the physical features of the resulting condensates, including their size, shape, material properties (e.g., viscosity and surface tension) and extent of partitioning of biomolecules within them, quantified by the partition coefficient (K<sub>p</sub>) (<xref rid="B6" ref-type="bibr">Feric et al., 2016</xref>; <xref rid="B15" ref-type="bibr">Mitrea et al., 2016</xref>; <xref rid="B18" ref-type="bibr">Riback et al., 2020</xref>). Recognition that biomolecules within large portions of the cell interior are organized through LLPS has revolutionized the fields of cell and structural biology.</p>
    <p>Liquid-liquid phase separation by biomolecules has been recognized since 2009, first in the context of live cells (<xref rid="B4" ref-type="bibr">Brangwynne et al., 2009</xref>) and later in reconstituted systems with purified components (<xref rid="B12" ref-type="bibr">Li et al., 2012</xref>). While many experimental techniques are used to study the process of LLPS (<xref rid="B14" ref-type="bibr">Mitrea et al., 2018</xref>), fluorescence microscopy of biomolecular condensates containing fluorescently-labeled components has emerged as a primary method. Commonly, proteins are genetically encoded with a fluorescent protein label (e.g., green fluorescent protein, GFP) (<xref rid="B8" ref-type="bibr">Giepmans et al., 2006</xref>) and expressed in live cultured cells for studies of biomolecular condensates. Performing confocal fluorescence microscopy in live cells preserves active biological processes and biomolecular dynamics, and enables quantitation of physical features of condensates containing fluorescently-labeled components, including number, size and shape, as well as their material (<xref rid="B6" ref-type="bibr">Feric et al., 2016</xref>) and thermodynamic (<xref rid="B18" ref-type="bibr">Riback, et al., 2020</xref>) properties. The extent to which proteins partition into condensates is quantified by the partition coefficient (K<sub>p</sub>), mentioned above, which is the ratio of dense phase and light phase concentrations ([DP] and [LP], respectively; K<sub>p</sub> = [DP]/[LP]). The thermodynamic favorability of protein partitioning into condensates is expressed as the Gibbs free energy of transfer (ΔG<sub>Tr</sub> = -RT•ln (K<sub>p</sub>)) (<xref rid="B18" ref-type="bibr">Riback et al., 2020</xref>). Thus, fluorescence microscopy not only allows quantitation of physical features of biomolecular condensates (e.g., their number and size in cells) but by noting the relative difference of labeled material within and outside of condensates, it can also quantify the driving force underlying their formation through LLPS (ΔG<sub>Tr</sub>). Access to these types of quantitative information obtained through live cell fluorescence imaging enables rigorous comparison of condensates formed through phase separation under different cellular conditions, or by different fluorescently-labeled proteins. Studies that derive these biophysical parameters have been reliant on manual determination of puncta features, performed in simplified systems, or used custom-made scripts to perform analyses. As these approaches are labor-intensive and subject to user error, the field of biological condensates can benefit from automated analysis of fluorescence microscopy images to quantify puncta within cells and extract biophysical parameters.</p>
    <p>NUP98 fusion oncoproteins arise through gene translocations that fuse the N-terminal protein coding region of <italic>NUP98</italic> to C-terminal coding regions of &gt; 30 different genes that commonly encode DNA binding or chromatin binding protein domains (<xref rid="B13" ref-type="bibr">Michmerhuizen et al., 2020</xref>) and are oncogenic drivers in ∼10% of pediatric cases of acute myeloid leukemia (AML) (<xref rid="B13" ref-type="bibr">Michmerhuizen et al., 2020</xref>). NUP98 fusion oncoproteins direct formation of DNA/chromatin-associated condensates, which recent studies (<xref rid="B1" ref-type="bibr">Ahn et al., 2021</xref>; <xref rid="B5" ref-type="bibr">Chandra et al., 2022</xref>) showed drive aberrant gene expression, transformation of hematopoietic cells, and leukemogenesis. NUP98-HOXA9 (abbreviated NHA9) is a prototypical NUP98 fusion oncoprotein that, when labelled with monomeric EGFP (termed G-NHA9), was visualized using confocal fluorescence microscopy to form hundreds of dense puncta in the nuclei of live cells. We initially applied the 3D object counter plugin of FIJI (<xref rid="B3" ref-type="bibr">Bolte and Cordelieres, 2006</xref>) to three-dimensional z stacks of live cell fluorescence microscopy images to obtain features of puncta formed by G-NHA9. However, the outcome of this analysis was poor, and therefore we were motivated to develop a customized image analysis pipeline (termed “Punctatools”). Herein we discuss the development of the Punctatools pipeline and its application to puncta formed by G-NHA9 in HEK293T cells, as well as those formed by mutant forms of G-NHA9. We demonstrate that the pipeline allows accurate segmentation of nuclear puncta formed by the G-NHA9 constructs and extraction of the associated quantitative puncta features. Access to this information enabled us to understand how the different interaction mechanisms contributing to LLPS by G-NHA9 govern puncta formation in cells. Accompanying this manuscript, we provide the computer code associated with the Punctatools image analysis pipeline, as well as scripts for performing standard analyses of puncta features and associated statistical analyses.</p>
  </sec>
  <sec id="s2">
    <title>Materials and Equipment</title>
    <sec id="s2-1">
      <title>Reagents and Equipment</title>
      <p>Example data were prepared using HEK293T cells (American Type Culture Collection; RRID:CVCL_0063) transfected with three different previously reported monomeric EGFP (mEGFP)-labeled NHA9 constructs, G-NHA9 (the wild-type fusion oncoprotein), G-NHA9-21FGAA (with alanine mutations in 21 FG motifs), and G-NHA9-ΔDNA (with mutations in the HOXA9 homeodomain that abrogate DNA binding) (<xref rid="B5" ref-type="bibr">Chandra et al., 2022</xref>). Immediately prior to imaging, cell culture media was replaced with phenol red-free imaging media supplemented with Hoechst dye (Thermofisher: CAT R37605 and 21063045, respectively) to enable visualization of cell nuclei using high-resolution fluorescence microscopy. Imaging was performed using a 3i Marianas microscope system equipped with a 100X objective, 405 nm (for Hoechst dye) and 488 nm (for mEGFP-labeled proteins) laser lines, and Slidebook 6.0 software. Full details on the preparation and imaging of cells, including reagents, procedures, and acquisition methods were reported previously (<xref rid="B5" ref-type="bibr">Chandra et al., 2022</xref>). We also generated purified mEGFP and prepared solutions at concentrations ranging from 1 nM to 100 μM; these solutions were individually imaged using the same microscope settings as used for cell imaging. The image results were analyzed and plotted to give a standard curve of the relationships between fluorescence intensity per square pixel in a single <italic>z</italic>-layer image slice and molar mEGFP concentration. These relationships were linear and were used to convert fluorescence intensities within regions of interest (ROIs) and puncta in cell images to molar mEGFP concentrations.</p>
    </sec>
    <sec id="s2-2">
      <title>Software</title>
      <p>The image analysis pipeline utilizes Python and is compatible with versions 3.7–3.9 (<xref rid="B23" ref-type="bibr">Van Rossum and Drake, 2009</xref>). The analysis relies on use of the Punctatools package developed herein and its dependencies. For instructions on how to install Punctatools, please refer to the package’s Github page <ext-link xlink:href="https://github.com/stjude/punctatools" ext-link-type="uri">https://github.com/stjude/punctatools</ext-link>. All dependencies will be installed automatically when running the installation script. Microscopy images as well as cell and puncta masks were examined using FIJI (<xref rid="B19" ref-type="bibr">Schindelin et al., 2012</xref>) (<ext-link xlink:href="https://imagej.net/software/fiji/" ext-link-type="uri">https://imagej.net/software/fiji/</ext-link>). The FIJI package 3D-object counter (<xref rid="B3" ref-type="bibr">Bolte and Cordelieres, 2006</xref>) was used to generate independent puncta segmentations for comparison against Punctatools pipeline results. R-studio (R 4.1.0) (R Development Core Team, 2019) was used to plot puncta features, calculate thermodynamic parameters, and perform statistical analysis.</p>
    </sec>
  </sec>
  <sec sec-type="methods" id="s3">
    <title>Methods</title>
    <p>The Punctatools workflow can be divided into four stages (<xref rid="F1" ref-type="fig">Figure 1</xref>): Sample Preparation and Image acquisition (Steps 1–3), Optional ROI Segmentation (Steps 4 and 5), Puncta segmentation and quantification (Steps 6–8) and Results Analysis (Steps 9–11).</p>
    <fig position="float" id="F1">
      <label>FIGURE 1</label>
      <caption>
        <p>The Punctatools image analysis pipeline. After samples are prepared and image stacks are acquired (Steps 1–3), users are first given the option to segment regions of interest (ROIs) using Cellpose (Steps 4 and 5). Following this, puncta centers are identified from raw puncta signals, and puncta are segmented from the background (Steps 6–8). Users are given the option to establish a signal to concentration ratio (Step 9), which can be used when calculating thermodynamic features (Step 10) and making statistical comparisons (Step 11). Optional steps are highlighted by light-blue background. Average mEGFP concentrations shown on the graph <italic>x</italic>-axes are estimates derived from calibration and are subject to the limitations of this calibration as noted in the main text.</p>
      </caption>
      <graphic xlink:href="fbinf-02-897238-g001" position="float"/>
    </fig>
    <sec id="s3-1">
      <title>Step 1: Preparation of Samples</title>
      <p>The NHA9 fusion oncoproteins used in our puncta imaging studies were fluorescently-labeled at the N-terminus with mEGFP and expressed through transient transfection in HEK293T cells using CL20 backbone plasmids (<xref rid="B5" ref-type="bibr">Chandra et al., 2022</xref>). While mEGFP was used in our studies, fluorescent proteins with different spectral properties are available (<xref rid="B8" ref-type="bibr">Giepmans et al., 2006</xref>). The G-NHA9 proteins form puncta in the nuclei of HEK293T cells; we used Hoechst dye to fluorescently label DNA and enable segmentation of nuclei. To enable conversion of mEGFP fluorescence intensity values for G-NHA9 proteins within and outside puncta to molar concentrations, we determined a standard fluorescence intensity curve by performing fluorescence microscopy imaging with solutions containing purified mEGFP protein at concentrations ranging from 1 nM to 100 μM (<xref rid="B5" ref-type="bibr">Chandra et al., 2022</xref>).</p>
    </sec>
    <sec id="s3-2">
      <title>Step 2: Acquisition of images</title>
      <p>Data for the G-NHA9 proteins were collected as 3D z-stacks with pixel size of 0.11 µm in the x- and y-dimensions (total image dimensions were 992 pixels by 992 pixels in the x- and y-dimensions, respectively) and 0.2 µm spacing between planes in the z-dimension, spanning a total z-dimension height of 12 µm. We record 3D z-stacked images at 15 to 20 different positions within the field of view for each condition (e.g., for each of three G-NHA9 protein constructs, wild-type and two mutants). Additional experimental details can be found in our published work (<xref rid="B5" ref-type="bibr">Chandra et al., 2022</xref>). The Punctatools pipeline is also capable of analyzing 2D images (a single z-plane), although many of the extracted parameters such as those dealing with volume will have reduced accuracy. Using the above protocol, we obtained images of hundreds of cells displaying fluorescently-labeled nuclear puncta. The number of cell positions that need to be imaged will vary based on transient transfection efficiency and cell confluency. In our studies, we imaged between 50–250 cells that displayed fluorescent signals for each condition to achieve sufficient statistical power for comparisons.</p>
      <p>As a guideline, the microscope objective used should be capable of x-, y- and <italic>z</italic>-axis resolutions that are less than the minimum dimensions of the puncta being quantified. Post processing methods such as deconvolution should not prohibit analysis with our pipeline, but care should be taken to account for any artifacts generated by such techniques. We note that the accuracy of data generated by this pipeline will be directly impacted by quality of the microscopy images being analyzed.</p>
    </sec>
    <sec id="s3-3">
      <title>Step 3: Data staging</title>
      <p>To process an image and quantify puncta features within, our pipeline requires all of the information for each field of view to be in a single file. If possible, users are encouraged to export data from the microscopy software as a single z-stack including all optical channels. This is the simplest way to prepare data for processing with this pipeline. We have also identified two alternative cases and provide tools to prepare data in the proper format.</p>
      <p>If the data is in a format that includes multiple positions or timepoints in a single file (for example, using the Slidebook format), tiff files for individual positions can be extracted using an in-house developed FIJI macro we provide in the distribution. First, create a directory to store the extracted files, then run the conversion macro “export_multipage.ijm” and specify a target location for the new extracted files when asked. The macro will then convert the multi-stack file into individual z-stacks compatible with this pipeline.</p>
      <p>If data is formatted as a single image for each z-slice and each channel, it can be reformatted into single z-stacks for each acquisition. To do this, first ensure that the files adhere to a consistent naming convention. File names should include the [SAMPLE_NAME] which denotes a unique acquisition. In addition to the sample name, there should be specific identifiers for the z position (e.g., “_Z”) and channel (e.g., “_C”) that immediately precede the channel and z position numbers, respectively. An example of a properly formatted image name is: “my_sample_position_3_Z00_C01.tif”. Once these files are prepared and properly named, open the “notebooks/setup_images_to_stack.ipynb” notebook and follow the included instructions to adjust the conversion parameters (such as channel code and z-position code). You will have an option to specify pixel size and z-spacing if they are missing from the image metadata. Providing correct values for these parameters is critical for determination of accurate puncta volumes. The output of this notebook will be a (json format text) file with conversion parameters. After creating this parameter file, open the “notebooks/run_images_to_stack.ipynb” notebook, specify the path to the json parameter file generated in the previous step, and run the notebook to convert the entire dataset into compiled tiff files.</p>
      <p>Once image input files are properly formatted, they can be divided into folders where each folder denotes a different condition (e.g. “condition1/my_sample_position_3_Z00_C01. tif”). The pipeline will note the name of each folder and include this information in the final output files, allowing for easy comparison between conditions.</p>
    </sec>
    <sec id="s3-4">
      <title>Optional Step 4: Set-Up ROI (Cell/Nuclei) Segmentation</title>
      <p>Segmentation of ROIs allows for the analysis and quantification of individual regions such as cells or nuclei. The Punctatools pipeline utilizes Cellpose (<xref rid="B21" ref-type="bibr">Stringer et al., 2021</xref>) to segment ROIs using fluorescence signals. To adjust the segmentation parameters, first open the “notebooks/setup_cell_segmentation.ipynb” notebook and follow the instructions to specify the path to the converted dataset, channel of interest, approximate ROI size, and the parameters for the Cellpose algorithm (<xref rid="T1" ref-type="table">Table 1</xref>). We recommend that users start with default values for segmentation parameters; in most cases these will provide sufficient accuracy for cell/nuclei segmentation. After specifying segmentation parameters, the setup notebook performs an example ROI segmentation that can be used to verify and adjust the parameters (see <xref rid="T1" ref-type="table">Table 1</xref> for details). We recommend that users repeat this step for several example images to ensure that segmentation results are consistently satisfactory. Once appropriate parameters have been determined, execute the rest of the notebook, which will save the adjusted parameter values to a json file which is used in subsequent steps.</p>
      <table-wrap position="float" id="T1">
        <label>TABLE 1</label>
        <caption>
          <p>List of parameters for ROI segmentation (setup_roi_segmentation.ipynb).</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead valign="top">
            <tr>
              <th align="left" rowspan="1" colspan="1">Parameter</th>
              <th align="center" rowspan="1" colspan="1">Definition</th>
              <th align="center" rowspan="1" colspan="1">Recommended initial value</th>
              <th align="center" rowspan="1" colspan="1">Notes</th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" rowspan="1" colspan="1">Input_dir</td>
              <td align="left" rowspan="1" colspan="1">Directory with images to be analyzed</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">All z-layers and channels for a specific sample must be combined into a single file (see Step 3 of the Protocol Procedure).</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Output_dir</td>
              <td align="left" rowspan="1" colspan="1">Directory to save ROI segmentation results</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">ROI masks will be added as an extra channel to the input image and saved in this directory.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Channel</td>
              <td align="left" rowspan="1" colspan="1">Channel index, starting from 0, that will be used to segment ROIs</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Cellpose allows using nuclei channel to improve whole-cell segmentation. To use this option, provide two channel indices as a list, where the first index corresponds to the nuclei staining, and the second index corresponds to the cytoplasm staining<break/>Examples: 0–the first channel will be used to segment ROIs (either cells or nuclei) [1, 0]–the second channel (1) will be used as an auxiliary nuclei stain, the first channel (0) will be used to segment whole cells.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Diameter</td>
              <td align="left" rowspan="1" colspan="1">Target ROI (cell or nucleus) diameter in pixels</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">An example image displayed in the notebook will contain scale in pixels to help determine the target ROI diameter. Set to None to automatically detect the ROI diameter.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Model_type</td>
              <td align="left" rowspan="1" colspan="1">Cellpose model to use for segmentation: ‘nuclei’ for nucleus segmentation, “cyto” or “cyto2” for cell segmentation</td>
              <td align="left" rowspan="1" colspan="1">cyto</td>
              <td align="left" rowspan="1" colspan="1">We found that “cyto” and “cyto2” models work better than “nuclei” for segmenting nuclei with irregular shapes.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Gpu</td>
              <td align="left" rowspan="1" colspan="1">If True, cellpose segmentation will run on GPU; if False, cellpose will use CPU</td>
              <td align="left" rowspan="1" colspan="1">True</td>
              <td align="left" rowspan="1" colspan="1">GPU processing is significantly faster; use gpu = True whenever possible.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Do_3D</td>
              <td align="left" rowspan="1" colspan="1">If True, cellpose segmentation is performed in 3D; if False, cellpose segments ROIs in each individual z-layer, and the ROIs are combined in 3D in the postprocessing</td>
              <td align="left" rowspan="1" colspan="1">False</td>
              <td align="left" rowspan="1" colspan="1">3D segmentation is resource intensive, though sometimes more accurate. If do_3D = True results in “CUDA out of memory” error, either set do_3D = False, or set gpu = False.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Flow_threshold</td>
              <td align="left" rowspan="1" colspan="1">Cellpose parameter: the maximum allowed error of the flows for each mask</td>
              <td align="left" rowspan="1" colspan="1">0.4</td>
              <td align="left" rowspan="1" colspan="1">Advanced parameter. Increase if cellpose returns too few masks; decrease if cellpose returns too many ill-shaped masks.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">cellprob_threshold</td>
              <td align="left" rowspan="1" colspan="1">Cellpose parameter: defines which pixels are used to run dynamics and determine masks</td>
              <td align="left" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">Advanced parameter. Decrease if cellpose returns too few ROIs; increase if cellpose returns too many ROIs; values should be between -6 and 6.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Remove_small_mode</td>
              <td align="left" rowspan="1" colspan="1">"2D”, or “3D”. Used to remove small ROIs by volume (3D) or area (2D)</td>
              <td align="left" rowspan="1" colspan="1">3D</td>
              <td align="left" rowspan="1" colspan="1">Set to “3D” unless testing on cropped images. Set to “2D” if the image contains only a few z-layers. If set to “3D”, small ROIs are excluded based on volume; this will exclude a ROI if only small part of it is contained in the field of view.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Remove_small_diam_fraction</td>
              <td align="left" rowspan="1" colspan="1">Size threshold used to exclude small ROIs, provided as a fraction of the “diameter” parameter</td>
              <td align="left" rowspan="1" colspan="1">0.5</td>
              <td align="left" rowspan="1" colspan="1">Advanced parameter. Increase to remove more ROIs, decrease remove fewer ROIs.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Parameter_file</td>
              <td align="left" rowspan="1" colspan="1">File name used to save the parameter values</td>
              <td align="left" rowspan="1" colspan="1">Parameters.json</td>
              <td align="left" rowspan="1" colspan="1">May include a complete path, or only a file name. If only a file name without path is provided, the file will be saved in the directory of the notebook.</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="s3-5">
      <title>Optional Step 5: Segment ROIs</title>
      <p>Once the setup_cell_segmentation notebook has been executed and a parameter file has been generated for ROI segmentation, in order to perform that segmentation on the entire dataset simply open the “notebooks/run_cell_segmentation.ipynb” notebook and direct it to the parameter file created in Step 4. Running the notebook will then segment all of the ROIs as specified in the parameter file and output a new set of tiff files that include an additional layer of ROI masks.</p>
    </sec>
    <sec id="s3-6">
      <title>Step 6: Set-Up Puncta Segmentation</title>
      <p>Puncta segmentation is done by first setting up parameters using the “notebooks/setup_puncta_analysis.ipynb” notebook. This notebook begins with instructions to specify input files. If ROI segmentation was done, specify the parameter file created at the end of Step 4 and the information from that file will be imported into the notebook, including the ROI segmented input images. Otherwise, specify a set of compiled z-stack image files as in Step 3. The notebook will then guide users through selecting a test image, specifying channels of interest for puncta segmentation, and preparing a small image region to test parameters. The first step of puncta segmentation is the detection of puncta centers using a Laplacian of Gaussian (LoG) blob detector. The LoG threshold detection parameter will dictate the sensitivity of the algorithm, with smaller values resulting in more puncta centers being identified, and larger values resulting in fewer puncta centers (<xref rid="F2" ref-type="fig">Figure 2A</xref>). Following identification of puncta centers, the pipeline will refine this selection by comparing their intensities against ROI fluorescent background. The background level is calculated one of two ways: the same value can be used for all cells (Global Background = True, <xref rid="F2" ref-type="fig">Figure 2B</xref>) or each cell can have a unique background intensity level (Global Background = False, <xref rid="F2" ref-type="fig">Figure 2C</xref>).</p>
      <fig position="float" id="F2">
        <label>FIGURE 2</label>
        <caption>
          <p>Setting-up puncta centers detection. <bold>(A)</bold> Puncta in fluorescence microscopy images are first identified using a Laplacian of Gaussian (LoG) filter; the detection sensitivity is determined by the LoG “threshold detection” parameter. Puncta centers identified in an image substack for cells expressing G-NHA9 (i) using three settings of the LoG “threshold_detection” parameter are shown (ii–iv). Detection of puncta centers can be further refined through adjustment of background filtering parameters, as illustrated in <bold>(B)</bold> and <bold>(C)</bold>. The examples in <bold>(B)</bold> and <bold>(C)</bold> used a LoG “threshold detection” value of 0.003, as shown in <bold>(A)</bold>, panel iii (blue dashed box). These data are also shown on the left (i) in panels <bold>(B)</bold> and <bold>(C)</bold>. In <bold>(B)</bold> puncta centers were identified using the Global Background (BG) = “True” option, and a range of values of the background (BG) threshold parameter (ii–iv). In <bold>(C)</bold>, puncta centers were identified using the Global Background (BG) = “False” option, and a range of values of the background threshold parameter (ii-iv). With the Global Background (BG) = “True” option <bold>(B)</bold>, a fixed background threshold is applied to all ROI (cell nuclei) in the image, while with the “False” option <bold>(C)</bold>, the background threshold value is calculated for each ROI (cell nucleus) individually.</p>
        </caption>
        <graphic xlink:href="fbinf-02-897238-g002" position="float"/>
      </fig>
      <p>Following this, the notebook guides the user through adjusting the puncta segmentation parameters, beginning with the segmentation mode (<xref rid="F3" ref-type="fig">Figure 3</xref>). If no ROIs have been segmented (Steps 4–5), set the segmentation mode to 0; this will analyze all puncta in LoG space using the same parameters according to the user defined segmentation threshold value. If ROIs have been segmented, you may choose mode 1 or 2; this will adjust the segmentation threshold depending on the background fluorescence in the ROIs. Mode 1 will segment puncta based on the LoG transformed image, while Mode 2 will segment puncta based on the original intensity values. This step may result in removal of some additional puncta detected after the previous step. Follow the guidelines in the notebook and <xref rid="T2" ref-type="table">Table 2</xref>, and inspect the output results to choose an adequate segmentation mode and threshold value for each channel of interest. Following this, additional filters such as the maximum allowed size of puncta and whether puncta outside of ROIs should be removed can be specified. The final parts of this setup protocol are to specify the names of input image channels and the output parameter file (if different from the input parameter file). Execute these parts of the notebook to save the adjusted parameter values, which will be used in the next step.</p>
      <fig position="float" id="F3">
        <label>FIGURE 3</label>
        <caption>
          <p>Setting-up puncta segmentation. Puncta Segmentation can be done in three ways, shown using puncta centers identified in <xref rid="F2" ref-type="fig">Figure 2C</xref>, background threshold = 3. <bold>(A)</bold> Mode 0 segments puncta based on the LoG filtered image, using a fixed threshold value. <bold>(B)</bold> Mode 1 segments puncta based on the LoG filtered image using a threshold value relative to the ROI background (LoG) intensity. <bold>(C)</bold> Mode 2 segments puncta based on raw intensity values using a threshold value relative to the ROI background intensity.</p>
        </caption>
        <graphic xlink:href="fbinf-02-897238-g003" position="float"/>
      </fig>
      <table-wrap position="float" id="T2">
        <label>TABLE 2</label>
        <caption>
          <p>List of parameters for puncta segmentation and analysis (setup_puncta_analysis.ipynb).</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead valign="top">
            <tr>
              <th align="left" rowspan="1" colspan="1">Parameter</th>
              <th align="center" rowspan="1" colspan="1">Definition</th>
              <th align="center" rowspan="1" colspan="1">Recommended initial value</th>
              <th align="center" rowspan="1" colspan="1">Notes</th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" rowspan="1" colspan="1">Parameter_file</td>
              <td align="left" rowspan="1" colspan="1">Parameter file with previously set up ROI segmentation parameters</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">If ROI segmentation was performed, you can set this to the parameter file name used for ROI segmentation. Alternatively, set this to a new parameter file name and specify the following two parameters: “input_dir” and “cell_segmentation”.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Input_dir</td>
              <td align="left" rowspan="1" colspan="1">Directory with images to be analyzed</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">All z-layers and channels for a specific sample must be combined into a single file (see Step 3 of the Protocol Procedure). If ROI segmentation was done, set this to the “output_dir” of the ROI segmentation. Alternatively, ignore this parameter and specify the “parameter_file”.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Roi_segmentation</td>
              <td align="left" rowspan="1" colspan="1">If True, the last channel of the input images will be used as ROI mask</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Set to False if the ROI segmentation step was skipped. Set to True if the images from “input_dir” contain ROI masks as the last channel. Alternatively, ignore this parameter and specify the “parameter_file”.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Output_dir</td>
              <td align="left" rowspan="1" colspan="1">Output directory to save puncta analysis results</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Puncta_channels</td>
              <td align="left" rowspan="1" colspan="1">List of channel indices, starting form 0, that will be used to segment puncta</td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Examples: [1]–puncta will be segmented in the second channel.<break/>[2, 3]–puncta will be segmented in the third and fourth channels.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Minsize_um</td>
              <td align="left" rowspan="1" colspan="1">Minimum target puncta size in µm</td>
              <td align="center" rowspan="1" colspan="1">0.2</td>
              <td align="left" rowspan="1" colspan="1">Will be used as the minimum sigma for the Laplacian of Gaussian detector. Decrease to detect smaller puncta, increase to avoid detection of smaller puncta.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Maxsize_um</td>
              <td align="left" rowspan="1" colspan="1">Maximum target puncta size in µm</td>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td align="left" rowspan="1" colspan="1">Will be used as the maximum sigma for the Laplacian of Gaussian detector. Increase to detect larger puncta, decrease to avoid detection of larger puncta.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Num_sigma</td>
              <td align="left" rowspan="1" colspan="1">Number of sigma values for the Laplacian of Gaussian detection</td>
              <td align="center" rowspan="1" colspan="1">5</td>
              <td align="left" rowspan="1" colspan="1">Advanced parameter. Decrease to save computational resources, increase to improve the accuracy of puncta centers detection.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Threshold_detection</td>
              <td align="left" rowspan="1" colspan="1">Threshold used by LoG detector to exclude low intensity blobs</td>
              <td align="center" rowspan="1" colspan="1">0.001</td>
              <td align="left" rowspan="1" colspan="1">Should be close to 0 and can be both positive and negative. Start with threshold_detection = 0 and first adjust minsize_um and maxsize_um to make sure that all puncta of relevant size are detected. After that, gradually increase the value of threshold_detection to remove low-intensity detection. See <xref rid="F3" ref-type="fig">Figure 3A</xref> for examples.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Overlap</td>
              <td align="left" rowspan="1" colspan="1">Parameter used by the LoG detector to remove the smaller one of two overlapping blobs</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">Advanced parameter. Set to 1 to only remove completely overlapping blobs. Decrease to remove blobs that are further apart. Should be between 0 and 1.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Threshold_background</td>
              <td align="left" rowspan="1" colspan="1">Threshold used to remove low intensity puncta centers, provided relative to the ROI background value (see “background_percentile”)</td>
              <td align="center" rowspan="1" colspan="1">3</td>
              <td align="left" rowspan="1" colspan="1">Example: threshold_background = 3 will remove all puncta centers with fluorescent intensity lower than 3 background values. Set to 0 to keep all puncta centers. Only applied if the ROI masks are provided.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Background_percentile</td>
              <td align="left" rowspan="1" colspan="1">Intensity percentile (between 0 and 100) used to calculate the background value of the ROI</td>
              <td align="center" rowspan="1" colspan="1">50</td>
              <td align="left" rowspan="1" colspan="1">Advanced parameter. 50 corresponds to the median value.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Global_background</td>
              <td align="left" rowspan="1" colspan="1">If False, the background value is calculated individually for each ROI. If True, the background value is calculated globally as the global_background_percentile of all ROIs</td>
              <td align="center" rowspan="1" colspan="1">False</td>
              <td align="left" rowspan="1" colspan="1">Set to False if there is a large range of cell fluorescence values. This will increase sensitivity in cells with low fluorescence and decrease sensitivity in cells with high fluorescence.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Global_background_percentile</td>
              <td align="left" rowspan="1" colspan="1">Percentile (between 0 and 100) of ROI background values to calculate the global background value</td>
              <td align="center" rowspan="1" colspan="1">95</td>
              <td align="left" rowspan="1" colspan="1">Advanced parameter. Only used if global_background = True</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Segmentation_mode</td>
              <td align="left" rowspan="1" colspan="1">Determines the way the “threshold_segmentation” is applied. For mode 0: absolute threshold is applied in LoG space; for mode 1: a threshold relative to the background is applied in LoG space; for mode 2: a threshold relative to the background is applied in image intensity space</td>
              <td align="center" rowspan="1" colspan="1">0</td>
              <td align="left" rowspan="1" colspan="1">Advanced parameter. Set to 0 if the background fluorescent signal in all ROIs is relatively uniform. Set to 1 if there is a large range of ROI background fluorescence values.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Threshold_segmentation</td>
              <td align="left" rowspan="1" colspan="1">Threshold for puncta segmentation. Used in combination with the “segmentation_mode”</td>
              <td align="center" rowspan="1" colspan="1">0.001 (mode 0)30 (mode 1) 2 (mode 2)</td>
              <td align="left" rowspan="1" colspan="1">For mode 0, start with values between 0.001 and 0.003; for mode 1, start with values between 20 and 100; for mode 2, start with values between 2 and 3 Decrease or increase to detect more/bigger or fewer/smaller puncta.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Remove_out_of_roi</td>
              <td align="left" rowspan="1" colspan="1">If True, puncta (parts) that extend beyond ROI will be removed. If False, all puncta will be kept</td>
              <td align="center" rowspan="1" colspan="1">False</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Maxrad_um</td>
              <td align="left" rowspan="1" colspan="1">Maximum puncta radius in µm. Used to remove large puncta</td>
              <td align="center" rowspan="1" colspan="1">None</td>
              <td align="left" rowspan="1" colspan="1">Set to None to keep all puncta.</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="s3-7">
      <title>Step 7: Segment and Quantify Puncta</title>
      <p>After generating a parameter file using “notebooks/setup_puncta_analysis.ipynb”, segment and quantify the entire dataset using the “notebooks/run_puncta_analysis.ipynb” notebook. To do so, specify in the notebook the path to the parameter file generated at the end of Step 6. Then, execute all the steps in the notebook. It will segment puncta in all the cells in the dataset and generate output files. Output files will include csv files with measurements for individual puncta, and if ROI segmentation was done, additional csv files with measurements on individual ROIs will be generated (<xref rid="T3" ref-type="table">Tables 3</xref>, <xref rid="T4" ref-type="table">4</xref>).</p>
      <table-wrap position="float" id="T3">
        <label>TABLE 3</label>
        <caption>
          <p>Measurements for individual ROIs (cells or nuclei).</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead valign="top">
            <tr>
              <th align="left" rowspan="1" colspan="1">Column name</th>
              <th align="center" rowspan="1" colspan="1">Definition</th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" rowspan="1" colspan="1">Image name</td>
              <td align="left" rowspan="1" colspan="1">Source file name, including subdirectory</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">ROI label</td>
              <td align="left" rowspan="1" colspan="1">Unique ROI (cell or nucleus) ID; matches the pixel value in the ROI segmentation mask</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">x</td>
              <td align="left" rowspan="1" colspan="1">the x-coordinate (pixels) of the ROI within the image</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">y</td>
              <td align="left" rowspan="1" colspan="1">the y-coordinate (pixels) of the ROI within the image</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">z</td>
              <td align="left" rowspan="1" colspan="1">the z-coordinate (pixels) of the ROI within the image</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">ROI volume pix</td>
              <td align="left" rowspan="1" colspan="1">Volume (or area, for 2D images) of the ROI in pixels</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">ROI volume um</td>
              <td align="left" rowspan="1" colspan="1">Volume of the ROI in µm<sup>3</sup> (or area in µm<sup>2</sup>, for 2D images)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">[Fl] mean intensity per ROI</td>
              <td align="left" rowspan="1" colspan="1">Average pixel intensity of the [Fl] channel inside the ROI. Calculated for each fluorescent channel in the image</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">[Fl] integrated intensity per ROI</td>
              <td align="left" rowspan="1" colspan="1">The sum of all pixel intensities of the [Fl] channel inside the ROI. Calculated for each fluorescent channel in the image</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">[Fl] mean background intensity</td>
              <td align="left" rowspan="1" colspan="1">Average pixel intensity of the [Fl] channel in the background (outsize of ROI); will have the same value for all ROI in the image</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">[Fl] integrated background intensity</td>
              <td align="left" rowspan="1" colspan="1">The sum of all pixel intensities of the [Fl] channel in the background (outsize of ROI); will have the same value for all ROI in the image</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">[Fl] entropy</td>
              <td align="left" rowspan="1" colspan="1">Entropy of the [Fl] channel inside the ROI</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Pearson correlation coefficient [Fl] vs. [Fl*]</td>
              <td align="left" rowspan="1" colspan="1">Pearson correlation coefficient between each pair of fluorescent channels [Fl] and [Fl*] inside the ROI</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Pearson correlation <italic>p</italic> value [Fl] vs. [Fl*]</td>
              <td align="left" rowspan="1" colspan="1"><italic>p</italic>-value for the Pearson correlation coefficient between each pair of fluorescent channels [Fl] and [Fl*] inside the ROI</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Mutual information [Fl] vs. [Fl *]</td>
              <td align="left" rowspan="1" colspan="1">Mutual information between each pair of fluorescent channels [Fl] and [Fl*] inside the ROI</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">number of [P] puncta</td>
              <td align="left" rowspan="1" colspan="1">Number of puncta detected in the [P] channel and assigned to the current ROI. This will correspond to the puncta measurements from individual puncta quantification files (<xref rid="T4" ref-type="table">Table 4</xref>) with matching “Image name” and “cell label” values and “channel” = [P]. Calculated for each channel [P] specified as puncta channel</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">average [P] puncta volume pix per ROI</td>
              <td align="left" rowspan="1" colspan="1">Average volume in pixels of puncta detected from channel [P] in the current ROI</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">average [P] puncta volume um per ROI</td>
              <td align="left" rowspan="1" colspan="1">Average volume in µm<sup>3</sup> (or area in µm<sup>2</sup>, for 2D images) of puncta detected from channel [P] in the current ROI</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">total [P] puncta volume pix per ROI</td>
              <td align="left" rowspan="1" colspan="1">Total volume in pixels of puncta detected from channel [P] in the current ROI</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">total [P] puncta volume um per ROI</td>
              <td align="left" rowspan="1" colspan="1">Total volume in µm<sup>3</sup> (or area in µm<sup>2</sup>, for 2D images) of puncta detected from channel [P] in the current ROI</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">average [P] puncta distance to ROI border um per nucleus</td>
              <td align="left" rowspan="1" colspan="1">Average distance in µm (in 3D) from the puncta’s centers of mass to the ROI border</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">[Fl] mean intensity inside [P] puncta</td>
              <td align="left" rowspan="1" colspan="1">The average intensity of the [Fl] channel inside puncta detected in the [P] channel in the current ROI. For [Fl] = [P], this will correspond to the dense phase concentration</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">[Fl] mean intensity outside [P] puncta</td>
              <td align="left" rowspan="1" colspan="1">The average intensity of the [Fl] channel outside puncta detected in the [P] channel in the current ROI. For [Fl] = [P], this will correspond to the light phase concentration</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">[Fl] integrated intensity inside [P] puncta</td>
              <td align="left" rowspan="1" colspan="1">The sum of all intensities of the [Fl] channel inside puncta detected in the [P] channel in the current ROI.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">[FL] integrated intensity outside [P] puncta</td>
              <td align="left" rowspan="1" colspan="1">The sum of all intensities of the [Fl] channel outside puncta detected in the [P] channel in the current ROI.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Overlap coefficient [P]_[P*]_coloc</td>
              <td align="left" rowspan="1" colspan="1">Overlap coefficient (overlap over union) for the current ROI for puncta masks detected from each pair of puncta channels [P] and [P*]. This is a measure of colocalization between puncta detected in different channels</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="T4">
        <label>TABLE 4</label>
        <caption>
          <p>Measurements for Individual puncta.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead valign="top">
            <tr>
              <th align="left" rowspan="1" colspan="1">Column name</th>
              <th align="center" rowspan="1" colspan="1">Defintion</th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" rowspan="1" colspan="1">Image name</td>
              <td align="left" rowspan="1" colspan="1">Source file name, including subdirectory</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Puncta label</td>
              <td align="left" rowspan="1" colspan="1">Unique puncta ID; matches the pixel value in the puncta segmentation mask</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">ROI label</td>
              <td align="left" rowspan="1" colspan="1">ID of the ROI (cell or nucleus) the punctum belongs to; 0 corresponds to puncta located outside ROI</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Channel</td>
              <td align="left" rowspan="1" colspan="1">Channel name in which the punctum was segmented</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">x</td>
              <td align="left" rowspan="1" colspan="1">the x-coordinate (pixels) of the punctum within the image</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">y</td>
              <td align="left" rowspan="1" colspan="1">the y-coordinate (pixels) of the punctum within the image</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">z</td>
              <td align="left" rowspan="1" colspan="1">the z-coordinate (pixels) of the punctum within the image</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Puncta volume pix</td>
              <td align="left" rowspan="1" colspan="1">Volume (or area, for 2D images) of the punctum in pixels</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Puncta volume um</td>
              <td align="left" rowspan="1" colspan="1">Volume of the punctum in µm<sup>3</sup> (or area in µm<sup>2</sup>, for 2D images)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Distance to ROI border um</td>
              <td align="left" rowspan="1" colspan="1">Distance in µm (in 3D) from the punctum’s center of mass to the border of the cell or nucleus; 0 corresponds to puncta located in the background</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">[FL] mean intensity per puncta</td>
              <td align="left" rowspan="1" colspan="1">Average pixel intensity of the [Fl] channel inside the punctum. Calculated for each fluorescent channel in the image</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">[FL] integrated intensity per puncta</td>
              <td align="left" rowspan="1" colspan="1">The sum of all pixel intensities of the [Fl] channel inside the punctum. Calculated for each fluorescent channel in the image</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Pearson correlation coefficient [Fl] vs. [Fl*]</td>
              <td align="left" rowspan="1" colspan="1">Pearson correlation coefficient between each pair of fluorescent channels [Fl] and [Fl*] inside the punctum</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Pearson correlation <italic>p</italic> value [Fl] vs. [Fl*]</td>
              <td align="left" rowspan="1" colspan="1"><italic>p</italic>-value for the Pearson correlation coefficient between each pair of fluorescent channels [Fl] and [Fl*] inside the punctum</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Mutual information [Fl] vs. [Fl*]</td>
              <td align="left" rowspan="1" colspan="1">Mutual information between each pair of fluorescent channels [Fl] and [Fl*] inside the punctum. This is a measure of correlation between channels</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="s3-8">
      <title>Step 8: Verify the Quality of the Cell/Nuclei and Puncta Segmentation</title>
      <p>The “notebooks/run_puncta_analysis.ipynb” notebook creates tiff files that include the original images along with ROI and puncta segmentation channels. The pixel values in each segmentation mask match the “puncta label” and “ROI label” values from the corresponding csv tables and are useful for identifying specific data points. To examine these masks visually, first open the output tiff files using image viewing software such as FIJI. Then adjust brightness-contrast and/or the lookup tables to improve visibility of each channel. We found that “glasbey” or “glasbey on dark” lookup tables work well for visualizing segmentation masks. Inspect whether the cell/nuclei and puncta masks match expectations. Repeat this inspection for several images from different treatment conditions to ensure consistent performance of the segmentation algorithm and that results align with expectations. It is critical that examined conditions include negative controls (such as diffuse fluorescent signal, and/or samples with no fluorescent signal), to ensure that the parameters are not overly sensitive. If the segmentation results are unsatisfactory, select a small set of representative samples and return to Step 4 and/or Step 6 to adjust the segmentation parameters. Because changes to parameters can alter puncta segmentation, and therefore quantification of puncta features (<xref rid="F4" ref-type="fig">Figure 4</xref>), users are encouraged to implement the same parameter values on the entire dataset across all experimental conditions to maintain quantification accuracy and to ensure that results are comparable. In cases where parameters capable of completely segmenting puncta-containing images while simultaneously not detecting puncta in negative controls cannot be found, we recommend applying the lowest value parameters that return no false puncta in negative controls and acknowledge that this circumstance results in under-segmentation of puncta within some images. While inspecting results, note the image name and cell ID of any dying or obviously aberrant cells. A list of these cells can be supplied to a post-processing script in Step 10 to exclude them from final analysis.</p>
      <fig position="float" id="F4">
        <label>FIGURE 4</label>
        <caption>
          <p>Impact of the “threshold_segmentation” parameter on the number and volume of detected puncta. <bold>(A)</bold> Example cells expressing the G-NHA9 (left), G-NHA9-21FGAA (second from left), and G-NHA9-ΔDNA (second from right) constructs with different sizes of puncta; mEGFP (right) is the negative control. <bold>(B)</bold> Plots showing how extracted features such as average number of puncta per cell (left) and average volume of puncta per cell (right) change with differing segmentation parameters. <bold>(C)</bold> Puncta segmentation masks generated with different threshold_segmentation (TS) values. Scale bars show 5 µm. Puncta segmentation was performed using mode 1, default LoG parameters (num_sigma = 5, minsize_um = 0.2, maxsize_um = 2) and a threshold detection value of 0.002 to identify potential puncta centers. Images are shown as maximum intensity z-projections. Full z-stacks including 3D segmentation can be found in the supplemental files.</p>
        </caption>
        <graphic xlink:href="fbinf-02-897238-g004" position="float"/>
      </fig>
    </sec>
    <sec id="s3-9">
      <title>Optional Step 9: Calibration of Fluorescence Intensity Versus Concentration</title>
      <p>For biologically relevant studies, it may be necessary to estimate concentrations of fluorescently-labeled biomolecules in cells treated under different conditions. To estimate concentrations of fluorescently-labeled protein inside and outside of puncta, a conversion factor that establishes the relationship between fluorescence intensity and fluorescent protein (e.g., mEGFP) concentration needs to be calculated. Prepare pure solutions of known concentrations of fluorescent protein in imaging media and collect images using parameters that are identical to those used in the experimental data collection (laser power wattage, acquisition time, etc.). When preparing these samples, it is important to account for factors that influence fluorescence intensity such as crowding, pH, and concentration; these factors can influence the intrinsic fluorescence of the fluorescent-label in the cellular setting (<xref rid="B10" ref-type="bibr">Kneen et al., 1998</xref>; <xref rid="B11" ref-type="bibr">Leiderman et al., 2006</xref>; <xref rid="B16" ref-type="bibr">Morikawa et al., 2016</xref>). We provide an example notebook, “notebooks/calibrate_intensities.ipynb” to match fluorescent intensities to protein concentrations (e.g., for the mEGFP channel). With this, a standard curve of the relationship between apparent fluorescence intensity and fluorescent protein concentration can be established, which can then be used to calculate a conversion factor. This parameter can be used to determine the apparent concentrations of labeled biomolecule inside (dense phase) and outside (light phase) of puncta when the relationship between fluorescence intensity and concentration is linear. Note that the exact concentration is not necessary to determine thermodynamic parameters such as partition coefficients.</p>
    </sec>
    <sec id="s3-10">
      <title>Optional Step 10: Calculation of Thermodynamic Characteristics</title>
      <p>This processing step enables pipeline users to generate multiple plots in several formats that allow comparison between experimental conditions. Immediate comparisons that can be made by this step are comparisons of basic parameters of cells such as: number of puncta, average volume of puncta, and average fluorescence intensity of a given fluorophore (FL) within cells. To facilitate further comparisons, data can be analyzed to derive the partition coefficient (K<sub>p</sub>) for the fluorescently-labeled biomolecule within puncta <xref rid="e1" ref-type="disp-formula">Eq. 1</xref> and partition coefficients are then used to derive the Gibbs free energy of transfer into puncta (ΔG<sub>Tr</sub>) <xref rid="e2" ref-type="disp-formula">Eq. 2</xref>, where R (1.9872) is the gas constant in units of kcal/mol and T is temperature in Kelvin units.<disp-formula id="e1"><mml:math id="m1" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic"> </mml:mi><mml:msub><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mi mathvariant="bold-italic">p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mi mathvariant="bold-italic">DP</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi mathvariant="bold-italic">LP</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic"> </mml:mi><mml:mfrac><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi mathvariant="bold-italic">FL</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="bold-italic">mean</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="bold-italic">intensity</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="bold-italic">inside</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi mathvariant="bold-italic">FL</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="bold-italic">puncta</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi mathvariant="bold-italic">FL</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="bold-italic">mean</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="bold-italic">intensity</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="bold-italic">outside</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi mathvariant="bold-italic">FL</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="bold-italic">puncta</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><label>(1)</label></disp-formula>
<disp-formula id="e2"><mml:math id="m2" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic"> </mml:mi><mml:mi mathvariant="bold">Δ</mml:mi><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">Tr</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="bold">RTln</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mi mathvariant="bold-italic">p</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><label>(2)</label></disp-formula>
</p>
      <p>To compile output data, calculate thermodynamic parameters, and compare datasets, we developed R functions that read output files from previous steps and performs these calculations. This function can be found in the “scripts/thermodynamic_characterization/puncta_thermo_calc.Rmd” R notebook provided. This script also generates plots to compare datasets. To run this analysis, first load the requisite packages and the function in R. Then call the function and provide the necessary inputs: cell. data = “PATH to cell data csv file”, puncta. data = “PATH to puncta data csv file”, cell. channel = “Name of ROI signal”, puncta. channel = “Name of puncta signal”, factor_conc = [[Conversion factor from intensity to µM]] (optional), and temp = [[temperature in Kelvin units]]. Assign output of the function to a dataframe, which can then be exported to a spreadsheet.</p>
    </sec>
    <sec id="s3-11">
      <title>Step 11: Statistical Analysis and Comparisons</title>
      <p>To determine the statistical significance of differences between the features of puncta imaged in different biological replicates, or under different biological conditions, use the provided R package “scripts/statistical_analysis/library.R”. An example of how to prepare and run the package is also provided as “scripts/statistical_analysis/runPuncta.R”. To utilize the package, first read the cell-level data for multiple biological conditions into a data frame in R. Then call the function and specify the following inputs: the column names of the characteristics to be compared (y.var), the condition variable (cond.var), the image subsample/position (subsamp.var), a vector with names of the conditions to include in the analysis (cond.inc.), the name of the transformation (trans.name, examples include “identity” or “log”), and an indicator of whether the y-variable is a count variable (y.count, T or F). Based on these inputs, compare. puncta.R will determine the proper statistical tests to perform and compute statistical estimates of the effect of the biological conditions on y with confidence intervals and <italic>p</italic>-values. It will then return the input data, statistical results, and a brief narrative describing the results.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s4">
    <title>Results</title>
    <sec id="s4-1">
      <title>Software Design</title>
      <p>We provide the full image analysis pipeline as an open-source Python package “Punctatools” (<ext-link xlink:href="https://github.com/stjude/punctatools" ext-link-type="uri">https://github.com/stjude/punctatools</ext-link>). It is solely dependent on open-source tools, such as Cellpose (<xref rid="B21" ref-type="bibr">Stringer et al., 2021</xref>), scikit-image (<xref rid="B22" ref-type="bibr">van der Walt et al., 2014</xref>), and intake_io (<xref rid="B9" ref-type="bibr">Höckendorf and Medyukhina, 2022</xref>), all of which will be installed automatically at setup. The pipeline consists of tools that perform several major functions (<xref rid="F1" ref-type="fig">Figure 1</xref>): data staging, segmentation of the regions of interest (ROIs; e.g., individual cells or nuclei), puncta segmentation, and puncta quantification (discussed below).</p>
      <p>ROI segmentation is done using Cellpose (<xref rid="B21" ref-type="bibr">Stringer et al., 2021</xref>), a deep-learning-based algorithm for cell and nucleus segmentation. This step is applied to segment either cells or nuclei, depending on the fluorescent signal used (e.g., Hoechst for segmenting nuclei in the examples provided here). Following segmentation of ROIs in individual <italic>z</italic>-layer images, they are combined in three dimensions (when the two-dimensional segmentation mode was used). Optionally, tools are provided to exclude small ROIs (e.g., those corresponding to aberrant or dying cells) and/or ROIs near the edges of images in the x- and <italic>y</italic>-axis dimensions (see <xref rid="s11" ref-type="sec">Supplementary Meterial S1</xref>).</p>
      <p>Segmentation of puncta within ROIs is done through the following steps (<xref rid="F2" ref-type="fig">Figures 2</xref>,<xref rid="F3" ref-type="fig">3</xref>; <xref rid="s11" ref-type="sec">Supplementary Meterial S1</xref>): 1) a Laplacian of Gaussian (LoG) filter is applied to identify candidate puncta centers (<xref rid="F2" ref-type="fig">Figure 2A</xref>); 2) intensity-dependent puncta center filtering is performed based on contrast to the background signal of the ROI (<xref rid="F2" ref-type="fig">Figures 2B,C</xref>); 3) thresholding of the image, followed by a seeded watershed segmentation is applied to the LoG transformed (<xref rid="F3" ref-type="fig">Figures 3A,B</xref>) or raw fluorescence intensity signal (<xref rid="F3" ref-type="fig">Figure 3C</xref>); and 4) optional filtering of puncta is done based on their size or extension beyond the ROI mask (see <xref rid="s11" ref-type="sec">Supplementary Meterial S1</xref>).</p>
      <p>After ROI and puncta segmentation, the Punctatools pipeline performs quantitative measurements on ROIs (<xref rid="T3" ref-type="table">Table 3</xref>) and puncta (<xref rid="T4" ref-type="table">Table 4</xref>). For each punctum, Punctatools quantifies location, volume, distance to ROI border, as well as the mean and integrated fluorescence intensities of all pixels in all detection channels within the segmented punctum. The values of these parameters are summarized for individual ROI. Punctatools also quantifies the mean and integrated fluorescence intensities for all pixels within each ROI, as well as all pixels inside (dense phase) and outside (light phase) of puncta for each ROI; if a calibration curve was established relating fluorescence intensities with molar concentrations (e.g., for the mEGFP channel; see Step 9), these values can be converted to molar concentration units. In our example data, ROIs of interest are cell nuclei and the biomolecules of interest (G-NHA9 constructs) are fluorescently-labeled with mEGFP. Therefore, the parameters described above give the apparent average total nuclear mEGFP concentration for all nuclei in the images being analyzed, and corresponding dense and light phase concentrations. Furthermore, the pipeline will report correlation statistics (e.g., Pearson correlation coefficients, mutual information) for each pair of channels. This calculation is performed and reported for both ROIs and puncta. Additionally, if multiple puncta channels are segmented, the pipeline will calculate the overlap coefficient (overlap over union) between segmented puncta for each ROI.</p>
      <p>The parameters for all steps of ROI and puncta segmentation are interactively adjusted using the provided setup notebooks and allow users to tune pipeline performance until results agree with their expert assessment (see <xref rid="T1" ref-type="table">Tables 1</xref>, <xref rid="T2" ref-type="table">2</xref> for the full list of adjustable parameters). The sensitivity, computational expense, and limits of detection will be determined by these user-defined parameters. For example, the parameters that determine the LoG transformation (num_sigma, overlap, threshold_detection, maxsize_um, and minsize_um) allow users to adjust the pipeline to detect puncta within the expected size range. Because changes in the analysis parameters result in differences in quantifications of puncta features (<xref rid="F4" ref-type="fig">Figure 4</xref>), when comparing the puncta features of different conditions, all conditions need to be analyzed with the same parameters.</p>
      <p>In addition to the Punctatools package, we provide the set of jupyter notebooks (Python language scripts), which we used for the analyses shown in this manuscript. The notebooks include step-by-step guides on how to adjust ROI and puncta segmentation parameters to adapt the workflow for particular experimental conditions (e.g., cell type, type of fluorescently-labeled biomolecule, location of puncta formed by the labeled biomolecule with cells, etc.).</p>
      <p>We also developed an R-function to extract thermodynamic parameters from the raw pipeline output (puncta_thermo_calc.Rmd). The function first reads the ROI and puncta datasets generated in previous steps for a given experimental condition, along with parameters needed to calculate the relevant characteristics of each cell. These include the apparent concentration of the fluorescently-labeled biomolecule (e.g., a mEGFP-labeled protein) in the ROI and the corresponding dense and light phase, the partition coefficient (K<sub>p</sub>), and the Gibbs free energy of transfer (ΔG<sub>Tr</sub>). Data generated by this function can be exported to a spreadsheet for examination, or directly plotted in R to make comparisons between conditions.</p>
      <p>Finally, we developed an R package to assess the statistical significance of differences in values of puncta parameters generated using the procedures discussed above for single replicates of images recorded under different biological conditions. The package can be found in the Punctatools github repository “scripts/statistical_analysis/library.R”. The package defines a function image.stats that compares ROI-level imaging characteristics across biological conditions. The input data is first passed as the dset argument to compare. puncta. The function then transforms the data as specified (trans.name) and subdivides it to include the biological conditions of interest (cond.var). Next, it fits a linear mixed effects model if y is not an integer variable (using lmer of the lme4 package) or a general linear mixed effects model with a Poisson distribution and log-link if y is a count variable (using glmer of the lme4 package). In each case (when y is an integer variable or not), the model represents the substantial variability between technical replicates in y (subsamp.var) as a random effect and the biological comparison across conditions of primary scientific interest (cond.var) as a fixed effect. The package then computes statistical estimates of the effect of the biological conditions on y with confidence intervals and <italic>p</italic>-values. Finally, the package returns these statistical results, copies of the input data and specifications, and a short narrative describing the results of the statistical analysis. In future work, we intend to extend this function to appropriately manage data from experiments with multiple biological replicates per condition. As the data collection for these studies becomes streamlined and less cumbersome, we encourage investigators to include multiple biological replicates in their studies to enhance statistical reliability and scientific rigor.</p>
    </sec>
    <sec id="s4-2">
      <title>Example Results</title>
      <p>Successful implementation of this pipeline up to Step 8 will return multiple results files. Amongst these are annotated image-format files that depict the masks generated for ROIs and puncta, in addition to the original intensity information; these files are stored within the puncta subdirectory. Masks are helpful for visually inspecting the results to determine whether ROIs (e.g., nuclei in our G-NHA9 construct examples) were properly segmented, and that puncta were correctly identified and segmented. Additionally, there are numerous spreadsheets that report the extracted puncta features for the different conditions being tested. One set of spreadsheets details parameters for individual puncta, noting volume (in pixels<sup>3</sup> and μm<sup>3</sup>), x-, y-, <italic>z</italic>-axis position, average and integrated fluorescence intensity, etc. Another set of files reports information relevant to the behavior of condensates formed in cells by the fluorescently-labeled biomolecule(s). For example, average values for puncta features within each ROI, average fluorescence intensity in the ROI, and correlation between fluorescence intensities of the different channels within the ROI. Further processing (as in Steps 9–11) converts this information into features relevant for thermodynamic analysis. We illustrate some of these results for images of live HEK293T cells expressing three different G-NHA9 constructs (<xref rid="F5" ref-type="fig">Figure 5A</xref>) analyzed using the Punctatools pipeline. For example, as discussed under Procedure (Step 9), if a standard curve for the relationship between fluorescence intensity of the fluorescent label (mEGFP in our case) and molar concentration is available, the average fluorescence intensity per ROI (nuclei in our case) can be converted to average molar concentration within each ROI. The results show that the average nuclear concentration of the mEGFP-labeled constructs for individual cells varies from 1 μM to over 10 μM and that the concentration ranges and distributions differ between the constructs (<xref rid="F5" ref-type="fig">Figure 5B</xref>). Also, the extent of positional overlap of the fluorescence signals of the mEGFP-labelled G-NHA9 constructs and the Hoechst dye, which stains chromosomal DNA, as given by the Pearson correlation coefficient, differs for the three G-NHA9 constructs (<xref rid="F5" ref-type="fig">Figure 5C</xref>). The conversion of fluorescence intensity to molar concentration enables examination of the dependence of puncta features on the concentration of the puncta-forming biomolecule—on a per ROI basis (per cell nucleus in our examples). We illustrate this feature of Punctatools on mEGFP concentration-dependence of puncta number, puncta mole fraction (e.g., the fraction of mEGFP-labeled biomolecules within puncta) and ΔG<sub>Tr</sub> (e.g., the thermodynamic favorability of the labeled biomolecule partitioning into puncta) for the three G-NHA9 constructs (<xref rid="F5" ref-type="fig">Figures 5D–F</xref>). Finally, we determine statistical significance of the differences between puncta features using the statistics tools within the Punctatools pipeline (<xref rid="F5" ref-type="fig">Figure 5G</xref>). In summary, the functionalities included in Punctatools enable evaluation and optimization of image analysis performance and, assuming suitable performance is achieved, detailed analysis of features of puncta formed by fluorescently-labeled biomolecules in live cells.</p>
      <fig position="float" id="F5">
        <label>FIGURE 5</label>
        <caption>
          <p>Example Punctatools pipeline output. <bold>(A)</bold> Exemplary microscopy images illustrating differences in puncta features for G-NHA9 (green box, <italic>n</italic> = 1,004), G-NHA9-21FGAA (blue box, <italic>n</italic> = 880), and G-NHA9-ΔDNA (red box, <italic>n</italic> = 849). The fluorescence signals for the G-NHA9 constructs are illustrated in green and those for Hoechst dye are shown in blue. The Punctatools pipeline quantifies raw images to extract parameters such as, <bold>(B)</bold>, the apparent average nuclear concentration per cell of the fluorescently-labeled biomolecule (mEGFP) and <bold>(C)</bold>, Pearson correlation coefficients (PCC) between fluorescent channels (the Hoechst dye and mEGFP channels in these examples). Additional functions within Punctatools generate plots reporting features such as, <bold>(D)</bold> Puncta number; <bold>(E)</bold> Puncta volume; <bold>(F)</bold> Puncta volume fraction (F<sub>vol</sub>); <bold>(G)</bold> Puncta mole fraction (F<sub>mol</sub>); <bold>(H)</bold> Light phase concentration (LP); <bold>(I)</bold> Dense phase concentration; <bold>(J)</bold> Partition coefficient (K<sub>p</sub>); or <bold>(K)</bold>, ΔG<sub>Tr</sub> versus the apparent average concentration of the fluorescently-labelled biomolecule (mEGFP in these examples) per ROI (cell nucleus in these examples). <bold>(L)</bold> The pipeline also determines the statistical significance of differences between these values for different conditions (three G-NHA9 constructs in these examples), including <italic>p</italic>-values. Average mEGFP concentrations shown on the graph <italic>x</italic>-axes are estimates derived from calibration, and are subject to the limitations of this calibration as noted in the main text.</p>
        </caption>
        <graphic xlink:href="fbinf-02-897238-g005" position="float"/>
      </fig>
    </sec>
    <sec id="s4-3">
      <title>Comparison to Other Methods</title>
      <p>FIJI is an open-source platform used to view and analyze image data with numerous plugins that provide additional functionality. We used the “Coloc 2” plugin to confirm the Pearson correlation coefficient (PCC) values output by our pipeline. To do so, we first imported the Cellpose ROIs into FIJI, then isolated the regions from the surrounding data and ran the plugin. We compared the PCC values generated by “Coloc 2” with those generated by our pipeline for each ROI in a sample image and found them to be identical, confirming robustness of our pipeline’s calculations. Additionally, we compared the results of the Punctatools pipeline’s segmentation against manual segmentation of puncta done by drawing ROIs in FIJI, and quantified each cell as defined by Cellpose. We found the results to be in good agreement (<xref rid="s11" ref-type="sec">Supplementary Figures 1B,C</xref>).</p>
      <p>We also used a FIJI plugin to compare our pipeline’s puncta segmentation against conventional thresholding approaches. “3D object counter” identifies and counts 3D objects in a set of data by first suggesting a recommended threshold value and then separating “objects” from the background based on the distribution of intensity values in the analyzed region. To segment puncta using this plugin, we first isolated individual cell nuclei from an acquired z-stack of puncta-displaying cell nuclei using the regions generated from Cellpose as generated in Step 5. We then analyzed each cell nucleus in this file with 3D object counter in two different ways: with a threshold automatically determined from the collective intensity distribution in the entire image-stack (Global Sensitivity), and with a threshold automatically determined from each individual cell nucleus’s intensity distribution (Local Sensitivity). We then compared the results between these analyses and the analyses of two different configurations of our pipeline: one that analyzes cell nuclei in the context of the entire file (Mode 0, Global Background = True, <xref rid="F6" ref-type="fig">Figure 6B</xref>) and a configuration that analyzes cell nuclei individually (Mode 1, Global Background = False, <xref rid="F6" ref-type="fig">Figure 6C</xref>). In cell nuclei that display obvious puncta, such as nucleus #20 (<xref rid="F6" ref-type="fig">Figure 6D</xref>), the Punctatools pipeline found more puncta (974 and 779, with local and global background options, respectively) than the FIJI 3D Object Counter method (44 and 275, respectively). In contrast, in a low expressing cell with no apparent nuclear puncta (nucleus #24), the Punctatools pipeline found no puncta while the 3D Object counter method found 14 puncta when evaluating the cell nucleus with a local threshold (<xref rid="F6" ref-type="fig">Figure 6E</xref>). In addition, we found that for both thresholding methods, the Punctatools pipeline returned segmentation masks that were truer representations of puncta shape, and the pipeline performance was superior in segmenting separate puncta in areas where multiple puncta existed close to one another. In conclusion, we determined that the LoG-based method of determining puncta segmentation used in Punctatools is superior to conventional intensity-thresholding methods.</p>
      <fig position="float" id="F6">
        <label>FIGURE 6</label>
        <caption>
          <p>Comparison of puncta segmentation performance: Punctatools versus FIJI 3D object-counter. <bold>(A)</bold> A single z-layer image of puncta in cells expressing G-NHA9 (the G-NHA9 fluorescence signals are illustrated in green and those for Hoechst dye are shown in blue); two ROIs (Cells #20 (solid red circle) and #24 (dashed green circle)) in this image were used for the performance comparisons presented in other panels. Cells #20 and #24 display many puncta and no puncta, respectively. Analysis of the 3D z-stack data to quantify puncta features for individual ROIs (57 nuclei total) resulted in different numbers of puncta by the Punctatools pipeline and FIJI 3D Object counter differ; in <bold>(B)</bold>, a constant, global background threshold was used by Punctatools (Mode 0) and the FIJI 3D object-counter and in <bold>(C)</bold>, the background thresholds were determined by the two algorithms for each ROI (cell nucleus; Mode 1 for Punctatools). In <bold>(B)</bold> and <bold>(C)</bold>, the number of puncta identified by Punctatools for each ROI is plotted on the <italic>x</italic>-axis and that determined by the FIJI 3D object-counter on the <italic>y</italic>-axis. <bold>(D)</bold> Raw image data for Cell #20 displaying many puncta (a single z-slice is shown, (i) and puncta segmentation masks generated using the FIJI 3D object counter (ii, iv) or Punctatools (iii,v) using global (ii,iii) or local, ROI-specific (iv,v) background thresholds. <bold>(E)</bold> as in <bold>(D)</bold> for Cell #24, which did not express G-NHA9 and does not display puncta. In <bold>(D)</bold> and <bold>(E)</bold>, the G-NHA9 fluorescence signals are illustrated in green and those for Hoechst dye are shown in blue. The masks for segmented puncta in <bold>(D)</bold> are illustrated in multiple colors.</p>
        </caption>
        <graphic xlink:href="fbinf-02-897238-g006" position="float"/>
      </fig>
      <p>Puncta analysis could potentially be simplified by 2D projection from 3D data prior to analysis. However, 2D projection produced inaccuracies in quantification of key quantities such as volume fraction and partition coefficient (<xref rid="s11" ref-type="sec">Supplementary Figures 1D,E</xref>).</p>
      <p>There are multiple existing software packages designed to facilitate algorithmic analysis of fluorescence microscopy data. For example, there are numerous open-source plugins for FIJI that recapitulate many of the analysis steps performed in the Punctatools pipeline. Additionally, CellProfiler (<xref rid="B20" ref-type="bibr">Stirling et al., 2021</xref>) contains a suite of image analysis tools designed to process and analyze large batches of image data. These open-source tools have been used to develop many different protocols that perform a large variety of analytical tasks on cell images and can execute these protocols on large sets of data and could be used to create pipelines comparable to the Punctatools pipeline.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s5">
    <title>Discussion</title>
    <p>Our image analysis pipeline was developed to facilitate objective, automated analysis of fluorescence microscopy images of biomolecular condensates formed through the process of LLPS. We tailored the performance of our pipeline to accommodate the physical features of biomolecular condensates; for example, the identified condensates, or puncta, are analyzed over their entire three-dimensional volumes and their boundaries are identified using a Laplacian of Gaussian filter applied to their fluorescently-labeled components. Quantification of entire puncta volumes enables analysis of the total puncta volume relative to the remaining nuclear volume, which is termed the puncta volume fraction (F<sub>vol</sub>). Our pipeline also quantifies the intensity of the signal for the fluorescently-labeled biomolecule within puncta, termed the dense phase, and within the surrounding ROI (the nucleoplasm in our examples), termed the light phase. These fluorescence intensities can be converted to apparent molar concentrations in the respective phases if an appropriate standard curve is available (e.g., recorded using purified mEGFP for our examples). The availability of these concentrations enables the mole fraction of the fluorescently-labeled biomolecule within puncta (F<sub>mol</sub>) to be determined (<xref rid="F5" ref-type="fig">Figure 5E</xref>). These parameters, F<sub>vol</sub> and F<sub>mol</sub>, are not available from other image analysis software packages. Another advantage of our image analysis pipeline is that it is more sensitive to the presence of puncta than other, intensity-base detection methods (<xref rid="F6" ref-type="fig">Figure 6</xref>). Our pipeline detects puncta by using the Laplacian of Gaussian transformation, which enables detection of sharp fluorescence intensity fluctuations that distinguish the puncta dense phases from the surrounding light phase. In the simplest case, the theory of liquid-liquid phase separation provides that the concentration of the fluorescently-labeled biomolecule that forms puncta has a uniform concentration in the light phase and a uniform but higher concentration in the dense phase. The ratio of dense to light phase concentrations is the partition coefficient (K<sub>p</sub>) and its value in condensates can range from a few-fold to over 100-fold. Our pipeline detected hundreds of puncta formed in cells by the NHA9 fusion oncoprotein while intensity-based image analysis methods detected significantly fewer puncta (<xref rid="F6" ref-type="fig">Figure 6</xref>). While we illustrate the performance of our image analysis pipeline using exclusively nuclear puncta-forming proteins, it is adaptable to identifying and analyzing condensates formed outside of the nucleus with appropriate experimental design (e.g., by providing a fluorescent signal for segmentation of the entire cell volume). Therefore, we believe that the Punctatools image analysis pipeline discussed herein will be useful in the analysis of cellular condensates formed by many other fluorescently-labeled biomolecules.</p>
    <p>The quantitative information from Punctatools pipeline provides detailed insight into the phase separation behavior of biomolecules in cells. For example, we enumerate the average fluorescence intensity per unit volume for fluorescently-labeled biomolecules which, when a standard curve relating fluorescence intensities to molar concentrations is available, allows the concentration dependence of puncta features to be examined. Puncta number (<xref rid="F5" ref-type="fig">Figure 5D</xref>) increases for the three G-NHA9 constructs (G-NHA9, G-NHA9-21FGAA and G-NHA9-ΔDNA) with increasing nuclear expression level, but these dependencies vary. The G-NHA9-ΔDNA construct, which interacts with other proteins in the nucleus but does not bind DNA, forms fewer puncta that are larger (<xref rid="F5" ref-type="fig">Figure 5E</xref>) than those formed by G-NHA9. In contrast, the G-NHA9-21FGAA construct, which harbors 21 pairs of mutations in the FG motifs that drive phase separation, forms fewer puncta than G-NHA9 and only at significantly higher protein expression levels. These results, based upon quantitative image analysis using the Punctatools pipeline, illustrate how altering the functional properties of the NHA9 fusion oncoprotein through mutation (e.g., by altering interactions with DNA or proteins, respectively, with G-NHA9-ΔDNA and G-NHA9-21FGAA) affects LLPS and puncta features in cells. Quantitative analysis of puncta within cell images also provides access to information on the volume occupied by puncta within the ROI (nuclei in our studies). For example, puncta formed by the G-NHA9 constructs occupy only a very small fraction of the nuclear volume (<xref rid="F5" ref-type="fig">Figure 5F</xref>), especially at low expression levels, although this fraction increases to almost 0.1 at the highest expression levels. However, the fraction of mEGFP-labeled protein molecules within puncta (<xref rid="F5" ref-type="fig">Figure 5G</xref>) exceeds 0.1 at the higher expression levels due to preferential partitioning within the phase-separated condensates, as given by the partition coefficient (K<sub>p</sub>, <xref rid="F5" ref-type="fig">Figure 5H</xref>). We note, however, that G-NHA9 construct partitioning within puncta declines sharply with increasing expression level (<xref rid="F5" ref-type="fig">Figure 5H</xref>) because the mEGFP-labeled protein concentration increases more steeply in the light phase ([LP], surrounding puncta) than in the dense phase ([DP], within puncta (<xref rid="F5" ref-type="fig">Figures 5I,J</xref>). This is due to declining thermodynamic favorability of incorporation of mEGFP-labeled G-NHA9 molecules within puncta with increasing expression level (e.g., ΔG<sub>Tr</sub> values become less negative, <xref rid="F5" ref-type="fig">Figure 5K</xref>), which is a hallmark of multicomponent phase separation driven by heterotypic interactions (<xref rid="B18" ref-type="bibr">Riback et al., 2020</xref>). Thus, the quantitative analyses enabled by Punctatools provides detailed insight into relationships between LLPS mechanisms and the physical and thermodynamic features of cellular puncta.</p>
    <p>It is now recognized that large regions of the interior of cells are occupied by biomolecular condensates that form through LLPS and perform diverse biological functions. While the basic principles underlying LLPS by biomolecules are understood, tools to quantitatively compare the features of the different types of condensates that form through LLPS are limited. Fluorescence microscopy is commonly applied in studies of condensates formed in cells by fluorescently-labeled biomolecules but often only qualitative analyses of the resulting images are performed. While many types of image analysis software tools are available for quantitative analyses of punctate structures in cells, we are not aware of any that have been developed with the principles of LLPS in mind. The Punctatools image analysis pipeline presented here was developed to enable the identification and segmentation of cellular puncta formed through LLPS, which in turn provides access to the wealth of quantitative physical and thermodynamic features discussed above. While the example data and analyses we present were generated through studies of fluorescently-labeled proteins that form nuclear puncta, our pipeline is adaptable for studies of condensates that form within the cytoplasm with appropriate experimental design. Therefore, we propose that Punctatools will be useful in studies of the growing numbers of biomolecules that perform their function(s) in the setting of phase separated condensates.</p>
  </sec>
</body>
<back>
  <ack>
    <p>The authors would like to thank the St. Jude Light Microscopy Center and staff for aiding with their expertise in high resolution fluorescence microscopy imaging.</p>
  </ack>
  <sec sec-type="data-availability" id="s6">
    <title>Data Availability Statement</title>
    <p>The original contributions presented in the study are included in the article/<xref rid="s11" ref-type="sec">Supplementary Material</xref>, further inquiries can be directed to the corresponding authors.</p>
  </sec>
  <sec id="s7">
    <title>Author Contributions</title>
    <p>KK and RK conceived and guided the study. HS established the microscopy protocols and collected the experimental data. AM developed the image analysis software and the Punctatools pipeline. ST developed the thermodynamic characterization analysis. HW and SP developed the statistical analysis. DB analyzed the data, tested and validated the software, and wrote the manuscript. All authors reviewed and edited the manuscript and approved the submitted version.</p>
  </sec>
  <sec id="s8">
    <title>Funding</title>
    <p>This work is supported by an NCI Cancer Center Support Grant (P30 CA021765), NCI R01 CA246125 (to RK), NCI FusOnC2 U54 CA243124 (to RK), NCI T32 CA236748 (to DB), and ALSAC. This research content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health.</p>
  </sec>
  <sec sec-type="COI-statement" id="s9">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
  <sec sec-type="disclaimer" id="s10">
    <title>Publisher’s Note</title>
    <p>All claims expressed in this article are solely those of the authors and do not necessarily represent those of their affiliated organizations, or those of the publisher, the editors and the reviewers. Any product that may be evaluated in this article, or claim that may be made by its manufacturer, is not guaranteed or endorsed by the publisher.</p>
  </sec>
  <sec id="s11">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link xlink:href="https://www.frontiersin.org/articles/10.3389/fbinf.2022.897238/full#supplementary-material" ext-link-type="uri">https://www.frontiersin.org/articles/10.3389/fbinf.2022.897238/full#supplementary-material</ext-link>
</p>
    <supplementary-material id="SM1" position="float" content-type="local-data">
      <media xlink:href="DataSheet3.ZIP">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM2" position="float" content-type="local-data">
      <media xlink:href="DataSheet4.ZIP">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM3" position="float" content-type="local-data">
      <media xlink:href="Image1.TIF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM4" position="float" content-type="local-data">
      <media xlink:href="DataSheet2.ZIP">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM5" position="float" content-type="local-data">
      <media xlink:href="DataSheet5.ZIP">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SM6" position="float" content-type="local-data">
      <media xlink:href="DataSheet1.DOCX">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahn</surname><given-names>J. H.</given-names></name><name><surname>Davis</surname><given-names>E. S.</given-names></name><name><surname>Daugird</surname><given-names>T. A.</given-names></name><name><surname>Zhao</surname><given-names>S.</given-names></name><name><surname>Quiroga</surname><given-names>I. Y.</given-names></name><name><surname>Uryu</surname><given-names>H.</given-names></name><etal/></person-group> (<year>2021</year>). <article-title>Phase Separation Drives Aberrant Chromatin Looping and Cancer Development</article-title>. <source>Nature</source>
<volume>595</volume> (<issue>7868</issue>), <fpage>591</fpage>–<lpage>595</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-021-03662-5</pub-id>
<pub-id pub-id-type="pmid">34163069</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Banani</surname><given-names>S. F.</given-names></name><name><surname>Lee</surname><given-names>H. O.</given-names></name><name><surname>Hyman</surname><given-names>A. A.</given-names></name><name><surname>Rosen</surname><given-names>M. K.</given-names></name></person-group> (<year>2017</year>). <article-title>Biomolecular Condensates: Organizers of Cellular Biochemistry</article-title>. <source>Nat. Rev. Mol. Cell. Biol.</source>
<volume>18</volume> (<issue>5</issue>), <fpage>285</fpage>–<lpage>298</lpage>. <pub-id pub-id-type="doi">10.1038/nrm.2017.7</pub-id>
<pub-id pub-id-type="pmid">28225081</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolte</surname><given-names>S.</given-names></name><name><surname>Cordelières</surname><given-names>F. P.</given-names></name></person-group> (<year>2006</year>). <article-title>A Guided Tour into Subcellular Colocalization Analysis in Light Microscopy</article-title>. <source>J. Microsc.</source>
<volume>224</volume> (<issue>Pt 3</issue>), <fpage>213</fpage>–<lpage>232</lpage>. <pub-id pub-id-type="doi">10.1111/j.1365-2818.2006.01706.x</pub-id>
<pub-id pub-id-type="pmid">17210054</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brangwynne</surname><given-names>C. P.</given-names></name><name><surname>Eckmann</surname><given-names>C. R.</given-names></name><name><surname>Courson</surname><given-names>D. S.</given-names></name><name><surname>Rybarska</surname><given-names>A.</given-names></name><name><surname>Hoege</surname><given-names>C.</given-names></name><name><surname>Gharakhani</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2009</year>). <article-title>Germline P Granules Are Liquid Droplets that Localize by Controlled Dissolution/Condensation</article-title>. <source>Science</source>
<volume>324</volume> (<issue>5935</issue>), <fpage>1729</fpage>–<lpage>1732</lpage>. <pub-id pub-id-type="doi">10.1126/science.1172046</pub-id>
<pub-id pub-id-type="pmid">19460965</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chandra</surname><given-names>B.</given-names></name><name><surname>Michmerhuizen</surname><given-names>N. L.</given-names></name><name><surname>Shirnekhi</surname><given-names>H. K.</given-names></name><name><surname>Tripathi</surname><given-names>S.</given-names></name><name><surname>Pioso</surname><given-names>B. J.</given-names></name><name><surname>Baggett</surname><given-names>D. W.</given-names></name><etal/></person-group> (<year>2022</year>). <article-title>Phase Separation Mediates NUP98 Fusion Oncoprotein Leukemic Transformation</article-title>. <source>Cancer Discov.</source>
<pub-id pub-id-type="doi">10.1158/2159-8290.cd-21-0674</pub-id>
</mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feric</surname><given-names>M.</given-names></name><name><surname>Vaidya</surname><given-names>N.</given-names></name><name><surname>Harmon</surname><given-names>T. S.</given-names></name><name><surname>Mitrea</surname><given-names>D. M.</given-names></name><name><surname>Zhu</surname><given-names>L.</given-names></name><name><surname>Richardson</surname><given-names>T. M.</given-names></name><etal/></person-group> (<year>2016</year>). <article-title>Coexisting Liquid Phases Underlie Nucleolar Subcompartments</article-title>. <source>Cell.</source>
<volume>165</volume> (<issue>7</issue>), <fpage>1686</fpage>–<lpage>1697</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2016.04.047</pub-id>
<pub-id pub-id-type="pmid">27212236</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flory</surname><given-names>P. J.</given-names></name><name><surname>Krigbaum</surname><given-names>W. R.</given-names></name></person-group> (<year>1951</year>). <article-title>Thermodynamics of High Polymer Solutions</article-title>. <source>Annu. Rev. Phys. Chem.</source>
<volume>2</volume>, <fpage>383</fpage>–<lpage>402</lpage>. <pub-id pub-id-type="doi">10.1146/annurev.pc.02.100151.002123</pub-id>
</mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giepmans</surname><given-names>B. N.</given-names></name><name><surname>Adams</surname><given-names>S. R.</given-names></name><name><surname>Ellisman</surname><given-names>M. H.</given-names></name><name><surname>Tsien</surname><given-names>R. Y.</given-names></name></person-group> (<year>2006</year>). <article-title>The Fluorescent Toolbox for Assessing Protein Location and Function</article-title>. <source>Science</source>
<volume>312</volume> (<issue>5771</issue>), <fpage>217</fpage>–<lpage>224</lpage>. <pub-id pub-id-type="doi">10.1126/science.1124618</pub-id>
<pub-id pub-id-type="pmid">16614209</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Höckendorf</surname><given-names>B.</given-names></name><name><surname>Medyukhina</surname><given-names>A.</given-names></name></person-group> (<year>2022</year>). <source>Image-focused IO for Python Using Intake and Xarray v0.0.2</source>. <pub-id pub-id-type="doi">10.5281/zenodo.5874608</pub-id>
</mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kneen</surname><given-names>M.</given-names></name><name><surname>Farinas</surname><given-names>J.</given-names></name><name><surname>Li</surname><given-names>Y.</given-names></name><name><surname>Verkman</surname><given-names>A. S.</given-names></name></person-group> (<year>1998</year>). <article-title>Green Fluorescent Protein as a Noninvasive Intracellular pH Indicator</article-title>. <source>Biophys. J.</source>
<volume>74</volume> (<issue>3</issue>), <fpage>1591</fpage>–<lpage>1599</lpage>. <pub-id pub-id-type="doi">10.1016/S0006-3495(98)77870-1</pub-id>
<pub-id pub-id-type="pmid">9512054</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leiderman</surname><given-names>P.</given-names></name><name><surname>Huppert</surname><given-names>D.</given-names></name><name><surname>Agmon</surname><given-names>N.</given-names></name></person-group> (<year>2006</year>). <article-title>Transition in the Temperature-Dependence of GFP Fluorescence: from Proton Wires to Proton Exit</article-title>. <source>Biophys. J.</source>
<volume>90</volume> (<issue>3</issue>), <fpage>1009</fpage>–<lpage>1018</lpage>. <pub-id pub-id-type="doi">10.1529/biophysj.105.069393</pub-id>
<pub-id pub-id-type="pmid">16284263</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>P.</given-names></name><name><surname>Banjade</surname><given-names>S.</given-names></name><name><surname>Cheng</surname><given-names>H. C.</given-names></name><name><surname>Kim</surname><given-names>S.</given-names></name><name><surname>Chen</surname><given-names>B.</given-names></name><name><surname>Guo</surname><given-names>L.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>Phase Transitions in the Assembly of Multivalent Signalling Proteins</article-title>. <source>Nature</source>
<volume>483</volume> (<issue>7389</issue>), <fpage>336</fpage>–<lpage>340</lpage>. <pub-id pub-id-type="doi">10.1038/nature10879</pub-id>
<pub-id pub-id-type="pmid">22398450</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michmerhuizen</surname><given-names>N. L.</given-names></name><name><surname>Klco</surname><given-names>J. M.</given-names></name><name><surname>Mullighan</surname><given-names>C. G.</given-names></name></person-group> (<year>2020</year>). <article-title>Mechanistic Insights and Potential Therapeutic Approaches for NUP98-Rearranged Hematologic Malignancies</article-title>. <source>Blood</source>
<volume>136</volume> (<issue>20</issue>), <fpage>2275</fpage>–<lpage>2289</lpage>. <pub-id pub-id-type="doi">10.1182/blood.2020007093</pub-id>
<pub-id pub-id-type="pmid">32766874</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitrea</surname><given-names>D. M.</given-names></name><name><surname>Chandra</surname><given-names>B.</given-names></name><name><surname>Ferrolino</surname><given-names>M. C.</given-names></name><name><surname>Gibbs</surname><given-names>E. B.</given-names></name><name><surname>Tolbert</surname><given-names>M.</given-names></name><name><surname>White</surname><given-names>M. R.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>Methods for Physical Characterization of Phase-Separated Bodies and Membrane-Less Organelles</article-title>. <source>J. Mol. Biol.</source>
<volume>430</volume> (<issue>23</issue>), <fpage>4773</fpage>–<lpage>4805</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmb.2018.07.006</pub-id>
<pub-id pub-id-type="pmid">30017918</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitrea</surname><given-names>D. M.</given-names></name><name><surname>Cika</surname><given-names>J. A.</given-names></name><name><surname>Guy</surname><given-names>C. S.</given-names></name><name><surname>Ban</surname><given-names>D.</given-names></name><name><surname>Banerjee</surname><given-names>P. R.</given-names></name><name><surname>Stanley</surname><given-names>C. B.</given-names></name><etal/></person-group> (<year>2016</year>). <article-title>Nucleophosmin Integrates within the Nucleolus via Multi-Modal Interactions with Proteins Displaying R-Rich Linear Motifs and rRNA</article-title>. <source>eLife</source>
<volume>5</volume>. <pub-id pub-id-type="doi">10.7554/eLife.13571</pub-id>
</mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morikawa</surname><given-names>T. J.</given-names></name><name><surname>Fujita</surname><given-names>H.</given-names></name><name><surname>Kitamura</surname><given-names>A.</given-names></name><name><surname>Horio</surname><given-names>T.</given-names></name><name><surname>Yamamoto</surname><given-names>J.</given-names></name><name><surname>Kinjo</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2016</year>). <article-title>Dependence of Fluorescent Protein Brightness on Protein Concentration in Solution and Enhancement of it</article-title>. <source>Sci. Rep.</source>
<volume>6</volume>, <fpage>22342</fpage>. <pub-id pub-id-type="doi">10.1038/srep22342</pub-id>
<pub-id pub-id-type="pmid">26956628</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><collab>R Development Core Team</collab> (<year>2011</year>).<article-title>RStudio: Integrated Development Environment for R</article-title>
</mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riback</surname><given-names>J. A.</given-names></name><name><surname>Zhu</surname><given-names>L.</given-names></name><name><surname>Ferrolino</surname><given-names>M. C.</given-names></name><name><surname>Tolbert</surname><given-names>M.</given-names></name><name><surname>Mitrea</surname><given-names>D. M.</given-names></name><name><surname>Sanders</surname><given-names>D. W.</given-names></name><etal/></person-group> (<year>2020</year>). <article-title>Composition-dependent Thermodynamics of Intracellular Phase Separation</article-title>. <source>Nature</source>
<volume>581</volume> (<issue>7807</issue>), <fpage>209</fpage>–<lpage>214</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-020-2256-2</pub-id>
<pub-id pub-id-type="pmid">32405004</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schindelin</surname><given-names>J.</given-names></name><name><surname>Arganda-Carreras</surname><given-names>I.</given-names></name><name><surname>Frise</surname><given-names>E.</given-names></name><name><surname>Kaynig</surname><given-names>V.</given-names></name><name><surname>Longair</surname><given-names>M.</given-names></name><name><surname>Pietzsch</surname><given-names>T.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>Fiji: an Open-Source Platform for Biological-Image Analysis</article-title>. <source>Nat. Methods</source>
<volume>9</volume> (<issue>7</issue>), <fpage>676</fpage>–<lpage>682</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2019</pub-id>
<pub-id pub-id-type="pmid">22743772</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stirling</surname><given-names>D. R.</given-names></name><name><surname>Swain-Bowden</surname><given-names>M. J.</given-names></name><name><surname>Lucas</surname><given-names>A. M.</given-names></name><name><surname>Carpenter</surname><given-names>A. E.</given-names></name><name><surname>Cimini</surname><given-names>B. A.</given-names></name><name><surname>Goodman</surname><given-names>A.</given-names></name></person-group> (<year>2021</year>). <article-title>CellProfiler 4: Improvements in Speed, Utility and Usability</article-title>. <source>BMC Bioinforma.</source>
<volume>22</volume> (<issue>1</issue>), <fpage>433</fpage>. <pub-id pub-id-type="doi">10.1186/s12859-021-04344-9</pub-id>
</mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stringer</surname><given-names>C.</given-names></name><name><surname>Wang</surname><given-names>T.</given-names></name><name><surname>Michaelos</surname><given-names>M.</given-names></name><name><surname>Pachitariu</surname><given-names>M.</given-names></name></person-group> (<year>2021</year>). <article-title>Cellpose: a Generalist Algorithm for Cellular Segmentation</article-title>. <source>Nat. Methods</source>
<volume>18</volume> (<issue>1</issue>), <fpage>100</fpage>–<lpage>106</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-020-01018-x</pub-id>
<pub-id pub-id-type="pmid">33318659</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van der Walt</surname><given-names>S.</given-names></name><name><surname>Schönberger</surname><given-names>J. L.</given-names></name><name><surname>Nunez-Iglesias</surname><given-names>J.</given-names></name><name><surname>Boulogne</surname><given-names>F.</given-names></name><name><surname>Warner</surname><given-names>J. D.</given-names></name><name><surname>Yager</surname><given-names>N.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>Scikit-Image: Image Processing in Python</article-title>. <source>PeerJ</source>
<volume>2</volume>, <fpage>e453</fpage>. <pub-id pub-id-type="doi">10.7717/peerj.453</pub-id>
<pub-id pub-id-type="pmid">25024921</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Van Rossum</surname><given-names>G.</given-names></name><name><surname>Drake</surname><given-names>F. L.</given-names></name></person-group> (<year>2009</year>). <source>Python 3 Reference Manual</source>. <publisher-loc>Scotts Valley, CA</publisher-loc>: <publisher-name>CreateSpace</publisher-name>. </mixed-citation>
    </ref>
  </ref-list>
</back>
