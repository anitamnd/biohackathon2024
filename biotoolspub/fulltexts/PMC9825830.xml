<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Virus Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Virus Evol</journal-id>
    <journal-id journal-id-type="publisher-id">vevolu</journal-id>
    <journal-title-group>
      <journal-title>Virus Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2057-1577</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9825830</article-id>
    <article-id pub-id-type="doi">10.1093/ve/veac120</article-id>
    <article-id pub-id-type="publisher-id">veac120</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Resources</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/MED00860</subject>
        <subject>AcademicSubjects/SCI01130</subject>
        <subject>AcademicSubjects/SCI02285</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>bayroot: Bayesian sampling of HIV-1 integration dates by root-to-tip regression</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8242-7862</contrib-id>
        <name>
          <surname>Ferreira</surname>
          <given-names>Roux-Cil</given-names>
        </name>
        <aff><institution content-type="department">Department of Pathology and Laboratory Medicine, Western University</institution>, London, ON N6A 5C1, <country country="CA">Canada</country></aff>
        <xref rid="FN01" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wong</surname>
          <given-names>Emmanuel</given-names>
        </name>
        <aff><institution content-type="department">Department of Pathology and Laboratory Medicine, Western University</institution>, London, ON N6A 5C1, <country country="CA">Canada</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3779-154X</contrib-id>
        <name>
          <surname>Poon</surname>
          <given-names>Art F Y</given-names>
        </name>
        <!--apoon42@uwo.ca-->
        <aff><institution content-type="department">Department of Pathology and Laboratory Medicine, Western University</institution>, London, ON N6A 5C1, <country country="CA">Canada</country></aff>
        <aff><institution content-type="department">Department of Microbiology and Immunology, Western University</institution>, London, ON N6A 3K7, <country country="CA">Canada</country></aff>
        <aff><institution content-type="department">Department of Computer Science, Western University</institution>, London, ON N6A 5B7, <country country="CA">Canada</country></aff>
        <aff><institution content-type="department">Health Sciences Addition, Western University</institution>, H422, London, Ontario N6A 5C1, <country country="CA">Canada</country></aff>
        <xref rid="FN02" ref-type="author-notes"/>
        <xref rid="COR0001" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR0001">*Corresponding author: E-mail: <email xlink:href="apoon42@uwo.ca">apoon42@uwo.ca</email></corresp>
      <fn id="FN01">
        <label>†</label>
        <p>
          <ext-link xlink:href="https://orcid.org/0000-0002-8242-7862" ext-link-type="uri">https://orcid.org/0000-0002-8242-7862</ext-link>
        </p>
      </fn>
      <fn id="FN02">
        <label>‡</label>
        <p>
          <ext-link xlink:href="https://orcid.org/0000-0003-3779-154X" ext-link-type="uri">https://orcid.org/0000-0003-3779-154X</ext-link>
        </p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-12-21">
      <day>21</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <volume>9</volume>
    <issue>1</issue>
    <elocation-id>veac120</elocation-id>
    <history>
      <date date-type="accepted">
        <day>20</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>03</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="received">
        <day>27</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>10</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>07</day>
        <month>1</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="veac120.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>The composition of the latent human immunodeficiency virus 1 (HIV-1) reservoir is shaped by when proviruses integrated into host genomes. These integration dates can be estimated by phylogenetic methods like root-to-tip (RTT) regression. However, RTT does not accommodate variation in the number of mutations over time, uncertainty in estimating the molecular clock, or the position of the root in the tree. To address these limitations, we implemented a Bayesian extension of RTT as an R package (<italic toggle="yes">bayroot</italic>), which enables the user to incorporate prior information about the time of infection and start of antiretroviral therapy. Taking an unrooted maximum likelihood tree as input, we use a Metropolis–Hastings algorithm to sample from the joint posterior distribution of three parameters (the rate of sequence evolution, i.e., molecular clock; the location of the root; and the time associated with the root). Next, we apply rejection sampling to this posterior sample of model parameters to simulate integration dates for HIV proviral sequences. To validate this method, we use the R package <italic toggle="yes">treeswithintrees</italic> (<italic toggle="yes">twt</italic>) to simulate time-scaled trees relating samples of actively and latently infected T cells from a single host. We find that <italic toggle="yes">bayroot</italic> yields significantly more accurate estimates of integration dates than conventional RTT under a range of model settings.</p>
    </abstract>
    <kwd-group>
      <kwd>HIV-1</kwd>
      <kwd>latent viral reservoir</kwd>
      <kwd>molecular clock</kwd>
      <kwd>root-to-tip regression</kwd>
      <kwd>Bayesian inference</kwd>
    </kwd-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <label>1.</label>
    <title>Introduction</title>
    <p>Root-to-tip (RTT) regression is a simple method to locate the earliest point in time in a phylogenetic tree (i.e., rooting the tree; <xref rid="R16" ref-type="bibr">Huelsenbeck, Bollback, and Levine 2002</xref>), to measure the rate of evolution (<xref rid="R9" ref-type="bibr">Drummond et al. 2003</xref>), or to reconstruct the divergence times of common ancestors. This method assumes the existence of a strict molecular clock, i.e., that the rate of molecular evolution is roughly constant (<xref rid="R4" ref-type="bibr">Bromham and Penny 2003</xref>). Accordingly, the number of nucleotide substitutions accumulating in a sequence should increase linearly over time. Hence, this method is a linear regression of the evolutionary divergence of sequences from their common ancestor against the times when those sequences were observed. The primary input of RTT regression is an unrooted phylogenetic tree with branch lengths measured in units of evolutionary time (i.e., the expected number of substitutions per site; <xref rid="R33" ref-type="bibr">Tajima and Nei 1984</xref>), which is the standard output of maximum likelihood methods for reconstructing phylogenies. The tips of the tree representing observed sequences are labelled with sampling times. Thus, RTT becomes an optimization over three parameters: the location of the root in the tree, the time associated with the root (<italic toggle="yes">x</italic>-intercept), and the molecular clock (slope of regression).</p>
    <p>RTT has a broad range of applications. Since many viruses have a very rapid rate of evolution, RTT can be applied to sequences collected over a number of months or years. For instance, RTT has recently been used to estimate the origin date and clock rate of severe acute respiratory syndrome coronavirus 2 within the first few months of the pandemic (<xref rid="R11" ref-type="bibr">Duchene et al. 2020</xref>). We are particularly interested in the use of RTT to estimate the integration dates of HIV-1 proviruses within hosts (<xref rid="R17" ref-type="bibr">Jones et al. 2018</xref>). HIV-1 converts its RNA genome into double-stranded DNA that becomes integrated into the host genome as part of the virus replication cycle. In some cases, this integrated provirus becomes reversibly dormant in a transcriptionally inactive host cell (<xref rid="R29" ref-type="bibr">Siliciano and Siliciano 2004</xref>). This long-lived reservoir of latently infected cells is the primary obstacle to an effective cure for HIV-1. Consequently, characterizing the composition and dynamics of the latent reservoir has significant implications for HIV-1 cure research (e.g., <xref rid="R15" ref-type="bibr">Gondim et al. 2021</xref>).</p>
    <p>For instance, we can estimate the molecular clock (the slope of the regression) from longitudinal samples of plasma HIV-1 RNA sequences before the start of antiretroviral therapy (ART). If we reconstruct a tree relating both these RNA sequences and proviral sequences from the latent reservoir, we can then use our clock estimate to extrapolate integration dates for the latter (<xref rid="R17" ref-type="bibr">Jones et al. 2018</xref>). This relies on the assumption that the integrated HIV-1 genome ceases to accumulate mutations upon integrating into the host genome. Since we are reconstructing a tree relating individual HIV-1 sequences from a single host, the resulting tree is technically a ‘genealogy’ instead of a phylogeny, and we are counting mutations in an individual lineage instead of the accumulation of substitutions in a population. Consequently, we will avoid using the terms ‘phylogeny’ and ‘substitution’ from this point onward.</p>
    <p>Due to its simplicity, RTT has a number of significant limitations. It implicitly assumes that the input tree is known without error. In practice, each proviral sequence is mapped to the regression line for a given tree to yield one and only one estimate of its integration date. Although one could generate interval estimates for integration dates, this is not trivial because we need to consider the joint confidence for the regression slope and intercept and to invert the model to predict dates. Furthermore, variation in the number of mutations after a given amount of time is expected, even under a strict molecular clock (<xref rid="R19" ref-type="bibr">Langley and Fitch 1974</xref>). In other words, a proviral sequence may by chance carry more mutations than expected given its actual date of integration. This random outcome can cause RTT to project a sequence’s integration date estimate into the future, past its time of sampling or even past the start of ART, when the infection of new cells should be nearly completely suppressed.</p>
    <p>Here we describe a Bayesian extension of the RTT method to estimate HIV-1 integration dates. Adopting a Bayesian approach provides a means of quantifying our uncertainty in estimating integration dates, as well as incorporating prior information about the time of infection and the start of ART. We detail our implementation of this method as an R package called <italic toggle="yes">bayroot</italic> and use a simulation model of within-host population dynamics to validate <italic toggle="yes">bayroot</italic> in comparison to conventional RTT methods.</p>
  </sec>
  <sec id="s2">
    <label>2.</label>
    <title>Methods</title>
    <sec id="s2-s1">
      <label>2.1</label>
      <title>Regression model</title>
      <p>We start with an unrooted tree <italic toggle="yes">T</italic> relating <italic toggle="yes">n</italic> observed sequences. A strict molecular clock assumes that mutations accumulate at a constant rate <italic toggle="yes">µ</italic> over time, such that the number of mutations per unit time follows a Poisson distribution. Let <italic toggle="yes">Y</italic><sub><italic toggle="yes">i</italic></sub> be the number of mutations in the <italic toggle="yes">i</italic><sup><italic toggle="yes">th</italic></sup> observed sequence, which is determined by the location of the root in <italic toggle="yes">T</italic>. Since <italic toggle="yes">Y</italic><sub><italic toggle="yes">i</italic></sub> is an integer-valued outcome, we must rescale the input tree <italic toggle="yes">T</italic> by multiplying its branch lengths by the sequence length, such that lengths are in units of the expected number of mutations per genome. Note that because these measures of evolutionary time are derived from a continuous-time Markov model of sequence evolution, multiple hits and reversions are accounted for. Let <italic toggle="yes">t</italic><sub>0</sub> be the origin time associated with the root. Let <inline-formula id="ILM0001"><tex-math notation="LaTeX" id="ILM0001-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\Delta t_i$\end{document}</tex-math></inline-formula> be the time that has elapsed between the <italic toggle="yes">i</italic><sup><italic toggle="yes">th</italic></sup> sample and the root. The log-likelihood for a set of RNA sequences <inline-formula id="ILM0002"><tex-math notation="LaTeX" id="ILM0002-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\{Y_i, \Delta t_i\}$\end{document}</tex-math></inline-formula> is:</p>
      <p><disp-formula id="M0001"><label>(1)</label><tex-math notation="LaTeX" id="M0001-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ \log L(Y_i, \Delta t_i) = \sum_i Y_i\log(\mu \Delta t_i) - \mu \Delta t_i - \log \Gamma(Y_i+1), $$\end{document}</tex-math></disp-formula> where <inline-formula id="ILM0003"><tex-math notation="LaTeX" id="ILM0003-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\Gamma(x)$\end{document}</tex-math></inline-formula> is the gamma function. <xref rid="M0001" ref-type="disp-formula">Equation (1)</xref> is sometimes referred to as the Langley–Fitch model (<xref rid="R19" ref-type="bibr">Langley and Fitch, 1974</xref>).</p>
      <p>Following prior work (<xref rid="R16" ref-type="bibr">Huelsenbeck, Bollback, and Levine 2002</xref>; <xref rid="R8" ref-type="bibr">Didelot et al. 2018</xref>), we assume a uniform prior distribution for possible locations of the root over the entire length of the tree. We also assume a uniform prior distribution for <italic toggle="yes">t</italic><sub>0</sub>, as standard practice in applications of Bayesian inference to HIV-1 infections (e.g., <xref rid="R32" ref-type="bibr">Sweeting et al. 2010</xref>; <xref rid="R30" ref-type="bibr">Stirrup and Dunn 2018</xref>). If a seroconversion window, i.e., the time interval between the last HIV seronegative visit and the first seropositive visit, is available for the host individual, these visit dates can be used to set lower and upper bounds for the uniform prior on <italic toggle="yes">t</italic><sub>0</sub>. If this information is not available, then these bounds may be based on other data such as viral load and CD4 cell count measurements (<xref rid="R23" ref-type="bibr">Pantazis et al. 2019</xref>). Otherwise, one may set the upper bound to the first sample collection date, and the lower bound may be derived from regional estimates of the time to HIV-1 diagnosis (e.g., <xref rid="R34" ref-type="bibr">Van Sighem et al. 2015</xref>). Finally, we assume a lognormal prior distribution on the clock rate <italic toggle="yes">µ</italic>, which can be informed by previous measurements of HIV-1 mutation rates within hosts e.g., <xref rid="R2" ref-type="bibr">Alizon and Fraser (2013)</xref>.</p>
      <p>With these prior distributions and the model likelihood, we implemented a Metropolis–Hastings sampling algorithm in R. A proposal function shifts the root along a branch by some distance <inline-formula id="ILM0004"><tex-math notation="LaTeX" id="ILM0004-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$d\sim \mathrm{Unif}(0, \delta_r)$\end{document}</tex-math></inline-formula>, selecting a branch at random if it encounters an internal node (i.e., split) as it traverses the length of the tree. If, however, a terminal node is encountered before the root has been shifted by distance <italic toggle="yes">d</italic>, then the remaining distance is travelled by reflecting back from this terminus. This results in a symmetric proposal distribution. We also used a uniform proposal <inline-formula id="ILM0005"><tex-math notation="LaTeX" id="ILM0005-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mu^{\prime}\sim \mathrm{Unif}(\mu-\delta_c, \mu+\delta_c)$\end{document}</tex-math></inline-formula> for the clock rate and a truncated normal proposal <inline-formula id="ILM0006"><tex-math notation="LaTeX" id="ILM0006-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t_0^{\prime}\sim {N}(t_0, \sigma)$\end{document}</tex-math></inline-formula> for the origin time. The sampling algorithm returns an S3 object storing a data frame of sampled parameter values and a character vector of sampled trees serialized into Newick strings.</p>
    </sec>
    <sec id="s2-s2">
      <label>2.2</label>
      <title>Sampling integration dates</title>
      <p>Given a posterior sample of parameters <italic toggle="yes">Y</italic>, <italic toggle="yes">µ</italic>, and <italic toggle="yes">t</italic><sub>0</sub>, we need to propagate this information to the distribution of integration times associated with proviral DNA sequences sampled post-ART initiation. Using Bayes rule, the probability of integration time <italic toggle="yes">t</italic><sub><italic toggle="yes">j</italic></sub> for the <inline-formula id="ILM0007"><tex-math notation="LaTeX" id="ILM0007-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j^{\mathrm{th}}$\end{document}</tex-math></inline-formula> DNA sequence given divergence <italic toggle="yes">Y</italic><sub><italic toggle="yes">j</italic></sub> is:</p>
      <p><disp-formula id="M0002"><label>(2)</label><tex-math notation="LaTeX" id="M0002-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ P(t_j\,|\,Y_j) = \frac{P(Y_j\,|\,t_j) P(t_j)}{P(Y_j)}, $$\end{document}</tex-math></disp-formula> where we index by <italic toggle="yes">j</italic> instead of <italic toggle="yes">i</italic> to emphasize a shift from HIV-1 RNA to DNA sequences. We assume a uniform prior for integration times, <inline-formula id="ILM0008"><tex-math notation="LaTeX" id="ILM0008-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P(t_j) = (T - t_0)^{-1}$\end{document}</tex-math></inline-formula> for <inline-formula id="ILM0009"><tex-math notation="LaTeX" id="ILM0009-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t_0\le t_j \le T$\end{document}</tex-math></inline-formula> and <inline-formula id="ILM0010"><tex-math notation="LaTeX" id="ILM0010-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P(t_j)=0$\end{document}</tex-math></inline-formula> otherwise, where <italic toggle="yes">t</italic><sub>0</sub> is the origin date and <italic toggle="yes">T</italic> is the time of ART initiation. Substituting <xref rid="M0001" ref-type="disp-formula">Equation (1)</xref> as <inline-formula id="ILM0011"><tex-math notation="LaTeX" id="ILM0011-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P(Y_j\,|\,t_j)$\end{document}</tex-math></inline-formula> into the denominator <inline-formula id="ILM0012"><tex-math notation="LaTeX" id="ILM0012-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P(Y_j)=\int_{t_0}^{T} P(Y_j\,|\,t_j) P(t_j) dt$\end{document}</tex-math></inline-formula> and setting <inline-formula id="ILM0013"><tex-math notation="LaTeX" id="ILM0013-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$s=t-t_0$\end{document}</tex-math></inline-formula>, we solve the definite integral:</p>
      <p><disp-formula id="M0003"><label>(3)</label><tex-math notation="LaTeX" id="M0003-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ P(Y_j) = \frac{\int_0^{T-t_0} (\mu s)^{Y_j} \exp(-\mu s) \mathrm{d}s}{(T-t_0)\Gamma(Y_j+1)} = \frac{\gamma(Y_j+1, \mu(T-t_0))}{\mu(T-t_0)\Gamma(Y_j+1)}, $$\end{document}</tex-math></disp-formula> where <inline-formula id="ILM0014"><tex-math notation="LaTeX" id="ILM0014-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\gamma(a, x)$\end{document}</tex-math></inline-formula> is the lower incomplete gamma function, <inline-formula id="ILM0015"><tex-math notation="LaTeX" id="ILM0015-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\int_0^x t^{a-1}\exp(-t) dt$\end{document}</tex-math></inline-formula>. Finally, substituting <xref rid="M0001" ref-type="disp-formula">Equations (1)</xref> and <xref rid="M0003" ref-type="disp-formula">(3)</xref> into <xref rid="M0002" ref-type="disp-formula">(2)</xref>, we can write: <disp-formula id="M0004"><label>(4)</label><tex-math notation="LaTeX" id="M0004-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ P(t_j | Y_j) = \frac{\mu M^{Y_j}\exp(-M)}{\gamma(Y_j+1, M)}, $$\end{document}</tex-math></disp-formula> where we use a shorthand <inline-formula id="ILM0016"><tex-math notation="LaTeX" id="ILM0016-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M = \mu(T-t_0)$\end{document}</tex-math></inline-formula> to simplify the equation. To generate a sample of integration dates from this distribution, we use a simple rejection sampling method. For a given posterior sample of <italic toggle="yes">Y</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">µ</italic>, and <italic toggle="yes">t</italic><sub>0</sub>, we use Brent’s algorithm to find the maximum of <xref rid="M0004" ref-type="disp-formula">Equation (4)</xref>, initialized at the midpoint <inline-formula id="ILM0017"><tex-math notation="LaTeX" id="ILM0017-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t = t_0 + (T-t_0)/2$\end{document}</tex-math></inline-formula>. This maximum was used as an upper bound for rejection sampling for times drawn from the prior distribution, <inline-formula id="ILM0018"><tex-math notation="LaTeX" id="ILM0018-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \sim \textrm{Unif}(t_0, T)$\end{document}</tex-math></inline-formula>.</p>
      <p>The Bayesian regression and integration date sampling methods described above were implemented in R as a package called <italic toggle="yes">bayroot</italic>. All source code is publicly available under the MIT license at <ext-link xlink:href="https://github.com/PoonLab/bayroot" ext-link-type="uri">https://github.com/PoonLab/bayroot</ext-link>.</p>
    </sec>
    <sec id="s2-s3">
      <label>2.3</label>
      <title>Simulating data</title>
      <p>To validate the above method, we used the R package <italic toggle="yes">twt</italic> (‘treeswithintrees’, <ext-link xlink:href="https://github.com/PoonLab/twt" ext-link-type="uri">https://github.com/PoonLab/twt</ext-link>) to simulate cell population dynamics forward in time and then to simulate trees by sampling lineages backwards in time to their common ancestors. This package uses exact stochastic simulation of discrete events (<xref rid="R14" ref-type="bibr">Gillespie, 1977</xref>). In brief, it calculates the total rate of all events (Λ), draws an exponentially distributed waiting time to the first event <inline-formula id="ILM0019"><tex-math notation="LaTeX" id="ILM0019-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\tau \sim \Lambda \exp(-\Lambda)$\end{document}</tex-math></inline-formula>, and then draws a uniform random number to determine which event occurs. We implemented a compartmental model of cell population dynamics (<xref rid="F1" ref-type="fig">Fig. 1</xref>) that can be represented by the following set of differential equations: <disp-formula id="M0005"><label>(5)</label><tex-math notation="LaTeX" id="M0005-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\eqalign{ \frac{dT}{dt} &amp;= -\rho T,\nonumber\\ \frac{dA_S}{dt} &amp;= \rho kT + m_{LA}L_S - \lambda_{AA}(t) A_I A_S - m_{AL}A_S - \mu_{A_S} A_S,\nonumber\\ \frac{dA_I}{dt} &amp;= \lambda_{AA}(t) A_I A_S + m_{LA}L_I - m_{AL}A_I - \mu_{A_I}A_I,\nonumber\\ \frac{dL_S}{dt} &amp;= r(1-k)T + m_{AL}A_S - \lambda_{AL}(t) A_I L_S - \lambda_{LL} L_I L_S - m_{LA}L_S - \mu_{L} L_S,\nonumber\\ \frac{dL_I}{dt} &amp;= \lambda_{AL}(t) A_I L_S + \lambda_{LL} L_I L_S + m_{AL}A_I - m_{LA}L_I - \mu_{L}L_I.} $$\end{document}</tex-math></disp-formula></p>
      <fig position="float" id="F1" fig-type="figure">
        <label>Figure 1.</label>
        <caption>
          <p>A schematic diagram of the compartmental model used to simulate cell population dynamics. Each box represents a well-mixed population of cells sharing the same rate parameters. We assume that only actively infected cells release virus particles that go on to infect other susceptible cells.</p>
        </caption>
        <graphic xlink:href="veac120f1" position="float"/>
      </fig>
      <p>This model is a simplified version of the system described by <xref rid="R27" ref-type="bibr">Rong and Perelson (2009)</xref>. Most notably, our version does not model changes in the viral load. <italic toggle="yes">T</italic> represents a finite population of naive CD4+ T cells from which the populations of active (<italic toggle="yes">A</italic>) and resting (latent, <italic toggle="yes">L</italic>) cells are replenished at rates <inline-formula id="ILM0020"><tex-math notation="LaTeX" id="ILM0020-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$k\rho$\end{document}</tex-math></inline-formula> and <inline-formula id="ILM0021"><tex-math notation="LaTeX" id="ILM0021-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(1-k)\rho$\end{document}</tex-math></inline-formula>, respectively, for <inline-formula id="ILM0022"><tex-math notation="LaTeX" id="ILM0022-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$0\le k \le 1$\end{document}</tex-math></inline-formula>. The <italic toggle="yes">S</italic> and <italic toggle="yes">I</italic> subscripts denote susceptible and infected subpopulations of active and latent cells. A branching event (<italic toggle="yes">λ</italic><sub><italic toggle="yes">xy</italic></sub>) requires a source cell to induce a target cell to undergo a change of state (switch compartments from <italic toggle="yes">x</italic> to <italic toggle="yes">y</italic>). For example, <italic toggle="yes">λ</italic><sub><italic toggle="yes">AA</italic></sub> represents the infection rate of a susceptible active T cell by a virus released from an actively infected cell. We assume that virus replication is completely blocked by the initiation of ART at time <inline-formula id="ILM0023"><tex-math notation="LaTeX" id="ILM0023-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^*$\end{document}</tex-math></inline-formula> (<xref rid="R18" ref-type="bibr">Kearney et al. 2014</xref>; <xref rid="R3" ref-type="bibr">Brodin et al. 2016</xref>), such that <inline-formula id="ILM0024"><tex-math notation="LaTeX" id="ILM0024-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lambda_{A\bullet}(t\ge t^*) = 0$\end{document}</tex-math></inline-formula>. A transition event occurs when a cell spontaneously migrates from compartments <italic toggle="yes">x</italic> to <italic toggle="yes">y</italic> at rate <italic toggle="yes">m</italic><sub><italic toggle="yes">xy</italic></sub>. For example, <italic toggle="yes">m</italic><sub><italic toggle="yes">LA</italic></sub> represents the reactivation rate of a latent cell. Finally, we assume constant cell death rates <italic toggle="yes">µ</italic><sub><italic toggle="yes">x</italic></sub> for each compartment <italic toggle="yes">x</italic>.</p>
      <p>The simulation is initialized at time zero with user-specified population sizes of susceptible cells in each compartment, and a single actively infected cell, <inline-formula id="ILM0025"><tex-math notation="LaTeX" id="ILM0025-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A_I(0)=1$\end{document}</tex-math></inline-formula>. We simulated the integer-valued population size trajectories <inline-formula id="ILM0026"><tex-math notation="LaTeX" id="ILM0026-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\{T, A_S, A_I, L_S, L_I\}(t)$\end{document}</tex-math></inline-formula> forward in time until a stopping time of <italic toggle="yes">t</italic> = 20 simulation time units. We generated 50 replicate sets of trajectories under two different scenarios by exact stochastic simulation. The rate parameters were set to the following values: <italic toggle="yes">r</italic> = 0.02, <italic toggle="yes">k</italic> = 0.5, <inline-formula id="ILM0027"><tex-math notation="LaTeX" id="ILM0027-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lambda_{AA}(t \lt t^*)=0.002$\end{document}</tex-math></inline-formula>, <inline-formula id="ILM0028"><tex-math notation="LaTeX" id="ILM0028-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lambda_{AL}(t \lt t^*) = 10^{-4}$\end{document}</tex-math></inline-formula>, <inline-formula id="ILM0029"><tex-math notation="LaTeX" id="ILM0029-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$m_{AL}=m_{LA}=0.001$\end{document}</tex-math></inline-formula>, <inline-formula id="ILM0030"><tex-math notation="LaTeX" id="ILM0030-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mu_{A_S} = 0.005$\end{document}</tex-math></inline-formula>, <inline-formula id="ILM0031"><tex-math notation="LaTeX" id="ILM0031-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mu_{A_I} = 0.1$\end{document}</tex-math></inline-formula>, and <inline-formula id="ILM0032"><tex-math notation="LaTeX" id="ILM0032-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mu_L=0.001$\end{document}</tex-math></inline-formula>. ART was initiated at <inline-formula id="ILM0033"><tex-math notation="LaTeX" id="ILM0033-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^* = 10$\end{document}</tex-math></inline-formula> time units post-infection in Scenario 1 and at <inline-formula id="ILM0034"><tex-math notation="LaTeX" id="ILM0034-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^* = 15$\end{document}</tex-math></inline-formula> in Scenario 2. For each iteration of the simulation, we calculated the rates for every type of event, adjusted by the respective compartment size at the current time <italic toggle="yes">t</italic>. For example, the rate of transmissions from <italic toggle="yes">A</italic><sub><italic toggle="yes">I</italic></sub> to <italic toggle="yes">A</italic><sub><italic toggle="yes">S</italic></sub> was set to <inline-formula id="ILM0035"><tex-math notation="LaTeX" id="ILM0035-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lambda_{AA}(t) A_I(t) A_S(t)$\end{document}</tex-math></inline-formula>. We drew an exponential waiting time given the total rate of all event types: <disp-formula id="UM0001"><tex-math notation="LaTeX" id="UM0001-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ \Lambda(t)=\sum_{x,y} \lambda_{xy}(t) N_x(t) N_y(t) + \sum_{x,y} m_{xy}(t)N_x(t), $$\end{document}</tex-math></disp-formula> and then determined which event type occurred with probability <inline-formula id="ILM0036"><tex-math notation="LaTeX" id="ILM0036-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lambda_{xy}(t) N_x(t) N_y(t) / \Lambda(t)$\end{document}</tex-math></inline-formula> or <inline-formula id="ILM0037"><tex-math notation="LaTeX" id="ILM0037-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$m_{xy}(t) N_x(t) / \Lambda(t)$\end{document}</tex-math></inline-formula>. Next, we incremented or decremented the respective population sizes for compartments affected by the event type. The time, type, and compartments of this event is recorded in a log that is later used to simulate trees. An example set of population size trajectories simulated using this algorithm under Scenario 1 is illustrated in <xref rid="F2" ref-type="fig">Fig. 2</xref>.</p>
      <fig position="float" id="F2" fig-type="figure">
        <label>Figure 2.</label>
        <caption>
          <p>Examples of <italic toggle="yes">twt</italic> simulation outputs for a model of cell dynamics in the latent reservoir. (top) Population dynamics simulated forward in time. Each line represents the population size of a different compartment. S = susceptible, I = infected. The dashed vertical line indicates the time of ART initiation. This plot was produced by calling the generic plot method on the S3 object from the <italic toggle="yes">twt</italic> function <italic toggle="yes">sim.outer.tree</italic>. (bottom) A tree simulated in reverse-time, relating 10 cells sampled from the latently infected compartment at <italic toggle="yes">τ</italic> = 0 and 30 from the actively infected compartment at <inline-formula id="ILM0038"><tex-math notation="LaTeX" id="ILM0038-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\tau=11, 14, 17$\end{document}</tex-math></inline-formula> (Scenario 1), where <inline-formula id="ILM0039"><tex-math notation="LaTeX" id="ILM0039-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\tau = 20-t$\end{document}</tex-math></inline-formula>. Triangles represent transmission events, open circles represent transitions, and closed circles represent sampling times. Branches representing cell lineages in a latent state (Latentcomp_<italic toggle="yes">N</italic>) are collapsed prior to simulating virus evolution. This tree visualization was generated from the same S3 object using the R package <italic toggle="yes">ggfree</italic> (<ext-link xlink:href="https://github.com/ArtPoon/ggfree" ext-link-type="uri">https://github.com/ArtPoon/ggfree</ext-link>).</p>
        </caption>
        <graphic xlink:href="veac120f2" position="float"/>
      </fig>
      <p>To generate a tree relating the sampled lineages in <italic toggle="yes">twt</italic>, we applied another exact stochastic simulation algorithm in reverse time. For the 50 replicate sets of trajectories generated under Scenario 1, we sampled 10 HIV-1 RNA lineages at times <italic toggle="yes">t</italic> = 3, 6, and 9 post-infection. For trajectories generated under Scenario 2, we sampled 10 HIV-1 RNA lineages at <italic toggle="yes">t</italic> = 11, 13, and 15 post-infection. In both scenarios, we sampled 10 latently infected cells at <italic toggle="yes">t</italic> = 20 post-infection, for a total of 40 sampled lineages per replicate tree. These lineage sampling times defined the initial conditions for the reverse-time simulation of trees. Next, the algorithm samples events from the log generated in the forward-time simulation to build up a tree relating the sampled lineages. The stopping condition of the tree sampling algorithm is that the sampled lineages converge to a single common ancestor, which becomes the root.</p>
      <p>We modified <italic toggle="yes">twt</italic> to output a Newick serialization of this ‘transmission tree’ among cells, labelling tips with sampling times. This tree included internal nodes with only one descendant branch, representing lineage state transitions, or transmissions to/from an unsampled lineage. Internal nodes were labelled with strings encoding the event type, node states (compartments), and unique identifiers for the individual cells involved. These annotations enabled us to ‘colour’ the branches of the tree by lineage state. The true integration dates for sampled latently infected cells were recorded to a separate file. An example of a tree generated by this process is shown in <xref rid="F2" ref-type="fig">Fig. 2</xref>.</p>
      <p>To simulate molecular evolution, we collapsed all branches corresponding to latently infected cells and used the resulting tree as input for INDELible (version 1.03; <xref rid="R13" ref-type="bibr">Fletcher and Yang 2009</xref>). We assigned an HIV-1 <italic toggle="yes">env</italic> sequence at the root (GenBank accession number <ext-link xlink:href="AY772699" ext-link-type="DDBJ/EMBL/GenBank">AY772699</ext-link>). This sequence is one of the HIV-1 subtype C references curated by the Los Alamos National Laboratory HIV Sequence Database (<ext-link xlink:href="http://www.hiv.lanl.gov" ext-link-type="uri">http://www.hiv.lanl.gov</ext-link>). We configured INDELible to use the Tamura–Nei (TrN) model of nucleotide evolution with transition rates <inline-formula id="ILM0040"><tex-math notation="LaTeX" id="ILM0040-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\kappa_1=4$\end{document}</tex-math></inline-formula> and <inline-formula id="ILM0041"><tex-math notation="LaTeX" id="ILM0041-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\kappa_2=8$\end{document}</tex-math></inline-formula> and stationary base frequencies <inline-formula id="ILM0042"><tex-math notation="LaTeX" id="ILM0042-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f_A=0.4$\end{document}</tex-math></inline-formula> and <inline-formula id="ILM0043"><tex-math notation="LaTeX" id="ILM0043-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f_C=f_G=f_T=0.2$\end{document}</tex-math></inline-formula>. In addition, we rescaled the tree such that the expected number of mutations per nucleotide site over its entire length was 1. Finally, we used FastTree (version 2.1.11, compiled for double precision; <xref rid="R25" ref-type="bibr">Price, Dehal and Arkin 2010</xref>) to reconstruct unrooted maximum likelihood trees from these simulated alignments.</p>
    </sec>
    <sec id="s2-s4">
      <label>2.4</label>
      <title>Model validation</title>
      <p>We ran our Bayesian sampling method on each of the 100 simulated trees for <inline-formula id="ILM0044"><tex-math notation="LaTeX" id="ILM0044-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$2\times 10^4$\end{document}</tex-math></inline-formula> steps, discarding a burn-in of 2,000 steps and thinning the remaining chain down to 1,000 steps. We set the lognormal prior distribution on clock rates to <inline-formula id="ILM0045"><tex-math notation="LaTeX" id="ILM0045-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mu=-5$\end{document}</tex-math></inline-formula> and <italic toggle="yes">σ</italic> = 2, and the uniform prior distribution on root dates to a minimum of one simulation time unit before the true origin and a maximum of the first HIV RNA sampling time. In addition, we set the proposal parameters to <inline-formula id="ILM0046"><tex-math notation="LaTeX" id="ILM0046-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\delta_r=0.01$\end{document}</tex-math></inline-formula> for the root location, <italic toggle="yes">σ</italic> = 0.33 for the time of infection, and <inline-formula id="ILM0047"><tex-math notation="LaTeX" id="ILM0047-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\delta_c=0.01$\end{document}</tex-math></inline-formula> for the clock rate. In preliminary runs, we found that these settings were sufficient for replicate chain samples to converge to the same posterior distribution. To sample integration dates for each DNA sequence, we further thinned the chain down to a total of 200 samples from the posterior distribution to reduce auto-correlation.</p>
      <p>To compare our results against conventional RTT regression, we censored the sampling times associated with tips that represented DNA sequences and then rooted the tree using the <italic toggle="yes">rtt</italic> function in the R package <italic toggle="yes">ape</italic> (implementation by R. M. McCloskey; <xref rid="R24" ref-type="bibr">Paradis and Schliep 2019</xref>). We extracted the RTT distances from the resulting tree and fit a simple linear regression of these distances against sampling times. Finally, we used the <italic toggle="yes">inverse.predict</italic> function from R package <italic toggle="yes">chemCal</italic> (<xref rid="R21" ref-type="bibr">Massart et al. 1997</xref>) to extract the predicted integration dates for the 200 samples from the posterior distribution.</p>
      <p>To quantify the discordance between estimated (<inline-formula id="ILM0048"><tex-math notation="LaTeX" id="ILM0048-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{t}$\end{document}</tex-math></inline-formula> ) and actual (<italic toggle="yes">t</italic>) integration dates, we calculated the root mean square error, <inline-formula id="ILM0049"><tex-math notation="LaTeX" id="ILM0049-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathrm{RMSE}=\sqrt{\sum_{i=1}^n (\hat{t}_i - t_i)^2 / n}$\end{document}</tex-math></inline-formula>, where <italic toggle="yes">n</italic> is the number of DNA sequences. We also calculated the mean absolute percentage error, MAPE <inline-formula id="ILM0050"><tex-math notation="LaTeX" id="ILM0050-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$=100\%\times \sum_{i=1}^{n} \left( |\hat{t_i} - t_i| / t_i \right)/n$\end{document}</tex-math></inline-formula>, as an alternative measure of estimation error that is less sensitive to extreme values. We used a paired Wilcoxon rank-sum test to evaluate the significance of differences between the RMSE (or MAPE) values obtained from <italic toggle="yes">bayroot</italic> and conventional RTT.</p>
    </sec>
  </sec>
  <sec id="s3">
    <label>3.</label>
    <title>Results</title>
    <p>To compare conventional RTT regression to our Bayesian approach (<italic toggle="yes">bayroot</italic>), we simulated the proliferation of HIV-1 among active and latent CD4+ T cells with an exact stochastic method. Our simulation workflow yielded a total of 100 trees reconstructed from HIV-1 RNA and integrated proviral DNA sequences. We assumed that HIV-1 RNA was sampled before the start of ART and that HIV-1 proviral DNA was sampled from the latent reservoir post-ART initiation (<xref rid="F2" ref-type="fig">Fig. 2</xref>). Fifty of the trees were simulated such that HIV-1 RNA was sampled at three time points starting at 3 simulation time units post-infection, at intervals of 3 time units (Scenario 1). For the remaining 50 trees, HIV-1 RNA sampling was delayed to 11 time units post-infection and taken at narrower intervals of 2 time units (Scenario 2).</p>
    <p><xref rid="F3" ref-type="fig">Figure 3</xref> compares the estimates of HIV-1 DNA integration dates produced by RTT and <italic toggle="yes">bayroot</italic>. Under Scenario 1, both methods tended to produce similar estimates because the sampling conditions were favourable for fitting the molecular clock (<xref rid="F3" ref-type="fig">Fig. 3A</xref>). The median RMSE was 0.947 for RTT and 0.889 time units for <italic toggle="yes">bayroot</italic>. On a case-by-case basis, <italic toggle="yes">bayroot</italic> produced significantly more accurate estimates than RTT (paired Wilcoxon test, <inline-formula id="ILM0051"><tex-math notation="LaTeX" id="ILM0051-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P=3.55\times 10^{-4}$\end{document}</tex-math></inline-formula>, <xref rid="F3" ref-type="fig">Fig. 3B</xref>). The overall difference between estimates was numerically small. For instance, the median difference in RMSE between RTT and <italic toggle="yes">bayroot</italic> was 0.059 (interquartile range, IQR = <inline-formula id="ILM0052"><tex-math notation="LaTeX" id="ILM0052-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$0.004 - 0.201$\end{document}</tex-math></inline-formula>) time units. In some cases, integration dates were mapped by RTT to the time period after ART initiation, leading to higher RMSE values (<xref rid="F3" ref-type="fig">Fig. 3B</xref>). Since <italic toggle="yes">bayroot</italic> incorporates the prior information that HIV-1 integration should not occur during effective ART, its estimates are constrained to times preceding ART initiation. We found no significant difference between methods (paired Wilcoxon test, <italic toggle="yes">P</italic> = 0.66; <xref rid="sup1" ref-type="supplementary-material">Fig. S1A</xref>) when error was measured by MAPE, which is less influenced by the largest errors than the RMSE. Furthermore, 89.8 per cent of the actual integration dates fell within the 95 per cent credible intervals generated by <italic toggle="yes">bayroot</italic>.</p>
    <fig position="float" id="F3" fig-type="figure">
      <label>Figure 3.</label>
      <caption>
        <p>Comparison of results from <italic toggle="yes">bayroot</italic> and conventional RTT regression. (A) A scatterplot of RTT distance (divergence) against sampling times post-infection, for a representative example generated under Scenario 1. A solid line represents the RTT regression fitted to the RNA sequence data (open circles), which we expect to intercept the horizontal axis at <italic toggle="yes">t</italic> = 0. A vertical dashed line marks the start of ART. Red points represent estimates of integration dates from the RTT model for DNA sequences sampled at time <italic toggle="yes">t</italic> = 20, as indicated by horizontal red, thin lines. Blue points and thick line segments represent the median and 95 per cent credible interval for integration date estimates from <italic toggle="yes">bayroot</italic>. Cross marks indicate the actual integration dates. (B) A slopegraph comparing the RMSE of integration date estimates from RTT and <italic toggle="yes">bayroot</italic> for all 50 simulations generated under Scenario 1. Line segments are coloured red if the RMSE for a given simulation was greater for <italic toggle="yes">bayroot</italic>, and blue otherwise. (C) and (D) A scatterplot and slopegraph for simulations generated under Scenario 2. Slopegraphs were generated using R package <italic toggle="yes">ggfree</italic> (<ext-link xlink:href="https://github.com/ArtPoon/ggfree" ext-link-type="uri">https://github.com/ArtPoon/ggfree</ext-link>).</p>
      </caption>
      <graphic xlink:href="veac120f3" position="float"/>
    </fig>
    <p>For Scenario 2, both methods became less accurate with median RMSEs of 2.79 and 2.10 time units for RTT and <italic toggle="yes">bayroot</italic>, respectively (<xref rid="F3" ref-type="fig">Fig. 3D</xref>). Because the sampling times of the RNA sequences used to calibrate the molecular clock were closer together and more distant from the actual time of infection in this scenario (<xref rid="F3" ref-type="fig">Fig. 3C</xref>), we are less certain about all three parameters of the regression, i.e., the location of the root in the tree, the time associated with the root (<italic toggle="yes">x</italic>-intercept), and the clock rate (slope). Under these conditions, <italic toggle="yes">bayroot</italic> benefits from having prior information about the time of infection. For our simulations where <italic toggle="yes">t</italic> = 0 is the actual time, we constrained the time of infection variable to the interval from −1 to 3 simulation time units. (In practice, one could use a uniform prior bounded by the last seronegative and first seropositive dates for that individual.) In other words, prior information about the time of infection ‘anchors’ the RTT regression when there are insufficient data to accurately estimate the <italic toggle="yes">x</italic>-intercept (<xref rid="F3" ref-type="fig">Fig. 3C</xref>). As a result, <italic toggle="yes">bayroot</italic> was significantly more accurate than RTT under this second scenario (paired Wilcoxon test, <inline-formula id="ILM0053"><tex-math notation="LaTeX" id="ILM0053-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P=3.82\times 10^{-7}$\end{document}</tex-math></inline-formula>, <xref rid="F3" ref-type="fig">Fig. 3D</xref>). The median difference in RMSE between RTT and <italic toggle="yes">bayroot</italic> was 0.405 (IQR <inline-formula id="ILM0054"><tex-math notation="LaTeX" id="ILM0054-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$0.190-0.807$\end{document}</tex-math></inline-formula>) time units—about seven times greater than scenario 1. In addition, this difference between methods remained significant when error was measured as MAPE (paired Wilcoxon test, <inline-formula id="ILM0055"><tex-math notation="LaTeX" id="ILM0055-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$3.4\times 10^{-7}$\end{document}</tex-math></inline-formula>; <xref rid="sup1" ref-type="supplementary-material">Fig. S1B</xref>). Decomposition of the mean squared error into bias and variance components indicated that the difference in RMSE was driven more by a reduction in bias in either scenario (<xref rid="sup1" ref-type="supplementary-material">Fig. S2</xref>). Finally, 89.4 per cent of actual integration dates fell within the 95 per cent credible intervals from <italic toggle="yes">bayroot</italic>. There was no significant association in this outcome between scenarios (Fisher’s exact test, odds ratio = 0.5, <italic toggle="yes">P</italic> = 0.34).</p>
    <p>Running a chain sample for <inline-formula id="ILM0056"><tex-math notation="LaTeX" id="ILM0056-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$2\times 10^4$\end{document}</tex-math></inline-formula> steps in <italic toggle="yes">bayroot</italic> required a median of 47.3 (IQR <inline-formula id="ILM0057"><tex-math notation="LaTeX" id="ILM0057-Latex">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$45.0-48.8$\end{document}</tex-math></inline-formula>) seconds in R version 4.2.0 for Linux on a single core of an AMD Ryzen ThreadRipper 1950X processor. If the user is not processing a large number of samples, as we have done here for replicate simulations, we suggest running chain samples for at least 10<sup>6</sup> steps with a thinning interval of 500 steps.</p>
  </sec>
  <sec id="s4">
    <label>4.</label>
    <title>Discussion</title>
    <p>The reconstruction of HIV-1 integration dates is a challenging problem. Cells carrying replication-competent provirus in the latent reservoir comprise a small fraction of resting CD4+ T cells (approximately 0.01–10 per million cells; <xref rid="R26" ref-type="bibr">Prodger et al. 2020</xref>; <xref rid="R7" ref-type="bibr">Crooks et al. 2015</xref>). Sequences of plasma HIV-1 RNA or integrated DNA often cover only a portion of the virus genome (<xref rid="R20" ref-type="bibr">Laskey et al. 2016</xref>), making it difficult to resolve their evolutionary relationships. In addition, the development of phylogenetic and statistical methods for analysing these sequence data (<xref rid="R12" ref-type="bibr">Ferreira et al. 2021</xref>) has lagged behind ongoing improvements in molecular techniques (<xref rid="R6" ref-type="bibr">Cho et al. 2022</xref>; <xref rid="R31" ref-type="bibr">Sun et al. 2022</xref>). Here we have described a Bayesian extension of a widely used regression method for estimating HIV-1 integration dates from sequence variation in the latent reservoir (<xref rid="R17" ref-type="bibr">Jones et al. 2018</xref>; <xref rid="R3" ref-type="bibr">Brodin et al. 2016</xref>; <xref rid="R5" ref-type="bibr">Brooks et al. 2020</xref>). Our method provides a means of incorporating additional data about the infection—e.g., the estimated date of infection, time of ART initiation, and previous measures of the rate of HIV-1 evolution within hosts—as prior information. Furthermore, adopting a Bayesian approach enables us to quantify our uncertainty about parameter estimates by sampling from the posterior distribution. We expect this will be important for studies where there is limited access to longitudinal plasma samples for retrospective sequencing, for instance.</p>
    <p>Of course, our method also retains some significant limitations of conventional approaches to RTT regression. First, we are assuming that the unrooted tree relating HIV-1 RNA and DNA sequences is known without error. It is possible to relax this assumption by adopting a hierarchical approach and replicating our regression analysis on a posterior sample of unrooted trees that may be generated by a Bayesian phylogenetic program such as MrBayes (<xref rid="R28" ref-type="bibr">Ronquist and Huelsenbeck 2003</xref>) or BEAST (<xref rid="R10" ref-type="bibr">Drummond and Rambaut 2007</xref>). This is less efficient than sampling from the joint posterior distribution of unrooted trees, mutation model, and the RTT regression parameters. Additionally, we are assuming that the divergence of each sequence is an independent outcome. This convenient approximation is clearly untrue because of identity by descent: sequences that share a more recent common ancestor will have a similar RTT distance because they have inherited the same set of mutations. It is possible to overcome this limitation by adapting the covariance matrix of the regression model to the phylogenetic structure of the data (<xref rid="R22" ref-type="bibr">Neher 2018</xref>).</p>
    <p>Not all studies use RTT regression to estimate HIV-1 integration dates. For example, one of the methods described by <xref rid="R1" ref-type="bibr">Abrahams et al. (2019)</xref> uses approximate maximum likelihood to reconstruct a host-specific tree relating HIV-1 RNA and DNA sequences and then locates the closest tip representing an RNA sequence for every tip representing a DNA sequence, which is assigned the sampling time of the RNA tip. Hence, the DNA sequences can only be associated with a finite number of integration dates. This approach benefits from extensive sampling of HIV-1 plasma RNA over the time period spanning the start of infection to ART initiation. If the ancestral HIV-1 RNA sequence most closely related to an HIV-1 provirus is not represented in the tree, then the latter would be mapped to another branch that may be associated with a sampling time that does not accurately estimate the integration date. In contrast, RTT methods directly use the number of mutations carried by an individual DNA sequence to estimate its integration date. The other sequences are used to calibrate the linear model mapping this divergence to the timeline.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>veac120_Supp</label>
      <media xlink:href="veac120_supp.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Dr Jessica Prodger, with whom our discussion about the use of RTT regression to estimate the integration dates of HIV provirus from the latent reservoir motivated the development of this Bayesian method. This work was presented at the 29th International Dynamics and Evolution of Human Viruses meeting in La Jolla, California, USA.</p>
  </ack>
  <sec sec-type="data-availability" id="s5">
    <title>Data availability</title>
    <p>The R package <italic toggle="yes">bayroot</italic> is publicly available under the MIT license at <ext-link xlink:href="https://github.com/PoonLab/bayroot" ext-link-type="uri">https://github.com/PoonLab/bayroot</ext-link>. We have also provided the simulated data and R scripts used to perform the method validation and generate figures in this repository. The R package <italic toggle="yes">twt</italic> is publicly available under the GNU Affero General Public License v3.0 (AGPL-3.0) at <ext-link xlink:href="https://github.com/PoonLab/twt" ext-link-type="uri">https://github.com/PoonLab/twt</ext-link>.</p>
  </sec>
  <sec id="s6">
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Virus Evolution</italic> online.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="R1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abrahams</surname><given-names>M. -R.</given-names></string-name></person-group><etal>et al.</etal> (<year>2019</year>) ‘<article-title>The Replication-Competent HIV-1 Latent Reservoir is Primarily Established near the Time of Therapy Initiation</article-title>’, <source><italic toggle="yes">Science Translational Medicine</italic></source>, <volume>11</volume>: <page-range>eaaw5589</page-range>. doi: <pub-id pub-id-type="doi">10.1126/scitranslmed.aaw5589</pub-id></mixed-citation>
    </ref>
    <ref id="R2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alizon</surname><given-names>S.</given-names></string-name> and <string-name><given-names>C.</given-names><surname>Fraser</surname></string-name></person-group> (<year>2013</year>) ‘<article-title>Within-Host and Between-Host Evolutionary Rates Across the HIV-1 Genome</article-title>’, <source><italic toggle="yes">Retrovirology</italic></source>, <volume>10</volume>: <fpage>1</fpage>–<lpage>10</lpage>. doi: <pub-id pub-id-type="doi">10.1186/1742-4690-10-49</pub-id><pub-id pub-id-type="pmid">23289738</pub-id></mixed-citation>
    </ref>
    <ref id="R3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brodin</surname><given-names>J.</given-names></string-name></person-group><etal>et al.</etal> (<year>2016</year>) ‘<article-title>Establishment and Stability of the Latent HIV-1 DNA Reservoir</article-title>’, <source><italic toggle="yes">eLife</italic></source>, <volume>5</volume>: <page-range>e18889</page-range>. doi: <pub-id pub-id-type="doi">10.7554/eLife.18889</pub-id></mixed-citation>
    </ref>
    <ref id="R4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bromham</surname><given-names>L.</given-names></string-name> and <string-name><given-names>D.</given-names><surname>Penny</surname></string-name></person-group> (<year>2003</year>) ‘<article-title>The Modern Molecular Clock</article-title>’, <source><italic toggle="yes">Nature Reviews Genetics</italic></source>, <volume>4</volume>: <fpage>216</fpage>–<lpage>224</lpage>. doi: <pub-id pub-id-type="doi">10.1038/nrg1020</pub-id></mixed-citation>
    </ref>
    <ref id="R5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brooks</surname><given-names>K.</given-names></string-name></person-group><etal>et al.</etal> (<year>2020</year>) ‘<article-title>HIV-1 Variants are Archived Throughout Infection and Persist in the Reservoir</article-title>’, <source><italic toggle="yes">PLoS Pathogens</italic></source>, <volume>16</volume>: <page-range>e1008378</page-range>. doi: <pub-id pub-id-type="doi">10.1371/journal.ppat.1008378</pub-id></mixed-citation>
    </ref>
    <ref id="R6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cho</surname><given-names>A.</given-names></string-name></person-group><etal>et al.</etal> (<year>2022</year>) ‘<article-title>Longitudinal Clonal Dynamics of HIV-1 Latent Reservoirs Measured by Combination Quadruplex Polymerase Chain Reaction and Sequencing</article-title>’, <source><italic toggle="yes">Proceedings of the National Academy of Sciences</italic></source>, <volume>119</volume>: <page-range>e2117630119</page-range>. doi: <pub-id pub-id-type="doi">10.1073/pnas.2117630119</pub-id></mixed-citation>
    </ref>
    <ref id="R7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Crooks</surname><given-names>A. M.</given-names></string-name></person-group><etal>et al.</etal> (<year>2015</year>) ‘<article-title>Precise Quantitation of the Latent HIV-1 Reservoir: Implications for Eradication Strategies</article-title>’, <source><italic toggle="yes">Journal of Infectious Diseases</italic></source>, <volume>212</volume>: <fpage>1361</fpage>–<lpage>1365</lpage>. doi: <pub-id pub-id-type="doi">10.1093/infdis/jiv218</pub-id><pub-id pub-id-type="pmid">25877550</pub-id></mixed-citation>
    </ref>
    <ref id="R8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Didelot</surname><given-names>X.</given-names></string-name></person-group><etal>et al.</etal> (<year>2018</year>) ‘<article-title>Bayesian Inference of Ancestral dates on Bacterial Phylogenetic Trees</article-title>’, <source><italic toggle="yes">Nucleic Acids Research</italic></source>, <volume>46</volume>: <fpage>e134</fpage>–<lpage>e134</lpage>. doi: <pub-id pub-id-type="doi">10.1093/nar/gky783</pub-id><pub-id pub-id-type="pmid">30184106</pub-id></mixed-citation>
    </ref>
    <ref id="R9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Drummond</surname><given-names>A.</given-names></string-name>, <string-name><given-names>O. G.</given-names><surname>Pybus</surname></string-name> and <string-name><given-names>A.</given-names><surname>Rambaut</surname></string-name></person-group> (<year>2003</year>) ‘<article-title>Inference of viral Evolutionary Rates from Molecular Sequences</article-title>’, <source><italic toggle="yes">Adv Parasitol</italic></source>, <volume>54</volume>: <fpage>331</fpage>–<lpage>358</lpage>. doi: <pub-id pub-id-type="doi">10.1016/S0065-308X(03)54008-8</pub-id><pub-id pub-id-type="pmid">14711090</pub-id></mixed-citation>
    </ref>
    <ref id="R10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Drummond</surname><given-names>A. J.</given-names></string-name> and <string-name><given-names>A.</given-names><surname>Rambaut</surname></string-name></person-group> (<year>2007</year>) ‘<article-title>BEAST: Bayesian Evolutionary Analysis by Sampling Trees</article-title>’, <source><italic toggle="yes">BMC Evolutionary Biology</italic></source>, <volume>7</volume>: <fpage>1</fpage>–<lpage>8</lpage>. doi: <pub-id pub-id-type="doi">10.1186/1471-2148-7-214</pub-id><pub-id pub-id-type="pmid">17214884</pub-id></mixed-citation>
    </ref>
    <ref id="R11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duchene</surname><given-names>S.</given-names></string-name></person-group><etal>et al.</etal> (<year>2020</year>) ‘<article-title>Temporal Signal and the Phylodynamic Threshold of SARS-CoV-2</article-title>’, <source><italic toggle="yes">Virus Evolution</italic></source>, <volume>6</volume>: <page-range>veaa061</page-range>. doi: <pub-id pub-id-type="doi">10.1093/ve/veaa061</pub-id></mixed-citation>
    </ref>
    <ref id="R12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ferreira</surname><given-names>R. -C.</given-names></string-name></person-group><etal>et al.</etal> (<year>2021</year>) ‘<article-title>Quantifying the Clonality and Dynamics of the Within-Host HIV-1 Latent Reservoir</article-title>’, <source><italic toggle="yes">Virus Evolution</italic></source>, <volume>7</volume>: <page-range>veaa104</page-range>. doi: <pub-id pub-id-type="doi">10.1093/ve/veaa104</pub-id></mixed-citation>
    </ref>
    <ref id="R13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fletcher</surname><given-names>W.</given-names></string-name> and <string-name><given-names>Z.</given-names><surname>Yang</surname></string-name></person-group> (<year>2009</year>) ‘<article-title>INDELible: a Flexible Simulator of Biological Sequence Evolution</article-title>’, <source><italic toggle="yes">Molecular Biology and Evolution</italic></source>, <volume>26</volume>: <fpage>1879</fpage>–<lpage>1888</lpage>. doi: <pub-id pub-id-type="doi">10.1093/molbev/msp098</pub-id><pub-id pub-id-type="pmid">19423664</pub-id></mixed-citation>
    </ref>
    <ref id="R14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gillespie</surname><given-names>D. T.</given-names></string-name></person-group> (<year>1977</year>) ‘<article-title>Exact Stochastic Simulation of Coupled Chemical Reactions</article-title>’, <source><italic toggle="yes">Journal of Physical Chemistry</italic></source>, <volume>81</volume>: <fpage>2340</fpage>–<lpage>2361</lpage>. doi: <pub-id pub-id-type="doi">10.1021/j100540a008</pub-id></mixed-citation>
    </ref>
    <ref id="R15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gondim</surname><given-names>M. V. P.</given-names></string-name></person-group><etal>et al.</etal> (<year>2021</year>) ‘<article-title>Heightened Resistance to Host Type 1 Interferons Characterizes HIV-1 at Transmission and after Antiretroviral Therapy Interruption</article-title>’, <source><italic toggle="yes">Science Translational Medicine</italic></source>, <volume>13</volume>: <page-range>eabd8179</page-range>. doi: <pub-id pub-id-type="doi">10.1126/scitranslmed.abd8179</pub-id></mixed-citation>
    </ref>
    <ref id="R16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huelsenbeck</surname><given-names>J. P.</given-names></string-name>, <string-name><given-names>J. P.</given-names><surname>Bollback</surname></string-name> and <string-name><given-names>A. M.</given-names><surname>Levine</surname></string-name></person-group> (<year>2002</year>) ‘<article-title>Inferring the Root of a Phylogenetic Tree</article-title>’, <source><italic toggle="yes">Systematic Biology</italic></source>, <volume>51</volume>: <fpage>32</fpage>–<lpage>43</lpage>. doi: <pub-id pub-id-type="doi">10.1080/106351502753475862</pub-id><pub-id pub-id-type="pmid">11943091</pub-id></mixed-citation>
    </ref>
    <ref id="R17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jones</surname><given-names>B. R.</given-names></string-name></person-group><etal>et al.</etal> (<year>2018</year>) ‘<article-title>Phylogenetic Approach to Recover Integration Dates of Latent HIV Sequences Within-Host</article-title>’, <source><italic toggle="yes">Proceedings of the National Academy of Sciences</italic></source>, <volume>115</volume>: <fpage>E8958</fpage>–<lpage>E8967</lpage>. doi: <pub-id pub-id-type="doi">10.1073/pnas.1802028115</pub-id></mixed-citation>
    </ref>
    <ref id="R18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kearney</surname><given-names>M. F.</given-names></string-name></person-group><etal>et al.</etal> (<year>2014</year>) ‘<article-title>Lack of Detectable HIV-1 Molecular Evolution During Suppressive Antiretroviral Therapy</article-title>’, <source><italic toggle="yes">PLoS pathogens</italic></source>, <volume>10</volume>: <page-range>e1004010</page-range>. doi: <pub-id pub-id-type="doi">10.1371/journal.ppat.1004010</pub-id></mixed-citation>
    </ref>
    <ref id="R19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Langley</surname><given-names>C. H.</given-names></string-name> and <string-name><given-names>W. M.</given-names><surname>Fitch</surname></string-name></person-group> (<year>1974</year>) ‘<article-title>An Examination of the Constancy of the Rate of Molecular Evolution</article-title>’, <source><italic toggle="yes">Journal of Molecular Evolution</italic></source>, <volume>3</volume>: <fpage>161</fpage>–<lpage>177</lpage>. doi: <pub-id pub-id-type="doi">10.1007/BF01797451</pub-id><pub-id pub-id-type="pmid">4368400</pub-id></mixed-citation>
    </ref>
    <ref id="R20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Laskey</surname><given-names>S. B.</given-names></string-name></person-group><etal>et al.</etal> (<year>2016</year>) ‘<article-title>Evaluating Clonal Expansion of HIV-Infected Cells: Optimization of PCR Strategies to Predict Clonality</article-title>’, <source><italic toggle="yes">PLoS Pathogens</italic></source>, <volume>12</volume>: <page-range>e1005689</page-range>. doi: <pub-id pub-id-type="doi">10.1371/journal.ppat.1005689</pub-id></mixed-citation>
    </ref>
    <ref id="R21">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>Desiré</given-names><surname>Luc Massart</surname></string-name>, <string-name><surname>Bernard</surname><given-names>G M Vandeginste</given-names></string-name>, <string-name><surname>Lutgarde</surname><given-names>M C Buydens</given-names></string-name>, <string-name><given-names>Sijbrand</given-names><surname>de Jong</surname></string-name>, <string-name><given-names>Paul J</given-names><surname>Lewi</surname></string-name>, and <string-name><given-names>Johanna</given-names><surname>Smeyers-Verbeke</surname></string-name></person-group>. <part-title><italic toggle="yes">Handbook of Chemometrics and Qualimetrics: Part A</italic></part-title>. <source>Data Handling in Science and Technology: 20A.</source><publisher-name>Elsevier Science</publisher-name>, <year>1997</year>.</mixed-citation>
    </ref>
    <ref id="R22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Neher</surname><given-names>R. A.</given-names></string-name></person-group> (<year>2018</year>) ‘<article-title>Efficient Estimation of Evolutionary Rates by Covariance Aware Regression</article-title>’, <source><italic toggle="yes">bioRxiv</italic></source>, <page-range>408005</page-range>. doi: <pub-id pub-id-type="doi">10.1101/408005</pub-id></mixed-citation>
    </ref>
    <ref id="R23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pantazis</surname><given-names>N.</given-names></string-name></person-group><etal>et al.</etal> (<year>2019</year>) ‘<article-title>Determining the Likely Place of HIV Acquisition for Migrants in Europe Combining Subject-Specific Information and Biomarkers Data</article-title>’, <source><italic toggle="yes">Statistical Methods in Medical Research</italic></source>, <volume>28</volume>: <fpage>1979</fpage>–<lpage>1997</lpage>. doi: <pub-id pub-id-type="doi">10.1177/0962280217746437</pub-id><pub-id pub-id-type="pmid">29233073</pub-id></mixed-citation>
    </ref>
    <ref id="R24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paradis</surname><given-names>E.</given-names></string-name> and <string-name><given-names>K.</given-names><surname>Schliep</surname></string-name></person-group> (<year>2019</year>) ‘<article-title>ape 5.0: An Environment for Modern Phylogenetics and Evolutionary Analyses in R</article-title>’, <source><italic toggle="yes">Bioinformatics</italic></source>, <volume>35</volume>: <fpage>526</fpage>–<lpage>528</lpage>. doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/bty633</pub-id><pub-id pub-id-type="pmid">30016406</pub-id></mixed-citation>
    </ref>
    <ref id="R25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Price</surname><given-names>M. N.</given-names></string-name>, <string-name><given-names>P. S.</given-names><surname>Dehal</surname></string-name> and <string-name><given-names>A. P.</given-names><surname>Arkin</surname></string-name></person-group> (<year>2010</year>) ‘<article-title>FastTree 2–Approximately Maximum-Likelihood Trees for Large Alignments</article-title>’, <source><italic toggle="yes">PLoS One</italic></source>, <volume>5</volume>: <page-range>e9490</page-range>. doi: <pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id></mixed-citation>
    </ref>
    <ref id="R26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Prodger</surname><given-names>J. L.</given-names></string-name></person-group><etal>et al.</etal><article-title>Reduced HIV-1 Latent Reservoir Outgrowth and Distinct Immune Correlates Among Women in Rakai, Uganda</article-title>’, <source><italic toggle="yes">JCI Insight</italic></source>, <volume>5</volume>: <page-range>2020</page-range>.</mixed-citation>
    </ref>
    <ref id="R27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rong</surname><given-names>L.</given-names></string-name> and <string-name><given-names>A. S.</given-names><surname>Perelson</surname></string-name></person-group> (<year>2009</year>) ‘<article-title>Modeling Latently Infected Cell Activation: Viral and Latent Reservoir Persistence, and Viral Blips in HIV-Infected Patients on Potent Therapy</article-title>’, <source><italic toggle="yes">PLoS Computational Biology</italic></source>, <volume>5</volume>: <page-range>e1000533</page-range>. doi: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000533</pub-id></mixed-citation>
    </ref>
    <ref id="R28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ronquist</surname><given-names>F.</given-names></string-name> and <string-name><given-names>J. P.</given-names><surname>Huelsenbeck</surname></string-name></person-group> (<year>2003</year>) ‘<article-title>MrBayes 3: Bayesian Phylogenetic Inference under Mixed Models</article-title>’, <source><italic toggle="yes">Bioinformatics</italic></source>, <volume>19</volume>: <fpage>1572</fpage>–<lpage>1574</lpage>. doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btg180</pub-id><pub-id pub-id-type="pmid">12912839</pub-id></mixed-citation>
    </ref>
    <ref id="R29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Siliciano</surname><given-names>J. D.</given-names></string-name> and <string-name><given-names>R. F.</given-names><surname>Siliciano</surname></string-name></person-group> (<year>2004</year>) ‘<article-title>A Long-Term Latent Reservoir for HIV-1: Discovery and Clinical Implications</article-title>’, <source><italic toggle="yes">Journal of Antimicrobial Chemotherapy</italic></source>, <volume>54</volume>: <fpage>6</fpage>–<lpage>9</lpage>. doi: <pub-id pub-id-type="doi">10.1093/jac/dkh292</pub-id><pub-id pub-id-type="pmid">15163657</pub-id></mixed-citation>
    </ref>
    <ref id="R30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stirrup</surname><given-names>O. T.</given-names></string-name> and <string-name><given-names>D. T.</given-names><surname>Dunn</surname></string-name></person-group> (<year>2018</year>) ‘<article-title>Estimation of Delay to Diagnosis and Incidence in HIV using Indirect Evidence of Infection Dates</article-title>’, <source><italic toggle="yes">BMC Medical Research methodology</italic></source>, <volume>18</volume>: <fpage>1</fpage>–<lpage>14</lpage>. doi: <pub-id pub-id-type="doi">10.1186/s12874-018-0522-x</pub-id><pub-id pub-id-type="pmid">29301497</pub-id></mixed-citation>
    </ref>
    <ref id="R31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>C.</given-names></string-name></person-group><etal>et al.</etal> (<year>2022</year>) ‘<article-title>Droplet-Microfluidics-Assisted Sequencing of HIV Proviruses and Their Integration Sites in Cells from People on Antiretroviral Therapy</article-title>’, <source><italic toggle="yes">Nature Biomedical Engineering</italic></source><volume>6</volume>, <fpage>1004</fpage>–<lpage>1012</lpage>. doi: <pub-id pub-id-type="doi">10.1038/s41551-022-00864-8</pub-id></mixed-citation>
    </ref>
    <ref id="R32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sweeting</surname><given-names>M. J.</given-names></string-name></person-group><etal>et al.</etal> (<year>2010</year>) ‘<article-title>Estimating the Distribution of the Window Period for Recent HIV Infections: a Comparison of Statistical Methods</article-title>’, <source><italic toggle="yes">Statistics in Medicine</italic></source>, <volume>29</volume>: <fpage>3194</fpage>–<lpage>3202</lpage>. doi: <pub-id pub-id-type="doi">10.1002/sim.3941</pub-id><pub-id pub-id-type="pmid">21170913</pub-id></mixed-citation>
    </ref>
    <ref id="R33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tajima</surname><given-names>F.</given-names></string-name> and <string-name><given-names>M.</given-names><surname>Nei</surname></string-name></person-group> (<year>1984</year>) ‘<article-title>Estimation of Evolutionary Distance between Nucleotide Sequences</article-title>’, <source><italic toggle="yes">Molecular Biology and Evolution</italic></source>, <volume>1</volume>: <fpage>269</fpage>–<lpage>285</lpage>. doi: <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a040317</pub-id><pub-id pub-id-type="pmid">6599968</pub-id></mixed-citation>
    </ref>
    <ref id="R34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Sighem</surname><given-names>A.</given-names></string-name></person-group><etal>et al.</etal> (<year>2015</year>) ‘<article-title>Estimating HIV Incidence, Time to Diagnosis, and the Undiagnosed HIV Epidemic using Routine Surveillance Data</article-title>’, <source><italic toggle="yes">Epidemiology (Cambridge, Mass.)</italic></source>, <volume>26</volume>: <page-range>653</page-range>. doi: <pub-id pub-id-type="doi">10.1097/EDE.0000000000000324</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
