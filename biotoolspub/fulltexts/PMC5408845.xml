<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5408845</article-id>
    <article-id pub-id-type="pmid">28088763</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btw777</article-id>
    <article-id pub-id-type="publisher-id">btw777</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Scater: pre-processing, quality control, normalization and visualization of single-cell RNA-seq data in R</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>McCarthy</surname>
          <given-names>Davis J</given-names>
        </name>
        <xref ref-type="aff" rid="btw777-aff1">1</xref>
        <xref ref-type="aff" rid="btw777-aff2">2</xref>
        <xref ref-type="aff" rid="btw777-aff3">3</xref>
        <xref ref-type="corresp" rid="btw777-cor1"/>
        <!--<email>davis@ebi.ac.uk</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Campbell</surname>
          <given-names>Kieran R</given-names>
        </name>
        <xref ref-type="aff" rid="btw777-aff2">2</xref>
        <xref ref-type="aff" rid="btw777-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lun</surname>
          <given-names>Aaron T L</given-names>
        </name>
        <xref ref-type="aff" rid="btw777-aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wills</surname>
          <given-names>Quin F</given-names>
        </name>
        <xref ref-type="aff" rid="btw777-aff2">2</xref>
        <xref ref-type="aff" rid="btw777-aff6">6</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Hofacker</surname>
          <given-names>Ivo</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btw777-aff1"><label>1</label>European Molecular Biology Laboratory, European Bioinformatics Institute, Wellcome Genome Campus, Hinxton, Cambridge, UK</aff>
    <aff id="btw777-aff2"><label>2</label>Wellcome Trust Centre for Human Genetics, University of Oxford, Oxford, UK</aff>
    <aff id="btw777-aff3"><label>3</label>St Vincent’s Institute of Medical Research, Fitzroy, Victoria, Australia</aff>
    <aff id="btw777-aff4"><label>4</label>Department of Physiology, Anatomy and Genetics, University of Oxford, Oxford, UK</aff>
    <aff id="btw777-aff5"><label>5</label>CRUK Cambridge Institute, University of Cambridge, Cambridge, UK</aff>
    <aff id="btw777-aff6"><label>6</label>Weatherall Institute for Molecular Medicine, University of Oxford, John Radcliffe Hospital, Oxford, UK</aff>
    <author-notes>
      <corresp id="btw777-cor1">To whom correspondence should be addressed. Email: <email>davis@ebi.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>4</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-01-14">
      <day>14</day>
      <month>1</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>1</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>8</issue>
    <fpage>1179</fpage>
    <lpage>1186</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>8</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>7</day>
        <month>11</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>12</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btw777.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Motivation</title>
        <p>Single-cell RNA sequencing (scRNA-seq) is increasingly used to study gene expression at the level of individual cells. However, preparing raw sequence data for further analysis is not a straightforward process. Biases, artifacts and other sources of unwanted variation are present in the data, requiring substantial time and effort to be spent on pre-processing, quality control (QC) and normalization.</p>
      </sec>
      <sec id="SA2">
        <title>Results</title>
        <p>We have developed the R/Bioconductor package <italic>scater</italic> to facilitate rigorous pre-processing, quality control, normalization and visualization of scRNA-seq data. The package provides a convenient, flexible workflow to process raw sequencing reads into a high-quality expression dataset ready for downstream analysis. <italic>scater</italic> provides a rich suite of plotting tools for single-cell data and a flexible data structure that is compatible with existing tools and can be used as infrastructure for future software development.</p>
      </sec>
      <sec id="SA3">
        <title>Availability and Implementation</title>
        <p>The open-source code, along with installation instructions, vignettes and case studies, is available through Bioconductor at <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/scater">http://bioconductor.org/packages/scater</ext-link>.</p>
      </sec>
      <sec id="SA4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Health and Medical Research Council</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000925</named-content>
        </funding-source>
        <award-id>APP1112</award-id>
        <award-id>681 to D.J.M.</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">European Molecular Biology Laboratory</named-content>
        </funding-source>
        <award-id>D.J.M.</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Cancer Research UK</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000289</named-content>
        </funding-source>
        <award-id>A1719</award-id>
        <award-id>7 to A.T.L.L.</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">United Kingdom Medical Research Council</named-content>
          <named-content content-type="funder-identifier">10.13039/501100007155</named-content>
        </funding-source>
        <award-id>K.R.C.</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Oxford Single Cell Biology Consortium</named-content>
        </funding-source>
        <award-id>Q.F.W.</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 Introduction</title>
    <p>Single-cell RNA sequencing (scRNA-seq) describes a broad class of techniques which profile the transcriptomes of individual cells. This provides insights into cellular processes at a resolution that cannot be matched by bulk RNA-seq experiments (<xref rid="btw777-B22" ref-type="bibr">Hebenstreit and Teichmann, 2011</xref>; <xref rid="btw777-B48" ref-type="bibr">Shalek <italic>et al.</italic>, 2013</xref>). With scRNA-seq data, the contributions of different cell types to the expression profile of a heterogeneous population can be explicitly determined. Rare cell types can be interrogated and new cell subpopulations can be discovered. Graduated processes such as development and differentiation can also be studied in greater detail. However, this improvement in resolution comes at the cost of increased technical noise and biases. This means that pre-processing, quality control and normalization are critical to a rigorous analysis of scRNA-seq data. The increased complexity of the data across hundreds or thousands of cells also requires sophisticated visualization tools to assist interpretation of the results.</p>
    <p>Numerous statistical methods and software tools have been published for scRNA-seq data (<xref rid="btw777-B5" ref-type="bibr">Angerer <italic>et al.</italic>, 2015</xref>; <xref rid="btw777-B16" ref-type="bibr">Finak <italic>et al.</italic>, 2015</xref>; <xref rid="btw777-B19" ref-type="bibr">Guo <italic>et al.</italic>, 2015</xref>; <xref rid="btw777-B26" ref-type="bibr">Juliá <italic>et al.</italic>, 2015</xref>; <xref rid="btw777-B28" ref-type="bibr">Kharchenko <italic>et al.</italic>, 2014</xref>; <xref rid="btw777-B52" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>). However, all of these assume that quality control and normalization have already been applied. Fewer methods are available in the literature to perform these basic steps in scRNA-seq data processing (<xref rid="btw777-B25" ref-type="bibr">Ilicic <italic>et al.</italic>, 2016</xref>). This issue is exacerbated by the diversity of scRNA-seq datasets with respect to the experimental protocol and the biological context of the study, meaning that a single processing pipeline with fixed parameters is unlikely to be universally applicable. Rather, software tools are required that support an interactive approach to analysis. This allows parameters to be fine-tuned for the study at hand in response to any issues diagnosed during data exploration. The provided functionality should also process the data in a statistically rigorous manner and encourage reproducible bioinformatics analyses.</p>
    <p>One of the most widely used frameworks for interactive analysis is the R programming language, extended for biological data analysis through the Bioconductor project (<xref rid="btw777-B24" ref-type="bibr">Huber <italic>et al.</italic>, 2015</xref>). While Bioconductor packages have been widely used for bulk RNA-seq data, the existing data structures (like the ExpressionSet class) are not sufficient for scRNA-seq data. This is because they do not support data types that are specific to single-cell studies, e.g. cell–cell distance matrices for clustering. For larger studies, this also includes data beyond expression profiles such as intensity values from fluorescence-activated cell sorting, cell imaging data and information from epigenetic and targeted genotyping assays. Existing methods for processing and applying quality control to scRNA-seq data are similarly inadequate. In particular, current visualization methods designed for exploratory data analysis of bulk transcriptomic experiments are unsuited to datasets containing hundreds or thousands of cells. The large size of each dataset also favours methods such as <italic>kallisto</italic> (<xref rid="btw777-B7" ref-type="bibr">Bray <italic>et al.</italic>, 2016</xref>) and <italic>Salmon</italic> (<xref rid="btw777-B41" ref-type="bibr">Patro <italic>et al.</italic>, 2016</xref>) for rapidly quantifying gene expression, but support for the output of these methods is currently limited. Extensions to the current computational infrastructure are required to provide appropriate data structures and methods that can accommodate these rich scRNA-seq datasets for integrative analyses of expression and other assay data along with the accompanying metadata.</p>
    <p>Here we present <italic>scater</italic>, an open-source R/Bioconductor software package that implements a convenient data structure for representing scRNA-seq data and contains functions for pre-processing, quality control, normalization and visualization. The package provides wrapper functions for running <italic>kallisto</italic> and <italic>Salmon</italic> on raw read data and converting their output into gene-level expression values, methods for computing and visualizing quality-control metrics for cells and genes, and methods for normalization and correction of uninteresting covariates. This is done in a single software environment which enables seamless integration with a large number of existing tools for scRNA-seq data analysis in R. The <italic>scater</italic> package provides basic infrastructure upon which customized scRNA-seq analyses can be constructed, and we anticipate the package to be useful across the whole spectrum of users, from experimentalists to computational scientists.</p>
  </sec>
  <sec>
    <title>2 Methods, data and implementation</title>
    <sec>
      <title>2.1 Case study with scRNA-seq data</title>
      <p>The results presented in the main paper and supplementary case study use an unpublished single-cell RNA-seq dataset consisting of 73 cells from two lymphoblast cell lines of two unrelated individuals. Cells were captured, lysed and cDNA generated using the popular C1 platform from Fluidigm, Inc. (<ext-link ext-link-type="uri" xlink:href="https://www.fluidigm.com/products/c1-system">https://www.fluidigm.com/products/c1-system</ext-link>). The processing of the two cell lines was replicated across two machines, with the nuclei of the two cell lines stained with different dyes before mixing on each machine. Cells were imaged before lysis, with an example image provided together with these data (see Case Study in <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). Samples were sequenced with paired-end sequencing using the HiSeq 2500 Sequencing system (Illumina). RNA-seq reads were mapped to a custom genome reference, consisting of Homo sapiens GRCh37 (primary assembly from <ext-link ext-link-type="uri" xlink:href="http://ftp://ftp.ensembl.org/pub/release-75/fasta/homo_sapiens/dna/">ftp://ftp.ensembl.org/pub/release-75/fasta/homo_sapiens/dna/</ext-link>, last accessed 14.08.2015), Epstein-Barr Virus type 1 (B95-8 strain, Accession NC_007605.1) and ERCC RNA spike-ins (ThermoFisher). Reads in fastq format were aligned with TopHat2 v2.0.12 (<xref rid="btw777-B29" ref-type="bibr">Kim <italic>et al.</italic>, 2013</xref>), using Bowtie2 v2.2.3.0 (<xref rid="btw777-B33" ref-type="bibr">Langmead and Salzberg, 2012</xref>) as the core mapping engine (–mate-inner-dist 190 –mate-std-dev 40 –report-secondary-alignments) and other default parameters. Potential PCR duplicates were marked with Picard MarkDuplicates v1.92(1464). Reads mapping uniquely to annotated exon features were counted using htseq-count implemented in HTSeq, version 0.6.1p1 (<xref rid="btw777-B3" ref-type="bibr">Anders <italic>et al.</italic>, 2015</xref>).</p>
      <p>Further case studies using <italic>scater</italic> on published data, for example from 3000 mouse cortex cells (<xref rid="btw777-B59" ref-type="bibr">Zeisel <italic>et al.</italic>, 2015</xref>) and 1200 cells from early-development mouse embryos (<xref rid="btw777-B47" ref-type="bibr">Scialdone <italic>et al.</italic>, 2016</xref>) are available at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.59897">http://dx.doi.org/10.5281/zenodo.59897</ext-link>. All materials required to reproduce the results presented in this paper are available at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.60139">http://dx.doi.org/10.5281/zenodo.60139</ext-link>.</p>
    </sec>
    <sec>
      <title>2.2 Implementation</title>
      <p>The <italic>scater</italic> package is an open-source R package available through Bioconductor. Key aspects of the code are written in C ++ to minimize computational time and memory use, and the package scales well to large datasets. For example, consider the <xref rid="btw777-B40" ref-type="bibr">Macosko <italic>et al.</italic> (2015)</xref> dataset, which contains more than 44 000 cells. The core scater functions to create an SCESet object and calculate QC metrics took approximately two minutes to complete on an early 2015 MacBook Pro laptop with 2.9 GHz Intel Core i5 processor and 16 Gb of RAM. Subsetting the SCESet object takes only a few seconds, and producing a PCA plot with the plotPCA function takes less than a minute.</p>
      <p>The package builds on many other R packages, including <italic>Biobase</italic> and <italic>BiocGenerics</italic> for core Bioconductor functionality (<xref rid="btw777-B24" ref-type="bibr">Huber <italic>et al.</italic>, 2015</xref>); <italic>destiny</italic> (<xref rid="btw777-B5" ref-type="bibr">Angerer <italic>et al.</italic>, 2015</xref>) and <italic>Rtsne</italic> for dimensionality reduction; and <italic>edgeR</italic> (<xref rid="btw777-B45" ref-type="bibr">Robinson <italic>et al.</italic>, 2010</xref>) and <italic>limma</italic> (<xref rid="btw777-B43" ref-type="bibr">Ritchie <italic>et al.</italic>, 2015</xref>) for model fitting and statistical analyses. The plotting functionality in the package uses <italic>ggplot2</italic>. A full set of dependencies is provided in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 The <italic>scater</italic> package</title>
      <p>The <italic>scater</italic> package offers a workflow to convert raw read sequences into a dataset ready for higher-level analysis within the R programming environment (<xref ref-type="fig" rid="btw777-F1">Fig. 1</xref>). In addition, <italic>scater</italic> provides basic computational infrastructure to standardize and streamline scRNA-seq data analyses. Key features of <italic>scater</italic> include: (i) the ‘single-cell expression set’ (SCESet) class, a data structure specialized for scRNA-seq data; (ii) wrapper methods to run <italic>kallisto</italic> and <italic>Salmon</italic> and process their output into gene-level expression values; (iii) automated calculation of quality control metrics, with QC visualization and filtering methods to retain high-quality cells and informative features; (iv) extensive visualization capabilities for inspection of scRNA-seq data and (v) methods to identify and remove uninteresting covariates affecting expression across cells. The package integrates many commonly used tools for scRNA-seq data analysis and provides a foundation on which future methods can be built. The methods in <italic>scater</italic> are agnostic to the form of the input data and are compatible with counts, transcripts-per-million, counts-per-million, FPKM or any other appropriate transformation of the expression values.</p>
      <fig id="btw777-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>An overview of the <italic>scater</italic> workflow, from raw sequenced reads to a high quality dataset ready for higher-level downstream analysis. For step 5, explanatory variables include experimental covariates like batch, cell source and other recorded information, as well as QC metrics computed from the data. Step 6 describes an optional round of normalization to remove effects of particular explanatory variables from the data. Automated computation of QC metrics and extensive plotting functionality support the workflow</p>
        </caption>
        <graphic xlink:href="btw777f1"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 SCESet: a data structure for single-cell expression data</title>
      <p>The <italic>scater</italic> package is built around the SCESet class (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>) which provides a sophisticated container for scRNA-seq data. This class inherits from the ExpressionSet class in Bioconductor’s <italic>Biobase</italic> package (<xref rid="btw777-B24" ref-type="bibr">Huber <italic>et al.</italic>, 2015</xref>), which allows assay data (and multiple transformations thereof), gene or transcript metadata and sample metadata to be combined in a single object to empower robust analyses. While the ExpressionSet class is the basis of many microarray and bulk RNA-seq analysis methods in Bioconductor, extensions to the class design are necessary to support scRNA-seq data analyses. Specifically, the SCESet class adds slots to store a reduced-dimension representation of the expression profiles, to easily visualize the relationships between cells; cell–cell and gene–gene pairwise distance matrices, for clustering or regulatory network reconstruction; bootstrapped expression results (such as from <italic>kallisto</italic>), to gauge the accuracy of expression quantification; consensus clustering results, where cluster assignments for each cell are combined from different methods to improve reliability; information about feature controls (such as ERCC spike-ins), which is required in downstream steps such as normalization, QC and detection of highly variable genes; and several more (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>). With these extra slots, SCESet objects can support analyses of scRNA-seq data that ExpressionSet cannot. In addition, extra data types such as FACS marker expression or epigenetic information can be easily stored in each SCESet object for integration with the single-cell expression profiles.</p>
      <p>An SCESet data object can be easily subsetted by row or column to remove unwanted genes or cells, respectively, from all data and metadata fields stored in the object. Furthermore, data and metadata in multiple SCESet objects can be easily combined e.g. to incorporate cells from different experimental batches. SCESet objects can also be converted to other R data structures, or saved to disk in structured, shareable formats. Further details on the class, including its motivation and execution, are available in the Supplementary Case Study and the package documentation. All methods available in <italic>scater</italic> are applicable to instances of the SCESet class and exploit the availability and richness of (meta)data stored in each SCESet object.</p>
    </sec>
    <sec>
      <title>3.3 Data pre-processing</title>
      <p>An important initial step in scRNA-seq data processing is to quantify the expression level of genomic features such as transcripts or genes from the raw sequencing data. Approaches to expression quantification from raw reads are, in principle, the same for scRNA-seq as they are for bulk RNA-seq (<xref rid="btw777-B27" ref-type="bibr">Kanitz <italic>et al.</italic>, 2015</xref>; <xref rid="btw777-B50" ref-type="bibr">Teng <italic>et al.</italic>, 2016</xref>). Read counts obtained from conventional quantification methods such as <italic>HTSeq</italic> (<xref rid="btw777-B3" ref-type="bibr">Anders <italic>et al.</italic>, 2015</xref>) and <italic>featureCounts</italic> (<xref rid="btw777-B37" ref-type="bibr">Liao <italic>et al.</italic>, 2014</xref>) can be readily stored in an SCESet object and used in a <italic>scater</italic> workflow (<xref ref-type="fig" rid="btw777-F1">Fig. 1</xref>). Another option is to use computationally efficient pseudoalignment methods such as <italic>kallisto</italic> and <italic>Salmon</italic>. This is especially appealing for large scRNA-seq datasets containing hundreds to tens of thousands of cells. To this end, <italic>scater</italic> also provides wrapper functions for <italic>kallisto</italic> and <italic>Salmon</italic> so that fast quantification of transcript-level expression can be managed completely within an R programming environment. A common subsequent step for these methods is to collapse transcript-level expression to gene-level expression. Exploiting the <italic>biomaRt</italic> R/Bioconductor package, <italic>scater</italic> provides a convenient function for using Ensembl annotations (<xref rid="btw777-B58" ref-type="bibr">Yates <italic>et al.</italic>, 2016</xref>) to obtain gene-level expression values and gene or transcript annotations.</p>
    </sec>
    <sec>
      <title>3.4 Data quality control</title>
      <p>The <italic>scater</italic> package provides methods to compute relevant QC metrics for an SCESet object. Given a set of control genes and/or cells, a variety of QC metrics will be computed and returned to the object in a single call to the calculateQCMetrics function (see package documentation). Cell-specific QC metrics include the total count across all genes, the total number of expressed genes, and the percentage of counts allocated to control genes like spike-in transcripts or mitochondrial genes. These metrics are useful for identifying low-quality cells—for example, a high percentage of counts mapping to spike-ins typically indicates that a small amount of RNA was captured for the cell, suggesting protocol failure or death of the cell in processing that renders it unsuitable for downstream analyses. For each gene, QC metrics such as the average expression level and the proportion of cells in which the gene is expressed are computed. This can be used to identify low-abundance genes or genes with high dropout rates that should be filtered out prior to downstream analyses. All of these metrics are used by scater to construct QC plots to diagnose potential issues with data quality. This facilitates quality control which—despite attempts at automation (<xref rid="btw777-B25" ref-type="bibr">Ilicic <italic>et al.</italic>, 2016</xref>)—still requires manual intervention to account for aspects of the data specific to each study. The package documentation provides full details of the QC metrics produced.</p>
      <p>In <italic>scater</italic>, the default plot method for an SCESet object produces a cumulative expression plot (<xref ref-type="fig" rid="btw777-F2">Fig. 2a</xref>). This plot describes how reads are distributed across genes, distinguishing between low-complexity libraries (where very few genes contain most of the counts) and their high-complexity counterparts (where counts are distributed more evenly across genes). For example, there is substantial variability in library complexity among cells in the case study dataset in <xref ref-type="fig" rid="btw777-F2">Figure 2a</xref>. Some cells have profiles similar to the blank wells, suggesting that library preparation or sequencing failed for these cells and that the corresponding libraries should be removed prior to further analysis. Cell phenotype variables can be incorporated into these plots to highlight differences in expression distributions for different types of cells. For example, the curve for each cell is coloured by the type of well that produced the library (<xref ref-type="fig" rid="btw777-F2">Fig. 2a</xref>), while cells can also be split into separate facets by library type to show more metadata variables simultaneously (see Supplementary Case Study). Cumulative expression plots should be favoured over boxplots as the default method for visualizing expression distributions across cells in a dataset, as the latter performs poorly at handling the long tail of low- and zero-expression observations in scRNA-seq data.</p>
      <fig id="btw777-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Different types of QC plots that can be generated with <italic>scater</italic>. (<bold>a</bold>) Cumulative expression plot showing the proportion of the library accounted for by the top 1–500 most highly expressed features. (<bold>b</bold>) PCA plot produced using a subset of the QC metrics computed with <italic>scater’s</italic> calculateQCMetrics function. (<bold>c</bold>) Plot of frequency of expression (percentage of cells in which the feature is deemed expressed) against mean expression level across cells. The vertical dotted line shows the median of the gene mean expression levels, and the horizontal dotted line indicates 50% frequency of expression. (<bold>d</bold>) Plot of the 20 most highly expressed features (computed according to the highest total read counts) across all cells in the dataset. For each feature, the circle represents the percentage of counts across all cells that correspond to that feature. The features are ordered by this value. The bars for each feature show the percentage of counts corresponding to the feature in each individual cell, providing a visualization of the distribution across cells. (<bold>e</bold>) Density plot showing the percentage of variance explained by a set of explanatory variables across all genes. Each individual plot is produced by a single call with either the function plot (a), plotPCA (b) or plotQC (c–e)</p>
        </caption>
        <graphic xlink:href="btw777f2"/>
      </fig>
      <p>The plotPCA function implements an approach to automatic outlier detection using multivariate normal methods applied to the cell-level QC metrics (<xref rid="btw777-B25" ref-type="bibr">Ilicic <italic>et al.</italic>, 2016</xref>). It produces a PCA plot computed from QC metrics, where cells corresponding to detected outliers are marked (<xref ref-type="fig" rid="btw777-F2">Fig. 2b</xref>). Briefly, semi-robust principal components are computed from robustly sphered QC metrics data, using the pcout function from the <italic>mvoutlier</italic> R package (<xref rid="btw777-B15" ref-type="bibr">Filzmoser <italic>et al.</italic>, 2008</xref>). These components are used to calculate distances for each cell, which are then used to compute weights for outlier detection. By default, the following QC metrics are used in this procedure: the percentage of counts from the top 100 features, the total number of features with detectable expression, the percentage of counts from control features, the number of detected feature controls, the log-scaled counts from endogenous features and log-transformed counts from feature controls. The user can specify QC metrics or other cell metadata variables to use for outlier detection with the ‘selected_variables’ argument to plotPCA. Detected outliers correspond to low-quality cells with abnormal library characteristics (e.g. low total counts and few expressed genes) that should be removed prior to downstream analysis. This automated approach is powerful but also somewhat opaque with respect to how outliers are defined, and so complements simpler filtering approaches that apply thresholds to particular QC metrics.</p>
      <p>The plotQC function generates many types of plots useful for quality control, such as a plot to visualize the frequency of expression of features against their average expression level (<xref ref-type="fig" rid="btw777-F2">Fig. 2c</xref>). Such plots are useful because scRNA-seq data are characterized by a high frequency of ‘dropout’ events, i.e. no observed expression (such as no read counts) in a particular cell for a gene that is actually expressed in that cell. Indeed, most genes will not have detectable expression in every cell. With plotQC, control features that should be present in each cell can be highlighted easily in the plot, allowing technical dropouts to be distinguished from biological heterogeneity of expression. Typical scRNA-seq datasets will show a broadly sigmoidal relationship between average expression level and frequency of expression across cells. This is consistent with expected behaviour where genes with greater average expression are more readily captured during library preparation and are detected at a greater frequency (<xref rid="btw777-B8" ref-type="bibr">Brennecke <italic>et al.</italic>, 2013</xref>; <xref rid="btw777-B30" ref-type="bibr">Kim <italic>et al.</italic>, 2015</xref>; <xref rid="btw777-B53" ref-type="bibr">Vallejos <italic>et al.</italic>, 2015</xref>).</p>
      <p>With plotQC, we can also produce a plot to visualize the most highly expressed features in the dataset (<xref ref-type="fig" rid="btw777-F2">Fig. 2d</xref>). This provides a feature-centric overview of the dataset that visualizes the features with highest total expression across all cells, while also displaying the distribution of cell-level expression values for these features. It is common to see ERCC spike-ins (if used), mitochondrial and ribosomal genes among the highest expressed genes, while datasets consisting of healthy cells will also show high levels of constitutively expressed genes like <italic>ACTB</italic>. This plot allows the analyst to quickly check that the gene- or transcript-level quantification is behaving as expected, and to flag datasets where it is not.</p>
      <p>Another important step in quality control is to identify variables (experimental factors or computed QC metrics) that drive variation in expression data across cells. The plotQC function provides a novel approach to identifying variables that have substantial explanatory power for many genes. For each variable in the phenoData slot of the SCESet object, we fit a linear model for each feature with only that variable as the explanatory variable. We then plot the distribution of the marginal <italic>R</italic><sup>2</sup> values across all features for the variables with the most explanatory power for the dataset (<xref ref-type="fig" rid="btw777-F2">Fig. 2e</xref>). The variables are ranked by median <italic>R</italic><sup>2</sup> across features in the plot, allowing users to identify variables that may need to be considered during normalization or statistical modelling. The plotQC function can also assess the influence of variables of interest by plotting principal components of the expression matrix most strongly correlated with a variable of interest against that variable. For example, in the Case Study data, the first principal component is correlated with the C1 machine used to process the cell (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>).</p>
      <p>We also introduce the plotPhenoData function for convenient plotting of cell phenotype information (including QC metrics), and the plotFeatureData function for plotting feature information (see examples in the Supplementary Case Study). These methods will work not only on the SCESet class defined in <italic>scater</italic>, but also on any ExpressionSet object, providing sophisticated plotting functionality for many other Bioconductor packages and contexts.</p>
      <p>The <italic>scater</italic> graphical user interface (GUI) provides convenient access to <italic>scater</italic>’s QC and visualization methods (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S4–S6</xref>). This opens an interactive interface in a web browser that facilitates exploration of the data through QC plots and other intuitive visualizations. The GUI allows users of any background to easily examine the effects of changing multiple parameters, which can be helpful for quickly conducting exploratory data analysis. Useful settings can then be stored in R scripts to ensure that data analyses are reproducible.</p>
      <p>In summary, <italic>scater</italic> provides a variety of novel and convenient methods to visualize an scRNA-seq dataset for QC. Low-quality cells and uninteresting genes can then be easily removed by filtering and subsetting the SCESet data structure prior to further analysis.</p>
    </sec>
    <sec>
      <title>3.5 Data visualization</title>
      <p>Dimensionality reduction techniques are necessary to convert high-dimensional expression data into low-dimensional representations for intuitive visualization of the relationships, similarities and differences between cells. To this end, <italic>scater</italic> provides convenient functions to apply a variety of dimensionality reduction procedures to the cells in an SCESet object. Functions include plotPCA, to perform a principal components analysis; plotTSNE, to perform t-distributed stochastic neighbour embedding (<xref rid="btw777-B55" ref-type="bibr">Van der Maaten and Hinton, 2008</xref>), which has been widely used for scRNA-seq data (<xref rid="btw777-B1" ref-type="bibr">Amir <italic>et al.</italic>, 2013</xref>; <xref rid="btw777-B6" ref-type="bibr">Bendall <italic>et al.</italic>, 2014</xref>; <xref rid="btw777-B40" ref-type="bibr">Macosko <italic>et al.</italic>, 2015</xref>); plotDiffusionMap, to generate a diffusion map (<xref rid="btw777-B20" ref-type="bibr">Haghverdi <italic>et al.</italic>, 2015</xref>) for visualizing differentiation processes; and plotMDS, to generate multi-dimensional scaling plots (<xref ref-type="fig" rid="btw777-F3">Fig. 3a–c</xref>). The plotReducedDim function can also be used to plot any reduced-dimension representation of cells (e.g. an independent component analysis produced by <italic>monocle</italic> (<xref rid="btw777-B51" ref-type="bibr">Trapnell <italic>et al.</italic>, 2013</xref>) or similar) that is stored in an SCESet object.</p>
      <fig id="btw777-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Reduced dimension representations of cells and gene expression plots with <italic>scater.</italic> Plots are shown using all genes (<bold>a–c</bold>) and cell cycle genes only (<bold>d–f</bold>) using PCA (a,d), t-SNE (b,e) and diffusion maps (c,f), where each point represents a cell. In the top row (a–c), points are coloured by patient of origin, sized by total features (number of genes with detectable expression) and the shape indicates the C1 machine used to process the cells. In the second row (d–f), points are coloured by the expression of <italic>CCND2</italic> (a gene associated with the G1/S phase transition of the cell cycle) in each cell. Furthermore, with the plotExpression function, gene expression can be plotted against any cell metadata variables or the expression of another gene—here, expression for the CD86, IGH44 and IGHV4-34 genes in each cell is plotted against the patient of origin (<bold>g</bold>). The function automatically detects whether the x-axis variable is categorical or continuous and plots the data accordingly, with x-axis values ‘jittered’ to avoid excessive overplotting of points with the same x coordinate</p>
        </caption>
        <graphic xlink:href="btw777f3"/>
      </fig>
      <p>By default, the PCA and t-SNE plots are produced using the features with the most variable expression across all cells. We focus on the most variable genes to highlight any heterogeneity in the data that might be driving interesting differences between cells. Alternatively, we can apply <italic>a priori</italic> knowledge to define a set of genes that are associated with a biological process of interest, and construct plots using only these features. For example, <xref rid="btw777-B46" ref-type="bibr">Scialdone <italic>et al.</italic> (2015)</xref> found that using prior knowledge to define feature sets is vital for exploring processes like the cell cycle, which can have substantial effects on single-cell expression measurements (<xref rid="btw777-B9" ref-type="bibr">Buettner <italic>et al.</italic>, 2015</xref>). The subsetting and filtering methods for SCESet objects facilitate the generation of reduced-dimension plots for particular gene sets, in order to investigate certain effects in the data such as those due to the cell cycle (<xref ref-type="fig" rid="btw777-F3">Fig. 3d–f</xref>).</p>
      <p>The various types of reduced-dimension plots can be used to examine the structure of the cell population, including the formation of distinct subpopulations or the presence of continuous trajectories. Cell-level variables stored in the SCESet object can be used to define the shape, colour and size of points plotted, allowing more information to be conveniently incorporated into each plot (e.g. cells are coloured by <italic>CCND2</italic> expression in <xref ref-type="fig" rid="btw777-F3">Fig. 3d–f</xref>). The plotExpression function is also provided for plotting expression levels of a particular gene against any of the cell phenotype variables or the expression level of another feature (<xref ref-type="fig" rid="btw777-F3">Fig. 3g</xref>). This allows the user to inspect the expression levels of a feature or set of features in full detail, rather than relying only on summary information and reduced-dimension plots where information is necessarily lost.</p>
    </sec>
    <sec>
      <title>3.6 Data normalization and batch correction</title>
      <p>Scaling normalization is typically required in RNA-seq data analysis to remove biases caused by differences in sequencing depth, capture efficiency or composition effects between samples. Frequently used methods for scaling normalization include the trimmed mean of M-values (<xref rid="btw777-B44" ref-type="bibr">Robinson and Oshlack, 2010</xref>), relative log-expression (<xref rid="btw777-B2" ref-type="bibr">Anders and Huber, 2010</xref>) and upper-quartile methods (<xref rid="btw777-B10" ref-type="bibr">Bullard <italic>et al.</italic>, 2010</xref>), all of which are available for use in <italic>scater</italic>. In addition, <italic>scater</italic> is tightly integrated with the <italic>scran</italic> package, which implements a method utilizing cell pooling and deconvolution to compute size factors better suited to scRNA-seq data (<xref rid="btw777-B39" ref-type="bibr">Lun <italic>et al.</italic>, 2016b</xref>). <xref rid="btw777-B38" ref-type="bibr">Lun <italic>et al.</italic> (2016a</xref>) also offers further discussion of the respective benefits and drawbacks of spike-in normalization and non-DE normalization.</p>
      <p>After scaling normalization, further correction is typically required to ameliorate or remove batch effects. For example, in the case study dataset, cells from two patients were each processed on two C1 machines. Although C1 machine is not one of the most important explanatory variables on a per-gene level (<xref ref-type="fig" rid="btw777-F2">Fig. 2e</xref>), this factor is correlated with the first principal component of the log-expression data (<xref ref-type="fig" rid="btw777-F2">Fig. 2f</xref>). This effect cannot be removed by scaling normalization methods, which target cell-specific biases and are not sufficient for removing large-scale batch effects that vary on a gene-by-gene basis (<xref ref-type="fig" rid="btw777-F4">Fig. 4a</xref>). Here we present two possibilities, both easily implemented in a scater workflow.</p>
      <fig id="btw777-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>Normalization and batch correction with <italic>scater</italic>. Principal component analysis plots showing cell structure in the first two PCA dimensions using various normalization methods that can be easily applied in <italic>scater</italic>, including endogenous size-factor normalization using methods from the <italic>scran</italic> package (<bold>a</bold>); expression residuals after applying size-factor normalization and regressing out known, unwanted sources of variation (<bold>b</bold>); and removal of one hidden factor identified using the RUVs method from the <italic>RUV</italic> package (<bold>c</bold>). In all plots, the colour of points is determined by the patient from which cells were obtained, shape is determined by the C1 machine used to process the cells and size reflects the total number of genes with detectable expression in the cell</p>
        </caption>
        <graphic xlink:href="btw777f4"/>
      </fig>
      <p>The C1 machine effect is known from the design of the experiment, so we can easily regress out this effect in <italic>scater</italic>. With the normaliseExprs function the user can supply a design matrix of variables to regress out of the expression values, and residuals from the linear model fit can be used as expression values for downstream analyses. For the dataset here, we fit a linear model to the <italic>scran</italic> normalized log-expression values with the C1 machine as an explanatory factor. (We also use the log-total counts from endogenous genes, percentage of counts from the top 100 most highly expressed genes and percentage of counts from control genes as additional covariates to control for these other unwanted technical effects.) We then use the residuals from the fitted model for further analyses (see Case Study in <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). This approach successfully removes the C1 machine effect as a major source of variation between cells; the first principal component now separates the cells from the two patients, as expected (<xref ref-type="fig" rid="btw777-F4">Fig. 4b</xref>). This approach needs to be used carefully as single-cell data often deviate from normal distributions, but in many cases, as here, it can successfully ameliorate large-scale known batch effects.</p>
      <p>In addition to removing known batch effects, it can be important for large datasets to identify (potentially unknown) sources of unwanted variation (<xref rid="btw777-B17" ref-type="bibr">Grün and van Oudenaarden, 2015</xref>; <xref rid="btw777-B23" ref-type="bibr">Hicks <italic>et al.</italic>, 2015</xref>; <xref rid="btw777-B36" ref-type="bibr">Leek <italic>et al.</italic>, 2010</xref>). <italic>scater</italic> is compatible with existing methods such as <italic>svaseq</italic> (<xref rid="btw777-B35" ref-type="bibr">Leek and Storey, 2007</xref>; <xref rid="btw777-B34" ref-type="bibr">Leek, 2014</xref>) and <italic>RUVSeq</italic> (<xref rid="btw777-B42" ref-type="bibr">Risso <italic>et al.</italic>, 2014</xref>) to identify and remove these unwanted sources of variation. Here, just removing the first latent variable identified by the RUVs method from <italic>RUVSeq</italic> is sufficient to remove the machine effect, as the PCA plot now separates cells by patient rather than C1 machine (<xref ref-type="fig" rid="btw777-F4">Fig. 4c</xref>). More targeted applications of these methods can be used to remove specific effects, for example, by identifying latent factors from cell cycle genes to remove the cell cycle effect.</p>
      <p>We emphasize that it is generally preferable to incorporate batch effects or latent variables into statistical models used for inference. Where this is not possible (e.g. for visualization), directly regressing out these uninteresting factors is required to obtain ‘corrected’ expression values for further analysis. Furthermore, a general risk of removing latent factors is that interesting biological variation may be removed along with the presumed unwanted variation. Users should therefore apply such methods with appropriate caution, particularly when an analysis aims to discover biological conditions, such as new cell types.</p>
    </sec>
    <sec>
      <title>3.7 Software and data integration</title>
      <p>As part of the R/Bioconductor ecosystem, <italic>scater</italic> can be easily integrated with other software for scRNA-seq data analysis (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S3</xref>). As the SCESet class builds on existing Bioconductor data structures, most Bioconductor packages for expression analyses are able to operate seamlessly with SCESet objects. Tools that can integrate easily with <italic>scater</italic> include many options for data normalization (<xref rid="btw777-B13" ref-type="bibr">Ding <italic>et al.</italic>, 2015</xref>; <xref rid="btw777-B39" ref-type="bibr">Lun <italic>et al.</italic>, 2016b</xref>; <xref rid="btw777-B53" ref-type="bibr">Vallejos <italic>et al.</italic>, 2015</xref>), differential expression analysis (<xref rid="btw777-B16" ref-type="bibr">Finak <italic>et al.</italic>, 2015</xref>; <xref rid="btw777-B28" ref-type="bibr">Kharchenko <italic>et al.</italic>, 2014</xref>; <xref rid="btw777-B52" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>; <xref rid="btw777-B54" ref-type="bibr">Vallejos <italic>et al.</italic>, 2016</xref>), heterogeneous gene expression analyses (<xref rid="btw777-B53" ref-type="bibr">Vallejos <italic>et al.</italic>, 2015</xref>), clustering (<xref rid="btw777-B14" ref-type="bibr">Fan <italic>et al.</italic>, 2016</xref>; <xref rid="btw777-B18" ref-type="bibr">Grün <italic>et al.</italic>, 2015</xref>; <xref rid="btw777-B19" ref-type="bibr">Guo <italic>et al.</italic>, 2015</xref>; <xref rid="btw777-B31" ref-type="bibr">Kiselev <italic>et al.</italic>, 2016</xref>), latent or hidden variable analysis (<xref rid="btw777-B12" ref-type="bibr">Chikina <italic>et al.</italic>, 2015</xref>; <xref rid="btw777-B34" ref-type="bibr">Leek, 2014</xref>; <xref rid="btw777-B42" ref-type="bibr">Risso <italic>et al.</italic>, 2014</xref>; <xref rid="btw777-B49" ref-type="bibr">Stegle <italic>et al.</italic>, 2012</xref>), cell cycle phase identification (<xref rid="btw777-B46" ref-type="bibr">Scialdone <italic>et al.</italic>, 2015</xref>) and pseudotime computation (<xref rid="btw777-B5" ref-type="bibr">Angerer <italic>et al.</italic>, 2015</xref>; <xref rid="btw777-B11" ref-type="bibr">Campbell and Yau, 2016</xref>; <xref rid="btw777-B26" ref-type="bibr">Juliá <italic>et al.</italic>, 2015</xref>; <xref rid="btw777-B52" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>). The <italic>scater</italic> package bridges the gap between raw reads and these downstream analysis tools by providing the pre-processing, QC, visualization and normalization methods and a data structure combining multiple data modalities and metadata necessary for convenient, robust and reproducible analyses of scRNA-seq data (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> for discussion of entry points to several third party tools from <italic>scater</italic>).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Single-cell RNA sequencing is widely used for high-resolution gene expression studies investigating the behaviour of individual cells. While scRNA-seq data can provide substantial biological insights, the complexity and noise of the data is also much greater than that of conventional bulk RNA-seq. Thus, rigorous analysis of scRNA-seq data requires careful quality control to remove low-quality cells and genes, as well as normalization to adjust for biases and batch effects in the expression data. Failure to carry out these procedures correctly is likely to compromise the validity of all downstream analyses (<xref rid="btw777-B17" ref-type="bibr">Grün and van Oudenaarden, 2015</xref>; <xref rid="btw777-B23" ref-type="bibr">Hicks <italic>et al.</italic>, 2015</xref>; <xref rid="btw777-B36" ref-type="bibr">Leek <italic>et al.</italic>, 2010</xref>).</p>
    <p>Here, we present an R/Bioconductor package, <italic>scater</italic>, that provides crucial infrastructure and methods for low-level scRNA-seq data analysis. The package introduces a data structure tailored to scRNA-seq data that is compatible with a vast number of existing tools in the Bioconductor project. The <italic>scater</italic> data structure combines multiple transformations of the expression data with cell and feature (gene or transcript) metadata and allows datasets to be easily standardized and shared. Wrapper functions for the popular RNA-seq quantification methods <italic>kallisto</italic> and <italic>Salmon</italic> facilitate the processing of raw read sequences to a SCESet object in R with expression data and accompanying metadata.</p>
    <p>Quality control is a vital preliminary step for scRNA-seq and can be a time-consuming manual task. We present a tool for automated computation of QC metrics, novel plotting methods for QC and convenient subsetting and filtering methods to substantially simplify the process of filtering out unwanted or problematic cells and genes. The package provides a large array of sophisticated plotting functions so that cells can be visualized with a variety of popular dimensionality-reduction techniques in plots that incorporate cell metadata and expression values as plotting variables.</p>
    <p>Normalization is a critical aspect of scRNA-seq data processing that is supported by <italic>scater</italic>. Scaling normalization methods, including the single-cell specific methods in the <italic>scran</italic> package, are seamlessly integrated into a <italic>scater</italic> workflow. Methods for identifying and removing batch effects and other types of unwanted variation are supported both with internal methods and through integration with a multitude of tools available in the R/Bioconductor environment. Once identified, important covariates and latent variables can be flagged for inclusion in downstream statistical models or their effects regressed out of normalized expression values. The package is thoroughly documented and a recent step-by-step workflow article demonstrates detailed use of <italic>scater</italic> in combination with other analysis packages in a range of scenarios (<xref rid="btw777-B38" ref-type="bibr">Lun <italic>et al.</italic>, 2016a</xref>).</p>
    <p>Future development will include further extensions to data structures that will enable tight integration of single-cell transcriptomic, genetic and epigenetic data, as well as further refinement of the methods available as the single-cell field matures. Although <italic>scater</italic> has been produced for scRNA-seq data, its capabilities are well suited for single-cell qPCR data and bulk RNA-seq data, and may prove useful for supporting analyses of these data types.</p>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>The <italic>scater</italic> package eases the burden for a user tasked with producing a high-quality single-cell expression dataset for downstream analysis. The intuitive GUI implemented in <italic>scater</italic> provides an easy entry point into rigorous analysis of scRNA-seq data for users without a computational background, enabling them to process raw reads into high-quality expression data within a single computing environment. Experienced users can take advantage of <italic>scater</italic>’s data structures, wide array of methods, suitability for scripted analyses and seamless integration with many other R/Bioconductor analysis tools. The data structures and methods in <italic>scater</italic> provide basic infrastructure upon which new scRNA-seq analysis tools can be developed. We anticipate that <italic>scater</italic> will be a useful resource for both analysts and software developers in the single-cell RNA sequencing field.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btw777_supp.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Marco Salvetti for provision of the two samples and Zam Cader for processing the samples. We would also like to acknowledge Peter Donnelly and Oliver Stegle for support and helpful discussions.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the National Health and Medical Research Council of Australia [APP1112681 to D.J.M.], by core funding from the European Molecular Biology Laboratory [D.J.M.], core funding from Cancer Research UK [A17197 to A.T.L.L.], the United Kingdom Medical Research Council [studentship to K.R.C.] and the Oxford Single Cell Biology Consortium [Q.F.W.].</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btw777-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Amir</surname><given-names>E.A.D.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>viSNE enables visualization of high dimensional single-cell data and reveals phenotypic heterogeneity of leukemia</article-title>. <source>Nat. Biotechnol</source>., <volume>31</volume>, <fpage>545</fpage>–<lpage>552</lpage>.<pub-id pub-id-type="pmid">23685480</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Anders</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Huber</surname><given-names>W.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol</source>., <volume>11</volume>, <fpage>R106</fpage>.<pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Anders</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>HTSeq–a Python framework to work with high-throughput sequencing data</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>166</fpage>–<lpage>169</lpage>.<pub-id pub-id-type="pmid">25260700</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Angerer</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>destiny: diffusion maps for large-scale single-cell data in R</article-title>. <source>Bioinformatics</source>, <bold>32</bold>, 1241–1243.</mixed-citation>
    </ref>
    <ref id="btw777-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bendall</surname><given-names>S.C.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Single-cell trajectory detection uncovers progression and regulatory coordination in human B cell development</article-title>. <source>Cell</source>, <volume>157</volume>, <fpage>714</fpage>–<lpage>725</lpage>.<pub-id pub-id-type="pmid">24766814</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bray</surname><given-names>N.L.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Near-optimal probabilistic RNA-seq quantification</article-title>. <source>Nat. Biotechnol</source>., <bold>34</bold>, 525–527.</mixed-citation>
    </ref>
    <ref id="btw777-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brennecke</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>. <source>Nat. Methods</source>, <volume>10</volume>, <fpage>1093</fpage>–<lpage>1095</lpage>.<pub-id pub-id-type="pmid">24056876</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Buettner</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>. <source>Nat. Biotechnol</source>., <volume>33</volume>, <fpage>155</fpage>–<lpage>160</lpage>.<pub-id pub-id-type="pmid">25599176</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bullard</surname><given-names>J.H.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title>. <source>BMC Bioinformatics</source>, <volume>247</volume>, <fpage>1</fpage>–<lpage>62</lpage>.</mixed-citation>
    </ref>
    <ref id="btw777-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Campbell</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Yau</surname><given-names>C.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Ouija: Incorporating prior knowledge in single-cell trajectory learning using Bayesian nonlinear factor analysis</article-title>. <source>bioRxiv</source>, <fpage>060442</fpage>.</mixed-citation>
    </ref>
    <ref id="btw777-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chikina</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>CellCODE: a robust latent variable approach to differential expression analysis for heterogeneous cell populations</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>1584</fpage>–<lpage>1591</lpage>.<pub-id pub-id-type="pmid">25583121</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ding</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Normalization and noise reduction for single cell RNA-seq experiments</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>2225</fpage>–<lpage>2227</lpage>.<pub-id pub-id-type="pmid">25717193</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fan</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Characterizing transcriptional heterogeneity through pathway and gene set overdispersion analysis</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>241</fpage>–<lpage>244</lpage>.<pub-id pub-id-type="pmid">26780092</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Filzmoser</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Outlier identification in high dimensions</article-title>. <source>Comput. Stat. Data Anal</source>., <volume>52</volume>, <fpage>1694</fpage>–<lpage>1711</lpage>.</mixed-citation>
    </ref>
    <ref id="btw777-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Finak</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>278</fpage>.<pub-id pub-id-type="pmid">26653891</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Grün</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>van Oudenaarden</surname><given-names>A.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Design and analysis of single-cell sequencing experiments</article-title>. <source>Cell</source>, <volume>163</volume>, <fpage>799</fpage>–<lpage>810</lpage>.<pub-id pub-id-type="pmid">26544934</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Grün</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>. <source>Nature</source>, <volume>525</volume>, <fpage>251</fpage>–<lpage>255</lpage>.<pub-id pub-id-type="pmid">26287467</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guo</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>SINCERA: a pipeline for single-cell RNA-Seq profiling analysis</article-title>. <source>PLoS Comput. Biol</source>., <volume>11</volume>, <fpage>e1004575</fpage>.<pub-id pub-id-type="pmid">26600239</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Haghverdi</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Diffusion maps for high-dimensional single-cell analysis of differentiation data</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>2989</fpage>–<lpage>2998</lpage>.<pub-id pub-id-type="pmid">26002886</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hebenstreit</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Teichmann</surname><given-names>S.A.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Analysis and simulation of gene expression profiles in pure and mixed cell populations</article-title>. <source>Phys. Biol</source>., <volume>8</volume>, <fpage>035013</fpage>.<pub-id pub-id-type="pmid">21572174</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hicks</surname><given-names>S.C.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>On the widespread and critical impact of systematic bias and batch effects in single-cell RNA-Seq data</article-title>. <source>bioRxiv</source>, <fpage>025528</fpage>.</mixed-citation>
    </ref>
    <ref id="btw777-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huber</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>115</fpage>–<lpage>121</lpage>.<pub-id pub-id-type="pmid">25633503</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ilicic</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Classification of low quality cells from single-cell RNA-seq data</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>29</fpage>.<pub-id pub-id-type="pmid">26887813</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Juliá</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Sincell: an R/Bioconductor package for statistical assessment of cell-state hierarchies from single-cell RNA-seq</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>3380</fpage>–<lpage>3382</lpage>.<pub-id pub-id-type="pmid">26099264</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kanitz</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Comparative assessment of methods for the computational inference of transcript isoform abundance from RNA-seq data</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>150</fpage>.<pub-id pub-id-type="pmid">26201343</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kharchenko</surname><given-names>P.V.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Bayesian approach to single-cell differential expression analysis</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>740</fpage>–<lpage>742</lpage>.<pub-id pub-id-type="pmid">24836921</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kim</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions</article-title>. <source>Genome Biol</source>., <volume>14</volume>, <fpage>R36</fpage>.<pub-id pub-id-type="pmid">23618408</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kim</surname><given-names>J.K.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Characterizing noise structure in single-cell RNA-seq distinguishes genuine from technical stochastic allelic expression</article-title>. <source>Nat. Commun</source>., <volume>6</volume>, 8687.</mixed-citation>
    </ref>
    <ref id="btw777-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kiselev</surname><given-names>V.Y.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>SC3 –– consensus clustering of single-cell RNA-Seq data</article-title>. <source>bioRxiv</source>, <fpage>036558</fpage>.</mixed-citation>
    </ref>
    <ref id="btw777-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Langmead</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>357</fpage>–<lpage>359</lpage>.<pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leek</surname><given-names>J.T.</given-names></name></person-group> (<year>2014</year>) 
<article-title>svaseq: removing batch effects and other unwanted noise from sequencing data</article-title>. <source>Nucleic Acids Res</source>., <volume>42</volume>, <fpage>e161</fpage>.</mixed-citation>
    </ref>
    <ref id="btw777-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leek</surname><given-names>J.T.</given-names></name>, <name name-style="western"><surname>Storey</surname><given-names>J.D.</given-names></name></person-group> (<year>2007</year>) 
<article-title>Capturing heterogeneity in gene expression studies by surrogate variable analysis</article-title>. <source>PLoS Genet</source>., <volume>3</volume>, <fpage>1724</fpage>–<lpage>1735</lpage>.<pub-id pub-id-type="pmid">17907809</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leek</surname><given-names>J.T.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Tackling the widespread and critical impact of batch effects in high-throughput data</article-title>. <source>Nat. Rev. Genet</source>., <volume>11</volume>, <fpage>733</fpage>–<lpage>739</lpage>.<pub-id pub-id-type="pmid">20838408</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liao</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>923</fpage>–<lpage>930</lpage>.<pub-id pub-id-type="pmid">24227677</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lun</surname><given-names>A.T.L.</given-names></name></person-group><etal>et al</etal> (<year>2016a</year>) 
<article-title>A step-by-step workflow for low-level analysis of single-cell RNA-seq data</article-title>. <source>F1000Research</source>, <volume>5</volume>, 2122.</mixed-citation>
    </ref>
    <ref id="btw777-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lun</surname><given-names>A.T.L.</given-names></name></person-group><etal>et al</etal> (<year>2016b</year>) 
<article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>75</fpage>.<pub-id pub-id-type="pmid">27122128</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Macosko</surname><given-names>E.Z.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1202</fpage>–<lpage>1214</lpage>.<pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Patro</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Salmon provides accurate, fast, and bias-aware transcript expression estimates using dual-phase inference</article-title>. <source>bioRxiv</source>, 021592.</mixed-citation>
    </ref>
    <ref id="btw777-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Risso</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Normalization of RNA-seq data using factor analysis of control genes or samples</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>896</fpage>–<lpage>902</lpage>.<pub-id pub-id-type="pmid">25150836</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ritchie</surname><given-names>M.E.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source>Nucleic Acids Res</source>., <volume>43</volume>, <fpage>e47</fpage>.<pub-id pub-id-type="pmid">25605792</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>M.D.</given-names></name>, <name name-style="western"><surname>Oshlack</surname><given-names>A.</given-names></name></person-group> (<year>2010</year>) 
<article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>. <source>Genome Biol</source>., <volume>11</volume>, <fpage>R25</fpage>.<pub-id pub-id-type="pmid">20196867</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>M.D.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>139</fpage>–<lpage>140</lpage>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Scialdone</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Computational assignment of cell-cycle stage from single-cell transcriptome data</article-title>. <source>Methods</source>, <volume>85</volume>, <fpage>54</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">26142758</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Scialdone</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Resolving early mesoderm diversification through single-cell expression profiling</article-title>. <source>Nature</source>, <volume>535</volume>, <fpage>289</fpage>–<lpage>293</lpage>.<pub-id pub-id-type="pmid">27383781</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shalek</surname><given-names>A.K.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Single-cell transcriptomics reveals bimodality in expression and splicing in immune cells</article-title>. <source>Nature</source>, <volume>498</volume>, <fpage>236</fpage>–<lpage>240</lpage>.<pub-id pub-id-type="pmid">23685454</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stegle</surname><given-names>O.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Using probabilistic estimation of expression residuals (PEER) to obtain increased power and interpretability of gene expression analyses</article-title>. <source>Nat. Protoc</source>., <volume>7</volume>, <fpage>500</fpage>–<lpage>507</lpage>.<pub-id pub-id-type="pmid">22343431</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Teng</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>A benchmark for RNA-seq quantification pipelines</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>74</fpage>.<pub-id pub-id-type="pmid">27107712</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Trapnell</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Differential analysis of gene regulation at transcript resolution with RNA-seq</article-title>. <source>Nat. Biotechnol</source>., <volume>31</volume>, <fpage>46</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">23222703</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Trapnell</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>381</fpage>–<lpage>386</lpage>.<pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vallejos</surname><given-names>C.A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>BASiCS: Bayesian analysis of single-cell sequencing data</article-title>. <source>PLoS Computat. Biol</source>., <volume>11</volume>, <fpage>e1004333</fpage>.</mixed-citation>
    </ref>
    <ref id="btw777-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vallejos</surname><given-names>C.A.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Beyond comparisons of means: understanding changes in gene expression at the single-cell level</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>70</fpage>.<pub-id pub-id-type="pmid">27083558</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Van der Maaten</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Hinton</surname><given-names>G.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Visualizing data using t-SNE</article-title>. <source>J. Mach. Learn. Res. JMLR</source>, <volume>9</volume>, <fpage>85</fpage>.</mixed-citation>
    </ref>
    <ref id="btw777-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yates</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Ensembl 2016</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>D710</fpage>–<lpage>D716</lpage>.<pub-id pub-id-type="pmid">26687719</pub-id></mixed-citation>
    </ref>
    <ref id="btw777-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zeisel</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>. <source>Science</source>, <volume>347</volume>, <fpage>1138</fpage>–<lpage>1142</lpage>.<pub-id pub-id-type="pmid">25700174</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
