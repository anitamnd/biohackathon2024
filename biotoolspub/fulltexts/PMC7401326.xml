<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Genet</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Genet.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-8021</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7401326</article-id>
    <article-id pub-id-type="doi">10.3389/fgene.2020.00675</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Genetics</subject>
        <subj-group>
          <subject>Technology and Code</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>rboAnalyzer: A Software to Improve Characterization of Non-coding RNAs From Sequence Database Search Output</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schwarz</surname>
          <given-names>Marek</given-names>
        </name>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/475939/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vohradský</surname>
          <given-names>Jiří</given-names>
        </name>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/37955/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Modrák</surname>
          <given-names>Martin</given-names>
        </name>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/471896/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pánek</surname>
          <given-names>Josef</given-names>
        </name>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/462573/overview"/>
      </contrib>
    </contrib-group>
    <aff><institution>Laboratory of Bioinformatics, Institute of Microbiology, Czech Academy of Sciences</institution>, <addr-line>Prague</addr-line>, <country>Czechia</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Alfredo Pulvirenti, University of Catania, Italy</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Juan Antonio Garcia-Martin, Centro Nacional de Biotecnología (CNB), Spain; Salvatore Alaimo, University of Catania, Italy</p>
      </fn>
      <corresp id="c001">*Correspondence: Josef Pánek, <email>panek@biomed.cas.cz</email></corresp>
      <fn fn-type="other" id="fn004">
        <p>This article was submitted to Computational Genomics, a section of the journal Frontiers in Genetics</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>11</volume>
    <elocation-id>675</elocation-id>
    <history>
      <date date-type="received">
        <day>02</day>
        <month>10</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>02</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2020 Schwarz, Vohradský, Modrák and Pánek.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Schwarz, Vohradský, Modrák and Pánek</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Searching for similar sequences in a database via BLAST or a similar tool is one of the most common bioinformatics tasks applied in general, and to non-coding RNAs in particular. However, the results of the search might be difficult to interpret due to the presence of partial matches to the database subject sequences. Here, we present rboAnalyzer – a tool that helps with interpreting sequence search result by (1) extending partial matches into plausible full-length subject sequences, (2) predicting homology of RNAs represented by full-length subject sequences to the query RNA, (3) pooling information across homologous RNAs found in the search results and public databases such as Rfam to predict more reliable secondary structures for all matches, and (4) contextualizing the matches by providing the prediction results and other relevant information in a rich graphical output. Using predicted full-length matches improves secondary structure prediction and makes rboAnalyzer robust with regards to identification of homology. The output of the tool should help the user to reliably characterize non-coding RNAs in BLAST output. The usefulness of the rboAnalyzer and its ability to correctly extend partial matches to full-length is demonstrated on known homologous RNAs. To allow the user to use custom databases and search options, rboAnalyzer accepts any search results as a text file in the BLAST format. The main output is an interactive HTML page displaying the computed characteristics and other context of the matches. The output can also be exported in an appropriate sequence and/or secondary structure formats.</p>
    </abstract>
    <kwd-group>
      <kwd>RNA</kwd>
      <kwd>sequence</kwd>
      <kwd>database</kwd>
      <kwd>search</kwd>
      <kwd>secondary structure</kwd>
      <kwd>RNA homology</kwd>
    </kwd-group>
    <counts>
      <fig-count count="8"/>
      <table-count count="2"/>
      <equation-count count="1"/>
      <ref-count count="20"/>
      <page-count count="13"/>
      <word-count count="0"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="S1">
    <title>Introduction</title>
    <p>The output of a BLAST (<xref rid="B2" ref-type="bibr">Camacho et al., 2009</xref>) search is a list of hits of the query sequence in the search database that are called <italic>high-scoring pairs</italic> (HSPs). They are characterized by their statistically estimated quality and position within the sequences in the search database. A HSP contains the sequences of the matched RNA and the query RNA that are similar to each other. These sequences can be either full sequences or fragments of the full sequences, so called <italic>partial matches</italic>.</p>
    <p>Since it is frequently impossible to reliably determine secondary structure, homology and function from a fragment of a non-coding RNA, the interpretation of results of a sequence search for non-coding RNAs requires full-length sequences of the matched RNAs. The full-length sequences of the partial matches are usually identified manually using external bioinformatics tools for individual RNAs which can be laborious and inefficient. The aim of the presented tool, rboAnalyzer, is to replace the manual work by an automated workflow and thereby to make the interpretation of the database sequence search results easier.</p>
    <p>The rboAnalyzer pipeline extends partial or otherwise imperfect matches to the length of the query sequence and computes its secondary structure and a homology to the query RNA. These tasks are handled with available bioinformatics algorithms integrated into a framework that combines the information contained in the BLAST output with external sources such as Rfam (<xref rid="B12" ref-type="bibr">Nawrocki et al., 2015</xref>). rboAnalyzer runs from command line. Its input consist of a BLAST output text file, a FASTA file with the query RNA sequence and the database used in the search. The output is a HTML page that integrates the computed characteristics of the subject RNAs together with the subject RNAs data. Results are presented in a clear, interactive and exportable form.</p>
    <p>While the presented version of rboAnalyzer takes BLAST results as an input, the algorithm is general and can be easily extended to accept matches obtained with other database sequence search tools.</p>
  </sec>
  <sec id="S2">
    <title>Implementation</title>
    <p>rboAnalyzer operates in three steps (<xref ref-type="fig" rid="F1">Figure 1</xref>): (1) extension of partial matches to their probable full-length, (2) homology identification of the subject RNAs, and (3) secondary structure prediction. All the information is then integrated into a HTML output. rboAnalyzer runs on Linux and was implemented using Bash and Python 3 with the Biopython (<xref rid="B3" ref-type="bibr">Cock et al., 2009</xref>), NumPy (<xref rid="B14" ref-type="bibr">Oliphant, 2006</xref>), Pandas (<xref rid="B11" ref-type="bibr">McKinney, 2010</xref>), matplotlib (<xref rid="B6" ref-type="bibr">Hunter, 2007</xref>), and Jinja2<sup><xref ref-type="fn" rid="footnote1">1</xref></sup> libraries.</p>
    <fig id="F1" position="float">
      <label>FIGURE 1</label>
      <caption>
        <p>An rboAnalyzer flowchart. The names of analysis steps are in boxes. The names of data and information are in italics. The arrows indicate the data and information flow.</p>
      </caption>
      <graphic xlink:href="fgene-11-00675-g001"/>
    </fig>
    <p>Step 1: Extending partial matches to full length</p>
    <p>In this step, partial matches of subject sequences in HSPs (<xref ref-type="fig" rid="F2">Figure 2</xref>) are extended to their predicted full-length in sequences in the underlying database. We accomplish this extension by three methods termed here “simple,” “locarna,” and “meta.”</p>
    <fig id="F2" position="float">
      <label>FIGURE 2</label>
      <caption>
        <p>The diagram outlying “simple” and “locarna” methods for extension of partial matches. Panels <bold>(A–C)</bold> demonstrate BLAST HSP, “simple,” and “locarna” methods, respectively. Panel <bold>(A)</bold> shows an example of BLAST HSP. The HSP consists of a partial match between the query and subject sequences. The match (with nucleotides highlighted in bold) is located between nucleotides 14 and 24 on the query sequence, while between nucleotides 21 and 31 on the subject sequence. The partial match of the subject sequence is extended to its predicted full length using the “simple” and “locarna” methods, demonstrated in panels (B, C), respectively. Panel <bold>(B)</bold> depicts the “simple” method. The example query sequence with 31 nucleotides is shown and marked as “Query” on its 5′ end. In section B 1. the partial match of the subject sequence (with nucleotides in bold on “Sbjct” sequence) is extended to its predicted full length simply by adding the parts of the subject sequence according to the length of the query sequence to its both ends. These parts are marked by dotted lines. Section B 2 shows the result of the extension, i.e., the extended partial match for the subject sequence. It lies between nucleotides 8 and 38 on the subject sequence. The original HSP is highlighted in bold. The red rectangles mark errors that can be either mismatched or missing nucleotides, marked by 5′ and 3′ red rectangles, respectively, in the diagram. The errors may be produced due to direct simple assignment of unaligned 5′ and 3′ flanking sequences of partial match without nucleotide context. Panel <bold>(C)</bold> depicts the “locarna” method. In section C 1., the partial match of the subject sequence is extended so it can be aligned to the query sequence by “locarna,” while anchored at HSP. The anchor is highlighted in yellow. The extension sequences at the both ends of the partial match of the subject sequence consists each of the extension to the length of the query sequence (dotted lines) and an extra sequence of an empirically chosen length of <italic>O</italic><sub>loc</sub> nucleotides (solid lines denoted as <italic>O</italic><sub>loc</sub>). For explanation, why this is used, please, refer to the main text. Section C 2. depicts the result of the “locarna” alignment. The extended partial match for subject sequence is between nucleotides 11 and 39 of the subject sequence and it is the final result, i.e., the extended partial match of the subject sequence. Note, that the “locarna” anchored alignment eliminated the errors produced by the “simple” method (B.2) due to taking into account nucleotide context of 5′ and 3′ flanking sequences of the partial match and therefore the correct nucleotides were assigned (marked by green rectangles).</p>
      </caption>
      <graphic xlink:href="fgene-11-00675-g002"/>
    </fig>
    <p>In the “simple” method (<xref ref-type="fig" rid="F2">Figure 2B</xref>), the lengths of the missing 5′ and 3′ stretches of the subject sequences are computed by directly extending partial matches in HSPs by the number of unmatched bases of the query sequence on either end.</p>
    <p>The “locarna” method (<xref ref-type="fig" rid="F2">Figure 2C</xref>) starts with the sequence of extended match determined by the “simple” extension method plus <italic>o</italic><sub>loc</sub> number of nucleotides on its either end copied from the database sequence. Then, this extended sequence and the query sequence are aligned using LocaRNA P sequence alignment algorithm (<xref rid="B20" ref-type="bibr">Will et al., 2012</xref>). The ungapped stretches of the matched bases in the original HSP are used as anchors. “No gap cost for end gaps” parameter is used to ensure that the sequence is aligned with respect to the original HSP. Then, the final sequence of extended match is identified in the “locarna” alignment as the parts of the match sequence aligned with the query sequence.</p>
    <p>We have set <italic>o</italic><sub>loc</sub> = <italic>30</italic> after optimization over a set of known RNAs (see the <xref ref-type="supplementary-material" rid="DS1">Supplementary Material</xref> “Optimization of rboAnalyzer step i) -Estimation of full-length subject sequences, methods and parameters” for details).</p>
    <p>In the “meta” extension method, rboAnalyzer uses both of the above described approaches to obtain two versions of the full-length match. Then it chooses the better one of the two sequences according to a score obtained by comparison of the two full-length sequences to the covariance model for the query sequence. The covariance model is computed by RSEARCH (<xref rid="B8" ref-type="bibr">Klein and Eddy, 2003</xref>) from the query sequence and the predicted secondary structure of the query RNA. The structure is predicted by RNAFold (<xref rid="B18" ref-type="bibr">Tafer et al., 2011</xref>). The user can also choose to use either a covariance model from Rfam that best matches the query sequence, or can provide his own model directly.</p>
    <sec id="S2.SS1">
      <title>Evaluating Partial Matches Extension Methods</title>
      <p>To evaluate the performance of the methods for extension of partial matches we prepared a dataset with known RNA sequences located at known positions in the database sequence. The database sequence was constructed artificially using sequences of RNAs families in CompaRNA dataset (<xref rid="B16" ref-type="bibr">Puton et al., 2013</xref>). CompaRNA contains those Rfam families that have at least one homolog with experimentally identified structure. Of the families in CompaRNA, we used only those whose Rfam seed alignments included at least 20 homologs. The homolog with experimentally identified structure was used as a template for evaluation of the accuracy of our secondary structure prediction.</p>
      <p>The above mentioned criteria were fulfilled by the following RNA families: RF00001, RF00002, RF00005, RF00008, RF00015, RF00017, RF00020, RF00095, RF00100, RF00162, RF00167, RF00169, RF00175, RF00209, RF00230, RF00250, RF00374, RF00379, RF00380, RF00480, RF01051, RF01725, RF01739, RF01807, RF01831, RF01852, RF02095, RF02253, and RF02348. For each family, three RNA sequences were chosen randomly and set aside to be used as query sequences. The remaining sequences were used to construct an artificial subject sequence, in which they were placed one after another, separated from each other by their 1000 nucleotides long 5′ and 3′ flanking regions, forming a long single sequence. The sequences of the flanking regions were obtained from NCBI using Rfam accession numbers of appropriate RNAs. When flanking regions with 1000 nucleotides were not available, a random sequence was used to fill the missing section.</p>
      <p>Furthermore, to create decoys in the artificial subject sequence, the same RNA sequences were shuffled 10 times each, and together with their flanking regions included into the artificial subject sequence in the same way as for the original RNAs. For this artificial subject sequence, a BLAST database was build using makeblastdb program (<xref rid="B2" ref-type="bibr">Camacho et al., 2009</xref>).</p>
      <p>This database was searched by the three query RNA sequences set aside previously for each RNA family to generate BLAST outputs using blastn program with parameters: -gapopen 2 -gapextend 1 -penalty -1 -reward 1 -word_size 7. The outputs were analyzed using rboAnalyzer and only the BLAST hits of the query sequences into homologous RNAs were considered for comparison. The partial matches were extended using the three extension methods and the result of the comparison are summarized in <xref ref-type="fig" rid="F3">Figure 3</xref>.</p>
      <fig id="F3" position="float">
        <label>FIGURE 3</label>
        <caption>
          <p>Comparison of accuracy of the three methods for extending partial matches. The comparison was carried out using 29 Rfam RNA families, listed on the right side of the figure and indicated by colors. The total error on y-axis is a number of nucleotides that are either missing or are in excess in comparison to reference Rfam sequences at both 5′ and 3′ ends of estimated full-length sequences. In the case of “locarna” and “meta” the median line is located at the very bottom of the box. To compare the accuracy of each of the three methods we used Mann–Whitney <italic>U</italic> test. The differences were significant between “simple” and “locarna” (<italic>p</italic> &lt; 0.001) and between “simple” and “meta” (<italic>p</italic> &lt; 0.001) methods, while the difference between “locarna” and “meta” was not significant (<italic>p</italic> = 0.34), saying that the “simple” method had the worst accuracy of the three methods, while accuracy of the “meta” and “locarna” was similar. We therefore chose the “locarna” method as the default method as its accuracy is better than that of “simple” method and it is faster than “meta” method.</p>
        </caption>
        <graphic xlink:href="fgene-11-00675-g003"/>
      </fig>
      <p>The box plots in <xref ref-type="fig" rid="F3">Figure 3</xref> indicated that the “simple” extension method was least accurate. The accuracies of “meta” and “locarna” methods were comparable, but the “locarna” method was faster, as the “meta” method is a combination of “simple” and “locarna” methods. We therefore chose the “locarna” method as the default extension method (see <xref ref-type="supplementary-material" rid="DS1">Supplementary Material</xref> “Comparison of three methods for extending partial matches –<xref ref-type="fig" rid="F3">Figure 3</xref>” for sum of errors).</p>
      <p>Step 2: Identification of homology of subject RNAs</p>
      <p>In this step, the homology of the subject RNAs to the query RNA was identified using sequences of extended matches of the subject RNAs. First, a covariance model of the query RNA was computed with RSEARCH, as described for the “meta” extension method in Step 1. Then, rboAnalyzer scored each of the extended matches by comparing it to the covariance model using cmalign (<xref rid="B13" ref-type="bibr">Nawrocki and Eddy, 2013</xref>). The score is a measure of the homology of the subject RNAs to the query RNA in terms of similarity of their sequences represented by their extended matches and their potential secondary structure. Based on the score, rboAnalyzer classified subject RNAs into three categories:</p>
      <disp-formula id="S2.Ex1">
        <mml:math id="M1">
          <mml:mrow>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                <mml:mtr>
                  <mml:mtd columnalign="center">
                    <mml:mi mathvariant="italic">homologous</mml:mi>
                  </mml:mtd>
                  <mml:mtd columnalign="center">
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mpadded width="+1.7pt">
                          <mml:mi>f</mml:mi>
                        </mml:mpadded>
                        <mml:mfrac>
                          <mml:mi>s</mml:mi>
                          <mml:mi>l</mml:mi>
                        </mml:mfrac>
                      </mml:mrow>
                      <mml:mo>≥</mml:mo>
                      <mml:mrow>
                        <mml:mn>0.5</mml:mn>
                        <mml:mi mathvariant="normal">∧</mml:mi>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                      <mml:mo>≥</mml:mo>
                      <mml:mn>20</mml:mn>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd columnalign="center">
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                      <mml:mi>o</mml:mi>
                      <mml:mpadded width="+1.7pt">
                        <mml:mi>t</mml:mi>
                      </mml:mpadded>
                      <mml:mi mathvariant="italic">homologous</mml:mi>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd columnalign="center">
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mpadded width="+1.7pt">
                          <mml:mi>f</mml:mi>
                        </mml:mpadded>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                      <mml:mo>&lt;</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd columnalign="center">
                    <mml:mrow>
                      <mml:mi>u</mml:mi>
                      <mml:mi>n</mml:mi>
                      <mml:mi>c</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>t</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd columnalign="center">
                    <mml:mrow>
                      <mml:mi>o</mml:mi>
                      <mml:mi>t</mml:mi>
                      <mml:mi>h</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>w</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>s</mml:mi>
                      <mml:mi>e</mml:mi>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
              <mml:mi/>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <italic>s</italic> is the score and <italic>l</italic> the length of the query sequence. The term <italic>s/l</italic> ≥ 0.5 for “homologous” is used to guarantee that the similarity between the subject sequence and CM model of the query sequence, from which the bit score is derived, is created by at least a half of a bit per one nucleotide of the query sequence. This way we want to filter out fragments with relatively high local similarity that are not homologous. The dependence of the threshold on the length of the query sequence reflects the fact that for longer sequences the length of the fragment with locally concentrated similarity can be longer.</p>
      <p>The information about homology of subject RNA to the query RNA is included in the rboAnalyzer output.</p>
      <p>Step 3: Prediction of secondary structure of subject RNAs</p>
      <p>The subject RNAs are further characterized by a secondary structure predicted using their extended matches.</p>
      <p>rboAnalyzer offers 15 methods for the secondary structure prediction implemented using available algorithms and their combinations in order to efficiently exploit the information in the BLAST output. The list and brief description of each method is outlined in <xref rid="T1" ref-type="table">Table 1</xref> (for more details, see <xref ref-type="supplementary-material" rid="FS1">Supplementary Table S2</xref> and online documentation).</p>
      <table-wrap id="T1" position="float">
        <label>TABLE 1</label>
        <caption>
          <p>List of secondary structure prediction methods implemented in rboAnalyzer with brief description and advantages/disadvantages related to prediction of secondary structures for full matches.</p>
        </caption>
        <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
          <thead>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Method name (category*)</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Brief description</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Advantages (+)/disadvantages (–)</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">rnafold (2)</td>
              <td valign="top" align="left" rowspan="1" colspan="1"><italic>de novo</italic> prediction by RNAfold</td>
              <td valign="top" align="left" rowspan="1" colspan="1">+ Fast<break/>+ Universal<break/>− Single sequence prediction that do not employ any additional information from BLAST output</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">C-A-r-Rc (1)/ M-A-r-Rc (1)</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Uses conserved base pairs in consensus secondary structure built from MSA of conserved full matches extended from HSPs in BLAST output to add information to RNAfold prediction</td>
              <td valign="top" align="left" rowspan="1" colspan="1">+ Information about conserved base pairs carried to individual structure prediction<break/>−Good alignment for consensus structure prediction may be hard to obtain especially when the BLAST output was from restricted search space</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">C-A-U-r-Rc (1)/ M-A-U-r-Rc (1)</td>
              <td valign="top" align="left" rowspan="1" colspan="1">The same as for C-A-r-Rc/M-A-r-Rc, but uses conserved unpaired bases</td>
              <td valign="top" align="left" rowspan="1" colspan="1">The same as for C-A-r-Rc/M-A-r-Rc, but applying to the conserved unpaired bases</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">rfam-Rc (2)</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Uses consensus structure from covariance model to add information to RNAfold prediction</td>
              <td valign="top" align="left" rowspan="1" colspan="1">+ Based on curated information from either Rfam or user<break/>−Can’t be used when the covariance model with secondary structure is not available</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">rfam-centroid (2)</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Uses sequence information from covariance model for CentroidHomfold prediction</td>
              <td valign="top" align="left" rowspan="1" colspan="1">+ Based on curated information from either Rfam or user<break/>−Can’t be used when the covariance model is not available</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">C-A-sub (1)/ M-A-sub (1)</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Uses consensus secondary structure built from MSA of conserved full matches extended from HSPs in BLAST output to select the best of suboptimal secondary structures generated by hybrid-ss-min prediction</td>
              <td valign="top" align="left" rowspan="1" colspan="1">+ Suboptimal secondary structure may provide better prediction then minimum free energy (MFE) predictions<break/>−Good alignment for consensus structure prediction may be hard to obtain especially when the BLAST output was from restricted search space</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">rfam-sub (2)</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Uses consensus secondary structure from covariance model to select the best of suboptimal secondary structures generated by hybrid-ss-min prediction</td>
              <td valign="top" align="left" rowspan="1" colspan="1">+ Suboptimal secondary structures may provide better prediction then MFE predictions<break/>−Can’t be used when the covariance model with secondary structure is not available</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">fq-sub (2)</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Secondary structure of query sequence predicted by RNAfold is used to select the best of suboptimal secondary structures generated by hybrid-ss-min prediction</td>
              <td valign="top" align="left" rowspan="1" colspan="1">+ Useful when secondary structure predicted by RNAfold is correct<break/>+ Suboptimal secondary structures may provide better prediction then MFE predictions<break/>−No additional information from BLAST output is used</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">centroid (1)/centroid-fast (1)</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Uses sequence information from full-length matches (either conserved or first few) for CentroidHomfold secondary structure prediction</td>
              <td valign="top" align="left" rowspan="1" colspan="1">+ Design of CentroidHomfold well suited for this task</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">TurboFold (1)/Turbo-fast (1)</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Uses sequence information from full-length matches (either conserved or first few) for TurboFold secondary structure prediction</td>
              <td valign="top" align="left" rowspan="1" colspan="1">+ Best performing without reference data<sup>†</sup><break/>− Slow<break/>− Memory demanding<break/>− Can’t be used when sequence contains ambiguous bases</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <attrib>
            <italic>*The categories are defined in Step 3: Prediction of secondary structure of subject RNAs section. <sup>†</sup>See <xref ref-type="supplementary-material" rid="DS1">Supplementary Material</xref> “Comparison of methods for prediction of secondary structures from estimated full-length sequences”.</italic>
          </attrib>
        </table-wrap-foot>
      </table-wrap>
      <p>There are two broad categories of structure prediction methods: those using multiple subject sequences from the BLAST output (category 1) and those which do not use them (category 2).</p>
      <p>The methods from the category 1 use the extended matches (Step 1) of those RNAs that were determined as homologous to the query RNA (Step 2). Among the sequences of the extended matches of these RNAs, each prediction method selects sequences which it will use as reference sequences for prediction. The selection is based on individually optimized threshold for similarity of the sequences to the query. rboAnalyzer also does not use sequences that are either identical or very similar to the query as they can distort prediction. The level of the sequence similarity is determined by the parameter optimized individually for each of the methods.</p>
      <p>The sequences are used in two ways depending on the prediction methods:</p>
      <list list-type="simple">
        <list-item>
          <label>(a)</label>
          <p>to build a reference consensus secondary structure using RNAalifold (<xref rid="B1" ref-type="bibr">Bernhart et al., 2008</xref>) with the multiple sequence alignment made by Clustal Omega (<xref rid="B17" ref-type="bibr">Sievers et al., 2011</xref>) or muscle (<xref rid="B4" ref-type="bibr">Edgar, 2004</xref>), followed by refold.pl (<xref rid="B18" ref-type="bibr">Tafer et al., 2011</xref>)/RNAfold –C (<xref rid="B9" ref-type="bibr">Lorenz et al., 2016</xref>), or UNAfold (<xref rid="B10" ref-type="bibr">Markham and Zuker, 2008</xref>);</p>
        </list-item>
        <list-item>
          <label>(b)</label>
          <p>to serve as reference sequences by the methods based on TurboFold (<xref rid="B19" ref-type="bibr">Tan et al., 2017</xref>) or CentroidHomfold (<xref rid="B5" ref-type="bibr">Hamada et al., 2009</xref>).</p>
        </list-item>
      </list>
      <p>The methods belonging to the category 2 include RNAfold, which is a <italic>de novo</italic> prediction method, then prediction methods that use covariance models identified in Rfam, and finally, a prediction method that uses RNAfold to predict secondary structure of the query RNA, which is then used as a structural template for finding a best matching structure among suboptimal structures of subject RNA predicted by UNAfold.</p>
    </sec>
  </sec>
  <sec id="S3">
    <title>Results</title>
    <sec id="S3.SS1">
      <title>Default Values of rboAnalyzer Parameters</title>
      <p>The default set-up for rboAnalyzer includes “locarna” method for extension of partial matches and three methods for the secondary structure prediction, RNAfold, TurboFold, and rfam-Rc (which is a shortcut for RNAfold –C with a Rfam consensus structure as constraint). TurboFold was chosen as it performed best of all the prediction methods. RNAfold was chosen as a standard with minimum input providing an output under any conditions. RNAfold –C with a Rfam consensus structure as constraint was chosen as a representative of the methods using information from an external source. The three selected methods were chosen as they are based on different prediction principles and guarantee that the user gets most accurate prediction available. The secondary structure prediction methods performance test is summarized in <xref ref-type="supplementary-material" rid="FS1">Supplementary Table S3</xref>.</p>
      <p>rboAnalyzer has numerous parameters that belong to the algorithms used for its construction. Their default values were optimized using RNAs with experimentally identified secondary structures. The list of the parameters and the algorithms used in rboAnalyzer and the details about the parameter optimization are described in the <xref ref-type="supplementary-material" rid="DS1">Supplementary Material</xref> “Optimization of rboAnalyzer parameters.”</p>
    </sec>
    <sec id="S3.SS2">
      <title>Test of rboAnalyzer Performance</title>
      <p>Here, the performance of rboAnalyzer with respect to the quality of HSPs in a BLAST output was tested.</p>
      <p>We first created a synthetic sequence database from the sequences of the RNA families selected using the criteria described in the “Evaluating partial matches extension methods” section above.</p>
      <p>For each RNA family we downloaded sequences from CompaRNA dataset which were then used as queries for BLAST. Then we extracted sequences from Rfam seed alignment for each RNA family that were used as known homologs. For each of them we downloaded its parent sequence from NCBI that were placed between sequences of its randomly shuffled 500 nucleotide long 5′ and 3′ flanking regions. These sequences were used to construct a BLAST database, in which the query RNAs with experimentally identified structures were searched with blastn program (parameters: -gapopen 2 -gapextend 1 -penalty -1 -reward 1 -word_size 7) obtaining BLAST outputs. For the families that included more than one RNA with experimentally identified secondary structure, more than one BLAST output were obtained and of them the one with the largest number of matches to the sequences from Rfam seed alignments was used for further analysis.</p>
      <p>Matches in each BLAST output were sorted into three groups according to their quality. The quality was defined as high, moderate and low and the thresholds were set so that each of the three groups contained equal number of matches to the sequences from Rfam seed alignments. Finally, the groups were used to form new synthetic BLAST outputs resulting into three synthetic outputs for each of the original BLAST outputs. These synthetic outputs were analyzed by rboAnalyzer to find out how its performance depends on the quality of BLAST outputs.</p>
      <p>The performance was measured by structural similarity between the secondary structures of subject RNAs predicted using sequences of their extended partial matches and the experimentally identified structures of the query RNAs. In this test, the subject RNAs and the query RNAs were known to be homologous as they came from the same families, and therefore the predicted secondary structures and experimentally identified structures should be similar if the rboAnalyzer characterizing pipeline was correct and accurate. The higher the similarity, the higher the overall performance of rboAnalyzer, because the secondary structure prediction is the final step of rboAnalyzer and therefore depends on the performance of the previous steps.</p>
      <p>The results of the test were summarized in <xref ref-type="fig" rid="F4">Figure 4</xref>. The rather flat curves showed steady rboAnalyzer performance regardless of the quality of HSPs in input BLAST outputs. This indicated that rboAnalyzer is robust and capable to produce accurate secondary structures even for short partial matches of subject RNAs.</p>
      <fig id="F4" position="float">
        <label>FIGURE 4</label>
        <caption>
          <p>A test of rboAnalyzer performance depending on quality of BLAST HSPs. The performance was measured using quality of predicted secondary structures. The secondary structure prediction is the last step of the rboAnalyzer analysis and therefore depends on the quality of all the previous steps, thus reflecting an overall rboAnalyzer performance. The quality was computed by matching the predicted secondary structures to their experimentally identified templates. The test was performed using RNAs from selected Rfam families that were searched by BLAST in a database that we constructed using the Rfam RNAs. Full length sequences of the Rfam RNAs were extended by rboAnalyzer from their partial matches in BLAST HSPs. The HSPs were assigned one of three levels of quality based on BLAST bit score: high, moderate and low. For definition of the quality levels, refer to the <italic>Test of rboAnalyzer performance</italic> subsection of the Results section. The HSPs depending on their assigned quality level were copied from the original, native BLAST output into one of three artificially constructed BLAST outputs. The outputs were three, physically three files, each containing HSPs only of one quality level. From partial matches in HSPs in these three outputs, the RNAs were reconstructed by rboAnalyzer. The HSP quality levels referring to the three outputs are shown on the horizontal axis in panels <bold>(A,B)</bold>. The quality of predicted secondary structures shown on the vertical axis in panels <bold>(A,B)</bold> is measured as a mean of tree edit distances [RNAdistance (<xref rid="B18" ref-type="bibr">Tafer et al., 2011</xref>)] between the predicted secondary structures of subject RNAs and experimentally identified structures in the test Rfam families. Each of the families contained at least one experimentally identified structure used as a structure template. Note that the lower the mean (vertical axis), the higher the structure similarity, as the similarity is measured using the tree edit distance. Therefore, lower values on vertical axis indicate a higher quality and a better overall rboAnalyzer performance. The colors of the curves in both panels indicate either a secondary structure prediction method <bold>(A)</bold> or a test Rfam RNA family <bold>(B)</bold>. The colors are defined on the right hand side of the panels. Panel <bold>(A)</bold> shows rboAnalyzer performance depending on the secondary structure prediction methods. In the graph, the tree edit distances of individual RNAs were averaged for individual prediction methods across the Rfam families. The tree edit distances were normalized to the length of respective query sequences. Panel <bold>(B)</bold> shows performance depending on test Rfam families. In the graph, the tree edit distances were averaged for individual Rfam families across the prediction methods. The error bars on the curves in the both panels represent 95% intervals from 100 bootstrap iterations. The families RF00095, RF00175, RF00230, RF01739, and RF01807 did not have enough matches into the sequences from Rfam seed alignments to divide their BLAST outputs to the three parts according to the quality of HSPs and therefore were excluded from the analysis.</p>
        </caption>
        <graphic xlink:href="fgene-11-00675-g004"/>
      </fig>
    </sec>
  </sec>
  <sec id="S4">
    <title>Example Usage of rboAnalyzer</title>
    <p>We demonstrate the use of rboAnalyzer on four examples (<xref ref-type="fig" rid="F5">Figures 5-8</xref>) for various scenarios of the rboAnalyzer use. The BLAST searches for rboAnalyzer demonstration were done at NCBI BLAST web server. The parameters of the searches are described in section “Results” of the <xref ref-type="supplementary-material" rid="DS1">Supplementary Material</xref>.</p>
    <fig id="F5" position="float">
      <label>FIGURE 5</label>
      <caption>
        <p>Snapshots of three example matches from output of BLAST search for <italic>Mycobacterium smegmatis</italic> ms1 RNA homologs, characterized by rboAnalyzer. Each of the three panels <bold>(A–C)</bold> contains from upper left corner to the right bottom corner following: ID and name of subject sequence, HSP with a partial match of the query sequence in the subject sequence, HSP characteristics, position of the full match of the subject RNA on a database subject sequence, homology of subject RNA identified by rboAnalyzer, full match sequence identified by rboAnalyzer by extension of HSP partial match, predicted secondary structures of subject RNA using its full match and depiction of the full match using NCBI genome browser.</p>
      </caption>
      <graphic xlink:href="fgene-11-00675-g005"/>
    </fig>
    <p>The number of HSPs in the BLAST outputs used for demonstration and time taken for the rboAnalyzer to run is shown in <xref rid="T2" ref-type="table">Table 2</xref>.</p>
    <table-wrap id="T2" position="float">
      <label>TABLE 2</label>
      <caption>
        <p>Summary of the examples of rboAnalyzer usage.</p>
      </caption>
      <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
        <thead>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">RNA Family</td>
            <td valign="top" align="center" rowspan="1" colspan="1">HSPs</td>
            <td valign="top" align="center" rowspan="1" colspan="1">Time taken (min)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">Time taken without TurboFold based method (min)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">Supplementary file with full outputs</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Ms1</td>
            <td valign="top" align="center" rowspan="1" colspan="1">146</td>
            <td valign="top" align="center" rowspan="1" colspan="1">23</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2</td>
            <td valign="top" align="center" rowspan="1" colspan="1">MS1.zip</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">TR</td>
            <td valign="top" align="center" rowspan="1" colspan="1">89</td>
            <td valign="top" align="center" rowspan="1" colspan="1">38</td>
            <td valign="top" align="center" rowspan="1" colspan="1">11</td>
            <td valign="top" align="center" rowspan="1" colspan="1">TR.zip</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">U2</td>
            <td valign="top" align="center" rowspan="1" colspan="1">44</td>
            <td valign="top" align="center" rowspan="1" colspan="1">21</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2</td>
            <td valign="top" align="center" rowspan="1" colspan="1">u2.zip</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">MYB IRES</td>
            <td valign="top" align="center" rowspan="1" colspan="1">41</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2</td>
            <td valign="top" align="center" rowspan="1" colspan="1">0.5</td>
            <td valign="top" align="center" rowspan="1" colspan="1">MYB.zip</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>In the examples, most of the computation time was used by TurboFold or the Turbofold-based method TurboFast for prediction of secondary structures, so we also report running times without using TurboFast. The characterization of the TR BLAST output was relatively slow in spite of less number of characterized HSPs, as TR is relatively large, e.g., much larger than ms1 RNA from the first example. On the contrary, characterization of MYB IRES was relatively fast, as MYB IRES is a relatively short RNA.</p>
    <sec id="S4.SS1">
      <title>ms1 RNA</title>
      <p>The first example demonstrates a common usage of rboAnalyzer; a characterization of HSPs in the output of BLAST search for the homologs of <italic>Mycobacterium smegmatis</italic> ms1 RNA in <italic>Actinobacteria</italic> (<xref ref-type="fig" rid="F5">Figure 5</xref>). We chose three example HSPs for <xref ref-type="fig" rid="F5">Figure 5</xref>, one with a high quality (BLAST <italic>E</italic>-value = 4.32 × 10<sup>–16</sup>; <xref ref-type="fig" rid="F5">Figure 5A</xref>) and two with low qualities (both with BLAST <italic>E</italic>-values = 2.39; <xref ref-type="fig" rid="F5">Figures 5B,C</xref>). The high quality HSP (<xref ref-type="fig" rid="F5">Figure 5A</xref>) is an example of the ideal situation. The HSP covers a substantial part of the query sequence with relatively few gaps indicating strong similarity between sequences of query and subject RNAs and thus suggesting their homology, which indeed was identified by rboAnalyzer. The high sequence similarity led to an accurately extended full match that made it possible to predict accurate secondary structures that were best represented by Turbofold and rfam-Rc prediction in <xref ref-type="fig" rid="F5">Figure 5A</xref>.</p>
      <p>The remaining two HSPs, shown in <xref ref-type="fig" rid="F5">Figures 5B,C</xref>, represented homologous and non-homologous RNAs, respectively. The homology was correctly identified by rboAnalyzer. Indeed, ms1 RNA is an exclusively bacterial RNA (<xref rid="B15" ref-type="bibr">Pánek et al., 2010</xref>) and the latter, non-homologous HSP (<xref ref-type="fig" rid="F5">Figure 5C</xref>) was in eukaryotic species.</p>
      <p>Further demonstrating capabilities of rboAnalyzer, the extended match for the HSP in <xref ref-type="fig" rid="F5">Figure 5B</xref> was accurately estimated although the HSP was a short fragment that covered only 50 nucleotides out of ∼300 nucleotides of the query sequence with numerous gaps. Consequently, the secondary structure of the subject RNA was predicted correctly showing similarity to the ms1 RNA structure (here represented best by the predicted secondary structures in <xref ref-type="fig" rid="F5">Figure 5A</xref>). The Turbofold prediction was more accurate than the RNAfold prediction (cf. predictions denoted Turbofold and rnafold in <xref ref-type="fig" rid="F5">Figure 5B</xref>). It is because Turbofold uses multiple sequences, while RNAfold single sequences only. It is advantageous to use Turbofold here, as the multiple sequences of the extended matches of homologous RNAs found in a BLAST output can be used for its input.</p>
      <p>The predicted secondary structures for the non-homologous HSP (<xref ref-type="fig" rid="F5">Figure 5C</xref>) were inaccurate, i.e., dissimilar to the ms1 RNA secondary structure, as the subject sequence did not represent homologous RNA.</p>
    </sec>
    <sec id="S4.SS2">
      <title>TR (Telomerase RNA)</title>
      <p>The second example (<xref ref-type="fig" rid="F6">Figure 6</xref>) demonstrates the use of the alternative methods for secondary structure prediction implemented in rboAnalyzer. It uses BLAST search for <italic>Rhizoprionodon porosus</italic> TR homologs in vertebrates.</p>
      <fig id="F6" position="float">
        <label>FIGURE 6</label>
        <caption>
          <p>Snapshots of rboAnalyzer output for characterization of the output of BLAST search for <italic>Rhizoprionodon porosus</italic> TR homologs. For description of the items in the both panels <bold>(A,B)</bold>, see the legend of <xref ref-type="fig" rid="F5">Figure 5</xref>.</p>
        </caption>
        <graphic xlink:href="fgene-11-00675-g006"/>
      </fig>
      <p>For the demonstration purposes we chose a hit into <italic>Mustelus canis</italic> TR evaluated by rboAnalyzer (<xref ref-type="fig" rid="F6">Figure 6</xref>). The secondary structure of <italic>Mustelus canis</italic> TR predicted using default prediction methods in rboAnalyzer, i.e., RNAfold, TurboFold, and rfam-Rc, were dissimilar to each other (<xref ref-type="fig" rid="F6">Figure 6A</xref>). The dissimilarity should give the user a clue that the result is not robust and needs further investigation.</p>
      <p>In such an uncertain situation, the user can re-examine the HSP using alternative methods for secondary structure prediction and check if they produce similar secondary structures that will help to identify the RNA.</p>
      <p>In this example, we chose centroid, fq-sub and C-A-r-Rc methods. They predicted similar secondary structures that were also similar to a reference, experimentally identified TR structure [found, e.g., in rPredictorDB database (<xref rid="B7" ref-type="bibr">Jelínek et al., 2019</xref>)].</p>
      <p>The similarity obtained with the alternative methods suggested that the hit was a TR RNA homolog. If the structures were dissimilar again, it would be a clue that the hit most likely represented rather than a TR RNA homolog, a non-homologous RNA or non-physiological artifact RNA sequence.</p>
    </sec>
    <sec id="S4.SS3">
      <title>u2 RNA</title>
      <p>The following two examples demonstrate the use of the information computed by rboAnalyzer to infer the homology of subject RNAs represented by their partial matches to the query RNA. The following example (<xref ref-type="fig" rid="F7">Figure 7</xref>) is a characterization of BLAST output of a search for homologs of the human u2 RNA in <italic>Cnidaria</italic>. <xref ref-type="fig" rid="F7">Figure 7</xref> shows three HSPs of human u2 RNA in <italic>Cnidaria</italic> selected in the complete rboAnalyzer output with varying quality. The first HSP represented an u2 RNA homolog, while the homology to u2 RNA of the latter two HSPs (<xref ref-type="fig" rid="F7">Figures 7B,C</xref>) was uncertain.</p>
      <fig id="F7" position="float">
        <label>FIGURE 7</label>
        <caption>
          <p>Snapshots of rboAnalyzer output for characterization of the output of BLAST output of a search for homologs of the human u2 RNA in <italic>Cnidaria</italic>. For description of the items in panels <bold>(A–C)</bold>, see the legend of <xref ref-type="fig" rid="F5">Figure 5</xref>.</p>
        </caption>
        <graphic xlink:href="fgene-11-00675-g007"/>
      </fig>
      <p>Here, to infer the homology, the user can use the predicted secondary structures obtained using full-length subject sequences reconstructed from the partial hits. In this case, the structures showed similarity to the predicted secondary structures of the u2 RNA homolog in <xref ref-type="fig" rid="F7">Figure 7A</xref>, thus indicating that both HSPs may represent u2 RNA homologs. Also, the sequence viewer for the two uncertain HSPs, showed that the two HSPs belong to the RF00004 family (not shown) which is the u2 RNA Rfam family. All this evidence led to the conclusion that the two HSPs were indeed u2 homologs.</p>
    </sec>
    <sec id="S4.SS4">
      <title>MYB IRES</title>
      <p>The fourth example (<xref ref-type="fig" rid="F8">Figure 8</xref>) is a characterization of BLAST output of a sequence search for the human MYB IRES homologs. It is an example of a situation, when it is hard to determine the homology of subject RNAs represented by HSPs as the HSPs had a low quality and there were not enough good sequences in the BLAST output that would serve for secondary structure prediction, as indicated in red at the bottom of the HSPs sections in <xref ref-type="fig" rid="F8">Figure 8</xref>.</p>
      <fig id="F8" position="float">
        <label>FIGURE 8</label>
        <caption>
          <p>Snapshots of rboAnalyzer output for characterization of the output of BLAST search for the human MYB IRES homologs. For description of the items in panels <bold>(A–C)</bold>, see the legend of <xref ref-type="fig" rid="F5">Figure 5</xref>.</p>
        </caption>
        <graphic xlink:href="fgene-11-00675-g008"/>
      </fig>
      <p><xref ref-type="fig" rid="F8">Figure 8A</xref> shows a HSP of the query RNA, i.e., the human MYB IRES. The other two HPSs (<xref ref-type="fig" rid="F8">Figures 8B,C</xref>) represented uncertain hits with low quality as indicated by BLAST <italic>E</italic>-values (0.385 and 0.0316) and CM bit scoring very low (8 and 19.45) compared to the <italic>E</italic>-value and CM bit score of the query RNA: 1.26 × 10<sup>–70</sup> and 196.1, respectively. The two HSPs were short and strongly gapped. They also lacked their predicted secondary structure (predicted using the rfam-Rc prediction method), as MYB IRES is not a member of Rfam database and therefore lacks its Rfam CM model. Therefore the secondary structures were predicted only by the two remaining default prediction methods, RNAfold, and Turbofold. Finally, the sequence viewer did not provide any information that would be useful for determination of the homology of the two HSPs.</p>
      <p>Nevertheless, there were two indications that these two HSPs might represent MYB IRES homologs: (1) the predicted secondary structures showed a partial similarity to the predicted secondary structure of the MYB IRES homolog shown in <xref ref-type="fig" rid="F8">Figure 8A</xref>, (2) the genomic locus in the 5′ end of genes as shown by sequence viewer is in general the genomic locus of an IRES (for an example, see the sequence viewer in <xref ref-type="fig" rid="F8">Figure 8A</xref>, which is annotated as “MYB”).</p>
      <p>While it still remained questionable whether the two HSPs represented homologous RNAs, we see that even for such extremely bad HSPs rboAnalyzer could provide hints to possible homology of subject RNAs to the query RNA that otherwise, based merely on the information in the original BLAST output, could be missed.</p>
    </sec>
  </sec>
  <sec id="S5">
    <title>Discussion and Conclusion</title>
    <p>We present rboAnalyzer, a tool for interpreting RNA sequence search outputs. It characterizes the hits in the outputs by prediction of their full-length sequences, homology to the query molecule and secondary structures. The tool is primarily aimed at non-coding RNA molecules, but can also be used with other RNAs that have defined structure (e.g., riboswitches).</p>
    <p>In our opinion, the tool is needed, because only full-length sequences allow for effective analysis of RNAs in general. The prediction and analysis of secondary structure, homology and function identification is also essential, as RNAs function only with their full-length sequences. The partial and/or gapped matches in the output of sequence search usually come without any other information than their quality. The next step naturally is the identification of full-length sequences of the matched RNAs. So far, up to our knowledge, there is no other choice than to do it manually The presented tools facilitates this task by integrating appropriate tools to one framework with rich user control and results output.</p>
    <p>By testing rboAnalyzer with BLAST outputs of varying quality we demonstrated that rboAnalyzer was able to give accurate secondary structure predictions even for HSPs that corresponded to short fragments and with low-quality HSPs.</p>
    <p>Since running rboAnalyzer on typical BLAST results takes from several minutes to about an hour, depending on the number of HSPs, the length of the query RNA and chosen prediction methods, it is suitable for analyzing small number of BLAST outputs on a personal workstation, but requires cluster-scale computational resources for larger analyses.</p>
    <p>rboAnalyzer is not suitable in situations, when subject RNAs include intronic RNA while the query RNA does not. It is because the difference between the length of the query sequence and the size of the genome locus containing the subject RNA with an intron makes it impossible to correctly extend the partial match of the subject RNA.</p>
    <p>Currently, the rboAnalyzer webserver is being developed. Also a minimal version of rboAnalyzer fast enough to be able to analyze individual HSPs in real time is under preparation and will be included in the webserver.</p>
    <p>rboAnalyzer is available under GPL 2.0 license.</p>
  </sec>
  <sec sec-type="data-availability" id="S6">
    <title>Data Availability Statement</title>
    <p>The datasets generated for this study are available on request to the corresponding author.</p>
  </sec>
  <sec id="S7">
    <title>Author Contributions</title>
    <p>JP: initiation and conception. MS: design, development, implementation, and testing. MS and JP: writing of the manuscript. MS, MM, JV, and JP: proofreading and discussion. All authors contributed to the article and approved the submitted version.</p>
  </sec>
  <sec id="conf1">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> This work was supported by ELIXIR CZ research infrastructure project (MEYS Grant No. LM2015047) and European Regional Development Fund – Project “ELIXIR-CZ: Budování kapacit” (No. CZ.02.1.01/0.0/0.0/16_013/0001777).</p>
    </fn>
  </fn-group>
  <fn-group>
    <fn id="footnote1">
      <label>1</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://palletsprojects.com/p/jinja/">https://palletsprojects.com/p/jinja/</ext-link>
      </p>
    </fn>
  </fn-group>
  <sec id="S9" sec-type="supplementary material">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/articles/10.3389/fgene.2020.00675/full#supplementary-material">https://www.frontiersin.org/articles/10.3389/fgene.2020.00675/full#supplementary-material</ext-link></p>
    <supplementary-material content-type="local-data" id="FS1">
      <media xlink:href="Data_Sheet_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="DS1">
      <media xlink:href="Data_Sheet_1.ZIP">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="DS2">
      <media xlink:href="Data_Sheet_2.ZIP">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="DS3">
      <media xlink:href="Data_Sheet_3.ZIP">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="DS4">
      <media xlink:href="Data_Sheet_4.ZIP">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernhart</surname><given-names>S. H.</given-names></name><name><surname>Hofacker</surname><given-names>I. L.</given-names></name><name><surname>Will</surname><given-names>S.</given-names></name><name><surname>Gruber</surname><given-names>A. R.</given-names></name><name><surname>Stadler</surname><given-names>P. F.</given-names></name></person-group> (<year>2008</year>). <article-title>RNAalifold: improved consensus structure prediction for RNA alignments.</article-title>
<source><italic>BMC Bioinformatics</italic></source>
<volume>9</volume>:<issue>474</issue>. <pub-id pub-id-type="doi">10.1186/1471-2105-9-474</pub-id>
<?supplied-pmid 19014431?><pub-id pub-id-type="pmid">19014431</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Camacho</surname><given-names>C.</given-names></name><name><surname>Coulouris</surname><given-names>G.</given-names></name><name><surname>Avagyan</surname><given-names>V.</given-names></name><name><surname>Ma</surname><given-names>N.</given-names></name><name><surname>Papadopoulos</surname><given-names>J.</given-names></name><name><surname>Bealer</surname><given-names>K.</given-names></name><etal/></person-group> (<year>2009</year>). <article-title>BLAST plus: architecture and applications.</article-title>
<source><italic>BMC Bioinformatics</italic></source>
<volume>10</volume>:<issue>421</issue>. <pub-id pub-id-type="doi">10.1186/1471-2105-10-421</pub-id>
<?supplied-pmid 20003500?><pub-id pub-id-type="pmid">20003500</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cock</surname><given-names>P. J. A.</given-names></name><name><surname>Antao</surname><given-names>T.</given-names></name><name><surname>Chang</surname><given-names>J. T.</given-names></name><name><surname>Chapman</surname><given-names>B. A.</given-names></name><name><surname>Cox</surname><given-names>C. J.</given-names></name><name><surname>Dalke</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2009</year>). <article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics.</article-title>
<source><italic>Bioinformatics</italic></source>
<volume>25</volume>
<fpage>1422</fpage>–<lpage>1423</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp163</pub-id>
<?supplied-pmid 19304878?><pub-id pub-id-type="pmid">19304878</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname><given-names>R. C.</given-names></name></person-group> (<year>2004</year>). <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput.</article-title>
<source><italic>Nucleic Acids Res.</italic></source>
<volume>32</volume>
<fpage>1792</fpage>–<lpage>1797</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id>
<?supplied-pmid 15034147?><pub-id pub-id-type="pmid">15034147</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamada</surname><given-names>M.</given-names></name><name><surname>Sato</surname><given-names>K.</given-names></name><name><surname>Kiryu</surname><given-names>H.</given-names></name><name><surname>Mituyama</surname><given-names>T.</given-names></name><name><surname>Asai</surname><given-names>K.</given-names></name></person-group> (<year>2009</year>). <article-title>Predictions of RNA secondary structure by combining homologous sequence information.</article-title>
<source><italic>Bioinformatics</italic></source>
<volume>25</volume>
<fpage>i330</fpage>–<lpage>i338</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp228</pub-id>
<?supplied-pmid 19478007?><pub-id pub-id-type="pmid">19478007</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunter</surname><given-names>J. D.</given-names></name></person-group> (<year>2007</year>). <article-title>Matplotlib: a 2D graphics environment.</article-title>
<source><italic>Comput. Sci. Eng.</italic></source>
<volume>9</volume>
<fpage>90</fpage>–<lpage>95</lpage>. <pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jelínek</surname><given-names>J.</given-names></name><name><surname>Hoksza</surname><given-names>D.</given-names></name><name><surname>Hajiè</surname><given-names>J.</given-names></name><name><surname>Pešek</surname><given-names>J.</given-names></name><name><surname>Drozen</surname><given-names>J.</given-names></name><name><surname>Hladík</surname><given-names>T.</given-names></name><etal/></person-group> (<year>2019</year>). <article-title>rPredictorDB: a predictive database of individual secondary structures of RNAs and their formatted plots.</article-title>
<source><italic>Database</italic></source>
<volume>2019</volume>:<issue>baz047</issue>. <pub-id pub-id-type="doi">10.1093/database/baz047</pub-id>
<?supplied-pmid 31032840?><pub-id pub-id-type="pmid">31032840</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname><given-names>R. J.</given-names></name><name><surname>Eddy</surname><given-names>S. R.</given-names></name></person-group> (<year>2003</year>). <article-title>RSEARCH: finding homologs of single structured RNA sequences.</article-title>
<source><italic>BMC Bioinformatics</italic></source>
<volume>4</volume>:<issue>44</issue>. <pub-id pub-id-type="doi">10.1186/1471-2105-4-44</pub-id>
<?supplied-pmid 14499004?><pub-id pub-id-type="pmid">14499004</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lorenz</surname><given-names>R.</given-names></name><name><surname>Hofacker</surname><given-names>I. L.</given-names></name><name><surname>Stadler</surname><given-names>P. F.</given-names></name></person-group> (<year>2016</year>). <article-title>RNA folding with hard and soft constraints.</article-title>
<source><italic>Algorithms Mol. Biol.</italic></source>
<volume>11</volume>:<issue>8</issue>. <pub-id pub-id-type="doi">10.1186/s13015-016-0070-z</pub-id>
<?supplied-pmid 27110276?><pub-id pub-id-type="pmid">27110276</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Markham</surname><given-names>N. R.</given-names></name><name><surname>Zuker</surname><given-names>M.</given-names></name></person-group> (<year>2008</year>). <article-title>UNAFold: software for nucleic acid folding and hybridization.</article-title>
<source><italic>Methods Mol. Biol.</italic></source>
<volume>453</volume>, <fpage>3</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">18712296</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>McKinney</surname><given-names>W.</given-names></name></person-group> (<year>2010</year>). “<article-title>Data structures for statistical computing in python</article-title>,” in <source><italic>Proceedings of the 9th Python in Science Conference</italic></source>, <role>eds</role>
<person-group person-group-type="editor"><name><surname>van der Walt</surname><given-names>S.</given-names></name><name><surname>Millman</surname><given-names>J.</given-names></name></person-group>, (<publisher-loc>Austin, TX</publisher-loc>), <fpage>51</fpage>–<lpage>56</lpage>.</mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nawrocki</surname><given-names>E. P.</given-names></name><name><surname>Burge</surname><given-names>S. W.</given-names></name><name><surname>Bateman</surname><given-names>A.</given-names></name><name><surname>Daub</surname><given-names>J.</given-names></name><name><surname>Eberhardt</surname><given-names>R. Y.</given-names></name><name><surname>Eddy</surname><given-names>S. R.</given-names></name><etal/></person-group> (<year>2015</year>). <article-title>Rfam 12.0: updates to the RNA families database.</article-title>
<source><italic>Nucleic Acids Res.</italic></source>
<volume>43</volume>
<fpage>D130</fpage>–<lpage>D137</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gku1063</pub-id>
<?supplied-pmid 25392425?><pub-id pub-id-type="pmid">25392425</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nawrocki</surname><given-names>E. P.</given-names></name><name><surname>Eddy</surname><given-names>S. R.</given-names></name></person-group> (<year>2013</year>). <article-title>Infernal 1.1: 100-fold faster RNA homology searches.</article-title>
<source><italic>Bioinformatics</italic></source>
<volume>29</volume>
<fpage>2933</fpage>–<lpage>2935</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt509</pub-id>
<?supplied-pmid 24008419?><pub-id pub-id-type="pmid">24008419</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Oliphant</surname><given-names>T. E.</given-names></name></person-group> (<year>2006</year>). <source><italic>A guide to NumPy.</italic></source>
<publisher-loc>Ho Chi Minh City</publisher-loc>: <publisher-name>Trelgol Publishing USA.</publisher-name></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pánek</surname><given-names>J.</given-names></name><name><surname>Krásnı</surname><given-names>L.</given-names></name><name><surname>Bobek</surname><given-names>J.</given-names></name><name><surname>Ježková</surname><given-names>E.</given-names></name><name><surname>Korelusová</surname><given-names>J.</given-names></name><name><surname>Vohradskı</surname><given-names>J.</given-names></name></person-group> (<year>2010</year>). <article-title>The suboptimal structures find the optimal RNAs: homology search for bacterial non-coding RNAs using suboptimal RNA structures.</article-title>
<source><italic>Nucleic Acids Res.</italic></source>
<volume>39</volume>
<fpage>3418</fpage>–<lpage>3426</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkq1186</pub-id>
<?supplied-pmid 21193488?><pub-id pub-id-type="pmid">21193488</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Puton</surname><given-names>T.</given-names></name><name><surname>Kozlowski</surname><given-names>L. P.</given-names></name><name><surname>Rother</surname><given-names>K. M.</given-names></name><name><surname>Bujnicki</surname><given-names>J. M.</given-names></name></person-group> (<year>2013</year>). <article-title>CompaRNA: a server for continuous benchmarking of automated methods for RNA secondary structure prediction.</article-title>
<source><italic>Nucleic Acids Res.</italic></source>
<volume>41</volume>
<fpage>4307</fpage>–<lpage>4323</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkt101</pub-id>
<?supplied-pmid 23435231?><pub-id pub-id-type="pmid">23435231</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sievers</surname><given-names>F.</given-names></name><name><surname>Wilm</surname><given-names>A.</given-names></name><name><surname>Dineen</surname><given-names>D.</given-names></name><name><surname>Gibson</surname><given-names>T. J.</given-names></name><name><surname>Karplus</surname><given-names>K.</given-names></name><name><surname>Li</surname><given-names>W.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>Fast, scalable generation of high-quality protein multiple sequence alignments using Clustal Omega.</article-title>
<source><italic>Mol. Syst. Biol.</italic></source>
<volume>7</volume>:<issue>539</issue>. <pub-id pub-id-type="doi">10.1038/msb.2011.75</pub-id>
<?supplied-pmid 21988835?><pub-id pub-id-type="pmid">21988835</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tafer</surname><given-names>H.</given-names></name><name><surname>Höner zu Siederdissen</surname><given-names>C.</given-names></name><name><surname>Stadler</surname><given-names>P. F.</given-names></name><name><surname>Bernhart</surname><given-names>S. H.</given-names></name><name><surname>Hofacker</surname><given-names>I. L.</given-names></name><name><surname>Lorenz</surname><given-names>R.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>ViennaRNA Package 2.0.</article-title>
<source><italic>Algorithms Mol. Biol.</italic></source>
<volume>6</volume>:<issue>26</issue>. <pub-id pub-id-type="doi">10.1186/1748-7188-6-26</pub-id>
<?supplied-pmid 22115189?><pub-id pub-id-type="pmid">22115189</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tan</surname><given-names>Z.</given-names></name><name><surname>Fu</surname><given-names>Y.</given-names></name><name><surname>Sharma</surname><given-names>G.</given-names></name><name><surname>Mathews</surname><given-names>D. H.</given-names></name></person-group> (<year>2017</year>). <article-title>TurboFold II: RNA structural alignment and secondary structure prediction informed by multiple homologs.</article-title>
<source><italic>Nucleic Acids Res.</italic></source>
<volume>45</volume>
<fpage>11570</fpage>–<lpage>11581</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkx815</pub-id>
<?supplied-pmid 29036420?><pub-id pub-id-type="pmid">29036420</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Will</surname><given-names>S.</given-names></name><name><surname>Joshi</surname><given-names>T.</given-names></name><name><surname>Hofacker</surname><given-names>I. L.</given-names></name><name><surname>Stadler</surname><given-names>P. F.</given-names></name><name><surname>Backofen</surname><given-names>R.</given-names></name></person-group> (<year>2012</year>). <article-title>LocARNA-P: accurate boundary prediction and improved detection of structural RNAs.</article-title>
<source><italic>RNA</italic></source>
<volume>18</volume>
<fpage>900</fpage>–<lpage>914</lpage>. <pub-id pub-id-type="doi">10.1261/rna.029041.111</pub-id>
<?supplied-pmid 22450757?><pub-id pub-id-type="pmid">22450757</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
