<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8290197</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giab049</article-id>
    <article-id pub-id-type="publisher-id">giab049</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
        <subject>AcademicSubjects/SCI02254</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>M<sup>2</sup>aia—Interactive, fast, and memory-efficient analysis of 2D and 3D multi-modal mass spectrometry imaging data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3148-4282</contrib-id>
        <name>
          <surname>Cordes</surname>
          <given-names>Jonas</given-names>
        </name>
        <aff><institution>Faculty of Computer Science, Mannheim University of Applied Sciences</institution>, Paul-Wittsack-Straße 10, 68163 Mannheim, <country country="DE">Germany</country></aff>
        <aff><institution>Medical Faculty Mannheim, University Heidelberg</institution>, Theodor Kutzer-Ufer 1-3, 68167 Mannheim, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1789-4090</contrib-id>
        <name>
          <surname>Enzlein</surname>
          <given-names>Thomas</given-names>
        </name>
        <aff><institution>Center for Mass Spectrometry and Optical Spectroscopy (CeMOS), Mannheim University of Applied Sciences</institution>, Paul-Wittsack-Straße 10, 68163 Mannheim, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7564-1385</contrib-id>
        <name>
          <surname>Marsching</surname>
          <given-names>Christian</given-names>
        </name>
        <aff><institution>Center for Mass Spectrometry and Optical Spectroscopy (CeMOS), Mannheim University of Applied Sciences</institution>, Paul-Wittsack-Straße 10, 68163 Mannheim, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hinze</surname>
          <given-names>Marven</given-names>
        </name>
        <aff><institution>Faculty of Computer Science, Mannheim University of Applied Sciences</institution>, Paul-Wittsack-Straße 10, 68163 Mannheim, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8816-7654</contrib-id>
        <name>
          <surname>Engelhardt</surname>
          <given-names>Sandy</given-names>
        </name>
        <aff><institution>Working Group “Artificial Intelligence in Cardiovascular Medicine” (AICM), University Hospital Heidelberg</institution>, Im Neuenheimer Feld 410, 69120 Heidelberg, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0802-6451</contrib-id>
        <name>
          <surname>Hopf</surname>
          <given-names>Carsten</given-names>
        </name>
        <aff><institution>Center for Mass Spectrometry and Optical Spectroscopy (CeMOS), Mannheim University of Applied Sciences</institution>, Paul-Wittsack-Straße 10, 68163 Mannheim, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6519-6484</contrib-id>
        <name>
          <surname>Wolf</surname>
          <given-names>Ivo</given-names>
        </name>
        <!--i.wolf@hs-mannheim.de-->
        <aff><institution>Faculty of Computer Science, Mannheim University of Applied Sciences</institution>, Paul-Wittsack-Straße 10, 68163 Mannheim, <country country="DE">Germany</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Correspondence address. Ivo Wolf, Faculty of Computer Science, Mannheim University of Applied Sciences, Paul-Wittsack-Straße 10, 68163 Mannheim, Germany. E-mail: <email>i.wolf@hs-mannheim.de</email></corresp>
    </author-notes>
    <pub-date pub-type="epub" iso-8601-date="2021-07-20">
      <day>20</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <volume>10</volume>
    <issue>7</issue>
    <elocation-id>giab049</elocation-id>
    <history>
      <date date-type="received">
        <day>01</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>6</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press GigaScience.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>Mass spectrometry imaging (MSI) is a label-free analysis method for resolving bio-molecules or pharmaceuticals in the spatial domain. It offers unique perspectives for the examination of entire organs or other tissue specimens. Owing to increasing capabilities of modern MSI devices, the use of 3D and multi-modal MSI becomes feasible in routine applications—resulting in hundreds of gigabytes of data. To fully leverage such MSI acquisitions, interactive tools for 3D image reconstruction, visualization, and analysis are required, which preferably should be open-source to allow scientists to develop custom extensions.</p>
      </sec>
      <sec id="abs2">
        <title>Findings</title>
        <p>We introduce M<sup>2</sup>aia (MSI applications for interactive analysis in MITK), a software tool providing interactive and memory-efficient data access and signal processing of multiple large MSI datasets stored in imzML format. M<sup>2</sup>aia extends MITK, a popular open-source tool in medical image processing. Besides the steps of a typical signal processing workflow, M<sup>2</sup>aia offers fast visual interaction, image segmentation, deformable 3D image reconstruction, and multi-modal registration. A unique feature is that fused data with individual mass axes can be visualized in a shared coordinate system. We demonstrate features of M<sup>2</sup>aia by reanalyzing an N-glycan mouse kidney dataset and 3D reconstruction and multi-modal image registration of a lipid and peptide dataset of a mouse brain, which we make publicly available.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusions</title>
        <p>To our knowledge, M<sup>2</sup>aia is the first extensible open-source application that enables a fast, user-friendly, and interactive exploration of large datasets. M<sup>2</sup>aia is applicable to a wide range of MSI analysis tasks.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>mass spectrometry imaging</kwd>
      <kwd>multi-modal</kwd>
      <kwd>image registration</kwd>
      <kwd>image reconstruction</kwd>
      <kwd>three-dimensional</kwd>
      <kwd>interactive visualization</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Bundesministerium für Bildung und Frauen</institution>
            <institution-id institution-id-type="DOI">10.13039/501100006603</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>13FH8I02IA</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1">
    <title>Introduction</title>
    <p>Imaging of molecular information in the spatial domain enables insights into otherwise hidden conditions and metabolic processes. Mass spectrometry imaging (MSI) represents a class of label-free and spot-wise spectrometry acquisition techniques [<xref rid="bib1" ref-type="bibr">1</xref>] and already plays an important role in a wide range of biomedical and industrial applications. It is a proven technique used for development of pharmacological agents [<xref rid="bib2" ref-type="bibr">2</xref>] or for phenotyping of pathological tissue samples [<xref rid="bib3" ref-type="bibr">3</xref>]. The spotwise imaging process results in 2D MSI data, where in each pixel a spectrum is acquired representing the relative intensities of ionizable molecular compounds covering a wide range of mass to charge (<italic toggle="yes">m</italic>/<italic toggle="yes">z</italic>) ratios.</p>
    <p>It is expected that the use of MSI techniques will increase dramatically in the future owing to the development of faster acquisition techniques and improved accuracy of MSI devices [<xref rid="bib4" ref-type="bibr">4</xref>]. The constantly growing file sizes of up to hundreds of gigabytes are a challenge for data processing, especially for interactive tasks like visualization and exploratory data analysis [<xref rid="bib5" ref-type="bibr">5</xref>].</p>
    <p>The research community can choose from a variety of software tools for MSI data [<xref rid="bib6" ref-type="bibr">6</xref>]. Interactive exploration, analysis, and processing of MSI data cannot be performed by the currently available open-source software solutions because they are not designed for an interactive scenario where low latencies and a user-friendly graphical interface are desirable. On the other hand, interactive and fast feedback is important for successful experiments, allowing early intervention by inclusion of interesting or exclusion of invalid image regions in further analysis. If blackbox-like scripts are just applied, the traceability and quality of MSI data processing steps can deteriorate. Apart from that, exporting data of intermediate steps for visualization in external tools is time consuming, error prone, and difficult to handle, especially if running on a server infrastructure.</p>
    <p>The emerging field of 3D MSI [<xref rid="bib7" ref-type="bibr">7–10</xref>] offers new perspectives into the molecular structure of biological samples. Images created by 3D mass spectrometry (MS) can be generated by combining multiple adjacent 2D MS images of consecutive cuts of a biological sample to an MS image volume by co-registration (3D image reconstruction) [<xref rid="bib5" ref-type="bibr">5</xref>,<xref rid="bib11" ref-type="bibr">11</xref>,<xref rid="bib12" ref-type="bibr">12</xref>].</p>
    <p>Multi-modal MSI can refer to (i) imaging of lipids, peptides, and proteins on adjacent tissue sections or the same tissue section [<xref rid="bib13" ref-type="bibr">13–16</xref>] with intermediate removal of the matrix [<xref rid="bib17" ref-type="bibr">17</xref>] (to apply different matrix preparation approaches) or (ii) the registration of MSI and another imaging modality like optical imaging [<xref rid="bib18" ref-type="bibr">18–21</xref>]. Registration of multi-modal data is challenging because of modality-dependent image contrasts. Especially difficult is to eliminate distortions caused by the preparation process, partial destruction in the original tissue morphology, and spatially misplaced tissue sections (rotated or placed upside down). Because it is an emerging field of research, interactive environments for (semi-) automatic 3D reconstruction or multi-modal MSI experiments do not exist yet in an openly accessible and mature form. The currently most advanced commercial solution is SCiLS Lab (Bruker Daltonik GmbH, Bremen, Germany).</p>
    <p>To recover the correct spatial relationship between corresponding images, registration methods need to be applied to perform mirroring, rigid or deformable image transformations. Open-source toolkits and command-line applications targeting intensity-based image registration are available, e.g., the Insight Toolkit (ITK) [<xref rid="bib22" ref-type="bibr">22</xref>,<xref rid="bib23" ref-type="bibr">23</xref>] and elastix [<xref rid="bib24" ref-type="bibr">24</xref>], and have been shown to be applicable to multi-modal image registration [<xref rid="bib19" ref-type="bibr">19</xref>] and 3D MSI image reconstruction [<xref rid="bib12" ref-type="bibr">12</xref>,<xref rid="bib25" ref-type="bibr">25</xref>].</p>
    <p>The results of 2D/3D MSI produce large hyper-dimensional datasets that pose computational challenges to interactive visualization, exploration, and analysis on commonly available software and hardware configurations. Software solutions for MSI are often limited by available RAM and time-consuming initialization procedures, which is especially true in the case of 3D image reconstruction where preferably all required 2D MSI datasets are accessible at the same time.</p>
    <sec id="sec1-1">
      <title>Aims</title>
      <p>We created M<sup>2</sup>aia (MSI application for interactive analysis in MITK, <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://scicrunch.org/resolver/RRID:SCR_019324" ext-link-type="uri">RRID:SCR_019324</ext-link>, <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://bio.tools/m2aia" ext-link-type="uri">biotools:m2aia</ext-link>) by integrating MSI support into the platform-independent and open-source Medical Imaging Interaction Toolkit (MITK) [<xref rid="bib28" ref-type="bibr">26</xref>]. M<sup>2</sup>aia supports the major MS image-related processing tasks required in an MSI study within a single framework. These are illustrated in Fig. <xref rid="fig1" ref-type="fig">1</xref>. M<sup>2</sup>aia supports read/write access to MSI data in the open standard format imaging mz Markup Language (imzML) [<xref rid="bib29" ref-type="bibr">27</xref>] supporting 2D/3D continuous and processed datasets, in addition to the (medical) image and image-related file formats supported by MITK. We developed M<sup>2</sup>aia with 4 main goals in mind: (i) providing a complete set of memory-efficient and fast MSI utilities for interactive data visualization, signal processing, and analysis, optionally usable for batch-processing; (ii) simultaneous handling of multiple, potentially multi-modal images with minimal memory overhead; (iii) support for user-driven 3D MS image reconstruction and multi-modal image registration; and (iv) the distribution of a community extendable and open-source code base.</p>
      <fig position="float" id="fig1">
        <label>Figure 1</label>
        <caption>
          <p>Commonly used MSI pipeline (left to right). The aim of M<sup>2</sup>aia is to provide an interactive environment with support for all image-related tasks from data import to co-registration, exploration, segmentation, and data export.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049fig1" position="float"/>
      </fig>
      <p>In contrast to applications like Galaxy [<xref rid="bib30" ref-type="bibr">28</xref>] that provide a server-side solution for non-interactive standardized processing of large MSI studies [<xref rid="bib31" ref-type="bibr">29</xref>], M<sup>2</sup>aia is designed to give a fast, visual, and interactive user response on commonly available hardware offering the aforementioned features. All main features can be accessed by means of a user-friendly graphical interface, and, therefore, no programming skills are required. Thus, the MSI extension of Galaxy [<xref rid="bib31" ref-type="bibr">29</xref>] and M<sup>2</sup>aia complement each other, offering different tools for a full-stack open-source MSI working environment.</p>
    </sec>
    <sec id="sec1-2">
      <title>The Medical Imaging Interaction Toolkit as an application and development backbone</title>
      <p>MITK [<xref rid="bib28" ref-type="bibr">26</xref>] is a popular open-source toolkit for development of interactive medical image processing applications. In essence, the MITK framework is characterized by (i) a flexible plugin-based user-interface and modular system environment; (ii) the capability of handling a wide range of 2D, 3D, and 3D+t (medical) images and image-related data such as surfaces, point sets, and image segmentations; (iii) consistent interactive visualization of multi-planar reconstructions and 3D visualizations; and (iv) a completely open-source code base built on top of ITK [<xref rid="bib22" ref-type="bibr">22</xref>, <xref rid="bib23" ref-type="bibr">23</xref>], VTK [<xref rid="bib32" ref-type="bibr">30</xref>,<xref rid="bib33" ref-type="bibr">31</xref>], and Qt [<xref rid="bib34" ref-type="bibr">32</xref>]. MITK is a cross-platform C++ toolkit and officially supports Windows, Linux, and macOS. A modular software structure allows the development of new applications decoupled from the main source tree of MITK. The Joint Imaging Platform (JIP) [<xref rid="bib35" ref-type="bibr">33</xref>] provides methods to containerize MITK, allowing it to be hosted on a scalable server infrastructure, and offers Virtual Network Computing as an interface able to stream MITK to a Web browser.</p>
    </sec>
  </sec>
  <sec id="sec2">
    <title>Findings</title>
    <p>M<sup>2</sup>aia can be considered as an interactive open-source exploration and analysis application for MSI data with the capability of 3D image reconstruction and multi-modal image registration that is extensible by the community. Figure <xref rid="fig3" ref-type="fig">2</xref> gives an impression of the graphical user interface (GUI). In the following sections we introduce the main concepts and newly implemented features that are introduced by M<sup>2</sup>aia. These features were compiled into several plugins targeting different aspects of MSI processing, including plugins for MSI import, export, signal processing, peak picking, multi-modal registration, and 3D reconstruction. All MSI-related plugins were built from scratch (except parts that incorporate third-party technologies) and highly optimized for fast reaction times and low memory overhead. Thanks to the multi-platform paradigm of MITK, binaries for multiple operating systems, including Windows- and Unix-based systems, are available. In addition, the modular system of M<sup>2</sup>aia allows the community a highly flexible development of plugins to add new functionalities and to develop command-line–based applications for batch processing.</p>
    <fig position="float" id="fig3">
      <label>Figure 2</label>
      <caption>
        <p>Graphical user interface. M<sup>2</sup>aia introduces utilities for common MSI processing tasks and new workflows for 3D reconstruction and multi-modal image registration, extending the standard features of MITK [<xref rid="bib16" ref-type="bibr">16</xref>] such as semi-automated segmentation and 2D/3D visualization. Rendered images show a multi-modal 3D reconstructed volume of APP NL-G-F mice brain lipid and peptide MALDI-TOF datasets introduced in this article. Volume rendering was applied to visualize high intensities of <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> 865 ± 0.4 Da (blue) of the 3D reconstructed lipid dataset and <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> 4070 ± 5 Da (yellow) of the 3D reconstructed peptide dataset. The plugin for controlling the import and processing of MSI data is shown on the upper right side, the peak picking plugin on the lower right corner, and the interactive spectrum view plugin on the lower left (here displaying the skyline spectrum of a lipid MS image).</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049fig3" position="float"/>
    </fig>
    <p>Finally, we provide 2 state-of-the-art use-cases. The first use-case demonstrates an <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> candidate detection task on publicly available N-linked glycan data [<xref rid="bib36" ref-type="bibr">34</xref>] (available in the PRIDE repository [<xref rid="bib37" ref-type="bibr">35</xref>]). In the second use-case we elaborate on the 3D reconstruction capabilities of M<sup>2</sup>aia using a multi-modal 3D MSI dataset of lipid and peptide acquisitions, which we make publicly available in the GigaScience respository, GigaDB [<xref rid="bib38" ref-type="bibr">36</xref>]. Especially, the interactive way of visualizing 2D/3D multi-modal image registration results with individual mass axes in a shared coordinate system is a unique feature, and, to our knowledge, M<sup>2</sup>aia is the first open-source application that offers this kind of visual interaction.</p>
    <sec id="sec2-1">
      <title>Data handling</title>
      <p>We implement support for the imzML file format (continuous-profile, continuous-centroid, and processed-centroid with external data storage in an imaging binary data [*.ibd] file). Provided that MSI data can be converted into the imzML format, M<sup>2</sup>aia is capable of processing data of various MSI devices, e.g., matrix-assisted laser desorption/ionization (MALDI), desorption electrospray ionization (DESI), or secondary ion mass spectrometry (SIMS).</p>
      <p>One challenge in MSI is the handling of computing resources. Loading tens of gigabytes of data into the computer’s memory is almost impossible without server-side processing capabilities. To face this challenge, we follow the strategy of “lazy loading,” resulting in minimal memory overhead and reaction times.</p>
      <p>Internally in M<sup>2</sup>aia the access to the imzML data is split into 2 steps. First, all necessary metadata <italic toggle="yes">M</italic> are read from the XML file (*.imzML), which contains both the image geometry information and all access information of the spectra (Fig. <xref rid="fig2" ref-type="fig">3</xref>, data processing task 1). Because the imzML files can become big XML structures (especially in 3D MSI several gigabytes), processing these files is very slow with conventional XML parsers. To overcome this problem we implemented an approach based on line-wise parsing, reducing the consumed time to a minimum. Second, an equal number of spectra are assigned to multiple threads, where each can read spectral data on demand (lazy loading) from the imaging binary data (*.ibd) container, using the metadata <italic toggle="yes">M</italic> from the first step (Fig. <xref rid="fig2" ref-type="fig">3</xref>, data processing task marked with an asterisk). From this point on, the processing time depends on the user-defined signal processing and data processing task–related steps. Loaded binary data blocks (e.g., partial spectrum data) are discarded after processing. Only the resulting numbers, e.g., the values of scaling factors, overview spectra, or pixels, are retained.</p>
      <fig position="float" id="fig2">
        <label>Figure 3</label>
        <caption>
          <p>Data flow for processing imzML files in M<sup>2</sup>aia. Fast imzML image metadata parsing (1) provides information about spectra and the image geometry. Spectra processing tasks 2–6 take advantage of the concept to assign equal parts of spectra to different threads. Each thread can trigger loading of spectra from disk (lazy loading). Signal processing can optionally be invoked. Processing task-specific reduction of thread results produces the desired output. Spectrum data are discarded after processing and only the processing results are stored to keep memory consumption low.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049fig2" position="float"/>
      </fig>
      <p>In addition to the aforementioned metadata content <italic toggle="yes">M</italic>, a set of gray-scale image artefacts <inline-formula><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{I}$\end{document}</tex-math></inline-formula> and a set of overview spectrum artefacts <inline-formula><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{S}$\end{document}</tex-math></inline-formula> are kept in memory.</p>
      <p>The set of image artefacts <inline-formula><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{I}=\lbrace {I^{\mathrm{ion}}}, {I^{\mathrm{norm}}}, {I^{\mathrm{index}}}, {I^{\mathrm{mask}}}\rbrace$\end{document}</tex-math></inline-formula> includes <italic toggle="yes">I</italic><sup>ion</sup> as placeholder image for representation of ion images (data type: double), <italic toggle="yes">I</italic><sup>norm</sup> as placeholder image of spectra-related normalization factors (data type: double), <italic toggle="yes">I</italic><sup>index</sup> as an image with pixel positions according to the spectrum ID in the imzML XML structure (data type: int), and <italic toggle="yes">I</italic><sup>mask</sup> as a binary mask indicating where valid spectrum information is accessible (data type: short). All images have the same number of pixels |<italic toggle="yes">I</italic>|.</p>
      <p>The set of overview spectra <inline-formula><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{S}=\lbrace {S^{\mathrm{skyline}}}, {S^{\mathrm{sum}}}, {S^{\mathrm{mean}}}\rbrace$\end{document}</tex-math></inline-formula> includes <italic toggle="yes">S</italic><sup>skyline</sup> as placeholder for the representation of the maximum spectrum, <italic toggle="yes">S</italic><sup>sum</sup> for the sum spectrum, and <italic toggle="yes">S</italic><sup>mean</sup> for the mean spectrum over all spectra in the image. All overview spectra have the same spectral depth |<italic toggle="yes">S</italic>| and data type double.</p>
      <p><inline-formula><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{I}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{S}$\end{document}</tex-math></inline-formula> are generated once during the initialization of an MSI image in M<sup>2</sup>aia and are held in memory as long as the MSI image is loaded. These artefacts require only a fraction of memory compared to loading the whole MSI spectra data. Data items are illustrated in Fig. <xref rid="fig2" ref-type="fig">3</xref>.</p>
      <p>The total memory <italic toggle="yes">E</italic> required for imaging and spectral data can be approximated with respect to the number of pixels of a placeholder image |<italic toggle="yes">I</italic>|, spectrum depth |<italic toggle="yes">S</italic>|, and the sizes δ<sup>type</sup> of the numeric types of the system in bytes. Additionally, during the multi-threaded processing, <italic toggle="yes">T</italic> threads are initialized, each of which at least allocates a single spectrum of size |<italic toggle="yes">S</italic>|:
<disp-formula id="update1625858694867"><label>(1)</label><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*}
E = |I|* \left(2\delta ^{\mathrm{double}}+\delta ^{\mathrm{int}} +\delta ^{\mathrm{short}}\right) + (3*|S|+T*|S|)*\delta ^{\mathrm{double}}\mathrm{.}
\end{eqnarray*}$$\end{document}</tex-math></disp-formula></p>
      <p>Consequently, the memory required by M<sup>2</sup>aia is <italic toggle="yes">O</italic>(|<italic toggle="yes">I</italic>| + |<italic toggle="yes">S</italic>|) and thus much lower than the total size of binary data, which is <italic toggle="yes">O</italic>(|<italic toggle="yes">I</italic>|*|<italic toggle="yes">S</italic>|).</p>
      <p>To test the data handling of M<sup>2</sup>aia, we conducted performance measurements for processing steps 1–3 (see Fig. <xref rid="fig2" ref-type="fig">3</xref>) using the publicly available 3D reference datasets described in [<xref rid="bib5" ref-type="bibr">5</xref>]. The list of the used reference datasets and the results are reported in Table <xref rid="tbl1" ref-type="table">1</xref>. The experiments were repeated 3 times each to obtain mean processing times and memory usage.</p>
      <table-wrap position="float" id="tbl1">
        <label>Table 1.</label>
        <caption>
          <p>Timing experiments on mobile and desktop systems using 3D reference data</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">File name</th>
              <th align="center" rowspan="1" colspan="1">System</th>
              <th align="center" rowspan="1" colspan="1">Size (GB)</th>
              <th align="center" rowspan="1" colspan="1">Spectra</th>
              <th align="center" rowspan="1" colspan="1">Depth</th>
              <th align="center" rowspan="1" colspan="1">Parsing of metadata (1) (s)</th>
              <th align="center" rowspan="1" colspan="1">Initialization (2) (s)</th>
              <th align="center" rowspan="1" colspan="1">Creation of ion image (3) (s)</th>
              <th align="center" rowspan="1" colspan="1">RAM usage (MB)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">3D Mouse Kidney</td>
              <td rowspan="1" colspan="1">A</td>
              <td rowspan="1" colspan="1">44.2</td>
              <td rowspan="1" colspan="1">1,362,830</td>
              <td rowspan="1" colspan="1">7,671</td>
              <td rowspan="1" colspan="1">24.9</td>
              <td rowspan="1" colspan="1">26.27</td>
              <td rowspan="1" colspan="1">10.9</td>
              <td rowspan="1" colspan="1">435.1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">3D Mouse Kidney</td>
              <td rowspan="1" colspan="1">B</td>
              <td rowspan="1" colspan="1">44.2</td>
              <td rowspan="1" colspan="1">1,362,830</td>
              <td rowspan="1" colspan="1">7,671</td>
              <td rowspan="1" colspan="1">5.7</td>
              <td rowspan="1" colspan="1">2.1</td>
              <td rowspan="1" colspan="1">0.6</td>
              <td rowspan="1" colspan="1">435.1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">3D Mouse Pancreas</td>
              <td rowspan="1" colspan="1">A</td>
              <td rowspan="1" colspan="1">27.3</td>
              <td rowspan="1" colspan="1">497,225</td>
              <td rowspan="1" colspan="1">13,297</td>
              <td rowspan="1" colspan="1">9.4</td>
              <td rowspan="1" colspan="1">13.14</td>
              <td rowspan="1" colspan="1">2.8</td>
              <td rowspan="1" colspan="1">292.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">3D OSCC</td>
              <td rowspan="1" colspan="1">A</td>
              <td rowspan="1" colspan="1">26.8</td>
              <td rowspan="1" colspan="1">828,558</td>
              <td rowspan="1" colspan="1">7,665</td>
              <td rowspan="1" colspan="1">14.9</td>
              <td rowspan="1" colspan="1">13.4</td>
              <td rowspan="1" colspan="1">4.04</td>
              <td rowspan="1" colspan="1">323.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Microbe Interaction 3D Timecourse</td>
              <td rowspan="1" colspan="1">A</td>
              <td rowspan="1" colspan="1">2.9</td>
              <td rowspan="1" colspan="1">17,672</td>
              <td rowspan="1" colspan="1">40,299</td>
              <td rowspan="1" colspan="1">0.4</td>
              <td rowspan="1" colspan="1">0.9</td>
              <td rowspan="1" colspan="1">0.08</td>
              <td rowspan="1" colspan="1">231.8</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>Processing of 3D reference datasets published by Oetjen et al. [<xref rid="bib5" ref-type="bibr">5</xref>] and available in the MetaboLights repository [MTBLS176]. The table lists the file names, number of spectra, depth of a spectrum, and the mean time in seconds and memory usage including memory used by the GUI values of 3 manually repeated runs. Processes 1–3 according to the procedures shown in Fig. <xref rid="fig2" ref-type="fig">3</xref>. Applied signal processing includes total-ion-count (TIC) normalization. System configuration A: mobile PC, Intel® Core<sup>TM</sup> i7-8750H CPU at 2.20  GHz 6-core processor, 16 GB physical memory, and SSD. System configuration B: desktop PC, AMD® Ryzen 9 5900x CPU at 3.7  GHz 12-core processor, 32 GB physical memory, and M.2 SSD.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="sec2-2">
      <title>Signal processing methods</title>
      <p>Signal processing is a fundamental and important step in MSI because spectral analysis may be influenced by a wide range of factors including sample preparation, acquisition methods, chemical noise, analyte displacement, and inconsistent intensities due to matrix or surface inhomogeneity, electronic fluctuations, or ionization effects [<xref rid="bib2" ref-type="bibr">2</xref>]. Signal processing aims to reduce these influences. Therefore, M<sup>2</sup>aia offers all steps of a typical signal processing workflow including (i) normalization, (ii) noise reduction, (iii) baseline correction, and (iv) peak-picking methods.</p>
      <sec id="sec2-2-1">
        <title>Normalization/calibration</title>
        <p>To compensate for pixel-to-pixel intensity variations, a spectrum <italic toggle="yes">S</italic> is normalized by
<disp-formula id="update1625859744610"><label>(2)</label><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*}
S(j)=S^{\mathrm{old}}(j)*f_{S}^{-1}\mathrm{,}
\end{eqnarray*}$$\end{document}</tex-math></disp-formula>where <italic toggle="yes">S</italic><sup>old</sup>(<italic toggle="yes">j</italic>) and <italic toggle="yes">S</italic>(<italic toggle="yes">j</italic>) are the original and scaled intensities, respectively; <italic toggle="yes">f</italic> is the normalization value; and <italic toggle="yes">j</italic> is the index related to the <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> position in a spectrum. If no normalization is applied, <italic toggle="yes">f</italic> is set to 1. Generated normalization maps are accessible for each image. As methods for determining <italic toggle="yes">f<sub>S</sub></italic>, M<sup>2</sup>aia offers calculating total-ion-count (TIC), the median, or the use of in-file normalization values (defined spectrum-wise in imzML, if available).</p>
      </sec>
      <sec id="h3content1626246628686">
        <title>Noise reduction</title>
        <p>Spectrum-wise noise reduction is realized via the Savitzky and Golay filter [<xref rid="bib40" ref-type="bibr">37</xref>] method.</p>
      </sec>
      <sec id="sec2-2-2">
        <title>Baseline correction</title>
        <p>Most signal-processing stages take advantage of baseline-corrected spectra. In MS, the baseline is the smooth curve offsetting the actual intensities. Baseline correction is generally performed by subtracting the estimated baseline from the intensity spectrum. Implemented is baseline estimation using the top-hat [<xref rid="bib39" ref-type="bibr">38</xref>] or running median method.</p>
      </sec>
      <sec id="sec2-2-4">
        <title>Peak picking</title>
        <p>Peak picking refers to the detection of peaks in a spectrum and provides information about the <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic>-values and corresponding intensities of the peaks. In M<sup>2</sup>aia, peaks within a spectrum are detected by finding local maxima above a certain noise level using a sliding window approach. The noise level is estimated by the median absolute deviation. Monoisotopic peaks can be identified by automatic Poisson peak harvesting [<xref rid="bib41" ref-type="bibr">39</xref>].</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Image interaction and processing</title>
    <p>Key advantages of M<sup>2</sup>aia are its interactive visualization and image-based processing methods. Visual interaction with 2D and 3D data allows the exploration and perception of whole datasets. Dimensionality reduction methods can be applied to generate views that help to exploit the full potential of MSI. Methods for image segmentation can be used to restrict the analysis to relevant regions of interest. Image- and/or point-based registration methods enable the creation of 3D reconstructions of stacks of MSI images or image registration in multi-modal imaging setups. These concepts are described in more details below.</p>
    <sec id="sec3-1">
      <title>Data visualization and interaction concepts</title>
      <p>All images loaded to M<sup>2</sup>aia are represented in a common virtual world coordinate system. This world space can be observed through multiple render windows that are showing different sliced views of the world space (multi-planar reconstructions, e.g., top views and side views of 3D stacks; tilted views are also possible). Complementary to the planar views, a 3D view is provided, facilitating the perception of the distribution of structures in 3D space. Additional to the visualization of pixel image data, M<sup>2</sup>aia also supports the incorporation of surfaces (e.g., created by segmentation of structures or loaded from files after external processing) and offers volume rendering for 3D image data (Fig. <xref rid="fig4" ref-type="fig">4</xref>). Several color maps are available and can be applied to images individually.</p>
      <fig position="float" id="fig4">
        <label>Figure 4</label>
        <caption>
          <p>3D reconstruction of lipid MALDI-MS TOF images of 10 consecutive APP NL-G-F mouse brain tissue sections. (A) Multi-planar reconstruction of the 3D MS image showing ion images at <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> 865.05 ± 0.1 Da. (B) Volume visualization of different mass features. High intensities (green) and low intensities (red) in ion image at <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> 865.05 ± 0.1 Da are visualized. Additionally, the cortex is highlighted by high intensities at <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> 868.76 ± 0.1 Da (purple). Processing and visualization have been performed completely within M<sup>2</sup>aia.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049fig4" position="float"/>
      </fig>
    </sec>
    <sec id="sec3-2">
      <title>Image segmentation</title>
      <p>Image segmentation can be used for selecting regions or structures within an image. M<sup>2</sup>aia offers semi-automatic segmentation tools for 2D/3D image data. Segmented areas can be statistically analyzed within M<sup>2</sup>aia or exported to obtain insights into the local ion intensity distributions.</p>
    </sec>
    <sec id="sec3-3">
      <title>Dimensionality reduction</title>
      <p>Various dimensionality reduction (DR) methods are available in M<sup>2</sup>aia for the investigation of the high-dimensional MSI data. The most basic DR method is the extraction of ion images by an intensity transformation within an interactively selected window of <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> values. The intensity values within the window are transformed into a single representative value. Currently, M<sup>2</sup>aia allows the calculation of mean, maximum, sum, or median for this purpose.</p>
      <p>More complex DR methods enable capturing features of the dataset distributed over many ion images at once. Principal component analysis (PCA) as a linear and t-stochastic neighbourhood embedding (t-SNE) [<xref rid="bib42" ref-type="bibr">40</xref>] as a non-linear DR method are available in M<sup>2</sup>aia. For initialization of the PCA or t-SNE, a finite set of ion images must be provided. Figure <xref rid="fig6" ref-type="fig">5</xref> illustrates the application of PCA and t-SNE to a centroid dataset.</p>
      <fig position="float" id="fig6">
        <label>Figure 5</label>
        <caption>
          <p>Results of 2 dimensionality reduction methods after performing the pipeline shown in Fig. <xref rid="fig5" ref-type="fig">6</xref>. (A) The 3 principal components with the largest eigenvalues of a PCA. (B) Results of a t-SNE with a target dimension of 3.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049fig6" position="float"/>
      </fig>
    </sec>
    <sec id="sec3-4">
      <title>Image registration</title>
      <p>Reconstruction of 3D MSI datasets requires image registration and aims to combine multiple adjacent 2D MS images of consecutive cuts of a biological sample to a single 3D MS image volume. Besides the critical issue of serial tissue sectioning, preparation, and acquisition, the processing and handling of 3D MSI data has been regarded as a huge bottleneck so far [<xref rid="bib6" ref-type="bibr">6</xref>].</p>
      <p>Another big task requiring image registration is in multi-modal set-ups for the combined analysis of MSI and another imaging modality such as microscopy images of immunofluorescence or haematoxylin-eosin (H&amp;E)-stained tissue sections. Challenges emerge from cases where adjacent tissue sections are used that may be distorted, and/or images containing no corresponding features due to the different imaging modalities.</p>
      <p>Generally, the goal of image registration is to spatially align 2 adjacent images, commonly referred to as fixed image <italic toggle="yes">I</italic><sup>F</sup> and moving image <italic toggle="yes">I</italic><sup>M</sup>. Registration aims to find the parameters of a transformation that maps <italic toggle="yes">I</italic><sup>M</sup> onto <italic toggle="yes">I</italic><sup>F</sup>. Methods exist that are based on reference points highlighting landmarks in both the fixed and moving image, as well as image-based methods that try to minimize an image-based similarity metric by iterative optimization. A distinction is made between rigid and deformable registration approaches, with the task deciding which method is chosen or whether both are used in combination. M<sup>2</sup>aia integrates the elastix [<xref rid="bib24" ref-type="bibr">24</xref>] toolkit for registration tasks.</p>
      <sec id="sec3-4-1">
        <title>3D Image reconstruction</title>
        <p>M<sup>2</sup>aia provides an interactive solution for performing 3D reconstruction. To create a 3D MSI volume, M<sup>2</sup>aia aligns consecutive slices to each other, applying subsequent rigid and deformable image-based registration steps in a fully automated way. This workflow has some technical challenges: (i) the provisioning of multiple MSI data at the same time, (ii) the choice of which image content is used for registration, and (iii) the parameterization of the rigid and deformable registration steps.</p>
        <p>To address the first challenge, M<sup>2</sup>aia allows multiple MSI images to be loaded and makes those accessible for further processing steps. Here, the already described lazy loading mechanism shows its advantages. Regarding the second challenge, it is necessary to find feature-rich ion images (<italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> ranges) that capture corresponding tissue structures in the moving and fixed image. If no such ion images are known beforehand, it is possible to search interactively for ion images. M<sup>2</sup>aia supports this by plotting overview spectra and the result of a peak-picking action. For the third challenge, M<sup>2</sup>aia offers an in-app editor to modify a template parameter file that is passed to elastix. In Fig. <xref rid="fig4" ref-type="fig">4</xref> the 3D reconstruction of the publicly accessible 3D dataset accompanying this article is exemplarily illustrated. In Use-case 2 we further elaborate on M<sup>2</sup>aia’s 3D reconstruction and multi-modal image registration capabilities.</p>
      </sec>
      <sec id="sec3-4-2">
        <title>Multi-modal image registration</title>
        <p>Image-to-image registration of multiple image sources can help to elucidate the relationship of observations that can only be detected in different image domains. It is not guaranteed that there is a large correspondence of image features in different domains, especially between MSI and other, e.g., optical, imaging methods. Owing to this fact, similarity metrics based on mutual information are used for image comparison.</p>
        <p>For the case of multi-modal MSI, it is necessary to choose appropriate image contrasts in the respective MSI domains of the moving and the fixed image. A major advantage of M<sup>2</sup>aia is that it allows the handling and visualization of individual mass axes of multiple MS images in a common coordinate system. This enables the user to select ion images with high mutual information in an interactive environment.</p>
      </sec>
    </sec>
    <sec id="sec3-5">
      <title>Multi-modal 3D MSI dataset</title>
      <p>To demonstrate the capabilities of M<sup>2</sup>aia we make a lipid 3D and a peptide 3D MSI dataset publicly available [<xref rid="bib38" ref-type="bibr">36</xref>] together with this article. The dataset consists of 10 consecutive cuts of brain tissue taken from an APP NL-G-F mouse model [<xref rid="bib43" ref-type="bibr">41</xref>]. Briefly, the sample was cut with a thickness of 10 <inline-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mu {\rm m}$\end{document}</tex-math></inline-formula>  and sections were placed on a single Bruker indium-tin oxide slide. Subsequently, lipid and peptide MALDI–time-of-flight (TOF) MSI acquisitions were made. In between the data acquisition for lipids and peptides, the matrix and most of the lipids remaining on the tissue sections were washed away before the peptide acquisition protocol was applied. The lipid and peptide datasets share a common lateral resolution of 20  <inline-formula><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mu {\rm m}$\end{document}</tex-math></inline-formula> and a spot size of 20 × 20 <inline-formula><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mu {\rm m}$\end{document}</tex-math></inline-formula>. The lipid 3D and peptide 3D datasets are published here for the first time. All experiments were approved (No.142/2015) by the Ethics Committee on Animal Experimentation of the University of Leuven.</p>
      <sec id="sec3-5-1">
        <title>Lipid MSI</title>
        <p>Measurement was done on a Rapiflex MALDI-TOF MS (Bruker Daltonics, Bremen, Germany) in reflector positive mode with <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> 600–1,800 using FlexImaging 5.0 software (Bruker Daltonics, Bremen, Germany). In brief, the acquisition method was calibrated using polyalanine calibration standard and quadratic calibration. Two hundred laser shots at 10 kHz repetition speed were accumulated for each raster spot.</p>
      </sec>
      <sec id="sec3-5-2">
        <title>Peptide MSI</title>
        <p>Prior to peptide MSI, tissue sections were delipidated using the washing procedure by Yang and Caprioli [<xref rid="bib17" ref-type="bibr">17</xref>]: 70% ethanol (30 s), 100% ethanol (30 s), Carnoy fluid (60/30/10 ethanol/chloroform/acetic acid v/v/v) (120 s), 100% ethanol (30 s), ddH2O (30 s), and 100% ethanol (30 s). Peptide MSI was performed on a Rapiflex MALDI-TOF MS (Bruker Daltonics, Bremen, Germany) in positive linear mode with <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> 2,000–10,000 using FlexImaging 5.0 software (Bruker Daltonics, Bremen, Germany) as described elsewhere [<xref rid="bib7" ref-type="bibr">7</xref>].</p>
        <p>MSI features describing the distribution of several occurrences of β-amyloids in a peptide dataset of the same specimen, which are related to the chosen APP NL-G-F mouse model and Alzheimer disease, are described in a separate publication by Enzlein et al. [<xref rid="bib7" ref-type="bibr">7</xref>].</p>
      </sec>
    </sec>
    <sec id="sec3-6">
      <title>Use-case 1: N-linked glycan <italic toggle="yes">m/z</italic> candidate detection</title>
      <p>We reanalyzed a publicly available N-linked glycan MALDI-TOF dataset [<xref rid="bib36" ref-type="bibr">34</xref>,<xref rid="bib44" ref-type="bibr">42</xref>] to demonstrate the applicability of M<sup>2</sup>aia. A similar study was done by Föll et al. [<xref rid="bib31" ref-type="bibr">29</xref>] using the application framework Galaxy, which is designed for server-side processing. The dataset is available in the PRIDE repository with accession code PXD009808. The data were published by Gustafsson et al. [<xref rid="bib36" ref-type="bibr">34</xref>] and used to examine an automated sample preparation approach for MALDI-TOF/TOF imaging of N-linked glycans on formalin-fixed paraffin-embedded (FFPE) murine kidney tissue [<xref rid="bib36" ref-type="bibr">34</xref>,<xref rid="bib44" ref-type="bibr">42</xref>]. PNGase F was printed on 2 FFPE kidney sections to release N-linked glycans from proteins. A part of the third kidney was covered with N-glycan calibrants and another part with buffer to serve as a control. Imaging was performed with a spatial resolution of 100  <inline-formula><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mu {\rm m}$\end{document}</tex-math></inline-formula>.</p>
      <p>Using M<sup>2</sup>aia, we loaded 3 datasets (PNG1, PNG2, and control; in total ∼6.4 GB; skipping the calibrant area) and applied TIC normalization, Savitzky-Golay smoothing, and Top-Hat baseline correction (Fig. <xref rid="fig5" ref-type="fig">6</xref>, Data preparation). Peak picking with monoisotopic peak identification was applied to the mean spectrum of each image, respectively. The peak results of the datasets were combined into a common peak list. Peak binning was applied to remove duplicates, resulting in a list of 107 <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> (candidate) peaks (Fig. <xref rid="fig5" ref-type="fig">6</xref>, Feature extraction).</p>
      <fig position="float" id="fig5">
        <label>Figure 6</label>
        <caption>
          <p>Typical steps to transform an MSI dataset into discriminating information in M<sup>2</sup>aia, exemplified by images from the reanalysis process of an N-glycan MALDI-TOF MSI dataset (Use-case 1).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049fig5" position="float"/>
      </fig>
      <p>To demonstrate how M<sup>2</sup>aia can be used in combination with other tools, we exported the processed data as a single imzML file to continue the processing with Cardinal (2.6.0) [<xref rid="bib45" ref-type="bibr">43</xref>]. Providing the list of common peak features during the export process allows the data to be stored in continuous centroid format. Using Cardinal, we compare the 2 PNGase F–treated kidney tissue sections with the control tissue section for the identification of discriminant <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> candidates that are potentially related to N-linked glycans. N-linked glycan <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> candidates were selected by the supervised spatial shrunken centroids (SSC) algorithm [<xref rid="bib46" ref-type="bibr">44</xref>,<xref rid="bib47" ref-type="bibr">45</xref>] (Fig. <xref rid="fig5" ref-type="fig">6</xref>, Analysis). Therefore, all pixels were separated into the classes “treated” (for PNG1 and PNG2) or “untreated” (for Control). By mapping the <italic toggle="yes">treated</italic> features selected by the SSC to the original publication of Gustafsson et al. [<xref rid="bib36" ref-type="bibr">34</xref>], we could identify 16 N-linked glycan–related <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> candidates, as listed in Table <xref rid="tbl2" ref-type="table">2</xref>. We calculated PCA images including the first 3 principal components and a t-SNE image (Fig. <xref rid="fig6" ref-type="fig">5</xref>) based on the common peak list in M<sup>2</sup>aia.</p>
      <table-wrap position="float" id="tbl2">
        <label>Table 2.</label>
        <caption>
          <p>Potential <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic>-candidates related to N-linked glycans</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="2" colspan="1">ID No.</th>
              <th rowspan="2" align="center" colspan="1"><italic toggle="yes">m</italic>/<italic toggle="yes">z</italic></th>
              <th rowspan="2" align="center" colspan="1">t-Statistics</th>
              <th colspan="2" align="center" rowspan="1">Error (ppm)</th>
              <th rowspan="2" align="center" colspan="1">LC-MS/MS M+NA+</th>
              <th rowspan="2" align="center" valign="middle" colspan="1">Composition</th>
            </tr>
            <tr>
              <th align="center" rowspan="1" colspan="1">This article</th>
              <th align="center" rowspan="1" colspan="1">Föll et al. [<xref rid="bib31" ref-type="bibr">29</xref>]</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">1,257.4730</td>
              <td rowspan="1" colspan="1">63.79</td>
              <td rowspan="1" colspan="1">50</td>
              <td rowspan="1" colspan="1">51</td>
              <td rowspan="1" colspan="1">1,257.41</td>
              <td rowspan="1" colspan="1">(Hex)<sub>2</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">1,419.5177</td>
              <td rowspan="1" colspan="1">60.62</td>
              <td rowspan="1" colspan="1">33</td>
              <td rowspan="1" colspan="1">59</td>
              <td rowspan="1" colspan="1">1,419.47</td>
              <td rowspan="1" colspan="1">(Hex)<sub>3</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">1,743.6281</td>
              <td rowspan="1" colspan="1">54.50</td>
              <td rowspan="1" colspan="1">33</td>
              <td rowspan="1" colspan="1">67</td>
              <td rowspan="1" colspan="1">1,743.57</td>
              <td rowspan="1" colspan="1">(Hex)<sub>5</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">1,905.6748</td>
              <td rowspan="1" colspan="1">50.93</td>
              <td rowspan="1" colspan="1">23</td>
              <td rowspan="1" colspan="1">30</td>
              <td rowspan="1" colspan="1">1,905.63</td>
              <td rowspan="1" colspan="1">(Hex)<sub>6</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">1,581.5697</td>
              <td rowspan="1" colspan="1">50.58</td>
              <td rowspan="1" colspan="1">25</td>
              <td rowspan="1" colspan="1">61</td>
              <td rowspan="1" colspan="1">1,581.53</td>
              <td rowspan="1" colspan="1">(Hex)<sub>4</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">2,304.8962</td>
              <td rowspan="1" colspan="1">47.12</td>
              <td rowspan="1" colspan="1">28</td>
              <td rowspan="1" colspan="1">36</td>
              <td rowspan="1" colspan="1">2,304.83</td>
              <td rowspan="1" colspan="1">(Hex)<sub>2</sub>(HexNAc)<sub>3</sub>(deoxyhexose)<sub>3</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">1,850.7140</td>
              <td rowspan="1" colspan="1">46.86</td>
              <td rowspan="1" colspan="1">34</td>
              <td rowspan="1" colspan="1">34</td>
              <td rowspan="1" colspan="1">1,850.65</td>
              <td rowspan="1" colspan="1">(Hex)<sub>1</sub>(HexNAc)<sub>3</sub>(deoxyhexose)<sub>1</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">1,809.6975</td>
              <td rowspan="1" colspan="1">45.44</td>
              <td rowspan="1" colspan="1">37</td>
              <td rowspan="1" colspan="1">52</td>
              <td rowspan="1" colspan="1">1,809.63</td>
              <td rowspan="1" colspan="1">(Hex)<sub>2</sub>(HexNAc)<sub>2</sub>(deoxyhexose)<sub>1</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">9</td>
              <td rowspan="1" colspan="1">2,158.8425</td>
              <td rowspan="1" colspan="1">38.62</td>
              <td rowspan="1" colspan="1">33</td>
              <td rowspan="1" colspan="1">54</td>
              <td rowspan="1" colspan="1">2,158.77</td>
              <td rowspan="1" colspan="1">(Hex)<sub>2</sub>(HexNAc)<sub>3</sub>(deoxyhexose)<sub>2</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">1,663.6324</td>
              <td rowspan="1" colspan="1">35.92</td>
              <td rowspan="1" colspan="1">37</td>
              <td rowspan="1" colspan="1">58</td>
              <td rowspan="1" colspan="1">1,663.57</td>
              <td rowspan="1" colspan="1">(Hex)<sub>2</sub>(HexNAc)<sub>2</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">11</td>
              <td rowspan="1" colspan="1">1,485.5967</td>
              <td rowspan="1" colspan="1">33.83</td>
              <td rowspan="1" colspan="1">44</td>
              <td rowspan="1" colspan="1">63</td>
              <td rowspan="1" colspan="1">1,485.53</td>
              <td rowspan="1" colspan="1">(HexNAc)<sub>2</sub>(deoxyhexose)<sub>1</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">12</td>
              <td rowspan="1" colspan="1">1,688.6586</td>
              <td rowspan="1" colspan="1">31.59</td>
              <td rowspan="1" colspan="1">28</td>
              <td rowspan="1" colspan="1">62</td>
              <td rowspan="1" colspan="1">1,688.61</td>
              <td rowspan="1" colspan="1">(HexNAc)<sub>3</sub>(deoxyhexose)<sub>1</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">13</td>
              <td rowspan="1" colspan="1">2,012.7717</td>
              <td rowspan="1" colspan="1">26.88</td>
              <td rowspan="1" colspan="1">30</td>
              <td rowspan="1" colspan="1">37</td>
              <td rowspan="1" colspan="1">2,012.71</td>
              <td rowspan="1" colspan="1">(Hex)<sub>2</sub>(HexNAc)<sub>3</sub>(deoxyhexose)<sub>1</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">14</td>
              <td rowspan="1" colspan="1">1,647.6444</td>
              <td rowspan="1" colspan="1">26.83</td>
              <td rowspan="1" colspan="1">45</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">1,647.57</td>
              <td rowspan="1" colspan="1">(Hex)<sub>1</sub>(HexNAc)<sub>2</sub>(deoxyhexose)<sub>1</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">15</td>
              <td rowspan="1" colspan="1">2,816.1882</td>
              <td rowspan="1" colspan="1">24.31</td>
              <td rowspan="1" colspan="1">63</td>
              <td rowspan="1" colspan="1">63</td>
              <td rowspan="1" colspan="1">2,816.01</td>
              <td rowspan="1" colspan="1">(Hex)<sub>3</sub>(HexNAc)<sub>4</sub>(deoxyhexose)<sub>1</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">2,067.7292</td>
              <td rowspan="1" colspan="1">19.00</td>
              <td rowspan="1" colspan="1">28</td>
              <td rowspan="1" colspan="1">43</td>
              <td rowspan="1" colspan="1">2,067.67</td>
              <td rowspan="1" colspan="1">(Hex)<sub>7</sub>+(Man)<sub>3</sub>(GlcNAc)<sub>2</sub></td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn2">
            <p>By the reanalysis of the data published by Gustafsson et al. [<xref rid="bib36" ref-type="bibr">34</xref>] in M<sup>2</sup>aia, we were able to identify a set of 16 discriminating <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> features (col. 2) obtained from the MSI data and mapped it to the LC-MS/MS experiment [<xref rid="bib36" ref-type="bibr">34</xref>] (col. 6) for the treated kidney sections. Errors are listed for M<sup>2</sup>aia (col. 4) and Föll et al. [<xref rid="bib31" ref-type="bibr">29</xref>] (col. 5) for comparison. Compositions [<xref rid="bib36" ref-type="bibr">34</xref>] of the corresponding <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> features are reported in col. 7. t-Statistics of the supervised spatial shrunken centroids algorithm are reported in col. 3. Column 1 reports the identifier (ID) for sorted features by descending t-statistics. Hex: hexose; Man: mannose; GlcNAc: N-acetyl-D-glucosamine; HexNAc: N-acetyl-D-hexosamine.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>For reproducibility purposes, protocols of the interactive steps from loading to exporting [<xref rid="bib48" ref-type="bibr">46</xref>] and for dimensionality reduction [<xref rid="bib49" ref-type="bibr">47</xref>] are available. The R-based processing of the intermediate results is available as a CodeOcean capsule [<xref rid="bib50" ref-type="bibr">48</xref>, <xref rid="bib51" ref-type="bibr">49</xref>]. An additional CodeOcean capsule implements the described workflow as a command-line application [<xref rid="bib52" ref-type="bibr">50</xref>,<xref rid="bib53" ref-type="bibr">51</xref>], demonstrating the possibility of developing M<sup>2</sup>aia-based applications for batch-processing and porting them to a server infrastructure.</p>
    </sec>
    <sec id="sec3-7">
      <title>Use-case 2: Multi-modal 3D image reconstruction</title>
      <p>As mentioned before, the dataset published together with this article consists of 10 consecutive brain slices of an APP NL-G-F mouse model, imaging both lipid and peptide features (in total ∼80 GB in size). The objective of the use-case described in the following is to demonstrate the applicability of M<sup>2</sup>aia for mono- and multi-modal 3D image reconstructions by showing how to embed the peptide information into the lipid structural context in Three dimensions.</p>
      <p>To demonstrate mono-modal 3D reconstruction, all 10 slices of the lipid and the peptide datasets were loaded into M<sup>2</sup>aia, respectively, and used for slicewise reconstruction of 3D image stacks. For multi-modal 3D-reconstruction, the peptide dataset was pairwise registered with the respective lipid slices of the previously reconstructed 3D lipid image stack.</p>
      <p>Each of the 10 lipid imzML binary files is ∼4.9 GB on disk and each of the 10 peptide imzML binary files is ∼2.8 GB. Loading and initialization of a single lipid image into M<sup>2</sup>aia took a mean of 3.26 ± 0.67 seconds for the lipid data and 2.06 ± 0.45 seconds for the peptide data. During the initialization, maps of TIC normalization factors and the TIC-normalized overview spectra are created for each dataset.</p>
      <p>Successful image-based registration requires images that are rich and similar in structural features. This can be done in M<sup>2</sup>aia by fast and interactive exploration of ion images. For the example data, structure-rich images in the lipid dataset were found at <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> 865 ± 0.65 Da and for the peptide dataset at <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> 2,250 ± 50 Da. For a rough initial alignment of considerably rotated tissue sections, we took advantage of M<sup>2</sup>aia’s capability to interactively rotate the slices by ±15° around the center. Additionally, the non-tissue areas were removed from the ion image generation process by segmentation of the respective areas, using the segmentation tools provided by M<sup>2</sup>aia.</p>
      <p>For mono-modal 3D reconstructions, a reference slice was first selected in the corresponding M<sup>2</sup>aia plugin from the list of ordered slices. Starting from this reference slice, adjacent slices were automatically aligned to each other by rigid and deformable image-based registration. The process is applied to the image stack in both downward and upward directions (see 3D reconstruction section of Fig. <xref rid="fig7" ref-type="fig">7</xref>).</p>
      <fig position="float" id="fig7">
        <label>Figure 7</label>
        <caption>
          <p>Steps for 3D reconstruction of consecutive MSI image slices in M<sup>2</sup>aia, exemplified by images from the 3D reconstruction and registration of the publicly available MALDI-TOF lipid and peptide dataset. Dashed boxes are possible additional processing steps that were not applied to the data shown.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049fig7" position="float"/>
      </fig>
      <p>Rigid registration is based on a multi-resolution registration strategy (Gaussian pyramid with 3 levels and downsampling factors of 4, 2, 1). Advanced Mattes mutual information [<xref rid="bib24" ref-type="bibr">24</xref>] is used as metric for the optimization of a Euler transformation using linear interpolation and 250 iterations.</p>
      <p>For the subsequent deformable registration steps, the same multi-resolution scheme and metric are applied. As deformable transformation, a recursive B-spline transformation is used with final grid spacing on the original resolution set to 0.8 mm, with scaling factors per pyramid level of 2, 1.5, and 1, respectively. Interpolation is performed by third-order B-splines. The optimization is run for 750 iterations. Figure <xref rid="fig7" ref-type="fig">7</xref> summarizes the workflow.</p>
      <p>To quantify the accuracy of the registration, we used M<sup>2</sup>aia to interactively select 7 reference points in each slice and in both modalities independently (a subset of points share a common anatomical location in both modalities), resulting in 70 reference points per set. In Fig. <xref rid="fig8" ref-type="fig">8</xref> the reference points of both modalities are shown in context of the reconstructed lipid dataset for the mid-slice of the stack.</p>
      <fig position="float" id="fig8">
        <label>Figure 8</label>
        <caption>
          <p>Maximum intensity projection of the multi-modal 3D reconstructed dataset at <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> 865 ± 0.65 Da. Peptide (blue crosses) and lipid (red circles) reference points are shown for the mid-slice of the stack.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049fig8" position="float"/>
      </fig>
      <p>For the mono-modal 3D reconstructions of the lipid (see Fig. <xref rid="fig4" ref-type="fig">4</xref>) and peptide datasets, we obtained a mean registration error of 28 ± 8 and 35 ± 5 <inline-formula><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mu {\rm m}$\end{document}</tex-math></inline-formula>, respectively, and for the multi-modal reconstruction a mean reconstruction error of 39 ± 4 <inline-formula><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mu {\rm m}$\end{document}</tex-math></inline-formula>.</p>
      <p>A protocol [<xref rid="bib54" ref-type="bibr">52</xref>] showing how to perform the interactive steps in M<sup>2</sup>aia of the workflow as described above is available on protocols.io. <xref rid="sup11" ref-type="supplementary-material">Additional File 1</xref> shows a rotating view of the volume visualization of the reconstructed data.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec4">
    <title>Discussion</title>
    <p>M<sup>2</sup>aia’s multi-threading and lazy loading concepts enable memory-efficient exploration of datasets that are far larger than the system’s actual working memory (Fig. <xref rid="fig2" ref-type="fig">3</xref>). As shown in Table <xref rid="tbl1" ref-type="table">1</xref>, loading a 44.2-GB dataset requires &lt;500 MB of RAM. This allows even complex MSI analysis tasks to be performed on standard PCs. We demonstrate this for <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> candidate detection on an N-linked glycan MALDI-TOF dataset and 3D multi-modal registration of a lipid and peptide dataset. All steps of the use-cases were performed on a laptop computer with 16 GB of RAM.</p>
    <p>M<sup>2</sup>aia's GUI is intended to remove existing barriers related to performing the steps of an MSI study. Additionally, all features of the M<sup>2</sup>aia programming API can also be used to create command-line applications. This is beneficial for batch processing of huge databases of MS images. In this case the interactive M<sup>2</sup>aia GUI can help us to understand the implications of each processing step during development and quality control.</p>
    <p>In addition to interactive processing with M<sup>2</sup>aia, it is possible to create memory-efficient command-line applications that also benefit from the multi-threading and lazy loading approaches. By implementing command-line applications within an OS-level virtualization (e.g., Docker) a scalable, distributable, and reproducible server-side MSI processing environment can be created and integrated with established workflow tools such as Galaxy.</p>
    <p>Image-to-image registration requires structure-rich images that include common characteristic features between tissue slices or, for the multi-modal case, between modalities. This may require a user-driven search for structure-rich images across the <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> dimension, which is facilitated by M<sup>2</sup>aia's fast and interactive ion image generation. Because different masses are intrinsically registered, it is irrelevant whether the structures visible in an image are meaningful entities or imaging/normalization artefacts. To demonstrate this, an unusually wide mass range of 50  Da at <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> 2,250 was chosen to generate a structure-rich image. This was successfully used in Use-case 2 for the 3D reconstruction. Disabling TIC normalization for the same <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic>-range leads to a noisy image without structures, not usable for image-based registration—suggesting that the contrast is actually caused by a TIC normalization artefact.</p>
    <p>Another challenge for purely automatic image registration approaches is significantly misaligned, especially heavily rotated, or, even worse, flipped images. The interactive environment of M<sup>2</sup>aia makes it possible to quickly obtain a rough pre-alignment of the images that is sufficient as initialization for subsequent automatic refinement. With the possibility to edit the elastix parameter file, M<sup>2</sup>aia offers unrestricted access to the full potential of the elastix toolkit to enable problem-specific customization of image registration.</p>
    <p>Evaluation of registration results is yet another task that requires interaction. It is performed either qualitatively by visualization methods (like blending or checkerboard visualization) or quantitatively by comparing corresponding landmarks or, less accurately, segmentations. Both methods typically require interactive tools, e.g., to select the appropriate parameters for visualization, to define corresponding landmarks, or to perform (or at least verify) segmentations. MITK, the toolkit that M<sup>2</sup>aia is based on, offers such tools. Future releases of M<sup>2</sup>aia will make them more easily accessible for MSI data.</p>
    <p>With rare exceptions, transforming an image to another coordinate system requires interpolation of image data. If interpolation is applied to spectral data, the interpolated spectra must be interpreted with caution. To avoid possible misinterpretation of interpolated spectra, M<sup>2</sup>aia currently calculates only interpolated ion images and allows the transformation parameters to be stored for use together with the unmodified MSI data. To avoid interpolation of spectra in a multi-modal registration task with MSI and non-MSI data, the MSI image domain should be used as the fixed image domain.</p>
    <p>Multi-modal MS imaging refers to approaches with different MSI contrasts (like lipid and peptide MS imaging), as well as combined MSI and non-MS imaging methods, e.g., MSI combined with microscopy. M<sup>2</sup>aia’s capabilities for the former scenario were demonstrated in Use-case 2. Combining MSI and microscopy is a common multi-modal MSI experiment with its own challenges in interactive visualization. Owing to the high lateral resolution of microscopy images, memory-efficient handling of microscopy datasets requires pyramidal and tiled storage approaches. To enable this in M<sup>2</sup>aia we are currently developing an interface for reading whole-slide images by utilizing the OpenSlide library [<xref rid="bib55" ref-type="bibr">53</xref>]. This will be part of an upcoming release of M<sup>2</sup>aia.</p>
  </sec>
  <sec sec-type="conclusions" id="sec5">
    <title>Conclusion</title>
    <p>To our knowledge, M<sup>2</sup>aia is the first open-source application that provides interactive, fast, and highly memory-efficient access to multiple 2D/3D MS images at the same time. It offers all steps of a typical MSI signal processing work flow, responsive visual interaction in 2 and 3 dimensions, as well as image processing functions such as segmentation, and features deformable 3D reconstruction and multi-modal registration. Another unique feature is that fused data with individual mass axes can be visualized in a shared coordinate system. Furthermore, M<sup>2</sup>aia is an extensible framework allowing the development of custom MSI analysis pipelines.</p>
  </sec>
  <sec sec-type="data-availability" id="sec7">
    <title>Data Availability</title>
    <list list-type="bullet">
      <list-item>
        <p>M<sup>2</sup>aia binaries for Windows and Linux [<xref rid="bib56" ref-type="bibr">54</xref>].</p>
      </list-item>
      <list-item>
        <p>M<sup>2</sup>aia source code [<xref rid="bib57" ref-type="bibr">55</xref>].</p>
      </list-item>
      <list-item>
        <p>The 3D reference datasets by Oetjen et al. [<xref rid="bib5" ref-type="bibr">5</xref>] used to generate the results of the timing experiments are available on the MetaboLights repository with accession code MTBLS176.</p>
      </list-item>
      <list-item>
        <p>Supporting data of Use-case 1: N-linked glycan MALDI MSI datasets by Gustafsson et al. [<xref rid="bib44" ref-type="bibr">42</xref>] are available in the PRIDE repository with accession code PXD009808.</p>
      </list-item>
      <list-item>
        <p>Supporting protocol of Use-case 1: interactive steps from loading to exporting [<xref rid="bib48" ref-type="bibr">46</xref>].</p>
      </list-item>
      <list-item>
        <p>Supporting protocol of Use-case 1: dimensionality reduction [<xref rid="bib48" ref-type="bibr">46</xref>].</p>
      </list-item>
      <list-item>
        <p>Supporting capsule of Use-case 1: command-line application based processing [<xref rid="bib52" ref-type="bibr">50</xref>].</p>
      </list-item>
      <list-item>
        <p>Supporting capsule of Use-case 1: R-based processing [<xref rid="bib50" ref-type="bibr">48</xref>].</p>
      </list-item>
      <list-item>
        <p>Supporting data of Use-case 2: multi-modal 3D lipid and peptide mouse brain MSI data data have been deposited to the GigaDB repository [<xref rid="bib38" ref-type="bibr">36</xref>].</p>
      </list-item>
      <list-item>
        <p>Supporting protocol of Use-case 2: interactive steps of 3D image reconstruction [<xref rid="bib54" ref-type="bibr">52</xref>].</p>
      </list-item>
    </list>
  </sec>
  <sec id="sec8">
    <title>Availability of Supporting Source Code and Requirements</title>
    <list list-type="bullet">
      <list-item>
        <p>Project name: M<sup>2</sup>aia—MSI applications for interactive analysis in MITK</p>
      </list-item>
      <list-item>
        <p>Project home page: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.github.com/jtfcordes/m2aia" ext-link-type="uri">https://www.github.com/jtfcordes/m2aia</ext-link></p>
      </list-item>
      <list-item>
        <p>Operating systems: Windows and Unix</p>
      </list-item>
      <list-item>
        <p>Programming language: C++, CMake, and R</p>
      </list-item>
      <list-item>
        <p>Other requirements: The project is based on the MITK snapshot/2020-12-21 [<xref rid="bib59" ref-type="bibr">56</xref>] (required for compiling) and elastix (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://scicrunch.org/resolver/RRID:SCR_009619" ext-link-type="uri">RRID:SCR_009619</ext-link>) v5.0.0 binaries [<xref rid="bib60" ref-type="bibr">57</xref>] (required for running)</p>
      </list-item>
      <list-item>
        <p>License: BSD</p>
      </list-item>
      <list-item>
        <p>
          <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://scicrunch.org/resolver/RRID:SCR_019324" ext-link-type="uri">RRID:SCR_019324</ext-link>
        </p>
      </list-item>
      <list-item>
        <p>
          <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://bio.tools/m2aia" ext-link-type="uri">biotools:m2aia</ext-link>
        </p>
      </list-item>
    </list>
  </sec>
  <sec id="h1content1625868212261">
    <title>Additional Files</title>
    <p>Additional File 1: Volume visualization of the multi-modal 3D reconstruction. A rotating view was generated for the result of Use-case 2, showing a volume visualization of <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> 864 ± 0.65 Da in blue-violet and <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> 4070 ± 5 Da in green.</p>
  </sec>
  <sec id="sec9">
    <title>Ethics, Consent, and Permissions</title>
    <p>All experiments were approved (No.142/2015) by the Ethics Committee on Animal Experimentation of the University of Leuven.</p>
  </sec>
  <sec id="sec10">
    <title>Abbreviations</title>
    <p>API: Application Programming Interface; CPU: central processing unit; DR: dimensionality reduction; GUI: graphical user interface; H&amp;E: hematoxylin-eosin; ibd: imaging binary data; LC-MS/MS: liquid chromatography tandem mass spectrometry; JIP: Joint Imaging Platform; M<sup>2</sup>aia: MSI applications for interactive analysis in MITK; MALDI: matrix-assisted laser desorption/ionization; MS: mass spectrometry; MSI: mass spectrometry imaging; mz or <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic>: mass-to-charge ratio; OS: operating system; PCA: pricipal component analysis; ppm: parts per million; PRIDE: proteomics identifications; RAM: random access memory; SSC: spatial shrunken centroids; SSD: Solid-State-Drive; t-SNE: t-stochastic neighbourhood embedding; TIC: total ion count/current; TOF: time of flight.</p>
  </sec>
  <sec id="sec11">
    <title>Competing Interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec id="sec12">
    <title>Funding</title>
    <p>This work was funded by the German Federal Ministry of Research (BMBF) as part of the Innovation Partnership M<sup>2</sup>Aind, project M<sup>2</sup>OGA (13FH8I02IA) within the framework FH-Impuls. The article processing charge was funded by the Baden-Württemberg Ministry of Science, Research and the Arts (MWK) in the funding programme Open Access Publishing.</p>
  </sec>
  <sec id="sec13">
    <title>Authors’ Contributions</title>
    <p>J.C. developed and tested M<sup>2</sup>aia and created the use-cases and protocols. T.E. and C.M. prepared and acquired the lipid and peptide 3D data that were made publicly available. T.E. and M.H. helped test the application. M.H. contributed to the development of the visualization strategies. I.W. and C.H. contributed to the conceptualization and funding acquisition. S.E. contributed to the conceptualization. J.C. and I.W. wrote the manuscript. All authors critically read and approved the manuscript’s contents.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>giab049_GIGA-D-21-00033_Original_Submission</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049_giga-d-21-00033_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup2" position="float" content-type="local-data">
      <label>giab049_GIGA-D-21-00033_Revision_1</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049_giga-d-21-00033_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup3" position="float" content-type="local-data">
      <label>giab049_GIGA-D-21-00033_Revision_2</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049_giga-d-21-00033_revision_2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup4" position="float" content-type="local-data">
      <label>giab049_Response_to_Reviewer_Comments_Original_Submission</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049_response_to_reviewer_comments_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup5" position="float" content-type="local-data">
      <label>giab049_Response_to_Reviewer_Comments_Revision_1</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049_response_to_reviewer_comments_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup6" position="float" content-type="local-data">
      <label>giab049_Reviewer_1_Report_Original_Submission</label>
      <caption>
        <p>Chris Armit -- 3/2/2021 Reviewed</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049_reviewer_1_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup7" position="float" content-type="local-data">
      <label>giab049_Reviewer_2_Report_Original_Submission</label>
      <caption>
        <p>Liam McDonnell -- 3/9/2021 Reviewed</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049_reviewer_2_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup8" position="float" content-type="local-data">
      <label>giab049_Reviewer_3_Report_Original_Submission</label>
      <caption>
        <p>Nathalie Agar -- 3/16/2021 Reviewed</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049_reviewer_3_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup9" position="float" content-type="local-data">
      <label>giab049_Reviewer_4_Report_Original_Submission</label>
      <caption>
        <p>Nathan Heath Patterson -- 3/22/2021 Reviewed</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049_reviewer_4_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup10" position="float" content-type="local-data">
      <label>giab049_Reviewer_4_Report_Revision_1</label>
      <caption>
        <p>Nathan Heath Patterson -- 5/20/2021 Reviewed</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049_reviewer_4_report_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup11" position="float" content-type="local-data">
      <label>giab049_Supplemental_Video</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="giab049_supplemental_video.mp4" mimetype="video" mime-subtype="mp4">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank the MITK developer team for the provisioning and continuous maintenance of the application backbone. M<sup>2</sup>aia’s t-SNE feature includes software developed by the Delft University of Technology.</p>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McDonnell</surname><given-names>LA</given-names></string-name>, <string-name><surname>Römpp</surname><given-names>A</given-names></string-name>, <string-name><surname>Balluff</surname><given-names>B</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Discussion point: reporting guidelines for mass spectrometry imaging</article-title>. <source>Anal Bioanal Chem</source>. <year>2015</year>;<volume>407</volume>(<issue>8</issue>):<fpage>2035</fpage>–<lpage>45</lpage>.<pub-id pub-id-type="pmid">25432304</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schulz</surname><given-names>S</given-names></string-name>, <string-name><surname>Becker</surname><given-names>M</given-names></string-name>, <string-name><surname>Groseclose</surname><given-names>MR</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Advanced MALDI mass spectrometry imaging in pharmaceutical research and drug development</article-title>. <source>Curr Opin Biotechnol</source>. <year>2019</year>;<volume>55</volume>:<fpage>51</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">30153614</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paine</surname><given-names>MRL</given-names></string-name>, <string-name><surname>Liu</surname><given-names>J</given-names></string-name>, <string-name><surname>Huang</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Three-dimensional mass spectrometry imaging identifies lipid markers of medulloblastoma metastasis</article-title>. <source>Sci Rep</source>. <year>2019</year>;<volume>9</volume>(<issue>1</issue>):<fpage>2205</fpage>.<pub-id pub-id-type="pmid">30778099</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buchberger</surname><given-names>AR</given-names></string-name>, <string-name><surname>DeLaney</surname><given-names>K</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Mass spectrometry imaging: a review of emerging advancements and future insights</article-title>. <source>Anal Chem</source>. <year>2018</year>;<volume>90</volume>(<issue>1</issue>):<fpage>240</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">29155564</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oetjen</surname><given-names>J</given-names></string-name>, <string-name><surname>Veselkov</surname><given-names>K</given-names></string-name>, <string-name><surname>Watrous</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Benchmark datasets for 3D MALDI- and DESI-imaging mass spectrometry</article-title>. <source>Gigascience</source>. <year>2015</year>;<volume>4</volume>, doi:<pub-id pub-id-type="doi">10.1186/s13742-015-0059-4</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ráfols</surname><given-names>P</given-names></string-name>, <string-name><surname>Vilalta</surname><given-names>D</given-names></string-name>, <string-name><surname>Brezmes</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Signal preprocessing, multivariate analysis and software tools for MA(LDI)-TOF mass spectrometry imaging for biological applications</article-title>. <source>Mass Spectrom Rev</source>. <year>2018</year>;<volume>37</volume>(<issue>3</issue>):<fpage>281</fpage>–<lpage>306</lpage>.<pub-id pub-id-type="pmid">27862147</pub-id></mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Enzlein</surname><given-names>T</given-names></string-name>, <string-name><surname>Cordes</surname><given-names>J</given-names></string-name>, <string-name><surname>Munteanu</surname><given-names>B</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Computational analysis of Alzheimer amyloid plaque composition in 2D- and elastically reconstructed 3D-MALDI MS images</article-title>. <source>Anal Chem</source>. <year>2020</year>;<volume>92</volume>(<issue>21</issue>):<fpage>14484</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">33138378</pub-id></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Palmer</surname><given-names>AD</given-names></string-name>, <string-name><surname>Alexandrov</surname><given-names>T</given-names></string-name></person-group>. <article-title>Serial 3D imaging mass spectrometry at its tipping point</article-title>. <source>Anal Chem</source>. <year>2015</year>;<volume>87</volume>(<issue>8</issue>):<fpage>4055</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">25817912</pub-id></mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thiele</surname><given-names>H</given-names></string-name>, <string-name><surname>Heldmann</surname><given-names>S</given-names></string-name>, <string-name><surname>Trede</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>2D and 3D MALDI-imaging: conceptual strategies for visualization and data mining</article-title>. <source>Biochim Biophys Acta</source>. <year>2014</year>;<volume>1844</volume>(<issue>1 Pt A</issue>):<fpage>117</fpage>–<lpage>37</lpage>.<pub-id pub-id-type="pmid">23467008</pub-id></mixed-citation>
    </ref>
    <ref id="bib10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trede</surname><given-names>D</given-names></string-name>, <string-name><surname>Schiffler</surname><given-names>S</given-names></string-name>, <string-name><surname>Becker</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Exploring three-dimensional matrix-assisted laser desorption/ionization imaging mass spectrometry data: three-dimensional spatial segmentation of mouse kidney</article-title>. <source>Anal Chem</source>. <year>2012</year>;<volume>84</volume>(<issue>14</issue>):<fpage>6079</fpage>–<lpage>87</lpage>.<pub-id pub-id-type="pmid">22720760</pub-id></mixed-citation>
    </ref>
    <ref id="bib11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patterson</surname><given-names>NH</given-names></string-name>, <string-name><surname>Doonan</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Daskalopoulou</surname><given-names>SS</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Three-dimensional imaging MS of lipids in atherosclerotic plaques: open-source methods for reconstruction and analysis</article-title>. <source>Proteomics</source>. <year>2016</year>;<volume>16</volume>(<issue>11-12</issue>):<fpage>1642</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">26958804</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdelmoula</surname><given-names>WM</given-names></string-name>, <string-name><surname>Regan</surname><given-names>MS</given-names></string-name>, <string-name><surname>Lopez</surname><given-names>BGC</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Automatic 3D nonlinear registration of mass spectrometry imaging and magnetic resonance imaging data</article-title>. <source>Anal Chem</source>. <year>2019</year>;<volume>91</volume>(<issue>9</issue>):<fpage>6206</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">30932478</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hanrieder</surname><given-names>J</given-names></string-name>, <string-name><surname>Phan</surname><given-names>NTN</given-names></string-name>, <string-name><surname>Kurczy</surname><given-names>ME</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Imaging mass spectrometry in neuroscience</article-title>. <source>ACS Chem Neurosci</source>. <year>2013</year>;<volume>4</volume>(<issue>5</issue>):<fpage>666</fpage>–<lpage>79</lpage>.<pub-id pub-id-type="pmid">23530951</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kaya</surname><given-names>I</given-names></string-name>, <string-name><surname>Brinet</surname><given-names>D</given-names></string-name>, <string-name><surname>Michno</surname><given-names>W</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Novel trimodal MALDI imaging mass spectrometry (IMS3) at 10 μm reveals spatial lipid and peptide correlates implicated in Aβ plaque pathology in Alzheimer’s disease</article-title>. <source>ACS Chem Neurosci</source>. <year>2017</year>;<volume>8</volume>(<issue>12</issue>):<fpage>2778</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">28925253</pub-id></mixed-citation>
    </ref>
    <ref id="bib15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kaya</surname><given-names>I</given-names></string-name>, <string-name><surname>Zetterberg</surname><given-names>H</given-names></string-name>, <string-name><surname>Blennow</surname><given-names>K</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Shedding light on the molecular pathology of amyloid plaques in transgenic Alzheimer’s disease mice using multimodal MALDI imaging mass spectrometry</article-title>. <source>ACS Chem Neurosci</source>. <year>2018</year>;<volume>9</volume>(<issue>7</issue>):<fpage>1802</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">29648443</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kaya</surname><given-names>I</given-names></string-name>, <string-name><surname>Sämfors</surname><given-names>S</given-names></string-name>, <string-name><surname>Levin</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Multimodal MALDI imaging mass spectrometry reveals spatially correlated lipid and protein changes in mouse heart with acute myocardial infarction</article-title>. <source>J Am Soc Mass Spectrom</source>. <year>2020</year>;<volume>31</volume>(<issue>10</issue>):<fpage>2133</fpage>–<lpage>2142</lpage>.<pub-id pub-id-type="pmid">32897704</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>J</given-names></string-name>, <string-name><surname>Caprioli</surname><given-names>RM</given-names></string-name></person-group>. <article-title>Matrix sublimation/recrystallization for imaging proteins by mass spectrometry at high spatial resolution</article-title>. <source>Anal Chem</source>. <year>2011</year>;<volume>83</volume>(<issue>14</issue>):<fpage>5728</fpage>–<lpage>34</lpage>.<pub-id pub-id-type="pmid">21639088</pub-id></mixed-citation>
    </ref>
    <ref id="bib18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdelmoula</surname><given-names>WM</given-names></string-name>, <string-name><surname>Škrášková</surname><given-names>K</given-names></string-name>, <string-name><surname>Balluff</surname><given-names>B</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Automatic generic registration of mass spectrometry imaging data to histology using nonlinear stochastic embedding</article-title>. <source>Anal Chem</source>. <year>2014</year>;<volume>86</volume>(<issue>18</issue>):<fpage>9204</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">25133861</pub-id></mixed-citation>
    </ref>
    <ref id="bib19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patterson</surname><given-names>NH</given-names></string-name>, <string-name><surname>Tuck</surname><given-names>M</given-names></string-name>, <string-name><surname>Van de Plas</surname><given-names>R</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Advanced registration and analysis of MALDI imaging mass spectrometry measurements through autofluorescence microscopy</article-title>. <source>Anal Chem</source>. <year>2018</year>;<volume>90</volume>(<issue>21</issue>):<fpage>12395</fpage>–<lpage>403</lpage>.<pub-id pub-id-type="pmid">30272960</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van de Plas</surname><given-names>R</given-names></string-name>, <string-name><surname>Yang</surname><given-names>J</given-names></string-name>, <string-name><surname>Spraggins</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Image fusion of mass spectrometry and microscopy: a multimodality paradigm for molecular tissue mapping</article-title>. <source>Nat Methods</source>. <year>2015</year>;<volume>12</volume>(<issue>4</issue>):<fpage>366</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">25707028</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Verbeeck</surname><given-names>N</given-names></string-name>, <string-name><surname>Yang</surname><given-names>J</given-names></string-name>, <string-name><surname>De Moor</surname><given-names>B</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Automated anatomical interpretation of ion distributions in tissue: linking imaging mass spectrometry to curated atlases</article-title>. <source>Anal Chem</source>. <year>2014</year>;<volume>86</volume>(<issue>18</issue>):<fpage>8974</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">25153352</pub-id></mixed-citation>
    </ref>
    <ref id="bib22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McCormick</surname><given-names>M</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Jomier</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>ITK: enabling reproducible research and open science</article-title>. <source>Front Neuroinform</source>. <year>2014</year>;<volume>8</volume>:<fpage>13</fpage>.<pub-id pub-id-type="pmid">24600387</pub-id></mixed-citation>
    </ref>
    <ref id="bib23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Insight Toolkit (ITK)</collab>.</person-group><comment><ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.itk.org" ext-link-type="uri">http://www.itk.org</ext-link>. Accessed 22 June 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klein</surname><given-names>S</given-names></string-name>, <string-name><surname>Staring</surname><given-names>M</given-names></string-name>, <string-name><surname>Murphy</surname><given-names>K</given-names></string-name>, <etal>et al.</etal></person-group><article-title>elastix: a toolbox for intensity-based medical image registration</article-title>. <source>IEEE Trans Med Imaging</source>. <year>2010</year>;<volume>29</volume>(<issue>1</issue>):<fpage>196</fpage>–<lpage>205</lpage>.<pub-id pub-id-type="pmid">19923044</pub-id></mixed-citation>
    </ref>
    <ref id="bib25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdelmoula</surname><given-names>WM</given-names></string-name>, <string-name><surname>Pezzotti</surname><given-names>N</given-names></string-name>, <string-name><surname>Hölt</surname><given-names>T</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Interactive visual exploration of 3D mass spectrometry imaging data using hierarchical stochastic neighbor embedding reveals spatiomolecular structures at full data resolution</article-title>. <source>J Proteome Res</source>. <year>2018</year>;<volume>17</volume>(<issue>3</issue>):<fpage>1054</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">29430923</pub-id></mixed-citation>
    </ref>
    <ref id="bib28">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nolden</surname><given-names>M</given-names></string-name>, <string-name><surname>Zelzer</surname><given-names>S</given-names></string-name>, <string-name><surname>Seitel</surname><given-names>A</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The Medical Imaging Interaction Toolkit: challenges and advances: 10 years of open-source development</article-title>. <source>Int J Comput Assist Radiol Surg</source>. <year>2013</year>;<volume>8</volume>(<issue>4</issue>):<fpage>607</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">23588509</pub-id></mixed-citation>
    </ref>
    <ref id="bib29">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schramm</surname><given-names>T</given-names></string-name>, <string-name><surname>Hester</surname><given-names>Z</given-names></string-name>, <string-name><surname>Klinkert</surname><given-names>I</given-names></string-name>, <etal>et al.</etal></person-group><article-title>imzML—a common data format for the flexible exchange and processing of mass spectrometry imaging data</article-title>. <source>J Proteomics</source>. <year>2012</year>;<volume>75</volume>(<issue>16</issue>):<fpage>5106</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">22842151</pub-id></mixed-citation>
    </ref>
    <ref id="bib30">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Afgan</surname><given-names>E</given-names></string-name>, <string-name><surname>Baker</surname><given-names>D</given-names></string-name>, <string-name><surname>Batut</surname><given-names>B</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The Galaxy platform for accessible, reproducible and collaborative biomedical analyses: 2018 update</article-title>. <source>Nucleic Acids Res</source>. <year>2018</year>;<volume>46</volume>(<issue>W1</issue>):<fpage>W537</fpage>–<lpage>44</lpage>.<pub-id pub-id-type="pmid">29790989</pub-id></mixed-citation>
    </ref>
    <ref id="bib31">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Föll</surname><given-names>MC</given-names></string-name>, <string-name><surname>Moritz</surname><given-names>L</given-names></string-name>, <string-name><surname>Wollmann</surname><given-names>T</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Accessible and reproducible mass spectrometry imaging data analysis in Galaxy</article-title>. <source>Gigascience</source>. <year>2019</year>;<volume>8</volume>(<issue>12</issue>):<fpage>giz143</fpage>.<pub-id pub-id-type="pmid">31816088</pub-id></mixed-citation>
    </ref>
    <ref id="bib32">
      <label>30.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Schroeder</surname><given-names>W</given-names></string-name>, <string-name><surname>Martin</surname><given-names>K</given-names></string-name>, <string-name><surname>Lorensen</surname><given-names>B</given-names></string-name></person-group>. <source>The Visualization Toolkit: An object-oriented approach to 3D graphics</source>. <edition>4</edition>th ed. <publisher-loc>Clifton Park, NY</publisher-loc>: <publisher-name>Kitware</publisher-name>; <year>2006</year>.</mixed-citation>
    </ref>
    <ref id="bib33">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Visualization Toolkit (VTK)</collab>.</person-group><comment><ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.vtk.org" ext-link-type="uri">http://www.vtk.org</ext-link>. Accessed 22 June 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib34">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>The Qt Company</collab>.</person-group><comment><ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.qt.io" ext-link-type="uri">http://www.qt.io</ext-link>. Accessed 22 June 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib35">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scherer</surname><given-names>J</given-names></string-name>, <string-name><surname>Nolden</surname><given-names>M</given-names></string-name>, <string-name><surname>Kleesiek</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Joint imaging platform for federated clinical data analytics</article-title>. <source>JCO Clin Cancer Inform</source>. <year>2020</year>;<volume>4</volume>:<fpage>1027</fpage>–<lpage>38</lpage>.<pub-id pub-id-type="pmid">33166197</pub-id></mixed-citation>
    </ref>
    <ref id="bib36">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gustafsson</surname><given-names>OJR</given-names></string-name>, <string-name><surname>Briggs</surname><given-names>MT</given-names></string-name>, <string-name><surname>Condina</surname><given-names>MR</given-names></string-name>, <etal>et al.</etal></person-group><article-title>MALDI imaging mass spectrometry of N-linked glycans on formalin-fixed paraffin-embedded murine kidney</article-title>. <source>Anal Bioanal Chem</source>. <year>2015</year>;<volume>407</volume>(<issue>8</issue>):<fpage>2127</fpage>–<lpage>39</lpage>.<pub-id pub-id-type="pmid">25434632</pub-id></mixed-citation>
    </ref>
    <ref id="bib37">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Perez-Riverol</surname><given-names>Y</given-names></string-name>, <string-name><surname>Csordas</surname><given-names>A</given-names></string-name>, <string-name><surname>Bai</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The PRIDE database and related tools and resources in 2019: improving support for quantification data</article-title>. <source>Nucleic Acids Res</source>. <year>2019</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D442</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">30395289</pub-id></mixed-citation>
    </ref>
    <ref id="bib38">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cordes</surname><given-names>J</given-names></string-name>, <string-name><surname>Enzlein</surname><given-names>T</given-names></string-name>, <string-name><surname>Marsching</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Supporting data for “M<sup>2</sup>aia—Interactive fast and memory-efficient analysis of 2D and 3D multi-modal mass spectrometry imaging data.”</article-title>. <source>GigaScience Database</source>. <year>2021</year>. <pub-id pub-id-type="doi">10.5524/100909</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib40">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Savitzky</surname><given-names>A</given-names></string-name>, <string-name><surname>Golay</surname><given-names>MJE</given-names></string-name></person-group>. <article-title>Smoothing and differentiation of data by simplified least squares procedures</article-title>. <source>Anal Chem</source>. <year>1964</year>;<volume>36</volume>(<issue>8</issue>):<fpage>1627</fpage>–<lpage>39</lpage>.</mixed-citation>
    </ref>
    <ref id="bib39">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Herk</surname><given-names>M</given-names></string-name></person-group>. <article-title>A fast algorithm for local minimum and maximum filters on rectangular and octagonal kernels</article-title>. <source>Pattern Recognit Lett</source>. <year>1992</year>;<volume>13</volume>(<issue>7</issue>):<fpage>517</fpage>–<lpage>21</lpage>.</mixed-citation>
    </ref>
    <ref id="bib41">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Breen</surname><given-names>E</given-names></string-name>, <string-name><surname>Hopewood</surname><given-names>F</given-names></string-name>, <string-name><surname>Williams</surname><given-names>K</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Automatic Poisson peak harvesting for high throughput protein identification</article-title>. <source>Electrophoresis</source>. <year>2000</year>;<volume>21</volume>(<issue>11</issue>):<fpage>2243</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">10892735</pub-id></mixed-citation>
    </ref>
    <ref id="bib42">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van der Maaten</surname><given-names>L</given-names></string-name>, <string-name><surname>Courville</surname><given-names>A</given-names></string-name>, <string-name><surname>Fergus</surname><given-names>R</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Accelerating t-SNE using tree-based algorithms</article-title>. <source>J Mach Learn Res</source>. <year>2014</year>;<volume>15</volume>:<fpage>3221</fpage>–<lpage>45</lpage>.</mixed-citation>
    </ref>
    <ref id="bib43">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nilsson</surname><given-names>P</given-names></string-name>, <string-name><surname>Saito</surname><given-names>T</given-names></string-name>, <string-name><surname>Saido</surname><given-names>TC</given-names></string-name></person-group>. <article-title>New mouse model of Alzheimer’s</article-title>. <source>ACS Chem Neurosci</source>. <year>2014</year>;<volume>5</volume>(<issue>7</issue>):<fpage>499</fpage>–<lpage>502</lpage>.<pub-id pub-id-type="pmid">24852598</pub-id></mixed-citation>
    </ref>
    <ref id="bib44">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gustafsson</surname><given-names>OJR</given-names></string-name>, <string-name><surname>Briggs</surname><given-names>MT</given-names></string-name>, <string-name><surname>Condina</surname><given-names>MR</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Raw <italic toggle="yes">N</italic>-glycan mass spectrometry imaging data on formalin-fixed mouse kidney</article-title>. <source>Data Brief</source>. <year>2018</year>;<volume>21</volume>:<fpage>185</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30364692</pub-id></mixed-citation>
    </ref>
    <ref id="bib45">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bemis</surname><given-names>KD</given-names></string-name>, <string-name><surname>Harry</surname><given-names>A</given-names></string-name>, <string-name><surname>Eberlin</surname><given-names>LS</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Cardinal: an R package for statistical analysis of mass spectrometry-based imaging experiments</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>14</issue>):<fpage>2418</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">25777525</pub-id></mixed-citation>
    </ref>
    <ref id="bib46">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tibshirani</surname><given-names>R</given-names></string-name>, <string-name><surname>Hastie</surname><given-names>T</given-names></string-name>, <string-name><surname>Narasimhan</surname><given-names>B</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Class prediction by nearest shrunken centroids, with applications to DNA microarrays</article-title>. <source>Stat Sci</source>. <year>2003</year>;<volume>18</volume>(<issue>1</issue>):<fpage>104</fpage>–<lpage>17</lpage>.</mixed-citation>
    </ref>
    <ref id="bib47">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bemis</surname><given-names>KD</given-names></string-name>, <string-name><surname>Harry</surname><given-names>A</given-names></string-name>, <string-name><surname>Eberlin</surname><given-names>LS</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Probabilistic segmentation of mass spectrometry (MS) images helps select important ions and characterize confidence in the resulting segments</article-title>. <source>Mol Cell Proteomics</source>. <year>2016</year>;<volume>15</volume>(<issue>5</issue>):<fpage>1761</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">26796117</pub-id></mixed-citation>
    </ref>
    <ref id="bib48">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cordes</surname><given-names>J</given-names></string-name></person-group>. <article-title>Supporting protocol for use-case 1: N-linked glycan m/z candidate detection in “M2aia—Interactive, fast and memory efficient analysis of 2D and 3D multi-modal mass spectrometry imaging data.”</article-title>. <source>protocols.io</source>. <year>2021</year>. <pub-id pub-id-type="doi">10.17504/protocols.io.bvq5n5y6</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib49">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cordes</surname><given-names>J</given-names></string-name></person-group>. <article-title>Supporting protocol for use-case 1: Dimensionality reduction in “M2aia—Interactive, fast and memory efficient analysis of 2D and 3D multi-modal mass spectrometry imaging data.”</article-title>. <source>protocols.io</source>. <year>2021</year>. <pub-id pub-id-type="doi">10.17504/protocols.io.brw4m7gw</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib50">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cordes</surname><given-names>J</given-names></string-name></person-group>. <article-title>Supporting capsule for use-case 1: R-based processing in “M<sup>2</sup>aia—Interactive, fast and memory efficient analysis of 2D and 3D multi-modal mass spectrometry imaging data.”</article-title>. <source>CodeOcean</source>. <year>2021</year>. <pub-id pub-id-type="doi">10.24433/CO.2384502.v1</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib51">
      <label>49.</label>
      <mixed-citation publication-type="journal"><comment>M<sup>2</sup>aia Github repository; R-based processing for use-case 1 “N-linked glycan m/z candidate detection.” <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/jtfcordes/m2aia/blob/v2021.01.01/Scripts/N-Glycan-CandidateDetection_UseCase1.R" ext-link-type="uri">https://github.com/jtfcordes/m2aia/blob/v2021.01.01/Scripts/N-Glycan-CandidateDetection_UseCase1.R</ext-link>. Accessed 22 June 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib52">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cordes</surname><given-names>J</given-names></string-name></person-group>. <article-title>Supporting capsule for use-case 1: Command-line application based pre-processing in “M<sup>2</sup>aia—Interactive, fast and memory efficient analysis of 2D and 3D multi-modal mass spectrometry imaging data.”</article-title>. <source>CodeOcean</source>. <year>2021</year>. <pub-id pub-id-type="doi">10.24433/CO.7662658.v1</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib53">
      <label>51.</label>
      <mixed-citation publication-type="journal"><comment>M<sup>2</sup>aia Github repository; Command-line application for use-case 1 “N-linked glycan m/z candidate detection.” <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/jtfcordes/m2aia/blob/v2021.01.01/Modules/M2aiaCLI/NLinkedGlycan.cpp" ext-link-type="uri">https://github.com/jtfcordes/m2aia/blob/v2021.01.01/Modules/M2aiaCLI/NLinkedGlycan.cpp</ext-link>. Accessed 22 June 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib54">
      <label>52.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cordes</surname><given-names>J</given-names></string-name></person-group>. <article-title>Supporting protocol for use-case 2: Multi-modal 3D image reconstruction in “M2aia— Interactive, fast and memory efficient analysis of 2D and 3D multi-modal mass spectrometry imaging data.”</article-title>. <source>protocols.io</source>. <year>2021</year>. <pub-id pub-id-type="doi">10.17504/protocols.io.bvq8n5zw</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib55">
      <label>53.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satyanarayanan</surname><given-names>M</given-names></string-name>, <string-name><surname>Goode</surname><given-names>A</given-names></string-name>, <string-name><surname>Gilbert</surname><given-names>B</given-names></string-name>, <etal>et al.</etal></person-group><article-title>OpenSlide: A vendor-neutral software foundation for digital pathology</article-title>. <source>J Pathol Inform</source>. <year>2013</year>;<volume>4</volume>:<fpage>27</fpage>.<pub-id pub-id-type="pmid">24244884</pub-id></mixed-citation>
    </ref>
    <ref id="bib56">
      <label>54.</label>
      <mixed-citation publication-type="journal"><comment>M<sup>2</sup>aia; Github Release Page 2021.01.01. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/jtfcordes/m2aia/releases/tag/v2021.01.01" ext-link-type="uri">https://github.com/jtfcordes/m2aia/releases/tag/v2021.01.01</ext-link>. Accessed 22 June 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib57">
      <label>55.</label>
      <mixed-citation publication-type="journal"><comment>M<sup>2</sup>aia; Archived Release version 2021.01.01. </comment><pub-id pub-id-type="doi">10.5281/zenodo.4471358</pub-id><comment>. Accessed 22 June 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib59">
      <label>56.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>MITK Github repository</collab></person-group>; <comment>snapshots/2020-12-21. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/MITK/MITK/tree/snapshots/2020-12-21" ext-link-type="uri">https://github.com/MITK/MITK/tree/snapshots/2020-12-21</ext-link>. Accessed 22 June 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib60">
      <label>57.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>elastix image registration toolbox Github repository</collab></person-group>; <comment>v5.0.0. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/SuperElastix/elastix/releases/tag/5.0.0" ext-link-type="uri">https://github.com/SuperElastix/elastix/releases/tag/5.0.0</ext-link>. Accessed 22 June 2021</comment>.</mixed-citation>
    </ref>
  </ref-list>
</back>
