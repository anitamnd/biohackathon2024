<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.0 20040830//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Environ Microbiol</journal-id>
    <journal-id journal-id-type="publisher-id">emi</journal-id>
    <journal-title-group>
      <journal-title>Environmental Microbiology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1462-2912</issn>
    <issn pub-type="epub">1462-2920</issn>
    <publisher>
      <publisher-name>Blackwell Publishing Ltd</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2909393</article-id>
    <article-id pub-id-type="doi">10.1111/j.1462-2920.2010.02193.x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Ironing out the wrinkles in the rare biosphere through improved OTU clustering</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Huse</surname>
          <given-names>Susan M</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Welch</surname>
          <given-names>David Mark</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Morrison</surname>
          <given-names>Hilary G</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sogin</surname>
          <given-names>Mitchell L</given-names>
        </name>
        <xref ref-type="corresp" rid="cor1">*</xref>
      </contrib>
      <aff>
        <institution>Josephine Bay Paul Center, Marine Biological Laboratory at Woods Hole</institution>
        <addr-line>7 MBL Street, Woods Hole, MA 02543, USA</addr-line>
      </aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">*For correspondence. E-mail <email>sogin@mbl.edu</email>; Tel. (+1) 508 289 7246; Fax (+1) 508 457 4727.</corresp>
      <fn>
        <p>Re-use of this article is permitted in accordance with the Terms and Conditions set out at <ext-link ext-link-type="uri" xlink:href="http://www3.interscience.wiley.com/authorresources/onlineopen.html">http://www3.interscience.wiley.com/authorresources/onlineopen.html</ext-link></p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2010</year>
    </pub-date>
    <volume>12</volume>
    <issue>7</issue>
    <fpage>1889</fpage>
    <lpage>1898</lpage>
    <history>
      <date date-type="received">
        <day>01</day>
        <month>12</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>1</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2010 Society for Applied Microbiology and Blackwell Publishing Ltd</copyright-statement>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.5/">
        <license-p>Re-use of this article is permitted in accordance with the Creative Commons Deed, Attribution 2.5, which does not permit commercial exploitation.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Deep sequencing of PCR amplicon libraries facilitates the detection of low-abundance populations in environmental DNA surveys of complex microbial communities. At the same time, deep sequencing can lead to overestimates of microbial diversity through the generation of low-frequency, error-prone reads. Even with sequencing error rates below 0.005 per nucleotide position, the common method of generating operational taxonomic units (OTUs) by multiple sequence alignment and complete-linkage clustering significantly increases the number of predicted OTUs and inflates richness estimates. We show that a 2% single-linkage preclustering methodology followed by an average-linkage clustering based on pairwise alignments more accurately predicts expected OTUs in both single and pooled template preparations of known taxonomic composition. This new clustering method can reduce the OTU richness in environmental samples by as much as 30–60% but does not reduce the fraction of OTUs in long-tailed rank abundance curves that defines the rare biosphere.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="">
    <title>Introduction</title>
    <p>Massively parallel pyrosequencing of ribosomal RNA (rRNA) coding regions that evolve rapidly allows the detection of very low abundance populations in complex microbial communities. Each processed sequence (pyrotag) more or less serves as a proxy for the occurrence of a microbial genome in an environmental DNA sample. Matching pyrotags to a reference rRNA database or clustering tags in a taxon-independent manner to identify operational taxonomic units (OTUs) suggests that taxonomic richness in marine, terrestrial and microbiome communities exceeds all prior estimates of microbial diversity. Many of the novel OTUs correspond to low-abundance organisms of the ‘rare biosphere’ (<xref ref-type="bibr" rid="b15">Pedros-Alio, 2006</xref>; <xref ref-type="bibr" rid="b16">2007</xref>;). However, the ability to generate more comprehensive descriptions of microbial diversity through deep sequencing introduces new challenges when estimating diversity, and questions have been raised about the accuracy of OTU richness estimates and the extent of the rare biosphere. Sequencing errors coupled with inadequate choice of clustering algorithms can lead to artificially elevated estimates of community richness.</p>
    <p>Quality-controlled sequence reads of 16S rRNA V6 hypervariable region amplicon libraries produced by the Roche Genome Sequencer 20 System (GS 20) have a per-base error rate of 0.25% (<xref ref-type="bibr" rid="b10">Huse <italic>et al.</italic>, 2007</xref>), which is comparable to a average phred score better than 25 on contemporary capillary instruments (<xref ref-type="bibr" rid="b5">Ewing and Green, 1998</xref>; <xref ref-type="bibr" rid="b6">Ewing <italic>et al.</italic>, 1998</xref>). For targets such as the short V6 rRNA hypervariable region that initially revealed the existence of the rare biosphere, 1 inaccurate nucleotide per 400 positions translates into 13% of the reads containing at least 1 inaccuracy. The number of sequences containing errors scales with the size of the sequencing effort, with larger data sets yielding a greater number of distinct sequencing variants. Instead of estimating diversity according to the number of unique sequences recovered, clustering methods based on either phylogenetic inferences or sequence similarities can define membership in an OTU. Similarity between rRNA genes equal to or greater than 97% often serves as a benchmark for assigning sequences to the same OTU. Yet even with very low sequencing error rates, the very large data sets produced by massively parallel sequencing will inevitably contain a fraction of reads with multiple errors, which can lead to overestimates of diversity.</p>
    <p>Recent reports have demonstrated the difficulties in clustering sequences into the appropriate number of OTUs in a sample based upon either unique rRNA pyrotags or 3% clusters. <xref ref-type="bibr" rid="b12">Kunin and colleagues (2010</xref>) explored how intrinsic pyrosequencing errors can lead to inflated estimates of diversity. Using the Markov Cluster algorithm (<xref ref-type="bibr" rid="b25">Van Dongen, 2008</xref>) they identified several hundred OTUs in pairwise alignments of ∼8000 300 nt reads from both the 5′ (4254 reads) and the 3′ end (4244 reads) of the <italic>Escherichia coli</italic> MG1655 rRNA gene. They examined the impact of quality filters including those outlined by <xref ref-type="bibr" rid="b10">Huse and colleagues (2007</xref>) as well as filters thatincorporate an improved quality-scoring algorithm that allows for a minimum average quality score and more stringent end-trimming (<xref ref-type="bibr" rid="b2">Brockman <italic>et al.</italic>, 2008</xref>). By applying a stringent quality filter minimum of ≤ 0.2% error and computing 3% pyrotag clusters, <xref ref-type="bibr" rid="b12">Kunin and colleagues (2010</xref>) obtained the predicted estimates of diversity for a single microbial genome.</p>
    <p>A different strategy for minimizing the contribution of pyrosequencing error to inflated estimates of diversity relies upon the program PyroNoise (<xref ref-type="bibr" rid="b17">Quince <italic>et al.</italic>, 2009</xref>). This algorithm corrects pyrosequences that are statistically more likely to be a variant of a common read caused by pyrosequencing error than an infrequent novel sequence. Rather than relying on the Roche base-calling algorithm and associated quality scores, PyroNoise evaluates the underlying flowgrams from the Roche Genome Sequencer FLX System (GS FLX). The combination of PyroNoise, multiple sequence alignment and complete linkage clustering (MS-CL) identified ∼60 OTUs in an analysis of pyrotags from a pooled template preparation (<xref ref-type="bibr" rid="b17">Quince <italic>et al.</italic>, 2009</xref>). Without PyroNoise, the same clustering procedure inflated diversity to ∼6000 OTUs. In an environmental sample of 16 222 pyrotags from Priest Pot Lake, PyroNoise reduced the OTU richness from 1327 to 855. However, the current implementation of PyroNoise requires very large computational resources (<xref ref-type="bibr" rid="b17">Quince <italic>et al.</italic>, 2009</xref>).</p>
    <p><xref ref-type="bibr" rid="b22">Sun and colleagues (2009</xref>) evaluated the impact of using pairwise (PW) alignments between sequences rather than the commonly used multiple sequence (MS) aligners, e.g. MUSCLE (<xref ref-type="bibr" rid="b4">Edgar, 2004</xref>), ClustalW (<xref ref-type="bibr" rid="b23">Thompson <italic>et al.</italic>, 1994</xref>) or NAST (<xref ref-type="bibr" rid="b3">Desantis <italic>et al.</italic>, 2006</xref>). Pairwise alignments reduced the number of OTUs by ∼30% compared with MS alignments. Performing pairwise alignments for hundreds of thousands of sequences requires a large number of CPU cycles. <xref ref-type="bibr" rid="b22">Sun and colleagues (2009</xref>) devised a filter using the more efficient kmer distances to preselect from all possible pairwise combinations only those combinations needed for clustering. For example, precisely computing pairwise distances for sequences differing by more than 10% is not required for creating accurate 3% clusters. Their program ESPRIT incorporates the kmer prefiltering of pairwise distances followed by a Needleman-Wunsch alignment (<xref ref-type="bibr" rid="b14">Needleman and Wunsch, 1970</xref>) for all sequence pairs of interest. This program makes pairwise alignments feasible for even very large samples.</p>
    <p>Each of these studies focused on one aspect of determining OTUs based on sequence similarity, either pyrosequencing error or alignment. Here we evaluate multiple facets of the entire clustering process, specifically the contribution of sequencing error, alignment method and clustering algorithm to the number of observed OTUs for communities of known taxonomic composition. We set our cluster threshold at 3% to minimize the influence of sequencing errors and to be consistent with the work cited above and with the majority of microbial diversity publications (<xref ref-type="bibr" rid="b21">Stackebrandt and Goebel, 1994</xref>). We amplified and pyrosequenced the V6 hypervariable region of the ribosomal RNA gene from single- and multiple-template pools to determine a simple and computationally effective method for accurately clustering short hypervariable pyrotags. We then applied this new clustering method to multiple published environmental samples to determine the nature and extent of OTU inflation in diverse samples.</p>
  </sec>
  <sec sec-type="">
    <title>Results</title>
    <p>To assess the accuracy of sequence clustering methods, we generated amplicon libraries of the V6 region from several DNA preparations of known 16S rRNA coding region composition: (i) cultures of a single clone (colony forming unit) of <italic>E. coli</italic>, which contains seven 16S operons with two distinct V6 hypervariable region sequences; (ii) cultures of a single clone of <italic>Staphylococcus epidermidis</italic>, which contains six 16S rRNA operons with two distinct V6 sequences; (iii) a plasmid clone containing a nearly full-length 16S rRNA coding region from <italic>E. coli</italic> 16S rRNA operon A, (iv) a plasmid clone containing a nearly full-length 16S rRNA coding region from <italic>S. epidermidis</italic> 16S rRNA operon 9; and (v) a mixture of 43 plasmid clones (Clone-43) containing partial 16S rRNA coding regions that span the V6 hypervariable region of distinct 16S rRNA genes amplified from a deep-sea hydrothermal vent community (<xref ref-type="bibr" rid="b10">Huse <italic>et al.</italic>, 2007</xref>). We sequenced approximately 200 000 high-quality reads from each of the genomic template <italic>E. coli</italic> and <italic>S. epidermidis</italic> libraries and from the mixed template Clone-43 library, and approximately 30 000 high-quality reads from the single template <italic>E. coli</italic> and <italic>S. epidermidis</italic> plasmid clone libraries. The amplified V6 regions of <italic>E. coli</italic> and <italic>S. epidermidis</italic> are 60 and 62 nt respectively. The V6 region of the Clone-43 mixture ranges from 57 to 145 nt.</p>
    <sec>
      <title>PCR and pyrosequencing error</title>
      <p>Prior to calculating the sequencing error rate, we eliminated the 11–19% of all reads that did not pass previously described quality filtering (<xref ref-type="bibr" rid="b10">Huse <italic>et al.</italic>, 2007</xref>; <xref ref-type="bibr" rid="b12">Kunin <italic>et al.</italic>, 2010</xref>). Our requirement that valid reads and their best match in a database of 16S rRNA sequences have an alignment ≥ 80% of the read's length (<xref ref-type="supplementary-material" rid="SD2">Table S1</xref>) eliminated an additional 0.02–0.14% of the reads. Comparing the reads that failed this criterion to the GenBank, non-redundant sequence database showed that many represented non-V6 amplification products. A small number of the aberrant reads contained insertion artefacts in the V6 amplicons. Short, highly diverse amplicon libraries that do not contain conserved regions will produce few if any chimeric reads (S.M. Huse, unpubl. obs.), and we assume that the minimum GAST alignment length requirement removed any inter-template chimeras in the Clone-43 data set. The large number of similar amplicons in the <italic>E. coli</italic> and <italic>S. epidermidis</italic> genomic template data sets led to the formation of several obvious within-species chimeras that we identified and removed based upon our knowledge of the sequences.</p>
      <p>Differences between a pyrotag sequence and its template reflect a combination of PCR and pyrosequencing error. We calculated the combined error rate, understanding that any unfiltered contamination, chimeras or non-rRNA amplification will increase our error rate estimates. We define the error rate for a given sequence as the number of insertions, deletions and substitutions in a sequence as compared with its template, divided by the length of the template sequence. The error rate varied between data sets, ranging from 0.0021 to 0.0042 (<xref ref-type="supplementary-material" rid="SD2">Table S2</xref>). This fits within the range we reported previously using a GS20 platform (<xref ref-type="bibr" rid="b10">Huse <italic>et al.</italic>, 2007</xref>) and compares with the error rate of capillary sequence data with an average phred score of 24-27.</p>
      <p>If pyrosequencing errors occurred at random, the number of expected sequences with exactly <italic>n</italic> errors would follow the binomial distribution. <xref ref-type="supplementary-material" rid="SD1">Figure S1</xref> shows that sequences having 1 error occurred less frequently than expected, while those with 3 or more errors exceeded expectations for a random distribution. Thus, a small proportion of the sequences contained multiple errors not predicted by the binomial distribution. In analyses of GS20 data, we previously reported that a limited number of sequences contained multiple errors (<xref ref-type="bibr" rid="b10">Huse <italic>et al.</italic>, 2007</xref>), which agrees with the known propensity for pyrosequencing technology to produce a small number of reads with many errors likely from beads on which the growing DNA strands fall out of phase or from multi-templated beads of similar sequence. Despite this non-random distribution, the vast majority of reads (&gt; 99%) display no more than two differences (&lt; 3.5% variation) from their parent templates (<xref ref-type="supplementary-material" rid="SD2">Table S2</xref>). We had previously assumed that pyrotags with 3% or fewer errors would cluster with their parent sequence while errant pyrotags containing more than 3% errors would likely form a new singleton OTU, but might occasionally join a cluster of closely related errant sequences. <xref ref-type="table" rid="tbl1">Table 1</xref> shows that the number of 3% OTUs calculated using the common method of multiple sequence alignment and complete-linkage clustering (MS-CL) exceeds the sum of expected template OTUs (based upon the known number of rRNA coding regions in each template pool) plus the number of clusters that would occur if each errant sequence &gt; 3% variant formed a new OTU. This suggests that sources other than pyrosequencing error can inflate OTU estimates.</p>
      <table-wrap id="tbl1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Number of OTUs for different clustering methods.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1">Expected OTUs</th>
              <th align="center" rowspan="1" colspan="1">Maximum expected due to errors</th>
              <th align="center" rowspan="1" colspan="1">MS-CL</th>
              <th align="center" rowspan="1" colspan="1">PW-AL</th>
              <th align="center" rowspan="1" colspan="1">SLP/PW-AL</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Template samples</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"><italic>E. coli</italic> (<italic>n</italic> = 215 618)</td>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td align="center" rowspan="1" colspan="1">378<sup>1</sup></td>
              <td align="center" rowspan="1" colspan="1">1042</td>
              <td align="center" rowspan="1" colspan="1">277</td>
              <td align="center" rowspan="1" colspan="1">88</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"><italic>E. coli</italic> SSU A (<italic>n</italic> = 31 030)</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">23<sup>1</sup></td>
              <td align="center" rowspan="1" colspan="1">137</td>
              <td align="center" rowspan="1" colspan="1">25</td>
              <td align="center" rowspan="1" colspan="1">10</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"><italic>S. epidermidis</italic> (<italic>n</italic> = 197 876)</td>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td align="center" rowspan="1" colspan="1">769<sup>1</sup></td>
              <td align="center" rowspan="1" colspan="1">1267</td>
              <td align="center" rowspan="1" colspan="1">323</td>
              <td align="center" rowspan="1" colspan="1">128</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"><italic>S. epidermidis SSU 9</italic> (<italic>n</italic> = 37 587)</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">85<sup>1</sup></td>
              <td align="center" rowspan="1" colspan="1">205</td>
              <td align="center" rowspan="1" colspan="1">37</td>
              <td align="center" rowspan="1" colspan="1">20</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Clone-43 (v6) (<italic>n</italic> = 202 340)</td>
              <td align="center" rowspan="1" colspan="1">43</td>
              <td align="center" rowspan="1" colspan="1">630<sup>1</sup></td>
              <td align="center" rowspan="1" colspan="1">2473</td>
              <td align="center" rowspan="1" colspan="1">458</td>
              <td align="center" rowspan="1" colspan="1">275</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Clone-43 v4-5 (232 nt, <italic>n</italic> = 16 673)</td>
              <td align="center" rowspan="1" colspan="1">42</td>
              <td align="center" rowspan="1" colspan="1">23<sup>1</sup></td>
              <td align="center" rowspan="1" colspan="1">126</td>
              <td align="center" rowspan="1" colspan="1">51</td>
              <td align="center" rowspan="1" colspan="1">54</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Clone-90 (241 nt, <italic>n</italic> = 34 308)</td>
              <td align="center" rowspan="1" colspan="1">30</td>
              <td align="center" rowspan="1" colspan="1">34–69<sup>2</sup></td>
              <td align="center" rowspan="1" colspan="1">237</td>
              <td align="center" rowspan="1" colspan="1">65</td>
              <td align="center" rowspan="1" colspan="1">62</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Natural samples</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Deep-sea vent <italic>Archaea</italic> (<italic>n</italic> = 63 133)</td>
              <td align="center" rowspan="1" colspan="1">N/A</td>
              <td align="center" rowspan="1" colspan="1">63–126<sup>2</sup></td>
              <td align="center" rowspan="1" colspan="1">709</td>
              <td align="center" rowspan="1" colspan="1">483</td>
              <td align="center" rowspan="1" colspan="1">470</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">English Channel (<italic>n</italic> = 12 851)</td>
              <td align="center" rowspan="1" colspan="1">N/A</td>
              <td align="center" rowspan="1" colspan="1">13–26<sup>2</sup></td>
              <td align="center" rowspan="1" colspan="1">1154</td>
              <td align="center" rowspan="1" colspan="1">880</td>
              <td align="center" rowspan="1" colspan="1">859</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Human Gut (<italic>n</italic> = 15 239)</td>
              <td align="center" rowspan="1" colspan="1">N/A</td>
              <td align="center" rowspan="1" colspan="1">15–30<sup>2</sup></td>
              <td align="center" rowspan="1" colspan="1">803</td>
              <td align="center" rowspan="1" colspan="1">625</td>
              <td align="center" rowspan="1" colspan="1">566</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Sewage (<italic>n</italic> = 33 082)</td>
              <td align="center" rowspan="1" colspan="1">N/A</td>
              <td align="center" rowspan="1" colspan="1">33–66<sup>2</sup></td>
              <td align="center" rowspan="1" colspan="1">2383</td>
              <td align="center" rowspan="1" colspan="1">1881</td>
              <td align="center" rowspan="1" colspan="1">1831</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">North Atlantic Deep Water (<italic>n</italic> = 15 497)</td>
              <td align="center" rowspan="1" colspan="1">N/A</td>
              <td align="center" rowspan="1" colspan="1">15–30<sup>2</sup></td>
              <td align="center" rowspan="1" colspan="1">1713</td>
              <td align="center" rowspan="1" colspan="1">1363</td>
              <td align="center" rowspan="1" colspan="1">1339</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn>
            <p>For both known template and environmental samples, we calculated the number of expected OTUs (known templates only) and the number generated using several alignment and clustering methods. We calculated the maximum additional OTUs expected due to errors using either (1) the count of unique sequences having more than 2 errors in the template pool (superscript ‘1’ in the table), or (2) 1–2 OTUs for every 1000 tags (superscript ‘2’ in the table). MS is a multiple sequence alignment, PW is a pairwise alignment, CL is complete-linkage clustering, AL is average-linkage clustering, and SLP is single-linkage preclustering.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Effect of alignment and clustering methods</title>
      <p>To evaluate the tendency of clustering methods to inflate the number of OTUs, we examined the behaviour of various approaches on sequences that differed by less than 3.5% (or 2 errors) from their template [the commonly used program, mothur (<xref ref-type="bibr" rid="b19">Schloss <italic>et al.</italic>, 2009</xref>), rounds distances to the nearest whole per cent when defining a cluster]. We found that MS-CL returned 129 instead of the two expected <italic>E. coli</italic> OTUs, 89 rather than the two expected <italic>S. epidermidis</italic> OTUs and 694 Clone-43 OTUs rather than the expected 43 (<xref ref-type="table" rid="tbl2">Table 2</xref>). Clearly, the clustering methodology propagates additional OTUs. To determine the cause(s) of this inflation we examined the effects of sequence alignment and clustering method on the number of OTUs generated from sequences that differ by less than 3.5%.</p>
      <table-wrap id="tbl2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Effect of clustering algorithm on sequences within 3% of their template.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1">
                <italic>Escherichia coli</italic>
              </th>
              <th align="center" rowspan="1" colspan="1">
                <italic>Staphylococcus epidermidis</italic>
              </th>
              <th align="center" rowspan="1" colspan="1"><italic>Escherichia coli</italic> operon A</th>
              <th align="center" rowspan="1" colspan="1"><italic>Staphylococcus epidermidis</italic> operon 9</th>
              <th align="center" rowspan="1" colspan="1">Clone-43</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Expected</td>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">43</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">MS-CL</td>
              <td align="center" rowspan="1" colspan="1">129</td>
              <td align="center" rowspan="1" colspan="1">89</td>
              <td align="center" rowspan="1" colspan="1">29</td>
              <td align="center" rowspan="1" colspan="1">26</td>
              <td align="center" rowspan="1" colspan="1">694</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">MS-AL</td>
              <td align="center" rowspan="1" colspan="1">54</td>
              <td align="center" rowspan="1" colspan="1">44</td>
              <td align="center" rowspan="1" colspan="1">6</td>
              <td align="center" rowspan="1" colspan="1">12</td>
              <td align="center" rowspan="1" colspan="1">218</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">MS-SL</td>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td align="center" rowspan="1" colspan="1">57</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">PW-CL</td>
              <td align="center" rowspan="1" colspan="1">6</td>
              <td align="center" rowspan="1" colspan="1">5</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">308</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">PW-AL</td>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">43</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">PW-SL</td>
              <td align="center" rowspan="1" colspan="1">2</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">1</td>
              <td align="center" rowspan="1" colspan="1">43</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn>
            <p>For each of five defined template preparations, we used combinations of alignment and clustering methods to create 3% OTUs.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>We first tested the effect of alignment strategies on the number of OTUs. Differences between hypervariable rRNA coding regions include a combination of elevated rates of nucleotide substitution, insertions and deletions that lead to considerable uncertainty in multiple sequence alignments. <xref ref-type="bibr" rid="b22">Sun and colleagues (2009</xref>) showed that combining thousands of such diverse sequences in one alignment can inflate the number of OTUs. Their pairwise alignments of pyrotags consistently yielded fewer OTUs than the multiple sequence alignments from MUSCLE, NAST or RDP-Pyro. We found that using a Needleman-Wunsch pairwise alignment rather than an unstructured multiple sequence alignment removed from 56% to 97% of the spurious OTUs in data sets containing only sequences less than 3.49% different from their template (<xref ref-type="table" rid="tbl2">Table 2</xref>).</p>
      <p>We examined the effect of three clustering algorithms: complete linkage, i.e. furthest neighbour, average linkage, i.e. average neighbour or <sc>upgma</sc> and single linkage, i.e. nearest neighbour. These algorithms employ different rules to determine whether a new sequence adds to an existing cluster or initiates formation of a new cluster. When using a 3% cut-off criterion for adding sequences to a cluster, complete linkage requires that a new sequence be less than 3% different from <italic>every</italic> other sequence already in the cluster; average linkage requires that the <italic>average</italic> distance between the new sequence and every sequence already in the cluster be less than 3%; and single linkage requires only that the new sequence be less than 3% different from <italic>any one</italic> read within the cluster. Regardless of alignment method, complete linkage produced more OTUs than expected (<xref ref-type="table" rid="tbl2">Table 2</xref>).</p>
      <p>In the absence of sequencing error greater than 3%, the combination of pairwise alignment and average-linkage clustering successfully eliminated all spurious OTUs from our five simplified data sets containing errors &lt; 3% (<xref ref-type="table" rid="tbl2">Table 2</xref>). <xref ref-type="bibr" rid="b17">Quince and colleagues (2009</xref>) also found that average-linkage clustering provides better results in the presence of noise. We applied this method to complete data sets (containing errors &gt; 3%). As expected, we eliminated most but not all spurious OTUs because the data sets include sequences with too many errors to cluster with their template (<xref ref-type="table" rid="tbl1">Table 1</xref>, <xref ref-type="fig" rid="fig01">Fig. 1</xref>).</p>
      <fig id="fig01" position="float">
        <label>Fig. 1</label>
        <caption>
          <p>Effect of clustering method on the number of OTUs. We created OTU clusters of the three known template preparations using combinations of multiple sequence and pairwise alignments, complete-linkage and average-linkage clustering, and single-linkage preclustering. Each method provides distinctly different numbers of OTUs for the same data. For short hypervariable tags sequenced at depth, the single-linkage preclustering using pairwise alignments, followed by an average linkage clustering (SLP / PW-AL) provides the most accurate results.</p>
        </caption>
        <graphic xlink:href="emi0012-1889-f1"/>
      </fig>
    </sec>
    <sec>
      <title>Creating preclusters represented by single sequences</title>
      <p>To reduce the number of spurious clusters produced by errant sequences, we introduced a modified single-linkage preclustering (SLP) step. We sorted sequences in abundance order before using the single-linkage algorithm to cluster sequences that differ by only 2%. Unlike other single-linkage algorithms, SLP does not merge two clusters when incorporating a new sequence that is within 2% of both; instead, it assigns the new sequence to the cluster containing the most abundant sequences. We chose a 2% preclustering width because the preclustering width must be less than the final clustering width, and because 2%, which corresponds to a single nucleotide change in a short, 60 nt read, is the smallest threshold that can be applied to V6 pyrotag sequences. Finally, SLP assigns the most abundant sequence as the representative of each precluster in a 3% average-linkage clustering of the full data set. This single-linkage preclustering approach reduced the number of spurious OTUs in data sets of known composition by ∼90% (<xref ref-type="table" rid="tbl1">Table 1</xref>). We applied this method to the analysis of longer pyrotags from DNA preparations of known composition: the V4-V5 region of Clone-43 (average sequence length 232 nt) and a data set of ∼240 nt including the V5 region from 90 plasmid templates (Clone-90) initially analysed by <xref ref-type="bibr" rid="b17">Quince and colleagues (2009</xref>). These longer sequences show lower rates of OTU inflation, perhaps because so many more changes in the sequence are needed to exceed 3%. The SLP step removed nearly all of the spurious OTUs from both of these data sets (<xref ref-type="table" rid="tbl1">Table 1</xref>). Single-linkage clustering normally carries the risk of over-aggregating sequences in complex samples. If the sequence space contains abundant template sequences surrounded by decreasing numbers of variants, then presorting by abundance prohibits the chaining together of template sequences with increasing divergence. Only those templates that are less than 3% different will fall into the same cluster, and these sequences should cluster together under any algorithm. Inspection of the OTUs generated in all of these samples showed that the SLP method succeeded in placing variant sequences with three or even four errors into OTUs with their template sequence, but did not aggregate template sequences that differed by more than 3%.</p>
      <p>To assess the remaining OTU inflation caused by errant sequences that SLP did not aggregate, we used SLP/PW-AL to determine OTUs in subsamples of the two genomic templates and the multiple-template Clone-43 data set at depths from 100 to ∼200 000 tags (197 846 sequences for <italic>S. epidermidis</italic>). As <xref ref-type="fig" rid="fig02">Fig. 2</xref> illustrates, the number of spurious OTUs generated is a function of sampling depth. The Clone-43 sample, with the highest ratio of spurious OTUs, has 234 extra OTUs at a sampling depth of 200 000. The <italic>E. coli</italic> sample had a rate less than half of that with only 85 extra OTUs at 200 000 sequences. Although the curves are not linear, they show that we can expect between one and two spurious OTUs per 1000 reads.</p>
      <fig id="fig02" position="float">
        <label>Fig. 2</label>
        <caption>
          <p>Number of additional OTUs as a function of sample depth. For the two genomic templates, <italic>E. coli</italic> and <italic>S. epidermidis</italic>, and the multiple template Clone-43 samples, we calculated the number of spurious OTUs as a function of sample depth.</p>
        </caption>
        <graphic xlink:href="emi0012-1889-f2"/>
      </fig>
    </sec>
    <sec>
      <title>Comparison to PyroNoise</title>
      <p>We compared the SLP approach to PyroNoise (<xref ref-type="supplementary-material" rid="SD2">Table S3</xref>), using two samples previously analysed with PyroNoise (<xref ref-type="bibr" rid="b17">Quince <italic>et al.</italic>, 2009</xref>), and three additional samples (two environmental and the Clone-43 pooled-template preparation). Both methods reduced the number of OTUs by approximately 30–50%. None of the SLP/PW-AN OTUs contained multiple high abundance sequences that differed by more than 3%.</p>
    </sec>
    <sec>
      <title>Impact on environmental data sets and the rare biosphere</title>
      <p>We compared the effect of the MS-CL and SLP/PW-AL methods of clustering on the distribution of OTU abundances in bacterial V6 amplicon libraries representing samples from the English Channel (<xref ref-type="bibr" rid="b7">Gilbert <italic>et al.</italic>, 2009</xref>), Milwaukee sewage (<xref ref-type="bibr" rid="b13">McLellan <italic>et al.</italic>, 2010</xref>), the human gut (<xref ref-type="bibr" rid="b24">Turnbaugh <italic>et al.</italic>, 2009</xref>), the North Atlantic Deep Water (<xref ref-type="bibr" rid="b20">Sogin <italic>et al.</italic>, 2006</xref>) and an archaeal V6 amplicon library from a deep-sea hydrothermal vent (<xref ref-type="bibr" rid="b8">Huber <italic>et al.</italic>, 2007</xref>). SLP/PW-AL generated 30–40% fewer OTUs than MS-CL (or SLP/MS-CL, <xref ref-type="supplementary-material" rid="SD2">Table S4</xref>). The relative frequency of the most abundant OTUs was 10–50% greater using SLP/PW-AN, consistent with the aggregation of errant sequences with their template that occurs during the SLP step (<xref ref-type="table" rid="tbl3">Table 3</xref>). Neither the fraction of OTUs that contained only a single tag (singleton OTUs) nor the fraction of OTUs that contained 1–3 tags differed substantially between methods. Thus, while SLP/PW-AN reduces the total number of OTUs it does so across a wide range of OTU abundances and does not reduce the proportion of OTUs that comprise the long tail of the abundance curve.</p>
      <table-wrap id="tbl3" position="float">
        <label>Table 3</label>
        <caption>
          <p>Distribution of most and least abundant pyrotags in MS-CL and SLP/PW-AL clusters.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1">Deep-sea vent <italic>Archaea</italic></th>
              <th align="center" rowspan="1" colspan="1">English Channel</th>
              <th align="center" rowspan="1" colspan="1">Human Gut</th>
              <th align="center" rowspan="1" colspan="1">Sewage</th>
              <th align="center" rowspan="1" colspan="1">North Atlantic Deep Water</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Size of most abundant OTU MS-CL</td>
              <td align="center" rowspan="1" colspan="1">47 711</td>
              <td align="center" rowspan="1" colspan="1">1613</td>
              <td align="center" rowspan="1" colspan="1">836</td>
              <td align="center" rowspan="1" colspan="1">948</td>
              <td align="center" rowspan="1" colspan="1">1371</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Size of most abundant OTU SLP/PW-AL</td>
              <td align="center" rowspan="1" colspan="1">49 857</td>
              <td align="center" rowspan="1" colspan="1">1882</td>
              <td align="center" rowspan="1" colspan="1">1436</td>
              <td align="center" rowspan="1" colspan="1">4219</td>
              <td align="center" rowspan="1" colspan="1">1711</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Total OTUs MS-CL</td>
              <td align="center" rowspan="1" colspan="1">709</td>
              <td align="center" rowspan="1" colspan="1">1154</td>
              <td align="center" rowspan="1" colspan="1">803</td>
              <td align="center" rowspan="1" colspan="1">2383</td>
              <td align="center" rowspan="1" colspan="1">1713</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Total OTUs SLP/PW-AL</td>
              <td align="center" rowspan="1" colspan="1">470</td>
              <td align="center" rowspan="1" colspan="1">859</td>
              <td align="center" rowspan="1" colspan="1">566</td>
              <td align="center" rowspan="1" colspan="1">1831</td>
              <td align="center" rowspan="1" colspan="1">1339</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Per cent OTUs as singletons – tripletons MS-CL</td>
              <td align="center" rowspan="1" colspan="1">39%</td>
              <td align="center" rowspan="1" colspan="1">66%</td>
              <td align="center" rowspan="1" colspan="1">65%</td>
              <td align="center" rowspan="1" colspan="1">69%</td>
              <td align="center" rowspan="1" colspan="1">74%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Per cent OTUs as singletons – tripletons SLP/PW-AL</td>
              <td align="center" rowspan="1" colspan="1">42%</td>
              <td align="center" rowspan="1" colspan="1">64%</td>
              <td align="center" rowspan="1" colspan="1">64%</td>
              <td align="center" rowspan="1" colspan="1">69%</td>
              <td align="center" rowspan="1" colspan="1">77%</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="">
    <title>Discussion</title>
    <p>The increased molecular sampling effort enabled by massively parallel DNA sequencing allows the detection of very-low-abundance DNA molecules in complex PCR amplicon libraries. In diversity surveys, these low-abundance sequences delineate rare OTUs (containing one or a few sequence tags) that define the long tail of rank abundance curves for complex microbial communities. This distribution implies the existence of a rare biosphere of many hundreds or thousands of very low abundance phylotypes. The extent of the long tail could reflect true biological signals of diversity, or deep molecular sampling efforts might amplify the effect of sequencing errors and clustering methods when estimating OTU richness. In their review of techniques for minimizing pyrosequencing error, <xref ref-type="bibr" rid="b18">Reeder and Knight (2009</xref>) suggested that the majority of pyrotags that make up the rare biosphere represents the accumulation of small sequencing errors. By extrapolating the rate of OTU inflation observed for low-complexity amplicon libraries, e.g. templates containing rRNA genes for either a single taxon or 90 taxa, they predicted similar impacts on diversity estimates for complex microbial communities and that the reduction in OTUs would correspond to rare biosphere populations. To determine how sequencing error might inflate estimates of OTUs, we undertook an in-depth analysis of template pools of known rRNA composition to determine the contribution of sequencing error to estimates of microbial diversity, the effect of alignment and clustering methodology when defining OTUs from massively parallel pyrotag data sets, and the contribution of aberrant amplicons templated from non-rRNA coding regions. After filtering low-quality sequences, the per-base pyrosequencing error rate on the GS FLX platform did not exceed conventional capillary systems. However, the behaviour of common alignment and clustering algorithms led to significant inflation of 3% OTUs commonly cited in studies of microbial diversity. Very large data sets irrespective of sequencing technology exacerbate the influence of these factors on estimates of diversity.</p>
    <p>Before estimating the number of OTUs predicted by pyrosequencing of the pooled template preparations, we removed low-quality reads and identified sequences that did not represent targeted hypervariable regions. In the case of DNA extracted from <italic>E. coli</italic> and <italic>S. epidermidis</italic> cultures, many of the non-target reads mapped to specific regions of the genome that did not code for rRNAs. In some genomes our rRNA primers will bind with low efficiency to similar but non-identical targets to produce non-rRNA pyrotags. This contamination by non-rRNA amplicons may vary for different taxa and may increase for complex communities with greater aggregate genetic complexity. It also reinforces the importance of screening reads for the inclusion of both primers, a process that is more difficult when pyrosequencing read lengths fail to span longer amplicon targets. While the fraction of these reads may be low, they contribute disproportionately to the creation of spurious OTUs; most represent unique sequences that will form novel clusters at any level. Reliance upon a significant local match by <sc>blast</sc> fails to identify these reads since the local match can be quite short. Requiring the alignment to extend for at least 80% of the length of the read effectively filters these non-target sequences from the pyrotag data set. A minimum alignment length can also detect chimeras between divergent taxa, although short hypervariable tags from diverse communities appear to generate few if any chimeras (S.M. Huse, unpublished analysis of 25 million pyrotags).</p>
    <p>After removing low-quality sequences (<xref ref-type="bibr" rid="b10">Huse <italic>et al.</italic>, 2007</xref>; <xref ref-type="bibr" rid="b12">Kunin <italic>et al.</italic>, 2010</xref>) and reads that did not represent the targeted region, we measured the per-base error rate to be 0.0021–0.0042. (We also identified a small number of V6 rRNA reads from microbial taxa that we did not intentionally include in the initial DNA preparations. An examination of sterile nutrient broth revealed that the yeast extract component contained DNA from diverse microbial taxa, data not shown.) This represents a combination of <italic>in vivo</italic> DNA replication errors, PCR errors and incorrect base calls by the Roche GS FLX software. The distribution of errors did not follow a binomial distribution, as we would expect if errors were randomly distributed in an independent manner throughout the reads. The measured error rate of ∼0.003 failed to account for the number of 3% OTUs produced using MS-CL, because sequences with less than 3% errors did not form a single cluster with their parent sequence. The inability to optimize in a single alignment a large number of hypervariable sequences from highly divergent taxa exacerbates the difficulty of clustering errant sequences with their parent sequence. The presence of multiple OTUs that should cluster together at the 3% level may explain most of the OTU inflation.</p>
    <p>The use of the complete-linkage clustering algorithm also inflates the number of estimated OTUs: as the amount of variation within the limited sequence space increases, it is decreasingly likely that variants will meet the requirement that no sequence can be added to an OTU unless it is less than 3% different from every sequence already in the OTU. Reads that vary from their template at different locations may be within 3% of the template, but not within 3% of each other. Each subsequent variant can initiate the formation of a new OTU. This leads to many individual OTUs comprised of variants less than 3% from their parent sequence. We tested clustering methods on mixed template preparations from which we filtered out variation greater than 3%, and demonstrated that clustering using the common method of an unstructured multiple sequence alignment followed by complete-linkage clustering (MS-CL) grossly overestimates the number of OTUs, while a pairwise alignment and average-linkage clustering (PW-AL) accurately identifies a single OTU for each template.</p>
    <p>To further reduce the inflation of OTUs even in data sets containing errant sequences, we developed a single-linkage preclustering method, SLP. The method assumes that template sequences will occur more frequently than their error-induced variants. We first sort sequences in order of abundance, and then create 2% single-linkage clusters. In a dense sequence space, single-linkage clustering can potentially chain together sequences so that OTUs can contain highly divergent but clearly related sequences. By starting with the most abundant sequences, we seed each cluster with template sequences and then add the less abundant variants; this prevents less frequent variants from linking templates that differ by more than 3% into the same OTU. We use the very narrow preclustering width of 2% to further reduce the likelihood of over-zealous aggregation, while still aggregating error-induced variation (the optimal width may vary with tag length). Careful examination of all clusters generated for both our mixed template data sets and the natural communities revealed no cases where an OTU contained abundant sequences that were not within 3% of each other.</p>
    <p>Both our SLP method and PyroNoise map infrequent sequencing variants to more frequent sequences, and both appear to be effective in reducing the sequencing noise that can contribute to OTU inflation. SLP, however, can also map variations arising from PCR error and microevolution to representative sequences. SLP and PyroNoise provide comparable reductions in spurious OTUs (<xref ref-type="supplementary-material" rid="SD2">Table S3</xref>). The two methods are not mutually exclusive however, and could be used in tandem, first cleaning pyrosequencing error with PyroNoise then combining moderate variation with SLP. The computational expense of running SLP, however, is much less than the current version of PyroNoise.</p>
    <p>Any sequencing method will have an intrinsic error rate, and given a large enough sample size the errant sequences will potentially inflate estimates of diversity. Empirically, we find that after SLP and average-linkage clustering, a smaller number of spurious OTUs remain than with other clustering methods. The majority of these remaining OTUs contain a single read, and we measure the rate of their occurrence in our defined V6 template pools to be ∼0.0015 per template. Thus, a data set of 1000 reads (a sampling effort common for Sanger sequencing) would have only 1–2 reads with enough errors to cluster independently of their parent sequence. However, a deeper survey of 10 000 or more reads made possible by next-generation technologies such as pyrosequencing will produce 10–20 additional reads. This is substantially less than the number of singleton OTUs found in most environmental data sets.</p>
    <p>We examined the OTUs generated by SLP/PW-AL from each of our mixed template preparations and found that &gt; 90% of the spurious OTUs contained only a single sequence; the rest generally contained two or rarely three. While indiscriminately removing all singleton OTUs will certainly reduce spurious OTUs, singleton OTUs frequently represent valid rare phylotypes in diverse environmental samples. We compared singleton OTUs from replicate single genome templates and found that even with very deep sequencing (&gt; 60 000 reads/replicate), singletons from one replicate rarely occurred in other replicates. If parallel generation of the same singleton OTU rarely occurs at these depths, we argue that the same spurious OTU will rarely arise in multiple environmental samples. In a preliminary analysis using 487 samples from the International Census of Marine Microbes (ICoMM, <ext-link ext-link-type="uri" xlink:href="http://icomm.mbl.edu">http://icomm.mbl.edu</ext-link>), we found that the probability of an OTU found in one sample occurring in another sample was about the same for singleton OTUs and non-singleton OTUs (not shown).</p>
    <p>Extrapolating OTU inflation from results of single template preparations can lead to unwarranted conclusions since the OTU inflation is a function of the sampling effort, not the sample diversity. For example, if a sample is sequenced to a depth of 20 000 tags, it will produce 20–40 spurious OTUs at the 3% threshold using SLP/PW-AN clustering. If the sample contains a single template, these 40 extra OTUs will constitute an inflation of 400%. In a sample with 100 different templates these OTUs would represent an inflation of 40%. In a complex environmental sample with more than 1000 phylotypes, the spurious OTUs would inflate estimates of diversity by less than 4%. Consistent with this prediction, SLP/PW-AL reduced the OTU counts in our simple template preparations by ∼90%, but OTU counts only decreased by 30–60% in complex environmental samples, a significant change but not different by orders of magnitude. <xref ref-type="bibr" rid="b17">Quince and colleagues (2009</xref>) reported very similar results with an 80% decrease in the OTUs of an artificial community, but only a 40% decrease in an environmental sample. Theoretically, when the sample diversity exceeds 1–2% of the sample depth, the OTU inflation (assuming 1–2 OTUs/1000 reads) will be less than 10%. When the sample diversity exceeds 5–10% of the sample depth, the OTU inflation will be less than 2%.</p>
    <p>Our initial expectation was that sequencing errors and clustering artefacts would disproportionately affect the rare OTUs. As the new SLP/PW-AL method maps errant sequences to their template sequence, the more abundant OTUs tend to increase in number. The majority of these sequences, however, previously clustered into non-singleton OTUs. Although the SLP/PW-AL method removed many spurious OTUs, the shape of the OTU abundance distribution curve remains essentially the same – a small number of highly abundant species and a long tail of rare species.</p>
  </sec>
  <sec sec-type="methods">
    <title>Experimental procedures</title>
    <sec>
      <title>Generation of amplicon libraries and pyrosequencing</title>
      <p>We inoculated 5 ml of filter-sterilized nutrient broth with a single colony of <italic>E. coli</italic> K12 ATCC 10798 or <italic>S. epidermidis</italic> ATCC 14990, and grew these cultures overnight at 37°C to an OD<sub>600</sub> of ∼1 [nutrient broth is 8 g Difco nutrient broth powder (Invitrogen) in Milli-Q+ ultrapure water (Millipore) to 1 l; all loops, pipets, flasks, etc. were disposable sterile polycarbonate or polypropylene]. For each species, we inoculated three 250 ml flasks, each containing 50 ml nutrient broth, with 100 µl of the overnight culture. We incubated the flasks at 37°C with vigorous shaking and harvested the cultures at late stationary phase (OD<sub>600</sub> of ∼1.25). We then divided each culture into three aliquots, extracted genomic DNA and used each DNA extraction in a separate amplification of the V6 region. We split one amplicon library from each species into two emPCR amplification prior to pyrosequencing for a total of 10 subsamples of single clones of <italic>E. coli</italic> and of <italic>S. epidermidis</italic>. We also generated an amplicon library from a previously prepared pool of plasmid DNA from 43 different cloned 16S rRNA genes from deep-sea vent organisms (<xref ref-type="bibr" rid="b10">Huse <italic>et al.</italic>, 2007</xref>; <xref ref-type="bibr" rid="b9">Huber <italic>et al.</italic>, 2009</xref>).</p>
      <p>We generated amplicon libraries using primer pools designed to span the V6 or V4-V5 hypervariable regions of as many known bacteria or archaea as possible (<xref ref-type="supplementary-material" rid="SD2">Tables S5 and S6</xref>). We used Invitrogen Platinum HiFi <italic>Taq</italic> polymerase for amplification, as we have found that the fidelity of standard <italic>Taq</italic> is insufficient for the level of deep sequencing provided by the GS FLX. We sequenced from the A adapter on a Roche GS FLX using standard Roche protocols and supplies and the amplicon base-calling pipeline. Sequences are available at the NCBI Short Read Archive (SRP001610).</p>
      <p>Data from environmental samples were collected as previously described (<xref ref-type="bibr" rid="b20">Sogin <italic>et al.</italic>, 2006</xref>; <xref ref-type="bibr" rid="b8">Huber <italic>et al.</italic>, 2007</xref>; <xref ref-type="bibr" rid="b7">Gilbert <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="b24">Turnbaugh <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="b13">McLellan <italic>et al.</italic>, 2010</xref>) using the amplification and processing methods outlined above.</p>
    </sec>
    <sec>
      <title>Filtering low-quality and contaminating reads</title>
      <p>For all data sets, we removed all sequences that contained one or more ambiguous bases (Ns), that did not have an exact match to the expected bar-coded forward primers, or that had an average quality score less than 30 (the V6 region is short and generally low in homopolymer stretches and therefore has high average quality scores) (<xref ref-type="bibr" rid="b20">Sogin <italic>et al.</italic>, 2006</xref>; <xref ref-type="bibr" rid="b10">Huse <italic>et al.</italic>, 2007</xref>; <xref ref-type="bibr" rid="b12">Kunin <italic>et al.</italic>, 2010</xref>). For V6 data sets, we also removed sequences that did not have a recognizable reverse primer sequence.</p>
      <p>For non-environmental data sets, we compared all reads to a database of 16S rRNA sequences using GAST (<xref ref-type="bibr" rid="b11">Huse <italic>et al.</italic>, 2008</xref>). Reads that had a best match to a non-target sequence that was at least 10% better than the match to the nearest template sequence were considered to be contamination and were removed. Reads that either did not have any match or did not have a match over at least 80% of their length were considered to represent non-target amplification, chimeras or reads with gross errors and were removed. These sequences were compared with the GenBank nt database using BLASTN (<xref ref-type="bibr" rid="b1">Altschul <italic>et al.</italic>, 1990</xref>).</p>
      <p>The likelihood of generating chimeras between short, hypervariable rRNA sequences of divergent taxa in the absence of the conserved regions of the gene is very small. The <italic>E. coli</italic> and <italic>S. epidermidis</italic> data sets, however, each include two very similar sequences in high density. Chimeras here are very similar to the correct sequences and map to the same species; therefore they are not identified by the minimum <sc>blast</sc> alignment requirement nor by standard chimera checking software, and would artificially increase the calculated error rate of PCR+pyrosequencing. Through visual examination we identified obvious chimeras and removed those specific sequences from the data. Some additional chimeras that contain sequencing errors and therefore do not exactly match predicted chimeras likely remain.</p>
    </sec>
    <sec>
      <title>Calculating the PCR+pyrosequencing error rate</title>
      <p>We compared each read to the relevant set of template sequences using the needledist module of ESPRIT (with options −g 5.75 −e 2.75 −x) (<xref ref-type="bibr" rid="b22">Sun <italic>et al.</italic>, 2009</xref>). The error rate was calculated as the number of insertions and deletions (of any length) plus the number of individual substitutions divided by the length of the template sequence.</p>
    </sec>
    <sec>
      <title>Clustering reads into OTUs</title>
      <p>We used mothur (<xref ref-type="bibr" rid="b19">Schloss <italic>et al.</italic>, 2009</xref>) to create a set of unique sequences from a fasta file of all quality-filtered reads in each sample. For unstructured multiple sequence alignments we used MUSCLE (<xref ref-type="bibr" rid="b4">Edgar, 2004</xref>) with non-default parameters −maxiters 2, −diags which have been previously shown to minimize alignment expansion in short hypervariable tags (<xref ref-type="bibr" rid="b20">Sogin <italic>et al.</italic>, 2006</xref>; <xref ref-type="bibr" rid="b22">Sun <italic>et al.</italic>, 2009</xref>). For Needleman-Wunsch pairwise alignments we used the kmerdist and needledist modules of ESPRIT (default parameters). We used quickdist (<xref ref-type="bibr" rid="b20">Sogin <italic>et al.</italic>, 2006</xref>) to create the distance matrix of all pairwise combinations from the multiple sequence alignment. ESPRIT's needledist creates a distance matrix using the quickdist distance calculation: the number of substitutions, deletions and insertions divided by the alignment length. We then used mothur to create OTUs using the single-linkage, average-linkage or complete-linkage options, and to calculate richness and rank-abundance statistics.</p>
    </sec>
    <sec>
      <title>Single-linkage preclustering</title>
      <p>Our preclustering algorithm first orders the unique sequences by frequency, then steps through the ordered sequences, assigning them to clusters. The most abundant sequence starts the first cluster. Each subsequent sequence is tested against the growing list of clusters using the single-linkage algorithm. If the sequence has a pairwise distance less than 0.02 (equivalent to a single difference in the V6 region) to any of the sequences already in the cluster, the new sequence will be added to the cluster and not tested against subsequent clusters. If the sequence is not within a distance of 0.02 from any read in any of the existing clusters, it will establish a new cluster. Once all sequences have been assigned to clusters, sequences in the low abundance clusters (&lt; 10 tags) are tested against the larger clusters and added to those clusters if possible. Ordering sequences by frequency ensures that those sequences that accurately represent the template pool will preferentially seed the establishment of a new cluster rather than those errant sequences that occur at lower frequency. This also helps avoid linking very different template sequences into a single cluster through a chain of low frequency errant sequences. The second round of preclustering incorporates small clusters into larger clusters in cases where the smaller cluster formed before the larger cluster included sequences that differ from the smaller cluster by less than 2%. For each final precluster, SLP assigns the sequence with the highest frequency to represent the cluster in downstream OTU clustering, with the count of all tags in the precluster assigned to it. The perl script that performs these operations, SLP, can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://vamps.mbl.edu/resources/software.php">http://vamps.mbl.edu/resources/software.php</ext-link>.</p>
    </sec>
    <sec>
      <title>PyroNoise comparisons</title>
      <p>We randomly selected 10 000 tags having an average quality score ≥ 30 and no ambiguous bases. We ran PyroNoise with default values (including −s 15.0 −c 0.05 for PCluster) and removed denoised sequences that did not map to Bacteria by GAST. The remaining sequences were clustered using pairwise alignments and average-linkage clustering as above.</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Rich Fox for his systems administration support for the Bay Paul Center computing facility, which made these analyses possible; and Bette Hecox-Lea, Ekaterina Andreishcheva and Jessica Mark Welch for laboratory support. This work was supported by the Woods Hole Center for Oceans and Human Health (NSF/OCE 0430724), a subcontract to MLS from the NIH Human Microbioime 1UH2DK083993-01 awarded to the University of Michigan and a foundation award from the Alfred P. Sloan Foundation to M.L.S. and D.M.W.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="b1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Meyers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="b2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brockman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Alvarez</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Garber</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Giannoukos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>WL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quality scores and SNP detection in sequencing-by-synthesis systems</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>763</fpage>
        <lpage>770</lpage>
        <pub-id pub-id-type="pmid">18212088</pub-id>
      </element-citation>
    </ref>
    <ref id="b3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeSantis</surname>
            <given-names>TZ</given-names>
            <suffix>Jr</suffix>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Brodie</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Larsen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Piceno</surname>
            <given-names>YM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NAST: a multiple sequence alignment server for comparative analysis of 16S rRNA genes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>W394</fpage>
        <lpage>W399</lpage>
        <pub-id pub-id-type="pmid">16845035</pub-id>
      </element-citation>
    </ref>
    <ref id="b4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>1792</fpage>
        <lpage>1797</lpage>
        <pub-id pub-id-type="pmid">15034147</pub-id>
      </element-citation>
    </ref>
    <ref id="b5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewing</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Base-calling of automated sequencer traces using Phred. II. Error probabilities</article-title>
        <source>Genome Res</source>
        <year>1998</year>
        <volume>8</volume>
        <fpage>186</fpage>
        <lpage>194</lpage>
        <pub-id pub-id-type="pmid">9521922</pub-id>
      </element-citation>
    </ref>
    <ref id="b6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewing</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hillier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wendl</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Base-calling of automated sequencer traces using Phred I. Accuracy assessment</article-title>
        <source>Genome Res</source>
        <year>1998</year>
        <volume>8</volume>
        <fpage>175</fpage>
        <lpage>185</lpage>
        <pub-id pub-id-type="pmid">9521921</pub-id>
      </element-citation>
    </ref>
    <ref id="b7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilbert</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Field</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Swift</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Newbold</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The seasonal structure of microbial communities in the Western English Channel</article-title>
        <source>Environ Microbiol</source>
        <year>2009</year>
        <volume>11</volume>
        <fpage>3132</fpage>
        <lpage>3139</lpage>
        <pub-id pub-id-type="pmid">19659500</pub-id>
      </element-citation>
    </ref>
    <ref id="b8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Mark Welch</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Huse</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Neal</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Butterfield</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Sogin</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Microbial population structures in the deep marine biosphere</article-title>
        <source>Science</source>
        <year>2007</year>
        <volume>318</volume>
        <fpage>97</fpage>
        <lpage>100</lpage>
        <pub-id pub-id-type="pmid">17916733</pub-id>
      </element-citation>
    </ref>
    <ref id="b9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Huse</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Neal</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Sogin</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Mark Welch</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Effect of PCR amplicon size on assessments of clone library microbial diversity and community structure</article-title>
        <source>Environ Microbiol</source>
        <year>2009</year>
        <volume>11</volume>
        <fpage>1292</fpage>
        <lpage>1302</lpage>
        <pub-id pub-id-type="pmid">19220394</pub-id>
      </element-citation>
    </ref>
    <ref id="b10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huse</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sogin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mark Welch</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Accuracy and quality of massively parallel DNA pyrosequencing</article-title>
        <source>Genome Biol</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R143</fpage>
        <pub-id pub-id-type="pmid">17659080</pub-id>
      </element-citation>
    </ref>
    <ref id="b11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huse</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Dethlefsen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Mark Welch</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Relman</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Sogin</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Exploring microbial diversity and taxonomy using SSU rRNA hypervariable Tag sequencing</article-title>
        <source>PLoS Genet</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>e1000255</fpage>
        <pub-id pub-id-type="pmid">19023400</pub-id>
      </element-citation>
    </ref>
    <ref id="b12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kunin</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Engelbrektson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ochman</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Wrinkles in the rare biosphere: pyrosequencing errors lead to artificial inflation of diversity estimates</article-title>
        <source>Environ Microbiol</source>
        <year>2010</year>
        <volume>12</volume>
        <fpage>118</fpage>
        <lpage>123</lpage>
        <pub-id pub-id-type="pmid">19725865</pub-id>
      </element-citation>
    </ref>
    <ref id="b13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLellan</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Huse</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Mueller-Spitz</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Andreishcheva</surname>
            <given-names>EN</given-names>
          </name>
          <name>
            <surname>Sogin</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Diversity and population structure of sewage derived microorganisms in wastewater treatment plant influent</article-title>
        <source>Environ Microbiol</source>
        <year>2010</year>
        <volume>12</volume>
        <fpage>378</fpage>
        <lpage>392</lpage>
        <pub-id pub-id-type="pmid">19840106</pub-id>
      </element-citation>
    </ref>
    <ref id="b14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Needleman</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Wunsch</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>
        <source>J Mol Biol</source>
        <year>1970</year>
        <volume>48</volume>
        <fpage>443</fpage>
        <lpage>453</lpage>
        <pub-id pub-id-type="pmid">5420325</pub-id>
      </element-citation>
    </ref>
    <ref id="b15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedros-Alio</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Marine microbial diversity: can it be determined?</article-title>
        <source>Trends Microbiol</source>
        <year>2006</year>
        <volume>14</volume>
        <fpage>257</fpage>
        <lpage>263</lpage>
        <pub-id pub-id-type="pmid">16679014</pub-id>
      </element-citation>
    </ref>
    <ref id="b16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedros-Alio</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>ECOLOGY: dipping into the rare biosphere</article-title>
        <source>Science</source>
        <year>2007</year>
        <volume>315</volume>
        <fpage>192</fpage>
        <lpage>193</lpage>
        <pub-id pub-id-type="pmid">17218512</pub-id>
      </element-citation>
    </ref>
    <ref id="b17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lanzen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Curtis</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Davenport</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Head</surname>
            <given-names>IM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Noise and the accurate determination of microbial diversity from 454 pyrosequencing data</article-title>
        <source>Nat Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>639</fpage>
        <lpage>641</lpage>
        <pub-id pub-id-type="pmid">19668203</pub-id>
      </element-citation>
    </ref>
    <ref id="b18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reeder</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The ‘rare biosphere’: a reality check</article-title>
        <source>Nat Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>636</fpage>
        <lpage>637</lpage>
        <pub-id pub-id-type="pmid">19718016</pub-id>
      </element-citation>
    </ref>
    <ref id="b19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Westcott</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Ryabin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hollister</surname>
            <given-names>EB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Introducing mothur: open source, platform-independent, community-supported software for describing and comparing microbial communities</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2009</year>
        <volume>75</volume>
        <fpage>7537</fpage>
        <lpage>7541</lpage>
        <pub-id pub-id-type="pmid">19801464</pub-id>
      </element-citation>
    </ref>
    <ref id="b20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sogin</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Mark Welch</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Huse</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Neal</surname>
            <given-names>PR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Microbial diversity in the deep sea and the underexplored ‘rare biosphere’</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2006</year>
        <volume>103</volume>
        <fpage>12115</fpage>
        <lpage>12120</lpage>
        <pub-id pub-id-type="pmid">16880384</pub-id>
      </element-citation>
    </ref>
    <ref id="b21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stackebrandt</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Goebel</surname>
            <given-names>BM</given-names>
          </name>
        </person-group>
        <article-title>Taxonomic note: a place for DNA-DNA reassociation and 16S rRNA sequence analysis in the present species definition in bacteriology</article-title>
        <source>Int J Syst Bacteriol</source>
        <year>1994</year>
        <volume>44</volume>
        <fpage>846</fpage>
        <lpage>849</lpage>
      </element-citation>
    </ref>
    <ref id="b22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Farrell</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>McKendree</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Farmerie</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>ESPRIT: estimating species richness using large collections of 16S rRNA pyrosequences</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>e76</fpage>
        <pub-id pub-id-type="pmid">19417062</pub-id>
      </element-citation>
    </ref>
    <ref id="b23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title>
        <source>Nucleic Acids Res</source>
        <year>1994</year>
        <volume>22</volume>
        <fpage>4673</fpage>
        <lpage>4680</lpage>
        <pub-id pub-id-type="pmid">7984417</pub-id>
      </element-citation>
    </ref>
    <ref id="b24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Hamady</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yatsunenko</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cantarel</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Duncan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>RE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A core gut microbiome in obese and lean twins</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>457</volume>
        <fpage>480</fpage>
        <lpage>484</lpage>
        <pub-id pub-id-type="pmid">19043404</pub-id>
      </element-citation>
    </ref>
    <ref id="b25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Dongen</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Graph clustering via a discrete uncoupling process</article-title>
        <source>SIAM J Matrix Anal Appl</source>
        <year>2008</year>
        <volume>30</volume>
        <fpage>121</fpage>
        <lpage>141</lpage>
      </element-citation>
    </ref>
  </ref-list>
  <sec sec-type="supplementary-material">
    <title>Supporting information</title>
    <p>Additional Supporting Information may be found in the online version of this article:</p>
    <p><bold>Fig. S1.</bold> Reads with errors: observed vs. expected. We plotted the number of reads with one or more errors that we observed and that would be expected using a binomial distribution of errors. The binomial distribution underestimates the number of reads with multiple errors. The error rates used for each community are reported in Supplementary Table 2.</p>
    <supplementary-material content-type="local-data" id="SD1">
      <media xlink:href="emi0012-1889-SD1.tif" xlink:type="simple" id="d32e2133" position="anchor" mimetype="image" mime-subtype="tiff"/>
    </supplementary-material>
    <p><bold>Table S1.</bold> Sequences generated from each clone experiment.</p>
    <p><bold>Table S2.</bold> Pyrosequencing and PCR error.</p>
    <p><bold>Table S3.</bold> PyroNoise comparison.</p>
    <p><bold>Table S4.</bold> Comparison of clustering methods after single-linkage preclustering (SLP).</p>
    <p><bold>Table S5.</bold> Amplification primers.</p>
    <p><bold>Table S6.</bold> Multiplexing barcodes used to differentiate subsamples of the two genomic template samples.</p>
    <supplementary-material content-type="local-data" id="SD2">
      <media xlink:href="emi0012-1889-SD2.doc" xlink:type="simple" id="d32e2159" position="anchor" mimetype="application" mime-subtype="msword"/>
    </supplementary-material>
    <p>Please note: Wiley-Blackwell are not responsible for the content or functionality of any supporting materials supplied by the authors. Any queries (other than missing material) should be directed to the corresponding author for the article.</p>
  </sec>
</back>
