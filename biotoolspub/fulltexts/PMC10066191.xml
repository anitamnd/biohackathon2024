<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10066191</article-id>
    <article-id pub-id-type="publisher-id">37539</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-023-37539-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A mass spectrum-oriented computational method for ion mobility-resolved untargeted metabolomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Luo</surname>
          <given-names>Mingdu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yin</surname>
          <given-names>Yandong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1249-6870</contrib-id>
        <name>
          <surname>Zhou</surname>
          <given-names>Zhiwei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Haosong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Xi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Hongmiao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3272-3567</contrib-id>
        <name>
          <surname>Zhu</surname>
          <given-names>Zheng-Jiang</given-names>
        </name>
        <address>
          <email>jiangzhu@sioc.ac.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.422150.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 1015 4378</institution-id><institution>Interdisciplinary Research Center on Biology and Chemistry, </institution><institution>Shanghai Institute of Organic Chemistry, Chinese Academy of Sciences, </institution></institution-wrap>Shanghai, 200032 P. R. China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.410726.6</institution-id><institution-id institution-id-type="ISNI">0000 0004 1797 8419</institution-id><institution>University of Chinese Academy of Sciences, </institution></institution-wrap>Beijing, 100049 P. R. China </aff>
      <aff id="Aff3"><label>3</label>Shanghai Key Laboratory of Aging Studies, Shanghai, 201210 P. R. China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>31</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>31</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>1813</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Ion mobility (IM) adds a new dimension to liquid chromatography-mass spectrometry-based untargeted metabolomics which significantly enhances coverage, sensitivity, and resolving power for analyzing the metabolome, particularly metabolite isomers. However, the high dimensionality of IM-resolved metabolomics data presents a great challenge to data processing, restricting its widespread applications. Here, we develop a mass spectrum-oriented bottom-up assembly algorithm for IM-resolved metabolomics that utilizes mass spectra to assemble four-dimensional peaks in a reverse order of multidimensional separation. We further develop the end-to-end computational framework Met4DX for peak detection, quantification and identification of metabolites in IM-resolved metabolomics. Benchmarking and validation of Met4DX demonstrates superior performance compared to existing tools with regard to coverage, sensitivity, peak fidelity and quantification precision. Importantly, Met4DX successfully detects and differentiates co-eluted metabolite isomers with small differences in the chromatographic and IM dimensions. Together, Met4DX advances metabolite discovery in biological organisms by deciphering the complex 4D metabolomics data.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">The high dimensionality of ion mobility (IM)-resolved metabolomics data presents a great challenge to data processing. Here, authors develop a mass spectrum-oriented bottom-up assembly algorithm and the end-to-end computational framework Met4DX for IM-resolved metabolomics.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Mass spectrometry</kwd>
      <kwd>Metabolomics</kwd>
      <kwd>Software</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China (National Science Foundation of China)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>22022411</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhu</surname>
            <given-names>Zheng-Jiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100003399</institution-id>
            <institution>Science and Technology Commission of Shanghai Municipality (Shanghai Municipal Science and Technology Commission)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2019SHZDZX02</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhu</surname>
            <given-names>Zheng-Jiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>The work was supported by National Key R&amp;D Program of China (2018YFA0800902), National Natural Science Foundation of China (31971356 and 22022411), Shanghai Municipal Science and Technology Major Project (2019SHZDZX02), and Shanghai Key Laboratory of Aging Studies (19DZ2260400).</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Mass spectrometry-based untargeted metabolomics has become increasingly successful in providing a comprehensive, unbiased and quantitative characterization of metabolites in a biological system under investigation<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. However, the enormous chemical and the compositional diversity of metabolome presents a grand challenge in separation and identification of metabolites. This challenge is particularly prominent for isomeric metabolites, which tend to co-elute on chromatography and share similar fragments in MS/MS spectra<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref></sup>. Recently, liquid chromatography–ion mobility–mass spectrometry (LC–IM–MS) has been emerging as a promising technology for four-dimensional untargeted metabolomics<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR6">6</xref></sup>. Ion mobility adds a new dimension of separation to LC–MS. After ionization, ion mobility separates metabolite ions according to their sizes, shapes, and charges in gas phase on the millisecond timescale, which effectively improves the resolving power and selectivity without adding to analysis times<sup><xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref></sup>. The ion mobility-derived collision cross-section (CCS) is a valuable physiochemical property for metabolite identification with high reproducibility across different instruments<sup><xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR13">13</xref></sup>. The hyphenation of IM with LC and tandem MS provides a promising strategy for the multidimensional analysis of the complex metabolome<sup><xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR16">16</xref></sup>. This technology has demonstrated distinct advantages over conventional LC–MS, including improved separation and peak capacity, capability to separate and differentiate metabolite isomers, and generation of four-dimensional (4D) data (i.e., <italic>m/z</italic>, retention time, CCS, and MS/MS spectrum) for metabolite identification<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>.</p>
    <p id="Par4">The high complexity of ion mobility-resolved untargeted metabolomics presents a great challenge to data processing. In particular, peak detection becomes more challenging in ion mobility-based four-dimensional data, which restricts the broad application of 4D metabolomics. Compared to increasing software availability in ion mobility-enhanced 4D proteomics<sup><xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR21">21</xref></sup>, very few software tools were developed for 4D metabolomics<sup><xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR24">24</xref></sup>. Mass spectra generated from ion mobility-resolved untargeted metabolomics are structurally complex because of the additional ion mobility dimension. For 4D peak detection in such complex dataset, the top-down based dimensionality reduction is often employed. For example, in 4D proteomics, software tools such as MaxQuant<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> and IonQuant<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> slice the 4D data space (<italic>m/z</italic>, retention time, ion mobility, and intensity) into multiple 3D sub-spaces (<italic>m/z</italic>, retention time, and intensity) along the ion mobility dimension (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1a</xref>). Then, peak detection is performed in each 3D sub-space using the conventional peak detection algorithm in LC–MS. This strategy finally tracks along the ion mobility dimension and integrates the same <italic>m/z</italic>-RT peaks in multiple 3D sub-spaces to form a 4D peak. Alternatively, in 4D lipidomics, MS-DIAL<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> developed a top-down compressing strategy for dimensionality reduction. Specifically, the 4D data space was compressed into one 3D space (<italic>m/z</italic>, retention time, and intensity) by summing the ion mobility dimension (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1b</xref>). Peak detection is first performed in retention time dimension. For each detected LC peak, a second peak detection is applied in ion mobility dimension. In summary, current 4D peak detection methods aim to convert 4D data into 3D data through the top-down based dimensionality reduction. Although dimensionality reduction simplifies the data structures, it also introduces signal masking and artifacts, and may reduce the peak detection sensitivity. To foster a more widespread application of 4D untargeted metabolomics and accelerate its development, more informatic solutions are urgently required.</p>
    <p id="Par5">The LC–IM–MS empowered 4D metabolomics enables to sequentially separate metabolites according to the required timescales from LC, IM to MS (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). Inspired by the sequential separations, in this work, we developed a mass spectrum-oriented bottom-up assembly algorithm for 4D peak detection. The bottom-up assembly strategy considers a mass spectrum (MS1 or MS2) as the smallest unit in 4D dataset, and builds its related elution peaks in IM dimension and LC dimension, respectively, in a reverse order of multidimensional separation. We refer to this as a reverse engineering strategy from data acquisition. With our 4D peak detection algorithm, we further developed an end-to-end computational framework, namely Met4DX, for peak detection, quantification and identification of metabolites in 4D untargeted metabolomics (Fig. <xref rid="Fig1" ref-type="fig">1b–e</xref>). We demonstrated that Met4DX substantially improved 4D peak detection coverage and sensitivity in different biological samples. Performances of Met4DX were thoroughly benchmarked and validated with other existing tools, including coverage, sensitivity, and peak fidelity as well as quantification precision. Importantly, Met4DX enabled to detect and differentiate co-eluted isomeric metabolites even with small differences on LC and IM separations. Finally, we demonstrated that Met4DX supported accurate identification of metabolites, in particular for co-eluted metabolites. In summary, Met4DX is a mass spectrum-oriented end-to-end computational tool for peak detection, quantification, and identification of metabolites in 4D untargeted metabolomics, which will empower the widespread applications of ion mobility-resolved metabolomics.<fig id="Fig1"><label>Fig. 1</label><caption><title>The Met4DX workflow for ion mobility-resolved untargeted metabolomics.</title><p><bold>a</bold> The multidimensional separations and measurements of metabolites using LC–IM–MS/MS technology. <bold>b</bold>–<bold>e</bold> Four major modules in Met4DX: <bold>b</bold> MS2 spectral dereplication; <bold>c</bold> the bottom-up assembly algorithm for 4D peak detection; <bold>d</bold> 4D peak alignment and grouping; and <bold>e</bold> multidimensional match for metabolite annotation. The black dot in (<bold>b</bold>) represents the precursor ion of an MS2 spectrum.</p></caption><graphic xlink:href="41467_2023_37539_Fig1_HTML" id="d32e424"/></fig></p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>The Met4DX workflow</title>
      <p id="Par6">Met4DX provides an end-to-end computational workflow for peak detection, quantification, and metabolite annotation in ion mobility-enhanced 4D untargeted metabolomics (Fig. <xref rid="Fig1" ref-type="fig">1</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). A MS spectrum is the smallest unit in 4D data acquisition, while the MS2 spectrum is highly essential for metabolite annotation. Thus, Met4DX starts the 4D data processing from each individual MS2 spectrum, and includes 4 major modules: (1) MS2 spectral dereplication; (2) the bottom-up assembly algorithm for 4D peak detection; (3) 4D peak alignment and grouping; and (4) multidimensional match for metabolite annotation.</p>
      <p id="Par7">In data-dependent MS2 acquisition (DDA), for example, parallel accumulation serial fragmentation (PASEF)-DDA in trapped ion mobility mass spectrometer (TIMS)<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, the same precursor ion is usually chosen and fragmentated multiple times to generate redundant MS2 spectra. To address this issue, Met4DX first performs MS2 spectral dereplication (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). Specifically, all acquired MS2 spectra are binned using the 3D information of their precursor ions (MS1), including <italic>m/z</italic>, retention time, and ion mobility (see Methods). For each bin, 3D distances between any of two MS2 spectra are calculated by integrating the similarities of ion mobility and RT of their precursor ions and MS2 spectra. Then, a hierarchical cluster analysis (HCA) is applied using the 3D distances among MS2 spectra in the bin, and generates the unique MS2 clusters for each bin. Finally, the MS2 spectrum with the highest spectral intensity (termed as unique MS2 spectrum) is selected to represent the cluster. The dereplication step significantly reduces the redundancy of MS2 spectra for subsequent peak detection.</p>
      <p id="Par8">Second, we developed a MS spectrum-oriented bottom-up assembly algorithm for 4D peak detection, which is the core module of Met4DX (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). The 4D peak detection is performed via 5 steps starting from individual MS2 spectrum. In step 1, for each unique MS2 spectrum, Met4DX searches its precursor MS1 data point in the <italic>m/z</italic>-ion mobility data frame with the precursor <italic>m/z</italic>, ion mobility, and frame index recorded in the mgf file. In step 2, the adjacent MS1 data points from the same <italic>m/z</italic>-ion mobility frame are retrieved to assemble a possible ion mobility peak. Then, peak detection is performed in ion mobility dimension. If a successful extracted ion mobilogram (EIM) peak is obtained, in step 3, MS1 data retrieval and assembly of EIM peaks are repeatedly extended to the adjacent <italic>m/z</italic>-ion mobility frames (i.e., EIM extension). After that, in step 4, all MS1 data points from EIM peaks in each mobility frame are summed up to rebuild the ion chromatogram in LC dimension. Similarly, peak detection is also performed in the assembled ion chromatogram (i.e., EIC detection). If a successful EIC peak is obtained, in step 5, a 4D peak is constructed with recorded apex and boundary information in EIM and EIC detections. Peak intensity is generated from 3D peak volume. Most importantly, Met4DX employs a serial of criteria during 4D peak detection to reduce false positive and improve peak fidelity (see Methods). Collectively, peak detection in Met4DX starts from one MS2 spectrum and constructs the 4D peak in a reverse order of the sequential separation in LC–IM–MS. Therefore, we refer our peak detection as a bottom-up assembly strategy.</p>
      <p id="Par9">Third, 4D peak alignment and grouping is performed to combine multiple samples for quantification (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). Specifically, metabolic peaks are matched between samples using 4D information (<italic>m/z</italic>, retention time, mobility, and MS/MS spectrum). Matched peaks are employed as landmarks to construct a retention time regression model for retention time correction and peak alignment. A density-based peak grouping strategy is further applied with the distribution of <italic>m/z</italic> and ion mobility values. Peak match between samples is also performed to overcome the stochasticity during data acquisition. Finally, gap filling is applied for missing values through targeted extraction. A 4D peak table is generated for metabolite quantification in multiple samples and groups, while related 4D information for each feature (<italic>m/z</italic>, retention time, CCS, and MS/MS spectrum) is also outputted. Fourth, metabolite annotation is performed through multidimensional match (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). In Met4DX, we curated a metabolite library of 135,638 metabolites collected from KEGG and HMDB with calculated <italic>m/z</italic>, CCS, RT, and MS/MS spectra (experimentally acquired or in silico predicted). In summary, Met4DX is a MS spectrum-oriented computational tool to provide an end-to-end data processing for 4D untargeted metabolomics. Met4DX is now freely available as an R package in GitHub.</p>
    </sec>
    <sec id="Sec4">
      <title>4D peak detection</title>
      <p id="Par10">We demonstrated 4D peak detection of Met4DX with NIST human urine samples (n = 6 technical replicates) acquired using TIMS with PASEF-DDA technology. In positive mode, a total of ~25,000 MS2 spectra acquired from each sample were inputted into Met4DX for 3D binning and MS2 spectral dereplication (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). Most clusters had only one unique MS2 spectrum (~60%; Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>). A total of ~8600 unique MS2 spectra were generated for each replicate (64% reduction; Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). With them as inputs, the MS2 spectrum-oriented bottom-up assembly was performed for 4D peak detection in each sample, and ~6700 features were successfully detected (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>). On average, 78% of unique MS2 spectra enabled to achieve the successful de novo assembles of 4D features. Finally, the application of peak alignment and grouping generated a total of 7287 features with a minimal fraction of 0.5 applied (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>). The negative mode data is shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>. In negative mode, as high as 98% of unique MS2 spectra enabled to achieve the successful de novo assembles of 4D features.<fig id="Fig2"><label>Fig. 2</label><caption><title>4D peak detection in human urine samples.</title><p>NIST human urine samples were acquired using TIMS with PASEF-DDA technology in positive mode and processed using Met4DX (<italic>n</italic> = 6 technical replicates). <bold>a</bold>–<bold>c</bold> The numbers of raw MS2 spectra (<bold>a</bold>), unique MS2 spectra (<bold>b</bold>), and assembled 4D features (<bold>c</bold>) in each sample replicate. Numbers represent mean ± SD (<italic>n</italic> = 6 technical replicates). <bold>d</bold> The total number of 4D features with a minimal fraction of 0.5 applied. <bold>e</bold> An example of kynurenic acid in urine sample was employed to demonstrate the bottom-up assembly algorithm for 4D peak detection in Mex4DX. Red arrow in the <italic>m/z</italic>-ion mobility data frame indicates the precursor data point for the unique MS2 spectrum. The combined symbols of open/closed cycles and the arrow in the unique MS2 spectrum represent a product ion scan to generate an MS2 spectrum from a fixed precursor ion.</p></caption><graphic xlink:href="41467_2023_37539_Fig2_HTML" id="d32e554"/></fig></p>
      <p id="Par11">More specifically, an example of kynurenic acid was employed to demonstrated the bottom-up assembly algorithm for 4D peak detection in Mex4DX (Fig. <xref rid="Fig2" ref-type="fig">2e</xref>). After MS2 dereplication, a unique MS spectrum (<italic>m/z</italic> = 190.0500 Da; mobility,1/<italic>K</italic><sub>0</sub> = 0.640 V·s/cm<sup>2</sup>; frame index = 1056) was generated to initiate peak detection. Met4DX first searched and retrieved its precursor data point with <italic>m/z</italic> and mobility information in the frame 1506. Then, adjacent MS1 data points in the same frame were also retrieved to assemble the IM peak. The peak apex was determined at 1/<italic>K</italic><sub>0</sub> of 0.640 V·s/cm<sup>2</sup>. The same IM peak assembly was repeatedly implemented in adjacent frames (frame index 966 – 1146; Fig. <xref rid="Fig2" ref-type="fig">2e</xref>). All IM peaks in these frames were summed up to assemble the corresponding EIC peak in LC dimension, and the EIC peak apex was determined as 190 s. Finally, peak intensity was integrated from the peak volume. This 4D peak was identified as kynurenic acid with four-dimensional match (<italic>m/z</italic>, CCS, RT, and MS/MS) and validation by the chemical standard (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>Performance benchmark</title>
      <p id="Par12">The MS spectrum-oriented bottom-up assembly strategy in Met4DX enables 4D peak detection with high coverage and sensitivity. Here, we further employed five different types of biological samples (NIST human urine, NIST human plasma, mouse brain tissue, mouse liver tissue, and 293T cells) to evaluate peak detection performance of Met4DX, including coverage, sensitivity, and peak fidelity. Other software tools such as MS-DIAL and MetaboScape (Bruker Daltonics, Bremen, Germany) were used for comparison. Met4DX achieved a total of 6500–8700 and 4400–6800 features in positive and negative modes, respectively, for different sample types (Fig. <xref rid="Fig3" ref-type="fig">3a, b</xref>, Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>–<xref rid="MOESM6" ref-type="media">3</xref>). The benchmark analyses demonstrated that Met4DX significantly improved peak coverage by 2–3 folds compared to MS-DIAL and MetaboScape. In human urine samples, we demonstrated that ~70% features reported in MS-DIAL or MetaboScape were also found in Met4DX (Fig. <xref rid="Fig3" ref-type="fig">3c, d</xref>; see Methods). The similar results were also obtained in other samples (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>). To clarify, we only counted 4D peaks with MS2 spectra obtained from MS-DIAL and MetaboScape for benchmark. To demonstrate high sensitivity, we serially diluted the human urine samples by 10 to 1000 times (10X, 100X, and 1000X), and processed the data with different software tools (Fig. <xref rid="Fig3" ref-type="fig">3e, f</xref>). Met4DX provided significantly higher sensitivity of peak detection in all diluted samples. In particular, Met4DX enabled to detect a total of 2951 peaks in 1000X samples. As a comparison, only ~600 peaks were detected from the same samples using MS-DIAL and MetaboScape (Fig. <xref rid="Fig3" ref-type="fig">3e</xref>). Thus, in low abundant samples, Met4DX significantly increased the peak detection coverage by ~5 folds. The similar results were also obtained for negative mode (Fig. <xref rid="Fig3" ref-type="fig">3f</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><title>High coverage and sensitivity of 4D peak detection.</title><p><bold>a</bold>, <bold>b</bold> The numbers of 4D peaks with MS2 spectra achieved by different software tools in different biological samples in positive (<bold>a</bold>) and negative (<bold>b</bold>) modes (<italic>n</italic> = 6 technical replicates for each sample type). <bold>c</bold>, <bold>d</bold> Overlaps of 4D peaks in human urine samples detected by different software tools in positive (<bold>c</bold>) and negative (<bold>d</bold>) modes. <bold>e</bold>, <bold>f</bold> The numbers of detected 4D peaks in serially diluted urine samples (10 to 1000 times) in positive (<bold>e</bold>) and negative (<bold>f</bold>) modes (<italic>n</italic> = 6 technical replicates for each dilution sample). <bold>g</bold> Peak fidelity rates of 4D peaks in biological samples obtained from Met4DX. In <bold>a</bold>–<bold>f</bold>, we only counted 4D peaks with MS2 spectra obtained from MS-DIAL and MetaboScape for the comparisons.</p></caption><graphic xlink:href="41467_2023_37539_Fig3_HTML" id="d32e684"/></fig></p>
      <p id="Par13">We further verified the peak fidelity of 4D peaks obtained from Met4DX through both manual check and the deep learning-empowered software EVA developed by Huan group<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. A 4D peak with good EIC or EIM peak shape was recognized as a true 4D peak. We selected the replicate sample with the highest peak intensity for evaluating peak fidelity. For NIST human urine samples, we exported and manually checked 7287 EIC and 7287 EIM peaks in positive mode, and 6889 EIC and 6889 EIM peaks in negative mode, respectively. For NIST human urine samples, 97% and 93% of 4D peaks were manually checked with good peak fidelity in positive and negative modes, respectively (Fig. <xref rid="Fig3" ref-type="fig">3g</xref>). Also, EVA checked the same samples and reported the similar peak fidelity rates of 96% and 95% in positive and negative mode, respectively. In addition, 93% and 89% of peak fidelity evaluations were consistency between manual check and EVA in positive and negative modes, respectively (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>). Moreover, EVA was used to evaluate the peak fidelity of all biological samples, and showed that Met4DX achieved high rates of peak fidelity (92% ± 5%) in all biological samples (Fig. <xref rid="Fig3" ref-type="fig">3g</xref>, Supplementary Data <xref rid="MOESM7" ref-type="media">4</xref>). MS-DIAL and MetaboScape also achieved similarly high rates of peak fidelity (97% ± 3% and 96% ± 3%, respectively; Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref> and Supplementary Data <xref rid="MOESM8" ref-type="media">5</xref> and <xref rid="MOESM9" ref-type="media">6</xref>). For computational resources comparison, we run these software tools with NIST human urine data (positive mode) on a desktop with Intel Core i7-12700 (2.10 GHz; 12 CPU cores; 20 logical cores) and 32 GB memory. For computational time, MS-DIAL, MetaboScape, and Met4DX took 3, 6, and 20 min to finish the data processing. For memory usage, MS-DIAL, MetaboScape, and Met4DX occupied ~4–6 GB, ~1–1.5 GB, and ~6–9 GB, respectively. In general, the computing resource required by Met4DX is affordable for most users. Collectively, we demonstrated that Met4DX enables a high-coverage 4D peak detection through the bottom-up assembly strategy, and achieves peak detection with high sensitivity and peak fidelity.</p>
    </sec>
    <sec id="Sec6">
      <title>Quantification precision</title>
      <p id="Par14">To evaluate the quantification precision of Met4DX, we ran it, as well as MS-DIAL and MetaboScape on 6 technical replicates of human urine samples. The distribution of relative standard deviations (RSDs) of peak intensities indicates that Met4DX had substantially higher quantification precision compared to MS-DIAL and MetaboScape (Fig. <xref rid="Fig4" ref-type="fig">4a–c</xref>), with median RSDs of 16.7%, 22.0%, and 17.9%, respectively. Also, percentages of detected peaks with RSD less 30% were 81%, 61%, and 67% for Met4DX, MS-DIAL, and MetaboScape, respectively. Exemplified scatter plots of 4D feature intensities between two replicates were displayed for Met4DX and MS-DIAL (Fig. <xref rid="Fig4" ref-type="fig">4d, e</xref>). Met4DX clearly demonstrated fewer outliers and higher Pearson correlation than MS-DIAL. All pairwise Pearson correlations between replicates were demonstrated as a heat map for both Met4DX and MS-DIAL (Fig. <xref rid="Fig4" ref-type="fig">4f</xref>), showing consistently higher correlations for Met4DX (median 0.974) compared to MS-DIAL (median 0.919). The similar results were also obtained in negative mode data of human urine samples (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>). However, we found that MetaboScape had significantly lower pairwise Pearson correlations (median 0.305) due to the high portions of missing values (Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref>). Furthermore, we evaluated the quantitation linearity of Met4DX. A mixture of 20 natural products was spiked into NIST human urine samples in a 4-fold dilution series. All of natural products measured by LC–IM–MS and detected by Met4DX showed good quantitation linearity (see Methods, Supplementary Fig. <xref rid="MOESM1" ref-type="media">11</xref> and Supplementary Data <xref rid="MOESM10" ref-type="media">7</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><title>High quantification precision of 4D peak detection.</title><p><bold>a</bold>–<bold>c</bold> The distributions of relative standard deviations (RSDs) of 4D peaks from human urine samples detected by Met4DX (<bold>a</bold>), MS-DIAL (<bold>b</bold>), and MetaboScape (<bold>c</bold>). <bold>d</bold>, <bold>e</bold> Log-log scatter plot of peak intensities between sample replicates 2 and 4 obtained from Met4DX (<bold>d</bold>) and MS-DIAL (<bold>e</bold>) for human urine samples. The color represents the peak density, in which yellow means dense and blue means sparse. <bold>f</bold> All pairwise Pearson correlations of peak intensities in 6 replicates of human urine samples using Met4DX (upper triangle) and MS-DAL (lower triangle). The urine samples were measured in positive mode (<italic>n</italic> = 6 technical replicates).</p></caption><graphic xlink:href="41467_2023_37539_Fig4_HTML" id="d32e783"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Metabolite annotation and isomer differentiation</title>
      <p id="Par15">Met4DX is an end-to-end computational tool for 4D untargeted metabolomics, which provides metabolite annotation through multidimensional match with the metabolite library. In Met4DX, we curated a metabolite library of 135,638 metabolites collected from KEGG and HMDB with calculated <italic>m/z</italic>, CCS, RT, and MS/MS spectra (experimental or in silico predicted; see Methods and Supplementary Fig. <xref rid="MOESM1" ref-type="media">12a</xref>). According to the definitions of Metabolomics Standards Initiative (MSI)<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, we classified the confidence levels of metabolite annotations in Met4DX as follows: level 1, 4D match with MS1, CCS, experimental RT, and experimental MS2 spectra from in-house chemical standards; level 2, 4D match with MS1, CCS, predicted RT, and experimental MS2 spectra from public libraries; level 3, 4D match with MS1, CCS, predicted RT, and predicted MS2 spectra (Fig. <xref rid="Fig5" ref-type="fig">5a</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">12b</xref>). With features from Met4DX, we annotated 339 and 219 features with level 1 annotations, 163 and 55 features with level 2 annotations, and 1636 and 1309 features with level 3 annotations in mouse liver samples in positive and negative modes, respectively (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>). The ion mobility-enhanced metabolite annotations of other biological samples were provided in Supplementary Fig. <xref rid="MOESM1" ref-type="media">13</xref> and Supplementary Data <xref rid="MOESM11" ref-type="media">8</xref>.<fig id="Fig5"><label>Fig. 5</label><caption><title>Ion mobility-enhanced multidimensional metabolite annotation and isomer differentiation.</title><p><bold>a</bold> The curation of 4D metabolite library in Met4DX to support metabolite annotation. <bold>b</bold> Numbers of annotated 4D features with different confidence levels in positive and negative modes of mouse liver samples (<italic>n</italic> = 6 technical replicates). <bold>c</bold> Differentiation of isomeric metabolites with the same formula in 4D metabolite library with LC separation and LC×IM dual separations. For LC separation, ΔRT was set as ≥10 s. For IM separation, ΔCCS were set as ≥4%, ≥2%, and ≥0.5%, respectively. In our metabolite library, 125,163 of 135,638 metabolites had at least one isomeric metabolite (with the same formula), which generated a total of 16,484,071 pairs of isomeric metabolite pairs. <bold>d</bold> The pair number of co-eluted isobaric features detected in different software tools. We defined the isobaric feature pairs had Δm/z ≤ 10 ppm and ΔRT ≤ 10 s in each software tool. <bold>e</bold> The distributions of ΔCCS for co-eluted feature pairs in mouse liver samples. <bold>f</bold>–<bold>i</bold> Examples of co-eluted feature pairs with different ΔCCS detected by Met4DX but missed by MS-DIAL and MetaboScape (Supplementary Fig. <xref rid="MOESM1" ref-type="media">21</xref>). <bold>j</bold> Identifications of metabolite isomers in panel (<bold>f</bold>) were achieved by Met4DX. <bold>k</bold>, <bold>l</bold> Validations of N-acetyl-L-phenylalanine (<bold>k</bold>) and 3-phenylpropionylglycine (<bold>l</bold>) by chemical standards, respectively.</p></caption><graphic xlink:href="41467_2023_37539_Fig5_HTML" id="d32e871"/></fig></p>
      <p id="Par16">Isomeric metabolites are common in biological samples, and tend to co-elute on chromatography and share similar fragments in MS/MS spectra<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref></sup>. The ion mobility-enhanced untargeted metabolomics is particularly prominent for differentiating isomeric metabolites. In our metabolite library, 125,173 out of 135,638 metabolites (92%) have at least one isomer (with the same formula). A total of 1,648,4071 pairs of metabolite isomers were generated. We calculated RT and CCS values for all metabolites and found that LC could resolve 18% of isomer pairs (ΔRT ≥ 10 s; Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). The addition of IM significantly improved the resolving power, and 39% of isomer pairs could be fully resolved and separated on baseline by IM (ΔCCS ≥ 4%; Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). Most modern commercial IM-MS instruments provide an IM resolving power (ca. 50–100, CCS/ΔCCS) that separates metabolite isomers with a half-peak-width when their ΔCCS was larger than 2%<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>. With this resolution, 62% of isomer pairs could be differentiated with LC×IM dual separations (ΔCCS ≥ 2%). For isomeric pairs with 0.5% of ΔCCS, the separation can only be achieved when the IM resolving power reaches &gt;250<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. In this case, 92% of isomeric pairs could be resolved (Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). We also demonstrated how LC separation differentiated isomeric metabolites with different resolutions in the metabolite library (Supplementary Fig. <xref rid="MOESM1" ref-type="media">14</xref>). By comparison, LC showed relatively poorer separation than IM. However, the combination of LC and IM further improved the differentiation of isomeric metabolites.</p>
      <p id="Par17">We further evaluated whether Met4DX enabled to sensitively detect and differentiate the isomeric metabolites in real 4D metabolomics data. For example, a total of 6440 4D features were detected by Met4DX in negative mode of mouse liver samples. Among them, a total of 3033 pairs of co-eluted isobaric features were successfully detected and differentiated by Met4DX (Δ<italic>m/z</italic> ≤ 10 ppm and ΔRT ≤ 10 s; Fig. <xref rid="Fig5" ref-type="fig">5d</xref>). As a comparison, MS-DIAL and MetaboScape only detected 827 and 1262 pairs, respectively (Fig. <xref rid="Fig5" ref-type="fig">5d</xref>). Similar results were also obtained in positive mode of mouse liver samples (Supplementary Fig. <xref rid="MOESM1" ref-type="media">15</xref>). Therefore, Met4DX increased the coverage of co-eluted isobaric features by 2–4 folds. The ΔCCS distribution of co-eluted isobaric features detected by Met4DX were demonstrated in Fig. <xref rid="Fig5" ref-type="fig">5e</xref>. Among them, 1654 pairs (54%) had ΔCCS larger than 4%, which were fully separated by IM at baseline. In addition, 513 and 180 pairs had ΔCCS in the ranges of 2–4% and 1–2%, respectively. An example pair of M206T169C147 and M206T166C155 discriminated by Met4DX was shown in Fig. <xref rid="Fig5" ref-type="fig">5f</xref>. This pair of co-eluting isobaric feature pairs had ΔCCS of 4.8%, fully separated by ion mobility at baseline. The detailed bottom-up assembly based 4D peak detection was provided in Supplementary Fig. <xref rid="MOESM1" ref-type="media">16</xref>. With a smaller ΔCCS of 2.6% and separation at half-peak-height by IM, feature pairs of M692T122C236 and M692T122C242 were also discriminated by Met4DX (Fig. <xref rid="Fig5" ref-type="fig">5g</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">17</xref>). Another isobaric feature pair with IM separation at half-peak-height and ΔCCS of 2.3% in positive mode were shown in Fig. <xref rid="Fig5" ref-type="fig">5h</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">18</xref>. As bottom-up assembly peak detection avoided dimensionality reduction, Met4DX enabled to differentiate small CCS difference and had high sensitivity on isobaric feature discrimination. Therefore, Met4DX also enabled to discriminate co-eluted pairs of isobaric features with ΔCCS as small as 1–2% (Fig. <xref rid="Fig5" ref-type="fig">5i</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">19</xref>), which could only be partially separated by IM and better resolved with LC×IM dual separation in LC–IM–MS (Supplementary Fig. <xref rid="MOESM1" ref-type="media">20</xref>). As comparison, MS-DIAL and MetaboScape failed to detected these isobaric feature pairs in Fig. <xref rid="Fig5" ref-type="fig">5f–i</xref> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">21</xref>), which proved the superiority of Met4DX for differentiation of isomeric metabolites.</p>
      <p id="Par18">Interestingly, as many as 686 pairs of isobaric features with ΔCCS less than 1% were also successfully detected by Met4DX. The marginal ΔCCS indicated that they could not be resolved by IM. We calculated ΔRT of these isobaric feature pairs, and demonstrated that they were resolved by LC×IM dual separations and successfully detected by Met4DX. For example, the isobaric feature pairs of M765T377C255 and M765T383C255 in Supplementary Fig. <xref rid="MOESM1" ref-type="media">22a</xref> had the same CCS values. Met4DX discriminated them in the step of EIC detection during the bottom-up assembly based 4D peak detection. Another example of co-eluted isobaric feature pairs of M1023T495C265 and M1023T497C267 were also shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">22b</xref>. With ΔCCS of 0.7% and ΔRT of 1.1 s, this pair were also successfully discriminated by Met4DX.</p>
      <p id="Par19">In multidimensional metabolomic analyses using LC–IM–MS, LC separation also played a vital role in separation of isomeric metabolites in real biological samples. For example, in the mouse liver samples, there were 3691 features with at least one IM co-eluting isobaric feature (Δ<italic>m/z</italic> ≤ 10 ppm and ΔCCS ≤ 2%), generating a total of 14,528 IM co-eluting isobaric feature pairs. Among them, 12,690 pairs (87%) had ΔRT larger than 20 s (Supplementary Fig. <xref rid="MOESM1" ref-type="media">23</xref>). These results proved the importance of LC separation in multidimensional metabolomics using LC–IM–MS.</p>
      <p id="Par20">The detection of co-eluted isobaric feature pairs by Met4DX facilitated accurate annotation of metabolites, in particular for isomer metabolites. The co-eluted isobaric features in Fig. <xref rid="Fig5" ref-type="fig">5f</xref>, M206T169C147 and M206T166C155 were identified as N-acetyl-L-phenylalanine and 3-phenylpropionylglycine, respectively, through matching 4D metabolite library by Met4DX (Fig. <xref rid="Fig5" ref-type="fig">5j</xref>). The co-eluted isobaric feature pairs were annotated as the isomeric metabolites of N-acetyl-L-phenylalanine and 3-phenylpropionylglycine, respectively, with the sequential <italic>m</italic>/<italic>z</italic>, RT, CCS, and MS2 spectral matches. Among them, the CCS match successfully differentiated them (Supplementary Fig. <xref rid="MOESM1" ref-type="media">24</xref>). The identifications were further validated by chemical standards (Fig. <xref rid="Fig5" ref-type="fig">5k, l</xref>). As a comparison, the same biological sample was also acquired on LC–MS, and a chimeric MS2 spectrum was obtained (Supplementary Fig. <xref rid="MOESM1" ref-type="media">25</xref>). Although the chimeric MS spectrum included major fragments from both metabolites, the 3D library match only generated the identification of 3-phenylpropionylglycine and failed to identify N-acetyl-L-phenylalanine. As MS-DIAL and MetaboScape failed to detect this pair of isobaric features (Supplementary Fig. <xref rid="MOESM1" ref-type="media">21a, e</xref>), the isomers were not identified by them.</p>
      <p id="Par21">Together, we demonstrated that Met4DX enabled to sensitively detect and differentiate the isomeric metabolites in real 4D metabolomics data and increased the coverage by 2–4 folds. Most importantly, due to the bottom-up assembly algorithm developed for 4D peak detection, co-eluted isomeric metabolites even with small differences on LC and IM separations could be successfully differentiated by Met4DX. We have demonstrated that Met4DX is an end-to-end computational tool for 4D untargeted metabolomics, which provides IM-enhanced metabolite annotation and is particularly prominent for differentiating isomeric metabolites.</p>
    </sec>
    <sec id="Sec8">
      <title>Versatile data processing in Met4DX</title>
      <p id="Par22">Met4DX is a versatile tool to process various types of IM-based 4D metabolomics data. In addition to process PASEF-DDA data starting from MS2 spectra, Met4DX also enables to process data with a user-inputted list of precursor ions to initiate the bottom-up assembly 4D peak detection (Supplementary Figs. <xref rid="MOESM1" ref-type="media">26</xref> and <xref rid="MOESM1" ref-type="media">27</xref>), which further increases the coverage of peak detection, in particular for those without MS2 spectra acquired. To facilitate this workflow, we have curated a list of precursor ions collected from various biological samples reported above (<italic>N</italic> = 72,265 in positive mode; <italic>N</italic> = 42,553 in negative mode; Supplementary Data <xref rid="MOESM12" ref-type="media">9</xref>). Each ion includes <italic>m/z</italic>, RT, and CCS information. With the inputted precursor ion list, Met4DX enables to perform 4D peak detection and related data processing for different IM-MS data including PASEF-DDA and PASEF-DIA data from Bruker TIMS, and IM-AIF data from Agilent DTIM-MS. For example, in NIST human urine samples acquired by PASEF-DDA, Met4DX detected 11419 features in total. Among them, 8309 features (73%) had MS2 spectra (Supplementary Fig. <xref rid="MOESM1" ref-type="media">28a</xref>, Supplementary Data <xref rid="MOESM13" ref-type="media">10</xref>). As a comparison, MS-DIAL and MetaboScape detected 14440 and 4351 features, and 3741 (26%) and 3927 (90%) features had MS2 spectra, respectively. The percentage of 4D features with MS2 spectra in MS-DIAL was significantly lower than Met4DX and MetaboScape. Moreover, Met4DX also showed higher quantification precision with a median RSD of 16.5%. The percentage of detected peaks with RSD less 30% was as high as 75% in Met4DX (Supplementary Fig. <xref rid="MOESM1" ref-type="media">28b</xref>). As a sharp contrast, although MS-DIAL generated more 4D features, most of them had poor quantification precision (median RSD = 47.8%; Supplementary Fig. <xref rid="MOESM1" ref-type="media">28c</xref>). Moreover, we overlapped 4D features detected by Met4DX and MS-DIAL (Supplementary Fig. <xref rid="MOESM1" ref-type="media">29a</xref>). As a result, 5263 features were obtained from both software tools, while 6156 and 9711 features were obtained only from Met4DX and MS-DIAL, respectively. However, these additional features obtained from MS-DIAL had low quantification precision with a median RSD of 56.3% and percentage of peaks with RSD less than 30% was as low as 11% (Supplementary Fig. <xref rid="MOESM1" ref-type="media">29b</xref>). In addition, only 11% of 4D peaks had MS2 spectra acquired (Supplementary Fig. <xref rid="MOESM1" ref-type="media">29d</xref>). These results indicated that additional peaks detected by MS-DIAL and missed by Met4DX had low quality. As a sharp comparison, additional features from Met4DX showed much higher quantitation precision and MS2 coverage (Supplementary Fig. <xref rid="MOESM1" ref-type="media">29c, e</xref>).</p>
      <p id="Par23">We also demonstrated the capability of Met4DX to process PASEF-DIA data from Bruker TIMS (Supplementary Fig. <xref rid="MOESM1" ref-type="media">30</xref>, Supplementary Data <xref rid="MOESM14" ref-type="media">11</xref>) and AIF data from Agilent DTIM-MS instruments (Supplementary Fig. <xref rid="MOESM1" ref-type="media">31</xref>, Supplementary Data <xref rid="MOESM15" ref-type="media">12</xref>). In NIST human urine data acquired by PASEF-DIA from TIMS, Met4DX detected 10021 features. Among them, 7882 features (79%) had MS2 spectra extracted (Supplementary Fig. <xref rid="MOESM1" ref-type="media">30a</xref>). As a comparison, for the same dataset, MS-DIAL detected 10681 features, but only 104 features had MS2 spectra extracted (&lt;1%, Supplementary Fig. <xref rid="MOESM1" ref-type="media">30b</xref>). MetaboScape detected 5753 features and did not support MS2 spectral extraction for DIA data (Supplementary Fig. <xref rid="MOESM1" ref-type="media">30c</xref>). Together, these results demonstrated that Me4DX enabled high-coverage 4D peak detection and MS2 spectral extraction in PASEF-DIA data compared with other software tools. Both MS-DIAL and MetaboScape have to improve MS2 spectral extraction function for PASEF-DIA data. For IM-AIF data from Agilent DTIM-MS, Met4DX detected 8324 features in NIST human urine data, and 8318 features had MS2 spectra extracted (Supplementary Fig. <xref rid="MOESM1" ref-type="media">31</xref>). Similarly, MS-DIAL enabled to detect 9054 features and 9042 features had MS2 spectra extracted. This indicated both Met4DX and MS-DIAL enabled to process IM-AIF data from Agilent instrument. Altogether, we have demonstrated that Met4DX is a versatile data processing tool for various 4D metabolomics data with high-coverage and quantification precision in peak detection.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par24">Ion mobility-resolved untargeted metabolomics provides the multidimensional analysis of the complex metabolome with improved resolving power and peak capacity, and generates four-dimensional data for accurate metabolite annotation<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>. However, the high dimensionality and complexity of four-dimensional data presents a great challenge to data processing, which results in low rates of peak detection and restricts its widespread applications. Currently, peak detection in 4D proteomics<sup><xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup> and metabolomics<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> mostly converted 4D data into 3D data through the top-down-based dimensionality reduction. This strategy simplifies the data structure, but significantly reduced the peak detection sensitivity. In our study, we developed a fundamentally different strategy, which employs a MS spectrum-orientated bottom-up assembly algorithm for 4D peak detection in ion mobility-resolved untargeted metabolomics. Our method considers a MS spectrum as the smallest unit in 4D dataset, and builds its related elution peaks in IM dimension and LC dimension, respectively. Thus, the method processes 4D metabolomics data from the precursor spectrum to IM peak, LC peak, and integration of 4D peak in a reverse order of multidimensional separation. We refer to this as a reverse engineering strategy from data acquisition. With this algorithm, we developed Met4DX, an end-to-end computational tool for peak detection, quantification, and metabolite annotation in 4D metabolomics. With different biological samples, we demonstrated that Met4DX enabled high coverage and sensitivity of 4D peak detection, and achieved &gt;90% of 4D peaks with high fidelity. We thoroughly benchmarked and validated Met4DX with other existing tools, including peak coverage, sensitivity and peak fidelity as well as quantification precision. We also demonstrated that Met4DX not only unleashed in-depth identification of metabolites but also achieved successful differentiation of co-eluted isomeric metabolites with high coverage and accuracy.</p>
    <p id="Par25">Isomeric metabolites commonly exist in metabolome and could not be fully resolved by conventional LC–MS. They tend to co-elute on chromatography, co-fragmentation and share similar fragments in MS/MS spectra, restricting the accurate metabolite identification in LC–MS-based untargeted metabolomics<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref></sup>. Ion mobility-resolved 4D metabolomics has demonstrated distinct advantages to separate metabolite isomers and generate four-dimensional data to characterize these isomers<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. Although LC–IM–MS technology enables to separate these isomers, it is highly challenging for data processing software tools to detect and differentiate them from the complex 4D metabolomics data. In this work, we demonstrated that the bottom-up assembly based 4D peak detection in Met4DX had superiority and high sensitivity in detecting co-eluted isomeric metabolites (Fig. <xref rid="Fig5" ref-type="fig">5f–i</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">16</xref>–<xref rid="MOESM1" ref-type="media">19</xref>). Small differences on both IM and LC dimensions were precisely recognized and differentiated. Due to this technological advancement, Met4DX increased the coverage of co-eluted isobaric features by 2–4 folds in real 4D metabolomics data of various biological samples. We also demonstrated that Met4DX enabled to discriminate co-eluted pairs of isobaric features with ΔCCS as small as 1%, which could only be partially separated by IM. These co-eluted isomeric metabolites are often failed to be detected by other software tools such as MS-DIAL and MetaboScape (Fig. <xref rid="Fig5" ref-type="fig">5f–i</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">21</xref>). Additionally, the detection of co-eluted isobaric feature pairs by Met4DX facilitated accurate annotation of metabolites, in particular for isomer metabolites. Notably, the resolving power of IM has been rapidly improved in the past decade. Some commercial and prototype IM-MS instruments (e.g., Cyclic IMS<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> and SLIMS<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>) achieved IM resolving power up to 500–1000. With these advancements, Met4DX will become more effective to discriminate isomeric metabolites in complex metabolome, which will empower the widespread applications of ion mobility-resolved 4D metabolomics.</p>
    <p id="Par26">Currently, MS/MS spectrum is crucial for metabolite annotation and structural elucidation in untargeted metabolomics. Deciphering MS/MS spectral data through tandem spectral match with standard library, network-based strategies (e.g., GNPS<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> and MetDNA<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>), and in silico prediction tools (e.g., SIRIUS<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> and MS-FINDER<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>) have readily facilitated metabolite annotation. With the development of Met4DX, it become feasible to expand more analytical dimensions to support multidimensional metabolite annotation including LC separation-derived RT and IM separation-derived CCS. The combination of LC and IM separations with MS measurements has been proved to improve resolving power, selectivity, and sensitivity, thereby benefiting the fidelity of metabolite annotation<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>. We demonstrated that Met4DX is particularly prominent to achieve high-coverage 4D peak detection with 4D information (MS1, RT, CCS, and MS/MS) of metabolites, maximizing information coverage to support in-depth metabolite annotation. We believe the integration of Met4DX with state-of-art metabolite annotation strategies, such as network-based tools (e.g., GNPS and MetDNA) and in silico prediction tools (e.g., SIRIUS) will further increase the coverage and accuracy of metabolite annotation in metabolomics. For 4D metabolomics, in the past decade, many CCS prediction tools<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR37">37</xref>,<xref ref-type="bibr" rid="CR38">38</xref></sup> with high accuracy were developed (with CCS prediction errors of 1–2%). However, the CCS prediction accuracy highly depended on the coverage of training datasets and training models. For some compounds lacking similar structures in training datasets, these tools generated predicted CCS values with relatively large errors, introducing false positives/negatives during metabolite annotation. Alternatively, the curation of experimental CCS values from chemical standards is promising to achieve better performances in metabolite annotation. Compared with proteomics, error rate estimation (i.e., false discovery rate) is under development in metabolomics. Recently, DIAMetAlyzer<sup><xref ref-type="bibr" rid="CR39">39</xref></sup> reported an automated false-discovery rate-controlled analysis for data-independent acquisition in metabolomics. More specifically for LC–IM–MS-based lipidomics, MS-DIAL reported the FDR of lipid annotations during RT and CCS matches using their validation set<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Sterol4DAnalyzer developed by our group also reported the FDR of sterols under different CCS match tolerances<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>. A comprehensive FDR estimation for 4D metabolomics annotation should include a ground-truth benchmark dataset and evaluations of all 4-dimensional matches with different tolerances, which would be an important future plan for 4D metabolomics.</p>
    <p id="Par27">In summary, Met4DX is a mass spectrum-oriented end-to-end computational tool for 4D untargeted metabolomics, which deciphers the complex 4D information of metabolites in metabolomics data, and substantially advances the discovery of functional metabolites in biological organisms. Metabolomics software tools with broad utilization are usually developed with user-friendly graphical user interface (GUI) and support all-in-one solution from raw data importing to metabolite annotation, like MS-DIAL, MZmine<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, XCMS Online<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, and so on. A well-designed GUI enables users to adjust parameters easily and check the result with convenience. The current version of Met4DX could only be run as an R package using command lines. In the future, a GUI with comprehensive functions would make Met4DX more user-friendly.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Chemicals</title>
      <p id="Par28">LC–MS grade methanol (MeOH), 2-propanol (IPA), and water (H<sub>2</sub>O) were purchased from Honeywell (Muskegon, MI, USA). LC–MS grade acetonitrile (ACN) was purchased from Merck (Darmstadt, Germany). Ammonium hydroxide (NH<sub>4</sub>OH) and ammonium acetate (NH<sub>4</sub>OAc) were purchased from Sigma-Aldrich (St. Louis, MO, USA). Metabolite chemical standards were purchased from Sigma-Aldrich (St. Louis, MO), J&amp;K (Shanghai, China), and Bidepharm (Shanghai, China). The NIST human urine (SRM 3667) and NIST human plasma (SRM 1950) sample were purchased from Ango Biotechnology (Shanghai, China). Chemical standards for 20 natural products were purchased from TopScience (Shanghai, China).</p>
    </sec>
    <sec id="Sec12">
      <title>Sample preparation</title>
      <p id="Par29">The preparation of biological samples followed our published protocols<sup><xref ref-type="bibr" rid="CR34">34</xref>,<xref ref-type="bibr" rid="CR43">43</xref></sup>. For NIST human urine samples, 150 μL of urine was taken and 600 μL of MeOH was added for extraction. The mixture was vortexed for 30 s and sonicated for 10 min at 4 °C in water bath. To facilitate protein precipitation, samples were then incubated for 1 h at −20 °C, and centrifuged for 15 min at 17,000 × <italic>g</italic> and 4 °C. The supernatant was collected and evaporated to dryness at 4 °C. 150 μL of ACN/H<sub>2</sub>O (1:1, v/v) were added into the dry extracts for reconstitution. The solution was vortexed for 30 s, sonicated at 4 °C for 10 min, and centrifuged at 17,000 × <italic>g</italic> and 4 °C. Finally, the supernatant was transferred into a vial for LC–IM–MS analysis. To prepare serially diluted urine samples, the final supernatant was directly diluted with ACN/H<sub>2</sub>O (1:1, v/v) by 10, 100, and 1000 folds, respectively. For NIST human plasma samples, 150 μL of plasma was taken and 600 μL of MeOH/ACN (1:1, v/v) was added for extraction. The rest procedures were kept the same as described for urine samples. The 293T cell line was obtained from ATCC with Product No. CRL-2925. The cells were cultured in 6-cm dishes with Dulbecco modified Eagle’s medium (DMEM) containing FBS (10%) and penicillin/streptomycin (1%). When growing to ~2,000,000 cells/dish, cells were harvested for metabolomics analysis. The culture medium was quickly removed and cells were washed with cold PBS twice. Dishes were placed on dry ice, and 1 mL of ACN/MeOH/H<sub>2</sub>O (2:2:1, v/v/v) was added for fast quenching and extraction. The extraction solution was pre-cooled at −80 °C for 1 h prior to the extraction. Then, dishes were incubated at −80 °C for 40 min. The cells were scraped from dishes and transferred to a 1.5-mL centrifuge tube. The samples were then vortexed for 1 min, and centrifugated for 15 min at 17,000 × <italic>g</italic> and 4 °C. The supernatant was collected and evaporated to dryness at 4 °C. For reconstitution, 100 μL of ACN/H<sub>2</sub>O (1:1, v/v) were added into the dry extracts. The rest of the procedure was kept the sample as described for NIST human urine samples. The preparation of mouse liver and brain tissues followed our previous publication<sup><xref ref-type="bibr" rid="CR34">34</xref>,<xref ref-type="bibr" rid="CR43">43</xref></sup>. The natural products were dissolved in MeOH with a concentration of 1 mg/mL as the stock solution. To prepare the natural products spiked-in NIST human urine sample with the highest concentration (i.e., 1X dilution), we took 1 μL of each stock solution and spiked into 80 μL of reconstituted NIST human urine solution in ACN/H<sub>2</sub>O (1:1, v/v). Then, the 1X dilution sample was further diluted with reconstituted NIST human urine solution by 4, 16, 64, and 256 folds, respectively (Supplementary Fig. <xref rid="MOESM1" ref-type="media">11</xref>).</p>
    </sec>
    <sec id="Sec13">
      <title>LC–IM–MS analysis</title>
      <p id="Par30">All metabolomics data were acquired using an UHPLC system (1290 series, Agilent Technologies, USA) coupled to a timsTOF Pro equipped with an electrospray ionization (ESI) source (Bruker Daltonics, Bremen, Germany) or DTIM-MS 6560 (Agilent Technologies, USA). For hydrophilic interaction liquid chromatography (HILIC) separation, Waters ACQUITY UPLC BEH Amide column (particle size, 1.7 μm; 100 mm (length) × 2.1 mm (i.d.)) was used for the LC separation and the column temperature was kept at 25 °C. For both positive and negative modes, mobile phase A of 25 mM ammonium hydroxide (NH<sub>4</sub>OH) and 25 mM ammonium acetate (NH<sub>4</sub>OAc) in water and mobile phase B of ACN were used, respectively. The gradient was set as below: 0–0.5 min: 95% B, 0.5–7 min: 95% B to 65% B, 7–8 min: 65% B to 40% B, 8–9 min: 40% B, 9–9.1 min: 40% B to 95% B, and 9.1–12 min: 95% B. The flow rate was 0.5 mL/min. The injection volume was 3 μL. For reverse phase (RP) separation, Phenomenex Kinetex C18 column (particle size, 2.6 μm; 100 mm (length) × 2.1 mm (i.d.)) was used and the column temperature was kept at 25 °C. For both positive and negative modes, mobile phase A of 0.01% acetic acid (v/v) in water and mobile phase B of IPA/ACN (1:1, v/v) were used, respectively. The gradient was set as below: 0–1 min: 1% B, 1–8 min: 1% B to 99% B, 8–9 min: 99% B, 9–9.1 min: 99% B to 1% B, 9.1–12 min: 1% B. The flow rate was 0.3 mL/min. The injection volume was 3 μL. For MS acquisition, PASEF-DDA scan mode was applied with mass range from 20 to 1300 Da and mobility range from 0.45 to 1.45 V·s/cm<sup>2</sup>. Detailed parameters for MS acquisition were set as follow: capillary voltages were set as +4500 V and −3600 V for positive and negative ionization modes, respectively; nebulizer pressure, 2.2 bar; dry gas, 10.0 L/min; dry temperature, 220 °C; number of PASEF MS/MS scans, 2; ramping time, 100 ms; TIMS stepping enabled; total cycle time, 0.53 s; charge range, 0–1; absolute threshold, 100 cts; active exclusion, checked; former target ions released after 0.1 min; isolation window, 1.2 Da; collision energy, 30 eV. In PASEF-DIA data acquisition, 7 mass steps with mass width of 144.3 Da and mass overlap of 5 Da were set in each cycle, covering the mass ranges of 20–1000 Da and mobility range of 0.45–1.45 V·s/cm<sup>2</sup>. The cycle time is 0.64 s. The data acquisition was performed using timsControl (version 2.0, Bruker Daltonics, Bremen, Germany). For IM-AIF data acquisition in Agilent DTIM-MS, the source parameters were set as follows: sheath gas temperature, 325 °C; dry gas temperature, 300 °C; sheath gas flow, 11 L/min; dry gas flow, 8 L/min; capillary voltage, 4000 V; and nebulizer pressure, 20 psi. The TOF mass range was set as <italic>m</italic>/<italic>z</italic> 50–1700 Da. For ion mobility parameters, nitrogen (N<sub>2</sub>) was used for the drift gas. Other related IM parameters were set as follows: entrance and exit voltages of drift tube, 1600 and 250 V; trap filling and trap release times, 20,000 and 150 μs. The pressure of drift tube was set at 3.95 Torr. The MS/MS spectra were acquired in the “Alternating frames” mode, and the collision energy was fixed at 20 V in frame 2. The CCS values were calculated with single electric field method. Data acquisitions were carried out using MassHunter Workstation Data Acquisition Software (Version B.08.00, Agilent Technologies, USA).</p>
    </sec>
    <sec id="Sec14">
      <title>Curation of 4D metabolite library</title>
      <p id="Par31">All metabolites in KEGG (accessed on 7 March, 2017; <ext-link ext-link-type="uri" xlink:href="https://www.genome.jp/kegg/">https://www.genome.jp/kegg/</ext-link>) and HMDB (accessed on 8 November, 2021; <ext-link ext-link-type="uri" xlink:href="https://hmdb.ca/">https://hmdb.ca/</ext-link>) were combined and dereplicated with their InChIKey. Then, metabolites with exact masses larger than 1200 Da or less than 60 Da were removed. Compounds without available SMILES were removed. Finally, a total of 135,638 unique metabolites were generated as the Met4DX metabolite library (Supplementary Fig. <xref rid="MOESM1" ref-type="media">12a</xref>). The 4D information for each metabolite was generated as follows and organized in a msp format file.</p>
      <sec id="Sec15">
        <title>MS1 dimension</title>
        <p id="Par32">With the formula and adduct information, we calculated theoretical <italic>m/z</italic> of metabolite ions, including [M + H]<sup>+</sup>, [M + Na]<sup>+</sup>, [M + NH<sub>4</sub>]<sup>+</sup> and [M + H-H<sub>2</sub>O]<sup>+</sup> for positive mode, and [M-H]<sup>-</sup>, [M + Na-2H]<sup>-</sup>, [M + HCOO]<sup>-</sup> for negative mode.</p>
      </sec>
      <sec id="Sec16">
        <title>CCS dimension</title>
        <p id="Par33">The SMILES strings of metabolites were inputted in our previous developed AllCCS (<ext-link ext-link-type="uri" xlink:href="http://allccs.zhulab.cn/">http://allccs.zhulab.cn/</ext-link>) for calculation CCS values in different adduct forms<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. Specifically, [M + H]<sup>+</sup>, [M + Na]<sup>+</sup>, [M + NH<sub>4</sub>]<sup>+</sup> and [M + H-H<sub>2</sub>O]<sup>+</sup> for positive mode, and [M-H]<sup>-</sup>, [M + Na-2H]<sup>-</sup>, [M + HCOO]<sup>-</sup> for negative mode were calculated, respectively.</p>
      </sec>
      <sec id="Sec17">
        <title>RT dimension</title>
        <p id="Par34">We curated the RT library through experimental measurements and in silico prediction. We experimentally measured 883 and 907 RT values on hydrophilic interaction liquid chromatography (HILIC) and reverse phase (RP) separations, respectively, covering a total of 1014 metabolites. For other metabolites, we employed a graph neural network (GNN)-based RT prediction model developed by Lu group for RT prediction<sup><xref ref-type="bibr" rid="CR44">44</xref>,<xref ref-type="bibr" rid="CR45">45</xref></sup>. The GNN-RT models on RP and HILIC separations were trained with the SMRT dataset from Siuzdak group<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> and the Retip dataset from Fiehn group<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, respectively. In Met4DX, we performed the transfer learning of RT predictions using the experimental measured HILIC and RP RTs in our LC conditions, respectively, and constructed two new GNN-RT prediction models. In transfer learning, key parameters such as the frozen layers number, learning rate as well as the iteration number were optimized during the training of transfer learning. In the testing of transfer learning, the median absolute errors were 17.62 and 9.65 s in HILIC and RP separations, respectively (Supplementary Fig. <xref rid="MOESM1" ref-type="media">32</xref>). Finally, the GNN-RT prediction models were used to predict RTs for metabolites without experimental RTs.</p>
      </sec>
      <sec id="Sec18">
        <title>MS/MS dimension</title>
        <p id="Par35">We first acquired the standard MS/MS spectra for 1064 metabolites with the same IM-MS parameters described in LC–IM–MS analysis part. In addition, we collected the experimental MS2 spectra in MoNA (<ext-link ext-link-type="uri" xlink:href="https://mona.fiehnlab.ucdavis.edu/">https://mona.fiehnlab.ucdavis.edu/</ext-link>; accessed on 31 May, 2022) and NIST 20 mass spectral library, and dereplicated the spectra using InChIKey. A total of 5234 and 2784 metabolites had experimental MS2 spectra in positive and negative modes, respectively, covering 5506 metabolites. To predict MS2 spectra, in Met4DX, the candidate metabolites after MS1, RT, and CCS matches were further inputted into MS-FINDER (version 3.24) for prediction of MS2 spectra and MS2 spectral match (scoring and ranking).</p>
      </sec>
    </sec>
    <sec id="Sec19">
      <title>The workflow of Met4DX</title>
      <p id="Par36">The Met4DX workflow includes four major modules: (1) MS2 spectral dereplication; (2) the bottom-up assembly algorithm for 4D peak detection; (3) 4D peak alignment and grouping; (4) multidimensional match for metabolite identification.<list list-type="order"><list-item><p id="Par37"><italic>MS2 spectral dereplication</italic></p><p id="Par38">For each data file, MS2 spectral dereplication was performed. Each MS2 spectrum was first purified by removing ions with intensities less than 30 and lower than 1%. Then, MS2 spectra were binned according to their differences of precursor <italic>m/z</italic>, RT, and mobility (<italic>m/z</italic> tolerance, 20 ppm or 0.004 Da for <italic>m/z</italic> &lt; 200 Da; RT tolerance, 20 s; mobility tolerance, 0.030 V·s/cm<sup>2</sup>). For bins with more than 1 MS2 spectrum, 3D distances of all pairwise MS2 spectra were calculated by integrating the distances of precursor RT, mobility, and MS2 spectral similarity with Eqs. (<xref rid="Equ1" ref-type="disp-formula">1</xref>–<xref rid="Equ6" ref-type="disp-formula">6</xref>). The trapezoidal function was used to calculate the distances of RT and mobility, while the dot-product function was used to calculate the distance of MS2 spectra. A hierarchical cluster analysis (HCA) was applied to cluster MS2 spectra in the bin. Here, the cutoff of 3D distance was set as 1. For each MS2 cluster, the most intense MS2 spectrum (i.e., the unique MS2 spectrum) was selected and outputted to represent the cluster. The spectral intensity in an MS2 spectrum is the sum intensity of top 10 fragment ions ranked by their intensities.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\rm{Dist}}}}}}}}_{i,j}=\left\{\begin{array}{c}0,\,\quad \quad \Delta {{{{{{\rm{RT}}}}}}}\,{{{{{{\rm{or}}}}}}}\,\Delta {{{{{{\rm{mobility}}}}}}}\le {{{{{{{\rm{TOL}}}}}}}}_{\min }\\ \frac{\left(\Delta -{{{{{{{\rm{TOL}}}}}}}}_{\min }\right)}{{{{{{{{\rm{TOL}}}}}}}}_{\max }-{{{{{{{\rm{TOL}}}}}}}}_{\min }},\,\quad{{{{{{{\rm{TOL}}}}}}}}_{\min } &lt; \Delta {{{{{{\rm{RT}}}}}}}\,{{{{{{\rm{or}}}}}}}\,\Delta {{{{{{\rm{mobility}}}}}}}\le {{{{{{{\rm{TOL}}}}}}}}_{\max }\\ 1,\,\quad \quad \Delta {{{{{{\rm{RT}}}}}}}\,{{{{{{\rm{or}}}}}}}\,\Delta {{{{{{\rm{mobility}}}}}}}\, &gt; {{{{{{{\rm{TOL}}}}}}}}_{\max }\end{array}\right.$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Dist</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mspace width="1.0em"/><mml:mspace width="1.0em"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">RT</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">or</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">mobility</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">TOL</mml:mi></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mfrac><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">TOL</mml:mi></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">TOL</mml:mi></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">TOL</mml:mi></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mspace width="1.0em"/><mml:msub><mml:mrow><mml:mi mathvariant="normal">TOL</mml:mi></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">RT</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">or</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">mobility</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">TOL</mml:mi></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mspace width="1.0em"/><mml:mspace width="1.0em"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">RT</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">or</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">mobility</mml:mi><mml:mspace width="0.25em"/><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">TOL</mml:mi></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_37539_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta {{{{{{{\rm{RT}}}}}}}}_{i,j}=\left|{{{{{{{\rm{RT}}}}}}}}_{i}-{{{{{{{\rm{RT}}}}}}}}_{j}\right|$$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">RT</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">RT</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">RT</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_37539_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta {{{{{{{\rm{mobility}}}}}}}}_{i,j}=\left|{{{{{{{\rm{mobility}}}}}}}}_{i}-{{{{{{{\rm{mobility}}}}}}}}_{j}\right|$$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">mobility</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">mobility</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">mobility</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_37539_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\rm{Dist}}}}}}}}_{{{{{{{{\rm{MS}}}}}}}2}_{i,j}}=1-\frac{\varSigma {W}_{i}{W}_{j}}{\sqrt{\varSigma {W}_{i}^{2}{W}_{j}^{2}}}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Dist</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">MS</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>Σ</mml:mi><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi>Σ</mml:mi><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2023_37539_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W={{{{{{{\rm{Intensity}}}}}}}}_{{{{{{{\rm{fragment}}}}}}}}^{1}\times {[m/z]}_{{{{{{{\rm{fragment}}}}}}}}^{0}$$\end{document}</tex-math><mml:math id="M10"><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Intensity</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">fragment</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>×</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">fragment</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:math><graphic xlink:href="41467_2023_37539_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\rm{Dist}}}}}}}}_{{3D}_{i,j}}=\root 2 \of {{{W}_{{{{{{{\rm{RT}}}}}}}}\times {{{{{{\rm{Dist}}}}}}}}_{{{{{{{{\rm{RT}}}}}}}}_{i,j}}^{2}+{{W}_{{{{{{{\rm{mobility}}}}}}}}\times {{{{{{\rm{Dist}}}}}}}}_{{{{{{{{\rm{mobility}}}}}}}}_{i,j}}^{2}+{{W}_{{{{{{{\rm{MS}}}}}}}2}\times {{{{{{\rm{Dist}}}}}}}}_{{{{{{{{\rm{MS}}}}}}}2}_{i,j}}^{2}}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Dist</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mn>3</mml:mn><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mroot><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">RT</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi mathvariant="normal">Dist</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">RT</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">mobility</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi mathvariant="normal">Dist</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">mobility</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">MS</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi mathvariant="normal">Dist</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">MS</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mroot></mml:math><graphic xlink:href="41467_2023_37539_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <italic>i</italic> and <italic>j</italic> were the indexes of MS2 spectra in the bin and <italic>i</italic> ≠ <italic>j</italic>. The maximum tolerance (TOL<sub>max</sub>) was the acceptable tolerance, while the minimum tolerance (TOL<sub>min</sub>) was the penalty-free tolerance. Here, TOL<sub>max</sub> and TOL<sub>min</sub> were set as 10 s and 20 s for RT, and 0.015 and 0.030 V·s/cm<sup>2</sup> for mobility, respectively. W was the weight in each dimension, and all weights were set as 1.</p></list-item><list-item><p id="Par39"><italic>The bottom-up assembly algorithm for 4D peak detection</italic></p><p id="Par40">For each MS data file, Met4DX assembled the 4D peaks from its unique MS2 spectra with a bottom-up assembly strategy. To access raw data in.d format, the R package opentimsr<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> (<ext-link ext-link-type="uri" xlink:href="https://github.com/cran/opentimsr">https://github.com/cran/opentimsr</ext-link>; version 1.0.13) and Bruker TDF-SDK (<ext-link ext-link-type="uri" xlink:href="https://www.bruker.com/protected/zh/services/software-downloads/mass-spectrometry/raw-data-access-libraries.html">https://www.bruker.com/protected/zh/services/software-downloads/mass-spectrometry/raw-data-access-libraries.html</ext-link>; version 2.8.7.1) were used. After querying the raw data and extracting all MS1 frames, a 5-step 4D peak detection was implemented as follows:</p><p id="Par41">Step 1: precursor search. For each unique MS2 spectrum, Met4DX searched its precursor MS1 data point in the <italic>m/z</italic>-ion mobility data frame with the precursor <italic>m/z</italic>, ion mobility, and frame index recorded in the .mgf file. Step 2: EIM detection. In the precursor frame, the adjacent MS1 data points within the set <italic>m/z</italic> and mobility ranges were retrieved to reconstruct the ion mobilogram. Specifically, <italic>m/z</italic> tolerance was 20 ppm or 0.004 Da for <italic>m/z</italic> &lt; 200 Da, and the range to reconstruct ion mobilogram was set as 0.1 V·s/cm<sup>2</sup> around the precursor MS1 data point. Then, the locally weighted scatterplot smoothing (LOESS) was applied for data smoothing. The EIM peak was detected by finding the local maximum within the peak span. The default peak span of EIM detection was 13 data points, converting to 0.013 V·s/cm<sup>2</sup> under our instrument parameters. If multiple apexes found, the EIM peak with a smallest mobility difference to the precursor mobility was selected. Step 3: EIM extension. If EIM detection in step 2 was successfully achieved in the precursor frame, this step further extended EIM detection in 30 adjacent MS1 frames around precursor frames. Step 4: EIC detection. The EIM peaks in each frame were summed up to generate the frame intensities, which were further projected to the LC dimension. Thus, the ion chromatogram on LC dimension was assembled. After LOESS smoothing, the EIC peak was also detected by finding the local maximum within the peak span. The default peak span of EIC detection was 11 data points, converting to ~5.3 s in our experimental conditions. If multiple apexes found, the EIC with a smallest RT difference to the precursor RT was selected. Step 5: 4D integration. With the EIM peaks detected in step 2 and the EIC peak detected in step 4, the 4D peak was constructed. Met4DX integrated the ion intensities around the apexes. Specifically, the MS1 data points in 5 frames nearest to the EIC apex and within mobility differences of 0.015 V·s/cm<sup>2</sup> to the EIM apexes were integrated. The <italic>m/z</italic> value of the 4D peak was re-weighted with the integrated MS1 data points’ <italic>m/z</italic> values and intensities.</p><p id="Par42">In 4D peak detection, a series of criteria were implemented to ensure the peak fidelity. During the EIM and EIC peak detection, the apexes should be the local maximum within the set span in accordance with the peak width at half height under our LC–IM–MS parameters. The detected apex should be within the tolerances of the precursor RT or mobility, respectively. Specifically, 10 s and 0.015 V·s/cm<sup>2</sup> were used, respectively. Additionally, there should be continuous signals near the apex. The signal-to-noise ratios (S/N) were also calculated to filter those signals with S/N lower than 3. Furthermore, noisy signals with high fluctuation (normalized standard noise ≥0.35) were also filtered, which followed our previous publication<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>.</p><p id="Par43">After the completion of the 4D peak detection, a 4D peak table was generated for each MS file. In this table, Met4DX calculated the CCS value of each feature from its experimental mobility with Eq. (<xref rid="Equ7" ref-type="disp-formula">7</xref>):<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{CCS}}}}}}}={{{{{{\rm{convertor}}}}}}}*\frac{z}{{K}_{0}}\sqrt{\frac{1}{{TM}}}\sqrt{\frac{M+m}{m}}$$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="normal">CCS</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">convertor</mml:mi><mml:mo>*</mml:mo><mml:mfrac><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:math><graphic xlink:href="41467_2023_37539_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <italic>z</italic> was the ion charge and 1/<italic>K</italic><sub>0</sub> was the mobility. <italic>T</italic> is the temperature, 305 K. <italic>M</italic> and <italic>m</italic> are exact masses of the analyst ion and N<sub>2</sub>, respectively<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>.</p></list-item><list-item><p id="Par44"><italic>4D peak alignment and grouping</italic></p><p id="Par45">We used a landmark-based strategy for RT alignment. The detected 4D peaks between one specific reference sample and other samples were matched with 4D information (<italic>m/z</italic>, RT, CCS, and MS2 spectra). The reference sample was user-defined. We recommended using one of the pooled quality control (QC) samples or the middle sample in the injection order as the reference sample. Then, a RT correction model was built with RTs of landmarks using a LOESS-based strategy. The RTs in samples were corrected and aligned to the reference sample. After that, a density-based peak grouping strategy<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> was implemented for feature grouping. 4D features across samples were binned together according to their <italic>m/z</italic> and mobility values. The bin sizes were set as 0.015 Da and 0.015 V·s/cm<sup>2</sup>. The density on RTs was profiled to generate the final 4D peak group. The bandwidth of gaussian smoothing was set as 5 s. The MS2 spectral stochasticity is common in DDA-based data acquisition. Met4DX re-performed the 4D peak detection in samples with missing peaks. The medium values of <italic>m/z</italic> and mobility among peaks in the peak group were used as the precursor information to perform the targeted 4D peak detection in samples with missing peaks. The MS1 frame with the smallest RT difference to the median of RTs in the peak groups was regarded as the precursor frame. The re-assembled 4D peaks should also meet the criteria of peak fidelity. Peak groups those met the requirement of minimal fraction (min. frac.; 0.5 by default) were kept. Gap filling was applied for missing values in the peak table through the mandatory integration, which integrated the signals in 5 frames, 20 ppm, and 0.015 V·s/cm<sup>2</sup> in mobility near the RT, <italic>m/z,</italic> and mobility values of the 4D peak. Met4DX finally outputs the 4D peak table with the qualitative information of <italic>m/z</italic>, RT, and CCS as well as peak intensities in a.csv table, named “features_filled.csv”. MS2 spectra for features were also exported in a .msp file, named “spectra.msp”.</p></list-item><list-item><p id="Par46"><italic>Multidimensional match for metabolite identification</italic></p><p id="Par47">Met4DX performed multidimensional match between each feature and the 4D metabolite library. First, Met4DX searched candidate metabolites in the library by sequentially matching MS1, RT, and CCS values. The <italic>m/z</italic> tolerance was set as 20 ppm in MS1 match. RTs in the metabolite library were first recalibrated into the experimental condition according to the protocol in our previous publication<sup><xref ref-type="bibr" rid="CR43">43</xref>,<xref ref-type="bibr" rid="CR52">52</xref></sup>, then matched to experimental values of 4D features. Finally, CCS match was performed. In RT and CCS matches, the minimum and maximum tolerances of trapezoidal function were set as 30 s and 90 s in RT match, and 3% and 6% in CCS match, respectively (Eqs. <xref rid="Equ8" ref-type="disp-formula">8</xref>–<xref rid="Equ10" ref-type="disp-formula">10</xref>). The CCS match tolerances were set according to the CCS prediction accuracy of AllCCS<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. The results showed that 72% of predicted CCS values had relative error less than 3% while 93% of predicted CCS values had relative error less than 6% (Supplementary Fig. <xref rid="MOESM1" ref-type="media">33</xref>). The CCS match tolerances were user-defined. If the user inputs a library with CCS values with high accuracy, the tolerances could be reduced. Only metabolite candidates within the maximum tolerance were remained and scored.<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{Score}}}}}}}=\left\{1-\begin{array}{c}1,\,\quad \quad \Delta {{{{{{\rm{RT}}}}}}}\,{{{{{{\rm{or}}}}}}}\,\Delta {{{{{{\rm{CCS}}}}}}}\le {{{{{{{\rm{TOL}}}}}}}}_{\min }\\ \frac{\left(\Delta -{{{{{{{\rm{TOL}}}}}}}}_{\min }\right)}{{{{{{{{\rm{TOL}}}}}}}}_{\max }-{{{{{{{\rm{TOL}}}}}}}}_{\min }},\,\quad {{{{{{{\rm{TOL}}}}}}}}_{\min } &lt; \Delta {{{{{{\rm{RT}}}}}}}\,{{{{{{\rm{or}}}}}}}\,\Delta {{{{{{\rm{CCS}}}}}}}\le {{{{{{{\rm{TOL}}}}}}}}_{\max }\\ 0,\,\quad \quad \Delta {{{{{{\rm{RT}}}}}}}\,{{{{{{\rm{or}}}}}}}\,\Delta {{{{{{\rm{CCS}}}}}}} &gt; {{{{{{{\rm{TOL}}}}}}}}_{\max }\end{array}\right.$$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="normal">Score</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mspace width="1.0em"/><mml:mspace width="1.0em"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">RT</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">or</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">CCS</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">TOL</mml:mi></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mfrac><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">TOL</mml:mi></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">TOL</mml:mi></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">TOL</mml:mi></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mspace width="1.0em"/><mml:msub><mml:mrow><mml:mi mathvariant="normal">TOL</mml:mi></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">RT</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">or</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">CCS</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">TOL</mml:mi></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mspace width="1.0em"/><mml:mspace width="1.0em"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">RT</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">or</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">CCS</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">TOL</mml:mi></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_37539_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta {{{{{{\rm{RT}}}}}}}=\left|{{{{{{{\rm{RT}}}}}}}}_{{{{{{{\rm{experiment}}}}}}}}-{{{{{{{\rm{RT}}}}}}}}_{{{{{{{\rm{library}}}}}}}}\right|$$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">RT</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">RT</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">experiment</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">RT</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">library</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_37539_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta {{{{{{\rm{CCS}}}}}}}=\frac{\left|{{{{{{{\rm{CCS}}}}}}}}_{{{{{{{\rm{experiment}}}}}}}}-{{{{{{{\rm{CCS}}}}}}}}_{{{{{{{\rm{library}}}}}}}}\right|}{{{{{{{{\rm{CCS}}}}}}}}_{{{{{{{\rm{library}}}}}}}}}\times 100\%$$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">CCS</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">CCS</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">experiment</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">CCS</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">library</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">CCS</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">library</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mn>100</mml:mn><mml:mi>%</mml:mi></mml:math><graphic xlink:href="41467_2023_37539_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par48">For candidate metabolites having experimental MS2 spectra in library, MS2 spectral match was scored with the dot-product function (Eqs. (<xref rid="Equ11" ref-type="disp-formula">11</xref>) and (<xref rid="Equ5" ref-type="disp-formula">5</xref>)). The cutoff value was set as 0.8. For matched candidate metabolites, the match scores in RT match, CCS match, and MS2 spectral match were integrated to calculate the final combined score using a linear weighting function (Eq. (<xref rid="Equ12" ref-type="disp-formula">12</xref>)). The weighs of RT match, CCS match, and MS2 spectral match were set as 0.2, 0.4, and 0.4, respectively. The cutoff value of the combined score was set as 0.6.<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\rm{Score}}}}}}}}_{{{{{{{\rm{MS}}}}}}}2}=\frac{\varSigma {W}_{{{{{{{\rm{experiment}}}}}}}}{W}_{{{{{{{\rm{library}}}}}}}}}{\sqrt{\varSigma {W}_{{{{{{{\rm{experiment}}}}}}}}^{2}{W}_{{{{{{{\rm{library}}}}}}}}^{2}}}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Score</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">MS</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>Σ</mml:mi><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">experiment</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">library</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi>Σ</mml:mi><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">experiment</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">library</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2023_37539_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{Score}}}}}}}={W}_{{{{{{{\rm{RT}}}}}}}}\times {{{{{{{\rm{Score}}}}}}}}_{{{{{{{\rm{RT}}}}}}}}+{W}_{{{{{{{\rm{CCS}}}}}}}}\times {{{{{{{\rm{Score}}}}}}}}_{{{{{{{\rm{CCS}}}}}}}}+{W}_{{{{{{{\rm{MS}}}}}}}2}\times {{{{{{{\rm{Score}}}}}}}}_{{{{{{{\rm{MS}}}}}}}2}$$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="normal">Score</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">RT</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Score</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">RT</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">CCS</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Score</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">CCS</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">MS</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Score</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">MS</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_37539_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par49">For candidate metabolites without experimental MS2 spectra in the metabolite library, Met4DX exported the feature and its experimental MS2 spectrum into MS-FINDER for structural scoring and ranking. In Met4DX, it only kept the top 3 candidates in [M + H]<sup>+</sup> or [M-H]<sup>-</sup> adduct forms outputted by MS-FINDER. Finally, all metabolite annotation results outputted in a table named “ScoreCombine.csv”.</p></list-item></list></p>
    </sec>
    <sec id="Sec20">
      <title>Data processing with Met4DX</title>
      <p id="Par50">For PASEF-DDA data, MS2 spectra in each raw MS file were first converted into the .mgf files using DataAnalysis (Bruker Daltonics, Bremen, Germany, version 5.2). The raw MS data files and MS2 spectra in mgf files were organized into one folder and imported into Met4DX for data processing. If MS2 spectral files were not provided, Met4DX enabled to generate MS2 spectra directly from the raw data files using the “GenerateMS2” function. Our data showed that Met4DX showed high consistency in peak detection using MS2 spectra converted from DataAnalysis and generated by the “GenerateMS2” function (Supplementary Fig. <xref rid="MOESM1" ref-type="media">34</xref>). The demo code to use the “GenerateMS2” function was provided in GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/ZhuMetLab/Met4DX">https://github.com/ZhuMetLab/Met4DX</ext-link>). Detailed parameters were provided in Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>. Met4DX finally outputted the 4D peak table with the qualitative information of <italic>m/z</italic>, RT, and CCS as well as peak intensities in a .csv table, named as “features_filled.csv”. MS2 spectra for 4D features were exported in a .msp file, named as “spectra.msp”. If metabolite annotation was performed, the multidimensional match result was outputted as a “ScoreCombine.csv” file. Met4DX also supported metabolite annotation with a user-defined metabolite library, and the instruction was provided in Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p id="Par51">For PASEF-DDA data, Met4DX also supports the input of a precursor ion list as seeds to initiate 4D peak detection. In Met4DX, we have curated a list of precursor ions collected from various biological samples (<italic>N</italic> = 72,265 in positive mode; <italic>N</italic> = 42,553 in negative mode; Supplementary Data <xref rid="MOESM12" ref-type="media">9</xref>) for this workflow. Each ion included <italic>m/z</italic>, RT, and CCS information. First, Met4DX converted CCS values in the ion list into mobility values. For each of the inputted precursor ions, the bottom-up assembly algorithm was performed for 4D peak detection (see the workflow of Met4DX for details). Then, Met4DX generated a 4D peak table after peak grouping which was further filtered with a minimal fraction (min. frac.) of 0.5. To assign MS2 spectra for each feature, Met4DX matched the precursor ion information (<italic>m/z</italic>, rt, and mobility) of an MS2 spectrum to those of 4D features, and selected the most intense MS2 spectrum. Finally, the gap-filling was performed in samples with missing values. Detailed parameters were provided in Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>.</p>
      <p id="Par52">For PASEF-DIA data, Met4DX also employs the user inputted precursor ion list to initiate 4D peak detection. The detailed workflow is similar to the processing of PASEF-DDA data. The major difference is the assignment of MS2 spectra. For each 4D peak, Met4DX selected the sample with the highest peak intensity. Then, the MS2 frame at the retention time apex of the 4D peak was retrieved in the specific sample. In this <italic>m</italic>/<italic>z</italic>-mobility frame for MS2 spectra, fragment ions at mobility apex were extracted and evaluated whether they were true signals with continuous data points along mobility axis and similar <italic>m/z</italic> values. Finally, an MS2 spectrum was generated at the apex of retention time and mobility and assigned to the 4D peak. Detailed parameters were provided in Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>.</p>
      <p id="Par53">For Agilent IM-AIF data, raw data files (.d format) were first converted into .mzML format with ProteoWizard (version 3.0.20360). Then, Met4DX converted CCS values in the precursor ion list into drift times with CCS calibration coefficients (t<sub>fix</sub> and β). For each precursor ion, the bottom-up assembly algorithm was performed for 4D peak detection (see the workflow of Met4DX for details). Met4DX generated a 4D peak table after peak grouping, which was further filtered with a minimal fraction (min. frac.) of 0.5. The extraction of MS2 spectra at apex of retention time and drift time was also performed to assign MS2 spectra to each 4D peak. Finally, the gap-filling was performed in samples with missing values. Detailed parameters were provided in Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>.</p>
    </sec>
    <sec id="Sec21">
      <title>Data processing using MS-DIAL and MetaboScape</title>
      <p id="Par54">For MS-DIAL (version 4.60 for Bruker PASEF-DDA and version 4.90 for Bruker PASEF-DIA and Agilent IM-AIF data processing), raw data files were first converted into .ibf format with IbfConverter.exe. Then, MS-DIAL performed peak detection, alignment, gap filling, and MS2 spectral assignment with the converted data files. Detailed parameters were provided in Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>. The feature table with representative MS2 spectra was outputted as a .txt file. After removing features with −1 in the “Average mobility” column, the rest features were counted as the 4D features. The 4D features with MS2 spectra in the “MS/MS spectrum” column were regarded as the complete 4D features in MS-DIAL. These 4D features were used for benchmark in our study. For MetaboScape (for PASEF-DDA and PASEF-DIA data processing; Bruker Daltonics, Bremen, Germany; version 2022b), raw data files were imported for peak detection, alignment, and MS2 spectral assignment. Detailed parameters were provided in Supplementary Table <xref rid="MOESM1" ref-type="media">6</xref>. All 4D features were selected and exported to a .csv table. 4D features with TRUE in the “MS/MS” column were regarded as complete 4D features assigned with MS2 spectra. These 4D features were used for benchmark in our study. For feature overlapping comparison in different software tools, <italic>m/z</italic> tolerance, RT, and CCS tolerances were set as 20 ppm, 10 s, and 2%, respectively.</p>
    </sec>
    <sec id="Sec22">
      <title>Evaluation of peak fidelity using EVA</title>
      <p id="Par55">For each 4D feature with MS2 spectra from Met4DX, MS-DIAL, and MetaboScape, we selected the replicate sample with the highest intensity, and then assembled the 4D peak in this replicate sample to obtain the EIC and EIM peaks and evaluate the peak fidelity of the feature. For EIC peaks, the IM dimension was removed, while for EIM peaks, the LC dimension was removed. The EIC and EIM peak shapes were inputted into the EVA software for peak fidelity evaluation<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. Specifically, in MS-DIAL and MetaboScape, we used the feature information from their feature tables to re-extract the 4D features for peak fidelity evaluation. The peak fidelity rates were calculated with these re-extracted 4D features (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>).</p>
    </sec>
    <sec id="Sec23">
      <title>Reporting summary</title>
      <p id="Par56">Further information on research design is available in the <xref rid="MOESM16" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec24">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2023_37539_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2023_37539_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2023_37539_MOESM3_ESM.docx">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2023_37539_MOESM4_ESM.xlsx">
            <caption>
              <p>Supplementary Data 1</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41467_2023_37539_MOESM5_ESM.zip">
            <caption>
              <p>Supplementary Data 2</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="41467_2023_37539_MOESM6_ESM.xlsx">
            <caption>
              <p>Supplementary Data 3</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="41467_2023_37539_MOESM7_ESM.xlsx">
            <caption>
              <p>Supplementary Data 4</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="41467_2023_37539_MOESM8_ESM.xlsx">
            <caption>
              <p>Supplementary Data 5</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="41467_2023_37539_MOESM9_ESM.xlsx">
            <caption>
              <p>Supplementary Data 6</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="41467_2023_37539_MOESM10_ESM.xlsx">
            <caption>
              <p>Supplementary Data 7</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM11">
          <media xlink:href="41467_2023_37539_MOESM11_ESM.xlsx">
            <caption>
              <p>Supplementary Data 8</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM12">
          <media xlink:href="41467_2023_37539_MOESM12_ESM.xlsx">
            <caption>
              <p>Supplementary Data 9</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM13">
          <media xlink:href="41467_2023_37539_MOESM13_ESM.xlsx">
            <caption>
              <p>Supplementary Data 10</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM14">
          <media xlink:href="41467_2023_37539_MOESM14_ESM.xlsx">
            <caption>
              <p>Supplementary Data 11</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM15">
          <media xlink:href="41467_2023_37539_MOESM15_ESM.xlsx">
            <caption>
              <p>Supplementary Data 12</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM16">
          <media xlink:href="41467_2023_37539_MOESM16_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec25">
        <title>Source data</title>
        <p id="Par60">
          <media position="anchor" xlink:href="41467_2023_37539_MOESM17_ESM.xlsx" id="MOESM17">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-023-37539-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The work was supported by National Natural Science Foundation of China (31971356 to Z.J.Z.), National Key R&amp;D Program of China (2018YFA0800902 to Z.J.Z.), Excellent Young Scholar Fund from NSFC (22022411 to Z.J.Z.), Shanghai Municipal Science and Technology Major Project (2019SHZDZX02 to Z.J.Z.), and Shanghai Key Laboratory of Aging Studies (19DZ2260400 to Z.J.Z.).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Z.J.Z., M.L., and Y.Y. conceived the idea and designed the algorithm and software. Y.Y., M.L., and X.C. tested and debugged the package. M.L. performed the sample preparation, data acquisition, data processing, and data analysis. Z.Z. developed the multidimensional match algorithm and contributed to the data analysis. H.Z. curated the experimental RT and MS/MS spectral libraries of metabolites. H.W. contributed to the RT prediction. Z.J.Z. and M.L. wrote the manuscript. Z.J.Z. supervised the project.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par57"><italic>Nature Communications</italic> thanks Corey Broeckling, and the other, anonymous, reviewer for their contribution to the peer review of this work. <xref rid="MOESM2" ref-type="media">Peer reviewer reports</xref> are available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>All raw data files of biological samples acquired by TIMS with PASEF-DDA can be assessed by National Omics Data Encyclopedia under Project ID <ext-link ext-link-type="uri" xlink:href="https://www.biosino.org/node/project/detail/OEP003701">OEP003701</ext-link> and Zenodo [10.5281/zenodo.7215544]<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>. Raw data files of NIST human urine sample acquired by TIMS with PASEF-DIA and DTIM-MS with IM-AIF can be assessed by National Omics Data Encyclopedia under Project ID: <ext-link ext-link-type="uri" xlink:href="https://www.biosino.org/node/project/detail/OEP003846">OEP003846</ext-link>. KEGG database (<ext-link ext-link-type="uri" xlink:href="https://www.genome.jp/kegg/">https://www.genome.jp/kegg/</ext-link>) was accessed on 7 March, 2017. HMDB database (<ext-link ext-link-type="uri" xlink:href="https://hmdb.ca/">https://hmdb.ca/</ext-link>) was accessed on 8 November, 2021. <xref rid="Sec25" ref-type="sec">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The source code of Met4DX was provided in GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/ZhuMetLab/Met4DX">https://github.com/ZhuMetLab/Met4DX</ext-link>) and Zenodo (10.5281/zenodo.7701165)<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par58">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patti</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Yanes</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Innovation: Metabolomics: the apogee of the omics trilogy</article-title>
        <source>Nat. Rev. Mol. Cell Biol.</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>263</fpage>
        <lpage>269</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm3314</pub-id>
        <?supplied-pmid 22436749?>
        <pub-id pub-id-type="pmid">22436749</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Aksenov, A. A., da Silva, R., Knight, R., Lopes, N. P. &amp; Dorrestein, P. C. Global chemical analysis of biology by mass spectrometry. <italic>Nat. Rev. Chem.</italic><bold>1</bold>, 10.1038/s41570-017-0054 (2017).</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Creek</surname>
            <given-names>DJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metabolite identification: are you sure? And how do your peers gauge your confidence?</article-title>
        <source>Metabolomics</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>350</fpage>
        <lpage>353</lpage>
        <pub-id pub-id-type="doi">10.1007/s11306-014-0656-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metabolite measurement: pitfalls to avoid and practices to follow</article-title>
        <source>Annu. Rev. Biochem.</source>
        <year>2017</year>
        <volume>86</volume>
        <fpage>277</fpage>
        <lpage>304</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-biochem-061516-044952</pub-id>
        <?supplied-pmid 28654323?>
        <pub-id pub-id-type="pmid">28654323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mairinger</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Causon</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Hann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The potential of ion mobility-mass spectrometry for non-targeted metabolomics</article-title>
        <source>Curr. Opin. Chem. Biol.</source>
        <year>2018</year>
        <volume>42</volume>
        <fpage>9</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cbpa.2017.10.015</pub-id>
        <?supplied-pmid 29107931?>
        <pub-id pub-id-type="pmid">29107931</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paglia</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Astarita</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Ion mobility mass spectrometry in the omics era: challenges and opportunities for metabolomics and lipidomics</article-title>
        <source>Mass Spectrom. Rev.</source>
        <year>2022</year>
        <volume>41</volume>
        <fpage>722</fpage>
        <lpage>765</lpage>
        <pub-id pub-id-type="doi">10.1002/mas.21686</pub-id>
        <?supplied-pmid 33522625?>
        <pub-id pub-id-type="pmid">33522625</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>May</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>McLean</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Ion mobility-mass spectrometry: time-dispersive instrumentation</article-title>
        <source>Anal. Chem.</source>
        <year>2015</year>
        <volume>87</volume>
        <fpage>1422</fpage>
        <lpage>1436</lpage>
        <pub-id pub-id-type="doi">10.1021/ac504720m</pub-id>
        <?supplied-pmid 25526595?>
        <pub-id pub-id-type="pmid">25526595</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dodds</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Ion mobility spectrometry: fundamental concepts, instrumentation, applications, and the road ahead</article-title>
        <source>J. Am. Soc. Mass Spectrom.</source>
        <year>2019</year>
        <volume>30</volume>
        <fpage>2185</fpage>
        <lpage>2195</lpage>
        <pub-id pub-id-type="doi">10.1007/s13361-019-02288-2</pub-id>
        <?supplied-pmid 31493234?>
        <pub-id pub-id-type="pmid">31493234</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeanne Dit Fouque</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fernandez-Lima</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Recent advances in biological separations using trapped ion mobility spectrometry – mass spectrometry</article-title>
        <source>TrAC Trends Anal. Chem.</source>
        <year>2019</year>
        <volume>116</volume>
        <fpage>308</fpage>
        <lpage>315</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trac.2019.04.010</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>May</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>McLean</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Ion mobility collision cross section compendium</article-title>
        <source>Anal. Chem.</source>
        <year>2017</year>
        <volume>89</volume>
        <fpage>1032</fpage>
        <lpage>1044</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.6b04905</pub-id>
        <?supplied-pmid 28035808?>
        <pub-id pub-id-type="pmid">28035808</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A structural examination and collision cross section database for over 500 metabolites and xenobiotics using drift tube ion mobility spectrometry</article-title>
        <source>Chem. Sci.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>7724</fpage>
        <lpage>7736</lpage>
        <pub-id pub-id-type="doi">10.1039/C7SC03464D</pub-id>
        <?supplied-pmid 29568436?>
        <pub-id pub-id-type="pmid">29568436</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Tu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>ZJ</given-names>
          </name>
        </person-group>
        <article-title>Advancing the large-scale CCS database for metabolomics and lipidomics at the machine-learning era</article-title>
        <source>Curr. Opin. Chem. Biol.</source>
        <year>2018</year>
        <volume>42</volume>
        <fpage>34</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cbpa.2017.10.033</pub-id>
        <?supplied-pmid 29136580?>
        <pub-id pub-id-type="pmid">29136580</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ion mobility collision cross-section atlas for known and unknown metabolite annotation in untargeted metabolomics</article-title>
        <source>Nat. Commun.</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>4334</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-18171-8</pub-id>
        <?supplied-pmid 32859911?>
        <pub-id pub-id-type="pmid">32859911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paglia</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ion mobility derived collision cross sections to support metabolomics applications</article-title>
        <source>Anal. Chem.</source>
        <year>2014</year>
        <volume>86</volume>
        <fpage>3985</fpage>
        <lpage>3993</lpage>
        <pub-id pub-id-type="doi">10.1021/ac500405x</pub-id>
        <?supplied-pmid 24640936?>
        <pub-id pub-id-type="pmid">24640936</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Schroeder, M., Meyer, S. W., Heyman, H. M., Barsch, A. &amp; Sumner, L. W. Generation of a collision cross section library for multi-dimensional plant metabolomics using UHPLC-trapped ion mobility-MS/MS. <italic>Metabolites</italic><bold>10</bold>, 10.3390/metabo10010013 (2019).</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vasilopoulou</surname>
            <given-names>CG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Trapped ion mobility spectrometry and PASEF enable in-depth lipidomics from minimal sample amounts</article-title>
        <source>Nat. Commun.</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>331</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-14044-x</pub-id>
        <?supplied-pmid 31949144?>
        <pub-id pub-id-type="pmid">31949144</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burnum-Johnson</surname>
            <given-names>KE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ion mobility spectrometry and the omics: distinguishing isomers, molecular classes and contaminant ions in complex samples</article-title>
        <source>Trends Anal. Chem.</source>
        <year>2019</year>
        <volume>116</volume>
        <fpage>292</fpage>
        <lpage>299</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trac.2019.04.022</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prianichnikov</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MaxQuant software for ion mobility enhanced shotgun proteomics</article-title>
        <source>Mol. Cell Proteom.</source>
        <year>2020</year>
        <volume>19</volume>
        <fpage>1058</fpage>
        <lpage>1069</lpage>
        <pub-id pub-id-type="doi">10.1074/mcp.TIR119.001720</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast quantitative analysis of timsTOF PASEF data with MSFragger and IonQuant</article-title>
        <source>Mol. Cell Proteom.</source>
        <year>2020</year>
        <volume>19</volume>
        <fpage>1575</fpage>
        <lpage>1585</lpage>
        <pub-id pub-id-type="doi">10.1074/mcp.TIR120.002048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sinitcyn</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MaxDIA enables library-based and library-free data-independent acquisition proteomics</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>1563</fpage>
        <lpage>1573</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-00968-7</pub-id>
        <?supplied-pmid 34239088?>
        <pub-id pub-id-type="pmid">34239088</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Demichev</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>dia-PASEF data analysis using FragPipe and DIA-NN for deep proteomics of low sample amounts</article-title>
        <source>Nat. Commun.</source>
        <year>2022</year>
        <volume>13</volume>
        <fpage>3944</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-022-31492-0</pub-id>
        <?supplied-pmid 35803928?>
        <pub-id pub-id-type="pmid">35803928</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsugawa</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A lipidome atlas in MS-DIAL 4</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>1159</fpage>
        <lpage>1163</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0531-2</pub-id>
        <?supplied-pmid 32541957?>
        <pub-id pub-id-type="pmid">32541957</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Colby</surname>
            <given-names>SM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DEIMoS: an open-source tool for processing high-dimensional mass spectrometry data</article-title>
        <source>Anal. Chem.</source>
        <year>2022</year>
        <volume>94</volume>
        <fpage>6130</fpage>
        <lpage>6138</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.1c05017</pub-id>
        <?supplied-pmid 35430813?>
        <pub-id pub-id-type="pmid">35430813</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Kirkwood, K. I. et al. Utilizing Skyline to analyze lipidomics data containing liquid chromatography, ion mobility spectrometry and mass spectrometry dimensions. <italic>Nat. Protoc</italic>. 10.1038/s41596-022-00714-6 (2022).</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meier</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Online parallel accumulation-serial fragmentation (PASEF) with a novel trapped ion mobility mass spectrometer</article-title>
        <source>Mol. Cell Proteom.</source>
        <year>2018</year>
        <volume>17</volume>
        <fpage>2534</fpage>
        <lpage>2545</lpage>
        <pub-id pub-id-type="doi">10.1074/mcp.TIR118.000900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>EVA: evaluation of metabolic feature fidelity using a deep learning model trained with Over 25000 extracted ion chromatograms</article-title>
        <source>Anal. Chem.</source>
        <year>2021</year>
        <volume>93</volume>
        <fpage>12181</fpage>
        <lpage>12186</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.1c01309</pub-id>
        <?supplied-pmid 34455775?>
        <pub-id pub-id-type="pmid">34455775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sumner</surname>
            <given-names>LW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Proposed minimum reporting standards for chemical analysis Chemical Analysis Working Group (CAWG) Metabolomics Standards Initiative (MSI)</article-title>
        <source>Metabolomics</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>211</fpage>
        <lpage>221</lpage>
        <pub-id pub-id-type="doi">10.1007/s11306-007-0082-2</pub-id>
        <?supplied-pmid 24039616?>
        <pub-id pub-id-type="pmid">24039616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nichols</surname>
            <given-names>CM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Untargeted molecular discovery in primary metabolism: collision cross section as a molecular descriptor in ion mobility-mass spectrometry</article-title>
        <source>Anal. Chem.</source>
        <year>2018</year>
        <volume>90</volume>
        <fpage>14484</fpage>
        <lpage>14492</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.8b04322</pub-id>
        <?supplied-pmid 30449086?>
        <pub-id pub-id-type="pmid">30449086</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Z-J</given-names>
          </name>
        </person-group>
        <article-title>The emerging role of ion mobility-mass spectrometry in lipidomics to facilitate lipid separation and identification</article-title>
        <source>TrAC Trends Anal. Chem.</source>
        <year>2019</year>
        <volume>116</volume>
        <fpage>332</fpage>
        <lpage>339</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trac.2019.03.017</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dodds</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>May</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>McLean</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Investigation of the complete suite of the leucine and isoleucine isomers: toward prediction of ion mobility separation capabilities</article-title>
        <source>Anal. Chem.</source>
        <year>2017</year>
        <volume>89</volume>
        <fpage>952</fpage>
        <lpage>959</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.6b04171</pub-id>
        <?supplied-pmid 28029037?>
        <pub-id pub-id-type="pmid">28029037</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruger</surname>
            <given-names>CP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exploring complex mixtures by cyclic ion mobility high-resolution mass spectrometry: application toward petroleum</article-title>
        <source>Anal. Chem.</source>
        <year>2021</year>
        <volume>93</volume>
        <fpage>5872</fpage>
        <lpage>5881</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.1c00222</pub-id>
        <?supplied-pmid 33784070?>
        <pub-id pub-id-type="pmid">33784070</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garimella</surname>
            <given-names>SVB</given-names>
          </name>
          <name>
            <surname>Nagy</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ibrahim</surname>
            <given-names>YM</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>Opening new paths for biological applications of ion mobility - mass spectrometry using Structures for Lossless Ion Manipulations</article-title>
        <source>Trends Anal. Chem.</source>
        <year>2019</year>
        <volume>116</volume>
        <fpage>300</fpage>
        <lpage>307</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trac.2019.04.021</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sharing and community curation of mass spectrometry data with Global Natural Products Social Molecular Networking</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>828</fpage>
        <lpage>837</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3597</pub-id>
        <?supplied-pmid 27504778?>
        <pub-id pub-id-type="pmid">27504778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metabolic reaction network-based recursive metabolite annotation for untargeted metabolomics</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1516</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-09550-x</pub-id>
        <?supplied-pmid 30944337?>
        <pub-id pub-id-type="pmid">30944337</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duhrkop</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SIRIUS 4: a rapid tool for turning tandem mass spectra into metabolite structure information</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>299</fpage>
        <lpage>302</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0344-8</pub-id>
        <?supplied-pmid 30886413?>
        <pub-id pub-id-type="pmid">30886413</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsugawa</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Hydrogen rearrangement rules: computational MS/MS fragmentation and structure elucidation using MS-FINDER software</article-title>
        <source>Anal. Chem.</source>
        <year>2016</year>
        <volume>88</volume>
        <fpage>7946</fpage>
        <lpage>7958</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.6b00770</pub-id>
        <?supplied-pmid 27419259?>
        <pub-id pub-id-type="pmid">27419259</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Plante</surname>
            <given-names>PL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Predicting Ion mobility collision cross-sections using a deep neural network: DeepCCS</article-title>
        <source>Anal. Chem.</source>
        <year>2019</year>
        <volume>91</volume>
        <fpage>5191</fpage>
        <lpage>5199</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.8b05821</pub-id>
        <?supplied-pmid 30932474?>
        <pub-id pub-id-type="pmid">30932474</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ross</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Breaking down structural diversity for comprehensive prediction of ion-neutral collision cross sections</article-title>
        <source>Anal. Chem.</source>
        <year>2020</year>
        <volume>92</volume>
        <fpage>4548</fpage>
        <lpage>4557</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.9b05772</pub-id>
        <?supplied-pmid 32096630?>
        <pub-id pub-id-type="pmid">32096630</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alka</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DIAMetAlyzer allows automated false-discovery rate-controlled analysis for data-independent acquisition in metabolomics</article-title>
        <source>Nat. Commun.</source>
        <year>2022</year>
        <volume>13</volume>
        <fpage>1347</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-022-29006-z</pub-id>
        <?supplied-pmid 35292629?>
        <pub-id pub-id-type="pmid">35292629</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ion mobility-based sterolomics reveals spatially and temporally distinctive sterol lipids in the mouse brain</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>4343</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-24672-x</pub-id>
        <?supplied-pmid 34267224?>
        <pub-id pub-id-type="pmid">34267224</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pluskal</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Castillo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Villar-Briones</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Orešič</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>MZmine 2: modular framework for processing, visualizing, and analyzing mass spectrometry-based molecular profile data</article-title>
        <source>BMC Bioinforma.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-395</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huan</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systems biology guided by XCMS Online metabolomics</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>461</fpage>
        <lpage>462</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4260</pub-id>
        <?supplied-pmid 28448069?>
        <pub-id pub-id-type="pmid">28448069</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metabolite annotation from knowns to unknowns through knowledge-guided multi-layer metabolic networking</article-title>
        <source>Nat. Commun.</source>
        <year>2022</year>
        <volume>13</volume>
        <fpage>6656</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-022-34537-6</pub-id>
        <?supplied-pmid 36333358?>
        <pub-id pub-id-type="pmid">36333358</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Retention time prediction in hydrophilic interaction liquid chromatography with graph neural network and transfer learning</article-title>
        <source>J. Chromatogr. A</source>
        <year>2021</year>
        <volume>1656</volume>
        <fpage>462536</fpage>
        <pub-id pub-id-type="doi">10.1016/j.chroma.2021.462536</pub-id>
        <?supplied-pmid 34563892?>
        <pub-id pub-id-type="pmid">34563892</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Prediction of liquid chromatographic retention time with graph neural networks to assist in small molecule identification</article-title>
        <source>Anal. Chem.</source>
        <year>2021</year>
        <volume>93</volume>
        <fpage>2200</fpage>
        <lpage>2206</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.0c04071</pub-id>
        <?supplied-pmid 33406817?>
        <pub-id pub-id-type="pmid">33406817</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Domingo-Almenara</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The METLIN small molecule dataset for machine learning-based retention time prediction</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>5811</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-13680-7</pub-id>
        <?supplied-pmid 31862874?>
        <pub-id pub-id-type="pmid">31862874</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonini</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kind</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tsugawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Barupal</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Retip: retention time prediction for compound annotation in untargeted metabolomics</article-title>
        <source>Anal. Chem.</source>
        <year>2020</year>
        <volume>92</volume>
        <fpage>7515</fpage>
        <lpage>7522</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.9b05765</pub-id>
        <?supplied-pmid 32390414?>
        <pub-id pub-id-type="pmid">32390414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lacki</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Startek</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Brehmer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Distler</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Tenzer</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>OpenTIMS, TimsPy, and TimsR: open and easy access to timsTOF raw data</article-title>
        <source>J. Proteome Res</source>
        <year>2021</year>
        <volume>20</volume>
        <fpage>2122</fpage>
        <lpage>2129</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jproteome.0c00962</pub-id>
        <?supplied-pmid 33724840?>
        <pub-id pub-id-type="pmid">33724840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>ZJ</given-names>
          </name>
        </person-group>
        <article-title>DecoMetDIA: deconvolution of multiplexed MS/MS spectra for metabolite identification in SWATH-MS-based untargeted metabolomics</article-title>
        <source>Anal. Chem.</source>
        <year>2019</year>
        <volume>91</volume>
        <fpage>11897</fpage>
        <lpage>11904</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.9b02655</pub-id>
        <?supplied-pmid 31436405?>
        <pub-id pub-id-type="pmid">31436405</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hernandez</surname>
            <given-names>DR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ion dynamics in a trapped ion mobility spectrometer</article-title>
        <source>Analyst</source>
        <year>2014</year>
        <volume>139</volume>
        <fpage>1913</fpage>
        <lpage>1921</lpage>
        <pub-id pub-id-type="doi">10.1039/C3AN02174B</pub-id>
        <?supplied-pmid 24571000?>
        <pub-id pub-id-type="pmid">24571000</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Want</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>O’Maille</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abagyan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>
        <source>Anal. Chem.</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>779</fpage>
        <lpage>787</lpage>
        <pub-id pub-id-type="doi">10.1021/ac051437y</pub-id>
        <?supplied-pmid 16448051?>
        <pub-id pub-id-type="pmid">16448051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>LipidIMMS Analyzer: integrating multi-dimensional information to support lipid identification in ion mobility-mass spectrometry based lipidomics</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>698</fpage>
        <lpage>700</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty661</pub-id>
        <?supplied-pmid 30052780?>
        <pub-id pub-id-type="pmid">30052780</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Luo, M. &amp; Zhu, Z. J. A mass spectrum-oriented computational method for ion mobility-resolved untargeted metabolomics. <italic>Zenodo</italic>10.5281/zenodo.7215544 (2022).</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Luo, M. &amp; Zhu, Z. J. A mass spectrum-oriented computational method for ion mobility-resolved untargeted metabolomics. <italic>Zenodo</italic>10.5281/zenodo.7701165 (2023).</mixed-citation>
    </ref>
  </ref-list>
</back>
