<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6437914</article-id>
    <article-id pub-id-type="publisher-id">1674</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1674-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Topconfects: a package for confident effect sizes in differential expression analysis provides a more biologically useful ranked gene list</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Harrison</surname>
          <given-names>Paul F.</given-names>
        </name>
        <address>
          <email>Paul.harrison@monash.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pattison</surname>
          <given-names>Andrew D.</given-names>
        </name>
        <address>
          <email>andrew.pattison@unimelb.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Powell</surname>
          <given-names>David R.</given-names>
        </name>
        <address>
          <email>david.powell@monash.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8942-9502</contrib-id>
        <name>
          <surname>Beilharz</surname>
          <given-names>Traude H.</given-names>
        </name>
        <address>
          <email>traude.beilharz@monash.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7857</institution-id><institution-id institution-id-type="GRID">grid.1002.3</institution-id><institution>Monash Bioinformatics Platform, </institution><institution>Monash University, </institution></institution-wrap>Melbourne, Australia </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7857</institution-id><institution-id institution-id-type="GRID">grid.1002.3</institution-id><institution>Stem Cell and Development Program, Monash Biomedicine Discovery Institute and Department of Biochemistry and Molecular Biology, </institution><institution>Monash University, </institution></institution-wrap>Melbourne, Australia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>67</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>9</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>3</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Differential gene expression analysis may discover a set of genes too large to easily investigate, so a means of ranking genes by biological interest level is desired. <italic>p</italic> values are frequently abused for this purpose. As an alternative, we propose a method of ranking by confidence bounds on the log fold change, based on the previously developed TREAT test. These confidence bounds provide guaranteed false discovery rate and false coverage-statement rate control. When applied to a breast cancer dataset, the top-ranked genes by Topconfects emphasize markedly different biological processes compared to the top-ranked genes by <italic>p</italic> value.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s13059-019-1674-7) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>RNA-Seq</kwd>
      <kwd>Differential expression analysis</kwd>
      <kwd>Confidence interval</kwd>
      <kwd>False discovery rate</kwd>
      <kwd>False coverage-statement rate</kwd>
      <kwd>TREAT</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Australian Research Council</institution>
        </funding-source>
        <award-id>DP170100569</award-id>
        <award-id>FT180100049</award-id>
        <principal-award-recipient>
          <name>
            <surname>Beilharz</surname>
            <given-names>Traude H.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Australian National Health and Medical Research Council</institution>
        </funding-source>
        <award-id>APP1128250</award-id>
        <principal-award-recipient>
          <name>
            <surname>Beilharz</surname>
            <given-names>Traude H.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Misunderstanding and abuse of <italic>p</italic> values has led to widespread debate and proposals for the adoption of alternatives [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. One moderate proposal is to switch from the reporting of <italic>p</italic> values to the reporting of confidence intervals (CIs) [<xref ref-type="bibr" rid="CR4">4</xref>]. This is a shift of emphasis from a dichotomous division between zero and non-zero effect size to estimating the effect size and placing confidence bounds on this estimate. CIs are based on the same underlying theory as <italic>p</italic> values, providing control of the type I error probability (the probability of the false rejection of a true hypothesis) [<xref ref-type="bibr" rid="CR5">5</xref>]. For example, Cochrane ([<xref ref-type="bibr" rid="CR6">6</xref>], section 12.4.1) uses CIs to judge whether an intervention has not just a non-zero effect but confidently a clinically useful effect. The widely used <italic>Publication Manual of the American Psychological Association</italic> ([<xref ref-type="bibr" rid="CR7">7</xref>], section 2.07) recommends giving estimated effect sizes and strongly recommends that these be accompanied by CIs, with effect sizes to be given in the original units and possibly also in a standardized form such as Cohen’s <italic>d</italic>.</p>
    <p id="Par3">One area this shift has not yet occurred is in differential expression analysis of microarray and RNA-Seq data. Here, the effect size of interest is generally the log<sub>2</sub> fold change (LFC) in the relative RNA abundance of each gene between two groups of biological samples. A possible reason is that due to the large number of genes tested, multiple testing correction is necessary in differential expression analysis in order to maintain a false discovery rate (FDR) [<xref ref-type="bibr" rid="CR8">8</xref>]. The dependence of FDR control on the number of discoveries made makes it difficult to reconcile with the use of CIs. An alternative would be to control the family-wise error rate (FWER) using a Bonferroni correction, which has a straightforward corresponding Bonferroni correction for CIs. However, unless conclusions depend on every single CI being correct, controlling the FWER is unnecessarily strict. A final possibility is a procedure that declares a certain number of discoveries made based on some criterion and then reports false coverage-statement rate (FCR) corrected CIs for the selected genes [<xref ref-type="bibr" rid="CR9">9</xref>]. This has been implemented in the context of differential gene expression [<xref ref-type="bibr" rid="CR10">10</xref>], with the criterion being that the genes have non-zero differential expression with a given FDR. An appealing feature of this approach is that the confidence intervals of discovered genes at most touch but never pass through zero LFC.</p>
    <p id="Par4">Considering the current <italic>p</italic> value-based practice, depending on the nature of the experiment, quality of the data produced, and the chosen FDR, the number of significantly differentially expressed genes discovered may range from just a few to thousands. However, a researcher may only have resources to follow up a limited number of genes, so that thousands of discoveries present a problem. Moreover, many genes that pass this statistical test for significance may not be sufficiently changed to be of biological significance. It is important therefore to have a way to rank genes by interest level.</p>
    <p id="Par5">A common default presentation of differential expression analysis results is to list genes in order of an “FDR adjusted <italic>p</italic> value.” The researcher may choose a cutoff value for this adjusted <italic>p</italic> value, producing a set of genes with that FDR. This then gives the researcher a means to select as many genes as they are able to further investigate: read down the list until the desired number of genes is obtained. However, statistical significance is not the same as a biologically meaningful effect size. It may be that in order to obtain a manageable set of genes by this method, the researcher chooses a far smaller FDR than they actually require. Genes may as easily be chosen by this method for low biological and technical variation as for a large LFC.</p>
    <p id="Par6">A temptation is to select a set of genes by a reasonable FDR threshold and then apply a further ad hoc filtering step to obtain a reasonably sized subset. It is a common practice to perform such filtering on the basis of estimated LFC, but better might be to use the inner end of a confidence interval. However this is done, no statistical guarantee about the LFCs is given beyond that that they are non-zero. If FCR-corrected confidence intervals were used to select the subset, these would also no longer be valid for that subset.</p>
    <p id="Par7">McCarthy and Smyth [<xref ref-type="bibr" rid="CR11">11</xref>] propose a principled solution to the problem of too many discoveries with their TREAT method. The researcher nominates a minimum LFC effect size of interest. The TREAT method finds genes with a magnitude of effect size larger than this. Again, the researcher is presented with a list in order of adjusted <italic>p</italic> value and may make the final choice of FDR. However, how to choose the minimum effect size with TREAT is not necessarily obvious. On the other hand, the researcher may well be able to nominate an acceptable FDR (5% is a common choice).</p>
    <p id="Par8">Therefore, we describe here a new approach to the presentation of TREAT results in which the FDR is fixed, and genes are presented in order of a quantity we call the “confident effect size” or “confect.” If a set of genes is chosen having a magnitude of confect greater than or equal to some amount, we guarantee with the given FDR that those genes will have a true LFC magnitude greater than that chosen amount. The researcher is then easily able to choose a desired effect size of interest to follow up and is never presented with unreasonably small adjusted <italic>p</italic> values. Furthermore, once a set of genes is chosen, the confect values provide confidence bounds with a controlled FCR. This form of presentation is “test inversion,” converting hypothesis testing into a confidence bound calculation, however with a novel feature being the incorporation of FDR control. The confect ranking solves two problems at once, giving confidence bounds with an appropriate level of multiple testing correction and simultaneously providing a ranking of genes by confident effect size.</p>
    <p id="Par9">We show using synthetic data that the confect ranking method scales across experiment sizes. The method is then applied to a cancer dataset, which has a high degree of heteroscedasticity between genes. The confect ranking method, as compared to the <italic>p</italic> value ranking method, leads to a markedly different emphasis on affected biological processes.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Confect ranking matches or outperforms alternative ranking methods in simulated data</title>
      <p id="Par10">To test the performance of the confect ranking method against alternative ranking methods, we generated simulated datasets with between 2 and 128 replicates per group, with parameters as described in the “<xref rid="Sec8" ref-type="sec">Methods</xref>” section. Two simulations were performed. In simulation 1, the parameters were chosen to emphasize differences between ranking methods, and in particular, the within-group variance has been made to vary greatly between genes. In simulation 2, the parameters were chosen to match the cancer dataset to be examined next. As the data is simulated, the true LFC for each gene and the correct ranking of genes by the magnitude of LFC is known, and results from different ranking methods may be compared to this true ranking. The percentage of correct genes in the top 20, 100, and 500 genes were calculated. Results from simulation 1 are shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a and from simulation 2 are shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a. Complete simulation inputs and results are available from [<xref ref-type="bibr" rid="CR12">12</xref>].<fig id="Fig1"><label>Fig. 1</label><caption><p>Results of simulation 1. <bold>a</bold> Proportion of top genes correct by various ranking methods in the top 20, 100, and 500 genes. Where genes were correct only because the ranking method fell back to ranking by limma <italic>p</italic> value, this is shown in gray. <bold>b</bold> Achieved FCR and FDR for different LFC thresholds by the confect method for a target FDR or 5%. Below the graphs, “LFC threshold” is the threshold used to select a set of genes; “True genes” is the number of genes with LFC truly exceeding this threshold. “Correct coverage” is the number of genes discovered and with true LFC correctly covered by the confidence bound. “False coverage” is the number of genes discovered but with true LFC outside the confidence bound. The sum of these last two numbers is the total number of discoveries at that threshold. All results are averaged over 100 simulations</p></caption><graphic xlink:href="13059_2019_1674_Fig1_HTML" id="MO1"/></fig><fig id="Fig2"><label>Fig. 2</label><caption><p><bold>a</bold>, <bold>b</bold> Results of simulation 2. The layout is the same as in Fig. <xref rid="Fig1" ref-type="fig">1</xref></p></caption><graphic xlink:href="13059_2019_1674_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par11">Although it is probably the most common approach to the analysis of differential gene expression, <italic>p</italic> value-based ranking (a) did not perform well in either simulation, nor should it be expected to as <italic>p</italic> values are not an indication of LFC effect size.</p>
      <p id="Par12">Confect ranking at 5% FDR (b) performs well. In simulation 1 for experiments with small numbers of replicates, this is due to falling back to ranking by the <italic>p</italic> value for the gene having non-zero LFC (shown as a gray bar in Fig. <xref rid="Fig1" ref-type="fig">1</xref>).</p>
      <p id="Par13">Interestingly, the naive method of ranking based on the inner end of a CI (c) also performed well for the purpose of ranking genes. The only place it performed worse than confect ranking was in simulation 1 for small numbers of replicates. This does not however provide control over false discoveries. The inner end of a FWER-corrected CI (d) performed less well than either the confects methods (b) or the unadjusted intervals (c).</p>
      <p id="Par14">TREAT <italic>p</italic> value-based ranking (e, f) may be tuned to perform well when finding a certain number of top genes, but is not a good general ranking scheme. This is as expected. The point of the confect value calculation is to modify the presentation of TREAT results to correct this shortcoming.</p>
      <p id="Par15">The estimated LFC (g) performed worst in simulation 1, but performed well in simulation 2. This is because in simulation 1 some genes with very high within-group variability will have randomly had a large estimated LFC, displacing the genes with truly large LFC. In simulation 2, the differences in variability between genes are much less pronounced.</p>
    </sec>
    <sec id="Sec4">
      <title>Confect confidence bounds provide FDR and FCR control in simulated data</title>
      <p id="Par16">Selecting a set of genes with absolute confect value exceeding some threshold <italic>e</italic>, the resulting genes should truly exceed this absolute LFC, with controlled false discovery rate. Furthermore, the confect values when considered as confidence bounds for the selected genes should achieve a controlled false coverage-statement rate. A false coverage-statement has been made if the sign is incorrect or the magnitude of the confect is larger than the true LFC. Achieved FDR and FCR are assessed at different thresholds for the two simulations in Figs. <xref rid="Fig1" ref-type="fig">1</xref>b and <xref rid="Fig2" ref-type="fig">2</xref>b. Ideally, achieved FDR and FCR would match the nominal level of 5%, but it can be seen that they fall below this. Fewer false discoveries and coverage statements are made than is allowed, and some potential further true discoveries may have been missed. There are two major reasons for this. Firstly, the TREAT method is conservative. It must produce <italic>p</italic> values for the worst case of a true LFC at the edge of the null hypothesis region, but in these simulations, the actual LFCs are clustered near zero, far from the edge of the null hypothesis region. Secondly, the confidence bounds provided by confects must work with all possible thresholds, and so have a larger adjustment than is required by Benjamini and Yekutieli’s rule [<xref ref-type="bibr" rid="CR9">9</xref>] after a specific threshold is chosen.</p>
      <p id="Par17">The performance of the confect method is compared to inner bounds from FWER-adjusted CIs and unadjusted CIs in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1 and S2. FWER adjustment also provides FDR and FCR control but, as can be seen, it falls even further below the 5% level. Bounds from unadjusted CIs do not provide FDR or FCR control.</p>
    </sec>
    <sec id="Sec5">
      <title>In a cancer dataset, sorting by confident effect size rather than <italic>p</italic> value highlights different biological pathways</title>
      <p id="Par18">To understand how ranking by confect rather than <italic>p</italic> value impacts the interpretation of real experimental data, we turned to tumor-normal comparisons of breast cancer patients (BRCA) within the The Cancer Genome Atlas (TCGA). With this breast cancer dataset, limma assigns low prior degrees of freedom of 3.6, indicating a high degree of heteroscedasticity: different genes have very different levels of variability. The variance moderation applied here by limma is minor in relation to the 96 residual degrees of freedom.</p>
      <p id="Par19">Of the 17,932 genes tested, 13,784 are found to be differentially expressed at 5% FDR (this also means 13,784 genes are given a confect value at 5% FDR). Such a large list is of little use to a biologist prioritizing genes for further investigation. Therefore, we compared the top 20 genes ranked by confect at 5% FDR (Fig. <xref rid="Fig3" ref-type="fig">3</xref>) and the top 20 genes ranked by limma <italic>p</italic> value (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). The full rankings are included in Additional files <xref rid="MOESM2" ref-type="media">2</xref> and <xref rid="MOESM3" ref-type="media">3</xref>, respectively. The facetted plots to the right of the main listing in these figures show the raw data for each gene. The two methods of ranking have highlighted very different patterns of gene expression. Ranking by confect, the top genes have large LFC. The variability in LFC between patients is high in these genes; however, the confect values are also large, giving confidence that the population average LFC is truly large. Note that sets of genes at the top of the confect ranking can be obtained using the TREAT method directly. For example, the top 10 genes would be obtained using TREAT with an LFC threshold of 4.8 (the absolute confect value for the 10th gene in the ranking). However, arriving at this threshold without using confect values would require trial and error.<fig id="Fig3"><label>Fig. 3</label><caption><p>Top 20 genes by confect ranking of the breast cancer dataset at 5% FDR. For each gene, the dot shows the estimated LFC and the line shows the “confect” confidence bound. To the right, normal and tumor expression levels for all patients are shown for each listed gene</p></caption><graphic xlink:href="13059_2019_1674_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Top 20 genes by limma <italic>p</italic> value-based ranking of the breast cancer dataset. <italic>p</italic> values shown are FDR adjusted</p></caption><graphic xlink:href="13059_2019_1674_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par20">Examining the ranking by <italic>p</italic> value, the top genes may have smaller average LFCs if the LFC also has smaller variability between patients. Examples of such genes are NEK2 and KIF4A, both involved in chromosome segregation for cell division.</p>
      <p id="Par21">Gene set enrichment was searched for using the R package fgsea. There were 5182 GO Biological Process gene sets available with between 15 and 2000 genes. At 5% FDR, 453 of these gene sets are significantly enriched when ranking genes by <italic>p</italic> value, and 1294 are significantly enriched when ranking by confect. This is too many gene sets to reasonably examine, so the Normalized Enrichment Score effect size was used to find the top enriched gene sets. Table <xref rid="Tab1" ref-type="table">1</xref> shows the top 10 enriched gene sets for both ranking methods. For the <italic>p</italic> value ranking, the emphasis is on processes associated with cell division as can be expected for oncological cell transformation. For the confect ranking however, a variety of biological processes are found at the top of the list, including cell-cell signaling and blood vessel development suggestive of the tumor micro-environment. Also notable is the presence of genes involved in the extra-cellular matrix in the top 20 genes, including two collagen (COL10A1, COL11A1) and three matrix metalloproteinase genes (MMP13, MMP11, MMP1). Only three of these are seen in the top 20 genes by <italic>p</italic> value.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Top-enriched GO biological process gene sets by NES, based on <italic>p</italic> value and confect rankings. Columns “Up” and “Down” are the percent significantly upregulated and downregulated genes in the cancer samples at 5% FDR</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Ranking method</th><th>GO term</th><th>Description</th><th>NES</th><th>Genes</th><th>Up (%)</th><th>Down (%)</th></tr></thead><tbody><tr><td rowspan="10"><italic>p</italic> value</td><td>GO:0051301</td><td>Cell division</td><td>4.81</td><td>582</td><td>54</td><td>30</td></tr><tr><td>GO:0000819</td><td>Sister chromatid segregation</td><td>4.42</td><td>232</td><td>65</td><td>20</td></tr><tr><td>GO:0007049</td><td>Cell cycle</td><td>4.41</td><td>1778</td><td>48</td><td>34</td></tr><tr><td>GO:0022402</td><td>Cell cycle process</td><td>4.35</td><td>1309</td><td>50</td><td>32</td></tr><tr><td>GO:0007059</td><td>Chromosome segregation</td><td>4.34</td><td>344</td><td>60</td><td>23</td></tr><tr><td>GO:0098813</td><td>Nuclear chromosome segregation</td><td>4.18</td><td>295</td><td>60</td><td>23</td></tr><tr><td>GO:0000070</td><td>Mitotic sister chromatid segregation</td><td>4.12</td><td>149</td><td>62</td><td>21</td></tr><tr><td>GO:1903047</td><td>Mitotic cell cycle process</td><td>4.08</td><td>826</td><td>54</td><td>28</td></tr><tr><td>GO:0000278</td><td>Mitotic cell cycle</td><td>3.99</td><td>1003</td><td>52</td><td>30</td></tr><tr><td>GO:0006334</td><td>Nucleosome assembly</td><td>3.86</td><td>106</td><td>74</td><td>18</td></tr><tr><td rowspan="10">Confect</td><td>GO:0003008</td><td>System process</td><td>6.32</td><td>1472</td><td>26</td><td>52</td></tr><tr><td>GO:0007186</td><td>G protein-coupled receptor signaling pathway</td><td>5.35</td><td>771</td><td>29</td><td>51</td></tr><tr><td>GO:0009888</td><td>Tissue development</td><td>5.23</td><td>1686</td><td>36</td><td>43</td></tr><tr><td>GO:0035295</td><td>Tube development</td><td>5.16</td><td>918</td><td>31</td><td>47</td></tr><tr><td>GO:0007267</td><td>Cell-cell signaling</td><td>5.11</td><td>1481</td><td>35</td><td>45</td></tr><tr><td>GO:0048646</td><td>Anatomical structure formation involved in morphogenesis</td><td>4.92</td><td>971</td><td>32</td><td>48</td></tr><tr><td>GO:0001568</td><td>Blood vessel development</td><td>4.87</td><td>608</td><td>29</td><td>52</td></tr><tr><td>GO:0006928</td><td>Movement of cell or subcellular component</td><td>4.85</td><td>1815</td><td>35</td><td>44</td></tr><tr><td>GO:0040011</td><td>Locomotion</td><td>4.85</td><td>1578</td><td>35</td><td>45</td></tr><tr><td>GO:0010469</td><td>Regulation of signaling receptor activity</td><td>4.84</td><td>413</td><td>34</td><td>47</td></tr></tbody></table></table-wrap></p>
      <p id="Par22">Few biological experiments contain the very large number of samples present in consortia data such as the TCGA. A smaller dataset may be simulated by taking a random subset of patients. Results using a random subset of 10 patients are shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref> (see also Additional file <xref rid="MOESM4" ref-type="media">4</xref>). For the top-ranked genes, the confect values are a much smaller fraction of the effect sizes than with the full dataset. Not all of the genes with large effect sizes found in the full dataset are near the top of the list in this subset, and some genes with smaller effect sizes have been “lucky” and are highly ranked, such as COMP (jumping from 45th in the full dataset to 3rd in the subset). “Luck” of this kind is inevitable in a small dataset with this level of heteroscedasticity, and the small confect values warn that this is occurring. Similarly, by conventional <italic>p</italic> value-based differential expression analysis, genes in an underpowered experiment would need a combination of a large effect size and a certain amount of luck to be declared significantly DE. Also note that if TREAT were being used directly, the LFC threshold would need to be adjusted between the full dataset and the subset in order to obtain a set of genes of reasonable size. The LFC threshold in TREAT may be viewed as a threshold on the confidence bound and not the effect size itself and hence needs to be adjusted to suit the size of the experiment. The confect ranking method removes this need for parameter adjustment.<fig id="Fig5"><label>Fig. 5</label><caption><p>Top 20 genes by confect ranking of the breast cancer dataset at 5% FDR, using only 10 patients’ data. In the individual gene expression plots to the right, selected patients are shown as black dots and the remaining patients are shown as gray dots</p></caption><graphic xlink:href="13059_2019_1674_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Discussion</title>
    <p id="Par23">The effect size used here was the LFC, with the intention of finding changes in expression with a large biological effect. The confect ranking method identifies genes with confidently large LFC. This places all genes on the same scale, and this scale has meaningful units of log<sub>2</sub> fold change.</p>
    <p id="Par24">Can a case for using <italic>p</italic> values as an effect size be made? What follows is an attempt. In fields such as psychology where the thing being measured may not have a scale with meaningful units or where there may be a number of different scales on which something may be measured, standardized effect sizes are used. Cohen’s <italic>d</italic> is one such standardized effect size. Cohen’s <italic>d</italic> is the ratio of an effect size to some appropriate standard deviation (several choices are possible [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]). Applied to differential gene expression, a problem is that each gene has its own standard deviation and is therefore effectively placed on a different scale, but a situation where comparing Cohen’s <italic>d</italic> between genes might be appropriate would be to identify reliable prognostic biomarkers, where the interest is in genes for which the signal exceeds the background noise level. Leaving aside the use of variance moderation in limma, and when the standard deviation used is the residual standard deviation of the linear model used, Cohen’s <italic>d</italic> is proportional to the <italic>t</italic> statistic, and <italic>p</italic> is a monotonic function of ∣<italic>t</italic>∣, so <italic>p</italic> values can serve as a kind of standardized effect size, albeit one that is not comparable between experiments of different sizes. While the <italic>p</italic> values shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref> are meaninglessly small when considered as <italic>p</italic> values, they may have some meaning when considered in this way.</p>
    <p id="Par25">In the breast cancer dataset, the different ranking methods lead to an emphasis on different biological processes, both in the top-ranked genes and in downstream gene set enrichment analysis. The difference may be largely explained by the difference in ranking between Cohen’s <italic>d</italic> and LFC effect sizes. The common practice of using the <italic>t</italic> statistic for gene set enrichment tests is also effectively a choice to use Cohen’s <italic>d</italic>, as discussed above.</p>
    <p id="Par26">By concentrating on the top 20 genes in the cancer dataset, confidence bounds on gene LFCs were selectively reported. When unadjusted confidence bounds are selectively reported, they can become invalid, but the FCR control provided by the confects method ensures that the confidence bounds it provides can still be trusted when only top-ranked genes are selected.</p>
    <p id="Par27">limma’s TREAT method was used here as the basis of the confect calculation. The TREAT method has been extended to negative binomial generalized linear models (GLMs) and quasi-likelihood models in the edgeR R package’s glmTreat function, specifically the null = “worst.case” mode [<xref ref-type="bibr" rid="CR14">14</xref>]. The DESeq2 R package [<xref ref-type="bibr" rid="CR15">15</xref>] also provides a suitable test relative to a threshold for negative binomial GLMs using the result function in altHypothesis = “greaterAbs” mode. Confect calculation based on these methods is also supported by our topconfects R package.</p>
    <p id="Par28">The approach taken here has been frequentist, aside from the use of Empirical Bayes moderation of variance. FDR control has two potential Bayesian analogs. One is the “local fdr” [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>], the probability of the LFC being zero. This has the drawback of requiring dichotomous prior beliefs in which there is non-zero probability of the LFC being exactly zero. Earlier we noted that a significant rejection of the hypothesis that the LFC is zero also implies that the sign of the LFC is confidently known. This leads to a second Bayesian analog, the probability of having falsely called the sign of an LFC, which can be used to control the “Type S” error rate [<xref ref-type="bibr" rid="CR18">18</xref>]. A Bayesian analog to confect values would be credible bounds on LFCs. As with local fdr and false sign probabilities, the key to this is a hierarchical model in which the prior distribution of LFCs is modeled accurately. It is not clear what the correct form of distribution of LFCs is, so this needs a statement of prior beliefs that accommodates many possibilities. As was seen here in the cancer data, different gene sets may have different distributions of LFCs, and a fully accurate statement of prior beliefs might also take this into account. DESeq2 has recently added Bayesian “False Sign Or Small” probabilities and shrunken LFC estimates based on modeling the distribution of LFCs using either the apeglm [<xref ref-type="bibr" rid="CR19">19</xref>] or ashr [<xref ref-type="bibr" rid="CR20">20</xref>] packages. The output of credible bounds would be a simple alternative presentation of the underlying posterior distributions here.</p>
    <p id="Par29">The FCR achieved by the method described here fell short of the nominal FCR (the confidence bounds were conservative), and a Bayesian approach may remedy this.</p>
  </sec>
  <sec id="Sec7">
    <title>Conclusions</title>
    <p id="Par30">The confect ranking method described here makes good use of any amount and quality of data. There is only one parameter, the desired FDR, for which a sensible default can be given. The resulting confect quantities are used in a similar way to FDR adjusted <italic>p</italic> values to select a set of genes of interest and have some similar properties. However, confect values are in the same units as the effect size (here LFC), making them easier to interpret. Comparing confect values to estimated LFC values provides feedback on whether or not an experiment was underpowered. The common practice of performing an ad hoc filtering step by estimated LFC is no longer necessary, and compared to TREAT, which provides a more principled method of filtering by LFC, even the need to provide a threshold is removed. Overall, this method of differential expression analysis has improved usability, with less expertise required in the choice of parameters and in interpretation.</p>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <p id="Par31">The confidence bound calculation requires as input a <italic>p</italic> value function <italic>p</italic><sub><italic>i</italic></sub>(<italic>e</italic>) for each gene <italic>i</italic>, 1 ≤ <italic>i</italic> ≤ <italic>n</italic><sub>gene</sub>, for a test of the null hypothesis that the absolute effect size is at most <italic>e</italic>. <italic>p</italic><sub><italic>i</italic></sub>(<italic>e</italic>) will be a non-decreasing function of <italic>e</italic>. The TREAT method [<xref ref-type="bibr" rid="CR11">11</xref>] provides a suitable <italic>p</italic> value function, with the effect size being LFC. The limma R package [<xref ref-type="bibr" rid="CR21">21</xref>] provides an implementation of this in the treat function.</p>
    <p id="Par32">In the following section, TREAT will be described. Next, confidence bounds derived from TREAT are considered for a fixed significance level cutoff <italic>α</italic>. Finally, this is extended to FDR control, in which confidence bounds are found with a dynamic significance level cutoff.</p>
    <sec id="Sec9">
      <title>TREAT</title>
      <p id="Par33">Let <italic>x</italic><sub><italic>i</italic></sub> be the estimated LFC of the <italic>i</italic>th gene, and <italic>s</italic><sub><italic>i</italic></sub> the estimate’s standard error with <italic>d</italic> degrees of freedom. TREAT is a replacement for the <italic>t</italic> tests usually performed by the limma method of differential expression analysis [<xref ref-type="bibr" rid="CR21">21</xref>] and makes the same adjustments to <italic>s</italic><sub><italic>i</italic></sub> and <italic>d</italic> to incorporate Empirical Bayes prior information. <italic>e</italic> is the LFC threshold being tested. Let <italic>F</italic> be the cumulative distribution function of the <italic>t</italic> distribution with <italic>d</italic> degrees of freedom. The TREAT <italic>p</italic> value, from [<xref ref-type="bibr" rid="CR11">11</xref>], is<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {p}_i(e)=1-F\left(\frac{\left|{x}_i\right|-e}{s_i}\right)+1-F\left(\frac{\left|{x}_i\right|+e}{s_i}\right) $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>e</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>−</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1674_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par34">An example of the shape of this function is shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>a. For the case of <italic>e</italic> = 0, the <italic>p</italic> value is the same as for a two-sided <italic>t</italic> test. We now check that this is a non-decreasing function of <italic>e</italic>. The derivative of <italic>F</italic> is the probability density function of the <italic>t</italic> distribution:<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {F}^{\prime }(t)=\frac{\Gamma \left(\frac{d+1}{2}\right)}{\sqrt{d\pi}\Gamma \left(\frac{\mathrm{d}}{2}\right)}{\left(1+\frac{t^2}{d}\right)}^{-\frac{d+1}{2}} $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:msup><mml:mi>F</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mrow><mml:mrow><mml:msqrt><mml:mi mathvariant="italic">dπ</mml:mi></mml:msqrt><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:mi mathvariant="normal">d</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mrow></mml:mfrac><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>d</mml:mi></mml:mfrac></mml:mrow></mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:math><graphic xlink:href="13059_2019_1674_Article_Equb.gif" position="anchor"/></alternatives></disp-formula><fig id="Fig6"><label>Fig. 6</label><caption><p><bold>a</bold> TREAT <italic>p</italic> value (<italic>p</italic><sub><italic>i</italic></sub>(<italic>e</italic>)) as a function of LFC (<italic>e</italic>), for <italic>x</italic><sub><italic>i</italic></sub> = 5,  <italic>s</italic><sub><italic>i</italic></sub> = 1,  <italic>d</italic> = 10. A 95% lower confidence bound on the effect size can be found from the <italic>e</italic> at which <italic>p</italic><sub><italic>i</italic></sub>(<italic>e</italic>) = 0.05. <bold>b</bold> Illustration of ranking method. Sets <italic>S</italic>(<italic>e</italic>) are sets of genes with effect size significantly exceeding threshold <italic>e</italic> at some desired FDR. These sets nest, providing a ranking of genes. From this diagram, the resulting confect values would be 1.5, 1, 1, 0.5, 0.5, 0.5, and 0 and with no value given to the final two genes</p></caption><graphic xlink:href="13059_2019_1674_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par35">All that is needed is to observe that this is a decreasing function of <italic>t</italic><sup>2</sup>. Now taking the derivative of <italic>p</italic><sub><italic>i</italic></sub>(<italic>e</italic>) with respect to <italic>e</italic>,<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {p}_i^{\prime }(e)=\frac{1}{s_i}{F}^{\prime}\left(\frac{\left|{x}_i\right|-e}{s_i}\right)-\frac{1}{s_i}{F}^{\prime}\left(\frac{\left|{x}_i\right|+e}{s_i}\right) $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>e</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>−</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:msup><mml:mi>F</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1674_Article_Equc.gif" position="anchor"/></alternatives></disp-formula><italic>e</italic> ≥ 0 and assuming <italic>s</italic><sub><italic>i</italic></sub> &gt; 0, it must be that <inline-formula id="IEq1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\left(\frac{\left|{x}_i\right|-e}{s_i}\right)}^2\le {\left(\frac{\left|{x}_i\right|+e}{s_i}\right)}^2 $$\end{document}</tex-math><mml:math id="M8" display="inline"><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>−</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>≤</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13059_2019_1674_Article_IEq1.gif"/></alternatives></inline-formula>. Therefore, <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {p}_i^{\prime }(e)\ge 0 $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>e</mml:mi></mml:mfenced><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="13059_2019_1674_Article_IEq2.gif"/></alternatives></inline-formula>, and therefore, <italic>p</italic><sub><italic>i</italic></sub>(<italic>e</italic>) is a non-decreasing function of <italic>e</italic>.</p>
    </sec>
    <sec id="Sec10">
      <title>Confidence bounds from TREAT</title>
      <p id="Par37">There is a close relationship between CIs and <italic>p</italic> values. For example, considering the two-sided <italic>t</italic> test of the null hypothesis that the LFC of a gene is <italic>e</italic>, the null hypothesis is not rejected for values of <italic>e</italic> where <italic>p</italic><sup><italic>t</italic> − test</sup>(<italic>e</italic>) &gt; <italic>α</italic>, and these values then form a 1 − <italic>α</italic> confidence interval. Similarly, a confidence bound can be obtained from the one-sided <italic>t</italic> test. This is called test inversion.</p>
      <p id="Par38">Note in particular that a significant result on a <italic>t</italic> test for <italic>e</italic> = 0 not only establishes that the LFC is non-zero, but also establishes that the sign of the LFC is known, since the corresponding confidence interval will lie either entirely above or below 0.</p>
      <p id="Par39">In the case of TREAT, the null hypothesis is that the LFC lies inside the range [−<italic>e</italic>, <italic>e</italic>]. Thus, TREAT <italic>p</italic> values are always larger than those from the <italic>t</italic> test that the LFC is 0, and a significant TREAT result determines the sign of the LFC. Taking the small liberty of considering that these two properties hold simultaneously, we view the largest <italic>e</italic> for which <italic>p</italic><sub><italic>i</italic></sub>(<italic>e</italic>) ≤ <italic>α</italic> as providing a confidence bound, establishing either that the LFC is greater than <italic>e</italic>, or establishing that it is less than −<italic>e</italic>.</p>
    </sec>
    <sec id="Sec11">
      <title>Calculation of confects</title>
      <p id="Par40">Using TREAT, and making the assumption that each gene is independent of the others, a set of genes with a magnitude of effect size exceeding <italic>e</italic> at a given FDR <italic>q</italic> may be obtained using the procedure of Benjamini and Hochberg [<xref ref-type="bibr" rid="CR8">8</xref>]. Benjamini and Hochberg’s procedure is to find the <italic>largest</italic> set <italic>S</italic>(<italic>e</italic>) satisfying<disp-formula id="Equd"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ S(e)=\left\{i:{p}_i(e)\le \frac{\mid S(e)\mid }{n_{\mathrm{gene}}}q\right\} $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mi>e</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>e</mml:mi></mml:mfenced><mml:mo>≤</mml:mo><mml:mfrac><mml:mrow><mml:mo>∣</mml:mo><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mi>e</mml:mi></mml:mfenced><mml:mo>∣</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>gene</mml:mtext></mml:msub></mml:mfrac><mml:mi>q</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1674_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par41">Sets for different effect sizes nest. If <italic>e</italic> &gt; <italic>e</italic>′, then <italic>S</italic>(<italic>e</italic>) ⊆ <italic>S</italic>(<italic>e</italic>′). Genes may drop out of <italic>S</italic>(<italic>e</italic>) as <italic>e</italic> increases for two reasons. Firstly, <italic>p</italic><sub><italic>i</italic></sub>(<italic>e</italic>) may rise above the threshold for inclusion in the set. Secondly, the threshold for inculsion in the set is a function of the size of the set ∣<italic>S</italic>(<italic>e</italic>)∣, so as the set becomes smaller, the threshold also becomes stricter. Thus, as one gene drops out several more may also need to immediately be dropped.</p>
      <p id="Par42">Let ∣<italic>c</italic><sub><italic>i</italic></sub>∣ be the largest <italic>e</italic> such that <italic>i</italic> ∈ <italic>S</italic>(<italic>e</italic>), and let the sign of <italic>c</italic><sub><italic>i</italic></sub> be the actual sign of the estimated effect. We call this quantity the “confect,” for <italic>con</italic>fident ef<italic>fect</italic> size. In our implementation, when computing <italic>c</italic><sub><italic>i</italic></sub>, we scan through a discrete set of effect sizes, by default considering <italic>e</italic> = 0, 0.01, 0.02, 0.03, … until <italic>S</italic>(<italic>e</italic>) is empty.</p>
      <p id="Par43">By presenting genes in order from largest to smallest ∣<italic>c</italic><sub><italic>i</italic></sub>∣, the researcher may easily choose an effect size resulting in a set of genes <italic>S</italic>(<italic>e</italic>) of a size suitable for their purpose. It may happen that some genes have the same ∣<italic>c</italic><sub><italic>i</italic></sub>∣, and in order to obtain a total order, we sort these by <italic>p</italic><sub><italic>i</italic></sub>(<italic>e</italic>) at the first <italic>e</italic> for which they are not in <italic>S</italic>(<italic>e</italic>). Some genes are not a member of any set and are not given a confect. These are listed last, in order of <italic>p</italic><sub><italic>i</italic></sub>(0) (the <italic>p</italic> value given by limma without using TREAT). An illustration of this method is shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>b.</p>
      <p id="Par44">The overall effect of this procedure is to provide a lower confidence bound on the magnitude of LFC for each gene, but with a higher level of confidence required for the larger effect sizes at the top of the list than for the smaller effect sizes lower down the list. This idea is made precise in the next section. Further, the set {<italic>i</italic>:| <italic>c</italic><sub><italic>i</italic></sub>| ≥<italic>e</italic>} is precisely <italic>S</italic>(<italic>e</italic>) and is always at the top of the ordering.</p>
      <p id="Par45">R code implementing this procedure is provided at <ext-link ext-link-type="uri" xlink:href="https://github.com/pfh/topconfects">https://github.com/pfh/topconfects</ext-link>.</p>
    </sec>
    <sec id="Sec12">
      <title>Relationship to false coverage-statement rate (FCR)</title>
      <p id="Par46">If a set of genes are selected, by any selection rule, FCR controlling confidence intervals or bounds for the selected genes may be constructed using a rule described by Benjamini and Yekutieli [<xref ref-type="bibr" rid="CR9">9</xref>]. This rule is that to ensure an FCR of <italic>q</italic> with <italic>n</italic><sub>selected</sub> genes selected, each confidence region must have coverage probability no less than <inline-formula id="IEq3"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ 1-\frac{n_{\mathrm{selected}}}{n_{\mathrm{gene}}}q $$\end{document}</tex-math><mml:math id="M14" display="inline"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mtext>selected</mml:mtext></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mtext>gene</mml:mtext></mml:msub></mml:mfrac><mml:mi>q</mml:mi></mml:math><inline-graphic xlink:href="13059_2019_1674_Article_IEq3.gif"/></alternatives></inline-formula>. Based on the preceding discussion, for confect confidence bounds, this is achieved if <inline-formula id="IEq4"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {p}_i\left(\left|{c}_i\right|\right)\le \frac{n_{\mathrm{selected}}}{n_{\mathrm{gene}}}q $$\end{document}</tex-math><mml:math id="M16" display="inline"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mfenced><mml:mo>≤</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mtext>selected</mml:mtext></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mtext>gene</mml:mtext></mml:msub></mml:mfrac><mml:mi>q</mml:mi></mml:math><inline-graphic xlink:href="13059_2019_1674_Article_IEq4.gif"/></alternatives></inline-formula>.</p>
      <p id="Par47">Suppose a set of genes are selected based on having an absolute confect value of at least <italic>e</italic>. That is, they are the members of <italic>S</italic>(<italic>e</italic>) and <italic>n</italic><sub>selected</sub> = |<italic>S</italic>(<italic>e</italic>)|. Then, for each gene <italic>i</italic> in the set, we have a confect value <italic>c</italic><sub><italic>i</italic></sub> derived from membership in a set <italic>S</italic>(|<italic>c</italic><sub><italic>i</italic></sub>|), |<italic>c</italic><sub><italic>i</italic></sub>| ≥ <italic>e</italic>, and by the nesting of sets |<italic>S</italic>(|<italic>c</italic><sub><italic>i</italic></sub>|)| ≤ <italic>n</italic><sub>selected</sub>. By the definition of the members of the sets, we have<disp-formula id="Eque"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {p}_i\left(\left|{c}_i\right|\right)\le \frac{\left|S\left(\left|{c}_i\right|\right)\right|}{n_{\mathrm{gene}}}q\le \frac{n_{\mathrm{selected}}}{n_{\mathrm{gene}}}q $$\end{document}</tex-math><mml:math id="M18" display="block"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mfenced><mml:mo>≤</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mi>n</mml:mi><mml:mtext>gene</mml:mtext></mml:msub></mml:mfrac><mml:mi>q</mml:mi><mml:mo>≤</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mtext>selected</mml:mtext></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mtext>gene</mml:mtext></mml:msub></mml:mfrac><mml:mi>q</mml:mi></mml:math><graphic xlink:href="13059_2019_1674_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par48">Therefore, the coverage probability of each gene in the set is sufficient to control the FCR.</p>
    </sec>
    <sec id="Sec13">
      <title>Evaluation with synthetic data</title>
      <p id="Par49">Simulated data for <italic>n</italic><sub>gene</sub> genes is generated for two equally sized groups with <italic>n</italic><sub>rep</sub> samples within each group. We follow the distributional assumption of limma [<xref ref-type="bibr" rid="CR21">21</xref>] that the gene-wise within-group variances <inline-formula id="IEq5"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}_i^2 $$\end{document}</tex-math><mml:math id="M20" display="inline"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1674_Article_IEq5.gif"/></alternatives></inline-formula> follow a scaled inverse chi-square distribution with degrees of freedom <italic>d</italic><sub>within</sub> and scale parameter <italic>s</italic><sub>within</sub>.<disp-formula id="Equf"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{d_{\mathrm{within}}{s}_{\mathrm{within}}^2}{\sigma_i^2}\sim {\chi}_{d_{\mathrm{within}}}^2 $$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>within</mml:mtext></mml:msub><mml:msubsup><mml:mi>s</mml:mi><mml:mtext>within</mml:mtext><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:mo>~</mml:mo><mml:msubsup><mml:mi>χ</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mtext>within</mml:mtext></mml:msub><mml:mn>2</mml:mn></mml:msubsup></mml:math><graphic xlink:href="13059_2019_1674_Article_Equf.gif" position="anchor"/></alternatives></disp-formula>limma’s calculation of <italic>p</italic> values, both normally and with the TREAT method, do not depend on any assumption about the distribution of LFC. limma’s calculation of the posterior log-odds <italic>B</italic> statistic does make such assumptions, specifically that there are a set of genes that are not differentially expressed, and the ratio of LFC to <italic>σ</italic><sub><italic>i</italic></sub> for the differentially expressed genes follows a specific distribution. This <italic>B</italic> statistic is not used here. The intent of this paper is to move from the dichotomous mode of thinking associated with <italic>p</italic> values to the estimation mode of thinking associated with effect sizes [<xref ref-type="bibr" rid="CR4">4</xref>], so our simulations do not assume any gene has precisely zero LFC. However, in a typical experiment, some genes are differentially expressed to a much greater extent than the majority.</p>
      <p id="Par50">Two simulations were performed, with different distributions of LFCs. “Simulation 1” investigates the scenario of large LFCs in some genes and large within-group variances in some genes, in order to best demonstrate differences between ranking methods. “Simulation 2” is a less variable simulation based on the cancer dataset described in the next section.</p>
      <p id="Par51">In simulation 1, we use a distribution of LFCs <italic>β</italic><sub><italic>i</italic></sub> with tails following a power law, specifically a scaled <italic>t</italic> distribution with <italic>d</italic><sub>between</sub> degrees of freedom and scaling factor <italic>s</italic><sub>between</sub>.<disp-formula id="Equg"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{\beta_i}{s_{\mathrm{between}}}\sim t\left({d}_{\mathrm{between}}\right) $$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mfrac><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mtext>between</mml:mtext></mml:msub></mml:mfrac><mml:mo>∼</mml:mo><mml:mi>t</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>d</mml:mi><mml:mtext>between</mml:mtext></mml:msub></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1674_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par52">In particular, the values used for the simulation were <italic>n</italic><sub>gene</sub> = 15000, <italic>n</italic><sub>rep</sub> = 2, 3, 4, 8, 16, 32, 64 and 128, <italic>d</italic><sub>within</sub> = 2, <italic>s</italic><sub>within</sub> = 0.75, <italic>d</italic><sub>between</sub> = 3, and <italic>s</italic><sub>between</sub> = 0.5. Note in particular that <italic>d</italic><sub>within</sub> has been chosen to be extremely small, which will generate a highly heteroscedastic dataset, in order to emphasize differences between different ways of ranking genes. Results are averaged over 100 runs of the simulation.</p>
      <p id="Par53">In simulation 2, we approximated the distribution of LFCs and residual variances seen in the cancer dataset described in the next section. A <italic>t</italic> distribution was not a good fit to the LFCs in this data, and a Laplace distribution was found to be a better fit. This has exponential rather than power-law tails.<disp-formula id="Equh"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\beta}_i\sim \mathrm{Laplace}\left(0,{s}_{\mathrm{between}}\right) $$\end{document}</tex-math><mml:math id="M26" display="block"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mtext>Laplace</mml:mtext><mml:mfenced close=")" open="(" separators=","><mml:mn>0</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mtext>between</mml:mtext></mml:msub></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1674_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par54">In particular, the values used for simulation 2 were <italic>n</italic><sub>gene</sub> = 15000, <italic>n</italic><sub>rep</sub> = 2, 3, 4, 8, 16, 32, 64 and 128, <italic>d</italic><sub>within</sub> = 5, <italic>s</italic><sub>within</sub> = 0.5, and <italic>s</italic><sub>between</sub> = 0.8. When choosing these values, maximum likelihood estimation was tried but did not lead to a good match to the tails of the cancer dataset distributions, so these values have been manually chosen to better match the tails of these distributions (shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). Again, <italic>d</italic><sub>within</sub> is an important parameter, and the higher value used here results in lower heteroscedasticity. Results are again averaged over 100 runs of the simulation.</p>
      <p id="Par55">Seven different methods of ranking genes are compared:<list list-type="alpha-lower"><list-item><p id="Par56">Ranking by limma <italic>p</italic> value. Ranking by <italic>p</italic> value is a common default output of differential expression software.</p></list-item><list-item><p id="Par57">Confect ranking at 5% FDR. This is the proposed method, with a reasonable choice of FDR.</p></list-item><list-item><p id="Par58">Ranking by the inner end of a 95% CI. Where the CIs span zero, genes are further ranked by limma <italic>p</italic> value. While this does not control the FDR, its accuracy as a ranking method is of interest.</p></list-item><list-item><p id="Par59">Ranking by the inner end of a Bonferroni-corrected CI maintaining a FWER of 5%. Where the CIs span zero, genes are further ranked by limma <italic>p</italic> value. This is a very strict correction for multiple testing.</p></list-item><list-item><p id="Par60">Ranking by TREAT <italic>p</italic> value with LFC threshold 1.0. While not a general ranking by LFC effect size, this should serve to distinguish genes having LFC magnitude exceeding 1.0 from those that do not.</p></list-item><list-item><p id="Par61">Ranking by TREAT <italic>p</italic> value with LFC threshold 5.0.</p></list-item><list-item><p id="Par62">Ranking by the magnitude of the LFC estimated by limma. If the noise level <inline-formula id="IEq6"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}_i^2 $$\end{document}</tex-math><mml:math id="M28" display="inline"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1674_Article_IEq6.gif"/></alternatives></inline-formula> was uniform over all genes, this would be the ideal ranking method. The ranking methods that perform better than this one will do so based on their ability to adapt to heteroscedasticity.</p></list-item></list></p>
    </sec>
    <sec id="Sec14">
      <title>Evaluation with cancer data</title>
      <p id="Par63">RNA-Seq read counts for genes for 97 tumor-normal pairs from the TCGA BRCA breast cancer dataset were obtained from FireBrowse [<xref ref-type="bibr" rid="CR22">22</xref>]. There was an average of 85 million reads counted per sample. The edgeR R package (version 3.22.5) was used to estimate TMM-adjusted library sizes [<xref ref-type="bibr" rid="CR23">23</xref>]. Genes with less than an average of 0.1 reads per million (RPM) were removed from further processing. The limma function voom was then used to convert the count data to log<sub>2</sub> RPM, with associated observation-level weights. The limma R package (version 3.36.5) was then used to fit linear models for each gene suitable for performing a paired-sample test for differential expression between tumor and normal samples [<xref ref-type="bibr" rid="CR21">21</xref>], and Empirical Bayes variance moderation was applied. The method described above was then used to calculate confect values and rank genes, using a target FDR of 5%.</p>
    </sec>
    <sec id="Sec15">
      <title>Gene set enrichment</title>
      <p id="Par64">In order to better understand the biological processes emphasized by different methods of ranking genes, R package fgsea (version 1.6.0) was used to find enriched gene sets associated with Gene Ontology (GO) biological process terms [<xref ref-type="bibr" rid="CR24">24</xref>]. fgsea implements the gene set enrichment analysis (GSEA) method, in particular the variant of the method for a pre-ranked list of genes [<xref ref-type="bibr" rid="CR25">25</xref>]. The exponent parameter <italic>p</italic> is set to 0, so that the results are based purely on the ranking, and not on any associated scores. The effect size used to rank gene sets was the normalized enrichment score (NES) produced by this method. A <italic>p</italic> value testing whether the NES is non-zero is available from fgsea, but unfortunately no confidence interval. Gene sets containing between 15 and 2000 genes were considered. Ten thousand permutations were used when calculating <italic>p</italic> values.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1674_MOESM1_ESM.pdf">
            <label>Additional file 1:</label>
            <caption>
              <p>Additional figures. Additional figures giving more details on the simulation results. (PDF 2197 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2019_1674_MOESM2_ESM.csv">
            <label>Additional file 2:</label>
            <caption>
              <p>Complete confect ranking of breast cancer dataset. Confect ranking of breast cancer dataset at 5% FDR. (CSV 1085 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2019_1674_MOESM3_ESM.csv">
            <label>Additional file 3:</label>
            <caption>
              <p>Complete <italic>p</italic> value-based ranking of breast cancer dataset. <italic>p</italic> value ranking of the breast cancer dataset. (CSV 1355 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2019_1674_MOESM4_ESM.csv">
            <label>Additional file 4:</label>
            <caption>
              <p>Confect ranking of breast cancer dataset with 10 patients. Confect ranking using data only from 10 randomly selected patients. (CSV 1053 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The results published here are in whole or part based upon data generated by the TCGA Research Network: <ext-link ext-link-type="uri" xlink:href="http://cancergenome.nih.gov/">http://cancergenome.nih.gov/</ext-link></p>
    <p>A reviewer question prompted us to give a more concrete statement of the coverage guarantee made by confect confidence bounds.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par65">TB is supported by a Biomedicine Discovery Fellowship from Monash University, and acknowledges support the Australian Research Council (ARC Discovery Project DP170100569 and Future Fellowship FT180100049) and National Health and Medical Research Council (NHMRC Project Grant APP1128250).</p>
    </sec>
    <sec id="FPar2" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p id="Par66">The method described in this paper is made available as an R package on GitHub [<xref ref-type="bibr" rid="CR26">26</xref>] and on Zenodo [<xref ref-type="bibr" rid="CR27">27</xref>]. It is part of Bioconductor version 3.9 as the package topconfects [<xref ref-type="bibr" rid="CR28">28</xref>]. The license is the GNU Lesser General Public License version 2.1.</p>
      <p id="Par67">The TCGA data used was downloaded from [<xref ref-type="bibr" rid="CR22">22</xref>]. In particular, RNA-Seq read count data was used from breast cancer (BRCA) patients for which there was both a tumor and normal tissue sample.</p>
      <p id="Par68">For the two simulations, simulated truth, simulated experimental data, and results by the methods examined are available from [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>PH developed the method and R code. AP helped test the method and helped with the use of TCGA data. Identification of the need for a flexible means to find the most “interesting” genes from a dataset and how to go about this evolved during extensive discussions between PH, DP, and TB. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p>All results in this paper are based only on the publicly available unrestricted-access portion of the TCGA data. Use of TCGA data does not require ethics approval.</p>
    </sec>
    <sec id="FPar4">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar5">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar6">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nuzzo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Scientific method: statistical errors</article-title>
        <source>Nature News</source>
        <year>2014</year>
        <volume>506</volume>
        <issue>7487</issue>
        <fpage>150</fpage>
        <pub-id pub-id-type="doi">10.1038/506150a</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wasserstein</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Lazar</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>The ASA’s statement on p-values: context, process, and purpose</article-title>
        <source>Am Stat</source>
        <year>2016</year>
        <volume>70</volume>
        <issue>2</issue>
        <fpage>129</fpage>
        <lpage>133</lpage>
        <pub-id pub-id-type="doi">10.1080/00031305.2016.1154108</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Greenland</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Senn</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Rothman</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Carlin</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Poole</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Goodman</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Altman</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Statistical tests, <italic>P</italic> values, confidence intervals, and power: a guide to misinterpretations</article-title>
        <source>Eur J Epidemiol</source>
        <year>2016</year>
        <volume>31</volume>
        <issue>4</issue>
        <fpage>337</fpage>
        <lpage>350</lpage>
        <pub-id pub-id-type="doi">10.1007/s10654-016-0149-3</pub-id>
        <pub-id pub-id-type="pmid">27209009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cumming</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>Understanding the new statistics: effect sizes, confidence intervals, and meta-analysis</source>
        <year>2012</year>
        <publisher-loc>New York and London</publisher-loc>
        <publisher-name>Taylor &amp; Francis Group</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neyman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>X—outline of a theory of statistical estimation based on the classical theory of probability</article-title>
        <source>Phil Trans R Soc Lond A</source>
        <year>1937</year>
        <volume>236</volume>
        <issue>767</issue>
        <fpage>333</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1098/rsta.1937.0005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Higgins JPT, Green S. Cochrane handbook for systematic reviews of interventions, version 5.1.0: The Cochrane Collaboration; 2011. published online. Available from: <ext-link ext-link-type="uri" xlink:href="http://handbook.cochrane.org">http://handbook.cochrane.org</ext-link></mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>American Psychological</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Publication manual of the American Psychological Association</source>
        <year>2009</year>
        <edition>6</edition>
        <publisher-loc>Washington DC</publisher-loc>
        <publisher-name>American Psychological Association</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc Ser B Methodol</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yekutieli</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>False discovery rate–adjusted multiple confidence intervals for selected parameters</article-title>
        <source>J Am Stat Assoc</source>
        <year>2005</year>
        <volume>100</volume>
        <issue>469</issue>
        <fpage>71</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1198/016214504000001907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jung</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Friede</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Beißbarth</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Reporting FDR analogous confidence intervals for the log fold change of differentially expressed genes</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>288</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-288</pub-id>
        <pub-id pub-id-type="pmid">21756370</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Testing significance relative to a fold-change threshold is a TREAT</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>6</issue>
        <fpage>765</fpage>
        <lpage>771</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp053</pub-id>
        <pub-id pub-id-type="pmid">19176553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Harrison</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Pattison</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Powell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Beilharz</surname>
            <given-names>TH</given-names>
          </name>
        </person-group>
        <source>Simulation results comparing topconfects to other methods</source>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Grissom</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <source>Effect sizes for research: a broad practical approach</source>
        <year>2005</year>
        <publisher-loc>New Jersey and London</publisher-loc>
        <publisher-name>Lawrence Erlbaum Associates</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>From reads to genes to pathways: differential expression analysis of RNA-Seq experiments using Rsubread and the edgeR quasi-likelihood pipeline</article-title>
        <source>F1000Research</source>
        <year>2016</year>
        <volume>5</volume>
        <fpage>1438</fpage>
        <?supplied-pmid 27508061?>
        <pub-id pub-id-type="pmid">27508061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>550</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Tusher</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Empirical Bayes analysis of a microarray experiment</article-title>
        <source>J Am Stat Assoc</source>
        <year>2001</year>
        <volume>96</volume>
        <issue>456</issue>
        <fpage>1151</fpage>
        <lpage>1160</lpage>
        <pub-id pub-id-type="doi">10.1198/016214501753382129</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Size, power and false discovery rates</article-title>
        <source>Ann Stat</source>
        <year>2007</year>
        <volume>35</volume>
        <issue>4</issue>
        <fpage>1351</fpage>
        <lpage>1377</lpage>
        <pub-id pub-id-type="doi">10.1214/009053606000001460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tuerlinckx</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Type S error rates for classical and Bayesian single and multiple comparison procedures</article-title>
        <source>Comput Stat</source>
        <year>2000</year>
        <volume>15</volume>
        <issue>3</issue>
        <fpage>373</fpage>
        <lpage>390</lpage>
        <pub-id pub-id-type="doi">10.1007/s001800000040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Zhu A, Ibrahim JG, Love MI. Heavy-tailed prior distributions for sequence count data: removing the noise and preserving large differences. bioRxiv. 2018; 10.1101/303255.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>False discovery rates: a new deal</article-title>
        <source>Biostatistics</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>2</issue>
        <fpage>275</fpage>
        <lpage>294</lpage>
        <?supplied-pmid 27756721?>
        <pub-id pub-id-type="pmid">27756721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Linear models and empirical Bayes methods for assessing differential expression in microarray experiments</article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2004</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.2202/1544-6115.1027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Broad Institute TCGA Genome Data Analysis Center. Firehose 2016_01_28 run: Broad Institute of MIT and Harvard; 2016. 10.7908/C11G0KM9</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>3</issue>
        <fpage>R25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-3-r25</pub-id>
        <pub-id pub-id-type="pmid">20196867</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Sergushichev A. An algorithm for fast preranked gene set enrichment analysis using cumulative statistic calculation. bioRxiv. 2016; 10.1101/060012.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Paulovich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pomeroy</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2005</year>
        <volume>102</volume>
        <issue>43</issue>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Harrison, P.F. Topconfects GitHub page. 2019; <ext-link ext-link-type="uri" xlink:href="https://github.com/pfh/topconfects">https://github.com/pfh/topconfects</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Harrison, P.F. Topconfects R Package. Zenodo. 2018. 10.5281/zenodo.1486277.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Harrison, P.F. Topconfects. Bioconductor. 2019. 10.18129/b9.bioc.topconfects.</mixed-citation>
    </ref>
  </ref-list>
</back>
