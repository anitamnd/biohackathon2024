<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10890765</article-id>
    <article-id pub-id-type="pmid">38346081</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-23-01546</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011875</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Molecular biology techniques</subject>
            <subj-group>
              <subject>Sequencing techniques</subject>
              <subj-group>
                <subject>RNA sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Molecular biology techniques</subject>
          <subj-group>
            <subject>Sequencing techniques</subject>
            <subj-group>
              <subject>RNA sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Chemistry</subject>
          <subj-group>
            <subject>Chemical Reactions</subject>
            <subj-group>
              <subject>Methylation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Research Design</subject>
          <subj-group>
            <subject>Experimental Design</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Data</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>High Throughput Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>High Throughput Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Cell biology</subject>
          <subj-group>
            <subject>Chromosome biology</subject>
            <subj-group>
              <subject>Chromatin</subject>
              <subj-group>
                <subject>Chromatin modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Epigenetics</subject>
            <subj-group>
              <subject>Chromatin</subject>
              <subj-group>
                <subject>Chromatin modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>Chromatin</subject>
              <subj-group>
                <subject>Chromatin modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>DNA</subject>
            <subj-group>
              <subject>DNA modification</subject>
              <subj-group>
                <subject>DNA methylation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>DNA</subject>
              <subj-group>
                <subject>DNA modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Epigenetics</subject>
            <subj-group>
              <subject>DNA modification</subject>
              <subj-group>
                <subject>DNA methylation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>DNA modification</subject>
              <subj-group>
                <subject>DNA methylation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Transcriptome Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Transcriptome Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">magpie</italic>: A power evaluation method for differential RNA methylation analysis in N6-methyladenosine sequencing</article-title>
      <alt-title alt-title-type="running-head">Power evaluation in differential RNA methylation analysis</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Guo</surname>
          <given-names>Zhenxing</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Duan</surname>
          <given-names>Daoyu</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3710-9029</contrib-id>
        <name>
          <surname>Tang</surname>
          <given-names>Wen</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Julia</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bush</surname>
          <given-names>William S.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5986-2260</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Liangliang</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jin</surname>
          <given-names>Fulai</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2243-9949</contrib-id>
        <name>
          <surname>Feng</surname>
          <given-names>Hao</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>School of Data Science, The Chinese University of Hong Kong, Shenzhen (CUHK-Shenzhen), Shenzhen, Guangdong, China</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Population and Quantitative Health Sciences, Case Western Reserve University, Cleveland, Ohio, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Hathaway Brown School, Shaker Heights, Ohio, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Genetics and Genome Sciences, Case Western Reserve University, Cleveland, Ohio, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ziemann</surname>
          <given-names>Mark</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Burnet Institute, AUSTRALIA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>hxf155@case.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <volume>20</volume>
    <issue>2</issue>
    <elocation-id>e1011875</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 Guo et al</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Guo et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1011875.pdf"/>
    <abstract>
      <p>Recently, novel biotechnologies to quantify RNA modifications became an increasingly popular choice for researchers who study epitranscriptome. When studying RNA methylations such as N6-methyladenosine (m<sup>6</sup>A), researchers need to make several decisions in its experimental design, especially the sample size and a proper statistical power. Due to the complexity and high-throughput nature of m<sup>6</sup>A sequencing measurements, methods for power calculation and study design are still currently unavailable. In this work, we propose a statistical power assessment tool, <italic toggle="yes">magpie</italic>, for power calculation and experimental design for epitranscriptome studies using m<sup>6</sup>A sequencing data. Our simulation-based power assessment tool will borrow information from real pilot data, and inspect various influential factors including sample size, sequencing depth, effect size, and basal expression ranges. We integrate two modules in <italic toggle="yes">magpie</italic>: (i) a flexible and realistic simulator module to synthesize m<sup>6</sup>A sequencing data based on real data; and (ii) a power assessment module to examine a set of comprehensive evaluation metrics.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Sample size and sequencing depth are two essential quantitative factors determined prior to high throughput sequencing experiments, for statistical power maximization with limited budget. Due to the complex structure of data from m<sup>6</sup>A RNA methylation sequencing, analytical derivations for both quantities remain challenging in experimental designs. In response to this challenge, we propose a simulation-based statistical framework, together with a user-friendly R/Bioconductor package <italic toggle="yes"><bold>magpie</bold></italic>, to comprehensively assess the power of the differential m<sup>6</sup>A methylation detection at varied sample sizes, effect sizes, baseline expression levels, and sequencing depths. Using in-silico synthetic data that mimic real data well, <italic toggle="yes"><bold>magpie</bold></italic> provides several major evaluation metrics to assist users in study design and statistical power evaluation.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100008136</institution-id>
            <institution>Case Western Reserve University</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2243-9949</contrib-id>
          <name>
            <surname>Feng</surname>
            <given-names>Hao</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This research was partially supported by the intramural funding from Case Western Reserve University awarded to HF, and the intramural funding UDF01002936 awarded to ZG from The Chinese University of Hong Kong, Shenzhen (CUHK-Shenzhen). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="1"/>
      <page-count count="13"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2024-02-23</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The proposed power assessment tool magpie is publicly available as a R/Bioconductor package at: <ext-link xlink:href="https://bioconductor.org/packages/magpie/" ext-link-type="uri">https://bioconductor.org/packages/magpie/</ext-link>. The simulation tutorial with instructions is available at <ext-link xlink:href="https://github.com/dxd429/magieSims" ext-link-type="uri">https://github.com/dxd429/magieSims</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The proposed power assessment tool magpie is publicly available as a R/Bioconductor package at: <ext-link xlink:href="https://bioconductor.org/packages/magpie/" ext-link-type="uri">https://bioconductor.org/packages/magpie/</ext-link>. The simulation tutorial with instructions is available at <ext-link xlink:href="https://github.com/dxd429/magieSims" ext-link-type="uri">https://github.com/dxd429/magieSims</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>RNA methylation represents another layer of epigenetic regulation in addition to the well-studied DNA methylation and histone modification. Among different types of RNA methylation, N6-methyladenosine, i.e. m<sup>6</sup>A, is the most common form. It has been identified as one of the post-transcriptional regulatory markers on mRNA, rRNA, tRNA, circRNA, miRNA and long-noncoding RNA, and plays important roles in regulating pre-RNA splicing, RNA translation, stability, and degradation [<xref rid="pcbi.1011875.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1011875.ref003" ref-type="bibr">3</xref>]. The effects of m<sup>6</sup>A suggest its involvement in multiple cellular processes such as cell differentiation and reprogramming [<xref rid="pcbi.1011875.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1011875.ref005" ref-type="bibr">5</xref>]. Studies also suggest linkages between the dysregulation of m<sup>6</sup>A and many human diseases such as cancers and neural disorders [<xref rid="pcbi.1011875.ref002" ref-type="bibr">2</xref>, <xref rid="pcbi.1011875.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1011875.ref007" ref-type="bibr">7</xref>].</p>
    <p>MeRIP-seq/m<sup>6</sup>A-seq was developed to characterize transcriptome-wide m<sup>6</sup>A profiles [<xref rid="pcbi.1011875.ref008" ref-type="bibr">8</xref>, <xref rid="pcbi.1011875.ref009" ref-type="bibr">9</xref>]. This technique typically relies on immunoprecipitation of m<sup>6</sup>A-containing RNA fragments (m<sup>6</sup>A-IP), followed by high-throughput next generation sequencing. These samples are generally referred to as the IP (immunoprecipitated) samples. In addition to IP samples, cDNA libraries are also prepared for input control mRNAs to measure the background mRNA abundance. These input controls are essentially the transcriptome from regular RNA-seq. The m<sup>6</sup>A methylation level, for each region, is then quantified by the enrichment of IP over input, roughly the normalized ratio between IP and input control counts. If the m<sup>6</sup>A enrichment is significantly high, then the called peak of that region suggests an underlying m<sup>6</sup>A residue. MeRIP-seq is becoming a popular and indispensable tool to profile transcriptome-wide m<sup>6</sup>A, since the invention of this technique. One feature of MeRIP-seq is that, it immunoprecipitates each IP sample independently, which can potentially induce technical variabilities. Such technical artifacts lead to erroneous peak calling of methylated regions. This problem becomes prominent in studies with small sample sizes [<xref rid="pcbi.1011875.ref010" ref-type="bibr">10</xref>], which is often the case given the high expenses associated with the current experimental protocols. As an improved alternative, in m<sup>6</sup>A-seq2 [<xref rid="pcbi.1011875.ref011" ref-type="bibr">11</xref>], a single IP experiment is performed on the pooled RNAs of all samples, where RNAs from different samples are uniquely barcoded and demultiplexed after sequencing. The multiplexed profiling procedure by m<sup>6</sup>A-seq2 is expected to be widely applied to interrogate the distribution and functional consequences of m<sup>6</sup>A.</p>
    <p>To study the biological implications of m<sup>6</sup>A, one fundamental task is to identify the Differentially Methylated Regions (DMRs) across different conditions. Although several DMR detection methods have been developed [<xref rid="pcbi.1011875.ref012" ref-type="bibr">12</xref>–<xref rid="pcbi.1011875.ref014" ref-type="bibr">14</xref>] and evaluated [<xref rid="pcbi.1011875.ref015" ref-type="bibr">15</xref>] in either MeRIP-seq or m<sup>6</sup>A-seq2 experiments, the sample size calculation with their associated statistical power remains an open question due to the complexities of sequencing experiments. Further, due to the uniqueness in data structure, power analysis tools developed for other types of analyses such as Differential Expression (DE) gene detection from RNA-seq cannot be applied to MeRIP-seq and m<sup>6</sup>A-seq2 experiments. First, data simulated for power assessment in DE gene detection from RNA-seq are barely equivalent to the input control data alone. No statistical model is available to generate their matched IP counts. Second, the effect size of methylation in m<sup>6</sup>A data analysis is based on the ratios of IP/input, not the input data alone. Therefore, the count coverage of each gene may affect power and other metrics in a way differing from that in DE analyses. Additionally, the impact of baseline expression of each gene and sequencing depth of the whole sample on the power of DMR detection are also unignorable. Therefore, an appropriate power analysis tool specifically for epitranscriptome studies is needed, especially with its increasing popularity. To our best knowledge, no method is currently available.</p>
    <p>Here, we propose a comprehensive power evaluation method named <italic toggle="yes"><bold>magpie</bold></italic> (<bold><underline>m</underline></bold><sup>6</sup><bold><underline>A</underline></bold>
<bold>g</bold>enome-wide differential analysis <bold><underline>p</underline></bold>ower <bold><underline>i</underline></bold>nferenc<bold><underline>e</underline></bold>). <italic toggle="yes"><bold>magpie</bold></italic> first learns characteristics of real data, and then synthesizes data that mimics the real data well. In simulations, <italic toggle="yes"><bold>magpie</bold></italic> allows for the adjustment of sample size, sequencing depth and effect size. It can evaluate the epitranscriptome study design using multiple metrics including sensitivity, specificity, precision, false discovery rate, and more. Building upon these functionalities, <italic toggle="yes"><bold>magpie</bold></italic> fills in the knowledge gap by providing a comprehensive biostatistical tool for statistical power evaluation, sample size calculation, and data analysis planning, which are almost always required in general experimental designs. This makes it the first available tool to guide the practical experimental design by comprehensively investigating the relationship between statistical metrics and associated factors in m<sup>6</sup>A differential analysis. <italic toggle="yes"><bold>magpie</bold></italic> is publicly available as an R/Bioconductor package at <ext-link xlink:href="https://bioconductor.org/packages/magpie/" ext-link-type="uri">https://bioconductor.org/packages/magpie/</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>An overview of <italic toggle="yes">magpie</italic></title>
      <p>We assess the effect of experimental design on the power of DMR detection purely based on simulations, where the whole procedure is divided into two components. First, <italic toggle="yes"><bold>magpie</bold></italic> preprocesses <italic toggle="yes">.bam</italic> files from MeRIP-seq sequencing and obtains read counts in candidate regions from all samples (<xref rid="pcbi.1011875.g001" ref-type="fig">Fig 1</xref>), where candidates are identified with conditional binomial tests. With the counts from the identified candidate regions, <italic toggle="yes"><bold>magpie</bold></italic> simulates count matrices for both IP and Input samples with a Gamma-Poisson model. Parameters involved are estimated from the candidates to mimic the actual MeRIP-seq data in aspects of marginal distribution read counts, and the distribution of biological dispersion in methylation levels (<xref rid="pcbi.1011875.g001" ref-type="fig">Fig 1</xref>). With data simulated, we then evaluate power and error rates on them (<xref rid="pcbi.1011875.g001" ref-type="fig">Fig 1</xref>). The two components, Gamma-Poisson simulation and power assessment, are independent so that <italic toggle="yes"><bold>magpie</bold></italic> allows the assessment on data by different simulation strategies.</p>
      <fig position="float" id="pcbi.1011875.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overview of <italic toggle="yes">magpie</italic>.</title>
          <p><italic toggle="yes"><bold>magpie</bold></italic> provides power evaluation for differential m<sup>6</sup>A methylation analysis. It takes pilot MeRIP-seq data as the input. Based on the pilot data, it obtains candidate regions, estimates key parameters, and conducts real-data-based simulations for statistical power evaluation.</p>
        </caption>
        <graphic xlink:href="pcbi.1011875.g001" position="float"/>
      </fig>
    </sec>
    <sec id="sec004">
      <title>Data generative model</title>
      <p>Here we describe how <italic toggle="yes"><bold>magpie</bold></italic> simulates the MeRIP-seq count matrices given existing real MeRIP-seq data from different conditions. <italic toggle="yes"><bold>magpie</bold></italic> processes <italic toggle="yes">.bam</italic> files by splitting the transcriptome into bins, aggregating read counts, and testing for significance of IP enrichment over Input. Using a bump-finding algorithm, significant bins are combined into candidate regions. <italic toggle="yes"><bold>magpie</bold></italic> then focus on these candidates in simulations, as other regions lack IP enrichment and biological relevance. Suppose there are in total <italic toggle="yes">N</italic> pairs of IP and Input samples from all conditions, and <italic toggle="yes">M</italic> candidate DMRs generated after preprocessing. Let <italic toggle="yes">X</italic><sub><italic toggle="yes">ij</italic></sub> and <italic toggle="yes">Y</italic><sub><italic toggle="yes">ij</italic></sub> denote input and IP counts in candidate DMR <italic toggle="yes">i</italic> from sample <italic toggle="yes">j</italic>. We assume that <inline-formula id="pcbi.1011875.e001"><alternatives><graphic xlink:href="pcbi.1011875.e001.jpg" id="pcbi.1011875.e001g" position="anchor"/><mml:math id="M1" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e002"><alternatives><graphic xlink:href="pcbi.1011875.e002.jpg" id="pcbi.1011875.e002g" position="anchor"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Similarly, <inline-formula id="pcbi.1011875.e003"><alternatives><graphic xlink:href="pcbi.1011875.e003.jpg" id="pcbi.1011875.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e004"><alternatives><graphic xlink:href="pcbi.1011875.e004.jpg" id="pcbi.1011875.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Here <inline-formula id="pcbi.1011875.e005"><alternatives><graphic xlink:href="pcbi.1011875.e005.jpg" id="pcbi.1011875.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>x</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e006"><alternatives><graphic xlink:href="pcbi.1011875.e006.jpg" id="pcbi.1011875.e006g" position="anchor"/><mml:math id="M6" display="inline" overflow="scroll"><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>y</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> represent the normalizing factors for input and IP samples, such as the library sizes. <inline-formula id="pcbi.1011875.e007"><alternatives><graphic xlink:href="pcbi.1011875.e007.jpg" id="pcbi.1011875.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e008"><alternatives><graphic xlink:href="pcbi.1011875.e008.jpg" id="pcbi.1011875.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> are normalized poisson rates. <inline-formula id="pcbi.1011875.e009"><alternatives><graphic xlink:href="pcbi.1011875.e009.jpg" id="pcbi.1011875.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1011875.e010"><alternatives><graphic xlink:href="pcbi.1011875.e010.jpg" id="pcbi.1011875.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, and <italic toggle="yes">θ</italic><sub><italic toggle="yes">i</italic></sub> are the shape and scale parameters of corresponding gamma distributions. Given above assumptions, naturally <inline-formula id="pcbi.1011875.e011"><alternatives><graphic xlink:href="pcbi.1011875.e011.jpg" id="pcbi.1011875.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Further, denote <inline-formula id="pcbi.1011875.e012"><alternatives><graphic xlink:href="pcbi.1011875.e012.jpg" id="pcbi.1011875.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1011875.e013"><alternatives><graphic xlink:href="pcbi.1011875.e013.jpg" id="pcbi.1011875.e013g" position="anchor"/><mml:math id="M13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, then marginally,
<disp-formula id="pcbi.1011875.e014"><alternatives><graphic xlink:href="pcbi.1011875.e014.jpg" id="pcbi.1011875.e014g" position="anchor"/><mml:math id="M14" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <p>In above equations, <italic toggle="yes">μ</italic><sub><italic toggle="yes">ij</italic></sub> and <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">ij</italic></sub> represent the mean and dispersion of the methylation level for candidate region <italic toggle="yes">i</italic> in sample <italic toggle="yes">j</italic>.</p>
      <p>We begin by simulating size factors, for which we directly use the values estimated from real data:
<disp-formula id="pcbi.1011875.e015"><alternatives><graphic xlink:href="pcbi.1011875.e015.jpg" id="pcbi.1011875.e015g" position="anchor"/><mml:math id="M15" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic toggle="yes">x</italic><sub><italic toggle="yes">bj</italic></sub> and <italic toggle="yes">y</italic><sub><italic toggle="yes">bj</italic></sub> are read counts in bin <italic toggle="yes">b</italic> from the <italic toggle="yes">j</italic>th Input and IP samples.</p>
      <p>Next, for each candidate region <italic toggle="yes">i</italic>, <italic toggle="yes"><bold>magpie</bold></italic> simulates a baseline methylation level <italic toggle="yes">μ</italic><sub><italic toggle="yes">i</italic></sub> or equivalently <inline-formula id="pcbi.1011875.e016"><alternatives><graphic xlink:href="pcbi.1011875.e016.jpg" id="pcbi.1011875.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:math></alternatives></inline-formula> in the structure of <inline-formula id="pcbi.1011875.e017"><alternatives><graphic xlink:href="pcbi.1011875.e017.jpg" id="pcbi.1011875.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> where <italic toggle="yes">Z</italic><sub><italic toggle="yes">j</italic></sub> contains the attributes of sample <italic toggle="yes">j</italic>, and <italic toggle="yes">β</italic><sub><italic toggle="yes">i</italic></sub> represents corresponding coefficient. To do that, we randomly sample <italic toggle="yes">α</italic><sub><italic toggle="yes">i</italic></sub> from one parametric distribution, or from its empirical distribution estimated from real data. Distributions of <inline-formula id="pcbi.1011875.e018"><alternatives><graphic xlink:href="pcbi.1011875.e018.jpg" id="pcbi.1011875.e018g" position="anchor"/><mml:math id="M18" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>’s from five MeRIP-seq datasets are presented in Fig D in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>.</p>
      <p>After simulating the baseline methylation, we simulate <inline-formula id="pcbi.1011875.e019"><alternatives><graphic xlink:href="pcbi.1011875.e019.jpg" id="pcbi.1011875.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:msubsup><mml:mi>β</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> for all regions. Because we can hardly know the actual number of DMRs and their degree of differential methylation, specific settings are adopted based on both reasonable assumptions and empirical observations. First, <italic toggle="yes"><bold>magpie</bold></italic> sets the proportion of DMRs as 10%, assuming that DM is present in only a small subset of regions in most experiments. Then, for non-DMRs, <italic toggle="yes">β</italic><sub><italic toggle="yes">i</italic></sub> = 0. For DMR <italic toggle="yes">i</italic>, <inline-formula id="pcbi.1011875.e020"><alternatives><graphic xlink:href="pcbi.1011875.e020.jpg" id="pcbi.1011875.e020g" position="anchor"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> if its estimated effect size <inline-formula id="pcbi.1011875.e021"><alternatives><graphic xlink:href="pcbi.1011875.e021.jpg" id="pcbi.1011875.e021g" position="anchor"/><mml:math id="M21" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is greater than the 50% quantile of all regions. Otherwise, <italic toggle="yes">β</italic><sub><italic toggle="yes">i</italic></sub> ∼ <italic toggle="yes">U</italic>(1, 2). Here, <inline-formula id="pcbi.1011875.e022"><alternatives><graphic xlink:href="pcbi.1011875.e022.jpg" id="pcbi.1011875.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> are directly derived from real pilot data, using the DMR detection method TRESS.</p>
      <p>The dispersion has been shown to be substantial across several real datasets, which justifies the necessity of its modeling (Fig F in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>). We can simulate it again from a parametric distribution or sample from empirical distributions. To ensure the robustness, the empirical distribution can be estimated by TRESS from raw counts or by Beta-binomial regressions from normalized counts. Denote <inline-formula id="pcbi.1011875.e023"><alternatives><graphic xlink:href="pcbi.1011875.e023.jpg" id="pcbi.1011875.e023g" position="anchor"/><mml:math id="M23" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e024"><alternatives><graphic xlink:href="pcbi.1011875.e024.jpg" id="pcbi.1011875.e024g" position="anchor"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> as the normalized IP and total counts, the Beta-Binomial regressions are established as follows:
<disp-formula id="pcbi.1011875.e025"><alternatives><graphic xlink:href="pcbi.1011875.e025.jpg" id="pcbi.1011875.e025g" position="anchor"/><mml:math id="M25" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mtext>logit</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>z</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic toggle="yes">μ</italic><sub><italic toggle="yes">ij</italic></sub> and <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">i</italic></sub> represent the mean and dispersion of methylation level. As noted, for the convenience of estimation, above Beta-binomial regressions (as well as TRESS) assume <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">ij</italic></sub> = <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">i</italic></sub> for all <italic toggle="yes">j</italic>.</p>
      <p>Empirically for the same real dataset, <inline-formula id="pcbi.1011875.e026"><alternatives><graphic xlink:href="pcbi.1011875.e026.jpg" id="pcbi.1011875.e026g" position="anchor"/><mml:math id="M26" display="inline" overflow="scroll"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> estimated by the Negative-binomial model in TRESS are usually greater than those estimated by Beta-binomial regressions. Without golden truth, our setting for <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">i</italic></sub> relies on a data driven approach. Specifically, by comparing to the real data, <italic toggle="yes"><bold>magpie</bold></italic> will calculate a KL-divergence for each of the synthetic counts by model in (<xref rid="pcbi.1011875.e014" ref-type="disp-formula">1</xref>). Those <inline-formula id="pcbi.1011875.e027"><alternatives><graphic xlink:href="pcbi.1011875.e027.jpg" id="pcbi.1011875.e027g" position="anchor"/><mml:math id="M27" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> resulting in a significantly lower KL divergence between simulated data and real data will be kept for final data generation. If there is no significant difference in KL-divergence, <inline-formula id="pcbi.1011875.e028"><alternatives><graphic xlink:href="pcbi.1011875.e028.jpg" id="pcbi.1011875.e028g" position="anchor"/><mml:math id="M28" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> estimated by NB will be adopted.</p>
      <p>Lastly, we simulate the scale parameter <italic toggle="yes">θ</italic><sub><italic toggle="yes">i</italic></sub> in (<xref rid="pcbi.1011875.e014" ref-type="disp-formula">1</xref>). Again, it can be simulated by parametric distributions, or sampled directly from empirical distributions. For the parametric distribution, we set its mean as a function of <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">i</italic></sub> observed in the previous peak detection method [<xref rid="pcbi.1011875.ref014" ref-type="bibr">14</xref>]. No matter the strategy employed, the first-round generated <inline-formula id="pcbi.1011875.e029"><alternatives><graphic xlink:href="pcbi.1011875.e029.jpg" id="pcbi.1011875.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> will be further scaled by the fold change between real and first-round simulated counts. Such an adjustment again helps to reduce the disparity between the simulated and real distributions, thereby improving the reliability of the results in follow-up power assessments.</p>
    </sec>
    <sec id="sec005">
      <title>DMR detection</title>
      <p>After generating the simulated read counts in candidate DMRs, an existing software developed for MeRIP-seq is applied to detect DMRs. We implement an interface for calling TRESS and exomePeak2. Each method reports test statistics, <italic toggle="yes">p</italic>-values and FDRs for all candidate regions. These results are then used for the downstream power assessment. Users also have the option to adopt other DMR detection methods for their own evaluation, by following our simulation tutorial with detail instructions at <ext-link xlink:href="https://github.com/dxd429/magieSims" ext-link-type="uri">https://github.com/dxd429/magieSims</ext-link>. This resource enables users to conduct their own analyses using the synthetic data generated by our simulation and evaluation framework.</p>
    </sec>
    <sec id="sec006">
      <title>Power assessment measures</title>
      <p>We adopted several evaluation metrics in the statistical power assessment for differential analysis using MeRIP-seq data. These metrics include classic criteria in hypothesis testings such as the false discovery rate (FDR), power, and precision. We also inspected the false discovery cost (FDC, defined below) and targeted power [<xref rid="pcbi.1011875.ref016" ref-type="bibr">16</xref>], aiming to provide a comprehensive statistical power evaluation.</p>
      <p>Because not all DMRs are of biological interest to us, especially those with low effect sizes, we introduce a cutoff Δ for the effect size <italic toggle="yes">β</italic>. Only those DMRs with |<italic toggle="yes">β</italic>|≥Δ are considered as ‘targeted DMRs’, which are of biological interest in research. We denote the number of non-DMRs, non-targeted DMRs, and targeted DMRs as <italic toggle="yes">R</italic><sub>0</sub>, <italic toggle="yes">R</italic><sub>1</sub>, and <italic toggle="yes">R</italic><sub>2</sub>, respectively. Suppose <italic toggle="yes">T</italic><sub><italic toggle="yes">r</italic></sub> represents the testing result of region <italic toggle="yes">r</italic>, where <italic toggle="yes">T</italic><sub><italic toggle="yes">r</italic></sub> = 1 denotes the discovered DMR, and <italic toggle="yes">T</italic><sub><italic toggle="yes">r</italic></sub> = 0 otherwise. The confusion matrix in the DMR detection is summarized in <xref rid="pcbi.1011875.t001" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="pcbi.1011875.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>The confusion matrix in m<sup>6</sup>A DMR detection, when taking biological significance into consideration.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011875.t001" id="pcbi.1011875.t001g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1">Simulated True</th>
                <th align="center" colspan="2" rowspan="1">Testing Result</th>
                <th align="center" rowspan="2" colspan="1">Total</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1"><italic toggle="yes">T</italic><sub><italic toggle="yes">r</italic></sub> = 0</th>
                <th align="center" rowspan="1" colspan="1"><italic toggle="yes">T</italic><sub><italic toggle="yes">r</italic></sub> = 1</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">Non-DMR</td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">N</italic>
                  <sub>0</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">P</italic>
                  <sub>0</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">R</italic>
                  <sub>0</sub>
                </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Non-targeted DMR (0 &lt; |<italic toggle="yes">β</italic>|&lt;Δ)</td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">N</italic>
                  <sub>1</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">P</italic>
                  <sub>1</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">R</italic>
                  <sub>1</sub>
                </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Targeted DMR (|<italic toggle="yes">β</italic>|≥Δ)</td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">N</italic>
                  <sub>2</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">P</italic>
                  <sub>2</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">R</italic>
                  <sub>2</sub>
                </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Total</td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">N</italic>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">P</italic>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">R</italic>
                </td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The false discovery rate (FDR) and precision are statistical metrics that jointly provide insights into the balance between true and false discoveries among the significant features. In this context, FDR and precision are defined as <inline-formula id="pcbi.1011875.e030"><alternatives><graphic xlink:href="pcbi.1011875.e030.jpg" id="pcbi.1011875.e030g" position="anchor"/><mml:math id="M30" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>P</mml:mi></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e031"><alternatives><graphic xlink:href="pcbi.1011875.e031.jpg" id="pcbi.1011875.e031g" position="anchor"/><mml:math id="M31" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mi>P</mml:mi></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, respectively. Statistical power is defined, naturally, as <inline-formula id="pcbi.1011875.e032"><alternatives><graphic xlink:href="pcbi.1011875.e032.jpg" id="pcbi.1011875.e032g" position="anchor"/><mml:math id="M32" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. To investigate the power of detecting targeted DMRs that are biologically interesting with |<italic toggle="yes">β</italic>|≥Δ, targeted power is introduced and defined as <inline-formula id="pcbi.1011875.e033"><alternatives><graphic xlink:href="pcbi.1011875.e033.jpg" id="pcbi.1011875.e033g" position="anchor"/><mml:math id="M33" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. To better illustrate the trade-off between false positives and true positives, we propose an additional metric, False Discovery Cost (FDC), <inline-formula id="pcbi.1011875.e034"><alternatives><graphic xlink:href="pcbi.1011875.e034.jpg" id="pcbi.1011875.e034g" position="anchor"/><mml:math id="M34" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, which is defined as the expected number of false positives per targeted true positive. The rationale behind this is straightforward: this cost is the expected number of false discoveries, per true discovery we are interested in.</p>
      <p>Finally, our proposed evaluation framework allows for the examination of aforementioned metrics using simulations under various combinations of sample size, sequencing depth, input expression stratum, and FDR threshold. Each user-defined scenario is repeated for 100 times, and these metrics are computed and averaged to generate empirical estimations.</p>
    </sec>
    <sec id="sec007">
      <title>Implementation</title>
      <p>Given a MeRIP-seq dataset in <italic toggle="yes">.bam</italic> files, various experimental scenarios (such as sample size, sequencing depth, FDR threshold, etc.), and a chosen differential methylation testing method, <italic toggle="yes"><bold>magpie</bold></italic> generates evaluation results for each proposed study design. Functions incorporated in <italic toggle="yes"><bold>magpie</bold></italic> allow users to export these results in an <italic toggle="yes">.xlsx</italic> file, and to visualize them through line plots. Users have the option to provide small pilot data, which could include only several chromosomes. We would estimate major parameters from these pilot data, to guide larger-scale simulations for power evaluation for future experimental designs. Alternatively, when pilot MeRIP-seq datasets are unavailable or unattainable, the function <italic toggle="yes">quickPower</italic> can produce power evaluation results within seconds. This is achieved by directly extracting our in-house evaluation results based on three public N6-methyladenosine datasets on GEO as the pilot data [<xref rid="pcbi.1011875.ref017" ref-type="bibr">17</xref>–<xref rid="pcbi.1011875.ref019" ref-type="bibr">19</xref>]. Our package also comes with a vignette that provides thorough instructions and examples of its applications in differential analysis experimental design on N6-methyladenosine.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec008">
    <title>Results</title>
    <sec id="sec009">
      <title>Larger sample size benefits DMR detection</title>
      <p>Under simulation settings outlined in Simulation Settings in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>, we next examine the relationship between sample size and power in DMR detection, given that determining sample size is a primary objective in our method. We adopt sample sizes of 2, 3, 5, 7, and 10 per group, and nominal FDR values of 0.05, 0.1, 0.15, and 0.2, both of which are common choices in MeRIP-seq experiments. Note that we have validated our synthetic data against the pilot data, ensuring that our strategy effectively captures the characteristics of real data (Fig G in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>). The empirical results for major metrics are shown in <xref rid="pcbi.1011875.g002" ref-type="fig">Fig 2</xref>. Grouped by sample size and nominal FDR level, power, targeted power, FDC, and FDR averaged over 100 simulations are shown in <xref rid="pcbi.1011875.g002" ref-type="fig">Fig 2A–2D</xref>. For a fixed sample size, metrics like power, FDC, and FDR diminish under lower FDR thresholds. This occurs as lower FDR values lead to greater stringency, which in turn reduces false positives. The power will drop, as expected, when using stringent FDRs. As sample size increases, these differences become smaller, particularly for statistical power (<xref rid="pcbi.1011875.g002" ref-type="fig">Fig 2A</xref>). Here, power remains consistently high across all FDR levels with 7 and 10 replicates per group. This highlights the benefit of using a larger sample size that helps detect DMRs with limited effect sizes, where a type II error would often occur when the sample size is small. Such trend is observed consistently when using different pilot data (Fig A in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>). At the same time, these results give researchers the knowledge to optimize the sample size based on their budgets. Using <xref rid="pcbi.1011875.g002" ref-type="fig">Fig 2A</xref> as an example, a power around 0.8 is achieved with 7 samples per group, and sample size of 7 is considered large in current MeRIP-seq studies. The benefit of expanding the sample size to 10 is marginal, but the associated costs could be significantly higher.</p>
      <fig position="float" id="pcbi.1011875.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Statistical power evaluation metrics for DMR detection, at various sample sizes and FDR thresholds.</title>
          <p>(<bold>A</bold>) Power versus sample size, with each line presenting one FDR cutoff. (<bold>B</bold>)-(<bold>D</bold>) Similar to (<bold>A</bold>) but for other metrics: targeted power, FDC, and FDR. Targeted power and FDC are computed for DMRs with |<italic toggle="yes">β</italic>|≥2. Each point on the line plots is an averaged value over N = 100 simulations based on real MeRIP-seq data.</p>
        </caption>
        <graphic xlink:href="pcbi.1011875.g002" position="float"/>
      </fig>
    </sec>
    <sec id="sec010">
      <title>Impact of baseline expression values</title>
      <p>It is useful for researchers to understand the effects of heterogeneity in baseline expression levels in DMR detection. In MeRIP-seq data, the basal expression level is represented by input control read counts, thus we stratify power metrics by input control ranges. Six strata are obtained based on following quantiles of mean input counts: stratum 1 (0%-10%), stratum 2 (10%-30%), stratum 3 (30%-50%), stratum 4 (50%-70%), stratum 5 (70%-90%), and stratum 6 (90%-100%). At a nominal FDR of 0.05, the average targeted power and FDC for the six strata are shown in <xref rid="pcbi.1011875.g003" ref-type="fig">Fig 3A and 3B</xref>. Overall, reduced targeted power is observed in the lower strata, a trend that is more evident when sample sizes are small. This is expected, as true differences in low-expressed regions are often obscured by noise, making DMRs harder to detect. A limited sample size further exacerbates this issue. This suggests the potential benefits of increasing the sequencing depth, particularly when biological replicates are limited and more samples are hard to obtain. Here, relatively low strata will enjoy the benefit of more drastic power improvement. Interestingly, higher FDCs are reported in the upper strata, suggesting that more false positives are detected per true discovery in these highly expressed regions. However, this trend diminishes with increasing sample size. Given that these metrics were computed across various simulation scenarios, we further explore the variability of the results, using visualizations within a specific stratum and sample size in <xref rid="pcbi.1011875.g003" ref-type="fig">Fig 3C–3F</xref>. With elevated sample sizes, there is reduced variability in both targeted power and FDC (<xref rid="pcbi.1011875.g003" ref-type="fig">Fig 3C and 3D</xref>). This is not surprising since it is more likely to capture the true dispersion with more replicates, leading to more consistent power estimates. However, this trend is not observed across the strata at a fixed sample size, suggesting the benefit of increasing sample size over sequencing depth for more reliable inferences. Under a fixed sample size (<xref rid="pcbi.1011875.g003" ref-type="fig">Fig 3E and 3F</xref>), an upward trend is observed across the strata for both targeted power and FDC. This trend aligns with the observations in <xref rid="pcbi.1011875.g003" ref-type="fig">Fig 3A and 3B</xref>, though some variability is evident. A heatmap panel is also available to illustrate the stratified results (Fig C in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>).</p>
      <fig position="float" id="pcbi.1011875.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Targeted power and FDC stratified by mean input values for DMRs with |<italic toggle="yes">β</italic>|≥2.</title>
          <p>Six strata are defined based on input count data quantiles: stratum 1 (0%, 10%), stratum 2 (10%, 30%), stratum 3 (30%, 50%), stratum 4 (50%, 70%), stratum 5 (70%, 90%), and stratum 6 (90%, 100%). A nominal FDR value of 0.05 is used to define significance. (<bold>A</bold>), (<bold>B</bold>) Mean targeted power and FDC along strata. Each line represents one sample size choice. (<bold>C</bold>), (<bold>D</bold>) Targeted power and FDC distributions in stratum 3, separated by sample size. (<bold>E</bold>), (<bold>F</bold>) Targeted power and FDC distributions with 5 replicates per group, stratified by mean input count values. N = 100 simulations are conducted.</p>
        </caption>
        <graphic xlink:href="pcbi.1011875.g003" position="float"/>
      </fig>
    </sec>
    <sec id="sec011">
      <title>Consistency among major DMR calling methods</title>
      <p>It is worth noting that the targeted power and FDC presented in the Results section are computed for DMRs with odds ratios (OR) exceeding Δ = 2, using TRESS. To evaluate the fluctuations of these two metrics across various effect sizes (OR), sample sizes and DMR detection methods, we also consider Δ values of 1.5, 2, 4, 6, 8, and 10, for TRESS, exomePeak2, and RADAR. In <xref rid="pcbi.1011875.g004" ref-type="fig">Fig 4</xref>, the targeted power and FDC are plotted against the sample size and are grouped by odds ratio thresholds. At all sample sizes, there is an increased targeted power (<xref rid="pcbi.1011875.g004" ref-type="fig">Fig 4A, 4C and 4E</xref>) and a higher FDC to identify DMRs with a larger odds ratio. Specifically, for FDC (<xref rid="pcbi.1011875.g004" ref-type="fig">Fig 4B, 4D and 4F</xref>), substantially higher values are observed among DMRs with exceptionally large odds ratios (Δ = 8, 10). This indicates that detecting DMRs with these large ORs might lead to a significant increase in false positives. These patterns hold true for TRESS, exomePeak2, RADAR. While all three methods show improvements in targeted power with added replicates across all odds ratio thresholds, a discrepancy is noted for FDC that it tends to increase with larger sample sizes when using exomePeak2 and RADAR. This discrepancy, however, is not universally observed when applying our proposed framework to different pilot data sets (Fig B in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>). Further examinations have been conducted to explore the choices of OR on the balance between sensitivity and specificity, as well as the trade-off between precision and recall (Fig E in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>). These findings highlight the importance of utilizing the users’ designated DMR detection methods during power calculation to ensure accurate estimations.</p>
      <fig position="float" id="pcbi.1011875.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Comparing power evaluation results between major DMR detection methods TRESS (A)-(B) and exomePeak2 (C)-(D).</title>
          <p>Targeted power and FDC are shown at various Odds Ratios (OR, representing effect size) and sample sizes. A nominal FDR value of 0.05 is used to define significance. Points on the line plots are averaged over N = 100 simulations.</p>
        </caption>
        <graphic xlink:href="pcbi.1011875.g004" position="float"/>
      </fig>
    </sec>
    <sec id="sec012">
      <title>Impact of sequencing depth</title>
      <p>As shown previously, sequencing depth is another critical factor in MeRIP-seq study design. Building upon our analysis of sequencing coverage strata, here we examine another aspect of sequencing depth by introducing a “depth factor”. This is a relative ratio to reflect the effect to enlarge or down-sample the sequencing coverage of the pilot data. As illustrated in <xref rid="pcbi.1011875.g005" ref-type="fig">Fig 5A</xref>, the targeted power rises with increased sequencing depth in all sample sizes. The incremental gain from increasing sequencing depth diminishes at high depths or large sample sizes, but benefits the small sample size the most. In <xref rid="pcbi.1011875.g005" ref-type="fig">Fig 5B</xref> for FDC, a similar pattern is observed as in the stratified analysis: FDCs increase with sequencing depth, but stabilize in scenarios with larger sample sizes. We also provide an integrated visualization in <xref rid="pcbi.1011875.g005" ref-type="fig">Fig 5C</xref>, presenting targeted power and FDC in the same panel, aiding users in understanding the tradeoffs between them. Researchers could consult similar figures, generated by <italic toggle="yes"><bold>magpie</bold></italic> using their own pilot data, to select a customized increase in sequencing depth to achieve the desired power.</p>
      <fig position="float" id="pcbi.1011875.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Sequencing depth affects targeted power and FDC for DMRs with |<italic toggle="yes">β</italic>|≥2.</title>
          <p>The ‘depth factor’ is the relative ratio of the new dataset’s library size over that from the original dataset. It reflects the impact of enlarging or down-sampling the sequencing depth of pilot data. (<bold>A</bold>), (<bold>B</bold>) Targeted power and FDC under different sequencing depths, grouped by sample size. (<bold>C</bold>) Joint visualization of the mean targeted power and FDC, over various sequencing depths and sample sizes. N = 100 simulations are conducted. The average sequencing depths of ‘Input’ and ‘IP’ from the pilot data are 3.51X and 0.54X, respectively.</p>
        </caption>
        <graphic xlink:href="pcbi.1011875.g005" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec013">
    <title>Discussions</title>
    <p>Sample size and power evaluation are pivotal and routine tasks in experimental design using sequencing data. Here we present the first tool to address the immediate needs of sample size calculation and power estimation for DMR detection in MeRIP-seq experiments. Traditionally, sample size calculation or power evaluation in hypothesis testings depends on inputs such as the effect size, variance from pilot studies, and the significance level. In contrast, for MeRIP-seq experiments with transcriptome-wide data, these scalar parameters must be considered as distributions. In addition, the distributions of sequencing depth and input control level can also significantly influence the statistical power, as we have shown in the results. We thus propose a statistically rigorous approach to address all these challenges, and draw information from pilot real data for simulation and empirical power evaluation.</p>
    <p>We have a flexible simulation framework that allows switching models to mimic the real data well. In sequencing studies, data from varied tissues or cell types can exhibit unique expression and RNA methylation distributions across features (i.e. genes or regions). To address this, our tool allows users to provide pilot data analogous to their intended studies, serving as the basis for the estimated and adopted parameters in downstream simulations. To ensure that the simulated data accurately reflects actual data characteristics, <italic toggle="yes"><bold>magpie</bold></italic> can adopt both negative-binomial and beta-binomial models and choose the one that aligns with the real data distributions best.</p>
    <p>Both increased sequencing coverage and a larger sample size can significantly enhance the statistical power, as demonstrated in Results. Given that the total sequencing reads are often predetermined before experiments, researchers can benefit from our tool to optimize the balance between sequencing depth and sample size, to ensure the best possible experimental design in differential RNA methylation studies.</p>
    <p>In our stratified analysis, significantly lower power is observed in regions of low input levels. This suggests the potential of refining the filtering strategy. While excluding low-expressed strata certainly means losing some true positives among these regions, it boosts the power to detect DMRs that are highly expressed, which are often of greater biological interest. Our proposed tool <italic toggle="yes"><bold>magpie</bold></italic> can offer a foresight into the overall power gain, should the researchers want to weigh the tradeoffs before initiating their data analyses.</p>
    <p>Our proposed approach captures real data characteristics, simulates data under various experimental settings, and produces common power evaluation metrices. This statistical framework has been implemented into a user-friendly R/Bioconductor package <italic toggle="yes"><bold>magpie</bold></italic>. The package allows users to save power evaluation results as an Excel file and visualize their relationship with aforementioned factors with line plots. Recognizing that users might not have their own pilot MeRIP-seq data, we also develop a “<italic toggle="yes">quickPower</italic>” function. This function can generate comprehensive power evaluation outputs in seconds, by retrieving pre-calculated results from three published studies. <italic toggle="yes"><bold>magpie</bold></italic> is available at <ext-link xlink:href="https://bioconductor.org/packages/magpie/" ext-link-type="uri">https://bioconductor.org/packages/magpie/</ext-link>.</p>
  </sec>
  <sec id="sec014" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1011875.s001" position="float" content-type="local-data">
      <label>S1 Appendix</label>
      <caption>
        <title>Simulation settings and additional results.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1011875.s001.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1011875.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Lu</surname><given-names>Z</given-names></name>, <name><surname>Gomez</surname><given-names>A</given-names></name>, <name><surname>Hon</surname><given-names>GC</given-names></name>, <name><surname>Yue</surname><given-names>Y</given-names></name>, <name><surname>Han</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>N 6-methyladenosine-dependent regulation of messenger RNA stability</article-title>. <source>Nature</source>. <year>2014</year>;<volume>505</volume>(<issue>7481</issue>):<fpage>117</fpage>–<lpage>120</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature12730</pub-id><?supplied-pmid 24284625?><pub-id pub-id-type="pmid">24284625</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Geula</surname><given-names>S</given-names></name>, <name><surname>Moshitch-Moshkovitz</surname><given-names>S</given-names></name>, <name><surname>Dominissini</surname><given-names>D</given-names></name>, <name><surname>Mansour</surname><given-names>AAF</given-names></name>, <name><surname>Kol</surname><given-names>N</given-names></name>, <name><surname>Salmon-Divon</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>m6A mRNA methylation facilitates resolution of naïve pluripotency toward differentiation</article-title>. <source>Science</source>. <year>2015</year>;<volume>347</volume>(<issue>6225</issue>):<fpage>1002</fpage>–<lpage>1006</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1261417</pub-id><?supplied-pmid 25569111?><pub-id pub-id-type="pmid">25569111</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Oerum</surname><given-names>S</given-names></name>, <name><surname>Meynier</surname><given-names>V</given-names></name>, <name><surname>Catala</surname><given-names>M</given-names></name>, <name><surname>Tisne</surname><given-names>C</given-names></name>. <article-title>A comprehensive review of m6A/m6Am RNA methyltransferase structures</article-title>. <source>Nucleic Acids Research</source>. <year>2021</year>;<volume>49</volume>(<issue>13</issue>):<fpage>7239</fpage>–<lpage>7255</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkab378</pub-id><?supplied-pmid 34023900?><pub-id pub-id-type="pmid">34023900</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Lasman</surname><given-names>L</given-names></name>, <name><surname>Hanna</surname><given-names>JH</given-names></name>, <name><surname>Novershtern</surname><given-names>N</given-names></name>. <article-title>Role of m6 a in embryonic stem cell differentiation and in gametogenesis</article-title>. <source>Epigenomes</source>. <year>2020</year>;<volume>4</volume>(<issue>1</issue>):<fpage>5</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/epigenomes4010005</pub-id><?supplied-pmid 34968239?><pub-id pub-id-type="pmid">34968239</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>T</given-names></name>, <name><surname>Hao</surname><given-names>YJ</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Li</surname><given-names>MM</given-names></name>, <name><surname>Wang</surname><given-names>M</given-names></name>, <name><surname>Han</surname><given-names>W</given-names></name>, <etal>et al</etal>. <article-title>M6A RNA methylation is regulated by microRNAs and promotes reprogramming to pluripotency</article-title>. <source>Cell Stem Cell</source>. <year>2015</year>;<volume>16</volume>(<issue>3</issue>):<fpage>289</fpage>–<lpage>301</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.stem.2015.02.011</pub-id><?supplied-pmid 25683224?><pub-id pub-id-type="pmid">25683224</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>XY</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Zhu</surname><given-names>JS</given-names></name>. <article-title>The role of m6A RNA methylation in human cancer</article-title>. <source>Molecular Cancer</source>. <year>2019</year>;<volume>18</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">30609930</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Lan</surname><given-names>Q</given-names></name>, <name><surname>Liu</surname><given-names>PY</given-names></name>, <name><surname>Haase</surname><given-names>J</given-names></name>, <name><surname>Bell</surname><given-names>JL</given-names></name>, <name><surname>Huttelmaier</surname><given-names>S</given-names></name>, <name><surname>Liu</surname><given-names>T</given-names></name>. <article-title>The critical role of RNA M6A methylation in cancer</article-title>. <source>Cancer Research</source>. <year>2019</year>;<volume>79</volume>(<issue>7</issue>):<fpage>1285</fpage>–<lpage>1292</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1158/0008-5472.CAN-18-2965</pub-id><?supplied-pmid 30894375?><pub-id pub-id-type="pmid">30894375</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Dominissini</surname><given-names>D</given-names></name>, <name><surname>Moshitch-Moshkovitz</surname><given-names>S</given-names></name>, <name><surname>Schwartz</surname><given-names>S</given-names></name>, <name><surname>Salmon-Divon</surname><given-names>M</given-names></name>, <name><surname>Ungar</surname><given-names>L</given-names></name>, <name><surname>Osenberg</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Topology of the human and mouse m 6 A RNA methylomes revealed by m 6 A-seq</article-title>. <source>Nature</source>. <year>2012</year>;<volume>485</volume>(<issue>7397</issue>):<fpage>201</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature11112</pub-id><?supplied-pmid 22575960?><pub-id pub-id-type="pmid">22575960</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Meyer</surname><given-names>KD</given-names></name>, <name><surname>Saletore</surname><given-names>Y</given-names></name>, <name><surname>Zumbo</surname><given-names>P</given-names></name>, <name><surname>Elemento</surname><given-names>O</given-names></name>, <name><surname>Mason</surname><given-names>CE</given-names></name>, <name><surname>Jaffrey</surname><given-names>SR</given-names></name>. <article-title>Comprehensive analysis of mRNA methylation reveals enrichment in 3’ UTRs and near stop codons</article-title>. <source>Cell</source>. <year>2012</year>;<volume>149</volume>(<issue>7</issue>):<fpage>1635</fpage>–<lpage>1646</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2012.05.003</pub-id><?supplied-pmid 22608085?><pub-id pub-id-type="pmid">22608085</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>McIntyre</surname><given-names>ABR</given-names></name>, <name><surname>Gokhale</surname><given-names>NS</given-names></name>, <name><surname>Cerchietti</surname><given-names>L</given-names></name>, <name><surname>Jaffrey</surname><given-names>SR</given-names></name>, <name><surname>Horner</surname><given-names>SM</given-names></name>, <name><surname>Mason</surname><given-names>CE</given-names></name>. <article-title>Limits in the detection of m6A changes using MeRIP/m6A-seq</article-title>. <source>Scientific Reports</source>. <year>2020</year>;<volume>10</volume>(<issue>1</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41598-020-63355-3</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Dierks</surname><given-names>D</given-names></name>, <name><surname>Garcia-Campos</surname><given-names>MA</given-names></name>, <name><surname>Uzonyi</surname><given-names>A</given-names></name>, <name><surname>Safra</surname><given-names>M</given-names></name>, <name><surname>Edelheit</surname><given-names>S</given-names></name>, <name><surname>Rossi</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Multiplexed profiling facilitates robust m6A quantification at site, gene and sample resolution</article-title>. <source>Nature Methods</source>. <year>2021</year>;<volume>18</volume>(<issue>9</issue>):<fpage>1060</fpage>–<lpage>1067</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41592-021-01242-z</pub-id><?supplied-pmid 34480159?><pub-id pub-id-type="pmid">34480159</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>Y</given-names></name>, <name><surname>Chen</surname><given-names>K</given-names></name>, <name><surname>Song</surname><given-names>B</given-names></name>, <name><surname>Ma</surname><given-names>J</given-names></name>, <name><surname>Wu</surname><given-names>X</given-names></name>, <name><surname>Xu</surname><given-names>Q</given-names></name>, <etal>et al</etal>. <article-title>M6A-Atlas: A comprehensive knowledgebase for unraveling the N6-methyladenosine (m6A) epitranscriptome</article-title>. <source>Nucleic Acids Research</source>. <year>2021</year>;<volume>49</volume>(<issue>D1</issue>):<fpage>D134</fpage>–<lpage>D143</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkaa692</pub-id><?supplied-pmid 32821938?><pub-id pub-id-type="pmid">32821938</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Z</given-names></name>, <name><surname>Zhan</surname><given-names>Q</given-names></name>, <name><surname>Eckert</surname><given-names>M</given-names></name>, <name><surname>Zhu</surname><given-names>A</given-names></name>, <name><surname>Chryplewicz</surname><given-names>A</given-names></name>, <name><surname>De Jesus</surname><given-names>DF</given-names></name>, <etal>et al</etal>. <article-title>RADAR: Differential analysis of MeRIP-seq data with a random effect model</article-title>. <source>Genome Biology</source>. <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-019-1915-9</pub-id><?supplied-pmid 31870409?><pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>Z</given-names></name>, <name><surname>Shafik</surname><given-names>AM</given-names></name>, <name><surname>Jin</surname><given-names>P</given-names></name>, <name><surname>Wu</surname><given-names>H</given-names></name>. <article-title>Differential RNA methylation analysis for MeRIP-seq data under general experimental design</article-title>. <source>Bioinformatics (Oxford, England)</source>. <year>2022</year>;<volume>38</volume>(<issue>20</issue>):<fpage>4705</fpage>–<lpage>4712</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btac601</pub-id><?supplied-pmid 36063045?><pub-id pub-id-type="pmid">36063045</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Duan</surname><given-names>D</given-names></name>, <name><surname>Tang</surname><given-names>W</given-names></name>, <name><surname>Wang</surname><given-names>R</given-names></name>, <name><surname>Guo</surname><given-names>Z</given-names></name>, <name><surname>Feng</surname><given-names>H</given-names></name>. <article-title>Evaluation of epitranscriptome-wide N6-methyladenosine differential analysis methods</article-title>. <source>Briefings in Bioinformatics</source>. <year>2023</year>;<volume>24</volume>(<issue>3</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbad139</pub-id><?supplied-pmid 37039682?><pub-id pub-id-type="pmid">37039682</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>H</given-names></name>, <name><surname>Wang</surname><given-names>C</given-names></name>, <name><surname>Wu</surname><given-names>Z</given-names></name>. <article-title>PROPER: Comprehensive power evaluation for differential expression using RNA-seq</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>2</issue>):<fpage>233</fpage>–<lpage>241</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btu640</pub-id><?supplied-pmid 25273110?><pub-id pub-id-type="pmid">25273110</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Niu</surname><given-names>Y</given-names></name>, <name><surname>Zhao</surname><given-names>X</given-names></name>, <name><surname>Wu</surname><given-names>YS</given-names></name>, <name><surname>Li</surname><given-names>MM</given-names></name>, <name><surname>Wang</surname><given-names>XJ</given-names></name>, <name><surname>Yang</surname><given-names>YG</given-names></name>. <article-title>N6-methyl-adenosine (m6A) in RNA: An Old Modification with A Novel Epigenetic Function</article-title>. <source>Genomics, Proteomics and Bioinformatics</source>. <year>2013</year>;<volume>11</volume>(<issue>1</issue>):<fpage>8</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.gpb.2012.12.002</pub-id><?supplied-pmid 23453015?><pub-id pub-id-type="pmid">23453015</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Schwartz</surname><given-names>S</given-names></name>, <name><surname>Mumbach</surname><given-names>MR</given-names></name>, <name><surname>Jovanovic</surname><given-names>M</given-names></name>, <name><surname>Wang</surname><given-names>T</given-names></name>, <name><surname>Maciag</surname><given-names>K</given-names></name>, <name><surname>Bushkin</surname><given-names>GG</given-names></name>, <etal>et al</etal>. <article-title>Perturbation of m6A writers reveals two distinct classes of mRNA methylation at internal and 5’ sites</article-title>. <source>Cell Reports</source>. <year>2014</year>;<volume>8</volume>(<issue>1</issue>):<fpage>284</fpage>–<lpage>296</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.celrep.2014.05.048</pub-id><?supplied-pmid 24981863?><pub-id pub-id-type="pmid">24981863</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Barbieri</surname><given-names>I</given-names></name>, <name><surname>Tzelepis</surname><given-names>K</given-names></name>, <name><surname>Pandolfini</surname><given-names>L</given-names></name>, <name><surname>Shi</surname><given-names>J</given-names></name>, <name><surname>Millán-Zambrano</surname><given-names>G</given-names></name>, <name><surname>Robson</surname><given-names>SC</given-names></name>, <etal>et al</etal>. <article-title>Promoter-bound METTL3 maintains myeloid leukaemia by m6A-dependent translation control</article-title>. <source>Nature</source>. <year>2017</year>;<volume>552</volume>(<issue>7683</issue>):<fpage>126</fpage>–<lpage>131</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature24678</pub-id><?supplied-pmid 29186125?><pub-id pub-id-type="pmid">29186125</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10890765</article-id>
    <article-id pub-id-type="pmid">38346081</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-23-01546</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011875</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Molecular biology techniques</subject>
            <subj-group>
              <subject>Sequencing techniques</subject>
              <subj-group>
                <subject>RNA sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Molecular biology techniques</subject>
          <subj-group>
            <subject>Sequencing techniques</subject>
            <subj-group>
              <subject>RNA sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Chemistry</subject>
          <subj-group>
            <subject>Chemical Reactions</subject>
            <subj-group>
              <subject>Methylation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Research Design</subject>
          <subj-group>
            <subject>Experimental Design</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Data</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>High Throughput Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>High Throughput Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Cell biology</subject>
          <subj-group>
            <subject>Chromosome biology</subject>
            <subj-group>
              <subject>Chromatin</subject>
              <subj-group>
                <subject>Chromatin modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Epigenetics</subject>
            <subj-group>
              <subject>Chromatin</subject>
              <subj-group>
                <subject>Chromatin modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>Chromatin</subject>
              <subj-group>
                <subject>Chromatin modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>DNA</subject>
            <subj-group>
              <subject>DNA modification</subject>
              <subj-group>
                <subject>DNA methylation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>DNA</subject>
              <subj-group>
                <subject>DNA modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Epigenetics</subject>
            <subj-group>
              <subject>DNA modification</subject>
              <subj-group>
                <subject>DNA methylation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>DNA modification</subject>
              <subj-group>
                <subject>DNA methylation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Transcriptome Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Transcriptome Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">magpie</italic>: A power evaluation method for differential RNA methylation analysis in N6-methyladenosine sequencing</article-title>
      <alt-title alt-title-type="running-head">Power evaluation in differential RNA methylation analysis</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Guo</surname>
          <given-names>Zhenxing</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Duan</surname>
          <given-names>Daoyu</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3710-9029</contrib-id>
        <name>
          <surname>Tang</surname>
          <given-names>Wen</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Julia</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bush</surname>
          <given-names>William S.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5986-2260</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Liangliang</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jin</surname>
          <given-names>Fulai</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2243-9949</contrib-id>
        <name>
          <surname>Feng</surname>
          <given-names>Hao</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>School of Data Science, The Chinese University of Hong Kong, Shenzhen (CUHK-Shenzhen), Shenzhen, Guangdong, China</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Population and Quantitative Health Sciences, Case Western Reserve University, Cleveland, Ohio, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Hathaway Brown School, Shaker Heights, Ohio, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Genetics and Genome Sciences, Case Western Reserve University, Cleveland, Ohio, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ziemann</surname>
          <given-names>Mark</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Burnet Institute, AUSTRALIA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>hxf155@case.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <volume>20</volume>
    <issue>2</issue>
    <elocation-id>e1011875</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 Guo et al</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Guo et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1011875.pdf"/>
    <abstract>
      <p>Recently, novel biotechnologies to quantify RNA modifications became an increasingly popular choice for researchers who study epitranscriptome. When studying RNA methylations such as N6-methyladenosine (m<sup>6</sup>A), researchers need to make several decisions in its experimental design, especially the sample size and a proper statistical power. Due to the complexity and high-throughput nature of m<sup>6</sup>A sequencing measurements, methods for power calculation and study design are still currently unavailable. In this work, we propose a statistical power assessment tool, <italic toggle="yes">magpie</italic>, for power calculation and experimental design for epitranscriptome studies using m<sup>6</sup>A sequencing data. Our simulation-based power assessment tool will borrow information from real pilot data, and inspect various influential factors including sample size, sequencing depth, effect size, and basal expression ranges. We integrate two modules in <italic toggle="yes">magpie</italic>: (i) a flexible and realistic simulator module to synthesize m<sup>6</sup>A sequencing data based on real data; and (ii) a power assessment module to examine a set of comprehensive evaluation metrics.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Sample size and sequencing depth are two essential quantitative factors determined prior to high throughput sequencing experiments, for statistical power maximization with limited budget. Due to the complex structure of data from m<sup>6</sup>A RNA methylation sequencing, analytical derivations for both quantities remain challenging in experimental designs. In response to this challenge, we propose a simulation-based statistical framework, together with a user-friendly R/Bioconductor package <italic toggle="yes"><bold>magpie</bold></italic>, to comprehensively assess the power of the differential m<sup>6</sup>A methylation detection at varied sample sizes, effect sizes, baseline expression levels, and sequencing depths. Using in-silico synthetic data that mimic real data well, <italic toggle="yes"><bold>magpie</bold></italic> provides several major evaluation metrics to assist users in study design and statistical power evaluation.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100008136</institution-id>
            <institution>Case Western Reserve University</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2243-9949</contrib-id>
          <name>
            <surname>Feng</surname>
            <given-names>Hao</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This research was partially supported by the intramural funding from Case Western Reserve University awarded to HF, and the intramural funding UDF01002936 awarded to ZG from The Chinese University of Hong Kong, Shenzhen (CUHK-Shenzhen). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="1"/>
      <page-count count="13"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2024-02-23</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The proposed power assessment tool magpie is publicly available as a R/Bioconductor package at: <ext-link xlink:href="https://bioconductor.org/packages/magpie/" ext-link-type="uri">https://bioconductor.org/packages/magpie/</ext-link>. The simulation tutorial with instructions is available at <ext-link xlink:href="https://github.com/dxd429/magieSims" ext-link-type="uri">https://github.com/dxd429/magieSims</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The proposed power assessment tool magpie is publicly available as a R/Bioconductor package at: <ext-link xlink:href="https://bioconductor.org/packages/magpie/" ext-link-type="uri">https://bioconductor.org/packages/magpie/</ext-link>. The simulation tutorial with instructions is available at <ext-link xlink:href="https://github.com/dxd429/magieSims" ext-link-type="uri">https://github.com/dxd429/magieSims</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>RNA methylation represents another layer of epigenetic regulation in addition to the well-studied DNA methylation and histone modification. Among different types of RNA methylation, N6-methyladenosine, i.e. m<sup>6</sup>A, is the most common form. It has been identified as one of the post-transcriptional regulatory markers on mRNA, rRNA, tRNA, circRNA, miRNA and long-noncoding RNA, and plays important roles in regulating pre-RNA splicing, RNA translation, stability, and degradation [<xref rid="pcbi.1011875.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1011875.ref003" ref-type="bibr">3</xref>]. The effects of m<sup>6</sup>A suggest its involvement in multiple cellular processes such as cell differentiation and reprogramming [<xref rid="pcbi.1011875.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1011875.ref005" ref-type="bibr">5</xref>]. Studies also suggest linkages between the dysregulation of m<sup>6</sup>A and many human diseases such as cancers and neural disorders [<xref rid="pcbi.1011875.ref002" ref-type="bibr">2</xref>, <xref rid="pcbi.1011875.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1011875.ref007" ref-type="bibr">7</xref>].</p>
    <p>MeRIP-seq/m<sup>6</sup>A-seq was developed to characterize transcriptome-wide m<sup>6</sup>A profiles [<xref rid="pcbi.1011875.ref008" ref-type="bibr">8</xref>, <xref rid="pcbi.1011875.ref009" ref-type="bibr">9</xref>]. This technique typically relies on immunoprecipitation of m<sup>6</sup>A-containing RNA fragments (m<sup>6</sup>A-IP), followed by high-throughput next generation sequencing. These samples are generally referred to as the IP (immunoprecipitated) samples. In addition to IP samples, cDNA libraries are also prepared for input control mRNAs to measure the background mRNA abundance. These input controls are essentially the transcriptome from regular RNA-seq. The m<sup>6</sup>A methylation level, for each region, is then quantified by the enrichment of IP over input, roughly the normalized ratio between IP and input control counts. If the m<sup>6</sup>A enrichment is significantly high, then the called peak of that region suggests an underlying m<sup>6</sup>A residue. MeRIP-seq is becoming a popular and indispensable tool to profile transcriptome-wide m<sup>6</sup>A, since the invention of this technique. One feature of MeRIP-seq is that, it immunoprecipitates each IP sample independently, which can potentially induce technical variabilities. Such technical artifacts lead to erroneous peak calling of methylated regions. This problem becomes prominent in studies with small sample sizes [<xref rid="pcbi.1011875.ref010" ref-type="bibr">10</xref>], which is often the case given the high expenses associated with the current experimental protocols. As an improved alternative, in m<sup>6</sup>A-seq2 [<xref rid="pcbi.1011875.ref011" ref-type="bibr">11</xref>], a single IP experiment is performed on the pooled RNAs of all samples, where RNAs from different samples are uniquely barcoded and demultiplexed after sequencing. The multiplexed profiling procedure by m<sup>6</sup>A-seq2 is expected to be widely applied to interrogate the distribution and functional consequences of m<sup>6</sup>A.</p>
    <p>To study the biological implications of m<sup>6</sup>A, one fundamental task is to identify the Differentially Methylated Regions (DMRs) across different conditions. Although several DMR detection methods have been developed [<xref rid="pcbi.1011875.ref012" ref-type="bibr">12</xref>–<xref rid="pcbi.1011875.ref014" ref-type="bibr">14</xref>] and evaluated [<xref rid="pcbi.1011875.ref015" ref-type="bibr">15</xref>] in either MeRIP-seq or m<sup>6</sup>A-seq2 experiments, the sample size calculation with their associated statistical power remains an open question due to the complexities of sequencing experiments. Further, due to the uniqueness in data structure, power analysis tools developed for other types of analyses such as Differential Expression (DE) gene detection from RNA-seq cannot be applied to MeRIP-seq and m<sup>6</sup>A-seq2 experiments. First, data simulated for power assessment in DE gene detection from RNA-seq are barely equivalent to the input control data alone. No statistical model is available to generate their matched IP counts. Second, the effect size of methylation in m<sup>6</sup>A data analysis is based on the ratios of IP/input, not the input data alone. Therefore, the count coverage of each gene may affect power and other metrics in a way differing from that in DE analyses. Additionally, the impact of baseline expression of each gene and sequencing depth of the whole sample on the power of DMR detection are also unignorable. Therefore, an appropriate power analysis tool specifically for epitranscriptome studies is needed, especially with its increasing popularity. To our best knowledge, no method is currently available.</p>
    <p>Here, we propose a comprehensive power evaluation method named <italic toggle="yes"><bold>magpie</bold></italic> (<bold><underline>m</underline></bold><sup>6</sup><bold><underline>A</underline></bold>
<bold>g</bold>enome-wide differential analysis <bold><underline>p</underline></bold>ower <bold><underline>i</underline></bold>nferenc<bold><underline>e</underline></bold>). <italic toggle="yes"><bold>magpie</bold></italic> first learns characteristics of real data, and then synthesizes data that mimics the real data well. In simulations, <italic toggle="yes"><bold>magpie</bold></italic> allows for the adjustment of sample size, sequencing depth and effect size. It can evaluate the epitranscriptome study design using multiple metrics including sensitivity, specificity, precision, false discovery rate, and more. Building upon these functionalities, <italic toggle="yes"><bold>magpie</bold></italic> fills in the knowledge gap by providing a comprehensive biostatistical tool for statistical power evaluation, sample size calculation, and data analysis planning, which are almost always required in general experimental designs. This makes it the first available tool to guide the practical experimental design by comprehensively investigating the relationship between statistical metrics and associated factors in m<sup>6</sup>A differential analysis. <italic toggle="yes"><bold>magpie</bold></italic> is publicly available as an R/Bioconductor package at <ext-link xlink:href="https://bioconductor.org/packages/magpie/" ext-link-type="uri">https://bioconductor.org/packages/magpie/</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>An overview of <italic toggle="yes">magpie</italic></title>
      <p>We assess the effect of experimental design on the power of DMR detection purely based on simulations, where the whole procedure is divided into two components. First, <italic toggle="yes"><bold>magpie</bold></italic> preprocesses <italic toggle="yes">.bam</italic> files from MeRIP-seq sequencing and obtains read counts in candidate regions from all samples (<xref rid="pcbi.1011875.g001" ref-type="fig">Fig 1</xref>), where candidates are identified with conditional binomial tests. With the counts from the identified candidate regions, <italic toggle="yes"><bold>magpie</bold></italic> simulates count matrices for both IP and Input samples with a Gamma-Poisson model. Parameters involved are estimated from the candidates to mimic the actual MeRIP-seq data in aspects of marginal distribution read counts, and the distribution of biological dispersion in methylation levels (<xref rid="pcbi.1011875.g001" ref-type="fig">Fig 1</xref>). With data simulated, we then evaluate power and error rates on them (<xref rid="pcbi.1011875.g001" ref-type="fig">Fig 1</xref>). The two components, Gamma-Poisson simulation and power assessment, are independent so that <italic toggle="yes"><bold>magpie</bold></italic> allows the assessment on data by different simulation strategies.</p>
      <fig position="float" id="pcbi.1011875.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overview of <italic toggle="yes">magpie</italic>.</title>
          <p><italic toggle="yes"><bold>magpie</bold></italic> provides power evaluation for differential m<sup>6</sup>A methylation analysis. It takes pilot MeRIP-seq data as the input. Based on the pilot data, it obtains candidate regions, estimates key parameters, and conducts real-data-based simulations for statistical power evaluation.</p>
        </caption>
        <graphic xlink:href="pcbi.1011875.g001" position="float"/>
      </fig>
    </sec>
    <sec id="sec004">
      <title>Data generative model</title>
      <p>Here we describe how <italic toggle="yes"><bold>magpie</bold></italic> simulates the MeRIP-seq count matrices given existing real MeRIP-seq data from different conditions. <italic toggle="yes"><bold>magpie</bold></italic> processes <italic toggle="yes">.bam</italic> files by splitting the transcriptome into bins, aggregating read counts, and testing for significance of IP enrichment over Input. Using a bump-finding algorithm, significant bins are combined into candidate regions. <italic toggle="yes"><bold>magpie</bold></italic> then focus on these candidates in simulations, as other regions lack IP enrichment and biological relevance. Suppose there are in total <italic toggle="yes">N</italic> pairs of IP and Input samples from all conditions, and <italic toggle="yes">M</italic> candidate DMRs generated after preprocessing. Let <italic toggle="yes">X</italic><sub><italic toggle="yes">ij</italic></sub> and <italic toggle="yes">Y</italic><sub><italic toggle="yes">ij</italic></sub> denote input and IP counts in candidate DMR <italic toggle="yes">i</italic> from sample <italic toggle="yes">j</italic>. We assume that <inline-formula id="pcbi.1011875.e001"><alternatives><graphic xlink:href="pcbi.1011875.e001.jpg" id="pcbi.1011875.e001g" position="anchor"/><mml:math id="M1" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e002"><alternatives><graphic xlink:href="pcbi.1011875.e002.jpg" id="pcbi.1011875.e002g" position="anchor"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Similarly, <inline-formula id="pcbi.1011875.e003"><alternatives><graphic xlink:href="pcbi.1011875.e003.jpg" id="pcbi.1011875.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e004"><alternatives><graphic xlink:href="pcbi.1011875.e004.jpg" id="pcbi.1011875.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Here <inline-formula id="pcbi.1011875.e005"><alternatives><graphic xlink:href="pcbi.1011875.e005.jpg" id="pcbi.1011875.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>x</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e006"><alternatives><graphic xlink:href="pcbi.1011875.e006.jpg" id="pcbi.1011875.e006g" position="anchor"/><mml:math id="M6" display="inline" overflow="scroll"><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>y</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> represent the normalizing factors for input and IP samples, such as the library sizes. <inline-formula id="pcbi.1011875.e007"><alternatives><graphic xlink:href="pcbi.1011875.e007.jpg" id="pcbi.1011875.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e008"><alternatives><graphic xlink:href="pcbi.1011875.e008.jpg" id="pcbi.1011875.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> are normalized poisson rates. <inline-formula id="pcbi.1011875.e009"><alternatives><graphic xlink:href="pcbi.1011875.e009.jpg" id="pcbi.1011875.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1011875.e010"><alternatives><graphic xlink:href="pcbi.1011875.e010.jpg" id="pcbi.1011875.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, and <italic toggle="yes">θ</italic><sub><italic toggle="yes">i</italic></sub> are the shape and scale parameters of corresponding gamma distributions. Given above assumptions, naturally <inline-formula id="pcbi.1011875.e011"><alternatives><graphic xlink:href="pcbi.1011875.e011.jpg" id="pcbi.1011875.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Further, denote <inline-formula id="pcbi.1011875.e012"><alternatives><graphic xlink:href="pcbi.1011875.e012.jpg" id="pcbi.1011875.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1011875.e013"><alternatives><graphic xlink:href="pcbi.1011875.e013.jpg" id="pcbi.1011875.e013g" position="anchor"/><mml:math id="M13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, then marginally,
<disp-formula id="pcbi.1011875.e014"><alternatives><graphic xlink:href="pcbi.1011875.e014.jpg" id="pcbi.1011875.e014g" position="anchor"/><mml:math id="M14" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <p>In above equations, <italic toggle="yes">μ</italic><sub><italic toggle="yes">ij</italic></sub> and <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">ij</italic></sub> represent the mean and dispersion of the methylation level for candidate region <italic toggle="yes">i</italic> in sample <italic toggle="yes">j</italic>.</p>
      <p>We begin by simulating size factors, for which we directly use the values estimated from real data:
<disp-formula id="pcbi.1011875.e015"><alternatives><graphic xlink:href="pcbi.1011875.e015.jpg" id="pcbi.1011875.e015g" position="anchor"/><mml:math id="M15" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic toggle="yes">x</italic><sub><italic toggle="yes">bj</italic></sub> and <italic toggle="yes">y</italic><sub><italic toggle="yes">bj</italic></sub> are read counts in bin <italic toggle="yes">b</italic> from the <italic toggle="yes">j</italic>th Input and IP samples.</p>
      <p>Next, for each candidate region <italic toggle="yes">i</italic>, <italic toggle="yes"><bold>magpie</bold></italic> simulates a baseline methylation level <italic toggle="yes">μ</italic><sub><italic toggle="yes">i</italic></sub> or equivalently <inline-formula id="pcbi.1011875.e016"><alternatives><graphic xlink:href="pcbi.1011875.e016.jpg" id="pcbi.1011875.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:math></alternatives></inline-formula> in the structure of <inline-formula id="pcbi.1011875.e017"><alternatives><graphic xlink:href="pcbi.1011875.e017.jpg" id="pcbi.1011875.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> where <italic toggle="yes">Z</italic><sub><italic toggle="yes">j</italic></sub> contains the attributes of sample <italic toggle="yes">j</italic>, and <italic toggle="yes">β</italic><sub><italic toggle="yes">i</italic></sub> represents corresponding coefficient. To do that, we randomly sample <italic toggle="yes">α</italic><sub><italic toggle="yes">i</italic></sub> from one parametric distribution, or from its empirical distribution estimated from real data. Distributions of <inline-formula id="pcbi.1011875.e018"><alternatives><graphic xlink:href="pcbi.1011875.e018.jpg" id="pcbi.1011875.e018g" position="anchor"/><mml:math id="M18" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>’s from five MeRIP-seq datasets are presented in Fig D in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>.</p>
      <p>After simulating the baseline methylation, we simulate <inline-formula id="pcbi.1011875.e019"><alternatives><graphic xlink:href="pcbi.1011875.e019.jpg" id="pcbi.1011875.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:msubsup><mml:mi>β</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> for all regions. Because we can hardly know the actual number of DMRs and their degree of differential methylation, specific settings are adopted based on both reasonable assumptions and empirical observations. First, <italic toggle="yes"><bold>magpie</bold></italic> sets the proportion of DMRs as 10%, assuming that DM is present in only a small subset of regions in most experiments. Then, for non-DMRs, <italic toggle="yes">β</italic><sub><italic toggle="yes">i</italic></sub> = 0. For DMR <italic toggle="yes">i</italic>, <inline-formula id="pcbi.1011875.e020"><alternatives><graphic xlink:href="pcbi.1011875.e020.jpg" id="pcbi.1011875.e020g" position="anchor"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> if its estimated effect size <inline-formula id="pcbi.1011875.e021"><alternatives><graphic xlink:href="pcbi.1011875.e021.jpg" id="pcbi.1011875.e021g" position="anchor"/><mml:math id="M21" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is greater than the 50% quantile of all regions. Otherwise, <italic toggle="yes">β</italic><sub><italic toggle="yes">i</italic></sub> ∼ <italic toggle="yes">U</italic>(1, 2). Here, <inline-formula id="pcbi.1011875.e022"><alternatives><graphic xlink:href="pcbi.1011875.e022.jpg" id="pcbi.1011875.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> are directly derived from real pilot data, using the DMR detection method TRESS.</p>
      <p>The dispersion has been shown to be substantial across several real datasets, which justifies the necessity of its modeling (Fig F in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>). We can simulate it again from a parametric distribution or sample from empirical distributions. To ensure the robustness, the empirical distribution can be estimated by TRESS from raw counts or by Beta-binomial regressions from normalized counts. Denote <inline-formula id="pcbi.1011875.e023"><alternatives><graphic xlink:href="pcbi.1011875.e023.jpg" id="pcbi.1011875.e023g" position="anchor"/><mml:math id="M23" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e024"><alternatives><graphic xlink:href="pcbi.1011875.e024.jpg" id="pcbi.1011875.e024g" position="anchor"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> as the normalized IP and total counts, the Beta-Binomial regressions are established as follows:
<disp-formula id="pcbi.1011875.e025"><alternatives><graphic xlink:href="pcbi.1011875.e025.jpg" id="pcbi.1011875.e025g" position="anchor"/><mml:math id="M25" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mtext>logit</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>z</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic toggle="yes">μ</italic><sub><italic toggle="yes">ij</italic></sub> and <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">i</italic></sub> represent the mean and dispersion of methylation level. As noted, for the convenience of estimation, above Beta-binomial regressions (as well as TRESS) assume <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">ij</italic></sub> = <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">i</italic></sub> for all <italic toggle="yes">j</italic>.</p>
      <p>Empirically for the same real dataset, <inline-formula id="pcbi.1011875.e026"><alternatives><graphic xlink:href="pcbi.1011875.e026.jpg" id="pcbi.1011875.e026g" position="anchor"/><mml:math id="M26" display="inline" overflow="scroll"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> estimated by the Negative-binomial model in TRESS are usually greater than those estimated by Beta-binomial regressions. Without golden truth, our setting for <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">i</italic></sub> relies on a data driven approach. Specifically, by comparing to the real data, <italic toggle="yes"><bold>magpie</bold></italic> will calculate a KL-divergence for each of the synthetic counts by model in (<xref rid="pcbi.1011875.e014" ref-type="disp-formula">1</xref>). Those <inline-formula id="pcbi.1011875.e027"><alternatives><graphic xlink:href="pcbi.1011875.e027.jpg" id="pcbi.1011875.e027g" position="anchor"/><mml:math id="M27" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> resulting in a significantly lower KL divergence between simulated data and real data will be kept for final data generation. If there is no significant difference in KL-divergence, <inline-formula id="pcbi.1011875.e028"><alternatives><graphic xlink:href="pcbi.1011875.e028.jpg" id="pcbi.1011875.e028g" position="anchor"/><mml:math id="M28" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> estimated by NB will be adopted.</p>
      <p>Lastly, we simulate the scale parameter <italic toggle="yes">θ</italic><sub><italic toggle="yes">i</italic></sub> in (<xref rid="pcbi.1011875.e014" ref-type="disp-formula">1</xref>). Again, it can be simulated by parametric distributions, or sampled directly from empirical distributions. For the parametric distribution, we set its mean as a function of <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">i</italic></sub> observed in the previous peak detection method [<xref rid="pcbi.1011875.ref014" ref-type="bibr">14</xref>]. No matter the strategy employed, the first-round generated <inline-formula id="pcbi.1011875.e029"><alternatives><graphic xlink:href="pcbi.1011875.e029.jpg" id="pcbi.1011875.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> will be further scaled by the fold change between real and first-round simulated counts. Such an adjustment again helps to reduce the disparity between the simulated and real distributions, thereby improving the reliability of the results in follow-up power assessments.</p>
    </sec>
    <sec id="sec005">
      <title>DMR detection</title>
      <p>After generating the simulated read counts in candidate DMRs, an existing software developed for MeRIP-seq is applied to detect DMRs. We implement an interface for calling TRESS and exomePeak2. Each method reports test statistics, <italic toggle="yes">p</italic>-values and FDRs for all candidate regions. These results are then used for the downstream power assessment. Users also have the option to adopt other DMR detection methods for their own evaluation, by following our simulation tutorial with detail instructions at <ext-link xlink:href="https://github.com/dxd429/magieSims" ext-link-type="uri">https://github.com/dxd429/magieSims</ext-link>. This resource enables users to conduct their own analyses using the synthetic data generated by our simulation and evaluation framework.</p>
    </sec>
    <sec id="sec006">
      <title>Power assessment measures</title>
      <p>We adopted several evaluation metrics in the statistical power assessment for differential analysis using MeRIP-seq data. These metrics include classic criteria in hypothesis testings such as the false discovery rate (FDR), power, and precision. We also inspected the false discovery cost (FDC, defined below) and targeted power [<xref rid="pcbi.1011875.ref016" ref-type="bibr">16</xref>], aiming to provide a comprehensive statistical power evaluation.</p>
      <p>Because not all DMRs are of biological interest to us, especially those with low effect sizes, we introduce a cutoff Δ for the effect size <italic toggle="yes">β</italic>. Only those DMRs with |<italic toggle="yes">β</italic>|≥Δ are considered as ‘targeted DMRs’, which are of biological interest in research. We denote the number of non-DMRs, non-targeted DMRs, and targeted DMRs as <italic toggle="yes">R</italic><sub>0</sub>, <italic toggle="yes">R</italic><sub>1</sub>, and <italic toggle="yes">R</italic><sub>2</sub>, respectively. Suppose <italic toggle="yes">T</italic><sub><italic toggle="yes">r</italic></sub> represents the testing result of region <italic toggle="yes">r</italic>, where <italic toggle="yes">T</italic><sub><italic toggle="yes">r</italic></sub> = 1 denotes the discovered DMR, and <italic toggle="yes">T</italic><sub><italic toggle="yes">r</italic></sub> = 0 otherwise. The confusion matrix in the DMR detection is summarized in <xref rid="pcbi.1011875.t001" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="pcbi.1011875.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>The confusion matrix in m<sup>6</sup>A DMR detection, when taking biological significance into consideration.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011875.t001" id="pcbi.1011875.t001g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1">Simulated True</th>
                <th align="center" colspan="2" rowspan="1">Testing Result</th>
                <th align="center" rowspan="2" colspan="1">Total</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1"><italic toggle="yes">T</italic><sub><italic toggle="yes">r</italic></sub> = 0</th>
                <th align="center" rowspan="1" colspan="1"><italic toggle="yes">T</italic><sub><italic toggle="yes">r</italic></sub> = 1</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">Non-DMR</td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">N</italic>
                  <sub>0</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">P</italic>
                  <sub>0</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">R</italic>
                  <sub>0</sub>
                </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Non-targeted DMR (0 &lt; |<italic toggle="yes">β</italic>|&lt;Δ)</td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">N</italic>
                  <sub>1</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">P</italic>
                  <sub>1</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">R</italic>
                  <sub>1</sub>
                </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Targeted DMR (|<italic toggle="yes">β</italic>|≥Δ)</td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">N</italic>
                  <sub>2</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">P</italic>
                  <sub>2</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">R</italic>
                  <sub>2</sub>
                </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Total</td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">N</italic>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">P</italic>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">R</italic>
                </td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The false discovery rate (FDR) and precision are statistical metrics that jointly provide insights into the balance between true and false discoveries among the significant features. In this context, FDR and precision are defined as <inline-formula id="pcbi.1011875.e030"><alternatives><graphic xlink:href="pcbi.1011875.e030.jpg" id="pcbi.1011875.e030g" position="anchor"/><mml:math id="M30" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>P</mml:mi></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e031"><alternatives><graphic xlink:href="pcbi.1011875.e031.jpg" id="pcbi.1011875.e031g" position="anchor"/><mml:math id="M31" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mi>P</mml:mi></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, respectively. Statistical power is defined, naturally, as <inline-formula id="pcbi.1011875.e032"><alternatives><graphic xlink:href="pcbi.1011875.e032.jpg" id="pcbi.1011875.e032g" position="anchor"/><mml:math id="M32" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. To investigate the power of detecting targeted DMRs that are biologically interesting with |<italic toggle="yes">β</italic>|≥Δ, targeted power is introduced and defined as <inline-formula id="pcbi.1011875.e033"><alternatives><graphic xlink:href="pcbi.1011875.e033.jpg" id="pcbi.1011875.e033g" position="anchor"/><mml:math id="M33" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. To better illustrate the trade-off between false positives and true positives, we propose an additional metric, False Discovery Cost (FDC), <inline-formula id="pcbi.1011875.e034"><alternatives><graphic xlink:href="pcbi.1011875.e034.jpg" id="pcbi.1011875.e034g" position="anchor"/><mml:math id="M34" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, which is defined as the expected number of false positives per targeted true positive. The rationale behind this is straightforward: this cost is the expected number of false discoveries, per true discovery we are interested in.</p>
      <p>Finally, our proposed evaluation framework allows for the examination of aforementioned metrics using simulations under various combinations of sample size, sequencing depth, input expression stratum, and FDR threshold. Each user-defined scenario is repeated for 100 times, and these metrics are computed and averaged to generate empirical estimations.</p>
    </sec>
    <sec id="sec007">
      <title>Implementation</title>
      <p>Given a MeRIP-seq dataset in <italic toggle="yes">.bam</italic> files, various experimental scenarios (such as sample size, sequencing depth, FDR threshold, etc.), and a chosen differential methylation testing method, <italic toggle="yes"><bold>magpie</bold></italic> generates evaluation results for each proposed study design. Functions incorporated in <italic toggle="yes"><bold>magpie</bold></italic> allow users to export these results in an <italic toggle="yes">.xlsx</italic> file, and to visualize them through line plots. Users have the option to provide small pilot data, which could include only several chromosomes. We would estimate major parameters from these pilot data, to guide larger-scale simulations for power evaluation for future experimental designs. Alternatively, when pilot MeRIP-seq datasets are unavailable or unattainable, the function <italic toggle="yes">quickPower</italic> can produce power evaluation results within seconds. This is achieved by directly extracting our in-house evaluation results based on three public N6-methyladenosine datasets on GEO as the pilot data [<xref rid="pcbi.1011875.ref017" ref-type="bibr">17</xref>–<xref rid="pcbi.1011875.ref019" ref-type="bibr">19</xref>]. Our package also comes with a vignette that provides thorough instructions and examples of its applications in differential analysis experimental design on N6-methyladenosine.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec008">
    <title>Results</title>
    <sec id="sec009">
      <title>Larger sample size benefits DMR detection</title>
      <p>Under simulation settings outlined in Simulation Settings in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>, we next examine the relationship between sample size and power in DMR detection, given that determining sample size is a primary objective in our method. We adopt sample sizes of 2, 3, 5, 7, and 10 per group, and nominal FDR values of 0.05, 0.1, 0.15, and 0.2, both of which are common choices in MeRIP-seq experiments. Note that we have validated our synthetic data against the pilot data, ensuring that our strategy effectively captures the characteristics of real data (Fig G in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>). The empirical results for major metrics are shown in <xref rid="pcbi.1011875.g002" ref-type="fig">Fig 2</xref>. Grouped by sample size and nominal FDR level, power, targeted power, FDC, and FDR averaged over 100 simulations are shown in <xref rid="pcbi.1011875.g002" ref-type="fig">Fig 2A–2D</xref>. For a fixed sample size, metrics like power, FDC, and FDR diminish under lower FDR thresholds. This occurs as lower FDR values lead to greater stringency, which in turn reduces false positives. The power will drop, as expected, when using stringent FDRs. As sample size increases, these differences become smaller, particularly for statistical power (<xref rid="pcbi.1011875.g002" ref-type="fig">Fig 2A</xref>). Here, power remains consistently high across all FDR levels with 7 and 10 replicates per group. This highlights the benefit of using a larger sample size that helps detect DMRs with limited effect sizes, where a type II error would often occur when the sample size is small. Such trend is observed consistently when using different pilot data (Fig A in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>). At the same time, these results give researchers the knowledge to optimize the sample size based on their budgets. Using <xref rid="pcbi.1011875.g002" ref-type="fig">Fig 2A</xref> as an example, a power around 0.8 is achieved with 7 samples per group, and sample size of 7 is considered large in current MeRIP-seq studies. The benefit of expanding the sample size to 10 is marginal, but the associated costs could be significantly higher.</p>
      <fig position="float" id="pcbi.1011875.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Statistical power evaluation metrics for DMR detection, at various sample sizes and FDR thresholds.</title>
          <p>(<bold>A</bold>) Power versus sample size, with each line presenting one FDR cutoff. (<bold>B</bold>)-(<bold>D</bold>) Similar to (<bold>A</bold>) but for other metrics: targeted power, FDC, and FDR. Targeted power and FDC are computed for DMRs with |<italic toggle="yes">β</italic>|≥2. Each point on the line plots is an averaged value over N = 100 simulations based on real MeRIP-seq data.</p>
        </caption>
        <graphic xlink:href="pcbi.1011875.g002" position="float"/>
      </fig>
    </sec>
    <sec id="sec010">
      <title>Impact of baseline expression values</title>
      <p>It is useful for researchers to understand the effects of heterogeneity in baseline expression levels in DMR detection. In MeRIP-seq data, the basal expression level is represented by input control read counts, thus we stratify power metrics by input control ranges. Six strata are obtained based on following quantiles of mean input counts: stratum 1 (0%-10%), stratum 2 (10%-30%), stratum 3 (30%-50%), stratum 4 (50%-70%), stratum 5 (70%-90%), and stratum 6 (90%-100%). At a nominal FDR of 0.05, the average targeted power and FDC for the six strata are shown in <xref rid="pcbi.1011875.g003" ref-type="fig">Fig 3A and 3B</xref>. Overall, reduced targeted power is observed in the lower strata, a trend that is more evident when sample sizes are small. This is expected, as true differences in low-expressed regions are often obscured by noise, making DMRs harder to detect. A limited sample size further exacerbates this issue. This suggests the potential benefits of increasing the sequencing depth, particularly when biological replicates are limited and more samples are hard to obtain. Here, relatively low strata will enjoy the benefit of more drastic power improvement. Interestingly, higher FDCs are reported in the upper strata, suggesting that more false positives are detected per true discovery in these highly expressed regions. However, this trend diminishes with increasing sample size. Given that these metrics were computed across various simulation scenarios, we further explore the variability of the results, using visualizations within a specific stratum and sample size in <xref rid="pcbi.1011875.g003" ref-type="fig">Fig 3C–3F</xref>. With elevated sample sizes, there is reduced variability in both targeted power and FDC (<xref rid="pcbi.1011875.g003" ref-type="fig">Fig 3C and 3D</xref>). This is not surprising since it is more likely to capture the true dispersion with more replicates, leading to more consistent power estimates. However, this trend is not observed across the strata at a fixed sample size, suggesting the benefit of increasing sample size over sequencing depth for more reliable inferences. Under a fixed sample size (<xref rid="pcbi.1011875.g003" ref-type="fig">Fig 3E and 3F</xref>), an upward trend is observed across the strata for both targeted power and FDC. This trend aligns with the observations in <xref rid="pcbi.1011875.g003" ref-type="fig">Fig 3A and 3B</xref>, though some variability is evident. A heatmap panel is also available to illustrate the stratified results (Fig C in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>).</p>
      <fig position="float" id="pcbi.1011875.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Targeted power and FDC stratified by mean input values for DMRs with |<italic toggle="yes">β</italic>|≥2.</title>
          <p>Six strata are defined based on input count data quantiles: stratum 1 (0%, 10%), stratum 2 (10%, 30%), stratum 3 (30%, 50%), stratum 4 (50%, 70%), stratum 5 (70%, 90%), and stratum 6 (90%, 100%). A nominal FDR value of 0.05 is used to define significance. (<bold>A</bold>), (<bold>B</bold>) Mean targeted power and FDC along strata. Each line represents one sample size choice. (<bold>C</bold>), (<bold>D</bold>) Targeted power and FDC distributions in stratum 3, separated by sample size. (<bold>E</bold>), (<bold>F</bold>) Targeted power and FDC distributions with 5 replicates per group, stratified by mean input count values. N = 100 simulations are conducted.</p>
        </caption>
        <graphic xlink:href="pcbi.1011875.g003" position="float"/>
      </fig>
    </sec>
    <sec id="sec011">
      <title>Consistency among major DMR calling methods</title>
      <p>It is worth noting that the targeted power and FDC presented in the Results section are computed for DMRs with odds ratios (OR) exceeding Δ = 2, using TRESS. To evaluate the fluctuations of these two metrics across various effect sizes (OR), sample sizes and DMR detection methods, we also consider Δ values of 1.5, 2, 4, 6, 8, and 10, for TRESS, exomePeak2, and RADAR. In <xref rid="pcbi.1011875.g004" ref-type="fig">Fig 4</xref>, the targeted power and FDC are plotted against the sample size and are grouped by odds ratio thresholds. At all sample sizes, there is an increased targeted power (<xref rid="pcbi.1011875.g004" ref-type="fig">Fig 4A, 4C and 4E</xref>) and a higher FDC to identify DMRs with a larger odds ratio. Specifically, for FDC (<xref rid="pcbi.1011875.g004" ref-type="fig">Fig 4B, 4D and 4F</xref>), substantially higher values are observed among DMRs with exceptionally large odds ratios (Δ = 8, 10). This indicates that detecting DMRs with these large ORs might lead to a significant increase in false positives. These patterns hold true for TRESS, exomePeak2, RADAR. While all three methods show improvements in targeted power with added replicates across all odds ratio thresholds, a discrepancy is noted for FDC that it tends to increase with larger sample sizes when using exomePeak2 and RADAR. This discrepancy, however, is not universally observed when applying our proposed framework to different pilot data sets (Fig B in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>). Further examinations have been conducted to explore the choices of OR on the balance between sensitivity and specificity, as well as the trade-off between precision and recall (Fig E in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>). These findings highlight the importance of utilizing the users’ designated DMR detection methods during power calculation to ensure accurate estimations.</p>
      <fig position="float" id="pcbi.1011875.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Comparing power evaluation results between major DMR detection methods TRESS (A)-(B) and exomePeak2 (C)-(D).</title>
          <p>Targeted power and FDC are shown at various Odds Ratios (OR, representing effect size) and sample sizes. A nominal FDR value of 0.05 is used to define significance. Points on the line plots are averaged over N = 100 simulations.</p>
        </caption>
        <graphic xlink:href="pcbi.1011875.g004" position="float"/>
      </fig>
    </sec>
    <sec id="sec012">
      <title>Impact of sequencing depth</title>
      <p>As shown previously, sequencing depth is another critical factor in MeRIP-seq study design. Building upon our analysis of sequencing coverage strata, here we examine another aspect of sequencing depth by introducing a “depth factor”. This is a relative ratio to reflect the effect to enlarge or down-sample the sequencing coverage of the pilot data. As illustrated in <xref rid="pcbi.1011875.g005" ref-type="fig">Fig 5A</xref>, the targeted power rises with increased sequencing depth in all sample sizes. The incremental gain from increasing sequencing depth diminishes at high depths or large sample sizes, but benefits the small sample size the most. In <xref rid="pcbi.1011875.g005" ref-type="fig">Fig 5B</xref> for FDC, a similar pattern is observed as in the stratified analysis: FDCs increase with sequencing depth, but stabilize in scenarios with larger sample sizes. We also provide an integrated visualization in <xref rid="pcbi.1011875.g005" ref-type="fig">Fig 5C</xref>, presenting targeted power and FDC in the same panel, aiding users in understanding the tradeoffs between them. Researchers could consult similar figures, generated by <italic toggle="yes"><bold>magpie</bold></italic> using their own pilot data, to select a customized increase in sequencing depth to achieve the desired power.</p>
      <fig position="float" id="pcbi.1011875.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Sequencing depth affects targeted power and FDC for DMRs with |<italic toggle="yes">β</italic>|≥2.</title>
          <p>The ‘depth factor’ is the relative ratio of the new dataset’s library size over that from the original dataset. It reflects the impact of enlarging or down-sampling the sequencing depth of pilot data. (<bold>A</bold>), (<bold>B</bold>) Targeted power and FDC under different sequencing depths, grouped by sample size. (<bold>C</bold>) Joint visualization of the mean targeted power and FDC, over various sequencing depths and sample sizes. N = 100 simulations are conducted. The average sequencing depths of ‘Input’ and ‘IP’ from the pilot data are 3.51X and 0.54X, respectively.</p>
        </caption>
        <graphic xlink:href="pcbi.1011875.g005" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec013">
    <title>Discussions</title>
    <p>Sample size and power evaluation are pivotal and routine tasks in experimental design using sequencing data. Here we present the first tool to address the immediate needs of sample size calculation and power estimation for DMR detection in MeRIP-seq experiments. Traditionally, sample size calculation or power evaluation in hypothesis testings depends on inputs such as the effect size, variance from pilot studies, and the significance level. In contrast, for MeRIP-seq experiments with transcriptome-wide data, these scalar parameters must be considered as distributions. In addition, the distributions of sequencing depth and input control level can also significantly influence the statistical power, as we have shown in the results. We thus propose a statistically rigorous approach to address all these challenges, and draw information from pilot real data for simulation and empirical power evaluation.</p>
    <p>We have a flexible simulation framework that allows switching models to mimic the real data well. In sequencing studies, data from varied tissues or cell types can exhibit unique expression and RNA methylation distributions across features (i.e. genes or regions). To address this, our tool allows users to provide pilot data analogous to their intended studies, serving as the basis for the estimated and adopted parameters in downstream simulations. To ensure that the simulated data accurately reflects actual data characteristics, <italic toggle="yes"><bold>magpie</bold></italic> can adopt both negative-binomial and beta-binomial models and choose the one that aligns with the real data distributions best.</p>
    <p>Both increased sequencing coverage and a larger sample size can significantly enhance the statistical power, as demonstrated in Results. Given that the total sequencing reads are often predetermined before experiments, researchers can benefit from our tool to optimize the balance between sequencing depth and sample size, to ensure the best possible experimental design in differential RNA methylation studies.</p>
    <p>In our stratified analysis, significantly lower power is observed in regions of low input levels. This suggests the potential of refining the filtering strategy. While excluding low-expressed strata certainly means losing some true positives among these regions, it boosts the power to detect DMRs that are highly expressed, which are often of greater biological interest. Our proposed tool <italic toggle="yes"><bold>magpie</bold></italic> can offer a foresight into the overall power gain, should the researchers want to weigh the tradeoffs before initiating their data analyses.</p>
    <p>Our proposed approach captures real data characteristics, simulates data under various experimental settings, and produces common power evaluation metrices. This statistical framework has been implemented into a user-friendly R/Bioconductor package <italic toggle="yes"><bold>magpie</bold></italic>. The package allows users to save power evaluation results as an Excel file and visualize their relationship with aforementioned factors with line plots. Recognizing that users might not have their own pilot MeRIP-seq data, we also develop a “<italic toggle="yes">quickPower</italic>” function. This function can generate comprehensive power evaluation outputs in seconds, by retrieving pre-calculated results from three published studies. <italic toggle="yes"><bold>magpie</bold></italic> is available at <ext-link xlink:href="https://bioconductor.org/packages/magpie/" ext-link-type="uri">https://bioconductor.org/packages/magpie/</ext-link>.</p>
  </sec>
  <sec id="sec014" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1011875.s001" position="float" content-type="local-data">
      <label>S1 Appendix</label>
      <caption>
        <title>Simulation settings and additional results.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1011875.s001.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1011875.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Lu</surname><given-names>Z</given-names></name>, <name><surname>Gomez</surname><given-names>A</given-names></name>, <name><surname>Hon</surname><given-names>GC</given-names></name>, <name><surname>Yue</surname><given-names>Y</given-names></name>, <name><surname>Han</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>N 6-methyladenosine-dependent regulation of messenger RNA stability</article-title>. <source>Nature</source>. <year>2014</year>;<volume>505</volume>(<issue>7481</issue>):<fpage>117</fpage>–<lpage>120</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature12730</pub-id><?supplied-pmid 24284625?><pub-id pub-id-type="pmid">24284625</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Geula</surname><given-names>S</given-names></name>, <name><surname>Moshitch-Moshkovitz</surname><given-names>S</given-names></name>, <name><surname>Dominissini</surname><given-names>D</given-names></name>, <name><surname>Mansour</surname><given-names>AAF</given-names></name>, <name><surname>Kol</surname><given-names>N</given-names></name>, <name><surname>Salmon-Divon</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>m6A mRNA methylation facilitates resolution of naïve pluripotency toward differentiation</article-title>. <source>Science</source>. <year>2015</year>;<volume>347</volume>(<issue>6225</issue>):<fpage>1002</fpage>–<lpage>1006</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1261417</pub-id><?supplied-pmid 25569111?><pub-id pub-id-type="pmid">25569111</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Oerum</surname><given-names>S</given-names></name>, <name><surname>Meynier</surname><given-names>V</given-names></name>, <name><surname>Catala</surname><given-names>M</given-names></name>, <name><surname>Tisne</surname><given-names>C</given-names></name>. <article-title>A comprehensive review of m6A/m6Am RNA methyltransferase structures</article-title>. <source>Nucleic Acids Research</source>. <year>2021</year>;<volume>49</volume>(<issue>13</issue>):<fpage>7239</fpage>–<lpage>7255</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkab378</pub-id><?supplied-pmid 34023900?><pub-id pub-id-type="pmid">34023900</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Lasman</surname><given-names>L</given-names></name>, <name><surname>Hanna</surname><given-names>JH</given-names></name>, <name><surname>Novershtern</surname><given-names>N</given-names></name>. <article-title>Role of m6 a in embryonic stem cell differentiation and in gametogenesis</article-title>. <source>Epigenomes</source>. <year>2020</year>;<volume>4</volume>(<issue>1</issue>):<fpage>5</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/epigenomes4010005</pub-id><?supplied-pmid 34968239?><pub-id pub-id-type="pmid">34968239</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>T</given-names></name>, <name><surname>Hao</surname><given-names>YJ</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Li</surname><given-names>MM</given-names></name>, <name><surname>Wang</surname><given-names>M</given-names></name>, <name><surname>Han</surname><given-names>W</given-names></name>, <etal>et al</etal>. <article-title>M6A RNA methylation is regulated by microRNAs and promotes reprogramming to pluripotency</article-title>. <source>Cell Stem Cell</source>. <year>2015</year>;<volume>16</volume>(<issue>3</issue>):<fpage>289</fpage>–<lpage>301</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.stem.2015.02.011</pub-id><?supplied-pmid 25683224?><pub-id pub-id-type="pmid">25683224</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>XY</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Zhu</surname><given-names>JS</given-names></name>. <article-title>The role of m6A RNA methylation in human cancer</article-title>. <source>Molecular Cancer</source>. <year>2019</year>;<volume>18</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">30609930</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Lan</surname><given-names>Q</given-names></name>, <name><surname>Liu</surname><given-names>PY</given-names></name>, <name><surname>Haase</surname><given-names>J</given-names></name>, <name><surname>Bell</surname><given-names>JL</given-names></name>, <name><surname>Huttelmaier</surname><given-names>S</given-names></name>, <name><surname>Liu</surname><given-names>T</given-names></name>. <article-title>The critical role of RNA M6A methylation in cancer</article-title>. <source>Cancer Research</source>. <year>2019</year>;<volume>79</volume>(<issue>7</issue>):<fpage>1285</fpage>–<lpage>1292</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1158/0008-5472.CAN-18-2965</pub-id><?supplied-pmid 30894375?><pub-id pub-id-type="pmid">30894375</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Dominissini</surname><given-names>D</given-names></name>, <name><surname>Moshitch-Moshkovitz</surname><given-names>S</given-names></name>, <name><surname>Schwartz</surname><given-names>S</given-names></name>, <name><surname>Salmon-Divon</surname><given-names>M</given-names></name>, <name><surname>Ungar</surname><given-names>L</given-names></name>, <name><surname>Osenberg</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Topology of the human and mouse m 6 A RNA methylomes revealed by m 6 A-seq</article-title>. <source>Nature</source>. <year>2012</year>;<volume>485</volume>(<issue>7397</issue>):<fpage>201</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature11112</pub-id><?supplied-pmid 22575960?><pub-id pub-id-type="pmid">22575960</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Meyer</surname><given-names>KD</given-names></name>, <name><surname>Saletore</surname><given-names>Y</given-names></name>, <name><surname>Zumbo</surname><given-names>P</given-names></name>, <name><surname>Elemento</surname><given-names>O</given-names></name>, <name><surname>Mason</surname><given-names>CE</given-names></name>, <name><surname>Jaffrey</surname><given-names>SR</given-names></name>. <article-title>Comprehensive analysis of mRNA methylation reveals enrichment in 3’ UTRs and near stop codons</article-title>. <source>Cell</source>. <year>2012</year>;<volume>149</volume>(<issue>7</issue>):<fpage>1635</fpage>–<lpage>1646</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2012.05.003</pub-id><?supplied-pmid 22608085?><pub-id pub-id-type="pmid">22608085</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>McIntyre</surname><given-names>ABR</given-names></name>, <name><surname>Gokhale</surname><given-names>NS</given-names></name>, <name><surname>Cerchietti</surname><given-names>L</given-names></name>, <name><surname>Jaffrey</surname><given-names>SR</given-names></name>, <name><surname>Horner</surname><given-names>SM</given-names></name>, <name><surname>Mason</surname><given-names>CE</given-names></name>. <article-title>Limits in the detection of m6A changes using MeRIP/m6A-seq</article-title>. <source>Scientific Reports</source>. <year>2020</year>;<volume>10</volume>(<issue>1</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41598-020-63355-3</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Dierks</surname><given-names>D</given-names></name>, <name><surname>Garcia-Campos</surname><given-names>MA</given-names></name>, <name><surname>Uzonyi</surname><given-names>A</given-names></name>, <name><surname>Safra</surname><given-names>M</given-names></name>, <name><surname>Edelheit</surname><given-names>S</given-names></name>, <name><surname>Rossi</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Multiplexed profiling facilitates robust m6A quantification at site, gene and sample resolution</article-title>. <source>Nature Methods</source>. <year>2021</year>;<volume>18</volume>(<issue>9</issue>):<fpage>1060</fpage>–<lpage>1067</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41592-021-01242-z</pub-id><?supplied-pmid 34480159?><pub-id pub-id-type="pmid">34480159</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>Y</given-names></name>, <name><surname>Chen</surname><given-names>K</given-names></name>, <name><surname>Song</surname><given-names>B</given-names></name>, <name><surname>Ma</surname><given-names>J</given-names></name>, <name><surname>Wu</surname><given-names>X</given-names></name>, <name><surname>Xu</surname><given-names>Q</given-names></name>, <etal>et al</etal>. <article-title>M6A-Atlas: A comprehensive knowledgebase for unraveling the N6-methyladenosine (m6A) epitranscriptome</article-title>. <source>Nucleic Acids Research</source>. <year>2021</year>;<volume>49</volume>(<issue>D1</issue>):<fpage>D134</fpage>–<lpage>D143</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkaa692</pub-id><?supplied-pmid 32821938?><pub-id pub-id-type="pmid">32821938</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Z</given-names></name>, <name><surname>Zhan</surname><given-names>Q</given-names></name>, <name><surname>Eckert</surname><given-names>M</given-names></name>, <name><surname>Zhu</surname><given-names>A</given-names></name>, <name><surname>Chryplewicz</surname><given-names>A</given-names></name>, <name><surname>De Jesus</surname><given-names>DF</given-names></name>, <etal>et al</etal>. <article-title>RADAR: Differential analysis of MeRIP-seq data with a random effect model</article-title>. <source>Genome Biology</source>. <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-019-1915-9</pub-id><?supplied-pmid 31870409?><pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>Z</given-names></name>, <name><surname>Shafik</surname><given-names>AM</given-names></name>, <name><surname>Jin</surname><given-names>P</given-names></name>, <name><surname>Wu</surname><given-names>H</given-names></name>. <article-title>Differential RNA methylation analysis for MeRIP-seq data under general experimental design</article-title>. <source>Bioinformatics (Oxford, England)</source>. <year>2022</year>;<volume>38</volume>(<issue>20</issue>):<fpage>4705</fpage>–<lpage>4712</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btac601</pub-id><?supplied-pmid 36063045?><pub-id pub-id-type="pmid">36063045</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Duan</surname><given-names>D</given-names></name>, <name><surname>Tang</surname><given-names>W</given-names></name>, <name><surname>Wang</surname><given-names>R</given-names></name>, <name><surname>Guo</surname><given-names>Z</given-names></name>, <name><surname>Feng</surname><given-names>H</given-names></name>. <article-title>Evaluation of epitranscriptome-wide N6-methyladenosine differential analysis methods</article-title>. <source>Briefings in Bioinformatics</source>. <year>2023</year>;<volume>24</volume>(<issue>3</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbad139</pub-id><?supplied-pmid 37039682?><pub-id pub-id-type="pmid">37039682</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>H</given-names></name>, <name><surname>Wang</surname><given-names>C</given-names></name>, <name><surname>Wu</surname><given-names>Z</given-names></name>. <article-title>PROPER: Comprehensive power evaluation for differential expression using RNA-seq</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>2</issue>):<fpage>233</fpage>–<lpage>241</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btu640</pub-id><?supplied-pmid 25273110?><pub-id pub-id-type="pmid">25273110</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Niu</surname><given-names>Y</given-names></name>, <name><surname>Zhao</surname><given-names>X</given-names></name>, <name><surname>Wu</surname><given-names>YS</given-names></name>, <name><surname>Li</surname><given-names>MM</given-names></name>, <name><surname>Wang</surname><given-names>XJ</given-names></name>, <name><surname>Yang</surname><given-names>YG</given-names></name>. <article-title>N6-methyl-adenosine (m6A) in RNA: An Old Modification with A Novel Epigenetic Function</article-title>. <source>Genomics, Proteomics and Bioinformatics</source>. <year>2013</year>;<volume>11</volume>(<issue>1</issue>):<fpage>8</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.gpb.2012.12.002</pub-id><?supplied-pmid 23453015?><pub-id pub-id-type="pmid">23453015</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Schwartz</surname><given-names>S</given-names></name>, <name><surname>Mumbach</surname><given-names>MR</given-names></name>, <name><surname>Jovanovic</surname><given-names>M</given-names></name>, <name><surname>Wang</surname><given-names>T</given-names></name>, <name><surname>Maciag</surname><given-names>K</given-names></name>, <name><surname>Bushkin</surname><given-names>GG</given-names></name>, <etal>et al</etal>. <article-title>Perturbation of m6A writers reveals two distinct classes of mRNA methylation at internal and 5’ sites</article-title>. <source>Cell Reports</source>. <year>2014</year>;<volume>8</volume>(<issue>1</issue>):<fpage>284</fpage>–<lpage>296</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.celrep.2014.05.048</pub-id><?supplied-pmid 24981863?><pub-id pub-id-type="pmid">24981863</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Barbieri</surname><given-names>I</given-names></name>, <name><surname>Tzelepis</surname><given-names>K</given-names></name>, <name><surname>Pandolfini</surname><given-names>L</given-names></name>, <name><surname>Shi</surname><given-names>J</given-names></name>, <name><surname>Millán-Zambrano</surname><given-names>G</given-names></name>, <name><surname>Robson</surname><given-names>SC</given-names></name>, <etal>et al</etal>. <article-title>Promoter-bound METTL3 maintains myeloid leukaemia by m6A-dependent translation control</article-title>. <source>Nature</source>. <year>2017</year>;<volume>552</volume>(<issue>7683</issue>):<fpage>126</fpage>–<lpage>131</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature24678</pub-id><?supplied-pmid 29186125?><pub-id pub-id-type="pmid">29186125</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10890765</article-id>
    <article-id pub-id-type="pmid">38346081</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-23-01546</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011875</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Molecular biology techniques</subject>
            <subj-group>
              <subject>Sequencing techniques</subject>
              <subj-group>
                <subject>RNA sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Molecular biology techniques</subject>
          <subj-group>
            <subject>Sequencing techniques</subject>
            <subj-group>
              <subject>RNA sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Chemistry</subject>
          <subj-group>
            <subject>Chemical Reactions</subject>
            <subj-group>
              <subject>Methylation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Research Design</subject>
          <subj-group>
            <subject>Experimental Design</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Data</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>High Throughput Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>High Throughput Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Cell biology</subject>
          <subj-group>
            <subject>Chromosome biology</subject>
            <subj-group>
              <subject>Chromatin</subject>
              <subj-group>
                <subject>Chromatin modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Epigenetics</subject>
            <subj-group>
              <subject>Chromatin</subject>
              <subj-group>
                <subject>Chromatin modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>Chromatin</subject>
              <subj-group>
                <subject>Chromatin modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>DNA</subject>
            <subj-group>
              <subject>DNA modification</subject>
              <subj-group>
                <subject>DNA methylation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>DNA</subject>
              <subj-group>
                <subject>DNA modification</subject>
                <subj-group>
                  <subject>DNA methylation</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Epigenetics</subject>
            <subj-group>
              <subject>DNA modification</subject>
              <subj-group>
                <subject>DNA methylation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>DNA modification</subject>
              <subj-group>
                <subject>DNA methylation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Transcriptome Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Transcriptome Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">magpie</italic>: A power evaluation method for differential RNA methylation analysis in N6-methyladenosine sequencing</article-title>
      <alt-title alt-title-type="running-head">Power evaluation in differential RNA methylation analysis</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Guo</surname>
          <given-names>Zhenxing</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Duan</surname>
          <given-names>Daoyu</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3710-9029</contrib-id>
        <name>
          <surname>Tang</surname>
          <given-names>Wen</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Julia</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bush</surname>
          <given-names>William S.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5986-2260</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Liangliang</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaofeng</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jin</surname>
          <given-names>Fulai</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2243-9949</contrib-id>
        <name>
          <surname>Feng</surname>
          <given-names>Hao</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>School of Data Science, The Chinese University of Hong Kong, Shenzhen (CUHK-Shenzhen), Shenzhen, Guangdong, China</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Population and Quantitative Health Sciences, Case Western Reserve University, Cleveland, Ohio, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Hathaway Brown School, Shaker Heights, Ohio, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Genetics and Genome Sciences, Case Western Reserve University, Cleveland, Ohio, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ziemann</surname>
          <given-names>Mark</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Burnet Institute, AUSTRALIA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>hxf155@case.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <volume>20</volume>
    <issue>2</issue>
    <elocation-id>e1011875</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 Guo et al</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Guo et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1011875.pdf"/>
    <abstract>
      <p>Recently, novel biotechnologies to quantify RNA modifications became an increasingly popular choice for researchers who study epitranscriptome. When studying RNA methylations such as N6-methyladenosine (m<sup>6</sup>A), researchers need to make several decisions in its experimental design, especially the sample size and a proper statistical power. Due to the complexity and high-throughput nature of m<sup>6</sup>A sequencing measurements, methods for power calculation and study design are still currently unavailable. In this work, we propose a statistical power assessment tool, <italic toggle="yes">magpie</italic>, for power calculation and experimental design for epitranscriptome studies using m<sup>6</sup>A sequencing data. Our simulation-based power assessment tool will borrow information from real pilot data, and inspect various influential factors including sample size, sequencing depth, effect size, and basal expression ranges. We integrate two modules in <italic toggle="yes">magpie</italic>: (i) a flexible and realistic simulator module to synthesize m<sup>6</sup>A sequencing data based on real data; and (ii) a power assessment module to examine a set of comprehensive evaluation metrics.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Sample size and sequencing depth are two essential quantitative factors determined prior to high throughput sequencing experiments, for statistical power maximization with limited budget. Due to the complex structure of data from m<sup>6</sup>A RNA methylation sequencing, analytical derivations for both quantities remain challenging in experimental designs. In response to this challenge, we propose a simulation-based statistical framework, together with a user-friendly R/Bioconductor package <italic toggle="yes"><bold>magpie</bold></italic>, to comprehensively assess the power of the differential m<sup>6</sup>A methylation detection at varied sample sizes, effect sizes, baseline expression levels, and sequencing depths. Using in-silico synthetic data that mimic real data well, <italic toggle="yes"><bold>magpie</bold></italic> provides several major evaluation metrics to assist users in study design and statistical power evaluation.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100008136</institution-id>
            <institution>Case Western Reserve University</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2243-9949</contrib-id>
          <name>
            <surname>Feng</surname>
            <given-names>Hao</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This research was partially supported by the intramural funding from Case Western Reserve University awarded to HF, and the intramural funding UDF01002936 awarded to ZG from The Chinese University of Hong Kong, Shenzhen (CUHK-Shenzhen). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="1"/>
      <page-count count="13"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2024-02-23</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The proposed power assessment tool magpie is publicly available as a R/Bioconductor package at: <ext-link xlink:href="https://bioconductor.org/packages/magpie/" ext-link-type="uri">https://bioconductor.org/packages/magpie/</ext-link>. The simulation tutorial with instructions is available at <ext-link xlink:href="https://github.com/dxd429/magieSims" ext-link-type="uri">https://github.com/dxd429/magieSims</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The proposed power assessment tool magpie is publicly available as a R/Bioconductor package at: <ext-link xlink:href="https://bioconductor.org/packages/magpie/" ext-link-type="uri">https://bioconductor.org/packages/magpie/</ext-link>. The simulation tutorial with instructions is available at <ext-link xlink:href="https://github.com/dxd429/magieSims" ext-link-type="uri">https://github.com/dxd429/magieSims</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>RNA methylation represents another layer of epigenetic regulation in addition to the well-studied DNA methylation and histone modification. Among different types of RNA methylation, N6-methyladenosine, i.e. m<sup>6</sup>A, is the most common form. It has been identified as one of the post-transcriptional regulatory markers on mRNA, rRNA, tRNA, circRNA, miRNA and long-noncoding RNA, and plays important roles in regulating pre-RNA splicing, RNA translation, stability, and degradation [<xref rid="pcbi.1011875.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1011875.ref003" ref-type="bibr">3</xref>]. The effects of m<sup>6</sup>A suggest its involvement in multiple cellular processes such as cell differentiation and reprogramming [<xref rid="pcbi.1011875.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1011875.ref005" ref-type="bibr">5</xref>]. Studies also suggest linkages between the dysregulation of m<sup>6</sup>A and many human diseases such as cancers and neural disorders [<xref rid="pcbi.1011875.ref002" ref-type="bibr">2</xref>, <xref rid="pcbi.1011875.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1011875.ref007" ref-type="bibr">7</xref>].</p>
    <p>MeRIP-seq/m<sup>6</sup>A-seq was developed to characterize transcriptome-wide m<sup>6</sup>A profiles [<xref rid="pcbi.1011875.ref008" ref-type="bibr">8</xref>, <xref rid="pcbi.1011875.ref009" ref-type="bibr">9</xref>]. This technique typically relies on immunoprecipitation of m<sup>6</sup>A-containing RNA fragments (m<sup>6</sup>A-IP), followed by high-throughput next generation sequencing. These samples are generally referred to as the IP (immunoprecipitated) samples. In addition to IP samples, cDNA libraries are also prepared for input control mRNAs to measure the background mRNA abundance. These input controls are essentially the transcriptome from regular RNA-seq. The m<sup>6</sup>A methylation level, for each region, is then quantified by the enrichment of IP over input, roughly the normalized ratio between IP and input control counts. If the m<sup>6</sup>A enrichment is significantly high, then the called peak of that region suggests an underlying m<sup>6</sup>A residue. MeRIP-seq is becoming a popular and indispensable tool to profile transcriptome-wide m<sup>6</sup>A, since the invention of this technique. One feature of MeRIP-seq is that, it immunoprecipitates each IP sample independently, which can potentially induce technical variabilities. Such technical artifacts lead to erroneous peak calling of methylated regions. This problem becomes prominent in studies with small sample sizes [<xref rid="pcbi.1011875.ref010" ref-type="bibr">10</xref>], which is often the case given the high expenses associated with the current experimental protocols. As an improved alternative, in m<sup>6</sup>A-seq2 [<xref rid="pcbi.1011875.ref011" ref-type="bibr">11</xref>], a single IP experiment is performed on the pooled RNAs of all samples, where RNAs from different samples are uniquely barcoded and demultiplexed after sequencing. The multiplexed profiling procedure by m<sup>6</sup>A-seq2 is expected to be widely applied to interrogate the distribution and functional consequences of m<sup>6</sup>A.</p>
    <p>To study the biological implications of m<sup>6</sup>A, one fundamental task is to identify the Differentially Methylated Regions (DMRs) across different conditions. Although several DMR detection methods have been developed [<xref rid="pcbi.1011875.ref012" ref-type="bibr">12</xref>–<xref rid="pcbi.1011875.ref014" ref-type="bibr">14</xref>] and evaluated [<xref rid="pcbi.1011875.ref015" ref-type="bibr">15</xref>] in either MeRIP-seq or m<sup>6</sup>A-seq2 experiments, the sample size calculation with their associated statistical power remains an open question due to the complexities of sequencing experiments. Further, due to the uniqueness in data structure, power analysis tools developed for other types of analyses such as Differential Expression (DE) gene detection from RNA-seq cannot be applied to MeRIP-seq and m<sup>6</sup>A-seq2 experiments. First, data simulated for power assessment in DE gene detection from RNA-seq are barely equivalent to the input control data alone. No statistical model is available to generate their matched IP counts. Second, the effect size of methylation in m<sup>6</sup>A data analysis is based on the ratios of IP/input, not the input data alone. Therefore, the count coverage of each gene may affect power and other metrics in a way differing from that in DE analyses. Additionally, the impact of baseline expression of each gene and sequencing depth of the whole sample on the power of DMR detection are also unignorable. Therefore, an appropriate power analysis tool specifically for epitranscriptome studies is needed, especially with its increasing popularity. To our best knowledge, no method is currently available.</p>
    <p>Here, we propose a comprehensive power evaluation method named <italic toggle="yes"><bold>magpie</bold></italic> (<bold><underline>m</underline></bold><sup>6</sup><bold><underline>A</underline></bold>
<bold>g</bold>enome-wide differential analysis <bold><underline>p</underline></bold>ower <bold><underline>i</underline></bold>nferenc<bold><underline>e</underline></bold>). <italic toggle="yes"><bold>magpie</bold></italic> first learns characteristics of real data, and then synthesizes data that mimics the real data well. In simulations, <italic toggle="yes"><bold>magpie</bold></italic> allows for the adjustment of sample size, sequencing depth and effect size. It can evaluate the epitranscriptome study design using multiple metrics including sensitivity, specificity, precision, false discovery rate, and more. Building upon these functionalities, <italic toggle="yes"><bold>magpie</bold></italic> fills in the knowledge gap by providing a comprehensive biostatistical tool for statistical power evaluation, sample size calculation, and data analysis planning, which are almost always required in general experimental designs. This makes it the first available tool to guide the practical experimental design by comprehensively investigating the relationship between statistical metrics and associated factors in m<sup>6</sup>A differential analysis. <italic toggle="yes"><bold>magpie</bold></italic> is publicly available as an R/Bioconductor package at <ext-link xlink:href="https://bioconductor.org/packages/magpie/" ext-link-type="uri">https://bioconductor.org/packages/magpie/</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>An overview of <italic toggle="yes">magpie</italic></title>
      <p>We assess the effect of experimental design on the power of DMR detection purely based on simulations, where the whole procedure is divided into two components. First, <italic toggle="yes"><bold>magpie</bold></italic> preprocesses <italic toggle="yes">.bam</italic> files from MeRIP-seq sequencing and obtains read counts in candidate regions from all samples (<xref rid="pcbi.1011875.g001" ref-type="fig">Fig 1</xref>), where candidates are identified with conditional binomial tests. With the counts from the identified candidate regions, <italic toggle="yes"><bold>magpie</bold></italic> simulates count matrices for both IP and Input samples with a Gamma-Poisson model. Parameters involved are estimated from the candidates to mimic the actual MeRIP-seq data in aspects of marginal distribution read counts, and the distribution of biological dispersion in methylation levels (<xref rid="pcbi.1011875.g001" ref-type="fig">Fig 1</xref>). With data simulated, we then evaluate power and error rates on them (<xref rid="pcbi.1011875.g001" ref-type="fig">Fig 1</xref>). The two components, Gamma-Poisson simulation and power assessment, are independent so that <italic toggle="yes"><bold>magpie</bold></italic> allows the assessment on data by different simulation strategies.</p>
      <fig position="float" id="pcbi.1011875.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overview of <italic toggle="yes">magpie</italic>.</title>
          <p><italic toggle="yes"><bold>magpie</bold></italic> provides power evaluation for differential m<sup>6</sup>A methylation analysis. It takes pilot MeRIP-seq data as the input. Based on the pilot data, it obtains candidate regions, estimates key parameters, and conducts real-data-based simulations for statistical power evaluation.</p>
        </caption>
        <graphic xlink:href="pcbi.1011875.g001" position="float"/>
      </fig>
    </sec>
    <sec id="sec004">
      <title>Data generative model</title>
      <p>Here we describe how <italic toggle="yes"><bold>magpie</bold></italic> simulates the MeRIP-seq count matrices given existing real MeRIP-seq data from different conditions. <italic toggle="yes"><bold>magpie</bold></italic> processes <italic toggle="yes">.bam</italic> files by splitting the transcriptome into bins, aggregating read counts, and testing for significance of IP enrichment over Input. Using a bump-finding algorithm, significant bins are combined into candidate regions. <italic toggle="yes"><bold>magpie</bold></italic> then focus on these candidates in simulations, as other regions lack IP enrichment and biological relevance. Suppose there are in total <italic toggle="yes">N</italic> pairs of IP and Input samples from all conditions, and <italic toggle="yes">M</italic> candidate DMRs generated after preprocessing. Let <italic toggle="yes">X</italic><sub><italic toggle="yes">ij</italic></sub> and <italic toggle="yes">Y</italic><sub><italic toggle="yes">ij</italic></sub> denote input and IP counts in candidate DMR <italic toggle="yes">i</italic> from sample <italic toggle="yes">j</italic>. We assume that <inline-formula id="pcbi.1011875.e001"><alternatives><graphic xlink:href="pcbi.1011875.e001.jpg" id="pcbi.1011875.e001g" position="anchor"/><mml:math id="M1" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e002"><alternatives><graphic xlink:href="pcbi.1011875.e002.jpg" id="pcbi.1011875.e002g" position="anchor"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Similarly, <inline-formula id="pcbi.1011875.e003"><alternatives><graphic xlink:href="pcbi.1011875.e003.jpg" id="pcbi.1011875.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e004"><alternatives><graphic xlink:href="pcbi.1011875.e004.jpg" id="pcbi.1011875.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Here <inline-formula id="pcbi.1011875.e005"><alternatives><graphic xlink:href="pcbi.1011875.e005.jpg" id="pcbi.1011875.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>x</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e006"><alternatives><graphic xlink:href="pcbi.1011875.e006.jpg" id="pcbi.1011875.e006g" position="anchor"/><mml:math id="M6" display="inline" overflow="scroll"><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>y</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> represent the normalizing factors for input and IP samples, such as the library sizes. <inline-formula id="pcbi.1011875.e007"><alternatives><graphic xlink:href="pcbi.1011875.e007.jpg" id="pcbi.1011875.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e008"><alternatives><graphic xlink:href="pcbi.1011875.e008.jpg" id="pcbi.1011875.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> are normalized poisson rates. <inline-formula id="pcbi.1011875.e009"><alternatives><graphic xlink:href="pcbi.1011875.e009.jpg" id="pcbi.1011875.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1011875.e010"><alternatives><graphic xlink:href="pcbi.1011875.e010.jpg" id="pcbi.1011875.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, and <italic toggle="yes">θ</italic><sub><italic toggle="yes">i</italic></sub> are the shape and scale parameters of corresponding gamma distributions. Given above assumptions, naturally <inline-formula id="pcbi.1011875.e011"><alternatives><graphic xlink:href="pcbi.1011875.e011.jpg" id="pcbi.1011875.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Further, denote <inline-formula id="pcbi.1011875.e012"><alternatives><graphic xlink:href="pcbi.1011875.e012.jpg" id="pcbi.1011875.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1011875.e013"><alternatives><graphic xlink:href="pcbi.1011875.e013.jpg" id="pcbi.1011875.e013g" position="anchor"/><mml:math id="M13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, then marginally,
<disp-formula id="pcbi.1011875.e014"><alternatives><graphic xlink:href="pcbi.1011875.e014.jpg" id="pcbi.1011875.e014g" position="anchor"/><mml:math id="M14" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <p>In above equations, <italic toggle="yes">μ</italic><sub><italic toggle="yes">ij</italic></sub> and <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">ij</italic></sub> represent the mean and dispersion of the methylation level for candidate region <italic toggle="yes">i</italic> in sample <italic toggle="yes">j</italic>.</p>
      <p>We begin by simulating size factors, for which we directly use the values estimated from real data:
<disp-formula id="pcbi.1011875.e015"><alternatives><graphic xlink:href="pcbi.1011875.e015.jpg" id="pcbi.1011875.e015g" position="anchor"/><mml:math id="M15" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic toggle="yes">x</italic><sub><italic toggle="yes">bj</italic></sub> and <italic toggle="yes">y</italic><sub><italic toggle="yes">bj</italic></sub> are read counts in bin <italic toggle="yes">b</italic> from the <italic toggle="yes">j</italic>th Input and IP samples.</p>
      <p>Next, for each candidate region <italic toggle="yes">i</italic>, <italic toggle="yes"><bold>magpie</bold></italic> simulates a baseline methylation level <italic toggle="yes">μ</italic><sub><italic toggle="yes">i</italic></sub> or equivalently <inline-formula id="pcbi.1011875.e016"><alternatives><graphic xlink:href="pcbi.1011875.e016.jpg" id="pcbi.1011875.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:math></alternatives></inline-formula> in the structure of <inline-formula id="pcbi.1011875.e017"><alternatives><graphic xlink:href="pcbi.1011875.e017.jpg" id="pcbi.1011875.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> where <italic toggle="yes">Z</italic><sub><italic toggle="yes">j</italic></sub> contains the attributes of sample <italic toggle="yes">j</italic>, and <italic toggle="yes">β</italic><sub><italic toggle="yes">i</italic></sub> represents corresponding coefficient. To do that, we randomly sample <italic toggle="yes">α</italic><sub><italic toggle="yes">i</italic></sub> from one parametric distribution, or from its empirical distribution estimated from real data. Distributions of <inline-formula id="pcbi.1011875.e018"><alternatives><graphic xlink:href="pcbi.1011875.e018.jpg" id="pcbi.1011875.e018g" position="anchor"/><mml:math id="M18" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>’s from five MeRIP-seq datasets are presented in Fig D in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>.</p>
      <p>After simulating the baseline methylation, we simulate <inline-formula id="pcbi.1011875.e019"><alternatives><graphic xlink:href="pcbi.1011875.e019.jpg" id="pcbi.1011875.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:msubsup><mml:mi>β</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> for all regions. Because we can hardly know the actual number of DMRs and their degree of differential methylation, specific settings are adopted based on both reasonable assumptions and empirical observations. First, <italic toggle="yes"><bold>magpie</bold></italic> sets the proportion of DMRs as 10%, assuming that DM is present in only a small subset of regions in most experiments. Then, for non-DMRs, <italic toggle="yes">β</italic><sub><italic toggle="yes">i</italic></sub> = 0. For DMR <italic toggle="yes">i</italic>, <inline-formula id="pcbi.1011875.e020"><alternatives><graphic xlink:href="pcbi.1011875.e020.jpg" id="pcbi.1011875.e020g" position="anchor"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> if its estimated effect size <inline-formula id="pcbi.1011875.e021"><alternatives><graphic xlink:href="pcbi.1011875.e021.jpg" id="pcbi.1011875.e021g" position="anchor"/><mml:math id="M21" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is greater than the 50% quantile of all regions. Otherwise, <italic toggle="yes">β</italic><sub><italic toggle="yes">i</italic></sub> ∼ <italic toggle="yes">U</italic>(1, 2). Here, <inline-formula id="pcbi.1011875.e022"><alternatives><graphic xlink:href="pcbi.1011875.e022.jpg" id="pcbi.1011875.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> are directly derived from real pilot data, using the DMR detection method TRESS.</p>
      <p>The dispersion has been shown to be substantial across several real datasets, which justifies the necessity of its modeling (Fig F in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>). We can simulate it again from a parametric distribution or sample from empirical distributions. To ensure the robustness, the empirical distribution can be estimated by TRESS from raw counts or by Beta-binomial regressions from normalized counts. Denote <inline-formula id="pcbi.1011875.e023"><alternatives><graphic xlink:href="pcbi.1011875.e023.jpg" id="pcbi.1011875.e023g" position="anchor"/><mml:math id="M23" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e024"><alternatives><graphic xlink:href="pcbi.1011875.e024.jpg" id="pcbi.1011875.e024g" position="anchor"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> as the normalized IP and total counts, the Beta-Binomial regressions are established as follows:
<disp-formula id="pcbi.1011875.e025"><alternatives><graphic xlink:href="pcbi.1011875.e025.jpg" id="pcbi.1011875.e025g" position="anchor"/><mml:math id="M25" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mtext>logit</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>z</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic toggle="yes">μ</italic><sub><italic toggle="yes">ij</italic></sub> and <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">i</italic></sub> represent the mean and dispersion of methylation level. As noted, for the convenience of estimation, above Beta-binomial regressions (as well as TRESS) assume <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">ij</italic></sub> = <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">i</italic></sub> for all <italic toggle="yes">j</italic>.</p>
      <p>Empirically for the same real dataset, <inline-formula id="pcbi.1011875.e026"><alternatives><graphic xlink:href="pcbi.1011875.e026.jpg" id="pcbi.1011875.e026g" position="anchor"/><mml:math id="M26" display="inline" overflow="scroll"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> estimated by the Negative-binomial model in TRESS are usually greater than those estimated by Beta-binomial regressions. Without golden truth, our setting for <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">i</italic></sub> relies on a data driven approach. Specifically, by comparing to the real data, <italic toggle="yes"><bold>magpie</bold></italic> will calculate a KL-divergence for each of the synthetic counts by model in (<xref rid="pcbi.1011875.e014" ref-type="disp-formula">1</xref>). Those <inline-formula id="pcbi.1011875.e027"><alternatives><graphic xlink:href="pcbi.1011875.e027.jpg" id="pcbi.1011875.e027g" position="anchor"/><mml:math id="M27" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> resulting in a significantly lower KL divergence between simulated data and real data will be kept for final data generation. If there is no significant difference in KL-divergence, <inline-formula id="pcbi.1011875.e028"><alternatives><graphic xlink:href="pcbi.1011875.e028.jpg" id="pcbi.1011875.e028g" position="anchor"/><mml:math id="M28" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> estimated by NB will be adopted.</p>
      <p>Lastly, we simulate the scale parameter <italic toggle="yes">θ</italic><sub><italic toggle="yes">i</italic></sub> in (<xref rid="pcbi.1011875.e014" ref-type="disp-formula">1</xref>). Again, it can be simulated by parametric distributions, or sampled directly from empirical distributions. For the parametric distribution, we set its mean as a function of <italic toggle="yes">ϕ</italic><sub><italic toggle="yes">i</italic></sub> observed in the previous peak detection method [<xref rid="pcbi.1011875.ref014" ref-type="bibr">14</xref>]. No matter the strategy employed, the first-round generated <inline-formula id="pcbi.1011875.e029"><alternatives><graphic xlink:href="pcbi.1011875.e029.jpg" id="pcbi.1011875.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> will be further scaled by the fold change between real and first-round simulated counts. Such an adjustment again helps to reduce the disparity between the simulated and real distributions, thereby improving the reliability of the results in follow-up power assessments.</p>
    </sec>
    <sec id="sec005">
      <title>DMR detection</title>
      <p>After generating the simulated read counts in candidate DMRs, an existing software developed for MeRIP-seq is applied to detect DMRs. We implement an interface for calling TRESS and exomePeak2. Each method reports test statistics, <italic toggle="yes">p</italic>-values and FDRs for all candidate regions. These results are then used for the downstream power assessment. Users also have the option to adopt other DMR detection methods for their own evaluation, by following our simulation tutorial with detail instructions at <ext-link xlink:href="https://github.com/dxd429/magieSims" ext-link-type="uri">https://github.com/dxd429/magieSims</ext-link>. This resource enables users to conduct their own analyses using the synthetic data generated by our simulation and evaluation framework.</p>
    </sec>
    <sec id="sec006">
      <title>Power assessment measures</title>
      <p>We adopted several evaluation metrics in the statistical power assessment for differential analysis using MeRIP-seq data. These metrics include classic criteria in hypothesis testings such as the false discovery rate (FDR), power, and precision. We also inspected the false discovery cost (FDC, defined below) and targeted power [<xref rid="pcbi.1011875.ref016" ref-type="bibr">16</xref>], aiming to provide a comprehensive statistical power evaluation.</p>
      <p>Because not all DMRs are of biological interest to us, especially those with low effect sizes, we introduce a cutoff Δ for the effect size <italic toggle="yes">β</italic>. Only those DMRs with |<italic toggle="yes">β</italic>|≥Δ are considered as ‘targeted DMRs’, which are of biological interest in research. We denote the number of non-DMRs, non-targeted DMRs, and targeted DMRs as <italic toggle="yes">R</italic><sub>0</sub>, <italic toggle="yes">R</italic><sub>1</sub>, and <italic toggle="yes">R</italic><sub>2</sub>, respectively. Suppose <italic toggle="yes">T</italic><sub><italic toggle="yes">r</italic></sub> represents the testing result of region <italic toggle="yes">r</italic>, where <italic toggle="yes">T</italic><sub><italic toggle="yes">r</italic></sub> = 1 denotes the discovered DMR, and <italic toggle="yes">T</italic><sub><italic toggle="yes">r</italic></sub> = 0 otherwise. The confusion matrix in the DMR detection is summarized in <xref rid="pcbi.1011875.t001" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="pcbi.1011875.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>The confusion matrix in m<sup>6</sup>A DMR detection, when taking biological significance into consideration.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011875.t001" id="pcbi.1011875.t001g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="2" colspan="1">Simulated True</th>
                <th align="center" colspan="2" rowspan="1">Testing Result</th>
                <th align="center" rowspan="2" colspan="1">Total</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1"><italic toggle="yes">T</italic><sub><italic toggle="yes">r</italic></sub> = 0</th>
                <th align="center" rowspan="1" colspan="1"><italic toggle="yes">T</italic><sub><italic toggle="yes">r</italic></sub> = 1</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">Non-DMR</td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">N</italic>
                  <sub>0</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">P</italic>
                  <sub>0</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">R</italic>
                  <sub>0</sub>
                </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Non-targeted DMR (0 &lt; |<italic toggle="yes">β</italic>|&lt;Δ)</td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">N</italic>
                  <sub>1</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">P</italic>
                  <sub>1</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">R</italic>
                  <sub>1</sub>
                </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Targeted DMR (|<italic toggle="yes">β</italic>|≥Δ)</td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">N</italic>
                  <sub>2</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">P</italic>
                  <sub>2</sub>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">R</italic>
                  <sub>2</sub>
                </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Total</td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">N</italic>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">P</italic>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">R</italic>
                </td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The false discovery rate (FDR) and precision are statistical metrics that jointly provide insights into the balance between true and false discoveries among the significant features. In this context, FDR and precision are defined as <inline-formula id="pcbi.1011875.e030"><alternatives><graphic xlink:href="pcbi.1011875.e030.jpg" id="pcbi.1011875.e030g" position="anchor"/><mml:math id="M30" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>P</mml:mi></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1011875.e031"><alternatives><graphic xlink:href="pcbi.1011875.e031.jpg" id="pcbi.1011875.e031g" position="anchor"/><mml:math id="M31" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mi>P</mml:mi></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, respectively. Statistical power is defined, naturally, as <inline-formula id="pcbi.1011875.e032"><alternatives><graphic xlink:href="pcbi.1011875.e032.jpg" id="pcbi.1011875.e032g" position="anchor"/><mml:math id="M32" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. To investigate the power of detecting targeted DMRs that are biologically interesting with |<italic toggle="yes">β</italic>|≥Δ, targeted power is introduced and defined as <inline-formula id="pcbi.1011875.e033"><alternatives><graphic xlink:href="pcbi.1011875.e033.jpg" id="pcbi.1011875.e033g" position="anchor"/><mml:math id="M33" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. To better illustrate the trade-off between false positives and true positives, we propose an additional metric, False Discovery Cost (FDC), <inline-formula id="pcbi.1011875.e034"><alternatives><graphic xlink:href="pcbi.1011875.e034.jpg" id="pcbi.1011875.e034g" position="anchor"/><mml:math id="M34" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, which is defined as the expected number of false positives per targeted true positive. The rationale behind this is straightforward: this cost is the expected number of false discoveries, per true discovery we are interested in.</p>
      <p>Finally, our proposed evaluation framework allows for the examination of aforementioned metrics using simulations under various combinations of sample size, sequencing depth, input expression stratum, and FDR threshold. Each user-defined scenario is repeated for 100 times, and these metrics are computed and averaged to generate empirical estimations.</p>
    </sec>
    <sec id="sec007">
      <title>Implementation</title>
      <p>Given a MeRIP-seq dataset in <italic toggle="yes">.bam</italic> files, various experimental scenarios (such as sample size, sequencing depth, FDR threshold, etc.), and a chosen differential methylation testing method, <italic toggle="yes"><bold>magpie</bold></italic> generates evaluation results for each proposed study design. Functions incorporated in <italic toggle="yes"><bold>magpie</bold></italic> allow users to export these results in an <italic toggle="yes">.xlsx</italic> file, and to visualize them through line plots. Users have the option to provide small pilot data, which could include only several chromosomes. We would estimate major parameters from these pilot data, to guide larger-scale simulations for power evaluation for future experimental designs. Alternatively, when pilot MeRIP-seq datasets are unavailable or unattainable, the function <italic toggle="yes">quickPower</italic> can produce power evaluation results within seconds. This is achieved by directly extracting our in-house evaluation results based on three public N6-methyladenosine datasets on GEO as the pilot data [<xref rid="pcbi.1011875.ref017" ref-type="bibr">17</xref>–<xref rid="pcbi.1011875.ref019" ref-type="bibr">19</xref>]. Our package also comes with a vignette that provides thorough instructions and examples of its applications in differential analysis experimental design on N6-methyladenosine.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec008">
    <title>Results</title>
    <sec id="sec009">
      <title>Larger sample size benefits DMR detection</title>
      <p>Under simulation settings outlined in Simulation Settings in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>, we next examine the relationship between sample size and power in DMR detection, given that determining sample size is a primary objective in our method. We adopt sample sizes of 2, 3, 5, 7, and 10 per group, and nominal FDR values of 0.05, 0.1, 0.15, and 0.2, both of which are common choices in MeRIP-seq experiments. Note that we have validated our synthetic data against the pilot data, ensuring that our strategy effectively captures the characteristics of real data (Fig G in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>). The empirical results for major metrics are shown in <xref rid="pcbi.1011875.g002" ref-type="fig">Fig 2</xref>. Grouped by sample size and nominal FDR level, power, targeted power, FDC, and FDR averaged over 100 simulations are shown in <xref rid="pcbi.1011875.g002" ref-type="fig">Fig 2A–2D</xref>. For a fixed sample size, metrics like power, FDC, and FDR diminish under lower FDR thresholds. This occurs as lower FDR values lead to greater stringency, which in turn reduces false positives. The power will drop, as expected, when using stringent FDRs. As sample size increases, these differences become smaller, particularly for statistical power (<xref rid="pcbi.1011875.g002" ref-type="fig">Fig 2A</xref>). Here, power remains consistently high across all FDR levels with 7 and 10 replicates per group. This highlights the benefit of using a larger sample size that helps detect DMRs with limited effect sizes, where a type II error would often occur when the sample size is small. Such trend is observed consistently when using different pilot data (Fig A in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>). At the same time, these results give researchers the knowledge to optimize the sample size based on their budgets. Using <xref rid="pcbi.1011875.g002" ref-type="fig">Fig 2A</xref> as an example, a power around 0.8 is achieved with 7 samples per group, and sample size of 7 is considered large in current MeRIP-seq studies. The benefit of expanding the sample size to 10 is marginal, but the associated costs could be significantly higher.</p>
      <fig position="float" id="pcbi.1011875.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Statistical power evaluation metrics for DMR detection, at various sample sizes and FDR thresholds.</title>
          <p>(<bold>A</bold>) Power versus sample size, with each line presenting one FDR cutoff. (<bold>B</bold>)-(<bold>D</bold>) Similar to (<bold>A</bold>) but for other metrics: targeted power, FDC, and FDR. Targeted power and FDC are computed for DMRs with |<italic toggle="yes">β</italic>|≥2. Each point on the line plots is an averaged value over N = 100 simulations based on real MeRIP-seq data.</p>
        </caption>
        <graphic xlink:href="pcbi.1011875.g002" position="float"/>
      </fig>
    </sec>
    <sec id="sec010">
      <title>Impact of baseline expression values</title>
      <p>It is useful for researchers to understand the effects of heterogeneity in baseline expression levels in DMR detection. In MeRIP-seq data, the basal expression level is represented by input control read counts, thus we stratify power metrics by input control ranges. Six strata are obtained based on following quantiles of mean input counts: stratum 1 (0%-10%), stratum 2 (10%-30%), stratum 3 (30%-50%), stratum 4 (50%-70%), stratum 5 (70%-90%), and stratum 6 (90%-100%). At a nominal FDR of 0.05, the average targeted power and FDC for the six strata are shown in <xref rid="pcbi.1011875.g003" ref-type="fig">Fig 3A and 3B</xref>. Overall, reduced targeted power is observed in the lower strata, a trend that is more evident when sample sizes are small. This is expected, as true differences in low-expressed regions are often obscured by noise, making DMRs harder to detect. A limited sample size further exacerbates this issue. This suggests the potential benefits of increasing the sequencing depth, particularly when biological replicates are limited and more samples are hard to obtain. Here, relatively low strata will enjoy the benefit of more drastic power improvement. Interestingly, higher FDCs are reported in the upper strata, suggesting that more false positives are detected per true discovery in these highly expressed regions. However, this trend diminishes with increasing sample size. Given that these metrics were computed across various simulation scenarios, we further explore the variability of the results, using visualizations within a specific stratum and sample size in <xref rid="pcbi.1011875.g003" ref-type="fig">Fig 3C–3F</xref>. With elevated sample sizes, there is reduced variability in both targeted power and FDC (<xref rid="pcbi.1011875.g003" ref-type="fig">Fig 3C and 3D</xref>). This is not surprising since it is more likely to capture the true dispersion with more replicates, leading to more consistent power estimates. However, this trend is not observed across the strata at a fixed sample size, suggesting the benefit of increasing sample size over sequencing depth for more reliable inferences. Under a fixed sample size (<xref rid="pcbi.1011875.g003" ref-type="fig">Fig 3E and 3F</xref>), an upward trend is observed across the strata for both targeted power and FDC. This trend aligns with the observations in <xref rid="pcbi.1011875.g003" ref-type="fig">Fig 3A and 3B</xref>, though some variability is evident. A heatmap panel is also available to illustrate the stratified results (Fig C in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>).</p>
      <fig position="float" id="pcbi.1011875.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Targeted power and FDC stratified by mean input values for DMRs with |<italic toggle="yes">β</italic>|≥2.</title>
          <p>Six strata are defined based on input count data quantiles: stratum 1 (0%, 10%), stratum 2 (10%, 30%), stratum 3 (30%, 50%), stratum 4 (50%, 70%), stratum 5 (70%, 90%), and stratum 6 (90%, 100%). A nominal FDR value of 0.05 is used to define significance. (<bold>A</bold>), (<bold>B</bold>) Mean targeted power and FDC along strata. Each line represents one sample size choice. (<bold>C</bold>), (<bold>D</bold>) Targeted power and FDC distributions in stratum 3, separated by sample size. (<bold>E</bold>), (<bold>F</bold>) Targeted power and FDC distributions with 5 replicates per group, stratified by mean input count values. N = 100 simulations are conducted.</p>
        </caption>
        <graphic xlink:href="pcbi.1011875.g003" position="float"/>
      </fig>
    </sec>
    <sec id="sec011">
      <title>Consistency among major DMR calling methods</title>
      <p>It is worth noting that the targeted power and FDC presented in the Results section are computed for DMRs with odds ratios (OR) exceeding Δ = 2, using TRESS. To evaluate the fluctuations of these two metrics across various effect sizes (OR), sample sizes and DMR detection methods, we also consider Δ values of 1.5, 2, 4, 6, 8, and 10, for TRESS, exomePeak2, and RADAR. In <xref rid="pcbi.1011875.g004" ref-type="fig">Fig 4</xref>, the targeted power and FDC are plotted against the sample size and are grouped by odds ratio thresholds. At all sample sizes, there is an increased targeted power (<xref rid="pcbi.1011875.g004" ref-type="fig">Fig 4A, 4C and 4E</xref>) and a higher FDC to identify DMRs with a larger odds ratio. Specifically, for FDC (<xref rid="pcbi.1011875.g004" ref-type="fig">Fig 4B, 4D and 4F</xref>), substantially higher values are observed among DMRs with exceptionally large odds ratios (Δ = 8, 10). This indicates that detecting DMRs with these large ORs might lead to a significant increase in false positives. These patterns hold true for TRESS, exomePeak2, RADAR. While all three methods show improvements in targeted power with added replicates across all odds ratio thresholds, a discrepancy is noted for FDC that it tends to increase with larger sample sizes when using exomePeak2 and RADAR. This discrepancy, however, is not universally observed when applying our proposed framework to different pilot data sets (Fig B in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>). Further examinations have been conducted to explore the choices of OR on the balance between sensitivity and specificity, as well as the trade-off between precision and recall (Fig E in <xref rid="pcbi.1011875.s001" ref-type="supplementary-material">S1 Appendix</xref>). These findings highlight the importance of utilizing the users’ designated DMR detection methods during power calculation to ensure accurate estimations.</p>
      <fig position="float" id="pcbi.1011875.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Comparing power evaluation results between major DMR detection methods TRESS (A)-(B) and exomePeak2 (C)-(D).</title>
          <p>Targeted power and FDC are shown at various Odds Ratios (OR, representing effect size) and sample sizes. A nominal FDR value of 0.05 is used to define significance. Points on the line plots are averaged over N = 100 simulations.</p>
        </caption>
        <graphic xlink:href="pcbi.1011875.g004" position="float"/>
      </fig>
    </sec>
    <sec id="sec012">
      <title>Impact of sequencing depth</title>
      <p>As shown previously, sequencing depth is another critical factor in MeRIP-seq study design. Building upon our analysis of sequencing coverage strata, here we examine another aspect of sequencing depth by introducing a “depth factor”. This is a relative ratio to reflect the effect to enlarge or down-sample the sequencing coverage of the pilot data. As illustrated in <xref rid="pcbi.1011875.g005" ref-type="fig">Fig 5A</xref>, the targeted power rises with increased sequencing depth in all sample sizes. The incremental gain from increasing sequencing depth diminishes at high depths or large sample sizes, but benefits the small sample size the most. In <xref rid="pcbi.1011875.g005" ref-type="fig">Fig 5B</xref> for FDC, a similar pattern is observed as in the stratified analysis: FDCs increase with sequencing depth, but stabilize in scenarios with larger sample sizes. We also provide an integrated visualization in <xref rid="pcbi.1011875.g005" ref-type="fig">Fig 5C</xref>, presenting targeted power and FDC in the same panel, aiding users in understanding the tradeoffs between them. Researchers could consult similar figures, generated by <italic toggle="yes"><bold>magpie</bold></italic> using their own pilot data, to select a customized increase in sequencing depth to achieve the desired power.</p>
      <fig position="float" id="pcbi.1011875.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011875.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Sequencing depth affects targeted power and FDC for DMRs with |<italic toggle="yes">β</italic>|≥2.</title>
          <p>The ‘depth factor’ is the relative ratio of the new dataset’s library size over that from the original dataset. It reflects the impact of enlarging or down-sampling the sequencing depth of pilot data. (<bold>A</bold>), (<bold>B</bold>) Targeted power and FDC under different sequencing depths, grouped by sample size. (<bold>C</bold>) Joint visualization of the mean targeted power and FDC, over various sequencing depths and sample sizes. N = 100 simulations are conducted. The average sequencing depths of ‘Input’ and ‘IP’ from the pilot data are 3.51X and 0.54X, respectively.</p>
        </caption>
        <graphic xlink:href="pcbi.1011875.g005" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec013">
    <title>Discussions</title>
    <p>Sample size and power evaluation are pivotal and routine tasks in experimental design using sequencing data. Here we present the first tool to address the immediate needs of sample size calculation and power estimation for DMR detection in MeRIP-seq experiments. Traditionally, sample size calculation or power evaluation in hypothesis testings depends on inputs such as the effect size, variance from pilot studies, and the significance level. In contrast, for MeRIP-seq experiments with transcriptome-wide data, these scalar parameters must be considered as distributions. In addition, the distributions of sequencing depth and input control level can also significantly influence the statistical power, as we have shown in the results. We thus propose a statistically rigorous approach to address all these challenges, and draw information from pilot real data for simulation and empirical power evaluation.</p>
    <p>We have a flexible simulation framework that allows switching models to mimic the real data well. In sequencing studies, data from varied tissues or cell types can exhibit unique expression and RNA methylation distributions across features (i.e. genes or regions). To address this, our tool allows users to provide pilot data analogous to their intended studies, serving as the basis for the estimated and adopted parameters in downstream simulations. To ensure that the simulated data accurately reflects actual data characteristics, <italic toggle="yes"><bold>magpie</bold></italic> can adopt both negative-binomial and beta-binomial models and choose the one that aligns with the real data distributions best.</p>
    <p>Both increased sequencing coverage and a larger sample size can significantly enhance the statistical power, as demonstrated in Results. Given that the total sequencing reads are often predetermined before experiments, researchers can benefit from our tool to optimize the balance between sequencing depth and sample size, to ensure the best possible experimental design in differential RNA methylation studies.</p>
    <p>In our stratified analysis, significantly lower power is observed in regions of low input levels. This suggests the potential of refining the filtering strategy. While excluding low-expressed strata certainly means losing some true positives among these regions, it boosts the power to detect DMRs that are highly expressed, which are often of greater biological interest. Our proposed tool <italic toggle="yes"><bold>magpie</bold></italic> can offer a foresight into the overall power gain, should the researchers want to weigh the tradeoffs before initiating their data analyses.</p>
    <p>Our proposed approach captures real data characteristics, simulates data under various experimental settings, and produces common power evaluation metrices. This statistical framework has been implemented into a user-friendly R/Bioconductor package <italic toggle="yes"><bold>magpie</bold></italic>. The package allows users to save power evaluation results as an Excel file and visualize their relationship with aforementioned factors with line plots. Recognizing that users might not have their own pilot MeRIP-seq data, we also develop a “<italic toggle="yes">quickPower</italic>” function. This function can generate comprehensive power evaluation outputs in seconds, by retrieving pre-calculated results from three published studies. <italic toggle="yes"><bold>magpie</bold></italic> is available at <ext-link xlink:href="https://bioconductor.org/packages/magpie/" ext-link-type="uri">https://bioconductor.org/packages/magpie/</ext-link>.</p>
  </sec>
  <sec id="sec014" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1011875.s001" position="float" content-type="local-data">
      <label>S1 Appendix</label>
      <caption>
        <title>Simulation settings and additional results.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1011875.s001.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1011875.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Lu</surname><given-names>Z</given-names></name>, <name><surname>Gomez</surname><given-names>A</given-names></name>, <name><surname>Hon</surname><given-names>GC</given-names></name>, <name><surname>Yue</surname><given-names>Y</given-names></name>, <name><surname>Han</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>N 6-methyladenosine-dependent regulation of messenger RNA stability</article-title>. <source>Nature</source>. <year>2014</year>;<volume>505</volume>(<issue>7481</issue>):<fpage>117</fpage>–<lpage>120</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature12730</pub-id><?supplied-pmid 24284625?><pub-id pub-id-type="pmid">24284625</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Geula</surname><given-names>S</given-names></name>, <name><surname>Moshitch-Moshkovitz</surname><given-names>S</given-names></name>, <name><surname>Dominissini</surname><given-names>D</given-names></name>, <name><surname>Mansour</surname><given-names>AAF</given-names></name>, <name><surname>Kol</surname><given-names>N</given-names></name>, <name><surname>Salmon-Divon</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>m6A mRNA methylation facilitates resolution of naïve pluripotency toward differentiation</article-title>. <source>Science</source>. <year>2015</year>;<volume>347</volume>(<issue>6225</issue>):<fpage>1002</fpage>–<lpage>1006</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1261417</pub-id><?supplied-pmid 25569111?><pub-id pub-id-type="pmid">25569111</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Oerum</surname><given-names>S</given-names></name>, <name><surname>Meynier</surname><given-names>V</given-names></name>, <name><surname>Catala</surname><given-names>M</given-names></name>, <name><surname>Tisne</surname><given-names>C</given-names></name>. <article-title>A comprehensive review of m6A/m6Am RNA methyltransferase structures</article-title>. <source>Nucleic Acids Research</source>. <year>2021</year>;<volume>49</volume>(<issue>13</issue>):<fpage>7239</fpage>–<lpage>7255</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkab378</pub-id><?supplied-pmid 34023900?><pub-id pub-id-type="pmid">34023900</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Lasman</surname><given-names>L</given-names></name>, <name><surname>Hanna</surname><given-names>JH</given-names></name>, <name><surname>Novershtern</surname><given-names>N</given-names></name>. <article-title>Role of m6 a in embryonic stem cell differentiation and in gametogenesis</article-title>. <source>Epigenomes</source>. <year>2020</year>;<volume>4</volume>(<issue>1</issue>):<fpage>5</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/epigenomes4010005</pub-id><?supplied-pmid 34968239?><pub-id pub-id-type="pmid">34968239</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>T</given-names></name>, <name><surname>Hao</surname><given-names>YJ</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Li</surname><given-names>MM</given-names></name>, <name><surname>Wang</surname><given-names>M</given-names></name>, <name><surname>Han</surname><given-names>W</given-names></name>, <etal>et al</etal>. <article-title>M6A RNA methylation is regulated by microRNAs and promotes reprogramming to pluripotency</article-title>. <source>Cell Stem Cell</source>. <year>2015</year>;<volume>16</volume>(<issue>3</issue>):<fpage>289</fpage>–<lpage>301</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.stem.2015.02.011</pub-id><?supplied-pmid 25683224?><pub-id pub-id-type="pmid">25683224</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>XY</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Zhu</surname><given-names>JS</given-names></name>. <article-title>The role of m6A RNA methylation in human cancer</article-title>. <source>Molecular Cancer</source>. <year>2019</year>;<volume>18</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">30609930</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Lan</surname><given-names>Q</given-names></name>, <name><surname>Liu</surname><given-names>PY</given-names></name>, <name><surname>Haase</surname><given-names>J</given-names></name>, <name><surname>Bell</surname><given-names>JL</given-names></name>, <name><surname>Huttelmaier</surname><given-names>S</given-names></name>, <name><surname>Liu</surname><given-names>T</given-names></name>. <article-title>The critical role of RNA M6A methylation in cancer</article-title>. <source>Cancer Research</source>. <year>2019</year>;<volume>79</volume>(<issue>7</issue>):<fpage>1285</fpage>–<lpage>1292</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1158/0008-5472.CAN-18-2965</pub-id><?supplied-pmid 30894375?><pub-id pub-id-type="pmid">30894375</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Dominissini</surname><given-names>D</given-names></name>, <name><surname>Moshitch-Moshkovitz</surname><given-names>S</given-names></name>, <name><surname>Schwartz</surname><given-names>S</given-names></name>, <name><surname>Salmon-Divon</surname><given-names>M</given-names></name>, <name><surname>Ungar</surname><given-names>L</given-names></name>, <name><surname>Osenberg</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Topology of the human and mouse m 6 A RNA methylomes revealed by m 6 A-seq</article-title>. <source>Nature</source>. <year>2012</year>;<volume>485</volume>(<issue>7397</issue>):<fpage>201</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature11112</pub-id><?supplied-pmid 22575960?><pub-id pub-id-type="pmid">22575960</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Meyer</surname><given-names>KD</given-names></name>, <name><surname>Saletore</surname><given-names>Y</given-names></name>, <name><surname>Zumbo</surname><given-names>P</given-names></name>, <name><surname>Elemento</surname><given-names>O</given-names></name>, <name><surname>Mason</surname><given-names>CE</given-names></name>, <name><surname>Jaffrey</surname><given-names>SR</given-names></name>. <article-title>Comprehensive analysis of mRNA methylation reveals enrichment in 3’ UTRs and near stop codons</article-title>. <source>Cell</source>. <year>2012</year>;<volume>149</volume>(<issue>7</issue>):<fpage>1635</fpage>–<lpage>1646</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2012.05.003</pub-id><?supplied-pmid 22608085?><pub-id pub-id-type="pmid">22608085</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>McIntyre</surname><given-names>ABR</given-names></name>, <name><surname>Gokhale</surname><given-names>NS</given-names></name>, <name><surname>Cerchietti</surname><given-names>L</given-names></name>, <name><surname>Jaffrey</surname><given-names>SR</given-names></name>, <name><surname>Horner</surname><given-names>SM</given-names></name>, <name><surname>Mason</surname><given-names>CE</given-names></name>. <article-title>Limits in the detection of m6A changes using MeRIP/m6A-seq</article-title>. <source>Scientific Reports</source>. <year>2020</year>;<volume>10</volume>(<issue>1</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41598-020-63355-3</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Dierks</surname><given-names>D</given-names></name>, <name><surname>Garcia-Campos</surname><given-names>MA</given-names></name>, <name><surname>Uzonyi</surname><given-names>A</given-names></name>, <name><surname>Safra</surname><given-names>M</given-names></name>, <name><surname>Edelheit</surname><given-names>S</given-names></name>, <name><surname>Rossi</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Multiplexed profiling facilitates robust m6A quantification at site, gene and sample resolution</article-title>. <source>Nature Methods</source>. <year>2021</year>;<volume>18</volume>(<issue>9</issue>):<fpage>1060</fpage>–<lpage>1067</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41592-021-01242-z</pub-id><?supplied-pmid 34480159?><pub-id pub-id-type="pmid">34480159</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>Y</given-names></name>, <name><surname>Chen</surname><given-names>K</given-names></name>, <name><surname>Song</surname><given-names>B</given-names></name>, <name><surname>Ma</surname><given-names>J</given-names></name>, <name><surname>Wu</surname><given-names>X</given-names></name>, <name><surname>Xu</surname><given-names>Q</given-names></name>, <etal>et al</etal>. <article-title>M6A-Atlas: A comprehensive knowledgebase for unraveling the N6-methyladenosine (m6A) epitranscriptome</article-title>. <source>Nucleic Acids Research</source>. <year>2021</year>;<volume>49</volume>(<issue>D1</issue>):<fpage>D134</fpage>–<lpage>D143</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkaa692</pub-id><?supplied-pmid 32821938?><pub-id pub-id-type="pmid">32821938</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Z</given-names></name>, <name><surname>Zhan</surname><given-names>Q</given-names></name>, <name><surname>Eckert</surname><given-names>M</given-names></name>, <name><surname>Zhu</surname><given-names>A</given-names></name>, <name><surname>Chryplewicz</surname><given-names>A</given-names></name>, <name><surname>De Jesus</surname><given-names>DF</given-names></name>, <etal>et al</etal>. <article-title>RADAR: Differential analysis of MeRIP-seq data with a random effect model</article-title>. <source>Genome Biology</source>. <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-019-1915-9</pub-id><?supplied-pmid 31870409?><pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>Z</given-names></name>, <name><surname>Shafik</surname><given-names>AM</given-names></name>, <name><surname>Jin</surname><given-names>P</given-names></name>, <name><surname>Wu</surname><given-names>H</given-names></name>. <article-title>Differential RNA methylation analysis for MeRIP-seq data under general experimental design</article-title>. <source>Bioinformatics (Oxford, England)</source>. <year>2022</year>;<volume>38</volume>(<issue>20</issue>):<fpage>4705</fpage>–<lpage>4712</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btac601</pub-id><?supplied-pmid 36063045?><pub-id pub-id-type="pmid">36063045</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Duan</surname><given-names>D</given-names></name>, <name><surname>Tang</surname><given-names>W</given-names></name>, <name><surname>Wang</surname><given-names>R</given-names></name>, <name><surname>Guo</surname><given-names>Z</given-names></name>, <name><surname>Feng</surname><given-names>H</given-names></name>. <article-title>Evaluation of epitranscriptome-wide N6-methyladenosine differential analysis methods</article-title>. <source>Briefings in Bioinformatics</source>. <year>2023</year>;<volume>24</volume>(<issue>3</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbad139</pub-id><?supplied-pmid 37039682?><pub-id pub-id-type="pmid">37039682</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>H</given-names></name>, <name><surname>Wang</surname><given-names>C</given-names></name>, <name><surname>Wu</surname><given-names>Z</given-names></name>. <article-title>PROPER: Comprehensive power evaluation for differential expression using RNA-seq</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>2</issue>):<fpage>233</fpage>–<lpage>241</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btu640</pub-id><?supplied-pmid 25273110?><pub-id pub-id-type="pmid">25273110</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Niu</surname><given-names>Y</given-names></name>, <name><surname>Zhao</surname><given-names>X</given-names></name>, <name><surname>Wu</surname><given-names>YS</given-names></name>, <name><surname>Li</surname><given-names>MM</given-names></name>, <name><surname>Wang</surname><given-names>XJ</given-names></name>, <name><surname>Yang</surname><given-names>YG</given-names></name>. <article-title>N6-methyl-adenosine (m6A) in RNA: An Old Modification with A Novel Epigenetic Function</article-title>. <source>Genomics, Proteomics and Bioinformatics</source>. <year>2013</year>;<volume>11</volume>(<issue>1</issue>):<fpage>8</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.gpb.2012.12.002</pub-id><?supplied-pmid 23453015?><pub-id pub-id-type="pmid">23453015</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Schwartz</surname><given-names>S</given-names></name>, <name><surname>Mumbach</surname><given-names>MR</given-names></name>, <name><surname>Jovanovic</surname><given-names>M</given-names></name>, <name><surname>Wang</surname><given-names>T</given-names></name>, <name><surname>Maciag</surname><given-names>K</given-names></name>, <name><surname>Bushkin</surname><given-names>GG</given-names></name>, <etal>et al</etal>. <article-title>Perturbation of m6A writers reveals two distinct classes of mRNA methylation at internal and 5’ sites</article-title>. <source>Cell Reports</source>. <year>2014</year>;<volume>8</volume>(<issue>1</issue>):<fpage>284</fpage>–<lpage>296</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.celrep.2014.05.048</pub-id><?supplied-pmid 24981863?><pub-id pub-id-type="pmid">24981863</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011875.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Barbieri</surname><given-names>I</given-names></name>, <name><surname>Tzelepis</surname><given-names>K</given-names></name>, <name><surname>Pandolfini</surname><given-names>L</given-names></name>, <name><surname>Shi</surname><given-names>J</given-names></name>, <name><surname>Millán-Zambrano</surname><given-names>G</given-names></name>, <name><surname>Robson</surname><given-names>SC</given-names></name>, <etal>et al</etal>. <article-title>Promoter-bound METTL3 maintains myeloid leukaemia by m6A-dependent translation control</article-title>. <source>Nature</source>. <year>2017</year>;<volume>552</volume>(<issue>7683</issue>):<fpage>126</fpage>–<lpage>131</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature24678</pub-id><?supplied-pmid 29186125?><pub-id pub-id-type="pmid">29186125</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
