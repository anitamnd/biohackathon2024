<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8317115</article-id>
    <article-id pub-id-type="pmid">33471072</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab021</article-id>
    <article-id pub-id-type="publisher-id">btab021</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">lgpr:</italic> an interpretable non-parametric method for inferring covariate effects from longitudinal data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2341-6765</contrib-id>
        <name>
          <surname>Timonen</surname>
          <given-names>Juho</given-names>
        </name>
        <xref rid="btab021-cor1" ref-type="corresp"/>
        <aff><institution>Department of Computer Science, Aalto University</institution>, Espoo 00076, <country country="FI">Finland</country></aff>
        <!--juho.timonen@aalto.fi-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mannerström</surname>
          <given-names>Henrik</given-names>
        </name>
        <aff><institution>Department of Computer Science, Aalto University</institution>, Espoo 00076, <country country="FI">Finland</country></aff>
        <!--juho.timonen@aalto.fi-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vehtari</surname>
          <given-names>Aki</given-names>
        </name>
        <aff><institution>Department of Computer Science, Aalto University</institution>, Espoo 00076, <country country="FI">Finland</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Lähdesmäki</surname>
          <given-names>Harri</given-names>
        </name>
        <xref rid="btab021-cor1" ref-type="corresp"/>
        <aff><institution>Department of Computer Science, Aalto University</institution>, Espoo 00076, <country country="FI">Finland</country></aff>
        <!--harri.lahdesmaki@aalto.fi-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Martelli</surname>
          <given-names>Pier Luigi</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab021-cor1">To whom correspondence should be addressed. <email>juho.timonen@aalto.fi</email> or <email>harri.lahdesmaki@aalto.fi</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-01-21">
      <day>21</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>13</issue>
    <fpage>1860</fpage>
    <lpage>1867</lpage>
    <history>
      <date date-type="received">
        <day>02</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>07</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>08</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab021.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Longitudinal study designs are indispensable for studying disease progression. Inferring covariate effects from longitudinal data, however, requires interpretable methods that can model complicated covariance structures and detect non-linear effects of both categorical and continuous covariates, as well as their interactions. Detecting disease effects is hindered by the fact that they often occur rapidly near the disease initiation time, and this time point cannot be exactly observed. An additional challenge is that the effect magnitude can be heterogeneous over the subjects.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present <italic toggle="yes">lgpr</italic>, a widely applicable and interpretable method for non-parametric analysis of longitudinal data using additive Gaussian processes. We demonstrate that it outperforms previous approaches in identifying the relevant categorical and continuous covariates in various settings. Furthermore, it implements important novel features, including the ability to account for the heterogeneity of covariate effects, their temporal uncertainty, and appropriate observation models for different types of biomedical data. The <italic toggle="yes">lgpr</italic> tool is implemented as a comprehensive and user-friendly R-package.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><italic toggle="yes">lgpr</italic> is available at <ext-link xlink:href="http://jtimonen.github.io/lgpr-usage" ext-link-type="uri">jtimonen.github.io/lgpr-usage</ext-link> with documentation, tutorials, test data and code for reproducing the experiments of this article.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Academy of Finland</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002341</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>292660</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Biomedical studies often collect observational longitudinal data, where the same individuals are measured at several time points. This is an important study design for examining disease development and has been extensively leveraged in biomedical studies, including various -omics studies, such as proteomics (<xref rid="btab021-B15" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2018</xref>), metagenomics (<xref rid="btab021-B29" ref-type="bibr">Vatanen et al., 2016</xref>) and single-cell transcriptomics (<xref rid="btab021-B25" ref-type="bibr">Sharma et al., 2018</xref>). The measured response variable of interest can be continuous (such as the abundance of a protein), discrete (such as the number of sequencing reads in a genomic region) or binary (such as patient condition). Often also several additional variables—i.e. covariates—are measured for each subject at each measurement time point. These can be categorical variables (such as sex, location or whether the subject is diagnosed with a disease or not) or continuous (such as age, time from disease initiation or blood pressure). Identifying the relevant covariates that affect the response variable is important for assessing potential risk factors of the disease and for understanding disease pathogenesis.</p>
    <p>A large body of literature has focused on the statistical analysis of longitudinal data (<xref rid="btab021-B5" ref-type="bibr">Diggle et al., 2002</xref>). Observations corresponding to the same individual are intercorrelated, and specialized statistical methods are therefore required. Methods must be able to model both time-dependent and static covariate effects at the same time and handle irregular measurement intervals, missing data and a varying number of measurements for different individuals. Generalized linear mixed models (GLMMs) (<xref rid="btab021-B27" ref-type="bibr">Stroup, 2012</xref>) have been found to best conform to these challenges, and they have become the standard workhorse for longitudinal data analysis. The R-package <italic toggle="yes">lme4</italic> (<xref rid="btab021-B1" ref-type="bibr">Bates et al., 2015</xref>) has gained high popularity and become a default choice for fitting GLMMs. These models, however, require specifying a parametric (linear) form for the covariate effects and provide biased inferences when their true effects are non-linear or non-stationary.</p>
    <p>GLMMs are an example of additive models, where the modelled function is decomposed as <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and each <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> depends only on a subset of the covariates. The term generalized additive models (<xref rid="btab021-B10" ref-type="bibr">Hastie and Tibshirani, 1986</xref>) (GAMs) is often used to refer to models where each <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> depends only on one covariate. GAMs are especially interpretable since the effect of each covariate can be studied independently (<xref rid="btab021-B19" ref-type="bibr">Plate, 1999</xref>). Examples of non-parametric GAMs are penalized smoothing splines, and their fitting involves penalizing the wiggliness of the functions (<xref rid="btab021-B31" ref-type="bibr">Wood, 2006</xref>).</p>
    <p>A Gaussian process (GP) is a popular Bayesian non-parametric model that is commonly used for time series modelling (<xref rid="btab021-B22" ref-type="bibr">Rasmussen and Williams, 2006</xref>; <xref rid="btab021-B23" ref-type="bibr">Roberts et al., 2013</xref>). GPs can model various types of functions, and the prior knowledge about the modelled unknown function is conveniently specified by a covariance (or kernel) function. For example, the exponentiated quadratic (EQ) kernel specifies that the function values are more similar for observations that are closer in time, and the periodic (PER) kernel specifies a repeating pattern.</p>
    <p>In additive GPs (<xref rid="btab021-B6" ref-type="bibr">Duvenaud et al., 2011</xref>; <xref rid="btab021-B19" ref-type="bibr">Plate, 1999</xref>), the GP prior is defined for several additive components <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and they can be tailored also for longitudinal study designs (<xref rid="btab021-B4" ref-type="bibr">Cheng et al., 2019</xref>; <xref rid="btab021-B20" ref-type="bibr">Quintana et al., 2016</xref>). <italic toggle="yes">LonGP</italic> (<xref rid="btab021-B4" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic>, 2019</xref>) is a recent additive GP modelling method that utilizes kernels that can depend not only on time, but possibly categorical factors and other covariates as well. It utilizes the binary mask (BIN) and categorical (CAT) kernel as building blocks, as they can be multiplied with continuous kernels such as EQ or PER to allow modelling effects that are present only for a subgroup of individuals, or effects that are different across individuals or groups. LonGP is specifically designed for detecting relevant covariates, and it employs a two-stage forward search with approximate leave-one-out and stratified cross-validation to add new additive components to an initial model one by one until the model does not improve significantly anymore. Due to computational convenience, GP models such as <italic toggle="yes">LonGP</italic> are often restricted to Gaussian observation model, which is not appropriate for count or proportion data commonly observed in biomedicine. A common approach is to use the Gaussian observation model after first applying a variance-stabilizing transform, such as log-transform, to the response variable, but this is not statistically justified and can lead to biased inferences (<xref rid="btab021-B16" ref-type="bibr">O’Hara and Kotze, 2010</xref>).</p>
    <p>Longitudinal studies often comprise a case and control group, and commonly a clinically determined time of disease initiation for each case individual is marked in the data. To reveal phenomena related to disease progression or to identify biomarkers, statistical modelling can utilize the disease-related age, i.e. time from disease initiation or onset, as one covariate that can explain changes in the response variable. Disease effects can be rapid when compared to other effects and expected to occur near the time of disease initiation, which is another aspect that GLM models cannot capture. In <italic toggle="yes">LonGP</italic>, these effects can be modelled using a non-stationary (NS) kernel. A major challenge, however, is that many diseases, such as Type 1 Diabetes (T1D), are heterogeneous (<xref rid="btab021-B17" ref-type="bibr">Pietropaolo et al., 2007</xref>), and disease-specific biomarkers are likely detectable only in a subset of the diagnosed individuals. Another problem that can confound the analysis of disease effects, is that the disease initiation (or onset) time is difficult to determine exactly. For example in T1D, the presence of islet cell autoantibodies in the blood is the earliest known marker of disease initiation (<xref rid="btab021-B32" ref-type="bibr">Ziegler et al., 2013</xref>), but they can only be measured when the subject visits a doctor. In general, the detected disease initiation time can differ from the true initiation time, and the extent of this difference can vary across individuals. To our knowledge, there exist no methods that can model non-stationary disease effects while taking into account the disease heterogeneity and uncertainty of initiation time.</p>
    <p>In this work, we propose a longitudinal data analysis method called <italic toggle="yes">lgpr</italic>, designed for revealing general non-linear and non-stationary effects of individual covariates and their interactions (see <xref rid="btab021-F1" ref-type="fig">Fig. 1a</xref>). It is based on the additive GP approach similar to <italic toggle="yes">LonGP</italic> but provides several significant improvements that tackle the challenges stated above. We use special interaction kernels that allow separating category effects (e.g. different temporal profiles for male and female subjects) from shared effects. This allows us to develop a straightforward but useful covariate relevance assessment method, which requires fitting only one model and gives estimates of the proportion of variance explained by each signal component and noise. Our package implements additive GP modelling and covariate relevance assessment also in the case of a non-Gaussian observation model and allows incorporating sample normalization factors that account for technical effects commonly present for example in RNA-sequencing data. Additionally, our tool can account for uncertainty in the disease effect time and features a novel kernel that allows identification of heterogeneous effects detectable only in a subset of individuals. For increased interpretability of disease effects, we propose a new variance masking (VM) kernel which separates effects related to disease development from the baseline difference between case and control individuals.</p>
    <fig position="float" id="btab021-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Overview of additive Gaussian process modelling of longitudinal data using <italic toggle="yes">lgpr</italic>. (<bold>a</bold>) A typical workflow with <italic toggle="yes">lgpr</italic>. <italic toggle="yes">1.</italic> User gives the data and model formula as input, along with possible additional modelling options such as non-default parameter priors or a discrete observation model. <italic toggle="yes">2.</italic> The model is fitted by sampling the posterior distribution of its parameters. <italic toggle="yes">3.</italic> Relevances of different covariates and interaction terms are computed. The inferred signal components can be visualized to study the magnitude and temporal aspects of different covariate effects. If a heterogeneous model component was specified, the results inform how strongly each individual experiences the effect. (<bold>b</bold>) Examples of different types of covariate effects that can be modelled using <italic toggle="yes">lgpr</italic>. The components <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> are draws from different Gaussian process priors. This artificial data comprises 8 individuals (4 male, 4 female), and 2 individuals of each sex are cases. The shown age-dependent components are a shared age effect <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, a sex-specific deviation <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> from the shared age effect, a disease-related age (<italic toggle="yes">diseaseAge</italic>) effect <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and a subject-specific deviation <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> from the shared age effect. For each of the diseased individuals, the disease initiation occurs at a slightly different age, between 20 and 40 months. Here, the magnitude of the disease effect is equal for each case individual, but <italic toggle="yes">lgpr</italic> can model also heterogeneous effects. The component <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is a function of blood pressure only, but is plotted against age for consistency as the simulated blood pressure variable has a temporal trend. (<bold>c</bold>) The cumulative effect <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is the sum of the low-dimensional components</p>
      </caption>
      <graphic xlink:href="btab021f1" position="float"/>
    </fig>
    <p>We have implemented <italic toggle="yes">lgpr</italic> as a user-friendly R-package (<xref rid="btab021-B21" ref-type="bibr">R Core Team, 2018</xref>) that can be used as a plug-in replacement for <italic toggle="yes">lme4</italic>. Under the hood, Bayesian model inference is carried out using the dynamic Hamiltonian Monte Carlo sampler (<xref rid="btab021-B2" ref-type="bibr">Betancourt, 2017</xref>; <xref rid="btab021-B11" ref-type="bibr">Hoffman and Gelman, 2014</xref>), as implemented in the high-performance statistical computation framework Stan (<xref rid="btab021-B3" ref-type="bibr">Carpenter et al., 2017</xref>). The new tool is summarized in <xref rid="btab021-F1" ref-type="fig">Figure 1a</xref>, and its improvements over <italic toggle="yes">LonGP</italic> are highlighted in <xref rid="btab021-T1" ref-type="table">Table 1</xref>. More background information and related research can be found in Supplementary Material.</p>
    <table-wrap position="float" id="btab021-T1">
      <label>Table 1.</label>
      <caption>
        <p>Key differences between <italic toggle="yes">lgpr</italic> and <italic toggle="yes">LonGP</italic></p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1">
              <italic toggle="yes">lgpr</italic>
            </th>
            <th rowspan="1" colspan="1"><italic toggle="yes">LonGP</italic> (<xref rid="btab021-B4" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic>, 2019</xref>)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Available kernels</td>
            <td rowspan="1" colspan="1">BIN, CAT, ZS, EQ, NS (parameterized warping), VM</td>
            <td rowspan="1" colspan="1">BIN, CAT, EQ, PER, NS (fixed warping)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Available observation models</td>
            <td rowspan="1" colspan="1">Gaussian, Poisson, NB, binomial, BB</td>
            <td rowspan="1" colspan="1">Gaussian</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Bayesian inference</td>
            <td rowspan="1" colspan="1">Dynamic HMC</td>
            <td rowspan="1" colspan="1">Slice sampling and CCD (<xref rid="btab021-B28" ref-type="bibr">Vanhatalo <italic toggle="yes">et al.</italic>, 2013</xref>)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Heterogeneous effects</td>
            <td rowspan="1" colspan="1">Available</td>
            <td rowspan="1" colspan="1">Not available</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Covariate uncertainty</td>
            <td rowspan="1" colspan="1">Available</td>
            <td rowspan="1" colspan="1">Not available</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Covariate relevance assessment</td>
            <td rowspan="1" colspan="1">Decomposition of variance</td>
            <td rowspan="1" colspan="1">Stepwise model search with crossvalidation</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <p><italic toggle="yes">Note</italic>: Kernel name abbreviations: BIN, binary mask; CAT, categorical; ZS, zero-sum; EQ, exponentiated quadratic; NS, non-stationary; VM, variance mask; PER, periodic. The input warping steepness (<italic toggle="yes">a</italic> in <xref rid="E3" ref-type="disp-formula">Equation 3</xref>) is fixed in <italic toggle="yes">LonGP</italic> but sampled in <italic toggle="yes">lgpr</italic>.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>We use simulated data to prove the benefit of each new feature of our method. Additionally, we use <italic toggle="yes">lgpr</italic> to analyse data from two recent T1D studies. The first one is a longitudinal proteomics dataset (<xref rid="btab021-B15" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2018</xref>) and the second one is RNA-sequencing data from peripheral blood cells (<xref rid="btab021-B12" ref-type="bibr">Kallionpää et al., 2019</xref>).</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 The probabilistic model</title>
      <p>We denote a longitudinal dataset with <italic toggle="yes">N</italic> data points and <italic toggle="yes">D</italic> covariates by a tuple <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <bold><italic toggle="yes">X</italic></bold> is an <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> covariate matrix and <bold><italic toggle="yes">y</italic></bold> is a vector of <italic toggle="yes">N</italic> response variable measurements. We refer to the <italic toggle="yes">i</italic>th row of <bold><italic toggle="yes">X</italic></bold> by <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">X</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">X</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>×</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>D</mml:mi></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the set of possible values for covariate <italic toggle="yes">d</italic>. In general, <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> can be discrete, such as the set of individual identifiers, or connected such as <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mi mathvariant="double-struck">R</mml:mi></mml:math></inline-formula> for (normalized) age.</p>
      <p>Our model involves an unobserved signal <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo>:</mml:mo><mml:mi mathvariant="script">X</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></inline-formula>, which is a function of the covariates. The signal is linked to <bold><italic toggle="yes">y</italic></bold> through a likelihood function, motivated by a statistical observation model for <bold><italic toggle="yes">y</italic></bold>, and uses transformed signal values <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">g</italic> is a link function and <italic toggle="yes">c<sub>i</sub></italic> are possible additional scaling factors. We have implemented inference under Gaussian, Poisson, binomial, beta binomial (BB) and negative binomial (NB) likelihoods, and they are defined in detail in Supplementary Material.</p>
      <p>The process <italic toggle="yes">f</italic> is assumed to consist of <italic toggle="yes">J</italic> low-dimensional additive components, so that <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (see <xref rid="btab021-F1" ref-type="fig">Fig. 1b and c</xref>). Each component <italic toggle="yes">j</italic> is modelled as a Gaussian process (GP) with zero mean function and kernel function <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This means that the vector of function values <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>⊤</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> has a multivariate normal prior <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with zero mean vector and <italic toggle="yes">N </italic>×<italic toggle="yes"> N</italic> covariance matrix with entries <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Because the components are <italic toggle="yes">a priori</italic> independent, the sum <italic toggle="yes">f</italic> is also a zero-mean Gaussian process with kernel <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>′</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:msubsup><mml:mo>α</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold">′</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula>. See more info about GPs in Supplementary Material or (<xref rid="btab021-B22" ref-type="bibr">Rasmussen and Williams, 2006</xref>).</p>
      <p>The parameter <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is called the marginal variance of component <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and it determines how largely the component varies. The base kernel function <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>′</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> on the other hand determines the component’s shape, as well as covariance structure over individuals or groups (see <xref rid="btab021-F1" ref-type="fig">Fig. 1b and c</xref>). The base kernels are constructed, as explained in the next section, so that each <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula> is a function of only one or two covariates. This is a sensible assumption in many real-world applications and apt to learn long-range structures in the data (<xref rid="btab021-B6" ref-type="bibr">Duvenaud <italic toggle="yes">et al.</italic>, 2011</xref>). Furthermore, this decomposition into additive components allows us to obtain interpretable covariate effects after fitting the model. <xref rid="btab021-B6" ref-type="bibr">Duvenaud <italic toggle="yes">et al.</italic> (2011)</xref> used also higher-order interaction terms (which we could incorporate into our model as well), but they did not study relevances of individual covariates, as high-order interactions inherently confound their interpretation.</p>
    </sec>
    <sec>
      <title>2.2 Kernel functions for longitudinal data</title>
      <sec>
        <label>2.2.1</label>
        <title>Shared effects</title>
        <p>Stationary shared effects of continuous covariates are modelled using the exponentiated quadratic (EQ) kernel <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>eq</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mo>|</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Here, <italic toggle="yes">x</italic> refers to a generic continuous covariate, and each shared effect component has its own lengthscale parameter <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>, which determines how rapidly the component can vary. For example, a shared age effect kernel is <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>eq</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>age</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>age</mml:mtext></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>age</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec>
        <label>2.2.2</label>
        <title>Category effects</title>
        <p>Effects of categorical covariates (such as sex or individual id) can be modelled either as fluctuating category-specific deviations from a shared effect (interaction of a categorical and continuous covariate) or as static category-specific offsets. For a pair of categorical covariate <italic toggle="yes">z</italic> (with <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> categories) and continuous covariate <italic toggle="yes">x</italic>, we use the kernel function 
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>×</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>zerosum</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>eq</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mo>|</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>when modelling the effect of <italic toggle="yes">z</italic> as deviation from the shared effect of <italic toggle="yes">x</italic>. The zero-sum kernel <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>zerosum</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, returns 1 if <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mi>z</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> otherwise. This is similar to the GP ANOVA approach in (<xref rid="btab021-B13" ref-type="bibr">Kaufman and Sain, 2010</xref>). If <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo>:</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>×</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>}</mml:mo><mml:mo>→</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></inline-formula> is modelled using the kernel in <xref rid="E1" ref-type="disp-formula">Equation 1</xref>, the sum <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is always zero for any <italic toggle="yes">t</italic> (see proof in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>). The fact that the sum over categories equals exactly zero for any <italic toggle="yes">t</italic> greatly helps model interpretation as this property separates the effect of the categorical covariate from the shared effect (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref> for illustration). If the effect of <italic toggle="yes">z</italic> is modelled as a batch or group offset, which does not depend on time or other continuous variables, the corresponding kernel function is just <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>zerosum</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Again, <italic toggle="yes">z</italic> refers to a generic categorical covariate.</p>
        <p>We note that the <italic toggle="yes">lgpr</italic> software implementation allows using also the categorical (CAT) kernel in place of <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>zerosum</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, when modelling the effects of categorical covariates. This kernel function returns 1 if its arguments belong to the same category and 0 otherwise.</p>
      </sec>
      <sec>
        <label>2.2.3</label>
        <title>Non-stationary effects</title>
        <p>We use the input warping approach (<xref rid="btab021-B26" ref-type="bibr">Snoek et al., 2014</xref>) to model non-stationary functions <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where most variability occurs near the event <italic toggle="yes">x </italic>=<italic toggle="yes"> </italic>0. The non-stationary kernel is 
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>ns</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>eq</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>→</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">[</mml:mo></mml:mrow></mml:math></inline-formula> is a monotonic non-linear input warping function 
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and the parameter <italic toggle="yes">a</italic> controls the width of the effect window around <italic toggle="yes">x </italic>=<italic toggle="yes"> </italic>0.</p>
      </sec>
      <sec>
        <label>2.2.4</label>
        <title>Disease effects</title>
        <p><xref rid="btab021-B4" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> (2019)</xref> modelled disease effects using the kernel in <xref rid="E2" ref-type="disp-formula">Equation 2</xref> for the disease-related age <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>disAge</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, i.e. time from disease initiation or onset of each individual. Note that for the control subjects, <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>disAge</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is not observed at all. In general, data for a continuous covariate <italic toggle="yes">x</italic> can be missing in part of the observations. In such cases, we adopt the approach of (<xref rid="btab021-B4" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic>, 2019</xref>) and multiply the kernel of <italic toggle="yes">x</italic> with a binary mask (BIN) kernel which returns 0 if either of its arguments is missing and 1 if they are available.</p>
        <p>Whereas this approach can model a non-stationary trend that is only present for the diseased individuals, its drawback is that it can capture effects that are merely a different base level between the diseased and healthy individuals. In order to find effects caused by the disease progression, we design a new kernel 
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>vm</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>vm</mml:mtext></mml:mrow><mml:mi>a</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>vm</mml:mtext></mml:mrow><mml:mi>a</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>ns</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>vm</mml:mtext></mml:mrow><mml:mi>a</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>→</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">[</mml:mo></mml:mrow></mml:math></inline-formula> is a variance mask function that forces the disease component to have zero variance, i.e. the same value for both groups, when <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo>→</mml:mo><mml:mo>−</mml:mo><mml:mo>∞</mml:mo></mml:mrow></mml:math></inline-formula>. We choose to use <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>vm</mml:mtext></mml:mrow><mml:mi>a</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, which means that the allowed amount of variance between these groups rises sigmoidally from 0 to the level determined by the marginal variance parameter, so that the midpoint is at <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>a</mml:mi></mml:mfrac><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>h</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The parameter <italic toggle="yes">h</italic> therefore determines a connection between the regions where the disease component is allowed to vary between the two groups and where it is allowed to vary over time. In our experiments, we use the value <italic toggle="yes">h </italic>=<italic toggle="yes"> </italic>0.025. This means, that 95% of the variation in <italic toggle="yes">ω<sub>a</sub></italic> occurs on the interval <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. The kernels in <xref rid="E2" ref-type="disp-formula">Equations 2</xref> and <xref rid="E4" ref-type="disp-formula">4</xref> combined with the missing value masking, as well as functions drawn from the corresponding GP priors, are illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>.</p>
        <fig position="float" id="btab021-F2">
          <label>Fig. 2.</label>
          <caption>
            <p>Covariate relevance assessment comparison with other methods and demonstration of our method’s scalability. (<bold>a</bold>) Comparison between <italic toggle="yes">lgpr</italic> and linear mixed effect modelling using the <italic toggle="yes">lme4</italic> and <italic toggle="yes">lmerTest</italic> packages. The panels show ROC curves for the problem of classifying covariates as relevant or irrelevant, when the total number of data points is <italic toggle="yes">N </italic>=<italic toggle="yes"> </italic>100, 300 and 600, respectively. (<bold>b</bold>) Comparison against <italic toggle="yes">LonGP</italic>. The bar plots show the fraction of times each covariate was chosen in the final model over 100 simulated datasets. The red underlined text indicates the covariates that were relevant in generating the data. The left panel shows results for 100 datasets that includes the disease-related age (<italic toggle="yes">diseaseAge</italic>) as a relevant covariate. The centre panel shows results for 100 simulations where the disease-related age was not a relevant covariate. The right panel shows distribution of runtimes over the total 200 datasets for both methods. The bar lengths are average runtimes, and the turnstiles indicate runtime standard deviations</p>
          </caption>
          <graphic xlink:href="btab021f2" position="float"/>
        </fig>
      </sec>
      <sec>
        <label>2.2.5</label>
        <title>Heterogeneous effects</title>
        <p>To model effects that have the same effect shape but possibly different magnitude for each individual, we define additional parameters <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>Q</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">Q</italic> is the number of individuals and each <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. Denote <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext>id</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and assume two individuals <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>id</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext>id</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>id</mml:mtext></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mo>′</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext>id</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. An effect is made heterogeneous in magnitude by multiplying its kernel by <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>heter</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>id</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:msub><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mtext>id</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>q</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. For example, to specify a heterogeneous disease effect component, we use the novel kernel 
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>heter</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>id</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:msub><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mtext>id</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>vm</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>disAge</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:msub><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mtext>disAge</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>disAge</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>For heterogeneous disease effects, the number of needed <italic toggle="yes">β</italic> parameters equals the number of only the case individuals.</p>
        <p>In our implementation, the prior for the unknown parameters <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">β</mml:mi></mml:math></inline-formula> is <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where the shape parameters <italic toggle="yes">b</italic><sub>1</sub> and <italic toggle="yes">b</italic><sub>2</sub> can be defined by the user. By default, we set <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>, in which case most of the prior mass is near the extremes 0 and 1 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3c</xref>). This choice is expected to induce sparsity, so that some individuals have close to zero effect magnitude. The posterior distributions of <italic toggle="yes">β<sub>i</sub></italic> can then be used to make inferences about which case individuals are affected by the disease (<italic toggle="yes">β<sub>i</sub></italic> close to 1) and which are not (<italic toggle="yes">β<sub>i</sub></italic> close to 0). The kernel in <xref rid="E5" ref-type="disp-formula">Equation 5</xref> is illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2c</xref>.</p>
        <fig position="float" id="btab021-F3">
          <label>Fig. 3.</label>
          <caption>
            <p>Heterogeneous disease effect modelling with <italic toggle="yes">lgpr</italic> improves detection of effects that are present only for a subset of case individuals. (<bold>a</bold>) ROC curves for covariate relevance assessment using both a heterogeneous and a homogeneous disease model for simulated data with 2, 4, 6 and 8 out of the 8 case individuals affected, respectively. (<bold>b</bold>) Heterogeneous modelling with <italic toggle="yes">lgpr</italic> can reveal the affected individuals. The boxplots show the distributions of the posterior medians of the individual-specific disease effect magnitude parameters <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mtext>id</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>id</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula> over 100 simulated datasets. The box is the interquantile range (<italic toggle="yes">IQR</italic>) between the 25th and 75th percentiles, vertical line inside the box is the 50th percentile and the whiskers extend a distance of at most <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:mn>1.5</mml:mn><mml:mo>·</mml:mo><mml:mi mathvariant="italic">IQR</mml:mi></mml:mrow></mml:math></inline-formula> from the box boundary. Each panel corresponds to the same experiment as the one above it</p>
          </caption>
          <graphic xlink:href="btab021f3" position="float"/>
        </fig>
        <p>We note that the <italic toggle="yes">lgpr</italic> software implementation allows defining also different types of heterogeneous components, by replacing the VM kernel with the EQ or NS kernel in <xref rid="E5" ref-type="disp-formula">Equation 5</xref>, and that multiple heterogeneous components can be included in a model.</p>
      </sec>
      <sec>
        <label>2.2.6</label>
        <title>Temporally uncertain effects</title>
        <p>The presented disease effect modelling approach relies on being able to measure the disease onset or effect time <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for each case individual, since the disease-related age is defined as <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>disAge</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>age</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. In <xref rid="btab021-B4" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> (2019)</xref>, <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was defined as age on the clinically determined disease initiation date, but in general the effect time can differ from it. Our implementation allows Bayesian inference also for the effect times, and can therefore capture effects that for some or all case individuals occur at a different time point than the clinically determined date. The user can set the prior either directly for the effect times <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, or for the difference between the effect time and observed initiation time, <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The first option is suitable if the disease is known to commence at certain age for all individuals. The latter option is useful in a more realistic setting where such information is not available, and it is reasonable to think that the clinically determined initiation time <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is close to the true effect time.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Model inference</title>
      <p>We collect all marginal variances, lengthscales and other possible kernel hyperparameters in a vector <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mtext>kernel</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Parameters of the observation model are denoted by <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and other parameters such as those related to input uncertainty by <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mtext>other</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The collection of all unknown parameters is then <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mtext>kernel</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mtext>obs</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mtext>other</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Under the hood, <italic toggle="yes">lgpr</italic> uses the dynamic Hamiltonian Monte Carlo sampler with multinomial sampling of dynamic length trajectories<xref rid="btab021-B11" ref-type="bibr"> (</xref><xref rid="btab021-B2" ref-type="bibr">Betancourt, 2017</xref>;<xref rid="btab021-B11" ref-type="bibr"> Hoffman and Gelman, 2014</xref>), as implemented in Stan (<xref rid="btab021-B3" ref-type="bibr">Carpenter <italic toggle="yes">et al.</italic>, 2017</xref>), to obtain <italic toggle="yes">S</italic> draws from the posterior distribution of <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:math></inline-formula>. The parameters are given robust priors that normalize model fitting (specified in Supplementary Material), and our software includes prior predictive checks that help in prior validation. Our default prior for the steepness parameter <italic toggle="yes">a</italic> of the input warping function (<xref rid="E3" ref-type="disp-formula">Equation 3</xref>) allows disease effects that occur approximately on a 36 month interval around the disease initiation time. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S3d and e</xref> illustrate the effect of the prior choice for this parameter.</p>
      <p>The remaining unknowns of the model are the values of the function components <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and their sum <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Under the Gaussian observation model, the posterior distributions of <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <bold><italic toggle="yes">f</italic></bold> can be derived analytically (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>). With other observation models, we sample the posterior of each <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> simultaneously with <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.4 Covariate relevance assessment</title>
      <p>Our method only requires sampling the posterior of a full model including all covariates. From now on we assume that each continuous covariate can be present in at most one shared effect term and arbitrarily many interactions terms. Its relevance is then interpreted to be the relevance of the shared effect component. The first requirement is not a restriction, and we consider the case of multiple shared effect components in Supplementary Section S2.2.5. We also assume that each categorical covariate can appear only in one term, which can be an interaction or a first-order term, and its relevance is then interpreted to be the relevance of the component where it appears. This way the covariate relevance assessment problem reduces to determining the relevance of each component. In Supplementary Section S2.2.6, we briefly consider also higher-order interaction terms.</p>
      <sec>
        <label>2.4.1</label>
        <title>Determining the amount of noise</title>
        <p>After posterior sampling, we have <italic toggle="yes">S</italic> parameter draws <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and if using a non-Gaussian observation model, also draws <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> of each function component <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula>. For each draw <italic toggle="yes">s</italic>, our model gives predictions <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mi>s</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. With the Gaussian observation model, <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, i.e. the analytically computed posterior mean of <bold><italic toggle="yes">f</italic></bold> (see Supplementary Material for formula and derivation), and the link function <italic toggle="yes">g</italic> is identity. With other observation models, <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are the scaling factors. Link functions for different observation models are defined in Supplementary Material.</p>
        <p>We determine how much of the data variation is explained by noise, using an approach closely related to the Bayesian <italic toggle="yes">R</italic><sup>2</sup>-statistic (<xref rid="btab021-B8" ref-type="bibr">Gelman et al., 2019</xref>) (see Supplementary Section 1). The noise proportion in draw <italic toggle="yes">s</italic> is 
<disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>noise</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE86"><mml:math id="IM86" display="inline" overflow="scroll"><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE87"><mml:math id="IM87" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> are the residual and explained sum of squares, respectively, and <inline-formula id="IE88"><mml:math id="IM88" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mi>s</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. With this definition, <inline-formula id="IE89"><mml:math id="IM89" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>noise</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> will be one if the model gives constant predictions and zero if predictions match data exactly. Note that with binomial and BB models, <italic toggle="yes">y<sub>i</sub></italic> is replaced by <inline-formula id="IE90"><mml:math id="IM90" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mo>η</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">η<sub>i</sub></italic> is the total the number of trials, as <italic toggle="yes">y<sub>i</sub></italic> is the number of successes.</p>
      </sec>
      <sec>
        <label>2.4.2</label>
        <title>Decomposing the explained variance</title>
        <p>The proportion of variance that is associated with the actual signal, <inline-formula id="IE91"><mml:math id="IM91" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>signal</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>noise</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, can then be seen as explained variance and is further divided between each model component. For cleaner notation, we define the variation of a vector <inline-formula id="IE92"><mml:math id="IM92" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as a sum of squared differences from the mean, i.e. <inline-formula id="IE93"><mml:math id="IM93" display="inline" overflow="scroll"><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>-</mml:mo><mml:mo> </mml:mo><mml:menclose notation="top"><mml:mi>v</mml:mi></mml:menclose><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>. The relevance of component <italic toggle="yes">j</italic> is 
<disp-formula id="E7"><label>(7)</label><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>signal</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:mi>S</mml:mi><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE94"><mml:math id="IM94" display="inline" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with Gaussian observation model and <inline-formula id="IE95"><mml:math id="IM95" display="inline" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> otherwise. Above we used <inline-formula id="IE96"><mml:math id="IM96" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to denote the posterior mean vector of component <italic toggle="yes">j</italic>, corresponding to draw <italic toggle="yes">s</italic> (see Supplementary Material). The final component and noise relevances are then 
<disp-formula id="E8"><label>(8)</label><mml:math id="M8" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>S</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:mrow><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>noise</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>S</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>noise</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>i.e. averages over the <italic toggle="yes">S</italic> MCMC draws. Our definition has the properties that <inline-formula id="IE97"><mml:math id="IM97" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> for all <italic toggle="yes">j</italic>, and that we can compute the proportion of variance explained by a subset of components <inline-formula id="IE98"><mml:math id="IM98" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">J</mml:mi><mml:mo>⊆</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> simply as <inline-formula id="IE99"><mml:math id="IM99" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="script">J</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">J</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Furthermore, <inline-formula id="IE100"><mml:math id="IM100" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>noise</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and for two component subsets <inline-formula id="IE101"><mml:math id="IM101" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">J</mml:mi><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></inline-formula>, it holds that <inline-formula id="IE102"><mml:math id="IM102" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="script">J</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec>
        <label>2.4.3</label>
        <title>Covariate selection</title>
        <p>We prefer reporting the numerical relevance values (<inline-formula id="IE103"><mml:math id="IM103" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) as a summary of how much effect each covariate has on the response variable, instead of classifying each covariate as either relevant or irrelevant. However, we also provide a method for performing covariate selection. The approach is to select the minimal subset of components <inline-formula id="IE104"><mml:math id="IM104" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">J</mml:mi></mml:mrow><mml:mrow><mml:mtext>sel</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> that together with noise explain at least <inline-formula id="IE105"><mml:math id="IM105" display="inline" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> of variance. Formally, <inline-formula id="IE106"><mml:math id="IM106" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">J</mml:mi></mml:mrow><mml:mrow><mml:mtext>sel</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:mrow><mml:mi mathvariant="script">J</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="script">J</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>, subject to <inline-formula id="IE107"><mml:math id="IM107" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="script">J</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>noise</mml:mtext></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mfrac><mml:mi>T</mml:mi><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">T </italic>=<italic toggle="yes"> </italic>95 by default. In Supplementary Material, we describe also a probabilistic extension of this method. We emphasize that when selecting covariates, we are not testing whether or not a given effect is exactly zero. Therefore we do not perform multiple testing corrections, as in frequentist literature, when analysing multiple response variables (several proteins or genes). See <xref rid="btab021-B7" ref-type="bibr">Gelman et al. (2012)</xref> for discussion.</p>
        <p>A related method, which also relies on selecting a minimal subset of covariates based on inference of a full model with all covariates, is the projection predictive model selection method (<xref rid="btab021-B9" ref-type="bibr">Goutis and Robert, 1998</xref>). It has been shown to perform well in predictive covariate selection for generalized linear models (<xref rid="btab021-B18" ref-type="bibr">Piironen and Vehtari, 2017</xref>). However, it still requires comparing lots of alternative sub-models to the full model, whereas in our case finding the minimal subset of predictors does not require additional sampling or parameter fitting. Moreover, sequential subset search methods, such as the projection predictive method and <italic toggle="yes">LonGP</italic> (<xref rid="btab021-B4" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic>, 2019</xref>), are prone to most often selecting the most expressive components. We argue that our method is more suitable for longitudinal GP models that contain components of different complexities. For example, an individual-specific age component is more expressive than a shared age effect component.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Experiments with simulated data</title>
      <p>First, we use simulated data to demonstrate the accuracy of covariate relevance assessment and benefits of the novel features of our method. In each experiment, we generate data with different types of continuous and categorical covariates (see Supplementary Material for details of data simulation). In order to test the accuracy of our covariate relevance assessment, we simulate noisy measurements of a response variable so that only part of the covariates are relevant. In each experiment we generate several random dataset realizations and measure performance in classifying covariates as relevant or irrelevant using the area under curve (AUC) measure for receiver operating characteristic (ROC) curves. Higher AUC value indicates better performance. The computed covariate relevances (rel<sub><italic toggle="yes">j</italic></sub> in <xref rid="E8" ref-type="disp-formula">Equation 8</xref>) are used as a score in the ROC analyses, which are performed using the <italic toggle="yes">pROC</italic> package (<xref rid="btab021-B24" ref-type="bibr">Robin et al., 2011</xref>).</p>
      <sec>
        <label>3.1.1</label>
        <title>Comparison with linear mixed effect modelling and LonGP</title>
        <p>We first confirm that linear mixed modelling cannot capture the covariate relevances whereas our GP modelling approach can, when the covariate effects are non-linear. We use the <italic toggle="yes">lme4</italic> package (<xref rid="btab021-B1" ref-type="bibr">Bates <italic toggle="yes">et al.</italic>, 2015</xref>) for fitting linear mixed effect models, and the <italic toggle="yes">lmerTest</italic> package (<xref rid="btab021-B14" ref-type="bibr">Kuznetsova et al., 2017</xref>) for computing <italic toggle="yes">p</italic>-values of the linear model components. The <italic toggle="yes">p</italic>-values are used as the score in ROC analysis. The resulting ROC curves and AUC scores are shown in <xref rid="btab021-F2" ref-type="fig">Figure 2a</xref>. It is evident that the linear mixed model approach performs poorly, whereas <italic toggle="yes">lgpr</italic> is consistently more accurate, reaching near-perfect performance when <italic toggle="yes">N </italic>=<italic toggle="yes"> </italic>600. To test the effect of the amount of noise, we repeat the experiment with <italic toggle="yes">N </italic>=<italic toggle="yes"> </italic>100, using different signal-to-noise ratios. Results are in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6a</xref>, and they show that the accuracy of <italic toggle="yes">lgpr</italic> improves consistently as the data is less noisy.</p>
        <p>We also compare our method with the additive Gaussian process model selection method <italic toggle="yes">LonGP</italic> (<xref rid="btab021-B4" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic>, 2019</xref>). Here, we set up a more difficult covariate selection problem with more covariates of different types, and also generate non-stationary disease effects for half of the individuals. Since <italic toggle="yes">LonGP</italic> uses a sequential model search, we cannot compute full ROC curves for it. Therefore we compare performances by counting how often each covariate is selected. <italic toggle="yes">LonGP</italic> tends to select very few covariates, and to have comparable results for <italic toggle="yes">lgpr</italic>, we set a rather low threshold of <italic toggle="yes">T </italic>=<italic toggle="yes"> </italic>80. <xref rid="btab021-F2" ref-type="fig">Figure 2b</xref> shows the number of times each method selected different covariates across the 100 simulated datasets for both the case where the disease effect was and was not relevant. We see that <italic toggle="yes">lgpr</italic> can more clearly distinguish the relevant covariates. Furthermore, the average run time per dataset is approximately five times smaller for <italic toggle="yes">lgpr</italic> (<xref rid="btab021-F2" ref-type="fig">Fig. 2b</xref>).</p>
        <p>In addition to <italic toggle="yes">T </italic>=<italic toggle="yes"> </italic>80, we include results with the default <italic toggle="yes">lgpr</italic> threshold of <italic toggle="yes">T </italic>=<italic toggle="yes"> </italic>95. The total covariate selection accuracies for <italic toggle="yes">lgpr</italic> using both thresholds as well as <italic toggle="yes">LonGP</italic>, are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. In additional experiments, we repeat the experiment with a higher signal-to-noise ratio, and test the behaviour of the methods when some of the case individuals are mistakenly modelled as controls. For these additional experiments, the accuracies are reported in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> and proportion of times each covariate is selected is reported in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6b</xref>.</p>
      </sec>
      <sec>
        <label>3.1.2</label>
        <title>Heterogeneous and temporally uncertain disease effect modelling</title>
        <p>To test the heterogeneous disease effect modelling approach, we generate data with 16 individuals out of which 8 are cases, but so that the disease effect is generated for only <inline-formula id="IE108"><mml:math id="IM108" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>affected</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:math></inline-formula> 2, 4, 6 or 8 of the case individuals. For each dataset replication, the inference is done using both a heterogeneous and homogeneous model. The results in <xref rid="btab021-F3" ref-type="fig">Figure 3</xref> show that heterogeneous modelling improves covariate selection accuracy, and the improvement is clearest when <inline-formula id="IE109"><mml:math id="IM109" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>affected</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. Moreover, in heterogeneous modelling, the posterior distribution of the individual-specific disease effect magnitude parameters <inline-formula id="IE110"><mml:math id="IM110" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mtext>id</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> indicates the affected individuals. See <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref> for a detailed demonstration of heterogeneous model inference.</p>
        <fig position="float" id="btab021-F4">
          <label>Fig. 4.</label>
          <caption>
            <p>(<bold>a</bold>) Modelling the uncertainty in the disease effect time enhances covariate relevance assessment accuracy, when data is generated so that the disease effect can occur earlier than the observed disease initiation. The left panel shows ROC curves for covariate relevance assessment with and without modelling the effect time uncertainty. In Model 1, the effect time is fixed to equal the observed initiation time, whereas Models 2-3 account for its uncertainty. Model 2 has an exponential decay prior for the difference between the effect time and observed onset. Model 3 has an oracle prior for the effect time. The right panel shows ROC curves for the same three models, in the task of classifying just the disease component as relevant or irrelevant. (<bold>b</bold>) Using a discrete observation model improves covariate selection accuracy for negative binomially distributed count data</p>
          </caption>
          <graphic xlink:href="btab021f4" position="float"/>
        </fig>
        <p>To test the model where the disease effect time is considered uncertain, we simulated data where the observed disease initiation time is later than the true generated effect of the disease-related age covariate. For each dataset we run the inference first by fixing the effect time to equal the clinically determined onset time (Model 1), and then using two different priors for the effect time uncertainty. The first prior is <inline-formula id="IE111"><mml:math id="IM111" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mtext>Exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0.05</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, meaning that the observed onset is most likely, and prior mass decays exponentially towards birth (Model 2). An oracle prior, which is exactly the distribution that is used to sample the real effect time, is used for reference (Model 3). The results in <xref rid="btab021-F4" ref-type="fig">Figure 4a</xref> show that the uncertainty modelling improves the covariate selection accuracy, and the oracle prior performs best as expected. Especially, we see that detection of the disease-related age covariate is more accurate when the uncertainty is being modelled. See <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref> for a more specific demonstration of effect time inference.</p>
        <fig position="float" id="btab021-F5">
          <label>Fig. 5.</label>
          <caption>
            <p>Results of analysing one example protein from a longitudinal proteomics dataset. (<bold>a</bold>) The normalized measurements for protein Q8WZA1, highlighted based on group (case or control). The lines connect an individual. (<bold>b</bold>) Same data where four case individuals (id=<inline-formula id="IE112"><mml:math id="IM112" display="inline" overflow="scroll"><mml:mrow><mml:mn>15</mml:mn><mml:mo>,</mml:mo><mml:mn>16</mml:mn><mml:mo>,</mml:mo><mml:mn>17</mml:mn><mml:mo>,</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:math></inline-formula>) are highlighted, based on being determined as affected by the disease in heterogeneous modelling. (<bold>c</bold>) Inferred function components, as well as their sum <italic toggle="yes">f</italic> (using posterior mean parameters), for Q8WZA1 analysed using the homogeneous and (<bold>d</bold>) heterogeneous model. The component relevances (rel<sub><italic toggle="yes">j</italic></sub> in <xref rid="E8" ref-type="disp-formula">Equation 8</xref>) for each <inline-formula id="IE113"><mml:math id="IM113" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> are <inline-formula id="IE114"><mml:math id="IM114" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.229</mml:mn><mml:mo>,</mml:mo><mml:mn>0.157</mml:mn><mml:mo>,</mml:mo><mml:mn>0.03</mml:mn><mml:mo>,</mml:mo><mml:mn>0.031</mml:mn><mml:mo>,</mml:mo><mml:mn>0.007</mml:mn></mml:mrow></mml:math></inline-formula> for the homogeneous model and <inline-formula id="IE115"><mml:math id="IM115" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.096</mml:mn><mml:mo>,</mml:mo><mml:mn>0.116</mml:mn><mml:mo>,</mml:mo><mml:mn>0.25</mml:mn><mml:mo>,</mml:mo><mml:mn>0.037</mml:mn><mml:mo>,</mml:mo><mml:mn>0.004</mml:mn></mml:mrow></mml:math></inline-formula> for the heterogeneous model, respectively. The heterogeneous model selects the disease component as relevant, whereas the homogeneous model does not. The posterior distributions of the function components and their sum outside observed time points is computed as explained in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. For clarity, standard deviations are not show for <inline-formula id="IE116"><mml:math id="IM116" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE117"><mml:math id="IM117" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>sum</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. (<bold>e</bold>) Kernel density estimates for the posterior distributions of the individual-specific disease effect magnitude parameters of the heterogeneous model</p>
          </caption>
          <graphic xlink:href="btab021f5" position="float"/>
        </fig>
      </sec>
      <sec>
        <label>3.1.3</label>
        <title>Non-Gaussian data</title>
        <p>To demonstrate the benefit of using a proper observation model for count data, we generate negative binomially distributed data and run the inference using both a Gaussian and NB observation model. For reference, we also run the inference using the Gaussian observation model after transforming the counts through mapping <inline-formula id="IE118"><mml:math id="IM118" display="inline" overflow="scroll"><mml:mrow><mml:mi>y</mml:mi><mml:mo>↦</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Results in <xref rid="btab021-F4" ref-type="fig">Figure 4b</xref> confirm that using the correct observation model in <italic toggle="yes">lgpr</italic> for this kind of count data improves covariate selection accuracy compared to the Gaussian or log-Gaussian models. We note, however, that covariate selection performance of the log-Gaussian model improves (relative to that of the NB model) when data has higher count values and dispersion is smaller, i.e. when the NB model is better approximated by the log-Gaussian model.</p>
      </sec>
      <sec>
        <label>3.1.4</label>
        <title>Experiments under model mismatch</title>
        <p>In the previous experiments, the true covariate effects were drawn from the additive GP priors. To validate the modelling approach further, we perform an additional experiment where the true effects are different types of parametric functions (Supplementary Section S3.6, Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S7a</xref>). The experiment setup is otherwise the same as in the comparison against <italic toggle="yes">LonGP</italic> (Section 3.1.1). We observed that the component relevances and amount of noise are captured well also in this case (Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S7b</xref>). We also test the behaviour of the model and covariate relevance assessment method when some of the true relevant covariates are not included in the model. This is a likely scenario in reality, because some true relevant predictor variables are not necessarily even measured, and therefore cannot be included in the model. Results in Supplementary Figure S7b suggest that failure to include relevant components in the model has the effect that more variance is explained by noise and individual-specific variation. This is expected behaviour, and we see that the other true relevant covariates can still be distinguished from the irrelevant ones, but modellers should be aware of this behaviour and interpret results accordingly.</p>
      </sec>
    </sec>
    <sec>
      <title>3.2 Longitudinal proteomics data analysis</title>
      <p>We used <italic toggle="yes">lgpr</italic> to analyse a longitudinal dataset from a recent T1D study (<xref rid="btab021-B15" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2018</xref>), where the longitudinal profile of protein intensities from plasma samples was measured for 11 cases and 10 controls at nine time points that span the initiation of the disease pathogenesis, resulting in a total of 189 data points for most proteins. We chose to analyse 1538 proteins which were chosen by requiring that at least 50% of the measurements must have non-missing values. The exact sample sizes after discarding missing data for each protein are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>. Eleven children developed T1D, and for those individuals we defined the disease effect time to be the seroconversion age, which was defined as age at the first detection of one or multiple T1D autoantibodies (<xref rid="btab021-B15" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2018</xref>). We performed our modelling using five covariates: id, age, diseaseAge, sex and group (case/control). We followed the preprocessing described in (<xref rid="btab021-B15" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2018</xref>) to get normalized protein intensities. Of the categorical covariates, id and sex are modelled as age-dependent category-specific deviations from the shared age effect, and group is a constant group offset variable.</p>
      <p>Covariate relevances and selection results for all proteins are included in Supplementary Tables S2 and S3. As an example, both models confirm the sex association of the Mullerian inhibiting factor (uniprot id P03971) (<xref rid="btab021-B15" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2018</xref>), assigning a relevance score of 0.912 for the <italic toggle="yes">sex</italic> × <italic toggle="yes">age</italic> interaction term. The homogeneous model finds 38 and the heterogeneous model finds 66 proteins associated with the disease-related age covariate, with intersection of 20 proteins. <xref rid="btab021-F5" ref-type="fig">Figure 5a</xref> shows the normalized measurements for protein Q8WA1 and <xref rid="btab021-F5" ref-type="fig">Figures 5c</xref> and <xref rid="btab021-F5" ref-type="fig">d</xref> show the inferred covariate effects using the two different disease effect modelling approaches. The new heterogeneous modelling approach is seen to detect a stronger average disease effect, because it allows the effect sizes to vary between individuals. Moreover, the posterior distributions of individual-specific disease effect magnitude parameters (<xref rid="btab021-F5" ref-type="fig">Fig. 5e</xref>), reveal four individuals (<inline-formula id="IE119"><mml:math id="IM119" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>15</mml:mn><mml:mo>,</mml:mo><mml:mn>16</mml:mn><mml:mo>,</mml:mo><mml:mn>17</mml:mn><mml:mo>,</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:math></inline-formula>) (<xref rid="btab021-F5" ref-type="fig">Fig. 5b</xref>), that experience a strong disease effect near the seroconversion time.</p>
    </sec>
    <sec>
      <title>3.3 Longitudinal RNA-seq data analysis</title>
      <p>We analysed also read count data from CD4+ T cells of 14 children measured at 3, 6, 12, 18, 24 and 36 months age (<xref rid="btab021-B12" ref-type="bibr">Kallionpää <italic toggle="yes">et al.</italic>, 2019</xref>). The number of available data points was 6 (for 8 children), 5 (2 children), 4 (2 children) or 3 (2 children), resulting in a total of 72 data points. Seven children had become seropositive for T1D during the measurement interval (cases), while the other seven children were autoantibody negative (controls). We included 519 highly variable genes in our <italic toggle="yes">lgpr</italic> analysis, based on preprocessing steps explained in Supplementary Material. We included the same covariates and components in our <italic toggle="yes">lgpr</italic> model as in the proteomics data analysis, and age at the first detection of one or more T1D autoantibodies was again used to compute the disease related age.</p>
      <p>Covariate relevances and selection results for all genes are included in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>. Our analysis confirms the differential expression profile of the IL32 gene between the case and control individuals (<xref rid="btab021-B12" ref-type="bibr">Kallionpää <italic toggle="yes">et al.</italic>, 2019</xref>), as the group covariate is selected with relevance 0.196. The disease-related age was initially selected as relevant for a total of 73 genes. As the data is sparse and noisy, we defined a stricter rule and required that the relevance of the disease-related age component alone is larger than 0.05. This way we detected 12 interesting, potentially disease development-related genes (highlighted in blue in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>). As an example, <xref rid="btab021-F6" ref-type="fig">Figure 6</xref> shows the inferred covariate effects for the SIAH3 (<italic toggle="yes">Seven in absentia homolog 3</italic>) gene.</p>
      <fig position="float" id="btab021-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Data and inferred covariate effects for the SIAH3 gene. (<bold>a</bold>) Raw count data highlighted based on group (case/control) and (<bold>b</bold>) sex. (<bold>c</bold>) Inferred cumulative effect <italic toggle="yes">f</italic> and (<bold>d</bold>) additive function components. Interpolation outside observed time points is done as explained in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. For clarity, standard deviations are not show for <inline-formula id="IE121"><mml:math id="IM120" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">f</italic>. The seroconversion times of the seven case individuals, i.e. used disease effect times, are 12, 12, 18, 24, 18, 12 and 18 months, indicated by the dashed red vertical lines. Inferred component relevances for <inline-formula id="IE122"><mml:math id="IM121" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> are <inline-formula id="IE123"><mml:math id="IM122" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.097</mml:mn><mml:mo>,</mml:mo><mml:mn>0.098</mml:mn><mml:mo>,</mml:mo><mml:mn>0.077</mml:mn><mml:mo>,</mml:mo><mml:mn>0.043</mml:mn><mml:mo>,</mml:mo><mml:mn>0.015</mml:mn></mml:mrow></mml:math></inline-formula>, respectively. The selected covariates are id, age, diseaseAge and sex</p>
        </caption>
        <graphic xlink:href="btab021f6" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>The <italic toggle="yes">lgpr</italic> tool provides several important novel features for modelling longitudinal data and offers a good balance between flexibility and interpretability. We have shown that the interpretable kernels, heterogeneous disease modelling, uncertainty modelling of effect times and covariate selection strategy of <italic toggle="yes">lgpr</italic> significantly improve previous longitudinal modelling methods. The tool has an intuitive syntax, and thus provides an easy transition from the standard linear mixed modelling tools to Bayesian non-parametric longitudinal regression. It is widely applicable as the data can involve irregular sampling intervals, different numbers of measurement points over individuals and crossed categorical factors. Moreover, many types of response variables that are common in post-genomic studies (continuous, discrete, binary, proportion) can be modelled with the proper observation models. The comprehensive software implementation of <italic toggle="yes">lgpr</italic> enjoys state-of-the-art sampling efficiency and diagnostics (<xref rid="btab021-B30" ref-type="bibr">Vehtari et al., 2020</xref>) offered by Stan. The user can choose from the numerous presented modelling options and set various parameter priors (which have widely applicable defaults). Overall, <italic toggle="yes">lgpr</italic> has the potential to become a standard tool for statistical analysis of longitudinal data.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab021_Supplementary_Data</label>
      <media xlink:href="btab021_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors acknowledge the computational resources provided by the Aalto Science-IT project.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Academy of Finland [292660].</p>
      <p><italic toggle="yes">Conflict of Interest:</italic> none declared.</p>
    </sec>
    <sec sec-type="data-availability">
      <title>Data availability</title>
      <p>No new data were generated or analysed in support of this research.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab021-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bates</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Fitting linear mixed-effects models using lme4</article-title>. <source>J. Stat. Softw</source>., <volume>67</volume>, <fpage>1</fpage>–<lpage>48</lpage>.</mixed-citation>
    </ref>
    <ref id="btab021-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Betancourt</surname><given-names>M.</given-names></string-name></person-group> (<year>2017</year>) 
<article-title>A conceptual introduction to Hamiltonian Monte Carlo</article-title>. <source>arXiv:1701.02434</source>.</mixed-citation>
    </ref>
    <ref id="btab021-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carpenter</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Stan: a probabilistic programming language</article-title>. <source>J. Stat. Softw</source>., <volume>76, 1–32</volume>.</mixed-citation>
    </ref>
    <ref id="btab021-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>An additive Gaussian process regression model for interpretable non-parametric analysis of longitudinal data</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>1798</fpage>.<pub-id pub-id-type="pmid">30996266</pub-id></mixed-citation>
    </ref>
    <ref id="btab021-B5">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Diggle</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2002</year>) <source>Analysis of Longitudinal Data</source>. 
<publisher-name>Oxford University Press</publisher-name>, 
<publisher-loc>United Kingdom</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab021-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duvenaud</surname><given-names>D.K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) 
<article-title>Additive Gaussian processes</article-title>. <source>Adv. Neur. Inf. Proc. Syst</source>., <volume>24</volume>, <fpage>226</fpage>.</mixed-citation>
    </ref>
    <ref id="btab021-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gelman</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) 
<article-title>Why we (usually) don’t have to worry about multiple comparisons</article-title>. <source>J. Res. Educ. Eff</source>., <volume>5</volume>, <fpage>189</fpage>–<lpage>211</lpage>.</mixed-citation>
    </ref>
    <ref id="btab021-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gelman</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>R-squared for Bayesian regression models</article-title>. <source>Am. Stat</source>., <volume>73</volume>, <fpage>307</fpage>–<lpage>309</lpage>.</mixed-citation>
    </ref>
    <ref id="btab021-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goutis</surname><given-names>C.</given-names></string-name>, <string-name><surname>Robert</surname><given-names>C.P.</given-names></string-name></person-group> (<year>1998</year>) 
<article-title>Model choice in generalised linear models: a Bayesian approach via Kullback-Leibler projections</article-title>. <source>Biometrika</source>, <volume>85</volume>, <fpage>29</fpage>–<lpage>37</lpage>.</mixed-citation>
    </ref>
    <ref id="btab021-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hastie</surname><given-names>T.</given-names></string-name>, <string-name><surname>Tibshirani</surname><given-names>R.</given-names></string-name></person-group> (<year>1986</year>) 
<article-title>Generalized additive models</article-title>. <source>Stat. Sci</source>., <volume>1</volume>, <fpage>297</fpage>–<lpage>310</lpage>.</mixed-citation>
    </ref>
    <ref id="btab021-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hoffman</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Gelman</surname><given-names>A.</given-names></string-name></person-group> (<year>2014</year>) 
<article-title>The No-U-Turn Sampler: adaptively setting path lengths in Hamiltonian Monte Carlo</article-title>. <source>J. Mach. Learn. Res</source>., <volume>15</volume>, <fpage>1593</fpage>–<lpage>1623</lpage>.</mixed-citation>
    </ref>
    <ref id="btab021-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kallionpää</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Early detection of peripheral blood cell signature in children developing <italic toggle="yes">β</italic>-cell autoimmunity at a young age</article-title>. <source>Diabetes</source>, <volume>68</volume>, <fpage>2024</fpage>–<lpage>2034</lpage>.<pub-id pub-id-type="pmid">31311800</pub-id></mixed-citation>
    </ref>
    <ref id="btab021-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kaufman</surname><given-names>C.G.</given-names></string-name>, <string-name><surname>Sain</surname><given-names>S.R.</given-names></string-name></person-group> (<year>2010</year>) 
<article-title>Bayesian functional ANOVA modeling using Gaussian process prior distributions</article-title>. <source>Bayesian Anal</source>., <volume>5</volume>, <fpage>123</fpage>–<lpage>149</lpage>.</mixed-citation>
    </ref>
    <ref id="btab021-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuznetsova</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>lmerTest package: tests in linear mixed effects models</article-title>. <source>J. Stat. Softw</source>., <volume>82</volume>, <fpage>1</fpage>–<lpage>26</lpage>.</mixed-citation>
    </ref>
    <ref id="btab021-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>C.-W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Temporal expression profiling of plasma proteins reveals oxidative stress in early stages of Type 1 Diabetes progression</article-title>. <source>J. Proteomics</source>, <volume>172</volume>, <fpage>100</fpage>–<lpage>110</lpage>.<pub-id pub-id-type="pmid">28993202</pub-id></mixed-citation>
    </ref>
    <ref id="btab021-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Hara</surname><given-names>R.B.</given-names></string-name>, <string-name><surname>Kotze</surname><given-names>D.J.</given-names></string-name></person-group> (<year>2010</year>) 
<article-title>Do not log-transform count data</article-title>. <source>Methods Ecol. Evol</source>., <volume>1</volume>, <fpage>118</fpage>–<lpage>122</lpage>.</mixed-citation>
    </ref>
    <ref id="btab021-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pietropaolo</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2007</year>) 
<article-title>The heterogeneity of diabetes</article-title>. <source>Diabetes</source>, <volume>56</volume>, <fpage>1189</fpage>–<lpage>1197</lpage>.<pub-id pub-id-type="pmid">17322478</pub-id></mixed-citation>
    </ref>
    <ref id="btab021-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Piironen</surname><given-names>J.</given-names></string-name>, <string-name><surname>Vehtari</surname><given-names>A.</given-names></string-name></person-group> (<year>2017</year>) 
<article-title>Comparison of Bayesian predictive methods for model selection</article-title>. <source>Stat. Comput</source>., <volume>27</volume>, <fpage>711</fpage>–<lpage>735</lpage>.</mixed-citation>
    </ref>
    <ref id="btab021-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Plate</surname><given-names>T.</given-names></string-name></person-group> (<year>1999</year>) 
<article-title>Accuracy versus interpretability in flexible modeling: implementing a tradeoff using Gaussian process models</article-title>. <source>Behaviourmetrika</source>, <volume>26</volume>, <fpage>29</fpage>–<lpage>50</lpage>.</mixed-citation>
    </ref>
    <ref id="btab021-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quintana</surname><given-names>F.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Bayesian nonparametric longitudinal data analysis</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>111</volume>, <fpage>1168</fpage>–<lpage>1181</lpage>.<pub-id pub-id-type="pmid">28366967</pub-id></mixed-citation>
    </ref>
    <ref id="btab021-B21">
      <mixed-citation publication-type="book">R Core Team (<year>2018</year>) <source>R: A Language and Environment for Statistical Computing</source>. 
<publisher-name>R Foundation for Statistical Computing</publisher-name>, 
<publisher-loc>Vienna, Austria</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab021-B22">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Rasmussen</surname><given-names>C.E.</given-names></string-name>, <string-name><surname>Williams</surname><given-names>C.K.I.</given-names></string-name></person-group> (<year>2006</year>) <source>Gaussian Processes for Machine Learning</source>. 
<publisher-name>MIT Press</publisher-name>, 
<publisher-loc>Cambridge, Massachusetts</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab021-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roberts</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Gaussian processes for time-series modelling</article-title>. <source>Phil. Trans. R. Soc. A</source>, <volume>371</volume>, <fpage>20110550</fpage>.<pub-id pub-id-type="pmid">23277607</pub-id></mixed-citation>
    </ref>
    <ref id="btab021-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robin</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) 
<article-title>pROC: an open-source package for R and S+ to analyze and compare ROC curves</article-title>. <source>BMC Bioinformatics</source>, <volume>12</volume>,</mixed-citation>
    </ref>
    <ref id="btab021-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sharma</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Longitudinal single-cell RNA sequencing of patient-derived primary cells reveals drug-induced infidelity in stem cell hierarchy</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>4931</fpage>.<pub-id pub-id-type="pmid">30467425</pub-id></mixed-citation>
    </ref>
    <ref id="btab021-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Snoek</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>Input warping for Bayesian optimization of non-stationary functions</article-title>. <source>Int. Conf. Mach. Learn</source>., <volume>31</volume>, <fpage>1674</fpage>–<lpage>1682</lpage>.</mixed-citation>
    </ref>
    <ref id="btab021-B27">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Stroup</surname><given-names>W.W.</given-names></string-name></person-group> (<year>2012</year>) <source>Generalized Linear Mixed Models: Modern Concepts, Methods and Applications. Chapman &amp; Hall/CRC Texts in Statistical Science</source>. 
<publisher-name>CRC Press</publisher-name>, 
<publisher-loc>Boca Raton, FL</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab021-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vanhatalo</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>GPstuff: Bayesian modeling with Gaussian processes</article-title>. <source>J. Mach. Learn. Res</source>., <volume>14</volume>, <fpage>1175</fpage>–<lpage>1179</lpage>.</mixed-citation>
    </ref>
    <ref id="btab021-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vatanen</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Variation in microbiome LPS immunogenicity contributes to autoimmunity in humans</article-title>. <source>Cell</source>, <volume>165</volume>, <fpage>842</fpage>–<lpage>853</lpage>.<pub-id pub-id-type="pmid">27133167</pub-id></mixed-citation>
    </ref>
    <ref id="btab021-B30">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Vehtari</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <part-title>Rank-normalization, folding, and localization: an improved</part-title>  <inline-formula id="IE124"><mml:math id="IM123" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>  <part-title>for assessing convergence of MCMC</part-title>. <source>Bayesian Anal</source>.  Advance publication, doi:10.1214/20-BA1221</mixed-citation>
    </ref>
    <ref id="btab021-B31">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Wood</surname><given-names>S.</given-names></string-name></person-group> (<year>2006</year>) <source>Generalized Additive Models: An Introduction with R. Texts in Statistical Science</source>. 
<publisher-name>Chapman &amp; Hall</publisher-name>, 
<publisher-loc>United Kingdom</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab021-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ziegler</surname><given-names>A.G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Seroconversion to multiple islet autoantibodies and risk of progression to diabetes in children</article-title>. <source>J. Am. Med. Assoc</source>., <volume>309</volume>, <fpage>2473</fpage>–<lpage>2479</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
