<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8055217</article-id>
    <article-id pub-id-type="pmid">32730595</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa676</article-id>
    <article-id pub-id-type="publisher-id">btaa676</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Triplet-based similarity score for fully multilabeled trees with poly-occurring labels</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6469-4887</contrib-id>
        <name>
          <surname>Ciccolella</surname>
          <given-names>Simone</given-names>
        </name>
        <xref ref-type="corresp" rid="btaa676-cor1"/>
        <xref ref-type="aff" rid="btaa676-aff1"/>
        <!--<email>simone.ciccolella@unimib.it</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bernardini</surname>
          <given-names>Giulia</given-names>
        </name>
        <xref ref-type="aff" rid="btaa676-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8786-2276</contrib-id>
        <name>
          <surname>Denti</surname>
          <given-names>Luca</given-names>
        </name>
        <xref ref-type="aff" rid="btaa676-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bonizzoni</surname>
          <given-names>Paola</given-names>
        </name>
        <xref ref-type="aff" rid="btaa676-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3040-9539</contrib-id>
        <name>
          <surname>Previtali</surname>
          <given-names>Marco</given-names>
        </name>
        <xref ref-type="aff" rid="btaa676-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Della Vedova</surname>
          <given-names>Gianluca</given-names>
        </name>
        <xref ref-type="aff" rid="btaa676-aff1"/>
      </contrib>
    </contrib-group>
    <aff id="btaa676-aff1"><institution>Department of Informatics, Systems and Communication, University of Milano-Biccoca</institution>, Milan 20126, <country country="IT">Italy</country></aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Elofsson</surname>
          <given-names>Arne</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa676-cor1">To whom correspondence should be addressed. <email>simone.ciccolella@unimib.it</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-07-30">
      <day>30</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>37</volume>
    <issue>2</issue>
    <fpage>178</fpage>
    <lpage>184</lpage>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>4</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>18</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>7</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa676.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The latest advances in cancer sequencing, and the availability of a wide range of methods to infer the evolutionary history of tumors, have made it important to evaluate, reconcile and cluster different tumor phylogenies. Recently, several notions of distance or similarities have been proposed in the literature, but none of them has emerged as the golden standard. Moreover, none of the known similarity measures is able to manage mutations occurring multiple times in the tree, a circumstance often occurring in real cases.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>To overcome these limitations, in this article, we propose MP3, the first similarity measure for tumor phylogenies able to effectively manage cases where multiple mutations can occur at the same time and mutations can occur multiple times. Moreover, a comparison of MP3 with other measures shows that it is able to classify correctly similar and dissimilar trees, both on simulated and on real data.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>An open source implementation of MP3 is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/AlgoLab/mp3treesim">https://github.com/AlgoLab/mp3treesim</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union’s Horizon 2020 research and innovation programme</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Marie Skłodowska-Curie</institution>
          </institution-wrap>
        </funding-source>
        <award-id>872539</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Recent methods to accurately infer the clonal evolution and progression of cancer have made it possible to develop targeted therapies for treating the disease. As discussed in several studies (<xref rid="btaa676-B29" ref-type="bibr">Morrissy <italic>et al.</italic>, 2016</xref>; <xref rid="btaa676-B31" ref-type="bibr">Wang <italic>et al.</italic>, 2016</xref>), understanding the history of accumulation and the prevalence of somatic mutations during cancer progression is a fundamental step to devise these treatment strategies.</p>
    <p>Given the importance of the task, a multitude of methods for cancer phylogeny reconstruction have been developed over the years. The increasing number of tools created has been encouraged by the diversity of data available; for instance, we are witnessing a shift from bulk sequencing data (<xref rid="btaa676-B5" ref-type="bibr">Bonizzoni <italic>et al.</italic>, 2017</xref>, <xref rid="btaa676-B4960596" ref-type="bibr">Bonizzoni et al., 2019, </xref> ; <xref rid="btaa676-B20" ref-type="bibr">Hajirasouliha <italic>et al.</italic>, 2014</xref>; <xref rid="btaa676-B19" ref-type="bibr">Hajirasouliha and Raphael, 2014</xref>; <xref rid="btaa676-B32" ref-type="bibr">Yuan <italic>et al.</italic>, 2015</xref>) toward single-cell data (<xref rid="btaa676-B9" ref-type="bibr">Ciccolella <italic>et al.</italic>, 2018a</xref>,<xref rid="btaa676-B10" ref-type="bibr">b</xref>; <xref rid="btaa676-B15" ref-type="bibr">El-Kebir, 2018</xref>; <xref rid="btaa676-B23" ref-type="bibr">Jahn <italic>et al.</italic>, 2016</xref>; <xref rid="btaa676-B33" ref-type="bibr">Zafar <italic>et al.</italic>, 2017</xref>) and hybrid approaches (<xref rid="btaa676-B27" ref-type="bibr">Malikic <italic>et al.</italic>, 2019a</xref>,<xref rid="btaa676-B28" ref-type="bibr">b</xref>).</p>
    <p>Having many different tools accomplishing the same task requires solid methods to compare their results. In contrast with classical phylogenetic trees, whose leaves, and only leaves, are labeled (with the species they represent), the trees that model tumor phylogenies are <italic>fully labeled</italic>, i.e. they also have labels (corresponding to the mutations) on the internal nodes. While there is a wide range of measures to compare leaf-labeled trees in the literature, <italic>ad hoc</italic> methods for tumor phylogenies are starting to appear in the past few years (<xref rid="btaa676-B11" ref-type="bibr">DiNardo <italic>et al.</italic>, 2020</xref>; <xref rid="btaa676-B3" ref-type="bibr">Bernardini <italic>et al.</italic>, 2019</xref>, Bernardini et al. <xref rid="btaa676-B4" ref-type="bibr">2020</xref>; Govek et al. 2018; <xref rid="btaa676-B25" ref-type="bibr">Karpov <italic>et al.</italic>, 2019</xref>); in particular, a detailed study of some notions of distance (<xref rid="btaa676-B11" ref-type="bibr">DiNardo <italic>et al.</italic>, 2020</xref>) has introduced two new measures complementing some more established definitions used in various cancer inference studies (<xref rid="btaa676-B9" ref-type="bibr">Ciccolella <italic>et al.</italic>, 2018a</xref>,<xref rid="btaa676-B10" ref-type="bibr">b</xref>). Those new measures are more nuanced, to capture some aspects of the mutation inheritance process, while still being very efficient to compute. A common trait of all the latter distances is their reliance on the analysis of <italic>pairs</italic> of nodes.</p>
    <p>On the other hand, some of the most widely used distances on classical phylogenies are based on rooted triples (<xref rid="btaa676-B2" ref-type="bibr">Aho <italic>et al.</italic>, 1981</xref>; <xref rid="btaa676-B7" ref-type="bibr">Brodal <italic>et al.</italic>, 2013</xref>; <xref rid="btaa676-B12" ref-type="bibr">Dobson, 1975</xref>) (for rooted phylogenies) or quartets (<xref rid="btaa676-B13" ref-type="bibr">Dudek and Gawrychowski, 2019</xref>) (for unrooted phylogenies) of labeled leaves. Although such metrics have major limitations for our purposes, as they do not apply directly to fully labeled trees, they also have some desirable properties that we would like to transfer in our setting. Specifically, this kind of metric captures well the differences in the topology of the trees; a feature that, to the best of our knowledge, lacks in most of the existing methods for tumor phylogenies. Therefore, we expect a triplet-based measure to provide additional insights on the different evolutionary histories, when applied to cancer progression.</p>
    <p>In this article, we generalize the notion of rooted triples similarity for classical phylogenies to tumor phylogenies. Moreover, we further extend this to multilabeled trees (i.e. where each node is labeled by a set of labels) and poly-occurring labels (i.e. each label can be assigned to more than one node). The latter feature is needed since recent studies (<xref rid="btaa676-B8" ref-type="bibr">Brown <italic>et al.</italic>, 2017</xref>; <xref rid="btaa676-B26" ref-type="bibr">Kuipers <italic>et al.</italic>, 2017</xref>) suggest widespread recurrence and loss of mutations, and more and more methods designed to infer tumor phylogenies considering such a possibility are starting to appear (<xref rid="btaa676-B9" ref-type="bibr">Ciccolella <italic>et al.</italic>, 2018a</xref>,<xref rid="btaa676-B10" ref-type="bibr">b</xref>; <xref rid="btaa676-B15" ref-type="bibr">El-Kebir, 2018</xref>). In a phylogenetic tree, a mutation loss is represented by a special character in the label, such as a minus sign: the design of our measure allows to handle such evolutionary events effectively, as they uniquely correspond to their label like any other kind of mutation.</p>
    <p>Through an extensive experimental analysis, we show that our novel measure is able to overcome the limitations in the existing literature and to provide a better alternative to both the direct comparison of evolutionary histories and the application to established clustering techniques, following the approach of <xref rid="btaa676-B11" ref-type="bibr">DiNardo <italic>et al.</italic> (2020)</xref>. Such a performing measure can also be incorporated in recent works (<xref rid="btaa676-B1" ref-type="bibr">Aguse <italic>et al.</italic>, 2019</xref>; <xref rid="btaa676-B18" ref-type="bibr">Govek <italic>et al.</italic>, 2018</xref>) designed to cluster and build consensus across multiple cancer progressions.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>A classical phylogenetic tree is a rooted, unordered and leaf-labeled tree. The set of all the labels occurring in <italic>T</italic> is denoted by <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and a function <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:mi mathvariant="monospace">N</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> maps each element of <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to a leaf of <italic>T</italic>. We denote with <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the Lowest Common Ancestor of nodes <italic>u</italic> and <italic>v</italic>. Given three leaves <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">V</mml:mi></mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the <italic>minimal tree topology</italic> they induce on <italic>T</italic>, denoted as <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:mi mathvariant="monospace">MTT</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, is the smallest subtree of <italic>T</italic> that includes the nodes <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="italic">V</mml:mi></mml:mrow><mml:mi mathvariant="italic">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo>}</mml:mo><mml:mo>∪</mml:mo><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∪</mml:mo><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∪</mml:mo><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and where all the nodes with degree 2 not in <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="italic">V</mml:mi></mml:mrow><mml:mi mathvariant="italic">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> are contracted.</p>
    <p>The rooted triplet distance measures the dissimilarity between two leaf-labeled trees with identical labels. It is given by the number of rooted triplets that induce different minimal topologies (<xref ref-type="fig" rid="btaa676-F1">Fig. 1</xref>) in the two trees over the total number of triplets (<xref rid="btaa676-B24" ref-type="bibr">Jansson and Rajaby, 2017</xref>). As tumor progression trees are fully labeled, such metric cannot be directly applied: in this section, we propose a novel similarity measure, inspired by the triplet distance, specifically designed for these more general trees.
</p>
    <fig id="btaa676-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Rooted triplet on labels (<italic>a</italic>, <italic>c</italic> and <italic>e</italic>). (<italic>Left</italic>) Tree <italic>T</italic> where the smallest subtree that contains all three labels is highlighted. (<italic>Right</italic>) The minimal topology induced by (<italic>a</italic>, <italic>c</italic> and <italic>e</italic>)</p>
      </caption>
      <graphic xlink:href="btaa676f1"/>
    </fig>
    <sec>
      <title>2.1 Extension to fully labeled trees and multilabeled trees</title>
      <p>A tree <italic>T</italic> on a set <italic>V<sub>T</sub></italic> of <italic>n</italic> nodes is <italic>fully labeled</italic> by a set <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of labels if there is a bijection <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:mi mathvariant="monospace">N</mml:mi><mml:mo> </mml:mo><mml:mo>:</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">V</mml:mi></mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. The definition of minimal topology of three leaves can be trivially extended to the minimal topology of three nodes: we next show that there are only five possible configurations (see <xref ref-type="fig" rid="btaa676-F2">Fig. 2</xref>).
</p>
      <fig id="btaa676-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>The five possible configurations for the minimal tree topology induced by an unordered set of three labels</p>
        </caption>
        <graphic xlink:href="btaa676f2"/>
      </fig>
      <p>Lemma 1. <italic>Given nodes</italic> <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">V</mml:mi></mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula><italic>, there exist only five possible configurations for</italic> <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:mi mathvariant="monospace">MTT</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>Proof. We start by dividing two possible cases: (i) <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, or (ii) just two <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>s are the same, say <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. There are no other possibilities, as <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≠</mml:mo><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≠</mml:mo><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is impossible: indeed, suppose without loss of generality that <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a descendant of <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≠</mml:mo><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>: they cannot be unrelated, as by definition they are both ancestors of <italic>u</italic>. <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is thus a common ancestor for <italic>v</italic> and <italic>z</italic>. Suppose toward a contradiction that <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≠</mml:mo><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, thus it is a descendant of <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and an ancestor of <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. But then it is an ancestor of both <italic>u</italic> an <italic>z</italic> and it is lower than <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, a contradiction.</p>
      <p>Case (i) has two subcases: either <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, corresponding to the rightmost configuration in <xref ref-type="fig" rid="btaa676-F2">Figure 2</xref>, or <inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∉</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, corresponding to the second configuration from the left. Case (ii) has three subcases: either both the distinct <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>s are in {<italic>u</italic>, <italic>v</italic>, <italic>z</italic>}, or none of the two is, or finally one is in {<italic>u</italic>, <italic>v</italic>, <italic>z</italic>} and the other is not. The first subcase corresponds to the leftmost configuration in <xref ref-type="fig" rid="btaa676-F2">Figure 2</xref>, the second subcase to the fourth configuration from the left. For the third subcase, either the external <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula> is an ancestor of all of the three {<italic>u</italic>, <italic>v</italic>, <italic>z</italic>}, corresponding to the third configuration, or it is an ancestor of two nodes and a descendant of the third one, say <italic>u</italic>. In the latter case, though, the external node would be the only child of <italic>u</italic>, and thus would be contracted by definition of <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:mi mathvariant="monospace">MTT</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, leading again to the rightmost configuration of <xref ref-type="fig" rid="btaa676-F2">Figure 2</xref>.</p>
      <p>In the case of fully labeled trees, the definition of <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula> of two nodes and <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:mi mathvariant="monospace">MTT</mml:mi><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula> of three nodes can trivially be extended to the <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula> of two labels and the <inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:mi mathvariant="monospace">MTT</mml:mi><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula> of three labels, as there is a one-to-one correspondence between nodes and labels. From now on, for ease of presentation, given two nodes <italic>u</italic> and <italic>v</italic> and their respective labels <italic>a</italic> and <italic>b</italic>, we will use <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> or <inline-formula id="IE34"><mml:math id="IM34"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> interchangeably. When modeling tumor progression, though, to have a bijection between nodes and labels (i.e. mutations) is quite a strong assumption, as multiple mutations often appear at the same time in the evolutionary history of cancer. We thus relax our assumptions and consider <italic>multilabeled</italic> instead of fully labeled trees.</p>
      <p>A rooted, unordered tree <italic>T</italic> is multilabeled if there exists a surjective function <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:mi mathvariant="monospace">N</mml:mi><mml:mo> </mml:mo><mml:mo>:</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">V</mml:mi></mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> that labels each node of <italic>T</italic> with a set of labels from <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>: note that, in this model, each label is assigned to one and only one node of <italic>T</italic>. We extend the definition of lowest common ancestor of two labels for a multilabeled tree as follows: if <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:mi mathvariant="italic">a</mml:mi><mml:mo>∈</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE38"><mml:math id="IM38"><mml:mrow><mml:mi mathvariant="italic">b</mml:mi><mml:mo>∈</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> label the same node <italic>u</italic>, then <inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="italic">u</mml:mi></mml:mrow></mml:math></inline-formula>; if they label two distinct nodes <italic>u</italic>, <italic>v</italic>, then <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="monospace">LCA</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This allows us to straightforwardly extend the definition of minimal tree topology of three labels for multilabeled trees. There are only four possible additional configurations for the minimal tree topology of multilabeled trees, shown in <xref ref-type="fig" rid="btaa676-F3">Figure 3</xref>: a proof can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref>.
</p>
      <fig id="btaa676-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>The four additional possible configurations for the minimal tree topology of multilabeled trees induced by an unordered set three labels</p>
        </caption>
        <graphic xlink:href="btaa676f3"/>
      </fig>
      <p>Lemma 2. <italic>Given T multilabeled and</italic> <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo>∈</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula><italic>, there exist nine configurations for</italic> <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:mi mathvariant="monospace">MTT</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.2 Extension to poly-occurring labels</title>
      <p>We further extend our model of tumor phylogeny by allowing the same label of <inline-formula id="IE43"><mml:math id="IM43"><mml:mrow><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to be assigned to multiple nodes of <italic>T</italic>. An element of <inline-formula id="IE44"><mml:math id="IM44"><mml:mrow><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> that labels more than one node of <italic>T</italic> is said to be a <italic>poly-occurring</italic> label. To the best of our knowledge, none of the existing tools is able to handle poly-occurring labels: indeed, although some of them accept input trees with poly-occurring labels, they simply disregard the multiple occurrences of a same label.</p>
      <p>Since it is often the case where the inferred evolutionary history involves the appearance of the same mutation in multiple events, a meaningful comparison between tumor phylogenies cannot overlook such a phenomenon. To consider poly-occurring labels in our similarity measure, we extend the definition of minimal tree topology. First, note that if a label occurs multiple times in the tree, then <inline-formula id="IE45"><mml:math id="IM45"><mml:mrow><mml:mi mathvariant="monospace">N</mml:mi><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula> maps each label to one or more nodes in <italic>V<sub>T</sub></italic>. Then, we define the minimal tree topology of poly-occurring labels <italic>a</italic>, <italic>b</italic>, <italic>c</italic>, denoted by M, as follows, where <inline-formula id="IE46"><mml:math id="IM46"><mml:mo>⊔</mml:mo></mml:math></inline-formula> indicates the multiset union:
<disp-formula id="E1"><mml:math id="M1"><mml:mrow><mml:mi mathvariant="monospace">M</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>⊔</mml:mo><mml:mrow><mml:mi mathvariant="italic">u</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="monospace">N</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="monospace">N</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="monospace">N</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mi mathvariant="monospace">MTT</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>In other words, the minimal tree topology of three labels is the multiset of all the minimal tree topologies of the nodes where <italic>a</italic>, <italic>b</italic> and <italic>c</italic> appear. We remark that in this setting <inline-formula id="IE47"><mml:math id="IM47"><mml:mrow><mml:mi mathvariant="monospace">M</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a multiset of configurations, thus the same configuration may appear multiple times in <inline-formula id="IE48"><mml:math id="IM48"><mml:mrow><mml:mi mathvariant="monospace">M</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.3 Similarity measure between trees</title>
      <p>We are now able to define a similarity measure between fully labeled trees with poly-occurring labels. Let <italic>S</italic> be a multiset and let <inline-formula id="IE49"><mml:math id="IM49"><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="italic">S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> be its cardinality. We define the number of shared configurations of labels <italic>a</italic>, <italic>b</italic>, <italic>c</italic> between two trees <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub> as <inline-formula id="IE50"><mml:math id="IM50"><mml:mrow><mml:mi mathvariant="italic">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">M</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⊓</mml:mo><mml:mi mathvariant="monospace">M</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>, i.e. the cardinality of the multiset intersection, and the maximum number of configurations of the triplet in the trees as <inline-formula id="IE51"><mml:math id="IM51"><mml:mrow><mml:mi mathvariant="italic">D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="italic">max</mml:mi><mml:mo>{</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">M</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">M</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>Based on these two values, we define multiple variations of the multipoly-occurring labels triplet-based (MP3) similarity measure that we will later combine into a single score. We define <inline-formula id="IE52"><mml:math id="IM52"><mml:mrow><mml:mi mathvariant="monospace">MP3</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mo>∩</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> as the similarity computed between triplets of labels shared by the two trees:
<disp-formula id="E2"><label>(1)</label><mml:math id="M2"><mml:mrow><mml:mi mathvariant="monospace">MP3</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mo>∩</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi mathvariant="italic">I</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="italic">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi mathvariant="italic">I</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="italic">D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>where <italic>I</italic> is the set of triples in <inline-formula id="IE53"><mml:math id="IM53"><mml:mrow><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∩</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Due to the nature of only considering the subset of labels that appears in both trees, <inline-formula id="IE54"><mml:math id="IM54"><mml:mrow><mml:mi mathvariant="monospace">MP3</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mo>∩</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> is a conservative measure, therefore, we present a variation that considers all possible configurations in both trees, thus having a wider view:
<disp-formula id="E3"><label>(2)</label><mml:math id="M3"><mml:mrow><mml:mi mathvariant="monospace">MP3</mml:mi><mml:msub><mml:mrow><mml:mo> </mml:mo></mml:mrow><mml:mo>∪</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi mathvariant="italic">J</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="italic">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi mathvariant="italic">J</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="italic">D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>where <italic>J</italic> is the set of triples in <inline-formula id="IE55"><mml:math id="IM55"><mml:mrow><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∪</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Different from <inline-formula id="IE56"><mml:math id="IM56"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∩</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∪</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> weighs also the labels that appear only in one of the trees. Note that, for every pair of trees, <inline-formula id="IE57"><mml:math id="IM57"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∪</mml:mo></mml:msub><mml:mo>≤</mml:mo><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∩</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula>, as the numerator remains identical in both, while the denominator of <inline-formula id="IE58"><mml:math id="IM58"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∪</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> has all the elements in <inline-formula id="IE59"><mml:math id="IM59"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∩</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> with the addition of the values of <italic>D</italic> for the triples present only in one of the input trees.</p>
      <p>Although <inline-formula id="IE60"><mml:math id="IM60"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∩</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE61"><mml:math id="IM61"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∪</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> are closely related, they provide two different views of a tumor phylogeny. Indeed, on one hand, <inline-formula id="IE62"><mml:math id="IM62"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∩</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> measures how similar the shared history of two tumor phylogenies is, i.e. it provides an idea of how well the two progressions can be reduced to the same subsequence of common mutations. On the other hand, <inline-formula id="IE63"><mml:math id="IM63"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∪</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> measures how similar the whole histories of the two evolutions are, i.e. it considers the impact of mutations acquired (or lost) in only one progression.</p>
      <p>Since the previous measures capture different aspects of the progressions, we want to combine them into a single, usable and powerful similarity measure that couples the strengths of both. The most intuitive method is to simply use a mean. We opted for the geometric mean: <inline-formula id="IE64"><mml:math id="IM64"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mi mathvariant="italic">G</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∩</mml:mo></mml:msub><mml:mo>·</mml:mo><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∪</mml:mo></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>.</p>
      <p>This function is not completely satisfactory, as a uniform function of 1 and 2 is not able to comprehensively capture the nuances in the input trees. Therefore, we developed a weighted mean with an intentional bias toward <inline-formula id="IE65"><mml:math id="IM65"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∩</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> to catch inner similarities in different trees. Such combination then tends to be closer to <inline-formula id="IE66"><mml:math id="IM66"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∩</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> when the trees are similar while moving toward <inline-formula id="IE67"><mml:math id="IM67"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∪</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> as the trees are less similar:
<disp-formula id="E4"><mml:math id="M4"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>σ</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∪</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∩</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:mi mathvariant="italic">min</mml:mi><mml:mo>{</mml:mo><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∩</mml:mo></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∪</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∪</mml:mo></mml:msub><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE68"><mml:math id="IM68"><mml:mrow><mml:mo>σ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="italic">e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">x</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the classic sigmoid function centered in 1/2 and <italic>μ</italic> is used to adjust the slopeness of the curve; we set <italic>μ </italic>= 10 in our experimentation. In addition, the sigmoid polarizes the values close to 1/2, thus helping to decide whether they are closer to 1 or 0, therefore, moving the final score closer to <inline-formula id="IE69"><mml:math id="IM69"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∩</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> or <inline-formula id="IE70"><mml:math id="IM70"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>∪</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
      <p>While all four measures are available in our implementation, we decided to use <inline-formula id="IE71"><mml:math id="IM71"><mml:mrow><mml:mi mathvariant="monospace">MP</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="monospace">3</mml:mi></mml:mrow><mml:mo>σ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> as default measure and is denoted simply as MP3. An experimental comparison of all four measures is shown in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Simulated data</title>
      <p>To perform our experiments, we follow an approach similar to the one performed in the study by <xref rid="btaa676-B11" ref-type="bibr">DiNardo <italic>et al.</italic> (2020)</xref>. We start from a base tree on which we apply a series of perturbations selected from: label swapping, label removal, label duplication, node swapping and node removal. Both the perturbations and the nodes and labels on which they are applied are chosen at random: our procedure allows to select a user-specified total number of actions and a probability vector that will be used to select the perturbations from the previous list.</p>
      <p>For the measure comparison experiments, we generated 30 perturbations from each of the 5 base trees, for a total of 150 trees. For the clustering evaluation, 3 base trees are entirely different from each other, and another 2 are perturbations of two of the others, to simulate similar subfamilies of the same tumor type: we perform a total of 10 perturbations on such 5 trees. More details on the perturbation parameters will be described in each section, while the entire configuration is available and reproducible at <ext-link ext-link-type="uri" xlink:href="https://github.com/AlgoLab/mp3treesim_supp">https://github.com/AlgoLab/mp3treesim_supp</ext-link>.</p>
    </sec>
    <sec>
      <title>3.2 Measures comparison</title>
      <p>We compared MP3 against all the different versions of DISC and CASet from the study by <xref rid="btaa676-B11" ref-type="bibr">DiNardo <italic>et al.</italic> (2020)</xref> and MLTD (<xref rid="btaa676-B25" ref-type="bibr">Karpov <italic>et al.</italic>, 2019</xref>). While MP3 and MLTD provide similarity scores, DISC and CASet compute a dissimilarity score, which we convert into a similarity measure by simply subtracting their value from 1.</p>
      <sec>
        <title>3.2.1 Effect of changes in the tree topology</title>
        <p>A key feature a measure on tumor phylogenies should have is to discern changes at different tree depths; indeed, a change close to the root should be more impactful than a change toward the leaves. Such a behavior is fundamental, as driver mutations are often acquired early in the evolutionary history, while less important passenger mutations usually happen at later stages: to mistake the two types of mutations should therefore have a high impact on a good similarity measure.</p>
        <p>To estimate this effect on all the measures, we start from a linear base tree [<italic>T</italic><sub>0</sub> in <xref ref-type="fig" rid="btaa676-F4">Fig. 4</xref> (<italic>left</italic>)]; we then raise its only leaf one level at the time and compute its similarity to the base tree, expecting a drop in similarity as the leaf raises to the root, similarly to experiment proposed in the study by <xref rid="btaa676-B11" ref-type="bibr">DiNardo <italic>et al.</italic> (2020)</xref>. <xref ref-type="fig" rid="btaa676-F4">Figure 4</xref> (<italic>left</italic>) clearly displays such effect for MP3, showing that it has the highest similarity decrease among all measures; DISC and CASet also have similar trends, but to a lower extent. Since the set of labels is the same for all trees, there is no difference between union and intersection versions of DISC and CASet. Contrarily, as already observed in the study by <xref rid="btaa676-B11" ref-type="bibr">DiNardo <italic>et al.</italic> (2020)</xref>, MLTD plateaus after the first change.
</p>
        <fig id="btaa676-F4" orientation="portrait" position="float">
          <label>Fig. 4.</label>
          <caption>
            <p>(<italic>Left</italic>) Effect of a node (highlighted in red) that ascends from leaf to child of the root, T<sub>0</sub> is the base tree to which the others are compared. (<italic>Right</italic>) Effect of label duplication on the similarity scores. Similarities are the average of 15 trees generated from the same base with the specified maximum number of duplications. MLTD was excluded since it failed to run on instances with poly-occurring labels</p>
          </caption>
          <graphic xlink:href="btaa676f4"/>
        </fig>
        <p>Another interesting aspect to investigate is how the presence of poly-occurring labels influences the similarity scores, as the more sophisticated the inference tools get, the more is common to have tumor phylogenies with multiple acquisitions or losses of the same mutation. To evaluate this aspect, we started from a multilabeled base tree with all labels occurring only once. We then created 15 perturbed trees for 5 different configurations. In the first one [on the abscissa 0 in <xref ref-type="fig" rid="btaa676-F4">Figure 4</xref>(<italic>right</italic>)], we allowed one operation excluding label duplication; for the others, we allowed a total of 1, 3, 5 and 7 operations with much higher chance of selecting a label duplication. Since perturbations occur randomly, we are only sure that at most the specified number of duplication occurred, and not necessarily to the same label.</p>
        <p><xref ref-type="fig" rid="btaa676-F4">Figure 4</xref>(<italic>right</italic>) shows that CASet<sub>∩</sub>, CASet<sub>∪</sub>, DISC<sub>∩</sub> and DISC<sub>∪</sub> have similar trends in this setting, MP3 being the only one that differs. In particular, the other measures assign a higher similarity score to the second configuration than to the first one, despite they are both obtained with one perturbing operation, allowing label duplication only in the second one. MP3 is the only measure that positively displays a monotonic decrease in similarity as the number of poly-occurring labels increases, being markedly steeper than the others. We believe that a larger steepness will be more informative than a plateauing curve, since while being true that after many of poly-occurrences no more information is gained, all the duplications will inevitably add more and more noise to the tree. Since MLTD assumes that every label appears only once, it failed to run on this experiment and was therefore excluded.</p>
      </sec>
      <sec>
        <title>3.2.2 Results on simulated data</title>
        <p>To analyze the differences between all measures, we designed two experimental settings: from 5 different base trees (available in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref>), we generated 30 perturbations for each class and computed similarities scores between all the 150 resulting trees. In the first configuration, we allowed a total of three operations excluding label duplications, while in the second one we allowed them. All the parameters and the different probabilities used for applying perturbations are available at our Supplementary Repository <ext-link ext-link-type="uri" xlink:href="https://github.com/AlgoLab/mp3treesim_supp">https://github.com/AlgoLab/mp3treesim_supp</ext-link>.</p>
        <p>Results for the first configuration are shown in <xref ref-type="fig" rid="btaa676-F5">Figure 5</xref>. The heatmaps (<italic>left</italic>) show that MP3 discerns the best between the trees in the same class (main diagonal) and the others: the results of DISC<sub>∪</sub> are really close to ours, but there is a more noticeable noise outside the main diagonal. DISC<sub>∩</sub> and CASet<sub>∪</sub> present even more noise than the others, but are still mostly able to distinguish the different classes; CASet<sub>∩</sub> seems to struggle the most on this setting, while MLTD displays high values of similarities for every couple of trees, but it is still able to differentiate between the bases.
</p>
        <fig id="btaa676-F5" orientation="portrait" position="float">
          <label>Fig. 5.</label>
          <caption>
            <p>Results for the first experimental configuration: (<italic>Left</italic>) Heatmaps displaying the scores between all-pairs 150 simulate trees. (<italic>Top-Right</italic>) Distribution of the similarities between the trees in the same class (intrasimilarity) and in different classes (intersimilarity). (<italic>Bottom-Right</italic>) Silhouette score computed using a hierarchical linkage clustering with cuts from 2 to 15</p>
          </caption>
          <graphic xlink:href="btaa676f5"/>
        </fig>
        <p>The boxplots in <xref ref-type="fig" rid="btaa676-F5">Figure 5</xref>(<italic>top-right</italic>) show the same result quantitatively: the crucial feature is to correctly distinguish the different classes. The values represent the distribution of the similarities between the trees in the same class (intrasimilarity) and in different classes (intersimilarity). MP3 differentiates better between intra- and intersimilarity, exhibiting the most compact distribution for the intersimilarities scores, while being a little more dispersed on the intrasimilarity due to the action of the sigmoid, that pulls apart the values around 1/2. Similarly to the previous case, DISC<sub>∪</sub>, CASet<sub>∪</sub> and MLTD show similar trends, while CASet<sub>∩</sub> displays the most overlapping distributions.</p>
        <p>Finally, in <xref ref-type="fig" rid="btaa676-F5">Figure 5</xref>(<italic>bottom-right</italic>), we computed a silhouette score from the data using a hierarchical linkage clustering with cuts from 2 to 15 to simulate a clustering scenario. Once again, MP3 performs the best expressing the maximum value for 5 cuts, being the five classes. DISC<sub>∩</sub>, DISC<sub>∪</sub> also show the largest value at the same cut. MLTD was excluded from the plot since it scored values close to –1 for every cut, thus causing the figure to be hard to interpret.</p>
        <p>In the second experimental setting, we introduced poly-occurring labels to the simulation. <xref ref-type="fig" rid="btaa676-F6">Figure 6</xref> exhibits results very similar to the previous ones. The main difference is that in the silhouette score (<italic>bottom-right</italic>) MP3, while still having its maximum value in correspondence of five cuts, is slightly lower than the other measures. On this experiment MLTD, not allowing poly-occurring labels, failed to compute the score in most of the instances, shown in gray in the heatmaps (<italic>left</italic>); it was excluded from the other plots given the high amount of failed runs. On the other hand, CASet and DISC accept input trees with poly-occurring labels, but they disregard the multiple occurrences of a same label, considering only one occurrence for each label in the computation.
</p>
        <fig id="btaa676-F6" orientation="portrait" position="float">
          <label>Fig. 6.</label>
          <caption>
            <p>Results for the second experimental configuration: (<italic>Left</italic>) Heatmaps displaying the scores between all the 150 simulate trees. (<italic>Top-Right</italic>) Distribution of the similarities between the trees in the same class (intrasimilarity) and in different classes (intersimilarity). (<italic>Bottom-Right</italic>) Silhouette score computed using a hierarchical linkage clustering with cuts from 2 to 15</p>
          </caption>
          <graphic xlink:href="btaa676f6"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>3.3 Application to clustering of trees</title>
      <p>A very important application of a tree similarity measure is clustering, e.g. to classify cancer type of patients by the similarity of their inferred phylogenies. This is of crucial interest for the development of precision therapies based on the topological structure and the evolution of mutations. Since to curate such classifications manually would be unfeasible as the size and the number of mutations increases, a good measure to use in conjunction with a clustering method is necessary.</p>
      <p>To evaluate a similar scenario, we started from three different bases, then perturbing two of such trees chosen at random; these new trees are then considered as additional base trees. Given this 5 bases, we created a total of 10 perturbed trees from each class. The goal was to simulate an experiment with three separate classes, with two of them further split in two subclasses, to obtain subtypes of the same cancer families. The five resulting bases are available in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref>, and the parameters used for the simulations are in our Supplementary Repository.</p>
      <p>Results for the clustering experiment are reported in <xref ref-type="fig" rid="btaa676-F7">Figure 7</xref>; <xref ref-type="fig" rid="btaa676-F7">Figure 7(a)</xref> shows the clustermaps computed using hierarchical linkage clustering. MP3, DISC<sub>∩</sub> and DISC<sub>∪</sub> correctly cluster the three main families as well as the two subfamilies, while both versions of CASet struggle the most in this experiment. <xref ref-type="fig" rid="btaa676-F7">Figure 7(b)</xref> displays the distribution of intra- and intersimilarity between the five bases; MP3 has the most compact intersimilarity distribution and is the only method that completely separates intra- and interdistributions. The high number of outliers for all methods is due to the high similarity of the two subclasses. To confirm this hypothesis, we computed the same distributions only for the three main classes, remapping the subclasses to the original corresponding base class in <xref ref-type="fig" rid="btaa676-F7">Figure 7(d)</xref>, where we note that the number of outliers is significantly reduced. Finally, <xref ref-type="fig" rid="btaa676-F7">Figure 7(c)</xref> shows the silhouette scores for the dataset; all measures express a higher score with three cuts, suggesting that the two subclasses are very similar to the two main bases they are derived from. The scores are very similar for all measures, with DISC<sub>∪</sub> having a higher value with three cuts and MP3 having a slightly higher with five clusters. CASet<sub>∩</sub> is the only method that have a much higher score in five, however, as shown in <xref ref-type="fig" rid="btaa676-F7">Figure 7(a)</xref>, the five clusters it reports are not the correct ones. MLTD was excluded from this experiment because it failed to run on most instances due to poly-occurring labels.
</p>
      <fig id="btaa676-F7" orientation="portrait" position="float">
        <label>Fig. 7.</label>
        <caption>
          <p>Results for the clustering experiment: (<bold>a</bold>) Clustermaps of the 50 simulated trees computed using hierarchical linkage clustering. (<bold>b</bold>) Distribution of the similarities between the trees in the same class (intrasimilarity) and in different classes (intersimilarity) for the 5 classes. The high number of outliers for all methods is due to the high similarity of the two subclasses. (<bold>c</bold>) Silhouette score computed using a hierarchical linkage clustering with cuts from 2 to 15. (<bold>d</bold>) Distribution of the similarities between the trees in the same class (intrasimilarity) and in different classes (intersimilarity) for the three main classes, remapping the subclasses to the original corresponding base. MLTD was excluded from this experiment because it failed to run on most instances due to the presence of poly-occurring labels</p>
        </caption>
        <graphic xlink:href="btaa676f7"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 Application to real dataset</title>
      <p>To further evaluate our similarity measure, we applied it to two publicly available real datasets: breast cancer xenoengraftment in immunodeficient mice (<xref rid="btaa676-B14" ref-type="bibr">Eirew <italic>et al.</italic>, 2015</xref>) and ultradeep-sequencing of clear cell renal-cell carcinoma (<xref rid="btaa676-B16" ref-type="bibr">Gerlinger <italic>et al.</italic>, 2014</xref>). Both datasets were previously considered for analyses by the two cancer phylogeny reconstruction methods LICHeE (<xref rid="btaa676-B30" ref-type="bibr">Popic <italic>et al.</italic>, 2015</xref>) and MIPUP (<xref rid="btaa676-B22" ref-type="bibr">Husić <italic>et al.</italic>, 2019</xref>). Data from the study by <xref rid="btaa676-B14" ref-type="bibr">Eirew <italic>et al.</italic> (2015)</xref> was also used in the study by <xref rid="btaa676-B11" ref-type="bibr">DiNardo <italic>et al.</italic> (2020)</xref> for evaluation. An interesting feature of the data in the study by <xref rid="btaa676-B16" ref-type="bibr">Gerlinger <italic>et al.</italic> (2014)</xref> is that most samples in the study present poly-occurring labels, suggesting recurrent mutations at different evolutionary stages. We recall that DISC and CASet compute dissimilarity scores, that we convert into a similarity measure subtracting their value from 1. All the analyzed trees are available in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref>.</p>
      <p>To evaluate the effectiveness of the measures in real scenarios, we selected the manually curated trees, published in the corresponding original sequencing studies, for case SA501 from the study by <xref rid="btaa676-B14" ref-type="bibr">Eirew <italic>et al.</italic> (2015)</xref> and for patient RMH002 from the study by <xref rid="btaa676-B16" ref-type="bibr">Gerlinger <italic>et al.</italic> (2014)</xref>. We then computed similarities between these reference trees and the ones inferred by LICHeE and MIPUP, as reported in the study by <xref rid="btaa676-B22" ref-type="bibr">Husić <italic>et al.</italic> (2019)</xref>.</p>
      <p>The reference RMH002 is very similar to the evolutions inferred by LICHeE and MIPUP, thus most of the measures agree on a high similarity score, as reported in <xref ref-type="fig" rid="btaa676-F8">Figure 8</xref>(<italic>left</italic>), with the exception of CASet<sub>∪</sub>. The scores computed by MP3 are higher than the others, possibly because it is the only method to correctly identify and process poly-occurring labels in the reference trees, due to the discovered recurring mutations. Differently from the previous analysis, the measures disagree considerably for SA501, as depicted in <xref ref-type="fig" rid="btaa676-F8">Figure 8</xref>(<italic>center</italic>). Indeed, MP3 reports a similarity value close to 0, suggesting that the considered trees are quite different, whereas the other measures report a higher similarity, especially DISC scoring up to 60% similarity.
</p>
      <fig id="btaa676-F8" orientation="portrait" position="float">
        <label>Fig. 8.</label>
        <caption>
          <p>(<italic>Left</italic>) Similarities between the manually curated tree reported by <xref rid="btaa676-B16" ref-type="bibr">Gerlinger <italic>et al.</italic> (2014)</xref> for patient RMH002 and the trees inferred by LICHeE and MIPUP. (<italic>Center</italic>) Similarities between the manually curated tree reported by <xref rid="btaa676-B14" ref-type="bibr">Eirew <italic>et al.</italic> (2015)</xref> for sample SA501 and the trees inferred by LICHeE and MIPUP. (<italic>Right</italic>) Similarities between the manually curated tree reported by <xref rid="btaa676-B14" ref-type="bibr">Eirew <italic>et al.</italic> (2015)</xref> for sample SA501 and the edge case with all mutations appearing in a single node</p>
        </caption>
        <graphic xlink:href="btaa676f8"/>
      </fig>
      <p>To thoroughly investigate this behavior, we defined some naïve approaches used as a proxy to analyze some basic aspects of the trees, such as the count of pairs of labels appearing in the same node in both trees. Even with such a naïve measure, the reference tree for SA501 from the study by <xref rid="btaa676-B14" ref-type="bibr">Eirew <italic>et al.</italic> (2015)</xref> and the trees inferred by MIPUP and LICHeE disagree considerably. The base tree contains only 50 labels, whereas the trees inferred by LICHeE and MIPUP contain 95 and 158 labels, respectively; of these, the reference shares a total of 24 label with LICHeE and 37 with MIPUP. Most importantly, only 54 out of 1759 pairs of labels appear in the same node both in the reference and LICHeE and 124 out of 8424 in MIPUP. Such evaluations, albeit very simplistic, suggest that the trees are indeed dissimilar and thus a lower score, as provided by MP3, is more reasonable than a high value of similarity.</p>
      <p>To better understand this phenomenon, we created the edge case of a single-node tree with all the 158 labels from MIPUP, and compared it against the reference SA501. The resulting values in <xref ref-type="fig" rid="btaa676-F8">Figure 8</xref>(<italic>right</italic>) show a high similarity score for DISC with values up to 69%, with CASet and MLTD being less influenced by this aspect with scores up to 11 and 20%. On the other hand, MP3 clearly defines the trees as extremely dissimilar, with a score of 0.04%. Such results for trees that are clearly extremely different show a strong bias for DISC toward high similarity values.</p>
    </sec>
    <sec>
      <title>3.5 Application to clustering of patients</title>
      <p>As a final evaluation of the measures, we computed a clustering of 36 medulloblastoma patients from the study by <xref rid="btaa676-B21" ref-type="bibr">Hovestadt <italic>et al.</italic> (2019)</xref>; the patients are classified according to four different subtypes of tumor. From the available scRNA-seq data, we inferred the cancer phylogeny of each patient using SCITE (<xref rid="btaa676-B23" ref-type="bibr">Jahn <italic>et al.</italic>, 2016</xref>); we then computed the similarities between all the inferred trees and used them to perform a hierarchical clustering.</p>
      <p><xref ref-type="fig" rid="btaa676-F9">Figure 9</xref> displays the clustering results for all the measures; in particular, using MP3 is possible to distinctively group the patients in their relative subtypes with only a few mismatched trees. A similar result is achieved by CASet<sub>∩</sub>, while the other measures tend to cluster together subtypes SHH and WNT, without a clear distinction between them.
</p>
      <fig id="btaa676-F9" orientation="portrait" position="float">
        <label>Fig. 9.</label>
        <caption>
          <p>Results for the clustering experiment: Hierarchical clustering obtained from 36 medulloblastoma patients (Hovestadt <italic>et al.</italic>, 2019). The trees were computed from the available scRNA-seq datasets using the inference tool SCITE (<xref rid="btaa676-B23" ref-type="bibr">Jahn <italic>et al.</italic>, 2016</xref>). The colors indicate the true tumor subtype of each patient</p>
        </caption>
        <graphic xlink:href="btaa676f9"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We identified two major limitations in the existing methods to compare tumor phylogenies: first, they are not sensitive enough to detect even major differences in the topology of the trees, as we demonstrated with <italic>ad hoc</italic> experiments. Second, they are not able to meaningfully compare trees where the same label is assigned to more than one node.</p>
    <p>We addressed the latter by representing tumor phylogenies as multilabeled trees with poly-occurring labels. Such model is best suited to cancer progression than the ones previously adopted, as it allows the same mutation to appear in multiple evolutionary events, a circumstance often occurring in real applications. Being inspired by the triplet distance for classical phylogenies, our new similarity measure correctly detects differences in the topology of the trees.</p>
    <p>Our experiments show that our method performs very well both on synthetic and real data and, unlike the other existing tools, it is able to detect differences regarding poly-occurring labels and it suitably distinguish trees with different topologies. Moreover, when applied to hierarchical clustering, it outperforms every other method.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btaa676_Supplementary_Data</label>
      <media xlink:href="btaa676_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors acknowledge Iman Hajirasouliha, Victoria Popic and Murray Patterson for many illuminating discussions on tumor phylogenies.</p>
    <sec>
      <title>Funding</title>
      <p>This project received funding from the European Union’s Horizon 2020 research and innovation programme under the Marie Skłodowska-Curie [872539].</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa676-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aguse</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Summarizing the solution space in tumor phylogeny inference by multiple consensus trees</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>i408</fpage>–<lpage>i416</lpage>.<pub-id pub-id-type="pmid">31510657</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aho</surname><given-names>A.V.</given-names></string-name></person-group><etal>et al</etal> (<year>1981</year>) 
<article-title>Inferring a tree from lowest common ancestors with an application to the optimization of relational expressions</article-title>. <source>SIAM J. Comput</source>., <volume>10</volume>, <fpage>405</fpage>–<lpage>421</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa676-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Bernardini</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) A rearrangement distance for fully-labelled trees. In: <italic>30th Annual Symposium on Combinatorial Pattern Matching (CPM 2019).</italic> Schloss Dagstuhl-Leibniz-Zentrum fuer Informatik. Dagsthl, Germany, pp. 28:1-28:15</mixed-citation>
    </ref>
    <ref id="btaa676-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Bernardini</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) On two measures of distance between fully-labelled trees. In: Gørtz,I.L. and Weimann,O. (eds.) <italic>31st Annual Symposium on Combinatorial Pattern Matching (CPM 2020)</italic>, volume 161 of <italic>Leibniz International Proceedings in Informatics (LIPIcs)</italic>. Schloss Dagstuhl–Leibniz-Zentrum für Informatik, Dagstuhl, Germany, pp. <fpage>6:1</fpage>–<lpage>6:16</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa676-B4960596">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonizzoni</surname>,<given-names>P.</given-names></string-name><etal>et al</etal>. (2019) </person-group><article-title>Does Relaxing the Infinite Sites Assumption Give Better Tumor Phylogenies? An ILP-Based Comparative Approach</article-title>. <source><italic toggle="yes">IEEE/ACM Transactions on Computational Biology and Bioinformatics</italic></source>, <volume>16</volume>, <fpage>1410</fpage>–<lpage>1423</lpage>. <pub-id pub-id-type="doi">10.1109/TCBB.2018.2865729</pub-id><pub-id pub-id-type="pmid">31603766</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Bonizzoni</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) Beyond perfect phylogeny: multisample phylogeny reconstruction via ilp. In: <italic>Proceedings of the 8th ACM International Conference on Bioinformatics, Computational Biology, and Health Informatics</italic>, Association for Computing Machinery, New York, NY, USA, pp. <fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa676-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Brodal</surname><given-names>G.S.</given-names></string-name></person-group><etal>et al</etal> (<year>2013</year>) Efficient algorithms for computing the triplet and quartet distance between trees of arbitrary degree. In <italic>Proceedings of the twenty-fourth annual ACM-SIAM symposium on Discrete algorithms</italic>. SIAM, New Orleans, LA, USA, pp. <fpage>1814</fpage>–<lpage>1832</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa676-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brown</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Phylogenetic analysis of metastatic progression in breast cancer using somatic mutations and copy number aberrations</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>14944</fpage>.<pub-id pub-id-type="pmid">28429735</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ciccolella</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>a) GPPS: an ilp-based approach for inferring cancer progression with mutation losses from single cell data. In: <italic>2018 IEEE 8th International Conference on Computational Advances in Bio and Medical Sciences (ICCABS)</italic>, Las Vegas, NV, 2018, pp. <fpage>1</fpage>–<lpage>1</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa676-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ciccolella</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>b) 
<article-title>Inferring cancer progression from single-cell sequencing while allowing mutation losses</article-title>. <source>bioRxiv</source>.</mixed-citation>
    </ref>
    <ref id="btaa676-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DiNardo</surname><given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) 
<article-title>Distance measures for tumor evolutionary trees</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>2090</fpage>–<lpage>2097</lpage>.<pub-id pub-id-type="pmid">31750900</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B12">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Dobson</surname><given-names>A.J.</given-names></string-name></person-group> (<year>1975</year>) <chapter-title>Comparing the shapes of trees</chapter-title>. In: <source>Combinatorial Mathematics III</source>. 
<publisher-name>Springer</publisher-name> Berlin Heidelberg, Berlin, Heidelberg, Germany, pp. <fpage>95</fpage>–<lpage>100</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa676-B13">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Dudek</surname><given-names>B.</given-names></string-name>, <string-name><surname>Gawrychowski</surname><given-names>P.</given-names></string-name></person-group> (<year>2019</year>) Computing quartet distance is equivalent to counting 4-cycles. In <italic>Proceedings of the 51st Annual ACM SIGACT Symposium on Theory of Computing</italic>, Association for Computing Machinery, New York, NY, USA, pp <fpage>733</fpage>–<lpage>743</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa676-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eirew</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Dynamics of genomic clones in breast cancer patient xenografts at single-cell resolution</article-title>. <source>Nature</source>, <volume>518</volume>, <fpage>422</fpage>–<lpage>426</lpage>.<pub-id pub-id-type="pmid">25470049</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>El-Kebir</surname><given-names>M.</given-names></string-name></person-group> (<year>2018</year>) 
<article-title>SPhyR: tumor phylogeny estimation from single-cell sequencing data under loss and error</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>i671</fpage>–<lpage>i679</lpage>.<pub-id pub-id-type="pmid">30423070</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gerlinger</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Genomic architecture and evolution of clear cell renal cell carcinomas defined by multiregion sequencing</article-title>. <source>Nat. Genet</source>., <volume>46</volume>, <fpage>225</fpage>–<lpage>233</lpage>.<pub-id pub-id-type="pmid">24487277</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Govek</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) A consensus approach to infer tumor evolutionary histories. In <italic>Proceedings of the 2018 ACM International Conference on Bioinformatics, Computational Biology, and Health Informatics</italic>, BCB ’18. Association for Computing Machinery, New York, NY, USA, pp. <fpage>63</fpage>–<lpage>72</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa676-B19">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hajirasouliha</surname><given-names>I.</given-names></string-name>, <string-name><surname>Raphael</surname><given-names>B.J.</given-names></string-name></person-group> (<year>2014</year>) <italic>Reconstructing Mutational History in Multiply Sampled Tumors Using Perfect Phylogeny Mixtures</italic>. Lecture Notes in Computer Science. Springer Nature, Berlin, Heidelberg, Germany, pp. <fpage>354</fpage>–<lpage>367</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa676-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hajirasouliha</surname><given-names>I.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>A combinatorial approach for analyzing intra-tumor heterogeneity from high-throughput sequencing data</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>i78</fpage>–<lpage>i86</lpage>.<pub-id pub-id-type="pmid">24932008</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hovestadt</surname><given-names>V.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Resolving medulloblastoma cellular architecture by single-cell genomics</article-title>. <source>Nature</source>, <volume>572</volume>, <fpage>74</fpage>–<lpage>79</lpage>.<pub-id pub-id-type="pmid">31341285</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Husić</surname><given-names>E.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>MIPUP: minimum perfect unmixed phylogenies for multi-sampled tumors via branchings and ilp</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>769</fpage>–<lpage>777</lpage>.<pub-id pub-id-type="pmid">30101335</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jahn</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Tree inference for single-cell data</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>86</fpage>.<pub-id pub-id-type="pmid">27149953</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jansson</surname><given-names>J.</given-names></string-name>, <string-name><surname>Rajaby</surname><given-names>R.</given-names></string-name></person-group> (<year>2017</year>) 
<article-title>A more practical algorithm for the rooted triplet distance</article-title>. <source>J. Comput. Biol</source>., <volume>24</volume>, <fpage>106</fpage>–<lpage>126</lpage>.<pub-id pub-id-type="pmid">27983874</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karpov</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>A multi-labeled tree dissimilarity measure for comparing “clonal trees” of tumor progression</article-title>. <source>Algorithms Mol. Biol</source>., <volume>14</volume>, <fpage>17</fpage>.<pub-id pub-id-type="pmid">31372179</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuipers</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Single-cell sequencing data reveal widespread recurrence and loss of mutational hits in the life histories of tumors</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>1885</fpage>–<lpage>1894</lpage>.<pub-id pub-id-type="pmid">29030470</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Malikic</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>a) 
<article-title>Integrative inference of subclonal tumour evolution from single-cell and bulk sequencing data</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>2750</fpage>.<pub-id pub-id-type="pmid">31227714</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Malikic</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>b) 
<article-title>Phiscs: a combinatorial approach for subperfect tumor phylogeny reconstruction via integrative use of single-cell and bulk sequencing data</article-title>. <source>Genome Res</source>., <volume>29</volume>, <fpage>1860</fpage>–<lpage>1877</lpage>.<pub-id pub-id-type="pmid">31628256</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morrissy</surname><given-names>A.S.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Divergent clonal selection dominates medulloblastoma at recurrence</article-title>. <source>Nature</source>, <volume>529</volume>, <fpage>351</fpage>– <lpage>357</lpage>.<pub-id pub-id-type="pmid">26760213</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Popic</surname><given-names>V.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Fast and scalable inference of multi-sample cancer lineages</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>91</fpage>.<pub-id pub-id-type="pmid">25944252</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Clonal evolution of glioblastoma under therapy</article-title>. <source>Nat. Genet</source>., <volume>48</volume>, <fpage>768</fpage>– <lpage>776</lpage>.<pub-id pub-id-type="pmid">27270107</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yuan</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Bitphylogeny: a probabilistic framework for reconstructing intra-tumor phylogenies</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>36</fpage>.<pub-id pub-id-type="pmid">25786108</pub-id></mixed-citation>
    </ref>
    <ref id="btaa676-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zafar</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Sifit: inferring tumor trees from single-cell sequencing data under finite-sites models</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>178</fpage>.<pub-id pub-id-type="pmid">28927434</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
