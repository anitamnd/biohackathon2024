<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1009309.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9009674</article-id>
    <article-id pub-id-type="pmid">35377867</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009309</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-21-01288</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
            <subj-group>
              <subject>Breast Tumors</subject>
              <subj-group>
                <subject>Breast Cancer</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Similarity Measures</subject>
              <subj-group>
                <subject>Cosine Similarity</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Nephrology</subject>
          <subj-group>
            <subject>Renal Cancer</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
            <subj-group>
              <subject>Genitourinary Tract Tumors</subject>
              <subj-group>
                <subject>Prostate Cancer</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Urology</subject>
          <subj-group>
            <subject>Prostate Diseases</subject>
            <subj-group>
              <subject>Prostate Cancer</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
            <subj-group>
              <subject>Carcinoma</subject>
              <subj-group>
                <subject>Hepatocellular Carcinoma</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
            <subj-group>
              <subject>Gastrointestinal Tumors</subject>
              <subj-group>
                <subject>Hepatocellular Carcinoma</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Gastroenterology and Hepatology</subject>
          <subj-group>
            <subject>Liver Diseases</subject>
            <subj-group>
              <subject>Hepatocellular Carcinoma</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Mutagenesis</subject>
            <subj-group>
              <subject>Mutagens</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Structures and Organelles</subject>
            <subj-group>
              <subject>Extracellular Matrix</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Mutation</subject>
            <subj-group>
              <subject>Substitution Mutation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SUITOR: Selecting the number of mutational signatures through cross-validation</article-title>
      <alt-title alt-title-type="running-head">Selecting the number of mutational signatures</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Donghyuk</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4088-3859</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Difei</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4451-8664</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Xiaohong R.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8606-4707</contrib-id>
        <name>
          <surname>Shi</surname>
          <given-names>Jianxin</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Landi</surname>
          <given-names>Maria Teresa</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0172-5516</contrib-id>
        <name>
          <surname>Zhu</surname>
          <given-names>Bin</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Statistics, Pusan National University, Busan, Korea</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Division of Cancer Epidemiology and Genetics, National Cancer Institute, National Institutes of Health, Bethesda, Maryland, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Panchenko</surname>
          <given-names>Anna R</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Queen’s University, CANADA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>bin.zhu@nih.gov</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <volume>18</volume>
    <issue>4</issue>
    <elocation-id>e1009309</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>3</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="cc0license">https://creativecommons.org/publicdomain/zero/1.0/</ali:license_ref>
        <license-p>This is an open access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">Creative Commons CC0</ext-link> public domain dedication.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1009309.pdf"/>
    <abstract>
      <p>For <italic toggle="yes">de novo</italic> mutational signature analysis, the critical first step is to decide how many signatures should be expected in a cancer genomics study. An incorrect number could mislead downstream analyses. Here we present SUITOR (Selecting the nUmber of mutatIonal signaTures thrOugh cRoss-validation), an unsupervised cross-validation method that requires little assumptions and no numerical approximations to select the optimal number of signatures without overfitting the data. <italic toggle="yes">In vitro</italic> studies and <italic toggle="yes">in silico</italic> simulations demonstrated that SUITOR can correctly identify signatures, some of which were missed by other widely used methods. Applied to 2,540 whole-genome sequenced tumors across 22 cancer types, SUITOR selected signatures with the smallest prediction errors and almost all signatures of breast cancer selected by SUITOR were validated in an independent breast cancer study. SUITOR is a powerful tool to select the optimal number of mutational signatures, facilitating downstream analyses with etiological or therapeutic importance.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Mutational signatures are the footprints of exogenous exposures and endogenous mutational processes on the cancer genomes. To estimate <italic toggle="yes">de novo</italic> mutational signatures, the first step is to decide how many signatures should be extracted in a cancer genomics study, which determines downstream analytical steps and has been insufficiently studied. We developed SUITOR, an unsupervised cross-validation method to select the optimal number of signatures without overfitting the data. We demonstrated SUITOR’s superior performance using <italic toggle="yes">in vitro</italic> experimental studies, <italic toggle="yes">in silico</italic> simulations and <italic toggle="yes">in vivo</italic> pan-cancer applications of 2,540 whole-genome sequenced tumors across 22 cancer types, and validated signatures of breast cancer in additional 440 breast tumors. SUITOR advances the methodological frontier of identifying <italic toggle="yes">de novo</italic> mutational signatures and would help discover the causes of cancer and the means of cancer prevention and treatment.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000054</institution-id>
            <institution>national cancer institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Intramural Research Program</award-id>
      </award-group>
      <funding-statement>This research was supported by the Intramural Research Program of the National Institutes of Health, National Cancer Institute, Division of Cancer Epidemiology and Genetics (DCEG). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="0"/>
      <page-count count="27"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2022-04-14</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the manuscript and its <xref rid="sec023" ref-type="sec">Supporting Information</xref> files. SUITOR: <ext-link xlink:href="https://github.com/binzhulab/SUITOR" ext-link-type="uri">https://github.com/binzhulab/SUITOR</ext-link> In vitro studies <ext-link xlink:href="http://medgen.medschl.cam.ac.uk/serena-nik-zainal/" ext-link-type="uri">http://medgen.medschl.cam.ac.uk/serena-nik-zainal/</ext-link> Sanger whole genome sequencing breast cancer study <ext-link xlink:href="ftp://ftp.sanger.ac.uk/pub/cancer/Nik-ZainalEtAl-560BreastGenomes" ext-link-type="ftp">ftp://ftp.sanger.ac.uk/pub/cancer/Nik-ZainalEtAl-560BreastGenomes</ext-link> (Note: it’s an FTP site. For Mac OS, please use the Finder window to access it; for Windows, use the File Explorer in Windows 8, or Windows Explorer in previous versions; the FTP site can also be accessed by FTP Clients, such as FileZilla, WinSCP and CyberDuck.) The Pan-Cancer Analysis of Whole Genomes (PCAWG) study <ext-link xlink:href="https://www.synapse.org/#!Synapse:syn11726620" ext-link-type="uri">https://www.synapse.org/#!Synapse:syn11726620</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the manuscript and its <xref rid="sec023" ref-type="sec">Supporting Information</xref> files. SUITOR: <ext-link xlink:href="https://github.com/binzhulab/SUITOR" ext-link-type="uri">https://github.com/binzhulab/SUITOR</ext-link> In vitro studies <ext-link xlink:href="http://medgen.medschl.cam.ac.uk/serena-nik-zainal/" ext-link-type="uri">http://medgen.medschl.cam.ac.uk/serena-nik-zainal/</ext-link> Sanger whole genome sequencing breast cancer study <ext-link xlink:href="ftp://ftp.sanger.ac.uk/pub/cancer/Nik-ZainalEtAl-560BreastGenomes" ext-link-type="ftp">ftp://ftp.sanger.ac.uk/pub/cancer/Nik-ZainalEtAl-560BreastGenomes</ext-link> (Note: it’s an FTP site. For Mac OS, please use the Finder window to access it; for Windows, use the File Explorer in Windows 8, or Windows Explorer in previous versions; the FTP site can also be accessed by FTP Clients, such as FileZilla, WinSCP and CyberDuck.) The Pan-Cancer Analysis of Whole Genomes (PCAWG) study <ext-link xlink:href="https://www.synapse.org/#!Synapse:syn11726620" ext-link-type="uri">https://www.synapse.org/#!Synapse:syn11726620</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Background</title>
    <p>Mutational signatures are patterns of somatic mutations imprinted on the cancer genome by operative mutational processes, including signatures of single base substitution [<xref rid="pcbi.1009309.ref001" ref-type="bibr">1</xref>], doublet base substitutions [<xref rid="pcbi.1009309.ref001" ref-type="bibr">1</xref>], structural variations [<xref rid="pcbi.1009309.ref002" ref-type="bibr">2</xref>,<xref rid="pcbi.1009309.ref003" ref-type="bibr">3</xref>] and copy number alterations [<xref rid="pcbi.1009309.ref004" ref-type="bibr">4</xref>–<xref rid="pcbi.1009309.ref006" ref-type="bibr">6</xref>]. For example, seventy-eight single base substitution mutational signatures have been identified across cancer types (<ext-link xlink:href="https://cancer.sanger.ac.uk/signatures/" ext-link-type="uri">https://cancer.sanger.ac.uk/signatures/</ext-link>) [<xref rid="pcbi.1009309.ref001" ref-type="bibr">1</xref>,<xref rid="pcbi.1009309.ref007" ref-type="bibr">7</xref>], with some associated with exogenous mutagenic exposures [<xref rid="pcbi.1009309.ref008" ref-type="bibr">8</xref>–<xref rid="pcbi.1009309.ref010" ref-type="bibr">10</xref>] and endogenous mutational processes [<xref rid="pcbi.1009309.ref011" ref-type="bibr">11</xref>–<xref rid="pcbi.1009309.ref014" ref-type="bibr">14</xref>]. Moreover, mutational signatures have been associated with cancer predisposition genes (e.g., <italic toggle="yes">NTHL1</italic> in multiple cancer types [<xref rid="pcbi.1009309.ref015" ref-type="bibr">15</xref>], including breast cancer [<xref rid="pcbi.1009309.ref016" ref-type="bibr">16</xref>]), and used to stratify cancer patients [<xref rid="pcbi.1009309.ref017" ref-type="bibr">17</xref>–<xref rid="pcbi.1009309.ref020" ref-type="bibr">20</xref>] for precision treatment. In these studies, deciding the expected number of signatures is the pivotal first step, which determines the downstream steps of extracting signature profiles, estimating signature activities and stratifying tumors based on signatures for treatment. As an example, the Pan-Cancer Analysis of Whole Genomes (PCAWG) consortium reported that the discordance between the extracted and known signatures is usually caused by the difficulty in selecting the correct number of signatures [<xref rid="pcbi.1009309.ref001" ref-type="bibr">1</xref>].</p>
    <p>There are two main types of mutational signatures analysis [<xref rid="pcbi.1009309.ref021" ref-type="bibr">21</xref>–<xref rid="pcbi.1009309.ref023" ref-type="bibr">23</xref>]: signature extraction and signature refitting. Signature extraction aims to extract <italic toggle="yes">de novo</italic> signature profiles [<xref rid="pcbi.1009309.ref024" ref-type="bibr">24</xref>–<xref rid="pcbi.1009309.ref028" ref-type="bibr">28</xref>] while signature refitting to estimate signature activities based on reference mutational signatures with potential applicability in the clinical setting [<xref rid="pcbi.1009309.ref029" ref-type="bibr">29</xref>,<xref rid="pcbi.1009309.ref030" ref-type="bibr">30</xref>]. Our interest is on selecting the correct number of <italic toggle="yes">de novo</italic> mutational signatures for signature extraction in cancer genomics studies [<xref rid="pcbi.1009309.ref031" ref-type="bibr">31</xref>,<xref rid="pcbi.1009309.ref032" ref-type="bibr">32</xref>], which has been insufficiently explored. SomaticSignatures [<xref rid="pcbi.1009309.ref024" ref-type="bibr">24</xref>] measures the goodness of fit of the number of signatures based on the residual sum of squares and the explained variance with no automatic selection criterion. SigProfilerExtractor [<xref rid="pcbi.1009309.ref025" ref-type="bibr">25</xref>] considers the mean reconstruction error and the stability of signature extraction; however, it is unclear how these features could be combined to jointly predict the number of signatures. EMu [<xref rid="pcbi.1009309.ref026" ref-type="bibr">26</xref>] and signeR [<xref rid="pcbi.1009309.ref027" ref-type="bibr">27</xref>] adopt a Bayesian information criterion (BIC) [<xref rid="pcbi.1009309.ref033" ref-type="bibr">33</xref>]. Although BIC is a popular model selection criterion for supervised learning (e.g., regression and classification) where the number of parameters is fixed, it may not be applicable to unsupervised learning, including mutational signature analysis, where the number of parameters increases with the sample size (other limitations of BIC are elaborated in Supplementary Note 1 in <xref rid="pcbi.1009309.s012" ref-type="supplementary-material">S1 Text</xref>). SignatureAnalyzer [<xref rid="pcbi.1009309.ref001" ref-type="bibr">1</xref>] uses an automatic relevance determination (ARD) prior [<xref rid="pcbi.1009309.ref034" ref-type="bibr">34</xref>] which imposes a sparsity assumption on mutation profiles and activities. The number of signatures chosen by SignatureAnalyzer is sensitive to the pre-specified sparsity assumption, especially hyperparameters of the ARD prior and the tolerance level.</p>
    <p>To overcome the limitations of previous methods, we propose selecting the number of signatures through cross-validation. Selecting the number of signatures is essentially a problem of model selection, which has been addressed by cross-validation in other research areas [<xref rid="pcbi.1009309.ref035" ref-type="bibr">35</xref>,<xref rid="pcbi.1009309.ref036" ref-type="bibr">36</xref>], including identification of cancer subtypes [<xref rid="pcbi.1009309.ref037" ref-type="bibr">37</xref>], exploration of population structure [<xref rid="pcbi.1009309.ref038" ref-type="bibr">38</xref>] and prediction of lymph node metastasis [<xref rid="pcbi.1009309.ref039" ref-type="bibr">39</xref>]. In the setting of mutational signature analysis, cross-validation splits the full dataset (here, the mutation counts) into a training set and a validation set; for a given number of signatures, these signatures are estimated in the training set and then they are used to predict the mutations in the validation set. Multiple candidate numbers of signatures are considered; and the number of signatures which predicts most closely the mutations in the validation (not the training) set is selected. Hence, cross-validation can prevent selecting too few or too many signatures (corresponding to an underfitting or overfitting model), both of which would predict mutation counts in the validation set poorly. In addition, unlike the BIC or the ARD prior, cross-validation requires little assumptions and no numerical approximations [<xref rid="pcbi.1009309.ref036" ref-type="bibr">36</xref>]. Therefore, cross-validation provides a viable solution for selecting the correct number of signatures.</p>
    <p>Despite being conceptually appealing, the standard cross-validation approach does not work for unsupervised mutational signature analysis. In the standard cross-validation scheme for the supervised learning (e.g., regression or classification in machine learning), it is feasible to remove a subset of subjects all together as a validation set. In contrast, cross-validation for mutational signature analysis requires retaining all tumors in the training set but removing some mutation counts from each tumor as a validation set. Consequently, missing data emerge in the training set and current methods for mutational signature analysis are inapplicable for cross-validation.</p>
    <p>These limitations are overcome by SUITOR (Selecting the nUmber of mutatIonal signaTures thrOugh cRoss-validation), an unsupervised cross-validation method that selects the optimal number of signatures to attain the minimal prediction error in the validation set. SUITOR extends the probabilistic model to allow missing data in the training set, which makes cross-validation feasible. Moreover, we propose an expectation/conditional maximization (ECM) algorithm [<xref rid="pcbi.1009309.ref040" ref-type="bibr">40</xref>] to extract signature profiles, estimate signature activities and impute the missing data simultaneously. We demonstrated SUITOR’s superior performance using <italic toggle="yes">in vitro</italic> experimental data, <italic toggle="yes">in silico</italic> simulations, <italic toggle="yes">in vivo</italic> applications to 2,540 tumors across 22 cancer types, and validation of signatures of breast cancer in additional 440 breast tumors. Recently, other cross-validation methods have been proposed to select the number of signatures; compared to SUITOR, CV2K focuses on selecting the number of signatures only (without extracting signature profiles and estimating signature activities) and is based on random, not balanced separation [<xref rid="pcbi.1009309.ref041" ref-type="bibr">41</xref>]; SparseSignatures applies cross-validation to select both the number of signatures and the shrinkage parameter simultaneously, which is computationally intensive and tends to infer signatures with spiking profiles [<xref rid="pcbi.1009309.ref042" ref-type="bibr">42</xref>].</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>Overview of SUITOR</title>
      <p>Mutational signature analysis decomposes the somatic mutation type matrix. Take single base substitution (SBS) as an example. A somatic mutation type matrix <bold>V</bold> of size 96×N contains mutation counts for N cancer genomes and 96 SBS types. Each SBS type refers to a mutated pyrimidine (C or T) in the center and two unmutated adjacent nucleotides (flanking 5’ and 3’ bases) with total 4×6×4 = 96 types. For example, a genomic sequence A<underline>C</underline>G in the normal tissue is mutated to A<underline>G</underline>G in the tumor tissue. This SBS belongs to the A[C &gt; G]G mutation type.</p>
      <p>SUITOR is built upon a probabilistic model [<xref rid="pcbi.1009309.ref043" ref-type="bibr">43</xref>,<xref rid="pcbi.1009309.ref044" ref-type="bibr">44</xref>], for which the maximum likelihood estimation (MLE) is equivalent to the solution of non-negative matrix factorization (NMF), the most popular method for mutational signature analysis [<xref rid="pcbi.1009309.ref025" ref-type="bibr">25</xref>]. More details are included in Methods section. NMF or equivalently the Poisson NMF model requires a given number of signatures <italic toggle="yes">r</italic>, which is unknown in practice; and SUITOR can select this number empirically. The steps of SUITOR are outlined as follows (with a schematic illustration in <xref rid="pcbi.1009309.g001" ref-type="fig">Fig 1</xref>): 1) the mutation type matrix is separated into the training and validation sets. The training set contains missing data held out as validation data; 2) the missing data are imputed in the initial step; 3) the ECM algorithm iteratively imputes the missing data in the expectation step (E-step) and estimates the signature activities (of the <bold>H</bold> matrix) and profiles (of the <bold>W</bold> matrix) in the conditional maximization steps (CM-steps) until the ECM algorithm allows <bold>V</bold>≈<bold>WH</bold> for a given number of signatures; 4) the missing data are imputed and compared to the validation data to calculate the prediction error in the validation set; 5) the above described steps are conducted for multiple candidate numbers of signatures and the one with the minimal prediction error will be chosen as the optimal number of signatures (corresponding to the red dot in the prediction error curve of validation set in <xref rid="pcbi.1009309.g001" ref-type="fig">Fig 1</xref>).</p>
      <fig position="float" id="pcbi.1009309.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009309.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>A schematic overview of SUITOR.</title>
          <p>This schematic diagram illustrates how SUITOR selects the number of <italic toggle="yes">de novo</italic> mutational signatures. Details are given in Results. Each column of the mutation type matrix <bold><italic toggle="yes">V</italic></bold> represents a tumor, each row a mutation type. The bottom left shows prediction error curves in the training set (blue) and validation set (red), which are manually drawn for the illustration purpose, with the red dot representing the minimal prediction error in the validation set. ECM algorithm: expectation/conditional maximization algorithm; CM-steps: conditional maximization steps; E-step: expectation step; <bold>W</bold>: signature profile matrix of size 96×<italic toggle="yes">r</italic>,<italic toggle="yes">r</italic> the number of signatures; <bold>H</bold>: signature activity matrix of size <italic toggle="yes">r</italic>×N, N the number of tumor; <italic toggle="yes">Q</italic>(<bold><italic toggle="yes">W</italic></bold>,<bold><italic toggle="yes">H</italic></bold>|<bold><italic toggle="yes">W</italic></bold><sup><bold><italic toggle="yes">t</italic></bold></sup>,<bold><italic toggle="yes">H</italic></bold><sup><bold><italic toggle="yes">t</italic></bold></sup>): conditional expectation of complete likelihood of <bold>W</bold> and <bold>H</bold> at the (<italic toggle="yes">t</italic>+1)-th step, given estimated <bold><italic toggle="yes">W</italic></bold><sup><bold><italic toggle="yes">t</italic></bold></sup> and <bold><italic toggle="yes">H</italic></bold><sup><bold><italic toggle="yes">t</italic></bold></sup> in the <italic toggle="yes">t</italic>-th step of ECM algorithm.</p>
        </caption>
        <graphic xlink:href="pcbi.1009309.g001" position="float"/>
      </fig>
      <p>There are three key contributions of SUITOR. First, SUITOR selects the number of signatures with the minimal prediction error, which prevents selecting too few or too many signatures (as model underfitting or overfitting). Although the prediction error in the training set is reduced with increasing signatures (as illustrated by the prediction error curve of the training set in <xref rid="pcbi.1009309.g001" ref-type="fig">Fig 1</xref>), the prediction error in the validation set will decrease first (due to the model underfitting with insufficient signatures) and then inflate (due to the model overfitting with redundant signatures). This is the well-known bias-variance tradeoff for model complexity [<xref rid="pcbi.1009309.ref045" ref-type="bibr">45</xref>] measured by the number of signatures in the setting of mutational signature analysis. Second, the cross-validation scheme of SUITOR guarantees that the missing data pattern does not depend on the remaining or missing mutation counts in the training set. Hence, the missing data mechanism is missing completely at random (MCAR), which ensures that the estimated signature profiles and activities would not be biased due to the missing data [<xref rid="pcbi.1009309.ref046" ref-type="bibr">46</xref>]. Third, the proposed ECM algorithm for SUITOR enjoys the convergence property, which guarantees the increase of the likelihood function over iterations until the ECM algorithm converges [<xref rid="pcbi.1009309.ref040" ref-type="bibr">40</xref>].</p>
    </sec>
    <sec id="sec004">
      <title>Evaluation of SUITOR in two <italic toggle="yes">in vitro</italic> studies</title>
      <p>We assessed the performance of SUITOR in two experimental studies [<xref rid="pcbi.1009309.ref008" ref-type="bibr">8</xref>,<xref rid="pcbi.1009309.ref011" ref-type="bibr">11</xref>], for which the true number and profile of signatures were generated experimentally and validated <italic toggle="yes">in vitro</italic> (see details in <xref rid="sec010" ref-type="sec">Methods</xref>). The first study created endogenous mutational signatures through CRISPR-Cas9-mediated knockouts of DNA repair genes in an isogenic human cell line [<xref rid="pcbi.1009309.ref011" ref-type="bibr">11</xref>]. The second study generated exogenous mutational signatures in human-induced pluripotent stem cell (iPSC) lines exposed to environmental or therapeutic mutagens [<xref rid="pcbi.1009309.ref008" ref-type="bibr">8</xref>]. For both studies, we evaluated whether SUITOR could correctly select the number of signatures and recover the profiles of single base substitution signatures. We then compared SUITOR’s performance with SigProfilerExtractor, SignatureAnalyzer and signeR.</p>
      <p>We first evaluated the <italic toggle="yes">in vitro</italic> CRISPR-Cas9-mediated knockout study of the DNA repair gene <italic toggle="yes">MSH6</italic>, which was known to induce a detectable signature [<xref rid="pcbi.1009309.ref011" ref-type="bibr">11</xref>] and hence could be used for evaluation as the positive control. SUITOR correctly detected the background signature, which existed before the knockout of <italic toggle="yes">MSH6</italic> and <italic toggle="yes">MSH6</italic> knockout-induced signature (<xref rid="pcbi.1009309.g002" ref-type="fig">Fig 2A</xref>) and recovered the corresponding signature profiles (<xref rid="pcbi.1009309.g002" ref-type="fig">Fig 2B</xref> and Table A in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>). SigProfilerExtractor, SignatureAnalyzer and signeR correctly identified these two signatures as well (<xref rid="pcbi.1009309.s001" ref-type="supplementary-material">S1 Fig</xref> and Table A in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>). Next, we extracted signatures of knockout studies of six DNA repair genes (<italic toggle="yes">CHEK2</italic>, <italic toggle="yes">NEIL1</italic>, <italic toggle="yes">NUDT1</italic>, <italic toggle="yes">POLB</italic>, <italic toggle="yes">POLE</italic> and <italic toggle="yes">POLM)</italic>, which did not induce experimentally detectable signatures [<xref rid="pcbi.1009309.ref011" ref-type="bibr">11</xref>] and hence could be used as the negative controls. SUITOR and the other three methods correctly identified one background signature only without false detection of knockout-induced signatures (<xref rid="pcbi.1009309.s002" ref-type="supplementary-material">S2 Fig</xref>). We conclude that in this <italic toggle="yes">in vitro</italic> study with at most two signatures, all four methods perform equally well. This is not the case when the number of signatures increases as shown below.</p>
      <fig position="float" id="pcbi.1009309.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009309.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title><italic toggle="yes">In vitro</italic> evaluation of SUITOR and other methods.</title>
          <p>a) Prediction errors of SUITOR for the training and validation sets of <italic toggle="yes">in vitro</italic> knockout study of DNA repair gene <italic toggle="yes">MSH6</italic>. The red dot denotes the number of signatures with the minimal prediction error in the validation set. b) Profiles of single base substitution signature estimated by SUITOR in <italic toggle="yes">MSH6</italic> gene knockout study. The x-axis indicates the 5’ and 3’ nucleotides for each substitution type (e.g., T[C&gt;A]C, cytosine to adenine substitution with 5’ thymine and 3’ cytosine). The top panel: the true and estimated background signatures (cosine similarity = 0.991; cosine similarity = 1 suggests two profiles being identical.); the bottom panel: the true and estimated <italic toggle="yes">MSH6</italic> knockout-induced signatures (cosine similarity = 0.997). c) Prediction errors by SUITOR for the training and validation sets of <italic toggle="yes">in vitro</italic> study of environmental or therapeutic mutagens. The red dot indicates the minimal prediction error in the validation set achieved by ten signatures, including one background signature and nine mutagen-induced signatures. d) Signatures discovered from the <italic toggle="yes">in vitro</italic> study of environmental or therapeutic mutagens by four methods. Methods which could identify a given mutagen are enclosed in parentheses. ENU: N-ethyl-N-nitrosourea; 6-Nitrochrysene+S9: 6-Nitrochrysene mixed with S9 rodent liver-derived metabolic enzyme; DES: diethyl sulfate; SSR: simulated solar radiation; AAI: aristolochic acid I; 1,2-DMH+S9: 1,2-dimethylhydrazine mixed with S9 rodent liver-derived metabolic enzyme; BPDE: benzo[a]pyrene-7,8-dihydrodiol-9,10-epoxide; DBADE: dibenz[a,h]anthracene diol-epoxide.</p>
        </caption>
        <graphic xlink:href="pcbi.1009309.g002" position="float"/>
      </fig>
      <p>For the <italic toggle="yes">in vitro</italic> study of 79 exogenous mutagens, stable mutational signatures were experimentally identified for 28 mutagens. These 28 signatures are not distinct as some signatures are very similar to each other (details in Methods); for example, both benzo[a]pyrene (BaP) and benzo[a]pyrene-7,8-dihydrodiol-9,10-epoxide (BPDE) are polycyclic aromatic hydrocarbons (PAHs) which are the established mutagens in tobacco smoke (<xref rid="pcbi.1009309.s003" ref-type="supplementary-material">S3 Fig</xref>). Although all four methods could find the background mutational signature, SUITOR detected 9 additional signatures induced by mutagens (<xref rid="pcbi.1009309.g002" ref-type="fig">Fig 2C</xref>, 10 signatures, including one background signature and 9 mutagen-induced signatures), SigProfilerExtractor detected 4, SignatureAnalyzer 8, and signeR 5 additional signatures (Figs <xref rid="pcbi.1009309.g002" ref-type="fig">2D</xref> and <xref rid="pcbi.1009309.s004" ref-type="supplementary-material">S4</xref> and Table B in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>). Next, we extracted <italic toggle="yes">de novo</italic> signature profiles and compared them with signature profiles reported in the original <italic toggle="yes">in vitro</italic> study [<xref rid="pcbi.1009309.ref008" ref-type="bibr">8</xref>]. Indeed, de <italic toggle="yes">novo</italic> signatures extracted by SUITOR, SigProfilerExtractor, SignatureAnalyzer and signeR could be matched to 10, 5, 9, 6 of 11 <italic toggle="yes">in vitro</italic> true signatures respectively with the cosine similarity threshold 0.8 (sensitivity = 91%, 45%, 82%, 55%, Table B in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>). The signature of 1,2-dimethylhydrazine (1,2-DMH) was detected by SUITOR and missed by the other methods. When cosine similarity threshold was increased to 0.9, the numbers of matched signatures were reduced to 7, 5, 7, 6 for SUITOR, SigProfilerExtractor, SignatureAnalyzer and signeR, respectively (sensitivity = 64%, 45%, 64%, 55%, Table B in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>). Besides detecting more true signatures, SUITOR also achieved the lowest prediction error (SUITOR:1292.5; SigProfilerExtractor:2295.4; SignatureAnalyzer:2176.6; signeR:1585.1). This indicates that the signatures detected by SUITOR in the training set predicted most closely the mutation counts in the validation set. Finally, we examined the signature activity matrices which were estimated by each method. Since each tumor subclone was exposed to one exogenous mutagen, we expected that the signature activities of the corresponding mutagen and the background signature should be high, while the activities of other signatures should be close to zero (but not necessarily as exactly zeros); consequently, when we clustered tumor subclones based on signature activities, tumor subclones exposed to the same mutagen would be clustered together and separated from others. We found that SUITOR and SignatureAnalyzer were able to separate most subclones into distinct clusters, each corresponding to a unique mutagen exposure (<xref rid="pcbi.1009309.s005" ref-type="supplementary-material">S5 Fig</xref>). In contrast, SigProfilerExtractor merged subclones exposed to BPDE and dibenz[a,h]anthracene diol-epoxide (DBADE); signeR mixed subclones exposed to N-ethyl-N-nitrosourea (ENU) and 1,2-DMH; and both SigProfilerExtractor and signeR mixed subclones exposed to 9-Nitrochrysense and aristolochic acid I (AAI).</p>
      <p>We note that <italic toggle="yes">in vitro</italic> study of exogenous mutagens favors the method of SignatureAnalyzer. SignatureAnalyzer implicitly assumes few signatures are present per sample and hence the loadings of signatures are sparse, which holds here since each sample was treated with a single mutagen in this <italic toggle="yes">in vitro</italic> study of exogenous mutagens. In spite of that, SUITOR performed better than SignatureAnalyzer. When the sparsity assumption does not hold, as demonstrated in <italic toggle="yes">in silico</italic> simulations and the PCAWG study described below, SignatureAnalyzer would find more false-positive signatures than the other methods. In contrast, SUITOR, which does not rely on the sparsity assumption, is not susceptible to it.</p>
    </sec>
    <sec id="sec005">
      <title><italic toggle="yes">In silico</italic> simulation studies</title>
      <p>To benchmark the performance of SUITOR and other methods, we evaluated them through additional <italic toggle="yes">in silico</italic> simulations, for which the estimated signature profiles are compared to the given signature profiles as the ground truth. First, we considered a simple setting of one true signature, for which any additional signature found would be a false positive (details in Methods). SUITOR, SigProfilerExtractor and signeR correctly identified the single true signature (<xref rid="pcbi.1009309.s006" ref-type="supplementary-material">S6 Fig</xref>) in 20 of 20 replicates; SignatureAnalyzer found a false positive signature (<xref rid="pcbi.1009309.s007" ref-type="supplementary-material">S7 Fig</xref>) in 17 of 20 replicates.</p>
      <p>Next, we examined a more compressive setting of nine true signatures with varying signature activities (details in Methods; <xref rid="pcbi.1009309.s008" ref-type="supplementary-material">S8 Fig</xref> and Table C in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>). All methods correctly identified six common signatures (SBS1, 2, 3, 5, 13, 18) in 20 of 20 replicates with the cosine similarity threshold 0.8; SUITOR and SignatureAnalyzer detected two rare signatures (SBS8,41) in more replicates than the other two methods (<xref rid="pcbi.1009309.g003" ref-type="fig">Fig 3A</xref>). None of the methods identified the extremely rare and flat signature SBS40 (present in one tumor only). Interestingly, there existed one replicate where two detected <italic toggle="yes">de novo</italic> signatures were most similar to SBS5 (cosine similarity 0.97 and 0.91, respectively) for SUITOR. It indicates that two flat signatures (likely SBS5 and SBS40) were detected in this replicate, which is consistent with the simulation design; indeed, the signature with cosine similarity 0.91 to SBS5 was also similar to SBS40 with cosine similarity 0.83. In addition, signeR found two flat signatures in two replicates. Both flat signatures were most similar to signature SBS5 followed by SBS40. Moreover, signeR found two SBS2 signatures in 3 replicates and two SBS13 signatures in 2 replicates, suggesting that signeR would occasionally overidentify APOBEC signatures (SBS2 and SBS13). Notably, all methods detected no other signatures besides the nine true signatures. We measured the cosine similarity between detected signatures and true ones (<xref rid="pcbi.1009309.s009" ref-type="supplementary-material">S9A Fig</xref>) averaged over 20 replicates. The cosine similarities of five common signatures (SBS1, 2, 3, 5, 18) were all over 90% for 4 methods; the cosine similarities of SBS13 were slightly lower than 90% for SignatureAnalyzer and signeR and higher than 90% for the other two methods; as expected, the cosine similarities of two rare signatures (SBS8,41) were much lower than other signatures (except cosine similarities of SBS41 by SUITOR and SignatureAnalyzer). As a result, the increasement of cosine similarity threshold from 0.8 to 0.9 would impact the frequency of signatures SBS8, 13, 41 to be detected across 20 replicates but not other signatures (Table D in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>).</p>
      <fig position="float" id="pcbi.1009309.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009309.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title><italic toggle="yes">In silico</italic> evaluation of SUITOR and other methods.</title>
          <p>a) The number of replicates in which a given signature (of total 9 signatures) will be detected by each method; the rare signatures SBS8 and SBS41 were discovered in 12, 6, 14 and 6 replicates, and 17, 7, 19 and 11 replicates over total 20 replicates by SUITOR, SigProfilerExtractor, SignatureAnalyzer and signeR, respectively. b) The number of replicates in which a given signature (of total 8 signatures) will be detected by each method under various error levels. Error level equaling to zero means no somatic mutations called by errors.</p>
        </caption>
        <graphic xlink:href="pcbi.1009309.g003" position="float"/>
      </fig>
      <p>Finally, we investigated the setting when part of somatic mutations was called by mistake, which likely occurs in practice due to sequencing and/or calling errors. We simulated a mutation type matrix for 300 tumors of eight signatures which cover six major substitution types. In addition, we added mutation counts caused by errors for each tumor generated from a uniform distribution with various error levels (rounded to the nearest integer, details in Methods). We repeated this simulation by 20 times. Notably, SUITOR consistently detect eight signatures regardless of error levels (<xref rid="pcbi.1009309.g003" ref-type="fig">Fig 3B</xref>) with the cosine similarity threshold 0.8; in contrast, although SBS9 was detected by SigProfilerExtractor (5 over 20 replicates), SignatureAnalyzer (20 over 20 replicates), and signeR (1 over 20 replicates) when there are no mutation calling errors, it was rarely detected when mutation calling errors present; for example, when the error level is 1.2, all three methods could not detect SBS9. Besides SBS9, signature SBS39 was missed by signeR when there existed error mutations. Compared to the given signature profiles, cosine similarities of signatures detected by SUITOR were higher than 90% for SBS4, 6, 7a, 17b, 22, 26 and 39 and slightly lower than 90% for SBS9 (<xref rid="pcbi.1009309.s009" ref-type="supplementary-material">S9B Fig</xref>). Consequently, if the cosine similarity threshold is increased to 0.9, only the frequency of signature SBS9 to be detected across 20 replicates would be reduced for all methods (Table E in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>), and SUITOR could still detect SBS9 in more replicates than other methods. For this simulation involved mutations called by errors, we further evaluated the performance of CV2K and SparseSignatures. When there were no mutation calling errors, CV2K was able to detect true 8 signatures among 19 of 20 replicates; however, its performance declined with increasing error levels; when the error level is at 1.2, CV2K detected 8 signatures in 6 of 20 replicates and detected 7 signatures in other 14 replicates (Table F in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>). SparseSignatures tended to find more signatures even without mutation calling errors; it detected more than 12 signatures (as many as 20 signatures for one replicate) in 9 of 20 replicates; when the error level was 1.2, SparseSignatures identified the true 8 signatures in only 2 replicates (Table F in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>).</p>
      <p>Together, the simulation studies suggest that SUITOR is able to find both common and rare signatures while well controlling the rate of false positives, outperforming other methods.</p>
    </sec>
    <sec id="sec006">
      <title>Detection of pan-cancer mutational signatures</title>
      <p>We tested the four methods in whole-genome sequencing (WGS) data of 2,540 tumors across 22 cancer types from the Pan-Cancer Analysis of Whole Genomes (PCAWG) study [<xref rid="pcbi.1009309.ref001" ref-type="bibr">1</xref>] (details in Methods).</p>
      <p>First, we extracted <italic toggle="yes">de novo</italic> mutation signatures one cancer type at a time for eight cancer types, each with at least 100 tumors. Unlike in <italic toggle="yes">in vitro</italic> or <italic toggle="yes">in silico</italic> studies, the true signatures were unknown here. Nevertheless, we could evaluate if the signatures detected in part of the dataset predict mutation counts in the remaining part well. Specifically, the mutation type matrix is separated into training, validation and testing sets, the last of which is used to evaluate the performance of the selected number of signatures (details in Methods). Among the four methods, SUITOR clearly attained the smallest prediction errors across eight cancer types (<xref rid="pcbi.1009309.g004" ref-type="fig">Fig 4A</xref>). It suggests that the existing tools are not designed for dealing with missing data and hence cannot conduct cross-validation, which motivates us to develop SUITOR. In addition, we compared signature profiles extracted by each method, using all counts in the mutation type matrix (i.e., without the split of the mutation type matrix for SigProfilerExtractor, SignatureAnalyzer and signeR); most signatures found by SUITOR were highly similar to the COSMIC signatures [<xref rid="pcbi.1009309.ref007" ref-type="bibr">7</xref>] (with cosine similarity &gt; 0.8, <xref rid="pcbi.1009309.g004" ref-type="fig">Fig 4B</xref>) and frequently detected by the other methods (<xref rid="pcbi.1009309.g004" ref-type="fig">Fig 4C</xref>). In contrast, SignatureAnalyzer identified more <italic toggle="yes">de novo</italic> signatures, some of which were not matched to any COSMIC signatures (<xref rid="pcbi.1009309.g004" ref-type="fig">Fig 4B</xref>).</p>
      <fig position="float" id="pcbi.1009309.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009309.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Mutational signature results of eight cancer studies of PCAWG.</title>
          <p>a) The prediction errors of SUITOR, SigProfilerExtractor, SignatureAnalyzer and signeR for eight cancer types (scale on the left-side Y axis) and for 2,540 tumors across 22 cancer types together, namely Pan-Cancer (scale on the right-side Y axis). SD: standard deviation. b) The number of signatures identified by each method. The shaded bars and the numbers above indicate the number of signatures whose profiles could be matched to COSMIC profiles (with cosine similarity &gt; 0.8). c) The cosine similarities between <italic toggle="yes">de novo</italic> signatures and COSMIC signatures. Only the matched pairs are shown (with cosine similarity &gt; 0.8). The higher the cosine similarity the better match to a COSMIC signature profile. The cosine similarity equivalent to one denotes a perfect match.</p>
        </caption>
        <graphic xlink:href="pcbi.1009309.g004" position="float"/>
      </fig>
      <p>Next, we extracted <italic toggle="yes">de novo</italic> signatures combining WGS data from 2,540 tumors (pan-cancer analysis). SUITOR found 22 signatures, eighteen of which could be matched to the COSMIC signatures (<xref rid="pcbi.1009309.g004" ref-type="fig">Fig 4B</xref>). These signatures had the smallest prediction error (<xref rid="pcbi.1009309.g004" ref-type="fig">Fig 4A</xref>), compared to signatures detected by the other methods: SUITOR 36,017; SigProfilerExtractor 255,111 (&gt;7 times SUITOR’s prediction error); SignatureAnalyzer 402,409 (&gt;11 times SUITOR’s prediction error); and signeR 193,191 (&gt;5 times SUITOR’s prediction error). As expected, the signatures commonly found in multiple cancer types (e.g., SBS1, SBS2 and SBS13) could be identified when combining all cancer types together, while signatures specific to a single cancer type (e.g., SBS24 specific to liver cancer) were absent in the combined signature analysis (<xref rid="pcbi.1009309.g004" ref-type="fig">Fig 4C</xref>). When we clustered 2,540 tumors based on signature activities <bold>H</bold> estimated by SUITOR, four clusters emerged in the t-SNE plot (<xref rid="pcbi.1009309.g005" ref-type="fig">Fig 5A</xref>). Liver tumors formed a distinct cluster, possibly due to its specific signature SBS24 caused by aflatoxin exposure; the remaining clusters included: i) a subset of lymphomas; ii) the majority of kidney tumors; iii) all remaining tumors. Similarly, we clustered the same 2,540 tumors based on signature activities <bold>H</bold> estimated by the other methods; liver tumors were separated from the other tumors across all of the t-SNE plots generated by the other methods (<xref rid="pcbi.1009309.g005" ref-type="fig">Fig 5B–5D</xref>); however, kidney tumors and lymphoma were mixed with other cancer types in the t-SNE plot from SignatureAnalyzer.</p>
      <fig position="float" id="pcbi.1009309.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009309.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>The t-SNE visualization of clustering patterns for 2,540 tumors across 22 cancer types based on signature activities.</title>
          <p>Signature activities are estimated by four methods: (a) SUITOR, (b) SigProfilerExtractor, (c) SignatureAnalyzer and (d) signeR. Each dot represents a tumor and is colored by the cancer type.</p>
        </caption>
        <graphic xlink:href="pcbi.1009309.g005" position="float"/>
      </fig>
      <p>In addition, we applied CV2K and SparseSignatures to select the number of signatures. The numbers selected by CV2K were comparable to ones by SUITOR (e.g, CV2K: 8 signatures vs SUITOR: 9 signatures for breast cancer; CV2K: 4 signatures vs SUITOR: 4 signatures for prostate cancer; Table G in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>). Since CV2K does not infer signatures profiles, we were unable to evaluate their similarities to COSMIC signatures. SparseSignatures tended to detect slightly fewer signatures than other methods (Table G in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>); since SparseSignatures imposed the sparsity assumption, its inferred profiles were spiky and less similar to the COSMIC signatures (Table H in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>).</p>
    </sec>
    <sec id="sec007">
      <title>External validation of breast cancer mutational signatures</title>
      <p>We validated the nine PCAWG breast cancer signatures (based on 194 breast tumors) using an independent WGS set of 440 breast tumors of the Sanger breast cancer (BRCA) study from the same ethnicity [<xref rid="pcbi.1009309.ref002" ref-type="bibr">2</xref>]. SUITOR (<xref rid="pcbi.1009309.g006" ref-type="fig">Fig 6A</xref> and Table I in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>) and signeR (Table J in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>) identified nine breast cancer signatures in PCAWG and validated eight in the Sanger BRCA study (with cosine similarity &gt; 0.8); SigProfilerExtractor identified eight signatures and confirmed seven (Table K in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>); SignatureAnalyzer identified twelve and validated eight (Table L in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>). Overall, six signatures (SBS1,2,8,13,17b and 18) were identified in both studies by all methods, while the flat featureless signature SBS5 could not be validated by any method.</p>
      <fig position="float" id="pcbi.1009309.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009309.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>The results of Sanger breast cancer study by SUITOR.</title>
          <p>a) The heatmap of cosine similarity between <italic toggle="yes">de novo</italic> signatures detected in the PCAWG breast cancer (BRCA) study and <italic toggle="yes">de novo</italic> signatures in the Sanger BRCA study. The signatures of the Sanger BRCA study are annotated by COSMIC signatures (if cosine similarities &gt; 0.8) among parentheses. For example, DNSigA (SBS1) refers to <italic toggle="yes">de novo</italic> signature A (DNSigA) being annotated by COSMIC signature SBS1. The four signatures which were detected in the Sanger BRCA study only were annotated by the red rectangular frames around the names of signature. b) The heatmap of signature activities estimated by SUITOR with hierarchical clustering in the Sanger BRCA study. The number of tumors included in each signature cluster is shown among parentheses on the top of the heatmap. Q1, Q2, Q3: the 1st, 2nd and 3rd quantiles of signature activities. c) The t-SNE visualization of tumors in G3 and G4 signature clusters, color-coded by signature clusters and molecular subtypes. TNBC: triple negative breast cancer.</p>
        </caption>
        <graphic xlink:href="pcbi.1009309.g006" position="float"/>
      </fig>
      <p>Besides validating eight PCAWG breast cancer signatures, SUITOR found four additional signatures in the Sanger BRCA study (<xref rid="pcbi.1009309.g006" ref-type="fig">Fig 6A</xref> and Table M in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>). Two of them were highly similar to COSMIC signatures SBS26 and SBS30 (cosine similarity &gt; 0.93) and were identified by the other three methods as well. The other two (similar to SBS3 and SBS6) were also detected by SignatureAnalyzer and/or signeR. Similarly, three other methods found a few more signatures as well (Tables N, O, and P in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>). These findings suggest that there likely exist additional signatures in the Sanger BRCA study that are missed in the PCAWG breast cancer study because of either the larger sample size or specific operative mutational processes (e.g., BRCA1 mutation carriers with signature SBS3) in Sanger BRCA study.</p>
      <p>Finally, as an example of clinical utility of the signatures estimated by SUITOR, we stratified the 440 breast tumors of the Sanger BRCA study using the signature activities. Four signature clusters were found; two dominant clusters (G3 and G4) included overall 430 tumors (<xref rid="pcbi.1009309.g006" ref-type="fig">Fig 6B</xref>). Compared to the G4 subgroup, the G3 subgroup showed significantly higher activities of the nine signatures (<xref rid="pcbi.1009309.s010" ref-type="supplementary-material">S10 Fig</xref> and Table Q in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>) and significantly lower activities of the <italic toggle="yes">de novo</italic> signature A (similar to COSMIC signature SBS1 associated with aging). We found a number of clinical factors associated with the subgroups G3 and G4, including age at diagnosis and tumor grade (Table R in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>). The singular most important associated factor was the molecular subtype: triple negative breast cancers were significantly enriched in the subgroup G3 (<xref rid="pcbi.1009309.g006" ref-type="fig">Fig 6C</xref>; odds ratio = 25.1, P-value &lt; 2.2x10<sup>-16</sup>, two-sided Fisher’s exact test).</p>
    </sec>
    <sec id="sec008">
      <title>Other applications</title>
      <p>Besides selecting the number of signatures of single base substitution, SUITOR could be used to select the number of signatures of other genomic alterations in tumors, including double base substitutions, small insertion and deletions (INDELs), and structure variations. For example, SUITOR could detect four <italic toggle="yes">de novo</italic> INDEL signatures in ovarian adenocarcinoma (n = 113 tumors). Three of them were similar to the COSMIC INDEL signatures: ID1 (associated with replication slippage, cosine similarity = 0.97; Table S in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>), ID6 (associated with defective homologous recombination-based DNA damage repair, cosine similarity = 0.95) and ID8 (associate with DNA double-strand breaks repair by non-homologous end joining, cosine similarity = 0.88). Although SUITOR is primarily designed for human tumors with whole genome sequencing, it can be applicated to select the number of signatures in other model organisms. As an example, we applied SUITOR to an experimental study on <italic toggle="yes">C</italic>. <italic toggle="yes">elegans</italic> [<xref rid="pcbi.1009309.ref047" ref-type="bibr">47</xref>]. Since mutation counts of <italic toggle="yes">C</italic>. <italic toggle="yes">elegans</italic> are very low (partially due to its smaller genome size around 101 Mb) relative to the mutation counts of human tumors based on WGS (human genome size around 3,000 Mb), we combined 100 <italic toggle="yes">C</italic>. <italic toggle="yes">elegans</italic> together to increase the mutation counts as a group (leading to 28 groups for 2717 <italic toggle="yes">C</italic>. <italic toggle="yes">elegans</italic>). SUITOR could detect five <italic toggle="yes">de novo</italic> SBS signatures. Compared to the signatures reported in the original <italic toggle="yes">C</italic>. <italic toggle="yes">elegans</italic> study [<xref rid="pcbi.1009309.ref047" ref-type="bibr">47</xref>], two <italic toggle="yes">de novo</italic> SBS signatures are highly similar to signatures of alkylating agents dimethyl sulfate (DMS, cosine similarity = 0.94, Table T in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>) and ethyl methanesulfonate (EMS, cosine similarity = 1.00), respectively; and another two <italic toggle="yes">de novo</italic> SBS signatures are similar to signatures of DNA repair deficiencies due to genes <italic toggle="yes">SLX1</italic> (cosine similarity = 0.89) and <italic toggle="yes">MLH1</italic> (cosine similarity = 0.87), respectively.</p>
      <p>For analyzing PCAWG study and Sanger breast cancer study, we excluded hypermutated tumors with mutation burden more than 10 mutations/Mb. The eight cancer types we analyzed had just few hypermutated tumors each. We further analyzed a couple of cancer types with more prevalent hypermutated tumors (colorectal adenocarcinomas n = 60, esophageal adenocarcinomas n = 98, Head and neck squamous cell carcinoma n = 57). SUITOR would find less signatures when we included hypermutated tumors (Table U in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>). For example, only SBS6 (associated with defective DNA mismatch repair) and SBS10a (associated with polymerase epsilon exonuclease domain mutations) could be detected for colorectal adenocarcinoma when including hypermutated tumors (17 over 60 tumors). It suggests the inclusion of hypermutated tumors would likely hinder the detection of other signatures by SUITOR, as least when the number of tumors is small.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec009">
    <title>Discussion</title>
    <p>It’s crucial to select the correct number of <italic toggle="yes">de novo</italic> mutational signatures for a cancer genomics study. Here we present SUITOR that selects the number of signatures through cross-validation to minimize the prediction error in the validation set. We have shown how SUITOR outperforms common existing methods most of the time. <italic toggle="yes">In vitro</italic> studies show that SUITOR is capable of retrieving the correct number and profiles of both endogenous and exogenous signatures, allowing the correct stratification of tumor subclones exposed to distinct mutagens. <italic toggle="yes">In silico</italic> simulation studies show that SUITOR can detect common signatures in all replicates and rare signatures (as low as 1%) in the majority of replicates. Applications to eight <italic toggle="yes">in vivo</italic> PCAWG cancer types show that SUITOR discovers signatures which achieve the lowest prediction errors in the testing sets. Most of these signatures are confirmed by other methods and matched to the COSMIC signatures. All except one signature found in PCAWG BRCA study were validated in the independent Sanger BRCA study. The activities of signatures selected by SUITOR in the Sanger BRCA study are dominated by two clusters, driven by the molecular/histological subtypes.</p>
    <p>In this paper, we used 10-fold cross validation, which is recommended as a good compromise for the bias-variance trade-off regarding the choice of k in K-fold cross validation [<xref rid="pcbi.1009309.ref048" ref-type="bibr">48</xref>,<xref rid="pcbi.1009309.ref049" ref-type="bibr">49</xref>]. In addition, we have tried 20-fold cross validation (i.e., 5% of data as validation data) for PCAWG studies, which led to the same number of signatures (<xref rid="sec002" ref-type="sec">results</xref> not shown).</p>
    <p>In summary, SUITOR has shown to perform better than other commonly used methods in revealing mutational signatures, the “footprints” engraved in the cancer genomes by operative mutational processes with potentially important etiological or therapeutic implications.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec010">
    <title>Methods</title>
    <sec id="sec011">
      <title>The probabilistic non-negative matrix factorization (NMF) model</title>
      <p>Given the number of signatures <italic toggle="yes">r</italic> to be extracted, NMF factorizes the mutation type matrix into two non-negative matrices: the matrix of signatures <bold>W</bold> of size 96×<italic toggle="yes">r</italic> and the matrix of activities/exposures <bold>H</bold> of size <italic toggle="yes">r</italic>×N such that <bold>V</bold>≈<bold>WH</bold>. Each column of <bold>W</bold> forms a signature profile with the elements summed to 1, showing how 96 mutation types comprise a signature profile; each column of <bold>H</bold> contains activities of <italic toggle="yes">r</italic> signatures, reflecting how intense <italic toggle="yes">r</italic> mutational signatures are in a tumor. To estimate <bold>W</bold> and <bold>H</bold>, it is common to minimize the generalized Kullback-Leibler (KL) divergence
<disp-formula id="pcbi.1009309.e001"><alternatives><graphic xlink:href="pcbi.1009309.e001.jpg" id="pcbi.1009309.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">W</mml:mi><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>96</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac bevelled="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
subject to <italic toggle="yes">w</italic><sub><italic toggle="yes">pj</italic></sub>≥0 and <italic toggle="yes">h</italic><sub><italic toggle="yes">jn</italic></sub>≥0 with 1≤<italic toggle="yes">j</italic>≤r, 1≤<italic toggle="yes">n</italic>≤N and 1≤<italic toggle="yes">p</italic>≤96. Lowercase letters, <italic toggle="yes">v</italic><sub><italic toggle="yes">pn</italic></sub>, <italic toggle="yes">w</italic><sub><italic toggle="yes">pj</italic></sub> and <italic toggle="yes">h</italic><sub><italic toggle="yes">jn</italic></sub>, denote elements of the corresponding matrices, <bold>V</bold>, <bold>W</bold> and <bold>H</bold>, respectively. NMF can also be solved with other objective functions such as Frobenius norm or more general <italic toggle="yes">β</italic>-divergence, depending on the applications [<xref rid="pcbi.1009309.ref034" ref-type="bibr">34</xref>].</p>
      <p>Notably, minimization of the generalized KL divergence is equivalent to maximize a likelihood function of a probabilistic NMF model [<xref rid="pcbi.1009309.ref044" ref-type="bibr">44</xref>,<xref rid="pcbi.1009309.ref050" ref-type="bibr">50</xref>]. Indeed, for a Poisson NMF model, <italic toggle="yes">v</italic><sub><italic toggle="yes">pn</italic></sub> of the <italic toggle="yes">n</italic>th tumor and <italic toggle="yes">p</italic>th mutation type is assumed to be independently distributed, following a Poisson distribution with mean <inline-formula id="pcbi.1009309.e002"><alternatives><graphic xlink:href="pcbi.1009309.e002.jpg" id="pcbi.1009309.e002g" position="anchor"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The log-likelihood of Poisson NMF model can be written as log{Pr(<bold>V</bold>|<bold>WH</bold>)} = −<italic toggle="yes">D</italic><sub><italic toggle="yes">KL</italic></sub>(<bold>V</bold>|<bold>WH</bold>)+<italic toggle="yes">C</italic> with a constant <italic toggle="yes">C</italic>. Therefore, minimizing generalized KL divergence <italic toggle="yes">D</italic><sub><italic toggle="yes">KL</italic></sub>(<bold>V</bold>|<bold>WH</bold>) is equivalent to maximizing the log-likelihood log{Pr(<bold>V</bold>|<bold>WH</bold>)}. In addition, it could be shown that the multiplicative update algorithm [<xref rid="pcbi.1009309.ref051" ref-type="bibr">51</xref>], which is commonly used to minimize the generalized KL divergence, is equivalent to an expectation/conditional maximization (ECM) algorithm [<xref rid="pcbi.1009309.ref040" ref-type="bibr">40</xref>] for the Poisson NMF model (Supplementary Note 2 in <xref rid="pcbi.1009309.s012" ref-type="supplementary-material">S1 Text</xref>). These two equivalences are used to develop SUITOR.</p>
    </sec>
    <sec id="sec012">
      <title>Unsupervised cross-validation for mutational signature analysis</title>
      <p>SUITOR aims to select the optimal number of signatures which minimizes the prediction error in the validation set through cross-validation. Here, we describe the steps to create the validation set and the related challenges.</p>
      <p>For a <italic toggle="yes">K</italic>-fold cross-validation, we divide the type matrix <bold>V</bold> into K parts where the Poisson NMF model is fitted on <italic toggle="yes">K</italic>−1 parts as the training set, and the fitted model is validated on the remaining one part as the validation set. The cross-validation is carried out K times with each part served as a validation set once, using the balanced separation [<xref rid="pcbi.1009309.ref052" ref-type="bibr">52</xref>,<xref rid="pcbi.1009309.ref053" ref-type="bibr">53</xref>] detailed as follows. In the <italic toggle="yes">k</italic><sup><italic toggle="yes">th</italic></sup> fold (1≤<italic toggle="yes">k</italic>≤<italic toggle="yes">K</italic>) of a balanced separation, a set of mutation counts {<italic toggle="yes">v</italic><sub><italic toggle="yes">pn</italic></sub>|<italic toggle="yes">p</italic> = (<italic toggle="yes">n mod</italic> 10)+(<italic toggle="yes">k</italic>−1)+<italic toggle="yes">aK</italic>, <italic toggle="yes">a</italic> = 1,2,….} are held out for the <italic toggle="yes">n</italic><sup><italic toggle="yes">th</italic></sup> tumor as validation data, where <italic toggle="yes">a</italic> is restricted such that 1≤<italic toggle="yes">p</italic>≤96. For example, (1, 11,⋯,91)<sup><italic toggle="yes">st</italic></sup> mutation types of the first tumor are held out in the 1<sup><italic toggle="yes">st</italic></sup> fold, (2, 12,⋯,92)<sup><italic toggle="yes">nd</italic></sup> mutation types in the 2<sup><italic toggle="yes">nd</italic></sup> fold and so on. Note that the balanced separation keeps equal number of retained mutation types for each tumor in the training set, which is computationally more stable than randomly splitting <bold>V</bold> into the training and validation sets. The latter may randomly remove a large number of mutation types for a tumor.</p>
      <p>As validation data are held out, missing data emerge in the training set, the reason for which existing methods of NMF fail. To address this challenge, we extended the Poisson NMF model and propose an expectation/conditional maximization (ECM) algorithm to incorporate the missing data.</p>
    </sec>
    <sec id="sec013">
      <title>Expectation/conditional maximization (ECM) algorithm of SUITOR</title>
      <p>Let <inline-formula id="pcbi.1009309.e003"><alternatives><graphic xlink:href="pcbi.1009309.e003.jpg" id="pcbi.1009309.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> be the set of indices of mutation type matrix <bold>V</bold> such that <inline-formula id="pcbi.1009309.e004"><alternatives><graphic xlink:href="pcbi.1009309.e004.jpg" id="pcbi.1009309.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="0.25em"/><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>96</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:math></alternatives></inline-formula>. For a <italic toggle="yes">K</italic>-fold cross-validation, <inline-formula id="pcbi.1009309.e005"><alternatives><graphic xlink:href="pcbi.1009309.e005.jpg" id="pcbi.1009309.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> would be divided into <italic toggle="yes">K</italic> disjoint sets <inline-formula id="pcbi.1009309.e006"><alternatives><graphic xlink:href="pcbi.1009309.e006.jpg" id="pcbi.1009309.e006g" position="anchor"/><mml:math id="M6" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. For the <italic toggle="yes">k</italic><sup><italic toggle="yes">th</italic></sup> fold, <inline-formula id="pcbi.1009309.e007"><alternatives><graphic xlink:href="pcbi.1009309.e007.jpg" id="pcbi.1009309.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></alternatives></inline-formula> denotes the validation set and <inline-formula id="pcbi.1009309.e008"><alternatives><graphic xlink:href="pcbi.1009309.e008.jpg" id="pcbi.1009309.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>\</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></alternatives></inline-formula> the training set, where <inline-formula id="pcbi.1009309.e009"><alternatives><graphic xlink:href="pcbi.1009309.e009.jpg" id="pcbi.1009309.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>\</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> represents the indices of <bold>V</bold> excluding ones in <inline-formula id="pcbi.1009309.e010"><alternatives><graphic xlink:href="pcbi.1009309.e010.jpg" id="pcbi.1009309.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. Mutation counts in <inline-formula id="pcbi.1009309.e011"><alternatives><graphic xlink:href="pcbi.1009309.e011.jpg" id="pcbi.1009309.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> will be removed from <bold>V</bold> and denote as missing data <inline-formula id="pcbi.1009309.e012"><alternatives><graphic xlink:href="pcbi.1009309.e012.jpg" id="pcbi.1009309.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></alternatives></inline-formula>. The <italic toggle="yes">v</italic><sub><italic toggle="yes">pn</italic></sub> in <inline-formula id="pcbi.1009309.e013"><alternatives><graphic xlink:href="pcbi.1009309.e013.jpg" id="pcbi.1009309.e013g" position="anchor"/><mml:math id="M13" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>and <italic toggle="yes">m</italic><sub><italic toggle="yes">pn</italic></sub> in <bold>M</bold><sub><italic toggle="yes">k</italic></sub> are assumed to be independently distributed as a Poisson distribution with the mean <inline-formula id="pcbi.1009309.e014"><alternatives><graphic xlink:href="pcbi.1009309.e014.jpg" id="pcbi.1009309.e014g" position="anchor"/><mml:math id="M14" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. By the scheme of balanced separation, <inline-formula id="pcbi.1009309.e015"><alternatives><graphic xlink:href="pcbi.1009309.e015.jpg" id="pcbi.1009309.e015g" position="anchor"/><mml:math id="M15" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is missing completely at random (MCAR), since <inline-formula id="pcbi.1009309.e016"><alternatives><graphic xlink:href="pcbi.1009309.e016.jpg" id="pcbi.1009309.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is removed from <bold>V</bold>, independent of values of <inline-formula id="pcbi.1009309.e017"><alternatives><graphic xlink:href="pcbi.1009309.e017.jpg" id="pcbi.1009309.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009309.e018"><alternatives><graphic xlink:href="pcbi.1009309.e018.jpg" id="pcbi.1009309.e018g" position="anchor"/><mml:math id="M18" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. MCAR enables us to propose an ECM algorithm to incorporate missing data and obtain unbiased estimates [<xref rid="pcbi.1009309.ref046" ref-type="bibr">46</xref>] of <bold>W</bold> and <bold>H</bold>.</p>
      <p>Next, we outline the ECM algorithm in the following iterative steps (details in Supplementary Note 3 in <xref rid="pcbi.1009309.s012" ref-type="supplementary-material">S1 Text</xref>).</p>
      <list list-type="order">
        <list-item>
          <p>Initial step: choose initial values of <bold>M</bold><sub><italic toggle="yes">k</italic></sub> and set initial parameters <bold>W</bold><sup><bold>0</bold></sup> and <bold>H</bold><sup><bold>0</bold></sup>.</p>
        </list-item>
        <list-item>
          <p>E-step: given the observed data <inline-formula id="pcbi.1009309.e019"><alternatives><graphic xlink:href="pcbi.1009309.e019.jpg" id="pcbi.1009309.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and the parameters <bold>W</bold><sup><bold><italic toggle="yes">t</italic></bold></sup> and <bold>H</bold><sup><bold><italic toggle="yes">t</italic></bold></sup> of the previous step <italic toggle="yes">t</italic>, the ECM algorithm calculates the conditional expectation of complete likelihood
<disp-formula id="pcbi.1009309.e020"><alternatives><graphic xlink:href="pcbi.1009309.e020.jpg" id="pcbi.1009309.e020g" position="anchor"/><mml:math id="M20" display="block" overflow="scroll"><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">W</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">W</mml:mi><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:msup><mml:mo>}</mml:mo><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">*</mml:mi></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">W</mml:mi><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
where <italic toggle="yes">C</italic>* is a constant independent of <bold>W</bold> and <bold>H</bold>, <inline-formula id="pcbi.1009309.e021"><alternatives><graphic xlink:href="pcbi.1009309.e021.jpg" id="pcbi.1009309.e021g" position="anchor"/><mml:math id="M21" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> the elements of <bold>V</bold>* as <inline-formula id="pcbi.1009309.e022"><alternatives><graphic xlink:href="pcbi.1009309.e022.jpg" id="pcbi.1009309.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> for <inline-formula id="pcbi.1009309.e023"><alternatives><graphic xlink:href="pcbi.1009309.e023.jpg" id="pcbi.1009309.e023g" position="anchor"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>\</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009309.e024"><alternatives><graphic xlink:href="pcbi.1009309.e024.jpg" id="pcbi.1009309.e024g" position="anchor"/><mml:math id="M24" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for <inline-formula id="pcbi.1009309.e025"><alternatives><graphic xlink:href="pcbi.1009309.e025.jpg" id="pcbi.1009309.e025g" position="anchor"/><mml:math id="M25" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.</p>
        </list-item>
        <list-item>
          <p>CM1-step: update parameters <bold>W</bold><sup><bold><italic toggle="yes">t</italic>+1</bold></sup> by maximizing <italic toggle="yes">Q</italic>(<bold>W</bold>, <bold>H</bold><sup><bold><italic toggle="yes">t</italic></bold></sup>|<bold>W</bold><sup><bold><italic toggle="yes">t</italic></bold></sup>, <bold>H</bold><sup><bold><italic toggle="yes">t</italic></bold></sup>) with respect to <bold>W</bold>.</p>
        </list-item>
        <list-item>
          <p>CM2-step: update parameters <bold>H</bold><sup><bold><italic toggle="yes">t</italic>+1</bold></sup> by maximizing <italic toggle="yes">Q</italic>(<bold>W</bold><sup><bold><italic toggle="yes">t</italic>+1</bold></sup>, <bold>H</bold>|<bold>W</bold><sup><bold><italic toggle="yes">t</italic></bold></sup>, <bold>H</bold><sup><bold><italic toggle="yes">t</italic></bold></sup>) with respect to <bold>H</bold>.</p>
        </list-item>
        <list-item>
          <p>Iterate steps 2 to 4 until convergence.</p>
        </list-item>
      </list>
      <p>In the initial step, we use the median of mutation counts in <inline-formula id="pcbi.1009309.e026"><alternatives><graphic xlink:href="pcbi.1009309.e026.jpg" id="pcbi.1009309.e026g" position="anchor"/><mml:math id="M26" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> per each mutation type as initial values for <bold>M</bold><sub><italic toggle="yes">k</italic></sub>; other more complicated methods of specifying initial values, such as nearest neighbors, lead to similar results (<xref rid="sec002" ref-type="sec">results</xref> not shown). We are aware that the ECM algorithm possibly converges to a local saddle point. To overcome it, we try 300 random initial values <bold>W</bold><sup><bold>0</bold></sup> and <bold>H</bold><sup><bold>0</bold></sup>, which leads to 300 pairs of <inline-formula id="pcbi.1009309.e027"><alternatives><graphic xlink:href="pcbi.1009309.e027.jpg" id="pcbi.1009309.e027g" position="anchor"/><mml:math id="M27" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, the estimates of <bold>W</bold> and <bold>H</bold> for the <italic toggle="yes">i</italic>th initial value, <italic toggle="yes">i</italic> = 1,2,…,300. The final reported <inline-formula id="pcbi.1009309.e028"><alternatives><graphic xlink:href="pcbi.1009309.e028.jpg" id="pcbi.1009309.e028g" position="anchor"/><mml:math id="M28" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009309.e029"><alternatives><graphic xlink:href="pcbi.1009309.e029.jpg" id="pcbi.1009309.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are the <inline-formula id="pcbi.1009309.e030"><alternatives><graphic xlink:href="pcbi.1009309.e030.jpg" id="pcbi.1009309.e030g" position="anchor"/><mml:math id="M30" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> which maximize the <inline-formula id="pcbi.1009309.e031"><alternatives><graphic xlink:href="pcbi.1009309.e031.jpg" id="pcbi.1009309.e031g" position="anchor"/><mml:math id="M31" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> among all <inline-formula id="pcbi.1009309.e032"><alternatives><graphic xlink:href="pcbi.1009309.e032.jpg" id="pcbi.1009309.e032g" position="anchor"/><mml:math id="M32" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>′</mml:mo><mml:mi>s</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>′</mml:mo><mml:mi>s</mml:mi></mml:math></alternatives></inline-formula>.</p>
    </sec>
    <sec id="sec014">
      <title>Selecting number of signatures by SUITOR</title>
      <p>For a given number of signatures <italic toggle="yes">r</italic>, we first evaluate the prediction error, i.e., the disparity between the observed validation data <inline-formula id="pcbi.1009309.e033"><alternatives><graphic xlink:href="pcbi.1009309.e033.jpg" id="pcbi.1009309.e033g" position="anchor"/><mml:math id="M33" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and the predicted ones <inline-formula id="pcbi.1009309.e034"><alternatives><graphic xlink:href="pcbi.1009309.e034.jpg" id="pcbi.1009309.e034g" position="anchor"/><mml:math id="M34" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi><mml:mo>[</mml:mo><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives></inline-formula> for the <italic toggle="yes">k</italic><sup><italic toggle="yes">th</italic></sup> fold, <italic toggle="yes">k</italic> = 1,2,…,<italic toggle="yes">K</italic>,
<disp-formula id="pcbi.1009309.e035"><alternatives><graphic xlink:href="pcbi.1009309.e035.jpg" id="pcbi.1009309.e035g" position="anchor"/><mml:math id="M35" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mi>R</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>}</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></alternatives></disp-formula></p>
      <p>We then evaluate overall prediction error, <inline-formula id="pcbi.1009309.e036"><alternatives><graphic xlink:href="pcbi.1009309.e036.jpg" id="pcbi.1009309.e036g" position="anchor"/><mml:math id="M36" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mi>R</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mi>R</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, across K folds. Since the term <italic toggle="yes">C</italic>* is unrelated to <inline-formula id="pcbi.1009309.e037"><alternatives><graphic xlink:href="pcbi.1009309.e037.jpg" id="pcbi.1009309.e037g" position="anchor"/><mml:math id="M37" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009309.e038"><alternatives><graphic xlink:href="pcbi.1009309.e038.jpg" id="pcbi.1009309.e038g" position="anchor"/><mml:math id="M38" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, it is dropped. Finally, we select the number of signatures <italic toggle="yes">r</italic>* which minimizes <italic toggle="yes">ERR</italic><sub><italic toggle="yes">r</italic></sub> over a range of numbers of signatures 1≤<italic toggle="yes">r</italic>≤<italic toggle="yes">R</italic>.</p>
    </sec>
    <sec id="sec015">
      <title>Extracting signature profiles and estimating activities of signatures</title>
      <p>Once the optimal number of signatures <italic toggle="yes">r</italic>* is determined by SUITOR, we extract mutational signature profiles <bold>W</bold> and estimating signature activities <bold>H</bold>, via maximizing log{Pr(<bold>V</bold>|<bold>WH</bold>)} with the fixed rank <italic toggle="yes">r</italic>*. Similar to the ECM algorithm in SUITOR, we evaluate multiple initial values and use <inline-formula id="pcbi.1009309.e039"><alternatives><graphic xlink:href="pcbi.1009309.e039.jpg" id="pcbi.1009309.e039g" position="anchor"/><mml:math id="M39" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009309.e040"><alternatives><graphic xlink:href="pcbi.1009309.e040.jpg" id="pcbi.1009309.e040g" position="anchor"/><mml:math id="M40" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> which maximizes <inline-formula id="pcbi.1009309.e041"><alternatives><graphic xlink:href="pcbi.1009309.e041.jpg" id="pcbi.1009309.e041g" position="anchor"/><mml:math id="M41" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to relieve local optima problem.</p>
    </sec>
    <sec id="sec016">
      <title>Parameters used for SUITOR and other mutational signatures analysis tools</title>
      <p>The parameters used for SUITOR and other mutational signatures analysis tools are listed as follows.</p>
      <p>SUITOR: minimum rank: 1; maximum rank: 10; number of folds: 10; EM algorithm stopping tolerance: 1e-5; maximum number of iterations in EM algorithm: 2000; number of seeds:300</p>
      <p>SigProfilerExtractor: sig.sigProfilerExtractor("matrix", "Output_folder_name", data, startProcess = 1, endProcess = 15, totalIterations = 100, cpu = 36).</p>
      <p>SigneR: signeR(M = t(input), nlim = c(1,15), try_all = TRUE),</p>
      <p>where try_all = TRUE means it evaluate BIC for rank in nlim = c(1, 15).</p>
      <p>SignatureAnalyzer: the default parameters.</p>
      <p>CV2K: the default parameters.</p>
      <p>SparseSignatures: the default parameters.</p>
    </sec>
    <sec id="sec017">
      <title><italic toggle="yes">In vitro</italic> studies</title>
      <p>The datasets of two <italic toggle="yes">in vitro</italic> studies were downloaded from <ext-link xlink:href="http://medgen.medschl.cam.ac.uk/serena-nik-zainal/" ext-link-type="uri">http://medgen.medschl.cam.ac.uk/serena-nik-zainal/</ext-link>. The details of study design and implementation were described previously [<xref rid="pcbi.1009309.ref008" ref-type="bibr">8</xref>,<xref rid="pcbi.1009309.ref011" ref-type="bibr">11</xref>]. In these <italic toggle="yes">in vitro</italic> studies, the endogenous and exogenous mutational signatures were experimentally generated <italic toggle="yes">in vitro</italic> and hence the true number of signatures and profiles are known.</p>
      <p>We created the mutation type matrix for both studies and applied SUITOR, SigProfilerExtractor, SignatureAnalyzer and signeR. We chose SigProfilerExtractor and SignatureAnalyzer, since they have been applied to a number of studies [<xref rid="pcbi.1009309.ref013" ref-type="bibr">13</xref>,<xref rid="pcbi.1009309.ref014" ref-type="bibr">14</xref>,<xref rid="pcbi.1009309.ref028" ref-type="bibr">28</xref>,<xref rid="pcbi.1009309.ref054" ref-type="bibr">54</xref>–<xref rid="pcbi.1009309.ref056" ref-type="bibr">56</xref>], and signeR [<xref rid="pcbi.1009309.ref027" ref-type="bibr">27</xref>] because it utilizes Bayesian information criterion (BIC), a popular model selection criterion for supervised learning. For SUITOR, we used 10-fold cross-validation with 90% of counts in mutation type matrix as the training set and the remaining 10% as the validation set. In contrast, the whole mutation type matrix <bold>V</bold> was analyzed by SigProfilerExtractor, SignatureAnalyzer and signeR, respectively under the default setting.</p>
      <p>The first study induced endogenous mutational signatures by CRISPR-Cas9-mediated knockouts of DNA repair genes in an isogenic human cell line. First, we focused on the <italic toggle="yes">MSH6</italic> knockout-induced single base substitution signature, which is characterized by C&gt;T and T&gt;C single base substitutions (~148 substitutions per cell division). We evaluated whether the four methods were able to retrieve the background signature and the <italic toggle="yes">MSH6</italic> knockout-induced signatures. Next, we analyzed the gene-knockout studies with no induced signatures (for genes <italic toggle="yes">CHK2</italic>, <italic toggle="yes">NEIL1</italic>, <italic toggle="yes">NUDT1</italic>, <italic toggle="yes">POLB</italic>, <italic toggle="yes">POLE</italic> and <italic toggle="yes">POLM</italic>), to evaluate whether the four methods would find false positive signatures in addition to the background signature.</p>
      <p>In the second study, exogenous mutational signatures were created by environmental or therapeutic mutagens. We selected 324 subclones (including 35 control subclones) of human-induced pluripotent stem cell (iPSC) lines, for which the mutations were measured by whole-genome sequencing (WGS). While controls are not exposed to mutagens, each subclone is exposed to one of 79 mutagens, including simulated solar radiation (SSR), dibenzo[a,l]pyrene (DBP) and alkylating agent therapy temozolomide (TMZ). SSR recapitulates the UV-associated signatures and DBP is a potent carcinogen of the polycyclic aromatic hydrocarbons (PAHs) produced when coal, crude oil, or gasoline is burned. The stable mutational signatures were experimentally identified for 28 mutagens. Note that these 28 signature profiles identified by experiments are not distinct. Hierarchical clustering of 28 signature profiles indicated signature profiles are clustered together with 13 clusters based on cosine similarity &gt; 0.8 between profiles (<xref rid="pcbi.1009309.s011" ref-type="supplementary-material">S11A Fig</xref>); consensus clustering showed that 13 clusters of signature profiles demonstrated the stable clustering (consensus matrix in <xref rid="pcbi.1009309.s011" ref-type="supplementary-material">S11B Fig</xref>).</p>
      <p>For each method, we checked if the correct number of signatures were attained with its impacts on the downstream analyses. Specifically, we investigated whether the retrieved <italic toggle="yes">de novo</italic> signature profiles were highly similar to the true signature profiles. We further explored if signature contributes could separate subclones exposed to the distinctive mutagens, visualized by t-distributed stochastic neighbor embedding (t-SNE [<xref rid="pcbi.1009309.ref057" ref-type="bibr">57</xref>]).</p>
    </sec>
    <sec id="sec018">
      <title><italic toggle="yes">In silico</italic> simulation design of one signature</title>
      <p>We simulated a mutation type matrix for 500 tumors and analyzed it by the four methods, each repeated 20 times. We used the signature profile of SBS8 as the true signature profile for <bold>W</bold> and generated the activity vector <bold>H</bold> from a uniform distribution within the range [20000, 40000]. SBS8 is dominated by C&gt;A and T&gt;A mutations but not as flat as signature SBS3 or SBS5 and not as spiky as signature SBS1 or SBS2. Then the mutation type <bold>V</bold> was generated by a Poisson distribution with mean <bold>WH</bold>.</p>
    </sec>
    <sec id="sec019">
      <title><italic toggle="yes">In silico</italic> simulation design of nine signatures</title>
      <p>We simulated signatures mimic to the ones observed in the Pan-Cancer Analysis of Whole Genomes (PCAWG) breast cancer study [<xref rid="pcbi.1009309.ref001" ref-type="bibr">1</xref>]. The nine signatures identified by SUITOR show various signature activities and signature profiles; some signatures contribute to all tumors (e.g., SBS1 and SBS5, present in 100% of tumors; Table C in <xref rid="pcbi.1009309.s013" ref-type="supplementary-material">S1 Table</xref>) while others contribute to a few tumors (e.g., SBS41, present in 6% of tumors) and even to one (SBS40) or two tumors (SBS8); some signature profiles are spiky (e.g., SBS1 and SBS2/13; <xref rid="pcbi.1009309.s008" ref-type="supplementary-material">S8 Fig</xref>) while others are relatively flat (e.g., SBS5).</p>
      <p>Specifically, we generated mutation type matrices similar to <bold>V</bold><sup>BR</sup>, the mutation type matrix of PCAWG breast cancer study. <bold>V</bold><sup>BR</sup> is approximated by <bold>W</bold><sup>BR</sup><bold>H</bold><sup>BR</sup>, for which <bold>W</bold><sup>BR</sup> contains the COSMIC signature profiles and <bold>H</bold><sup>BR</sup> is the corresponding signature activity matrix (downloaded from <ext-link xlink:href="https://www.synapse.org/#!Synapse:syn11738669" ext-link-type="uri">https://www.synapse.org/#!Synapse:syn11738669</ext-link>). We removed signatures with zero activities to all tumors and chose 9 signatures to compose the signature profile matrix <bold>W</bold><sup>BR</sup> of size 96×9. With <bold>W</bold><sup>BR</sup> fixed, we took bootstrap samples <inline-formula id="pcbi.1009309.e042"><alternatives><graphic xlink:href="pcbi.1009309.e042.jpg" id="pcbi.1009309.e042g" position="anchor"/><mml:math id="M42" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">o</mml:mi><mml:mi mathvariant="bold-italic">o</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> from each column of matrix <bold>H</bold><sup>BR</sup>, and generated <inline-formula id="pcbi.1009309.e043"><alternatives><graphic xlink:href="pcbi.1009309.e043.jpg" id="pcbi.1009309.e043g" position="anchor"/><mml:math id="M43" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">o</mml:mi><mml:mi mathvariant="bold-italic">o</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> which follows a Poisson distribution with mean <bold>W</bold><sup>BR</sup>
<inline-formula id="pcbi.1009309.e044"><alternatives><graphic xlink:href="pcbi.1009309.e044.jpg" id="pcbi.1009309.e044g" position="anchor"/><mml:math id="M44" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi mathvariant="bold-italic">o</mml:mi><mml:mi mathvariant="bold-italic">o</mml:mi><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Due to the dependencies between SBS1 and SBS5 as well as between SBS2 and SBS13, their activities are resampled jointly while the activities of other signatures are sampled individually. We simulated 20 mutation type matrices for 200 tumors, and each was analyzed by four methods respectively.</p>
    </sec>
    <sec id="sec020">
      <title><italic toggle="yes">In silico</italic> simulation of eight signatures with some mutations called by mistake</title>
      <p>We simulated a mutation type matrix for 300 tumors with mutation calling errors. We repeated this simulation 20 times and analyzed the simulated type matrices by SUITOR, SigProfilerExtractor, SignatureAnalyzer, signeR, CV2k and sparseSignatures. We chose eight signature profiles as the true signature profiles for <bold>W</bold> to cover all six major substitution types: SBS4 for [C &gt; A], SBS39 for [C &gt; G], SBS6 and SBS7a for [C &gt; T], SBS22 for [T &gt; A], SBS26 for [T &gt; C], SBS17b for [T &gt; G] and SBS9 for [T &gt; C] and [T &gt; G]. The activity matrix <bold>H</bold> was first generated from a uniform distribution with the range [0, 100], then some randomly chosen elements in the activity matrix <bold>H</bold> were set as zero to mimic the real data. The true mutation type <bold>V</bold><sup><bold>0</bold></sup> without error was generated by a Poisson distribution with mean <bold>WH</bold>. In addition, we added error mutation counts for each mutation type and each tumor caused by possible sequencing and/or calling errors; we chose a relatively simple noise model to imitate error mutation counts not specific to a subset of mutation types. Specifically, error mutation counts were generated independently and identically from a uniform distribution for each mutation type with the range [0, <bold>a</bold>×<bold>b</bold>] and were rounded to the nearest integer, where the error level <bold>a</bold> equates to 0 (i.e., no error mutation counts), 0.4, 0.8 and 1.2, and <bold>b</bold> is the average mutation count of each tumor (i.e., <bold>b</bold> being the column average of the matrix <bold>V</bold><sup><bold>0</bold></sup>). Hence, the error mutation counts were proportional to counts of true mutation counts with varying error levels.</p>
    </sec>
    <sec id="sec021">
      <title><italic toggle="yes">In vivo</italic> human cancer genomics studies</title>
      <p>We analyzed 2, 540 tumors across 22 cancer types of PCAWG [<xref rid="pcbi.1009309.ref001" ref-type="bibr">1</xref>], including 321 tumors of hepatocellular carcinoma, 286 tumors of prostate adenocarcinoma, 237 tumors of pancreatic adenocarcinoma, 194 tumors of breast adenocarcinoma, 146 tumors of central nervous system medulloblastoma, 143 tumors of renal cell carcinoma,112 tumors of ovary adenocarcinoma and 100 cases of B-cell non-Hodgkin lymphoma. Other cancer types have less than 100 tumors per cancer type. The tumors were whole genome sequenced and datasets of the somatic mutation calls were downloaded from <ext-link xlink:href="https://www.synapse.org/#!Synapse:syn11726620" ext-link-type="uri">https://www.synapse.org/#!Synapse:syn11726620</ext-link>, which includes single base substitution (SBS) and Insertions and Deletions (INDEL). The hypermutator tumors with SBS mutation burden more than 10 mutations/Mb were excluded [<xref rid="pcbi.1009309.ref058" ref-type="bibr">58</xref>] (e.g., we excluded 5 tumors of hepatocellular carcinoma, 4 tumors of pancreatic adenocarcinoma, 4 tumors of breast adenocarcinoma, 1 tumor of renal cell carcinoma,1 tumor of ovary adenocarcinoma, 7 tumors of B-cell non-Hodgkin lymphoma and zero tumors for other two cancer types). For each cancer type, we applied SUITOR, SigProfilerExtractor, SignatureAnalyzer and signeR to select the number of signatures and estimate signature activities and profiles. The signatures with cosine similarity larger than 0.8 were reported. The higher the cosine similarity the better match to a COSMIC signature profile. The cosine similarity equivalent to one denotes a perfect match. Note that the cosine similarity larger than 0.9 is a more stringent cutoff and our simulation studies show few true signatures may be missed by using the cosine similarity 0.9 as the cutoff.</p>
      <p>To compare the prediction errors, we split the mutation type matrix into a training set (90% of counts in the mutation type matrix), a validation set (5%) and a testing set (5%). For SUITOR, the training set was used to fit the probabilistic NMF model with multiple numbers of signatures and the validation set to select the number of signatures. The other methods used both the training and validation sets to select the number of signatures. Next, we compared the prediction errors of selected signatures by each method on the testing set. For SigProfilerExtractor, SignatureAnalyzer and signeR, we imputed missing training data by medians of available mutation counts per each mutational type, applied each method, predicted the testing data and calculated the prediction error as SUITOR did. For SUITOR, it could handle missing data and predict the testing data by the ECM algorithm. Note that the split of the mutation type matrix into a training set (90% of counts in the mutation type matrix), a validation set (5%) and a testing set (5%) was used for comparing the prediction errors only. For comparing the extracted profiles (<xref rid="pcbi.1009309.g004" ref-type="fig">Fig 4B and 4C</xref>), all counts in the mutation type matrix were used for SigProfilerExtractor, SignatureAnalyzer and signeR.</p>
    </sec>
    <sec id="sec022">
      <title>Sanger whole genome sequencing breast cancer study</title>
      <p>The Sanger whole genome breast cancer (BRCA) study sequenced 560 breast tumors. The somatic mutation calls files were downloaded from <ext-link xlink:href="ftp://ftp.sanger.ac.uk/pub/cancer/Nik-ZainalEtAl-560BreastGenomes" ext-link-type="ftp">ftp://ftp.sanger.ac.uk/pub/cancer/Nik-ZainalEtAl-560BreastGenomes</ext-link>. Among 560 breast tumors, 110 tumors were included in PCAWG and hence excluded from this validation study. Ten hypermutator tumors were also excluded. We applied SUITOR, SigProfilerExtractor, SignatureAnalyzer and signeR to a) select the number of signatures and estimate signature activities and profiles; b) compare the signatures with ones detected in the PCAWG breast cancer study; and c) investigate if additional signatures are found in Sanger whole genome breast cancer study. In addition, we stratified the tumors based on mutation activities and associated the signature clusters with epidemiological or clinical characteristics.</p>
    </sec>
  </sec>
  <sec id="sec023" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1009309.s001" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>The number of signatures selected for the knockout study of DNA repair gene <italic toggle="yes">MSH6</italic>.</title>
        <p>Each plot shows how SigProfilerExtractor (A), SignatureAnalyzer (B) and signeR (C) select the optimal number of signatures respectively.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1009309.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009309.s002" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>The signatures detected in knockout studies of six DNA repair genes.</title>
        <p>A) The plots of criteria to select the optimal number of signatures by SUITOR, SigProfilerExtractor, signeR and SignatureAnalyzer (in clockwise order). B) The profiles of signatures discovered by each method.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1009309.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009309.s003" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>Signature profiles identified experimentally from the <italic toggle="yes">in vitro</italic> study of environmental or therapeutic mutagens.</title>
        <p>The signatures include 28 mutagen-induced signatures and a background signature existing in control samples and all mutagen treated samples. ENU: N-ethyl-N-nitrosourea; DBP+S9: dibenzo[a,l]pyrene mixed with S9 rodent liver-derived metabolic enzyme; PhiP+S9: 2-amino-1-methyl-6-phenylimidazo[4,5-b]pyridine mixed with S9 rodent liver-derived metabolic enzyme; MNU: N-methyl-N-nitrosourea; DBPDE: dibenzo[a,l]pyrene diol-epoxide; MX: 3-chloro-4-(dichloromethyl)-5-hydroxy- 2(5H)-furanone; AAI: aristolochic acid I; 1,2-DMH+S9: 1,2-dimethylhydrazine mixed with S9 rodent liver-derived metabolic enzyme; 1,8-DNP: 1,8-Dinitropyrene; DBA+S9: dibenz[a,h]anthracene mixed with S9 rodent liver-derived metabolic enzyme; 3-NBA: 3-nitrobenzanthrone; DBADE: dibenz[a,h]anthracene diol-epoxide; 1,6-DNP: 1,6-Dinitropyrene; DES: diethyl sulfate; DBAC: dibenz[a,j]acridine; 5-Methylchrysene+S9: 5-Methylchrysene mixed with S9 rodent liver-derived metabolic enzyme; SSR: simulated solar radiation; BaP+S9: benzo[a]pyrene mixed with S9 rodent liver-derived metabolic enzyme; 6-Nitrochrysene+S9: 6-Nitrochrysene mixed with S9 rodent liver-derived metabolic enzyme; BPDE: benzo[a]pyrene-7,8-dihydrodiol-9,10-epoxide.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1009309.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009309.s004" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <p><bold>The number of signatures selected from the <italic toggle="yes">in vitro</italic> study of environmental or therapeutic mutagens by A) SigProfilerExtractor, B) SignatureAnalyzer and C) signeR.</bold> The numbers of detected signatures include one background signature and additional mutagen-induced mutational signatures.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1009309.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009309.s005" position="float" content-type="local-data">
      <label>S5 Fig</label>
      <caption>
        <title>Clusters of subclones of <italic toggle="yes">in vitro</italic> study of exogenous mutagens, visualized by t-SNE for SUITOR, SigProfilerExtractor, SignatureAnalyzer and signeR.</title>
        <p>Each dot represents a subclone, colored by the mutagen treatment.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1009309.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009309.s006" position="float" content-type="local-data">
      <label>S6 Fig</label>
      <caption>
        <p>The number of signatures selected for <italic toggle="yes">in silico</italic> simulation studies with one signature by SUITOR (A), SigProfilerExtractor (B), SignatureAnalyzer (C) and signeR (D) for one replicate as an illustration.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1009309.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009309.s007" position="float" content-type="local-data">
      <label>S7 Fig</label>
      <caption>
        <title>The signature profiles of the true mutational signature and the ones discovered by each method for a replicate in <italic toggle="yes">in silico</italic> simulation studies with one signature.</title>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1009309.s007.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009309.s008" position="float" content-type="local-data">
      <label>S8 Fig</label>
      <caption>
        <title>The profiles of nine signatures pre-specified in the <italic toggle="yes">in silico</italic> simulation studies.</title>
        <p>Some signature profiles are spiky (e.g., SBS1 and SBS2/13), while others are relatively flat (e.g., SBS5).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1009309.s008.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009309.s009" position="float" content-type="local-data">
      <label>S9 Fig</label>
      <caption>
        <title>The cosine similarities over 20 replicates of SUITOR, SigProfilerExtractor, SignatureAnalyzer and signeR for <italic toggle="yes">in silico</italic> simulation (A) with nine COSIMIC signatures and (B) with eight COSMIC signatures added by sequencing errors.</title>
        <p>The length of the solid line represents the standard deviation.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1009309.s009.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009309.s010" position="float" content-type="local-data">
      <label>S10 Fig</label>
      <caption>
        <title>The boxplots of mutation contributions of 12 signatures for signature clusters G3 and G4 in Sanger breast cancer study.</title>
        <p>The signatures of the Sanger BRCA study are annotated by COSMIC signatures (if cosine similarities &gt; 0.8) among parentheses. For example, DNSigA (SBS1) refers to de novo signature A (DNSigA) being annotated by COSMIC signature SBS1.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1009309.s010.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009309.s011" position="float" content-type="local-data">
      <label>S11 Fig</label>
      <caption>
        <p>(A) The dendrogram of hierarchical clustering of 28 mutagens with complete linkage method. The height of the branches represents the dissimilarity defined as 1 minus cosine similarity between two signature profiles. The dashed red line corresponds to 0.8 cosine similarity which suggests 13 clusters. (B) The heatmap of the cluster consensus matrix for k = 13. Elements of the consensus matrix show the proportions of concordant mutagen pairs over resampled data: white (0%) indicates never clustered together and dark blue (100%) shows clustered together always.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1009309.s011.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009309.s012" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>Supplementary notes.</title>
        <p>Supplementary note 1 in <xref rid="pcbi.1009309.s012" ref-type="supplementary-material">S1 Text</xref>: on Bayesian information criteria (BIC) for mutational signature analysis. Supplementary note 2 in <xref rid="pcbi.1009309.s012" ref-type="supplementary-material">S1 Text</xref>: on equivalence between multiplicative update algorithm of NMF and exception/conditional maximization (ECM) algorithm for a Poisson NMF model. Supplementary note 3 in <xref rid="pcbi.1009309.s012" ref-type="supplementary-material">S1 Text</xref>: expectation/conditional maximization (ECM) algorithm.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1009309.s012.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009309.s013" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>Supplementary tables.</title>
        <p><bold>Table A in S1 Table:</bold> The cosine similarities between the <italic toggle="yes">de novo</italic> signatures and the true <italic toggle="yes">in vitro</italic> signatures. <italic toggle="yes">De novo</italic> signatures are discovered by SUITOR, SUITOR, SigProfilerExtractor, SignatureAnalyzer and signeR. Cosine similarity is used to compare them with true <italic toggle="yes">in vitro</italic> signatures: the background signature and signature induced by MSH6 gene knockout. Cosine similarity ranges from 0 to 1, with a cosine of 1 indicating a perfect match. <bold>Table B in S1 Table:</bold> The cosine similarities between the signatures discovered by SUITOR, SigProfilerExtractor, SignatureAnalyzer, signeR and the true mutagen-induced signatures. For each <italic toggle="yes">de novo</italic> signature, the largest cosine similarities are highlighted in red, indicating the strongest similarity to the corresponding <italic toggle="yes">in vitro</italic> signatures. ENU: N-ethyl-N-nitrosourea; DES: diethyl sulfate; 1,2-DMH+S9: 1,2-dimethylhydrazine mixed with S9 rodent liver-derived metabolic enzyme; TMZ: Temozolomide; SSR: simulated solar radiation; 6-NC: 6-Nitrochrysene; AAI: aristolochic acid I. <bold>Table C in S1 Table:</bold> The percentage of nonzeros, mean and standard deviation (SD) of signature contributions in <italic toggle="yes">in silico</italic> simulation studies of nine signatures. <bold>Table D in S1 Table</bold>: The selected number of signatures out of 20 in <italic toggle="yes">in silico</italic> simulations of nine signatures for SUITOR, SigProfilerExtractor, SignatureAnalyzer, signeR. The column with #(CS &gt; 0.8) indicates the number of signatures based on the threshold 0.8, while the column with #(CS&gt;0.9) indicates the number of signatures based on the threshold 0.9. <bold>Table E in S1 Table</bold>: The selected number of signatures out of 20 in <italic toggle="yes">in silico</italic> simulations with sequencing errors for SUITOR, SigProfilerExtractor, SignatureAnalyzer, signeR. The column with #(CS &gt; 0.8) indicates the number of signatures based on the threshold 0.8, while the column with #(CS&gt;0.9) indicates the number of signatures based on the threshold 0.9. Sequencing errors per each tumor were generated from a uniform distribution within the range [0, a×b], where the letter a denotes ErrorLevel (0 means no sequencing errors) and b is the average mutation count of each tumor. The frequencies of signature SBS9 are highlighted in red because the frequency of signature SBS9 to be detected across 20 replicates would be reduced for all methods if the cosine similarity threshold is increased to 0.9. <bold>Table F in S1 Table:</bold> The selected number of signatures out of 20 in <italic toggle="yes">in silico</italic> simulations with sequencing errors for SparseSignatures and CV2K. Sequencing errors per each tumor were generated from a uniform distribution within the range [0, a×b], where the a denotes ErrorLevel (0 means no sequencing errors) and b is the average mutation count of each tumor. <bold>Table G in S1 Table:</bold> The number of signatures identified by SparseSignatures and CV2K for eight cancer types of PCAWG studies, entire PCAWG data and Sanger Breast cancer study. The column with CS* &gt; 0.8 indicates the number of signatures whose largest cosine similarity is greater than 0.8 for SparseSignatures method. <bold>Table H in S1 Table:</bold> The cosine similarities between <italic toggle="yes">de novo</italic> signatures discovered by SparseSignatures in <italic toggle="yes">in vivo</italic> studies. We annotated them with COSIMC signature having the largest cosine similarity. COSMIC signatures and cosine similarities are highlighted in red if it is larger than 0.8. Duplicated signatures with repsect to the highest cosine similarity are marked with an asterisk. <bold>Table I in S1 Table:</bold> The cosine similarity between <italic toggle="yes">de novo</italic> signatures discovered by SUITOR in PCAWG breast cancer study and <italic toggle="yes">de novo</italic> signatures discovered by SUITOR in Sanger breast cancer study. For each column, the largest cosine similarity is highlighted in red if it is larger than 0.8 or in blue otherwise, corresponding to the COSMIC signature most similar to a given PCAWG or Sanger signature. <bold>Table J in S1 Table:</bold> The cosine similarity between <italic toggle="yes">de novo</italic> signatures discovered by signeR in PCAWG breast cancer study and <italic toggle="yes">de novo</italic> signatures discovered by signeR in Sanger breast cancer study. For each column, the largest cosine similarity is highlighted in red if it is larger than 0.8 or in blue otherwise, corresponding to the COSMIC signature most similar to a given PCAWG or Sanger signature. <bold>Table K in S1 Table:</bold> The cosine similarity between <italic toggle="yes">de novo</italic> signatures discovered by SigProfilerExtractor in PCAWG breast cancer study and de novo signatures discovered by SigProfilerExtractor in Sanger breast cancer study. For each column, the largest cosine similarity is highlighted in red if it is larger than 0.8 or in blue otherwise, corresponding to the COSMIC signature most similar to a given PCAWG or Sanger signature. <bold>Table L in S1 Table:</bold> The cosine similarity between <italic toggle="yes">de novo</italic> signatures discovered by SignatureAnalyzer in PCAWG breast cancer study and <italic toggle="yes">de novo</italic> signatures discovered by SignatureAnalyzer in Sanger breast cancer study. For each column, the largest cosine similarity is highlighted in red if it is larger than 0.8 or in blue otherwise, corresponding to the COSMIC signature most similar to a given PCAWG or Sanger signature. <bold>Table M in S1 Table:</bold> The cosine similarity between <italic toggle="yes">de novo</italic> signatures discovered by SUITOR in PCAWG breast cancer study and in Sanger breast cancer study with COSMIC signature profiles. For each column, the largest cosine similarity is highlighted in red if it is larger than 0.8 or in blue otherwise, corresponding to the COSMIC signature most similar to a given PCAWG or Sanger signature. <bold>Table N in S1 Table:</bold> The cosine similarity between <italic toggle="yes">de novo</italic> signatures discovered by SigProfilerExtractor in PCAWG breast cancer study and in Sanger breast cancer study with COSMIC signature profiles. For each column, the largest cosine similarity is highlighted in red if it is larger than 0.8 or in blue otherwise, corresponding to the COSMIC signature most similar to a given PCAWG or Sanger signature. <bold>Table O in S1 Table:</bold> The cosine similarity between <italic toggle="yes">de novo</italic> signatures discovered by SignatureAnalyzer in PCAWG breast cancer study and in Sanger breast cancer study with COSMIC signature profiles. For each column, the largest cosine similarity is highlighted in red if it is larger than 0.8 or in blue otherwise, corresponding to the COSMIC signature most similar to a given PCAWG or Sanger signature. <bold>Table P in S1 Table:</bold> The cosine similarity between <italic toggle="yes">de novo</italic> signatures discovered by signeR in PCAWG breast cancer study and in Sanger breast cancer study with COSMIC signature profiles. For each column, the largest cosine similarity is highlighted in red if it is larger than 0.8 or in blue otherwise, corresponding to the COSMIC signature most similar to a given PCAWG or Sanger signature. <bold>Table Q in S1 Table:</bold> The mean and standard deviation (SD) of signature contributions by signature subtype G3 and G4. <bold>Table R in S1 Table:</bold> The clinical and pathological factors associated with the subgroups G3 and G4. a) For continuous factors; b) for discrete factors. <bold>Table S in S1 Table:</bold> The cosine similarities between <italic toggle="yes">de novo</italic> INDEL signatures in ovarian adenocarcinoma by SUITOR and COSIMC INDEL signatures. <bold>Table T in S1 Table:</bold> The cosine similarity between <italic toggle="yes">de novo</italic> signatures discovered by SUITOR and the signatures reported in the original <italic toggle="yes">C</italic>. <italic toggle="yes">elegans</italic> study (Volkova et al. 2020). COSMIC signatures and cosine similarities are highlighted in red if it is larger than 0.8. <bold>Table U in S1 Table:</bold> The cosine similarity between <italic toggle="yes">de novo</italic> signatures discovered by SUITOR in PCAWG colorectal, esophageal, and head SCC cancer studies. COSMIC signatures and cosine similarities are highlighted in red if it is larger than 0.8. The numbers in parentheses are the number of tumors for each study.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1009309.s013.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009309.s014" position="float" content-type="local-data">
      <label>S1 Data</label>
      <caption>
        <title>Information for software and dataset webpages.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1009309.s014.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009309.s015" position="float" content-type="local-data">
      <label>S2 Data</label>
      <caption>
        <title>The input and output matrices of signature profiles (W) and activities (H) for the SUITOR as well as the benchmarking methods (SigProfilerExtractor, SignatureAnalyzer, and signeR) as results of <italic toggle="yes">in vitro</italic> and the Pan-Cancer Analysis of Whole Genomes (PCAWG) studies.</title>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pcbi.1009309.s015.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>This study utilized the high-performance computational capabilities of the Biowulf Linux cluster at the National Institutes of Health, Bethesda, MD: <ext-link xlink:href="https://biowulf.nih.gov/" ext-link-type="uri">https://biowulf.nih.gov</ext-link>. We would like to thank Bill Wheeler (Information Management Services) for computation support and Dr. Paul Albert (Biostatistics Branch of DCEG) and Dr. Ludmil Alexandrov (University of California San Diego) for helpful comments. We appreciate the help from authors of CV2K and SparseSignatures.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1009309.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Alexandrov</surname><given-names>LB</given-names></name>, <name><surname>Kim</surname><given-names>J</given-names></name>, <name><surname>Haradhvala</surname><given-names>NJ</given-names></name>, <name><surname>Huang</surname><given-names>MN</given-names></name>, <name><surname>Tian Ng</surname><given-names>AW</given-names></name>, <name><surname>Wu</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>The repertoire of mutational signatures in human cancer</article-title>. <source>Nature</source>. <year>2020</year>;<volume>578</volume>(<issue>7793</issue>):<fpage>94</fpage>–<lpage>101</lpage>. Epub 2020/02/07. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-020-1943-3</pub-id> ; PubMed Central PMCID: PMC7054213.<?supplied-pmid 32025018?><pub-id pub-id-type="pmid">32025018</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Nik-Zainal</surname><given-names>S</given-names></name>, <name><surname>Davies</surname><given-names>H</given-names></name>, <name><surname>Staaf</surname><given-names>J</given-names></name>, <name><surname>Ramakrishna</surname><given-names>M</given-names></name>, <name><surname>Glodzik</surname><given-names>D</given-names></name>, <name><surname>Zou</surname><given-names>X</given-names></name>, <etal>et al</etal>. <article-title>Landscape of somatic mutations in 560 breast cancer whole-genome sequences</article-title>. <source>Nature</source>. <year>2016</year>;<volume>534</volume>(<issue>7605</issue>):<fpage>47</fpage>–<lpage>54</lpage>. Epub 2016/05/03. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature17676</pub-id> ; PubMed Central PMCID: PMC4910866.<?supplied-pmid 27135926?><pub-id pub-id-type="pmid">27135926</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Roberts</surname><given-names>ND</given-names></name>, <name><surname>Wala</surname><given-names>JA</given-names></name>, <name><surname>Shapira</surname><given-names>O</given-names></name>, <name><surname>Schumacher</surname><given-names>SE</given-names></name>, <name><surname>Kumar</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Patterns of somatic structural variation in human cancer genomes</article-title>. <source>Nature</source>. <year>2020</year>;<volume>578</volume>(<issue>7793</issue>):<fpage>112</fpage>–<lpage>21</lpage>. Epub 2020/02/07. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-019-1913-9</pub-id> ; PubMed Central PMCID: PMC7025897.<?supplied-pmid 32025012?><pub-id pub-id-type="pmid">32025012</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Macintyre</surname><given-names>G</given-names></name>, <name><surname>Goranova</surname><given-names>TE</given-names></name>, <name><surname>De Silva</surname><given-names>D</given-names></name>, <name><surname>Ennis</surname><given-names>D</given-names></name>, <name><surname>Piskorz</surname><given-names>AM</given-names></name>, <name><surname>Eldridge</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Copy number signatures and mutational processes in ovarian carcinoma</article-title>. <source>Nat Genet</source>. <year>2018</year>;<volume>50</volume>(<issue>9</issue>):<fpage>1262</fpage>–<lpage>70</lpage>. Epub 2018/08/15. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41588-018-0179-8</pub-id> ; PubMed Central PMCID: PMC6130818.<?supplied-pmid 30104763?><pub-id pub-id-type="pmid">30104763</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>S</given-names></name>, <name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Song</surname><given-names>M</given-names></name>, <name><surname>Tao</surname><given-names>Z</given-names></name>, <name><surname>Wu</surname><given-names>T</given-names></name>, <name><surname>He</surname><given-names>Z</given-names></name>, <etal>et al</etal>. <article-title>Copy number signature analysis tool and its application in prostate cancer reveals distinct mutational processes and clinical outcomes</article-title>. <source>PLoS Genet</source>. <year>2021</year>;<volume>17</volume>(<issue>5</issue>):<fpage>e1009557</fpage>. Epub 2021/05/05. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pgen.1009557</pub-id> ; PubMed Central PMCID: PMC8121287.<?supplied-pmid 33945534?><pub-id pub-id-type="pmid">33945534</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Steele</surname><given-names>CD</given-names></name>, <name><surname>Abbasi</surname><given-names>A</given-names></name>, <name><surname>Islam</surname><given-names>SMA</given-names></name>, <name><surname>Khandekar</surname><given-names>A</given-names></name>, <name><surname>Haase</surname><given-names>K</given-names></name>, <name><surname>Hames</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Signatures of copy number alterations in human cancer</article-title>. <source>bioRxiv</source>. <year>2021</year>:2021.04.30.441940. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/2021.04.30.441940</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Tate</surname><given-names>JG</given-names></name>, <name><surname>Bamford</surname><given-names>S</given-names></name>, <name><surname>Jubb</surname><given-names>HC</given-names></name>, <name><surname>Sondka</surname><given-names>Z</given-names></name>, <name><surname>Beare</surname><given-names>DM</given-names></name>, <name><surname>Bindal</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>COSMIC: the Catalogue Of Somatic Mutations In Cancer</article-title>. <source>Nucleic Acids Res</source>. <year>2019</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D941</fpage>–<lpage>D7</lpage>. Epub 2018/10/30. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gky1015</pub-id> ; PubMed Central PMCID: PMC6323903.<?supplied-pmid 30371878?><pub-id pub-id-type="pmid">30371878</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Kucab</surname><given-names>JE</given-names></name>, <name><surname>Zou</surname><given-names>X</given-names></name>, <name><surname>Morganella</surname><given-names>S</given-names></name>, <name><surname>Joel</surname><given-names>M</given-names></name>, <name><surname>Nanda</surname><given-names>AS</given-names></name>, <name><surname>Nagy</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>A Compendium of Mutational Signatures of Environmental Agents</article-title>. <source>Cell</source>. <year>2019</year>;<volume>177</volume>(<issue>4</issue>):<fpage>821</fpage>–<lpage>36</lpage> e16. Epub 2019/04/16. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2019.03.001</pub-id> ; PubMed Central PMCID: PMC6506336.<?supplied-pmid 30982602?><pub-id pub-id-type="pmid">30982602</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Alexandrov</surname><given-names>LB</given-names></name>, <name><surname>Ju</surname><given-names>YS</given-names></name>, <name><surname>Haase</surname><given-names>K</given-names></name>, <name><surname>Van Loo</surname><given-names>P</given-names></name>, <name><surname>Martincorena</surname><given-names>I</given-names></name>, <name><surname>Nik-Zainal</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Mutational signatures associated with tobacco smoking in human cancer</article-title>. <source>Science</source>. <year>2016</year>;<volume>354</volume>(<issue>6312</issue>):<fpage>618</fpage>–<lpage>22</lpage>. Epub 2016/11/05. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.aag0299</pub-id> ; PubMed Central PMCID: PMC6141049.<?supplied-pmid 27811275?><pub-id pub-id-type="pmid">27811275</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Letouze</surname><given-names>E</given-names></name>, <name><surname>Shinde</surname><given-names>J</given-names></name>, <name><surname>Renault</surname><given-names>V</given-names></name>, <name><surname>Couchy</surname><given-names>G</given-names></name>, <name><surname>Blanc</surname><given-names>JF</given-names></name>, <name><surname>Tubacher</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Mutational signatures reveal the dynamic interplay of risk factors and cellular processes during liver tumorigenesis</article-title>. <source>Nat Commun</source>. <year>2017</year>;<volume>8</volume>(<issue>1</issue>):<fpage>1315</fpage>. Epub 2017/11/05. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-017-01358-x</pub-id> ; PubMed Central PMCID: PMC5670220.<?supplied-pmid 29101368?><pub-id pub-id-type="pmid">29101368</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Zou</surname><given-names>X</given-names></name>, <name><surname>Owusu</surname><given-names>M</given-names></name>, <name><surname>Harris</surname><given-names>R</given-names></name>, <name><surname>Jackson</surname><given-names>SP</given-names></name>, <name><surname>Loizou</surname><given-names>JI</given-names></name>, <name><surname>Nik-Zainal</surname><given-names>S</given-names></name>. <article-title>Validating the concept of mutational signatures with isogenic cell models</article-title>. <source>Nat Commun</source>. <year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>1744</fpage>. Epub 2018/05/03. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-018-04052-8</pub-id> ; PubMed Central PMCID: PMC5931590.<?supplied-pmid 29717121?><pub-id pub-id-type="pmid">29717121</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Polak</surname><given-names>P</given-names></name>, <name><surname>Kim</surname><given-names>J</given-names></name>, <name><surname>Braunstein</surname><given-names>LZ</given-names></name>, <name><surname>Karlic</surname><given-names>R</given-names></name>, <name><surname>Haradhavala</surname><given-names>NJ</given-names></name>, <name><surname>Tiao</surname><given-names>G</given-names></name>, <etal>et al</etal>. <article-title>A mutational signature reveals alterations underlying deficient homologous recombination repair in breast cancer</article-title>. <source>Nat Genet</source>. <year>2017</year>;<volume>49</volume>(<issue>10</issue>):<fpage>1476</fpage>–<lpage>86</lpage>. Epub 2017/08/22. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ng.3934</pub-id> .<?supplied-pmid 28825726?><pub-id pub-id-type="pmid">28825726</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Haradhvala</surname><given-names>NJ</given-names></name>, <name><surname>Kim</surname><given-names>J</given-names></name>, <name><surname>Maruvka</surname><given-names>YE</given-names></name>, <name><surname>Polak</surname><given-names>P</given-names></name>, <name><surname>Rosebrock</surname><given-names>D</given-names></name>, <name><surname>Livitz</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Distinct mutational signatures characterize concurrent loss of polymerase proofreading and mismatch repair.</article-title><source>Nat Commun.</source><year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>1746</fpage>. Epub 2018/05/03. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-018-04002-4</pub-id> ; PubMed Central PMCID: PMC5931517.<?supplied-pmid 29717118?><pub-id pub-id-type="pmid">29717118</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Petljak</surname><given-names>M</given-names></name>, <name><surname>Alexandrov</surname><given-names>LB</given-names></name>, <name><surname>Brammeld</surname><given-names>JS</given-names></name>, <name><surname>Price</surname><given-names>S</given-names></name>, <name><surname>Wedge</surname><given-names>DC</given-names></name>, <name><surname>Grossmann</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Characterizing Mutational Signatures in Human Cancer Cell Lines Reveals Episodic APOBEC Mutagenesis</article-title>. <source>Cell</source>. <year>2019</year>;<volume>176</volume>(<issue>6</issue>):<fpage>1282</fpage>–<lpage>94</lpage> e20. Epub 2019/03/09. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2019.02.012</pub-id> ; PubMed Central PMCID: PMC6424819.<?supplied-pmid 30849372?><pub-id pub-id-type="pmid">30849372</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Grolleman</surname><given-names>JE</given-names></name>, <name><surname>de Voer</surname><given-names>RM</given-names></name>, <name><surname>Elsayed</surname><given-names>FA</given-names></name>, <name><surname>Nielsen</surname><given-names>M</given-names></name>, <name><surname>Weren</surname><given-names>RDA</given-names></name>, <name><surname>Palles</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Mutational Signature Analysis Reveals NTHL1 Deficiency to Cause a Multi-tumor Phenotype</article-title>. <source>Cancer Cell</source>. <year>2019</year>;<volume>35</volume>(<issue>2</issue>):<fpage>256</fpage>–<lpage>66</lpage> e5. Epub 2019/02/13. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.ccell.2018.12.011</pub-id> .<?supplied-pmid 30753826?><pub-id pub-id-type="pmid">30753826</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Drost</surname><given-names>J</given-names></name>, <name><surname>van Boxtel</surname><given-names>R</given-names></name>, <name><surname>Blokzijl</surname><given-names>F</given-names></name>, <name><surname>Mizutani</surname><given-names>T</given-names></name>, <name><surname>Sasaki</surname><given-names>N</given-names></name>, <name><surname>Sasselli</surname><given-names>V</given-names></name>, <etal>et al</etal>. <article-title>Use of CRISPR-modified human stem cell organoids to study the origin of mutational signatures in cancer</article-title>. <source>Science</source>. <year>2017</year>;<volume>358</volume>(<issue>6360</issue>):<fpage>234</fpage>–<lpage>8</lpage>. Epub 2017/09/16. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.aao3130</pub-id> ; PubMed Central PMCID: PMC6038908.<?supplied-pmid 28912133?><pub-id pub-id-type="pmid">28912133</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Secrier</surname><given-names>M</given-names></name>, <name><surname>Li</surname><given-names>X</given-names></name>, <name><surname>de Silva</surname><given-names>N</given-names></name>, <name><surname>Eldridge</surname><given-names>MD</given-names></name>, <name><surname>Contino</surname><given-names>G</given-names></name>, <name><surname>Bornschein</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Mutational signatures in esophageal adenocarcinoma define etiologically distinct subgroups with therapeutic relevance</article-title>. <source>Nat Genet</source>. <year>2016</year>;<volume>48</volume>(<issue>10</issue>):<fpage>1131</fpage>–<lpage>41</lpage>. Epub 2016/09/07. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ng.3659</pub-id> ; PubMed Central PMCID: PMC5957269.<?supplied-pmid 27595477?><pub-id pub-id-type="pmid">27595477</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Staaf</surname><given-names>J</given-names></name>, <name><surname>Glodzik</surname><given-names>D</given-names></name>, <name><surname>Bosch</surname><given-names>A</given-names></name>, <name><surname>Vallon-Christersson</surname><given-names>J</given-names></name>, <name><surname>Reutersward</surname><given-names>C</given-names></name>, <name><surname>Hakkinen</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Whole-genome sequencing of triple-negative breast cancers in a population-based clinical study</article-title>. <source>Nat Med</source>. <year>2019</year>;<volume>25</volume>(<issue>10</issue>):<fpage>1526</fpage>–<lpage>33</lpage>. Epub 2019/10/02. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41591-019-0582-4</pub-id> ; PubMed Central PMCID: PMC6859071.<?supplied-pmid 31570822?><pub-id pub-id-type="pmid">31570822</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Connor</surname><given-names>AA</given-names></name>, <name><surname>Denroche</surname><given-names>RE</given-names></name>, <name><surname>Jang</surname><given-names>GH</given-names></name>, <name><surname>Timms</surname><given-names>L</given-names></name>, <name><surname>Kalimuthu</surname><given-names>SN</given-names></name>, <name><surname>Selander</surname><given-names>I</given-names></name>, <etal>et al</etal>. <article-title>Association of Distinct Mutational Signatures With Correlates of Increased Immune Activity in Pancreatic Ductal Adenocarcinoma</article-title>. <source>JAMA Oncol</source>. <year>2017</year>;<volume>3</volume>(<issue>6</issue>):<fpage>774</fpage>–<lpage>83</lpage>. Epub 2016/10/22. <comment>doi: </comment><pub-id pub-id-type="doi">10.1001/jamaoncol.2016.3916</pub-id> ; PubMed Central PMCID: PMC5824324.<?supplied-pmid 27768182?><pub-id pub-id-type="pmid">27768182</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>X</given-names></name>, <name><surname>Wu</surname><given-names>WK</given-names></name>, <name><surname>Xing</surname><given-names>R</given-names></name>, <name><surname>Wong</surname><given-names>SH</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Fang</surname><given-names>X</given-names></name>, <etal>et al</etal>. <article-title>Distinct Subtypes of Gastric Cancer Defined by Molecular Characterization Include Novel Mutational Signatures with Prognostic Capability</article-title>. <source>Cancer Res</source>. <year>2016</year>;<volume>76</volume>(<issue>7</issue>):<fpage>1724</fpage>–<lpage>32</lpage>. Epub 2016/02/10. <comment>doi: </comment><pub-id pub-id-type="doi">10.1158/0008-5472.CAN-15-2443</pub-id> .<?supplied-pmid 26857262?><pub-id pub-id-type="pmid">26857262</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Omichessan</surname><given-names>H</given-names></name>, <name><surname>Severi</surname><given-names>G</given-names></name>, <name><surname>Perduca</surname><given-names>V</given-names></name>. <article-title>Computational tools to detect signatures of mutational processes in DNA from tumours: A review and empirical comparison of performance</article-title>. <source>PLoS One</source>. <year>2019</year>;<volume>14</volume>(<issue>9</issue>):<fpage>e0221235</fpage>. Epub 2019/09/13. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0221235</pub-id> ; PubMed Central PMCID: PMC6741849.<?supplied-pmid 31513583?><pub-id pub-id-type="pmid">31513583</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Grolleman</surname><given-names>JE</given-names></name>, <name><surname>Diaz-Gay</surname><given-names>M</given-names></name>, <name><surname>Franch-Exposito</surname><given-names>S</given-names></name>, <name><surname>Castellvi-Bel</surname><given-names>S</given-names></name>, <name><surname>de Voer</surname><given-names>RM</given-names></name>. <article-title>Somatic mutational signatures in polyposis and colorectal cancer</article-title>. <source>Mol Aspects Med</source>. <year>2019</year>;<volume>69</volume>:<fpage>62</fpage>–<lpage>72</lpage>. Epub 2019/05/21. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.mam.2019.05.002</pub-id> .<?supplied-pmid 31108140?><pub-id pub-id-type="pmid">31108140</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Baez-Ortega</surname><given-names>A</given-names></name>, <name><surname>Gori</surname><given-names>K</given-names></name>. <article-title>Computational approaches for discovery of mutational signatures in cancer</article-title>. <source>Brief Bioinform</source>. <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>77</fpage>–<lpage>88</lpage>. Epub 2017/10/03. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbx082</pub-id> ; PubMed Central PMCID: PMC6357558.<?supplied-pmid 28968631?><pub-id pub-id-type="pmid">28968631</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Gehring</surname><given-names>JS</given-names></name>, <name><surname>Fischer</surname><given-names>B</given-names></name>, <name><surname>Lawrence</surname><given-names>M</given-names></name>, <name><surname>Huber</surname><given-names>W</given-names></name>. <article-title>SomaticSignatures: inferring mutational signatures from single-nucleotide variants</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>22</issue>):<fpage>3673</fpage>–<lpage>5</lpage>. Epub 2015/07/15. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btv408</pub-id> ; PubMed Central PMCID: PMC4817139.<?supplied-pmid 26163694?><pub-id pub-id-type="pmid">26163694</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Alexandrov</surname><given-names>LB</given-names></name>, <name><surname>Nik-Zainal</surname><given-names>S</given-names></name>, <name><surname>Wedge</surname><given-names>DC</given-names></name>, <name><surname>Campbell</surname><given-names>PJ</given-names></name>, <name><surname>Stratton</surname><given-names>MR</given-names></name>. <article-title>Deciphering signatures of mutational processes operative in human cancer</article-title>. <source>Cell Rep</source>. <year>2013</year>;<volume>3</volume>(<issue>1</issue>):<fpage>246</fpage>–<lpage>59</lpage>. Epub 2013/01/16. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.celrep.2012.12.008</pub-id> ; PubMed Central PMCID: PMC3588146.<?supplied-pmid 23318258?><pub-id pub-id-type="pmid">23318258</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Fischer</surname><given-names>A</given-names></name>, <name><surname>Illingworth</surname><given-names>CJ</given-names></name>, <name><surname>Campbell</surname><given-names>PJ</given-names></name>, <name><surname>Mustonen</surname><given-names>V</given-names></name>. <article-title>EMu: probabilistic inference of mutational processes and their localization in the cancer genome</article-title>. <source>Genome Biol</source>. <year>2013</year>;<volume>14</volume>(<issue>4</issue>):<fpage>R39</fpage>. Epub 2013/05/01. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/gb-2013-14-4-r39</pub-id> ; PubMed Central PMCID: PMC3663107.<?supplied-pmid 23628380?><pub-id pub-id-type="pmid">23628380</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Rosales</surname><given-names>RA</given-names></name>, <name><surname>Drummond</surname><given-names>RD</given-names></name>, <name><surname>Valieris</surname><given-names>R</given-names></name>, <name><surname>Dias-Neto</surname><given-names>E</given-names></name>, <name><surname>da Silva</surname><given-names>IT</given-names></name>. <article-title>signeR: an empirical Bayesian approach to mutational signature discovery</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>1</issue>):<fpage>8</fpage>–<lpage>16</lpage>. Epub 2016/11/01. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btw572</pub-id> .<?supplied-pmid 27591080?><pub-id pub-id-type="pmid">27591080</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>J</given-names></name>, <name><surname>Mouw</surname><given-names>KW</given-names></name>, <name><surname>Polak</surname><given-names>P</given-names></name>, <name><surname>Braunstein</surname><given-names>LZ</given-names></name>, <name><surname>Kamburov</surname><given-names>A</given-names></name>, <name><surname>Kwiatkowski</surname><given-names>DJ</given-names></name>, <etal>et al</etal>. <article-title>Somatic ERCC2 mutations are associated with a distinct genomic signature in urothelial tumors</article-title>. <source>Nat Genet</source>. <year>2016</year>;<volume>48</volume>(<issue>6</issue>):<fpage>600</fpage>–<lpage>6</lpage>. Epub 2016/04/26. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ng.3557</pub-id> ; PubMed Central PMCID: PMC4936490.<?supplied-pmid 27111033?><pub-id pub-id-type="pmid">27111033</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Rosenthal</surname><given-names>R</given-names></name>, <name><surname>McGranahan</surname><given-names>N</given-names></name>, <name><surname>Herrero</surname><given-names>J</given-names></name>, <name><surname>Taylor</surname><given-names>BS</given-names></name>, <name><surname>Swanton</surname><given-names>C</given-names></name>. <article-title>DeconstructSigs: delineating mutational processes in single tumors distinguishes DNA repair deficiencies and patterns of carcinoma evolution</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>:<fpage>31</fpage>. Epub 2016/02/24. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-016-0893-4</pub-id> ; PubMed Central PMCID: PMC4762164.<?supplied-pmid 26899170?><pub-id pub-id-type="pmid">26899170</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>X</given-names></name>, <name><surname>Wojtowicz</surname><given-names>D</given-names></name>, <name><surname>Przytycka</surname><given-names>TM</given-names></name>. <article-title>Detecting presence of mutational signatures in cancer with confidence</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>2</issue>):<fpage>330</fpage>–<lpage>7</lpage>. Epub 2017/10/14. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btx604</pub-id> ; PubMed Central PMCID: PMC5860213.<?supplied-pmid 29028923?><pub-id pub-id-type="pmid">29028923</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Maura</surname><given-names>F</given-names></name>, <name><surname>Degasperi</surname><given-names>A</given-names></name>, <name><surname>Nadeu</surname><given-names>F</given-names></name>, <name><surname>Leongamornlert</surname><given-names>D</given-names></name>, <name><surname>Davies</surname><given-names>H</given-names></name>, <name><surname>Moore</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>A practical guide for mutational signature analysis in hematological malignancies.</article-title><source>Nat Commun.</source><year>2019</year>;<volume>10</volume>(<issue>1</issue>):<fpage>2969</fpage>. Epub 2019/07/07. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-019-11037-8</pub-id> ; PubMed Central PMCID: PMC6611883.<?supplied-pmid 31278357?><pub-id pub-id-type="pmid">31278357</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Degasperi</surname><given-names>A</given-names></name>, <name><surname>Amarante</surname><given-names>TD</given-names></name>, <name><surname>Czarnecki</surname><given-names>J</given-names></name>, <name><surname>Shooter</surname><given-names>S</given-names></name>, <name><surname>Zou</surname><given-names>X</given-names></name>, <name><surname>Glodzik</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>A practical framework and online tool for mutational signature analyses show inter-tissue variation and driver dependencies</article-title>. <source>Nat Cancer</source>. <year>2020</year>;<volume>1</volume>(<issue>2</issue>):<fpage>249</fpage>–<lpage>63</lpage>. Epub 2020/03/03. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s43018-020-0027-5</pub-id> ; PubMed Central PMCID: PMC7048622.<?supplied-pmid 32118208?><pub-id pub-id-type="pmid">32118208</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Schwarz</surname><given-names>G.</given-names></name><article-title>Estimating the dimension of a model</article-title>. <source>The annals of statistics</source>. <year>1978</year>;<volume>6</volume>(<issue>2</issue>):<fpage>461</fpage>–<lpage>4</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Tan</surname><given-names>VY</given-names></name>, <name><surname>Févotte</surname><given-names>C</given-names></name>. <article-title>Automatic relevance determination in nonnegative matrix factorization with the β-divergence</article-title>. <source>IEEE Trans Pattern Anal Mach Intell</source>. <year>2013</year>;<volume>35</volume>(<issue>7</issue>):<fpage>1592</fpage>–<lpage>605</lpage>. Epub 2013/05/18. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/TPAMI.2012.240</pub-id> .<?supplied-pmid 23681989?><pub-id pub-id-type="pmid">23681989</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Yang</surname><given-names>Y</given-names></name>. <article-title>Cross-validation for selecting a model selection procedure</article-title>. <source>Journal of Econometrics</source>. <year>2015</year>;<volume>187</volume>(<issue>1</issue>):<fpage>95</fpage>–<lpage>112</lpage>. <pub-id pub-id-type="doi">10.1016/j.jeconom.2015.02.006</pub-id>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Arlot</surname><given-names>S</given-names></name>, <name><surname>Celisse</surname><given-names>A</given-names></name>. <article-title>A survey of cross-validation procedures for model selection.</article-title><source>Statistics surveys.</source><year>2010</year>;<volume>4</volume>:<fpage>40</fpage>–<lpage>79</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Dyrskjot</surname><given-names>L</given-names></name>, <name><surname>Thykjaer</surname><given-names>T</given-names></name>, <name><surname>Kruhoffer</surname><given-names>M</given-names></name>, <name><surname>Jensen</surname><given-names>JL</given-names></name>, <name><surname>Marcussen</surname><given-names>N</given-names></name>, <name><surname>Hamilton-Dutoit</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Identifying distinct classes of bladder carcinoma using microarrays</article-title>. <source>Nat Genet</source>. <year>2003</year>;<volume>33</volume>(<issue>1</issue>):<fpage>90</fpage>–<lpage>6</lpage>. Epub 2002/12/07. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ng1061</pub-id> .<?supplied-pmid 12469123?><pub-id pub-id-type="pmid">12469123</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Byrne</surname><given-names>RP</given-names></name>, <name><surname>van Rheenen</surname><given-names>W</given-names></name>, <collab>Project Min EALSGC</collab>, <name><surname>van den Berg</surname><given-names>LH</given-names></name>, <name><surname>Veldink</surname><given-names>JH</given-names></name>, <name><surname>McLaughlin</surname><given-names>RL</given-names></name>. <article-title>Dutch population structure across space, time and GWAS design.</article-title><source>Nat Commun.</source><year>2020</year>;<volume>11</volume>(<issue>1</issue>):<fpage>4556</fpage>. Epub 2020/09/13. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-020-18418-4</pub-id> ; PubMed Central PMCID: PMC7486932.<?supplied-pmid 32917883?><pub-id pub-id-type="pmid">32917883</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Yu</surname><given-names>J</given-names></name>, <name><surname>Deng</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>T</given-names></name>, <name><surname>Zhou</surname><given-names>J</given-names></name>, <name><surname>Jia</surname><given-names>X</given-names></name>, <name><surname>Xiao</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Lymph node metastasis prediction of papillary thyroid carcinoma based on transfer learning radiomics</article-title>. <source>Nat Commun</source>. <year>2020</year>;<volume>11</volume>(<issue>1</issue>):<fpage>4807</fpage>. Epub 2020/09/25. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-020-18497-3</pub-id> ; PubMed Central PMCID: PMC7511309.<?supplied-pmid 32968067?><pub-id pub-id-type="pmid">32968067</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Meng</surname><given-names>X-L</given-names></name>, <name><surname>Rubin</surname><given-names>DB</given-names></name>. <article-title>Maximum Likelihood Estimation via the ECM Algorithm: A General Framework</article-title>. <source>Biometrika</source>. <year>1993</year>;<volume>80</volume>(<issue>2</issue>):<fpage>267</fpage>–<lpage>78</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.2307/2337198</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Gilad</surname><given-names>G</given-names></name>, <name><surname>Sason</surname><given-names>I</given-names></name>, <name><surname>Sharan</surname><given-names>R</given-names></name>. <article-title>An automated approach for determining the number of components in non-negative matrix factorization with application to mutational signature learning.</article-title><source>Machine Learning: Science and Technology.</source><year>2020</year>;<volume>2</volume>(<issue>1</issue>):<fpage>015013</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Lal</surname><given-names>A</given-names></name>, <name><surname>Liu</surname><given-names>K</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>, <name><surname>Sidow</surname><given-names>A</given-names></name>, <name><surname>Ramazzotti</surname><given-names>D</given-names></name>. <article-title>De novo mutational signature discovery in tumor genomes using SparseSignatures.</article-title><source>PLoS Comput Biol.</source><year>2021</year>;<volume>17</volume>(<issue>6</issue>):<fpage>e1009119</fpage>–e. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1009119</pub-id> .<?supplied-pmid 34181655?><pub-id pub-id-type="pmid">34181655</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref043">
      <label>43</label>
      <mixed-citation publication-type="other">Févotte C, Cemgil AT, editors. Nonnegative matrix factorizations as probabilistic inference in composite models. 2009 17th European Signal Processing Conference; 2009 24–28 Aug. 2009.</mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref044">
      <label>44</label>
      <mixed-citation publication-type="other">Gaussier E, Goutte C. Relation between PLSA and NMF and implications. Proceedings of the 28th annual international ACM SIGIR conference on Research and development in information retrieval; Salvador, Brazil: Association for Computing Machinery; 2005. p. 601–2.</mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref045">
      <label>45</label>
      <mixed-citation publication-type="other">Friedman J, Hastie T, Tibshirani R. The elements of statistical learning: Springer series in statistics New York; 2001.</mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref046">
      <label>46</label>
      <mixed-citation publication-type="book"><name><surname>Little</surname><given-names>RJ</given-names></name>, <name><surname>Rubin</surname><given-names>DB</given-names></name>. <source>Statistical analysis with missing data</source>: <publisher-name>John Wiley &amp; Sons</publisher-name>; <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Volkova</surname><given-names>NV</given-names></name>, <name><surname>Meier</surname><given-names>B</given-names></name>, <name><surname>Gonzalez-Huici</surname><given-names>V</given-names></name>, <name><surname>Bertolini</surname><given-names>S</given-names></name>, <name><surname>Gonzalez</surname><given-names>S</given-names></name>, <name><surname>Vohringer</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Mutational signatures are jointly shaped by DNA damage and repair</article-title>. <source>Nat Commun</source>. <year>2020</year>;<volume>11</volume>(<issue>1</issue>):<fpage>2169</fpage>. Epub 2020/05/03. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-020-15912-7</pub-id> ; PubMed Central PMCID: PMC7195458.<?supplied-pmid 32358516?><pub-id pub-id-type="pmid">32358516</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref048">
      <label>48</label>
      <mixed-citation publication-type="other">Kohavi R. A study of cross-validation and bootstrap for accuracy estimation and model selection. Proceedings of the 14th international joint conference on Artificial intelligence—Volume 2; Montreal, Quebec, Canada: Morgan Kaufmann Publishers Inc.; 1995. p. 1137–43.</mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Breiman</surname><given-names>L</given-names></name>, <name><surname>Spector</surname><given-names>P</given-names></name>. <article-title>Submodel Selection and Evaluation in Regression. The X-Random Case.</article-title><source>International Statistical Review / Revue Internationale de Statistique.</source><year>1992</year>;<volume>60</volume>(<issue>3</issue>):<fpage>291</fpage>–<lpage>319</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.2307/1403680</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref050">
      <label>50</label>
      <mixed-citation publication-type="other">Ding C, Li T, Peng W. Nonnegative matrix factorization and probabilistic latent semantic indexing: equivalence, chi-square statistic, and a hybrid method. Proceedings of the 21st national conference on Artificial intelligence—Volume 1; Boston, Massachusetts: AAAI Press; 2006. p. 342–7.</mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>DD</given-names></name>, <name><surname>Seung</surname><given-names>HS</given-names></name>. <article-title>Learning the parts of objects by non-negative matrix factorization</article-title>. <source>Nature</source>. <year>1999</year>;<volume>401</volume>(<issue>6755</issue>):<fpage>788</fpage>–<lpage>91</lpage>. Epub 1999/11/05. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/44565</pub-id> .<?supplied-pmid 10548103?><pub-id pub-id-type="pmid">10548103</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Bro</surname><given-names>R</given-names></name>, <name><surname>Kjeldahl</surname><given-names>K</given-names></name>, <name><surname>Smilde</surname><given-names>AK</given-names></name>, <name><surname>Kiers</surname><given-names>HAL</given-names></name>. <article-title>Cross-validation of component models: A critical look at current methods</article-title>. <source>Analytical and Bioanalytical Chemistry</source>. <year>2008</year>;<volume>390</volume>(<issue>5</issue>):<fpage>1241</fpage>–<lpage>51</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s00216-007-1790-1</pub-id><?supplied-pmid 18214448?><pub-id pub-id-type="pmid">18214448</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Wold</surname><given-names>S.</given-names></name><article-title>Cross-Validatory Estimation of the Number of Components in Factor and Principal Components Models.</article-title><source>Technometrics</source>. <year>1978</year>;<volume>20</volume>(<issue>4</issue>):<fpage>397</fpage>–<lpage>405</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/00401706.1978.10489693</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Xue</surname><given-names>R</given-names></name>, <name><surname>Chen</surname><given-names>L</given-names></name>, <name><surname>Zhang</surname><given-names>C</given-names></name>, <name><surname>Fujita</surname><given-names>M</given-names></name>, <name><surname>Li</surname><given-names>R</given-names></name>, <name><surname>Yan</surname><given-names>SM</given-names></name>, <etal>et al</etal>. <article-title>Genomic and Transcriptomic Profiling of Combined Hepatocellular and Intrahepatic Cholangiocarcinoma Reveals Distinct Molecular Subtypes</article-title>. <source>Cancer Cell</source>. <year>2019</year>;<volume>35</volume>(<issue>6</issue>):<fpage>932</fpage>–<lpage>47</lpage> e8. Epub 2019/05/28. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.ccell.2019.04.007</pub-id> .<?supplied-pmid 31130341?><pub-id pub-id-type="pmid">31130341</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Rose Li</surname><given-names>Y</given-names></name>, <name><surname>Halliwill</surname><given-names>KD</given-names></name>, <name><surname>Adams</surname><given-names>CJ</given-names></name>, <name><surname>Iyer</surname><given-names>V</given-names></name>, <name><surname>Riva</surname><given-names>L</given-names></name>, <name><surname>Mamunur</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Mutational signatures in tumours induced by high and low energy radiation in Trp53 deficient mice.</article-title><source>Nat Commun.</source><year>2020</year>;<volume>11</volume>(<issue>1</issue>):<fpage>394</fpage>. Epub 2020/01/22. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-019-14261-4</pub-id> ; PubMed Central PMCID: PMC6971050.<?supplied-pmid 31959748?><pub-id pub-id-type="pmid">31959748</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Kasar</surname><given-names>S</given-names></name>, <name><surname>Kim</surname><given-names>J</given-names></name>, <name><surname>Improgo</surname><given-names>R</given-names></name>, <name><surname>Tiao</surname><given-names>G</given-names></name>, <name><surname>Polak</surname><given-names>P</given-names></name>, <name><surname>Haradhvala</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Whole-genome sequencing reveals activation-induced cytidine deaminase signatures during indolent chronic lymphocytic leukaemia evolution</article-title>. <source>Nat Commun</source>. <year>2015</year>;<volume>6</volume>:<fpage>8866</fpage>. Epub 2015/12/08. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ncomms9866</pub-id> ; PubMed Central PMCID: PMC4686820.<?supplied-pmid 26638776?><pub-id pub-id-type="pmid">26638776</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Lvd</surname><given-names>Maaten</given-names></name>, <name><surname>Hinton</surname><given-names>G</given-names></name>. <article-title>Visualizing data using t-SNE.</article-title><source>Journal of machine learning research</source>. <year>2008</year>;<volume>9</volume>(<issue>Nov</issue>):<fpage>2579</fpage>–<lpage>605</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009309.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Campbell</surname><given-names>BB</given-names></name>, <name><surname>Light</surname><given-names>N</given-names></name>, <name><surname>Fabrizio</surname><given-names>D</given-names></name>, <name><surname>Zatzman</surname><given-names>M</given-names></name>, <name><surname>Fuligni</surname><given-names>F</given-names></name>, <name><surname>de Borja</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Comprehensive Analysis of Hypermutation in Human Cancer</article-title>. <source>Cell</source>. <year>2017</year>;<volume>171</volume>(<issue>5</issue>):<fpage>1042</fpage>–<lpage>56</lpage> e10. Epub 2017/10/24. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2017.09.048</pub-id> ; PubMed Central PMCID: PMC5849393.<?supplied-pmid 29056344?><pub-id pub-id-type="pmid">29056344</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1009309.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009309.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Panchenko</surname>
          <given-names>Anna R</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Panchenko, Ma</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Panchenko, Ma</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009309" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">17 Aug 2021</named-content>
    </p>
    <p>Dear Dr. Zhu,</p>
    <p>Thank you very much for submitting your manuscript "SUITOR: selecting the number of mutational signatures through cross-validation" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by three independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Anna R Panchenko</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Jian Ma</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: Comments for the manuscript draft and supplementary figures are uploaded as attachments. Comments for the supplementary tables are described below.</p>
    <p>Supplementary table comments:</p>
    <p>In the description of Supplementary Table 3, "signarues" should be corrected to "signatures".</p>
    <p>In Supplementary Table 4, row "SBS40", column "nonzeros SD", please ensure that this NA value is correct.</p>
    <p>For supplementary tables 5, 6, 7, 8, 10, 11 and 12, please ensure that the significance of highlighted values is explicitly stated in the table caption.</p>
    <p>For supplementary tables 5, 6, 7, 8, 9, 10, 11 and 12, please ensure that the significance of color coding for highlighted values (red versus blue) is explicitly stated in the table caption.</p>
    <p>For supplementary tables 5, 6, 8, 9, 10, 11 and 12, please ensure that the highlighted values are consistently displayed in either a bold typeface or non-bold typeface.</p>
    <p>Reviewer #2: Comments for Authors</p>
    <p>In this study, the authors describe the development of a new bioinformatic tool intended to deal with one of the main issues during mutational signature analysis, which is the correct selection of the number of signatures.</p>
    <p>In my opinion, the authors did a great job in addressing one of the key points in this relatively new type of genomic analysis, since many of the previously published tools have failed in solving it. Actually, there are a substantial number of R-based tools for mutational signatures analysis recently published, including MutationalPatterns (doi: 10.1186/s13073-018-0539-0), MutSpec (doi: 10.1186/s12859-016-1011-z), SomaticSignatures (doi: 10.1093/bioinformatics/btv408) or SignatureToolsLib (doi: 10.1038/s43018-020-0027-5), that do not provide automatic selection of the number of signatures. Therefore, these tools leave one of the key parameters of the analysis directly on the users’ hands. However, many times users are not experts on the computational engines behind the signature extraction process. In this regard, SUITOR appears as a very interesting option to work alongside these other tools, in order to correctly select the number of signatures that better represent the data.</p>
    <p>However, the authors have not explored this possibility in the manuscript, focusing on benchmarking their tool against three other tools that do include automatic selection of the number of signatures. Although the approach for the selection of the number of signatures provides a new perspective with the insightful use of cross-validation, the tool suffers a lack of completeness in comparison to the other three tools benchmarked in the manuscript, SigProfilerExtractor, SignatureAnalyzer and SigneR. SUITOR does not include almost any user guide, explanation of the input parameters and output files/variables generated, plotting capabilities, possibility of extracting signature and activity matrices, comparison to existing reference signatures (e.g., COSMIC database) or algorithm tuning. Even though the reported benchmarking results are promising, the authors should consider including some of these features to facilitate the usage of SUITOR. Currently, I was not able to perform a simple analysis with the provided test data and obtaining the extracted mutational signatures. I correctly obtained the suggested number of signatures, but not the actual signature profiles.</p>
    <p>Please find below some more detailed comments:</p>
    <p>Major comments</p>
    <p>1. The main concern regarding the presented bioinformatic tool, SUITOR, is that is unclear if it can be used for a complete mutational signature extraction analysis or only for the selection of the number of signatures. According to the provided benchmarking figures and tables, as well as the description of the ECM algorithm, it seems that SUITOR can extract mutational signatures by itself. However, the R code following the instructions provided does not allow to generate the matrices of signatures and activities, giving only the suggested number of signatures as result.</p>
    <p>2. The output matrices for the benchmarking are not available (only the cosine similarities in the supplementary tables), which prevents reproducing the reported extraction results for SUITOR or the other three tools.</p>
    <p>3. The rationale for the selection of the benchmarking datasets is not provided in some cases, e.g., selection of SBS8 for the in silico simulations with one signature, or exclusion of hypermutated tumors with &gt;10 mutations/Mb in PCAWG and breast cancer data analysis. Actually, hypermutated tumors are particularly important in mutational signature analysis since they can lead to the extraction of false positive signatures (doi: 10.1038/s41586-020-1943-3). Therefore, their influence on SUITOR performance should be assessed.</p>
    <p>In addition, the authors should make a clear distinction between benchmarking, which is only possible in silico using simulated data, and exploratory analysis using real data (either in vitro or in vivo). Benchmarking is only possible in simulations because ground truth signatures are needed for comparison, and these are not available in real data.</p>
    <p>Also, ground truth signature/s are not available for the first in silico analysis performed in the manuscript (lines 436-440) since the input matrix was constructed using random numbers, instead of generating a random ground truth signature/s. Moreover, the authors claimed that the signature extracted from this random-generated input matrix is similar to SBS3 (line 215), which is probably related to the fact that SBS3 is a flat-like signature. However, SBS3 has been previously associated with defective homologous recombination-based DNA damage repair and germline mutations in BRCA1 and BRCA2 (doi: 10.1016/j.cell.2012.04.024, 10.1038/nature17676, 10.1038/nm.4292, 10.1038/onc.2016.243 and others).</p>
    <p>4. The authors should clarify why the PCAWG benchmarking on the three additional tools was performed on 90% of the counts in the mutation catalog matrix (lines 482-491) and not on 100% as it was done in the in vitro benchmarking (lines 410-412). This cross-validation approach may have biased the benchmarking results since the other tools are not designed for dealing with missing data. The authors used the medians of available mutation counts per mutational context to fill the missing data, which may have disrupted the original input matrix and the whole extraction process.</p>
    <p>5. As previously mentioned, the GitHub README file is missing different sections, in particular a detailed explanation of the different input parameters, as well as the output variables and objects. A more detailed vignette would also be useful apart from the html file provided (<ext-link xlink:href="https://github.com/binzhulab/SUITOR/blob/master/SUITOR.html" ext-link-type="uri">https://github.com/binzhulab/SUITOR/blob/master/SUITOR.html</ext-link>), in a similar way as the SigneR authors presented for their tool (<ext-link xlink:href="https://www.bioconductor.org/packages/release/bioc/vignettes/signeR/inst/doc/signeR-vignette.html" ext-link-type="uri">https://www.bioconductor.org/packages/release/bioc/vignettes/signeR/inst/doc/signeR-vignette.html</ext-link>). An example of a comprehensive mutational signature extraction analysis should be included in this vignette in order to be reproducible by potential users.</p>
    <p>6. In a SUITOR test following the code provided in the html file and using the provided test data but fixing the print parameter on print=3, it is concerning to observe that some iterations of the EM algorithm did not converge. It is not clear in the manuscript how many iterations are used as maximum for the multiplicative updates/ECM algorithm, as well as how many NMF/ECM replicates are considered.</p>
    <p>Minor comments</p>
    <p>1. The authors should clarify why 0.8 was used as the threshold for cosine similarity matching instead of the 0.9 commonly used in the prior literature (doi: 10.1038/s41586-020-1943-3).</p>
    <p>2. The inclusion of the developed package in one of the main repositories for R packages (R CRAN or Bioconductor) is recommended since this has also been done by many of the other R-based mutational signature analysis tools already available in the field, including MutationalPatterns, SomaticSignatures or SigneR.</p>
    <p>3. The background section is missing the newest collection of reference mutational signatures in the COSMIC database, corresponding to version 3.2 from March 2021 (<ext-link xlink:href="https://cancer.sanger.ac.uk/signatures/" ext-link-type="uri">https://cancer.sanger.ac.uk/signatures/</ext-link>). The authors should also mention in the introduction the other mutational types where mutational signatures have been extracted, including indels, doublet base substitutions (reference signatures also present in COSMIC), structural variants (doi: 10.1038/nature17676 among others) and copy number variants (doi: 10.1038/s41588-018-0179-8, 10.1101/2021.04.30.441940 and others).</p>
    <p>4. The association of NTHL1 germline mutations with a particular mutational signature (SBS30) in more than 10 different cancer types should also be included in the background section in line 34 apart from the association with breast cancer (doi: 10.1016/j.ccell.2018.12.011).</p>
    <p>5. The claim about the method used by SomaticSignatures to select the number of signatures (lines 44-46) is inaccurate, since this tool does not have an automatic method for this selection. The authors correctly pointed out that the authors of SomaticSignatures suggested using the residual sum of squares and the explained variance. However, this is only a suggestion, and the user is required to manually choose the number of signatures to use in the extraction based on a set of plots depicting the mentioned metrics as well as some additional ones.</p>
    <p>6. The language used for the first explanation of the specific cross-validation scheme developed for the mutational signature analysis problem in lines 77-83 is unclear, making it difficult to follow.</p>
    <p>7. In the mathematical notation of the method, W and H matrices are switched with regard to the original implementation of the mutational signatures framework (doi: 10.1016/j.celrep.2012.12.008 and 10.1038/s41586-020-1943-3). W was originally defined as the matrix of signatures (rows = number of mutational contexts &amp; columns = signatures) and H as the matrix of activities/exposures (rows = signatures &amp; columns = samples). In the manuscript, the authors changed the notation and transposed the matrices, which is mathematically correct but not in agreement with previous literature.</p>
    <p>8. The authors should clarify which data was used for generating the clustering presented in figure 5 and in the results section (lines 254-256).</p>
    <p>9. The authors should provide some evidence that SUITOR is able to handle the selection of the number of signatures arising from other genomic alterations (as they claimed in the discussion section, lines 312-314) since only data from single base substitutions (SBS96 context) is presented in the manuscript.</p>
    <p>10. The parameters used for the different tools are missing in the methods section, in particular, the number of NMF/ECM runs performed and the maximum number of iterations per run in case that convergence is not reached, including the ones used for SUITOR (lines 393-397).</p>
    <p>11. SigProfilerExtractor should be used as the name of the corresponding tool instead of sigProfiler, according to the information present in the GitHub provided in line 510 and also by the authors in their preprint for that particular tool (doi: 10.1101/2020.12.13.422570).</p>
    <p>12. Since the specific version number is not available, an approximate date of download should be included for SignatureAnalyzer in line 512.</p>
    <p>13. The authors should consider moving some technical details of the results-overview section (lines 97-156) to the methods section.</p>
    <p>14. A citation to the COSMIC database (e.g. doi: 10.1093/nar/gky1015) should be included in the first mention of the COSMIC reference mutational signatures, as well as in line 32 when mentioning the current reference set of mutational signatures. The URL <ext-link xlink:href="https://cancer.sanger.ac.uk/signatures/" ext-link-type="uri">https://cancer.sanger.ac.uk/signatures/</ext-link> may also be included.</p>
    <p>15. A citation to a review about the several mutational signature analysis tools in the literature should be added in lines 42-43. Some examples are doi: 10.1093/bib/bbx082, 10.1016/j.mam.2019.05.002 or 10.1371/journal.pone.0221235. In addition, the authors should mention the two main types of analysis that have been addressed by prior studies: signature extraction and signature refitting based on reference mutational signatures. Whereas the authors have focused their manuscript on the extraction process, it is important to mention the availability of the refitting analysis, with potential applicability in clinical practice (as discussed here, doi: 10.1186/s13059-016-0893-4).</p>
    <p>Reviewer #3: This paper addresses a key challenge in mutational signatures analysis of cancer genomes that is determining the correct number of distinct mutational processes/signatures operating on studied samples, i.e. the rank of factorization. The problem is important, especially that it significantly affects the downstream analyses. The method is based on the cross-validation method used for model selection. The authors evaluate their method on simulated and in vitro data, as well as real cancer samples. They compare it with existing methods developed for signature inference (not specifically for the identification of number of signatures).</p>
    <p>Overall the manuscript is well written and presents an interesting approach, but it lacks clarity in some parts. The significance of the study lies in stating an important practical problem directly and proposing a method to solve it. However, it seems that the authors are not aware of existing approaches for this problem that use cross-validation as well. CV2K method (Gilad et al, Mach. Learn. Sci. Technol., 2020) uses a similar cross-validation schema (although random, not balanced separation as the authors) combined with sBCD NMF. SparseSignatures (Lal et al., PLoS Comp. Biol. 2021; available in BioRxiv and Bioconductor since 2018), a framework to extract signatures, uses cross-validation to identify the number of signatures. These two methods seem to be more appropriate for benchmarking the method, as they use a similar cross-validation idea (both methods) or were developed specifically for the same problem (CV2K).</p>
    <p>Please do not change existing terminology used in signature analysis literature; see the seminal paper by Alexandrov et al. (Cell Reports, 2013) for reference. It can lead to misunderstanding and confusion. For example, a mutational catalog of a cancer genome is defined by Alexandrov et al. as a vector containing the number of somatic mutations of a genome defined over a finite alphabet of mutation types. Thus, “A[C&gt;G]G” is a mutation type not a mutation catalog; and there are 96 mutation types (or categories, features) not catalogs.</p>
    <p>The authors use two in vitro studies to benchmark their approach. In both of these studies there is only one perturbation per experiment (gene knockout or cell exogenous exposure) leading to at most one mutational signature beyond the background. However, there is an experimental dataset available that has both gene knockouts and genotoxins, see the paper by Volkova et al. (Nature Communications, 2020). The authors could evaluate their approach on this dataset if possible (e.g. samples that have high number of mutations).</p>
    <p>Is there a particular reason that the two in vitro datasets were treated in a different way? The samples from Kucab et al. were all analysed together (put in a single V matrix), while the samples from Zou et al were split into two analyses (MSH6 knockout and the rest). All methods should be able to find two signatures in Zou et al even when all samples were analysed together. Only MSH6 KO samples have two signatures present while all other samples should have only one signature (background) with non-zero activity.</p>
    <p>For the second in vivo dataset (Kucab et al), all methods found a different number of signatures. However, how many signatures should be expected for this dataset? Have you tried to see how many profiles of these 28 mutagens are similar to each other? If you assume 0.8 cosine similarity (as you do for signature comparison), how many clusters of mutagen profiles would you have? Moreover, have you inspected the exposure matrix inferred by different methods? Each studied sample comes from a single mutagen treatment, so its profile should be affected by at most two signatures (background and mutagen signature). Thus, the exposure matrix (for all samples as you have in your paper) should be very sparse with at most two non-zero values in each row; more non-zero values would suggest overfitting and the number of signatures is too high and should be reduced. This could lead to a good validation of the result.</p>
    <p>Figure 2b, top panel, is incorrect. It shows the MSH6 knockout signature not the background signature. Both top and bottom panels (Fig. 2b) show the same signature, but the top panels should show the background signature that is similar to signatures shown in Supplemental Figure 2b, or signature in Fig 3a (parental clone) in the original paper (Zou et al).</p>
    <p>The random mutation scenario in in silico simulation study seems artificial as it is not similar to any existing COSMIC signature. The proposed association with SBS3 is weak; SBS3 is usually associated with HR deficiency in signature studies. Instead, you should expand your two other scenarios. More signatures could be tested in your design with one signature, not only SBS8. However, a design with more signatures is more realistic and corresponds to actual problems in cancer studies. Thus, you could expand the last scenario in place of the first two. It will be more informative.</p>
    <p>In Figure 3b, some methods, including SUITOR, find the same signature more than 20 times in 20 replicates. This suggests overfitting as the same COSMIC signature is found more than once. Can it be related to a case when prediction error for a validation set exhibits a “plateau” near the minimum, i.e. similar prediction error for different number of signatures? In such a case it might be reasonable to select the lowest possible number of signatures not the number that gives the lowest error as it might be statistically impossible to differentiate these two cases.</p>
    <p>How are the missing values selected in the initial step of the algorithm? In line 376, it is stated that you use the median of mutation counts in V (training) per each mutation catalog (meaning mutation type), i.e. median of non-missing values from a corresponding column of V. However, in the detailed description of the algorithm (Supplementary note 3), it stated that these are the medians from the corresponding row of V. Please fix this (probably in Supplementary note 3) and potentially other places where it is incorrectly stated.</p>
    <p>The above mentioned initialization is okay for SUITOR as it tries to improve the estimates of the held-out mutation counts. However, it does not seem appropriate to fill in missing values in datasets provided to other methods (SigProfiles, SignatureAnalyser, signeR) as you do in the in vivo (PCAWG) benchmarking. Missing mutation count data is not a problem in mutational signature analysis, so these methods were not designed to deal with it. SUITOR imputes them because it is part of the cross-validation schema it uses. This leads to unfair comparison between SUITOR and other methods. It would be fair if the authors provide to the other methods the values imputed by SUITOR to fill in the held-out mutation counts. This way the comparison between methods would assess the methods’ ability to infer the number of signatures and their profiles, not the other methods’ inability to correctly infer the missing values and signature profiles based on incorrect input data. As it is, the imputed values are not even normalized to a sample's overall mutation counts; for each mutation type, all missing values are replaced by the same value (column median). Thus, SUITOR has an advantage when compared with other methods.</p>
    <p>Minor comments:</p>
    <p>- Use correct names for algorithms (upper/lowercase), i.e. SigProfiler, SignatureAnalyser, signeR, consistently.</p>
    <p>- line 52: “elaborated” &gt; “are elaborated”</p>
    <p>- line 125: “been” &gt; “be”</p>
    <p>- line 138: “The” &gt; “the”</p>
    <p>- line 359: fix the reference</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: <bold>No: </bold>Signature and activity matrices arising from the benchmarking results have not been made available by the authors. They are needed for the reproducibility of the study.</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: <bold>Yes: </bold>Daniel Espiritu</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <supplementary-material id="pcbi.1009309.s016" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Supplementary figures.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1009309.s016.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009309.s017" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">PCOMPBIOL-D-21-01288.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1009309.s017.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1009309.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009309.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009309" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">2 Feb 2022</named-content>
    </p>
    <supplementary-material id="pcbi.1009309.s018" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">ResponseLetter_v2.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1009309.s018.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1009309.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009309.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Panchenko</surname>
          <given-names>Anna R</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Panchenko, Ma</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Panchenko, Ma</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009309" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">21 Feb 2022</named-content>
    </p>
    <p>Dear Dr. Zhu,</p>
    <p>Thank you very much for submitting your manuscript "SUITOR: selecting the number of mutational signatures through cross-validation" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the review recommendations. Please make sure that you make all data sets available, as was requested by reviewers.</p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Anna R Panchenko</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Jian Ma</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p><bold>Reviewer #2:</bold> I am sincerely grateful for the thorough review of the manuscript performed by the authors. In particular, they did a great job in improving the usability of the tool and providing the specific analyses suggested by the other reviewers and myself regarding different variant types, species or hypermutated tumors, increasing the quality of the manuscript and the tool. Considering the benchmarking reported, SUITOR appears as a powerful tool for the accurate selection of the number of mutational signatures in a specific cancer dataset, especially for non-hypermutated tumors. However, I have some additional comments that can be found below.</p>
    <p>1. As I previously mentioned, the commonly used cosine similarity threshold for mutational signature analysis in previous literature is 0.9. The authors claimed that their simulation studies show minor differences between this well-established threshold and their selected one (0.8). However, they should provide some detailed metrics about the differences observed in the benchmarking if they had used 0.9 (or other intermediate value) as the threshold. For example, in the case of the supplementary table 2 (in vitro analysis), using a different cosine similarity threshold would result in SUITOR having a reduced precision/specificity compared to the other three tools, especially SigneR and SigProfilerExtractor. The selection of the cosine similarity threshold is critical considering that the average cosine similarity expected between two random nonnegative vectors simply by chance is 0.75 (doi: 10.1186/s12859-020-03772-3).</p>
    <p>2. For the real data analyses, the authors validate their results by indicating the matching of the extracted signatures to COSMIC reference signatures. This matching by itself is not an indication that the tool is identifying real signatures in the data. For example, in the analysis of the C. elegans dataset, the authors claimed to identify a signature closely matching SBS7c. This signature, as indicated, has a specific etiology (UV light exposure) and is usually found alongside SBS7a/b in skin tumors. Therefore, it seems unlikely that this signature is present in the original dataset by itself and could potentially represent a false positive signature. In addition, the authors should compare their results with the ones from the original C. elegans study (doi: 10.1038/s41467-020-15912-7).</p>
    <p>3. Also regarding the C. elegans dataset, the authors should clarify if they have renormalized the COSMIC reference signatures to account for the differences in the trinucleotide proportions between human and C. elegans genomes. One example of the renormalization can be observed in the COSMIC website (<ext-link xlink:href="https://cancer.sanger.ac.uk/signatures/downloads/" ext-link-type="uri">https://cancer.sanger.ac.uk/signatures/downloads/</ext-link>), where the original GRCh37-based reference signatures were translated to different reference genomes and species, according to the different trinucleotide frequencies.</p>
    <p>4. The authors should explain why they chose to include different noise levels generated from a uniform distribution, considering the data is an integer (counts). An expansion of the methods regarding the noise model selection would also be helpful.</p>
    <p>5. COSMIC Mutational Signatures v3.2 includes 78 single base substitution signatures and not 49, since several artifact-related signatures are also included in the reference set.</p>
    <p>6. The results of the application of SUITOR to hypermutated tumors, indels, and the C. elegans study should be included in the results section apart from the discussion section. For the analysis of hypermutators and indel signatures, it should be indicated which datasets were used and how many samples were included per group. For indels and the C. elegans study, a supplementary table with the cosine similarities similar to the ones provided for the other datasets is missing.</p>
    <p>7. For SignatureAnalyzer, it should be specified if the CPU or the GPU version was used.</p>
    <p>8. The output W and H matrices are missing for the newly included datasets of PCAWG Colorectal, PCAWG Esophageal, PCAWG Head and Neck, ovarian adenocarcinoma for indel analysis, and C. elegans analysis. Also, to benefit reproducibility, the mutational matrices used as input for all benchmarking and real data analyses should be included in the supplementary dataset.</p>
    <p>9. Typos: spacing between equal signs not consistent (e.g., lines 389-391); C. elegans should be written in italics (lines 394-397); *caner (line 407). Please check for typos in the user guide too (e.g., *SUTIOR, section 4.2).</p>
    <p><bold>Reviewer #3:</bold> The reviewer's comments were fully addressed. No more comments.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #2: <bold>No: </bold>The output W and H matrices are missing for the newly included datasets of PCAWG Colorectal, PCAWG Esophageal, PCAWG Head and Neck, ovarian adenocarcinoma for indel analysis, and C. elegans analysis. Also, to benefit reproducibility, the mutational matrices used as input for all benchmarking and real data analyses should be included in the supplementary dataset.</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>Figure Files:</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link xlink:href="https://pacev2.apexcovantage.com" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>Data Requirements:</p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>Reproducibility:</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <p>References:</p>
    <p>Review your reference list to ensure that it is complete and correct. If you have cited papers that have been retracted, please include the rationale for doing so in the manuscript text, or remove these references and replace them with relevant current references. Any changes to the reference list should be mentioned in the rebuttal letter that accompanies your revised manuscript.</p>
    <p>
      <italic toggle="yes">If you need to cite a retracted article, indicate the article’s retracted status in the References list and also include a citation and full reference for the retraction notice.</italic>
    </p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1009309.r004">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009309.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009309" id="rel-obj004" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">5 Mar 2022</named-content>
    </p>
    <supplementary-material id="pcbi.1009309.s019" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response to Referee_Revision2.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1009309.s019.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1009309.r005" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009309.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Panchenko</surname>
          <given-names>Anna R</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Panchenko, Ma</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Panchenko, Ma</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009309" id="rel-obj005" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">9 Mar 2022</named-content>
    </p>
    <p>Dear Dr. Zhu,</p>
    <p>We are pleased to inform you that your manuscript 'SUITOR: selecting the number of mutational signatures through cross-validation' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Anna R Panchenko</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Jian Ma</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1009309.r006" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009309.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Panchenko</surname>
          <given-names>Anna R</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Panchenko, Ma</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Panchenko, Ma</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009309" id="rel-obj006" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">29 Mar 2022</named-content>
    </p>
    <p>PCOMPBIOL-D-21-01288R2 </p>
    <p>SUITOR: Selecting the number of mutational signatures through cross-validation</p>
    <p>Dear Dr Zhu,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Zsofia Freund</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
