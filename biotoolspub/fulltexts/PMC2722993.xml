<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1460-2059</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2722993</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp065</article-id>
    <article-id pub-id-type="publisher-id">btp065</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>German Conference on Bioinformatics</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Lightweight comparison of RNAs based on exact sequence–structure matches</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Heyne</surname>
          <given-names>Steffen</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Will</surname>
          <given-names>Sebastian</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Beckstette</surname>
          <given-names>Michael</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Backofen</surname>
          <given-names>Rolf</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff>Bioinformatics Group, Albert-Ludwigs-University Freiburg, Georges-Koehler-Allee 106, Freiburg, D-79110, Germany</aff>
    <author-notes>
      <corresp id="COR1"><sup>*</sup>To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Trey Ideker</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>2</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>2</day>
      <month>2</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>25</volume>
    <issue>16</issue>
    <fpage>2095</fpage>
    <lpage>2102</lpage>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>10</month>
        <year>2008</year>
      </date>
      <date date-type="rev-recd">
        <day>31</day>
        <month>10</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>1</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Specific functions of ribonucleic acid (RNA) molecules are often associated with different motifs in the RNA structure. The key feature that forms such an RNA motif is the combination of sequence and structure properties. In this article, we introduce a new RNA sequence–structure comparison method which maintains exact matching substructures. Existing common substructures are treated as whole unit while variability is allowed between such structural motifs.</p>
      <p>Based on a fast detectable set of overlapping and crossing substructure matches for two nested RNA secondary structures, our method <monospace>ExpaRNA</monospace> (exact pattern of alignment of RNA) computes the longest collinear sequence of substructures common to two <bold>RNA</bold>s in <italic>O</italic>(<italic>H</italic>·<italic>nm</italic>) time and <italic>O</italic>(<italic>nm</italic>) space, where <italic>H</italic> ≪ <italic>n</italic>·<italic>m</italic> for real RNA structures. Applied to different <bold>RNA</bold>s, our method correctly identifies sequence–structure similarities between two <bold>RNA</bold>s.</p>
      <p><bold>Results:</bold> We have compared <monospace>ExpaRNA</monospace> with two other alignment methods that work with given RNA structures, namely <monospace>RNAforester</monospace> and <monospace>RNA_align</monospace>. The results are in good agreement, but can be obtained in a fraction of running time, in particular for larger <bold>RNA</bold>s. We have also used <monospace>ExpaRNA</monospace> to speed up state-of-the-art Sankoff-style alignment tools like <monospace>LocARNA</monospace>, and observe a tradeoff between quality and speed. However, we get a speedup of 4.25 even in the highest quality setting, where the quality of the produced alignment is comparable to that of <monospace>LocARNA</monospace> alone.</p>
      <p><bold>Availability:</bold> The presented algorithm is implemented in the program <monospace>ExpaRNA</monospace>, which is available from our website (<ext-link ext-link-type="uri" xlink:href="http://www.bioinf.uni-freiburg.de/Software">http://www.bioinf.uni-freiburg.de/Software</ext-link>).</p>
      <p><bold>Contact:</bold> {<email>exparna@informatik.uni-freiburg.de</email>,<email>backofen@informatik.uni-freiburg.de</email>}</p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp065/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Ribonucleic acids (<bold>RNA</bold>s) are associated with a large range of important cellular functions in living organisms. Moreover, recent findings show that <bold>RNA</bold>s can perform regulatory functions formerly assigned only to proteins. Likewise to proteins, these functions are often associated with evolutionary conserved motifs that contain specific sequence and structure properties. Examples for such regulatory RNA elements, whose functions are mediated by sequence–structure motifs are selenocysteine insertion sequence (SECIS) elements (Huttenhofer <italic>et al.</italic>, <xref ref-type="bibr" rid="B17">1996</xref>) (see <xref ref-type="fig" rid="F1">Fig. 1</xref> for an example), iron-responsive elements (IREs) (Hentze and Kuhn, <xref ref-type="bibr" rid="B13">1996</xref>), different riboswitches (Serganov and Patel, <xref ref-type="bibr" rid="B26">2007</xref>) or internal ribosomal entry sites (IRESs) (Martineau <italic>et al.</italic>, <xref ref-type="bibr" rid="B21">2004</xref>). Therefore, the detection of similar structural motifs in different <bold>RNA</bold>s is an important aspect for function determination and should be considered in pairwise RNA comparison methods. Although this problem is addressed in sequence–structure alignment methods, these approaches are often very time-consuming and do not necessarily preserve functionally important common substructures in the alignment (Jiang <italic>et al.</italic>, <xref ref-type="bibr" rid="B18">1995</xref>, <xref ref-type="bibr" rid="B19">2002</xref>).
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Putative SECIS elements in non-coding regions of <italic>Methanococcus jannaschii</italic> according to Wilting <italic>et al.</italic> (<xref ref-type="bibr" rid="B30">1997</xref>). The indicated substructure represents a common substructure, i.e. a local motif.</p></caption><graphic xlink:href="btp065f1"/></fig></p>
    <p>In this article, we propose a new lightweight, motif-based method for the pairwise comparison of <bold>RNA</bold>s. Instead of computing a full sequence–structure alignment, our approach efficiently computes a significant arrangement of sequence–structure motifs, common to two <bold>RNA</bold>s. For the sake of algorithmic complexity and applicability in practice, we neglect higher order interactions like pseudoknots. This allows to describe sequence–structure motifs with nested RNA secondary structures, as shown in <xref ref-type="fig" rid="F1">Figure 1</xref>.</p>
    <p>Our <monospace>ExpaRNA</monospace> (exact pattern of alignment of RNA) method uses as a pre-processing step a fast <italic>O</italic>(<italic>nm</italic>) time and space algorithm from Backofen and Siebert (<xref ref-type="bibr" rid="B3">2007</xref>) for the identification of isolated common substructures for the two given <bold>RNA</bold>s of lengths <italic>n</italic> and <italic>m</italic> with nested secondary structures. More precisely, this method identifies the complete, but overlapping set of exact common substructures. Our approach makes use of these common substructures and computes the longest collinear, non-overlapping sequence of substructures common to two <bold>RNA</bold>s in <italic>O</italic>(<italic>H</italic>·<italic>nm</italic>) time and <italic>O</italic>(<italic>nm</italic>) space, where <italic>H</italic> ≪ <italic>n</italic>·<italic>m</italic> for real RNA structures. Herein after, we call this the L<sc>ongest</sc> C<sc>ommon</sc> S<sc>ubsequence of</sc> E<sc>xact</sc> P<sc>attern</sc> M<sc>atchings</sc> problem (<bold>LCS-EPM</bold>).</p>
    <p>The <bold>LCS-EPM</bold> requires known or predicted structure. We have compared our approach with two other alignment methods that work with given RNA structures, namely <monospace>RNAforester</monospace> and <monospace>RNA_align</monospace>. The results are in good agreement, but can be obtained in a fraction of running time, in particular for larger <bold>RNA</bold>s.</p>
    <p>Since in many practical applications, there is no known structure, and structure prediction would lead to wrong results, we have also setup a pipeline that combines <monospace>ExpaRNA</monospace> with a state-of-the-art Sankoff-style algorithm for simultaneous alignment and folding (Sankoff, <xref ref-type="bibr" rid="B25">1985</xref>). Albeit Sankoff-like approaches are currently the gold standard for RNA alignment, it has the drawback of a high computational complexity. Basically, we predict a longest common subsequence of exact pattern first, and then use <monospace>LocARNA</monospace> (Will <italic>et al.</italic>, <xref ref-type="bibr" rid="B28">2007</xref>) to fill the unaligned space between the exact pattern matchings. This amounts to calculate a constraint alignment by <monospace>LocARNA</monospace>, which restricts the search space and thus speeds up <monospace>LocARNA</monospace>. Moreover, the speedup increases with the extent of information calculated by <monospace>ExpaRNA</monospace>. However, this normally implies that the quality is decreased. Hence, there is a trade-off between the speedup resulting from this combined pipeline, and the quality of the produced alignment. However, we get a speedup of 4.25 even in the highest quality setting, where the quality of the produced alignment is comparable to that of <monospace>LocARNA</monospace> alone. In application scenarios where optimal quality is not strictly required, we obtain a speedup up to 8.25. Note that this pipeline could also be used in combination with other Sankoff-like tools that are in principle able to profit from alignment constraints, e.g. Dynalign, PMComp and FoldalignM (Hofacker <italic>et al.</italic>, <xref ref-type="bibr" rid="B16">2004</xref>; Mathews and Turner, <xref ref-type="bibr" rid="B22">2002</xref>; Torarinsson <italic>et al.</italic>, <xref ref-type="bibr" rid="B27">2007</xref>).</p>
    <sec>
      <title>Related work:</title>
      <p>existing approaches addressing the sequence–structure comparison problem for RNA molecules can be distinguished by the given structural information and their representation. The standard alignment-based comparison approach employs the computation of edit distances between given RNA secondary structures (Bafna <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">1995</xref>; Jiang <italic>et al.</italic>, <xref ref-type="bibr" rid="B19">2002</xref>). In (Evans, <xref ref-type="bibr" rid="B9">1999</xref>) the author introduced the problem of finding the longest arc-preserving common subsequence (LAPCS). However, even for two <italic>nested</italic> RNA secondary structures, both problems remain NP-hard (Blin <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2003</xref>; Lin <italic>et al.</italic>, <xref ref-type="bibr" rid="B20">2002</xref>). With some restrictions to the scoring scheme, the time complexity for determination of the edit distance can be lowered to polynomial time (Jiang <italic>et al.</italic>, <xref ref-type="bibr" rid="B19">2002</xref>).</p>
      <p>If the nested secondary structure is represented as a tree, comparison methods exist for the edit distance between two ordered labeled trees (Zhang and Shasha, <xref ref-type="bibr" rid="B31">1989</xref>) as well as for the alignment of trees (Jiang <italic>et al.</italic>, <xref ref-type="bibr" rid="B18">1995</xref>). An improved version of the tree alignment method with extension to global and local forest alignments is given in Höchsmann <italic>et al.</italic> (<xref ref-type="bibr" rid="B14">2003</xref>) and implemented in the program RNAforester. The MiGaL (Allali and Sagot, <xref ref-type="bibr" rid="B1">2005</xref>) approach extends the tree edit distance model by the two new tree edit operations and is especially efficient due to its usage of different abstraction layers.</p>
      <p>The article is organized as follows. In <xref ref-type="sec" rid="SEC2">Section 2</xref>, we describe the way in which exact common substructures can be used for pairwise sequence–structure comparison. In addition, we explain how sequence–structure alignment methods can profit from anchor constraints. <xref ref-type="sec" rid="SEC3">Sections 3</xref> and <xref ref-type="sec" rid="SEC4">4</xref> present the results for two applications of our tool <monospace>ExpaRNA</monospace>.</p>
    </sec>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <p>RNA is a macro molecule described formally by a pair ℛ=(<italic>S</italic>, <italic>B</italic>) of a primary structure <italic>S</italic> and a secondary structure <italic>B</italic>. A <italic>primary structure S</italic> is a sequence of nucleotides <italic>S</italic>=<italic>s</italic><sub>1</sub><italic>s</italic><sub>2</sub>…<italic>s</italic><sub><italic>n</italic></sub> over the alphabet {<italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>U</italic>}. With |<italic>S</italic>| we denote the length of sequence S. <italic>S</italic>[<italic>i</italic>] indicates the nucleotide at position <italic>i</italic> in sequence S. With <italic>S</italic>[<italic>i</italic>…<italic>j</italic>] we define the substring of <italic>S</italic> starting at position <italic>i</italic> until <italic>j</italic> for 1≤<italic>i</italic>&lt;<italic>j</italic>≤|<italic>S</italic>|. A <italic>secondary structure B</italic> is a set of base pairs <italic>B</italic>={(<italic>i</italic>, <italic>i</italic>′) | 1≤<italic>i</italic>&lt;<italic>i</italic>′≤|<italic>S</italic>|} over <italic>S</italic>, where each base takes part in at most one base pair. A secondary structure <italic>B</italic> is called <italic>crossing</italic> if there are two pairs (<italic>i</italic>, <italic>i</italic>′),(<italic>j</italic>, <italic>j</italic>′)∈<italic>B</italic> with <italic>i</italic>&lt;<italic>j</italic>&lt;<italic>i</italic>′&lt;<italic>j</italic>′. Otherwise it is called <italic>non-crossing</italic> or <italic>nested</italic>.</p>
    <p>For the definition of local RNA motifs, we represent an RNA ℛ=(<italic>S</italic>, <italic>B</italic>) as undirected labeled graph <italic>G</italic>=(<italic>V</italic>, <italic>E</italic>), called the <italic>structure graph of</italic> ℛ. Its set of vertices <italic>V</italic> is the set of positions in <italic>S</italic>, i.e. <italic>V</italic>={1,…, |<italic>S</italic>|}. Its set of edges <italic>E</italic> comprises all backbone bonds and all base pairs, i.e. <italic>E</italic>={(<italic>i</italic>, <italic>i</italic>+1)∣1≤<italic>i</italic>&lt;|<italic>S</italic>|}∪<italic>B</italic>. An <italic>RNA pattern in</italic> ℛ is a set of positions 𝒫⊆{1,…, |<italic>S</italic>|}, such that the <italic>pattern graph for 𝒫 in G</italic>, defined as the subgraph <italic>G</italic>′=(<italic>V</italic>′, <italic>E</italic>′) of <italic>G</italic>, where <italic>V</italic>′=𝒫 and <italic>E</italic>′={(<italic>i</italic>, <italic>i</italic>′)∈<italic>E</italic> | <italic>i</italic>∈𝒫 and <italic>i</italic>′∈𝒫}, is connected. By this definition, an RNA pattern corresponds to a local motif, i.e. a substructure consisting of neighbored nucleotides according to a neighborhood that is induced by the backbone bonds and base pairs within a fixed secondary structure (cf. <xref ref-type="fig" rid="F1">Fig. 1</xref>).</p>
    <sec id="SEC2.1">
      <title>2.1 Exact pattern matchings of two RNAs</title>
      <p>In the following, we consider two fixed, non-crossing <bold>RNA</bold>s ℛ<sub>1</sub>=(<italic>S</italic><sub>1</sub>, <italic>B</italic><sub>1</sub>) and ℛ<sub>2</sub>=(<italic>S</italic><sub>2</sub>, <italic>B</italic><sub>2</sub>). Their corresponding structure graphs are <italic>G</italic><sub>1</sub>=(<italic>V</italic><sub>1</sub>, <italic>E</italic><sub>1</sub>) and <italic>G</italic><sub>2</sub>=(<italic>V</italic><sub>2</sub>, <italic>E</italic><sub>2</sub>), respectively. We will define an exact pattern matching as a special <italic>ordered matching of V</italic><sub>1</sub> <italic>and V</italic><sub>2</sub>, i.e. as a set ℳ⊆<italic>V</italic><sub>1</sub> × <italic>V</italic><sub>2</sub>, where for all (<italic>p</italic>, <italic>q</italic>), (<italic>p</italic>′, <italic>q</italic>′)∈ℳ it holds that <italic>p</italic>&lt;<italic>p</italic>′ implies <italic>q</italic>&lt;<italic>q</italic>′ and <italic>p</italic>=<italic>p</italic>′ iff <italic>q</italic>=<italic>q</italic>′.</p>
      <p>According to an ordered matching ℳ of <italic>V</italic><sub>1</sub> and <italic>V</italic><sub>2</sub>, we merge the graphs <italic>G</italic><sub>1</sub> and <italic>G</italic><sub>2</sub> into a <italic>matching graph</italic> 𝒢<sub>ℳ</sub>=(ℳ, <italic>E</italic><sub>ℳ</sub>), where <italic>E</italic><sub>ℳ</sub>={((<italic>p</italic>, <italic>q</italic>),(<italic>p</italic>′, <italic>q</italic>′))∈ℳ×ℳ∣(<italic>p</italic>, <italic>p</italic>′)∈<italic>E</italic><sub>1</sub> and (<italic>q</italic>, <italic>q</italic>′)∈<italic>E</italic><sub>2</sub>}. A pair (<italic>p</italic>, <italic>q</italic>)∈ℳ is called <italic>admissible</italic> if it satisfies the following conditions: (i) <italic>S</italic><sub>1</sub>[<italic>p</italic>]=<italic>S</italic><sub>2</sub>[<italic>q</italic>] and (ii) <bold>STRUCT</bold><sub>1</sub>(<italic>p</italic>)=<bold>STRUCT</bold><sub>2</sub>(<italic>q</italic>). Here, function <bold>STRUCT</bold><sub><italic>i</italic></sub>(<italic>j</italic>) yields one of the three possible structural types for a nucleotide at position <italic>j</italic> in structure <italic>i</italic>: <italic>single stranded</italic>, <italic>left paired</italic> or <italic>right paired</italic>. Furthermore, exact pattern matchings need to preserve all base pairs. A matching ℳ satisfies this iff ∀(<italic>p</italic>, <italic>q</italic>), (<italic>p</italic>′, <italic>q</italic>′)∈ℳ : (<italic>p</italic>, <italic>p</italic>′)∈<italic>B</italic><sub>1</sub> ⇔ (<italic>q</italic>, <italic>q</italic>′)∈<italic>B</italic><sub>2</sub>. Then, an <italic>exact pattern matching</italic> 𝒫ℳ is an ordered matching where <italic>G</italic><sub>𝒫ℳ</sub> is connected, all (<italic>p</italic>, <italic>q</italic>)∈𝒫ℳ are admissible and all base pairs are preserved.</p>
      <p>Hence, an exact pattern matching 𝒫ℳ describes the matching between sets of positions in the two <bold>RNA</bold>s ℛ<sub>1</sub> and ℛ<sub>2</sub>, namely the projections π<sub>1</sub>𝒫ℳ={<italic>p</italic>|(<italic>p</italic>, <italic>q</italic>)∈𝒫ℳ} and π<sub>2</sub>𝒫ℳ={<italic>q</italic>|(<italic>p</italic>, <italic>q</italic>)∈𝒫ℳ}. Note that π<sub>1</sub>𝒫ℳ and π<sub>2</sub>𝒫ℳ are patterns in ℛ<sub>1</sub> and ℛ<sub>2</sub>, respectively, i.e. in particular they correspond to the connected pattern graphs <italic>G</italic><sup><italic>p</italic></sup><sub>1</sub> and <italic>G</italic><sup><italic>p</italic></sup><sub>2</sub>. Note further, although we require that an exact pattern matching 𝒫ℳ is an isomorphism on base pairs, 𝒫ℳ does not necessarily describe an isomorphism on backbone edges in the pattern graphs <italic>G</italic><sup><italic>p</italic></sup><sub>1</sub> and <italic>G</italic><sup><italic>p</italic></sup><sub>2</sub>, since for (<italic>p</italic>, <italic>q</italic>),(<italic>p</italic>′, <italic>q</italic>′)∈𝒫ℳ where <italic>p</italic> and <italic>p</italic>′ form an edge in <italic>G</italic><sup><italic>p</italic></sup><sub>1</sub>, <italic>q</italic> and <italic>q</italic>′ do not necessarily form an edge in <italic>G</italic><sup><italic>p</italic></sup><sub>2</sub>. For details and proofs we refer to Backofen and Siebert (<xref ref-type="bibr" rid="B3">2007</xref>).</p>
      <p>For our algorithm, we utilize only <italic>maximal</italic> exact pattern matchings, i.e. ∀𝒫ℳ′ : 𝒫ℳ⊆𝒫ℳ′⇒𝒫ℳ′=𝒫ℳ. In the following, we abbreviate the term maximal exact matching pattern by <bold>EPM</bold>. Similar to the minimal word size as e.g. used in <bold>BLAST</bold> (Altschul <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">1997</xref>), it is reasonable to consider a minimal size γ for <bold>EPM</bold>s. Hence, the set of all maximal exact pattern matchings ℰ over two <bold>RNA</bold>s ℛ<sub>1</sub> and ℛ<sub>2</sub> is defined as
<disp-formula><graphic xlink:href="btp065um1"/></disp-formula>
Note that each <bold>EPM</bold> is an arc-preserving common (but not longest common) subsequence as defined in Evans (<xref ref-type="bibr" rid="B9">1999</xref>) for the <bold>LAPCS</bold> problem. Since <bold>EPM</bold>s have in addition the above described properties, the detection of all <bold>EPM</bold>s is a computationally light problem, compared to <bold>LAPCS</bold>, which is NP-complete even for nested sequences (Blin <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2003</xref>). Using the dynamic programming approach described in Backofen and Siebert (<xref ref-type="bibr" rid="B3">2007</xref>), the set of all <bold>EPM</bold>s can be found in <italic>O</italic>(<italic>nm</italic>) time and <italic>O</italic>(<italic>nm</italic>) space, making this approach applicable for fast sequence–structure comparisons. Now recall that each <bold>EPM</bold> is maximal. This implies that any two exact pattern matchings are disjoint and therefore a pair (<italic>p</italic>, <italic>q</italic>)∈ℰ∈<bold>E</bold><sup>1,2</sup><sub>γ</sub> is unique in <bold>E</bold><sup>1,2</sup><sub>γ</sub> and part of at most one <bold>EPM</bold>. The number of <bold>EPM</bold>s contained in <bold>E</bold><sup>1,2</sup><sub>γ</sub> is bounded by <italic>n</italic>·<italic>m</italic>, with <italic>n</italic>=|<italic>S</italic><sub>1</sub>| and <italic>m</italic>=|<italic>S</italic><sub>2</sub>|.</p>
      <p><bold>E</bold><sup>1,2</sup><sub>γ</sub> can be seen as a ‘library’ of all common motifs between two RNAs that can be utilized for a pairwise comparison method. Thus, the main idea of our approach will be to take a subset EPMs from <bold>E</bold><sup>1,2</sup><sub>γ</sub> that in combination will cover a large portion of both <bold>RNA</bold>s. The <bold>EPM</bold>s in <bold>E</bold><sup>1,2</sup><sub>γ</sub> differ in their size and shape as well as in their structural positions in both <bold>RNA</bold>s. Simply selecting two or several of these substructures for combination would probably lead to overlapping or crossing structures (<xref ref-type="fig" rid="F2">Fig. 2</xref>). Hence, the set of all <bold>EPM</bold>s is not a solution for the <bold>LAPCS</bold> problem since the combination of several <bold>EPM</bold>s is not necessarily arc-preserving. Clearly, a meaningful subset of common substructures excludes overlapping and crossing patterns. This guarantees that the backbone order of matched nucleotides as well as base pairs of the given <bold>RNA</bold>s are preserved. Compatible <bold>EPM</bold>s are called non-crossing. Formally, two <bold>EPM</bold>s ℰ<sub>1</sub> and ℰ<sub>2</sub> are <italic>non-crossing</italic> if ℰ<sub>1</sub>∪ℰ<sub>2</sub> is an ordered matching. <xref ref-type="fig" rid="F2">Figure 2</xref> shows an example of a possible set <bold>E</bold><sup>1,2</sup><sub>γ</sub>. A ‘good’ subset to describe the similarity between the two <bold>RNA</bold>s would probably exclude the <bold>EPM</bold>s indicated in red.
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>A possible set <bold>E</bold><sup>1,2</sup><sub>γ</sub> for two RNAs ℛ<sub>1</sub>, ℛ<sub>2</sub>. The set {ℰ<sub>1</sub>, ℰ<sub>2</sub>, ℰ<sub>3</sub>, ℰ<sub>4</sub>} can be used for a comparison, whereas {ℰ<sub>5</sub>, ℰ<sub>6</sub>} should be excluded. ℰ<sub>5</sub> is crossing ℰ<sub>2</sub> and ℰ<sub>3</sub>, whereas ℰ<sub>6</sub> is overlapping with ℰ<sub>3</sub> in ℛ<sub>1</sub> and with ℰ<sub>4</sub> in ℛ<sub>2</sub>. Note that not all possible <bold>EPM</bold> s are indicated.</p></caption><graphic xlink:href="btp065f2"/></fig>
</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Combining EPMs for comparing RNAs: problem definition and algorithm overview</title>
      <p>The formulation of <bold>LCS-EPM</bold> is motivated by the fact that similar <bold>RNA</bold>s with fixed secondary structures share identical structural elements in a similar arrangement. Examples are shown in our result section for the comparison of thermodynamically folded as well as experimentally verified secondary structures. The knowledge of such a ‘common core’ of identical substructures in two <bold>RNA</bold>s is interesting for different tasks.</p>
      <p>For our global approach, we are interested in a <italic>maximal</italic> possible arrangement of substructures shared by two <bold>RNA</bold>s. If the motifs are given in the form of exact pattern matchings, we call this the <bold>LCS-EPM</bold> problem. Basically, we search for a maximal combination of <bold>EPM</bold>s that form a common subsequence. Note that albeit the problem shares some similarity with <bold>LAPCS</bold>, it is restricted in such a way that an efficient solution is possible.</p>
      <p>Formally, <bold>LCS-EPM</bold> is defined as follows. Given two nested <bold>RNA</bold>s ℛ<sub>1</sub>, ℛ<sub>2</sub> and a set of exact pattern matchings <bold>E</bold><sup>1,2</sup><sub>γ</sub> of these two <bold>RNA</bold>s, find an ordered matching ℳ<sub>EPM</sub> consisting of a subset of <bold>EPM</bold>s from <bold>E</bold><sup>1,2</sup><sub>γ</sub> that has maximal cardinality. Thus, ℳ<sub>EPM</sub> is defined as the union <inline-formula><inline-graphic xlink:href="btp065i1.jpg"/></inline-formula> of a subset 𝒞⊆<bold>E</bold><sup>1,2</sup><sub>γ</sub>, where all <bold>EPM</bold>s contained in 𝒞 are mutually non-crossing. Note that this implies that the found subsequence is a common subsequence since ℳ<sub>EPM</sub> is an ordered matching. The common base pairs are induced by the <bold>EPM</bold> s itself.</p>
      <p>Given a library of <bold>EPM</bold>s, our algorithm works by singling out the best combination of compatible <bold>EPM</bold>s. This task is performed efficiently by dynamic programming. The main idea is to recursively reduce the problem of solving the <bold>EPM</bold> puzzle for the <bold>EPM</bold>s enclosed in subsequences <italic>S</italic><sup>1</sup>[<italic>i</italic>…<italic>j</italic>] and <italic>S</italic><sup>2</sup>[<italic>k</italic>…<italic>l</italic>] to the problem for smaller subsequences. For our recursion scheme, we exploit the special structure of <bold>EPM</bold>s, which span matchings of certain subsequences of consecutive nucleotides. Between the boundaries of these matched consecutive subsequence, <bold>EPM</bold>s can omit subsequences; thereby they contain holes.</p>
      <p><xref ref-type="fig" rid="F3">Figure 3</xref> illustrates this structure of <bold>EPM</bold>s and shows how, given a single <bold>EPM</bold> ℰ, the relative position of the other <bold>EPM</bold>s to ℰ can be distinguished. Formally, this is defined via the boundaries and holes of a single <bold>EPM</bold>.
<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>Ordering of exact pattern matchings relative to <bold>EPM</bold> ℰ<sub>1</sub> (indicated in dark gray). The cases <italic>before, inside</italic> and <italic>after</italic> do not violate the non-crossing condition. Only <bold>EPM</bold> ℰ<sub>3</sub> crosses ℰ<sub>1</sub>. Note that an arc denotes a base pair within an <bold>EPM</bold>.</p></caption><graphic xlink:href="btp065f3"/></fig>
</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Algorithmic concepts: boundaries and holes</title>
      <p>The nucleotide positions of a pattern 𝒫 of size <italic>k</italic> can be written as an increasing sequence. Similarly, an <bold>EPM</bold> ℰ of size k over two <bold>RNA</bold>s is given with its corresponding patterns 𝒫<sub>1</sub> in ℛ<sub>1</sub> and 𝒫<sub>2</sub> in ℛ<sub>2</sub> and their increasing sequences 𝒫<sub>1</sub>=〈<italic>p</italic><sub>1</sub>, <italic>p</italic><sub>2</sub>,…, <italic>p</italic><sub><italic>k</italic></sub>〉 and 𝒫<sub>2</sub>=〈<italic>q</italic><sub>1</sub>, <italic>q</italic><sub>2</sub>,…, <italic>q</italic><sub><italic>k</italic></sub>〉.</p>
      <sec id="SEC2.3.1">
        <title>2.3.1 Boundaries of EPMs</title>
        <p>In the view of the secondary structure, the elements (<italic>p</italic><sub>1</sub>, <italic>p</italic><sub><italic>k</italic></sub>) and (<italic>q</italic><sub>1</sub>, <italic>q</italic><sub><italic>k</italic></sub>) determine the outside borders of the <bold>EPM</bold>. Therefore, we call them <italic>outside-boundaries</italic> and write them as <inline-formula><inline-graphic xlink:href="btp065i2.jpg"/></inline-formula>. In the view of an arc-annotated sequence, we call (<italic>p</italic><sub>1</sub>, <italic>q</italic><sub>1</sub>) <italic>left-outside-boundaries</italic> and (<italic>p</italic><sub><italic>k</italic></sub>, <italic>q</italic><sub><italic>k</italic></sub>) <italic>right-outside-boundaries</italic> and denote them as LEFT<sub>ℰ</sub> and RIGHT<sub>ℰ</sub>.</p>
        <p>If an <bold>EPM</bold> contains base pairs, the structural shape is more complex and the outside-boundaries are not sufficient to describe all structural borders. If not all enclosed nucleotides of a base pair are part of the <bold>EPM</bold>, then there exist two positions in each <bold>RNA</bold> that form an additional structural border <italic>inside</italic> the range of the outside-boundaries. In addition, if a pattern contains several independent base pairs (e.g. in a multi-loop), there can be several such inside borders (cf. <xref ref-type="fig" rid="F4">Fig. 4</xref>). The set of all such borders is called <italic>inside-boundaries</italic> and is defined as <inline-formula><inline-graphic xlink:href="btp065i3.jpg"/></inline-formula>. Note that <italic>outside-boundaries</italic> always exists, whereas the set <italic>inside-boundaries</italic> can be empty. For example, assume an <bold>EPM</bold> that comprises only unpaired nucleotides or a complete hairpin including the closing bond. If an <bold>EPM</bold> consists of only one base pair in each sequence, then inside-and outside-boundaries are identical. With the superscript index for the RNA we retrieve the boundaries for a single RNA. For example LEFT<sub>ℰ</sub><sup>1</sup>=<italic>p</italic><sub>1</sub>.
<fig id="F4" position="float"><label>Fig. 4.</label><caption><p>A pattern of an <bold>EPM</bold> in one RNA (green nucleotides). The different boundaries are indicated.</p></caption><graphic xlink:href="btp065f4"/></fig>
</p>
      </sec>
      <sec id="SEC2.3.2">
        <title>2.3.2 Holes</title>
        <p>Holes are directly related to inside-boundaries and describe the subsequences which are not the part of the subsequence <italic>S</italic><sub><italic>i</italic></sub>[<bold>LEFT</bold><sub>ℰ</sub><sup><italic>i</italic></sup>, <bold>RIGHT</bold><sub>ℰ</sub><sup><italic>i</italic></sup>] of an <bold>EPM</bold> ℰ. For a given <bold>EPM</bold> ℰ with its set of inside-boundaries <bold>IN</bold><sub>ℰ</sub>, the set of holes with minimal size γ is defined as <bold>HOLES</bold><sub>ℰ</sub>={〈(<italic>l</italic><sup>1</sup>, <italic>r</italic><sup>1</sup>), (<italic>l</italic><sup>2</sup>, <italic>r</italic><sup>2</sup>)〉 | <italic>r</italic><sup>1</sup>≥<italic>l</italic><sup>1</sup> + γ ∧ <italic>r</italic><sup>2</sup>≥<italic>l</italic><sup>2</sup> + γ}. We introduce the notations <italic>h</italic><sup><italic>L</italic>1</sup>, <italic>h</italic><sup><italic>R</italic>1</sup>, <italic>h</italic><sup><italic>L</italic>1</sup> and <italic>h</italic><sup><italic>R</italic>2</sup> to refer to <italic>l</italic><sup>1</sup>,<italic>r</italic><sup>1</sup>,<italic>l</italic><sup>2</sup> and <italic>r</italic><sup>2</sup> of a hole <italic>h</italic>=〈(<italic>l</italic><sup>1</sup>, <italic>r</italic><sup>1</sup>),(<italic>l</italic><sup>2</sup>, <italic>r</italic><sup>2</sup>)〉, respectively. For each <italic>h</italic>∈<bold>HOLES</bold><sub>ℰ</sub> there exists a pair of inside-boundaries with 〈(<italic>h</italic><sup><italic>L</italic>1</sup>−1, <italic>h</italic><sup><italic>R</italic>1</sup>+1),(<italic>h</italic><sup><italic>L</italic>2</sup>−1, <italic>h</italic><sup><italic>R</italic>2</sup>+1)〉∈<bold>IN</bold><sub>ℰ</sub>. Clearly, a hole spans a substring <italic>S</italic><sub>1</sub>[<italic>h</italic><sup><italic>L</italic>1</sup>…<italic>h</italic><sup><italic>R</italic>1</sup>] in the first <bold>RNA</bold> and a substring <italic>S</italic><sub>2</sub>[<italic>h</italic><sup><italic>L</italic>2</sup>…<italic>h</italic><sup><italic>R</italic>2</sup>] in the second <bold>RNA</bold>. With γ we refer to the same size as indicated by <bold>E</bold><sup>1,2</sup><sub>γ</sub>.</p>
        <p>According to the length of the induced subsequences <italic>S</italic><sub><italic>i</italic></sub>[<italic>h</italic><sup><italic>Li</italic></sup>…<italic>h</italic><sup><italic>Ri</italic></sup>], we can sort all holes in one RNA. Let <italic>h</italic><sub><italic>i</italic></sub>∈<bold>HOLES</bold><sub>ℰ<sub><italic>i</italic></sub></sub> and <italic>h</italic><sub><italic>j</italic></sub>∈<bold>HOLES</bold><sub>ℰ<sub><italic>j</italic></sub></sub> two holes for any two ℰ<sub><italic>i</italic></sub>, ℰ<sub><italic>j</italic></sub>∈<bold>E</bold><sup>1,2</sup><sub>γ</sub>. We define an ordering <inline-formula><inline-graphic xlink:href="btp065i4.jpg"/></inline-formula> in ℛ<sub>1</sub> if and only if <italic>h</italic><sub><italic>i</italic></sub> is of smaller size than <italic>h</italic><sub><italic>j</italic></sub> or of equal size in ℛ<sub>1</sub>, i.e. <inline-formula><inline-graphic xlink:href="btp065i5.jpg"/></inline-formula>.</p>
      </sec>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Dynamic programming recursion for LCS-EPM</title>
      <p>The essential difference of <bold>LCS-EPM</bold> to other alignment-based <bold>RNA</bold> comparison problems (including <bold>LAPCS</bold>) is that it treats a common substructure (i.e. an exact pattern matching) as a whole, unbreakable unit. This means that a solution of <bold>LCS-EPM</bold> either completely includes or completely excludes the edges (<italic>p</italic>, <italic>q</italic>) of each <bold>EPM</bold>. Following this idea, we want to compute the longest collinear sequence of <bold>EPM</bold>s which does not contain any crossing and overlapping <bold>EPM</bold>s.</p>
      <p>The overall solution for <bold>LCS-EPM</bold> is constructed by a bottom-up approach from the comparison of substructures that are covered by the subsequences <italic>S</italic><sub>1</sub>[<italic>i</italic>…<italic>j</italic>] and <italic>S</italic><sub>2</sub>[<italic>k</italic>…<italic>l</italic>]. In principle, this requires a four-dimensional matrix, denoted as <italic>D</italic>(<italic>i</italic>, <italic>j</italic>, <italic>k</italic>, <italic>l</italic>), which contains the maximal score for combining <bold>EPM</bold>s that match only bases in <italic>S</italic><sub>1</sub>[<italic>i</italic>…<italic>j</italic>] and <italic>S</italic><sub>2</sub>[<italic>k</italic>…<italic>l</italic>]. However, we can restrict ourselves to two-dimensional matrices using our notions of boundaries and holes for an exact pattern matching ℰ. For each hole, we introduce one two-dimensional matrix of entries <bold>D</bold><sup><italic>h</italic></sup>(<italic>j</italic>, <italic>l</italic>), such that <bold>D</bold><sup><italic>h</italic></sup>(<italic>j</italic>, <italic>l</italic>) is <italic>D</italic>(<italic>h</italic><sup><italic>L</italic>1</sup>, <italic>j</italic>, <italic>h</italic><sup><italic>L</italic>2</sup>, <italic>l</italic>) of our imaginary four-dimensional matrix.</p>
      <p>Finding non-crossing regions relative to an <bold>EPM</bold> is achieved as follows: all nucleotides before LEFT<sub>ℰ</sub>, i.e <italic>S</italic><sub><italic>i</italic></sub>[1, LEFT<sub>ℰ</sub><sup><italic>i</italic></sup>−1], as well as all nucleotides after the RIGHT<sub>ℰ</sub>, i.e. <italic>S</italic><sub><italic>i</italic></sub>[RIGHT<sub>ℰ</sub><sup><italic>i</italic></sup>+1, |<italic>S</italic><sub><italic>i</italic></sub>|] fulfill the non-crossing condition. This means that any <bold>EPM</bold> with its outside-boundaries OUT<sub>ℰ</sub> in these regions is non-crossing relative to the considered <bold>EPM</bold>. Similarly we handle <bold>EPM</bold> s that contain base pairs with the introduced notion of HOLES<sub>ℰ</sub>. All <bold>EPM</bold>s that are located inside any hole of ℰ cannot cross or overlap with ℰ.</p>
      <p>The recursion scheme for a dynamic programming algorithm is as follows. Any ℰ is handled only once at its right-outside-boundary <bold>RIGHT</bold><sub>ℰ</sub>. The score of ℰ is composed of the score <italic>before</italic> ℰ (<xref ref-type="fig" rid="F3">Fig. 3</xref>), given at the position LEFT<sub>ℰ</sub>−1, plus the size of ℰ itself, denoted by the function ω, plus possible scores between inside-boundaries, given recursively by the computation for scores for holes <italic>h</italic>∈<bold>HOLES</bold><sub>ℰ</sub>. This last recursion case recurses to possible substructures and therefore suggests the use of a four-dimensional matrix. However, it suffices to use only quadratic space, since (1) all the scores for <bold>EPM</bold> s are stored in a vector with entries <bold>S</bold><sub>ℰ</sub> and (2) the score of each hole of an <bold>EPM</bold> can be computed using only a two-dimensional matrix. By ordering all holes according to <inline-formula><inline-graphic xlink:href="btp065i6.jpg"/></inline-formula>, we guarantee that all necessary scores are already computed and stored, whenever an <bold>EPM</bold> is considered. Due to this order, the recursion starts with the smallest holes and goes on to the larger ones. Note that the two holes of the same size can be treated in any order.</p>
      <p>For the formal description of the recursion, fix a hole <italic>h</italic>. The following recursion scheme works for any <italic>h</italic><sup><italic>L</italic>1</sup>≤<italic>j</italic>≤<italic>h</italic><sup><italic>R</italic>1</sup> and <italic>h</italic><sup><italic>L</italic>2</sup>≤<italic>l</italic>≤<italic>h</italic><sup><italic>R</italic>1</sup>.
<disp-formula><graphic xlink:href="btp065um2"/></disp-formula>
<disp-formula><graphic xlink:href="btp065um3"/></disp-formula>
</p>
      <p>After filling the matrices, the best score is computed from treating the whole sequence as hole. With a standard traceback technique the set of <bold>EPM</bold>s that form the <bold>LCS-EPM</bold> are found.</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Complexity</title>
      <p>Let <italic>n</italic>=|<italic>S</italic><sub>1</sub>| and <italic>m</italic>=|<italic>S</italic><sub>2</sub>| denote the lengths of the sequences. The time complexity depends primarily on the total number of holes. The set <bold>E</bold><sup>1,2</sup><sub>γ</sub> contains maximal n · m different holes which is estimated with <italic>O</italic>(<italic>nm</italic>). The proof is omitted. For each hole, we fill a two-dimensional matrix with a size of at most |<italic>S</italic><sub>1</sub>[<italic>l</italic><sup>1</sup>, <italic>r</italic><sup>1</sup>]|≤|<italic>S</italic><sub>1</sub>|=<italic>n</italic> and |<italic>S</italic><sub>2</sub>[<italic>l</italic><sup>2</sup>, <italic>r</italic><sup>2</sup>]|≤|<italic>S</italic><sub>2</sub>|=<italic>m</italic>. Consequently, for all holes we need <italic>O</italic>(<italic>n</italic><sup>2</sup><italic>m</italic><sup>2</sup>) time as worst case complexity. For real RNAs, a more appropriate time complexity can be given as <italic>O</italic>(<italic>H</italic>·<italic>nm</italic>) with <italic>H</italic> as the number of holes, since <italic>H</italic> ≪ <italic>n</italic>·<italic>m</italic>. This explains the fast running time of our algorithm on RNA. The space complexity is only <italic>O</italic>(<italic>nm</italic>) because for each hole, after computing its score contribution and adding the score to its <bold>EPM</bold>, the space for the corresponding matrix <bold>D</bold><sup><italic>h</italic></sup> is recycled.</p>
      <p>We summarize the complexity of solving the <bold>LCS-EPM</bold> problem as follows. Given two nested RNAs ℛ<sub>1</sub>=(<italic>S</italic><sub>1</sub>, <italic>B</italic><sub>1</sub>) and ℛ<sub>2</sub>=(<italic>S</italic><sub>2</sub>, <italic>B</italic><sub>2</sub>). The problem to determine the longest common subsequence of exact pattern matchings (<bold>LCS-EPM</bold>), including computation of <bold>E</bold><sup>1,2</sup><sub>γ</sub>, is solvable in total <italic>O</italic>(<italic>n</italic><sup>2</sup><italic>m</italic><sup>2</sup>) time and <italic>O</italic>(<italic>nm</italic>) space.</p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Speeding up RNA alignment by EPMs</title>
      <p>One important application of <bold>LCS-EPM</bold> is the use of the predicted alignment edges ℳ<sub>EPM</sub> as anchor constraints for sequence–structure alignment methods (Bauer <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2007</xref>; Havgaard <italic>et al.</italic>, <xref ref-type="bibr" rid="B12">2007</xref>; Will <italic>et al.</italic>, <xref ref-type="bibr" rid="B28">2007</xref>). The idea of this combined alignment approach is to first solve the <bold>LCS-EPM</bold> for two given RNAs and then hand over the obtained result to an (usually much more expensive) sequence–structure alignment algorithm. This algorithm is used to fill the unaligned space between the exact pattern matchings in ℳ<sub>EPM</sub> in order to produce a complete alignment, i.e. an alignment that also includes all the bases that do not occur in exact pattern matchings.</p>
      <p>In general, anchor constraints restrict the space of possible alignments. Thus any alignment algorithm can be sped up by the use of such constraints. Therefore, one expects a speed up of the existing sequence–structure alignment tools that support anchor constraints, when one combines them with the preprocessing by <monospace>ExpaRNA</monospace> that generates anchor constraints. Thus, the proposed combination will result in an accelerated RNA alignment approach compared to the underlying RNA alignment approach alone, which will work for any available alignment method.</p>
      <p>In particular, we modified the <monospace>LocARNA</monospace> algorithm for simultaneous folding and alignment of two RNA sequences <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> in order to profit from anchors. As a Sankoff-style algorithm, <monospace>LocARNA</monospace> essentially evaluates the recursion
<disp-formula><graphic xlink:href="btp065um4"/></disp-formula>
where <italic>i</italic>, <italic>j</italic>, <italic>k</italic>, <italic>l</italic> are sequence positions, i.e. 1≤<italic>i</italic>&lt;<italic>j</italic>≤<italic>n</italic>=|<italic>S</italic><sub>1</sub>| and 1≤<italic>k</italic>&lt;<italic>l</italic>≤<italic>m</italic>=|<italic>S</italic><sub>2</sub>|, α is the gap cost, σ is a base similarity function and τ is a base pair similarity function τ, which reflects Turner's RNA energy model (Hofacker <italic>et al.</italic>, <xref ref-type="bibr" rid="B16">2004</xref>; Mathews <italic>et al.</italic>, <xref ref-type="bibr" rid="B23">1999</xref>). An entry <italic>M</italic><sub><italic>ij</italic>;<italic>kl</italic></sub> contains the maximal score of alignments of <italic>S</italic><sub>1</sub>[<italic>i</italic>..<italic>j</italic>] with <italic>S</italic><sub>2</sub>[<italic>k</italic>..<italic>l</italic>], whereas for the entries <italic>D</italic><sub><italic>ij</italic>;<italic>kl</italic></sub> the alignments additionally have to match the base pairs (<italic>i</italic>, <italic>j</italic>) and (<italic>k</italic>, <italic>l</italic>). In consequence, <italic>D</italic><sub><italic>ij</italic>;<italic>kl</italic></sub> are only required when (<italic>i</italic>, <italic>k</italic>) and (<italic>j</italic>, <italic>l</italic>) can be alignment edges of some alignment at all. For computing all entries <italic>D</italic><sub><italic>ij</italic>;<italic>kl</italic></sub> with a common (<italic>i</italic>, <italic>k</italic>), the algorithm fills the matrix slice <italic>M</italic><sub><italic>i</italic>·;<italic>k</italic>·</sub>, which is the main load of the algorithm.</p>
      <p>Given anchors, the algorithm can be modified to require less entries in <italic>D</italic><sub><italic>ij</italic>;<italic>kl</italic></sub>, namely only those where (<italic>i</italic>, <italic>k</italic>) and (<italic>j</italic>, <italic>l</italic>) are compatible with the anchors. Particularly, this implies that it needs to compute only entries <italic>M</italic><sub><italic>ij</italic>;<italic>kl</italic></sub> where (<italic>i</italic>, <italic>k</italic>) is compatible with the anchor constraints.</p>
      <p>For example, assume that we have a single anchor constraint (<italic>n</italic>/2, <italic>m</italic>/2) (w.l.o.g. <italic>n</italic> and <italic>m</italic> even). Because only alignment edges (<italic>i</italic>, <italic>k</italic>) with <italic>i</italic>≤<italic>n</italic>/2 and <italic>k</italic>≤<italic>n</italic>/2 or <italic>i</italic>&gt;<italic>n</italic>/2 and <italic>k</italic>&gt;<italic>n</italic>/2 are compatible with the anchor, the algorithm computes only entries in <italic>M</italic><sub><italic>ij</italic>;<italic>kl</italic></sub> for those (<italic>i</italic>, <italic>j</italic>), i.e. only half of the entries compared to the unconstrained algorithm.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>3 RESULTS</title>
    <p>We implemented the algorithm for finding the longest common subsequence of exact RNA patterns (i.e. <bold>LCS-EPM</bold>) in the tool <monospace>ExpaRNA</monospace>. The algorithm to determine all <bold>EPM</bold> s is implemented according to Backofen and Siebert (<xref ref-type="bibr" rid="B3">2007</xref>). <monospace>ExpaRNA</monospace> is implemented in C++.</p>
    <p>We see at least two main application areas for <monospace>ExpaRNA</monospace>. First, given two RNAs along with their known or predicted secondary structure, the result of <monospace>ExpaRNA</monospace> comprises the optimal set of compatible exact common substructures. In biology, this can be used to get a good, first overview of existing similarities. Second, due to the fast running time of <monospace>ExpaRNA</monospace>, it is very attractive to use <monospace>ExpaRNA</monospace> for high-throughput RNA analysis tasks. We designed scenarios for both applications to study the different uses of our tool in detail.</p>
    <sec id="SEC3.1">
      <title>3.1 Comparative structural analysis of large RNAs</title>
      <p>Here, we study the application of <monospace>ExpaRNA</monospace> for analyzing large RNAs that are very costly to compare by other sufficiently accurate tools and where <monospace>ExpaRNA</monospace> elucidates information about identical structural motifs, which is not directly addressed by these tools and therefore may remain hidden. To enable an evaluation of our results, the experiments are performed on medium-sized and large RNAs where sequence–structure alignment tools are still applicable.</p>
      <p>We have chosen two pairs of RNAs: (<bold>a</bold>) two IRES RNAs from hepatitis C virus, which belong both to the Rfam family HCV_IRES for IRESs (Griffiths-Jones <italic>et al.</italic>, <xref ref-type="bibr" rid="B11">2005</xref>). GenBank: AF165050 (bases 1–379) and D45172 (bases 1–391). The secondary structures were predicted by <monospace>RNAfold</monospace> (Hofacker <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">1994</xref>). (<bold>b</bold>) Two 16S rRNAs. The first RNA is from <italic>Escherichia coli</italic> and is 1541 bases long. The second RNA of length 1551 stems from <italic>Dictyostelium discoideum</italic> (GenBank codes: J01859 and D16466). The secondary structures were taken from the Comparative RNA Web (CRW) site (Cannone <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2002</xref>).</p>
      <p><xref ref-type="table" rid="T1">Table 1</xref> shows the results for both pairs of RNAs. The solution of <bold>LCS-EPM</bold> is depicted as annotation of the secondary structures in <xref ref-type="fig" rid="F5">Figure 5</xref> for the IRES RNAs and in <xref ref-type="fig" rid="F6">Figure 6</xref> for the 16S rRNAs. These figures are directly produced by <monospace>ExpaRNA</monospace> using the Vienna RNA Package (Hofacker <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">1994</xref>) for the structure layout. For the IRES RNAs, the numbers mark the five largest <bold>EPM</bold> s from the set <bold>E</bold><sup>1,2</sup><sub>γ</sub> and correspond to the manually marked <bold>EPM</bold> s in Backofen and Siebert (<xref ref-type="bibr" rid="B3">2007</xref>). <bold>LCS-EPM</bold> predicts all of them automatically. In the case of the 16S rRNAs, the result of <monospace>ExpaRNA</monospace> shows significant similarities in nearly all stem and loop regions. Note that the set <bold>E</bold><sup>1,2</sup><sub>γ</sub> was computed with γ=2 for both examples.
<fig id="F5" position="float"><label>Fig. 5.</label><caption><p><bold>LCS-EPM</bold> approach applied to two hepatitis C virus IRES RNAs. The colored nucleotides represent the found <bold>LCS-EPM</bold> with a coverage of 45% (175 nt). Each <bold>EPM</bold> is shown in a different color. The numbers indicate the five largest <bold>EPM</bold> s from <bold>E</bold><sup>1,2</sup><sub>γ</sub>. GenBank: D45172 (upper RNA), AF165050 (lower RNA).</p></caption><graphic xlink:href="btp065f5"/></fig>
<fig id="F6" position="float"><label>Fig. 6.</label><caption><p><bold>LCS-EPM</bold> approach applied to two 16S RNAs. The colored nucleotides represent the found <bold>LCS-EPM</bold> with a coverage of 57% (875 nt). Each <bold>EPM</bold> is shown in a different color. (<bold>a</bold>) <italic>D. discoideum</italic> 16S rRNA (D16466), (<bold>b</bold>) <italic>E. coli</italic> 16S rRNA (J01859).</p></caption><graphic xlink:href="btp065f6"/></fig>
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Comparison of the number of exactly matching alignment edges found by <bold>LCS-EPM</bold> and two alignment methods</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Methods</th><th align="left" colspan="3" rowspan="1">IRES RNAs<hr/></th><th align="left" colspan="3" rowspan="1">16S rRNAs<hr/></th></tr><tr><th rowspan="1" colspan="1"/><th align="left" rowspan="1" colspan="1">No. of matches</th><th align="left" rowspan="1" colspan="1">Coverage (%)</th><th align="left" rowspan="1" colspan="1">Time (s)</th><th align="left" rowspan="1" colspan="1">No. of matches</th><th align="left" rowspan="1" colspan="1">Coverage (%)</th><th align="left" rowspan="1" colspan="1">Time</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1"><bold><monospace>ExpaRNA</monospace></bold></td><td align="left" rowspan="1" colspan="1">175</td><td align="left" rowspan="1" colspan="1">45</td><td align="left" rowspan="1" colspan="1">0.97</td><td align="left" rowspan="1" colspan="1">875</td><td align="left" rowspan="1" colspan="1">57</td><td align="left" rowspan="1" colspan="1">16.9 s</td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>RNA_align</monospace></td><td align="left" rowspan="1" colspan="1">192</td><td align="left" rowspan="1" colspan="1">50</td><td align="left" rowspan="1" colspan="1">62.1</td><td align="left" rowspan="1" colspan="1">861</td><td align="left" rowspan="1" colspan="1">56</td><td align="left" rowspan="1" colspan="1">1 h 35 m</td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>RNAforester</monospace></td><td align="left" rowspan="1" colspan="1">128</td><td align="left" rowspan="1" colspan="1">33</td><td align="left" rowspan="1" colspan="1">5.41</td><td align="left" rowspan="1" colspan="1">847</td><td align="left" rowspan="1" colspan="1">55</td><td align="left" rowspan="1" colspan="1">7 m 25 s</td></tr><tr><td colspan="7" rowspan="1"><hr/></td></tr><tr><td align="left" colspan="2" rowspan="1">Comparison</td><td align="left" colspan="2" rowspan="1">IRES RNAs</td><td align="left" colspan="2" rowspan="1">16S rRNAs</td><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" colspan="2" rowspan="1">No. of common matches</td><td align="left" colspan="2" rowspan="1">No. of common matches</td><td rowspan="1" colspan="1"/></tr><tr><td colspan="7" rowspan="1"><hr/></td></tr><tr><td align="left" colspan="2" rowspan="1"><monospace>ExpaRNA</monospace> and <monospace>RNA_align</monospace></td><td align="left" colspan="2" rowspan="1">159 (82.8%)</td><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">688 (79.9%)</td><td rowspan="1" colspan="1"/></tr><tr><td align="left" colspan="2" rowspan="1"><bold><monospace>ExpaRNA</monospace> and <monospace>RNAforester</monospace></bold></td><td align="left" colspan="2" rowspan="1">103 (80.5%)</td><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">700 (82.6%)</td><td rowspan="1" colspan="1"/></tr></tbody></table><table-wrap-foot><fn><p>In the lower part, no. of <italic>common matches</italic> defines the number of identical aligned nucleotides of <monospace>ExpaRNA</monospace> and the other methods.</p></fn></table-wrap-foot></table-wrap></p>
      <p>We compare our results with the output of <monospace>RNA_align</monospace> and <monospace>RNAforester</monospace>. The first method computes sequence-structure alignments according to the general edit distance algorithm (Jiang <italic>et al.</italic>, <xref ref-type="bibr" rid="B19">2002</xref>). The <monospace>RNAforester</monospace> program of Höchsmann <italic>et al.</italic> (<xref ref-type="bibr" rid="B14">2003</xref>) is built upon the tree editing algorithm for ordered trees of Jiang <italic>et al.</italic> (<xref ref-type="bibr" rid="B18">1995</xref>) and extends it to calculate forest alignments. We compare us with these tools since both tools cover the state-of-the-art in RNA alignment that is based on fixed structures. The general edit distance algorithm is a classic editing type algorithm for RNA comparison, whereas <monospace>RNAforester</monospace> represents the class of tree alignment-based algorithms, which can be due to their working principle much faster, but are less accurate than editing algorithms.</p>
      <p>We compared the methods by the number of common realized alignment edges. Therefore, we have first computed the alignments for both RNA pairs. Next, we have counted all positions with exact sequence–structure matchings in these alignments and also determined the intersections with LCS-EPM. Note that the time for <monospace>ExpaRNA</monospace> in <xref ref-type="table" rid="T1">Table 1</xref> includes the time to determine all <bold>EPM</bold> s for the two IRES RNAs (0.44s) and for the two 16S rRNAs (1.2s). The given sequence coverage rate is twice the number of predicted exact matches divided by the sum of the two sequence lengths.</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Speeding up RNA alignment for large-scale analysis</title>
      <p>Here, we study the performance of <monospace>ExpaRNA</monospace> for high-throughput <bold>RNA</bold> analysis. In <xref ref-type="sec" rid="SEC2.6">Section 2.6</xref>, we showed by which means sequence–structure alignment algorithms can profit from anchor constraints and suggested to combine such tools with <monospace>ExpaRNA</monospace> that yields <bold>EPM</bold> s as anchor constraints in the form of a pre-computation step.</p>
      <p>In order to assess the possible speedup by this combination, we tested <monospace>ExpaRNA</monospace> in combination with the <monospace>LocARNA</monospace> algorithm (Otto <italic>et al.</italic>, <xref ref-type="bibr" rid="B24">2008</xref>; Will <italic>et al.</italic>, <xref ref-type="bibr" rid="B28">2007</xref>).</p>
      <p>The accuracy of our combined approach (called <monospace>ExpLoc</monospace>) was evaluated with the Bralibase 2.1 benchmark (Gardner <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">2005</xref>; Wilm <italic>et al.</italic>, <xref ref-type="bibr" rid="B29">2006</xref>). The Bralibase 2.1 consists of a collection of hand-curated sets of RNA alignments. Because we are interested in the performance of pairwise alignment, we choose the k2 dataset with 8976 pairwise alignments. For each reference alignment, we compute the corresponding <monospace>ExpLoc</monospace> alignment and determined its sum of pair scores (SPS)/Compalign score (Bahr <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2001</xref>; Gardner <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">2005</xref>; Wilm <italic>et al.</italic>, <xref ref-type="bibr" rid="B29">2006</xref>) that measures the accuracy of reproducing the reference alignment. Furthermore, we recorded the running times of <monospace>ExpLoc</monospace> and <monospace>LocARNA</monospace> for each k2 alignment.</p>
      <p>For the computation of a single <monospace>ExpLoc</monospace> alignment, we first computed the mfe structure with <monospace>RNAfold</monospace> of each sequence and input the two RNAs to <monospace>ExpaRNA</monospace>. Afterwards, the <monospace>ExpaRNA</monospace> output is used as anchor constraints for <monospace>LocARNA</monospace> in order to obtain the complete alignment of the two RNAs.</p>
      <p>To test the performance of the two approaches, we carried out five experiments. First, we examined the accuracy of <monospace>LocARNA</monospace> alone. The other four experiments evaluate the performance of the combined approach <monospace>ExpLoc</monospace>. Here, we assessed the resulting alignment quality for different values γ=7,8,9 and 10 for the <monospace>ExpaRNA</monospace> algorithm.</p>
      <p><xref ref-type="fig" rid="F7">Figure 7</xref> shows the achieved SPS scores at different levels of sequence identity for all five experiments. In addition, we included the performance of the <monospace>Lara</monospace> sequence–structure alignment algorithm (Bauer <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2007</xref>).
<fig id="F7" position="float"><label>Fig. 7.</label><caption><p>Obtained alignment qualities for different minimal <bold>EPM</bold> sizes γ in comparison to <monospace>LocARNA</monospace> and <monospace>Lara</monospace> on <monospace>Bralibase 2.1</monospace> k2 dataset.</p></caption><graphic xlink:href="btp065f7"/></fig></p>
      <p><xref ref-type="fig" rid="F8">Figure 8</xref> shows a boxplot (also called box-and-whisker plot) visualizing min-values, max-values, medians and quartiles of the SPS/Compalign score distribution for varying pairwise sequence identities.
<fig id="F8" position="float"><label>Fig. 8.</label><caption><p>Comparison of the quality of obtained results for exploc (light blue) and <monospace>LocARNA</monospace> (orange). The boxplot shows distributions of sum-of-pairs scores (SPS) on the <italic>y</italic>-axis for different sequence identities on the <italic>x</italic>-axis for all 8976 pairwise alignments from <monospace>Bralibase 2.1</monospace> and an minimal <bold>EPM</bold> size of γ=10. To compute distributions, alignments were grouped according to their APSI in intervals of width 5.</p></caption><graphic xlink:href="btp065f8"/></fig></p>
      <p>The obtained speedup factors shown in <xref ref-type="fig" rid="F9">Figure 9</xref> are calculated relative to the <monospace>LocARNA</monospace> algorithm. The shown values correspond to the experiments in <xref ref-type="fig" rid="F7">Figure 7</xref>. The overall running time of <monospace>LocARNA</monospace> was 19 h 26 min. All computations were carried out on a Pentium 4 with 3.2 GHz.
<fig id="F9" position="float"><label>Fig. 9.</label><caption><p>Achieved speedup of <monospace>ExpLoc</monospace> with respect to <monospace>LocARNA</monospace> running time when using different minimal <bold>EPM</bold>sizes γ. Total times were measured for both methods when applied to all alignments of the <monospace>Bralibase 2.1</monospace> k2 dataset.</p></caption><graphic xlink:href="btp065f9"/></fig>
</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>4 DISCUSSION</title>
    <p>Our results indicate that <monospace>ExpaRNA</monospace> can be advantageous in different application scenarios. In comparative <bold>RNA</bold> analysis, the results of <monospace>ExpaRNA</monospace> exhibit the existing similarities between <bold>RNA</bold> structures in a nice way. Existing relationships can be detected in a fraction of runtime without using a full alignment procedure.</p>
    <p>Due to the availability of more and more large-scale datasets from modern pyro-sequencing techniques, high-throughput analysis methods for thousands of RNAs are needed. We analyzed the contribution of <monospace>ExpaRNA</monospace> for such tasks with the <monospace>Bralibase</monospace> benchmark. In general, our combined approach yields comparable results like other sequence–structure alignment algorithms. We observed a scaleable tradeoff between speedup and resulting alignment quality according to the selected minimal <bold>EPM</bold> size γ (<xref ref-type="fig" rid="F7">Figs 7</xref> and <xref ref-type="fig" rid="F9">9</xref>). By using different γ parameters our combined approach <monospace>ExpLoc</monospace> can be nicely balanced. This is important for problems with large datasets in which often a lower quality setting is sufficent. Moreover, our results show that anchor constraints are able to speedup Sankoff-style alignment algorithms in general (see <xref ref-type="sec" rid="SEC2.6">Section 2.6</xref>).</p>
    <p>A more fine-grained picture of the achieved accuracy of <monospace>ExpLoc</monospace> with γ=10 is shown in <xref ref-type="fig" rid="F8">Figure 8</xref>. In the &lt;70% sequence identity the differences are small. The lowered quality especially in region with a high sequence identity can be explained by the used mfe structures for <monospace>ExpaRNA</monospace>. Only slight differences in the sequence result in wide changes of the secondary structure which in turn leads to wrong predicted anchors. However, pure sequence alignment programs are sufficent here. For low sequence identities (≤30%), there are nearly no differences. Here, <monospace>ExpaRNA</monospace> often does not find anchors which result in a standard <monospace>LocARNA</monospace> alignment. However, these cases are rare, which is also indicated by the width of the boxes in <xref ref-type="fig" rid="F8">Figure 8</xref>.</p>
    <p>The different speedups of <monospace>ExpLoc</monospace> for different γ values can be explained by the number of predicted anchor points. For γ=7 there exists more anchors than for γ=10. Further, we observe from our data speedups for short as well as for long alignments (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp065/DC1">Supplementary Figs 1 and 2</ext-link>). In particular, the speedup for long alignments is higher than for small ones, but also the majority of small alignments are accelerated. For longer RNAs we observe speedups around 100. We also look into the distribution of the speedups over different sequence identity classes. In general, sequences with a high sequence identity gain a higher speedup, but we also observe high speedups for classes between 35% and 65% sequence identity. This range is especially relevant for sequence–structure alignment methods, as pure sequence alignment methods will fail here.</p>
    <p>Finally, we also observe 336 alignments for <monospace>ExpLoc</monospace> with γ=10 (447 for γ=7) resulting in a better SPS score than <monospace>LocARNA</monospace> alone.</p>
  </sec>
  <sec sec-type="conclusions" id="SEC5">
    <title>5 CONCLUSION</title>
    <p>We have developed a new algorithm for the pairwise sequence–structure comparison of <bold>RNA</bold>s and implemented it in the program <monospace>ExpaRNA</monospace>. Our approach utilizes common substructures for the detection of global similarities between two <bold>RNA</bold>s. We have applied the presented dynamic programming algorithm to two different kinds of application. In comparative sequence analysis, <monospace>ExpaRNA</monospace> can be used as good overview of existing similarities between two <bold>RNA</bold>s. Especially for large <bold>RNA</bold>s, <monospace>ExpaRNA</monospace> produces fast meaningful results without the need for usually more expensive alignment methods. In addition, we tested the performance of <monospace>ExpaRNA</monospace> in large-scale data analysis. Here, the main idea is to use the predicted LCS-EPM, i.e. an optimal set of compatible substructures, as anchor constraints for Sankoff-style alignment algorithms in order to compute a complete gapped global alignment. We tested <monospace>ExpaRNA</monospace> in combination with the <monospace>LocARNA</monospace> algorithm on the <monospace>Bralibase</monospace> benchmark. In our experiments, we observe a trade-off between quality and speedup according to the chosen parameter γ. However, we get a speedup of 4.25 even in the highest tested quality setting, where the quality of the produced alignment is comparable to other sequence–structure alignment methods. The achieved results also suggests further exploration of the full potential of the <monospace>ExpaRNA</monospace> and <monospace>ExpLoc</monospace> approach for a variety of <bold>RNA</bold> structure comparsion-based applications.</p>
    <p><italic>Funding</italic>: German Research Foundation (DFG grant BA 2168/2-1 SPP 1258); Federal Ministry of Education and Research (BMBF grant 0313921 FORSYS/FRISYS).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>[Supplementary Data]</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="btp065_index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="btp065_1.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allali</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sagot</surname>
            <given-names>M-F</given-names>
          </name>
        </person-group>
        <article-title>A new distance for high level RNA secondary structure comparison</article-title>
        <source>IEEE/ACM Trans. Comput. Biol. Bioinfor.</source>
        <year>2005</year>
        <volume>2</volume>
        <fpage>3</fpage>
        <lpage>14</lpage>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1997</year>
        <volume>25</volume>
        <fpage>3389</fpage>
        <lpage>3402</lpage>
        <pub-id pub-id-type="pmid">9254694</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Siebert</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fast detection of common sequence structure patterns in RNAs</article-title>
        <source>J. Discrete Algorithm</source>
        <year>2007</year>
        <volume>5</volume>
        <fpage>212</fpage>
        <lpage>228</lpage>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bafna</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Zvi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Esko</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Computing similarity between RNA strings</article-title>
        <source>Proceedings of the 6th Symposium Combinatorial Pattern Matching.</source>
        <year>1995</year>
        <publisher-name>Lecture Notes in Computer Science</publisher-name>
        <fpage>1</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bahr</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BAliBASE (Benchmark Alignment dataBASE): enhancements for repeats, transmembrane sequences and circular permutations</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>323</fpage>
        <lpage>326</lpage>
        <pub-id pub-id-type="pmid">11125126</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate multiple sequence-structure alignment of RNA sequences using combinatorial optimization</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>271</fpage>
        <pub-id pub-id-type="pmid">17662141</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Blin</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA sequences and the<sc>edit(nested,nested)</sc>problem</article-title>
        <source>Technical Report RR-IRIN-03.07</source>
        <year>2003</year>
        <publisher-loc>IRIN</publisher-loc>
        <publisher-name>Université de Nantes</publisher-name>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cannone</surname>
            <given-names>JJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Comparative RNA Web (CRW) Site: an online database of comparative sequence and structure information for ribosomal, intron, and other RNAs: Correction</article-title>
        <source>BMC Bioinformatics</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>15</fpage>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Evans</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Algorithms and Complexity for Annotated Sequence Analysis</article-title>
        <source>Ph.D. thesis</source>
        <year>1999</year>
        <publisher-name>University of Alberta</publisher-name>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>PP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A benchmark of multiple sequence alignment programs upon structural RNAs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>2433</fpage>
        <lpage>2439</lpage>
        <pub-id pub-id-type="pmid">15860779</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griffiths-Jones</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rfam: annotating non-coding RNAs in complete genomes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>D121</fpage>
        <lpage>D124</lpage>
        <pub-id pub-id-type="pmid">15608160</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Havgaard</surname>
            <given-names>JH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast pairwise structural RNA alignments by pruning of the dynamical programming matrix</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>1896</fpage>
        <lpage>1908</lpage>
        <pub-id pub-id-type="pmid">17937495</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hentze</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>LC</given-names>
          </name>
        </person-group>
        <article-title>Molecular control of vertebrate iron metabolism: mRNA-based regulatory circuits operated by iron, nitric oxide, and oxidative stress</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>1996</year>
        <volume>93</volume>
        <fpage>8175</fpage>
        <lpage>8182</lpage>
        <pub-id pub-id-type="pmid">8710843</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Höchsmann</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Local similarity in RNA secondary structures</article-title>
        <source>Proceedings of Computational Systems Bioinformatics (CSB 2003)</source>
        <year>2003</year>
        <volume>2</volume>
        <publisher-name>IEEE Computer Society</publisher-name>
        <fpage>159</fpage>
        <lpage>168</lpage>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast folding and comparison of RNA secondary structures</article-title>
        <source>Monatsh. Chem.</source>
        <year>1994</year>
        <volume>125</volume>
        <fpage>167</fpage>
        <lpage>188</lpage>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Alignment of RNA base pairing probability matrices</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>2222</fpage>
        <lpage>2227</lpage>
        <pub-id pub-id-type="pmid">15073017</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huttenhofer</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Solution structure of mRNA hairpins promoting selenocysteine incorporation in Escherichia coli and their base-specific interaction with special elongation factor SELB</article-title>
        <source>RNA</source>
        <year>1996</year>
        <volume>2</volume>
        <fpage>354</fpage>
        <lpage>366</lpage>
        <pub-id pub-id-type="pmid">8634916</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Alignment of trees - an alternative to tree edit</article-title>
        <source>Theor. Comput. Sci.</source>
        <year>1995</year>
        <volume>143</volume>
        <fpage>137</fpage>
        <lpage>148</lpage>
      </element-citation>
    </ref>
    <ref id="B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A general edit distance between RNA structures</article-title>
        <source>J. Comput. Biol.</source>
        <year>2002</year>
        <volume>9</volume>
        <fpage>371</fpage>
        <lpage>388</lpage>
        <pub-id pub-id-type="pmid">12015887</pub-id>
      </element-citation>
    </ref>
    <ref id="B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The longest common subsequence problem for sequences with nested arc annotations</article-title>
        <source>J. Comput. Syst. Sci.</source>
        <year>2002</year>
        <volume>65</volume>
        <fpage>465</fpage>
        <lpage>480</lpage>
      </element-citation>
    </ref>
    <ref id="B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martineau</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Internal ribosome entry site structural motifs conserved among mammalian fibroblast growth factor 1 alternatively spliced mRNAs</article-title>
        <source>Mol. Cell Biol.</source>
        <year>2004</year>
        <volume>24</volume>
        <fpage>7622</fpage>
        <lpage>7635</lpage>
        <pub-id pub-id-type="pmid">15314170</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Dynalign: an algorithm for finding the secondary structure common to two RNA sequences</article-title>
        <source>J. Mol. Biol.</source>
        <year>2002</year>
        <volume>317</volume>
        <fpage>191</fpage>
        <lpage>203</lpage>
        <pub-id pub-id-type="pmid">11902836</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathews</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Expanded sequence dependence of thermodynamic parameters improves prediction of RNA secondary structure</article-title>
        <source>J. Mol. Biol.</source>
        <year>1999</year>
        <volume>288</volume>
        <fpage>911</fpage>
        <lpage>940</lpage>
        <pub-id pub-id-type="pmid">10329189</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Otto</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure local multiple alignment of RNA</article-title>
        <source>Proceedings of German Conference on Bioinformatics (GCB'2008)</source>
        <year>2008</year>
        <volume>P-136</volume>
        <publisher-loc>LNI</publisher-loc>
        <publisher-name>Gesellschaft für Informatik</publisher-name>
        <fpage>178</fpage>
        <lpage>188</lpage>
      </element-citation>
    </ref>
    <ref id="B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sankoff</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Simultaneous solution of the RNA folding, alignment and protosequence problems</article-title>
        <source>SIAM J. Appl. Math.</source>
        <year>1985</year>
        <volume>45</volume>
        <fpage>810</fpage>
        <lpage>825</lpage>
      </element-citation>
    </ref>
    <ref id="B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Serganov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Ribozymes, riboswitches and beyond: regulation of gene expression without proteins</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>776</fpage>
        <lpage>790</lpage>
        <pub-id pub-id-type="pmid">17846637</pub-id>
      </element-citation>
    </ref>
    <ref id="B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torarinsson</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiple structural alignment and clustering of RNA sequences</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>926</fpage>
        <lpage>932</lpage>
        <pub-id pub-id-type="pmid">17324941</pub-id>
      </element-citation>
    </ref>
    <ref id="B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inferring non-coding RNA families and classes by means of genome-scale structure-based clustering</article-title>
        <source>PLOS Comput. Biol.</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e65</fpage>
        <pub-id pub-id-type="pmid">17432929</pub-id>
      </element-citation>
    </ref>
    <ref id="B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An enhanced RNA alignment benchmark for sequence alignment programs</article-title>
        <source>Algorithms Mol. Biol.</source>
        <year>2006</year>
        <volume>1</volume>
        <fpage>19</fpage>
        <pub-id pub-id-type="pmid">17062125</pub-id>
      </element-citation>
    </ref>
    <ref id="B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilting</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Selenoprotein synthesis in archaea: identification of an mRNA element of Methanococcus jannaschii probably directing selenocysteine insertion</article-title>
        <source>J. Mol. Biol.</source>
        <year>1997</year>
        <volume>266</volume>
        <fpage>637</fpage>
        <lpage>641</lpage>
        <pub-id pub-id-type="pmid">9102456</pub-id>
      </element-citation>
    </ref>
    <ref id="B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shasha</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Simple fast algorithms for the editing distance between trees and related problems</article-title>
        <source>SIAM J. Comput.</source>
        <year>1989</year>
        <volume>18</volume>
        <fpage>1245</fpage>
        <lpage>1262</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
